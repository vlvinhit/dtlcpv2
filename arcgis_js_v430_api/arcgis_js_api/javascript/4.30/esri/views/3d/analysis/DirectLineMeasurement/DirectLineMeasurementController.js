// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.30/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/tslib.es6 ../../../../core/Accessor ../../../../core/Logger ../../../../core/reactiveUtils ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../interfaces ../support/projectionUtils ../../../support/euclideanLengthMeasurementUtils ../../../support/geodesicLengthMeasurementUtils ../../../support/geodesicMeasurementUtils".split(" "),function(d,f,q,r,e,h,x,y,t,k,
p,u,v,w){d.DirectLineMeasurementController=class extends q{constructor(a){super(a)}initialize(){this.addHandles([e.watch(()=>({viewData:this.viewData,startPoint:this.analysis.startPoint}),({viewData:a,startPoint:b})=>{a.elevationAlignedStartPoint=this._applyProjectionAndElevationAlignment(b)},e.syncAndInitial),e.watch(()=>({viewData:this.viewData,endPoint:this.analysis.endPoint}),({viewData:a,endPoint:b})=>{a.elevationAlignedEndPoint=this._applyProjectionAndElevationAlignment(b)},e.syncAndInitial),
e.watch(()=>({result:this._computedResult,viewData:this.viewData}),({result:a,viewData:b})=>{b.result=a},e.syncAndInitial)])}_applyProjectionAndElevationAlignment(a){if(null==a)return a;const {spatialReference:b,elevationProvider:l}=this.view,c=p.applyProjectionAndElevationAlignment(a,b,l);return null==c?(p.logFailedGeometryProjectionError(this.analysis,a.spatialReference,r.getLogger(this)),null):c}get _computedResult(){const {elevationAlignedStartPoint:a,elevationAlignedEndPoint:b,measurementMode:l}=
this.viewData;if(null==a||null==b)return null;const c=u.euclideanDistanceBetweenPoints(a,b),g=v.geodesicDistanceBetweenPoints(a,b);if(null==c)return null;let m,n;switch(l){case k.MeasurementMode.Auto:n=null!=g?"geodesic":"euclidean";m=g??c.horizontal;break;case k.MeasurementMode.Geodesic:if(null==g)return null;n="geodesic";m=g;break;case k.MeasurementMode.Euclidean:n="euclidean",m=c.horizontal}return{mode:n,directDistance:c.direct,horizontalDistance:m,verticalDistance:c.vertical,distance:l===k.MeasurementMode.Euclidean||
c.horizontal.value<=w.geodesicDistanceThreshold?c.direct:g??c.horizontal}}};f.__decorate([h.property()],d.DirectLineMeasurementController.prototype,"view",void 0);f.__decorate([h.property()],d.DirectLineMeasurementController.prototype,"analysis",void 0);f.__decorate([h.property()],d.DirectLineMeasurementController.prototype,"viewData",void 0);f.__decorate([h.property()],d.DirectLineMeasurementController.prototype,"_computedResult",null);d.DirectLineMeasurementController=f.__decorate([t.subclass("esri.views.3d.analysis.DirectLineMeasurement.DirectLineMeasurementController")],
d.DirectLineMeasurementController);Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})});
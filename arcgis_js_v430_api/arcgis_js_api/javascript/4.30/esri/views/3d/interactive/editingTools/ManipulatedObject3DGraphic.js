// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.30/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/tslib.es6 ../../../../core/Evented ../../../../core/maybe ../../../../core/reactiveUtils ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../../../../core/support/UpdatingHandles ../../../../layers/graphics/sources/interfaces ../../../../support/elevationInfoUtils ../manipulatorUtils ./undoRecords ../../layers/graphics/GraphicState ../../../interactive/GraphicManipulator ../../../interactive/editGeometry/EditGeometryOperations".split(" "),
function(b,c,h,e,k,d,w,x,y,l,m,n,p,q,r,t,u,v){const f=Symbol();b.ManipulatedObject3DGraphic=class extends h.EventedAccessor{get operations(){return this._operations}get updating(){return this._updatingHandles.updating}get elevationInfo(){return p.getGraphicEffectiveElevationInfo(this.graphic)}get visible(){return this._graphicState.displaying}get isDraped(){return this._graphicState.isDraped}get origin(){return q.getGraphicAttachmentOrigin(this.view,this.graphic)}constructor(a){super(a);this._updatingHandles=
new m.UpdatingHandles}destroy(){this._operations=e.destroyMaybe(this._operations);this._updatingHandles.destroy()}initialize(){this._graphicState=new t.GraphicState({graphic:this.graphic});this._graphicState.on("changed",()=>this.emit("committed"));this.addHandles(this.view.trackGraphicState(this._graphicState));this.addHandles(this._updatingHandles.add(()=>this.graphic.geometry,a=>{if(a!==this._operations?.data.geometry)if(a&&"multipoint"!==a?.type&&"extent"!==a?.type)if(this._operations?.trySetGeometry(a))this.emit("modified-externally");
else{e.destroyMaybe(this._operations);this.removeHandles(f);const g=v.EditGeometryOperations.fromGeometry(a,this.view.state.viewingMode);this._operations=g;this.addHandles(g.data.on("change",()=>this.graphic.geometry=g.data.geometry),f)}else e.destroyMaybe(this._operations),this.removeHandles(f),this._operations=null},k.initial))}createManipulator(a){return new u.GraphicManipulator({view:this.view,graphic:this.graphic,...a})}maskOccludee(){return this.view.maskOccludee(this.graphic)}endInteraction(){"mesh"===
this.graphic.geometry?.type&&this.graphic.notifyMeshTransformChanged({action:n.MeshTransformUpdateAction.UpdateFastLocalOrigin})}toMap(a){return this.view.toMap(a,{include:[this.graphic]})}createUndoRecord(){const {graphic:{geometry:a}}=this;return r.createGraphicGeometryUndoRecord(a)}};c.__decorate([d.property({constructOnly:!0})],b.ManipulatedObject3DGraphic.prototype,"view",void 0);c.__decorate([d.property({constructOnly:!0})],b.ManipulatedObject3DGraphic.prototype,"graphic",void 0);c.__decorate([d.property()],
b.ManipulatedObject3DGraphic.prototype,"_operations",void 0);c.__decorate([d.property()],b.ManipulatedObject3DGraphic.prototype,"operations",null);c.__decorate([d.property()],b.ManipulatedObject3DGraphic.prototype,"updating",null);b.ManipulatedObject3DGraphic=c.__decorate([l.subclass("esri.views.3d.interactive.editingTools.ManipulatedObject3DGraphic")],b.ManipulatedObject3DGraphic);Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})});
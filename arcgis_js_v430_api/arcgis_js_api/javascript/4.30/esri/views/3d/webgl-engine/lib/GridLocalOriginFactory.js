// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.30/esri/copyright.txt for details.
//>>built
define("exports ../../../../core/has ../../../../core/uid ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../core/libs/gl-matrix-2/factories/vec4f64 ../../../../geometry/projection/projectBuffer ./Attribute ./ContentObjectType ./Geometry ./LocalOriginFactory ./Object3D ./testUtils ./VertexAttribute ./WebGLLayer ../materials/RibbonLineMaterial".split(" "),function(p,F,r,q,t,u,v,w,x,y,n,z,A,B,C,D){class E{constructor(a){this._originSR=a;this._rootOriginId="root/"+
r.generateUID();this._origins=new Map;this._objects=new Map;this._gridSize=5E5}getOrigin(a){var c=this._origins.get(this._rootOriginId);if(null==c){c=A.gridLocalOriginFactory.rootOrigin;if(null!=c)return this._origins.set(this._rootOriginId,n.fromValues(c[0],c[1],c[2],this._rootOriginId)),this.getOrigin(a);a=n.fromValues(a[0]+Math.random()-.5,a[1]+Math.random()-.5,a[2]+Math.random()-.5,this._rootOriginId);this._origins.set(this._rootOriginId,a);return a}var d=this._gridSize;const m=Math.round(a[0]/
d),l=Math.round(a[1]/d),f=Math.round(a[2]/d),g=`${m}/${l}/${f}`;let h=this._origins.get(g);const k=.5*d;q.subtract(b,a,c.vec3);b[0]=Math.abs(b[0]);b[1]=Math.abs(b[1]);b[2]=Math.abs(b[2]);if(b[0]<k&&b[1]<k&&b[2]<k)return h&&(d=Math.max(...b),q.subtract(b,a,h.vec3),b[0]=Math.abs(b[0]),b[1]=Math.abs(b[1]),b[2]=Math.abs(b[2]),Math.max(...b)<d)?h:c;h||(h=n.fromValues(m*d,l*d,f*d,g),this._origins.set(g,h));return h}_drawOriginBox(a,c=u.fromValues(1,1,0,1)){const d=window.view,m=d._stage;var l=c.toString();
if(!this._objects.has(l)){this._material=new D.RibbonLineMaterial({width:2,color:c});m.add(this._material);c=new C.WebGLLayer(m,{pickable:!1});var f=new z.Object3D({castShadow:!1});m.add(f);c.add(f);this._objects.set(l,f)}l=this._objects.get(l);c=[0,1,5,4,0,2,1,7,6,2,0,1,3,7,5,4,6,2,0];f=c.length;const g=Array(3*f),h=[],k=.5*this._gridSize;for(let e=0;e<f;e++)g[3*e]=a[0]+(c[e]&1?k:-k),g[3*e+1]=a[1]+(c[e]&2?k:-k),g[3*e+2]=a[2]+(c[e]&4?k:-k),0<e&&h.push(e-1,e);v.projectBuffer(g,this._originSR,0,g,d.renderSpatialReference,
0,f);a=new y.Geometry(this._material,[[B.VertexAttribute.POSITION,new w.Attribute(g,h,3,!0)]],null,x.ContentObjectType.Line);m.add(a);l.addGeometry(a)}get test(){}}const b=t.create();p.GridLocalOriginFactory=E;Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})});
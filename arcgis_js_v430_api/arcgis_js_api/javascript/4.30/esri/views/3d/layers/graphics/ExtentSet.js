// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.30/esri/copyright.txt for details.
//>>built
define(["exports","../../../../core/has","../../../../core/PooledArray","../../../../geometry/support/aaBoundingRect","../../../support/Scheduler"],function(l,t,n,d,p){class q{constructor(){this._extents=new n({allocator:a=>a||d.create()});this._tmpExtent=d.create();this._dirty=!1}get empty(){return 0===this._extents.length}get size(){return this._extents.length}clear(){this._extents.clear()}add(a){this._contains(a)||(this._removeContained(a),d.copy(this._extents.pushNew(),a),this._dirty=!0)}pop(){this._dirty&&
this._mergeTight();return this._extents.pop()}merge(a){this._mergeTight(a);return a.hasProgressed}_mergeTight(a=p.noBudget){const b=this._extents,g=new Set;let m=0;for(;m!==b.length;){b.sort((h,e)=>h[0]-e[0]);m=b.length;g.clear();for(let h=0;h<b.length;++h){if(a.done)return;const e=b.at(h);if(e){for(let c=h+1;c<b.length;++c){const f=b.at(c);if(null==f||f[0]>=e[2])break;g.add(f)}g.forEach(c=>{if(e!==c)if(c[2]<=e[0])g.delete(c);else{var f=d.area(e),r=d.area(c),k=this._tmpExtent;d.expand(e,c,k);f+=r;
.05>(d.area(k)-f)/f&&(d.copy(e,k),g.delete(c),b.remove(c),a.madeProgress())}});g.add(e)}}}this._dirty=!1}_contains(a){return this._extents.some(b=>d.contains(b,a))}_removeContained(a){this._extents.filterInPlace(b=>!d.contains(a,b))}get test(){}}l.ExtentSet=q;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})});
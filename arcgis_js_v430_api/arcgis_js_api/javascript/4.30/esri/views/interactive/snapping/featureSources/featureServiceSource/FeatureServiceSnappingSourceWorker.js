// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.30/esri/copyright.txt for details.
//>>built
require({cache:{"esri/core/support/UpdatingHandles":function(){define("exports ../../chunks/tslib.es6 ../Accessor ../handleUtils ../reactiveUtils ../scheduling ../accessorSupport/decorators/property ../accessorSupport/decorators/subclass".split(" "),function(a,c,w,v,C,z,e,r){a.UpdatingHandles=class extends w{constructor(){super(...arguments);this.updating=!1;this._scheduleHandleId=this._handleId=0;this._pendingPromises=new Set}destroy(){this.removeAll()}add(d,u,A={}){return this._installWatch(d,u,
A,C.watch)}addWhen(d,u,A={}){return this._installWatch(d,u,A,C.when)}addOnCollectionChange(d,u,{initial:A=!1,final:x=!1}={}){const E=++this._handleId;this.addHandles([C.on(d,"after-changes",this._createSyncUpdatingCallback(),C.sync),C.on(d,"change",u,{onListenerAdd:A?m=>u({added:m.toArray(),removed:[]}):void 0,onListenerRemove:x?m=>u({added:[],removed:m.toArray()}):void 0})],E);return v.makeHandle(()=>this.removeHandles(E))}addPromise(d){if(null==d)return d;const u=++this._handleId;this.addHandles(v.makeHandle(()=>
{this._pendingPromises.delete(d)&&(0!==this._pendingPromises.size||this.hasHandles(-42)||this._set("updating",!1))}),u);this._pendingPromises.add(d);this._set("updating",!0);const A=()=>this.removeHandles(u);d.then(A,A);return d}removeAll(){this._pendingPromises.clear();this.removeAllHandles();this._set("updating",!1)}_installWatch(d,u,A={},x){const E=++this._handleId;A.sync||this._installSyncUpdatingWatch(d,E);d=x(d,u,A);this.addHandles(d,E);return v.makeHandle(()=>this.removeHandles(E))}_installSyncUpdatingWatch(d,
u){const A=this._createSyncUpdatingCallback();d=C.watch(d,A,{sync:!0,equals:()=>!1});this.addHandles(d,u);return d}_createSyncUpdatingCallback(){return()=>{this.removeHandles(-42);++this._scheduleHandleId;const d=this._scheduleHandleId;this._get("updating")||this._set("updating",!0);this.addHandles(z.schedule(()=>{d===this._scheduleHandleId&&(this._set("updating",0<this._pendingPromises.size),this.removeHandles(-42))}),-42)}}};c.__decorate([e.property({readOnly:!0})],a.UpdatingHandles.prototype,"updating",
void 0);a.UpdatingHandles=c.__decorate([r.subclass("esri.core.support.UpdatingHandles")],a.UpdatingHandles);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/FeatureStore":function(){define("../../../core/arrayUtils ../../../core/Error ../../../core/Evented ../../../core/Logger ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../featureConversionUtils ./BoundsStore ./geometryUtils ./optimizedFeatureQueryEngineAdapter".split(" "),
function(a,c,w,v,C,z,e,r,d,u){const A=C.create();class x{constructor(E){this.geometryInfo=E;this._boundsStore=new r.BoundsStore;this._featuresById=new Map;this._markedIds=new Set;this.events=new w;this.featureAdapter=u.optimizedFeatureQueryEngineAdapter}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let E=
0;this._featuresById.forEach(m=>{null!=m.geometry&&m.geometry.coords&&(E+=m.geometry.coords.length)});return{featureCount:this._featuresById.size,vertexCount:E/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}getFullExtent(E){if(null==this.fullBounds)return null;const [m,h,b,n]=this.fullBounds;return{xmin:m,ymin:h,xmax:b,ymax:n,spatialReference:d.cleanFromGeometryEngine(E)}}add(E){this._add(E);this._emitChanged()}addMany(E){for(const m of E)this._add(m);this._emitChanged()}upsertMany(E){E=E.map(m=>this._upsert(m));
this._emitChanged();return E.filter(a.isSome)}clear(){this._featuresById.clear();this._boundsStore.clear();this._emitChanged()}removeById(E){E=this._featuresById.get(E);if(!E)return null;this._remove(E);this._emitChanged();return E}removeManyById(E){this._boundsStore.invalidateIndex();for(const m of E)(E=this._featuresById.get(m))&&this._remove(E);this._emitChanged()}forEachBounds(E,m){for(const h of E)(E=this._boundsStore.get(h.objectId))&&m(C.fromRect(A,E))}getFeature(E){return this._featuresById.get(E)}has(E){return this._featuresById.has(E)}forEach(E){this._featuresById.forEach(m=>
E(m))}forEachInBounds(E,m){this._boundsStore.forEachInBounds(E,h=>{m(this._featuresById.get(h))})}startMarkingUsedFeatures(){this._boundsStore.invalidateIndex();this._markedIds.clear()}sweep(){let E=!1;this._featuresById.forEach((m,h)=>{this._markedIds.has(h)||(E=!0,this._remove(m))});this._markedIds.clear();E&&this._emitChanged()}_emitChanged(){this.events.emit("changed",void 0)}_add(E){if(E){var m=E.objectId;if(null==m)v.getLogger("esri.layers.graphics.data.FeatureStore").error(new c("featurestore:invalid-feature",
"feature id is missing",{feature:E}));else{var h=this._featuresById.get(m);this._markedIds.add(m);if(h){E.displayId=h.displayId;var b=this._boundsStore.get(m);this._boundsStore.delete(m)}else if(null!=this.onFeatureAdd)this.onFeatureAdd(E);E.geometry?.coords?.length?(b=e.getBoundsOptimizedGeometry(null!=b?b:z.create(),E.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),null!=b&&this._boundsStore.set(m,b)):this._boundsStore.set(m,null);this._featuresById.set(m,E)}}}_upsert(E){const m=E?.objectId;
if(null==m)return v.getLogger("esri.layers.graphics.data.FeatureStore").error(new c("featurestore:invalid-feature","feature id is missing",{feature:E})),null;const h=this._featuresById.get(m);if(!h)return this._add(E),E;this._markedIds.add(m);const {geometry:b,attributes:n}=E;for(const p in n)h.attributes[p]=n[p];b&&(h.geometry=b,this._boundsStore.set(m,e.getBoundsOptimizedGeometry(z.create(),b,this.geometryInfo.hasZ,this.geometryInfo.hasM)??null));return h}_remove(E){if(null!=this.onFeatureRemove)this.onFeatureRemove(E);
const m=E.objectId;this._markedIds.delete(m);this._boundsStore.delete(m);this._featuresById.delete(m);return E}}return x})},"esri/geometry/support/aaBoundingBox":function(){define(["exports","../Extent","./aaBoundingRect"],function(a,c,w){function v(h=E){return[h[0],h[1],h[2],h[3],h[4],h[5]]}function C(h,b,n,p,D,M,g=v()){g[0]=h;g[1]=b;g[2]=n;g[3]=p;g[4]=D;g[5]=M;return g}function z(h){return h[0]>=h[3]?0:h[3]-h[0]}function e(h){return h[1]>=h[4]?0:h[4]-h[1]}function r(h){return h[2]>=h[5]?0:h[5]-
h[2]}function d(h,b){return Math.max(b[0],h[0])<=Math.min(b[3],h[3])&&Math.max(b[1],h[1])<=Math.min(b[4],h[4])&&Math.max(b[2],h[2])<=Math.min(b[5],h[5])}function u(h,b){h[0]=b[0];h[1]=b[1];h[2]=b[2];h[3]=b[3];h[4]=b[4];h[5]=b[5];return h}function A(h){return 6===h.length}const x=[Infinity,Infinity,Infinity,-Infinity,-Infinity,-Infinity],E=[0,0,0,0,0,0],m=v();a.allFinite=function(h){for(let b=0;6>b;b++)if(!isFinite(h[b]))return!1;return!0};a.center=function(h,b=[0,0,0]){b[0]=h[0]+z(h)/2;b[1]=h[1]+
e(h)/2;b[2]=h[2]+r(h)/2;return b};a.contains=function(h,b){return b[0]>=h[0]&&b[1]>=h[1]&&b[2]>=h[2]&&b[3]<=h[3]&&b[4]<=h[4]&&b[5]<=h[5]};a.containsPoint=function(h,b){return b[0]>=h[0]&&b[1]>=h[1]&&b[2]>=h[2]&&b[0]<=h[3]&&b[1]<=h[4]&&b[2]<=h[5]};a.containsPointWithMargin=function(h,b,n){return b[0]>=h[0]-n&&b[1]>=h[1]-n&&b[2]>=h[2]-n&&b[0]<=h[3]+n&&b[1]<=h[4]+n&&b[2]<=h[5]+n};a.create=v;a.depth=e;a.diameter=function(h){const b=z(h),n=r(h);h=e(h);return Math.sqrt(b*b+n*n+h*h)};a.empty=function(h){return h?
u(h,x):v(x)};a.equals=function(h,b,n){if(null==h||null==b)return h===b;if(!A(h)||!A(b))return!1;if(n)for(let p=0;p<h.length;p++){if(!n(h[p],b[p]))return!1}else for(n=0;n<h.length;n++)if(h[n]!==b[n])return!1;return!0};a.expandWithAABB=function(h,b){h[0]=Math.min(h[0],b[0]);h[1]=Math.min(h[1],b[1]);h[2]=Math.min(h[2],b[2]);h[3]=Math.max(h[3],b[3]);h[4]=Math.max(h[4],b[4]);h[5]=Math.max(h[5],b[5])};a.expandWithBuffer=function(h,b,n=0,p=b.length/3){let D=h[0],M=h[1],g=h[2],J=h[3],R=h[4],B=h[5];for(let F=
0;F<p;F++)D=Math.min(D,b[n+3*F]),M=Math.min(M,b[n+3*F+1]),g=Math.min(g,b[n+3*F+2]),J=Math.max(J,b[n+3*F]),R=Math.max(R,b[n+3*F+1]),B=Math.max(B,b[n+3*F+2]);h[0]=D;h[1]=M;h[2]=g;h[3]=J;h[4]=R;h[5]=B};a.expandWithNestedArray=function(h,b,n){const p=b.length;let D=h[0],M=h[1],g=h[2],J=h[3],R=h[4],B=h[5];if(n)for(n=0;n<p;n++){var F=b[n];D=Math.min(D,F[0]);M=Math.min(M,F[1]);g=Math.min(g,F[2]);J=Math.max(J,F[0]);R=Math.max(R,F[1]);B=Math.max(B,F[2])}else for(n=0;n<p;n++)F=b[n],D=Math.min(D,F[0]),M=Math.min(M,
F[1]),J=Math.max(J,F[0]),R=Math.max(R,F[1]);h[0]=D;h[1]=M;h[2]=g;h[3]=J;h[4]=R;h[5]=B};a.expandWithOffset=function(h,b,n,p){h[0]=Math.min(h[0],h[0]+b);h[3]=Math.max(h[3],h[3]+b);h[1]=Math.min(h[1],h[1]+n);h[4]=Math.max(h[4],h[4]+n);h[2]=Math.min(h[2],h[2]+p);h[5]=Math.max(h[5],h[5]+p)};a.expandWithRect=function(h,b){h[0]=Math.min(h[0],b[0]);h[1]=Math.min(h[1],b[1]);h[3]=Math.max(h[3],b[2]);h[4]=Math.max(h[4],b[3])};a.expandWithVec3=function(h,b){h[0]=Math.min(h[0],b[0]);h[1]=Math.min(h[1],b[1]);h[2]=
Math.min(h[2],b[2]);h[3]=Math.max(h[3],b[0]);h[4]=Math.max(h[4],b[1]);h[5]=Math.max(h[5],b[2])};a.fromExtent=function(h,b=v()){b[0]=h.xmin;b[1]=h.ymin;b[2]=h.hasZ?h.zmin:-Infinity;b[3]=h.xmax;b[4]=h.ymax;b[5]=h.hasZ?h.zmax:Infinity;return b};a.fromMinMax=function(h,b,n=v()){n[0]=h[0];n[1]=h[1];n[2]=h[2];n[3]=b[0];n[4]=b[1];n[5]=b[2];return n};a.fromRect=function(h,b){h[0]=b[0];h[1]=b[1];h[2]=Number.NEGATIVE_INFINITY;h[3]=b[2];h[4]=b[3];h[5]=Number.POSITIVE_INFINITY;return h};a.fromRectValues=function(h,
b,n,p,D){h[0]=b;h[1]=n;h[2]=Number.NEGATIVE_INFINITY;h[3]=p;h[4]=D;h[5]=Number.POSITIVE_INFINITY;return h};a.fromValues=C;a.getMax=function(h,b){b[0]=h[3];b[1]=h[4];b[2]=h[5];return b};a.getMin=function(h,b){b[0]=h[0];b[1]=h[1];b[2]=h[2];return b};a.height=r;a.intersects=d;a.intersectsClippingArea=function(h,b){return null==b?!0:d(h,b)};a.is=A;a.isPoint=function(h){return 0===z(h)&&0===e(h)&&0===r(h)};a.maximumDimension=function(h){return Math.max(z(h),r(h),e(h))};a.negativeInfinity=x;a.offset=function(h,
b,n,p,D=h){D[0]=h[0]+b;D[1]=h[1]+n;D[2]=h[2]+p;D[3]=h[3]+b;D[4]=h[4]+n;D[5]=h[5]+p;return D};a.positiveInfinity=[-Infinity,-Infinity,-Infinity,Infinity,Infinity,Infinity];a.scale=function(h,b,n=h){const p=h[0]+z(h)/2,D=h[1]+e(h)/2,M=h[2]+r(h)/2;n[0]=p+(h[0]-p)*b;n[1]=D+(h[1]-D)*b;n[2]=M+(h[2]-M)*b;n[3]=p+(h[3]-p)*b;n[4]=D+(h[4]-D)*b;n[5]=M+(h[5]-M)*b;return n};a.set=u;a.setMax=function(h,b,n=h){n[3]=b[0];n[4]=b[1];n[5]=b[2];n!==h&&(n[0]=h[0],n[1]=h[1],n[2]=h[2]);return h};a.setMin=function(h,b,n=
h){n[0]=b[0];n[1]=b[1];n[2]=b[2];n!==h&&(n[3]=h[3],n[4]=h[4],n[5]=h[5]);return n};a.size=function(h,b=[0,0,0]){b[0]=z(h);b[1]=e(h);b[2]=r(h);return b};a.toExtent=function(h,b){return isFinite(h[2])||isFinite(h[5])?new c({xmin:h[0],xmax:h[3],ymin:h[1],ymax:h[4],zmin:h[2],zmax:h[5],spatialReference:b}):new c({xmin:h[0],xmax:h[3],ymin:h[1],ymax:h[4],spatialReference:b})};a.toRect=function(h,b){b||=w.create();b[0]=h[0];b[1]=h[1];b[2]=h[3];b[3]=h[4];return b};a.width=z;a.wrap=function(h,b,n,p,D,M){return C(h,
b,n,p,D,M,m)};a.zero=E;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/featureConversionUtils":function(){define("exports ../../core/Error ../../core/Logger ../../core/maybe ../../geometry/support/aaBoundingBox ../../geometry/support/aaBoundingRect ../../geometry/support/jsonUtils ./OptimizedFeature ./OptimizedFeatureSet ./OptimizedGeometry".split(" "),function(a,c,w,v,C,z,e,r,d,u){function A(I,O){return I?O?4:3:O?3:2}function x(I,O,P,X){if(I){if(P)return O&&
X?K:Oa;if(O&&X)return q}else if(O&&X)return Oa;return Ta}function E({scale:I,translate:O},P){return Math.round((P-O[0])/I[0])}function m({scale:I,translate:O},P){return Math.round((O[1]-P)/I[1])}function h({scale:I,translate:O},P,X){return P*I[X]+O[X]}function b(I){I=I.coords;return{x:I[0],y:I[1]}}function n(I,O){I.coords[0]=O.x;I.coords[1]=O.y;return I}function p(I){I=I.coords;return{x:I[0],y:I[1],z:I[2]}}function D(I,O){I.coords[0]=O.x;I.coords[1]=O.y;I.coords[2]=O.z;return I}function M(I){I=I.coords;
return{x:I[0],y:I[1],m:I[2]}}function g(I,O){I.coords[0]=O.x;I.coords[1]=O.y;I.coords[2]=O.m;return I}function J(I){I=I.coords;return{x:I[0],y:I[1],z:I[2],m:I[3]}}function R(I,O){I.coords[0]=O.x;I.coords[1]=O.y;I.coords[2]=O.z;I.coords[3]=O.m;return I}function B(I,O){return I&&O?R:I?D:O?g:n}function F(I,O,P,X,aa){P=B(P,X);for(const {geometry:ca,attributes:fa}of O)O=null!=ca?P(new u,ca):null,I.push(new r.OptimizedFeature(O,fa,null,aa?fa[aa]:void 0));return I}function N(I,O,P=B(null!=O.z,null!=O.m)){return P(I,
O)}function T(I,O,P,X){for(const {geometry:aa,attributes:ca}of O)I.push({attributes:ca,geometry:null!=aa?y(aa,P,X):null});return I}function y(I,O,P){if(null==I)return null;const X=A(O,P),aa=[];for(let ca=0;ca<I.coords.length;ca+=X){const fa=[];for(let la=0;la<X;la++)fa.push(I.coords[ca+la]);aa.push(fa)}return O?P?{points:aa,hasZ:O,hasM:P}:{points:aa,hasZ:O}:P?{points:aa,hasM:P}:{points:aa}}function G(I,O,P,X,aa){P=A(P,X);for(const {geometry:ca,attributes:fa}of O)O=null!=ca?k(new u,ca,P):null,I.push(new r.OptimizedFeature(O,
fa,null,aa?fa[aa]:void 0));return I}function k(I,O,P=A(O.hasZ,O.hasM)){I.lengths[0]=O.points.length;const X=I.coords;let aa=0;for(const ca of O.points)for(O=0;O<P;O++)X[aa++]=ca[O];return I}function l(I,O,P){if(!I)return null;const X=A(O,P),{coords:aa,lengths:ca}=I;I=[];let fa=0;for(const la of ca){const ma=[];for(let ua=0;ua<la;ua++){const pa=[];for(let sa=0;sa<X;sa++)pa.push(aa[fa++]);ma.push(pa)}I.push(ma)}return O?P?{paths:I,hasZ:O,hasM:P}:{paths:I,hasZ:O}:P?{paths:I,hasM:P}:{paths:I}}function H(I,
O,P,X,aa){P=A(P,X);for(const {geometry:ca,attributes:fa,centroid:la}of O)O=null!=ca?U(new u,ca,P):null,X=null!=la?N(new u,la):null,I.push(new r.OptimizedFeature(O,fa,X,aa?fa[aa]:void 0));return I}function U(I,O,P=A(O.hasZ,O.hasM)){const {lengths:X,coords:aa}=I;let ca=0;for(const fa of O.paths){for(const la of fa)for(O=0;O<P;O++)aa[ca++]=la[O];X.push(fa.length)}return I}function Q(I,O,P){if(!I)return null;const X=A(O,P),{coords:aa,lengths:ca}=I;I=[];let fa=0;for(const la of ca){const ma=[];for(let ua=
0;ua<la;ua++){const pa=[];for(let sa=0;sa<X;sa++)pa.push(aa[fa++]);ma.push(pa)}I.push(ma)}return O?P?{rings:I,hasZ:O,hasM:P}:{rings:I,hasZ:O}:P?{rings:I,hasM:P}:{rings:I}}function W(I,O,P=O.hasZ,X=O.hasM){return Z(I,O.rings,P,X)}function Z(I,O,P,X){P=A(P,X);const {lengths:aa,coords:ca}=I;X=0;Ea(I);for(const fa of O){for(const la of fa)for(O=0;O<P;O++)ca[X++]=la[O];aa.push(fa.length)}return I}function ea(I,O,P,X,aa,ca){Da(I);if(!P){for(const fa of O)I.push(new r.OptimizedFeature(null,fa.attributes,
null,ca?fa.attributes[ca]:void 0));return I}switch(P){case "esriGeometryPoint":return F(I,O,X,aa,ca);case "esriGeometryMultipoint":return G(I,O,X,aa,ca);case "esriGeometryPolyline":return H(I,O,X,aa,ca);case "esriGeometryPolygon":for(const {geometry:fa,centroid:la,attributes:ma}of O)O=null!=fa?W(new u,fa,X,aa):null,P=ca?ma[ca]:void 0,null!=la?I.push(new r.OptimizedFeature(O,ma,n(new u,la),P)):I.push(new r.OptimizedFeature(O,ma,null,P));break;default:Pa().error("convertToFeatureSet:unknown-geometry",
new c(`Unable to parse unknown geometry type '${P}'`)),Da(I)}return I}function ia(I,O,P,X){I=I&&("coords"in I?I:I.geometry);if(null==I)return null;switch(O){case "esriGeometryPoint":return O=b,P&&X?O=J:P?O=p:X&&(O=M),O(I);case "esriGeometryMultipoint":return y(I,P,X);case "esriGeometryPolyline":return l(I,P,X);case "esriGeometryPolygon":return Q(I,P,X);default:return Pa().error("convertToGeometry:unknown-geometry",new c(`Unable to parse unknown geometry type '${O}'`)),null}}function na(I,O,P,X,aa){Da(I);
if(null==P){for(const fa of O)I.push({attributes:fa.attributes});return I}switch(P){case "esriGeometryPoint":P=b;X&&aa?P=J:X?P=p:aa&&(P=M);for(var ca of O){const {geometry:fa,attributes:la}=ca;X=null!=fa?P(fa):null;I.push({attributes:la,geometry:X})}break;case "esriGeometryMultipoint":return T(I,O,X,aa);case "esriGeometryPolyline":for(const {geometry:fa,attributes:la}of O)I.push({attributes:la,geometry:null!=fa?l(fa,X,aa):null});break;case "esriGeometryPolygon":for(const {geometry:fa,attributes:la,
centroid:ma}of O)ca=null!=fa?Q(fa,X,aa):null,null!=ma?(O=b(ma),I.push({attributes:la,centroid:O,geometry:ca})):I.push({attributes:la,geometry:ca});break;default:Pa().error("convertToFeatureSet:unknown-geometry",new c(`Unable to parse unknown geometry type '${P}'`))}return I}function qa(I,O,P,X,aa,ca,fa=P,la=X){Ea(I);if(!O?.coords.length)return null;aa=Sa[aa];const {coords:ma,lengths:ua}=O;O=A(P,X);const pa=A(P&&fa,X&&la);P=x(P,X,fa,la);if(!ua.length)return P(I.coords,ma,0,0,E(ca,ma[0]),m(ca,ma[1])),
Ea(I,O,0),I;let sa,Ca=0,xa,Ba=0;for(const Aa of ua){if(Aa<aa)continue;let ya=0;xa=Ba;la=X=E(ca,ma[Ca]);sa=fa=m(ca,ma[Ca+1]);P(I.coords,ma,xa,Ca,la,sa);ya++;Ca+=O;xa+=pa;for(let Ia=1;Ia<Aa;Ia++,Ca+=O)if(la=E(ca,ma[Ca]),sa=m(ca,ma[Ca+1]),la!==X||sa!==fa)P(I.coords,ma,xa,Ca,la-X,sa-fa),xa+=pa,ya++,X=la,fa=sa;ya>=aa&&(I.lengths.push(ya),Ba=xa)}Da(I.coords,Ba);return I.coords.length?I:null}function va(I,O,P,X,aa,ca,fa){let la=X,ma=0;for(let pa=ca+P;pa<fa;pa+=P){var ua=O[pa];const sa=O[pa+1],Ca=O[fa],xa=
O[fa+1];let Ba=O[ca],Aa=O[ca+1],ya=Ca-Ba,Ia=xa-Aa;if(0!==ya||0!==Ia){const Qa=((ua-Ba)*ya+(sa-Aa)*Ia)/(ya*ya+Ia*Ia);1<Qa?(Ba=Ca,Aa=xa):0<Qa&&(Ba+=ya*Qa,Aa+=Ia*Qa)}ya=ua-Ba;Ia=sa-Aa;ua=ya*ya+Ia*Ia;ua>la&&(ma=pa,la=ua)}la>X&&(ma-ca>P&&va(I,O,P,X,aa,ca,ma),aa(I,O,I.length,ma,O[ma],O[ma+1]),fa-ma>P&&va(I,O,P,X,aa,ma,fa))}function ta(I,O,P,X,aa){const {coords:ca,lengths:fa}=O;P=A(P,X);if(!ca.length)return I!==O&&Ea(I),I;v.assertIsSome(aa);const {originPosition:la,scale:ma,translate:ua}=aa;aa=ja;aa.originPosition=
la;X=aa.scale;X[0]=ma[0]??1;X[1]=-(ma[1]??1);X[2]=ma[2]??1;X[3]=ma[3]??1;var pa=aa.translate;pa[0]=ua[0]??0;pa[1]=ua[1]??0;pa[2]=ua[2]??0;pa[3]=ua[3]??0;if(!fa.length){for(X=0;X<P;++X)I.coords[X]=h(aa,ca[X],X);I!==O&&Ea(I,P,0);return I}pa=0;for(let Ca=0;Ca<fa.length;Ca++){const xa=fa[Ca];I.lengths[Ca]=xa;for(var sa=0;sa<P;++sa)I.coords[pa+sa]=h(aa,ca[pa+sa],sa);sa=I.coords[pa];let Ba=I.coords[pa+1];pa+=P;for(let Aa=1;Aa<xa;Aa++,pa+=P){sa+=ca[pa]*X[0];Ba+=ca[pa+1]*X[1];I.coords[pa]=sa;I.coords[pa+
1]=Ba;for(let ya=2;ya<P;++ya)I.coords[pa+ya]=h(aa,ca[pa+ya],ya)}}I!==O&&Ea(I,ca.length,fa.length);return I}function wa(I,O,P,X){let aa=0,ca=I[X*O],fa=I[X*(O+1)];for(let la=1;la<P;la++){const ma=ca+I[X*(O+la)],ua=fa+I[X*(O+la)+1],pa=(ma-ca)*(ua+fa);ca=ma;fa=ua;aa+=pa}return.5*aa}function Ea(I,O=0,P=0){Da(I.lengths,P);Da(I.coords,O)}function Da(I,O=0){I.length!==O&&(I.length=O)}const Pa=()=>w.getLogger("esri.layers.graphics.featureConversionUtils"),Sa={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,
esriGeometryMultipoint:0,esriGeometryEnvelope:0},Ta=(I,O,P,X,aa,ca)=>{I[P]=aa;I[P+1]=ca},Oa=(I,O,P,X,aa,ca)=>{I[P]=aa;I[P+1]=ca;I[P+2]=O[X+2]},q=(I,O,P,X,aa,ca)=>{I[P]=aa;I[P+1]=ca;I[P+2]=O[X+3]},K=(I,O,P,X,aa,ca)=>{I[P]=aa;I[P+1]=ca;I[P+2]=O[X+2];I[P+3]=O[X+3]},Y=[],ba=[],ja={originPosition:"lowerLeft",scale:[1,1,1,1],translate:[0,0,0,0]};a.convertFromFeature=function(I,O,P,X,aa){Y[0]=I;[I]=ea(ba,Y,O,P,X,aa);Da(Y);Da(ba);return I};a.convertFromFeatureSet=function(I,O){const P=new d,{hasM:X,hasZ:aa,
features:ca,objectIdFieldName:fa,spatialReference:la,geometryType:ma,exceededTransferLimit:ua,transform:pa,fields:sa}=I;sa&&(P.fields=sa);P.geometryType=ma??null;P.objectIdFieldName=fa??O??null;P.spatialReference=la??null;if(!P.objectIdFieldName)return Pa().error(new c("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),P;ca&&ea(P.features,ca,ma,aa,X,P.objectIdFieldName);ua&&(P.exceededTransferLimit=ua);X&&(P.hasM=X);aa&&(P.hasZ=aa);pa&&(P.transform=pa);return P};a.convertFromFeatures=
ea;a.convertFromGeometry=function(I,O,P){if(null==I)return null;const X=new u;"hasZ"in I&&null==O&&(O=I.hasZ);"hasM"in I&&null==P&&(P=I.hasM);if(e.isPoint(I))return B(null!=O?O:null!=I.z,null!=P?P:null!=I.m)(X,I);if(e.isPolygon(I))return W(X,I,O,P);if(e.isPolyline(I))return U(X,I,A(O,P));if(e.isMultipoint(I))return k(X,I,A(O,P));Pa().error("convertFromGeometry:unknown-geometry",new c(`Unable to parse unknown geometry type '${I}'`))};a.convertFromMultipoint=k;a.convertFromMultipointFeatures=G;a.convertFromNestedArray=
Z;a.convertFromPoint=N;a.convertFromPointFeatures=F;a.convertFromPolygon=W;a.convertFromPolyline=U;a.convertFromPolylineFeatures=H;a.convertToFeature=function(I,O,P,X){ba[0]=I;na(Y,ba,O,P,X);I=Y[0];Da(Y);Da(ba);return I};a.convertToFeatureSet=function(I){const {objectIdFieldName:O,spatialReference:P,transform:X,fields:aa,hasM:ca,hasZ:fa,features:la,geometryType:ma,exceededTransferLimit:ua,uniqueIdField:pa,queryGeometry:sa,queryGeometryType:Ca}=I;I=na([],la,ma,fa,ca);const xa=ia(sa,Ca,!1,!1);I={features:I,
fields:aa,geometryType:ma,objectIdFieldName:O,spatialReference:P,uniqueIdField:pa,queryGeometry:xa};X&&(I.transform=X);ua&&(I.exceededTransferLimit=ua);ca&&(I.hasM=ca);fa&&(I.hasZ=fa);return I};a.convertToFeatures=na;a.convertToGeometry=ia;a.convertToMultipoint=y;a.convertToMultipointFeatures=T;a.convertToPoint=function(I,O,P){return I?O?P?J(I):p(I):P?M(I):b(I):null};a.convertToPolygon=Q;a.convertToPolyline=l;a.generalizeOptimizedGeometry=function(I,O,P,X,aa,ca,fa=P,la=X){Ea(I);if(!O?.coords.length)return null;
aa=Sa[aa];const {coords:ma,lengths:ua}=O;O=A(P,X);const pa=A(P&&fa,X&&la);P=x(P,X,fa,la);if(!ua.length)return P(I.coords,ma,0,0,ma[0],ma[1]),Ea(I,O,0),I;X=0;ca*=ca;for(const sa of ua){if(sa<aa){X+=sa*O;continue}fa=I.coords.length/pa;la=X;const Ca=X+(sa-1)*O;P(I.coords,ma,I.coords.length,la,ma[la],ma[la+1]);va(I.coords,ma,O,ca,P,la,Ca);P(I.coords,ma,I.coords.length,Ca,ma[Ca],ma[Ca+1]);la=I.coords.length/pa-fa;la>=aa?I.lengths.push(la):Da(I.coords,fa*pa);X+=sa*O}return I.coords.length?I:null};a.getBoundsOptimizedGeometry=
function(I,O,P,X){if(!O?.coords?.length)return null;P=A(P,X);let aa=X=Number.POSITIVE_INFINITY,ca=Number.NEGATIVE_INFINITY,fa=Number.NEGATIVE_INFINITY;if(O&&O.coords){O=O.coords;for(let la=0;la<O.length;la+=P){const ma=O[la],ua=O[la+1];X=Math.min(X,ma);ca=Math.max(ca,ma);aa=Math.min(aa,ua);fa=Math.max(fa,ua)}}C.is(I)?C.fromRectValues(I,X,aa,ca,fa):z.fromValues(X,aa,ca,fa,I);return I};a.getQuantizedArea=function(I,O){const {coords:P,lengths:X}=I;let aa=I=0;for(let ca=0;ca<X.length;ca++){const fa=X[ca];
aa+=wa(P,I,fa,O);I+=fa}return Math.abs(aa)};a.getQuantizedBoundsOptimizedGeometry=function(I,O,P,X){P=A(P,X);const {lengths:aa,coords:ca}=O;X=O=Number.POSITIVE_INFINITY;let fa=Number.NEGATIVE_INFINITY,la=Number.NEGATIVE_INFINITY,ma=0;for(const ua of aa){let pa=ca[ma],sa=ca[ma+1];O=Math.min(pa,O);X=Math.min(sa,X);fa=Math.max(pa,fa);la=Math.max(sa,la);ma+=P;for(let Ca=1;Ca<ua;Ca++,ma+=P){const xa=ca[ma],Ba=ca[ma+1];pa+=xa;sa+=Ba;0>xa&&(O=Math.min(O,pa));0<xa&&(fa=Math.max(fa,pa));0>Ba?X=Math.min(X,
sa):0<Ba&&(la=Math.max(la,sa))}}I[0]=O;I[1]=X;I[2]=fa;I[3]=la;return I};a.getSignedQuantizedRingArea=wa;a.quantizeOptimizedFeatureSet=function(I,O){const {geometryType:P,features:X,hasM:aa,hasZ:ca}=O;if(!I)return O;for(let fa=0;fa<X.length;fa++){const la=X[fa],ma=la.weakClone();ma.geometry=new u;qa(ma.geometry,la.geometry,aa,ca,P,I);la.centroid&&(ma.centroid=new u,qa(ma.centroid,la.centroid,aa,ca,"esriGeometryPoint",I));X[fa]=ma}O.transform=I;return O};a.quantizeOptimizedGeometry=qa;a.quantizeX=E;
a.quantizeY=m;a.removeCollinearVertices=function(I,O,P,X,aa){if(!O?.coords?.length)return null;P=Sa[P];const {coords:ca,lengths:fa}=O;O=x(X,aa,X,aa);X=A(X,aa);let la=aa=0,ma=0,ua=0;for(const Ca of fa){la=ua;O(I.coords,ca,la,aa,ca[aa],ca[aa+1]);aa+=X;var pa=ca[aa];let xa=ca[aa+1],Ba=pa,Aa=xa;var sa=xa/pa;la+=X;O(I.coords,ca,la,aa,Ba,Aa);aa+=X;for(let ya=2;ya<Ca;ya++){pa=ca[aa];xa=ca[aa+1];const Ia=xa/pa,Qa=sa===Ia||!isFinite(sa)&&!isFinite(Ia);sa=Qa&&isFinite(Ia)?0<=sa&&0<=Ia||0>=sa&&0>=Ia:0<=Aa&&
0<=xa||0>=Aa&&0>=xa;Qa&&sa?(Ba+=pa,Aa+=xa):(Ba=pa,Aa=xa,la+=X);O(I.coords,ca,la,aa,Ba,Aa);aa+=X;sa=Ia}la+=X;pa=(la-ua)/X;pa>=P&&(I.lengths[ma]=pa,ua=la,ma++)}I.coords.length>ua&&(I.coords.length=ua);I.lengths.length>ma&&(I.lengths.length=ma);return I.coords.length&&I.lengths.length?I:null};a.removeZMValues=function(I,O,P,X,aa,ca){Ea(I);I.lengths.push(...O.lengths);if(P===aa&&X===ca)for(var fa=0;fa<O.coords.length;fa++)I.coords.push(O.coords[fa]);else for(fa=A(P,X),P=x(P,X,aa,ca),O=O.coords,X=0;X<
O.length;X+=fa)P(I.coords,O,I.coords.length,X,O[X],O[X+1]);return I};a.unquantizeOptimizedFeatureSet=function(I){const {transform:O,features:P,hasM:X,hasZ:aa}=I;if(!O)return I;for(const ca of P)null!=ca.geometry&&ta(ca.geometry,ca.geometry,X,aa,O),null!=ca.centroid&&ta(ca.centroid,ca.centroid,X,aa,O);I.transform=null;return I};a.unquantizeOptimizedGeometry=ta;a.unquantizeValue=h;a.unquantizeX=function(I,O){return h(I,O,0)};a.unquantizeY=function(I,O){return h(I,-O,1)};Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/layers/graphics/OptimizedFeature":function(){define(["exports","./OptimizedGeometry"],function(a,c){class w{constructor(C=null,z={},e,r){this.geometry=C;this.attributes=z;this.centroid=e;this.objectId=r;this.geohashY=this.geohashX=this.displayId=0}static fromJSON(C,z){const e=C.geometry?c.fromJSON(C.geometry):null,r=C.centroid?c.fromJSON(C.centroid):null;return new w(e,C.attributes,r,C.attributes[z])}weakClone(){const C=new w(this.geometry,this.attributes,this.centroid,
this.objectId);C.displayId=this.displayId;C.geohashX=this.geohashX;C.geohashY=this.geohashY;return C}clone(){var C=this.geometry?.clone();C=new w(C,{...this.attributes},this.centroid?.clone(),this.objectId);C.displayId=this.displayId;C.geohashX=this.geohashX;C.geohashY=this.geohashY;return C}}class v extends w{}a.OptimizedFeature=w;a.OptimizedFeatureWithGeometry=v;a.hasGeometry=function(C){return!!C.geometry?.coords?.length};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/OptimizedGeometry":function(){define(function(){class a{constructor(c=
[],w=[],v=!1){this.lengths=c??[];this.coords=w??[];this.hasIndeterminateRingOrder=v}static fromJSON(c){return new a(c.lengths,c.coords,c.hasIndeterminateRingOrder)}static fromRect(c){const [w,v,C,z]=c;c=C-w;const e=z-v;return new a([5],[w,v,c,0,0,e,-c,0,0,-e])}get isPoint(){return 0===this.lengths.length}get maxLength(){return Math.max(...this.lengths)}get size(){return this.lengths.reduce((c,w)=>c+w)}forEachVertex(c){let w=0;this.lengths.length||c(this.coords[0],this.coords[1]);for(let v=0;v<this.lengths.length;v++){const C=
this.lengths[v];for(let z=0;z<C;z++)c(this.coords[2*(z+w)],this.coords[2*(z+w)+1]);w+=C}}deltaDecode(){const c=this.clone(),{coords:w,lengths:v}=c;let C=0;for(const z of v){for(let e=1;e<z;e++)w[2*(C+e)]+=w[2*(C+e)-2],w[2*(C+e)+1]+=w[2*(C+e)-1];C+=z}return c}clone(c){if(0===this.lengths.length)return new a([],[this.coords[0],this.coords[1]]);var w=2*(0===this.lengths.length?1:this.lengths.reduce((v,C)=>v+C));w=this.coords.slice(0,w);return c?(c.set(w),new a(this.lengths,c,this.hasIndeterminateRingOrder)):
new a(Array.from(this.lengths),Array.from(w),this.hasIndeterminateRingOrder)}}return a})},"esri/layers/graphics/OptimizedFeatureSet":function(){define(function(){class a{constructor(){this.spatialReference=this.geometryType=this.geometryProperties=this.geohashFieldName=this.globalIdFieldName=this.objectIdFieldName=null;this.hasM=this.hasZ=!1;this.features=[];this.fields=[];this.transform=null;this.exceededTransferLimit=!1;this.queryGeometry=this.queryGeometryType=this.uniqueIdField=null}weakClone(){const c=
new a;c.objectIdFieldName=this.objectIdFieldName;c.globalIdFieldName=this.globalIdFieldName;c.geohashFieldName=this.geohashFieldName;c.geometryProperties=this.geometryProperties;c.geometryType=this.geometryType;c.spatialReference=this.spatialReference;c.hasZ=this.hasZ;c.hasM=this.hasM;c.features=this.features;c.fields=this.fields;c.transform=this.transform;c.exceededTransferLimit=this.exceededTransferLimit;c.uniqueIdField=this.uniqueIdField;c.queryGeometry=this.queryGeometry;c.queryGeometryType=this.queryGeometryType;
return c}}return a})},"esri/layers/graphics/data/BoundsStore":function(){define(["exports","../../../core/has","../../../core/libs/rbush/PooledRBush","../../../geometry/support/aaBoundingRect"],function(a,c,w,v){function C(r,d,u){z.minX=d[0];z.minY=d[1];z.maxX=d[2];z.maxY=d[3];r.search(z,u)}const z={minX:0,minY:0,maxX:0,maxY:0};class e{constructor(){this._indexInvalid=!1;this._boundsToLoad=[];this._boundsById=new Map;this._idByBounds=new Map;this._index=new w.PooledRBush(9,c("esri-csp-restrictions")?
r=>({minX:r[0],minY:r[1],maxX:r[2],maxY:r[3]}):["[0]","[1]","[2]","[3]"]);this._loadIndex=()=>{if(this._indexInvalid){const r=Array(this._idByBounds.size);let d=0;this._idByBounds.forEach((u,A)=>{r[d++]=A});this._indexInvalid=!1;this._index.clear();this._index.load(r)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter(r=>this._idByBounds.has(r))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const r=v.empty();for(const d of this._boundsById.values())d&&
(r[0]=Math.min(d[0],r[0]),r[1]=Math.min(d[1],r[1]),r[2]=Math.max(d[2],r[2]),r[3]=Math.max(d[3],r[3]));return r}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1;this._boundsToLoad.length=0;this._boundsById.clear();this._idByBounds.clear();this._index.clear()}delete(r){const d=this._boundsById.get(r);this._boundsById.delete(r);d&&(this._idByBounds.delete(d),this._indexInvalid||this._index.remove(d))}forEachInBounds(r,d){this._loadIndex();C(this._index,r,u=>d(this._idByBounds.get(u)))}get(r){return this._boundsById.get(r)}has(r){return this._boundsById.has(r)}invalidateIndex(){this._indexInvalid||
(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(r,d){if(!this._indexInvalid){const u=this._boundsById.get(r);u&&(this._index.remove(u),this._idByBounds.delete(u))}this._boundsById.set(r,d);d&&(this._idByBounds.set(d,r),this._indexInvalid||(this._boundsToLoad.push(d),5E4<this._boundsToLoad.length&&this._loadIndex()))}}a.BoundsStore=e;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/rbush/PooledRBush":function(){define(["exports","../../arrayUtils","../../has",
"../../PooledArray","../../../chunks/quickselect"],function(a,c,w,v,C){function z(N,T){for(D.clear();N;){if(!0===N.leaf)for(const y of N.children)T(y);else D.pushArray(N.children);N=D.pop()??null}}function e(N,T){r(N,0,N.children.length,T,N)}function r(N,T,y,G,k){k||=new B([]);k.minX=Infinity;k.minY=Infinity;k.maxX=-Infinity;k.maxY=-Infinity;for(let l=T,H;l<y;l++)H=N.children[l],d(k,N.leaf?G(H):H);return k}function d(N,T){N.minX=Math.min(N.minX,T.minX);N.minY=Math.min(N.minY,T.minY);N.maxX=Math.max(N.maxX,
T.maxX);N.maxY=Math.max(N.maxY,T.maxY)}function u(N,T){return N.minX-T.minX}function A(N,T){return N.minY-T.minY}function x(N){return(N.maxX-N.minX)*(N.maxY-N.minY)}function E(N){return N.maxX-N.minX+(N.maxY-N.minY)}function m(N,T){return N.minX<=T.minX&&N.minY<=T.minY&&T.maxX<=N.maxX&&T.maxY<=N.maxY}function h(N,T){return T.minX<=N.maxX&&T.minY<=N.maxY&&T.maxX>=N.minX&&T.maxY>=N.minY}function b(N,T,y,G,k){for(T=[T,y];T.length;){y=T.pop();const l=T.pop();if(y-l<=G)continue;const H=l+Math.ceil((y-
l)/G/2)*G;C.quickselect(N,H,l,y,k);T.push(l,H,H,y)}}class n{constructor(N=9,T){this._compareMinX=u;this._compareMinY=A;this._toBBox=y=>y;this._maxEntries=Math.max(4,N||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));T&&("function"===typeof T?this._toBBox=T:this._initFormat(T));this.clear()}destroy(){this.clear();p.prune();D.prune();M.prune();g.prune()}all(N){z(this._data,N)}search(N,T){let y=this._data;const G=this._toBBox;if(h(N,y))for(p.clear();y;){for(let k=0,l=y.children.length;k<
l;k++){const H=y.children[k],U=y.leaf?G(H):H;h(N,U)&&(y.leaf?T(H):m(N,U)?z(H,T):p.push(H))}y=p.pop()}}collides(N){let T=this._data;const y=this._toBBox;if(!h(N,T))return!1;for(p.clear();T;){for(let G=0,k=T.children.length;G<k;G++){const l=T.children[G],H=T.leaf?y(l):l;if(h(N,H)){if(T.leaf||m(N,H))return!0;p.push(l)}}T=p.pop()}return!1}load(N){if(!N.length)return this;if(N.length<this._minEntries){for(let T=0,y=N.length;T<y;T++)this.insert(N[T]);return this}N=this._build(N.slice(0,N.length),0,N.length-
1,0);if(this._data.children.length)if(this._data.height===N.height)this._splitRoot(this._data,N);else{if(this._data.height<N.height){const T=this._data;this._data=N;N=T}this._insert(N,this._data.height-N.height-1,!0)}else this._data=N;return this}insert(N){N&&this._insert(N,this._data.height-1);return this}clear(){this._data=new B([]);return this}remove(N){if(!N)return this;let T=this._data,y=null,G=0,k=!1,l;const H=this._toBBox(N);M.clear();for(g.clear();T||0<M.length;){T||(T=M.pop(),y=M.data[M.length-
1],G=g.pop()??0,k=!0);if(T.leaf&&(l=c.indexOf(T.children,N,T.children.length,T.indexHint),-1!==l)){T.children.splice(l,1);M.push(T);this._condense(M);break}k||T.leaf||!m(T,H)?y?(G++,T=y.children[G],k=!1):T=null:(M.push(T),g.push(G),G=0,y=T,T=T.children[0])}return this}toJSON(){return this._data}fromJSON(N){this._data=N;return this}_build(N,T,y,G){var k=y-T+1,l=this._maxEntries;if(k<=l)return N=new B(N.slice(T,y+1)),e(N,this._toBBox),N;G||(G=Math.ceil(Math.log(k)/Math.log(l)),l=Math.ceil(k/l**(G-1)));
const H=new F([]);H.height=G;k=Math.ceil(k/l);l=k*Math.ceil(Math.sqrt(l));for(b(N,T,y,l,this._compareMinX);T<=y;T+=l){const U=Math.min(T+l-1,y);b(N,T,U,k,this._compareMinY);for(let Q=T;Q<=U;Q+=k)H.children.push(this._build(N,Q,Math.min(Q+k-1,U),G-1))}e(H,this._toBBox);return H}_insert(N,T,y){var G=this._toBBox;y=y?N:G(N);M.clear();G=this._data;for(var k=T,l=M;;){l.push(G);if(!0===G.leaf||l.length-1===k)break;let H=Infinity,U=Infinity,Q=void 0;for(let W=0,Z=G.children.length;W<Z;W++){const ea=G.children[W],
ia=x(ea),na=(Math.max(ea.maxX,y.maxX)-Math.min(ea.minX,y.minX))*(Math.max(ea.maxY,y.maxY)-Math.min(ea.minY,y.minY))-ia;na<U?(U=na,H=ia<H?ia:H,Q=ea):na===U&&ia<H&&(H=ia,Q=ea)}G=Q||G.children[0]}G.children.push(N);for(d(G,y);0<=T;)if(M.data[T].children.length>this._maxEntries)this._split(M,T),T--;else break;for(N=M;0<=T;T--)d(N.data[T],y)}_split(N,T){const y=N.data[T];var G=y.children.length;const k=this._minEntries;this._chooseSplitAxis(y,k,G);if(G=this._chooseSplitIndex(y,k,G))G=y.children.splice(G,
y.children.length-G),G=y.leaf?new B(G):new F(G),G.height=y.height,e(y,this._toBBox),e(G,this._toBBox),T?N.data[T-1].children.push(G):this._splitRoot(y,G)}_splitRoot(N,T){this._data=new F([N,T]);this._data.height=N.height+1;e(this._data,this._toBBox)}_chooseSplitIndex(N,T,y){let G,k,l=void 0;G=k=Infinity;for(let U=T;U<=y-T;U++){var H=r(N,0,U,this._toBBox);const Q=r(N,U,y,this._toBBox),W=Math.max(0,Math.min(H.maxX,Q.maxX)-Math.max(H.minX,Q.minX))*Math.max(0,Math.min(H.maxY,Q.maxY)-Math.max(H.minY,Q.minY));
H=x(H)+x(Q);W<G?(G=W,l=U,k=H<k?H:k):W===G&&H<k&&(k=H,l=U)}return l}_chooseSplitAxis(N,T,y){const G=N.leaf?this._compareMinX:u,k=N.leaf?this._compareMinY:A,l=this._allDistMargin(N,T,y,G);T=this._allDistMargin(N,T,y,k);l<T&&N.children.sort(G)}_allDistMargin(N,T,y,G){N.children.sort(G);G=this._toBBox;var k=r(N,0,T,G);const l=r(N,y-T,y,G);let H=E(k)+E(l);for(let U=T;U<y-T;U++){const Q=N.children[U];d(k,N.leaf?G(Q):Q);H+=E(k)}for(y=y-T-1;y>=T;y--)k=N.children[y],d(l,N.leaf?G(k):k),H+=E(l);return H}_condense(N){for(let T=
N.length-1;0<=T;T--){const y=N.data[T];if(0===y.children.length)if(0<T){const G=N.data[T-1],k=G.children;k.splice(c.indexOf(k,y,k.length,G.indexHint),1)}else this.clear();else e(y,this._toBBox)}}_initFormat(N){const T=["return a"," - b",";"];this._compareMinX=new Function("a","b",T.join(N[0]));this._compareMinY=new Function("a","b",T.join(N[1]));this._toBBox=new Function("a","return {minX: a"+N[0]+", minY: a"+N[1]+", maxX: a"+N[2]+", maxY: a"+N[3]+"};")}}const p=new v,D=new v,M=new v,g=new v({deallocator:void 0});
class J{constructor(){this.minY=this.minX=Infinity;this.maxY=this.maxX=-Infinity}}class R extends J{constructor(){super(...arguments);this.height=1;this.indexHint=new c.PositionHint}}class B extends R{constructor(N){super();this.children=N;this.leaf=!0}}class F extends R{constructor(N){super();this.children=N;this.leaf=!1}}a.BBox=J;a.PooledRBush=n;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/quickselect":function(){define(["exports","./_commonjsHelpers"],function(a,
c){var w={exports:{}};(function(v){(function(C){C=C();void 0!==C&&(v.exports=C)})(function(){function C(r,d,u,A,x){for(;A>u;){if(600<A-u){var E=A-u+1,m=d-u+1,h=Math.log(E),b=.5*Math.exp(2*h/3);h=.5*Math.sqrt(h*b*(E-b)/E)*(0>m-E/2?-1:1);C(r,d,Math.max(u,Math.floor(d-m*b/E+h)),Math.min(A,Math.floor(d+(E-m)*b/E+h)),x)}E=r[d];m=u;b=A;z(r,u,d);for(0<x(r[A],E)&&z(r,u,A);m<b;){z(r,m,b);m++;for(b--;0>x(r[m],E);)m++;for(;0<x(r[b],E);)b--}0===x(r[u],E)?z(r,u,b):(b++,z(r,b,A));b<=d&&(u=b+1);d<=b&&(A=b-1)}}function z(r,
d,u){var A=r[d];r[d]=r[u];r[u]=A}function e(r,d){return r<d?-1:r>d?1:0}return function(r,d,u,A,x){C(r,d,u||0,A||r.length-1,x||e)}})})(w);c=c.getDefaultExportFromCjs(w.exports);a.quickselect=c})},"esri/layers/graphics/data/geometryUtils":function(){define(["exports","../featureConversionUtils","../OptimizedGeometry"],function(a,c,w){const v=new w,C=new w,z=new w,e={esriGeometryPoint:c.convertToPoint,esriGeometryPolyline:c.convertToPolyline,esriGeometryPolygon:c.convertToPolygon,esriGeometryMultipoint:c.convertToMultipoint},
r=(d,u)=>"_geVersion"!==d?u:void 0;a.cleanFromGeometryEngine=function(d){return d&&"_geVersion"in d?JSON.parse(JSON.stringify(d,r)):d};a.getGeometry=function(d,u,A,x,E,m,h=u,b=A){const n=u&&h,p=A&&b;x=null!=x?"coords"in x?x:x.geometry:null;if(null==x)return null;if(E)return u=c.generalizeOptimizedGeometry(C,x,u,A,d,E,h,b),m&&(u=c.quantizeOptimizedGeometry(z,u,n,p,d,m)),e[d]?.(u,n,p)??null;if(m)return m=c.quantizeOptimizedGeometry(z,x,u,A,d,m,h,b),e[d]?.(m,n,p)??null;c.removeZMValues(v,x,u,A,h,b);
return e[d]?.(v,n,p)??null};a.transformCentroid=function(d,u,A,x=d.hasZ,E=d.hasM){if(null==u)return null;const m=d.hasZ&&x,h=d.hasM&&E;return A?(d=c.quantizeOptimizedGeometry(z,u,d.hasZ,d.hasM,"esriGeometryPoint",A,x,E),c.convertToPoint(d,m,h)):c.convertToPoint(u,m,h)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/optimizedFeatureQueryEngineAdapter":function(){define(["exports","../centroid","../OptimizedFeature","../OptimizedGeometry"],function(a,c,w,
v){a.optimizedFeatureQueryEngineAdapter={getObjectId(C){return C.objectId},getAttributes(C){return C.attributes},getAttribute(C,z){return C.attributes[z]},cloneWithGeometry(C,z){return new w.OptimizedFeature(z,C.attributes,null,C.objectId)},getGeometry(C){return C.geometry},getCentroid(C,z){null==C.centroid&&(C.centroid=c.getCentroidOptimizedGeometry(new v,C.geometry,z.hasZ,z.hasM));return C.centroid}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/centroid":function(){define(["exports"],
function(a){function c(v,C,z,e,r,d){d=r?d?4:3:d?3:2;let u=z,A=z+d,x=0,E=0,m=z=0,h=0;for(let b=0,n=e-1;b<n;b++,u+=d,A+=d){e=C[u];const p=C[u+1],D=C[u+2],M=C[A],g=C[A+1],J=C[A+2];let R=e*g-M*p;m+=R;x+=(e+M)*R;E+=(p+g)*R;r&&(R=e*J-M*D,z+=(D+J)*R,h+=R);e<v[0]&&(v[0]=e);e>v[1]&&(v[1]=e);p<v[2]&&(v[2]=p);p>v[3]&&(v[3]=p);r&&(D<v[4]&&(v[4]=D),D>v[5]&&(v[5]=D))}0<m&&(m*=-1);0<h&&(h*=-1);if(!m)return null;v=[x,E,.5*m];r&&(v[3]=z,v[4]=.5*h);return v}function w(v,C,z,e,r){r=e?r?4:3:r?3:2;let d=C,u=C+r,A=0,x=
0,E=0,m=0;for(let p=0,D=z-1;p<D;p++,d+=r,u+=r){var h=v[d];const M=v[d+1],g=v[d+2],J=v[u],R=v[u+1],B=v[u+2];if(e){var b=J-h;var n=R-M;const F=B-g;b=Math.sqrt(b*b+n*n+F*F)}else b=J-h,n=R-M,b=Math.sqrt(b*b+n*n);b&&(A+=b,e?(h=[h+.5*(J-h),M+.5*(R-M),g+.5*(B-g)],x+=b*h[0],E+=b*h[1],m+=b*h[2]):(h=[h+.5*(J-h),M+.5*(R-M)],x+=b*h[0],E+=b*h[1]))}return 0<A?e?[x/A,E/A,m/A]:[x/A,E/A]:0<z?e?[v[C],v[C+1],v[C+2]]:[v[C],v[C+1]]:null}a.getCentroidOptimizedGeometry=function(v,C,z,e){if(!C?.lengths.length)return null;
v.lengths.length&&(v.lengths.length=0);v.coords.length&&(v.coords.length=0);const r=v.coords,d=[],u=z?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:A,coords:x}=C;var E=z?e?4:3:e?3:2;let m=0;for(const h of A){const b=c(u,x,m,h,z,e);b&&d.push(b);m+=h*E}d.sort((h,b)=>{let n=h[2]-b[2];0===
n&&z&&(n=h[4]-b[4]);return n});d.length&&(E=6*d[0][2],r[0]=d[0][0]/E,r[1]=d[0][1]/E,z&&(E=6*d[0][4],r[2]=0!==E?d[0][3]/E:0),r[0]<u[0]||r[0]>u[1]||r[1]<u[2]||r[1]>u[3]||z&&(r[2]<u[4]||r[2]>u[5]))&&(r.length=0);if(!r.length)if(C=C.lengths[0]?w(x,0,A[0],z,e):null)r[0]=C[0],r[1]=C[1],z&&2<C.length&&(r[2]=C[2]);else return null;return v};a.lineCentroid=w;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngine":function(){define("exports ../../../core/arrayUtils ../../../core/Error ../../../core/JSONSupport ../../../core/lang ../../../core/maybe ../../../core/MemCache ../../../core/promiseUtils ../../../core/unitUtils ../../../geometry/projection ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./attributeSupport ./geometryUtils ./projectionSupport ./QueryEngineCapabilities ./QueryEngineResult ./queryUtils ./queryValidationUtils ./spatialQuerySupport ./timeSupport ../../support/FieldsIndex ../../../views/support/Scheduler".split(" "),
function(a,c,w,v,C,z,e,r,d,u,A,x,E,m,h,b,n,p,D,M,g,J,R,B,F,N,T,y){function G(Q){if(F.canQueryWithRBush(Q)){if(m.isExtent(Q))return[x.fromValues(Math.min(Q.xmin,Q.xmax),Math.min(Q.ymin,Q.ymax),Math.max(Q.xmin,Q.xmax),Math.max(Q.ymin,Q.ymax))];if(m.isPolygon(Q))return Q.rings.map(W=>x.fromValues(Math.min(W[0][0],W[2][0]),Math.min(W[0][1],W[2][1]),Math.max(W[0][0],W[2][0]),Math.max(W[0][1],W[2][1])))}return[E.getBoundsXY(x.create(),Q)]}class k{constructor(Q,W=null,Z,ea,ia){this.attributes=Q;this.geometry=
Z;this.centroid=ea;this.filterFlags=ia;this.groupId=-1;this.displayId=W}}const l=new e.MemCacheStorage(2E6);let H=0;class U{constructor(Q){this._changeHandle=this._geometryQueryCache=null;this.capabilities={query:g.queryCapabilities};this.geometryType=Q.geometryType;this.hasM=!!Q.hasM;this.hasZ=!!Q.hasZ;this.objectIdField=Q.objectIdField;this.spatialReference=Q.spatialReference;this.definitionExpression=Q.definitionExpression;this.featureStore=Q.featureStore;this.aggregateAdapter=Q.aggregateAdapter;
this._changeHandle=this.featureStore.events.on("changed",()=>this.clearCache());this.timeInfo=Q.timeInfo;Q.cacheSpatialQueries&&(this._geometryQueryCache=new e.MemCache(H++ +"$$",l));this.fieldsIndex=v.isSerializable(Q.fieldsIndex)?Q.fieldsIndex:T.fromJSON(Q.fieldsIndex);this.availableFields=!Q.availableFields||1===Q.availableFields.length&&"*"===Q.availableFields[0]?new Set(this.fieldsIndex.fields.map(W=>W.name)):new Set(Q.availableFields.map(W=>this.fieldsIndex.get(W)?.name).filter(W=>null!=W));
Q.scheduler&&Q.priority&&(this._frameTask=Q.scheduler.registerTask(Q.priority))}destroy(){this._frameTask=z.removeMaybe(this._frameTask);this.clearCache();z.destroyMaybe(this._geometryQueryCache);this._changeHandle=z.removeMaybe(this._changeHandle)}get featureAdapter(){return this.featureStore.featureAdapter}clearCache(){this._geometryQueryCache?.clear();this._fullExtentPromise=this._timeExtentPromise=this._allFeaturesPromise=null}async executeQuery(Q,W){W=r.signalFromSignalOrOptions(W);try{return(await this._executeQuery(Q,
{},W)).createQueryResponse()}catch(Z){if(Z!==R.queryEngineEmptyResult)throw Z;return(new J.QueryEngineResult([],Q,this)).createQueryResponse()}}async executeQueryForCount(Q={},W){W=r.signalFromSignalOrOptions(W);try{return(await this._executeQuery(Q,{returnGeometry:!1,returnCentroid:!1,outSR:null},W)).createQueryResponseForCount()}catch(Z){if(Z!==R.queryEngineEmptyResult)throw Z;return 0}}async executeQueryForExtent(Q,W){W=r.signalFromSignalOrOptions(W);const Z=Q.outSR;try{const ea=await this._executeQuery(Q,
{returnGeometry:!0,returnCentroid:!1,outSR:null},W),ia=ea.size;if(!ia)return{count:0,extent:null};const na=await this._getBounds(ea.items,ea.spatialReference,Z||this.spatialReference);return{count:ia,extent:na}}catch(ea){if(ea===R.queryEngineEmptyResult)return{count:0,extent:null};throw ea;}}async executeQueryForIds(Q,W){return this.executeQueryForIdSet(Q,W).then(Z=>Array.from(Z))}async executeQueryForIdSet(Q,W){W=r.signalFromSignalOrOptions(W);try{const Z=await this._executeQuery(Q,{returnGeometry:!0,
returnCentroid:!1,outSR:null},W),ea=Z.items,ia=new Set;await this._reschedule(()=>{for(const na of ea)ia.add(Z.featureAdapter.getObjectId(na))},W);return ia}catch(Z){if(Z===R.queryEngineEmptyResult)return new Set;throw Z;}}async executeQueryForSnapping(Q,W){const Z=r.signalFromSignalOrOptions(W),{point:ea,distance:ia,returnEdge:na,vertexMode:qa}=Q;if(!na&&"none"===qa)return{candidates:[]};let va=C.clone(Q.query);va=await this._schedule(()=>R.normalizeQueryLike(va,this.definitionExpression,this.spatialReference),
Z);va=await this._reschedule(()=>B.validateQuery(va,{availableFields:this.availableFields,fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference}),Z);(W=!b.equals(ea.spatialReference,this.spatialReference))&&await M.checkProjectionSupport(ea.spatialReference,this.spatialReference);var ta="number"===typeof ia?ia:ia.x,wa="number"===typeof ia?ia:ia.y;ta={xmin:ea.x-ta,xmax:ea.x+ta,ymin:ea.y-wa,ymax:ea.y+wa,spatialReference:ea.spatialReference};ta=W?M.project(ta,
this.spatialReference):ta;if(!ta)return{candidates:[]};wa=(await h.normalizeCentralMeridian(m.fromJSON(ea),null,{signal:Z}))[0];const Ea=(await h.normalizeCentralMeridian(m.fromJSON(ta),null,{signal:Z}))[0];if(null==wa||null==Ea)return{candidates:[]};const Da=new J.QueryEngineResult(await this._reschedule(()=>this._searchFeatures(G(Ea.toJSON())),Z),va,this);await this._reschedule(()=>this._executeObjectIdsQuery(Da),Z);await this._reschedule(()=>this._executeTimeQuery(Da),Z);await this._reschedule(()=>
this._executeAttributesQuery(Da),Z);await this._reschedule(()=>this._executeGeometryQueryForSnapping(Da,Z),Z);wa=wa.toJSON();wa=W?M.project(wa,this.spatialReference):wa;return Da.createSnappingResponse({...Q,point:wa,distance:W?Math.max(ta.xmax-ta.xmin,ta.ymax-ta.ymin)/2:ia},ea.spatialReference)}async executeQueryForLatestObservations(Q,W){W=r.signalFromSignalOrOptions(W);if(!this.timeInfo?.trackIdField)throw new w("unsupported-query","Missing timeInfo or timeInfo.trackIdField",{query:Q,timeInfo:this.timeInfo});
try{const Z=await this._executeQuery(Q,{},W);await this._reschedule(()=>this._filterLatest(Z),W);return Z.createQueryResponse()}catch(Z){if(Z!==R.queryEngineEmptyResult)throw Z;return(new J.QueryEngineResult([],Q,this)).createQueryResponse()}}async executeQueryForSummaryStatistics(Q={},W,Z){Z=r.signalFromSignalOrOptions(Z);const {field:ea,normalizationField:ia,valueExpression:na}=W;return(await this._executeQueryForStatistics(Q,{field:ea,normalizationField:ia,valueExpression:na},Z)).createSummaryStatisticsResponse(W)}async executeQueryForUniqueValues(Q=
{},W,Z){Z=r.signalFromSignalOrOptions(Z);const {field:ea,field2:ia,field3:na,valueExpression:qa}=W;return(await this._executeQueryForStatistics(Q,{field:ea,field2:ia,field3:na,valueExpression:qa},Z)).createUniqueValuesResponse(W)}async executeQueryForClassBreaks(Q={},W,Z){Z=r.signalFromSignalOrOptions(Z);const {field:ea,normalizationField:ia,valueExpression:na}=W;return(await this._executeQueryForStatistics(Q,{field:ea,normalizationField:ia,valueExpression:na},Z)).createClassBreaksResponse(W)}async executeQueryForHistogram(Q=
{},W,Z){Z=r.signalFromSignalOrOptions(Z);const {field:ea,normalizationField:ia,valueExpression:na}=W;return(await this._executeQueryForStatistics(Q,{field:ea,normalizationField:ia,valueExpression:na},Z)).createHistogramResponse(W)}async fetchRecomputedExtents(Q){Q=r.signalFromSignalOrOptions(Q);this._timeExtentPromise||(this._timeExtentPromise=N.getTimeExtent(this.timeInfo,this.featureStore));const [W,Z]=await Promise.all([this._getFullExtent(),this._timeExtentPromise]);r.throwIfAborted(Q);return{fullExtent:W,
timeExtent:Z}}async _getBounds(Q,W,Z){const ea=A.set(A.create(),A.negativeInfinity);await this.featureStore.forEachBounds(Q,ia=>A.expandWithAABB(ea,ia));Q={xmin:ea[0],ymin:ea[1],xmax:ea[3],ymax:ea[4],spatialReference:D.cleanFromGeometryEngine(this.spatialReference)};this.hasZ&&isFinite(ea[2])&&isFinite(ea[5])&&(Q.zmin=ea[2],Q.zmax=ea[5],Q.hasZ=!0);W=M.project(Q,W,Z);W.spatialReference=D.cleanFromGeometryEngine(Z);0===W.xmax-W.xmin&&(Z=d.getMetersPerUnitForSR(W.spatialReference),W.xmin-=Z,W.xmax+=
Z);0===W.ymax-W.ymin&&(Z=d.getMetersPerUnitForSR(W.spatialReference),W.ymin-=Z,W.ymax+=Z);this.hasZ&&null!=W.zmin&&null!=W.zmax&&0===W.zmax-W.zmin&&(Z=d.getMetersPerUnitForSR(W.spatialReference),W.zmin-=Z,W.zmax+=Z);return W}_getFullExtent(){this._fullExtentPromise||(this._fullExtentPromise="getFullExtent"in this.featureStore&&this.featureStore.getFullExtent?Promise.resolve(this.featureStore.getFullExtent(this.spatialReference)):this._getAllFeatures().then(Q=>this._getBounds(Q,this.spatialReference,
this.spatialReference)));return this._fullExtentPromise}async _schedule(Q,W){return null!=this._frameTask?this._frameTask.schedule(Q,W):Q(y.noBudget)}async _reschedule(Q,W){return null!=this._frameTask?this._frameTask.reschedule(Q,W):Q(y.noBudget)}async _getAllFeaturesQueryEngineResult(Q){return new J.QueryEngineResult(await this._getAllFeatures(),Q,this)}async _getAllFeatures(){if(null==this._allFeaturesPromise){const Z=[];this._allFeaturesPromise=(async()=>{await this.featureStore.forEach(ea=>Z.push(ea))})().then(()=>
Z)}const Q=this._allFeaturesPromise,W=await Q;return Q===this._allFeaturesPromise?W.slice():this._getAllFeatures()}async _executeQuery(Q,W,Z){Q=C.clone(Q);Q=await this._schedule(()=>R.normalizeQuery(Q,this.definitionExpression,this.spatialReference),Z);Q=await this._reschedule(()=>B.validateQuery(Q,{availableFields:this.availableFields,fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference}),Z);Q={...Q,...W};const ea=await this._reschedule(()=>this._executeSceneFilterQuery(Q,
Z),Z),ia=await this._reschedule(()=>this._executeGeometryQuery(Q,ea,Z),Z);await this._reschedule(()=>this._executeAggregateIdsQuery(ia),Z);await this._reschedule(()=>this._executeObjectIdsQuery(ia),Z);await this._reschedule(()=>this._executeTimeQuery(ia),Z);await this._reschedule(()=>this._executeAttributesQuery(ia),Z);return ia}async _executeSceneFilterQuery(Q,W){if(null==Q.sceneFilter)return null;const {outSR:Z,returnGeometry:ea,returnCentroid:ia}=Q;var na=this.featureStore.featureSpatialReference,
qa=Q.sceneFilter.geometry;const va=null==na||b.equals(na,qa.spatialReference)?qa:M.project(qa,na);if(!va)return null;na=ea||ia;na=b.isValid(Z)&&!b.equals(this.spatialReference,Z)&&na?async Da=>this._project(Da,Z):Da=>Da;const ta=this.featureAdapter;qa=await this._reschedule(()=>this._searchFeatures(G(va)),W);if("disjoint"===Q.sceneFilter.spatialRelationship){if(!qa.length)return null;const Da=new Set;for(var wa of qa)Da.add(ta.getObjectId(wa));const Pa=await this._reschedule(()=>this._getAllFeatures(),
W);wa=await this._reschedule(async()=>{const Sa=await F.getSpatialQueryOperator("esriSpatialRelDisjoint",va,this.geometryType,this.hasZ,this.hasM),Ta=await this._runSpatialFilter(Pa,Oa=>!Da.has(ta.getObjectId(Oa))||Sa(ta.getGeometry(Oa)),W);return new J.QueryEngineResult(Ta,Q,this)},W);return na(wa)}if(!qa.length)return new J.QueryEngineResult([],Q,this);if(this._canExecuteSinglePass(va,Q))return na(new J.QueryEngineResult(qa,Q,this));const Ea=await F.getSpatialQueryOperator("esriSpatialRelContains",
va,this.geometryType,this.hasZ,this.hasM);wa=await this._runSpatialFilter(qa,Da=>Ea(ta.getGeometry(Da)),W);return na(new J.QueryEngineResult(wa,Q,this))}async _executeGeometryQuery(Q,W,Z){if(null!=W&&0===W.items.length)return W;Q=null!=W?W.query:Q;const {geometry:ea,outSR:ia,spatialRel:na,returnGeometry:qa,returnCentroid:va}=Q;var ta=this.featureStore.featureSpatialReference;const wa=!ea||null==ta||b.equals(ta,ea.spatialReference)?ea:M.project(ea,ta),Ea=qa||va,Da=b.isValid(ia)&&!b.equals(this.spatialReference,
ia),Pa=this._geometryQueryCache&&null==W?Da&&Ea?JSON.stringify({originalFilterGeometry:ea,spatialRelationship:na,outSpatialReference:ia}):JSON.stringify({originalFilterGeometry:ea,spatialRelationship:na}):null;ta=Pa?this._geometryQueryCache.get(Pa):null;if(null!=ta)return new J.QueryEngineResult(ta,Q,this);ta=async K=>{Da&&Ea&&await this._project(K,ia);Pa&&this._geometryQueryCache.put(Pa,K.items,K.items.length+1);return K};if(!wa)return ta(null!=W?W:await this._getAllFeaturesQueryEngineResult(Q));
const Sa=this.featureAdapter;let Ta=await this._reschedule(()=>this._searchFeatures(G(ea)),Z);if("esriSpatialRelDisjoint"===na){if(!Ta.length)return ta(null!=W?W:await this._getAllFeaturesQueryEngineResult(Q));const K=new Set;for(var Oa of Ta)K.add(Sa.getObjectId(Oa));const Y=null!=W?W.items:await this._reschedule(()=>this._getAllFeatures(),Z);Oa=await this._reschedule(async()=>{const ba=await F.getSpatialQueryOperator(na,wa,this.geometryType,this.hasZ,this.hasM),ja=await this._runSpatialFilter(Y,
I=>!K.has(Sa.getObjectId(I))||ba(Sa.getGeometry(I)),Z);return new J.QueryEngineResult(ja,Q,this)},Z);return ta(Oa)}if(null!=W){const K=new c.PositionHint;Ta=Ta.filter(Y=>0<=c.indexOf(W.items,Y,W.items.length,K))}if(!Ta.length)return ta=new J.QueryEngineResult([],Q,this),Pa&&this._geometryQueryCache.put(Pa,ta.items,1),ta;if(this._canExecuteSinglePass(wa,Q))return ta(new J.QueryEngineResult(Ta,Q,this));const q=await F.getSpatialQueryOperator(na,wa,this.geometryType,this.hasZ,this.hasM);Oa=await this._runSpatialFilter(Ta,
K=>q(Sa.getGeometry(K)),Z);return ta(new J.QueryEngineResult(Oa,Q,this))}async _executeGeometryQueryForSnapping(Q,W){const {query:Z}=Q,{spatialRel:ea}=Z;if(Q?.items?.length&&Z.geometry&&ea){var ia=await F.getSpatialQueryOperator(ea,Z.geometry,this.geometryType,this.hasZ,this.hasM);W=await this._runSpatialFilter(Q.items,na=>ia(na.geometry),W);Q.items=W}}_executeAggregateIdsQuery(Q){if(0!==Q.items.length&&Q.query.aggregateIds?.length&&null!=this.aggregateAdapter){var W=new Set;for(const ea of Q.query.aggregateIds)this.aggregateAdapter.getFeatureObjectIds(ea).forEach(ia=>
W.add(ia));var Z=this.featureAdapter.getObjectId;Q.items=Q.items.filter(ea=>W.has(Z(ea)))}}_executeObjectIdsQuery(Q){if(0!==Q.items.length&&Q.query.objectIds?.length){var W=new Set(Q.query.objectIds),Z=this.featureAdapter.getObjectId;Q.items=Q.items.filter(ea=>W.has(Z(ea)))}}_executeTimeQuery(Q){if(0!==Q.items.length){var W=N.getTimeOperator(this.timeInfo,Q.query.timeExtent,this.featureAdapter);null!=W&&(Q.items=Q.items.filter(W))}}_executeAttributesQuery(Q){if(0!==Q.items.length){var W=p.getWhereClause(Q.query.where,
this.fieldsIndex);if(W){if(!W.isStandardized)throw new TypeError("Where clause is not standardized");Q.items=Q.items.filter(Z=>W.testFeature(Z,this.featureAdapter))}}}async _runSpatialFilter(Q,W,Z){if(!W)return Q;if(null==this._frameTask)return Q.filter(qa=>W(qa));let ea=0;const ia=[],na=async qa=>{for(;ea<Q.length;){const va=Q[ea++];W(va)&&(ia.push(va),qa.madeProgress());qa.done&&await this._reschedule(ta=>na(ta),Z)}};return this._reschedule(qa=>na(qa),Z).then(()=>ia)}_filterLatest(Q){const {trackIdField:W,
startTimeField:Z,endTimeField:ea}=this.timeInfo,ia=ea||Z,na=new Map,qa=this.featureAdapter.getAttribute;for(const va of Q.items){const ta=qa(va,W),wa=qa(va,ia),Ea=na.get(ta);(!Ea||wa>qa(Ea,ia))&&na.set(ta,va)}Q.items=Array.from(na.values())}_canExecuteSinglePass(Q,W){({spatialRel:W}=W);return F.canQueryWithRBush(Q)&&("esriSpatialRelEnvelopeIntersects"===W||"esriGeometryPoint"===this.geometryType&&("esriSpatialRelIntersects"===W||"esriSpatialRelContains"===W))}async _project(Q,W){if(!W||b.equals(this.spatialReference,
W))return Q;const Z=this.featureAdapter;let ea=void 0;try{const ia=await this._getFullExtent();ea=u.getTransformation(this.spatialReference,W,ia)}catch{}W=await M.projectMany(Q.items.map(ia=>D.getGeometry(this.geometryType,this.hasZ,this.hasM,Z.getGeometry(ia))),this.spatialReference,W,ea);Q.items=W.map((ia,na)=>Z.cloneWithGeometry(Q.items[na],n.convertFromGeometry(ia,this.hasZ,this.hasM)));return Q}async _searchFeatures(Q){const W=new Set;await Promise.all(Q.map(Z=>this.featureStore.forEachInBounds(Z,
ea=>W.add(ea))));Q=Array.from(W.values());W.clear();return Q}async _executeQueryForStatistics(Q,W,Z){Q=C.clone(Q);try{Q=await this._schedule(()=>R.normalizeQuery(Q,this.definitionExpression,this.spatialReference),Z);Q=await this._reschedule(()=>B.validateStatisticsQuery(Q,W,{availableFields:this.availableFields,fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference}),Z);const ea=await this._reschedule(()=>this._executeSceneFilterQuery(Q,Z),Z),ia=await this._reschedule(()=>
this._executeGeometryQuery(Q,ea,Z),Z);await this._reschedule(()=>this._executeAggregateIdsQuery(ia),Z);await this._reschedule(()=>this._executeObjectIdsQuery(ia),Z);await this._reschedule(()=>this._executeTimeQuery(ia),Z);await this._reschedule(()=>this._executeAttributesQuery(ia),Z);return ia}catch(ea){if(ea!==R.queryEngineEmptyResult)throw ea;return new J.QueryEngineResult([],Q,this)}}}a.Feature=k;a.QueryEngine=U;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/MemCache":function(){define(["exports",
"./PooledArray"],function(a,c){a.RemoveMode=void 0;(function(e){e[e.ALL=0]="ALL";e[e.SOME=1]="SOME"})(a.RemoveMode||(a.RemoveMode={}));class w{constructor(e,r,d){this.name=e;this._storage=r;this.id=`${C++}:`;this.size=0;this.maxSize=-1;this._removeFunc=!1;this._miss=this._hit=0;this._storage.register(this);d&&(this._storage.registerRemoveFunc(this.id,d),this._removeFunc=!0)}destroy(){this._storage.clear(this);this._removeFunc&&this._storage.deregisterRemoveFunc(this.id);this._storage.deregister(this);
this._storage=null}get hitRate(){return this._hit/(this._hit+this._miss)}get storageSize(){return this._storage.size}getSize(e){return this._storage.getSize(this,e)}resetHitRate(){this._hit=this._miss=0}put(e,r,d,u=0){this._storage.put(this,e,r,d,u)}pop(e){e=this._storage.pop(this,e);void 0===e?++this._miss:++this._hit;return e}get(e){e=this._storage.get(this,e);void 0===e?++this._miss:++this._hit;return e}peek(e){return this._storage.peek(this,e)}updateSize(e,r,d){this._storage.updateSize(this,e,
r,d)}clear(){this._storage.clear(this)}clearAll(){this._storage.clearAll()}get performanceInfo(){return this._storage.performanceInfo}resetStats(){this._storage.resetStats()}}class v{get size(){return this._size}constructor(e=10485760){this._maxSize=e;this._db=new Map;this._miss=this._hit=this._size=0;this._removeFuncs=new c;this._users=new c}destroy(){this.clearAll();this._removeFuncs.clear();this._users.clear();this._db=null}register(e){this._users.push(e)}deregister(e){this._users.removeUnordered(e)}registerRemoveFunc(e,
r){this._removeFuncs.push([e,r])}deregisterRemoveFunc(e){this._removeFuncs.filterInPlace(r=>r[0]!==e)}get maxSize(){return this._maxSize}set maxSize(e){this._maxSize=Math.max(e,-1);this._checkSize()}getSize(e,r){return this._db.get(e.id+r)?.size??0}put(e,r,d,u,A){r=e.id+r;const x=this._db.get(r);x&&(this._size-=x.size,e.size-=x.size,this._db.delete(r),x.entry!==d&&this._notifyRemove(r,x.entry,x.size,a.RemoveMode.ALL));u>this._maxSize?this._notifyRemove(r,d,u,a.RemoveMode.ALL):void 0===d?console.warn("Refusing to cache undefined entry "):
!u||0>u?(console.warn(`Refusing to cache entry with size ${u} for key ${r}`),this._notifyRemove(r,d,0,a.RemoveMode.ALL)):(this._db.set(r,new z(d,u,1+Math.max(A,-4)- -3)),this._size+=u,e.size+=u,this._checkSize())}updateSize(e,r,d,u){r=e.id+r;const A=this._db.get(r);if(A&&A.entry===d){this._size-=A.size;for(e.size-=A.size;u>this._maxSize;)if(u=this._notifyRemove(r,d,u,a.RemoveMode.SOME),!(null!=u&&0<u)){this._db.delete(r);return}A.size=u;this._size+=u;e.size+=u;this._checkSize()}}pop(e,r){r=e.id+r;
const d=this._db.get(r);if(d)return this._size-=d.size,e.size-=d.size,this._db.delete(r),++this._hit,d.entry;++this._miss}get(e,r){r=e.id+r;e=this._db.get(r);if(void 0===e)++this._miss;else return this._db.delete(r),e.lives=e.lifetime,this._db.set(r,e),++this._hit,e.entry}peek(e,r){(e=this._db.get(e.id+r))?++this._hit:++this._miss;return e?.entry}get performanceInfo(){const e={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+
"%",Entries:this._db.size.toString()},r={},d=[];this._db.forEach((x,E)=>{const m=x.lifetime;d[m]=(d[m]||0)+x.size;this._users.forAll(h=>{const {id:b,name:n}=h;E.startsWith(b)&&(r[n]=(r[n]||0)+x.size)})});const u={};this._users.forAll(x=>{const E=x.name;"hitRate"in x&&"number"===typeof x.hitRate&&!isNaN(x.hitRate)&&0<x.hitRate?(r[E]=r[E]||0,u[E]=Math.round(100*x.hitRate)+"%"):u[E]="0%"});var A=Object.keys(r);A.sort((x,E)=>r[E]-r[x]);A.forEach(x=>e[x]=Math.round(r[x]/2**20)+"MB / "+u[x]);for(A=d.length-
1;0<=A;--A){const x=d[A];x&&(e["Priority "+(A+-3-1)]=Math.round(x/this._size*100)+"%")}return e}resetStats(){this._hit=this._miss=0;this._users.forAll(e=>e.resetHitRate())}clear(e){const r=e.id;this._db.forEach((d,u)=>{u.startsWith(r)&&(this._size-=d.size,this._db.delete(u),this._notifyRemove(u,d.entry,d.size,a.RemoveMode.ALL))});e.size=0}clearAll(){this._db.forEach((e,r)=>this._notifyRemove(r,e.entry,e.size,a.RemoveMode.ALL));this._users.forAll(e=>e.size=0);this._size=0;this._db.clear()}_getHitRate(){return this._hit/
(this._hit+this._miss)}_notifyRemove(e,r,d,u){let A;this._removeFuncs.some(x=>e.startsWith(x[0])?(x=x[1](r,u,d),"number"===typeof x&&(A=x),!0):!1);return A}_checkSize(){this._users.forAll(e=>this._checkSizeLimits(e));this._checkSizeLimits()}_checkSizeLimits(e){const r=e??this;if(!(0>r.maxSize||r.size<=r.maxSize)){for(var d=e?.id,u=!0;u;){u=!1;for(const [A,x]of this._db)if(0===x.lifetime&&(!d||A.startsWith(d))){this._purgeItem(A,x,e);if(r.size<=.9*r.maxSize)return;u||=this._db.has(A)}}for(const [A,
x]of this._db)if(!d||A.startsWith(d))if(this._purgeItem(A,x,e),r.size<=.9*r.maxSize)break}}_purgeItem(e,r,d=this._users.find(u=>e.startsWith(u.id))){this._db.delete(e);if(1>=r.lives){this._size-=r.size;d&&(d.size-=r.size);const u=this._notifyRemove(e,r.entry,r.size,a.RemoveMode.SOME);null!=u&&0<u&&(this._size+=u,d&&(d.size+=u),r.lives=r.lifetime,r.size=u,this._db.set(e,r))}else--r.lives,this._db.set(e,r)}}let C=0;class z{constructor(e,r,d){this.entry=e;this.size=r;this.lives=this.lifetime=d}}a.MemCache=
w;a.MemCacheStorage=v;a.MinPriority=-3;a.NoPriority=-4;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/normalizeUtils":function(){define("exports ../../config ../../core/Error ../../core/Logger ../Polygon ../Polyline ./normalizeUtilsCommon ./spatialReferenceUtils ./webMercatorUtils ../../rest/geometryService/cut ../../rest/geometryService/simplify".split(" "),function(a,c,w,v,C,z,e,r,d,u,A){function x(D){const M=[];let g=0,J=0;for(let R=0;R<D.length;R++){const B=
D[R];let F=null;for(let N=0;N<B.length;N++)F=B[N],M.push(F),0===N?J=g=F[0]:(g=Math.min(g,F[0]),J=Math.max(J,F[0]));F&&M.push([(g+J)/2,0])}return M}function E(D,M){if(!(D instanceof z||D instanceof C))throw p().error("straightLineDensify: the input geometry is neither polyline nor polygon"),new w("straightLineDensify: the input geometry is neither polyline nor polygon");var g=e.getGeometryParts(D);const J=[];for(const B of g){g=[];J.push(g);g.push([B[0][0],B[0][1]]);for(let F=0;F<B.length-1;F++){const N=
B[F][0],T=B[F][1],y=B[F+1][0],G=B[F+1][1];var R=Math.sqrt((y-N)*(y-N)+(G-T)*(G-T));const k=(G-T)/R,l=(y-N)/R,H=R/M;if(1<H){for(let U=1;U<=H-1;U++){const Q=U*M;g.push([l*Q+N,k*Q+T])}R=(R+Math.floor(H-1)*M)/2;g.push([l*R+N,k*R+T])}g.push([y,G])}}return"polygon"===D.type?new C({rings:J,spatialReference:D.spatialReference}):new z({paths:J,spatialReference:D.spatialReference})}function m(D,M,g){M&&(D=E(D,1E6),D=d.webMercatorToGeographic(D,!0));g&&(D=e.updatePolyGeometry(D,g));return D}function h(D,M,g){if(Array.isArray(D)){var J=
D[0];J>M?(g=e.offsetMagnitude(J,M),D[0]=J+-2*g*M):J<g&&(M=e.offsetMagnitude(J,g),D[0]=J+-2*M*g)}else J=D.x,J>M?(g=e.offsetMagnitude(J,M),D=D.clone().offset(-2*g*M,0)):J<g&&(M=e.offsetMagnitude(J,g),D=D.clone().offset(-2*M*g,0));return D}function b(D,M){let g=-1;for(let J=0;J<M.cutIndexes.length;J++){const R=M.cutIndexes[J],B=M.geometries[J],F=e.getGeometryParts(B);for(let N=0;N<F.length;N++){const T=F[N];T.some(y=>{if(180>y[0])return!0;y=0;for(var G=0;G<T.length;G++){var k=T[G][0];y=k>y?k:y}y=Number(y.toFixed(9));
y=-360*e.offsetMagnitude(y,180);for(G=0;G<T.length;G++)k=B.getPoint(N,G),B.setPoint(N,G,k.clone().offset(y,0));return!0})}if(R===g)if("polygon"===D[0].type)for(const N of e.getGeometryParts(B))D[R]=D[R].addRing(N);else{if("polyline"===D[0].type)for(const N of e.getGeometryParts(B))D[R]=D[R].addPath(N)}else g=R,D[R]=B}return D}async function n(D,M,g){if(!Array.isArray(D))return n([D],M);M&&"string"!==typeof M&&p().warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");
var J="string"===typeof M?M:M?.url??c.geometryServiceUrl;let R,B,F;let N=0;var T=[];M=[];for(var y of D)if(null==y)M.push(y);else{if(!G){var G=y.spatialReference;var k=r.getInfo(G);var l=(R=G.isWebMercator)?102100:4326;B=e.cutParams[l].maxX;F=e.cutParams[l].minX;var H=e.cutParams[l].plus180Line;l=e.cutParams[l].minus180Line}if(k)if("mesh"===y.type)M.push(y);else if("point"===y.type)M.push(h(y.clone(),B,F));else if("multipoint"===y.type){var U=y.clone();U.points=U.points.map(Q=>h(Q,B,F));M.push(U)}else if("extent"===
y.type)U=y.clone()._normalize(!1,!1,k),M.push(U.rings?new C(U):U);else if(y.extent){U=y.extent;const Q=2*e.offsetMagnitude(U.xmin,F)*B;let W=0===Q?y.clone():e.updatePolyGeometry(y.clone(),Q);U.offset(Q,0);let {xmin:Z,xmax:ea}=U;Z=Number(Z.toFixed(9));ea=Number(ea.toFixed(9));U.intersects(H)&&ea!==B?(N=ea>N?ea:N,W=m(W,R),T.push(W),M.push("cut")):U.intersects(l)&&Z!==F?(N=2*ea*B>N?2*ea*B:N,W=m(W,R,360),T.push(W),M.push("cut")):M.push(W)}else M.push(y.clone());else M.push(y)}G=e.offsetMagnitude(N,B);
k=-90;H=G;for(y=new z;0<G;)l=-180+360*G,y.addPath([[l,k],[l,-1*k]]),k*=-1,G--;if(0<T.length&&0<H){G=await u.cut(J,T,y,g);G=b(T,G);k=[];T=[];for(H=0;H<M.length;H++)y=M[H],"cut"!==y?T.push(y):(y=G.shift(),l=D[H],null!=l&&"polygon"===l.type&&l.rings&&1<l.rings.length&&y.rings.length>=l.rings.length?(k.push(y),T.push("simplify")):T.push(R?d.geographicToWebMercator(y):y));if(!k.length)return T;M=await A.simplify(J,k,g);D=[];for(g=0;g<T.length;g++)J=T[g],"simplify"!==J?D.push(J):D.push(R?d.geographicToWebMercator(M.shift()):
M.shift());return D}D=[];for(g=0;g<M.length;g++)J=M[g],"cut"!==J?D.push(J):(J=T.shift(),D.push(!0===R?d.geographicToWebMercator(J):J));return D}const p=()=>v.getLogger("esri.geometry.support.normalizeUtils");a.getClosestDenormalizedXToReference=function(D,M,g){g=r.getInfo(g);if(null==g)return D;const [J,R]=g.valid;g=2*R;let B=0,F=0;M>R?B=Math.ceil(Math.abs(M-R)/g):M<J&&(B=-Math.ceil(Math.abs(M-J)/g));D>R?F=Math.ceil(Math.abs(D-R)/g):D<J&&(F=-Math.ceil(Math.abs(D-J)/g));D+=(B-F)*g;M=D-M;M>R?D-=g:M<
J&&(D+=g);return D};a.getDenormalizedExtent=function(D){if(!D)return null;const M=D.extent;if(!M)return null;var g=D.spatialReference&&r.getInfo(D.spatialReference);if(!g)return M;const [J,R]=g.valid;({width:g}=M);let {xmin:B,xmax:F}=M;[B,F]=[F,B];if("extent"===D.type||0===g||g<=R||g>2*R||B<J||F>R)return M;let N;switch(D.type){case "polygon":if(1<D.rings.length)N=x(D.rings);else return M;break;case "polyline":if(1<D.paths.length)N=x(D.paths);else return M;break;case "multipoint":N=D.points}D=M.clone();
for(let T=0;T<N.length;T++){let y=N[T][0];0>y?(y+=R,F=Math.max(y,F)):(y-=R,B=Math.min(y,B))}D.xmin=B;D.xmax=F;return D.width<g?(D.xmin-=R,D.xmax-=R,D):M};a.normalizeCentralMeridian=n;a.normalizeMapX=function(D,M){if(M=r.getInfo(M)){const [g,J]=M.valid;M=J-g;if(D<g)for(;D<g;)D+=M;if(D>J)for(;D>J;)D-=M}return D};a.straightLineDensify=E;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/normalizeUtilsCommon":function(){define(["exports","../Polyline","../SpatialReference",
"./jsonUtils"],function(a,c,w,v){function C(z){return v.isPolygon(z)?z.rings:z.paths}c={102100:{maxX:2.0037508342788905E7,minX:-2.0037508342788905E7,plus180Line:new c({paths:[[[2.0037508342788905E7,-2.0037508342788905E7],[2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:w.WebMercator}),minus180Line:new c({paths:[[[-2.0037508342788905E7,-2.0037508342788905E7],[-2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:w.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new c({paths:[[[180,
-180],[180,180]]],spatialReference:w.WGS84}),minus180Line:new c({paths:[[[-180,-180],[-180,180]]],spatialReference:w.WGS84})}};a.cutParams=c;a.getGeometryParts=C;a.offsetMagnitude=function(z,e){return Math.ceil((z-e)/(2*e))};a.updatePolyGeometry=function(z,e){const r=C(z);for(const d of r)for(const u of d)u[0]+=e;return z};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/geometryService/cut":function(){define("exports ../../geometry ../../request ../../geometry/support/jsonUtils ../../geometry/support/spatialReferenceUtils ../utils".split(" "),
function(a,c,w,v,C,z){a.cut=async function(e,r,d,u){e=z.parseUrl(e);const A=r[0].spatialReference;r={...u,responseType:"json",query:{...e.query,f:"json",sr:C.srToRESTValue(A),target:JSON.stringify({geometryType:v.getJsonType(r[0]),geometries:r}),cutter:JSON.stringify(d)}};r=await w(e.path+"/cut",r);const {cutIndexes:x,geometries:E=[]}=r.data;return{cutIndexes:x,geometries:E.map(m=>{m=v.fromJSON(m);m.spatialReference=A;return m})}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/utils":function(){define("exports ../config ../kernel ../core/lang ../core/urlUtils ../support/apiKeyUtils".split(" "),
function(a,c,w,v,C,z){function e(r,d,u){const A={};for(const E in r)if("declaredClass"!==E){var x=r[E];null!=x&&"function"!==typeof x&&(Array.isArray(x)?A[E]=x.map(m=>e(m)):"object"===typeof x?x.toJSON?(x=x.toJSON(u?.[E]),A[E]=d?x:JSON.stringify(x)):A[E]=d?x:JSON.stringify(x):A[E]=x)}return A}a.asValidOptions=function(r,d){return d?{...d,query:{...(r??{}),...d.query}}:{query:r}};a.encode=e;a.getToken=function(r,d){return r?z.supportsApiKey(r)&&(d||c.apiKey)?d||c.apiKey:w.id?.findCredential(r)?.token:
null};a.parseUrl=function(r){return"string"===typeof r?C.urlToObject(r):v.clone(r)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/geometryService/simplify":function(){define("exports ../../request ../../core/urlUtils ../../geometry/support/jsonUtils ../../geometry/support/spatialReferenceUtils ./utils".split(" "),function(a,c,w,v,C,z){a.simplify=async function(e,r,d){const u="string"===typeof e?w.urlToObject(e):e;e=r[0].spatialReference;const A=v.getJsonType(r[0]);r={...d,
query:{...u.query,f:"json",sr:C.srToRESTValue(e),geometries:JSON.stringify(z.encodeGeometries(r))}};({data:r}=await c(u.path+"/simplify",r));return z.decodeGeometries(r.geometries,A,e)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/geometryService/utils":function(){define(["exports","../../geometry/support/jsonUtils"],function(a,c){a.decodeGeometries=function(w,v,C){const z=c.getGeometryType(v);return w.map(e=>{e=z.fromJSON(e);e.spatialReference=C;return e})};a.encodeGeometries=
function(w){return{geometryType:c.getJsonType(w[0]),geometries:w.map(v=>v.toJSON())}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/attributeSupport":function(){define(["exports","../../../core/Error","../../../core/sql/WhereClauseCache","../../support/fieldType"],function(a,c,w,v){function C(m,h,b={}){const n=z(h,m);if(!n)throw b=A.getError(h,m),new c("unsupported-query","invalid SQL expression",{expression:h,error:b});m=b.expressionName||"expression";
if(b.validateStandardized&&!n.isStandardized)throw new c("unsupported-query",`${m} is not standard`,{expression:h});if(b.validateAggregate&&!n.isAggregate)throw new c("unsupported-query",`${m} does not contain a valid aggregate function`,{expression:h});return n.fieldNames}function z(m,h){return m?A.get(m,h):null}function e(m){return/\((.*?)\)/.test(m)?m:m.split(" as ")[0]}function r(m,h,b,n={}){const p=new Map;d(p,m,h,n.allowedFieldTypes??E,b);if(p.size)throw new c("unsupported-query",`${n.expressionName??
"expression"} contains invalid or missing fields`,{errors:Array.from(p.values()),query:n.query});}function d(m,h,b,n,p){p=p.includes("*")?[...b,...p.filter(D=>"*"!==D)]:p;for(const D of p)if(h.get(D))u(m,h,b,n,D);else try{const M=e(D),g=C(h,M,{validateStandardized:!0});for(const J of g)u(m,h,b,n,J)}catch(M){m.set(D,{type:"expression-error",expression:D,error:M})}}function u(m,h,b,n,p){(h=h.get(p))?b.has(h.name)?"all"!==n&&!1===n?.has(h.type)&&m.set(p,{type:"invalid-type",fieldName:h.name,fieldType:v.kebabDict.fromJSON(h.type),
allowedFieldTypes:Array.from(n,D=>v.kebabDict.fromJSON(D))}):m.set(p,{type:"missing-field",fieldName:h.name}):m.set(p,{type:"invalid-field",fieldName:p})}const A=new w.WhereClauseCache(50,500);w=new Set("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeBigInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong".split(" "));const x=new Set(["esriFieldTypeDate","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]),E=new Set(["esriFieldTypeString",
"esriFieldTypeGUID","esriFieldTypeGlobalID",...w,...x]);a.allDateAndTimeFieldTypes=x;a.getAliasFromFieldName=function(m){return m.split(" as ")[1]};a.getExpressionFromFieldName=e;a.getWhereClause=z;a.numericFieldTypes=w;a.validateFields=r;a.validateHaving=function(m,h,b,n,p){if(!b)return!0;const D=C(m,b,{validateAggregate:!0,expressionName:"having clause"});r(m,h,D,{expressionName:"having clause",query:p});if(!z(b,m)?.getExpressions().every(M=>{const {aggregateType:g,field:J}=M,R=m.get(J)?.name;return n.some(B=>
{const {onStatisticField:F,statisticType:N}=B;return m.get(F)?.name===R&&N.toLowerCase().trim()===g})}))throw new c("unsupported-query","expressions in having clause should also exist in outStatistics",{having:b});return!0};a.validateWhere=function(m,h,b,n){if(!b)return!0;b=C(m,b,{validateStandardized:!0,expressionName:"where clause"});r(m,h,b,{expressionName:"where clause",query:n});return!0};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereClauseCache":function(){define(["exports",
"../LRUCache","./WhereClause"],function(a,c,w){class v{constructor(C,z){this._cache=new c.LRUCache(C);this._invalidCache=new c.LRUCache(z)}get(C,z){const e=`${z.uid}:${C}`,r=this._cache.get(e);if(r)return r;if(null!=this._invalidCache.get(e))return null;try{const d=w.WhereClause.create(C,z);this._cache.put(e,d);return d}catch(d){return this._invalidCache.put(e,d),null}}getError(C,z){return this._invalidCache.get(`${z.uid}:${C}`)??null}}a.WhereClauseCache=v;Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/core/LRUCache":function(){define(["exports","./MemCache"],function(a,c){class w{constructor(v,C){this._storage=new c.MemCacheStorage;this.name=this.id="";this.size=0;this._storage.maxSize=v;this._storage.register(this);C&&this._storage.registerRemoveFunc("",C)}destroy(){this._storage.deregister(this);this._storage.destroy()}put(v,C,z=1){this._storage.put(this,v,C,z,1)}pop(v){return this._storage.pop(this,v)}get(v){return this._storage.get(this,v)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(v){this._storage.maxSize=
v}resetHitRate(){}}a.LRUCache=w;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereClause":function(){define("exports ../../arcade/ArcadeDate ../../arcade/featureset/support/errorsupport ../has ./AggregateFunctions ./DateOnly ./sqlArithmeticUtils ./sqlCompareUtils ./sqlDateParsingUtils ./SqlInterval ./SqlTimestampOffset ./StandardizedFunctions ./TimeOnly ./WhereGrammar ../../chunks/datetime".split(" "),function(a,c,w,v,C,z,e,r,d,u,A,x,E,m,h){function b(y){return Array.isArray(y)?
y:[y]}function n(y){return null!==y?!0!==y:null}function p(y,G){return null!=y&&null!=G?!0===y&&!0===G:!1===y||!1===G?!1:null}function D(y,G){return null!=y&&null!=G?!0===y||!0===G:!0===y||!0===G?!0:null}function M(y,G,k){if(null==y)return null;k=!1;for(const l of G)if(null==l)k=null;else if(y===l){k=!0;break}else if(r.isDateOrTimeValue(y)&&r.isDateOrTimeValue(l)&&(k=r.sqlCompare(y,l,"\x3d")))break;return k}function g(y,G,k){if(null==y)return null;let l="",H=N.Normal;for(let U=0;U<G.length;U++){const Q=
G.charAt(U);switch(H){case N.Normal:Q===k?H=N.Escaped:l="-[]/{}()*+?.\\^$|".includes(Q)?l+("\\"+Q):"%"===Q?l+".*":"_"===Q?l+".":l+Q;break;case N.Escaped:l="-[]/{}()*+?.\\^$|".includes(Q)?l+("\\"+Q):l+Q,H=N.Normal}}return(new RegExp("^"+l+"$","m")).test(y)}function J(y,G,k,l){y=l.getAttribute(y,G);G=k?.get(G);return null==y||"esriFieldTypeDate"!==G?.type&&"date"!==G?.type?null==y||"esriFieldTypeDateOnly"!==G?.type&&"date-only"!==G?.type?null==y||"esriFieldTypeTimeOnly"!==G?.type&&"time-only"!==G?.type?
null==y||"esriFieldTypeTimestampOffset"!==G?.type&&"timestamp-offset"!==G?.type?y:new A.SqlTimeStampOffset(y):E.TimeOnly.fromReader(y):z.DateOnly.fromReader(y):d.convertToExecutingTimeZone(new Date(y),k?.getLuxonTimeZone(G.name)??h.FixedOffsetZone.utcInstance)}const R=new Set(["current_timestamp","current_date","current_time"]);class B{static makeBool(y){return!0===y}static featureValue(y,G,k,l){return J(y,G,k,l)}static equalsNull(y){return null===y}static applyLike(y,G,k){return g(y,G,k)}static ensureArray(y){return b(y)}static applyIn(y,
G,k){return M(y,G)}static currentDate(y){return z.DateOnly.fromNow(y)}static makeSqlInterval(y,G,k){return u.SqlInterval.createFromValueAndQualifier(y,G,k)}static convertInterval(y){return y instanceof u.SqlInterval?y.valueInMilliseconds():y}static currentTimestamp(y){return d.convertToExecutingTimeZone(new Date,y)}static compare(y,G,k,l){return r.sqlCompare(G,k,y)}static calculate(y,G,k,l){return e.sqlCalculateFunction(y,G,k,l)}static evaluateTime(y){return d.parseTime(y)}static evaluateTimestamp(y,
G,k){return d.parseTimestamp(y,G,k)}static evaluateDate(y,G){return d.parseDate(y,G)}static evaluateFunction(y,G,k){return x.evaluateFunction(y,G,k)}static lookup(y,G){y=G[y];return void 0===y?null:y}static between(y,G,k){return null==y||null==G[0]||null==G[1]?null:r.sqlCompare(y,G[0],"\x3e\x3d")&&r.sqlCompare(y,G[1],"\x3c\x3d")}static notbetween(y,G,k){return null==y||null==G[0]||null==G[1]?null:r.sqlCompare(y,G[0],"\x3c")||r.sqlCompare(y,G[1],"\x3e")}static ternaryNot(y){return n(y)}static ternaryAnd(y,
G){return p(y,G)}static ternaryOr(y,G){return D(y,G)}}class F{constructor(y,G,k="UTC"){this.fieldsIndex=G;this.timeZone=k;this.parameters={};this._hasDateFunctions=void 0;this.parseTree=m.WhereGrammar.parse(y);const {isStandardized:l,isAggregate:H,referencedFieldNames:U}=this._extractExpressionInfo(G);this._referencedFieldNames=U;this.isStandardized=l;this.isAggregate=H}static convertValueToStorageFormat(y,G=null){if(null===G)return d.isDate(y)?y.getTime():d.isDateTime(y)?y.toMillis():d.isTimestampOffset(y)?
y.toStorageFormat():d.isTimeOnly(y)?y.toStorageString():d.isDateOnly(y)?y.toStorageFormat():y;switch(G){case "date":if(d.isDate(y))return y.getTime();if(d.isDateTime(y))return y.toMillis();if(d.isTimestampOffset(y))return y.toMilliseconds();if(d.isDateOnly(y))return y.toNumber();break;case "date-only":if(d.isDate(y))return z.DateOnly.fromDateJS(y).toString();if(d.isTimestampOffset(y))return z.DateOnly.fromSqlTimeStampOffset(y).toString();if(d.isDateTime(y))return z.DateOnly.fromDateTime(y).toString();
break;case "time-only":if(d.isDate(y))return E.TimeOnly.fromDateJS(y).toStorageString();if(d.isDateTime(y))return E.TimeOnly.fromDateTime(y).toStorageString();if(d.isTimestampOffset(y))return E.TimeOnly.fromSqlTimeStampOffset(y).toStorageString();if(d.isTimeOnly(y))return y.toStorageString();break;case "timestamp-offset":if(d.isDate(y))return A.SqlTimeStampOffset.fromJSDate(y).toStorageFormat();if(d.isDateTime(y))return A.SqlTimeStampOffset.fromDateTime(y).toStorageFormat();if(d.isTimestampOffset(y))return y.toStorageFormat()}return y}static create(y,
G,k="UTC"){return new F(y,G,k)}get fieldNames(){return this._referencedFieldNames}testSet(y,G=T){return!!this._evaluateNode(this.parseTree,null,G,y)}calculateValue(y,G=T){y=this._evaluateNode(this.parseTree,y,G,null);return y instanceof u.SqlInterval?y.valueInMilliseconds()/864E5:y}calculateValueCompiled(y,G=T){if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(y,this.parameters,G,this.fieldsIndex,this.timeZone);if(v("esri-csp-restrictions"))return this.calculateValue(y,
G);this._compileMe();return this.parseTree._compiledVersion(y,this.parameters,G,this.fieldsIndex,this.timeZone)}testFeature(y,G=T){return!!this._evaluateNode(this.parseTree,y,G,null)}testFeatureCompiled(y,G=T){if(null!=this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(y,this.parameters,G,this.fieldsIndex,this.timeZone);if(v("esri-csp-restrictions"))return this.testFeature(y,G);this._compileMe();return!!this.parseTree._compiledVersion(y,this.parameters,G,this.fieldsIndex,this.timeZone)}get hasDateFunctions(){if(null!=
this._hasDateFunctions)return this._hasDateFunctions;this._hasDateFunctions=!1;this._visitAll(this.parseTree,y=>{"current-time"===y.type?this._hasDateFunctions=!0:"function"===y.type&&(this._hasDateFunctions=this._hasDateFunctions||R.has(y.name.toLowerCase()))});return this._hasDateFunctions}getFunctions(){const y=new Set;this._visitAll(this.parseTree,G=>{"function"===G.type&&y.add(G.name.toLowerCase())});return Array.from(y)}getExpressions(){const y=new Map;this._visitAll(this.parseTree,G=>{if("function"===
G.type){const k=G.name.toLowerCase();G=G.args.value[0];if("column-reference"===G.type){G=G.column;const l=`${k}-${G}`;y.has(l)||y.set(l,{aggregateType:k,field:G})}}});return[...y.values()]}getVariables(){const y=new Set;this._visitAll(this.parseTree,G=>{"parameter"===G.type&&y.add(G.value.toLowerCase())});return Array.from(y)}_compileMe(){const y="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter",
"fieldsIndex","timeZone",y)).bind(B)}_extractExpressionInfo(y){const G=[],k=new Set;let l=!0,H=!1;this._visitAll(this.parseTree,U=>{switch(U.type){case "column-reference":var Q=y?.get(U.column);let W;Q?Q=W=Q.name??"":(W=U.column,Q=W.toLowerCase());k.has(Q)||(k.add(Q),G.push(W));U.column=W;break;case "function":const {name:Z,args:ea}=U;U=ea.value.length;l&&=x.isStandardized(Z,U);!1===H&&(H=C.isAggregate(Z,U))}});return{referencedFieldNames:Array.from(G),isStandardized:l,isAggregate:H}}_visitAll(y,
G){if(null!=y)switch(G(y),y.type){case "when-clause":this._visitAll(y.operand,G);this._visitAll(y.value,G);break;case "case-expression":for(const k of y.clauses)this._visitAll(k,G);"simple"===y.format&&this._visitAll(y.operand,G);null!==y.else&&this._visitAll(y.else,G);break;case "expression-list":for(const k of y.value)this._visitAll(k,G);break;case "unary-expression":this._visitAll(y.expr,G);break;case "binary-expression":this._visitAll(y.left,G);this._visitAll(y.right,G);break;case "function":this._visitAll(y.args,
G)}}evaluateNodeToJavaScript(y){switch(y.type){case "interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(y.value)+", "+JSON.stringify(y.qualifier)+","+JSON.stringify(y.op)+")";case "case-expression":var G="";if("simple"===y.format){var k=this.evaluateNodeToJavaScript(y.operand);G="( ";for(let l=0;l<y.clauses.length;l++)G+=" (this.compare('\x3d',"+k+","+this.evaluateNodeToJavaScript(y.clauses[l].operand)+") ? ("+this.evaluateNodeToJavaScript(y.clauses[l].value)+") : "}else for(G=
"( ",k=0;k<y.clauses.length;k++)G+=" this.makeBool("+this.evaluateNodeToJavaScript(y.clauses[k].operand)+")\x3d\x3d\x3dtrue ? ("+this.evaluateNodeToJavaScript(y.clauses[k].value)+") : ";G=null!==y.else?G+this.evaluateNodeToJavaScript(y.else):G+"null";return G+" )";case "parameter":return"this.lookup("+JSON.stringify(y.value.toLowerCase())+",lookups)";case "expression-list":G="[";for(k of y.value)"["!==G&&(G+=","),G+=this.evaluateNodeToJavaScript(k);return G+"]";case "unary-expression":return"this.ternaryNot("+
this.evaluateNodeToJavaScript(y.expr)+")";case "binary-expression":switch(y.operator){case "AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(y.left)+","+this.evaluateNodeToJavaScript(y.right)+" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(y.left)+","+this.evaluateNodeToJavaScript(y.right)+" )";case "IS":if("null"!==y.right.type)throw new w.SqlError(w.SqlErrorCodes.UnsupportedIsRhs);return"this.equalsNull("+this.evaluateNodeToJavaScript(y.left)+")";case "ISNOT":if("null"!==
y.right.type)throw new w.SqlError(w.SqlErrorCodes.UnsupportedIsRhs);return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(y.left)+")))";case "IN":return"this.applyIn("+this.evaluateNodeToJavaScript(y.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(y.right)+"), timeZone)";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(y.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(y.right)+"), timeZone))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(y.left)+
","+this.evaluateNodeToJavaScript(y.right)+", timeZone)";case "NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(y.left)+","+this.evaluateNodeToJavaScript(y.right)+", timeZone)";case "LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(y.left)+","+this.evaluateNodeToJavaScript(y.right)+","+JSON.stringify(y.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(y.left)+","+this.evaluateNodeToJavaScript(y.right)+","+JSON.stringify(y.escape)+
"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+JSON.stringify(y.operator)+","+this.evaluateNodeToJavaScript(y.left)+","+this.evaluateNodeToJavaScript(y.right)+", timeZone)";case "*":case "-":case "+":case "/":case "||":return"this.calculate("+JSON.stringify(y.operator)+","+this.evaluateNodeToJavaScript(y.left)+","+this.evaluateNodeToJavaScript(y.right)+", timeZone)"}throw new w.SqlError(w.SqlErrorCodes.UnsupportedOperator,{operator:y.operator});
case "null":case "boolean":case "string":case "number":return JSON.stringify(y.value);case "time":return"this.evaluateTime("+JSON.stringify(y.value)+")";case "date":return"this.evaluateDate("+JSON.stringify(y.value)+", 'unknown')";case "timestamp":return"this.evaluateTimestamp("+JSON.stringify(y.value)+", 'unknown')";case "current-time":return"date"===y.mode?"this.currentDate(timeZone)":"this.currentTimestamp(timeZone)";case "column-reference":return"this.featureValue(feature,"+JSON.stringify(y.column)+
",fieldsIndex,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(y.name)+","+this.evaluateNodeToJavaScript(y.args)+", timeZone)"}throw new w.SqlError(w.SqlErrorCodes.UnsupportedSyntax,{node:y.type});}_evaluateNode(y,G,k,l){switch(y.type){case "interval":return k=this._evaluateNode(y.value,G,k,l),u.SqlInterval.createFromValueAndQualifier(k,y.qualifier,y.op);case "case-expression":if("simple"===y.format){var H=this._evaluateNode(y.operand,G,k,l);for(var U=0;U<y.clauses.length;U++)if(r.sqlCompare(H,
this._evaluateNode(y.clauses[U].operand,G,k,l),"\x3d",this.timeZone))return this._evaluateNode(y.clauses[U].value,G,k,l)}else for(H=0;H<y.clauses.length;H++)if(!0===this._evaluateNode(y.clauses[H].operand,G,k,l))return this._evaluateNode(y.clauses[H].value,G,k,l);return null!==y.else?this._evaluateNode(y.else,G,k,l):null;case "parameter":return y=this.parameters[y.value.toLowerCase()],d.isDate(y)?h.DateTime.fromJSDate(y):y instanceof c.ArcadeDate?y.toDateTime():y;case "expression-list":H=[];for(var Q of y.value)H.push(this._evaluateNode(Q,
G,k,l));return H;case "unary-expression":return n(this._evaluateNode(y.expr,G,k,l));case "binary-expression":switch(y.operator){case "AND":return p(this._evaluateNode(y.left,G,k,l),this._evaluateNode(y.right,G,k,l));case "OR":return D(this._evaluateNode(y.left,G,k,l),this._evaluateNode(y.right,G,k,l));case "IS":if("null"!==y.right.type)throw new w.SqlError(w.SqlErrorCodes.UnsupportedIsRhs);return null===this._evaluateNode(y.left,G,k,l);case "ISNOT":if("null"!==y.right.type)throw new w.SqlError(w.SqlErrorCodes.UnsupportedIsRhs);
return null!==this._evaluateNode(y.left,G,k,l);case "IN":return H=b(this._evaluateNode(y.right,G,k,l)),M(this._evaluateNode(y.left,G,k,l),H,this.timeZone);case "NOT IN":return H=b(this._evaluateNode(y.right,G,k,l)),n(M(this._evaluateNode(y.left,G,k,l),H,this.timeZone));case "BETWEEN":return H=this._evaluateNode(y.left,G,k,l),y=this._evaluateNode(y.right,G,k,l),null==H||null==y[0]||null==y[1]?null:r.sqlCompare(H,y[0],"\x3e\x3d",this.timeZone)&&r.sqlCompare(H,y[1],"\x3c\x3d",this.timeZone);case "NOTBETWEEN":return H=
this._evaluateNode(y.left,G,k,l),y=this._evaluateNode(y.right,G,k,l),null==H||null==y[0]||null==y[1]?null:r.sqlCompare(H,y[0],"\x3c",this.timeZone)||r.sqlCompare(H,y[1],"\x3e",this.timeZone);case "LIKE":return g(this._evaluateNode(y.left,G,k,l),this._evaluateNode(y.right,G,k,l),y.escape);case "NOT LIKE":return n(g(this._evaluateNode(y.left,G,k,l),this._evaluateNode(y.right,G,k,l),y.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return r.sqlCompare(this._evaluateNode(y.left,
G,k,l),this._evaluateNode(y.right,G,k,l),y.operator,this.timeZone);case "-":case "+":case "*":case "/":case "||":return e.sqlCalculateFunction(y.operator,this._evaluateNode(y.left,G,k,l),this._evaluateNode(y.right,G,k,l),this.timeZone)}case "null":case "boolean":case "string":case "number":return y.value;case "date":return y.parsedValue??(y.parsedValue=d.parseDate(y.value,"unknown")),y.parsedValue;case "timestamp":return y.parsedValue??(y.parsedValue=d.parseTimestamp(y.value,"unknown")),y.parsedValue;
case "time":return d.parseTime(y.value);case "current-time":return"date"===y.mode?z.DateOnly.fromNow(this.timeZone):d.convertToExecutingTimeZone(new Date,this.timeZone);case "column-reference":return J(G,y.column,this.fieldsIndex,k);case "data-type":return y.value;case "function":if(this.isAggregate&&C.isAggregate(y.name,y.args.value.length)){G=[];for(H of y.args?.value||[]){Q=[];for(U of l||[])Q.push(this._evaluateNode(H,U,k,null));G.push(Q)}return C.aggregateFunction(y.name,G)}k=this._evaluateNode(y.args,
G,k,l);return x.evaluateFunction(y.name,k,this.timeZone)}throw new w.SqlError(w.SqlErrorCodes.UnsupportedSyntax,{node:y.type});}}var N;(function(y){y[y.Normal=0]="Normal";y[y.Escaped=1]="Escaped"})(N||={});const T={getAttribute(y,G){return(y&&"object"===typeof y.attributes?y.attributes:y)[G]}};a.WhereClause=F;a.defaultAttributeAdapter=T;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/ArcadeDate":function(){define(["exports","../core/string","../core/sql/UnknownTimeZone",
"../chunks/datetime"],function(a,c,w,v){function C(u,A,x){return u<A?u-A:u>x?u-x:0}function z(u,A=!0){if(u instanceof v.Zone)return u;if("system"===u.toLowerCase())return"system";if("utc"===u.toLowerCase())return"UTC";if("unknown"===u.toLowerCase())return w.UnknownTimeZone.instance;if(/^[+-]?[0-9]{1,2}([:][0-9]{2})?$/.test(u)){const x=v.FixedOffsetZone.parseSpecifier("UTC"+(u.startsWith("+")||u.startsWith("-")?"":"+")+u);if(x)return x}u=v.IANAZone.create(u);if(!u.isValid){if(A)throw new r(a.ArcadeDateErrorCodes.TimeZoneNotRecognized);
return null}return u}a.ArcadeDateErrorCodes=void 0;(a.ArcadeDateErrorCodes||(a.ArcadeDateErrorCodes={})).TimeZoneNotRecognized="TimeZoneNotRecognized";const e={[a.ArcadeDateErrorCodes.TimeZoneNotRecognized]:"Timezone identifier has not been recognized."};class r extends Error{constructor(u,A){super(c.replace(e[u],A));this.declaredRootClass="esri.arcade.arcadedate.dateerror";Error.captureStackTrace&&Error.captureStackTrace(this,r)}}class d{constructor(u){this._date=u;this.declaredRootClass="esri.arcade.arcadedate"}static fromParts(u=
0,A=1,x=1,E=0,m=0,h=0,b=0,n){if(isNaN(u)||isNaN(A)||isNaN(x)||isNaN(E)||isNaN(m)||isNaN(h)||isNaN(b))return null;const p=v.DateTime.local(u,A).daysInMonth;u=v.DateTime.fromObject({day:1>x?1:x>p?p:x,year:u,month:1>A?1:12<A?12:A,hour:0>E?0:23<E?23:E,minute:0>m?0:59<m?59:m,second:0>h?0:59<h?59:h,millisecond:0>b?0:999<b?999:b},{zone:z(n)});u=u.plus({months:C(A,1,12),days:C(x,1,p),hours:C(E,0,23),minutes:C(m,0,59),seconds:C(h,0,59),milliseconds:C(b,0,999)});return new d(u)}static get systemTimeZoneCanonicalName(){return Intl.DateTimeFormat().resolvedOptions().timeZone??
"system"}static arcadeDateAndZoneToArcadeDate(u,A){A=z(A);return u.isUnknownTimeZone||A===w.UnknownTimeZone.instance?d.fromParts(u.year,u.monthJS+1,u.day,u.hour,u.minute,u.second,u.millisecond,A):new d(u._date.setZone(A))}static dateJSToArcadeDate(u){return new d(v.DateTime.fromJSDate(u,{zone:"system"}))}static dateJSAndZoneToArcadeDate(u,A="system"){A=z(A);return new d(v.DateTime.fromJSDate(u,{zone:A}))}static unknownEpochToArcadeDate(u){return new d(v.DateTime.fromMillis(u,{zone:w.UnknownTimeZone.instance}))}static unknownDateJSToArcadeDate(u){return new d(v.DateTime.fromMillis(u.getTime(),
{zone:w.UnknownTimeZone.instance}))}static epochToArcadeDate(u,A="system"){A=z(A);return new d(v.DateTime.fromMillis(u,{zone:A}))}static dateTimeToArcadeDate(u){return new d(u)}clone(){return new d(this._date)}changeTimeZone(u){u=z(u);return d.dateTimeToArcadeDate(this._date.setZone(u))}static dateTimeAndZoneToArcadeDate(u,A){A=z(A);return u.zone===w.UnknownTimeZone.instance||A===w.UnknownTimeZone.instance?d.fromParts(u.year,u.month,u.day,u.hour,u.minute,u.second,u.millisecond,A):new d(u.setZone(A))}static nowToArcadeDate(u){u=
z(u);return new d(v.DateTime.fromJSDate(new Date,{zone:u}))}static nowUTCToArcadeDate(){return new d(v.DateTime.utc())}get isSystem(){return"system"===this.timeZone||this.timeZone===d.systemTimeZoneCanonicalName}equals(u){return this.isSystem&&u.isSystem?this.toNumber()===u.toNumber():this.isUnknownTimeZone!==u.isUnknownTimeZone?!1:this._date.equals(u._date)}get isUnknownTimeZone(){return this._date.zone===w.UnknownTimeZone.instance}get isValid(){return this._date.isValid}get hour(){return this._date.hour}get second(){return this._date.second}get day(){return this._date.day}get dayOfWeekISO(){return this._date.weekday}get dayOfWeekJS(){let u=
this._date.weekday;6<u&&(u=0);return u}get millisecond(){return this._date.millisecond}get monthISO(){return this._date.month}get weekISO(){return this._date.weekNumber}get yearISO(){return this._date.weekYear}get monthJS(){return this._date.month-1}get year(){return this._date.year}get minute(){return this._date.minute}get zone(){return this._date.zone}get timeZoneOffset(){return this.isUnknownTimeZone?0:this._date.offset}get timeZone(){if(this.isUnknownTimeZone)return"unknown";if("system"===this._date.zone.type)return"system";
const u=this.zone;return"fixed"===u.type?0===u.fixed?"UTC":u.formatOffset(0,"short"):u.name}stringify(){return JSON.stringify(this.toJSDate())}plus(u){return new d(this._date.plus(u))}diff(u,A="milliseconds"){return this._date.diff(u._date,A)[A]}toISODate(){return this._date.toISODate()}toISOString(u){return u?this._date.toISO({suppressMilliseconds:!0,includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})}toISOTime(u,A){return this._date.toISOTime({suppressMilliseconds:u,
includeOffset:A&&!this.isUnknownTimeZone})}toFormat(u,A){this.isUnknownTimeZone&&(u=u.replaceAll("Z",""));return this._date.toFormat(u,A)}toJSDate(){return this._date.toJSDate()}toSQLValue(){return this._date.toFormat("yyyy-LL-dd HH:mm:ss")}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}toDateTime(){return this._date}toNumber(){return this._date.toMillis()}getTime(){return this._date.toMillis()}toUTC(){return new d(this._date.toUTC())}toLocal(){return new d(this._date.toLocal())}toString(){return this.toISOString(!0)}static fromReaderAsTimeStampOffset(u){if(!u)return null;
u=v.DateTime.fromISO(u,{setZone:!0});return new d(u)}}a.ArcadeDate=d;a.ArcadeDateError=r;a.arcadeDateErrorMessages=e;a.createDateTimeZone=z;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/UnknownTimeZone":function(){define(["exports","../../chunks/datetime"],function(a,c){function w(C){return C instanceof c.Zone?C===v.instance?!0:!1:"unknown"===C?.toString().toLowerCase()?!0:!1}class v{}v.instance=new c.IANAZone("Etc/UTC");a.UnknownTimeZone=v;a.adoptTimeZone=function(C,
z){return c.DateTime.fromObject({day:C.day,year:C.year,month:C.month,hour:C.hour,minute:C.minute,second:C.second,millisecond:C.millisecond},{zone:z})};a.isUnknownTimeZone=w;a.substituteUnknownTimezone=function(C){return w(C)?v.instance:C};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/featureset/support/errorsupport":function(){define(["exports","../../../core/string"],function(a,c){a.SqlErrorCodes=void 0;(function(e){e.InvalidFunctionParameters="InvalidFunctionParameters";
e.InvalidValueForAggregateFunction="InvalidValueForAggregateFunction";e.UnsupportedSqlFunction="UnsupportedSqlFunction";e.UnsupportedOperator="UnsupportedOperator";e.UnsupportedSyntax="UnsupportedSyntax";e.UnsupportedIsRhs="UnsupportedIsRhs";e.UnsupportedIsLhs="UnsupportedIsLhs";e.InvalidDataType="InvalidDataType";e.CannotCastValue="CannotCastValue";e.FunctionNotRecognized="FunctionNotRecognized";e.InvalidTime="InvalidTime";e.InvalidParameterCount="InvalidParameterCount";e.InvalidTimeStamp="InvalidTimeStamp";
e.InvalidDate="InvalidDate";e.InvalidOperator="InvalidOperator";e.IllegalInterval="IllegalInterval";e.YearMonthIntervals="YearMonthIntervals";e.PrimarySecondaryQualifiers="PrimarySecondaryQualifiers";e.MissingStatisticParameters="MissingStatisticParameters"})(a.SqlErrorCodes||(a.SqlErrorCodes={}));const w={[a.SqlErrorCodes.InvalidValueForAggregateFunction]:"Invalid value used in aggregate function",[a.SqlErrorCodes.MissingStatisticParameters]:"Statistic does not have 1 or 0 Parameters",[a.SqlErrorCodes.InvalidFunctionParameters]:"Invalid parameters for call to {function}",
[a.SqlErrorCodes.UnsupportedIsLhs]:"Unsupported left hand expression in is statement",[a.SqlErrorCodes.UnsupportedIsRhs]:"Unsupported right hand expression in is statement",[a.SqlErrorCodes.UnsupportedOperator]:"Unsupported operator - {operator}",[a.SqlErrorCodes.UnsupportedSyntax]:"Unsupported syntax - {node}",[a.SqlErrorCodes.UnsupportedSqlFunction]:"Sql function not found \x3d {function}",[a.SqlErrorCodes.InvalidDataType]:"Invalid sql data type",[a.SqlErrorCodes.InvalidDate]:"Invalid date encountered",
[a.SqlErrorCodes.InvalidOperator]:"Invalid operator encountered",[a.SqlErrorCodes.InvalidTime]:"Invalid time encountered",[a.SqlErrorCodes.IllegalInterval]:"Illegal interval",[a.SqlErrorCodes.FunctionNotRecognized]:"Function not recognized",[a.SqlErrorCodes.InvalidTimeStamp]:"Invalid timestamp encountered",[a.SqlErrorCodes.InvalidParameterCount]:"Invalid parameter count for call to {name}",[a.SqlErrorCodes.PrimarySecondaryQualifiers]:"Primary and Secondary SqlInterval qualifiers not supported",[a.SqlErrorCodes.YearMonthIntervals]:"Year-Month Intervals not supported",
[a.SqlErrorCodes.CannotCastValue]:"Cannot cast value to the required data type"};class v extends Error{constructor(e,r){super(c.replace(w[e],r));this.declaredRootClass="esri.arcade.featureset.support.sqlerror";Error.captureStackTrace&&Error.captureStackTrace(this,v)}}a.FeatureSetErrorCodes=void 0;(function(e){e.NeverReach="NeverReach";e.NotImplemented="NotImplemented";e.Cancelled="Cancelled";e.InvalidStatResponse="InvalidStatResponse";e.InvalidRequest="InvalidRequest";e.RequestFailed="RequestFailed";
e.MissingFeatures="MissingFeatures";e.AggregationFieldNotFound="AggregationFieldNotFound";e.DataElementsNotFound="DataElementsNotFound"})(a.FeatureSetErrorCodes||(a.FeatureSetErrorCodes={}));const C={[a.FeatureSetErrorCodes.Cancelled]:"Cancelled",[a.FeatureSetErrorCodes.InvalidStatResponse]:"Invalid statistics response from service",[a.FeatureSetErrorCodes.InvalidRequest]:"Invalid request",[a.FeatureSetErrorCodes.RequestFailed]:"Request failed - {reason}",[a.FeatureSetErrorCodes.MissingFeatures]:"Missing features",
[a.FeatureSetErrorCodes.AggregationFieldNotFound]:"Aggregation field not found",[a.FeatureSetErrorCodes.DataElementsNotFound]:"Data elements not found on service",[a.FeatureSetErrorCodes.NeverReach]:"Encountered unreachable logic",[a.FeatureSetErrorCodes.NotImplemented]:"Not implemented"};class z extends Error{constructor(e,r){super(c.replace(C[e],r));this.declaredRootClass="esri.arcade.featureset.support.featureseterror";Error.captureStackTrace&&Error.captureStackTrace(this,z)}}a.FeatureSetError=
z;a.SqlError=v;a.featureSetErrorMessages=C;a.sqlErrorMessages=w;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/AggregateFunctions":function(){define("exports ../../arcade/featureset/support/errorsupport ./DateOnly ./SqlTimestampOffset ./TimeOnly ../../chunks/datetime".split(" "),function(a,c,w,v,C,z){function e(A){if(null===A)return null;let x=0,E=0;for(let m=0;m<A.length;m++){const h=A[m];if(null!==h){if("number"!==typeof h)throw new c.SqlError(c.SqlErrorCodes.InvalidValueForAggregateFunction);
E++;x+=h}}return 0===E?null:x/A.length}function r(A,x){if(null===A)return null;let E=null,m=null;for(const h of A)A=h,A=h instanceof w.DateOnly?h.toNumber():h instanceof C.TimeOnly?h.toNumber():h instanceof z.DateTime?h.toMillis():h instanceof v.SqlTimeStampOffset?h.toMilliseconds():h,null===E?(E=h,m=A):"max"===x&&null!==m&&null!==A&&m<=A?(E=h,m=A):"min"===x&&null!==m&&null!==A&&m>=A&&(E=h,m=A);return E}function d(A){if(null===A)return null;A=A.filter(m=>null!==m);if(0===A.length)return null;const x=
e(A);if(null===x)return null;let E=0;for(const m of A){if("number"!==typeof m)throw new c.SqlError(c.SqlErrorCodes.InvalidValueForAggregateFunction);E+=(x-m)**2}return E/(A.length-1)}const u={min:{minParams:1,maxParams:1,evaluate:A=>r(A[0],"min")},max:{minParams:1,maxParams:1,evaluate:A=>r(A[0],"max")},avg:{minParams:1,maxParams:1,evaluate:A=>e(A[0])},sum:{minParams:1,maxParams:1,evaluate:A=>{A=A[0];if(null===A)A=null;else{var x=0;for(let E=0;E<A.length;E++){const m=A[E];if(null!==m){if("number"!==
typeof m)throw new c.SqlError(c.SqlErrorCodes.InvalidValueForAggregateFunction);x+=m}}A=x}return A}},stddev:{minParams:1,maxParams:1,evaluate:A=>{A=A[0];null===A?A=null:(A=d(A),A=null===A?null:Math.sqrt(A));return A}},count:{minParams:1,maxParams:1,evaluate:A=>null==A[0]?null:A[0].length},var:{minParams:1,maxParams:1,evaluate:A=>d(A[0])}};a.aggregateFunction=function(A,x){const E=u[A.toLowerCase()];if(null==E)throw new c.SqlError(c.SqlErrorCodes.FunctionNotRecognized);if(x.length<E.minParams||x.length>
E.maxParams)throw new c.SqlError(c.SqlErrorCodes.InvalidParameterCount,{name:A.toUpperCase()});return E.evaluate(x)};a.isAggregate=function(A,x){A=u[A.toLowerCase()];return null!=A&&x>=A.minParams&&x<=A.maxParams};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/DateOnly":function(){define(["exports","../../arcade/ArcadeDate","../../intl/locale","../../chunks/datetime"],function(a,c,w,v){function C(e){e=e.replaceAll(/LTS|LT|L{1,4}|l{1,4}/g,"[$\x26]");let r="";const d=
/(\[[^[]*\])|(\\)?([Hh]mm(ss)?|Mo|M{1,4}|Do|DDDo|D{1,4}|d{2,4}|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;for(const u of e.match(d)||[])switch(u){case "D":r+="d";break;case "DD":r+="dd";break;case "DDD":r+="o";break;case "d":r+="c";break;case "ddd":r+="ccc";break;case "dddd":r+="cccc";break;case "M":r+="L";break;case "MM":r+="LL";break;case "MMM":r+="LLL";break;case "MMMM":r+="LLLL";break;case "YY":r+="yy";
break;case "Y":case "YYYY":r+="yyyy";break;case "Q":r+="q";break;case "X":case "x":r+=u;break;default:r=2<=u.length&&"["===u.slice(0,1)&&"]"===u.slice(-1)?r+`'${u.slice(1,-1)}'`:r+`'${u}'`}return r}class z{constructor(e,r,d){this._year=e;this._month=r;this._day=d;this.declaredRootClass="esri.core.sql.dateonly"}get month(){return this._month}get monthJS(){return this._month-1}get year(){return this._year}get day(){return this._day}get isValid(){return this.toDateTime("unknown").isValid}equals(e){return e instanceof
z&&e.day===this.day&&e.month===this.month&&e.year===this.year}clone(){return new z(this._year,this._month,this._day)}toDateTime(e){return v.DateTime.fromObject({day:this.day,month:this.month,year:this.year},{zone:c.createDateTimeZone(e)})}toDateTimeLuxon(e){return v.DateTime.fromObject({day:this.day,month:this.month,year:this.year},{zone:c.createDateTimeZone(e)})}toString(){return`${this.year.toString().padStart(4,"0")}-${this.month.toString().padStart(2,"0")}-${this.day.toString().padStart(2,"0")}`}toFormat(e=
null,r=!0){if(null===e||""===e)return this.toString();r&&(e=C(e));if(!e)return"";r=this.toDateTime("unknown");return c.ArcadeDate.dateTimeToArcadeDate(r).toFormat(e,{locale:w.getLocale(),numberingSystem:"latn"})}toArcadeDate(){const e=this.toDateTime("unknown");return c.ArcadeDate.dateTimeToArcadeDate(e)}toNumber(){return this.toDateTime("unknown").toMillis()}toJSDate(){return this.toDateTime("unknown").toJSDate()}toStorageFormat(){return this.toFormat("yyyy-LL-dd",!1)}toSQLValue(){return this.toFormat("yyyy-LL-dd",
!1)}toSQLWithKeyword(){return"date '"+this.toFormat("yyyy-LL-dd",!1)+"'"}plus(e,r){return z.fromDateTime(this.toUTCDateTime().plus({[e]:r}))}toUTCDateTime(){return v.DateTime.utc(this.year,this.month,this.day,0,0,0,0)}difference(e,r){switch(r.toLowerCase()){case "days":case "day":case "d":return this.toUTCDateTime().diff(e.toUTCDateTime(),"days").days;case "months":case "month":return this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months;case "minutes":case "minute":case "m":return"M"===r?
this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(e.toUTCDateTime(),"minutes").minutes;case "seconds":case "second":case "s":return this.toUTCDateTime().diff(e.toUTCDateTime(),"seconds").seconds;case "milliseconds":case "millisecond":case "ms":return this.toUTCDateTime().diff(e.toUTCDateTime(),"milliseconds").milliseconds;case "hours":case "hour":case "h":return this.toUTCDateTime().diff(e.toUTCDateTime(),"hours").hours;case "years":case "year":case "y":return this.toUTCDateTime().diff(e.toUTCDateTime(),
"years").years;default:return this.toUTCDateTime().diff(e.toUTCDateTime(),"milliseconds").milliseconds}}static fromMilliseconds(e){e=v.DateTime.fromMillis(e,{zone:v.FixedOffsetZone.utcInstance});return e.isValid?z.fromParts(e.year,e.month,e.day):null}static fromSeconds(e){e=v.DateTime.fromSeconds(e,{zone:v.FixedOffsetZone.utcInstance});return e.isValid?z.fromParts(e.year,e.month,e.day):null}static fromReader(e){if(!e)return null;e=e.split("-");return 3!==e.length?null:new z(parseInt(e[0],10),parseInt(e[1],
10),parseInt(e[2],10))}static fromParts(e,r,d){e=new z(e,r,d);return!1===e.isValid?null:e}static fromDateJS(e){return z.fromParts(e.getFullYear(),e.getMonth()+1,e.getDay())}static fromDateTime(e){return z.fromParts(e.year,e.month,e.day)}static fromSqlTimeStampOffset(e){return this.fromDateTime(e.toDateTime())}static fromString(e,r=null){if(""===e||null===e)return null;var d=[];if(r)(r=C(r))&&d.push(r);else if(null===r||""===r)return e=v.DateTime.fromISO(e,{setZone:!0}),e.isValid?z.fromParts(e.year,
e.month,e.day):null;for(const u of d)if(d=v.DateTime.fromFormat(e,r??u),d.isValid)return new z(d.year,d.month,d.day);return null}static fromNow(e="system"){e=v.DateTime.fromJSDate(new Date).setZone(c.createDateTimeZone(e));return new z(e.year,e.month,e.day)}}a.DateOnly=z;a.standardizeDateOnlyFormat=C;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/SqlTimestampOffset":function(){define(["exports","../../chunks/datetime"],function(a,c){function w(C){return Number.isNaN(C)||
0===C?C:Math.trunc(C)}class v{constructor(C){this._timeStampOffset=C;this._date=null}toDateTime(){this._date??(this._date=c.DateTime.fromISO(this._timeStampOffset,{setZone:!0}));return this._date}get isValid(){return this.toDateTime().isValid}get timezoneOffsetHour(){return w(this.toDateTime().offset/60)}get timezoneOffsetMinutes(){return w(this.toDateTime().offset%60)}toMilliseconds(){return this.toDateTime().toMillis()}get hour(){return this.toDateTime().hour}get minute(){return this.toDateTime().minute}get second(){return this.toDateTime().second}get day(){return this.toDateTime().day}get month(){return this.toDateTime().month}get year(){return this.toDateTime().year}startOfDay(){return v.fromDateTime(this.toDateTime().startOf("day"))}static fromJSDate(C){return new v(c.DateTime.fromJSDate(C).toISO({includeOffset:!0}))}static fromDateTime(C){return new v(C.toISO({includeOffset:!0}))}static fromParts(C,
z,e=0,r=0,d=0,u=0,A=0,x=!1,E=0,m=0){C=`${C.toString().padStart(4,"0")}-${z.toString().padStart(2,"0")}-${e.toString().padStart(2,"0")}`;z="";10>u&&(z="0");r=`${r.toString().padStart(2,"0")}:${d.toString().padStart(2,"0")}:${z+u.toString()}`;0!==A&&(r+="."+A.toString().padStart(3,"0"));A=`${x?"-":"+"}${E.toString().padStart(2,"0")}:${m.toString().padStart(2,"0")}`;return new v(C+"T"+r+A)}toStorageFormat(){return this._timeStampOffset}toString(){return this._timeStampOffset}toSQLValue(){let C=this.toDateTime().toSQL({includeOffset:!0,
includeOffsetSpace:!0});C&&=C.replace(".000","");return C}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}addMilliseconds(C){C=this.toDateTime().plus(C);return v.fromDateTime(C)}}a.SqlTimeStampOffset=v;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/TimeOnly":function(){define(["exports","../../arcade/kernel","../../intl/locale","../../chunks/datetime"],function(a,c,w,v){function C(e){if(!e)return"";const r=/(a|A|hh?|HH?|mm?|ss?|SSS|S|.)/g;let d="";for(const u of e.match(r)||
[])switch(u){case "SSS":d+=u;break;case "A":case "a":d+="a";break;case "m":case "mm":case "h":case "hh":case "H":case "HH":case "s":case "ss":d+=u;break;default:d+=`'${u}'`}return d}class z{constructor(e,r,d,u){this._hour=e;this._minute=r;this._second=d;this._millisecond=u;this.declaredRootClass="esri.core.sql.timeonly"}get hour(){return this._hour}get minute(){return this._minute}get second(){return this._second}get millisecond(){return this._millisecond}equals(e){return e instanceof z&&e.hour===
this.hour&&e.minute===this.minute&&e.second===this.second&&e.millisecond===this.millisecond}clone(){return new z(this.hour,this.minute,this.second,this.millisecond)}isValid(){return c.isInteger(this.hour)&&c.isInteger(this.minute)&&c.isInteger(this.second)&&c.isInteger(this.millisecond)&&0<=this.hour&&24>this.hour&&0<=this.minute&&60>this.minute&&0<=this.second&&60>this.second&&0<=this.millisecond&&1E3>this.millisecond}toString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,
"0")}:${this.second.toString().padStart(2,"0")}`+(0<this.millisecond?"."+this.millisecond.toString().padStart(3,"0"):"")}toSQLValue(){return this.toString()}toSQLWithKeyword(){return`time '${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}${0<this.millisecond?"."+this.millisecond.toString().padStart(3,"0"):""}'`}toStorageString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,
"0")}`}toFormat(e=null){return null===e||""===e?this.toString():(e=C(e))?v.DateTime.local(1970,1,1,this._hour,this._minute,this._second,this._millisecond).toFormat(e,{locale:w.getLocale(),numberingSystem:"latn"}):""}toNumber(){return this.millisecond+1E3*this.second+6E4*this.minute+36E5*this.hour}static fromParts(e,r,d,u){e=new z(e,r,d,u);return e.isValid()?e:null}static fromReader(e){if(!e)return null;e=e.split(":");return 3!==e.length?null:new z(parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],
10),0)}static fromMilliseconds(e){return 864E5<e||0>e?null:new z(Math.floor(e/36E5%24),Math.floor(e/6E4%60),Math.floor(e/1E3%60),Math.floor(e%1E3))}static fromDateJS(e){return new z(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}static fromDateTime(e){return new z(e.hour,e.minute,e.second,e.millisecond)}static fromSqlTimeStampOffset(e){return this.fromDateTime(e.toDateTime())}static fromString(e,r=null){if(""===e||null===e)return null;const d=[];if(r)(r=C(r))&&d.push(r);else if(null===
r||""===r)d.push("HH:mm:ss"),d.push("HH:mm:ss.SSS"),d.push("hh:mm:ss a"),d.push("hh:mm:ss.SSS a"),d.push("HH:mm"),d.push("hh:mm a"),d.push("H:mm"),d.push("h:mm a"),d.push("H:mm:ss"),d.push("h:mm:ss a"),d.push("H:mm:ss.SSS"),d.push("h:mm:ss.SSS a");for(const u of d)if(r=v.DateTime.fromFormat(e,u),r.isValid)return new z(r.hour,r.minute,r.second,r.millisecond);return null}plus(e,r){switch(e){case "days":case "years":case "months":return this.clone();case "hours":case "minutes":case "seconds":case "milliseconds":return z.fromDateTime(this.toUTCDateTime().plus({[e]:r}))}return null}toUTCDateTime(){return v.DateTime.utc(1970,
1,1,this.hour,this.minute,this.second,this.millisecond)}difference(e,r){switch(r.toLowerCase()){case "days":case "day":case "d":return this.toUTCDateTime().diff(e.toUTCDateTime(),"days").days;case "months":case "month":return this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months;case "minutes":case "minute":case "m":return"M"===r?this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(e.toUTCDateTime(),"minutes").minutes;case "seconds":case "second":case "s":return this.toUTCDateTime().diff(e.toUTCDateTime(),
"seconds").seconds;case "milliseconds":case "millisecond":case "ms":return this.toUTCDateTime().diff(e.toUTCDateTime(),"milliseconds").milliseconds;case "hours":case "hour":case "h":return this.toUTCDateTime().diff(e.toUTCDateTime(),"hours").hours;case "years":case "year":case "y":return this.toUTCDateTime().diff(e.toUTCDateTime(),"years").years;default:return this.toUTCDateTime().diff(e.toUTCDateTime(),"milliseconds").milliseconds}}}a.TimeOnly=z;a.standardizeTimeFormat=C;Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/arcade/kernel":function(){define(["exports","../geometry/Extent"],function(a,c){a.cloneGeometry=function(w){if(null==w)return null;const v=w.clone();void 0!==w.cache._geVersion&&(v.cache._geVersion=w.cache._geVersion);return v};a.convertLinearUnitsToCode=function(w){if(null==w)return null;if("number"===typeof w)return w;w=w.toLowerCase();w=w.replaceAll(/\s/g,"");w=w.replaceAll("-","");switch(w){case "meters":case "meter":case "m":case "squaremeters":case "squaremeter":return 9001;
case "miles":case "mile":case "squaremile":case "squaremiles":return 9093;case "kilometers":case "kilometer":case "squarekilometers":case "squarekilometer":case "km":return 9036;case "yard":case "yd":case "yards":case "squareyards":case "squareyard":return 9096;case "feet":case "ft":case "foot":case "squarefeet":case "squarefoot":return 9002;case "nmi":case "nauticalmile":case "nauticalmiles":case "squarenauticalmile":case "squarenauticalmiles":return 9030}return null};a.convertSquareUnitsToCode=
function(w){if(null==w)return null;if("number"===typeof w)return w;w=w.toLowerCase();w=w.replaceAll(/\s/g,"");w=w.replaceAll("-","");switch(w){case "meters":case "meter":case "m":case "squaremeters":case "squaremeter":return 109404;case "miles":case "mile":case "squaremile":case "squaremiles":return 109439;case "kilometers":case "kilometer":case "squarekilometers":case "squarekilometer":case "km":return 109414;case "acres":case "acre":case "ac":return 109402;case "hectares":case "hectare":case "ha":return 109401;
case "yard":case "yd":case "yards":case "squareyards":case "squareyard":return 109442;case "feet":case "ft":case "foot":case "squarefeet":case "squarefoot":return 109405;case "nmi":case "nauticalmile":case "nauticalmiles":case "squarenauticalmile":case "squarenauticalmiles":return 109409}return null};a.isInteger=function(w){return"number"===typeof w&&isFinite(w)&&Math.floor(w)===w};a.sameGeomType=function(w,v){return w===v||"point"===w&&"esriGeometryPoint"===v||"polyline"===w&&"esriGeometryPolyline"===
v||"polygon"===w&&"esriGeometryPolygon"===v||"extent"===w&&"esriGeometryEnvelope"===v||"multipoint"===w&&"esriGeometryMultipoint"===v||"point"===v&&"esriGeometryPoint"===w||"polyline"===v&&"esriGeometryPolyline"===w||"polygon"===v&&"esriGeometryPolygon"===w||"extent"===v&&"esriGeometryEnvelope"===w||"multipoint"===v&&"esriGeometryMultipoint"===w?!0:!1};a.shapeExtent=function(w){if(null==w)return null;switch(w.type){case "polygon":case "multipoint":case "polyline":return w.extent;case "point":return new c({xmin:w.x,
ymin:w.y,xmax:w.x,ymax:w.y,spatialReference:w.spatialReference});case "extent":return w}return null};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/sqlArithmeticUtils":function(){define(["exports","../../arcade/featureset/support/errorsupport","./sqlDateParsingUtils","./SqlInterval","./StandardizedFunctions"],function(a,c,w,v,C){function z(I,O,P){switch(P){case "+":return I+O;case "-":return I-O;case "*":return I*O;case "/":return I/O}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);
}function e(I,O,P){switch(P){case "+":return O.plus({milliseconds:I.valueInMilliseconds()});case "-":return I.valueInMilliseconds()-O.toMillis()}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function r(I,O,P){switch(P){case "+":return O.plus("milliseconds",I.valueInMilliseconds())}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function d(I,O,P){switch(P){case "+":return O.plus("milliseconds",I.valueInMilliseconds())}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function u(I,
O,P){switch(P){case "+":return I.plus("milliseconds",O.valueInMilliseconds());case "-":return I.plus("milliseconds",-1*O.valueInMilliseconds())}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function A(I,O,P){switch(P){case "+":return O.addMilliseconds(I.valueInMilliseconds())}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function x(I,O,P){switch(P){case "+":return v.SqlInterval.createFromMilliseconds(I.valueInMilliseconds()+O.valueInMilliseconds());case "-":return v.SqlInterval.createFromMilliseconds(I.valueInMilliseconds()-
O.valueInMilliseconds());case "*":return v.SqlInterval.createFromMilliseconds(I.valueInMilliseconds()*O.valueInMilliseconds());case "/":return v.SqlInterval.createFromMilliseconds(I.valueInMilliseconds()/O.valueInMilliseconds())}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function E(I,O,P){switch(P){case "+":return v.SqlInterval.createFromMilliseconds(I.valueInMilliseconds()+O);case "-":return v.SqlInterval.createFromMilliseconds(I.valueInMilliseconds()-O);case "*":return v.SqlInterval.createFromMilliseconds(I.valueInMilliseconds()*
O);case "/":return v.SqlInterval.createFromMilliseconds(I.valueInMilliseconds()/O)}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function m(I,O,P){switch(P){case "+":return v.SqlInterval.createFromMilliseconds(I+O.valueInMilliseconds());case "-":return v.SqlInterval.createFromMilliseconds(I-O.valueInMilliseconds());case "*":return v.SqlInterval.createFromMilliseconds(I*O.valueInMilliseconds());case "/":return v.SqlInterval.createFromMilliseconds(I/O.valueInMilliseconds())}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);
}function h(I,O,P){switch(P){case "+":return I.plus("milliseconds",O.valueInMilliseconds());case "-":return I.plus("milliseconds",-1*O.valueInMilliseconds())}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function b(I,O,P){switch(P){case "+":return I.plus({milliseconds:O.valueInMilliseconds()});case "-":return I.minus({milliseconds:O.valueInMilliseconds()})}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function n(I,O,P){switch(P){case "+":return I.addMilliseconds(O.valueInMilliseconds());
case "-":return I.addMilliseconds(-1*O.valueInMilliseconds())}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function p(I,O,P){O*=864E5;switch(P){case "+":return I.plus({milliseconds:O});case "-":return I.minus({milliseconds:O})}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function D(I,O,P){O*=864E5;switch(P){case "+":return I.plus("milliseconds",O);case "-":return I.plus("milliseconds",-1*O)}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function M(I,O,P){O*=864E5;switch(P){case "+":return I.plus("milliseconds",
O);case "-":return I.plus("milliseconds",-1*O)}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function g(I,O,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function J(I,O,P){O*=864E5;switch(P){case "+":return I.addMilliseconds(O);case "-":return I.addMilliseconds(-1*O)}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function R(I,O,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function B(I,O,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function F(I,
O,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function N(I,O,P){O=parseFloat(O);if(isNaN(O))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);return z(I,O,P)}function T(I,O,P){I=parseFloat(I);if(isNaN(I))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);return z(I,O,P)}function y(I,O,P){switch(P){case "+":return I+O}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function G(I,O,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function k(I,O,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);
}function l(I,O,P){switch(P){case "-":return I.toDateTimeLuxon(O.zone).diff(O).as("days")}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function H(I,O,P){switch(P){case "-":return I.toDateTimeLuxon(O.toDateTime().zone).diff(O.toDateTime()).as("days")}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function U(I,O,P){switch(P){case "-":return I.toDateTimeLuxon("UTC").diff(O.toDateTimeLuxon("UTC")).as("days")}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function Q(I,O,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);
}function W(I,O,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function Z(I,O,P){switch(P){case "-":return I.toDateTime().diff(O.toDateTimeLuxon(I.toDateTime().zone)).as("days")}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function ea(I,O,P){switch(P){case "-":return I.toDateTime().diff(O).as("days")}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function ia(I,O,P){switch(P){case "-":return I.toDateTime().diff(O.toDateTime()).as("days")}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);
}function na(I,O,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function qa(I,O,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function va(I,O,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function ta(I,O,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function wa(I,O,P){switch(P){case "-":return I.diff(O).as("days")}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function Ea(I,O,P){switch(P){case "-":return I.diff(O.toDateTimeLuxon(I.zone)).as("days")}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);
}function Da(I,O,P){switch(P){case "-":return I.diff(O.toDateTime()).as("days")}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function Pa(I,O,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function Sa(I,O,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function Ta(I,O,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function Oa(I,O,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function q(I,O,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);
}function K(I,O,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function Y(I,O,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function ba(I,O,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}function ja(I,O,P){throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}a.calculateDateOnlyAndDateOnly=U;a.calculateDateOnlyAndDateTime=l;a.calculateDateOnlyAndNumber=D;a.calculateDateOnlyAndSqlInterval=h;a.calculateDateOnlyAndString=Sa;a.calculateDateOnlyAndTimeOnly=Q;a.calculateDateOnlyAndTimestamp=
H;a.calculateDateTimeAndDateOnly=Ea;a.calculateDateTimeAndDateTime=wa;a.calculateDateTimeAndNumber=p;a.calculateDateTimeAndSqlInterval=b;a.calculateDateTimeAndString=Oa;a.calculateDateTimeAndTimeOnly=Pa;a.calculateDateTimeAndTimestamp=Da;a.calculateNumberAndDateOnly=F;a.calculateNumberAndDateTime=g;a.calculateNumberAndNumber=z;a.calculateNumberAndSqlInterval=m;a.calculateNumberAndString=N;a.calculateNumberAndTimeOnly=B;a.calculateNumberAndTimestamp=R;a.calculateSqlIntervalAndDateOnly=d;a.calculateSqlIntervalAndDateTime=
e;a.calculateSqlIntervalAndNumber=E;a.calculateSqlIntervalAndSqlInterval=x;a.calculateSqlIntervalAndString=G;a.calculateSqlIntervalAndTimeOnly=r;a.calculateSqlIntervalAndTimestamp=A;a.calculateStringAndDateOnly=Y;a.calculateStringAndDateTime=ba;a.calculateStringAndNumber=T;a.calculateStringAndSqlInterval=k;a.calculateStringAndString=y;a.calculateStringAndTimeOnly=K;a.calculateStringAndTimestamp=ja;a.calculateTimeOnlyAndDateOnly=qa;a.calculateTimeOnlyAndDateTime=na;a.calculateTimeOnlyAndNumber=M;a.calculateTimeOnlyAndSqlInterval=
u;a.calculateTimeOnlyAndString=Ta;a.calculateTimeOnlyAndTimeOnly=ta;a.calculateTimeOnlyAndTimestamp=va;a.calculateTimestampAndDateOnly=Z;a.calculateTimestampAndDateTime=ea;a.calculateTimestampAndNumber=J;a.calculateTimestampAndSqlInterval=n;a.calculateTimestampAndString=q;a.calculateTimestampAndTimeOnly=W;a.calculateTimestampAndTimestamp=ia;a.sqlCalculateFunction=function(I,O,P,X){if("||"===I)return C.evaluateFunction("concat",[O,P],X);if(null===O||null===P)return null;if(w.isNumber(O)){if(w.isNumber(P))return z(O,
P,I);if(w.isSqlInterval(P))return m(O,P,I);if(w.isTimeOnly(P))return B();if(w.isDateOnly(P))return F();if(w.isTimestampOffset(P))return R();if(w.isDateTime(P))return g();if(w.isString(P))return N(O,P,I)}else if(w.isDateOnly(O)){if(w.isNumber(P))return D(O,P,I);if(w.isSqlInterval(P))return h(O,P,I);if(w.isTimeOnly(P))return Q();if(w.isDateOnly(P))return U(O,P,I);if(w.isTimestampOffset(P))return H(O,P,I);if(w.isDateTime(P))return l(O,P,I);if(w.isString(P))return Sa()}else if(w.isTimeOnly(O)){if(w.isNumber(P))return M(O,
P,I);if(w.isSqlInterval(P))return u(O,P,I);if(w.isTimeOnly(P))return ta();if(w.isDateOnly(P))return qa();if(w.isTimestampOffset(P))return va();if(w.isDateTime(P))return na();if(w.isString(P))return Ta()}else if(w.isSqlInterval(O)){if(w.isNumber(P))return E(O,P,I);if(w.isSqlInterval(P))return x(O,P,I);if(w.isTimeOnly(P))return r(O,P,I);if(w.isDateOnly(P))return d(O,P,I);if(w.isTimestampOffset(P))return A(O,P,I);if(w.isDateTime(P))return e(O,P,I);if(w.isString(P))return G()}else if(w.isDateTime(O)){if(w.isNumber(P))return p(O,
P,I);if(w.isSqlInterval(P))return b(O,P,I);if(w.isTimeOnly(P))return Pa();if(w.isDateOnly(P))return Ea(O,P,I);if(w.isTimestampOffset(P))return Da(O,P,I);if(w.isDateTime(P))return wa(O,P,I);if(w.isString(P))return Oa()}else if(w.isTimestampOffset(O)){if(w.isNumber(P))return J(O,P,I);if(w.isSqlInterval(P))return n(O,P,I);if(w.isTimeOnly(P))return W();if(w.isDateOnly(P))return Z(O,P,I);if(w.isTimestampOffset(P))return ia(O,P,I);if(w.isDateTime(P))return ea(O,P,I);if(w.isString(P))return q()}else if(w.isString(O)){if(w.isNumber(P))return T(O,
P,I);if(w.isSqlInterval(P))return k();if(w.isTimeOnly(P))return K();if(w.isDateOnly(P))return Y();if(w.isTimestampOffset(P))return ja();if(w.isDateTime(P))return ba();if(w.isString(P))return y(O,P,I)}throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/sqlDateParsingUtils":function(){define("exports ../../arcade/featureset/support/errorsupport ./DateOnly ./SqlInterval ./SqlTimestampOffset ./TimeOnly ./UnknownTimeZone ../../chunks/datetime".split(" "),
function(a,c,w,v,C,z,e,r){function d(p,D,M){M=m.exec(p);if(null!==M){const [,g,J,R,B,F,N,T]=M;p=r.DateTime.fromObject({year:parseInt(g,10),month:parseInt(J,10),day:parseInt(R,10),hour:parseInt(B,10),minute:parseInt(F,10),second:parseInt(N,10),millisecond:T?parseInt(T.replace(".",""),10):0},{zone:e.substituteUnknownTimezone(D)});if(!1===p.isValid)throw new c.SqlError(c.SqlErrorCodes.InvalidTimeStamp);return p}M=h.exec(p);if(null!==M){const [,g,J,R,B,F,N,T,y,G,k]=M;p=C.SqlTimeStampOffset.fromParts(parseInt(g,
10),parseInt(J,10),parseInt(R,10),parseInt(B,10),parseInt(F,10),parseInt(N,10),T?parseInt(T.replace(".",""),10):0,"-"===y,parseInt(G,10),parseInt(k,10));if(!1===p.isValid)throw new c.SqlError(c.SqlErrorCodes.InvalidTimeStamp);return p}M=b.exec(p);if(null!==M){const [,g,J,R,B,F,N,T,y]=M;p=C.SqlTimeStampOffset.fromParts(parseInt(g,10),parseInt(J,10),parseInt(R,10),parseInt(B,10),parseInt(F,10),0,0,"-"===N,parseInt(T,10),parseInt(y,10));if(!1===p.isValid)throw new c.SqlError(c.SqlErrorCodes.InvalidTimeStamp);
return p}M=n.exec(p);if(null!==M){const [,g,J,R,B,F]=M;p=r.DateTime.fromObject({year:parseInt(g,10),month:parseInt(J,10),day:parseInt(R,10),hour:parseInt(B,10),minute:parseInt(F,10),second:0},{zone:e.substituteUnknownTimezone(D)});if(!1===p.isValid)throw new c.SqlError(c.SqlErrorCodes.InvalidTimeStamp);return p}M=E.exec(p);if(null!==M){const [,g,J,R]=M;p=r.DateTime.fromObject({year:parseInt(g,10),month:parseInt(J,10),day:parseInt(R,10),hour:0,minute:0,second:0},{zone:e.substituteUnknownTimezone(D)});
if(!1===p.isValid)throw new c.SqlError(c.SqlErrorCodes.InvalidTimeStamp);return p}throw new c.SqlError(c.SqlErrorCodes.InvalidTimeStamp);}const u=/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/,A=/^(\d{1,2}):(\d{1,2})$/,x=/^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/,E=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,m=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$/,h=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,b=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,
n=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/;a.convertToExecutingTimeZone=function(p,D){if(D instanceof r.Zone)return D===e.UnknownTimeZone.instance?r.DateTime.fromMillis(p.getTime(),{zone:e.UnknownTimeZone.instance}):r.DateTime.fromJSDate(p,{zone:D});switch(D){case "system":case "local":case null:return r.DateTime.fromJSDate(p);default:return"unknown"===D?.toLowerCase()?r.DateTime.fromMillis(p.getTime(),{zone:e.UnknownTimeZone.instance}):r.DateTime.fromJSDate(p,{zone:D})}};a.isDate=function(p){return p instanceof
Date};a.isDateOnly=function(p){return p instanceof w.DateOnly};a.isDateTime=function(p){return p instanceof r.DateTime};a.isNumber=function(p){return"number"===typeof p};a.isSqlInterval=function(p){return p instanceof v.SqlInterval};a.isString=function(p){return"string"===typeof p||p instanceof String};a.isTimeOnly=function(p){return p instanceof z.TimeOnly};a.isTimestampOffset=function(p){return p instanceof C.SqlTimeStampOffset};a.parseDate=function(p,D){const M=E.exec(p);if(null===M)try{return d(p,
D)}catch{throw new c.SqlError(c.SqlErrorCodes.InvalidDate);}const [,g,J,R]=M;p=w.DateOnly.fromParts(parseInt(g,10),parseInt(J,10),parseInt(R,10));if(null===p)throw new c.SqlError(c.SqlErrorCodes.InvalidDate);return p};a.parseTime=function(p){let D=u.exec(p);if(null!==D){const [,M,g,J]=D;p=z.TimeOnly.fromParts(parseInt(M,10),parseInt(g,10),parseInt(J,10),0);if(null!==p)return p;throw new c.SqlError(c.SqlErrorCodes.InvalidTime);}D=A.exec(p);if(null!==D){const [,M,g]=D;p=z.TimeOnly.fromParts(parseInt(M,
10),parseInt(g,10),0,0);if(null!==p)return p;throw new c.SqlError(c.SqlErrorCodes.InvalidTime);}D=x.exec(p);if(null!==D){const [,M,g,J,R]=D;p=z.TimeOnly.fromParts(parseInt(M,10),parseInt(g,10),parseInt(J,10),parseInt(R,10));if(null!==p)return p}throw new c.SqlError(c.SqlErrorCodes.InvalidTime);};a.parseTimestamp=d;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/SqlInterval":function(){define(["exports","../../arcade/featureset/support/errorsupport"],function(a,c){class w{constructor(){this.op=
"+";this.millis=this.minute=this.year=this.month=this.hour=this.second=this.day=0}static _fixDefaults(v){if(null!==v.precision||null!==v.secondary)throw new c.SqlError(c.SqlErrorCodes.PrimarySecondaryQualifiers);}static _parseSecondsComponent(v,C){C.includes(".")?(C=C.split("."),v.second=parseFloat(C[0]),v.millis=parseInt(C[1],10)):v.second=parseFloat(C)}static createFromMilliseconds(v){const C=new w;C.second=v/1E3;return C}static createFromValueAndQualifier(v,C,z){let e=null;const r=new w;r.op="-"===
z?"-":"+";if("interval-period"===C.type){w._fixDefaults(C);z=RegExp("^[0-9]{1,}$");if("year"===C.period||"month"===C.period)throw new c.SqlError(c.SqlErrorCodes.YearMonthIntervals);if("second"===C.period)if(/^[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/.test(v))w._parseSecondsComponent(r,v);else throw new c.SqlError(c.SqlErrorCodes.IllegalInterval);else if(z.test(v))r[C.period]=parseFloat(v);else throw new c.SqlError(c.SqlErrorCodes.IllegalInterval);}else{w._fixDefaults(C.start);w._fixDefaults(C.end);if("year"===
C.start.period||"month"===C.start.period||"year"===C.end.period||"month"===C.end.period)throw new c.SqlError(c.SqlErrorCodes.YearMonthIntervals);switch(C.start.period){case "day":switch(C.end.period){case "hour":e=RegExp("^[0-9]{1,} [0-9]{1,}$");if(e.test(v))r[C.start.period]=parseFloat(v.split(" ")[0]),r[C.end.period]=parseFloat(v.split(" ")[1]);else throw new c.SqlError(c.SqlErrorCodes.IllegalInterval);break;case "minute":e=RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$");if(e.test(v))r[C.start.period]=
parseFloat(v.split(" ")[0]),v=v.split(" ")[1].split(":"),r.hour=parseFloat(v[0]),r.minute=parseFloat(v[1]);else throw new c.SqlError(c.SqlErrorCodes.IllegalInterval);break;case "second":e=RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(e.test(v))r[C.start.period]=parseFloat(v.split(" ")[0]),v=v.split(" ")[1].split(":"),r.hour=parseFloat(v[0]),r.minute=parseFloat(v[1]),w._parseSecondsComponent(r,v[2]);else throw new c.SqlError(c.SqlErrorCodes.IllegalInterval);break;default:throw new c.SqlError(c.SqlErrorCodes.IllegalInterval);
}break;case "hour":switch(C.end.period){case "minute":e=RegExp("^[0-9]{1,}:[0-9]{1,}$");if(e.test(v))r.hour=parseFloat(v.split(":")[0]),r.minute=parseFloat(v.split(":")[1]);else throw new c.SqlError(c.SqlErrorCodes.IllegalInterval);break;case "second":e=RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(e.test(v))v=v.split(":"),r.hour=parseFloat(v[0]),r.minute=parseFloat(v[1]),w._parseSecondsComponent(r,v[2]);else throw new c.SqlError(c.SqlErrorCodes.IllegalInterval);break;default:throw new c.SqlError(c.SqlErrorCodes.IllegalInterval);
}break;case "minute":switch(C.end.period){case "second":e=RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(e.test(v))v=v.split(":"),r.minute=parseFloat(v[0]),w._parseSecondsComponent(r,v[1]);else throw new c.SqlError(c.SqlErrorCodes.IllegalInterval);break;default:throw new c.SqlError(c.SqlErrorCodes.IllegalInterval);}break;default:throw new c.SqlError(c.SqlErrorCodes.IllegalInterval);}}return r}valueInMilliseconds(){return("-"===this.op?-1:1)*(this.millis+1E3*this.second+6E4*this.minute+36E5*
this.hour+864E5*this.day+365/12*this.month*864E5+31536E6*this.year)}}a.SqlInterval=w;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/StandardizedFunctions":function(){define("exports ../../arcade/featureset/support/errorsupport ../string ./DateOnly ./sqlCompareUtils ./sqlDateParsingUtils ./TimeOnly ../../chunks/datetime".split(" "),function(a,c,w,v,C,z,e,r){function d(b){return"string"===typeof b||b instanceof String}function u(b){return z.isDate(b)||z.isDateOnly(b)||
z.isDateTime(b)||z.isTimeOnly(b)||z.isTimestampOffset(b)?!1:!0}function A(b){return z.isDateOnly(b)||z.isTimeOnly(b)?b.toString():z.isTimestampOffset(b)?b.toSQLValue():z.isDateTime(b)?0===b.millisecond?b.toFormat("yyyy-LL-dd HH:mm:ss"):b.toSQL({includeOffset:!1}):z.isDate(b)?A(r.DateTime.fromJSDate(b)):b.toString()}function x(b){if(z.isDate(b))return v.DateOnly.fromDateJS(b);if(z.isDateTime(b))return v.DateOnly.fromParts(b.year,b.month,b.day);if(z.isDateOnly(b))return b;if(z.isTimeOnly(b))throw new c.SqlError(c.SqlErrorCodes.CannotCastValue);
if(z.isTimestampOffset(b)&&null===v.DateOnly.fromParts(b.year,b.month,b.day))throw new c.SqlError(c.SqlErrorCodes.CannotCastValue);if(d(b)&&(b=v.DateOnly.fromReader(b),null!==b&&b.isValid))return b;throw new c.SqlError(c.SqlErrorCodes.CannotCastValue);}function E(b,n,p){if(z.isDate(b))return z.convertToExecutingTimeZone(b,n);if(z.isDateTime(b))return b;if(z.isDateOnly(b))return b.toDateTimeLuxon("unknown");if(z.isTimeOnly(b))throw new c.SqlError(c.SqlErrorCodes.CannotCastValue);if(z.isTimestampOffset(b))return b;
if(d(b))return z.parseTimestamp(b,"unknown",p);throw new c.SqlError(c.SqlErrorCodes.CannotCastValue);}function m(b){if(z.isDate(b))return e.TimeOnly.fromDateJS(b);if(z.isDateTime(b))return e.TimeOnly.fromDateTime(b);if(z.isDateOnly(b))throw new c.SqlError(c.SqlErrorCodes.CannotCastValue);if(z.isTimeOnly(b))return b;if(z.isTimestampOffset(b))return e.TimeOnly.fromSqlTimeStampOffset(b);if(d(b))return z.parseTime(b);throw new c.SqlError(c.SqlErrorCodes.CannotCastValue);}const h={extract:{minParams:2,
maxParams:2,evaluate:([b,n])=>{if(null==n)return null;if(z.isDate(n))switch(b.toUpperCase()){case "SECOND":return n.getSeconds();case "MINUTE":return n.getMinutes();case "HOUR":return n.getHours();case "DAY":return n.getDate();case "MONTH":return n.getMonth()+1;case "YEAR":return n.getFullYear();case "TIMEZONE_HOUR":return 0;case "TIMEZONE_MINUTE":return 0}else if(z.isDateTime(n))switch(b.toUpperCase()){case "SECOND":return n.second;case "MINUTE":return n.minute;case "HOUR":return n.hour;case "DAY":return n.day;
case "MONTH":return n.month;case "YEAR":return n.year}else if(z.isDateOnly(n))switch(b.toUpperCase()){case "DAY":return n.day;case "MONTH":return n.month;case "YEAR":return n.year}else if(z.isTimeOnly(n))switch(b.toUpperCase()){case "SECOND":return n.second;case "MINUTE":return n.minute;case "HOUR":return n.hour}else if(z.isTimestampOffset(n))switch(b.toUpperCase()){case "SECOND":return n.second;case "MINUTE":return n.minute;case "HOUR":return n.hour;case "DAY":return n.day;case "MONTH":return n.month;
case "YEAR":return n.year;case "TIMEZONE_HOUR":return n.timezoneOffsetHour;case "TIMEZONE_MINUTE":return n.timezoneOffsetMinutes}throw new c.SqlError(c.SqlErrorCodes.InvalidFunctionParameters,{function:"EXTRACT"});}},substring:{minParams:2,maxParams:3,evaluate:b=>{if(2===b.length){const [n,p]=b;return null==n||null==p?null:n.toString().substring(p-1)}if(3===b.length){const [n,p,D]=b;return null==n||null==p||null==D?null:0>=D?"":n.toString().substring(p-1,p+D-1)}}},position:{minParams:2,maxParams:2,
evaluate:([b,n])=>null==b||null==n?null:n.indexOf(b)+1},trim:{minParams:2,maxParams:3,evaluate:b=>{var n=3===b.length,p=n?b[1]:" ";n=n?b[2]:b[1];if(null==p||null==n)return null;p=`(${w.escapeRegExpString(p)})`;switch(b[0]){case "BOTH":return n.replaceAll(new RegExp(`^${p}*|${p}*$`,"g"),"");case "LEADING":return n.replaceAll(new RegExp(`^${p}*`,"g"),"");case "TRAILING":return n.replaceAll(new RegExp(`${p}*$`,"g"),"")}throw new c.SqlError(c.SqlErrorCodes.InvalidFunctionParameters,{function:"TRIM"});
}},abs:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:Math.abs(b[0])},ceiling:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:Math.ceil(b[0])},floor:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:Math.floor(b[0])},log:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:Math.log(b[0])},log10:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:Math.log(b[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:Math.sin(b[0])},cos:{minParams:1,maxParams:1,evaluate:b=>
null==b[0]?null:Math.cos(b[0])},tan:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:Math.tan(b[0])},asin:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:Math.asin(b[0])},acos:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:Math.acos(b[0])},atan:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:Math.atan(b[0])},sign:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:0<b[0]?1:0>b[1]?-1:0},power:{minParams:2,maxParams:2,evaluate:b=>null==b[0]||null==b[1]?null:b[0]**b[1]},mod:{minParams:2,
maxParams:2,evaluate:b=>null==b[0]||null==b[1]?null:b[0]%b[1]},round:{minParams:1,maxParams:2,evaluate:b=>{const n=b[0];b=2===b.length?10**b[1]:1;return null==n?null:Math.round(n*b)/b}},truncate:{minParams:1,maxParams:2,evaluate:b=>null==b[0]?null:1===b.length?parseInt(b[0].toFixed(0),10):parseFloat(b[0].toFixed(b[1]))},char_length:{minParams:1,maxParams:1,evaluate:b=>d(b[0])?b[0].length:0},concat:{minParams:1,maxParams:Infinity,evaluate:b=>{let n="";for(let p=0;p<b.length;p++){if(null==b[p])return null;
n+=b[p].toString()}return n}},lower:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:b[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:b[0].toString().toUpperCase()},coalesce:{minParams:1,maxParams:Infinity,evaluate:b=>{for(const n of b)if(null!==n)return n;return null}},cosh:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:Math.cosh(b[0])},sinh:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:Math.sinh(b[0])},tanh:{minParams:1,maxParams:1,evaluate:b=>
null==b[0]?null:Math.tanh(b[0])},nullif:{minParams:2,maxParams:2,evaluate:(b,n)=>C.sqlCompare(b[0],b[1],"\x3d")?null:b[0]},cast:{minParams:2,maxParams:2,evaluate:(b,n)=>{const p=b[0];b=b[1];if(null===p)return null;switch(b.type){case "integer":if(!u(p))throw new c.SqlError(c.SqlErrorCodes.CannotCastValue);n=parseInt(p,10);if(isNaN(n))throw new c.SqlError(c.SqlErrorCodes.CannotCastValue);return n;case "smallint":if(!u(p))throw new c.SqlError(c.SqlErrorCodes.CannotCastValue);n=parseInt(p,10);if(isNaN(n))throw new c.SqlError(c.SqlErrorCodes.CannotCastValue);
if(32767<n||-32767>n)throw new c.SqlError(c.SqlErrorCodes.CannotCastValue);return n;case "float":case "real":if(!u(p))throw new c.SqlError(c.SqlErrorCodes.CannotCastValue);n=parseFloat(p);if(isNaN(n))throw new c.SqlError(c.SqlErrorCodes.CannotCastValue);return n;case "time":return m(p);case "date":return x(p);case "timestamp":return E(p,n,!0===b.withtimezone);case "varchar":n=A(p);if(n.length>b.size)throw new c.SqlError(c.SqlErrorCodes.CannotCastValue);return n;default:throw new c.SqlError(c.SqlErrorCodes.InvalidDataType);
}}}};a.evaluateFunction=function(b,n,p){const D=h[b.toLowerCase()];if(null==D)throw new c.SqlError(c.SqlErrorCodes.FunctionNotRecognized);if(n.length<D.minParams||n.length>D.maxParams)throw new c.SqlError(c.SqlErrorCodes.InvalidParameterCount,{name:b.toUpperCase()});return D.evaluate(n,p)};a.isStandardized=function(b,n){b=h[b.toLowerCase()];return null!=b&&n>=b.minParams&&n<=b.maxParams};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/sqlCompareUtils":function(){define("exports ../../arcade/featureset/support/errorsupport ./sqlDateParsingUtils ./SqlTimestampOffset ./UnknownTimeZone ../../chunks/datetime".split(" "),
function(a,c,w,v,C,z){function e(b){return w.isDateTime(b)||w.isTimestampOffset(b)?!0:!1}function r(b){return w.isDateTime(b)||w.isDateOnly(b)||w.isTimestampOffset(b)||w.isTimeOnly(b)?!0:!1}function d(b){if(w.isDateTime(b))return b.toMillis();if(w.isDateOnly(b))return b.toNumber();if(w.isTimestampOffset(b))return b.toMilliseconds();throw new c.SqlError(c.SqlErrorCodes.InvalidDataType);}function u(b,n,p){switch(p){case "\x3c\x3e":return b!==n;case "\x3d":return b===n;case "\x3e":return b>n;case "\x3c":return b<
n;case "\x3e\x3d":return b>=n;case "\x3c\x3d":return b<=n}}function A(b,n,p){const D=parseFloat(n);if(!isNaN(D))return u(b,D,p);b=b.toString();switch(p){case "\x3c\x3e":return b!==n;case "\x3d":return b===n;case "\x3e":return b>n;case "\x3c":return b<n;case "\x3e\x3d":return b>=n;case "\x3c\x3d":return b<=n}}function x(b,n,p){const D=parseFloat(b);if(!isNaN(D))return u(D,n,p);n=n.toString();switch(p){case "\x3c\x3e":return b!==n;case "\x3d":return b===n;case "\x3e":return b>n;case "\x3c":return b<
n;case "\x3e\x3d":return b>=n;case "\x3c\x3d":return b<=n}}function E(b,n,p){switch(p){case "\x3c\x3e":return b!==n;case "\x3d":return b===n;case "\x3e":return b>n;case "\x3c":return b<n;case "\x3e\x3d":return b>=n;case "\x3c\x3d":return b<=n}}function m(b,n,p){b instanceof v.SqlTimeStampOffset&&(b=b.toDateTime());n instanceof v.SqlTimeStampOffset&&(n=n.toDateTime());b=h(b);n=h(n);switch(p){case "\x3c\x3e":return b!==n;case "\x3d":return b===n;case "\x3e":return b>n;case "\x3c":return b<n;case "\x3e\x3d":return b>=
n;case "\x3c\x3d":return b<=n}}function h(b){return 321408E5*b.year+26784E5*b.month+864E5*b.day+36E5*b.hour+6E4*b.minute+1E3*b.second+b.millisecond}a.dateValueInMilliseconds=d;a.isDateOrTimeValue=r;a.isDateTimeComparableValue=e;a.sqlCompare=function(b,n,p,D){if(null==b||null==n)return null;if(w.isNumber(b)){if(w.isNumber(n))return u(b,n,p);if(w.isString(n))return A(b,n,p);if(r(n))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);if(w.isDateOnly(n))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);
}else if(w.isString(b)){if(w.isNumber(n))return x(b,n,p);if(w.isString(n))return E(b,n,p);if(w.isDateTime(n))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);if(w.isDateOnly(n))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);if(w.isTimeOnly(n))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);if(w.isTimestampOffset(n))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}else if(w.isDateTime(b)){if(e(n)){if(b instanceof z.DateTime&&C.isUnknownTimeZone(b.zone)){if(n instanceof z.DateTime&&
!1===C.isUnknownTimeZone(n.zone)||n instanceof v.SqlTimeStampOffset)return m(b,n,p)}else if(n instanceof z.DateTime&&C.isUnknownTimeZone(n.zone)&&(b instanceof z.DateTime&&!1===C.isUnknownTimeZone(b.zone)||b instanceof v.SqlTimeStampOffset))return m(b,n,p);return u(d(b),d(n),p)}if(w.isString(n))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);if(w.isDateOnly(n))return n=n.toDateTimeLuxon(b.zone),b=b.startOf("day"),u(b.toMillis(),n.toMillis(),p);if(w.isTimeOnly(n))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);
if(w.isNumber(n))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}else if(w.isDateOnly(b)){if(w.isTimestampOffset(n))return b=b.toDateTimeLuxon(n.toDateTime().zone),n=n.startOfDay(),u(b.toMillis(),n.toMilliseconds(),p);if(w.isDateTime(n))return b=b.toDateTimeLuxon(n.zone),n=n.startOf("day"),u(b.toMillis(),n.toMillis(),p);if(w.isString(n))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);if(w.isDateOnly(n))return u(b.toNumber(),n.toNumber(),p);if(w.isTimeOnly(n))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);
if(w.isNumber(n))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}else if(w.isTimeOnly(b)){if(w.isTimeOnly(n))return u(b.toNumber(),n.toNumber(),p);if(w.isString(n))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);if(w.isNumber(n))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);if(w.isDateOnly(n))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);if(e(n))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}else if(w.isTimestampOffset(b)){if(e(n))return n instanceof z.DateTime&&
C.isUnknownTimeZone(n.zone)?m(b,n,p):u(d(b),d(n),p);if(w.isString(n))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);if(w.isDateOnly(n))return n=n.toDateTimeLuxon(b.toDateTime().zone),b=b.startOfDay(),u(b.toMilliseconds(),n.toMillis(),p);if(w.isTimeOnly(n))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);if(w.isNumber(n))throw new c.SqlError(c.SqlErrorCodes.InvalidOperator);}switch(p){case "\x3c\x3e":return b!==n;case "\x3d":return b===n;case "\x3e":return b>n;case "\x3c":return b<n;case "\x3e\x3d":return b>=
n;case "\x3c\x3d":return b<=n}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereGrammar":function(){define(["exports","../../chunks/_commonjsHelpers"],function(a,c){var w={exports:{}};(function(z){(function(e,r){z.exports&&(z.exports=r())})(c.commonjsGlobal,function(){function e(d,u,A,x){d=Error.call(this,d);Object.setPrototypeOf&&Object.setPrototypeOf(d,e.prototype);d.expected=u;d.found=A;d.location=x;d.name="SyntaxError";return d}function r(d,u,A){A=A||" ";if(d.length>
u)return d;u-=d.length;A+=A.repeat(u);return d+A.slice(0,u)}(function(d,u){function A(){this.constructor=d}A.prototype=u.prototype;d.prototype=new A})(e,Error);e.prototype.format=function(d){var u="Error: "+this.message;if(this.location){var A=null,x;for(x=0;x<d.length;x++)if(d[x].source===this.location.source){A=d[x].text.split(/\r\n|\n|\r/g);break}d=this.location.start;x=this.location.source&&"function"===typeof this.location.source.offset?this.location.source.offset(d):d;var E=this.location.source+
":"+x.line+":"+x.column;if(A){var m=this.location.end,h=r("",x.line.toString().length," ");A=A[d.line-1];m=(d.line===m.line?m.column:A.length+1)-d.column||1;u+="\n --\x3e "+E+"\n"+h+" |\n"+x.line+" | "+A+"\n"+h+" | "+r("",d.column-1," ")+r("",m,"^")}else u+="\n at "+E}return u};e.buildMessage=function(d,u){function A(b){return b.charCodeAt(0).toString(16).toUpperCase()}function x(b){return b.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,
"\\r").replace(/[\x00-\x0F]/g,function(n){return"\\x0"+A(n)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(n){return"\\x"+A(n)})}function E(b){return b.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(n){return"\\x0"+A(n)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(n){return"\\x"+A(n)})}function m(b){return h[b.type](b)}var h={literal:function(b){return'"'+
x(b.text)+'"'},class:function(b){var n=b.parts.map(function(p){return Array.isArray(p)?E(p[0])+"-"+E(p[1]):E(p)});return"["+(b.inverted?"^":"")+n.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(b){return b.description}};return"Expected "+function(b){b=b.map(m);var n,p;b.sort();if(0<b.length){for(p=n=1;n<b.length;n++)b[n-1]!==b[n]&&(b[p]=b[n],p++);b.length=p}switch(b.length){case 1:return b[0];case 2:return b[0]+" or "+b[1];default:return b.slice(0,
-1).join(", ")+", or "+b[b.length-1]}}(d)+" but "+(u?'"'+x(u)+'"':"end of input")+" found."};return{SyntaxError:e,parse:function(d,u){function A(L,S){S=void 0!==S?S:h(oa,t);throw new e(L,null,null,S);}function x(L,S){return{type:"literal",text:L,ignoreCase:S}}function E(L,S,V){return{type:"class",parts:L,inverted:S,ignoreCase:V}}function m(L){var S=Yb[L],V;if(!S){for(V=L-1;!Yb[V];)V--;S=Yb[V];for(S={line:S.line,column:S.column};V<L;)10===d.charCodeAt(V)?(S.line++,S.column=1):S.column++,V++;Yb[L]=
S}return S}function h(L,S,V){V=m(L);var da=m(S);return{source:Md,start:{offset:L,line:V.line,column:V.column},end:{offset:S,line:da.line,column:da.column}}}function b(L){t<eb||(t>eb&&(eb=t,yc=[]),yc.push(L))}function n(){var L=t;ka();var S=D();S!==f?(ka(),oa=L,L=S):(t=L,L=f);return L}function p(){var L=t;var S=D();if(S!==f){var V=[];var da=t;var ra=ka();var za=Wa();if(za!==f){var Fa=ka();var Ga=D();Ga!==f?da=ra=[ra,za,Fa,Ga]:(t=da,da=f)}else t=da,da=f;for(;da!==f;)V.push(da),da=t,ra=ka(),za=Wa(),
za!==f?(Fa=ka(),Ga=D(),Ga!==f?da=ra=[ra,za,Fa,Ga]:(t=da,da=f)):(t=da,da=f);oa=L;L={type:"expression-list"};S=[S];for(da=0;da<V.length;da++)S.push(V[da][3]);L.value=S}else t=L,L=f;return L}function D(){var L=t;var S=M();if(S!==f){var V=[];var da=t;var ra=ka();var za=P();if(za!==f){var Fa=ka();var Ga=M();Ga!==f?da=ra=[ra,za,Fa,Ga]:(t=da,da=f)}else t=da,da=f;for(;da!==f;)V.push(da),da=t,ra=ka(),za=P(),za!==f?(Fa=ka(),Ga=M(),Ga!==f?da=ra=[ra,za,Fa,Ga]:(t=da,da=f)):(t=da,da=f);oa=L;L=nb(S,V)}else t=L,
L=f;return L}function M(){var L=t;var S=g();if(S!==f){var V=[];var da=t;var ra=ka();var za=O();if(za!==f){var Fa=ka();var Ga=g();Ga!==f?da=ra=[ra,za,Fa,Ga]:(t=da,da=f)}else t=da,da=f;for(;da!==f;)V.push(da),da=t,ra=ka(),za=O(),za!==f?(Fa=ka(),Ga=g(),Ga!==f?da=ra=[ra,za,Fa,Ga]:(t=da,da=f)):(t=da,da=f);oa=L;L=nb(S,V)}else t=L,L=f;return L}function g(){var L=t;var S=I();if(S===f){S=t;if(33===d.charCodeAt(t)){var V=Nd;t++}else V=f,0===ha&&b(Od);if(V!==f){var da=t;ha++;if(61===d.charCodeAt(t)){var ra=
Rc;t++}else ra=f,0===ha&&b(Sc);ha--;ra===f?da=void 0:(t=da,da=f);da!==f?S=V=[V,da]:(t=S,S=f)}else t=S,S=f}S!==f?(V=ka(),da=g(),da!==f?(oa=L,L={type:"unary-expression",operator:"NOT",expr:da}):(t=L,L=f)):(t=L,L=f);if(L===f){S=t;L=F();if(L!==f){ka();V=t;da=[];ra=t;var za=ka();var Fa=J();if(Fa!==f){var Ga=ka();var ob=F();ob!==f?ra=za=[za,Fa,Ga,ob]:(t=ra,ra=f)}else t=ra,ra=f;if(ra!==f)for(;ra!==f;)da.push(ra),ra=t,za=ka(),Fa=J(),Fa!==f?(Ga=ka(),ob=F(),ob!==f?ra=za=[za,Fa,Ga,ob]:(t=ra,ra=f)):(t=ra,ra=
f);else da=f;da!==f&&(oa=V,da={type:"arithmetic",tail:da});V=da;V===f&&(V=t,da=B(),da!==f?(ka(),ra=Ja(),ra!==f?(ka(),ra=p(),ra!==f?(ka(),za=Ka(),za!==f?(oa=V,V={op:da,right:ra}):(t=V,V=f)):(t=V,V=f)):(t=V,V=f)):(t=V,V=f),V===f&&(V=t,da=B(),da!==f?(ka(),ra=Ja(),ra!==f?(ka(),ra=Ka(),ra!==f?(oa=V,V={op:da,right:{type:"expression-list",value:[]}}):(t=V,V=f)):(t=V,V=f)):(t=V,V=f),V===f&&(V=t,da=B(),da!==f?(ka(),ra=Z(),ra!==f?(oa=V,V={op:da,right:ra}):(t=V,V=f)):(t=V,V=f))),V===f&&(V=t,za=I(),za!==f?(ka(),
da=X(),da!==f?(ka(),ra=F(),ra!==f?(ka(),Fa=O(),Fa!==f?(ka(),za=F(),za!==f?(oa=V,V={op:"NOT"+da,right:{type:"expression-list",value:[ra,za]}}):(t=V,V=f)):(t=V,V=f)):(t=V,V=f)):(t=V,V=f)):(t=V,V=f),V===f&&(V=t,za=X(),za!==f?(ka(),da=F(),da!==f?(ka(),ra=O(),ra!==f?(ka(),Fa=F(),Fa!==f?(oa=V,V={op:za,right:{type:"expression-list",value:[da,Fa]}}):(t=V,V=f)):(t=V,V=f)):(t=V,V=f)):(t=V,V=f)),V===f&&(V=t,da=ba(),da!==f?(ka(),ra=I(),ra!==f?(ka(),ra=F(),ra!==f?(oa=V,V={op:da+"NOT",right:ra}):(t=V,V=f)):(t=
V,V=f)):(t=V,V=f),V===f&&(V=t,da=ba(),da!==f?(ka(),ra=F(),ra!==f?(oa=V,V={op:da,right:ra}):(t=V,V=f)):(t=V,V=f)),V===f&&(V=t,da=R(),da!==f?(ka(),ra=ta(),ra!==f?(ka(),za=t,d.substr(t,6).toLowerCase()===Pd?(Fa=d.substr(t,6),t+=6):(Fa=f,0===ha&&b(Qd)),Fa!==f?(Fa=t,ha++,Ga=H(),ha--,Ga===f?Fa=void 0:(t=Fa,Fa=f),Fa!==f?(oa=za,za="ESCAPE"):(t=za,za=f)):(t=za,za=f),za!==f?(ka(),za=wa(),za!==f?(oa=V,V={op:da,right:ra,escape:za.value}):(t=V,V=f)):(t=V,V=f)):(t=V,V=f)):(t=V,V=f),V===f&&(V=t,da=R(),da!==f?(ka(),
ra=ta(),ra!==f?(oa=V,V={op:da,right:ra,escape:""}):(t=V,V=f)):(t=V,V=f))))));V===f&&(V=null);oa=S;S=V;""==S||void 0==S||null==S?S=L:(V=null,S=V="arithmetic"==S.type?nb(L,S.tail):Mb(S.op,L,S.right,S.escape))}else t=S,S=f;L=S}return L}function J(){if(d.substr(t,2)===Tc){var L=Tc;t+=2}else L=f,0===ha&&b(Rd);L===f&&(62===d.charCodeAt(t)?(L=Sd,t++):(L=f,0===ha&&b(Td)),L===f&&(d.substr(t,2)===Uc?(L=Uc,t+=2):(L=f,0===ha&&b(Ud)),L===f&&(d.substr(t,2)===Vc?(L=Vc,t+=2):(L=f,0===ha&&b(Vd)),L===f&&(60===d.charCodeAt(t)?
(L=Wd,t++):(L=f,0===ha&&b(Xd)),L===f&&(61===d.charCodeAt(t)?(L=Rc,t++):(L=f,0===ha&&b(Sc)),L===f&&(d.substr(t,2)===Wc?(L=Wc,t+=2):(L=f,0===ha&&b(Yd))))))));return L}function R(){var L;var S=L=t;var V=I();if(V!==f){var da=ka();var ra=ja();ra!==f?S=V=[V,da,ra]:(t=S,S=f)}else t=S,S=f;S!==f&&(oa=L,S=S[0]+" "+S[2]);L=S;L===f&&(L=ja());return L}function B(){var L;var S=L=t;var V=I();if(V!==f){var da=ka();var ra=Y();ra!==f?S=V=[V,da,ra]:(t=S,S=f)}else t=S,S=f;S!==f&&(oa=L,S=S[0]+" "+S[2]);L=S;L===f&&(L=
Y());return L}function F(){var L=t;var S=T();if(S!==f){var V=[];var da=t;var ra=ka();var za=N();if(za!==f){var Fa=ka();var Ga=T();Ga!==f?da=ra=[ra,za,Fa,Ga]:(t=da,da=f)}else t=da,da=f;for(;da!==f;)V.push(da),da=t,ra=ka(),za=N(),za!==f?(Fa=ka(),Ga=T(),Ga!==f?da=ra=[ra,za,Fa,Ga]:(t=da,da=f)):(t=da,da=f);oa=L;L=nb(S,V)}else t=L,L=f;return L}function N(){if(43===d.charCodeAt(t)){var L=zc;t++}else L=f,0===ha&&b(Ac);L===f&&(45===d.charCodeAt(t)?(L=Bc,t++):(L=f,0===ha&&b(Cc)),L===f&&(d.substr(t,2)===Xc?
(L=Xc,t+=2):(L=f,0===ha&&b(Zd))));return L}function T(){var L=t;var S=G();if(S!==f){var V=[];var da=t;var ra=ka();var za=y();if(za!==f){var Fa=ka();var Ga=G();Ga!==f?da=ra=[ra,za,Fa,Ga]:(t=da,da=f)}else t=da,da=f;for(;da!==f;)V.push(da),da=t,ra=ka(),za=y(),za!==f?(Fa=ka(),Ga=G(),Ga!==f?da=ra=[ra,za,Fa,Ga]:(t=da,da=f)):(t=da,da=f);oa=L;L=nb(S,V)}else t=L,L=f;return L}function y(){if(42===d.charCodeAt(t)){var L=$d;t++}else L=f,0===ha&&b(ae);L===f&&(47===d.charCodeAt(t)?(L=be,t++):(L=f,0===ha&&b(ce)));
return L}function G(){var L=wa();if(L===f){var S=t;var V=t;var da=Sa();if(da!==f){var ra=Ta();if(ra!==f){var za=Oa();za!==f?(oa=V,V=parseFloat(da+ra+za)):(t=V,V=f)}else t=V,V=f}else t=V,V=f;V===f&&(V=t,da=Sa(),da!==f?(ra=Ta(),ra!==f?(oa=V,V=parseFloat(da+ra)):(t=V,V=f)):(t=V,V=f),V===f&&(V=t,da=Sa(),da!==f?(ra=Oa(),ra!==f?(oa=V,V=parseFloat(da+ra)):(t=V,V=f)):(t=V,V=f),V===f&&(V=t,da=Sa(),da!==f&&(oa=V,da=parseFloat(da)),V=da)));var Fa=V;if(Fa!==f){var Ga=t;ha++;var ob=l();ha--;ob===f?Ga=void 0:(t=
Ga,Ga=f);Ga!==f?(oa=S,S={type:"number",value:Fa}):(t=S,S=f)}else t=S,S=f;L=S;if(L===f){var pb=t;var Jb=t;if(d.substr(t,4).toLowerCase()===de){var Zb=d.substr(t,4);t+=4}else Zb=f,0===ha&&b(ee);if(Zb!==f){var Nb=t;ha++;var fe=H();ha--;fe===f?Nb=void 0:(t=Nb,Nb=f);Nb!==f?Jb=Zb=[Zb,Nb]:(t=Jb,Jb=f)}else t=Jb,Jb=f;var qb=Jb;qb!==f&&(oa=pb,qb={type:"boolean",value:!0});pb=qb;if(pb===f){pb=t;var Kb=t;if(d.substr(t,5).toLowerCase()===ge){var $b=d.substr(t,5);t+=5}else $b=f,0===ha&&b(he);if($b!==f){var Ob=
t;ha++;var ie=H();ha--;ie===f?Ob=void 0:(t=Ob,Ob=f);Ob!==f?Kb=$b=[$b,Ob]:(t=Kb,Kb=f)}else t=Kb,Kb=f;qb=Kb;qb!==f&&(oa=pb,qb={type:"boolean",value:!1});pb=qb}L=pb;if(L===f){var je=t;var Lb=t;if(d.substr(t,4).toLowerCase()===ke){var ac=d.substr(t,4);t+=4}else ac=f,0===ha&&b(le);if(ac!==f){var Pb=t;ha++;var me=H();ha--;me===f?Pb=void 0:(t=Pb,Pb=f);Pb!==f?Lb=ac=[ac,Pb]:(t=Lb,Lb=f)}else t=Lb,Lb=f;var Dc=Lb;Dc!==f&&(oa=je,Dc={type:"null",value:null});L=Dc;if(L===f){var rb=t;if(la()!==f){ka();var bc=ta();
bc!==f?(oa=rb,"string"===bc.type&&!0!==/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(bc.value)&&A("Date literal is invalid"),rb={type:"date",value:bc.value}):(t=rb,rb=f)}else t=rb,rb=f;L=rb;if(L===f){var sb=
t;if(fa()!==f){ka();var cc=ta();cc!==f?(oa=sb,"string"===cc.type&&!0!==/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(cc.value)&&A("Timestamp literal is invalid"),sb={type:"timestamp",value:cc.value}):
(t=sb,sb=f)}else t=sb,sb=f;L=sb;if(L===f){var Ua=t;var Ec=ua();if(Ec!==f){ka();if(45===d.charCodeAt(t)){var hb=Bc;t++}else hb=f,0===ha&&b(Cc);hb===f&&(43===d.charCodeAt(t)?(hb=zc,t++):(hb=f,0===ha&&b(Ac)));if(hb!==f){ka();var Qb=ta();if(Qb!==f){ka();var Yc=ia();Yc!==f?(oa=Ua,Ua={type:"interval",value:Qb,qualifier:Yc,op:hb}):(t=Ua,Ua=f)}else t=Ua,Ua=f}else t=Ua,Ua=f}else t=Ua,Ua=f;Ua===f&&(Ua=t,Ec=ua(),Ec!==f?(ka(),hb=ta(),hb!==f?(ka(),Qb=ia(),Qb!==f?(oa=Ua,Ua={type:"interval",value:hb,qualifier:Qb,
op:""}):(t=Ua,Ua=f)):(t=Ua,Ua=f)):(t=Ua,Ua=f));L=Ua;if(L===f){var tb=t;if(ma()!==f){ka();var dc=ta();dc!==f?(oa=tb,"string"===dc.type&&!0!==/^(\d{1,2}):(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/.test(dc.value)&&A("Time literal is invalid"),tb={type:"time",value:dc.value}):(t=tb,tb=f)}else t=tb,tb=f;L=tb}}}}}}}var La=L;if(La===f){var Za=t;var ub=t;if(d.substr(t,7).toLowerCase()===ne){var Zc=d.substr(t,7);t+=7}else Zc=f,0===ha&&b(oe);if(Zc!==f){var ec=t;ha++;
var pe=H();ha--;pe===f?ec=void 0:(t=ec,ec=f);ec!==f?(oa=ub,ub="EXTRACT"):(t=ub,ub=f)}else t=ub,ub=f;if(ub!==f){ka();var qe=Ja();if(qe!==f){ka();var $a=pa();if($a===f&&($a=sa(),$a===f&&($a=Ca(),$a===f&&($a=xa(),$a===f&&($a=Ba(),$a===f&&($a=Aa(),$a===f)))))){var vb=t;if(d.substr(t,13).toLowerCase()===re){var $c=d.substr(t,13);t+=13}else $c=f,0===ha&&b(se);if($c!==f){var fc=t;ha++;var te=H();ha--;te===f?fc=void 0:(t=fc,fc=f);fc!==f?(oa=vb,vb="TIMEZONE_HOUR"):(t=vb,vb=f)}else t=vb,vb=f;$a=vb;if($a===
f){var wb=t;if(d.substr(t,15).toLowerCase()===ue){var ad=d.substr(t,15);t+=15}else ad=f,0===ha&&b(ve);if(ad!==f){var gc=t;ha++;var we=H();ha--;we===f?gc=void 0:(t=gc,gc=f);gc!==f?(oa=wb,wb="TIMEZONE_MINUTE"):(t=wb,wb=f)}else t=wb,wb=f;$a=wb}}var bd=$a;if(bd!==f){ka();var xe=aa();if(xe!==f){ka();var cd=D();if(cd!==f){ka();var ye=Ka();ye!==f?(oa=Za,Za={type:"function",name:"extract",args:{type:"expression-list",value:[{type:"string",value:bd},cd]}}):(t=Za,Za=f)}else t=Za,Za=f}else t=Za,Za=f}else t=
Za,Za=f}else t=Za,Za=f}else t=Za,Za=f;La=Za;if(La===f){var ab=t;var xb=t;if(d.substr(t,9).toLowerCase()===ze){var dd=d.substr(t,9);t+=9}else dd=f,0===ha&&b(Ae);if(dd!==f){var hc=t;ha++;var Be=H();ha--;Be===f?hc=void 0:(t=hc,hc=f);hc!==f?(oa=xb,xb="SUBSTRING"):(t=xb,xb=f)}else t=xb,xb=f;if(xb!==f){ka();var Ce=Ja();if(Ce!==f){ka();var Fc=D();if(Fc!==f){ka();var De=aa();if(De!==f){ka();var Gc=D();if(Gc!==f){ka();var ib=t;var yb=t;if(d.substr(t,3).toLowerCase()===Ee){var ed=d.substr(t,3);t+=3}else ed=
f,0===ha&&b(Fe);if(ed!==f){var ic=t;ha++;var Ge=H();ha--;Ge===f?ic=void 0:(t=ic,ic=f);ic!==f?(oa=yb,yb="FOR"):(t=yb,yb=f)}else t=yb,yb=f;var Rb=yb;if(Rb!==f){var He=ka();var fd=D();if(fd!==f){var Ie=ka();ib=Rb=[Rb,He,fd,Ie]}else t=ib,ib=f}else t=ib,ib=f;ib===f&&(ib=null);Rb=Ka();Rb!==f?(oa=ab,ab={type:"function",name:"substring",args:{type:"expression-list",value:ib?[Fc,Gc,ib[2]]:[Fc,Gc]}}):(t=ab,ab=f)}else t=ab,ab=f}else t=ab,ab=f}else t=ab,ab=f}else t=ab,ab=f}else t=ab,ab=f;La=ab;if(La===f){var Na=
t;var Hc=ca();if(Hc!==f){ka();var Ic=Ja();if(Ic!==f){ka();var jb=ea();jb===f&&(jb=null);ka();var Sb=D();if(Sb!==f){ka();var Jc=aa();if(Jc!==f){ka();var gd=D();if(gd!==f){ka();var Je=Ka();Je!==f?(oa=Na,Na={type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:null==jb?"BOTH":jb},Sb,gd]}}):(t=Na,Na=f)}else t=Na,Na=f}else t=Na,Na=f}else t=Na,Na=f}else t=Na,Na=f}else t=Na,Na=f;Na===f&&(Na=t,Hc=ca(),Hc!==f?(ka(),Ic=Ja(),Ic!==f?(ka(),jb=ea(),jb===f&&(jb=null),ka(),Sb=D(),
Sb!==f?(ka(),Jc=Ka(),Jc!==f?(oa=Na,Na={type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:null==jb?"BOTH":jb},Sb]}}):(t=Na,Na=f)):(t=Na,Na=f)):(t=Na,Na=f)):(t=Na,Na=f));La=Na;if(La===f){var bb=t;var zb=t;if(d.substr(t,8).toLowerCase()===Ke){var hd=d.substr(t,8);t+=8}else hd=f,0===ha&&b(Le);if(hd!==f){var jc=t;ha++;var Me=H();ha--;Me===f?jc=void 0:(t=jc,jc=f);jc!==f?(oa=zb,zb="POSITION"):(t=zb,zb=f)}else t=zb,zb=f;if(zb!==f){ka();var Ne=Ja();if(Ne!==f){ka();var id=
D();if(id!==f){ka();var Oe=Y();if(Oe!==f){ka();var jd=D();if(jd!==f){ka();var Pe=Ka();Pe!==f?(oa=bb,bb={type:"function",name:"position",args:{type:"expression-list",value:[id,jd]}}):(t=bb,bb=f)}else t=bb,bb=f}else t=bb,bb=f}else t=bb,bb=f}else t=bb,bb=f}else t=bb,bb=f;La=bb;if(La===f){var cb=t;var Ab=t;if(d.substr(t,4).toLowerCase()===Qe){var kd=d.substr(t,4);t+=4}else kd=f,0===ha&&b(Re);if(kd!==f){var kc=t;ha++;var Se=H();ha--;Se===f?kc=void 0:(t=kc,kc=f);kc!==f?(oa=Ab,Ab="CAST"):(t=Ab,Ab=f)}else t=
Ab,Ab=f;if(Ab!==f){ka();var Te=Ja();if(Te!==f){ka();var ld=D();if(ld!==f){ka();var Bb=t;if(d.substr(t,2).toLowerCase()===Ue){var md=d.substr(t,2);t+=2}else md=f,0===ha&&b(Ve);if(md!==f){var lc=t;ha++;var We=H();ha--;We===f?lc=void 0:(t=lc,lc=f);lc!==f?(oa=Bb,Bb="AS"):(t=Bb,Bb=f)}else t=Bb,Bb=f;var Xe=Bb;if(Xe!==f){ka();var Ha=t;var Cb=t;if(d.substr(t,7).toLowerCase()===Ye){var nd=d.substr(t,7);t+=7}else nd=f,0===ha&&b(Ze);if(nd!==f){var mc=t;ha++;var $e=H();ha--;$e===f?mc=void 0:(t=mc,mc=f);mc!==
f?(oa=Cb,Cb="INTEGER"):(t=Cb,Cb=f)}else t=Cb,Cb=f;var Ma=Cb;Ma!==f&&(oa=Ha,Ma={type:"data-type",value:{type:"integer"}});Ha=Ma;if(Ha===f){Ha=t;var Db=t;if(d.substr(t,8).toLowerCase()===af){var od=d.substr(t,8);t+=8}else od=f,0===ha&&b(bf);if(od!==f){var nc=t;ha++;var cf=H();ha--;cf===f?nc=void 0:(t=nc,nc=f);nc!==f?(oa=Db,Db="SMALLINT"):(t=Db,Db=f)}else t=Db,Db=f;Ma=Db;Ma!==f&&(oa=Ha,Ma={type:"data-type",value:{type:"smallint"}});Ha=Ma;if(Ha===f){Ha=t;var Eb=t;if(d.substr(t,5).toLowerCase()===df){var pd=
d.substr(t,5);t+=5}else pd=f,0===ha&&b(ef);if(pd!==f){var oc=t;ha++;var ff=H();ha--;ff===f?oc=void 0:(t=oc,oc=f);oc!==f?(oa=Eb,Eb="FLOAT"):(t=Eb,Eb=f)}else t=Eb,Eb=f;Ma=Eb;Ma!==f&&(oa=Ha,Ma={type:"data-type",value:{type:"float"}});Ha=Ma;if(Ha===f){Ha=t;var Fb=t;if(d.substr(t,4).toLowerCase()===gf){var qd=d.substr(t,4);t+=4}else qd=f,0===ha&&b(hf);if(qd!==f){var pc=t;ha++;var jf=H();ha--;jf===f?pc=void 0:(t=pc,pc=f);pc!==f?(oa=Fb,Fb="REAL"):(t=Fb,Fb=f)}else t=Fb,Fb=f;Ma=Fb;Ma!==f&&(oa=Ha,Ma={type:"data-type",
value:{type:"real"}});Ha=Ma;if(Ha===f&&(Ha=t,Ma=la(),Ma!==f&&(oa=Ha,Ma={type:"data-type",value:{type:"date"}}),Ha=Ma,Ha===f&&(Ha=t,Ma=fa(),Ma!==f&&(oa=Ha,Ma={type:"data-type",value:{type:"timestamp"}}),Ha=Ma,Ha===f&&(Ha=t,Ma=ma(),Ma!==f&&(oa=Ha,Ma={type:"data-type",value:{type:"time"}}),Ha=Ma,Ha===f)))){Ha=t;var Gb=t;if(d.substr(t,7).toLowerCase()===kf){var rd=d.substr(t,7);t+=7}else rd=f,0===ha&&b(lf);if(rd!==f){var qc=t;ha++;var mf=H();ha--;mf===f?qc=void 0:(t=qc,qc=f);qc!==f?(oa=Gb,Gb="VARCHAR"):
(t=Gb,Gb=f)}else t=Gb,Gb=f;Ma=Gb;if(Ma!==f){ka();var nf=Ja();if(nf!==f){ka();var sd=q();if(sd!==f){ka();var of=Ka();of!==f?(oa=Ha,Ha={type:"data-type",value:{type:"varchar",size:parseInt(sd)}}):(t=Ha,Ha=f)}else t=Ha,Ha=f}else t=Ha,Ha=f}else t=Ha,Ha=f}}}}var td=Ha;if(td!==f){ka();var pf=Ka();pf!==f?(oa=cb,cb={type:"function",name:"cast",args:{type:"expression-list",value:[ld,td]}}):(t=cb,cb=f)}else t=cb,cb=f}else t=cb,cb=f}else t=cb,cb=f}else t=cb,cb=f}else t=cb,cb=f;La=cb;if(La===f){var kb=t;var db=
t;var Tb=k();Tb!==f&&(oa=db);db=Tb;if(db===f)if(db=t,96===d.charCodeAt(t)?(Tb=ud,t++):(Tb=f,0===ha&&b(vd)),Tb!==f){var rc=[];if(wd.test(d.charAt(t))){var lb=d.charAt(t);t++}else lb=f,0===ha&&b(xd);if(lb!==f)for(;lb!==f;)rc.push(lb),wd.test(d.charAt(t))?(lb=d.charAt(t),t++):(lb=f,0===ha&&b(xd));else rc=f;rc!==f?(96===d.charCodeAt(t)?(lb=ud,t++):(lb=f,0===ha&&b(vd)),lb!==f?(oa=db,db=rc.join("")):(t=db,db=f)):(t=db,db=f)}else t=db,db=f;var yd=db;if(yd!==f){ka();var qf=Ja();if(qf!==f){ka();var sc=p();
sc===f&&(sc=null);ka();var rf=Ka();rf!==f?(oa=kb,kb={type:"function",name:yd,args:sc?sc:{type:"expression-list",value:[]}}):(t=kb,kb=f)}else t=kb,kb=f}else t=kb,kb=f;La=kb;if(La===f){var fb;var Va=t;var Kc=ya();if(Kc!==f){ka();var Ub=D();if(Ub!==f){ka();var Vb=[];for(fb=Da();fb!==f;)Vb.push(fb),fb=Da();fb=ka();var tc=Ia();tc!==f?(oa=Va,Va={type:"case-expression",format:"simple",operand:Ub,clauses:Vb,else:null}):(t=Va,Va=f)}else t=Va,Va=f}else t=Va,Va=f;if(Va===f)if(Va=t,Kc=ya(),Kc!==f)if(ka(),Ub=
D(),Ub!==f){ka();Vb=[];for(fb=Da();fb!==f;)Vb.push(fb),fb=Da();fb=ka();tc=Pa();if(tc!==f){ka();var sf=Ia();sf!==f?(oa=Va,Va={type:"case-expression",format:"simple",operand:Ub,clauses:Vb,else:tc.value}):(t=Va,Va=f)}else t=Va,Va=f}else t=Va,Va=f;else t=Va,Va=f;var Lc=Va;if(Lc===f){var gb;var Xa=t;var Mc=ya();if(Mc!==f){ka();var Wb=[];for(gb=Ea();gb!==f;)Wb.push(gb),gb=Ea();gb=ka();var uc=Ia();uc!==f?(oa=Xa,Xa={type:"case-expression",format:"searched",clauses:Wb,else:null}):(t=Xa,Xa=f)}else t=Xa,Xa=
f;if(Xa===f)if(Xa=t,Mc=ya(),Mc!==f){ka();Wb=[];for(gb=Ea();gb!==f;)Wb.push(gb),gb=Ea();gb=ka();uc=Pa();if(uc!==f){ka();var tf=Ia();tf!==f?(oa=Xa,Xa={type:"case-expression",format:"searched",clauses:Wb,else:uc.value}):(t=Xa,Xa=f)}else t=Xa,Xa=f}else t=Xa,Xa=f;Lc=Xa}La=Lc;if(La===f){var Hb=t;var uf=t;var vc;var Xb=t;var zd=l();if(zd!==f){var Ad=[];for(vc=U();vc!==f;)Ad.push(vc),vc=U();oa=Xb;Xb=zd+Ad.join("")}else t=Xb,Xb=f;var Bd=Xb;Bd!==f&&(oa=uf);var mb=Bd;if(mb!==f){oa=Hb;var Nc=mb;mb=/^CURRENT_DATE$/i.test(Nc)?
{type:"current-time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(Nc)?{type:"current-time",mode:"timestamp"}:{type:"column-reference",table:"",column:Nc}}Hb=mb;if(Hb===f){Hb=t;var Ib=t;if(W()!==f){var wc;var vf=t;var Oc=[];for(wc=Q();wc!==f;)Oc.push(wc),wc=Q();oa=vf;var wf=Oc=Oc.join("");var xf=W();xf!==f?(oa=Ib,Ib=wf):(t=Ib,Ib=f)}else t=Ib,Ib=f;mb=Ib;mb!==f&&(oa=Hb,mb={type:"column-reference",table:"",column:mb,delimited:!0});Hb=mb}La=Hb;if(La===f&&(La=Z(),La===f)){La=t;var yf=Ja();if(yf!==f){ka();var Pc=
D();if(Pc!==f){ka();var zf=Ka();zf!==f?(oa=La,Pc.paren=!0,La=Pc):(t=La,La=f)}else t=La,La=f}else t=La,La=f}}}}}}}}}return La}function k(){var L;var S=t;var V=l();if(V!==f){var da=[];for(L=H();L!==f;)da.push(L),L=H();oa=S;S=V+da.join("")}else t=S,S=f;return S}function l(){if(Af.test(d.charAt(t))){var L=d.charAt(t);t++}else L=f,0===ha&&b(Bf);return L}function H(){if(Cf.test(d.charAt(t))){var L=d.charAt(t);t++}else L=f,0===ha&&b(Df);return L}function U(){if(Cd.test(d.charAt(t))){var L=d.charAt(t);t++}else L=
f,0===ha&&b(Dd);return L}function Q(){if(Cd.test(d.charAt(t))){var L=d.charAt(t);t++}else L=f,0===ha&&b(Dd);if(L===f)if(L=t,W()!==f){var S=W();S!==f?(oa=L,L='"'):(t=L,L=f)}else t=L,L=f;return L}function W(){if(Ef.test(d.charAt(t))){var L=d.charAt(t);t++}else L=f,0===ha&&b(Ff);return L}function Z(){var L;var S=L=t;if(64===d.charCodeAt(t)){var V=Gf;t++}else V=f,0===ha&&b(Hf);if(V!==f){var da=k();da!==f?S=V=[V,da]:(t=S,S=f)}else t=S,S=f;S!==f&&(oa=L,S={type:"parameter",value:S[1]});return S}function ea(){var L=
t;if(d.substr(t,7).toLowerCase()===If){var S=d.substr(t,7);t+=7}else S=f,0===ha&&b(Jf);if(S!==f){S=t;ha++;var V=H();ha--;V===f?S=void 0:(t=S,S=f);S!==f?(oa=L,L="LEADING"):(t=L,L=f)}else t=L,L=f;L===f&&(L=t,d.substr(t,8).toLowerCase()===Kf?(S=d.substr(t,8),t+=8):(S=f,0===ha&&b(Lf)),S!==f?(S=t,ha++,V=H(),ha--,V===f?S=void 0:(t=S,S=f),S!==f?(oa=L,L="TRAILING"):(t=L,L=f)):(t=L,L=f),L===f&&(L=t,d.substr(t,4).toLowerCase()===Mf?(S=d.substr(t,4),t+=4):(S=f,0===ha&&b(Nf)),S!==f?(S=t,ha++,V=H(),ha--,V===f?
S=void 0:(t=S,S=f),S!==f?(oa=L,L="BOTH"):(t=L,L=f)):(t=L,L=f)));return L}function ia(){var L=t;var S=t;var V=na();if(V!==f){ka();var da=Ja();if(da!==f)if(ka(),da=va(),da!==f){ka();var ra=Ka();ra!==f?(oa=S,S={type:"interval-period",period:V.value,precision:da,secondary:null}):(t=S,S=f)}else t=S,S=f;else t=S,S=f}else t=S,S=f;S===f&&(S=t,V=na(),V!==f&&(oa=S,V={type:"interval-period",period:V.value,precision:null,secondary:null}),S=V);if(S!==f)if(ka(),V=t,d.substr(t,2).toLowerCase()===Of?(da=d.substr(t,
2),t+=2):(da=f,0===ha&&b(Pf)),da!==f?(da=t,ha++,ra=H(),ha--,ra===f?da=void 0:(t=da,da=f),da!==f?(oa=V,V="TO"):(t=V,V=f)):(t=V,V=f),V!==f){ka();V=t;da=na();da!==f&&(oa=V,da={type:"interval-period",period:da.value,precision:null,secondary:null});V=da;if(V===f){V=t;da=Aa();if(da!==f)if(ka(),da=Ja(),da!==f)if(ka(),da=va(),da!==f)if(ka(),ra=Wa(),ra!==f)if(ka(),ra=qa(),ra!==f){ka();var za=Ka();za!==f?(oa=V,V={type:"interval-period",period:"second",precision:da,secondary:ra}):(t=V,V=f)}else t=V,V=f;else t=
V,V=f;else t=V,V=f;else t=V,V=f;else t=V,V=f;V===f&&(V=t,da=Aa(),da!==f?(ka(),da=Ja(),da!==f?(ka(),da=va(),da!==f?(ka(),ra=Ka(),ra!==f?(oa=V,V={type:"interval-period",period:"second",precision:da,secondary:null}):(t=V,V=f)):(t=V,V=f)):(t=V,V=f)):(t=V,V=f),V===f&&(V=t,da=Aa(),da!==f&&(oa=V,da={type:"interval-period",period:"second",precision:null,secondary:null}),V=da))}V!==f?(oa=L,L={type:"interval-qualifier",start:S,end:V}):(t=L,L=f)}else t=L,L=f;else t=L,L=f;L===f&&(L=t,V=na(),V!==f?(ka(),S=Ja(),
S!==f?(ka(),S=qa(),S!==f?(ka(),da=Ka(),da!==f?(oa=L,L={type:"interval-period",period:V.value,precision:S,secondary:null}):(t=L,L=f)):(t=L,L=f)):(t=L,L=f)):(t=L,L=f),L===f&&(L=t,V=na(),V!==f&&(oa=L,V={type:"interval-period",period:V.value,precision:null,secondary:null}),L=V,L===f&&(L=t,V=Aa(),V!==f?(ka(),S=Ja(),S!==f?(ka(),S=va(),S!==f?(ka(),da=Wa(),da!==f?(ka(),V=qa(),V!==f?(ka(),da=Ka(),da!==f?(oa=L,L={type:"interval-period",period:"second",precision:S,secondary:V}):(t=L,L=f)):(t=L,L=f)):(t=L,L=
f)):(t=L,L=f)):(t=L,L=f)):(t=L,L=f),L===f&&(L=t,V=Aa(),V!==f?(ka(),S=Ja(),S!==f?(ka(),S=qa(),S!==f?(ka(),da=Ka(),da!==f?(oa=L,L={type:"interval-period",period:"second",precision:S,secondary:null}):(t=L,L=f)):(t=L,L=f)):(t=L,L=f)):(t=L,L=f),L===f&&(L=t,V=Aa(),V!==f&&(oa=L,V={type:"interval-period",period:"second",precision:null,secondary:null}),L=V)))));return L}function na(){var L=t;var S=Ca();S!==f&&(oa=L,S={type:"string",value:"day"});L=S;L===f&&(L=t,S=xa(),S!==f&&(oa=L,S={type:"string",value:"hour"}),
L=S,L===f&&(L=t,S=Ba(),S!==f&&(oa=L,S={type:"string",value:"minute"}),L=S,L===f&&(L=t,S=sa(),S!==f&&(oa=L,S={type:"string",value:"month"}),L=S,L===f&&(L=t,S=pa(),S!==f&&(oa=L,S={type:"string",value:"year"}),L=S))));return L}function qa(){var L=t;var S=q();S!==f&&(oa=L,S=parseFloat(S));return S}function va(){var L=t;var S=q();S!==f&&(oa=L,S=parseFloat(S));return S}function ta(){var L=wa();L===f&&(L=Z());return L}function wa(){var L=t;if(39===d.charCodeAt(t)){var S=Ed;t++}else S=f,0===ha&&b(Fd);S===
f&&(d.substr(t,2)===Gd?(S=Gd,t+=2):(S=f,0===ha&&b(Qf)));if(S!==f){S=[];var V=t;if(d.substr(t,2)===xc){var da=xc;t+=2}else da=f,0===ha&&b(Hd);da!==f&&(oa=V,da="'");V=da;V===f&&(Id.test(d.charAt(t))?(V=d.charAt(t),t++):(V=f,0===ha&&b(Jd)));for(;V!==f;)S.push(V),V=t,d.substr(t,2)===xc?(da=xc,t+=2):(da=f,0===ha&&b(Hd)),da!==f&&(oa=V,da="'"),V=da,V===f&&(Id.test(d.charAt(t))?(V=d.charAt(t),t++):(V=f,0===ha&&b(Jd)));39===d.charCodeAt(t)?(V=Ed,t++):(V=f,0===ha&&b(Fd));V!==f?(oa=L,L={type:"string",value:S.join("")}):
(t=L,L=f)}else t=L,L=f;return L}function Ea(){var L=t;if(Qa()!==f){ka();var S=D();if(S!==f){ka();var V=Ya();V!==f?(ka(),V=D(),V!==f?(oa=L,L={type:"when-clause",operand:S,value:V}):(t=L,L=f)):(t=L,L=f)}else t=L,L=f}else t=L,L=f;return L}function Da(){var L=t;if(Qa()!==f){ka();var S=D();if(S!==f){ka();var V=Ya();V!==f?(ka(),V=D(),V!==f?(oa=L,L={type:"when-clause",operand:S,value:V}):(t=L,L=f)):(t=L,L=f)}else t=L,L=f}else t=L,L=f;return L}function Pa(){var L=t;var S=t;if(d.substr(t,4).toLowerCase()===
Rf){var V=d.substr(t,4);t+=4}else V=f,0===ha&&b(Sf);if(V!==f){V=t;ha++;var da=H();ha--;da===f?V=void 0:(t=V,V=f);V!==f?(oa=S,S="ELSE"):(t=S,S=f)}else t=S,S=f;S!==f?(ka(),S=D(),S!==f?(oa=L,L={type:"else-clause",value:S}):(t=L,L=f)):(t=L,L=f);return L}function Sa(){var L=q();if(L===f){L=t;if(45===d.charCodeAt(t)){var S=Bc;t++}else S=f,0===ha&&b(Cc);S===f&&(43===d.charCodeAt(t)?(S=zc,t++):(S=f,0===ha&&b(Ac)));if(S!==f){var V=q();V!==f?(oa=L,L=S[0]+V):(t=L,L=f)}else t=L,L=f}return L}function Ta(){var L=
t;if(46===d.charCodeAt(t)){var S=Tf;t++}else S=f,0===ha&&b(Uf);S!==f?(S=q(),S===f&&(S=null),oa=L,L="."+(null!=S?S:"")):(t=L,L=f);return L}function Oa(){var L;var S=L=t;if(Vf.test(d.charAt(t))){var V=d.charAt(t);t++}else V=f,0===ha&&b(Wf);V!==f?(Xf.test(d.charAt(t))?(V=d.charAt(t),t++):(V=f,0===ha&&b(Yf)),V===f&&(V=null),oa=S,S="e"+(null===V?"":V)):(t=S,S=f);S!==f?(V=q(),V!==f?(oa=L,L=S+V):(t=L,L=f)):(t=L,L=f);return L}function q(){var L=t;var S=[];var V=K();if(V!==f)for(;V!==f;)S.push(V),V=K();else S=
f;S!==f&&(oa=L,S=S.join(""));return S}function K(){if(Zf.test(d.charAt(t))){var L=d.charAt(t);t++}else L=f,0===ha&&b($f);return L}function Y(){var L=t;if(d.substr(t,2).toLowerCase()===ag){var S=d.substr(t,2);t+=2}else S=f,0===ha&&b(bg);if(S!==f){S=t;ha++;var V=H();ha--;V===f?S=void 0:(t=S,S=f);S!==f?(oa=L,L="IN"):(t=L,L=f)}else t=L,L=f;return L}function ba(){var L=t;if(d.substr(t,2).toLowerCase()===cg){var S=d.substr(t,2);t+=2}else S=f,0===ha&&b(dg);if(S!==f){S=t;ha++;var V=H();ha--;V===f?S=void 0:
(t=S,S=f);S!==f?(oa=L,L="IS"):(t=L,L=f)}else t=L,L=f;return L}function ja(){var L=t;if(d.substr(t,4).toLowerCase()===eg){var S=d.substr(t,4);t+=4}else S=f,0===ha&&b(fg);if(S!==f){S=t;ha++;var V=H();ha--;V===f?S=void 0:(t=S,S=f);S!==f?(oa=L,L="LIKE"):(t=L,L=f)}else t=L,L=f;return L}function I(){var L=t;if(d.substr(t,3).toLowerCase()===gg){var S=d.substr(t,3);t+=3}else S=f,0===ha&&b(hg);if(S!==f){S=t;ha++;var V=H();ha--;V===f?S=void 0:(t=S,S=f);S!==f?(oa=L,L="NOT"):(t=L,L=f)}else t=L,L=f;return L}function O(){var L=
t;if(d.substr(t,3).toLowerCase()===ig){var S=d.substr(t,3);t+=3}else S=f,0===ha&&b(jg);if(S!==f){S=t;ha++;var V=H();ha--;V===f?S=void 0:(t=S,S=f);S!==f?(oa=L,L="AND"):(t=L,L=f)}else t=L,L=f;return L}function P(){var L=t;if(d.substr(t,2).toLowerCase()===kg){var S=d.substr(t,2);t+=2}else S=f,0===ha&&b(lg);if(S!==f){S=t;ha++;var V=H();ha--;V===f?S=void 0:(t=S,S=f);S!==f?(oa=L,L="OR"):(t=L,L=f)}else t=L,L=f;return L}function X(){var L=t;if(d.substr(t,7).toLowerCase()===mg){var S=d.substr(t,7);t+=7}else S=
f,0===ha&&b(ng);if(S!==f){S=t;ha++;var V=H();ha--;V===f?S=void 0:(t=S,S=f);S!==f?(oa=L,L="BETWEEN"):(t=L,L=f)}else t=L,L=f;return L}function aa(){var L=t;if(d.substr(t,4).toLowerCase()===og){var S=d.substr(t,4);t+=4}else S=f,0===ha&&b(pg);if(S!==f){S=t;ha++;var V=H();ha--;V===f?S=void 0:(t=S,S=f);S!==f?(oa=L,L="FROM"):(t=L,L=f)}else t=L,L=f;return L}function ca(){var L=t;if(d.substr(t,4).toLowerCase()===qg){var S=d.substr(t,4);t+=4}else S=f,0===ha&&b(rg);if(S!==f){S=t;ha++;var V=H();ha--;V===f?S=
void 0:(t=S,S=f);S!==f?(oa=L,L="TRIM"):(t=L,L=f)}else t=L,L=f;return L}function fa(){var L=t;if(d.substr(t,9).toLowerCase()===sg){var S=d.substr(t,9);t+=9}else S=f,0===ha&&b(tg);if(S!==f){S=t;ha++;var V=H();ha--;V===f?S=void 0:(t=S,S=f);S!==f?(oa=L,L="TIMESTAMP"):(t=L,L=f)}else t=L,L=f;return L}function la(){var L=t;if(d.substr(t,4).toLowerCase()===ug){var S=d.substr(t,4);t+=4}else S=f,0===ha&&b(vg);if(S!==f){S=t;ha++;var V=H();ha--;V===f?S=void 0:(t=S,S=f);S!==f?(oa=L,L="DATE"):(t=L,L=f)}else t=
L,L=f;return L}function ma(){var L=t;if(d.substr(t,4).toLowerCase()===wg){var S=d.substr(t,4);t+=4}else S=f,0===ha&&b(xg);if(S!==f){S=t;ha++;var V=H();ha--;V===f?S=void 0:(t=S,S=f);S!==f?(oa=L,L="TIME"):(t=L,L=f)}else t=L,L=f;return L}function ua(){var L=t;if(d.substr(t,8).toLowerCase()===yg){var S=d.substr(t,8);t+=8}else S=f,0===ha&&b(zg);if(S!==f){S=t;ha++;var V=H();ha--;V===f?S=void 0:(t=S,S=f);S!==f?(oa=L,L="INTERVAL"):(t=L,L=f)}else t=L,L=f;return L}function pa(){var L=t;if(d.substr(t,4).toLowerCase()===
Ag){var S=d.substr(t,4);t+=4}else S=f,0===ha&&b(Bg);if(S!==f){S=t;ha++;var V=H();ha--;V===f?S=void 0:(t=S,S=f);S!==f?(oa=L,L="YEAR"):(t=L,L=f)}else t=L,L=f;return L}function sa(){var L=t;if(d.substr(t,5).toLowerCase()===Cg){var S=d.substr(t,5);t+=5}else S=f,0===ha&&b(Dg);if(S!==f){S=t;ha++;var V=H();ha--;V===f?S=void 0:(t=S,S=f);S!==f?(oa=L,L="MONTH"):(t=L,L=f)}else t=L,L=f;return L}function Ca(){var L=t;if(d.substr(t,3).toLowerCase()===Eg){var S=d.substr(t,3);t+=3}else S=f,0===ha&&b(Fg);if(S!==f){S=
t;ha++;var V=H();ha--;V===f?S=void 0:(t=S,S=f);S!==f?(oa=L,L="DAY"):(t=L,L=f)}else t=L,L=f;return L}function xa(){var L=t;if(d.substr(t,4).toLowerCase()===Gg){var S=d.substr(t,4);t+=4}else S=f,0===ha&&b(Hg);if(S!==f){S=t;ha++;var V=H();ha--;V===f?S=void 0:(t=S,S=f);S!==f?(oa=L,L="HOUR"):(t=L,L=f)}else t=L,L=f;return L}function Ba(){var L=t;if(d.substr(t,6).toLowerCase()===Ig){var S=d.substr(t,6);t+=6}else S=f,0===ha&&b(Jg);if(S!==f){S=t;ha++;var V=H();ha--;V===f?S=void 0:(t=S,S=f);S!==f?(oa=L,L="MINUTE"):
(t=L,L=f)}else t=L,L=f;return L}function Aa(){var L=t;if(d.substr(t,6).toLowerCase()===Kg){var S=d.substr(t,6);t+=6}else S=f,0===ha&&b(Lg);if(S!==f){S=t;ha++;var V=H();ha--;V===f?S=void 0:(t=S,S=f);S!==f?(oa=L,L="SECOND"):(t=L,L=f)}else t=L,L=f;return L}function ya(){var L=t;if(d.substr(t,4).toLowerCase()===Mg){var S=d.substr(t,4);t+=4}else S=f,0===ha&&b(Ng);if(S!==f){S=t;ha++;var V=H();ha--;V===f?S=void 0:(t=S,S=f);S!==f?(oa=L,L="CASE"):(t=L,L=f)}else t=L,L=f;return L}function Ia(){var L=t;if(d.substr(t,
3).toLowerCase()===Og){var S=d.substr(t,3);t+=3}else S=f,0===ha&&b(Pg);if(S!==f){S=t;ha++;var V=H();ha--;V===f?S=void 0:(t=S,S=f);S!==f?(oa=L,L="END"):(t=L,L=f)}else t=L,L=f;return L}function Qa(){var L=t;if(d.substr(t,4).toLowerCase()===Qg){var S=d.substr(t,4);t+=4}else S=f,0===ha&&b(Rg);if(S!==f){S=t;ha++;var V=H();ha--;V===f?S=void 0:(t=S,S=f);S!==f?(oa=L,L="WHEN"):(t=L,L=f)}else t=L,L=f;return L}function Ya(){var L=t;if(d.substr(t,4).toLowerCase()===Sg){var S=d.substr(t,4);t+=4}else S=f,0===ha&&
b(Tg);if(S!==f){S=t;ha++;var V=H();ha--;V===f?S=void 0:(t=S,S=f);S!==f?(oa=L,L="THEN"):(t=L,L=f)}else t=L,L=f;return L}function Wa(){if(44===d.charCodeAt(t)){var L=Ug;t++}else L=f,0===ha&&b(Vg);return L}function Ja(){if(40===d.charCodeAt(t)){var L=Wg;t++}else L=f,0===ha&&b(Xg);return L}function Ka(){if(41===d.charCodeAt(t)){var L=Yg;t++}else L=f,0===ha&&b(Zg);return L}function ka(){var L;var S=[];for(L=Ra();L!==f;)S.push(L),L=Ra();return S}function Ra(){if($g.test(d.charAt(t))){var L=d.charAt(t);
t++}else L=f,0===ha&&b(ah);return L}function Mb(L,S,V,da){L={type:"binary-expression",operator:L,left:S,right:V};void 0!==da&&(L.escape=da);return L}function nb(L,S){for(var V=0;V<S.length;V++)L=Mb(S[V][1],L,S[V][3]);return L}u=void 0!==u?u:{};var f={},Md=u.grammarSource,Kd={start:n},Ld=n,Nd="!",Rc="\x3d",Tc="\x3e\x3d",Sd="\x3e",Uc="\x3c\x3d",Vc="\x3c\x3e",Wd="\x3c",Wc="!\x3d",zc="+",Bc="-",Xc="||",$d="*",be="/",Gf="@",Ed="'",Gd="N'",xc="''",Tf=".",ke="null",de="true",ge="false",ag="in",cg="is",eg=
"like",Pd="escape",gg="not",ig="and",kg="or",mg="between",og="from",Ee="for",ze="substring",ne="extract",qg="trim",Ke="position",sg="timestamp",ug="date",wg="time",If="leading",Kf="trailing",Mf="both",Qe="cast",Ue="as",Ye="integer",af="smallint",df="float",gf="real",kf="varchar",Of="to",yg="interval",Ag="year",re="timezone_hour",ue="timezone_minute",Cg="month",Eg="day",Gg="hour",Ig="minute",Kg="second",Mg="case",Og="end",Qg="when",Sg="then",Rf="else",Ug=",",Wg="(",Yg=")",ud="`",Af=/^[A-Za-z_\x80-\uFFFF]/,
Cf=/^[A-Za-z0-9_]/,Cd=/^[A-Za-z0-9_.\x80-\uFFFF]/,Ef=/^["]/,Id=/^[^']/,Zf=/^[0-9]/,Vf=/^[eE]/,Xf=/^[+\-]/,$g=/^[ \t\n\r]/,wd=/^[^`]/,Od=x("!",!1),Sc=x("\x3d",!1),Rd=x("\x3e\x3d",!1),Td=x("\x3e",!1),Ud=x("\x3c\x3d",!1),Vd=x("\x3c\x3e",!1),Xd=x("\x3c",!1),Yd=x("!\x3d",!1),Ac=x("+",!1),Cc=x("-",!1),Zd=x("||",!1),ae=x("*",!1),ce=x("/",!1),Bf=E([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),Df=E([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),Dd=E([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],
!1,!1),Ff=E(['"'],!1,!1),Hf=x("@",!1),Fd=x("'",!1),Qf=x("N'",!1),Hd=x("''",!1),Jd=E(["'"],!0,!1),Uf=x(".",!1),$f=E([["0","9"]],!1,!1),Wf=E(["e","E"],!1,!1),Yf=E(["+","-"],!1,!1),le=x("NULL",!0),ee=x("TRUE",!0),he=x("FALSE",!0),bg=x("IN",!0),dg=x("IS",!0),fg=x("LIKE",!0),Qd=x("ESCAPE",!0),hg=x("NOT",!0),jg=x("AND",!0),lg=x("OR",!0),ng=x("BETWEEN",!0),pg=x("FROM",!0),Fe=x("FOR",!0),Ae=x("SUBSTRING",!0),oe=x("EXTRACT",!0),rg=x("TRIM",!0),Le=x("POSITION",!0),tg=x("TIMESTAMP",!0),vg=x("DATE",!0),xg=x("TIME",
!0),Jf=x("LEADING",!0),Lf=x("TRAILING",!0),Nf=x("BOTH",!0),Re=x("CAST",!0),Ve=x("AS",!0),Ze=x("INTEGER",!0),bf=x("SMALLINT",!0),ef=x("FLOAT",!0),hf=x("REAL",!0),lf=x("VARCHAR",!0),Pf=x("TO",!0),zg=x("INTERVAL",!0),Bg=x("YEAR",!0),se=x("TIMEZONE_HOUR",!0),ve=x("TIMEZONE_MINUTE",!0),Dg=x("MONTH",!0),Fg=x("DAY",!0),Hg=x("HOUR",!0),Jg=x("MINUTE",!0),Lg=x("SECOND",!0),Ng=x("CASE",!0),Pg=x("END",!0),Rg=x("WHEN",!0),Tg=x("THEN",!0),Sf=x("ELSE",!0),Vg=x(",",!1),Xg=x("(",!1),Zg=x(")",!1),ah=E([" ","\t","\n",
"\r"],!1,!1),vd=x("`",!1),xd=E(["`"],!0,!1),t=0,oa=0,Yb=[{line:1,column:1}],eb=0,yc=[],ha=0;if("startRule"in u){if(!(u.startRule in Kd))throw Error("Can't start parsing from rule \""+u.startRule+'".');Ld=Kd[u.startRule]}var Qc=Ld();if(Qc!==f&&t===d.length)return Qc;Qc!==f&&t<d.length&&b({type:"end"});throw function(L,S,V){return new e(e.buildMessage(L,S),L,S,V)}(yc,eb<d.length?d.charAt(eb):null,eb<d.length?h(eb,eb+1):h(eb,eb));}}})})(w);var v=w.exports;class C{static parse(z){return v.parse(z)}}a.WhereGrammar=
C;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/fieldType":function(){define(["exports","../../core/jsonMap"],function(a,c){c=new c.JSONMap({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",
esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"});a.kebabDict=c;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/projectionSupport":function(){define("exports ../../../core/arrayUtils ../../../core/promiseUtils ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),
function(a,c,w,v,C,z,e){function r(b,n){if(!n)return null;if("x"in n){var p={x:0,y:0};[p.x,p.y]=b(n.x,n.y,A);null!=n.z&&(p.z=n.z);null!=n.m&&(p.m=n.m);return p}return"xmin"in n?(p={xmin:0,ymin:0,xmax:0,ymax:0},[p.xmin,p.ymin]=b(n.xmin,n.ymin,A),[p.xmax,p.ymax]=b(n.xmax,n.ymax,A),n.hasZ&&(p.zmin=n.zmin,p.zmax=n.zmax,p.hasZ=!0),n.hasM&&(p.mmin=n.mmin,p.mmax=n.mmax,p.hasM=!0),p):"rings"in n?{rings:d(n.rings,b),hasM:n.hasM,hasZ:n.hasZ}:"paths"in n?{paths:d(n.paths,b),hasM:n.hasM,hasZ:n.hasZ}:"points"in
n?{points:u(n.points,b),hasM:n.hasM,hasZ:n.hasZ}:null}function d(b,n){const p=[];for(const D of b)p.push(u(D,n));return p}function u(b,n){const p=[];for(const D of b)b=n(D[0],D[1],[0,0]),p.push(b),2<D.length&&b.push(D[2]),3<D.length&&b.push(D[3]);return p}const A=[0,0],x=r.bind(null,e.lngLatToXY),E=r.bind(null,e.xyToLngLat);class m{constructor(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}async push(b,n,p,D){if(!b?.length||!n||!p||z.equals(n,p))return b;b={geometries:b,inSpatialReference:n,
outSpatialReference:p,geographicTransformation:D,resolve:w.createResolver()};this._jobs.push(b);this._timer??(this._timer=setTimeout(this._process,10));return b.resolve.promise}_process(){this._timer=null;const b=this._jobs.shift();if(b){var {geometries:n,inSpatialReference:p,outSpatialReference:D,resolve:M,geographicTransformation:g}=b;e.canProject(p,D)?z.isWebMercator(D)?M(n.map(x)):M(n.map(E)):M(v.projectMany(C.jsonAdapter,n,p,D,g,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,
10))}}}const h=new m;a.checkProjectionSupport=async function(b,n){b&&n&&(b=Array.isArray(b)?b.map(p=>null!=p.geometry?p.geometry.spatialReference:null).filter(c.isSome):[b],await v.initializeProjection(b.map(p=>({source:p,dest:n}))))};a.project=function(b,n,p,D){if(!b)return b;p||(p=n,n=b.spatialReference);return z.isValid(n)&&z.isValid(p)&&!z.equals(n,p)?e.canProject(n,p)?(b=z.isWebMercator(p)?x(b):E(b),b.spatialReference=p,b):v.projectMany(C.jsonAdapter,[b],n,p,null,D)[0]:b};a.projectMany=function(b,
n,p,D){return h.push(b,n,p,D)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/geometryAdapters/json":function(){define(["exports"],function(a){class c{constructor(e,r,d){this.x=e;this.y=r;this.spatialReference=d;this.m=this.z=void 0}}class w{constructor(e,r,d,u){this.rings=e;this.spatialReference=r;this.hasM=this.hasZ=void 0;d&&(this.hasZ=d);u&&(this.hasM=u)}}class v{constructor(e,r,d,u){this.paths=e;this.spatialReference=r;this.hasM=this.hasZ=void 0;d&&(this.hasZ=
d);u&&(this.hasM=u)}}class C{constructor(e,r,d,u){this.points=e;this.spatialReference=r;this.hasM=this.hasZ=void 0;d&&(this.hasZ=d);u&&(this.hasM=u)}}class z{constructor(e,r,d,u,A){this.xmin=e;this.ymin=r;this.xmax=d;this.ymax=u;this.spatialReference=A;this.mmax=this.mmin=this.zmax=this.zmin=void 0}}a.jsonAdapter={convertToGEGeometry:function(e,r){return null==r?null:e.convertJSONToGeometry(r)},exportPoint:function(e,r,d){d=new c(e.getPointX(r),e.getPointY(r),d);const u=e.hasZ(r),A=e.hasM(r);u&&(d.z=
e.getPointZ(r));A&&(d.m=e.getPointM(r));return d},exportPolygon:function(e,r,d){return new w(e.exportPaths(r),d,e.hasZ(r),e.hasM(r))},exportPolyline:function(e,r,d){return new v(e.exportPaths(r),d,e.hasZ(r),e.hasM(r))},exportMultipoint:function(e,r,d){return new C(e.exportPoints(r),d,e.hasZ(r),e.hasM(r))},exportExtent:function(e,r,d){var u=e.hasZ(r);const A=e.hasM(r);d=new z(e.getXMin(r),e.getYMin(r),e.getXMax(r),e.getYMax(r),d);u&&(u=e.getZExtent(r),d.zmin=u.vmin,d.zmax=u.vmax);A&&(e=e.getMExtent(r),
d.mmin=e.vmin,d.mmax=e.vmax);return d}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngineCapabilities":function(){define(["exports"],function(a){a.queryCapabilities={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,
supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByAnonymous:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,
maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports ../../../core/lang ../../../geometry/support/centroid ../../../geometry/support/extentUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ./AttributesBuilder ./geometryUtils ./projectionSupport ./SnappingCandidate ../../support/fieldUtils ../../../statistics/utils".split(" "),
function(a,c,w,v,C,z,e,r,d,u,A,x,E){function m(p,D,M,g){const J=g.x-M.x;g=g.y-M.y;D=Math.min(1,Math.max(0,((D.x-M.x)*J+(D.y-M.y)*g)/(J*J+g*g)));p.x=M.x+J*D;p.y=M.y+g*D}function h(p,D){return p?D?4:3:D?3:2}class b{constructor(p,D,M){this.items=p;this.query=D;this.geometryType=M.geometryType;this.hasM=M.hasM;this.hasZ=M.hasZ;this.fieldsIndex=M.fieldsIndex;this.objectIdField=M.objectIdField;this.spatialReference=M.spatialReference;this.featureAdapter=M.featureAdapter}get size(){return this.items.length}createQueryResponseForCount(){const p=
new r(this.query,this.featureAdapter,this.fieldsIndex);if(!this.query.outStatistics)return p.countDistinctValues(this.items);const {groupByFieldsForStatistics:D,having:M,outStatistics:g}=this.query;if(!D?.length)return 1;const J=new Map,R=new Map,B=new Set;for(const T of g){var {statisticType:F}=T;F="exceedslimit"!==F?T.onStatisticField:void 0;if(!R.has(F)){var N=[];for(const y of D){const G=this._getAttributeValues(p,y,J);N.push(G)}R.set(F,this._calculateUniqueValues(N,p.returnDistinctValues))}F=
R.get(F);for(const y in F){const {data:G,items:k}=F[y];N=G.join(",");M&&!p.validateItems(k,M)||B.add(N)}}return B.size}async createQueryResponse(){let p;p=this.query.outStatistics?this.query.outStatistics.some(D=>"exceedslimit"===D.statisticType)?this._createExceedsLimitQueryResponse(this.query):await this._createStatisticsQueryResponse(this.query):this._createFeatureQueryResponse(this.query);if(this.query.returnQueryGeometry){const D=this.query.geometry;e.isValid(this.query.outSR)&&!e.equals(D.spatialReference,
this.query.outSR)?p.queryGeometry=d.cleanFromGeometryEngine({spatialReference:this.query.outSR,...u.project(D,D.spatialReference,this.query.outSR)}):p.queryGeometry=d.cleanFromGeometryEngine({spatialReference:this.query.outSR,...D})}return p}createSnappingResponse(p,D){const M=this.featureAdapter,g=h(this.hasZ,this.hasM),{point:J,mode:R}=p,B="number"===typeof p.distance?p.distance:p.distance.x,F="number"===typeof p.distance?p.distance:p.distance.y,N={candidates:[]},T="esriGeometryPolygon"===this.geometryType;
D=this._getPointCreator(R,this.spatialReference,D);const y=new n(null,0),G=new n(null,0),k={x:0,y:0,z:0};for(const ea of this.items){var l=M.getGeometry(ea);if(null==l)continue;const {coords:ia,lengths:na}=l;y.coords=ia;G.coords=ia;if(p.returnEdge){l=0;for(var H=0;H<na.length;H++){var U=na[H];for(var Q=0;Q<U;Q++,l+=g){var W=y;W.coordsIndex=l;if(Q!==U-1){const qa=G;qa.coordsIndex=l+g;const va=k;m(k,J,W,qa);var Z=(J.x-va.x)/B;const ta=(J.y-va.y)/F;Z=Z*Z+ta*ta;1>=Z&&N.candidates.push(A.makeEdgeCandidate(M.getObjectId(ea),
D(va),Math.sqrt(Z),D(W),D(qa)))}}}}if("none"!==p.vertexMode)if(l=T?ia.length-g:ia.length,"all"===p.vertexMode)for(H=0;H<l;H+=g)U=y,U.coordsIndex=H,Q=(J.x-U.x)/B,W=(J.y-U.y)/F,Q=Q*Q+W*W,1>=Q&&N.candidates.push(A.makeVertexCandidate(M.getObjectId(ea),D(U),Math.sqrt(Q)));else if("ends"===p.vertexMode){l=[0];T||l.push(ia.length-g);for(const qa of l)l=y,l.coordsIndex=qa,H=(J.x-l.x)/B,U=(J.y-l.y)/F,H=H*H+U*U,1>=H&&N.candidates.push(A.makeVertexCandidate(M.getObjectId(ea),D(l),Math.sqrt(H)))}}N.candidates.sort((ea,
ia)=>ea.distance-ia.distance);return N}_getPointCreator(p,D,M){const g=null==M||e.equals(D,M)?R=>R:R=>u.project(R,D,M),{hasZ:J}=this;return"3d"===p?J?({x:R,y:B,z:F})=>g({x:R,y:B,z:F}):({x:R,y:B})=>g({x:R,y:B,z:0}):({x:R,y:B})=>g({x:R,y:B})}async createSummaryStatisticsResponse(p){const {field:D,valueExpression:M,normalizationField:g,normalizationType:J,normalizationTotal:R,minValue:B,maxValue:F,scale:N,timeZone:T}=p;var y=this.fieldsIndex.get(D);p=x.isDateField(y)||x.isDateOnlyField(y)||x.isTimestampOffsetField(y);
const G=await this._getDataValues({field:D,valueExpression:M,normalizationField:g,normalizationType:J,normalizationTotal:R,scale:N,timeZone:T}),k=E.isNullCountSupported({normalizationType:J,normalizationField:g,minValue:B,maxValue:F}),l={value:.5,fieldType:y?.type};y=x.isStringField(y)?E.calculateStringStatistics({values:G,supportsNullCount:k,percentileParams:l}):E.calculateStatistics({values:G,minValue:B,maxValue:F,useSampleStdDev:!J,supportsNullCount:k,percentileParams:l});return E.processSummaryStatisticsResult(y,
p)}async createUniqueValuesResponse(p){const {field:D,valueExpression:M,domains:g,returnAllCodedValues:J,scale:R,timeZone:B}=p;var F=await this._getDataValues({field:D,field2:p.field2,field3:p.field3,fieldDelimiter:p.fieldDelimiter,valueExpression:M,scale:R,timeZone:B},!1);F=E.calculateUniqueValuesCount(F);return E.createUVResult(F,g,J,p.fieldDelimiter)}async createClassBreaksResponse(p){const {field:D,valueExpression:M,normalizationField:g,normalizationType:J,normalizationTotal:R,classificationMethod:B,
standardDeviationInterval:F,minValue:N,maxValue:T,numClasses:y,scale:G,timeZone:k}=p;p=await this._getDataValues({field:D,valueExpression:M,normalizationField:g,normalizationType:J,normalizationTotal:R,scale:G,timeZone:k});p=E.calculateClassBreaks(p,{field:D,normalizationField:g,normalizationType:J,normalizationTotal:R,classificationMethod:B,standardDeviationInterval:F,minValue:N,maxValue:T,numClasses:y});return E.resolveCBResult(p,B)}async createHistogramResponse(p){const {field:D,valueExpression:M,
normalizationField:g,normalizationType:J,normalizationTotal:R,classificationMethod:B,standardDeviationInterval:F,minValue:N,maxValue:T,numBins:y,scale:G,timeZone:k}=p;p=await this._getDataValues({field:D,valueExpression:M,normalizationField:g,normalizationType:J,normalizationTotal:R,scale:G,timeZone:k});return E.calculateHistogram(p,{field:D,normalizationField:g,normalizationType:J,normalizationTotal:R,classificationMethod:B,standardDeviationInterval:F,minValue:N,maxValue:T,numBins:y})}_sortFeatures(p,
D,M){if(1<p.length&&D?.length)for(const g of D.reverse()){D=g.split(" ");const J=D[0],R=this.fieldsIndex.get(J);D=D[1]?"desc"===D[1].toLowerCase():!1;const B=E.getAttributeComparator(R?.type,D);p.sort((F,N)=>{F=M(F,J,R);N=M(N,J,R);return B(F,N)})}}_createFeatureQueryResponse(p){const D=this.items,{geometryType:M,hasM:g,hasZ:J,objectIdField:R,spatialReference:B}=this,{outFields:F,outSR:N,quantizationParameters:T,resultRecordCount:y,resultOffset:G,returnZ:k,returnM:l}=p,H=null!=y?D.length>(G||0)+y:
!1,U=F&&(F.includes("*")?[...this.fieldsIndex.fields]:F.map(Q=>this.fieldsIndex.get(Q)));return{exceededTransferLimit:H,features:this._createFeatures(p,D),fields:U,geometryType:M,hasM:g&&l,hasZ:J&&k,objectIdFieldName:R,spatialReference:d.cleanFromGeometryEngine(N||B),transform:T&&z.toQuantizationTransform(T)||null}}_createFeatures(p,D){const M=new r(p,this.featureAdapter,this.fieldsIndex),{hasM:g,hasZ:J}=this,{orderByFields:R,quantizationParameters:B,returnGeometry:F,returnCentroid:N,maxAllowableOffset:T,
resultOffset:y,resultRecordCount:G,returnZ:k=!1,returnM:l=!1}=p,H=J&&k,U=g&&l;p=[];var Q=0;const W=[...D];this._sortFeatures(W,R,(qa,va,ta)=>M.getFieldValue(qa,va,ta));if(this.geometryType&&(F||N)){var Z=z.toQuantizationTransform(B)??void 0;D="esriGeometryPolygon"===this.geometryType||"esriGeometryPolyline"===this.geometryType;if(F&&!N)for(var ea of W){var ia=this.featureAdapter.getGeometry(ea),na={attributes:M.getAttributes(ea),geometry:d.getGeometry(this.geometryType,this.hasZ,this.hasM,ia,T,Z,
H,U)};D&&ia&&!na.geometry&&(na.centroid=d.transformCentroid(this,this.featureAdapter.getCentroid(ea,this),Z));p[Q++]=na}else if(!F&&N)for(ia of W)p[Q++]={attributes:M.getAttributes(ia),centroid:d.transformCentroid(this,this.featureAdapter.getCentroid(ia,this),Z)};else for(na of W)p[Q++]={attributes:M.getAttributes(na),centroid:d.transformCentroid(this,this.featureAdapter.getCentroid(na,this),Z),geometry:d.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(na),T,Z,H,
U)}}else for(Z of W)(ea=M.getAttributes(Z))&&(p[Q++]={attributes:ea});Q=y||0;null!=G&&(p=p.slice(Q,Math.min(p.length,Q+G)));return p}_createExceedsLimitQueryResponse(p){var D=!1;let M=Number.POSITIVE_INFINITY,g=Number.POSITIVE_INFINITY;D=Number.POSITIVE_INFINITY;for(const J of p.outStatistics??[])if("exceedslimit"===J.statisticType){M=null!=J.maxPointCount?J.maxPointCount:Number.POSITIVE_INFINITY;g=null!=J.maxRecordCount?J.maxRecordCount:Number.POSITIVE_INFINITY;D=null!=J.maxVertexCount?J.maxVertexCount:
Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===this.geometryType)D=this.items.length>M;else if(this.items.length>g)D=!0;else{p=h(this.hasZ,this.hasM);const J=this.featureAdapter;D=this.items.reduce((R,B)=>{B=J.getGeometry(B);return R+(null!=B&&B.coords.length||0)},0)/p>D}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(D)}}]}}async _createStatisticsQueryResponse(p){var D=
{attributes:{}};const M=[],g=new Map,J=new Map,R=new Map,B=new Map,F=new r(p,this.featureAdapter,this.fieldsIndex);var N=p.outStatistics;const {groupByFieldsForStatistics:T,having:y,orderByFields:G,resultRecordCount:k}=p;p=T?.length;const l=!!p,H=l?T[0]:null,U=l&&!this.fieldsIndex.get(H);for(const ia of N??[]){const {outStatisticFieldName:na,statisticType:qa}=ia;N=ia;const va="exceedslimit"!==qa?ia.onStatisticField:void 0,ta="percentile_disc"===qa||"percentile_cont"===qa;var Q="EnvelopeAggregate"===
qa||"CentroidAggregate"===qa||"ConvexHullAggregate"===qa;const wa=l&&1===p&&(va===H||U)&&"count"===qa;if(l){if(!R.has(va)){var W=[];for(const Ea of T){var Z=this._getAttributeValues(F,Ea,g);W.push(Z)}R.set(va,this._calculateUniqueValues(W,Q?!1:F.returnDistinctValues))}W=R.get(va);if(!W)continue;Z=Object.keys(W);for(const Ea of Z){const {count:Da,data:Pa,items:Sa,itemPositions:Ta}=W[Ea];Z=Pa.join(",");if(!y||F.validateItems(Sa,y)){const Oa=B.get(Z)||{attributes:{}};if(Q){Oa.aggregateGeometries||(Oa.aggregateGeometries=
{});const {aggregateGeometries:K,outStatisticFieldName:Y}=await this._getAggregateGeometry(N,Sa);Oa.aggregateGeometries[Y]=K}else{var ea=null;if(wa)ea=Da;else{const K=this._getAttributeValues(F,va,g);ea=Ta.map(Y=>K[Y]);ea=ta&&"statisticParameters"in N?this._getPercentileValue(N,ea):this._getStatisticValue(N,ea,null,F.returnDistinctValues)}Oa.attributes[na]=ea}let q=0;T.forEach((K,Y)=>Oa.attributes[this.fieldsIndex.get(K)?K:`EXPR_${++q}`]=Pa[Y]);B.set(Z,Oa)}}}else if(Q){D.aggregateGeometries||(D.aggregateGeometries=
{});const {aggregateGeometries:Ea,outStatisticFieldName:Da}=await this._getAggregateGeometry(N,this.items);D.aggregateGeometries[Da]=Ea}else Q=this._getAttributeValues(F,va,g),D.attributes[na]=ta&&"statisticParameters"in N?this._getPercentileValue(N,Q):this._getStatisticValue(N,Q,J,F.returnDistinctValues);N="min"!==qa&&"max"!==qa||!x.isStringField(this.fieldsIndex.get(va))&&!this._isAnyDateField(va)?null:this.fieldsIndex.get(va)?.type;M.push({name:na,alias:na,type:N||"esriFieldTypeDouble"})}D=l?Array.from(B.values()):
[D];this._sortFeatures(D,G,(ia,na)=>ia.attributes[na]);k&&(D.length=Math.min(k,D.length));return{fields:M,features:D}}_isAnyDateField(p){p=this.fieldsIndex.get(p);return x.isDateField(p)||x.isDateOnlyField(p)||x.isTimestampOffsetField(p)||x.isTimeOnlyField(p)}async _getAggregateGeometry(p,D){const {convexHull:M,union:g}=await new Promise((k,l)=>a(["../../../geometry/geometryEngineJSON"],k,l)),{statisticType:J,outStatisticFieldName:R}=p,{featureAdapter:B,spatialReference:F,geometryType:N,hasZ:T,hasM:y}=
this;D=D.map(k=>d.getGeometry(N,T,y,B.getGeometry(k)));const G=M(F,D,!0)[0];p={aggregateGeometries:null,outStatisticFieldName:null};"EnvelopeAggregate"===J?(D=G?C.getPolygonExtent(G):C.getGeometryExtent(g(F,D)),p.aggregateGeometries={...D,spatialReference:F},p.outStatisticFieldName=R||"extent"):"CentroidAggregate"===J?(D=G?v.polygonCentroid(G):v.extentCentroid(C.getGeometryExtent(g(F,D))),p.aggregateGeometries={x:D[0],y:D[1],spatialReference:F},p.outStatisticFieldName=R||"centroid"):"ConvexHullAggregate"===
J&&(p.aggregateGeometries=G,p.outStatisticFieldName=R||"convexHull");return p}_getStatisticValue(p,D,M,g){const {onStatisticField:J,statisticType:R}=p;p=null;p=M?.has(J)?M.get(J):x.isStringField(this.fieldsIndex.get(J))||this._isAnyDateField(J)?E.calculateStringStatistics({values:D,returnDistinct:g}):E.calculateStatistics({values:g?[...(new Set(D))]:D,minValue:null,maxValue:null,useSampleStdDev:!0});M&&M.set(J,p);return p["var"===R?"variance":R]}_getPercentileValue(p,D){const {onStatisticField:M,
statisticParameters:g,statisticType:J}=p,{value:R,orderBy:B}=g;p=this.fieldsIndex.get(M);return E.calculatePercentile(D,{value:R,orderBy:B,fieldType:p?.type,isDiscrete:"percentile_disc"===J})}_getAttributeValues(p,D,M){if(M.has(D))return M.get(D);const g=this.fieldsIndex.get(D),J=this.items.map(R=>p.getFieldValue(R,D,g));M.set(D,J);return J}_calculateUniqueValues(p,D){const M={},g=this.items,J=g.length;for(let R=0;R<J;R++){const B=g[R],F=[];for(const T of p)F.push(T[R]);const N=F.join(",");null==
M[N]?M[N]={count:1,data:F,items:[B],itemPositions:[R]}:(D||M[N].count++,M[N].items.push(B),M[N].itemPositions.push(R))}return M}async _getDataValues(p,D=!0){const M=new r(this.query,this.featureAdapter,this.fieldsIndex),{valueExpression:g,scale:J,timeZone:R}=p;return g?M.getExpressionValues(this.items,g,{viewingMode:"map",scale:J,spatialReference:this.query.outSR||this.spatialReference},{geometryType:this.geometryType,hasZ:this.hasZ,hasM:this.hasM},R):M.getDataValues(this.items,w.clone(p),D)}}class n{constructor(p,
D){this.coords=p;this.coordsIndex=D}get x(){return this.coords[this.coordsIndex]}get y(){return this.coords[this.coordsIndex+1]}get z(){return this.coords[this.coordsIndex+2]}}c.QueryEngineResult=b;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/quantizationUtils":function(){define(["exports","./jsonUtils"],function(a,c){function w(k){if("lowerLeft"===k.originPosition&&4===k.scale.length&&4===k.translate.length)return k;const {originPosition:l,scale:H,translate:U}=
k;k=H[1]??1;return{originPosition:"lowerLeft",scale:[H[0]??1,"lowerLeft"===l?k:-k,H[2]??1,H[3]??1],translate:[U[0]??0,U[1]??0,U[2]??0,U[3]??0]}}function v({scale:k,translate:l},H){return Math.round((H-l[0])/k[0])}function C({scale:k,translate:l},H){return Math.round((H-l[1])/k[1])}function z({scale:k,translate:l},H){return Math.round(((H??0)-l[2])/k[2])}function e({scale:k,translate:l},H){return H?Math.round((H-l[3])/k[3]):0}function r(k,l){return k&&l?F:k&&!l?R:!k&&l?B:J}function d({scale:k,translate:l},
H){return H*k[0]+l[0]}function u({scale:k,translate:l},H){return H*k[1]+l[1]}function A({scale:k,translate:l},H){return(H??0)*k[2]+l[2]}function x({scale:k,translate:l},H){return H?H*k[3]+l[3]:0}function E(k,l){return k&&l?G:k&&!l?T:!k&&l?y:N}function m(k,l,H){const U=Array(H.length);for(let Q=0;Q<H.length;Q++)U[Q]=l(k,H[Q]);return U}function h(k,l,H){let [U,Q]=H[0],W=Math.min(U,l[0]),Z=Math.min(Q,l[1]),ea=Math.max(U,l[2]);l=Math.max(Q,l[3]);for(let ia=1;ia<H.length;ia++){const [na,qa]=H[ia];U+=na;
Q+=qa;0>na&&(W=Math.min(W,U));0<na&&(ea=Math.max(ea,U));0>qa?Z=Math.min(Z,Q):0<qa&&(l=Math.max(l,Q))}k[0]=W;k[1]=Z;k[2]=ea;k[3]=l;return k}function b(k,l){if(!l.length)return null;k[0]=k[1]=Number.POSITIVE_INFINITY;k[2]=k[3]=Number.NEGATIVE_INFINITY;for(let H=0;H<l.length;H++)h(k,k,l[H]);return k}function n(k,l,H){k=w(k);l.xmin=v(k,H.xmin);l.ymin=C(k,H.ymin);l.xmax=v(k,H.xmax);l.ymax=C(k,H.ymax);H.hasZ&&(l.zmin=z(k,H.zmin),l.zmax=z(k,H.zmax));H.hasM&&(l.mmin=e(k,H.mmin),l.mmax=e(k,H.mmax));l.hasZ=
H.hasZ??!1;l.hasM=H.hasM??!1;return l}function p(k,l,H){k=w(k);l.points=r(H.hasZ,H.hasM)(k,H.points)??[];l.hasZ=H.hasZ??!1;l.hasM=H.hasM??!1;return l}function D(k,l,H){k=w(k);l.x=v(k,H.x);l.y=C(k,H.y);null!=H.z&&(l.z=z(k,H.z));null!=H.m&&(l.m=e(k,H.m));return l}function M(k,l,H){{k=w(k);var U=H.rings;const Q=[],W=r(H.hasZ,H.hasM);for(let Z=0;Z<U.length;Z++){const ea=W(k,U[Z]);ea&&3<=ea.length&&Q.push(ea)}k=Q.length?Q:null}if(!k)return null;l.rings=k;l.hasZ=H.hasZ??!1;l.hasM=H.hasM??!1;return l}function g(k,
l,H){{k=w(k);var U=H.paths;const Q=[],W=r(H.hasZ,H.hasM);for(let Z=0;Z<U.length;Z++){const ea=W(k,U[Z]);ea&&2<=ea.length&&Q.push(ea)}k=Q.length?Q:null}if(!k)return null;l.paths=k;l.hasZ=H.hasZ??!1;l.hasM=H.hasM??!1;return l}const J=(k,l)=>{const H=[];if(!l.length)return null;var U=l[0];let Q=v(k,U[0]);U=C(k,U[1]);H.push([Q,U]);for(let W=1;W<l.length;W++){const [Z,ea]=l[W],ia=v(k,Z),na=C(k,ea);ia===Q&&na===U||H.push([ia-Q,na-U]);Q=ia;U=na}return H},R=(k,l)=>{const H=[];if(!l.length)return null;var U=
l[0];let Q=v(k,U[0]),W=C(k,U[1]);U=z(k,U[2]);H.push([Q,W,U]);for(let Z=1;Z<l.length;Z++){const [ea,ia,na]=l[Z],qa=v(k,ea),va=C(k,ia),ta=z(k,na);qa===Q&&va===W&&ta===U||H.push([qa-Q,va-W,ta]);Q=qa;W=va;U=ta}return H},B=(k,l)=>{const H=[];if(!l.length)return null;var U=l[0];let Q=v(k,U[0]),W=C(k,U[1]);U=e(k,U[2]);H.push([Q,W,U]);for(let Z=1;Z<l.length;Z++){const [ea,ia,na]=l[Z],qa=v(k,ea),va=C(k,ia),ta=e(k,na);qa===Q&&va===W&&ta===U||H.push([qa-Q,va-W,ta]);Q=qa;W=va;U=ta}return H},F=(k,l)=>{const H=
[];if(!l.length)return null;var U=l[0];let Q=v(k,U[0]),W=C(k,U[1]),Z=z(k,U[2]);U=e(k,U[3]);H.push([Q,W,Z,U]);for(let ea=1;ea<l.length;ea++){const [ia,na,qa,va]=l[ea],ta=v(k,ia),wa=C(k,na),Ea=z(k,qa),Da=e(k,va);ta===Q&&wa===W&&Ea===Z&&Da===U||H.push([ta-Q,wa-W,Ea,Da]);Q=ta;W=wa;Z=Ea;U=Da}return H},N=(k,l)=>{const H=Array(l.length);if(!l.length)return H;var U=l[0];let Q=d(k,U[0]);U=u(k,U[1]);H[0]=[Q,U];const {scale:W,originPosition:Z}=k;k=W[0];const ea="lowerLeft"===Z?W[1]:-W[1];for(let ia=1;ia<l.length;ia++){const [na,
qa]=l[ia];Q+=k*na;U+=ea*qa;H[ia]=[Q,U]}return H},T=(k,l)=>{const H=Array(l.length);if(!l.length)return H;var U=l[0];let Q=d(k,U[0]),W=u(k,U[1]);H[0]=[Q,W,A(k,U[2])];const {scale:Z,originPosition:ea}=k;U=Z[0];const ia="lowerLeft"===ea?Z[1]:-Z[1];for(let na=1;na<l.length;na++){const [qa,va,ta]=l[na];Q+=U*qa;W+=ia*va;H[na]=[Q,W,A(k,ta)]}return H},y=(k,l)=>{const H=Array(l.length);if(!l.length)return H;var U=l[0];let Q=d(k,U[0]),W=u(k,U[1]);H[0]=[Q,W,x(k,U[2])];const {scale:Z,originPosition:ea}=k;U=Z[0];
const ia="lowerLeft"===ea?Z[1]:-Z[1];for(let na=1;na<l.length;na++){const [qa,va,ta]=l[na];Q+=U*qa;W+=ia*va;H[na]=[Q,W,x(k,ta)]}return H},G=(k,l)=>{const H=Array(l.length);if(!l.length)return H;var U=l[0];let Q=d(k,U[0]),W=u(k,U[1]);H[0]=[Q,W,A(k,U[2]),x(k,U[3])];const {scale:Z,originPosition:ea}=k;U=Z[0];const ia="lowerLeft"===ea?Z[1]:-Z[1];for(let na=1;na<l.length;na++){const [qa,va,ta,wa]=l[na];Q+=U*qa;W+=ia*va;H[na]=[Q,W,A(k,ta),x(k,wa)]}return H};a.getQuantizedBoundsCoordsArray=h;a.getQuantizedBoundsCoordsArrayArray=
b;a.getQuantizedBoundsPaths=function(k){return b([0,0,0,0],k)};a.getQuantizedBoundsPoints=function(k){const l=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return h(l,l,k)};a.getQuantizedBoundsRings=function(k){return b([0,0,0,0],k)};a.normalizeTransform=w;a.quantizeBounds=function(k,l,H){k=w(k);l[0]=v(k,H[0]);l[3]=C(k,H[1]);l[2]=v(k,H[2]);l[1]=C(k,H[3]);return l};a.quantizeCoordsArrayXY=J;a.quantizeCoordsArrayXYM=B;a.quantizeCoordsArrayXYZ=
R;a.quantizeCoordsArrayXYZM=F;a.quantizeExtent=n;a.quantizeGeometry=function(k,l){return k&&l?c.isPoint(l)?D(k,{},l):c.isPolyline(l)?g(k,{},l):c.isPolygon(l)?M(k,{},l):c.isMultipoint(l)?p(k,{},l):c.isExtent(l)?n(k,{},l):null:null};a.quantizeM=e;a.quantizeMultipoint=p;a.quantizePoint=D;a.quantizePolygon=M;a.quantizePolyline=g;a.quantizeX=v;a.quantizeY=C;a.quantizeZ=z;a.toQuantizationTransform=function(k){return k?{originPosition:"upper-left"===k.originPosition?"upperLeft":"lower-left"===k.originPosition?
"lowerLeft":k.originPosition,scale:k.tolerance?[k.tolerance,k.tolerance,1,1]:[1,1,1,1],translate:null!=k.extent?[k.extent.xmin,k.extent.ymax,k.extent.zmin??0,k.extent.mmin??0]:[0,0,0,0]}:null};a.unquantizeBounds=function(k,l,H){k=w(k);return H?(l[0]=d(k,H[0]),l[1]=u(k,H[3]),l[2]=d(k,H[2]),l[3]=u(k,H[1]),l):[d(k,l[0]),u(k,l[3]),d(k,l[2]),u(k,l[1])]};a.unquantizeCoordsArrayArray=m;a.unquantizeCoordsArrayXY=N;a.unquantizeCoordsArrayXYM=y;a.unquantizeCoordsArrayXYZ=T;a.unquantizeCoordsArrayXYZM=G;a.unquantizeExtent=
function(k,l,H,U=H.hasZ??!1,Q=H.hasM??!1){k=w(k);l.xmin=d(k,H.xmin);l.xmax=d(k,H.xmax);l.ymin=u(k,H.ymin);l.ymax=u(k,H.ymax);U&&(l.zmin=A(k,H.zmin),l.zmax=A(k,H.zmax));Q&&(l.mmin=x(k,H.mmin),l.mmax=x(k,H.mmax));l.hasZ=U;l.hasM=Q;return l};a.unquantizeM=x;a.unquantizeMultipoint=function(k,l,H,U=H?.hasZ??!1,Q=H?.hasM??!1){null!=H&&(k=w(k),l.points=E(U,Q)(k,H.points),l.hasZ=U,l.hasM=Q);return l};a.unquantizePoint=function(k,l,H,U=null!=H?.z,Q=null!=H?.m){if(null==H)return l;k=w(k);l.x=d(k,H.x);l.y=u(k,
H.y);U&&(l.z=A(k,H.z));Q&&(l.m=x(k,H.m));return l};a.unquantizePolygon=function(k,l,H,U=H?.hasZ??!1,Q=H?.hasM??!1){null!=H&&(k=w(k),l.rings=m(k,E(U,Q),H.rings),l.hasZ=U,l.hasM=Q);return l};a.unquantizePolyline=function(k,l,H,U=H?.hasZ??!1,Q=H?.hasM??!1){null!=H&&(k=w(k),l.paths=m(k,E(U,Q),H.paths),l.hasZ=U,l.hasM=Q);return l};a.unquantizeX=d;a.unquantizeY=u;a.unquantizeZ=A;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/AttributesBuilder":function(){define("./attributeSupport ./geometryUtils ../../support/fieldUtils ../../../smartMapping/statistics/support/utils ../../../statistics/utils ../../../support/arcadeOnDemand".split(" "),
function(a,c,w,v,C,z){class e{constructor(r,d,u){this._fieldDataCache=new Map;this._returnDistinctMap=new Map;this.returnDistinctValues=r.returnDistinctValues??!1;this.fieldsIndex=u;this.featureAdapter=d;if((d=r.outFields)&&!d.includes("*")){this.outFields=d;r=0;for(const x of d){var A=a.getExpressionFromFieldName(x);A=(d=this.fieldsIndex.get(A))?null:a.getWhereClause(A,u);d=d?d.name:a.getAliasFromFieldName(x)||`FIELD_EXP_${r++}`;this._fieldDataCache.set(x,{alias:d,clause:A})}}}countDistinctValues(r){if(!this.returnDistinctValues)return r.length;
r.forEach(d=>this.getAttributes(d));return this._returnDistinctMap.size}getAttributes(r){r=this._processAttributesForOutFields(r);return this._processAttributesForDistinctValues(r)}getFieldValue(r,d,u){const A=u?u.name:d;let x=null;this._fieldDataCache.has(A)?x=this._fieldDataCache.get(A)?.clause:u||(x=a.getWhereClause(d,this.fieldsIndex),this._fieldDataCache.set(A,{alias:A,clause:x}));return u?this.featureAdapter.getAttribute(r,A):x?.calculateValue(r,this.featureAdapter)}getDataValues(r,d,u=!0){const A=
d.normalizationType,x=d.normalizationTotal,E=this.fieldsIndex.get(d.field),m=w.isDateOnlyField(E)||w.isTimestampOffsetField(E),h=w.isTimeOnlyField(E);return r.map(b=>{let n=d.field&&this.getFieldValue(b,d.field,this.fieldsIndex.get(d.field));d.field2?(n=`${C.processNullValue(n)}${d.fieldDelimiter}${C.processNullValue(this.getFieldValue(b,d.field2,this.fieldsIndex.get(d.field2)))}`,d.field3&&(n=`${n}${d.fieldDelimiter}${C.processNullValue(this.getFieldValue(b,d.field3,this.fieldsIndex.get(d.field3)))}`)):
"string"===typeof n&&u&&(m?n=n?(new Date(n)).getTime():null:h&&(n=n?v.timeOnlyToMilliseconds(n):null));A&&Number.isFinite(n)&&(b="field"===A&&d.normalizationField?this.getFieldValue(b,d.normalizationField,this.fieldsIndex.get(d.normalizationField)):null,n=C.getNormalizedValue(n,A,b,x));return n})}async getExpressionValues(r,d,u,A,x){const {arcadeUtils:E}=await z.loadArcade(),m=E.hasGeometryOperations(d);m&&await E.enableGeometryOperations();const h=E.createFunction(d),b=E.getViewInfo(u),n={fields:this.fieldsIndex.fields};
return r.map(p=>{p={attributes:this.featureAdapter.getAttributes(p),layer:n,geometry:m?{...c.getGeometry(A.geometryType,A.hasZ,A.hasM,this.featureAdapter.getGeometry(p)),spatialReference:u?.spatialReference}:null};p=E.createExecContext(p,b,x);return E.executeFunction(h,p)})}validateItem(r,d){this._fieldDataCache.has(d)||this._fieldDataCache.set(d,{alias:d,clause:a.getWhereClause(d,this.fieldsIndex)});return this._fieldDataCache.get(d)?.clause?.testFeature(r,this.featureAdapter)??!1}validateItems(r,
d){this._fieldDataCache.has(d)||this._fieldDataCache.set(d,{alias:d,clause:a.getWhereClause(d,this.fieldsIndex)});return this._fieldDataCache.get(d)?.clause?.testSet(r,this.featureAdapter)??!1}_processAttributesForOutFields(r){const d=this.outFields;if(!d?.length)return this.featureAdapter.getAttributes(r);const u={};for(const A of d){const {alias:x,clause:E}=this._fieldDataCache.get(A);u[x]=E?E.calculateValue(r,this.featureAdapter):this.featureAdapter.getAttribute(r,x)}return u}_processAttributesForDistinctValues(r){if(null==
r||!this.returnDistinctValues)return r;var d=this.outFields,u=[];if(d)for(const x of d){var {alias:A}=this._fieldDataCache.get(x);u.push(r[A])}else for(A in r)u.push(r[A]);d=`${(d||["*"]).join(",")}=${u.join(",")}`;u=this._returnDistinctMap.get(d)||0;this._returnDistinctMap.set(d,++u);return 1<u?null:r}}return e})},"esri/smartMapping/statistics/support/utils":function(){define("exports ../../../geometry ../../../core/Error ../../../core/screenUtils ../../../core/timeUtils ../../../geometry/SpatialReference ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ../../../layers/support/fieldUtils ../../../renderers/support/heatmapUtils ../../support/utils ../../../statistics/utils ../../../support/arcadeOnDemand ../../../geometry/Point".split(" "),
function(a,c,w,v,C,z,e,r,d,u,A,x,E,m){function h(g){g=M.exec(g);if(!g)return null;const {hh:J,mm:R,ss:B,ms:F}=g.groups;return Number(J)*C.millisecondsPerTimeUnit.hours+Number(R)*C.millisecondsPerTimeUnit.minutes+Number(B)*C.millisecondsPerTimeUnit.seconds+Number(F||0)}function b(g,J){g=null!=g?g:"";null!=J&&J&&(g=g?"("+g+") AND ("+J+")":J);return g}function n(g){const J=g.layer;return g.fields.filter(R=>!J.getField(R))}function p(g){const J=g.layer;return g.fields.filter(R=>{R=J.getFieldUsageInfo(R);
return!R||!R.supportsStatistics})}let D=null;const M=/^(?<hh>([0-1][0-9])|([2][0-3])):(?<mm>[0-5][0-9])(:(?<ss>[0-5][0-9]))?([.](?<ms>\d+))?$/;a.calculateHeatmapStats=function(g,J=18,R,B,F){const N=new Float64Array(B*F);J=Math.round(v.pt2px(J));let T=Number.POSITIVE_INFINITY,y=Number.NEGATIVE_INFINITY;R=u.createValueFunction(R);for(const {geometry:l,attributes:H}of g){const {x:U,y:Q}=l;g=Math.max(0,U-J);var G=Math.max(0,Q-J);const W=Math.min(F,Q+J),Z=Math.min(B,U+J),ea=+R(H);for(;G<W;G++)for(let ia=
g;ia<Z;ia++){var k=G*B+ia;const na=u.evaluateDensityKernel(ia-U,G-Q,J)*ea;k=N[k]+=na;T=Math.min(T,k);y=Math.max(y,k)}}return{min:T,max:y}};a.getDataValues=async function(g,J,R=!0){if(!J)return[];const {field:B,field2:F,field3:N,fieldDelimiter:T,fieldInfos:y,timeZone:G}=g;var k=B&&y?.find(va=>va.name.toLowerCase()===B.toLowerCase());const l=k?d.isTimeOnlyField(k):!1,H=k?A.isAnyDateField(k):!1,U=g.valueExpression,Q=g.normalizationType,W=g.normalizationField,Z=g.normalizationTotal,ea=[];k=g.viewInfoParams;
let ia=null,na=null;if(U){if(!D){const {arcadeUtils:va}=await E.loadArcade();D=va}D.hasGeometryOperations(U)&&await D.enableGeometryOperations();ia=D.createFunction(U);na=k?D.getViewInfo({viewingMode:k.viewingMode,scale:k.scale,spatialReference:new z(k.spatialReference)}):null}g=g.fieldInfos;const qa=J[0]&&"declaredClass"in J[0]&&"esri.Graphic"===J[0].declaredClass||!g?null:{fields:g};J.forEach(va=>{var ta=va.attributes;if(U){var wa=D.createExecContext(qa?{...va,layer:qa}:va,na,G);wa=D.executeFunction(ia,
wa)}else ta&&(wa=ta[B],F?(wa=`${x.processNullValue(wa)}${T}${x.processNullValue(ta[F])}`,N&&(wa=`${wa}${T}${x.processNullValue(ta[N])}`)):"string"===typeof wa&&R&&(H?wa=wa?(new Date(wa)).getTime():null:l&&(wa=wa?h(wa):null)));Q&&"number"===typeof wa&&isFinite(wa)&&(ta=ta&&parseFloat(ta[W]),wa=x.getNormalizedValue(wa,Q,ta,Z));ea.push(wa)});return ea};a.getRangeExpr=function(g,J,R){J=null!=J?g+" \x3e\x3d "+J:"";g=null!=R?g+" \x3c\x3d "+R:"";R="";return(R=J&&g?b(J,g):J||g)?"("+R+")":""};a.getSQLFilterForNormalization=
function(g){const J=g.field,R=g.normalizationType;g=g.normalizationField;let B;if("field"===R)B="(NOT "+g+" \x3d 0)";else if("log"===R||"natural-log"===R||"square-root"===R)B=`(${J} > 0)`;return B};a.getSumOfAttributesExpr=function(g,J,R){const B=[],F=[],N=[],T=[],y=[];g.forEach((l,H)=>{const U=l.field?"field":"expression",Q=l.field||l.valueExpression;l.field?(y.push(Q),F.push(`var ${U}${H} = Number($feature["${Q}"]);`)):(B.push(`function getValueForExpr${H}() {\n  ${Q} \n}`),F.push(`var ${U}${H} = Number(getValueForExpr${H}());`));
R||N.push(`${U}${H} = IIf(${U}${H} < 0, 0, ${U}${H});`);T.push(`${U}${H}`)});g="return sum;";const G=B.length?null:y.reduce((l,H)=>`${l} + ${H}`);let k=null;J||R?J?R||(g="return IIf(sum \x3e\x3d 0, sum, null);",G&&(k=`(( ${G} ) >= 0)`)):(g="return IIf(sum !\x3d 0, sum, null);",G&&(k=`(( ${G} ) <> 0)`)):(g="return IIf(sum \x3e 0, sum, null);",G&&(k=`(( ${G} ) > 0)`));return{valueExpression:[B.length?B.join("\n"):"",F.join("\n"),N.join("\n"),`var sum = ${T.join(" + ")};`,g].filter(Boolean).join("\n\n"),
sqlExpression:G,sqlWhere:k}};a.mergeWhereClauses=b;a.quantizeFeatures=function(g,J,R,B){const F=r.isWrappable(R)?r.getInfo(R):null,N=F?Math.round((F.valid[1]-F.valid[0])/J.scale[0]):null;return g.map(T=>{const y=new m(T.geometry);e.quantizePoint(J,y,y);if(F){var G=N??0,k=B[0];0>y.x?y.x+=G:y.x>k&&(y.x-=G)}T.geometry=y;return T})};a.timeOnlyToMilliseconds=h;a.verifyBasicFieldValidity=function(g,J,R){const B=n({layer:g,fields:J});if(B.length)return new w(R,"Unknown fields: "+B.join(", ")+". You can only use fields defined in the layer schema");
g=p({layer:g,fields:J});if(g.length)return new w(R,"Unsupported fields: "+g.join(", ")+". You can only use fields that can be fetched i.e. AdapterFieldUsageInfo.supportsStatistics must be true")};a.verifyFieldType=function(g,J,R,B){let F;J?J.name!==g.objectIdField&&B.includes(J.type)||(F=new w(R,"'field' should be one of these types: "+B.join(","))):F=new w(R,"'field' is not defined in the layer schema");return F};a.verifyFilterValidty=function(g,J){if(g&&"intersects"!==g.spatialRelationship)return new w(J,
"Only 'intersects' spatialRelationship is supported for featureFilter")};a.verifyNumericField=function(g,J,R){let B;J?J.name!==g.objectIdField&&d.isNumericField(J)||(B=new w(R,"'field' should be one of these numeric types: "+d.numericTypes.join(","))):B=new w(R,"'field' is not defined in the layer schema");return B};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/screenUtils":function(){define(["exports"],function(a){function c(v){return v?72*v/96:0}const w=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i;
a.castRenderScreenPointArray=function(v){return v};a.castRenderScreenPointArray3=function(v){return v};a.castScreenPointArray=function(v){return v};a.createRenderScreenPoint=function(v=0,C=0){return{x:v,y:C}};a.createRenderScreenPointArray=function(v=0,C=0){return[v,C]};a.createRenderScreenPointArray3=function(v=0,C=0,z=0){return[v,C,z]};a.createScreenPoint=function(v=0,C=0){return{x:v,y:C}};a.createScreenPointArray=function(v=0,C=0){return[v,C]};a.pt2px=function(v){return v?v/72*96:0};a.px2pt=c;
a.screenPointArrayToObject=function(v,C){return C?(C.x=v[0],C.y=v[1],C):{x:v[0],y:v[1]}};a.screenPointObjectToArray=function(v,C){return C?(C[0]=v.x,C[1]=v.y,2<C.length&&(C[2]=0),C):[v.x,v.y]};a.toPt=function(v){if("string"===typeof v){var C=v.match(w);if(C){var z=Number(C[1]);C=C[3]&&C[3].toLowerCase();v="-"===v.charAt(0);z="px"===C?c(z):z;return v?-z:z}console.warn("screenUtils.toPt: input not recognized!");return null}return v};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/timeUtils":function(){define(["exports",
"../intl/date","../time/timeZoneUtils","../chunks/datetime"],function(a,c,w,v){function C(r,d,u){return 0===r?0:r*e[d]/e[u]}function z(r){switch(r){case "milliseconds":return"millisecond";case "seconds":return"second";case "minutes":return"minute";case "hours":return"hour";case "days":return"day";case "weeks":return"week";case "months":return"month";case "years":return"year"}}const e={milliseconds:1,seconds:1E3,minutes:6E4,hours:36E5,days:864E5,weeks:6048E5,months:26784E5,years:31536E6,decades:31536E7,
centuries:31536E8};a.convertTime=C;a.isValidDate=function(r){return r instanceof Date&&!isNaN(r.getTime())};a.makeUTCTime=function(r,d,u="milliseconds"){d=new Date(C(d,u,"milliseconds"));d.setUTCFullYear(r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate());return d};a.mergeTimeExtents=function(r,d){return r&&d?r.intersection(d):r||d};a.millisecondsPerTimeUnit=e;a.offsetDate=function(r,d,u,A=w.system){A=new v.IANAZone(c.resolveTimeZone(A));r=v.DateTime.fromJSDate(r,{zone:A});A="decades"===u||"centuries"===
u?"year":z(u);"decades"===u&&(d*=10);"centuries"===u&&(d*=100);return r.plus({[A]:d}).toJSDate()};a.offsetDateUTC=function(r,d,u="milliseconds"){r=r.getTime();d=C(d,u,"milliseconds");return new Date(r+d)};a.resetUTCDate=function(r,d){r=new Date(r.getTime());r.setUTCFullYear(d.getFullYear(),d.getMonth(),d.getDate());return r};a.timeSinceUTCMidnight=function(r,d="milliseconds"){const u=C(r.getUTCHours(),"hours","milliseconds"),A=C(r.getUTCMinutes(),"minutes","milliseconds"),x=C(r.getUTCSeconds(),"seconds",
"milliseconds");r=r.getUTCMilliseconds();return C(u+A+x+r,"milliseconds",d)};a.truncateDate=function(r,d,u=w.system){u=new v.IANAZone(c.resolveTimeZone(u));r=v.DateTime.fromJSDate(r,{zone:u});if("decades"===d||"centuries"===d)return r=r.startOf("year"),{year:u}=r,r.set({year:u-u%("decades"===d?10:100)}).toJSDate();d=z(d);return r.startOf(d).toJSDate()};a.truncateLocalTime=function(r){const d=new Date(0);d.setHours(0);d.setMinutes(0);d.setSeconds(0);d.setMilliseconds(0);d.setFullYear(r.getUTCFullYear(),
r.getUTCMonth(),r.getUTCDate());return d};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/heatmapUtils":function(){define(["exports","../../core/mathUtils","../../core/screenUtils","../../chunks/vec42","../../core/libs/gl-matrix-2/factories/vec4f64"],function(a,c,w,v,C){function z(e,r,d,u){let {color:A,ratio:x}=r,{color:E,ratio:m}=d;m===x&&(1===m?x-=1E-6:m+=1E-6);r=c.clamp((u-x)/(m-x),0,1);v.lerp(e,A.toArray(),E.toArray(),r)}a.createValueFunction=function(e){return"function"===
typeof e?e:e?r=>+r[e]:()=>1};a.evaluateDensityKernel=function(e,r,d){e=Math.sqrt(e**2+r**2)/d;return 1<e?0:3/(Math.PI*d**2)*(1-e**2)**2};a.gaussianBlurRadiusPxToKernelDensityRadiusPt=function(e){return w.px2pt(2.4*e)};a.generateGradient=function(e){const r=new Uint8ClampedArray(2048);e=e.filter(({ratio:E})=>0<=E&&1>=E).sort((E,m)=>E.ratio-m.ratio).map(({color:E,ratio:m})=>({color:E,ratio:Math.max(m,.001)}));if(1>e.length)return r;let d=e[0],u=e[0],A=1;const x=C.create();for(let E=0;512>E;E++){const m=
(E+.5)/512;for(;m>u.ratio&&A<e.length;)d=u,u=e[A++];z(x,d,u,m);r.set(x,4*E)}return r};a.kernelDensityRadiusPtToGaussianBlurRadiusPx=function(e){return w.pt2px(e)/2.4};a.magicKernelDensityRadiusInflationFactor=2.4;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/smartMapping/support/utils":function(){define("exports ../../intl/date ../../layers/support/fieldUtils ../../support/arcadeOnDemand ../../support/basemapUtils ../../time/timeZoneUtils".split(" "),function(a,c,w,v,C,z){function e(m){return String(m).padStart(2,
"0")}function r(m,h,b){if("date"===h||"number"===h){"number"===h&&(m=new Date(m));h=b?m.getFullYear():m.getUTCFullYear();const n=e((b?m.getMonth():m.getUTCMonth())+1),p=e(b?m.getDate():m.getUTCDate()),D=e(b?m.getHours():m.getUTCHours()),M=e(b?m.getMinutes():m.getUTCMinutes());m=e(b?m.getSeconds():m.getUTCSeconds());m=`TIMESTAMP'${h}-${n}-${p} ${D}:${M}:${m}'`}return m}function d(m,h){if(h instanceof Date)return"date";if("number"===typeof h)return"number";if("string"===typeof h&&(m=m.getField(h),"\x3cnow\x3e"!==
h.toLowerCase()&&w.isDateField(m)))return"field"}const u={light:"streets gray topo terrain oceans osm gray-vector streets-vector topo-vector streets-relief-vector streets-navigation-vector topo-3d navigation-3d streets-3d osm-3d gray-3d arcgis-light-gray arcgis-navigation arcgis-streets arcgis-streets-relief arcgis-topographic arcgis-oceans osm-standard osm-standard-relief osm-streets osm-streets-relief osm-light-gray arcgis-terrain arcgis-charted-territory arcgis-community arcgis-colored-pencil arcgis-modern-antique arcgis-midcentury arcgis-newspaper arcgis-hillshade-light".split(" "),
dark:"satellite hybrid dark-gray dark-gray-vector streets-night-vector navigation-dark-3d streets-dark-3d dark-gray-3d arcgis-imagery arcgis-imagery-standard arcgis-dark-gray arcgis-navigation-night arcgis-streets-night osm-dark-gray arcgis-nova arcgis-hillshade-dark".split(" ")},A={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864E5},x=new Set(["integer","small-integer"]);let E=null;a.castIntegerFieldToFloat=function(m){return`cast(${m} as float)`};a.dateTypes=
["date","date-only","timestamp-offset"];a.defaultBasemapGroups=u;a.fieldDelimiter=",";a.formatAnyDate=function(m,h){const {format:b,timeZoneOptions:n,fieldType:p}=h??{};let D;n&&({timeZone:M,timeZoneName:D}=z.getTimeZoneFormattingOptions(n.layerTimeZone,n.datesInUnknownTimezone,n.viewTimeZone,c.convertDateFormatToIntlOptions(b||"short-date-short-time"),p));if("string"===typeof m&&isNaN(Date.parse("time-only"===p?`1970-01-01T${m}Z`:m)))return m;switch(p){case "date-only":var M=c.convertDateFormatToIntlOptions(b||
"short-date");return"string"===typeof m?c.formatDateOnly(m,{...M}):c.formatDate(m,{...M,timeZone:z.utc});case "time-only":return M=c.convertDateFormatToIntlOptions(b||"short-time"),"string"===typeof m?c.formatTimeOnly(m,M):c.formatDate(m,{...M,timeZone:z.utc});case "timestamp-offset":if(!M&&"string"===typeof m&&(new Date(m)).toISOString()!==m)return m;M=(h=b||n?c.convertDateFormatToIntlOptions(b||"short-date-short-time"):void 0)?{...h,timeZone:M,timeZoneName:D}:void 0;return"string"===typeof m?c.formatTimestamp(m,
M):c.formatDate(m,M);default:return h=b||n?c.convertDateFormatToIntlOptions(b||"short-date-short-time"):void 0,c.formatDate("string"===typeof m?new Date(m):m,h?{...h,timeZone:M,timeZoneName:D}:void 0)}};a.getBasemapGroup=function(m,h=u){for(const b in h)if(h[b].includes(m))return b};a.getBasemapId=function(m,h,b=!0){let n=null;m&&("string"===typeof m?h.includes(m)&&(n=m):n=C.getWellKnownBasemapId(m));return b?n||"gray":n};a.getDateDiffSQL=function(m,h,b,n){const {hasQueryEngine:p}=m;b=r(b,d(m,b),
p);m=r(h,d(m,h),p);m=`(${b} - ${m})`;n=A[n];h="/";1>n&&(n=1/n,h="*");return{sqlExpression:1===n?m:`(${m} ${h} ${n})`,sqlWhere:null}};a.getDateType=d;a.getFieldsList=async function(m){const {field:h,field2:b,field3:n,normalizationField:p,valueExpression:D}=m;m=[];D&&(E||({arcadeUtils:m}=await v.loadArcade(),E=m),m=E.extractFieldNames(D));h&&m.push(h);b&&m.push(b);n&&m.push(n);p&&m.push(p);return m};a.getNormalizationType=function(m){let h=m.normalizationType;h||(m.normalizationField?h="field":null!=
m.normalizationTotal&&(h="percent-of-total"));return h??void 0};a.isAnyDateField=function(m){return w.isDateField(m)||w.isDateOnlyField(m)||w.isTimestampOffsetField(m)};a.isIntegerField=function(m,h){m=h&&m.getField(h);return!!m&&x.has(m.type)};a.unitValueInDays=A;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/support/basemapUtils":function(){define("exports ../Basemap ../config ../core/Collection ../core/Logger ../core/maybe ../core/urlUtils ../core/accessorSupport/ensureType ../layers/effects/utils ./basemapDefinitions".split(" "),
function(a,c,w,v,C,z,e,r,d,u){function A(G,k){let l;if("string"===typeof G){const H=G in u.esriBasemapDefinitions,U=!H&&G.includes("/");if(!H&&!U)return k=Object.entries(u.esriBasemapDefinitions).filter(([,Q])=>w.apiKey&&!Q.classic||!w.apiKey&&(Q.classic||Q.is3d)).map(([Q])=>`"${Q}"`).sort().join(", "),C.getLogger("esri.support.basemapUtils").warn(`Unable to find basemap definition for: ${G}. Try one of these: ${k}`),null;k&&(l=k[G]);l||(l=H?c.fromId(G):new c({style:{id:G}}),k&&(k[G]=l))}else l=r.ensureType(c,
G);l?.destroyed&&(C.getLogger("esri.support.basemapUtils").warn("The provided basemap is already destroyed",{basemap:l}),l=null);return l}function x(G){if(T)return T(G);let k=null;G=b(G);const l=!G?.baseLayers.length;for(const U in u.esriBasemapDefinitions){var H=M(u.esriBasemapDefinitions[U]);H=J(G,H,{mustMatchReferences:l});if("equal"===H){k=U;break}"base-layers-equal"===H&&(k=U)}return k}function E(G,k){const l=new v;G.forEach(H=>{const U=k.find(Q=>"scene"!==Q.type&&B(p(H),p(Q)))||H;l.includes(U)?
l.push(H):l.push(U)});return l}function m(G){if(h(G.url))return!0;if("vector-tile"===G.type)for(const k in G.sourceNameToSource)if(h(G.sourceNameToSource[k]?.sourceUrl))return!0;return!1}function h(G){if(!G)return!1;G=new e.Url(e.makeAbsolute(G));return!!G.authority&&y.test(G.authority)}function b(G){return G?!G.loaded&&G.resourceInfo?M(G.resourceInfo.data):{baseLayers:n(G.baseLayers),referenceLayers:n(G.referenceLayers)}:null}function n(G){return(v.isCollection(G)?G.toArray():G).map(p)}function p(G){return{type:G.type,
effect:"effect"in G?G.effect:void 0,url:F("urlTemplate"in G&&G.urlTemplate||G.url||"styleUrl"in G&&G.styleUrl||""),minScale:"minScale"in G&&null!=G.minScale?G.minScale:0,maxScale:"maxScale"in G&&null!=G.maxScale?G.maxScale:0,opacity:null!=G.opacity?G.opacity:1,visible:null!=G.visible?!!G.visible:!0,sublayers:"map-image"!==G.type&&"wms"!==G.type||null==G.sublayers?void 0:G.sublayers?.map(k=>({id:k.id,visible:k.visible})),activeLayerId:"wmts"===G.type?G.activeLayer?.id:void 0}}function D(G){return G.isReference||
"ArcGISSceneServiceLayer"===G.layerType}function M(G){return G?{baseLayers:g((G.baseMapLayers??[]).filter(k=>!D(k))),referenceLayers:g((G.baseMapLayers??[]).filter(k=>D(k)))}:null}function g(G){return G.map(k=>{let l;switch(k.layerType){case "VectorTileLayer":l="vector-tile";break;case "ArcGISTiledMapServiceLayer":l="tile";break;case "ArcGISSceneServiceLayer":l="scene";break;default:l="unknown"}return{type:l,effect:k.effect,url:F(k.templateUrl||k.urlTemplate||k.styleUrl||k.url),minScale:k.minScale??
0,maxScale:k.maxScale??0,opacity:k.opacity??1,visible:null!=k.visibility?!!k.visibility:!0,sublayers:void 0,activeLayerId:void 0}})}function J(G,k,l){return null!=G!==(null!=k)?"not-equal":G&&k?R(G.baseLayers,k.baseLayers)?R(G.referenceLayers,k.referenceLayers)?"equal":l.mustMatchReferences?"not-equal":"base-layers-equal":"not-equal":"equal"}function R(G,k){if(G.length!==k.length)return!1;for(let l=0;l<G.length;l++)if(!B(G[l],k[l]))return!1;return!0}function B(G,k){if(G.type!==k.type||G.url!==k.url||
G.minScale!==k.minScale||G.maxScale!==k.maxScale||G.visible!==k.visible||G.opacity!==k.opacity||!d.effectEquals(G.effect,k.effect))return!1;if(null!=G.activeLayerId||null!=k.activeLayerId)return G.activeLayerId===k.activeLayerId;if(null!=G.sublayers||null!=k.sublayers){if(null==G.sublayers||null==k.sublayers||G.sublayers.length!==k.sublayers.length)return!1;for(let l=0;l<G.sublayers.length;l++){const H=G.sublayers.at(l),U=k.sublayers.at(l);if(H?.id!==U?.id||H?.visible!==U?.visible)return!1}}return!0}
function F(G){return G?e.normalize(G).replace(/^\s*https?:/i,"").toLowerCase():""}function N(G){return"portalItem"in G?G.portalItem?.thumbnailUrl:void 0}let T;const y=/^(basemaps|ibasemaps).*-api\.arcgis\.com$/i;a.clonePreservingTiledLayers=function(G,k=null){G=A(G);if(!G)return null;G=G.clone();k&&(G.baseLayers=E(G.baseLayers,k.baseLayers),G.referenceLayers=E(G.referenceLayers,k.referenceLayers));return G};a.contentEquals=function(G,k){if(G===k||null!=G?.portalItem?.id&&G.portalItem.id===k?.portalItem?.id)return!0;
G=b(G);k=b(k);return"equal"===J(G,k,{mustMatchReferences:!0})};a.createCache=function(){return{}};a.destroyCache=function(G){for(const k in G)z.destroyMaybe(G[k]),delete G[k]};a.ensureType=A;a.findSpatialReference=function(G,k){if(null==k||null==G)return{spatialReference:null,updating:!1};if("not-loaded"===k.loadStatus)return k.load(),{spatialReference:null,updating:!0};if(k.spatialReference)return{spatialReference:k.spatialReference,updating:!1};if(0===k.baseLayers.length)return{spatialReference:null,
updating:!1};k=k.baseLayers.at(0);switch(k.loadStatus){case "not-loaded":k.load();case "loading":return{spatialReference:null,updating:!0};case "failed":return{spatialReference:null,updating:!1}}k=(("supportedSpatialReferences"in k?k.supportedSpatialReferences:null)||["tileInfo"in k?k.tileInfo?.spatialReference:k.spatialReference]).filter(Boolean);const l=G.spatialReference;return l?{spatialReference:k.find(H=>l.equals(H))??k[0]??null,updating:!1}:{spatialReference:k[0],updating:!1}};a.getBasemapThumbnailUrl=
function(G){if(!G)return null;var {thumbnailUrl:k}=G;return k?k:(k=x(G))?u.esriBasemapDefinitions[k].thumbnailUrl:z.mappedFind(G.baseLayers,N)};a.getWellKnownBasemapId=x;a.hasDeveloperBasemapLayer=function(G){return!!G?.baseLayers.concat(G.referenceLayers).some(m)};a.isBasemap3D=function(G){return"Web Scene"===G.portalItem?.type||G.referenceLayers.some(k=>"scene"===k.type)};a.isBasemapInBeta=function(G){return!!G?.portalItem?.tags?.some(k=>"beta"===k.toLowerCase())};a.isBasemapLayer=function(G,k){return G.basemap?.referenceLayers?.some(l=>
l.uid===k)||G.basemap?.baseLayers?.some(l=>l.uid===k)};a.isDeveloperBasemapLayer=m;a.overrideGetWellKnownBasemapId=function(G){T=G};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/Basemap":function(){define("require ./chunks/tslib.es6 ./request ./core/Collection ./core/collectionUtils ./core/JSONSupport ./core/lang ./core/Loadable ./core/loadAll ./core/Logger ./core/maybe ./core/promiseUtils ./core/urlUtils ./core/accessorSupport/decorators/property ./core/has ./core/accessorSupport/decorators/subclass ./core/accessorSupport/decorators/writer ./geometry/SpatialReference ./portal/Portal ./portal/PortalItem ./support/basemapDefinitions ./support/BasemapStyle ./webdoc/support/writeUtils".split(" "),
function(a,c,w,v,C,z,e,r,d,u,A,x,E,m,h,b,n,p,D,M,g,J,R){var B;let F=0;z=B=class extends z.JSONSupportMixin(r){constructor(y){super(y);this.thumbnailUrl=this.style=this.spatialReference=this.portalItem=this.id=null;this.title="Basemap";this.id=Date.now().toString(16)+"-basemap-"+F++;this.baseLayers=new v;this.referenceLayers=new v;const G=k=>{k.parent&&k.parent!==this&&"remove"in k.parent&&k.parent.remove(k);k.parent=this;"elevation"===k.type&&u.getLogger(this).error(`Layer '${k.title}, id:${k.id}' of type '${k.type}' is not supported as a basemap layer and will therefore be ignored.`)};
this.addHandles([this.baseLayers.on("after-add",k=>G(k.item)),this.referenceLayers.on("after-add",k=>G(k.item)),this.baseLayers.on("after-remove",k=>{k.item.parent=null}),this.referenceLayers.on("after-remove",k=>{k.item.parent=null})])}initialize(){this.when().catch(y=>{u.getLogger(this).error("#load()",`Failed to load basemap (title: '${this.title}', id: '${this.id}')`,y)});this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){var y=this.baseLayers.toArray();for(const G of y)G.destroy();
y=this.referenceLayers.toArray();for(const G of y)G.destroy();this.baseLayers.destroy();this.referenceLayers.destroy();this.portalItem=A.destroyMaybe(this.portalItem)}normalizeCtorArgs(y){y&&"resourceInfo"in y&&(this._set("resourceInfo",y.resourceInfo),y={...y},delete y.resourceInfo);return y}set baseLayers(y){this._set("baseLayers",C.referenceSetter(y,this._get("baseLayers")))}_writeBaseLayers(y,G,k){const l=[];y&&(k={...k,layerContainerType:"basemap"},this.baseLayers.forEach(H=>{H=R.getLayerJSON(H,
k.webmap?k.webmap.getLayerJSONFromResourceInfo(H):null,k);null!=H&&l.push(H)}),this.referenceLayers.forEach(H=>{const U=R.getLayerJSON(H,k.webmap?k.webmap.getLayerJSONFromResourceInfo(H):null,k);null!=U&&("scene"!==H.type&&(U.isReference=!0),l.push(U))}));G.baseMapLayers=l}set referenceLayers(y){this._set("referenceLayers",C.referenceSetter(y,this._get("referenceLayers")))}writeTitle(y,G){G.title=y||"Basemap"}load(y){this.addResolvingPromise(this._loadFromSource(y));return Promise.resolve(this)}loadAll(){return d.loadAll(this,
y=>{y(this.baseLayers,this.referenceLayers)})}clone(){const y={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.map(G=>e.isClonable(G)?G.clone():G),referenceLayers:this.referenceLayers.map(G=>e.isClonable(G)?G.clone():G)};this.loaded&&(y.loadStatus="loaded");return(new B({resourceInfo:this.resourceInfo})).set(y)}read(y,G){this.resourceInfo||this._set("resourceInfo",{data:y,context:G});super.read(y,G)}write(y,G){y=y||{};G?.origin||(G={origin:"web-map",...G});super.write(y,
G);!this.loaded&&this.resourceInfo?.data.baseMapLayers&&(y.baseMapLayers=this.resourceInfo.data.baseMapLayers.map(k=>{k=e.clone(k);k.url&&E.isProtocolRelative(k.url)&&(k.url=`https:${k.url}`);k.templateUrl&&E.isProtocolRelative(k.templateUrl)&&(k.templateUrl=`https:${k.templateUrl}`);return k}));return y}async _loadFromSource(y){const {resourceInfo:G,portalItem:k,style:l}=this;x.throwIfAborted(y);const H=[];G?(H.push(this._loadLayersFromJSON(G.data,G.context?G.context.url:null,y)),G.data.id&&!G.data.title&&
H.push(g.getBasemapTitle(G.data.id).then(U=>{U&&this.read({title:U},G.context)}))):k?H.push(this._loadFromItem(k,y)):l&&H.push(this._loadFromStylesService(l,y));await Promise.all(H)}async _loadLayersFromJSON(y,G,k){const l=this.resourceInfo?.context,H=this.portalItem?.portal||l?.portal||null,U=T[l?.origin||""]??"web-map",{populateOperationalLayers:Q}=await new Promise((Z,ea)=>a(["./layers/support/layersCreator"],Z,ea)),W=[];x.throwIfAborted(k);if(y.baseMapLayers&&Array.isArray(y.baseMapLayers)){G=
{context:{...l,origin:U,url:G,portal:H,layerContainerType:"basemap"},defaultLayerType:"DefaultTileLayer"};const Z=ea=>"web-scene"===U&&"ArcGISSceneServiceLayer"===ea.layerType||ea.isReference;k=Q(this.baseLayers,y.baseMapLayers.filter(ea=>!Z(ea)),G);W.push(k);y=Q(this.referenceLayers,y.baseMapLayers.filter(Z),G);W.push(y)}await Promise.allSettled(W)}async _loadFromItem(y,G){const k=await (await y.load(G)).fetchData("json",G),l=E.urlToObject(y.itemUrl??"");this._set("resourceInfo",{data:k.baseMap??
{},context:{origin:N[y.type||""]??"web-map",portal:y.portal||D.getDefault(),url:l}});this.read(this.resourceInfo.data,this.resourceInfo.context);this.read({spatialReference:k.spatialReference},this.resourceInfo.context);this.read({title:y.title,thumbnailUrl:y.thumbnailUrl},{origin:"portal-item",portal:y.portal||D.getDefault(),url:l});return this._loadLayersFromJSON(this.resourceInfo.data,l,G)}async _loadFromStylesService(y,G){var k=`${y.serviceUrl}/${y.id}`;y=(await w(k,{query:{language:y.getLanguageParamValue(),
places:y.places,worldview:y.worldview},signal:G?.signal})).data;k=E.urlToObject(k);this._set("resourceInfo",{data:y.baseMap??{},context:{origin:"web-map",url:k}});this.read(this.resourceInfo.data,this.resourceInfo.context);this.read({spatialReference:y.spatialReference},this.resourceInfo.context);return this._loadLayersFromJSON(this.resourceInfo.data,k,G)}static fromId(y){return(y=g.esriBasemapDefinitions[y])?y.itemId?new B({portalItem:{id:y.itemId,portal:{url:"https://www.arcgis.com"}}}):B.fromJSON(y,
{origin:y.is3d?"web-scene":"web-map"}):null}};c.__decorate([m.property({json:{write:{ignoreOrigin:!0,target:"baseMapLayers",writer(y,G,k,l){this._writeBaseLayers(y,G,l)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:v}},writer(y,G,k,l){this._writeBaseLayers(y,G,l)}}}}}})],z.prototype,"baseLayers",null);c.__decorate([m.property({type:String,json:{origins:{"web-scene":{write:!0}}}})],z.prototype,"id",void 0);c.__decorate([m.property({type:M})],z.prototype,"portalItem",void 0);
c.__decorate([m.property()],z.prototype,"referenceLayers",null);c.__decorate([m.property({readOnly:!0})],z.prototype,"resourceInfo",void 0);c.__decorate([m.property({type:p})],z.prototype,"spatialReference",void 0);c.__decorate([m.property({type:J})],z.prototype,"style",void 0);c.__decorate([m.property()],z.prototype,"thumbnailUrl",void 0);c.__decorate([m.property({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],z.prototype,"title",void 0);c.__decorate([n.writer("title")],z.prototype,
"writeTitle",null);z=B=c.__decorate([b.subclass("esri.Basemap")],z);const N={"Web Scene":"web-scene","Web Map":"web-map","Link Chart":"link-chart"},T={"web-scene":"web-scene","web-map":"web-map","link-chart":"link-chart"};return z})},"esri/core/collectionUtils":function(){define(["exports","./Collection"],function(a,c){a.castForReferenceSetter=function(w){return w};a.referenceSetter=function(w,v,C=c){v||=new C;if(v===w)return v;v.removeAll();w&&(Array.isArray(w)||"items"in w&&Array.isArray(w.items))?
v.addMany(w):w&&v.add(w);return v};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/Loadable":function(){define("../chunks/tslib.es6 ./Error ./maybe ./Promise ./promiseUtils ./Warning ./accessorSupport/decorators/property ./accessorSupport/decorators/subclass".split(" "),function(a,c,w,v,C,z,e,r){const d=u=>{u=class extends u{constructor(...A){super(...A);this.loadError=this._loadController=null;this.loadStatus="not-loaded";this._set("loadWarnings",[]);this.addResolvingPromise(new Promise(x=>
{const E=this.load.bind(this);this.load=m=>{const h=new Promise((b,n)=>{const p=C.onAbortOrThrow(m,n);this.destroyed&&n(new c("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this}));this.when(b,n).finally(()=>{p&&p.remove()})});if("not-loaded"===this.loadStatus){this._set("loadStatus","loading");const b=this._loadController=new AbortController;E({signal:b.signal})}x();return h}}));this.when(()=>{this._set("loadStatus","loaded");
this._loadController=null},x=>{this._set("loadStatus","failed");this._set("loadError",x);this._loadController=null})}destroy(){this._loadController&&(this._loadController=w.abortMaybe(this._loadController),this._promiseProps.abort());this._set("loadError",null);this._set("loadWarnings",[])}get loaded(){return"loaded"===this.loadStatus}get loadWarnings(){return this._get("loadWarnings")}load(){return null}cancelLoad(){if(this.isFulfilled())return this;this._set("loadError",new c("load:cancelled","Cancelled"));
this._loadController?.abort();this._promiseProps.abort();return this}};a.__decorate([e.property({readOnly:!0})],u.prototype,"loaded",null);a.__decorate([e.property({readOnly:!0})],u.prototype,"loadError",void 0);a.__decorate([e.property({clonable:!1})],u.prototype,"loadStatus",void 0);a.__decorate([e.property({type:[z],readOnly:!0})],u.prototype,"loadWarnings",null);return u=a.__decorate([r.subclass("esri.core.Loadable")],u)};v=class extends d(v.EsriPromise){};v=a.__decorate([r.subclass("esri.core.Loadable")],
v);(function(u){u.LoadableMixin=d;u.isLoadable=function(A){return!(!A||!A.load)}})(v||={});return v})},"esri/core/Promise":function(){define(["exports","../chunks/tslib.es6","./Accessor","./promiseUtils","./accessorSupport/decorators/subclass"],function(a,c,w,v,C){var z;(function(d){d[d.PENDING=0]="PENDING";d[d.RESOLVED=1]="RESOLVED";d[d.REJECTED=2]="REJECTED"})(z||={});class e{constructor(){this._resolver=v.createResolver();this._status=z.PENDING;this._resolvingPromises=[];this._resolver.promise.then(()=>
{this._status=z.RESOLVED;this._cleanUp()},()=>{this._status=z.REJECTED;this._cleanUp()});this.promise=this._resolver.promise}destroy(){this._cleanUp()}addResolvingPromise(d){this._resolvingPromises.push(d);this._tryResolve()}isResolved(){return this._status===z.RESOLVED}isRejected(){return this._status===z.REJECTED}isFulfilled(){return this._status!==z.PENDING}abort(){this._resolver.reject(v.createAbortError())}_cleanUp(){this._resolvingPromises=this._allPromise=null}_tryResolve(){if(!this.isFulfilled()){var d=
v.createResolver(),u=[...this._resolvingPromises,d.promise],A=this._allPromise=Promise.all(u);A.then(()=>{this.isFulfilled()||this._allPromise!==A||this._resolver.resolve()},x=>{this.isFulfilled()||this._allPromise!==A||v.isAbortError(x)||this._resolver.reject(x)});d.resolve()}}}const r=d=>{d=class extends d{constructor(...u){super(...u);this._promiseProps=new e;this.addResolvingPromise(Promise.resolve())}destroy(){this._promiseProps.destroy()}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(u,
A){return this._promiseProps.promise.then(()=>this).then(u,A)}catch(u){return this.when(null,u)}addResolvingPromise(u){u&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in u?u.when():u)}};return d=c.__decorate([C.subclass("esri.core.Promise")],d)};a.EsriPromise=class extends r(w){};a.EsriPromise=c.__decorate([C.subclass("esri.core.Promise")],a.EsriPromise);a.EsriPromiseMixin=r;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/loadAll":function(){define(["exports",
"./asyncUtils","./Collection","./Loadable"],function(a,c,w,v){async function C(z,e){const r=[],d=(...A)=>{for(const x of A)null!=x&&(Array.isArray(x)?d(...x):w.isCollection(x)?x.forEach(E=>d(E)):v.isLoadable(x)&&r.push(x))};e(d);let u=null;await c.map(r,async A=>{A=await c.result("loadAll"in A&&"function"===typeof A.loadAll?A.loadAll():A.load());!1!==A.ok||u||(u=A)});if(u)throw u.error;return z}a.loadAll=async function(z,e){await z.load();return C(z,e)};a.loadAllChildren=C;Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/portal/Portal":function(){define("require ../chunks/tslib.es6 ../config ../kernel ../request ../core/Error ../core/JSONSupport ../core/Loadable ../core/maybe ../core/promiseUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/RandomLCG ../core/has ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../geometry/Extent ../intl/locale ./portalDefault ./PortalGroup ./PortalQueryParams ./PortalQueryResult ./PortalUser ../support/apiKeyUtils".split(" "),
function(a,c,w,v,C,z,e,r,d,u,A,x,E,m,h,b,n,p,D,M,g,J,R,B){function F(l){const H=v.id;return()=>{const U=l.deref();U&&H.findCredential(U.restUrl)&&U.signIn().catch(()=>{})}}const N=l=>Object.freeze(Object.defineProperty({__proto__:null,default:l},Symbol.toStringTag,{value:"Module"}));var T;let y;const G={PortalGroup:()=>Promise.resolve({default:M}),PortalItem:()=>new Promise((l,H)=>a(["./PortalItem"],U=>l(N(U)),H)),PortalUser:()=>Promise.resolve({default:R})};e=T=class extends e.JSONSupportMixin(r){constructor(l){super(l);
this.access=this._esriIdCredentialCreateHandle=null;this.allSSL=!1;this.authMode="auto";this.bingKey=this.basemapGalleryGroupQuery3D=this.basemapGalleryGroupQuery=this.authorizedCrossOriginDomains=null;this.canProvisionDirectPurchase=this.canListPreProvisionedItems=this.canListData=this.canListApps=!1;this.canSearchPublic=!0;this.canSignInIDP=this.canSignInArcGIS=this.canSharePublic=this.canShareBingPublic=!1;this.colorSetsGroupQuery=null;this.commentsEnabled=!1;this.livingAtlasGroupQuery=this.layoutGroupQuery=
this.galleryTemplatesGroupQuery=this.featuredItemsGroupQuery=this.featuredGroups=this.eueiEnabled=this.devBasemapGalleryGroupQuery=this.description=this.defaultVectorBasemap=this.defaultExtent=this.defaultDevBasemap=this.defaultBasemap=this.customBaseUrl=this.culture=this.created=null;this.hasCategorySchema=!1;this.ipCntryCode=this.id=this.httpsPort=this.httpPort=this.homePageFeaturedContentCount=this.homePageFeaturedContent=this.helperServices=null;this.isReadOnly=this.isPortal=!1;this.region=this.portalProperties=
this.portalMode=this.portalHostname=this.name=this.modified=this.maxTokenExpirationMinutes=this.layerTemplatesGroupQuery=null;this.recycleBinEnabled=!1;this.rotatorPanels=null;this.showHomePageDescription=!1;this.sourceJSON=null;this.supportsHostedServices=!1;this.units=this.templatesGroupQuery=this.symbolSetsGroupQuery=null;this.url=w.portalUrl;this.user=this.urlKey=null;this.use3dBasemaps=!0;this.useVectorBasemaps=this.useStandardizedQuery=!1;this.vectorBasemapGalleryGroupQuery=null}normalizeCtorArgs(l){return"string"===
typeof l?{url:l}:l}destroy(){k.unregister(this);this.defaultBasemap=d.destroyMaybe(this.defaultBasemap);this.defaultDevBasemap=d.destroyMaybe(this.defaultDevBasemap);this.defaultVectorBasemap=d.destroyMaybe(this.defaultVectorBasemap);this._esriIdCredentialCreateHandle=d.removeMaybe(this._esriIdCredentialCreateHandle)}readAuthorizedCrossOriginDomains(l){if(l)for(const H of l)w.request.trustedServers.includes(H)||w.request.trustedServers.push(H);return l}readDefaultBasemap(l){return this._readBasemap(l)}readDefaultDevBasemap(l){return this._readBasemap(l)}readDefaultVectorBasemap(l){return this._readBasemap(l)}get extraQuery(){const l=
!this.user?.orgId||this.canSearchPublic;return this.id&&!l?` AND orgid:${this.id}`:null}get isOrganization(){return!!this.access}get itemPageUrl(){return this.url?`${this.url}/home/item.html`:null}get restUrl(){let l=this.url;if(l){const H=l.indexOf("/sharing");l=0<H?l.substring(0,H):this.url.replace(/\/+$/,"");l+="/sharing/rest"}return l}get thumbnailUrl(){const l=this.restUrl,H=this.thumbnail;return l&&H?this._normalizeSSL(l+"/portals/self/resources/"+H):null}readUrlKey(l){return l?l.toLowerCase():
l}readUser(l){let H=null;l&&(H=R.fromJSON(l),H.portal=this);return H}load(l){const H=(new Promise((U,Q)=>a(["../Basemap"],W=>U(N(W)),Q))).then(({default:U})=>{u.throwIfAborted(l);y=U}).then(()=>this.sourceJSON?this.sourceJSON:this.fetchSelf(this.authMode,!1,l)).then(U=>{if(v.id){const Q=v.id;this.credential=Q.findCredential(this.restUrl);this.credential||this.authMode!==T.AUTH_MODE_AUTO&&this.authMode!==T.AUTH_MODE_NO_PROMPT||(this._esriIdCredentialCreateHandle?.remove(),this._esriIdCredentialCreateHandle=
Q.on("credential-create",F(new WeakRef(this))),k.register(this,this._esriIdCredentialCreateHandle,this))}this.sourceJSON=U;this.read(U)});this.addResolvingPromise(H);return Promise.resolve(this)}async createElevationLayers(){await this.load();const l=this._getHelperService("defaultElevationLayers"),H=(await new Promise((U,Q)=>a(["../layers/ElevationLayer"],W=>U(N(W)),Q))).default;return l?l.map(U=>new H({id:U.id,url:U.url})):[]}async fetchBasemaps(l,H){const U=await this._fetchBasemaps(l,H);!0===
H?.include3d&&!1!==this.use3dBasemaps&&(l=await this._fetchBasemaps3D(l,H),U.unshift(...l));return U}fetchCategorySchema(l){return this.hasCategorySchema?this.request(this.restUrl+"/portals/self/categorySchema",l).then(H=>H.categorySchema):u.isAborted(l)?Promise.reject(u.createAbortError()):Promise.resolve([])}fetchFeaturedGroups(l){const H=this.featuredGroups,U=new g({num:100,sortField:"title"});if(H?.length){const Q=[];for(const W of H)Q.push(`(title:"${W.title}" AND owner:${W.owner})`);U.query=
Q.join(" OR ");return this.queryGroups(U,l).then(W=>W.results)}return u.isAborted(l)?Promise.reject(u.createAbortError()):Promise.resolve([])}fetchRegions(l){const H=this.user?.culture||this.culture||p.getLocale();return this.request(this.restUrl+"/portals/regions",{...l,query:{culture:H}})}fetchSettings(l){const H=this.user?.culture||this.culture||p.getLocale();return this.request(this.restUrl+"/portals/self/settings",{...l,query:{culture:H}})}static getDefault(){return D.ensureDefaultPortalInstance(()=>
new T)}queryGroups(l,H){return this.queryPortal("/community/groups",l,"PortalGroup",H)}queryItems(l,H){return this.queryPortal("/search",l,"PortalItem",H)}queryUsers(l,H){l.sortField||(l.sortField="username");return this.queryPortal("/community/users",l,"PortalUser",H)}fetchSelf(l=this.authMode,H=!1,U){const Q=this.restUrl+"/portals/self";l={authMode:l,query:{culture:p.getLocale().toLowerCase()},withCredentials:!0,...U};"auto"===l.authMode&&(l.authMode="no-prompt");H&&(l.query.default=!0);return this.request(Q,
l)}queryPortal(l,H,U,Q){const W=x.ensureType(g,H),Z=ea=>this.request(this.restUrl+l,{...W.toRequestOptions(this),...Q}).then(ia=>{const na=W.clone();na.start=ia.nextStart;return new J({nextQueryParams:na,queryParams:W,total:ia.total,results:T._resultsToTypedArray(ea,{portal:this},ia,Q)})}).then(ia=>Promise.all(ia.results.map(na=>"function"===typeof na.when?na.when():ia)).then(()=>ia,na=>{u.throwIfAbortError(na);return ia}));return U&&G[U]?G[U]().then(({default:ea})=>{u.throwIfAborted(Q);return Z(ea)}):
Z()}signIn(){if(this.authMode===T.AUTH_MODE_ANONYMOUS||this.authMode===T.AUTH_MODE_NO_PROMPT&&!v.id)return Promise.reject(new z("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if("failed"===this.loadStatus)return Promise.reject(this.loadError);const l=H=>Promise.resolve().then(()=>{if("not-loaded"===this.loadStatus)return H||(this.authMode="immediate"),this.load().then(()=>null);if("loading"===this.loadStatus)return this.load().then(()=>{if(this.credential)return null;this.credential=
H;return this.fetchSelf("immediate")});if(this.user&&this.credential===H)return null;this.credential=H;return this.fetchSelf("immediate")}).then(U=>{U&&(this.sourceJSON=U,this.read(U))});return v.id?v.id.getCredential(this.restUrl,{prompt:this.authMode!==T.AUTH_MODE_NO_PROMPT}).then(H=>l(H)):l(this.credential)}normalizeUrl(l){const H=this.credential?.token;return this._normalizeSSL(H?l+(l.includes("?")?"\x26":"?")+"token\x3d"+H:l)}requestToTypedArray(l,H,U){return this.request(l,H).then(Q=>{const W=
T._resultsToTypedArray(U,{portal:this},Q);return Promise.all(W.map(Z=>"function"===typeof Z.when?Z.when():Q)).then(()=>W,()=>W)})}request(l,H={}){var U={f:"json",...H.query};const {authMode:Q=this.authMode===T.AUTH_MODE_ANONYMOUS||this.authMode===T.AUTH_MODE_NO_PROMPT?this.authMode:"auto",body:W=null,cacheBust:Z=!1,method:ea="auto",responseType:ia="json",signal:na}=H;U={authMode:Q,body:W,cacheBust:Z,method:ea,query:U,responseType:ia,timeout:0,signal:na};H.withCredentials&&(U.withCredentials=!0);return C(this._normalizeSSL(l),
U).then(qa=>qa.data)}toJSON(){throw new z("internal:not-yet-implemented","Portal.toJSON is not yet implemented");}static fromJSON(l){if(!l)return null;if(l.declaredClass)throw Error("JSON object is already hydrated");return new T({sourceJSON:l})}_getHelperService(l){const H=this.helperServices&&this.helperServices[l];if(!H)throw new z("portal:service-not-found",`The \`helperServices\` do not include an entry named "${l}"`);return H}async _fetchBasemaps(l,H){const U=new g;U.query=l||(w.apiKey&&B.supportsApiKey(this.url)?
this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery);U.disableExtraQuery=!0;l=await this.queryGroups(U,H);if(!l.total)return[];l=l.results[0];U.num=100;U.query='type:"Web Map" -type:"Web Application"';U.sortField=l.sortField||"name";U.sortOrder=l.sortOrder||"desc";H=await l.queryItems(U,H);return H.total?H.results.filter(Q=>"Web Map"===Q.type).map(Q=>new y({portalItem:Q})):[]}async _fetchBasemaps3D(l,H){l=l||this.basemapGalleryGroupQuery3D;
if(!l)return[];l=new g({query:l,disableExtraQuery:!0});var U=await this.queryGroups(l,H);if(!U.total)return[];U=U.results[0];l.num=100;l.query='type:"Web Scene"';l.sortField=U.sortField||"name";l.sortOrder=U.sortOrder||"desc";H=await U.queryItems(l,H);return H.total?H.results.filter(Q=>"Web Scene"===Q.type).map(Q=>new y({portalItem:Q})):[]}_normalizeSSL(l){return l.replace(/^http:/i,"https:").replace(":7080",":7443")}_readBasemap(l){return l?(l=y.fromJSON(l),l.portalItem={portal:this},l):null}static _resultsToTypedArray(l,
H,U,Q){if(U){const W=null!=Q?Q.signal:null;U=U.listings||U.notifications||U.userInvitations||U.tags||U.items||U.groups||U.comments||U.provisions||U.results||U.relatedItems||U;if(l||H)U=U.map(Z=>{Z=Object.assign(l?l.fromJSON(Z):Z,H);"function"===typeof Z.load&&Z.load(W);return Z})}else U=[];return U}};e.AUTH_MODE_ANONYMOUS="anonymous";e.AUTH_MODE_AUTO="auto";e.AUTH_MODE_IMMEDIATE="immediate";e.AUTH_MODE_NO_PROMPT="no-prompt";c.__decorate([A.property()],e.prototype,"access",void 0);c.__decorate([A.property()],
e.prototype,"allSSL",void 0);c.__decorate([A.property()],e.prototype,"authMode",void 0);c.__decorate([A.property()],e.prototype,"authorizedCrossOriginDomains",void 0);c.__decorate([h.reader("authorizedCrossOriginDomains")],e.prototype,"readAuthorizedCrossOriginDomains",null);c.__decorate([A.property()],e.prototype,"basemapGalleryGroupQuery",void 0);c.__decorate([A.property({json:{name:"3DBasemapGalleryGroupQuery"}})],e.prototype,"basemapGalleryGroupQuery3D",void 0);c.__decorate([A.property()],e.prototype,
"bingKey",void 0);c.__decorate([A.property()],e.prototype,"canListApps",void 0);c.__decorate([A.property()],e.prototype,"canListData",void 0);c.__decorate([A.property()],e.prototype,"canListPreProvisionedItems",void 0);c.__decorate([A.property()],e.prototype,"canProvisionDirectPurchase",void 0);c.__decorate([A.property()],e.prototype,"canSearchPublic",void 0);c.__decorate([A.property()],e.prototype,"canShareBingPublic",void 0);c.__decorate([A.property()],e.prototype,"canSharePublic",void 0);c.__decorate([A.property()],
e.prototype,"canSignInArcGIS",void 0);c.__decorate([A.property()],e.prototype,"canSignInIDP",void 0);c.__decorate([A.property()],e.prototype,"colorSetsGroupQuery",void 0);c.__decorate([A.property()],e.prototype,"commentsEnabled",void 0);c.__decorate([A.property({type:Date})],e.prototype,"created",void 0);c.__decorate([A.property()],e.prototype,"credential",void 0);c.__decorate([A.property()],e.prototype,"culture",void 0);c.__decorate([A.property()],e.prototype,"currentVersion",void 0);c.__decorate([A.property()],
e.prototype,"customBaseUrl",void 0);c.__decorate([A.property()],e.prototype,"defaultBasemap",void 0);c.__decorate([h.reader("defaultBasemap")],e.prototype,"readDefaultBasemap",null);c.__decorate([A.property()],e.prototype,"defaultDevBasemap",void 0);c.__decorate([h.reader("defaultDevBasemap")],e.prototype,"readDefaultDevBasemap",null);c.__decorate([A.property({type:n})],e.prototype,"defaultExtent",void 0);c.__decorate([A.property()],e.prototype,"defaultVectorBasemap",void 0);c.__decorate([h.reader("defaultVectorBasemap")],
e.prototype,"readDefaultVectorBasemap",null);c.__decorate([A.property()],e.prototype,"description",void 0);c.__decorate([A.property()],e.prototype,"devBasemapGalleryGroupQuery",void 0);c.__decorate([A.property()],e.prototype,"eueiEnabled",void 0);c.__decorate([A.property({readOnly:!0})],e.prototype,"extraQuery",null);c.__decorate([A.property()],e.prototype,"featuredGroups",void 0);c.__decorate([A.property()],e.prototype,"featuredItemsGroupQuery",void 0);c.__decorate([A.property()],e.prototype,"galleryTemplatesGroupQuery",
void 0);c.__decorate([A.property()],e.prototype,"layoutGroupQuery",void 0);c.__decorate([A.property()],e.prototype,"livingAtlasGroupQuery",void 0);c.__decorate([A.property()],e.prototype,"hasCategorySchema",void 0);c.__decorate([A.property()],e.prototype,"helpBase",void 0);c.__decorate([A.property()],e.prototype,"helperServices",void 0);c.__decorate([A.property()],e.prototype,"helpMap",void 0);c.__decorate([A.property()],e.prototype,"homePageFeaturedContent",void 0);c.__decorate([A.property()],e.prototype,
"homePageFeaturedContentCount",void 0);c.__decorate([A.property()],e.prototype,"httpPort",void 0);c.__decorate([A.property()],e.prototype,"httpsPort",void 0);c.__decorate([A.property()],e.prototype,"id",void 0);c.__decorate([A.property()],e.prototype,"ipCntryCode",void 0);c.__decorate([A.property({readOnly:!0})],e.prototype,"isOrganization",null);c.__decorate([A.property()],e.prototype,"isPortal",void 0);c.__decorate([A.property()],e.prototype,"isReadOnly",void 0);c.__decorate([A.property({readOnly:!0})],
e.prototype,"itemPageUrl",null);c.__decorate([A.property()],e.prototype,"layerTemplatesGroupQuery",void 0);c.__decorate([A.property()],e.prototype,"maxTokenExpirationMinutes",void 0);c.__decorate([A.property({type:Date})],e.prototype,"modified",void 0);c.__decorate([A.property()],e.prototype,"name",void 0);c.__decorate([A.property()],e.prototype,"portalHostname",void 0);c.__decorate([A.property()],e.prototype,"portalMode",void 0);c.__decorate([A.property()],e.prototype,"portalProperties",void 0);
c.__decorate([A.property()],e.prototype,"region",void 0);c.__decorate([A.property()],e.prototype,"recycleBinEnabled",void 0);c.__decorate([A.property({readOnly:!0})],e.prototype,"restUrl",null);c.__decorate([A.property()],e.prototype,"rotatorPanels",void 0);c.__decorate([A.property()],e.prototype,"showHomePageDescription",void 0);c.__decorate([A.property()],e.prototype,"sourceJSON",void 0);c.__decorate([A.property()],e.prototype,"staticImagesUrl",void 0);c.__decorate([A.property({json:{name:"2DStylesGroupQuery"}})],
e.prototype,"stylesGroupQuery2d",void 0);c.__decorate([A.property({json:{name:"stylesGroupQuery"}})],e.prototype,"stylesGroupQuery3d",void 0);c.__decorate([A.property()],e.prototype,"supportsHostedServices",void 0);c.__decorate([A.property()],e.prototype,"symbolSetsGroupQuery",void 0);c.__decorate([A.property()],e.prototype,"templatesGroupQuery",void 0);c.__decorate([A.property()],e.prototype,"thumbnail",void 0);c.__decorate([A.property({readOnly:!0})],e.prototype,"thumbnailUrl",null);c.__decorate([A.property()],
e.prototype,"units",void 0);c.__decorate([A.property()],e.prototype,"url",void 0);c.__decorate([A.property()],e.prototype,"urlKey",void 0);c.__decorate([h.reader("urlKey")],e.prototype,"readUrlKey",null);c.__decorate([A.property()],e.prototype,"user",void 0);c.__decorate([h.reader("user")],e.prototype,"readUser",null);c.__decorate([A.property()],e.prototype,"use3dBasemaps",void 0);c.__decorate([A.property()],e.prototype,"useStandardizedQuery",void 0);c.__decorate([A.property()],e.prototype,"useVectorBasemaps",
void 0);c.__decorate([A.property()],e.prototype,"vectorBasemapGalleryGroupQuery",void 0);c=e=T=c.__decorate([b.subclass("esri.portal.Portal")],e);const k=new FinalizationRegistry(l=>{l.remove()});return c})},"esri/portal/portalDefault":function(){define(["exports"],function(a){let c;a.clearDefaultPortalInstance=function(){c=void 0};a.ensureDefaultPortalInstance=function(w){if(!c||c.destroyed)c=w();return c};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/portal/PortalGroup":function(){define("../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/RandomLCG ../core/has ../core/accessorSupport/decorators/subclass ./PortalQueryParams".split(" "),
function(a,c,w,v,C,z,e,r,d){var u;w=u=class extends w.JSONSupport{constructor(A){super(A);this.id=this.description=this.created=this.access=null;this.isInvitationOnly=!1;this.title=this.tags=this.sourceJSON=this.sortOrder=this.sortField=this.snippet=this.portal=this.owner=this.modified=null}get thumbnailUrl(){const A=this.url,x=this.thumbnail;return A&&x&&this.portal?this.portal?.normalizeUrl(`${A}/info/${x}?f=json`):null}get url(){const A=this.portal?.restUrl;return A?A+"/community/groups/"+this.id:
null}fetchCategorySchema(A){return this.portal.request(this.url+"/categorySchema",A).then(x=>{x=x.categorySchema||[];return x.some(E=>"contentCategorySetsGroupQuery.LivingAtlas"===E.source)?this._fetchCategorySchemaSet("LivingAtlas",A):x})}fetchMembers(A){return this.portal.request(this.url+"/users",A)}getThumbnailUrl(A){let x=this.thumbnailUrl;x&&A&&(x+=`&w=${A}`);return x}toJSON(){throw new c("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented");}static fromJSON(A){if(!A)return null;
if(A.declaredClass)throw Error("JSON object is already hydrated");const x=new u({sourceJSON:A});x.read(A);return x}queryItems(A,x){A=C.ensureType(d,A);const E=this.portal;if(5<parseFloat(E.currentVersion))return A=A||new d,E.queryPortal(`/content/groups/${this.id}/search`,A,"PortalItem",x);A=A?A.clone():new d;A.query="group:"+this.id+(A.query?" "+A.query:"");return E.queryItems(A,x)}_fetchCategorySchemaSet(A,x){const E=this.portal;return E.fetchSelf(E.authMode,!0,x).then(m=>{if(m=m.contentCategorySetsGroupQuery)return m=
new d({disableExtraQuery:!0,num:1,query:m}),E.queryGroups(m,x);throw new c("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found");}).then(m=>{if(m.total){m=m.results[0];const h=new d({num:1,query:`typekeywords:"${A}"`});return m.queryItems(h,x)}throw new c("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found");}).then(m=>m.total?m.results[0].fetchData("json",x).then(h=>{h=h?.categorySchema;return h?.length?h:[]}):[])}};a.__decorate([v.property()],
w.prototype,"access",void 0);a.__decorate([v.property({type:Date})],w.prototype,"created",void 0);a.__decorate([v.property()],w.prototype,"description",void 0);a.__decorate([v.property()],w.prototype,"id",void 0);a.__decorate([v.property()],w.prototype,"isInvitationOnly",void 0);a.__decorate([v.property({type:Date})],w.prototype,"modified",void 0);a.__decorate([v.property()],w.prototype,"owner",void 0);a.__decorate([v.property()],w.prototype,"portal",void 0);a.__decorate([v.property()],w.prototype,
"snippet",void 0);a.__decorate([v.property()],w.prototype,"sortField",void 0);a.__decorate([v.property()],w.prototype,"sortOrder",void 0);a.__decorate([v.property()],w.prototype,"sourceJSON",void 0);a.__decorate([v.property()],w.prototype,"tags",void 0);a.__decorate([v.property()],w.prototype,"thumbnail",void 0);a.__decorate([v.property({readOnly:!0})],w.prototype,"thumbnailUrl",null);a.__decorate([v.property()],w.prototype,"title",void 0);a.__decorate([v.property({readOnly:!0})],w.prototype,"url",
null);return w=u=a.__decorate([r.subclass("esri.portal.PortalGroup")],w)})},"esri/portal/PortalQueryParams":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/jsonMap ../core/lang ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/accessorSupport/decorators/subclass ../geometry/Extent ../geometry/SpatialReference ../geometry/support/webMercatorUtils".split(" "),function(a,c,w,v,C,z,e,r,d,u,A){var x;const E=new w.JSONMap({avgRating:"avg-rating",numRatings:"num-ratings",
numComments:"num-comments",numViews:"num-views"});c=x=class extends c{constructor(m){super(m);this.categories=null;this.disableExtraQuery=!1;this.filter=this.extent=null;this.num=10;this.sortField=this.query=null;this.start=1}get sortOrder(){return this._get("sortOrder")||"asc"}set sortOrder(m){"asc"!==m&&"desc"!==m||this._set("sortOrder",m)}clone(){return new x({categories:this.categories?v.clone(this.categories):null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():
null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}toRequestOptions(m,h){let b=[];this.categories&&(b=this.categories.map(D=>Array.isArray(D)?JSON.stringify(D):D));let n="";if(this.extent){var p=A.project(this.extent,u.WGS84);null!=p&&(n=`${p.xmin},${p.ymin},${p.xmax},${p.ymax}`)}p=this.query;!this.disableExtraQuery&&m.extraQuery&&(p="("+p+")"+m.extraQuery);m={categories:b,bbox:n,q:p,filter:this.filter,num:this.num,sortField:null,
sortOrder:null,start:this.start};this.sortField&&(m.sortField=this.sortField.split(",").map(D=>E.toJSON(D.trim())).join(","),m.sortOrder=this.sortOrder);return{query:{...h,...m}}}};a.__decorate([C.property()],c.prototype,"categories",void 0);a.__decorate([C.property()],c.prototype,"disableExtraQuery",void 0);a.__decorate([C.property({type:d})],c.prototype,"extent",void 0);a.__decorate([C.property()],c.prototype,"filter",void 0);a.__decorate([C.property()],c.prototype,"num",void 0);a.__decorate([C.property()],
c.prototype,"query",void 0);a.__decorate([C.property()],c.prototype,"sortField",void 0);a.__decorate([C.property()],c.prototype,"sortOrder",null);a.__decorate([C.property()],c.prototype,"start",void 0);return c=x=a.__decorate([r.subclass("esri.portal.PortalQueryParams")],c)})},"esri/portal/PortalQueryResult":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass".split(" "),
function(a,c,w,v,C,z,e){c=class extends c{constructor(r){super(r);this.total=this.results=this.queryParams=this.nextQueryParams=null}};a.__decorate([w.property()],c.prototype,"nextQueryParams",void 0);a.__decorate([w.property()],c.prototype,"queryParams",void 0);a.__decorate([w.property()],c.prototype,"results",void 0);a.__decorate([w.property()],c.prototype,"total",void 0);return c=a.__decorate([e.subclass("esri.portal.PortalQueryResult")],c)})},"esri/portal/PortalUser":function(){define("require ../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass ./PortalFolder ./PortalGroup".split(" "),
function(a,c,w,v,C,z,e,r,d,u,A){var x;v=x=class extends v.JSONSupport{constructor(E){super(E);this.userType=this.userLicenseTypeId=this.username=this.units=this.sourceJSON=this.roleId=this.role=this.region=this.privileges=this.preferredView=this.portal=this.orgId=this.modified=this.fullName=this.email=this.description=this.culture=this.created=this.access=null}get thumbnailUrl(){const E=this.url,m=this.thumbnail;return E&&m?this.portal.normalizeUrl(`${E}/info/${m}?f=json`):null}get userContentUrl(){const E=
this.portal?.restUrl;return E?`${E}/content/users/${this.username}`:null}get url(){const E=this.portal?.restUrl;return E?`${E}/community/users/${this.username}`:null}addItem(E){const m=E&&E.item;var h=E?.data;E=E?.folder;const b={method:"post"};m&&(b.query=m.createPostQuery(),null!=h&&("string"===typeof h?b.query.text=h:"object"===typeof h&&(b.query.text=JSON.stringify(h))));h=this.userContentUrl;E&&(h+="/"+("string"===typeof E?E:E.id));return this.portal.request(h+"/addItem",b).then(n=>{m.id=n.id;
m.portal=this.portal;return m.loaded?m.reload():m.load()})}async deleteItem(E,m=!1){let h=this.userContentUrl;E.ownerFolder&&(h+="/"+E.ownerFolder);await this.portal.request(h+`/items/${E.id}/delete`,{method:"post",query:m?{permanentDelete:!0}:{}});E.id=null;E.portal=null}async deleteItems(E,m=!1){E=E.concat();var h=this.userContentUrl+"/deleteItems";const b=[];var n=E.map(p=>p.id);if(n.length){m={method:"post",query:{items:n.join(","),permanentDelete:m}};h=await this.portal.request(h,m);for(const p of h.results)h=
E.find(D=>p.itemId===D.id),m=p.success,n=null,m?(h.id=null,h.portal=null):p.error&&(n=new w("portal:delete-item-failed",p.error.message,p.error)),b.push({item:h,success:m,error:n})}return b}fetchFolders(){return this.portal.request(this.userContentUrl??"",{query:{num:1}}).then(E=>E&&E.folders?E.folders.map(m=>{m=u.fromJSON(m);m.portal=this.portal;return m}):[])}fetchGroups(){return this.portal.request(this.url??"").then(E=>E&&E.groups?E.groups.map(m=>{m=A.fromJSON(m);m.portal=this.portal;return m}):
[])}async fetchItems(E){E??={};var m=this.userContentUrl??"";E.folder&&(m+="/"+E.folder.id);const {default:h}=await new Promise((b,n)=>a(["./PortalItem"],p=>b(Object.freeze(Object.defineProperty({__proto__:null,default:p},Symbol.toStringTag,{value:"Module"}))),n));E=await this.portal.request(m,{query:{folders:!1,inRecycleBin:E.inRecycleBin?!0:null,foldersContent:!E.folder&&E.includeSubfolderItems?!0:null,num:E.num||10,start:E.start||1,sortField:E.sortField||"created",sortOrder:E.sortOrder||"asc"}});
return E?.items?(m=E.items.map(b=>{b=h.fromJSON(b);b.portal=this.portal;return b}),await Promise.all(m.map(b=>b.load())),{items:m,nextStart:E.nextStart,total:E.total}):{items:[],nextStart:-1,total:0}}fetchTags(){return this.portal.request(this.url+"/tags").then(E=>E.tags)}getThumbnailUrl(E){let m=this.thumbnailUrl;m&&E&&(m+=`&w=${E}`);return m}queryFavorites(E){return this.favGroupId?(this._favGroup||(this._favGroup=new A({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(E)):Promise.reject(new w("internal:unknown",
"Unknown internal error",{internalError:"Unknown favGroupId"}))}async restoreItem(E,m){await this.portal.request(this.userContentUrl+`/items/${E.id}/restore`,{method:"post",query:m?{folderID:"string"===typeof m?m:m.id}:null})}toJSON(){throw new w("internal:not-yet-implemented","PortalUser.toJSON is not yet implemented");}static fromJSON(E){if(!E)return null;if(E.declaredClass)throw Error("JSON object is already hydrated");const m=new x({sourceJSON:E});m.read(E);return m}};c.__decorate([C.property()],
v.prototype,"access",void 0);c.__decorate([C.property({type:Date})],v.prototype,"created",void 0);c.__decorate([C.property()],v.prototype,"culture",void 0);c.__decorate([C.property()],v.prototype,"description",void 0);c.__decorate([C.property()],v.prototype,"email",void 0);c.__decorate([C.property()],v.prototype,"favGroupId",void 0);c.__decorate([C.property()],v.prototype,"fullName",void 0);c.__decorate([C.property({type:Date})],v.prototype,"modified",void 0);c.__decorate([C.property()],v.prototype,
"orgId",void 0);c.__decorate([C.property()],v.prototype,"portal",void 0);c.__decorate([C.property()],v.prototype,"preferredView",void 0);c.__decorate([C.property()],v.prototype,"privileges",void 0);c.__decorate([C.property()],v.prototype,"region",void 0);c.__decorate([C.property()],v.prototype,"role",void 0);c.__decorate([C.property()],v.prototype,"roleId",void 0);c.__decorate([C.property()],v.prototype,"sourceJSON",void 0);c.__decorate([C.property()],v.prototype,"thumbnail",void 0);c.__decorate([C.property({readOnly:!0})],
v.prototype,"thumbnailUrl",null);c.__decorate([C.property()],v.prototype,"units",void 0);c.__decorate([C.property({readOnly:!0})],v.prototype,"userContentUrl",null);c.__decorate([C.property({readOnly:!0})],v.prototype,"url",null);c.__decorate([C.property()],v.prototype,"username",void 0);c.__decorate([C.property()],v.prototype,"userLicenseTypeId",void 0);c.__decorate([C.property()],v.prototype,"userType",void 0);return v=x=c.__decorate([d.subclass("esri.portal.PortalUser")],v)})},"esri/portal/PortalFolder":function(){define("../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass".split(" "),
function(a,c,w,v,C,z,e,r){w=class extends w.JSONSupport{constructor(d){super(d);this.username=this.title=this.portal=this.id=this.created=null}get url(){const d=this.portal?.restUrl;return d?`${d}/content/users/${this.username}/${this.id}`:null}toJSON(){throw new c("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented");}};a.__decorate([v.property({type:Date})],w.prototype,"created",void 0);a.__decorate([v.property()],w.prototype,"id",void 0);a.__decorate([v.property()],w.prototype,
"portal",void 0);a.__decorate([v.property()],w.prototype,"title",void 0);a.__decorate([v.property({readOnly:!0})],w.prototype,"url",null);a.__decorate([v.property()],w.prototype,"username",void 0);return w=a.__decorate([r.subclass("esri.portal.PortalFolder")],w)})},"esri/portal/PortalItem":function(){define("require ../chunks/tslib.es6 ../assets ../core/Error ../core/JSONSupport ../core/lang ../core/Loadable ../core/urlUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../geometry/Extent ./Portal ./PortalItemResource ./PortalRating ../chunks/persistableUrlUtils".split(" "),
function(a,c,w,v,C,z,e,r,d,u,A,x,E,m,h,b,n){var p;const D=new Set("3DTiles Service;CSV;Feature Collection;Feature Service;Feed;GeoJson;Group Layer;Image Service;KML;Map Service;Media Layer;Scene Service;Stream Service;Vector Tile Service;WFS;WMS;WMTS".split(";")),M=new Set(["KML","GeoJson","CSV"]);C=p=class extends C.JSONSupportMixin(e){static from(g){return u.ensureClass(p,g)}constructor(g){super(g);this.id=this.groupCategories=this.extent=this.description=this.culture=this.created=this.categories=
this.avgRating=this.applicationProxies=this.apiKey=this.accessInformation=this.access=null;this.isOrgItem=!1;this.url=this.typeKeywords=this.type=this.title=this.tags=this.spatialReference=this.sourceUrl=this.sourceJSON=this.snippet=this.size=this.screenshots=this.portal=this.ownerFolder=this.owner=this.numViews=this.numRatings=this.numComments=this.name=this.modified=this.licenseInfo=this.itemControl=null}destroy(){this.portal=null}get displayName(){const g=this.type,J=this.typeKeywords||[];let R=
g;"Feature Service"===g||"Feature Collection"===g?R=J.includes("Table")?"Table":J.includes("Route Layer")?"Route Layer":J.includes("Markup")?"Markup":"Feature Layer":"Image Service"===g?R=J.includes("Elevation 3D Layer")?"Elevation Layer":J.includes("Tiled Imagery")?"Tiled Imagery Layer":"Imagery Layer":"Scene Service"===g?R="Scene Layer":"Video Service"===g?R="Video Layer":"Scene Package"===g?R="Scene Layer Package":"Stream Service"===g?R="Feature Layer":"Geoprocessing Service"===g?R=J.includes("Web Tool")?
"Tool":"Geoprocessing Service":"Geoenrichment Service"===g?R="GeoEnrichment Service":"Geocoding Service"===g?R="Locator":"Microsoft Powerpoint"===g?R="Microsoft PowerPoint":"GeoJson"===g?R="GeoJSON":"Globe Service"===g?R="Globe Layer":"Vector Tile Service"===g?R="Tile Layer":"netCDF"===g?R="NetCDF":"Map Service"===g?R=J.includes("Spatiotemporal")||!J.includes("Hosted Service")&&!J.includes("Tiled")||J.includes("Relational")?"Map Image Layer":"Tile Layer":g?.toLowerCase().includes("add in")?R=g.replaceAll(/(add in)/gi,
"Add-In"):"datastore catalog service"===g?R="Big Data File Share":"Compact Tile Package"===g?R="Tile Package (tpkx)":"Raster function template"===g?R="Raster Function Template":"OGCFeatureServer"===g?R="OGC Feature Layer":"web mapping application"===g&&J.includes("configurableApp")?R="Instant App":"Insights Page"===g?R="Insights Report":"Excalibur Imagery Project"===g?R="Excalibur Project":"3DTiles Service"===g?R="3D tiles layer":"3DTiles Package"===g&&(R="3D tiles package");return R}readExtent(g){return g&&
g.length?new E(g[0][0],g[0][1],g[1][0],g[1][1]):null}get iconUrl(){var g=this.type?.toLowerCase()||"";const J=this.typeKeywords||[];var R=!1,B=!1;let F=!1,N=!1,T=!1,y=!1;R=B=!1;0<g.indexOf("service")||"feature collection"===g||"kml"===g||"wms"===g||"wmts"===g||"wfs"===g?(R=J.includes("Hosted Service"),"feature service"===g||"feature collection"===g||"kml"===g||"wfs"===g?(B=J.includes("Table"),F=J.includes("Route Layer"),N=J.includes("Markup"),T=J.includes("Spatiotemporal"),y=J.includes("UtilityNetwork"),
g=T&&B?"spatiotemporaltable":B?"table":F?"routelayer":N?"markup":T?"spatiotemporal":y?"utilitynetwork":R?"featureshosted":"features"):"map service"===g||"wms"===g||"wmts"===g?(T=J.includes("Spatiotemporal"),B=J.includes("Relational"),g=T||B?"mapimages":R||J.includes("Tiled")||"wmts"===g?"maptiles":"mapimages"):g="scene service"===g?J.includes("Line")?"sceneweblayerline":J.includes("3DObject")?"sceneweblayermultipatch":J.includes("Point")?"sceneweblayerpoint":J.includes("IntegratedMesh")?"sceneweblayermesh":
J.includes("PointCloud")?"sceneweblayerpointcloud":J.includes("Polygon")?"sceneweblayerpolygon":J.includes("Building")?"sceneweblayerbuilding":J.includes("Voxel")?"sceneweblayervoxel":"sceneweblayer":"image service"===g?J.includes("Elevation 3D Layer")?"elevationlayer":J.includes("Tiled Imagery")?"tiledimagerylayer":"imagery":"stream service"===g?"streamlayer":"vector tile service"===g?"vectortile":"datastore catalog service"===g?"datastorecollection":"geocoding service"===g?"geocodeservice":"video service"===
g?J.includes("Live Stream")?"livestreamvideolayer":"videolayer":"geoprocessing service"===g?J.includes("Web Tool")?"tool":"layers":"geodata service"===g?"geodataservice":"3dtiles service"===g?J.includes("3DObject")?"3dobjecttileslayer":J.includes("IntegratedMesh")?"integratedmeshtileslayer":"3dtileslayer":"layers"):g="web map"===g||"cityengine web scene"===g?"maps":"web scene"===g?J.includes("ViewingMode-Local")?"webscenelocal":"websceneglobal":"web mapping application"===g&&J.includes("configurableApp")?
"instantapps":"web mapping application"===g||"mobile application"===g||"application"===g||"operation view"===g||"desktop application"===g?"apps":"map document"===g||"map package"===g||"published map"===g||"scene document"===g||"globe document"===g||"basemap package"===g||"mobile basemap package"===g||"mobile map package"===g||"project package"===g||"project template"===g||"pro map"===g||"layout"===g||"layer"===g&&J.includes("ArcGIS Pro")||"explorer map"===g&&J.indexOf("Explorer Document")?"mapsgray":
"service definition"===g||"shapefile"===g||"cad drawing"===g||"geojson"===g||"netcdf"===g||"administrative report"===g?"datafiles":"360 vr experience"===g?"360vr":"explorer add in"===g||"desktop add in"===g||"windows viewer add in"===g||"windows viewer configuration"===g?"appsgray":"arcgis pro add in"===g||"arcgis pro configuration"===g?"addindesktop":"pdf"===g?"pdf":"microsoft word"===g?"word":"microsoft excel"===g?"excel":"microsoft powerpoint"===g?"ppt":"rule package"===g||"file geodatabase"===
g||"sqlite geodatabase"===g||"csv collection"===g||"kml collection"===g||"windows mobile package"===g||"map template"===g||"desktop application template"===g||"gml"===g||"arcpad package"===g||"code sample"===g||"document link"===g||"earth configuration"===g||"operations dashboard add in"===g||"rules package"===g||"workflow manager package"===g||"explorer map"===g&&J.includes("Explorer Mapping Application")||J.includes("Document")?"datafilesgray":"network analysis service"===g||"geoprocessing service"===
g||"geodata service"===g||"geometry service"===g||"geoprocessing package"===g||"locator package"===g||"geoprocessing sample"===g||"workflow manager service"===g?"toolsgray":"layer"===g||"layer package"===g||"explorer layer"===g?"layersgray":"analysis model"===g?"analysismodel":"scene package"===g?"scenepackage":"3dtiles package"===g?"3dtileslayerpackage":"3dtiles service"===g?"3dtileslayer":"mobile scene package"===g?"mobilescenepackage":"tile package"===g||"compact tile package"===g?"tilepackage":
"task file"===g?"taskfile":"report template"===g?"report-template":"statistical data collection"===g?"statisticaldatacollection":"insights workbook"===g?"workbook":"insights model"===g?"insightsmodel":"insights page"===g?"insightspage":"insights theme"===g?"insightstheme":"hub initiative"===g?"hubinitiative":"hub page"===g?"hubpage":"hub site application"===g?"hubsite":"hub event"===g?"hubevent":"hub project"===g?"hubproject":"relational database connection"===g?"relationaldatabaseconnection":"big data file share"===
g?"datastorecollection":"image collection"===g?"imagecollection":"desktop style"===g?"desktopstyle":"style"===g?J.includes("Dictionary")?"dictionarystyle":"style":"dashboard"===g?"dashboard":"raster function template"===g?"rasterprocessingtemplate":"vector tile package"===g?"vectortilepackage":"ortho mapping project"===g?"orthomappingproject":"ortho mapping template"===g?"orthomappingtemplate":"solution"===g?"solutions":"geopackage"===g?"geopackage":"deep learning package"===g?"deeplearningpackage":
"real time analytic"===g?"realtimeanalytics":"big data analytic"===g?"bigdataanalytics":"feed"===g?"feed":"excalibur imagery project"===g?"excaliburimageryproject":"notebook"===g?"notebook":"storymap"===g?"storymap":"survey123 add in"===g?"survey123addin":"mission"===g?"mission":"mission report"===g?"missionreport":"mission template"===g?"missiontemplate":"quickcapture project"===g?"quickcaptureproject":"pro report"===g?"proreport":"pro report template"===g?"proreporttemplate":"urban model"===g?"urbanmodel":
"web experience"===g?"experiencebuilder":"web experience template"===g?"webexperiencetemplate":"experience builder widget"===g?"experiencebuilderwidget":"experience builder widget package"===g?"experiencebuilderwidgetpackage":"workflow"===g?"workflow":"kernel gateway connection"===g?"kernelgatewayconnection":"insights script"===g?"insightsscript":"hub initiative template"===g?"hubinitiativetemplate":"storymap theme"===g?"storymaptheme":"knowledge graph"===g?"knowledgegraph":"knowledge graph layer"===
g?"knowledgegraphlayer":"knowledge studio project"===g?"knowledgestudio":"native application"===g?"nativeapp":"native application installer"===g?"nativeappinstaller":"web link chart"===g?"linkchart":"knowledge graph web investigation"===g?"investigation":"ogcfeatureserver"===g?"features":"pro project"===g?"proproject":"insights workbook package"===g?"insightsworkbookpackage":"apache parquet"===g?"apacheparquet":"notebook code snippet library"===g?"notebookcodesnippets":"suitability model"===g?"suitabilitymodel":
"esri classifier definition"===g?"classifierdefinition":"esri classification schema"===g?"classificationschema":"insights data engineering workbook"===g?"dataengineeringworkbook":"insights data engineering model"===g?"dataengineeringmodel":"deep learning studio project"===g?"deeplearningproject":"discussion"===g?"discussion":"allsource project"===g?"allsourceproject":"api key"===g?"apikey":"data pipeline"===g?"datapipelines":"group layer"===g?(R=J.includes("Map"))?"layergroup2d":"layergroup":"media layer"===
g?"onlinemedialayer":"form"===g?J.includes("Survey123")?"survey":"datafilesgray":"csv"===g?"csv":"image"===g?"image":"maps";return g?w.getAssetUrl("esri/images/portal/"+g+"16.png"):null}get isLayer(){return null!=this.type&&D.has(this.type)}get itemCdnUrl(){return n.toCDNUrl(this.itemUrl)}get itemPageUrl(){const g=this.portal?.itemPageUrl;return g&&this.id?`${g}?id=${this.id}`:null}get itemUrl(){const g=this.portal?.restUrl;return g&&this.id?`${g}/content/items/${this.id}`:null}get thumbnailUrl(){const g=
this.itemUrl,J=this.thumbnail;return g&&J?this.portal?.normalizeUrl(`${g}/info/${J}?f=json`)??null:null}get userItemUrl(){const g=this.portal?.restUrl;if(!g)return null;const J=this.owner||this.portal?.user?.username;return J?`${g}/content/users/${this.ownerFolder?`${J}/${this.ownerFolder}`:J}/items/${this.id}`:null}load(g){const J=this.portal??(this.portal=m.getDefault()),R=J.load(g).then(()=>this.sourceJSON?this.sourceJSON:this.id&&this.itemUrl?J.request(this.itemUrl,{signal:null!=g?g.signal:null,
query:{token:this.apiKey}}):{}).then(B=>{this.sourceJSON=B;this.read(B)});this.addResolvingPromise(R);return Promise.resolve(this)}async addRating(g){const J={method:"post",query:{}};g instanceof b&&(g=g.rating);null==g||isNaN(g)||"number"!==typeof g||(J.query.rating=g);if(!this.portal)return null;await this.portal.request(this.itemUrl+"/addRating",J);return new b({rating:g,created:new Date})}clone(){var g={access:this.access,accessInformation:this.accessInformation,applicationProxies:z.clone(this.applicationProxies),
avgRating:this.avgRating,categories:z.clone(this.categories),created:z.clone(this.created),culture:this.culture,description:this.description,extent:z.clone(this.extent),groupCategories:z.clone(this.groupCategories),id:this.id,itemControl:this.itemControl,licenseInfo:this.licenseInfo,modified:z.clone(this.modified),name:this.name,numComments:this.numComments,numRatings:this.numRatings,numViews:this.numViews,owner:this.owner,ownerFolder:this.ownerFolder,portal:this.portal,screenshots:z.clone(this.screenshots),
size:this.size,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:z.clone(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:z.clone(this.typeKeywords),url:this.url};this.loaded&&(g.loadStatus="loaded");g=(new p({sourceJSON:this.sourceJSON})).set(g);g._set("isOrgItem",this.isOrgItem);return g}createPostQuery(){const g=this.toJSON();for(var J of["tags","typeKeywords","categories"])g[J]=g[J]?.join(", ");({extent:J}=g);J&&(g.extent=
JSON.stringify(J));return g}async deleteRating(){await this.portal.request(this.itemUrl+"/deleteRating",{method:"post"})}fetchData(g="json",J){return this.portal.request(this.itemUrl+"/data",{responseType:g,...J,query:{token:this.apiKey}})}async fetchRating(g){g=await this.portal.request(this.itemUrl+"/rating",{query:{token:this.apiKey},...g});return null!=g.rating?(g.created=new Date(g.created),new b(g)):null}fetchRelatedItems(g,J){return this.portal.requestToTypedArray(this.itemUrl+"/relatedItems",
{query:{...g,token:this.apiKey},...J},p)}getThumbnailUrl(g){let J=this.thumbnailUrl;J&&g&&(J+=`&w=${g}`);return J}reload(){return this.portal.request(this.itemUrl??"",{cacheBust:!0,query:{token:this.apiKey}}).then(g=>{this.sourceJSON=g;this.read(g);return this})}update(g){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const J=g?.data,R={method:"post"};R.query=this.createPostQuery();for(const B in R.query)null===R.query[B]&&(R.query[B]="");R.query.clearEmptyFields=!0;null!=J&&
("string"===typeof J?R.query.text=J:"object"===typeof J&&(R.query.text=JSON.stringify(J)));return this.portal.request(`${this.userItemUrl}/update`,R).then(()=>this.reload())}):Promise.reject(new v("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async copy(g){if(!this.id)throw new v("portal:item-does-not-exist","The item does not exist yet");await this.load();const {portal:J,itemUrl:R}=this;await J.signIn();const {copyResources:B,folder:F,tags:N,title:T}=g||{};g=
{method:"post",query:{copyPrivateResources:"all"===B,folder:"string"===typeof F?F:F?.id,includeResources:!!B,tags:N?.join(","),title:T}};({itemId:g}=await J.request(`${R}/copy`,g));return new p({id:g,portal:J})}updateThumbnail(g){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const J=g.thumbnail,R=g.filename,B={method:"post"};if("string"===typeof J)r.isDataProtocol(J)?B.query={data:J}:B.query={url:r.makeAbsolute(J)},null!=R&&(B.query.filename=R);else{const F=new FormData;null!=
R?F.append("file",J,R):F.append("file",J);B.body=F}return this.portal.request(`${this.userItemUrl}/updateThumbnail`,B).then(()=>this.reload())}):Promise.reject(new v("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async fetchResources(g={},J){const {fetchResources:R}=await new Promise((B,F)=>a(["./support/resourceUtils"],B,F));return R(this,g,J)}async addResource(g,J,R){const {addOrUpdateResources:B}=await new Promise((F,N)=>a(["./support/resourceUtils"],F,N));g.portalItem=
this;await B(this,[{resource:g,content:J,compress:R?.compress,access:R?.access}],"add",R);return g}async removeResource(g,J){const {removeResource:R}=await new Promise((B,F)=>a(["./support/resourceUtils"],B,F));if(g.portalItem&&g.portalItem.itemUrl!==this.itemUrl)throw new v("removeresource:portal-item-mismatch","The portal item associated with the provided resource does not match the item");return R(this,g,J)}async removeAllResources(g){const {removeAllResources:J}=await new Promise((R,B)=>a(["./support/resourceUtils"],
R,B));return J(this,g)}resourceFromPath(g){return new h({portalItem:this,path:g})}toJSON(){var g=this.extent;g={accessInformation:this.accessInformation,categories:z.clone(this.categories),created:this.created?.getTime(),description:this.description,extent:g&&[[g.xmin,g.ymin],[g.xmax,g.ymax]],id:this.id,isOrgItem:this.isOrgItem,licenseInfo:this.licenseInfo,modified:this.modified?.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,
tags:z.clone(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:z.clone(this.typeKeywords),url:this.url};return z.fixJson(g)}static fromJSON(g){if(!g)return null;if(g.declaredClass)throw Error("JSON object is already hydrated");return new p({sourceJSON:g})}_getPostQuery(){const g=this.toJSON();for(const J in g)"tags"===J&&null!==g[J]&&(g[J]=g[J].join(", ")),"typeKeywords"===J&&null!==g[J]&&(g[J]=g[J].join(", ")),"extent"===J&&g[J]&&(g[J]=JSON.stringify(g[J]));return g}};
c.__decorate([d.property({type:["private","shared","org","public"]})],C.prototype,"access",void 0);c.__decorate([d.property()],C.prototype,"accessInformation",void 0);c.__decorate([d.property({type:String})],C.prototype,"apiKey",void 0);c.__decorate([d.property({json:{read:{source:"appProxies"}}})],C.prototype,"applicationProxies",void 0);c.__decorate([d.property()],C.prototype,"avgRating",void 0);c.__decorate([d.property()],C.prototype,"categories",void 0);c.__decorate([d.property({type:Date})],
C.prototype,"created",void 0);c.__decorate([d.property()],C.prototype,"culture",void 0);c.__decorate([d.property()],C.prototype,"description",void 0);c.__decorate([d.property({readOnly:!0})],C.prototype,"displayName",null);c.__decorate([d.property({type:E})],C.prototype,"extent",void 0);c.__decorate([A.reader("extent")],C.prototype,"readExtent",null);c.__decorate([d.property()],C.prototype,"groupCategories",void 0);c.__decorate([d.property({readOnly:!0})],C.prototype,"iconUrl",null);c.__decorate([d.property()],
C.prototype,"id",void 0);c.__decorate([d.property({readOnly:!0})],C.prototype,"isLayer",null);c.__decorate([d.property({type:Boolean,readOnly:!0})],C.prototype,"isOrgItem",void 0);c.__decorate([d.property()],C.prototype,"itemControl",void 0);c.__decorate([d.property({readOnly:!0})],C.prototype,"itemPageUrl",null);c.__decorate([d.property({readOnly:!0})],C.prototype,"itemUrl",null);c.__decorate([d.property()],C.prototype,"licenseInfo",void 0);c.__decorate([d.property({type:Date})],C.prototype,"modified",
void 0);c.__decorate([d.property()],C.prototype,"name",void 0);c.__decorate([d.property()],C.prototype,"numComments",void 0);c.__decorate([d.property()],C.prototype,"numRatings",void 0);c.__decorate([d.property()],C.prototype,"numViews",void 0);c.__decorate([d.property()],C.prototype,"owner",void 0);c.__decorate([d.property()],C.prototype,"ownerFolder",void 0);c.__decorate([d.property({type:m})],C.prototype,"portal",void 0);c.__decorate([d.property()],C.prototype,"screenshots",void 0);c.__decorate([d.property()],
C.prototype,"size",void 0);c.__decorate([d.property()],C.prototype,"snippet",void 0);c.__decorate([d.property()],C.prototype,"sourceJSON",void 0);c.__decorate([d.property({type:String})],C.prototype,"sourceUrl",void 0);c.__decorate([d.property({type:String})],C.prototype,"spatialReference",void 0);c.__decorate([d.property()],C.prototype,"tags",void 0);c.__decorate([d.property()],C.prototype,"thumbnail",void 0);c.__decorate([d.property({readOnly:!0})],C.prototype,"thumbnailUrl",null);c.__decorate([d.property()],
C.prototype,"title",void 0);c.__decorate([d.property()],C.prototype,"type",void 0);c.__decorate([d.property()],C.prototype,"typeKeywords",void 0);c.__decorate([d.property({type:String,json:{read(g,J){M.has(J.type)&&(J=this.portal?.restUrl,g||=J&&this.id?`${J}/content/items/${this.id}/data`:null);return g}}})],C.prototype,"url",void 0);c.__decorate([d.property({readOnly:!0})],C.prototype,"userItemUrl",null);return C=p=c.__decorate([x.subclass("esri.portal.PortalItem")],C)})},"esri/portal/PortalItemResource":function(){define("require ../chunks/tslib.es6 ../core/Accessor ../core/Error ../core/Logger ../core/urlUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/RandomLCG ../core/has ../core/accessorSupport/decorators/subclass".split(" "),
function(a,c,w,v,C,z,e,r,d,u,A){function x(E,m){if(null==E)return E;E=E.replace(/^\/+/,"");null!=m&&z.isAbsolute(E)&&(E=z.makeRelative(E,m.itemUrl));return E?.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,"")}w=class extends w{constructor(E){super(E);this.portalItem=null}normalizeCtorArgs(E){return E?.portalItem&&E.path?{...E,path:x(E.path,E.portalItem)}:E}set path(E){null!=E&&z.isAbsolute(E)?C.getLogger(this).error("portalitemresource:invalid-path","A portal item resource path must be relative"):
this._set("path",E)}_castPath(E){return x(E,this.portalItem)}get url(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}get cdnUrl(){return this.portalItem&&this.path?`${this.portalItem.itemCdnUrl}/resources/${this.path}`:null}get itemRelativeUrl(){return this.portalItem&&this.path?`./resources/${this.path}`:null}fetch(E="json",m){const h=this.cdnUrl;if(null==h)throw new v("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");
return this.portalItem.portal.request(h,{responseType:E,query:{token:this.portalItem.apiKey},signal:m?.signal})}async update(E,m){const {addOrUpdateResources:h}=await new Promise((b,n)=>a(["./support/resourceUtils"],b,n));await h(this.portalItem,[{resource:this,content:E,compress:m?.compress,access:m?.access}],"update",m);return this}hasPath(){return null!=this.path}};c.__decorate([e.property()],w.prototype,"portalItem",void 0);c.__decorate([e.property({type:String,value:null})],w.prototype,"path",
null);c.__decorate([r.cast("path")],w.prototype,"_castPath",null);c.__decorate([e.property({type:String,readOnly:!0})],w.prototype,"url",null);c.__decorate([e.property({type:String,readOnly:!0})],w.prototype,"cdnUrl",null);c.__decorate([e.property({type:String,readOnly:!0})],w.prototype,"itemRelativeUrl",null);return w=c.__decorate([A.subclass("esri.portal.PortalItemResource")],w)})},"esri/portal/PortalRating":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass".split(" "),
function(a,c,w,v,C,z,e){c=class extends c{constructor(r){super(r);this.rating=this.created=null}};a.__decorate([w.property()],c.prototype,"created",void 0);a.__decorate([w.property()],c.prototype,"rating",void 0);return c=a.__decorate([e.subclass("esri.portal.PortalRating")],c)})},"esri/chunks/persistableUrlUtils":function(){define(["exports","../kernel","../core/urlUtils","../portal/support/urlUtils"],function(a,c,w,v){function C(p,D){var M=D?.url?.path;p&&M&&(p=w.makeAbsolute(p,M,{preserveProtocolRelative:!0}),
D.portalItem&&D.readResourcePaths&&(M=w.makeRelative(p,D.portalItem.itemUrl),null!=M&&b.test(M)&&D.readResourcePaths.push(D.portalItem.resourceFromPath(M).path)));return(p=x(p,D?.portal))&&h.test(p)?E(p):p}function z(p,D,M=a.MarkKeep.YES){p=p&&h.test(p)?m(p):p;if(null==p)return p;!w.isAbsolute(p)&&D?.blockedRelativeUrls&&D.blockedRelativeUrls.push(p);let g=w.makeAbsolute(p);if(D){var J=D.verifyItemRelativeUrls?.rootPath||D.url?.path;if(J){J=x(J,D.portal);const R=x(g,D.portal);g=w.makeRelative(R,J,
J);null!=g&&g!==R&&g!==p&&D.verifyItemRelativeUrls&&D.verifyItemRelativeUrls.writtenUrls.push(g)}}g=A(g,D?.portal);w.isAbsolute(g)&&(g=w.normalize(g));D?.resources&&D?.portalItem&&!w.isAbsolute(g)&&!w.isDataProtocol(g)&&M===a.MarkKeep.YES&&D.resources.toKeep.push({resource:D.portalItem.resourceFromPath(g),compress:!1});return g}function e(p,D,M){return C(p,M)}function r(p,D,M,g){p=z(p,g);void 0!==p&&(D[M]=p)}function d(p){return(p?.match(h)??null)?.[1]??null}function u(p){p=p?.match(h)??null;if(null==
p)return null;p=p[2];const D=p.lastIndexOf("/");if(-1===D){const {path:J,extension:R}=w.splitPathExtension(p);return{prefix:null,filename:J,extension:R}}const {path:M,extension:g}=w.splitPathExtension(p.slice(D+1));return{prefix:p.slice(0,D),filename:M,extension:g}}function A(p,D){return D&&!D.isPortal&&D.urlKey&&D.customBaseUrl?w.changeDomain(p,`${D.urlKey}.${D.customBaseUrl}`,D.portalHostname):p}function x(p,D){if(!D||D.isPortal||!D.urlKey||!D.customBaseUrl)return p;const M=`${D.urlKey}.${D.customBaseUrl}`,
g=w.getAppUrl();return w.hasSameOrigin(g,`${g.scheme}://${M}`)?w.changeDomain(p,D.portalHostname,M):w.changeDomain(p,M,D.portalHostname)}function E(p){if(!p)return p||null;p&&c.id&&!c.id.findCredential(p)&&(p=v.normalizeArcGISOnlineOrgDomain(p),p=p.replace(/^https?:\/\/www\.arcgis\.com/,"https://cdn.arcgis.com"),p=p.replace(/^https?:\/\/devext\.arcgis\.com/,"https://cdndev.arcgis.com"),p=p.replace(/^https?:\/\/qaext\.arcgis\.com/,"https://cdnqa.arcgis.com"));return p}function m(p){if(!p)return p||
null;p=p.replace(/^https?:\/\/cdn\.arcgis\.com/,"https://www.arcgis.com");p=p.replace(/^https?:\/\/cdndev\.arcgis\.com/,"https://devext.arcgis.com");(p=p.replace(/^https?:\/\/cdnqa\.arcgis\.com/,"https://qaext.arcgis.com"))&&c.id&&!c.id.findCredential(p)&&(p=v.normalizeArcGISOnlineOrgDomain(p));return p}const h=/\/items\/([^/]+)\/resources\/(.*)/,b=/^\.\/resources\//;a.MarkKeep=void 0;(function(p){p[p.YES=0]="YES";p[p.NO=1]="NO"})(a.MarkKeep||(a.MarkKeep={}));const n=Object.freeze(Object.defineProperty({__proto__:null,
get MarkKeep(){return a.MarkKeep},ensureMainOnlineDomain:A,fromCDNUrl:m,fromJSON:C,itemIdFromResourceUrl:d,prefixAndFilenameFromResourceUrl:u,read:e,toCDNUrl:E,toJSON:z,write:r},Symbol.toStringTag,{value:"Module"}));a.ensureMainOnlineDomain=A;a.fromCDNUrl=m;a.fromJSON=C;a.itemIdFromResourceUrl=d;a.persistableUrlUtils=n;a.prefixAndFilenameFromResourceUrl=u;a.read=e;a.toCDNUrl=E;a.toJSON=z;a.write=r})},"esri/support/basemapDefinitions":function(){define(["exports","../assets","../intl/messages"],function(a,
c,w){a.esriBasemapDefinitions={satellite:{id:"satellite",classic:!0,get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/satellite.jpg")},baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",classic:!0,get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/hybrid.jpg")},baseMapLayers:[{id:"hybrid-base-layer",
url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/30d6b8271e1849cd9c3042060001f425/resources/styles/root.json",layerType:"VectorTileLayer",title:"Hybrid Reference Layer",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",classic:!0,get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/terrain.jpg")},
baseMapLayers:[{id:"terrain-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Terrain Base",showLegend:!1,visibility:!0,opacity:1},{id:"terrain-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Reference Overlay",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},oceans:{id:"oceans",
classic:!0,get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/oceans.jpg")},baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Reference",
isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},osm:{id:"osm",classic:!0,get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/osm.jpg")},baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",classic:!0,get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/dark-gray-vector.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json",
layerType:"VectorTileLayer",title:"Dark Gray Base",visibility:!0,opacity:1},{id:"dark-gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get "dark-gray"(){return{...this["dark-gray-vector"],id:"dark-gray"}},"gray-vector":{id:"gray-vector",classic:!0,get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/gray-vector.jpg")},
baseMapLayers:[{id:"gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Base",visibility:!0,opacity:1},{id:"gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get gray(){return{...this["gray-vector"],
id:"gray"}},"streets-vector":{id:"streets-vector",classic:!0,get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/streets-vector.jpg")},baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,opacity:1}]},get streets(){return{...this["streets-vector"],id:"streets"}},"topo-vector":{id:"topo-vector",classic:!0,get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/topo-vector.jpg")},
baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"topo-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},get topo(){return{...this["topo-vector"],id:"topo"}},
"streets-night-vector":{id:"streets-night-vector",classic:!0,get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/streets-night.jpg")},baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",classic:!0,get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/streets-relief.jpg")},
baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",title:"World Streets Relief",layerType:"VectorTileLayer",visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",
classic:!0,get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/streets-navigation.jpg")},baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]},"topo-3d":{id:"topo-3d",is3d:!0,get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/topo-3d.png")},baseMapLayers:[{id:"topo-3d-base-layer",
styleUrl:"https://www.arcgis.com/sharing/rest/content/items/1e7d1784d1ef4b79ba6764d0bd6c3150/resources/styles/root.json",layerType:"VectorTileLayer",title:"Topographic",visibility:!0,opacity:1},{id:"topo-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",
itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-3d":{id:"navigation-3d",is3d:!0,get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/navigation-3d.jpg")},baseMapLayers:[{id:"navigation-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/ccc904ff872b4144b94934e55e32784b/resources/styles/root.json",
layerType:"VectorTileLayer",title:"Navigation",visibility:!0,opacity:1},{id:"navigation-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",
layerType:"ArcGISSceneServiceLayer"}]},"streets-3d":{id:"streets-3d",is3d:!0,get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/streets-3d.png")},baseMapLayers:[{id:"streets-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/198298c4c64c4cb19de5b46aa00c198d/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"streets-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",
itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"streets-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"osm-3d":{id:"osm-3d",is3d:!0,get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/osm-3d.png")},baseMapLayers:[{id:"osm-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/8628d259c9d14bdc848771c23c513940/resources/styles/root.json",
layerType:"VectorTileLayer",title:"OpenStreetMap",visibility:!0,opacity:1},{id:"osm-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},
{id:"osm-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"gray-3d":{id:"gray-3d",is3d:!0,get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/gray-3d.png")},baseMapLayers:[{id:"gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/01a14b466345455ba4176d2e6390db92/resources/styles/root.json",layerType:"VectorTileLayer",
title:"Streets",visibility:!0,opacity:1},{id:"gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-dark-3d":{id:"navigation-dark-3d",
itemId:"5a1365328b4943f09a54cf5fd1205707",is3d:!0,baseMapLayers:[{id:"navigation-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/451a1777ab3f4bf095fae24a117439d9/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation Dark"},{id:"navigation-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},
{id:"navigation-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"streets-dark-3d":{id:"streets-dark-3d",itemId:"8a4efa2c20484ec9b4557895e65736ff",is3d:!0,baseMapLayers:[{id:"streets-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/bc599b6d741a4ac084b7eea7bf8c5938/resources/styles/root.json",layerType:"VectorTileLayer",
title:"OpenStreetMap Streets Night (for 3D)"},{id:"streets-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"streets-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},
"dark-gray-3d":{id:"dark-gray-3d",itemId:"a8b7322a5fe94002bb0f5e0eeb0c5c18",is3d:!0,baseMapLayers:[{id:"dark-gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/4178f71acb934fb89f169e7d667c20c6/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Dark Gray Canvas (for 3D)"},{id:"dark-gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",
layerType:"ArcGISSceneServiceLayer"},{id:"dark-gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"arcgis-imagery":{get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/hybrid.jpg")},title:"Imagery Hybrid",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"},
{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-imagery-standard":{get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/satellite.jpg")},title:"Imagery",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"}]},"arcgis-imagery-labels":{title:"Hybrid [Reference]",
baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-light-gray":{get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/gray-vector.jpg")},title:"Light Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Base",title:"Light Gray Canvas Base"},{layerType:"VectorTileLayer",
styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Labels",title:"Light Gray Canvas Labels",isReference:!0}]},"arcgis-dark-gray":{get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/dark-gray.jpg")},title:"Dark Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Base",title:"Dark Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Labels",
title:"Dark Gray Canvas Labels",isReference:!0}]},"arcgis-navigation":{get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/streets-navigation.jpg")},title:"Navigation",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Navigation",title:"World Navigation Map"}]},"arcgis-navigation-night":{title:"Navigation (Dark Mode)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:NavigationNight",
title:"World Navigation Map (Dark Mode)"}]},"arcgis-streets":{get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/streets-vector.jpg")},title:"Streets",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Streets",title:"World Street Map"}]},"arcgis-streets-night":{get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/streets-night.jpg")},title:"Streets (Night)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsNight",
title:"World Street Map (Night)"}]},"arcgis-streets-relief":{get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/streets-relief.jpg")},title:"Streets (with Relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsRelief:Base",title:"World Street Map (with Relief)"}]},
"arcgis-topographic":{get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/topo.jpg")},title:"Topographic",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Topographic:Base",title:"World Topographic Map"}]},"arcgis-oceans":{get thumbnailUrl(){return c.getAssetUrl("esri/images/basemap/oceans.jpg")},
title:"Oceans",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Ocean Base",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Oceans:Labels",title:"World Ocean Reference",isReference:!0}]},"osm-standard":{title:"OpenStreetMap",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Standard",
title:"OpenStreetMap"}]},"osm-standard-relief":{title:"OpenStreetMap (with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StandardRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-streets":{title:"OpenStreetMap (Streets)",baseMapLayers:[{layerType:"VectorTileLayer",
styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Streets",title:"OpenStreetMap (Streets)"}]},"osm-streets-relief":{title:"OpenStreetMap (Streets with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StreetsRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},
"osm-light-gray":{title:"OpenStreetMap (Light Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Base",title:"OSM (Light Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Labels",title:"OSM (Light Gray Reference)",isReference:!0}]},"osm-dark-gray":{title:"OpenStreetMap (Dark Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",
styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Base",title:"OSM (Dark Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Labels",title:"OSM (Dark Gray Reference)",isReference:!0}]},"arcgis-terrain":{title:"Terrain with Labels",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},
{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Base",title:"World Terrain Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Detail",title:"World Terrain Reference",isReference:!0}]},"arcgis-community":{title:"Community",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Community",title:"Community"}]},
"arcgis-charted-territory":{title:"Charted Territory",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ChartedTerritory:Base",title:"Charted Territory"}]},"arcgis-colored-pencil":{title:"Colored Pencil",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ColoredPencil",
title:"Colored Pencil"}]},"arcgis-nova":{title:"Nova",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Nova",title:"Nova"}]},"arcgis-modern-antique":{title:"Modern Antique",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ModernAntique:Base",
title:"Modern Antique"}]},"arcgis-midcentury":{title:"Mid-Century",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Midcentury",title:"Mid-Century"}]},"arcgis-newspaper":{title:"Newspaper",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Newspaper",title:"Newspaper"}]},"arcgis-hillshade-light":{title:"Hillshade",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",
showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"}]},"arcgis-hillshade-dark":{title:"Hillshade (Dark)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade (Dark)",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade_Dark/MapServer"}]},"arcgis-human-geography":{title:"Human Geography",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Base",
title:"Human Geography Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Detail",title:"Human Geography Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Label",title:"Human Geography Label",isReference:!0}]},"arcgis-human-geography-dark":{title:"Human Geography (Dark)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Base",
title:"Human Geography Dark Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Detail",title:"Human Geography Dark Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Label",title:"Human Geography Dark Label",isReference:!0}]}};a.getBasemapTitle=async function(v){if(v){var C=v.includes("-vector")?v.slice(0,v.indexOf("-vector")):
v.includes("-3d")?v.slice(0,v.indexOf("-3d")):v,z=await w.fetchMessageBundle("esri/t9n/basemaps");return z[v]||z[C]}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/support/BasemapStyle":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass ../intl/locale".split(" "),function(a,c,w,v,C,z,e,r){const d=new Set("ar bs ca hr cs da nl en et fi fr de el he hu id it ja ko lv lt nb pl ro ru sr es sv th tr uk vi".split(" "));
c=class extends c{constructor(u){super(u);this.places=this.language=this.id=null;this.serviceUrl="https://basemapstyles-api.arcgis.com/arcgis/rest/services/styles/v2/webmaps";this.worldview=null}getLanguageParamValue(){if(this.language)return this.language;var u=r.getLocale().toLowerCase();switch(u){case "pt-br":return"pt-BR";case "pt-pt":return"pt-PT";case "zh-cn":return"zh-CN";case "zh-hk":return"zh-HK";case "zh-tw":return"zh-TW"}u=r.getLanguage(u);return"pt"===u?"pt-BR":u&&d.has(u)?u:"global"}};
a.__decorate([w.property()],c.prototype,"id",void 0);a.__decorate([w.property()],c.prototype,"language",void 0);a.__decorate([w.property()],c.prototype,"places",void 0);a.__decorate([w.property()],c.prototype,"serviceUrl",void 0);a.__decorate([w.property()],c.prototype,"worldview",void 0);return c=a.__decorate([e.subclass("esri.support.BasemapStyle")],c)})},"esri/webdoc/support/writeUtils":function(){define("exports ../../core/Error ../../core/lang ../../core/object ../../core/accessorSupport/extensions/serializableProperty/writer ../../layers/support/layerUtils".split(" "),
function(a,c,w,v,C,z){function e(u,A){"maxScale"in u&&(A.maxScale=C.numberToJSON(u.maxScale)??void 0);"minScale"in u&&(A.minScale=C.numberToJSON(u.minScale)??void 0)}const r=new Set("bing-maps imagery imagery-tile map-image open-street-map tile unknown unsupported vector-tile web-tile wms wmts".split(" ")),d=new Set("catalog csv feature geo-rss geojson group imagery imagery-tile kml knowledge-graph map-image map-notes media ogc-feature oriented-imagery route stream subtype-group tile unknown unsupported vector-tile web-tile wfs wms wmts".split(" "));
a.disableRestrictedWriting=function(u){r.add(u);d.add(u)};a.enableRestrictedWriting=function(u){r.delete(u);d.delete(u)};a.getLayerJSON=function(u,A,x){if(!u.persistenceEnabled)return null;if(!("write"in u&&u.write))return x?.messages&&x.messages.push(new c("layer:unsupported",`Layers (${u.title}, ${u.id}) of type '${u.declaredClass}' cannot be persisted`,{layer:u})),null;if(z.isFeatureCollectionLayer(u)&&!u.isTable)A=u.resourceInfo;else{if(x.restrictedWebMapWriting){var E="basemap"===x.layerContainerType?
r:"operational-layers"===x.layerContainerType?d:null;E=null!=E?E.has(u.type)&&!z.isFeatureCollectionLayer(u):!0}else E=!0;if(E)return A={},u.write(A,x)?A:null}if(null!=A){A=w.clone(A);if(x=A)z.isFeatureCollectionLayer(u)?(E=v.getDeepValue("featureCollection.layers",x)?.[0]?.layerDefinition)&&e(u,E):"group"!==u.type&&e(u,x);if(x&&(x.id=u.id,"blendMode"in u&&(x.blendMode=u.blendMode,"normal"===x.blendMode&&delete x.blendMode),x.opacity=C.numberToJSON(u.opacity)??void 0,x.title=u.title||"Layer",x.visibility=
u.visible,"legendEnabled"in u&&"wmts"!==u.type))if(z.isFeatureCollectionLayer(u)){if(x=x.featureCollection)x.showLegend=u.legendEnabled}else x.showLegend=u.legendEnabled}return A};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/layerUtils":function(){define(["exports","../../kernel","../../request"],function(a,c,w){function v(z){return"scene"===z?.type}function C(z){z=z?.type;return"imagery-tile"===z||"tile"===z||"open-street-map"===z||"vector-tile"===z||"web-tile"===
z||"wmts"===z}a.getEffectiveEditingEnabled=function(z){a:if("editingEnabled"in z)switch(z.type){case "csv":case "feature":case "geojson":case "oriented-imagery":case "scene":case "subtype-group":case "subtype-sublayer":var e=!0;break a;default:e=!1}else e=!1;return e?"effectiveEditingEnabled"in z?z.effectiveEditingEnabled:z.editingEnabled:!1};a.getEffectiveLayerCapabilities=function(z){a:if("capabilities"in z)switch(z.type){case "catalog":case "catalog-footprint":case "csv":case "feature":case "geojson":case "imagery":case "knowledge-graph-sublayer":case "ogc-feature":case "oriented-imagery":case "scene":case "sublayer":case "subtype-group":case "subtype-sublayer":case "wfs":var e=
!0;break a;default:e=!1}else e=!1;return e?"effectiveCapabilities"in z?z.effectiveCapabilities:z.capabilities:null};a.getOwningPortalUrl=async function(z,e){var r=c.id?.findServerInfo(z);if(null!=r?.currentVersion)return r.owningSystemUrl||null;r=z.toLowerCase().indexOf("/rest/services");if(-1===r)return null;z=`${z.substring(0,r)}/rest/info`;({data:e}=await w(z,{query:{f:"json"},responseType:"json",signal:null!=e?e.signal:null}));return e?.owningSystemUrl||null};a.getTileMaxtrixSetFromActiveLayer=
function(z){if(z.activeLayer){const e=z.activeLayer.tileMatrixSet;if(e)return e;if(z=z.activeLayer.tileMatrixSets)return z}return null};a.isBaseLayer=function(z){return null!=z?.parent&&"declaredClass"in z.parent&&"esri.Basemap"===z.parent.declaredClass&&z.parent.baseLayers.includes(z)};a.isBasemap3DSupportedLayer=function(z){return C(z)||v(z)};a.isBasemapSupportedTiledLayer=C;a.isFeatureCollectionLayer=function(z){return"feature"===z?.type&&!z.url&&"memory"===z.source?.type};a.isFeatureLayer=function(z){return null!=
z&&"object"===typeof z&&"type"in z&&"feature"===z.type};a.isFeatureServiceLayer=function(z){return"feature"===z?.type&&"feature-layer"===z.source?.type};a.isGraphicsLayer=function(z){return null!=z&&"object"===typeof z&&"type"in z&&"graphics"===z.type};a.isGroupLayer=function(z){return null!=z&&"type"in z&&"group"===z.type};a.isImageryTileLayer=function(z){return"imagery-tile"===z?.type};a.isIntegratedMeshLayer=function(z){return"integrated-mesh"===z||"integrated-mesh-3dtiles"===z};a.isIntegratedMeshOperationalLayer=
function(z){return"IntegratedMeshLayer"===z||"IntegratedMesh3DTilesLayer"===z};a.isKnowledgeGraphLayer=function(z){return null!=z&&"object"===typeof z&&"type"in z&&"knowledge-graph"===z.type&&"layers"in z};a.isLayerWithFeatureLayerSource=function(z){return("feature"===z?.type||"subtype-group"===z?.type)&&"feature-layer"===z.source?.type};a.isLinkChartLayer=function(z){return null!=z&&"object"===typeof z&&"type"in z&&"link-chart"===z.type&&"layers"in z};a.isMapNotesLayer=function(z){return null!=z&&
"object"===typeof z&&"type"in z&&"map-notes"===z.type&&"sublayers"in z};a.isSceneLayer=v;a.isSceneServiceLayer=function(z){z=z?.type;return"building-scene"===z||"integrated-mesh"===z||"point-cloud"===z||"scene"===z};a.isSubtypeGroupLayer=function(z){return null!=z&&"object"===typeof z&&"type"in z&&"subtype-group"===z.type&&"sublayers"in z};a.isSubtypeSublayer=function(z){return"subtype-sublayer"===z?.type};a.isTable=function(z){return null!=z&&"object"===typeof z&&"isTable"in z&&!!z.isTable};a.isTiledLayer=
function(z){z=z?.type;return"base-tile"===z||"tile"===z||"elevation"===z||"imagery-tile"===z||"base-elevation"===z||"open-street-map"===z||"wcs"===z||"web-tile"===z||"wmts"===z||"vector-tile"===z};a.isVoxelLayer=function(z){return"voxel"===z?.type};a.sceneServiceLayerTypeToClassName={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};a.serializeLayerDefinitions=function(z){const e=/[:;]/,r=[];let d=!1;if(z&&(z.forEach((u,
A)=>{r.push([A,u]);!d&&e.test(u)&&(d=!0)}),0<r.length)){if(d){const u={};r.forEach(A=>{u[A[0]]=A[1]});z=JSON.stringify(u)}else{const u=[];r.forEach(A=>{u.push(A[0]+":"+A[1])});z=u.join(";")}return z}return null};a.serializeTimeOptions=function(z){if(z){var e=[];z.forEach((r,d)=>{e.push('"'+d+'":'+JSON.stringify(r))});if(e.length)return"{"+e.join(",")+"}"}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/effects/utils":function(){define(["exports","./effects"],function(a,
c){a.canInterpolateEffects=function(w,v){const C=w.length>v.length?w:v;return(w.length>v.length?v:w).every((z,e)=>z.type===C[e].type)};a.effectEquals=function(w,v){w=JSON.stringify(w??null);v=JSON.stringify(v??null);return w===v};a.isEffectFunctions=function(w){return(w=w[0])?"type"in w:!1};a.normalizeEffects=function(w,v){const C=w.length>v.length?w:v;w=w.length>v.length?v:w;for(v=w.length;v<C.length;v++)w.push(c.createEffectWithInitialValues(C[v]))};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/effects/effects":function(){define(["exports","../../colorUtils","../../core/screenUtils","../../core/libs/gl-matrix-2/factories/mat4f32","./colorMatrixFunctions"],function(a,c,w,v,C){function z(m,h,b){return m+(h-m)*b}function e(m){return Math.round(1E3*w.px2pt(m))/1E3}class r{constructor(m,h,b){this.strength=m;this.radius=h;this.threshold=b;this.type="bloom"}interpolate(m,h,b){this.strength=z(m.strength,h.strength,b);this.radius=z(m.radius,h.radius,b);this.threshold=z(m.threshold,h.threshold,
b)}clone(){return new r(this.strength,this.radius,this.threshold)}toJSON(){return{type:"bloom",radius:e(this.radius),strength:this.strength,threshold:this.threshold}}}class d{constructor(m){this.radius=m;this.type="blur"}interpolate(m,h,b){this.radius=Math.round(z(m.radius,h.radius,b))}clone(){return new d(this.radius)}toJSON(){return{type:"blur",radius:e(this.radius)}}}class u{constructor(m,h){this.type=m;this.amount=h;if("invert"===this.type||"grayscale"===this.type||"sepia"===this.type)this.amount=
Math.min(this.amount,1)}get colorMatrix(){this._colorMatrix||this._updateMatrix();return this._colorMatrix}interpolate(m,h,b){this.amount=z(m.amount,h.amount,b);this._updateMatrix()}clone(){return new u(this.type,this.amount)}toJSON(){return{type:this.type,amount:this.amount}}_updateMatrix(){const m=this._colorMatrix||v.create();switch(this.type){case "brightness":this._colorMatrix=C.brightness(m,this.amount);break;case "contrast":this._colorMatrix=C.contrast(m,this.amount);break;case "grayscale":this._colorMatrix=
C.grayscale(m,this.amount);break;case "invert":this._colorMatrix=C.invert(m,this.amount);break;case "saturate":this._colorMatrix=C.saturate(m,this.amount);break;case "sepia":this._colorMatrix=C.sepia(m,this.amount)}}}class A{constructor(m,h,b,n){this.offsetX=m;this.offsetY=h;this.blurRadius=b;this.color=n;this.type="drop-shadow"}interpolate(m,h,b){this.offsetX=z(m.offsetX,h.offsetX,b);this.offsetY=z(m.offsetY,h.offsetY,b);this.blurRadius=z(m.blurRadius,h.blurRadius,b);this.color[0]=Math.round(z(m.color[0],
h.color[0],b));this.color[1]=Math.round(z(m.color[1],h.color[1],b));this.color[2]=Math.round(z(m.color[2],h.color[2],b));this.color[3]=z(m.color[3],h.color[3],b)}clone(){return new A(this.offsetX,this.offsetY,this.blurRadius,[...this.color])}toJSON(){const m=[...this.color];m[3]*=255;return{type:"drop-shadow",xoffset:e(this.offsetX),yoffset:e(this.offsetY),blurRadius:e(this.blurRadius),color:m}}}class x{constructor(m){this.angle=m;this.type="hue-rotate"}get colorMatrix(){this._colorMatrix||this._updateMatrix();
return this._colorMatrix}interpolate(m,h,b){this.angle=z(m.angle,h.angle,b);this._updateMatrix()}clone(){return new x(this.angle)}toJSON(){return{type:"hue-rotate",angle:this.angle}}_updateMatrix(){const m=this._colorMatrix||v.create();this._colorMatrix=C.rotateHue(m,this.angle)}}class E{constructor(m){this.amount=m;this.type="opacity";this.amount=Math.min(this.amount,1)}interpolate(m,h,b){this.amount=z(m.amount,h.amount,b)}clone(){return new E(this.amount)}toJSON(){return{type:"opacity",amount:this.amount}}}
a.BloomEffect=r;a.BlurEffect=d;a.ColorMatrixEffect=u;a.DropShadowEffect=A;a.HueRotateEffect=x;a.OpacityEffect=E;a.createEffectWithInitialValues=function(m){switch(m.type){case "grayscale":case "sepia":case "invert":return new u(m.type,0);case "saturate":case "brightness":case "contrast":return new u(m.type,1);case "opacity":return new E(1);case "hue-rotate":return new x(0);case "blur":return new d(0);case "drop-shadow":return new A(0,0,0,[...c.getNamedColor("transparent")]);case "bloom":return new r(0,
0,1)}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/factories/mat4f32":function(){define(["exports"],function(a){function c(){const r=new Float32Array(16);r[0]=1;r[5]=1;r[10]=1;r[15]=1;return r}function w(r){const d=new Float32Array(16);d[0]=r[0];d[1]=r[1];d[2]=r[2];d[3]=r[3];d[4]=r[4];d[5]=r[5];d[6]=r[6];d[7]=r[7];d[8]=r[8];d[9]=r[9];d[10]=r[10];d[11]=r[11];d[12]=r[12];d[13]=r[13];d[14]=r[14];d[15]=r[15];return d}function v(r,d,u,A,x,E,m,h,b,n,p,D,M,
g,J,R){const B=new Float32Array(16);B[0]=r;B[1]=d;B[2]=u;B[3]=A;B[4]=x;B[5]=E;B[6]=m;B[7]=h;B[8]=b;B[9]=n;B[10]=p;B[11]=D;B[12]=M;B[13]=g;B[14]=J;B[15]=R;return B}function C(r,d){return new Float32Array(r,d,16)}const z=c(),e=Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:z,clone:w,create:c,createView:C,fromValues:v},Symbol.toStringTag,{value:"Module"}));a.IDENTITY=z;a.clone=w;a.create=c;a.createView=C;a.fromValues=v;a.mat4f32=e;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/effects/colorMatrixFunctions":function(){define(["exports","../../core/libs/gl-matrix-2/math/mat4"],function(a,c){a.brightness=(w,v)=>{w=c.set(w,v,0,0,0,0,v,0,0,0,0,v,0,0,0,0,1);return c.transpose(w,w)};a.contrast=(w,v)=>{w=c.set(w,v,0,0,.5-.5*v,0,v,0,.5-.5*v,0,0,v,.5-.5*v,0,0,0,1);return c.transpose(w,w)};a.grayscale=(w,v)=>{v=1-v;w=c.set(w,.2126+.7874*v,.7152-.7152*v,.0722-.0722*v,0,.2126-.2126*v,.7152+.2848*v,.0722-.0722*v,0,.2126-.2126*v,.7152-.7152*v,.0722+.9278*v,0,0,0,0,1);return c.transpose(w,
w)};a.invert=(w,v)=>{const C=1-2*v;w=c.set(w,C,0,0,v,0,C,0,v,0,0,C,v,0,0,0,1);return c.transpose(w,w)};a.rotateHue=(w,v)=>{const C=Math.sin(v*Math.PI/180);v=Math.cos(v*Math.PI/180);w=c.set(w,.213+.787*v-.213*C,.715-.715*v-.715*C,.072-.072*v+.928*C,0,.213-.213*v+.143*C,.715+.285*v+.14*C,.072-.072*v-.283*C,0,.213-.213*v-.787*C,.715-.715*v+.715*C,.072+.928*v+.072*C,0,0,0,0,1);return c.transpose(w,w)};a.saturate=(w,v)=>{w=c.set(w,.213+.787*v,.715-.715*v,.072-.072*v,0,.213-.213*v,.715+.285*v,.072-.072*
v,0,.213-.213*v,.715-.715*v,.072+.928*v,0,0,0,0,1);return c.transpose(w,w)};a.sepia=(w,v)=>{v=1-v;w=c.set(w,.393+.607*v,.769-.769*v,.189-.189*v,0,.349-.349*v,.686+.314*v,.168-.168*v,0,.272-.272*v,.534-.534*v,.131+.869*v,0,0,0,0,1);return c.transpose(w,w)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/math/mat4":function(){define(["exports","../factories/vec3f64","./common"],function(a,c,w){function v(q,K){q[0]=K[0];q[1]=K[1];q[2]=K[2];q[3]=K[3];q[4]=K[4];
q[5]=K[5];q[6]=K[6];q[7]=K[7];q[8]=K[8];q[9]=K[9];q[10]=K[10];q[11]=K[11];q[12]=K[12];q[13]=K[13];q[14]=K[14];q[15]=K[15];return q}function C(q,K,Y,ba,ja,I,O,P,X,aa,ca,fa,la,ma,ua,pa,sa){q[0]=K;q[1]=Y;q[2]=ba;q[3]=ja;q[4]=I;q[5]=O;q[6]=P;q[7]=X;q[8]=aa;q[9]=ca;q[10]=fa;q[11]=la;q[12]=ma;q[13]=ua;q[14]=pa;q[15]=sa;return q}function z(q){q[0]=1;q[1]=0;q[2]=0;q[3]=0;q[4]=0;q[5]=1;q[6]=0;q[7]=0;q[8]=0;q[9]=0;q[10]=1;q[11]=0;q[12]=0;q[13]=0;q[14]=0;q[15]=1;return q}function e(q,K){if(q===K){const Y=K[1],
ba=K[2],ja=K[3],I=K[6],O=K[7],P=K[11];q[1]=K[4];q[2]=K[8];q[3]=K[12];q[4]=Y;q[6]=K[9];q[7]=K[13];q[8]=ba;q[9]=I;q[11]=K[14];q[12]=ja;q[13]=O;q[14]=P}else q[0]=K[0],q[1]=K[4],q[2]=K[8],q[3]=K[12],q[4]=K[1],q[5]=K[5],q[6]=K[9],q[7]=K[13],q[8]=K[2],q[9]=K[6],q[10]=K[10],q[11]=K[14],q[12]=K[3],q[13]=K[7],q[14]=K[11],q[15]=K[15];return q}function r(q,K){d(q,K)||z(q);return q}function d(q,K){const Y=K[0],ba=K[1],ja=K[2],I=K[3],O=K[4],P=K[5],X=K[6],aa=K[7],ca=K[8],fa=K[9],la=K[10],ma=K[11],ua=K[12],pa=K[13],
sa=K[14];K=K[15];const Ca=Y*P-ba*O,xa=Y*X-ja*O,Ba=Y*aa-I*O,Aa=ba*X-ja*P,ya=ba*aa-I*P,Ia=ja*aa-I*X,Qa=ca*pa-fa*ua,Ya=ca*sa-la*ua,Wa=ca*K-ma*ua,Ja=fa*sa-la*pa,Ka=fa*K-ma*pa,ka=la*K-ma*sa;let Ra=Ca*ka-xa*Ka+Ba*Ja+Aa*Wa-ya*Ya+Ia*Qa;if(!Ra)return null;Ra=1/Ra;q[0]=(P*ka-X*Ka+aa*Ja)*Ra;q[1]=(ja*Ka-ba*ka-I*Ja)*Ra;q[2]=(pa*Ia-sa*ya+K*Aa)*Ra;q[3]=(la*ya-fa*Ia-ma*Aa)*Ra;q[4]=(X*Wa-O*ka-aa*Ya)*Ra;q[5]=(Y*ka-ja*Wa+I*Ya)*Ra;q[6]=(sa*Ba-ua*Ia-K*xa)*Ra;q[7]=(ca*Ia-la*Ba+ma*xa)*Ra;q[8]=(O*Ka-P*Wa+aa*Qa)*Ra;q[9]=
(ba*Wa-Y*Ka-I*Qa)*Ra;q[10]=(ua*ya-pa*Ba+K*Ca)*Ra;q[11]=(fa*Ba-ca*ya-ma*Ca)*Ra;q[12]=(P*Ya-O*Ja-X*Qa)*Ra;q[13]=(Y*Ja-ba*Ya+ja*Qa)*Ra;q[14]=(pa*xa-ua*Aa-sa*Ca)*Ra;q[15]=(ca*Aa-fa*xa+la*Ca)*Ra;return q}function u(q,K){const Y=K[0],ba=K[1],ja=K[2],I=K[3],O=K[4],P=K[5],X=K[6],aa=K[7],ca=K[8],fa=K[9],la=K[10],ma=K[11],ua=K[12],pa=K[13],sa=K[14];K=K[15];q[0]=P*(la*K-ma*sa)-fa*(X*K-aa*sa)+pa*(X*ma-aa*la);q[1]=-(ba*(la*K-ma*sa)-fa*(ja*K-I*sa)+pa*(ja*ma-I*la));q[2]=ba*(X*K-aa*sa)-P*(ja*K-I*sa)+pa*(ja*aa-I*
X);q[3]=-(ba*(X*ma-aa*la)-P*(ja*ma-I*la)+fa*(ja*aa-I*X));q[4]=-(O*(la*K-ma*sa)-ca*(X*K-aa*sa)+ua*(X*ma-aa*la));q[5]=Y*(la*K-ma*sa)-ca*(ja*K-I*sa)+ua*(ja*ma-I*la);q[6]=-(Y*(X*K-aa*sa)-O*(ja*K-I*sa)+ua*(ja*aa-I*X));q[7]=Y*(X*ma-aa*la)-O*(ja*ma-I*la)+ca*(ja*aa-I*X);q[8]=O*(fa*K-ma*pa)-ca*(P*K-aa*pa)+ua*(P*ma-aa*fa);q[9]=-(Y*(fa*K-ma*pa)-ca*(ba*K-I*pa)+ua*(ba*ma-I*fa));q[10]=Y*(P*K-aa*pa)-O*(ba*K-I*pa)+ua*(ba*aa-I*P);q[11]=-(Y*(P*ma-aa*fa)-O*(ba*ma-I*fa)+ca*(ba*aa-I*P));q[12]=-(O*(fa*sa-la*pa)-ca*(P*
sa-X*pa)+ua*(P*la-X*fa));q[13]=Y*(fa*sa-la*pa)-ca*(ba*sa-ja*pa)+ua*(ba*la-ja*fa);q[14]=-(Y*(P*sa-X*pa)-O*(ba*sa-ja*pa)+ua*(ba*X-ja*P));q[15]=Y*(P*la-X*fa)-O*(ba*la-ja*fa)+ca*(ba*X-ja*P);return q}function A(q){const K=q[0],Y=q[1],ba=q[2],ja=q[3],I=q[4],O=q[5],P=q[6],X=q[7],aa=q[8],ca=q[9],fa=q[10],la=q[11],ma=q[12],ua=q[13],pa=q[14];q=q[15];return(K*O-Y*I)*(fa*q-la*pa)-(K*P-ba*I)*(ca*q-la*ua)+(K*X-ja*I)*(ca*pa-fa*ua)+(Y*P-ba*O)*(aa*q-la*ma)-(Y*X-ja*O)*(aa*pa-fa*ma)+(ba*X-ja*P)*(aa*ua-ca*ma)}function x(q,
K,Y){const ba=K[0],ja=K[1],I=K[2],O=K[3],P=K[4],X=K[5],aa=K[6],ca=K[7],fa=K[8],la=K[9],ma=K[10],ua=K[11],pa=K[12],sa=K[13],Ca=K[14];K=K[15];let xa=Y[0],Ba=Y[1],Aa=Y[2],ya=Y[3];q[0]=xa*ba+Ba*P+Aa*fa+ya*pa;q[1]=xa*ja+Ba*X+Aa*la+ya*sa;q[2]=xa*I+Ba*aa+Aa*ma+ya*Ca;q[3]=xa*O+Ba*ca+Aa*ua+ya*K;xa=Y[4];Ba=Y[5];Aa=Y[6];ya=Y[7];q[4]=xa*ba+Ba*P+Aa*fa+ya*pa;q[5]=xa*ja+Ba*X+Aa*la+ya*sa;q[6]=xa*I+Ba*aa+Aa*ma+ya*Ca;q[7]=xa*O+Ba*ca+Aa*ua+ya*K;xa=Y[8];Ba=Y[9];Aa=Y[10];ya=Y[11];q[8]=xa*ba+Ba*P+Aa*fa+ya*pa;q[9]=xa*ja+
Ba*X+Aa*la+ya*sa;q[10]=xa*I+Ba*aa+Aa*ma+ya*Ca;q[11]=xa*O+Ba*ca+Aa*ua+ya*K;xa=Y[12];Ba=Y[13];Aa=Y[14];ya=Y[15];q[12]=xa*ba+Ba*P+Aa*fa+ya*pa;q[13]=xa*ja+Ba*X+Aa*la+ya*sa;q[14]=xa*I+Ba*aa+Aa*ma+ya*Ca;q[15]=xa*O+Ba*ca+Aa*ua+ya*K;return q}function E(q,K,Y){const ba=Y[0],ja=Y[1];Y=Y[2];if(K===q)q[12]=K[0]*ba+K[4]*ja+K[8]*Y+K[12],q[13]=K[1]*ba+K[5]*ja+K[9]*Y+K[13],q[14]=K[2]*ba+K[6]*ja+K[10]*Y+K[14],q[15]=K[3]*ba+K[7]*ja+K[11]*Y+K[15];else{const I=K[0],O=K[1],P=K[2],X=K[3],aa=K[4],ca=K[5],fa=K[6],la=K[7],
ma=K[8],ua=K[9],pa=K[10],sa=K[11];q[0]=I;q[1]=O;q[2]=P;q[3]=X;q[4]=aa;q[5]=ca;q[6]=fa;q[7]=la;q[8]=ma;q[9]=ua;q[10]=pa;q[11]=sa;q[12]=I*ba+aa*ja+ma*Y+K[12];q[13]=O*ba+ca*ja+ua*Y+K[13];q[14]=P*ba+fa*ja+pa*Y+K[14];q[15]=X*ba+la*ja+sa*Y+K[15]}return q}function m(q,K,Y){const ba=Y[0],ja=Y[1];Y=Y[2];q[0]=K[0]*ba;q[1]=K[1]*ba;q[2]=K[2]*ba;q[3]=K[3]*ba;q[4]=K[4]*ja;q[5]=K[5]*ja;q[6]=K[6]*ja;q[7]=K[7]*ja;q[8]=K[8]*Y;q[9]=K[9]*Y;q[10]=K[10]*Y;q[11]=K[11]*Y;q[12]=K[12];q[13]=K[13];q[14]=K[14];q[15]=K[15];return q}
function h(q,K,Y,ba){let ja=ba[0],I=ba[1];ba=ba[2];let O=Math.sqrt(ja*ja+I*I+ba*ba);var P=void 0,X=void 0;let aa=void 0,ca=void 0,fa=void 0,la=void 0,ma=void 0,ua=void 0,pa=void 0,sa=void 0,Ca=void 0,xa=void 0,Ba=void 0,Aa=void 0,ya=void 0,Ia=void 0,Qa=void 0,Ya=void 0,Wa=void 0,Ja=void 0,Ka=void 0,ka=void 0;X=P=void 0;if(O<w.getEpsilon())return null;O=1/O;ja*=O;I*=O;ba*=O;P=Math.sin(Y);X=Math.cos(Y);aa=1-X;ca=K[0];fa=K[1];la=K[2];ma=K[3];ua=K[4];pa=K[5];sa=K[6];Ca=K[7];xa=K[8];Ba=K[9];Aa=K[10];ya=
K[11];Ia=ja*ja*aa+X;Qa=I*ja*aa+ba*P;Ya=ba*ja*aa-I*P;Wa=ja*I*aa-ba*P;Ja=I*I*aa+X;Ka=ba*I*aa+ja*P;ka=ja*ba*aa+I*P;P=I*ba*aa-ja*P;X=ba*ba*aa+X;q[0]=ca*Ia+ua*Qa+xa*Ya;q[1]=fa*Ia+pa*Qa+Ba*Ya;q[2]=la*Ia+sa*Qa+Aa*Ya;q[3]=ma*Ia+Ca*Qa+ya*Ya;q[4]=ca*Wa+ua*Ja+xa*Ka;q[5]=fa*Wa+pa*Ja+Ba*Ka;q[6]=la*Wa+sa*Ja+Aa*Ka;q[7]=ma*Wa+Ca*Ja+ya*Ka;q[8]=ca*ka+ua*P+xa*X;q[9]=fa*ka+pa*P+Ba*X;q[10]=la*ka+sa*P+Aa*X;q[11]=ma*ka+Ca*P+ya*X;K!==q&&(q[12]=K[12],q[13]=K[13],q[14]=K[14],q[15]=K[15]);return q}function b(q,K,Y){const ba=
Math.sin(Y);Y=Math.cos(Y);const ja=K[4],I=K[5],O=K[6],P=K[7],X=K[8],aa=K[9],ca=K[10],fa=K[11];K!==q&&(q[0]=K[0],q[1]=K[1],q[2]=K[2],q[3]=K[3],q[12]=K[12],q[13]=K[13],q[14]=K[14],q[15]=K[15]);q[4]=ja*Y+X*ba;q[5]=I*Y+aa*ba;q[6]=O*Y+ca*ba;q[7]=P*Y+fa*ba;q[8]=X*Y-ja*ba;q[9]=aa*Y-I*ba;q[10]=ca*Y-O*ba;q[11]=fa*Y-P*ba;return q}function n(q,K,Y){const ba=Math.sin(Y);Y=Math.cos(Y);const ja=K[0],I=K[1],O=K[2],P=K[3],X=K[8],aa=K[9],ca=K[10],fa=K[11];K!==q&&(q[4]=K[4],q[5]=K[5],q[6]=K[6],q[7]=K[7],q[12]=K[12],
q[13]=K[13],q[14]=K[14],q[15]=K[15]);q[0]=ja*Y-X*ba;q[1]=I*Y-aa*ba;q[2]=O*Y-ca*ba;q[3]=P*Y-fa*ba;q[8]=ja*ba+X*Y;q[9]=I*ba+aa*Y;q[10]=O*ba+ca*Y;q[11]=P*ba+fa*Y;return q}function p(q,K,Y){const ba=Math.sin(Y);Y=Math.cos(Y);const ja=K[0],I=K[1],O=K[2],P=K[3],X=K[4],aa=K[5],ca=K[6],fa=K[7];K!==q&&(q[8]=K[8],q[9]=K[9],q[10]=K[10],q[11]=K[11],q[12]=K[12],q[13]=K[13],q[14]=K[14],q[15]=K[15]);q[0]=ja*Y+X*ba;q[1]=I*Y+aa*ba;q[2]=O*Y+ca*ba;q[3]=P*Y+fa*ba;q[4]=X*Y-ja*ba;q[5]=aa*Y-I*ba;q[6]=ca*Y-O*ba;q[7]=fa*
Y-P*ba;return q}function D(q,K){q[0]=1;q[1]=0;q[2]=0;q[3]=0;q[4]=0;q[5]=1;q[6]=0;q[7]=0;q[8]=0;q[9]=0;q[10]=1;q[11]=0;q[12]=K[0];q[13]=K[1];q[14]=K[2];q[15]=1;return q}function M(q,K){q[0]=K[0];q[1]=0;q[2]=0;q[3]=0;q[4]=0;q[5]=K[1];q[6]=0;q[7]=0;q[8]=0;q[9]=0;q[10]=K[2];q[11]=0;q[12]=0;q[13]=0;q[14]=0;q[15]=1;return q}function g(q,K,Y){if(0===K)return z(q);let ba=Y[0],ja=Y[1];Y=Y[2];let I=Math.sqrt(ba*ba+ja*ja+Y*Y),O=void 0,P=void 0,X=void 0;if(I<w.getEpsilon())return null;I=1/I;ba*=I;ja*=I;Y*=I;
O=Math.sin(K);P=Math.cos(K);X=1-P;q[0]=ba*ba*X+P;q[1]=ja*ba*X+Y*O;q[2]=Y*ba*X-ja*O;q[3]=0;q[4]=ba*ja*X-Y*O;q[5]=ja*ja*X+P;q[6]=Y*ja*X+ba*O;q[7]=0;q[8]=ba*Y*X+ja*O;q[9]=ja*Y*X-ba*O;q[10]=Y*Y*X+P;q[11]=0;q[12]=0;q[13]=0;q[14]=0;q[15]=1;return q}function J(q,K){const Y=Math.sin(K);K=Math.cos(K);q[0]=1;q[1]=0;q[2]=0;q[3]=0;q[4]=0;q[5]=K;q[6]=Y;q[7]=0;q[8]=0;q[9]=-Y;q[10]=K;q[11]=0;q[12]=0;q[13]=0;q[14]=0;q[15]=1;return q}function R(q,K){const Y=Math.sin(K);K=Math.cos(K);q[0]=K;q[1]=0;q[2]=-Y;q[3]=0;q[4]=
0;q[5]=1;q[6]=0;q[7]=0;q[8]=Y;q[9]=0;q[10]=K;q[11]=0;q[12]=0;q[13]=0;q[14]=0;q[15]=1;return q}function B(q,K){const Y=Math.sin(K);K=Math.cos(K);q[0]=K;q[1]=Y;q[2]=0;q[3]=0;q[4]=-Y;q[5]=K;q[6]=0;q[7]=0;q[8]=0;q[9]=0;q[10]=1;q[11]=0;q[12]=0;q[13]=0;q[14]=0;q[15]=1;return q}function F(q,K,Y){var ba=K[0],ja=K[1],I=K[2],O=K[3],P=ba+ba,X=ja+ja;const aa=I+I;K=ba*P;const ca=ba*X;ba*=aa;const fa=ja*X;ja*=aa;I*=aa;P*=O;X*=O;O*=aa;q[0]=1-(fa+I);q[1]=ca+O;q[2]=ba-X;q[3]=0;q[4]=ca-O;q[5]=1-(K+I);q[6]=ja+P;q[7]=
0;q[8]=ba+X;q[9]=ja-P;q[10]=1-(K+fa);q[11]=0;q[12]=Y[0];q[13]=Y[1];q[14]=Y[2];q[15]=1;return q}function N(q,K){const Y=Oa,ba=-K[0],ja=-K[1],I=-K[2],O=K[3],P=K[4],X=K[5],aa=K[6],ca=K[7],fa=ba*ba+ja*ja+I*I+O*O;0<fa?(Y[0]=2*(P*O+ca*ba+X*I-aa*ja)/fa,Y[1]=2*(X*O+ca*ja+aa*ba-P*I)/fa,Y[2]=2*(aa*O+ca*I+P*ja-X*ba)/fa):(Y[0]=2*(P*O+ca*ba+X*I-aa*ja),Y[1]=2*(X*O+ca*ja+aa*ba-P*I),Y[2]=2*(aa*O+ca*I+P*ja-X*ba));F(q,K,Y);return q}function T(q,K){q[0]=K[12];q[1]=K[13];q[2]=K[14];return q}function y(q,K){const Y=K[0],
ba=K[1],ja=K[2],I=K[4],O=K[5],P=K[6],X=K[8],aa=K[9];K=K[10];q[0]=Math.sqrt(Y*Y+ba*ba+ja*ja);q[1]=Math.sqrt(I*I+O*O+P*P);q[2]=Math.sqrt(X*X+aa*aa+K*K);return q}function G(q,K){const Y=K[0]+K[5]+K[10];let ba=0;0<Y?(ba=2*Math.sqrt(Y+1),q[3]=.25*ba,q[0]=(K[6]-K[9])/ba,q[1]=(K[8]-K[2])/ba,q[2]=(K[1]-K[4])/ba):K[0]>K[5]&&K[0]>K[10]?(ba=2*Math.sqrt(1+K[0]-K[5]-K[10]),q[3]=(K[6]-K[9])/ba,q[0]=.25*ba,q[1]=(K[1]+K[4])/ba,q[2]=(K[8]+K[2])/ba):K[5]>K[10]?(ba=2*Math.sqrt(1+K[5]-K[0]-K[10]),q[3]=(K[8]-K[2])/ba,
q[0]=(K[1]+K[4])/ba,q[1]=.25*ba,q[2]=(K[6]+K[9])/ba):(ba=2*Math.sqrt(1+K[10]-K[0]-K[5]),q[3]=(K[1]-K[4])/ba,q[0]=(K[8]+K[2])/ba,q[1]=(K[6]+K[9])/ba,q[2]=.25*ba);return q}function k(q,K,Y,ba){var ja=K[0],I=K[1],O=K[2],P=K[3],X=ja+ja,aa=I+I,ca=O+O;K=ja*X;const fa=ja*aa;ja*=ca;const la=I*aa;I*=ca;O*=ca;X*=P;aa*=P;P*=ca;ca=ba[0];const ma=ba[1];ba=ba[2];q[0]=(1-(la+O))*ca;q[1]=(fa+P)*ca;q[2]=(ja-aa)*ca;q[3]=0;q[4]=(fa-P)*ma;q[5]=(1-(K+O))*ma;q[6]=(I+X)*ma;q[7]=0;q[8]=(ja+aa)*ba;q[9]=(I-X)*ba;q[10]=(1-
(K+la))*ba;q[11]=0;q[12]=Y[0];q[13]=Y[1];q[14]=Y[2];q[15]=1;return q}function l(q,K,Y,ba,ja){var I=K[0],O=K[1],P=K[2],X=K[3],aa=I+I,ca=O+O,fa=P+P;K=I*aa;var la=I*ca,ma=I*fa;I=O*ca;O*=fa;var ua=P*fa;P=X*aa;ca*=X;const pa=X*fa;var sa=ba[0],Ca=ba[1];fa=ba[2];ba=ja[0];X=ja[1];ja=ja[2];aa=(1-(I+ua))*sa;const xa=(la+pa)*sa;sa*=ma-ca;la=(la-pa)*Ca;ua=(1-(K+ua))*Ca;Ca*=O+P;ma=(ma+ca)*fa;O=(O-P)*fa;K=(1-(K+I))*fa;q[0]=aa;q[1]=xa;q[2]=sa;q[3]=0;q[4]=la;q[5]=ua;q[6]=Ca;q[7]=0;q[8]=ma;q[9]=O;q[10]=K;q[11]=0;
q[12]=Y[0]+ba-(aa*ba+la*X+ma*ja);q[13]=Y[1]+X-(xa*ba+ua*X+O*ja);q[14]=Y[2]+ja-(sa*ba+Ca*X+K*ja);q[15]=1;return q}function H(q,K){var Y=K[0],ba=K[1],ja=K[2];K=K[3];var I=Y+Y,O=ba+ba;const P=ja+ja;Y*=I;const X=ba*I;ba*=O;const aa=ja*I,ca=ja*O;ja*=P;I*=K;O*=K;K*=P;q[0]=1-ba-ja;q[1]=X+K;q[2]=aa-O;q[3]=0;q[4]=X-K;q[5]=1-Y-ja;q[6]=ca+I;q[7]=0;q[8]=aa+O;q[9]=ca-I;q[10]=1-Y-ba;q[11]=0;q[12]=0;q[13]=0;q[14]=0;q[15]=1;return q}function U(q,K,Y,ba,ja,I,O){const P=1/(Y-K),X=1/(ja-ba),aa=1/(I-O);q[0]=2*I*P;q[1]=
0;q[2]=0;q[3]=0;q[4]=0;q[5]=2*I*X;q[6]=0;q[7]=0;q[8]=(Y+K)*P;q[9]=(ja+ba)*X;q[10]=(O+I)*aa;q[11]=-1;q[12]=0;q[13]=0;q[14]=O*I*2*aa;q[15]=0;return q}function Q(q,K,Y,ba,ja){K=1/Math.tan(K/2);let I=void 0;q[0]=K/Y;q[1]=0;q[2]=0;q[3]=0;q[4]=0;q[5]=K;q[6]=0;q[7]=0;q[8]=0;q[9]=0;q[11]=-1;q[12]=0;q[13]=0;q[15]=0;null!=ja&&Infinity!==ja?(I=1/(ba-ja),q[10]=(ja+ba)*I,q[14]=2*ja*ba*I):(q[10]=-1,q[14]=-2*ba);return q}function W(q,K,Y,ba){const ja=Math.tan(K.upDegrees*Math.PI/180),I=Math.tan(K.downDegrees*Math.PI/
180),O=Math.tan(K.leftDegrees*Math.PI/180);K=Math.tan(K.rightDegrees*Math.PI/180);const P=2/(O+K),X=2/(ja+I);q[0]=P;q[1]=0;q[2]=0;q[3]=0;q[4]=0;q[5]=X;q[6]=0;q[7]=0;q[8]=-((O-K)*P*.5);q[9]=(ja-I)*X*.5;q[10]=ba/(Y-ba);q[11]=-1;q[12]=0;q[13]=0;q[14]=ba*Y/(Y-ba);q[15]=0;return q}function Z(q,K,Y,ba,ja,I,O){const P=1/(K-Y),X=1/(ba-ja),aa=1/(I-O);q[0]=-2*P;q[1]=0;q[2]=0;q[3]=0;q[4]=0;q[5]=-2*X;q[6]=0;q[7]=0;q[8]=0;q[9]=0;q[10]=2*aa;q[11]=0;q[12]=(K+Y)*P;q[13]=(ja+ba)*X;q[14]=(O+I)*aa;q[15]=1;return q}
function ea(q,K,Y,ba){const ja=K[0],I=K[1];K=K[2];let O=ja-Y[0],P=I-Y[1];Y=K-Y[2];var X=w.getEpsilon();if(Math.abs(O)<X&&Math.abs(P)<X&&Math.abs(Y)<X)z(q);else{var aa=1/Math.sqrt(O*O+P*P+Y*Y);O*=aa;P*=aa;Y*=aa;aa=ba[0];var ca=ba[1];X=ba[2];ba=ca*Y-X*P;X=X*O-aa*Y;ca=aa*P-ca*O;(aa=Math.sqrt(ba*ba+X*X+ca*ca))?(aa=1/aa,ba*=aa,X*=aa,ca*=aa):ca=X=ba=0;var fa=P*ca-Y*X,la=Y*ba-O*ca,ma=O*X-P*ba;(aa=Math.sqrt(fa*fa+la*la+ma*ma))?(aa=1/aa,fa*=aa,la*=aa,ma*=aa):ma=la=fa=0;q[0]=ba;q[1]=fa;q[2]=O;q[3]=0;q[4]=X;
q[5]=la;q[6]=P;q[7]=0;q[8]=ca;q[9]=ma;q[10]=Y;q[11]=0;q[12]=-(ba*ja+X*I+ca*K);q[13]=-(fa*ja+la*I+ma*K);q[14]=-(O*ja+P*I+Y*K);q[15]=1}}function ia(q,K,Y,ba){const ja=K[0],I=K[1];K=K[2];var O=ba[0];const P=ba[1];var X=ba[2];ba=ja-Y[0];let aa=I-Y[1];Y=K-Y[2];let ca=ba*ba+aa*aa+Y*Y;0<ca&&(ca=1/Math.sqrt(ca),ba*=ca,aa*=ca,Y*=ca);let fa=P*Y-X*aa;X=X*ba-O*Y;O=O*aa-P*ba;ca=fa*fa+X*X+O*O;0<ca&&(ca=1/Math.sqrt(ca),fa*=ca,X*=ca,O*=ca);q[0]=fa;q[1]=X;q[2]=O;q[3]=0;q[4]=aa*O-Y*X;q[5]=Y*fa-ba*O;q[6]=ba*X-aa*fa;
q[7]=0;q[8]=ba;q[9]=aa;q[10]=Y;q[11]=0;q[12]=ja;q[13]=I;q[14]=K;q[15]=1;return q}function na(q){return"mat4("+q[0]+", "+q[1]+", "+q[2]+", "+q[3]+", "+q[4]+", "+q[5]+", "+q[6]+", "+q[7]+", "+q[8]+", "+q[9]+", "+q[10]+", "+q[11]+", "+q[12]+", "+q[13]+", "+q[14]+", "+q[15]+")"}function qa(q){return Math.sqrt(q[0]**2+q[1]**2+q[2]**2+q[3]**2+q[4]**2+q[5]**2+q[6]**2+q[7]**2+q[8]**2+q[9]**2+q[10]**2+q[11]**2+q[12]**2+q[13]**2+q[14]**2+q[15]**2)}function va(q,K,Y){q[0]=K[0]+Y[0];q[1]=K[1]+Y[1];q[2]=K[2]+
Y[2];q[3]=K[3]+Y[3];q[4]=K[4]+Y[4];q[5]=K[5]+Y[5];q[6]=K[6]+Y[6];q[7]=K[7]+Y[7];q[8]=K[8]+Y[8];q[9]=K[9]+Y[9];q[10]=K[10]+Y[10];q[11]=K[11]+Y[11];q[12]=K[12]+Y[12];q[13]=K[13]+Y[13];q[14]=K[14]+Y[14];q[15]=K[15]+Y[15];return q}function ta(q,K,Y){q[0]=K[0]-Y[0];q[1]=K[1]-Y[1];q[2]=K[2]-Y[2];q[3]=K[3]-Y[3];q[4]=K[4]-Y[4];q[5]=K[5]-Y[5];q[6]=K[6]-Y[6];q[7]=K[7]-Y[7];q[8]=K[8]-Y[8];q[9]=K[9]-Y[9];q[10]=K[10]-Y[10];q[11]=K[11]-Y[11];q[12]=K[12]-Y[12];q[13]=K[13]-Y[13];q[14]=K[14]-Y[14];q[15]=K[15]-Y[15];
return q}function wa(q,K,Y){q[0]=K[0]*Y;q[1]=K[1]*Y;q[2]=K[2]*Y;q[3]=K[3]*Y;q[4]=K[4]*Y;q[5]=K[5]*Y;q[6]=K[6]*Y;q[7]=K[7]*Y;q[8]=K[8]*Y;q[9]=K[9]*Y;q[10]=K[10]*Y;q[11]=K[11]*Y;q[12]=K[12]*Y;q[13]=K[13]*Y;q[14]=K[14]*Y;q[15]=K[15]*Y;return q}function Ea(q,K,Y,ba){q[0]=K[0]+Y[0]*ba;q[1]=K[1]+Y[1]*ba;q[2]=K[2]+Y[2]*ba;q[3]=K[3]+Y[3]*ba;q[4]=K[4]+Y[4]*ba;q[5]=K[5]+Y[5]*ba;q[6]=K[6]+Y[6]*ba;q[7]=K[7]+Y[7]*ba;q[8]=K[8]+Y[8]*ba;q[9]=K[9]+Y[9]*ba;q[10]=K[10]+Y[10]*ba;q[11]=K[11]+Y[11]*ba;q[12]=K[12]+Y[12]*
ba;q[13]=K[13]+Y[13]*ba;q[14]=K[14]+Y[14]*ba;q[15]=K[15]+Y[15]*ba;return q}function Da(q,K){return q[0]===K[0]&&q[1]===K[1]&&q[2]===K[2]&&q[3]===K[3]&&q[4]===K[4]&&q[5]===K[5]&&q[6]===K[6]&&q[7]===K[7]&&q[8]===K[8]&&q[9]===K[9]&&q[10]===K[10]&&q[11]===K[11]&&q[12]===K[12]&&q[13]===K[13]&&q[14]===K[14]&&q[15]===K[15]}function Pa(q,K){if(q===K)return!0;const Y=q[0],ba=q[1],ja=q[2],I=q[3],O=q[4],P=q[5],X=q[6],aa=q[7],ca=q[8],fa=q[9],la=q[10],ma=q[11],ua=q[12],pa=q[13],sa=q[14];q=q[15];const Ca=K[0],
xa=K[1],Ba=K[2],Aa=K[3],ya=K[4],Ia=K[5],Qa=K[6],Ya=K[7],Wa=K[8],Ja=K[9],Ka=K[10],ka=K[11],Ra=K[12],Mb=K[13],nb=K[14];K=K[15];const f=w.getEpsilon();return Math.abs(Y-Ca)<=f*Math.max(1,Math.abs(Y),Math.abs(Ca))&&Math.abs(ba-xa)<=f*Math.max(1,Math.abs(ba),Math.abs(xa))&&Math.abs(ja-Ba)<=f*Math.max(1,Math.abs(ja),Math.abs(Ba))&&Math.abs(I-Aa)<=f*Math.max(1,Math.abs(I),Math.abs(Aa))&&Math.abs(O-ya)<=f*Math.max(1,Math.abs(O),Math.abs(ya))&&Math.abs(P-Ia)<=f*Math.max(1,Math.abs(P),Math.abs(Ia))&&Math.abs(X-
Qa)<=f*Math.max(1,Math.abs(X),Math.abs(Qa))&&Math.abs(aa-Ya)<=f*Math.max(1,Math.abs(aa),Math.abs(Ya))&&Math.abs(ca-Wa)<=f*Math.max(1,Math.abs(ca),Math.abs(Wa))&&Math.abs(fa-Ja)<=f*Math.max(1,Math.abs(fa),Math.abs(Ja))&&Math.abs(la-Ka)<=f*Math.max(1,Math.abs(la),Math.abs(Ka))&&Math.abs(ma-ka)<=f*Math.max(1,Math.abs(ma),Math.abs(ka))&&Math.abs(ua-Ra)<=f*Math.max(1,Math.abs(ua),Math.abs(Ra))&&Math.abs(pa-Mb)<=f*Math.max(1,Math.abs(pa),Math.abs(Mb))&&Math.abs(sa-nb)<=f*Math.max(1,Math.abs(sa),Math.abs(nb))&&
Math.abs(q-K)<=f*Math.max(1,Math.abs(q),Math.abs(K))}function Sa(q){const K=w.getEpsilon(),Y=q[0],ba=q[1],ja=q[2],I=q[4],O=q[5],P=q[6],X=q[8],aa=q[9];q=q[10];return Math.abs(1-(Y*Y+I*I+X*X))<=K&&Math.abs(1-(ba*ba+O*O+aa*aa))<=K&&Math.abs(1-(ja*ja+P*P+q*q))<=K}function Ta(q){return 1===q[0]&&0===q[1]&&0===q[2]&&0===q[4]&&1===q[5]&&0===q[6]&&0===q[8]&&0===q[9]&&1===q[10]}const Oa=c.create();c=Object.freeze(Object.defineProperty({__proto__:null,add:va,adjoint:u,copy:v,determinant:A,equals:Pa,exactEquals:Da,
frob:qa,fromQuat:H,fromQuat2:N,fromRotation:g,fromRotationTranslation:F,fromRotationTranslationScale:k,fromRotationTranslationScaleOrigin:l,fromScaling:M,fromTranslation:D,fromXRotation:J,fromYRotation:R,fromZRotation:B,frustum:U,getRotation:G,getScaling:y,getTranslation:T,hasIdentityRotation:Ta,identity:z,invert:d,invertOrIdentity:r,isOrthoNormal:Sa,lookAt:ea,mul:x,multiply:x,multiplyScalar:wa,multiplyScalarAndAdd:Ea,ortho:Z,perspective:Q,perspectiveFromFieldOfView:W,rotate:h,rotateX:b,rotateY:n,
rotateZ:p,scale:m,set:C,str:na,sub:ta,subtract:ta,targetTo:ia,translate:E,transpose:e},Symbol.toStringTag,{value:"Module"}));a.add=va;a.adjoint=u;a.copy=v;a.determinant=A;a.equals=Pa;a.exactEquals=Da;a.frob=qa;a.fromQuat=H;a.fromQuat2=N;a.fromRotation=g;a.fromRotationTranslation=F;a.fromRotationTranslationScale=k;a.fromRotationTranslationScaleOrigin=l;a.fromScaling=M;a.fromTranslation=D;a.fromXRotation=J;a.fromYRotation=R;a.fromZRotation=B;a.frustum=U;a.getRotation=G;a.getScaling=y;a.getTranslation=
T;a.hasIdentityRotation=Ta;a.identity=z;a.invert=d;a.invertOrIdentity=r;a.isOrthoNormal=Sa;a.lookAt=ea;a.mat4=c;a.mul=x;a.multiply=x;a.multiplyScalar=wa;a.multiplyScalarAndAdd=Ea;a.ortho=Z;a.perspective=Q;a.perspectiveFromFieldOfView=W;a.rotate=h;a.rotateX=b;a.rotateY=n;a.rotateZ=p;a.scale=m;a.set=C;a.str=na;a.sub=ta;a.subtract=ta;a.targetTo=ia;a.translate=E;a.transpose=e;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/statistics/utils":function(){define(["exports","../rest/support/ClassBreaksDefinition",
"../rest/support/generateRendererUtils"],function(a,c,w){function v(k){return null==k||"string"===typeof k&&!k?"\x3cNull\x3e":k}function C(k){const l=null!=k.minValue||null!=k.maxValue,H=!!k.sqlExpression&&k.supportsSQLExpression;return!(null!=k.normalizationField||null!=k.normalizationType)&&!l&&!H}function z(k){const {values:l,useSampleStdDev:H,supportsNullCount:U}=k;var Q=Number.POSITIVE_INFINITY;let W=Number.NEGATIVE_INFINITY,Z=null,ea=null;var ia=null;let na=null,qa=0;const va=null==k.minValue?
-Infinity:k.minValue,ta=null==k.maxValue?Infinity:k.maxValue;for(const wa of l)Number.isFinite(wa)?wa>=va&&wa<=ta&&(Z=null===Z?wa:Z+wa,Q=Math.min(Q,wa),W=Math.max(W,wa),qa++):"string"===typeof wa&&qa++;if(qa&&null!=Z){ea=Z/qa;ia=0;for(const wa of l)Number.isFinite(wa)&&wa>=va&&wa<=ta&&(ia+=(wa-ea)**2);na=H?1<qa?ia/(qa-1):0:0<qa?ia/qa:0;ia=Math.sqrt(na)}else W=Q=null;Q={avg:ea,count:qa,max:W,min:Q,stddev:ia,sum:Z,variance:na};U&&(Q.nullcount=l.length-qa);k.percentileParams&&(Q.median=e(l,k.percentileParams));
return Q}function e(k,l){const {fieldType:H,value:U,orderBy:Q,isDiscrete:W}=l,Z=r(H,"desc"===Q);k=[...k].filter(qa=>null!=qa).sort((qa,va)=>Z(qa,va));if(0===k.length)return null;if(0>=U)return k[0];if(1<=U)return k[k.length-1];var ea=(k.length-1)*U,ia=Math.floor(ea);l=ia+1;ea%=1;ia=k[ia];const na=k[l];return l>=k.length||W||"string"===typeof ia||"string"===typeof na?ia:ia*(1-ea)+na*ea}function r(k,l){if(k){if(D.has(k))return l?y:G;if(M.has(k))return d(l,!1);if("esriFieldTypeTimestampOffset"===k)return l?
F:B;const W=d(l,!0);if("esriFieldTypeString"===k)return W;if("esriFieldTypeGUID"===k||"esriFieldTypeGlobalID"===k)return(Z,ea)=>W(u(Z),u(ea))}const H=l?1:-1,U=l?y:G,Q=d(l,!0);return(W,Z)=>"number"===typeof W&&"number"===typeof Z?U(W,Z):"string"===typeof W&&"string"===typeof Z?Q(W,Z):H}function d(k,l){if(!l)return k?T:N;const H=k?J:R;return k?(U,Q)=>{const W=H(U,Q);if(null!=W)return W;U=U.toUpperCase();Q=Q.toUpperCase();return U>Q?-1:U<Q?1:0}:(U,Q)=>{const W=H(U,Q);if(null!=W)return W;U=U.toUpperCase();
Q=Q.toUpperCase();return U<Q?-1:U>Q?1:0}}function u(k){return k.substr(24,12)+k.substr(19,4)+k.substr(16,2)+k.substr(14,2)+k.substr(11,2)+k.substr(9,2)+k.substr(6,2)+k.substr(4,2)+k.substr(2,2)+k.substr(0,2)}function A(k){return"coded-value"!==k?.type?[]:k.codedValues.map(l=>l.code)}function x(k,l){const H=m({field:l.field,normalizationType:l.normalizationType,normalizationField:l.normalizationField,classificationMethod:l.classificationMethod,standardDeviationInterval:l.standardDeviationInterval,
breakCount:l.numClasses||5});k=E(k,l.minValue,l.maxValue);return w.createGenerateRendererClassBreaks({definition:H,values:k,normalizationTotal:l.normalizationTotal})}function E(k,l,H){const U=null==l?-Infinity:l,Q=null==H?Infinity:H;return k.filter(W=>Number.isFinite(W)&&W>=U&&W<=Q)}function m(k){const {breakCount:l,field:H,normalizationField:U,normalizationType:Q}=k,W=k.classificationMethod||"equal-interval";return new c({breakCount:l,classificationField:H,classificationMethod:W,normalizationField:"field"===
Q?U:void 0,normalizationType:Q,standardDeviationInterval:"standard-deviation"===W?k.standardDeviationInterval||1:void 0})}function h(k,l){const {field:H,classificationMethod:U,standardDeviationInterval:Q,normalizationType:W,normalizationField:Z,normalizationTotal:ea,minValue:ia,maxValue:na}=l,qa=l.numBins||10;let va=l=null,ta=null;U&&"equal-interval"!==U||W?({classBreaks:k}=x(k,{field:H,normalizationType:W,normalizationField:Z,normalizationTotal:ea,classificationMethod:U,standardDeviationInterval:Q,
minValue:ia,maxValue:na,numClasses:qa}),l=k[0].minValue,va=k[k.length-1].maxValue,ta=k.map(wa=>[wa.minValue,wa.maxValue])):(null!=ia&&null!=na?(l=ia,va=na):(k=z({values:k,minValue:ia,maxValue:na,useSampleStdDev:!W,supportsNullCount:C({normalizationType:W,normalizationField:Z,minValue:ia,maxValue:na})}),l=k.min??null,va=k.max??null),ta=n(l??0,va??0,qa));return{min:l,max:va,intervals:ta}}function b(k,l){let H=-1;for(let U=k.length-1;0<=U;U--)if(l>=k[U][0]){H=U;break}return H}function n(k,l,H){const U=
(l-k)/H,Q=[];let W;for(let Z=1;Z<=H;Z++)W=k+U,W=Number(W.toFixed(16)),Q.push([k,Z===H?l:W]),k=W;return Q}const p=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,D=new Set("esriFieldTypeDate esriFieldTypeInteger esriFieldTypeSmallInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeOID esriFieldTypeBigInteger".split(" ")),M=new Set(["esriFieldTypeTimeOnly","esriFieldTypeDateOnly"]),g="min max avg stddev count sum variance nullcount median".split(" "),J=(k,l)=>null==k?null==l?0:1:
null==l?-1:null,R=(k,l)=>null==k?null==l?0:-1:null==l?1:null,B=(k,l)=>R(k,l)??(k===l?0:(new Date(k)).getTime()-(new Date(l)).getTime()),F=(k,l)=>J(k,l)??(k===l?0:(new Date(l)).getTime()-(new Date(k)).getTime()),N=(k,l)=>R(k,l)??(k===l?0:k<l?-1:1),T=(k,l)=>J(k,l)??(k===l?0:k<l?1:-1),y=(k,l)=>J(k,l)??l-k,G=(k,l)=>R(k,l)??k-l;a.calculateClassBreaks=x;a.calculateHistogram=function(k,l){var H=h(k,l);if(null==H.min&&null==H.max)return{bins:[],minValue:H.min,maxValue:H.max,normalizationTotal:l.normalizationTotal};
const U=H.intervals,Q=H.min??0;H=H.max??0;const W=U.map((Z,ea)=>({minValue:U[ea][0],maxValue:U[ea][1],count:0}));for(const Z of k)null!=Z&&Z>=Q&&Z<=H&&(k=b(U,Z),-1<k&&W[k].count++);return{bins:W,minValue:Q,maxValue:H,normalizationTotal:l.normalizationTotal}};a.calculatePercentile=e;a.calculateStatistics=z;a.calculateStringStatistics=function(k){const l=k.returnDistinct?[...(new Set(k.values))]:k.values;var H=l.filter(Q=>null!=Q).sort();const U=H.length;H={count:U,min:H[0],max:H[U-1]};k.supportsNullCount&&
(H.nullcount=l.length-U);k.percentileParams&&(H.median=e(l,k.percentileParams));return H};a.calculateUniqueValuesCount=function(k){const l={};for(let H of k){if(null==H||"string"===typeof H&&""===H.trim())H=null;null==l[H]?l[H]={count:1,data:H}:l[H].count++}return{count:l}};a.createClassBreaksDefinition=m;a.createUVResult=function(k,l,H,U){k=k.count;const Q=[];if(H&&l){H=[];var W=A(l[0]);for(const Z of W)if(l[1]){W=A(l[1]);for(const ea of W)if(l[2]){W=A(l[2]);for(const ia of W)H.push(`${v(Z)}${U}${v(ea)}${U}${v(ia)}`)}else H.push(`${v(Z)}${U}${v(ea)}`)}else H.push(Z);
for(const Z of H)k.hasOwnProperty(Z)||(k[Z]={data:Z,count:0})}for(const Z in k)l=k[Z],Q.push({value:l.data,count:l.count,label:l.label});return{uniqueValueInfos:Q}};a.getAttributeComparator=r;a.getEqualIntervalBins=n;a.getNormalizedValue=function(k,l,H,U){let Q=null;switch(l){case "log":0!==k&&(Q=Math.log(k)*Math.LOG10E);break;case "percent-of-total":Number.isFinite(U)&&0!==U&&(Q=k/U*100);break;case "field":Number.isFinite(H)&&0!==H&&(Q=k/H);break;case "natural-log":0<k&&(Q=Math.log(k));break;case "square-root":0<
k&&(Q=k**.5)}return Q};a.isNullCountSupported=C;a.processNullValue=v;a.processSummaryStatisticsResult=function(k,l){let H;for(H in k)g.includes(H)&&(Number.isFinite(k[H])||(k[H]=null));if(!l)return k;["avg","stddev","variance"].forEach(U=>{null!=k[U]&&(k[U]=Math.ceil(k[U]??0))});return k};a.resolveCBResult=function(k,l){let H=k.classBreaks;const U=H[0]?.minValue,Q=H[H.length-1]?.maxValue,W="standard-deviation"===l;H=H.map(Z=>{const ea=Z.label;Z={minValue:Z.minValue,maxValue:Z.maxValue,label:ea};if(W&&
ea){const ia=ea.match(p)?.map(na=>+na.trim())??[];2===ia.length?(Z.minStdDev=ia[0],Z.maxStdDev=ia[1],0>ia[0]&&0<ia[1]&&(Z.hasAvg=!0)):1===ia.length&&(ea.includes("\x3c")?(Z.minStdDev=null,Z.maxStdDev=ia[0]):ea.includes("\x3e")&&(Z.minStdDev=ia[0],Z.maxStdDev=null))}return Z});return{minValue:U,maxValue:Q,classBreakInfos:H,normalizationTotal:k.normalizationTotal}};a.statisticTypes=g;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/ClassBreaksDefinition":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),
function(a,c,w,v,C,z,e,r,d){C=new c.JSONMap({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"});c=new c.JSONMap({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});w=class extends w.JSONSupport{constructor(u){super(u);this.type="class-breaks-definition";
this.normalizationType=this.normalizationField=this.classificationMethod=this.classificationField=this.breakCount=null}set standardDeviationInterval(u){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",u)}set definedInterval(u){"defined-interval"===this.classificationMethod&&this._set("definedInterval",u)}};a.__decorate([r.enumeration({classBreaksDef:"class-breaks-definition"})],w.prototype,"type",void 0);a.__decorate([v.property({json:{write:!0}})],w.prototype,
"breakCount",void 0);a.__decorate([v.property({json:{write:!0}})],w.prototype,"classificationField",void 0);a.__decorate([v.property({type:String,json:{read:C.read,write:C.write}})],w.prototype,"classificationMethod",void 0);a.__decorate([v.property({json:{write:!0}})],w.prototype,"normalizationField",void 0);a.__decorate([v.property({json:{read:c.read,write:c.write}})],w.prototype,"normalizationType",void 0);a.__decorate([v.property({value:null,json:{write:!0}})],w.prototype,"standardDeviationInterval",
null);a.__decorate([v.property({value:null,json:{write:!0}})],w.prototype,"definedInterval",null);return w=a.__decorate([d.subclass("esri.rest.support.ClassBreaksDefinition")],w)})},"esri/core/accessorSupport/decorators/enumeration":function(){define(["exports","../../jsonMap","./property"],function(a,c,w){a.enumeration=function(v,C={}){v=v instanceof c.JSONMap?v:new c.JSONMap(v,C);v={type:C?.ignoreUnknown??!0?v.apiValues:String,json:{type:v.jsonValues,read:C?.readOnly?!1:{reader:v.read},write:{writer:v.write}}};
void 0!==C?.readOnly&&(v.readOnly=!!C.readOnly);void 0!==C?.default&&(v.json.default=C.default);void 0!==C?.name&&(v.json.name=C.name);void 0!==C?.nonNullable&&(v.nonNullable=C.nonNullable);return w.property(v)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/generateRendererUtils":function(){define(["exports","../../core/Logger"],function(a,c){function w(x){var E=x.definition;const {classificationMethod:m,normalizationType:h,definedInterval:b}=E;E=E.breakCount??
1;const n=[];var p=x.values;if(0===p.length)return[];p=p.sort((B,F)=>B-F);var D=p[0],M=p[p.length-1];if("equal-interval"===m)if(p.length>=E){p=(M-D)/E;x=D;for(var g=1;g<E;g++){var J=Number((D+g*p).toFixed(6));n.push({minValue:x,maxValue:J,label:v(x,J,h)});x=J}n.push({minValue:x,maxValue:M,label:v(x,M,h)})}else p.forEach(B=>{n.push({minValue:B,maxValue:B,label:v(B,B,h)})});else if("natural-breaks"===m){p=C(p);x=z(p.uniqueValues,x.valueFrequency||p.valueFrequency,E);for(g=1;g<E;g++)p.uniqueValues.length>
g&&(J=Number(p.uniqueValues[x[g]].toFixed(6)),n.push({minValue:D,maxValue:J,label:v(D,J,h)}),D=J);n.push({minValue:D,maxValue:M,label:v(D,M,h)})}else if("quantile"===m)if(p.length>=E&&D!==M){x=Math.ceil(p.length/E);g=0;for(J=1;J<E;J++){var R=x+g-1;R>p.length&&(R=p.length-1);0>R&&(R=0);n.push({minValue:D,maxValue:p[R],label:v(D,p[R],h)});D=p[R];g+=x;x=Math.ceil((p.length-g)/(E-J))}n.push({minValue:D,maxValue:M,label:v(D,M,h)})}else for(E=-1,M=0;M<p.length;M++)D=p[M],D!==E&&(E=D,n.push({minValue:E,
maxValue:D,label:v(E,D,h)}),E=D);else if("standard-deviation"===m)if(x=d(p),g=u(p,x),0===g)n.push({minValue:p[0],maxValue:p[0],label:v(p[0],p[0],h)});else{p=r(D,M,E,x,g)*g;g=0;for(J=E;1<=J;J--)R=Number((x-(J-.5)*p).toFixed(6)),n.push({minValue:D,maxValue:R,label:v(D,R,h)}),D=R,g++;J=Number((x+.5*p).toFixed(6));n.push({minValue:D,maxValue:J,label:v(D,J,h)});D=J;g++;for(R=1;R<=E;R++)J=g===2*E?M:Number((x+(R+.5)*p).toFixed(6)),n.push({minValue:D,maxValue:J,label:v(D,J,h)}),D=J,g++}else if("defined-interval"===
m){if(!b)return n;E=p[0];M=p[p.length-1];p=Math.ceil((M-E)/b);D=E;for(x=1;x<p;x++)g=Number((E+x*b).toFixed(6)),n.push({minValue:D,maxValue:g,label:v(D,g,h)}),D=g;n.push({minValue:D,maxValue:M,label:v(D,M,h)})}return n}function v(x,E,m){let h=null;return h=x===E?m&&"percent-of-total"===m?x+"%":x.toString():m&&"percent-of-total"===m?x+"% - "+E+"%":x+" - "+E}function C(x){const E=[],m=[];let h=Number.MIN_VALUE,b=1,n=-1;for(let p=0;p<x.length;p++){const D=x[p];D===h?(b++,m[n]=b):null!==D&&(E.push(D),
h=D,b=1,m.push(b),n++)}return{uniqueValues:E,valueFrequency:m}}function z(x,E,m){var h=x.length;const b=[];m>h&&(m=h);for(var n=0;n<m;n++)b.push(Math.round(n*h/m-1));b.push(h-1);n=e(b,x,E,m);h=n.mean;n=n.sdcm;var p=m,D=0,M=0;let g=0,J=0,R=!0;for(let F=0;2>F&&R;F++){0===F&&(R=!1);for(var B=0;B<p-1;B++)for(;b[B+1]+1!==b[B+2];)if(b[B+1]+=1,D=A(B,b,x,E),g=D.sbMean,D=D.sbSdcm,M=A(B+1,b,x,E),J=M.sbMean,M=M.sbSdcm,D+M<n[B]+n[B+1])n[B]=D,n[B+1]=M,h[B]=g,h[B+1]=J,R=!0;else{--b[B+1];break}for(B=p-1;0<B;B--)for(;b[B]!==
b[B-1]+1;)if(--b[B],D=A(B-1,b,x,E),g=D.sbMean,D=D.sbSdcm,M=A(B,b,x,E),J=M.sbMean,M=M.sbSdcm,D+M<n[B-1]+n[B])n[B-1]=D,n[B]=M,h[B-1]=g,h[B]=J,R=!0;else{b[B]+=1;break}}R&&(n=e(b,x,E,m));return b}function e(x,E,m,h){let b=[];var n=[],p=[];let D=0;const M=[],g=[];for(var J=0;J<h;J++){var R=A(J,x,E,m);M.push(R.sbMean);g.push(R.sbSdcm);D+=g[J]}R=D;for(J=!0;J||D<R;){J=!1;b=[];for(n=0;n<h;n++)b.push(x[n]);for(p=0;p<h;p++)for(R=x[p]+1;R<=x[p+1];R++)if(n=E[R],0<p&&R!==x[p+1]&&Math.abs(n-M[p])>Math.abs(n-M[p-
1]))x[p]=R;else if(p<h-1&&x[p]!==R-1&&Math.abs(n-M[p])>Math.abs(n-M[p+1])){x[p+1]=R-1;break}R=D;D=0;n=[];p=[];for(let B=0;B<h;B++){n.push(M[B]);p.push(g[B]);const F=A(B,x,E,m);M[B]=F.sbMean;g[B]=F.sbSdcm;D+=g[B]}}if(D>R){for(E=0;E<h;E++)x[E]=b[E],M[E]=n[E],g[E]=p[E];D=R}return{mean:M,sdcm:g}}function r(x,E,m,h,b){x=Math.max(h-x,E-h)/b/m;return 1<=x?1:.5<=x?.5:.25}function d(x){let E=0;for(let m=0;m<x.length;m++)E+=x[m];return E/=x.length}function u(x,E){let m=0;for(let h=0;h<x.length;h++){const b=
x[h];m+=(b-E)*(b-E)}m/=x.length;return Math.sqrt(m)}function A(x,E,m,h){var b=0,n=0;for(var p=E[x]+1;p<=E[x+1];p++){const D=h[p];b+=m[p]*D;n+=D}0>=n&&c.getLogger("esri.rest.support.generateRendererUtils").warn("Exception in Natural Breaks calculation");b/=n;n=0;for(p=E[x]+1;p<=E[x+1];p++)n+=h[p]*(m[p]-b)**2;return{sbMean:b,sbSdcm:n}}a.createGenerateRendererClassBreaks=function(x){const {normalizationTotal:E}=x;return{classBreaks:w(x),normalizationTotal:E}};a.createGenerateRendererUniqueValues=function(x){x=
C(x);const E=[],m=x.uniqueValues.length;for(let h=0;h<m;h++){const b=x.uniqueValues[h];E.push({value:b,count:x.valueFrequency[h],label:b.toString()})}return{uniqueValues:E}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/SnappingCandidate":function(){define(["exports"],function(a){a.makeEdgeCandidate=function(c,w,v,C,z,e=!1){return{objectId:c,target:w,distance:v,type:"edge",start:C,end:z,draped:e}};a.makeVertexCandidate=function(c,w,v){return{objectId:c,
target:w,distance:v,type:"vertex"}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/queryUtils":function(){define("require exports ../../../core/jsonMap ../../../core/unitUtils ../../../geometry/projection ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ./projectionSupport".split(" "),function(a,c,w,v,C,z,e,r,d,u){async function A(n,p,D){if(!n)return null;
var {where:M}=n;n.where=M=M?.trim();if(!M||/^1 *= *1$/.test(M)||p&&p===M)n.where=null;if(!n.geometry)return n;p=await E(n);n.distance=0;n.units=null;"esriSpatialRelEnvelopeIntersects"===n.spatialRel&&({spatialReference:M}=n.geometry,p=z.getGeometryExtent(p),p.spatialReference=M);if(p){await u.checkProjectionSupport(p.spatialReference,D);M=p.spatialReference;p=x(p,D)&&e.isExtent(p)?{spatialReference:M,rings:[[[p.xmin,p.ymin],[p.xmin,p.ymax],[p.xmax,p.ymax],[p.xmax,p.ymin],[p.xmin,p.ymin]]]}:p;M=(await r.normalizeCentralMeridian(e.fromJSON(p)))[0];
if(null==M)throw b;const g="quantizationParameters"in n&&n.quantizationParameters?.tolerance||"maxAllowableOffset"in n&&n.maxAllowableOffset||0;p=g&&x(p,D)?{densificationStep:8*g}:void 0;M=M.toJSON();p=u.project(M,M.spatialReference,D,p);if(!p)throw b;p.spatialReference=D;n.geometry=p}return n}function x(n,p){if(!n)return!1;const D=n.spatialReference;return(e.isExtent(n)||e.isPolygon(n)||e.isPolyline(n))&&!d.equals(D,p)&&!C.canProjectWithoutEngine(D,p)}async function E(n){const {distance:p,units:D}=
n,M=n.geometry;if(null==p||"vertexAttributes"in M)return M;var g=M.spatialReference;n=D?h.fromJSON(D):v.getUnitString(g);g=g&&(d.isGeographic(g)||d.isWebMercator(g))?M:await u.checkProjectionSupport(g,d.wgs84).then(()=>u.project(M,d.wgs84));return(await m())(g.spatialReference,g,p,n)}async function m(){return(await new Promise((n,p)=>a(["../../../geometry/geometryEngineJSON"],n,p))).geodesicBuffer}const h=new w.JSONMap({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",
esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),b=Object.freeze({});c.normalizeQuery=async function(n,p,D){const {outFields:M,orderByFields:g,groupByFieldsForStatistics:J,outStatistics:R}=n;if(M)for(var B=0;B<M.length;B++)M[B]=M[B].trim();if(g)for(B=0;B<g.length;B++)g[B]=g[B].trim();if(J)for(B=0;B<J.length;B++)J[B]=J[B].trim();if(R)for(B=0;B<R.length;B++)R[B].onStatisticField&&(R[B].onStatisticField=R[B].onStatisticField.trim());
n.geometry&&!n.outSR&&(n.outSR=n.geometry.spatialReference);return A(n,p,D)};c.normalizeQueryLike=A;c.queryEngineEmptyResult=b;c.unitsKebabDict=h;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/queryValidationUtils":function(){define("exports ../../../core/Error ./attributeSupport ./projectionSupport ./spatialQuerySupport ../../../support/arcadeOnDemand".split(" "),function(a,c,w,v,C,z){function e(x,E,m){const {outFields:h,orderByFields:b,returnDistinctValues:n,
outStatistics:p}=m,D=p?p.map(M=>M.outStatisticFieldName&&M.outStatisticFieldName.toLowerCase()).filter(Boolean):[];if(b&&0<b.length){const M=b.map(g=>{const J=g.toLowerCase();return J.includes(" asc")?J.split(" asc")[0]:J.includes(" desc")?J.split(" desc")[0]:g}).filter(g=>!D.includes(g));w.validateFields(x,E,M,{expressionName:"orderByFields",query:m})}if(h&&0<h.length)w.validateFields(x,E,h,{expressionName:"outFields",query:m,allowedFieldTypes:"all"});else if(n)throw new c("unsupported-query","outFields should be specified for returnDistinctValues",
{query:m});w.validateWhere(x,E,m.where,m)}function r(x,E,m){const {outStatistics:h,groupByFieldsForStatistics:b,having:n}=m;var p=b?.length,D=h?.length;if(n){if(!p||!D)throw new c("unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:m});w.validateHaving(x,E,n,h,m)}if(D&&u(h)){D=h.map(M=>M.onStatisticField).filter(Boolean);w.validateFields(x,E,D,{expressionName:"onStatisticFields",query:m});p&&w.validateFields(x,E,b,{expressionName:"groupByFieldsForStatistics",
query:m});for(const M of h){const {onStatisticField:g,statisticType:J}=M;if(("percentile_disc"===J||"percentile_cont"===J)&&"statisticParameters"in M){if({statisticParameters:p}=M,!p)throw new c("unsupported-query","statisticParameters should be set for percentile type",{definition:M,query:m});}else x.get(g)&&"count"!==J&&"min"!==J&&"max"!==J&&w.validateFields(x,E,[g],{expressionName:`outStatistics with '${J}' statistic type`,allowedFieldTypes:A,query:m})}}}async function d(x,E,m,h){var b=[];m.valueExpression&&
({arcadeUtils:b}=await z.loadArcade(),b=b.extractFieldNames(m.valueExpression));m.field&&b.push(m.field);m.field2&&b.push(m.field2);m.field3&&b.push(m.field3);m.normalizationField&&b.push(m.normalizationField);if(!b.length&&!m.valueExpression)throw new c("unsupported-query","field or valueExpression is required",{params:m});w.validateFields(x,E,b,{expressionName:"statistics",query:h})}function u(x){return null!=x&&x.every(E=>"exceedslimit"!==E.statisticType)}const A=new Set([...w.numericFieldTypes,
...w.allDateAndTimeFieldTypes]);a.validateQuery=async function(x,{fieldsIndex:E,geometryType:m,spatialReference:h,availableFields:b}){if(0>(x.distance??0)||null!=x.geometryPrecision||x.multipatchOption&&"xyFootprint"!==x.multipatchOption||x.pixelSize||x.relationParam||x.text)throw new c("unsupported-query","Unsupported query options",{query:x});e(E,b,x);r(E,b,x);return Promise.all([C.checkSpatialQuerySupport(x,m,h),v.checkProjectionSupport(h,x.outSR)]).then(()=>x)};a.validateStatisticsQuery=async function(x,
E,{fieldsIndex:m,geometryType:h,spatialReference:b,availableFields:n}){if(0>(x.distance??0)||null!=x.geometryPrecision||x.multipatchOption||x.pixelSize||x.relationParam||x.text||x.outStatistics||x.groupByFieldsForStatistics||x.having||x.orderByFields)throw new c("unsupported-query","Unsupported query options",{query:x});e(m,n,x);return Promise.all([d(m,n,E,x),C.checkSpatialQuerySupport(x,h,b),v.checkProjectionSupport(b,x.outSR)]).then(()=>x)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/graphics/data/spatialQuerySupport":function(){define("require exports ../../../core/Error ../../../geometry/support/contains ../../../geometry/support/intersects ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ../contains ../featureConversionUtils ../OptimizedGeometry ./geometryUtils ./projectionSupport".split(" "),function(a,c,w,v,C,z,e,r,d,u,A,x){function E(){return new Promise((p,D)=>a(["../../../geometry/geometryEngineJSON"],p,D))}const m={esriSpatialRelIntersects:"intersects",
esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null};var h={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,
esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},b={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},n={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};c.canQueryWithRBush=function(p){if(z.isExtent(p))return!0;if(z.isPolygon(p)){for(const D of p.rings)if(5!==D.length||D[0][0]!==D[1][0]||D[0][0]!==D[4][0]||D[2][0]!==D[3][0]||D[0][1]!==D[3][1]||D[0][1]!==
D[4][1]||D[1][1]!==D[2][1])return!1;return!0}return!1};c.checkSpatialQuerySupport=async function(p,D,M){const {spatialRel:g,geometry:J}=p;if(J){if(null==g||!0!==h[g])throw new w("unsupported-query","Unsupported query spatial relationship",{query:p});if(e.isValid(J.spatialReference)&&e.isValid(M)){if(null==J||!0!==b[z.getJsonType(J)])throw new w("unsupported-query","Unsupported query geometry type",{query:p});if(null==D||!0!==n[D])throw new w("unsupported-query","Unsupported layer geometry type",{query:p});
if(p.outSR)return x.checkProjectionSupport(p.geometry?.spatialReference,p.outSR)}}};c.getSpatialQueryOperator=function(p,D,M,g,J){if(z.isPolygon(D)&&"esriGeometryPoint"===M&&("esriSpatialRelIntersects"===p||"esriSpatialRelContains"===p)){const R=d.convertFromPolygon(new u,D,!1,!1);return Promise.resolve(B=>r.polygonContainsPoint(R,!1,!1,B))}if(z.isPolygon(D)&&"esriGeometryMultipoint"===M){const R=d.convertFromPolygon(new u,D,!1,!1);if("esriSpatialRelContains"===p)return Promise.resolve(B=>r.polygonContainsMultipoint(R,
!1,!1,B,g,J))}if(z.isExtent(D)&&"esriGeometryPoint"===M&&("esriSpatialRelIntersects"===p||"esriSpatialRelContains"===p))return Promise.resolve(R=>v.extentContainsPoint(D,A.getGeometry(M,g,J,R)));if(z.isExtent(D)&&"esriGeometryMultipoint"===M&&"esriSpatialRelContains"===p)return Promise.resolve(R=>v.extentContainsMultipoint(D,A.getGeometry(M,g,J,R)));if(z.isExtent(D)&&"esriSpatialRelIntersects"===p){const R=C.getExtentIntersector(M);return Promise.resolve(B=>R(D,A.getGeometry(M,g,J,B)))}return E().then(R=>
{const B=R[m[p]].bind(null,D.spatialReference,D);return F=>B(A.getGeometry(M,g,J,F))})};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/intersects":function(){define(["exports","./intersectsBase"],function(a,c){a.extentIntersectsExtent=c.extentIntersectsExtent;a.extentIntersectsMultipoint=c.extentIntersectsMultipoint;a.extentIntersectsPoint=c.extentIntersectsPoint;a.extentIntersectsPolygon=c.extentIntersectsPolygon;a.extentIntersectsPolyline=c.extentIntersectsPolyline;
a.getFeatureExtentIntersector=c.getFeatureExtentIntersector;a.isSelfIntersecting=c.isSelfIntersecting;a.segmentIntersects=c.segmentIntersects;a.getExtentIntersector=function(w){return"mesh"===w?c.extentIntersectsExtent:c.getFeatureExtentIntersector(w)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/contains":function(){define(["exports"],function(a){function c(w,v,C,z,e){if(!w)return!1;v=v?C?4:3:C?3:2;const {coords:r,lengths:d}=w;C=!1;w=0;for(const A of d){var u=
w;for(let x=w,E=w+A*v;x<E;x+=v){u=x+v;u===E&&(u=w);const m=r[x],h=r[x+1],b=r[u];u=r[u+1];(h<e&&u>=e||u<e&&h>=e)&&m+(e-h)/(u-h)*(b-m)<z&&(C=!C)}w+=A*v}return C}a.polygonContainsCoords=c;a.polygonContainsMultipoint=function(w,v,C,z,e,r){e=e?r?4:3:r?3:2;const {coords:d,lengths:u}=z;if(!u)return!1;for(let A=0,x=0;A<u.length;A++,x+=e)if(!c(w,v,C,d[x],d[x+1]))return!1;return!0};a.polygonContainsPoint=function(w,v,C,z){return c(w,v,C,z.coords[0],z.coords[1])};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/graphics/data/timeSupport":function(){define(["exports"],function(a){function c(C,z,e,r,d){if(null!=r&&null!=d)return u=>{const A=C(u,z);u=C(u,e);return(null==A||A<=d)&&(null==u||u>=r)};if(null!=r)return u=>{u=C(u,e);return null==u||u>=r};if(null!=d)return u=>{u=C(u,z);return null==u||u<=d}}function w(C,z,e,r){if(null!=e&&null!=r&&e===r)return d=>C(d,z)===e;if(null!=e&&null!=r)return d=>{d=C(d,z);return null!=d&&d>=e&&d<=r};if(null!=e)return d=>{d=C(d,z);return null!=d&&d>=e};if(null!=
r)return d=>{d=C(d,z);return null!=d&&d<=r}}function v(){return()=>!1}a.getTimeExtent=async function(C,z){if(!C)return null;const e=z.featureAdapter,{startTimeField:r,endTimeField:d}=C;let u=Number.POSITIVE_INFINITY,A=Number.NEGATIVE_INFINITY;if(r&&d)await z.forEach(x=>{const E=e.getAttribute(x,r);x=e.getAttribute(x,d);null==E||isNaN(E)||(u=Math.min(u,E));null==x||isNaN(x)||(A=Math.max(A,x))});else{const x=r||d;await z.forEach(E=>{E=e.getAttribute(E,x);null==E||isNaN(E)||(u=Math.min(u,E),A=Math.max(A,
E))})}return{start:u,end:A}};a.getTimeOperator=function(C,z,e){if(!z||!C)return null;const {startTimeField:r,endTimeField:d}=C;if(!r&&!d)return null;const {start:u,end:A}=z;if(null===u&&null===A)return null;if(void 0===u&&void 0===A)return v();C=e.getAttributeAsTimestamp?.bind(e)??e.getAttribute.bind(e);return r&&d?c(C,r,d,u,A):w(C,r||d,u,A)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/FieldsIndex":function(){define("../../core/Error ../../core/JSONSupport ../../core/Logger ../../core/MapUtils ../../core/sql/UnknownTimeZone ./fieldUtils ../../time/timeZoneUtils ../../chunks/datetime".split(" "),
function(a,c,w,v,C,z,e,r){function d(m){return m.trim().toLowerCase()}function u(m){const h=new Map;if(!m.fields)return h;const b=!0===m.datesInUnknownTimezone,{timeInfo:n,editFieldsInfo:p}=m;var D=(n?"startField"in n?n.startField:n.startTimeField:"")??"";const M=(n?"endField"in n?n.endField:n.endTimeField:"")??"",g="dateFieldsTimeZone"in m?m.dateFieldsTimeZone??null:m.dateFieldsTimeReference?e.fromTimeReference(m.dateFieldsTimeReference):null,J=p?"timeZone"in p?p.timeZone??g:p.dateFieldsTimeReference?
e.fromTimeReference(p.dateFieldsTimeReference):g??e.utc:null,R=n?"timeZone"in n?n.timeZone??g:n.timeReference?e.fromTimeReference(n.timeReference):g:null;D=new Map([[d(p?.creationDateField??""),J],[d(p?.editDateField??""),J],[d(D),R],[d(M),R]]);for(const {name:B,type:F}of m.fields)E.has(F)?h.set(B,e.unknown):"date"!==F&&"esriFieldTypeDate"!==F?h.set(B,null):b?h.set(B,e.unknown):(m=D.get(d(B??""))??g,h.set(B,m));return h}const A=new Map;class x{static fromJSON(m){return new x(m.fields,m.timeZoneByFieldName)}static fromLayer(m){return new x(m.fields??
[],u(m))}static fromLayerJSON(m){return new x(m.fields??[],u(m))}constructor(m=[],h){this._fieldsMap=new Map;this._normalizedFieldsMap=new Map;this._dateFieldsSet=new Set;this._numericFieldsSet=new Set;this._requiredFields=null;this.dateFields=[];this.numericFields=[];this.fields=m||[];this._timeZoneByFieldName=h?new Map(h):null;m=[];for(const b of this.fields){h=b?.name;const n=z.normalizeFieldName(h)?.toLowerCase()??"";if(h&&n){const p=d(h);this._fieldsMap.set(h,b);this._fieldsMap.set(p,b);this._normalizedFieldsMap.set(n,
b);m.push(`${p}:${b.type}:${this._timeZoneByFieldName?.get(h)}`);z.isDateField(b)?(this.dateFields.push(b),this._dateFieldsSet.add(b)):z.isNumericField(b)&&(this._numericFieldsSet.add(b),this.numericFields.push(b));z.isObjectIDField(b)||z.isGlobalIDField(b)||(b.editable=null==b.editable||!!b.editable,b.nullable=null==b.nullable||!!b.nullable)}}m.sort();this.uid=m.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const m of this.fields)z.isObjectIDField(m)||z.isGlobalIDField(m)||
m.nullable||void 0!==z.getFieldDefaultValue(m)||this._requiredFields.push(m)}return this._requiredFields}equals(m){return this.uid===m?.uid}has(m){return null!=this.get(m)}get(m){if(m){var h=this._fieldsMap.get(m);if(h)return h;(h=this._fieldsMap.get(d(m))??this._normalizedFieldsMap.get(z.normalizeFieldName(m)?.toLowerCase()??""))&&this._fieldsMap.set(m,h);return h}}getTimeZone(m){m=this.get(m&&"string"!==typeof m?m.name:m);return m?this._timeZoneByFieldName?this._timeZoneByFieldName.get(m.name):
"date"===m.type||"esriFieldTypeDate"===m.type?(w.getLogger("esri.layers.support.FieldsIndex").error(new a("getTimeZone:no-timezone-information",`no time zone information for field '${m.name}'`)),e.utc):E.has(m.type)?e.unknown:null:null}getLuxonTimeZone(m){const h=this.getTimeZone(m);return h?h===e.unknown?C.UnknownTimeZone.instance:h===e.utc?r.FixedOffsetZone.utcInstance:v.getOrCreateMapValue(A,h,()=>r.IANAZone.create(h)):null}isDateField(m){return this._dateFieldsSet.has(this.get(m))}isTimeOnlyField(m){return z.isTimeOnlyField(this.get(m))}isNumericField(m){return this._numericFieldsSet.has(this.get(m))}normalizeFieldName(m){return this.get(m)?.name??
void 0}toJSON(){return{fields:this.fields.map(m=>c.isSerializable(m)?m.toJSON():m),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}}const E=new Set("time-only date-only timestamp-offset esriFieldTypeDateOnly esriFieldTypeTimeOnly esriFieldTypeTimestampOffset".split(" "));return x})},"esri/views/support/Scheduler":function(){define("exports ../../core/Handles ../../core/has ../../core/Logger ../../core/maybe ../../core/PerformanceSampler ../../core/PooledArray ../../core/promiseUtils ../../core/reactiveUtils ../../core/signal ../../core/time ../../layers/support/PromiseQueue ./debugFlags ./RenderState ./Yield".split(" "),
function(a,c,w,v,C,z,e,r,d,u,A,x,E,m,h){function b(T){return n.has(T)?n.get(T):"number"===typeof T?T:1}a.TaskPriority=void 0;(function(T){T.RESOURCE_CONTROLLER_IMMEDIATE="immediate";T.RESOURCE_CONTROLLER="schedule";T.SLIDE="slide";T.STREAM_DATA_LOADER="stream loader";T.ELEVATION_QUERY="elevation query";T.TERRAIN_SURFACE="terrain";T.SURFACE_GEOMETRY_UPDATES="surface geometry updates";T.LOD_RENDERER="LoD renderer";T.GRAPHICS_CORE="Graphics3D";T.I3S_CONTROLLER="I3S";T.POINT_CLOUD_LAYER="point cloud";
T.FEATURE_TILE_FETCHER="feature fetcher";T.OVERLAY="overlay";T.STAGE="stage";T.GRAPHICS_DECONFLICTOR="graphics deconflictor";T.FILTER_VISIBILITY="Graphics3D filter visibility";T.SCALE_VISIBILITY="Graphics3D scale visibility";T.FRUSTUM_VISIBILITY="Graphics3D frustum visibility";T.POINT_OF_INTEREST_FREQUENT="POI frequent";T.POINT_OF_INTEREST_INFREQUENT="POI infrequent";T.LABELER="labeler";T.FEATURE_QUERY_ENGINE="feature query";T.FEATURE_TILE_TREE="feature tile tree";T.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree";
T.ELEVATION_ALIGNMENT="elevation alignment";T.ELEVATION_ALIGNMENT_SCENE="elevation alignment scene";T.TEXT_TEXTURE_ATLAS="text texture atlas";T.TEXTURE_UNLOAD="texture unload";T.LINE_OF_SIGHT_TOOL="line of sight tool";T.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool";T.ELEVATION_PROFILE="elevation profile";T.SNAPPING="snapping";T.SHADOW_ACCUMULATOR="shadow accumulator";T.CLOUDS_GENERATOR="clouds generator";T[T.NONE=0]="NONE";T[T.TEST_PRIO=1]="TEST_PRIO"})(a.TaskPriority||(a.TaskPriority=
{}));const n=new Map([[a.TaskPriority.RESOURCE_CONTROLLER_IMMEDIATE,0],[a.TaskPriority.RESOURCE_CONTROLLER,4],[a.TaskPriority.SLIDE,0],[a.TaskPriority.STREAM_DATA_LOADER,0],[a.TaskPriority.ELEVATION_QUERY,0],[a.TaskPriority.TERRAIN_SURFACE,1],[a.TaskPriority.SURFACE_GEOMETRY_UPDATES,1],[a.TaskPriority.LOD_RENDERER,2],[a.TaskPriority.GRAPHICS_CORE,2],[a.TaskPriority.I3S_CONTROLLER,2],[a.TaskPriority.POINT_CLOUD_LAYER,2],[a.TaskPriority.FEATURE_TILE_FETCHER,2],[a.TaskPriority.OVERLAY,4],[a.TaskPriority.STAGE,
4],[a.TaskPriority.GRAPHICS_DECONFLICTOR,4],[a.TaskPriority.FILTER_VISIBILITY,4],[a.TaskPriority.SCALE_VISIBILITY,4],[a.TaskPriority.FRUSTUM_VISIBILITY,4],[a.TaskPriority.CLOUDS_GENERATOR,4],[a.TaskPriority.POINT_OF_INTEREST_FREQUENT,6],[a.TaskPriority.POINT_OF_INTEREST_INFREQUENT,30],[a.TaskPriority.LABELER,8],[a.TaskPriority.FEATURE_QUERY_ENGINE,8],[a.TaskPriority.FEATURE_TILE_TREE,16],[a.TaskPriority.FEATURE_TILE_TREE_ACTIVE,0],[a.TaskPriority.ELEVATION_ALIGNMENT,12],[a.TaskPriority.ELEVATION_ALIGNMENT_SCENE,
14],[a.TaskPriority.TEXT_TEXTURE_ATLAS,12],[a.TaskPriority.TEXTURE_UNLOAD,12],[a.TaskPriority.LINE_OF_SIGHT_TOOL,16],[a.TaskPriority.LINE_OF_SIGHT_TOOL_INTERACTIVE,0],[a.TaskPriority.SNAPPING,0],[a.TaskPriority.SHADOW_ACCUMULATOR,30]]),p=A.Milliseconds(6.5),D=A.Milliseconds(1),M=A.Milliseconds(30),g=A.Milliseconds(1E3/30),J=A.Milliseconds(100);var R;(function(T){class y{get updating(){return this._updating.value}_updatingChanged(){this._updating.value=this._tasks.some(l=>l.needsUpdate)}constructor(){this._updating=
u.signal(!0);this._microTaskQueued=!1;this._frameNumber=0;this.performanceInfo={total:new z("total"),tasks:new Map};this._frameTaskTimes=new Map;this._budget=new k;this._state=m.RenderState.INTERACTING;this._tasks=new e;this._runQueue=new e;this._load=0;this._idleStateCallbacks=new e;this._debug=this._forceTask=this._idleUpdatesStartFired=!1;this._debugHandle=d.watch(()=>E.SCHEDULER_LOG_SLOW_TASKS,l=>this._debug=l,d.initial);for(const l of Object.keys(a.TaskPriority))this.performanceInfo.tasks.set(a.TaskPriority[l],
new z(a.TaskPriority[l]))}destroy(){this._tasks.toArray().forEach(l=>l.remove());this._tasks.clear();C.removeMaybe(this._debugHandle);this._microTaskQueued=!1;this._updatingChanged()}taskRunningChanged(l){this._updatingChanged();l&&0<this._budget.remaining&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask(()=>{this._microTaskQueued&&(this._microTaskQueued=!1,0<this._budget.remaining&&this._schedule()&&this.frame())}))}registerTask(l,H){H=new G(this,l,H);this._tasks.push(H);this._updatingChanged();
this.performanceInfo.tasks.has(l)||this.performanceInfo.tasks.set(l,new z(l));return H}registerIdleStateCallbacks(l,H){const U={idleBegin:l,idleEnd:H};this._idleStateCallbacks.push(U);this.state===m.RenderState.IDLE&&this._idleUpdatesStartFired&&U.idleBegin();const Q=this;return{remove:()=>this._removeIdleStateCallbacks(U),set idleBegin(W){Q._idleUpdatesStartFired&&(U.idleEnd(),Q._state===m.RenderState.IDLE&&W());U.idleBegin=W},set idleEnd(W){U.idleEnd=W}}}get load(){return this._load}set state(l){this._state!==
l&&(this._state=l,this.state!==m.RenderState.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll(H=>H.idleEnd())))}get state(){return this._state}updateBudget(l){++this._frameNumber;let H=p,U=l.frameDuration,Q=D;switch(this.state){case m.RenderState.IDLE:H=A.Milliseconds(0);U=A.Milliseconds(Math.max(J,l.frameDuration));Q=M;break;case m.RenderState.INTERACTING:U=A.Milliseconds(Math.max(g,l.frameDuration))}U=A.Milliseconds(U-l.elapsedFrameTime-H);if(this.state!==
m.RenderState.IDLE&&U<D&&!this._forceTask)return this._forceTask=!0,!1;U=A.Milliseconds(Math.max(U,Q));this._budget.reset(U,this.state);this._updateLoad();return this._schedule()}frame(){this._microTaskQueued=this._forceTask=!1;switch(this.state){case m.RenderState.IDLE:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll(l=>l.idleBegin()));this._runIdle();break;case m.RenderState.INTERACTING:this._runInteracting();break;default:this._runAnimating()}}stopFrame(){this._budget.reset(A.Milliseconds(0),
this._state);this._budget.madeProgress()}_removeIdleStateCallbacks(l){this._idleUpdatesStartFired&&l.idleEnd();this._idleStateCallbacks.removeUnordered(l)}removeTask(l){this._tasks.removeUnordered(l);this._runQueue.removeUnordered(l);this._updatingChanged()}_updateTask(l){this._tasks.forAll(H=>{H.name===l&&H.setPriority(l)})}_getState(l){if(this._runQueue.some(U=>U.name===l))return a.TaskState.SCHEDULED;let H=a.TaskState.IDLE;this._tasks.forAll(U=>{U.name===l&&U.needsUpdate&&(1>=U.schedulePriority?
H=a.TaskState.READY:H!==a.TaskState.READY&&(H=a.TaskState.WAITING))});return H}_getRuntime(l){let H=0;this._tasks.forAll(U=>{U.name===l&&(H+=U.runtime)});return H}_resetRuntimes(){this._tasks.forAll(l=>l.runtime=0)}_getRunning(){const l=new Map;this._tasks.forAll(U=>{U.needsUpdate&&l.set(U.name,(l.get(U.name)||0)+1)});if(0===l.size)return null;let H="";l.forEach((U,Q)=>{H=1<U?H+` ${U}x ${Q}`:H+` ${Q}`});return H}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const l=
this._tasks.reduce((H,U)=>U.needsUpdate?++H:H,0);this._load=.9*this._load+l*(1-.9)}_schedule(){this._runQueue.filterInPlace(l=>{if(l.needsUpdate)return!0;l.schedulePriority=l.basePriority;return!1});for(this._tasks.forAll(l=>{0===l.basePriority&&l.needsUpdate&&!this._runQueue.includes(l)&&l.blockFrame!==this._frameNumber&&this._runQueue.unshift(l)});0===this._runQueue.length;){let l=!1;this._tasks.forAll(H=>{if(H.needsUpdate&&0!==H.schedulePriority&&0!==H.basePriority&&H.blockFrame!==this._frameNumber)switch(l=
!0,H.schedulePriority){case 1:H.schedulePriority=0;this._runQueue.push(H);break;default:--H.schedulePriority}});if(!l)return this._updatingChanged(),!1}this._updatingChanged();return!0}_run(){const l=this._budget.now();this._startFrameTaskTimes();do for(;0<this._runQueue.length;){var H=this._budget.now();const U=this._runQueue.pop();this._budget.resetProgress();try{U.task.runTask(this._budget)===h.Yield&&(U.blockFrame=this._frameNumber)}catch(Q){v.getLogger("esri.views.support.Scheduler").error(`Exception in task "${U.name}"`,
Q),U.blockFrame=this._frameNumber}!this._budget.hasProgressed&&U.blockFrame!==this._frameNumber&&U.needsUpdate&&(U.blockFrame=this._frameNumber);U.schedulePriority=U.basePriority;H=this._budget.now()-H;U.runtime+=H;this._frameTaskTimes.set(U.priority,this._frameTaskTimes.get(U.priority)+H);if(0>=this._budget.remaining){this._updatingChanged();this._recordFrameTaskTimes(this._budget.now()-l);return}}while(this._schedule());this._updatingChanged();this._recordFrameTaskTimes(this._budget.now()-l)}_startFrameTaskTimes(){for(const l of Object.keys(a.TaskPriority))this._frameTaskTimes.set(a.TaskPriority[l],
0)}_recordFrameTaskTimes(l){this._frameTaskTimes.forEach((H,U)=>this.performanceInfo.tasks.get(U).record(H));this.performanceInfo.total.record(l)}get test(){}}T.Scheduler=y;class G{get task(){return this._task.value}get updating(){return this._queue.running}constructor(l,H,U){this._scheduler=l;this.name=H;this.runtime=this.blockFrame=0;this._queue=new x.PromiseQueue;this._handles=new c;this.schedulePriority=this._basePriority=b(H);this._task=u.signal(null!=U?U:this._queue);this._handles.add(d.when(()=>
this.task.running,Q=>l.taskRunningChanged(Q)))}remove(){this.processQueue(B);this._scheduler.removeTask(this);this.schedule=N.schedule;this.reschedule=N.reschedule;this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(l){if(this.name!==l){this.name=l;l=b(l);if(0===this._basePriority||0!==this.schedulePriority)this.schedulePriority=l;this._basePriority=l}}get priority(){return this.name}set priority(l){this.setPriority(l)}get needsUpdate(){return this.updating||this.task.running}schedule(l,
H,U){return this._queue.push(l,H,U)}reschedule(l,H,U){return this._queue.unshift(l,H,U)}processQueue(l){return this._queue.runTask(l)}}class k{constructor(){this._begin="undefined"!==typeof performance?performance.now():0;this._budget=0;this._state=m.RenderState.IDLE;this._progressed=this._done=!1;this._enabled=!0}run(l){if(this.done)return!1;!0===l()&&this.madeProgress();return!0}get done(){return this._done}get budget(){return this._budget}madeProgress(){this._progressed=!0;return this._done=this.elapsed>=
this._budget&&this._enabled}get state(){return this._state}get enabled(){return this._enabled}set enabled(l){this._enabled=l}reset(l,H){this._begin=this.now();this._budget=l;this._state=H;this.resetProgress()}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return this.now()-this._begin}resetProgress(){this._done=this._progressed=!1}get hasProgressed(){return this._progressed}}T.Budget=k})(R||={});a.TaskState=void 0;(function(T){T.SCHEDULED=
"s";T.READY="r";T.WAITING="w";T.IDLE="i"})(a.TaskState||(a.TaskState={}));const B=(()=>{const T=new R.Budget;T.enabled=!1;return T})();class F{remove(){}processQueue(){}schedule(T,y,G){try{if(r.isAborted(y)){const k=r.createAbortError();return G?Promise.resolve(G(k)):Promise.reject(k)}return r.when(T(B))}catch(k){return Promise.reject(k)}}reschedule(T,y,G){return this.schedule(T,y,G)}}const N=new F;a.ImmediateTask=N;a.getTaskPriority=b;a.newScheduler=function(){return new R.Scheduler};a.noBudget=
B;a.taskPriorities=n;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/signal":function(){define(["exports","./lang","./accessorSupport/tracking","./accessorSupport/tracking/SimpleObservable"],function(a,c,w,v){class C{constructor(z,e){this._observable=new v.SimpleObservable;this._value=z;this._equalityFunction=e}get value(){w.trackAccess(this._observable);return this._value}set value(z){this._equalityFunction(z,this._value)||(this._value=z,this._observable.notify())}mutate(z){z(this._value);
this._observable.notify()}}a.signal=function(z,e=c.equalsShallow){return new C(z,e)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/PromiseQueue":function(){define(["exports","../../core/promiseUtils","../../core/signal","../../views/support/Yield"],function(a,c,w,v){class C{constructor(){this._tasks=[];this._runningTasks=w.signal(0)}get length(){return this._tasks.length}get running(){return 0<this._runningTasks.value}destroy(){this.cancelAll()}runTask(e){if(0===
this.length)return v.Yield;for(;!e.done&&this._process(e);)e.madeProgress()}push(e,r,d){++this._runningTasks.value;return(new Promise((u,A)=>this._tasks.push(new z(u,A,e,r,d)))).finally(()=>--this._runningTasks.value)}unshift(e,r,d){++this._runningTasks.value;return(new Promise((u,A)=>this._tasks.unshift(new z(u,A,e,r,d)))).finally(()=>--this._runningTasks.value)}_process(e){if(0===this._tasks.length)return!1;const r=this._tasks.shift();try{const d=c.isAborted(r.signal);if(d&&!r.abortCallback)r.reject(c.createAbortError());
else{const u=d?r.abortCallback?.(c.createAbortError()):r.callback(e);c.isPromiseLike(u)?u.then(r.resolve,r.reject):r.resolve(u)}}catch(d){r.reject(d)}return!0}cancelAll(){const e=c.createAbortError();for(const r of this._tasks)if(r.abortCallback){const d=r.abortCallback(e);r.resolve(d)}else r.reject(e);this._tasks.length=0}}class z{constructor(e,r,d,u,A){this.resolve=e;this.reject=r;this.callback=d;this.signal=u;this.abortCallback=A}}a.PromiseQueue=C;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/views/support/Yield":function(){define(["exports"],function(a){const c=Symbol("Yield");a.Yield=c;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/debugFlags":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),function(a,c,w,v,C,z,e){c=class extends c{constructor(){super(...arguments);this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=
this.SCHEDULER_LOG_SLOW_TASKS=!1}};a.__decorate([w.property()],c.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0);a.__decorate([w.property()],c.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0);c=a.__decorate([e.subclass("esri.views.support.debugFlags")],c);return new c})},"esri/views/support/RenderState":function(){define(["exports"],function(a){a.RenderState=void 0;var c=a.RenderState||(a.RenderState={});c[c.ANIMATING=0]="ANIMATING";c[c.INTERACTING=1]="INTERACTING";c[c.IDLE=2]=
"IDLE";Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/TileInfo":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/unitUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/RandomLCG ../../core/has ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../geometry/Point ../../geometry/SpatialReference ../../geometry/support/aaBoundingRect ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ./LOD ./TileKey".split(" "),
function(a,c,w,v,C,z,e,r,d,u,A,x,E,m,h,b,n,p){var D;c=new c.JSONMap({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});w=D=class extends w.JSONSupport{static create(M={}){const {resolutionFactor:g=1,scales:J,size:R=256,spatialReference:B=E.WebMercator,numLODs:F=24}=M;if(!h.isValid(B)){M=[];if(J)for(var N=0;N<J.length;N++){var T=
J[N];M.push(new n({level:N,scale:T,resolution:T}))}else for(N=5E-4,T=F-1;0<=T;T--)M.unshift(new n({level:T,scale:N,resolution:N})),N*=2;return new D({dpi:96,lods:M,origin:new x(0,0,B),size:[R,R],spatialReference:B})}N=h.getInfo(B);M=M.origin?new x({x:M.origin.x,y:M.origin.y,spatialReference:B}):N?new x({x:N.origin[0],y:N.origin[1],spatialReference:B}):new x({x:0,y:0,spatialReference:B});N=1/(39.37*v.getMetersPerUnitForSR(B)*96);T=[];if(J)for(var y=0;y<J.length;y++){var G=J[y];T.push(new n({level:y,
scale:G,resolution:G*N}))}else{var k=h.isGeographic(B)?512/R*5.916575275917094E8:256/R*5.91657527591555E8;y=Math.ceil(F/g);T.push(new n({level:0,scale:k,resolution:k*N}));for(G=1;G<y;G++)k/=2**g,T.push(new n({level:G,scale:k,resolution:k*N}))}return new D({dpi:96,lods:T,origin:M,size:[R,R],spatialReference:B})}constructor(M){super(M);this.dpi=96;this.spatialReference=this.size=this.origin=this.format=null}get isWrappable(){const {spatialReference:M,origin:g}=this;if(M&&g){const J=h.getInfo(M);return M.isWrappable&&
!!J&&Math.abs(J.origin[0]-g.x)<=J.dx}return!1}readOrigin(M,g){return x.fromJSON({spatialReference:g.spatialReference,...M})}set lods(M){const g=[],J=this._levelToLOD={};M&&M.forEach(R=>{g.push(R.scale);J[R.level]=R});this._set("scales",g);this._set("lods",M);this._initializeUpsampleLevels()}readSize(M,g){return[g.cols,g.rows]}writeSize(M,g){g.cols=M[0];g.rows=M[1]}zoomToScale(M){const g=this.scales;if(0>=M)return g[0];if(M>=g.length-1)return g[g.length-1];const J=Math.floor(M);return g[J]/(g[J]/g[J+
1])**(M-J)}scaleToZoom(M){const g=this.scales,J=g.length-1;let R=0;for(;R<J;R++){const B=g[R],F=g[R+1];if(B<=M)break;if(F===M)return R+1;if(B>M&&F<M)return R+Math.log(B/M)/Math.log(B/F)}return R}tileAt(M,g,J,R){var B=this.lodAt(M);if(!B)return null;let F;if("number"===typeof g)F=g,g=J;else{if(h.equals(g.spatialReference,this.spatialReference))F=g.x,g=g.y;else{R=b.project(g,this.spatialReference);if(null==R)return null;F=R.x;g=R.y}R=J}J=B.resolution*this.size[0];B=B.resolution*this.size[1];R||=new p.TileKey(null,
0,0,0,m.create());R.level=M;R.row=Math.floor((this.origin.y-g)/B+.001);R.col=Math.floor((F-this.origin.x)/J+.001);this.updateTileInfo(R);return R}updateTileInfo(M,g=D.ExtrapolateOptions.NONE){var J=this.lodAt(M.level);J||g!==D.ExtrapolateOptions.POWER_OF_TWO||(g=this.lods[this.lods.length-1],g.level<M.level&&(J=g));if(J){var R=M.level-J.level;g=J.resolution*this.size[0]/2**R;J=J.resolution*this.size[1]/2**R;M.id=`${M.level}/${M.row}/${M.col}`;M.extent||(M.extent=m.create());M.extent[0]=this.origin.x+
M.col*g;M.extent[1]=this.origin.y-(M.row+1)*J;M.extent[2]=M.extent[0]+g;M.extent[3]=M.extent[1]+J}}upsampleTile(M){const g=this._upsampleLevels[M.level];if(!g||-1===g.parentLevel)return!1;M.level=g.parentLevel;M.row=Math.floor(M.row/g.factor+.001);M.col=Math.floor(M.col/g.factor+.001);this.updateTileInfo(M);return!0}getTileBounds(M,g){var J=this.lodAt(g.level);if(null==J)return null;var {resolution:R}=J;J=R*this.size[0];R*=this.size[1];M[0]=this.origin.x+g.col*J;M[1]=this.origin.y-(g.row+1)*R;M[2]=
M[0]+J;M[3]=M[1]+R;return M}lodAt(M){return this._levelToLOD?.[M]??null}clone(){return D.fromJSON(this.write({}))}getCompatibleForVTL(M){if(this.size[0]!==this.size[1]||256===this.size[0]&&512===M)return null;const g=(512===this.size[0]&&256===M?-1:0)+(this.spatialReference.isGeographic?1:0);if(this.size[0]===M&&0===g)return this;const J=[],R=this.lods.length-g;for(let B=0;B<R;B++){const F=B+g,{scale:N,resolution:T}=0<=F?this.lods[F]:{scale:2*this.lods[0].scale,resolution:2*this.lods[0].resolution};
J.push(new n({level:B,scale:N,resolution:T}))}return new D({size:[M,M],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,lods:J})}_initializeUpsampleLevels(){const M=this.lods;this._upsampleLevels=[];let g=null;for(let J=0;J<M.length;J++){const R=M[J];this._upsampleLevels[R.level]={parentLevel:g?g.level:-1,factor:g?g.resolution/R.resolution:0};g=R}}};a.__decorate([C.property({type:Number,json:{write:!0}})],w.prototype,
"compressionQuality",void 0);a.__decorate([C.property({type:Number,json:{write:!0}})],w.prototype,"dpi",void 0);a.__decorate([C.property({type:String,json:{read:c.read,write:c.write,origins:{"web-scene":{read:!1,write:!1}}}})],w.prototype,"format",void 0);a.__decorate([C.property({readOnly:!0})],w.prototype,"isWrappable",null);a.__decorate([C.property({type:x,json:{write:!0}})],w.prototype,"origin",void 0);a.__decorate([d.reader("origin")],w.prototype,"readOrigin",null);a.__decorate([C.property({type:[n],
value:null,json:{write:!0}})],w.prototype,"lods",null);a.__decorate([C.property({readOnly:!0})],w.prototype,"scales",void 0);a.__decorate([C.property({cast:M=>Array.isArray(M)?M:"number"===typeof M?[M,M]:[256,256]})],w.prototype,"size",void 0);a.__decorate([d.reader("size",["rows","cols"])],w.prototype,"readSize",null);a.__decorate([A.writer("size",{cols:{type:z.Integer},rows:{type:z.Integer}})],w.prototype,"writeSize",null);a.__decorate([C.property({type:E,json:{write:!0}})],w.prototype,"spatialReference",
void 0);w=D=a.__decorate([u.subclass("esri.layers.support.TileInfo")],w);(function(M){M=M.ExtrapolateOptions||(M.ExtrapolateOptions={});M[M.NONE=0]="NONE";M[M.POWER_OF_TWO=1]="POWER_OF_TWO"})(w||={});return w})},"esri/layers/support/LOD":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/RandomLCG ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),function(a,c,w,v,C,
z,e){var r;c=r=class extends c.JSONSupport{constructor(d){super(d);this.cols=null;this.level=0;this.origin=this.levelValue=null;this.resolution=0;this.rows=null;this.scale=0}clone(){return new r({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}};a.__decorate([w.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],c.prototype,"cols",void 0);a.__decorate([w.property({type:v.Integer,
json:{write:!0}})],c.prototype,"level",void 0);a.__decorate([w.property({type:String,json:{write:!0}})],c.prototype,"levelValue",void 0);a.__decorate([w.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],c.prototype,"origin",void 0);a.__decorate([w.property({type:Number,json:{write:!0}})],c.prototype,"resolution",void 0);a.__decorate([w.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],c.prototype,
"rows",void 0);a.__decorate([w.property({type:Number,json:{write:!0}})],c.prototype,"scale",void 0);return c=r=a.__decorate([e.subclass("esri.layers.support.LOD")],c)})},"esri/layers/support/TileKey":function(){define(["exports"],function(a){class c{constructor(w,v,C,z,e){this.id=w;this.level=v;this.row=C;this.col=z;this.extent=e}}a.TileKey=c;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/Query":function(){define("../../chunks/tslib.es6 ../../geometry ../../TimeExtent ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../core/accessorSupport/ensureType ../../geometry/support/jsonUtils ../../layers/support/source/DataLayerSource ./FullTextSearch ./QuantizationParameters ./spatialRelationships ./StatisticDefinition ../../geometry/SpatialReference ../../geometry/Point".split(" "),
function(a,c,w,v,C,z,e,r,d,u,A,x,E,m,h,b,n,p,D,M){var g;v=new v.JSONMap({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let J=g=class extends C.JSONSupport{static from(R){return x.ensureClass(g,R)}constructor(R){super(R);this.aggregateIds=null;this.cacheHint=void 0;this.compactGeometryEnabled=!1;this.datumTransformation=null;this.defaultSpatialReferenceEnabled=
!1;this.dynamicDataSource=this.distance=void 0;this.geometry=this.gdbVersion=this.fullText=this.formatOf3DObjects=null;this.geometryPrecision=void 0;this.historicMoment=this.having=this.groupByFieldsForStatistics=null;this.maxAllowableOffset=void 0;this.maxRecordCountFactor=1;this.multipatchOption=null;this.num=void 0;this.resultType=this.relationParameter=this.rangeValues=this.quantizationParameters=this.pixelSize=this.parameterValues=this.outStatistics=this.outSpatialReference=this.outFields=this.orderByFields=
this.objectIds=null;this.returnDistinctValues=this.returnCentroid=!1;this.returnExceededLimitFeatures=!0;this.returnQueryGeometry=this.returnGeometry=!1;this.returnZ=this.returnM=void 0;this.sourceSpatialReference=null;this.spatialRelationship="intersects";this.start=void 0;this.timeExtent=this.text=this.sqlFormat=null;this.timeReferenceUnknownClient=!1;this.where=this.units=null}castDatumTransformation(R){return"number"===typeof R||"object"===typeof R?R:null}writeHistoricMoment(R,B){B.historicMoment=
R&&R.getTime()}writeParameterValues(R,B){if(R){const F={};for(const N in R){const T=R[N];Array.isArray(T)?F[N]=T.map(y=>y instanceof Date?y.getTime():y):F[N]=T instanceof Date?T.getTime():T}B.parameterValues=F}}writeStart(R,B){B.resultOffset=this.start;B.resultRecordCount=this.num||10;B.where="1\x3d1"}writeWhere(R,B){B.where=R||"1\x3d1"}clone(){return new g(z.clone({aggregateIds:this.aggregateIds,cacheHint:this.cacheHint,compactGeometryEnabled:this.compactGeometryEnabled,datumTransformation:this.datumTransformation,
defaultSpatialReferenceEnabled:this.defaultSpatialReferenceEnabled,distance:this.distance,fullText:this.fullText,formatOf3DObjects:this.formatOf3DObjects,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:null!=this.historicMoment?new Date(this.historicMoment.getTime()):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,
num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,
returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,dynamicDataSource:this.dynamicDataSource,sourceSpatialReference:this.sourceSpatialReference,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,timeReferenceUnknownClient:this.timeReferenceUnknownClient,units:this.units,where:this.where}))}};J.MAX_MAX_RECORD_COUNT_FACTOR=5;a.__decorate([e.property({json:{write:!0}})],
J.prototype,"aggregateIds",void 0);a.__decorate([e.property({type:Boolean,json:{write:!0}})],J.prototype,"cacheHint",void 0);a.__decorate([e.property({type:Boolean,json:{default:!1,write:!0}})],J.prototype,"compactGeometryEnabled",void 0);a.__decorate([e.property({json:{write:!0}})],J.prototype,"datumTransformation",void 0);a.__decorate([r.cast("datumTransformation")],J.prototype,"castDatumTransformation",null);a.__decorate([e.property({type:Boolean,json:{default:!1,write:!0}})],J.prototype,"defaultSpatialReferenceEnabled",
void 0);a.__decorate([e.property({type:Number,json:{write:{overridePolicy(R){return{enabled:0<R}}}}})],J.prototype,"distance",void 0);a.__decorate([e.property({type:m.DataLayerSource,json:{write:!0}})],J.prototype,"dynamicDataSource",void 0);a.__decorate([e.property({type:String,json:{write:!0}})],J.prototype,"formatOf3DObjects",void 0);a.__decorate([e.property({type:[h],json:{write:{enabled:!0,overridePolicy(){return{enabled:null!=this.fullText&&0<this.fullText.length}}}}})],J.prototype,"fullText",
void 0);a.__decorate([e.property({type:String,json:{write:!0}})],J.prototype,"gdbVersion",void 0);a.__decorate([e.property({types:c.geometryTypes,json:{read:E.fromJSON,write:!0}})],J.prototype,"geometry",void 0);a.__decorate([e.property({type:Number,json:{write:!0}})],J.prototype,"geometryPrecision",void 0);a.__decorate([e.property({type:[String],json:{write:!0}})],J.prototype,"groupByFieldsForStatistics",void 0);a.__decorate([e.property({type:String,json:{write:!0}})],J.prototype,"having",void 0);
a.__decorate([e.property({type:Date})],J.prototype,"historicMoment",void 0);a.__decorate([A.writer("historicMoment")],J.prototype,"writeHistoricMoment",null);a.__decorate([e.property({type:Number,json:{write:!0}})],J.prototype,"maxAllowableOffset",void 0);a.__decorate([e.property({type:Number,cast(R){return 1>R?1:R>J.MAX_MAX_RECORD_COUNT_FACTOR?J.MAX_MAX_RECORD_COUNT_FACTOR:R},json:{write:{overridePolicy(R){return{enabled:1<R}}}}})],J.prototype,"maxRecordCountFactor",void 0);a.__decorate([e.property({type:["xyFootprint"],
json:{write:!0}})],J.prototype,"multipatchOption",void 0);a.__decorate([e.property({type:Number,json:{read:{source:"resultRecordCount"}}})],J.prototype,"num",void 0);a.__decorate([e.property({json:{write:!0}})],J.prototype,"objectIds",void 0);a.__decorate([e.property({type:[String],json:{write:!0}})],J.prototype,"orderByFields",void 0);a.__decorate([e.property({type:[String],json:{write:!0}})],J.prototype,"outFields",void 0);a.__decorate([e.property({type:D,json:{name:"outSR",write:!0}})],J.prototype,
"outSpatialReference",void 0);a.__decorate([e.property({type:[p],json:{write:{enabled:!0,overridePolicy(){return{enabled:null!=this.outStatistics&&0<this.outStatistics.length}}}}})],J.prototype,"outStatistics",void 0);a.__decorate([e.property({json:{write:!0}})],J.prototype,"parameterValues",void 0);a.__decorate([A.writer("parameterValues")],J.prototype,"writeParameterValues",null);a.__decorate([e.property({type:M,json:{write:!0}})],J.prototype,"pixelSize",void 0);a.__decorate([e.property({type:b,
json:{write:!0}})],J.prototype,"quantizationParameters",void 0);a.__decorate([e.property({type:[Object],json:{write:!0}})],J.prototype,"rangeValues",void 0);a.__decorate([e.property({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy(){return{enabled:"relation"===this.spatialRelationship}}}}})],J.prototype,"relationParameter",void 0);a.__decorate([e.property({type:String,json:{write:!0}})],J.prototype,"resultType",void 0);a.__decorate([e.property({type:Boolean,
json:{default:!1,write:!0}})],J.prototype,"returnCentroid",void 0);a.__decorate([e.property({type:Boolean,json:{default:!1,write:!0}})],J.prototype,"returnDistinctValues",void 0);a.__decorate([e.property({type:Boolean,json:{default:!0,write:!0}})],J.prototype,"returnExceededLimitFeatures",void 0);a.__decorate([e.property({type:Boolean,json:{write:!0}})],J.prototype,"returnGeometry",void 0);a.__decorate([e.property({type:Boolean,json:{default:!1,write:!0}})],J.prototype,"returnQueryGeometry",void 0);
a.__decorate([e.property({type:Boolean,json:{default:!1,write:!0}})],J.prototype,"returnM",void 0);a.__decorate([e.property({type:Boolean,json:{write:{overridePolicy(R){return{enabled:R}}}}})],J.prototype,"returnZ",void 0);a.__decorate([e.property({type:D,json:{write:!0}})],J.prototype,"sourceSpatialReference",void 0);a.__decorate([d.enumeration(n.spatialRelKebabDict,{ignoreUnknown:!1,name:"spatialRel"})],J.prototype,"spatialRelationship",void 0);a.__decorate([e.property({type:Number,json:{read:{source:"resultOffset"}}})],
J.prototype,"start",void 0);a.__decorate([A.writer("start"),A.writer("num")],J.prototype,"writeStart",null);a.__decorate([e.property({type:String,json:{write:!0}})],J.prototype,"sqlFormat",void 0);a.__decorate([e.property({type:String,json:{write:!0}})],J.prototype,"text",void 0);a.__decorate([e.property({type:w,json:{write:!0}})],J.prototype,"timeExtent",void 0);a.__decorate([e.property({type:Boolean,json:{default:!1,write:!0}})],J.prototype,"timeReferenceUnknownClient",void 0);a.__decorate([d.enumeration(v,
{ignoreUnknown:!1}),e.property({json:{write:{overridePolicy(R){return{enabled:!!R&&null!=this.distance&&0<this.distance}}}}})],J.prototype,"units",void 0);a.__decorate([e.property({type:String,json:{write:{overridePolicy(R){return{enabled:null!=R||null!=this.start&&0<this.start}}}}})],J.prototype,"where",void 0);a.__decorate([A.writer("where")],J.prototype,"writeWhere",null);return J=g=a.__decorate([u.subclass("esri.rest.support.Query")],J)})},"esri/TimeExtent":function(){define("./chunks/tslib.es6 ./core/JSONSupport ./core/timeUtils ./core/accessorSupport/decorators/property ./core/has ./core/Logger ./core/RandomLCG ./core/accessorSupport/decorators/reader ./core/accessorSupport/decorators/subclass ./core/accessorSupport/decorators/writer ./time/timeZoneUtils".split(" "),
function(a,c,w,v,C,z,e,r,d,u,A){var x;c=x=class extends c.JSONSupport{static get allTime(){return E}static get empty(){return m}static fromArray(h){return new x({start:null!=h[0]?new Date(h[0]):h[0],end:null!=h[1]?new Date(h[1]):h[1]})}constructor(h){super(h);this.start=this.end=null}readEnd(h,b){return null!=b.end?new Date(b.end):null}writeEnd(h,b){b.end=h?.getTime()??null}get isAllTime(){return this.equals(x.allTime)}get isEmpty(){return this.equals(x.empty)}readStart(h,b){return null!=b.start?
new Date(b.start):null}writeStart(h,b){b.start=h?.getTime()??null}clone(){return new x({end:this.end,start:this.start})}equals(h){if(!h)return!1;const b=this.start?.getTime()??this.start,n=this.end?.getTime()??this.end,p=h.start?.getTime()??h.start;h=h.end?.getTime()??h.end;return b===p&&n===h}expandTo(h,b=A.system){if(this.isEmpty||this.isAllTime)return this.clone();let n=this.start;n&&=w.truncateDate(n,h,b);let p=this.end;if(p){const D=w.truncateDate(p,h,b);p=p.getTime()===D.getTime()?D:w.offsetDate(D,
1,h,b)}return new x({start:n,end:p})}intersection(h){if(!h)return this.clone();if(this.isEmpty||h.isEmpty)return x.empty;if(this.isAllTime)return h.clone();if(h.isAllTime)return this.clone();const b=this.start?.getTime()??-Infinity,n=this.end?.getTime()??Infinity,p=h.start?.getTime()??-Infinity;h=h.end?.getTime()??Infinity;let D,M;p>=b&&p<=n?D=p:b>=p&&b<=h&&(D=b);n>=p&&n<=h?M=n:h>=b&&h<=n&&(M=h);return null==D||null==M||isNaN(D)||isNaN(M)?x.empty:new x({start:-Infinity===D?null:new Date(D),end:Infinity===
M?null:new Date(M)})}offset(h,b,n=A.system){if(this.isEmpty||this.isAllTime)return this.clone();const p=new x,{start:D,end:M}=this;null!=D&&(p.start=w.offsetDate(D,h,b,n));null!=M&&(p.end=w.offsetDate(M,h,b,n));return p}toArray(){return this.isEmpty?[void 0,void 0]:[this.start?.getTime()??null,this.end?.getTime()??null]}union(h){if(!h||h.isEmpty)return this.clone();if(this.isEmpty)return h.clone();if(this.isAllTime||h.isAllTime)return E.clone();const b=null!=this.start&&null!=h.start?new Date(Math.min(this.start.getTime(),
h.start.getTime())):null;h=null!=this.end&&null!=h.end?new Date(Math.max(this.end.getTime(),h.end.getTime())):null;return new x({start:b,end:h})}};a.__decorate([v.property({type:Date,json:{write:{allowNull:!0}}})],c.prototype,"end",void 0);a.__decorate([r.reader("end")],c.prototype,"readEnd",null);a.__decorate([u.writer("end")],c.prototype,"writeEnd",null);a.__decorate([v.property({readOnly:!0,json:{read:!1}})],c.prototype,"isAllTime",null);a.__decorate([v.property({readOnly:!0,json:{read:!1}})],
c.prototype,"isEmpty",null);a.__decorate([v.property({type:Date,json:{write:{allowNull:!0}}})],c.prototype,"start",void 0);a.__decorate([r.reader("start")],c.prototype,"readStart",null);a.__decorate([u.writer("start")],c.prototype,"writeStart",null);c=x=a.__decorate([d.subclass("esri.TimeExtent")],c);const E=new c,m=new c({start:void 0,end:void 0});return c})},"esri/layers/support/source/DataLayerSource":function(){define("exports ../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/cast ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/extensions/serializableProperty/reader ../Field ./MapLayerSource ./QueryTableDataSource ./RasterDataSource ./TableDataSource".split(" "),
function(a,c,w,v,C,z,e,r,d,u,A,x,E,m,h,b){function n(){g||=A.createTypeReader({types:p()});return g}function p(){J||={key:"type",base:null,typeMap:{"data-layer":a.DataLayerSource,"map-layer":E.MapLayerSource}};return J}var D,M;w=w.strict()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"});a.JoinTableDataSource=D=class extends v.JSONSupport{constructor(R){super(R);this.type="join-table"}readLeftTableSource(R,B,F){return n()(R,B,F)}castLeftTableSource(R){return u.ensureOneOfType(p(),
R)}readRightTableSource(R,B,F){return n()(R,B,F)}castRightTableSource(R){return u.ensureOneOfType(p(),R)}clone(){const {leftTableKey:R,rightTableKey:B,leftTableSource:F,rightTableSource:N,joinType:T}=this,y={leftTableKey:R,rightTableKey:B,leftTableSource:F?.clone()??void 0,rightTableSource:N?.clone()??void 0,joinType:T};return new D(y)}};c.__decorate([e.enumeration({joinTable:"join-table"})],a.JoinTableDataSource.prototype,"type",void 0);c.__decorate([C.property({type:String,json:{write:!0}})],a.JoinTableDataSource.prototype,
"leftTableKey",void 0);c.__decorate([C.property({type:String,json:{write:!0}})],a.JoinTableDataSource.prototype,"rightTableKey",void 0);c.__decorate([C.property({json:{write:!0}})],a.JoinTableDataSource.prototype,"leftTableSource",void 0);c.__decorate([r.reader("leftTableSource")],a.JoinTableDataSource.prototype,"readLeftTableSource",null);c.__decorate([z.cast("leftTableSource")],a.JoinTableDataSource.prototype,"castLeftTableSource",null);c.__decorate([C.property({json:{write:!0}})],a.JoinTableDataSource.prototype,
"rightTableSource",void 0);c.__decorate([r.reader("rightTableSource")],a.JoinTableDataSource.prototype,"readRightTableSource",null);c.__decorate([z.cast("rightTableSource")],a.JoinTableDataSource.prototype,"castRightTableSource",null);c.__decorate([e.enumeration(w)],a.JoinTableDataSource.prototype,"joinType",void 0);a.JoinTableDataSource=D=c.__decorate([d.subclass("esri.layers.support.source.JoinTableDataSource")],a.JoinTableDataSource);let g=null,J=null;z={key:"type",base:null,typeMap:{"join-table":a.JoinTableDataSource,
"query-table":m.QueryTableDataSource,raster:h.RasterDataSource,table:b.TableDataSource}};a.DataLayerSource=M=class extends v.JSONSupport{constructor(R){super(R);this.type="data-layer"}clone(){const {fields:R,dataSource:B}=this;return new M({fields:R,dataSource:B})}};c.__decorate([e.enumeration({dataLayer:"data-layer"})],a.DataLayerSource.prototype,"type",void 0);c.__decorate([C.property({type:[x],json:{write:!0}})],a.DataLayerSource.prototype,"fields",void 0);c.__decorate([C.property({types:z,json:{write:!0}})],
a.DataLayerSource.prototype,"dataSource",void 0);a.DataLayerSource=M=c.__decorate([d.subclass("esri.layers.support.source.DataLayerSource")],a.DataLayerSource);a.DataLayerSource.from=u.ensureType(a.DataLayerSource);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/Field":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/RandomLCG ../../core/has ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ./domains ./fieldType".split(" "),
function(a,c,w,v,C,z,e,r,d,u,A,x){var E;const m=new c.JSONMap({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});c=E=class extends w.JSONSupport{constructor(h){super(h);
this.alias=null;this.defaultValue=void 0;this.domain=this.description=null;this.editable=!0;this.length=void 0;this.name=null;this.nullable=!0;this.valueType=this.type=null;this.visible=!0}readDescription(h,{description:b}){h=null;try{h=b?JSON.parse(b):null}catch(n){}return h?.value??null}readValueType(h,{description:b}){h=null;try{h=b?JSON.parse(b):null}catch(n){}return h?m.fromJSON(h.fieldValueType):null}clone(){return new E({alias:this.alias,defaultValue:this.defaultValue,description:this.description,
domain:this.domain?.clone()??null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}};a.__decorate([v.property({type:String,json:{write:!0}})],c.prototype,"alias",void 0);a.__decorate([v.property({type:[String,Number],json:{write:{allowNull:!0}}})],c.prototype,"defaultValue",void 0);a.__decorate([v.property()],c.prototype,"description",void 0);a.__decorate([d.reader("description")],c.prototype,"readDescription",
null);a.__decorate([v.property({types:A.types,json:{read:{reader:A.fromJSON},write:!0}})],c.prototype,"domain",void 0);a.__decorate([v.property({type:Boolean,json:{write:!0}})],c.prototype,"editable",void 0);a.__decorate([v.property({type:C.Integer,json:{write:{overridePolicy(h){return{enabled:Number.isFinite(h)}}}}})],c.prototype,"length",void 0);a.__decorate([v.property({type:String,json:{write:!0}})],c.prototype,"name",void 0);a.__decorate([v.property({type:Boolean,json:{write:!0}})],c.prototype,
"nullable",void 0);a.__decorate([r.enumeration(x.kebabDict)],c.prototype,"type",void 0);a.__decorate([v.property()],c.prototype,"valueType",void 0);a.__decorate([d.reader("valueType",["description"])],c.prototype,"readValueType",null);a.__decorate([v.property({type:Boolean,json:{read:!1}})],c.prototype,"visible",void 0);return c=E=a.__decorate([u.subclass("esri.layers.support.Field")],c)})},"esri/layers/support/domains":function(){define("exports ../../core/has ./CodedValueDomain ./Domain ./InheritedDomain ./RangeDomain".split(" "),
function(a,c,w,v,C,z){c={key:"type",base:v,typeMap:{range:z,"coded-value":w,inherited:C}};a.CodedValueDomain=w;a.DomainBase=v;a.InheritedDomain=C;a.RangeDomain=z;a.fromJSON=function(e){if(!e?.type)return null;switch(e.type){case "range":return z.fromJSON(e);case "codedValue":return w.fromJSON(e);case "inherited":return C.fromJSON(e)}return null};a.types=c;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/CodedValueDomain":function(){define("../../chunks/tslib.es6 ../../core/lang ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./CodedValue ./Domain".split(" "),
function(a,c,w,v,C,z,e,r,d){var u;v=u=class extends d{constructor(A){super(A);this.codedValues=null;this.type="coded-value"}getName(A){let x=null;if(this.codedValues){const E=String(A);this.codedValues.some(m=>{String(m.code)===E&&(x=m.name);return!!x})}return x}clone(){return new u({codedValues:c.clone(this.codedValues),name:this.name})}};a.__decorate([w.property({type:[r.CodedValue],json:{write:!0}})],v.prototype,"codedValues",void 0);a.__decorate([z.enumeration({codedValue:"coded-value"})],v.prototype,
"type",void 0);return v=u=a.__decorate([e.subclass("esri.layers.support.CodedValueDomain")],v)})},"esri/layers/support/CodedValue":function(){define("exports ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),function(a,c,w,v,C,z,e,r){var d;a.CodedValue=d=class extends w.JSONSupport{constructor(u){super(u);this.code=this.name=null}clone(){return new d({name:this.name,
code:this.code})}};c.__decorate([v.property({type:String,json:{write:!0}})],a.CodedValue.prototype,"name",void 0);c.__decorate([v.property({type:[String,Number],json:{write:!0}})],a.CodedValue.prototype,"code",void 0);a.CodedValue=d=c.__decorate([r.subclass("esri.layers.support.CodedValue")],a.CodedValue);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/Domain":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),
function(a,c,w,v,C,z,e,r,d){c=new c.JSONMap({inherited:"inherited",codedValue:"coded-value",range:"range"});w=class extends w.JSONSupport{constructor(u){super(u);this.type=this.name=null}};a.__decorate([v.property({type:String,json:{write:!0}})],w.prototype,"name",void 0);a.__decorate([r.enumeration(c)],w.prototype,"type",void 0);return w=a.__decorate([d.subclass("esri.layers.support.Domain")],w)})},"esri/layers/support/InheritedDomain":function(){define("../../chunks/tslib.es6 ../../core/Logger ../../core/has ../../core/RandomLCG ../../core/Error ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./Domain".split(" "),
function(a,c,w,v,C,z,e,r){var d;c=d=class extends r{constructor(u){super(u);this.type="inherited"}clone(){return new d}};a.__decorate([z.enumeration({inherited:"inherited"})],c.prototype,"type",void 0);return c=d=a.__decorate([e.subclass("esri.layers.support.InheritedDomain")],c)})},"esri/layers/support/RangeDomain":function(){define("../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./Domain".split(" "),
function(a,c,w,v,C,z,e,r){var d;w=d=class extends r{constructor(u){super(u);this.minValue=this.maxValue=null;this.type="range"}clone(){return new d({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}};a.__decorate([c.property({json:{type:[Number],read:{source:"range",reader(u,A){return A.range?.[1]}},write:{enabled:!1,overridePolicy(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",writer(u,A,x){A[x]=[this.minValue||0,u]}}}})],w.prototype,"maxValue",void 0);a.__decorate([c.property({json:{type:[Number],
read:{source:"range",reader(u,A){return A.range?.[0]}},write:{target:"range",writer(u,A,x){A[x]=[u,this.maxValue||0]}}}})],w.prototype,"minValue",void 0);a.__decorate([z.enumeration({range:"range"})],w.prototype,"type",void 0);return w=d=a.__decorate([e.subclass("esri.layers.support.RangeDomain")],w)})},"esri/layers/support/source/MapLayerSource":function(){define("exports ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/RandomLCG ../../../core/has ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,c,w,v,C,z,e,r,d){var u;a.MapLayerSource=u=class extends w.JSONSupport{constructor(A){super(A);this.type="map-layer"}clone(){const {mapLayerId:A,gdbVersion:x}=this;return new u({mapLayerId:A,gdbVersion:x})}};c.__decorate([r.enumeration({mapLayer:"map-layer"})],a.MapLayerSource.prototype,"type",void 0);c.__decorate([v.property({type:C.Integer,json:{write:!0}})],a.MapLayerSource.prototype,"mapLayerId",void 0);c.__decorate([v.property({type:String,json:{write:!0}})],a.MapLayerSource.prototype,
"gdbVersion",void 0);a.MapLayerSource=u=c.__decorate([d.subclass("esri.layers.support.source.MapLayerSource")],a.MapLayerSource);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/source/QueryTableDataSource":function(){define("exports ../../../chunks/tslib.es6 ../../../geometry ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ../../../geometry/SpatialReference ../../../geometry/support/typeUtils".split(" "),
function(a,c,w,v,C,z,e,r,d,u,A,x){var E;a.QueryTableDataSource=E=class extends v.JSONSupport{constructor(m){super(m);this.type="query-table"}clone(){const {workspaceId:m,query:h,oidFields:b,spatialReference:n,geometryType:p}=this,D={workspaceId:m,query:h,oidFields:b,spatialReference:n?.clone()??void 0,geometryType:p};return new E(D)}};c.__decorate([d.enumeration({queryTable:"query-table"})],a.QueryTableDataSource.prototype,"type",void 0);c.__decorate([C.property({type:String,json:{write:!0}})],a.QueryTableDataSource.prototype,
"workspaceId",void 0);c.__decorate([C.property({type:String,json:{write:!0}})],a.QueryTableDataSource.prototype,"query",void 0);c.__decorate([C.property({type:String,json:{write:!0}})],a.QueryTableDataSource.prototype,"oidFields",void 0);c.__decorate([C.property({type:A,json:{write:!0}})],a.QueryTableDataSource.prototype,"spatialReference",void 0);c.__decorate([d.enumeration(x.featureGeometryTypeKebabDictionary)],a.QueryTableDataSource.prototype,"geometryType",void 0);a.QueryTableDataSource=E=c.__decorate([u.subclass("esri.layers.support.source.QueryTableDataSource")],
a.QueryTableDataSource);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/source/RasterDataSource":function(){define("exports ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass".split(" "),function(a,c,w,v,C,z,e,r,d){var u;a.RasterDataSource=u=class extends w.JSONSupport{constructor(A){super(A);
this.type="raster"}clone(){const {workspaceId:A,dataSourceName:x}=this;return new u({workspaceId:A,dataSourceName:x})}};c.__decorate([r.enumeration({raster:"raster"})],a.RasterDataSource.prototype,"type",void 0);c.__decorate([v.property({type:String,json:{write:!0}})],a.RasterDataSource.prototype,"dataSourceName",void 0);c.__decorate([v.property({type:String,json:{write:!0}})],a.RasterDataSource.prototype,"workspaceId",void 0);a.RasterDataSource=u=c.__decorate([d.subclass("esri.layers.support.source.RasterDataSource")],
a.RasterDataSource);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/source/TableDataSource":function(){define("exports ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass".split(" "),function(a,c,w,v,C,z,e,r,d){var u;a.TableDataSource=u=class extends w.JSONSupport{constructor(A){super(A);
this.type="table"}clone(){const {workspaceId:A,gdbVersion:x,dataSourceName:E}=this;return new u({workspaceId:A,gdbVersion:x,dataSourceName:E})}};c.__decorate([r.enumeration({table:"table"})],a.TableDataSource.prototype,"type",void 0);c.__decorate([v.property({type:String,json:{write:!0}})],a.TableDataSource.prototype,"workspaceId",void 0);c.__decorate([v.property({type:String,json:{write:!0}})],a.TableDataSource.prototype,"gdbVersion",void 0);c.__decorate([v.property({type:String,json:{write:!0}})],
a.TableDataSource.prototype,"dataSourceName",void 0);a.TableDataSource=u=c.__decorate([d.subclass("esri.layers.support.source.TableDataSource")],a.TableDataSource);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/FullTextSearch":function(){define("../../chunks/tslib.es6 ../../core/Clonable ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),
function(a,c,w,v,C,z,e,r){c=class extends c.ClonableMixin(w.JSONSupport){constructor(d){super(d);this.searchType=this.searchTerm=this.operator=this.onFields=null}};a.__decorate([v.property({type:[String],json:{write:{enabled:!0,overridePolicy(){return{enabled:null!=this.onFields&&0<this.onFields.length}}}}})],c.prototype,"onFields",void 0);a.__decorate([v.property({type:String,json:{write:!0}})],c.prototype,"operator",void 0);a.__decorate([v.property({type:String,json:{write:!0}})],c.prototype,"searchTerm",
void 0);a.__decorate([v.property({type:String,json:{write:!0}})],c.prototype,"searchType",void 0);return c=a.__decorate([r.subclass("esri.rest.support.FullTextSearch")],c)})},"esri/core/Clonable":function(){define("exports ../chunks/tslib.es6 ./Accessor ./has ./lang ./Logger ./maybe ./accessorSupport/PropertyOrigin ./accessorSupport/utils ./accessorSupport/decorators/subclass".split(" "),function(a,c,w,v,C,z,e,r,d,u){v=A=>{A=class extends A{clone(){var x=d.getProperties(this);e.assertIsSome(x,"unable to clone instance of non-accessor class");
var E=x.metadata;const m=x.store,h={};x=new Map;for(var b in E){var n=E[b];const p=m?.originOf(b),D=n.clonable;if(n.readOnly||!1===D||p!==r.OriginId.USER&&p!==r.OriginId.DEFAULTS&&p!==r.OriginId.WEB_MAP&&p!==r.OriginId.WEB_SCENE)continue;n=this[b];let M=null;M="function"===typeof D?D(n):"reference"===D?n:C.tryClone(n);if(null==n||null!=M)p===r.OriginId.DEFAULTS?x.set(b,M):h[b]=M}E=new (Object.getPrototypeOf(this).constructor)(h);if(x.size&&(b=d.getProperties(E)?.store))for(const [p,D]of x)b.set(p,
D,r.OriginId.DEFAULTS);return E}};return A=c.__decorate([u.subclass("esri.core.Clonable")],A)};a.Clonable=class extends v(w){};a.Clonable=c.__decorate([u.subclass("esri.core.Clonable")],a.Clonable);a.ClonableMixin=v;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/QuantizationParameters":function(){define("../../chunks/tslib.es6 ../../geometry ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/subclass ../../geometry/Extent".split(" "),
function(a,c,w,v,C,z,e,r,d,u){var A;c=new w.JSONMap({upperLeft:"upper-left",lowerLeft:"lower-left"});v=A=class extends v.JSONSupport{constructor(x){super(x);this.extent=null;this.mode="view";this.originPosition="upper-left";this.tolerance=1}clone(){return new A(C.clone({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))}};a.__decorate([z.property({type:u,json:{write:{overridePolicy(){return{enabled:"view"===this.mode}}}}})],v.prototype,"extent",void 0);
a.__decorate([z.property({type:["view","edit"],json:{write:!0}})],v.prototype,"mode",void 0);a.__decorate([z.property({type:String,json:{read:c.read,write:c.write}})],v.prototype,"originPosition",void 0);a.__decorate([z.property({type:Number,json:{write:{overridePolicy(){return{enabled:"view"===this.mode}}}}})],v.prototype,"tolerance",void 0);return v=A=a.__decorate([d.subclass("esri.rest.support.QuantizationParameters")],v)})},"esri/rest/support/spatialRelationships":function(){define(["exports",
"../../core/jsonMap"],function(a,c){c=new c.JSONMap({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"});a.spatialRelKebabDict=c;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/rest/support/StatisticDefinition":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer".split(" "),function(a,c,w,v,C,z,e,r,d){var u;c=new c.JSONMap({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",
percentile_disc:"percentile-discrete",EnvelopeAggregate:"envelope-aggregate",CentroidAggregate:"centroid-aggregate",ConvexHullAggregate:"convex-hull-aggregate"});w=u=class extends w.JSONSupport{constructor(A){super(A);this.maxVertexCount=this.maxRecordCount=this.maxPointCount=void 0;this.statisticParameters=this.statisticType=this.outStatisticFieldName=this.onStatisticField=null}writeStatisticParameters(A,x){if("percentile-continuous"===this.statisticType||"percentile-discrete"===this.statisticType)x.statisticParameters=
v.clone(A)}clone(){return new u({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType,statisticParameters:v.clone(this.statisticParameters)})}};a.__decorate([C.property({type:Number,json:{write:!0}})],w.prototype,"maxPointCount",void 0);a.__decorate([C.property({type:Number,json:{write:!0}})],w.prototype,"maxRecordCount",void 0);
a.__decorate([C.property({type:Number,json:{write:!0}})],w.prototype,"maxVertexCount",void 0);a.__decorate([C.property({type:String,json:{write:!0}})],w.prototype,"onStatisticField",void 0);a.__decorate([C.property({type:String,json:{write:!0}})],w.prototype,"outStatisticFieldName",void 0);a.__decorate([C.property({type:String,json:{read:{source:"statisticType",reader:c.read},write:{target:"statisticType",writer:c.write}}})],w.prototype,"statisticType",void 0);a.__decorate([C.property({type:Object})],
w.prototype,"statisticParameters",void 0);a.__decorate([d.writer("statisticParameters")],w.prototype,"writeStatisticParameters",null);return w=u=a.__decorate([r.subclass("esri.rest.support.StatisticDefinition")],w)})},"esri/symbols/support/ElevationInfo":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ./FeatureExpressionInfo ./unitConversionUtils".split(" "),
function(a,c,w,v,C,z,e,r,d,u,A,x,E){var m;z=c.strict()({onTheGround:"on-the-ground",relativeToGround:"relative-to-ground",relativeToScene:"relative-to-scene",absoluteHeight:"absolute-height"});c=new c.JSONMap({foot:"feet",kilometer:"kilometers",meter:"meters",mile:"miles","us-foot":"us-feet",yard:"yards"});w=m=class extends w.JSONSupport{constructor(h){super(h);this.offset=null}readFeatureExpressionInfo(h,b){if(null!=h)return h;if(b.featureExpression&&0===b.featureExpression.value)return{expression:"0"}}writeFeatureExpressionInfo(h,
b,n,p){b[n]=h.write({},p);"0"===h.expression&&(b.featureExpression={value:0})}get mode(){const {offset:h,featureExpressionInfo:b}=this;return this._isOverridden("mode")?this._get("mode"):null!=h||b?"relative-to-ground":"on-the-ground"}set mode(h){this._override("mode",h)}set unit(h){this._set("unit",h)}write(h,b){return this.offset||this.mode||this.featureExpressionInfo||this.unit?super.write(h,b):null}clone(){return new m({mode:this.mode,offset:this.offset,featureExpressionInfo:this.featureExpressionInfo?
this.featureExpressionInfo.clone():void 0,unit:this.unit})}equals(h){return this.mode===h.mode&&this.offset===h.offset&&this.unit===h.unit&&v.equalsMaybe(this.featureExpressionInfo,h.featureExpressionInfo)}};a.__decorate([C.property({type:x,json:{write:!0}})],w.prototype,"featureExpressionInfo",void 0);a.__decorate([d.reader("featureExpressionInfo",["featureExpressionInfo","featureExpression"])],w.prototype,"readFeatureExpressionInfo",null);a.__decorate([A.writer("featureExpressionInfo",{featureExpressionInfo:{type:x},
"featureExpression.value":{type:[0]}})],w.prototype,"writeFeatureExpressionInfo",null);a.__decorate([C.property({type:z.apiValues,nonNullable:!0,json:{type:z.jsonValues,read:z.read,write:{writer:z.write,isRequired:!0}}})],w.prototype,"mode",null);a.__decorate([C.property({type:Number,json:{write:!0}})],w.prototype,"offset",void 0);a.__decorate([C.property({type:E.supportedUnits,json:{type:String,read:c.read,write:c.write}})],w.prototype,"unit",null);return w=m=a.__decorate([u.subclass("esri.symbols.support.ElevationInfo")],
w)})},"esri/symbols/support/FeatureExpressionInfo":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../layers/support/fieldUtils".split(" "),function(a,c,w,v,C,z,e,r){var d;c=d=class extends c.JSONSupport{constructor(u){super(u)}async collectRequiredFields(u,A){return r.collectArcadeFieldNames(u,A,this.expression)}clone(){return new d({expression:this.expression,
title:this.title})}equals(u){return this.expression===u.expression&&this.title===u.title}};a.__decorate([w.property({type:String,json:{write:!0}})],c.prototype,"expression",void 0);a.__decorate([w.property({type:String,json:{write:!0}})],c.prototype,"title",void 0);return c=d=a.__decorate([e.subclass("esri.symbols.support.FeatureExpressionInfo")],c)})},"esri/symbols/support/unitConversionUtils":function(){define(["exports","../../renderers/support/lengthUtils"],function(a,c){const w=function(){const v=
Object.keys(c.meterIn);v.sort();return v}();a.getMetersPerUnit=function(v){return 1/(c.meterIn[v]||1)};a.supportedUnits=w;a.supportsUnit=function(v){return!!v&&null!=c.meterIn[v]};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/lengthUtils":function(){define(["exports","../../core/unitUtils","../../geometry/support/Ellipsoid"],function(a,c,w){c={unknown:1,inches:c.convertUnit(1,"meters","inches"),feet:c.convertUnit(1,"meters","feet"),"us-feet":c.convertUnit(1,
"meters","us-feet"),yards:c.convertUnit(1,"meters","yards"),miles:c.convertUnit(1,"meters","miles"),"nautical-miles":c.convertUnit(1,"meters","nautical-miles"),millimeters:c.convertUnit(1,"meters","millimeters"),centimeters:c.convertUnit(1,"meters","centimeters"),decimeters:c.convertUnit(1,"meters","decimeters"),meters:c.convertUnit(1,"meters","meters"),kilometers:c.convertUnit(1,"meters","kilometers"),"decimal-degrees":1/c.lengthToDegrees(1,"meters",w.earth.radius)};a.meterIn=c;Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/featureSources/snappingCandidateElevationAlignment":function(){define("exports ../../../../core/has ../../../../core/LRUCache ../../../../core/MapUtils ../../../../core/promiseUtils ../../../../core/unitUtils ../../../../symbols/support/unitConversionUtils".split(" "),function(a,c,w,v,C,z,e){function r(E,{x:m,y:h,z:b,spatialReference:n}){return`${E}-${m}-${h}-${b??0}}-wkid:${n?.wkid}`}function d(){return[]}class u{async alignCandidates(E,
m,h){return E}notifyElevationSourceChange(){}}class A{constructor(E,m){this._elevationInfo=E;this._alignPointsInFeatures=m;this._alignmentsCache=new w.LRUCache(1024);this._cacheVersion=0}async alignCandidates(E,m,h){const b=this._elevationInfo;if(null!=b&&"absolute-height"===b.mode&&!b.featureExpressionInfo){{const {offset:n,unit:p}=b;if(null!=n){m=z.getMetersPerVerticalUnitForSR(m);h=e.getMetersPerUnit(p??"meters");m=h/m*n;for(const D of E)switch(D.type){case "edge":D.start.z+=m;D.end.z+=m;continue;
case "vertex":D.target.z+=m}}}return E}return this._alignComputedElevationCandidates(E,m,h)}notifyElevationSourceChange(){this._alignmentsCache.clear();this._cacheVersion++}async _alignComputedElevationCandidates(E,m,h){var b=new Map;for(const J of E)v.getOrCreateMapValue(b,J.objectId,d).push(J);const [n,p,D]=this._prepareQuery(b,m);b=await this._alignPointsInFeatures(n,h);C.throwIfAborted(h);if(D!==this._cacheVersion)return this._alignComputedElevationCandidates(E,m,h);this._applyCacheAndResponse(n,
b,p);const {drapedObjectIds:M,failedObjectIds:g}=b;m=[];for(const J of E)({objectId:E}=J),M.has(E)&&"edge"===J.type&&(J.draped=!0),g.has(E)||m.push(J);return m}_prepareQuery(E,m){const h=[],b=[];for(const [n,p]of E){E=[];for(const D of p)this._addToQueriesOrCachedResult(n,D.target,E,b),"edge"===D.type&&(this._addToQueriesOrCachedResult(n,D.start,E,b),this._addToQueriesOrCachedResult(n,D.end,E,b));0!==E.length&&h.push({objectId:n,points:E})}return[{spatialReference:m.toJSON(),pointsInFeatures:h},b,
this._cacheVersion]}_addToQueriesOrCachedResult(E,m,h,b){E=r(E,m);E=this._alignmentsCache.get(E);null!=E?b.push(new x(m,E)):h.push(m)}_applyCacheAndResponse(E,{elevations:m,drapedObjectIds:h,failedObjectIds:b},n){for(var p of n)p.apply();n=0;p=this._alignmentsCache;for(const {objectId:D,points:M}of E.pointsInFeatures)if(b.has(D))n+=M.length;else{E=!h.has(D);for(const g of M){const J=r(D,g),R=m[n++];g.z=R;E&&p.put(J,R,1)}}}}class x{constructor(E,m){this.point=E;this.z=m}apply(){this.point.z=this.z}}
a.getSnappingCandidateElevationAligner=function(E=!1,m){if(E){const {elevationInfo:h,alignPointsInFeatures:b}=m;return new A(h,b)}return new u};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/featureSources/snappingCandidateElevationFilter":function(){define(["exports","../../../../core/has"],function(a,c){function w(d){return 1>=d.distance}function v(d,u,{x:A,y:x,z:E}){const {start:m,end:h,target:b}=d;if(!d.draped){const D=h.x-m.x;var n=h.y-m.y,p=
h.z-m.z;const M=Math.min(1,Math.max(0,((u.x-m.x)*D+(u.y-m.y)*n+p*(u.z-m.z))/(D*D+n*n+p*p)));n=m.y+n*M;p=m.z+p*M;b.x=m.x+D*M;b.y=n;b.z=p}A=(u.x-b.x)/A;x=(u.y-b.y)/x;u=(u.z-b.z)/E;d.distance=Math.sqrt(A*A+x*x+u*u)}function C(d,u,{x:A,y:x,z:E}){const {target:m}=d;A=(u.x-m.x)/A;x=(u.y-m.y)/x;u=(u.z-m.z)/E;d.distance=Math.sqrt(A*A+x*x+u*u)}function z(d,u){return d.distance-u.distance}class e{filter(d,u){return u}notifyElevationSourceChange(){}}class r{filter(d,u){const {point:A,distance:x}=d;({z:d}=A);
if(null==d||0===u.length)return u;d="number"===typeof x?{x,y:x,z:x}:x;u=this._updateCandidatesTo3D(u,A,d).filter(w);u.sort(z);return u}_updateCandidatesTo3D(d,u,A){for(const x of d)switch(x.type){case "edge":v(x,u,A);continue;case "vertex":C(x,u,A)}return d}}a.getSnappingCandidateElevationFilter=function(d=!1){return d?new r:new e};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/featureSources/symbologySnappingCandidates":function(){define("exports ../../../../core/has ../../../../core/lang ../../../../core/LRUCache ../../../../core/promiseUtils ../../../../core/string".split(" "),
function(a,c,w,v,C,z){function e(u){switch(u.type){case "vertex":const {objectId:A,target:x}=u;return z.numericHash(`${A}-vertex-${x.x}-${x.y}-${x.z??0}`).toString();case "edge":const {objectId:E,start:m,end:h}=u;return z.numericHash(`${E}-edge-${m.x}-${m.y}-${m.z??0}-to-${h.x}-${h.y}-${h.z??0}`).toString();default:return""}}class r{async fetch(){return[]}notifySymbologyChange(){}}class d{constructor(u){this._getSymbologyCandidates=u;this._candidatesCache=new v.LRUCache(1024);this._cacheVersion=0}async fetch(u,
A){if(0===u.length)return[];const x=[],E=[],m=this._candidatesCache;for(var h of u){var b=e(h),n=m.get(b);if(n)for(var p of n)E.push(w.clone(p));else x.push(h),m.put(b,[],1)}if(0===x.length)return E;h=this._cacheVersion;const {candidates:D,sourceCandidateIndices:M}=await this._getSymbologyCandidates(x,A);C.throwIfAborted(A);if(h!==this._cacheVersion)return this.fetch(u,A);u=[];({length:A}=D);for(h=0;h<A;++h)b=D[h],n=e(x[M[h]]),p=m.get(n),p.push(b),m.put(n,p,p.length),u.push(w.clone(b));return E.concat(u)}notifySymbologyChange(){this._candidatesCache.clear();
this._cacheVersion++}}a.getSymbologySnappingCandidatesFetcher=function(u=!1,A){return u?new d(A):new r};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/featureSources/featureServiceSource/FeatureServiceTiledFetcher":function(){define("exports ../../../../../chunks/tslib.es6 ../../../../../core/Accessor ../../../../../core/arrayUtils ../../../../../core/AsyncSequence ../../../../../core/asyncUtils ../../../../../core/handleUtils ../../../../../core/Logger ../../../../../core/promiseUtils ../../../../../core/reactiveUtils ../../../../../core/SetUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/has ../../../../../core/accessorSupport/decorators/subclass ../../../../../core/support/UpdatingHandles ../../../../../geometry/Extent ../../../../../geometry/support/aaBoundingRect ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/support/arcgisLayerUrl ../../../../../rest/query/operations/pbfOptimizedFeatureSet ../../../../../rest/query/operations/query ../../../../../rest/support/Query ./PendingFeatureTile".split(" "),
function(a,c,w,v,C,z,e,r,d,u,A,x,E,m,h,b,n,p,D,M,g,J,R){a.FeatureServiceTiledFetcher=class extends w{get _minimumVerticesPerFeature(){switch(this.store?.featureStore.geometryType){case "esriGeometryPoint":case "esriGeometryMultipoint":return 1;case "esriGeometryPolygon":return 4;case "esriGeometryPolyline":return 2}}get _mandatoryOutFields(){const B=new Set;this.objectIdField&&B.add(this.objectIdField);this.globalIdField&&B.add(this.globalIdField);return B}set outFields(B){const F=this._get("outFields");
B=A.union(B,this._mandatoryOutFields);A.equals(B,F)||(this._set("outFields",B),A.isSubsetOf(B,F)||this.refresh())}get outFields(){return this._get("outFields")??this._mandatoryOutFields}set filter(B){const F=this._get("filter");B=this._filterProperties(B);JSON.stringify(F)!==JSON.stringify(B)&&this._set("filter",B)}set customParameters(B){const F=this._get("customParameters");JSON.stringify(F)!==JSON.stringify(B)&&this._set("customParameters",B)}get _configuration(){return{filter:this.filter,customParameters:this.customParameters,
tileInfo:this.tileInfo,tileSize:this.tileSize}}set tileInfo(B){const F=this._get("tileInfo");F===B||null!=B&&null!=F&&JSON.stringify(B)===JSON.stringify(F)||(this._set("tileInfo",B),this.store.tileInfo=B)}set tileSize(B){this._get("tileSize")!==B&&this._set("tileSize",B)}get updating(){return this.updatingExcludingEdits||this._pendingEdits.updating}get updatingExcludingEdits(){return this._updatingHandles.updating}get hasZ(){return this.store.featureStore.hasZ}constructor(B){super(B);this.suspended=
!0;this.tilesOfInterest=[];this.availability=0;this._pendingTiles=new Map;this._updatingHandles=new h.UpdatingHandles;this._pendingEdits=new C.AsyncSequence;this._pendingEditsAbortController=new AbortController}initialize(){this._initializeFetchExtent();this._updatingHandles.add(()=>this._configuration,()=>this.refresh());this._updatingHandles.add(()=>this.tilesOfInterest,(B,F)=>{v.equals(B,F,({id:N},{id:T})=>N===T)||this._process()},u.sync);this.addHandles(u.when(()=>!this.suspended,()=>this._process()))}destroy(){this._pendingTiles.forEach(B=>
this._deletePendingTile(B));this._pendingTiles.clear();this.store.destroy();this.tilesOfInterest.length=0;this._pendingEditsAbortController.abort();this._pendingEditsAbortController=null;this._updatingHandles.destroy()}refresh(){this.store.refresh();this._pendingTiles.forEach(B=>this._deletePendingTile(B));this._process()}applyEdits(B){this._pendingEdits.push(B,async F=>{if(0!==F.addedFeatures.length||0!==F.updatedFeatures.length||0!==F.deletedFeatures.length){for(const [,N]of this._pendingTiles)N.reset();
F={...F,deletedFeatures:F.deletedFeatures.map(({objectId:N,globalId:T})=>N&&-1!==N?N:this._lookupObjectIdByGlobalId(T))};await this._updatingHandles.addPromise(this.store.processEdits(F,(N,T)=>this._queryFeaturesById(N,T),this._pendingEditsAbortController.signal));this._processPendingTiles()}})}_initializeFetchExtent(){if(this.capabilities.query.supportsExtent&&D.isHostedAgolService(this.url)){var B=z.createTask(async F=>{try{const N=await g.executeQueryForExtent(this.url,new J({where:"1\x3d1",outSpatialReference:this.spatialReference,
cacheHint:this.capabilities.query.supportsCacheHint??void 0}),{query:this._configuration.customParameters,signal:F});this.store.extent=b.fromJSON(N.data?.extent)}catch(N){d.throwIfAbortError(N),r.getLogger(this).warn("Failed to fetch data extent",N)}});this._updatingHandles.addPromise(B.promise.then(()=>this._process()));this.addHandles(e.makeHandle(()=>B.abort()))}}get debugInfo(){return{numberOfFeatures:this.store.featureStore.numFeatures,tilesOfInterest:this.tilesOfInterest,pendingTiles:Array.from(this._pendingTiles.values()).map(B=>
B.debugInfo),storedTiles:this.store.debugInfo}}_process(){this._markTilesNotAlive();this._createPendingTiles();this._deletePendingTiles();this._processPendingTiles()}_markTilesNotAlive(){for(const [,B]of this._pendingTiles)B.alive=!1}_createPendingTiles(){if(!this.suspended){var B=this._collectMissingTilesInfo();this._setAvailability(null==B?1:B.coveredArea/B.fullArea);if(null!=B)for(const {data:F,resolution:N}of B.missingTiles)(B=this._pendingTiles.get(F.id))?(B.resolution=N,B.alive=!0):this._createPendingTile(F,
N)}}_collectMissingTilesInfo(){let B=null;for(let F=this.tilesOfInterest.length-1;0<=F;F--){const N=this.store.process(this.tilesOfInterest[F],(T,y)=>this._verifyTileComplexity(T,y),this.outFields);null==B?B=N:B.prepend(N)}return B}_deletePendingTiles(){for(const [,B]of this._pendingTiles)B.alive||this._deletePendingTile(B)}_processPendingTiles(){const B={fetchCount:(F,N)=>this._fetchCount(F,N),fetchFeatures:(F,N,T)=>this._fetchFeatures(F,N,T),finish:(F,N)=>this._finishPendingTile(F,N),resume:()=>
this._processPendingTiles()};if(this._ensureFetchAllCounts(B))for(const [,F]of this._pendingTiles)this._verifyTileComplexity(this.store.getFeatureCount(F.data),F.resolution)&&this._updatingHandles.addPromise(F.process(B))}_verifyTileComplexity(B,F){return this._verifyVertexComplexity(B)&&this._verifyFeatureDensity(B,F)}_verifyVertexComplexity(B){return 1E6>B*this._minimumVerticesPerFeature}_verifyFeatureDensity(B,F){if(null==this.tileInfo)return!1;F*=this.tileSize;return 1>25/(F*F)*B}_ensureFetchAllCounts(B){let F=
!0;for(const [,N]of this._pendingTiles)N.state.type<R.StateType.FETCHED_COUNT&&this._updatingHandles.addPromise(N.process(B)),N.state.type<=R.StateType.FETCH_COUNT&&(F=!1);return F}_finishPendingTile(B,F){this.store.add(B.data,F);this._deletePendingTile(B);this._updateAvailability()}_updateAvailability(){const B=this._collectMissingTilesInfo();this._setAvailability(null==B?1:B.coveredArea/B.fullArea)}_setAvailability(B){this._set("availability",B)}_createPendingTile(B,F){F=new R.PendingFeatureTile(B,
F);this._pendingTiles.set(B.id,F);return F}_deletePendingTile(B){B.reset();this._pendingTiles.delete(B.data.id)}async _fetchCount(B,F){return this.store.fetchCount(B.data,this.url,this._createCountQuery(B),{query:this.customParameters,timeout:6E5,signal:F})}async _fetchFeatures(B,F,N){let T=0;const y=[];let G=0,k=F;for(;;){const l=this._createFeaturesQuery(B),H=this._setPagingParameters(l,T,k),{features:U,exceededTransferLimit:Q}=await this._queryFeatures(l,N);H&&(T+=l.num);G+=U.length;for(const W of U)y.push(W);
k=F-G;if(!H||!Q||0>=k)return y}}_filterProperties(B){return null==B?{where:"1\x3d1",gdbVersion:void 0,timeExtent:void 0}:{where:B.where||"1\x3d1",timeExtent:B.timeExtent,gdbVersion:B.gdbVersion}}_lookupObjectIdByGlobalId(B){const F=this.globalIdField,N=this.objectIdField;if(null==F)throw Error("Expected globalIdField to be defined");let T=null;this.store.featureStore.forEach(y=>{B===y.attributes[F]&&(T=y.objectId??y.attributes[N])});if(null==T)throw Error(`Expected to find a feature with globalId ${B}`);
return T}_queryFeaturesById(B,F){const N=this._createFeaturesQuery();N.objectIds=B;return this._queryFeatures(N,F)}_queryFeatures(B,F){return this.capabilities.query.supportsFormatPBF?this._queryFeaturesPBF(B,F):this._queryFeaturesJSON(B,F)}async _queryFeaturesPBF(B,F){const {sourceSpatialReference:N}=this;({data:B}=await g.executeQueryPBF(this.url,B,new M.OptimizedFeatureSetParserContext({sourceSpatialReference:N}),{query:this._configuration.customParameters,timeout:6E5,signal:F}));return p.unquantizeOptimizedFeatureSet(B)}async _queryFeaturesJSON(B,
F){const {sourceSpatialReference:N}=this;({data:B}=await g.executeQuery(this.url,B,N,{query:this._configuration.customParameters,timeout:6E5,signal:F}));return p.convertFromFeatureSet(B,this.objectIdField)}_createCountQuery(B){B=this._createBaseQuery(B);this.capabilities.query.supportsCacheHint&&(B.cacheHint=!0);return B}_createFeaturesQuery(B=null){const F=this._createBaseQuery(B);var N=null!=B?.data?this.store.getAttributesForTile(B?.data?.id):null;N=A.union(A.difference(this.outFields,N??new Set),
this._mandatoryOutFields);F.outFields=Array.from(N);F.returnGeometry=!0;null!=B&&(this.capabilities.query.supportsResultType?F.resultType="tile":this.capabilities.query.supportsCacheHint&&(F.cacheHint=!0));return F}_createBaseQuery(B){B=new J({returnZ:this.hasZ,returnM:!1,geometry:null!=this.tileInfo&&null!=B?n.toExtent(B.data.extent,this.tileInfo.spatialReference):void 0});const F=this._configuration.filter;null!=F&&(B.where=F.where,B.gdbVersion=F.gdbVersion,B.timeExtent=F.timeExtent);B.outSpatialReference=
this.spatialReference;return B}_setPagingParameters(B,F,N){if(!this.capabilities.query.supportsPagination)return!1;const {supportsMaxRecordCountFactor:T,supportsCacheHint:y,tileMaxRecordCount:G,maxRecordCount:k,supportsResultType:l}=this.capabilities.query,H=T?J.MAX_MAX_RECORD_COUNT_FACTOR:1,U=H*((l||y)&&G?G:k||2E3);B.start=F;T?(B.maxRecordCountFactor=Math.min(H,Math.ceil(N/U)),B.num=Math.min(N,B.maxRecordCountFactor*U)):B.num=Math.min(N,U);return!0}};c.__decorate([x.property({constructOnly:!0})],
a.FeatureServiceTiledFetcher.prototype,"url",void 0);c.__decorate([x.property({constructOnly:!0})],a.FeatureServiceTiledFetcher.prototype,"objectIdField",void 0);c.__decorate([x.property({constructOnly:!0})],a.FeatureServiceTiledFetcher.prototype,"globalIdField",void 0);c.__decorate([x.property({constructOnly:!0})],a.FeatureServiceTiledFetcher.prototype,"capabilities",void 0);c.__decorate([x.property({constructOnly:!0})],a.FeatureServiceTiledFetcher.prototype,"sourceSpatialReference",void 0);c.__decorate([x.property({constructOnly:!0})],
a.FeatureServiceTiledFetcher.prototype,"spatialReference",void 0);c.__decorate([x.property({constructOnly:!0})],a.FeatureServiceTiledFetcher.prototype,"store",void 0);c.__decorate([x.property({readOnly:!0})],a.FeatureServiceTiledFetcher.prototype,"_minimumVerticesPerFeature",null);c.__decorate([x.property()],a.FeatureServiceTiledFetcher.prototype,"_mandatoryOutFields",null);c.__decorate([x.property()],a.FeatureServiceTiledFetcher.prototype,"outFields",null);c.__decorate([x.property()],a.FeatureServiceTiledFetcher.prototype,
"suspended",void 0);c.__decorate([x.property()],a.FeatureServiceTiledFetcher.prototype,"filter",null);c.__decorate([x.property()],a.FeatureServiceTiledFetcher.prototype,"customParameters",null);c.__decorate([x.property({readOnly:!0})],a.FeatureServiceTiledFetcher.prototype,"_configuration",null);c.__decorate([x.property()],a.FeatureServiceTiledFetcher.prototype,"tileInfo",null);c.__decorate([x.property()],a.FeatureServiceTiledFetcher.prototype,"tileSize",null);c.__decorate([x.property()],a.FeatureServiceTiledFetcher.prototype,
"tilesOfInterest",void 0);c.__decorate([x.property({readOnly:!0})],a.FeatureServiceTiledFetcher.prototype,"updating",null);c.__decorate([x.property({readOnly:!0})],a.FeatureServiceTiledFetcher.prototype,"updatingExcludingEdits",null);c.__decorate([x.property({readOnly:!0})],a.FeatureServiceTiledFetcher.prototype,"availability",void 0);c.__decorate([x.property()],a.FeatureServiceTiledFetcher.prototype,"hasZ",null);a.FeatureServiceTiledFetcher=c.__decorate([m.subclass("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTiledFetcher")],
a.FeatureServiceTiledFetcher);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/AsyncSequence":function(){define(["exports","../chunks/tslib.es6","./Accessor","./accessorSupport/decorators/property","./accessorSupport/decorators/subclass"],function(a,c,w,v,C){a.AsyncSequence=class extends w{constructor(){super(...arguments);this.updating=!1;this._pending=[]}push(z,e){this._pending.push({promise:z,callback:e});1===this._pending.length&&this._process()}_process(){if(this._pending.length){this.updating=
!0;var z=this._pending[0];z.promise.then(e=>z.callback(e)).catch(()=>{}).then(()=>{this._pending.shift();this._process()})}else this.updating=!1}};c.__decorate([v.property()],a.AsyncSequence.prototype,"updating",void 0);a.AsyncSequence=c.__decorate([C.subclass("esri.core.AsyncSequence")],a.AsyncSequence);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/arcgisLayerUrl":function(){define(["exports","../../core/urlUtils","../../chunks/persistableUrlUtils"],function(a,
c,w){function v(x){if(null==x)return null;x=c.urlToObject(x);x=x?.path.match(d)||x?.path.match(u);if(!x)return null;const [,E,m,h,b]=x;x=m.indexOf("/");return{title:z(-1!==x?m.slice(x+1):m),serverType:e[h.toLowerCase()],sublayer:null!=b&&""!==b?parseInt(b,10):null,url:{path:E}}}function C(x){return(x=c.urlToObject(x).path.match(A))?{serviceUrl:x[1],sublayerId:Number(x[2])}:null}function z(x){x=x.replaceAll(/\s*[/_]+\s*/g," ");return x[0].toUpperCase()+x.slice(1)}const e={mapserver:"MapServer",imageserver:"ImageServer",
featureserver:"FeatureServer",knowledgegraphserver:"KnowledgeGraphServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer","3dtilesserver":"3DTilesServer",videoserver:"VideoServer"},r=Object.values(e),d=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${r.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),u=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^/\\n]+)\\/(${r.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),A=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;
a.cleanTitle=z;a.isArcGISUrl=function(x){return d.test(x)};a.isHostedAgolService=function(x){x=c.getOrigin(x,!0);if(!x)return!1;x=x.toLowerCase();return x.endsWith(".arcgis.com")&&(x.startsWith("services")||x.startsWith("tiles")||x.startsWith("features"))};a.isServerOrServicesAGOLUrl=function(x){if(!x)return!1;x=(new c.Url(c.makeAbsolute(x))).authority?.toLowerCase();return"server.arcgisonline.com"===x||"services.arcgisonline.com"===x};a.isWmsServer=function(x){if(!x)return!1;var E=x.toLowerCase();
x=E.includes("/services/");const m=E.includes("/mapserver/wmsserver"),h=E.includes("/imageserver/wmsserver");E=E.includes("/wmsserver");return x&&(m||h||E)};a.parse=v;a.parseNonStandardSublayerUrl=C;a.sanitizeUrl=function(x,E){return x?c.removeTrailingSlash(c.removeQueryParameters(x,E)):x};a.sanitizeUrlWithLayerId=function(x){let {url:E}=x;if(!E)return{url:E};E=c.removeQueryParameters(E,x.logger);const m=c.urlToObject(E),h=v(m.path);let b=void 0;null!=h?(null!=h.sublayer&&null==x.layer.layerId&&(b=
h.sublayer),E=h.url.path):x.nonStandardUrlAllowed&&(x=C(m.path),null!=x&&(E=x.serviceUrl,b=x.sublayerId));return{url:c.removeTrailingSlash(E),layerId:b}};a.serverTypes=r;a.titleFromUrlAndName=function(x,E){const m=[];x&&(x=v(x),null!=x&&x.title&&m.push(x.title));E&&(E=z(E),m.push(E));if(2===m.length){if(m[0].toLowerCase().includes(m[1].toLowerCase()))return m[0];if(m[1].toLowerCase().includes(m[0].toLowerCase()))return m[1]}return m.join(" - ")};a.writeUrlWithLayerId=function(x,E,m,h,b){w.write(E,
h,"url",b);h.url&&null!=x.layerId&&(h.url=c.join(h.url,m,x.layerId.toString()))};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/query/operations/pbfOptimizedFeatureSet":function(){define("exports ../../../core/unitUtils ../../../geometry/support/spatialReferenceUtils ../../../layers/graphics/OptimizedFeature ../../../layers/graphics/OptimizedFeatureSet ../../../layers/graphics/OptimizedGeometry".split(" "),function(a,c,w,v,C,z){const e=["esriGeometryPoint","esriGeometryMultipoint",
"esriGeometryPolyline","esriGeometryPolygon"];class r{constructor(d){this._options=d;this.geometryTypes=e;this._vertexDimension=this._coordinatePtr=0}createFeatureResult(){return new C}prepareFeatures(d){this._vertexDimension=2;d.hasZ&&this._vertexDimension++;d.hasM&&this._vertexDimension++}finishFeatureResult(d){if(d?.features&&d.hasZ&&this._options.sourceSpatialReference&&d.spatialReference&&!w.equals(d.spatialReference,this._options.sourceSpatialReference)&&!d.spatialReference.vcsWkid){var u=c.getMetersPerVerticalUnitForSR(this._options.sourceSpatialReference),
A=c.getMetersPerVerticalUnitForSR(d.spatialReference);u/=A;if(1!==u)for(const x of d.features)if(v.hasGeometry(x))for(d=x.geometry.coords,A=2;A<d.length;A+=3)d[A]*=u}}addFeature(d,u){d.features.push(u)}createFeature(){return new v.OptimizedFeature}createSpatialReference(){return{wkid:0}}createGeometry(){return new z}addField(d,u){d.fields.push(u)}allocateCoordinates(d){d.coords.length=d.lengths.reduce((u,A)=>u+A,0)*this._vertexDimension;this._coordinatePtr=0}addCoordinate(d,u){d.coords[this._coordinatePtr++]=
u}addCoordinatePoint(d,u){d.coords.push(u)}addLength(d,u){d.lengths.push(u)}addQueryGeometry(d,u){d.queryGeometry=u.queryGeometry;d.queryGeometryType=u.queryGeometryType}createPointGeometry(){return new z}}a.OptimizedFeatureSetParserContext=r;a.optimizedGeometryTypes=e;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/query/operations/query":function(){define("exports ../../../request ../../../core/urlUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../../operations/urlUtils ./pbfQueryUtils ./queryZScale".split(" "),
function(a,c,w,v,C,z,e,r,d){function u(m,h){if(h&&"extent"===m.type)return`${m.xmin},${m.ymin},${m.xmax},${m.ymax}`;if(h&&"point"===m.type)return`${m.x},${m.y}`;m=m.toJSON();delete m.spatialReference;return JSON.stringify(m)}function A(m,h){const b=m.geometry,n=m.toJSON();delete n.compactGeometryEnabled;delete n.defaultSpatialReferenceEnabled;let p,D,M;null!=b&&(D=b.spatialReference,M=z.srToRESTValue(D),n.geometryType=v.getJsonType(b),n.geometry=u(b,m.compactGeometryEnabled),n.inSR=M);n.groupByFieldsForStatistics&&
(n.groupByFieldsForStatistics=n.groupByFieldsForStatistics.join(","));n.objectIds&&(n.objectIds=n.objectIds.join(","));n.orderByFields&&(n.orderByFields=n.orderByFields.join(","));!n.outFields||!n.returnDistinctValues&&(h?.returnCountOnly||h?.returnExtentOnly||h?.returnIdsOnly)?delete n.outFields:n.outFields.includes("*")?n.outFields="*":n.outFields=n.outFields.join(",");n.outSR?(n.outSR=z.srToRESTValue(n.outSR),p=m.outSpatialReference):b&&(n.returnGeometry||n.returnCentroid)&&(n.outSR=n.inSR,p=D);
n.returnGeometry&&delete n.returnGeometry;n.outStatistics&&(n.outStatistics=JSON.stringify(n.outStatistics));n.fullText&&(n.fullText=JSON.stringify(n.fullText));n.pixelSize&&(n.pixelSize=JSON.stringify(n.pixelSize));n.quantizationParameters&&(m.defaultSpatialReferenceEnabled&&null!=D&&null!=m.quantizationParameters?.extent&&D.equals(m.quantizationParameters.extent.spatialReference)&&delete n.quantizationParameters.extent.spatialReference,n.quantizationParameters=JSON.stringify(n.quantizationParameters));
n.parameterValues&&(n.parameterValues=JSON.stringify(n.parameterValues));n.rangeValues&&(n.rangeValues=JSON.stringify(n.rangeValues));n.dynamicDataSource&&(n.layer=JSON.stringify({source:n.dynamicDataSource}),delete n.dynamicDataSource);if(n.timeExtent){const {start:g,end:J}=n.timeExtent;if(null!=g||null!=J)n.time=g===J?g:`${null==g?"null":g},${null==J?"null":J}`;delete n.timeExtent}m.defaultSpatialReferenceEnabled&&null!=D&&null!=p&&D.equals(p)&&(n.defaultSR=n.inSR,delete n.inSR,delete n.outSR);
return n}function x(m,h,b){return E(m,h,"pbf",b)}async function E(m,h,b,n={},p={}){m="string"===typeof m?w.urlToObject(m):m;var D=(await C.normalizeCentralMeridian(h.geometry?[h.geometry]:[],null,{signal:n.signal}))?.[0];null!=D&&(h=h.clone(),h.geometry=D);D=e.mapParameters({...m.query,f:b,...p,...A(h,p)});return c(w.join(m.path,null==h.formatOf3DObjects||p.returnCountOnly||p.returnExtentOnly||p.returnIdsOnly?"query":"query3d"),{...n,responseType:"pbf"===b?"array-buffer":"json",query:{...D,...n.query}})}
a.encodeGeometry=u;a.executeQuery=async function(m,h,b,n){m=null!=h.timeExtent&&h.timeExtent.isEmpty?{data:{features:[]}}:await E(m,h,"json",n);d.applyFeatureSetZUnitScaling(h,b,m.data);return m};a.executeQueryForCount=function(m,h,b){return null!=h.timeExtent&&h.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):E(m,h,"json",b,{returnIdsOnly:!0,returnCountOnly:!0})};a.executeQueryForExtent=async function(m,h,b){if(null!=h.timeExtent&&h.timeExtent.isEmpty)return{data:{count:0,extent:null}};m=await E(m,
h,"json",b,{returnExtentOnly:!0,returnCountOnly:!0});h=m.data;if(h.hasOwnProperty("extent"))return m;if(h.features)throw Error("Layer does not support extent calculation.");if(h.hasOwnProperty("count"))throw Error("Layer does not support extent calculation.");return m};a.executeQueryForIds=function(m,h,b){return null!=h.timeExtent&&h.timeExtent.isEmpty?Promise.resolve({data:{objectIds:[]}}):E(m,h,"json",b,{returnIdsOnly:!0})};a.executeQueryPBF=async function(m,h,b,n){if(null!=h.timeExtent&&h.timeExtent.isEmpty)return{data:b.createFeatureResult()};
m=await x(m,h,n);m.data=r.parsePBFFeatureQuery(m.data,b);return m};a.executeQueryPBFBuffer=x;a.queryToQueryStringParameters=A;a.runQuery=E;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/operations/urlUtils":function(){define(["exports"],function(a){function c(w){const v={};for(const C in w){if("declaredClass"===C)continue;const z=w[C];if(null!=z&&"function"!==typeof z)if(Array.isArray(z)){v[C]=[];for(let e=0;e<z.length;e++)v[C][e]=c(z[e])}else"object"===typeof z?z.toJSON&&
(v[C]=JSON.stringify(z)):v[C]=z}return v}a.mapParameters=c;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/query/operations/pbfQueryUtils":function(){define(["exports","./pbfFeatureServiceParser"],function(a,c){a.parsePBFFeatureQuery=function(w,v){var C=c.parseFeatureQuery(w,v);w=C.queryResult.featureResult;v=C.queryResult.queryGeometry;C=C.queryResult.queryGeometryType;if(w&&w.features&&w.features.length&&w.objectIdFieldName){const z=w.objectIdFieldName;for(const e of w.features)e.attributes&&
(e.objectId=e.attributes[z])}w&&(w.queryGeometry=v,w.queryGeometryType=C);return w};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/query/operations/pbfFeatureServiceParser":function(){define(["exports","../../../core/Error","../../../core/pbf","../../../layers/graphics/OptimizedGeometry","./pbfOptimizedFeatureSet"],function(a,c,w,v,C){function z(B){return B>=g.length?null:g[B]}function e(B,F,N){B=B.asUnsafe();for(N=F.createPointGeometry(N);B.next();)switch(B.tag()){case 3:var T=
B.getUInt32();T=B.pos()+T;let y=0;for(;B.pos()<T;)F.addCoordinatePoint(N,B.getSInt64(),y++);break;default:B.skip()}return N}function r(B,F,N){B=B.asUnsafe();const T=F.createGeometry(N);for(N=2+(N.hasZ?1:0)+(N.hasM?1:0);B.next();)switch(B.tag()){case 2:var y=B.getUInt32();y=B.pos()+y;for(var G=0;B.pos()<y;)F.addLength(T,B.getUInt32(),G++);break;case 3:y=B.getUInt32();y=B.pos()+y;G=0;for(F.allocateCoordinates(T);B.pos()<y;)F.addCoordinate(T,B.getSInt64(),G),G++,G===N&&(G=0);break;default:B.skip()}return T}
function d(B){B=B.asUnsafe();const F=new v;let N="esriGeometryPoint";for(;B.next();)switch(B.tag()){case 2:var T=B.getUInt32();for(T=B.pos()+T;B.pos()<T;)F.lengths.push(B.getUInt32());break;case 3:T=B.getUInt32();for(T=B.pos()+T;B.pos()<T;)F.coords.push(B.getSInt64());break;case 1:N=C.optimizedGeometryTypes[B.getEnum()];break;default:B.skip()}return{queryGeometry:F,queryGeometryType:N}}function u(B){for(B=B.asUnsafe();B.next();)switch(B.tag()){case 1:return B.getString();case 2:return B.getFloat();
case 3:return B.getDouble();case 4:return B.getSInt32();case 5:return B.getUInt32();case 6:return B.getInt64();case 7:return B.getUInt64();case 8:return B.getSInt64();case 9:return B.getBool();default:return B.skip(),null}return null}function A(B){B=B.asUnsafe();const F={type:z(0)};for(;B.next();)switch(B.tag()){case 1:F.name=B.getString();break;case 2:F.type=z(B.getEnum());break;case 3:F.alias=B.getString();break;case 4:var N=B.getEnum();N=N>=J.length?null:J[N];F.sqlType=N;break;case 5:B.skip();
break;case 6:F.defaultValue=B.getString();break;default:B.skip()}return F}function x(B){const F={};for(B=B.asUnsafe();B.next();)switch(B.tag()){case 1:F.name=B.getString();break;case 2:F.isSystemMaintained=B.getBool();break;default:B.skip()}return F}function E(B,F,N,T){const y=F.createFeature(N);let G=0;for(;B.next();)switch(B.tag()){case 1:const k=T[G++].name;y.attributes[k]=B.processMessage(u);break;case 2:y.geometry=B.processMessageWithArgs(r,F,N);break;case 4:y.centroid=B.processMessageWithArgs(e,
F,N);break;default:B.skip()}return y}function m(B){const F=[1,1,1,1];for(B=B.asUnsafe();B.next();)switch(B.tag()){case 1:F[0]=B.getDouble();break;case 2:F[1]=B.getDouble();break;case 4:F[2]=B.getDouble();break;case 3:F[3]=B.getDouble();break;default:B.skip()}return F}function h(B){const F=[0,0,0,0];for(B=B.asUnsafe();B.next();)switch(B.tag()){case 1:F[0]=B.getDouble();break;case 2:F[1]=B.getDouble();break;case 4:F[2]=B.getDouble();break;case 3:F[3]=B.getDouble();break;default:B.skip()}return F}function b(B){const F=
{originPosition:0>=R.length?null:R[0]};for(B=B.asUnsafe();B.next();)switch(B.tag()){case 1:var N=B.getEnum();F.originPosition=N>=R.length?null:R[N];break;case 2:F.scale=B.processMessage(m);break;case 3:F.translate=B.processMessage(h);break;default:B.skip()}return F}function n(B){const F={};for(B=B.asUnsafe();B.next();)switch(B.tag()){case 1:F.shapeAreaFieldName=B.getString();break;case 2:F.shapeLengthFieldName=B.getString();break;case 3:F.units=B.getString();break;default:B.skip()}return F}function p(B,
F){for(F=F.createSpatialReference();B.next();)switch(B.tag()){case 1:F.wkid=B.getUInt32();break;case 5:F.wkt=B.getString();break;case 2:F.latestWkid=B.getUInt32();break;case 3:F.vcsWkid=B.getUInt32();break;case 4:F.latestVcsWkid=B.getUInt32();break;default:B.skip()}return F}function D(B,F){const N=F.createFeatureResult();B=B.asUnsafe();N.geometryType=0>=F.geometryTypes.length?null:F.geometryTypes[0];let T=!1;for(;B.next();)switch(B.tag()){case 1:N.objectIdFieldName=B.getString();break;case 3:N.globalIdFieldName=
B.getString();break;case 4:N.geohashFieldName=B.getString();break;case 5:N.geometryProperties=B.processMessage(n);break;case 7:var y=B.getEnum();N.geometryType=y>=F.geometryTypes.length?null:F.geometryTypes[y];break;case 8:N.spatialReference=B.processMessageWithArgs(p,F);break;case 10:N.hasZ=B.getBool();break;case 11:N.hasM=B.getBool();break;case 12:N.transform=B.processMessage(b);break;case 9:N.exceededTransferLimit=B.getBool();break;case 13:F.addField(N,B.processMessage(A));break;case 15:T||(F.prepareFeatures(N),
T=!0);F.addFeature(N,B.processMessageWithArgs(E,F,N,N.fields));break;case 2:N.uniqueIdField=B.processMessage(x);break;default:B.skip()}F.finishFeatureResult(N);return N}function M(B,F){const N={};let T=null;for(;B.next();)switch(B.tag()){case 4:T=B.processMessageWithArgs(d);break;case 1:N.featureResult=B.processMessageWithArgs(D,F);break;default:B.skip()}null!=T&&N.featureResult&&F.addQueryGeometry(N,T);return N}const g="esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeString esriFieldTypeDate esriFieldTypeOID esriFieldTypeGeometry esriFieldTypeBlob esriFieldTypeRaster esriFieldTypeGUID esriFieldTypeGlobalID esriFieldTypeXML esriFieldTypeBigInteger esriFieldTypeDateOnly esriFieldTypeTimeOnly esriFieldTypeTimestampOffset".split(" "),
J="sqlTypeBigInt sqlTypeBinary sqlTypeBit sqlTypeChar sqlTypeDate sqlTypeDecimal sqlTypeDouble sqlTypeFloat sqlTypeGeometry sqlTypeGUID sqlTypeInteger sqlTypeLongNVarchar sqlTypeLongVarbinary sqlTypeLongVarchar sqlTypeNChar sqlTypeNVarchar sqlTypeOther sqlTypeReal sqlTypeSmallInt sqlTypeSqlXml sqlTypeTime sqlTypeTimestamp sqlTypeTimestamp2 sqlTypeTinyInt sqlTypeVarbinary sqlTypeVarchar".split(" "),R=["upperLeft","lowerLeft"];a.parseFeatureQuery=function(B,F){try{const N=new w(new Uint8Array(B),new DataView(B));
for(B={};N.next();)switch(N.tag()){case 2:B.queryResult=N.processMessageWithArgs(M,F);break;default:N.skip()}return B}catch(N){throw new c("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:N});}};a.parseField=A;a.parseFieldType=z;a.parseTransform=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/query/operations/queryZScale":function(){define(["exports","../../../geometry/support/zscale"],function(a,c){a.applyFeatureSetZUnitScaling=function(w,v,C){if(C?.features&&
C.hasZ&&(w=c.getGeometryZScaler(C.geometryType,v,w.outSpatialReference),null!=w))for(const z of C.features)w(z.geometry)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/featureSources/featureServiceSource/PendingFeatureTile":function(){define(["exports","../../../../../core/asyncUtils","../../../../../geometry/support/aaBoundingRect"],function(a,c,w){class v{constructor(z,e){this.data=z;this.resolution=e;this.state={type:a.StateType.CREATED};this.alive=
!0}process(z){switch(this.state.type){case a.StateType.CREATED:return this.state=this._gotoFetchCount(this.state,z),this.state.task.promise.then(z.resume,z.resume);case a.StateType.FETCHED_COUNT:return this.state=this._gotoFetchFeatures(this.state,z),this.state.task.promise.then(z.resume,z.resume);case a.StateType.FETCHED_FEATURES:this.state=this._goToDone(this.state,z)}return null}get debugInfo(){return{data:this.data,featureCount:this._featureCount,state:this._stateToString}}get _featureCount(){switch(this.state.type){case a.StateType.CREATED:case a.StateType.FETCH_COUNT:return 0;
case a.StateType.FETCHED_COUNT:return this.state.featureCount;case a.StateType.FETCH_FEATURES:return this.state.previous.featureCount;case a.StateType.FETCHED_FEATURES:return this.state.features.length;case a.StateType.DONE:return this.state.previous.features.length}}get _stateToString(){switch(this.state.type){case a.StateType.CREATED:return"created";case a.StateType.FETCH_COUNT:return"fetch-count";case a.StateType.FETCHED_COUNT:return"fetched-count";case a.StateType.FETCH_FEATURES:return"fetch-features";
case a.StateType.FETCHED_FEATURES:return"fetched-features";case a.StateType.DONE:return"done"}}_gotoFetchCount(z,e){return{type:a.StateType.FETCH_COUNT,previous:z,task:c.createTask(async r=>{r=await c.resultOrAbort(e.fetchCount(this,r));this.state.type===a.StateType.FETCH_COUNT&&(this.state={type:a.StateType.FETCHED_COUNT,featureCount:r.ok?r.value:Infinity,previous:this.state})})}}_gotoFetchFeatures(z,e){return{type:a.StateType.FETCH_FEATURES,previous:z,task:c.createTask(async r=>{r=await c.resultOrAbort(e.fetchFeatures(this,
z.featureCount,r));this.state.type===a.StateType.FETCH_FEATURES&&(this.state={type:a.StateType.FETCHED_FEATURES,previous:this.state,features:r.ok?r.value:[]})})}}_goToDone(z,e){e.finish(this,z.features);return{type:a.StateType.DONE,previous:z}}reset(){const z=this.state;this.state={type:a.StateType.CREATED};switch(z.type){case a.StateType.FETCH_COUNT:case a.StateType.FETCH_FEATURES:z.task.abort()}}intersects(z){if(null==z||!this.data.extent)return!0;w.fromExtent(z,C);return w.intersects(this.data.extent,
C)}}a.StateType=void 0;(function(z){z[z.CREATED=0]="CREATED";z[z.FETCH_COUNT=1]="FETCH_COUNT";z[z.FETCHED_COUNT=2]="FETCHED_COUNT";z[z.FETCH_FEATURES=3]="FETCH_FEATURES";z[z.FETCHED_FEATURES=4]="FETCHED_FEATURES";z[z.DONE=5]="DONE"})(a.StateType||(a.StateType={}));const C=w.create();a.PendingFeatureTile=v;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/featureSources/featureServiceSource/FeatureServiceTileStore":function(){define("exports ../../../../../chunks/tslib.es6 ../../../../../core/Accessor ../../../../../core/byteSizeEstimations ../../../../../core/ByteSizeUnit ../../../../../core/has ../../../../../core/SetUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/Logger ../../../../../core/RandomLCG ../../../../../core/accessorSupport/decorators/subclass ../../../../../geometry/support/aaBoundingRect ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/data/BoundsStore ../../../../../layers/support/TileInfo ../../../../../layers/support/TileKey ../../../../../rest/query/operations/query ./FeatureServiceTileCache".split(" "),
function(a,c,w,v,C,z,e,r,d,u,A,x,E,m,h,b,n,p){function D(F){return F.reduce((N,T)=>{var y=T.geometry;if(null==y)y=0;else{var G=v.estimateFixedArraySize(y.lengths,4);y=32+v.estimateFixedArraySize(y.coords,8)+G}T=32+y+v.estimateAttributesObjectSize(T.attributes);return N+T},0)}a.FeatureServiceTileStore=class extends w{constructor(F){super(F);this.extent=this.tileInfo=null;this.maximumByteSize=10*C.ByteSizeUnit.MEGABYTES;this._tileBounds=new m.BoundsStore;this._tiles=new p.FeatureServiceTileCache;this._refCounts=
new Map;this._tileFeatureCounts=new Map;this._tmpBoundingRect=x.create()}add(F,N){for(var T of N)this._referenceFeature(T.objectId);N=this.featureStore.upsertMany(N);T=N.map(y=>new Set(Object.keys(y.attributes))).reduce((y,G)=>e.intersection(y,G),new Set(Object.keys(N[0]?.attributes??[])));this._addTileStorage(F,new Set(N.map(y=>y.objectId)),D(N),T);this._tiles.applyByteSizeLimit(this.maximumByteSize,y=>this._removeTileStorage(y))}getAttributesForTile(F){return F?this._tiles.get(F)?.attributeKeys:
null}destroy(){this.clear();this._tileFeatureCounts.clear()}clear(){this.featureStore.clear();this._tileBounds.clear();this._tiles.clear();this._refCounts.clear()}refresh(){this.clear();this._tileFeatureCounts.clear()}processEdits(F,N,T){this._processEditsDelete(F.deletedFeatures.concat(F.updatedFeatures));return this._processEditsRefetch(F.addedFeatures.concat(F.updatedFeatures),N,T)}_addTileStorage(F,N,T,y){const G=F.id;this._tiles.set(G,new M(F,N,T,y));this._tileBounds.set(G,F.extent);this._tileFeatureCounts.set(G,
N.size)}_remove({id:F}){(F=this._tiles.get(F))&&this._removeTileStorage(F)}_removeTileStorage(F){const N=[];for(const T of F.objectIds)this._unreferenceFeature(T)===B.REMOVED&&N.push(T);this.featureStore.removeManyById(N);F=F.data.id;this._tiles.delete(F);this._tileBounds.delete(F)}_processEditsDelete(F){this.featureStore.removeManyById(F);for(const [,N]of this._tiles){for(const T of F)N.objectIds.delete(T);this._tileFeatureCounts.set(N.data.id,N.objectIds.size)}for(const N of F)this._refCounts.delete(N)}async _processEditsRefetch(F,
N,T){F=(await N(F,T)).features;const {hasZ:y,hasM:G}=this.featureStore;for(const k of F)F=E.getBoundsOptimizedGeometry(this._tmpBoundingRect,k.geometry,y,G),null!=F&&this._tileBounds.forEachInBounds(F,l=>{l=this._tiles.get(l);this.featureStore.add(k);const H=k.objectId;l.objectIds.has(H)||(l.objectIds.add(H),this._referenceFeature(H),this._tileFeatureCounts.set(l.data.id,l.objectIds.size))})}process(F,N=()=>!0,T){if(null==this.tileInfo||!F.extent||null!=this.extent&&!x.intersects(x.fromExtent(this.extent,
this._tmpBoundingRect),F.extent))return new J(F);var y=this.getAttributesForTile(F.id);if(e.isSubsetOf(T,y))return new J(F);y=this._createTileTree(F,this.tileInfo);this._simplify(y,N,null,0,1);return this._collectMissingTiles(F,y,this.tileInfo,T)}get debugInfo(){return Array.from(this._tiles.values()).map(({data:F})=>({data:F,featureCount:this._tileFeatureCounts.get(F.id)||0}))}getFeatureCount(F){return this._tileFeatureCounts.get(F.id)??0}async fetchCount(F,N,T,y){const G=this._tileFeatureCounts.get(F.id);
if(null!=G)return G;N=await n.executeQueryForCount(N,T,y);this._tileFeatureCounts.set(F.id,N.data.count);return N.data.count}_createTileTree(F,N){const T=new g(F.level,F.row,F.col);N.updateTileInfo(T,h.ExtrapolateOptions.POWER_OF_TWO);this._tileBounds.forEachInBounds(F.extent,y=>{y=this._tiles.get(y)?.data;var G;if(!(G=!y)){if(F&&y)if(F.level===y.level)G=F.row===y.row&&F.col===y.col;else{var k=F.level<y.level;G=k?F:y;k=k?y:F;var l=1<<k.level-G.level;G=Math.floor(k.row/l)===G.row&&Math.floor(k.col/
l)===G.col}else G=!1;G=!G}G||this._populateChildren(T,y,N,this._tileFeatureCounts.get(y.id)||0)});return T}_populateChildren(F,N,T,y){var G=N.level-F.level-1;if(0>G)F.isLeaf=!0;else{var k=N.row>>G,l=N.col>>G;G=(k-(F.row<<1)<<1)+(l-(F.col<<1));var H=F.children[G];null!=H?this._populateChildren(H,N,T,y):(k=new g(F.level+1,k,l),T.updateTileInfo(k,h.ExtrapolateOptions.POWER_OF_TWO),F.children[G]=k,this._populateChildren(k,N,T,y))}}_simplify(F,N,T,y,G){const k=G*G;if(F.isLeaf)return N(this.getFeatureCount(F),
G)?0:(this._remove(F),null!=T&&(T.children[y]=null),k);G/=2;const l=G*G;let H=0;for(let U=0;U<F.children.length;U++){const Q=F.children[U];H+=null!=Q?this._simplify(Q,N,F,U,G):l}0===H?this._mergeChildren(F):.18751>1-H/k&&(this._purge(F),null!=T&&(T.children[y]=null),H=k);return H}_mergeChildren(F){const N=new Set;let T=0,y;this._forEachLeaf(F,G=>{const k=this._tiles.get(G.id);if(k){y=y?e.intersection(y,k.attributeKeys):new Set(k.attributeKeys);T+=k.byteSize;for(const l of k.objectIds)N.has(l)||(N.add(l),
this._referenceFeature(l));this._remove(G)}});this._addTileStorage(F,N,T,y??new Set);F.isLeaf=!0;F.children[0]=F.children[1]=F.children[2]=F.children[3]=null;this._tileFeatureCounts.set(F.id,N.size)}_forEachLeaf(F,N){for(const T of F.children)null!=T&&(T.isLeaf?N(T):this._forEachLeaf(T,N))}_purge(F){if(null!=F)if(F.isLeaf)this._remove(F);else for(let N=0;N<F.children.length;N++)this._purge(F.children[N]),F.children[N]=null}_collectMissingTiles(F,N,T,y){F=new R(T,F,this.extent);this._collectMissingTilesRecurse(N,
F,1,y);return F.info}_collectMissingTilesRecurse(F,N,T,y){var G=this.getAttributesForTile(F.id);(G=G&&!e.isSubsetOf(y,G))&&N.addMissing(F.level,F.row,F.col,T);if(!F.isLeaf)if(F.hasChildren)for(T/=2,G=0;G<F.children.length;G++){const k=F.children[G];null==k?N.addMissing(F.level+1,(F.row<<1)+((G&2)>>1),(F.col<<1)+(G&1),T):this._collectMissingTilesRecurse(k,N,T,y)}else G||N.addMissing(F.level,F.row,F.col,T)}_referenceFeature(F){const N=(this._refCounts.get(F)||0)+1;this._refCounts.set(F,N);return 1===
N?B.ADDED:B.UNCHANGED}_unreferenceFeature(F){const N=(this._refCounts.get(F)||0)-1;if(0===N)return this._refCounts.delete(F),B.REMOVED;0<N&&this._refCounts.set(F,N);return B.UNCHANGED}get test(){}};c.__decorate([r.property({constructOnly:!0})],a.FeatureServiceTileStore.prototype,"featureStore",void 0);c.__decorate([r.property()],a.FeatureServiceTileStore.prototype,"tileInfo",void 0);c.__decorate([r.property()],a.FeatureServiceTileStore.prototype,"extent",void 0);c.__decorate([r.property()],a.FeatureServiceTileStore.prototype,
"maximumByteSize",void 0);a.FeatureServiceTileStore=c.__decorate([A.subclass("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTileStore")],a.FeatureServiceTileStore);class M{constructor(F,N,T,y){this.data=F;this.objectIds=N;this.byteSize=T;this.attributeKeys=y}}class g{constructor(F,N,T){this.level=F;this.row=N;this.col=T;this.isLeaf=!1;this.extent=null;this.children=[null,null,null,null]}get hasChildren(){return!this.isLeaf&&(null!=this.children[0]||null!=this.children[1]||
null!=this.children[2]||null!=this.children[3])}}class J{constructor(F,N=[]){this.missingTiles=N;this.coveredArea=this.fullArea=0;this.coveredArea=this.fullArea=x.area(F.extent)}prepend(F){this.missingTiles=F.missingTiles.concat(this.missingTiles);this.coveredArea+=F.coveredArea;this.fullArea+=F.fullArea}}class R{constructor(F,N,T){this._tileInfo=F;this._extent=null;this.info=new J(N);null!=T&&(this._extent=x.fromExtent(T))}addMissing(F,N,T,y){F=new b.TileKey(null,F,N,T);this._tileInfo.updateTileInfo(F,
h.ExtrapolateOptions.POWER_OF_TWO);null==F.extent||null!=this._extent&&!x.intersects(this._extent,F.extent)||(this.info.missingTiles.push({data:F,resolution:y}),this.info.coveredArea-=x.area(F.extent))}}var B;(function(F){F[F.ADDED=0]="ADDED";F[F.REMOVED=1]="REMOVED";F[F.UNCHANGED=2]="UNCHANGED"})(B||={});a.ProcessResult=J;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/ByteSizeUnit":function(){define(["exports"],function(a){a.ByteSizeUnit=void 0;var c=a.ByteSizeUnit||(a.ByteSizeUnit=
{});c[c.KILOBYTES=1024]="KILOBYTES";c[c.MEGABYTES=1048576]="MEGABYTES";c[c.GIGABYTES=1073741824]="GIGABYTES";Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/featureSources/featureServiceSource/FeatureServiceTileCache":function(){define(["exports"],function(a){class c{constructor(){this._store=new Map;this._byteSize=0}set(w,v){this.delete(w);this._store.set(w,v);this._byteSize+=v.byteSize}delete(w){const v=this._store.get(w);return this._store.delete(w)?
(null!=v&&(this._byteSize-=v.byteSize),!0):!1}get(w){this._used(w);return this._store.get(w)}has(w){this._used(w);return this._store.has(w)}clear(){this._store.clear()}applyByteSizeLimit(w,v){for(const [C,z]of this._store){if(this._byteSize<=w)break;this.delete(C);v(z)}}values(){return this._store.values()}[Symbol.iterator](){return this._store[Symbol.iterator]()}_used(w){const v=this._store.get(w);v&&(this._store.delete(w),this._store.set(w,v))}}a.FeatureServiceTileCache=c;Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("../../../../../chunks/tslib.es6 ../../../../../geometry ../../../../../core/Evented ../../../../../core/promiseUtils ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/has ../../../../../core/Logger ../../../../../core/RandomLCG ../../../../../core/accessorSupport/decorators/subclass ../../../../../core/support/UpdatingHandles ../../../../../geometry/SpatialReference ../../../../../layers/graphics/data/FeatureStore ../../../../../layers/graphics/data/QueryEngine ../../../../../layers/support/TileInfo ../../../../../rest/support/Query ../../../../../symbols/support/ElevationInfo ../snappingCandidateElevationAlignment ../snappingCandidateElevationFilter ../symbologySnappingCandidates ./FeatureServiceTiledFetcher ./FeatureServiceTileStore ../../../../../geometry/support/jsonUtils".split(" "),function(a,
c,w,v,C,z,e,r,d,u,A,x,E,m,h,b,n,p,D,M,g,J,R){c=class extends w.EventedAccessor{constructor(){super(...arguments);this._isInitializing=!0;this.remoteClient=null;this._whenSetup=v.createResolver();this._elevationAligner=p.getSnappingCandidateElevationAligner();this._elevationFilter=D.getSnappingCandidateElevationFilter();this._symbologyCandidatesFetcher=M.getSymbologySnappingCandidatesFetcher();this._updatingHandles=new A.UpdatingHandles;this._editsUpdatingHandles=new A.UpdatingHandles;this._pendingApplyEdits=
new Map;this._alignPointsInFeatures=async(F,N)=>{F=await this.remoteClient.invoke("alignElevation",{query:F},{signal:N});v.throwIfAborted(N);return F};this._getSymbologyCandidates=async(F,N)=>{F={candidates:F,spatialReference:this._spatialReference.toJSON()};F=await this.remoteClient.invoke("getSymbologyCandidates",F,{signal:N});v.throwIfAborted(N);return F}}get updating(){return this.updatingExcludingEdits||this._editsUpdatingHandles.updating||this._featureFetcher.updating}get updatingExcludingEdits(){return this._featureFetcher.updatingExcludingEdits||
this._isInitializing||this._updatingHandles.updating}destroy(){this._featureFetcher?.destroy();this._queryEngine?.destroy();this._featureStore?.clear()}async setup(F){if(this.destroyed)return{result:{}};const {geometryType:N,objectIdField:T,timeInfo:y,fieldsIndex:G}=F.serviceInfo;var {hasZ:k}=F;const l=x.fromJSON(F.spatialReference);this._spatialReference=l;this._featureStore=new E({...F.serviceInfo,hasZ:k,hasM:!1});this._queryEngine=new m.QueryEngine({spatialReference:F.spatialReference,featureStore:this._featureStore,
geometryType:N,fieldsIndex:G,hasZ:k,hasM:!1,objectIdField:T,timeInfo:y});this._featureFetcher=new g.FeatureServiceTiledFetcher({store:new J.FeatureServiceTileStore({featureStore:this._featureStore}),url:F.serviceInfo.url,objectIdField:F.serviceInfo.objectIdField,globalIdField:F.serviceInfo.globalIdField,capabilities:F.serviceInfo.capabilities,spatialReference:l,sourceSpatialReference:x.fromJSON(F.serviceInfo.spatialReference),customParameters:F.configuration.customParameters});k="3d"===F.configuration.viewType;
this._elevationAligner=p.getSnappingCandidateElevationAligner(k,{elevationInfo:null!=F.elevationInfo?n.fromJSON(F.elevationInfo):null,alignPointsInFeatures:this._alignPointsInFeatures});this._elevationFilter=D.getSnappingCandidateElevationFilter(k);this.addHandles([C.watch(()=>this._featureFetcher.availability,H=>this.emit("notify-availability",{availability:H}),C.sync),C.watch(()=>this.updating,()=>this._notifyUpdating())]);this._whenSetup.resolve();this._isInitializing=!1;return this.configure(F.configuration)}async configure(F){await this._updatingHandles.addPromise(this._whenSetup.promise);
this._updateFeatureFetcherConfiguration(F);return B}async setSuspended(F,N){await this._updatingHandles.addPromise(this._whenSetup.promise);v.throwIfAborted(N);this._featureFetcher.suspended=F;return B}async updateOutFields(F,N){await this._updatingHandles.addPromise(this._whenSetup.promise);v.throwIfAborted(N);this._featureFetcher.outFields=new Set(F??[]);return B}async fetchCandidates(F,N){await this._whenSetup.promise;v.throwIfAborted(N);if(F.filter){var {distance:T,units:y,spatialRel:G,where:k,
timeExtent:l,objectIds:H}=F.filter;var U={geometry:F.filter.geometry?R.fromJSON(F.filter.geometry):void 0,distance:T,units:y,spatialRel:G,timeExtent:l,objectIds:H,where:k??"1\x3d1"};U={...F,query:U}}else U={...F,query:{where:"1\x3d1"}};N=N?.signal;var Q=await this._queryEngine.executeQueryForSnapping(U,N);v.throwIfAborted(N);F=await this._elevationAligner.alignCandidates(Q.candidates,x.fromJSON(F.point.spatialReference)??x.WGS84,N);v.throwIfAborted(N);Q=await this._symbologyCandidatesFetcher.fetch(F,
N);v.throwIfAborted(N);F=0===Q.length?F:F.concat(Q);return{result:{candidates:this._elevationFilter.filter(U,F)}}}async updateTiles(F,N){await this._updatingHandles.addPromise(this._whenSetup.promise);v.throwIfAborted(N);this._featureFetcher.tileSize=F.tileSize;this._featureFetcher.tilesOfInterest=F.tiles;this._featureFetcher.tileInfo=null!=F.tileInfo?h.fromJSON(F.tileInfo):null;return B}async refresh(F,N){await this._updatingHandles.addPromise(this._whenSetup.promise);v.throwIfAborted(N);this._featureFetcher.refresh();
return B}async whenNotUpdating(F,N){await this._updatingHandles.addPromise(this._whenSetup.promise);v.throwIfAborted(N);await C.whenOnce(()=>!this.updatingExcludingEdits,N);v.throwIfAborted(N);return B}async getDebugInfo(F,N){v.throwIfAborted(N);return{result:this._featureFetcher.debugInfo}}async beginApplyEdits(F,N){this._updatingHandles.addPromise(this._whenSetup.promise);v.throwIfAborted(N);N=v.createResolver();this._pendingApplyEdits.set(F.id,N);this._featureFetcher.applyEdits(N.promise);this._editsUpdatingHandles.addPromise(N.promise);
return B}async endApplyEdits(F,N){const T=this._pendingApplyEdits.get(F.id);T&&T.resolve(F.edits);v.throwIfAborted(N);return B}async notifyElevationSourceChange(F,N){this._elevationAligner.notifyElevationSourceChange();return B}async notifySymbologyChange(F,N){this._symbologyCandidatesFetcher.notifySymbologyChange();return B}async setSymbologySnappingSupported(F){this._symbologyCandidatesFetcher=M.getSymbologySnappingCandidatesFetcher(F,this._getSymbologyCandidates);return B}_updateFeatureFetcherConfiguration(F){this._featureFetcher.filter=
null!=F.filter?b.fromJSON(F.filter):null;this._featureFetcher.customParameters=F.customParameters}_notifyUpdating(){this.emit("notify-updating",{updating:this.updating})}};a.__decorate([z.property({readOnly:!0})],c.prototype,"updating",null);a.__decorate([z.property({readOnly:!0})],c.prototype,"updatingExcludingEdits",null);a.__decorate([z.property()],c.prototype,"_isInitializing",void 0);c=a.__decorate([u.subclass("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceSnappingSourceWorker")],
c);const B={result:{}};return c});
// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.30/esri/copyright.txt for details.
//>>built
define("require exports ../../../../chunks/tslib.es6 ../../../../core/reactiveUtils ../../../../core/scheduling ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../../keybindings ../css ../../../../widgets/Widget ../../../../chunks/componentsUtils ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),function(l,e,f,q,r,g,J,K,L,t,m,u,
v,w,M,c){const d=`${u.base}-editable-field`;var x=`${d}--input`,y=`${d}--feedback`,z=`${d}--read-only`,A=`${d}--locked`,B=`${d}__title`,C=`${d}__value`,p=`${d}__value__content`,D=`${d}__value__content--read-only`,E=`${d}__lock-icon`,F=`${d}__input`,G=`${d}__input-suffix`,H=`${d}__button`;e.TooltipEditableField=class extends v{constructor(){super(...arguments);this._input=null;this._onKeyDown=a=>{if(a.key===m.tooltipKeys.discard&&"input"===this.mode&&this._input)this.context.onDiscard(this._input)};
this._onInputKeyDown=a=>{const b=this._input;if(b)switch(a.key){case m.tooltipKeys.commit:return this.field.onCommit("commit-and-exit",b,this.context);case m.tooltipKeys.next:return a.preventDefault(),a.stopPropagation(),this.field.onCommit(a.shiftKey?"commit-and-previous":"commit-and-next",b,this.context)}};this._onInput=a=>{this.field.onInput(a.target.value)};this._onInputBlur=()=>{const a=this._input;if(a)this.field.onCommit("commit-on-blur",a,this.context)};this._selectText=()=>{const a=()=>{this._input===
document.activeElement&&this._input?.selectText()};a();r.waitAnimationFrame().then(a)}}initialize(){this.addHandles(q.watch(()=>this._rawDisplayValue,()=>{const {committed:a,inputValue:b}=this.field;a||b||this._input!==document.activeElement||this._selectText()}))}loadDependencies(){return w.loadCalciteComponents({button:()=>new Promise((a,b)=>l(["../../../../chunks/calcite-button"],a,b)),icon:()=>new Promise((a,b)=>l(["../../../../chunks/calcite-icon"],a,b)),input:()=>new Promise((a,b)=>l(["../../../../chunks/calcite-input"],
a,b))})}render(){const {field:a,mode:b}=this,n="input"===b,{locked:k,readOnly:h}=a;return c.tsx("div",{class:this.classes({[d]:!0,[y]:"feedback"===b,[x]:"input"===b,[A]:k,[z]:h})},c.tsx("div",{class:B,key:"title"},this._title),c.tsx("div",{class:C,key:"value",onkeydown:this._onKeyDown},n?this._renderValueInputMode():this._renderValueFeedbackMode()))}get _formattedValue(){return this.field.getFormattedValue(this.context)||"\u2014"}get _rawDisplayValue(){return this.field.getRawDisplayValue(this.context)}get _suffix(){return this.field.getSuffix(this.context)}get _title(){const {title:a}=
this.field;return"string"===typeof a?a:a(this.context)}_renderValueFeedbackMode(){return c.tsx(c.tsxFragment,null,c.tsx("div",{class:p,key:"value-feedback"},this._formattedValue),this.field.locked&&"input"!==this.mode?c.tsx("calcite-icon",{class:E,icon:"lock",key:"icon",scale:"s"}):null)}_renderValueInputMode(){return this.field.readOnly?this._renderValueReadOnly():this._renderValueWritable()}_renderValueReadOnly(){return c.tsx("div",{class:this.classes(p,D),key:"value-read-only"},this._formattedValue)}_renderValueWritable(){const {field:a}=
this,{name:b,invalid:n,locked:k}=a;var h=this.context?.messages.sketch??{};h=k?h.unlockConstraint:h.lockConstraint;return c.tsx(c.tsxFragment,null,c.tsx("calcite-input",{afterCreate:I=>{this._input=I},class:F,"data-field-name":b,"data-testid":`tooltip-field-${b}`,onblur:this._onInputBlur,onfocus:this._selectText,onkeydown:this._onInputKeyDown,scale:"s",status:n?"invalid":"idle",type:"text",value:this._rawDisplayValue??"\u2014",onCalciteInputInput:this._onInput}),c.tsx("div",{class:G,key:"suffix"},
this._suffix),a.lockable?c.tsx("calcite-button",{alignment:"center",appearance:"transparent",class:H,"data-testid":`tooltip-field-${b}-lock`,iconStart:k?"lock":"unlock",key:"lock",kind:"neutral",label:h,onclick:()=>{a.toggleLock(this.context)},scale:"s",tabIndex:-1,title:h}):c.tsx("div",{key:"lock-empty"}))}};f.__decorate([g.property()],e.TooltipEditableField.prototype,"field",void 0);f.__decorate([g.property()],e.TooltipEditableField.prototype,"context",void 0);f.__decorate([g.property()],e.TooltipEditableField.prototype,
"mode",void 0);f.__decorate([g.property()],e.TooltipEditableField.prototype,"_input",void 0);f.__decorate([g.property()],e.TooltipEditableField.prototype,"_formattedValue",null);f.__decorate([g.property()],e.TooltipEditableField.prototype,"_rawDisplayValue",null);f.__decorate([g.property()],e.TooltipEditableField.prototype,"_suffix",null);f.__decorate([g.property()],e.TooltipEditableField.prototype,"_title",null);e.TooltipEditableField=f.__decorate([t.subclass("esri.views.interactive.tooltip.components.TooltipEditableField")],
e.TooltipEditableField);Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});
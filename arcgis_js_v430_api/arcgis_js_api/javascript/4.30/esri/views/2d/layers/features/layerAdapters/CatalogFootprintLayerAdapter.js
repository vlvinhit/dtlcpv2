// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.30/esri/copyright.txt for details.
//>>built
define("exports ../../../../../core/lang ../../../../../layers/support/arcgisLayerUrl ./geometryUtils ./labelingUtils ../schema/SourceSchema ../schema/processor/SimpleProcessorSchema ../support/rendererUtils".split(" "),function(q,v,w,x,r,y,z,A){class B{constructor(b){this.layer=b}getLabelingDeconflictionInfo(b){b=this.layer;const a=r.getLayerDeconflictionEnabled(b);return[{vvEvaluators:{0:r.createLabelVVEvaluator(b.renderer)},deconflictionEnabled:a}]}async createServiceOptions(b){var a=this.layer;
const {capabilities:c,editingInfo:e,objectIdField:d,globalIdField:f,datesInUnknownTimezone:k,orderBy:g,parsedUrl:l}=a,m=a.fieldsIndex.toJSON(),n=x.getEffectiveGeometryType(a),p=a.timeInfo?.toJSON();a=a.spatialReference.toJSON();const t=v.clone(l);let u=d;if(g?.length){var h=!g[0].valueExpression&&g[0].field;h&&(u=h)}h=w.isHostedAgolService(t.path);return{type:"feature-service",source:t,isSourceHosted:h,orderByFields:u,outSpatialReference:b.spatialReference.toJSON(),metadata:{timeReferenceUnknownClient:k,
globalIdField:f,fieldsIndex:m,geometryType:n,objectIdField:d,timeInfo:p,spatialReference:a,subtypeField:null,subtypes:null,typeIdField:null,types:null},queryMetadata:{maxRecordCount:c.query.maxRecordCount,supportsCompactGeometry:c.query.supportsCompactGeometry,supportsDefaultSpatialReference:c.query.supportsDefaultSpatialReference,supportsFormatPBF:c.query.supportsFormatPBF,supportsMaxRecordCountFactor:c.query.supportsMaxRecordCountFactor,supportsQuantization:c.query.supportsQuantization,lastEditDate:e?.lastEditDate?.getTime(),
snapshotInfo:null}}}createSourceSchema(b,a){const {definitionExpression:c,customParameters:e,timeExtent:d,apiKey:f}=this.layer;return y.createFeatureSourceSchema({definitionExpression:c,customParameters:e,timeExtent:d},b,a,f)}createProcessorSchema(b,a,c){const {fields:e,geometryType:d,orderBy:f,objectIdField:k,renderer:g,labelingInfo:l,labelsVisible:m}=this.layer,n={featureReduction:null,fields:e.map(p=>p.toJSON()),geometryType:d,labelingInfo:l,labelsVisible:m,objectIdField:k,orderBy:f??"default",
renderer:g?.clone()};return z.createSimpleProcessorSchema(b,a,n,c)}get hasRequiredSupport(){return A.isRendererSupported(this.layer.renderer)}get timeOptions(){return this.layer}getUpdateHashProperties(b){var a=this.layer;const {definitionExpression:c,apiKey:e,renderer:d}=a;b=this.layer.labelsVisible?this.layer.labelingInfo:null;const f=JSON.stringify(a.customParameters);a=JSON.stringify(a.orderBy);return{outFields:this.layer.outFields,apiKey:e,customParameters:f,definitionExpression:c,labelingInfo:b,
orderBy:a,renderer:d}}setGraphicOrigin(b){b.origin={type:"catalog",layer:this.layer}}}q.CatalogFootprintLayerAdapter=B;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})});
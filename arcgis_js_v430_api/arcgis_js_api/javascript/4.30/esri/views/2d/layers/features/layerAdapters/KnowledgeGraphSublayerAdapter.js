// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.30/esri/copyright.txt for details.
//>>built
define("exports ./featureReductionUtils ./geometryUtils ./labelingUtils ../schema/SourceSchema ../schema/processor/SimpleProcessorSchema ../support/rendererUtils".split(" "),function(k,l,m,f,n,p,q){class r{constructor(b){this.layer=b;this.timeOptions=null}getLabelingDeconflictionInfo(b){const a=this.layer;b=f.getFeatureReductionDeconflictionEnabled(a,b)??f.getLayerDeconflictionEnabled(a);return[{vvEvaluators:{0:f.createLabelVVEvaluator(a.renderer)},deconflictionEnabled:b}]}async createServiceOptions(b){const a=
this.layer,{capabilities:c,objectIdField:d}=a,e=a.fieldsIndex.toJSON(),g=m.getEffectiveGeometryType(a),h=a.spatialReference.toJSON();return{type:"memory",source:await a.source.openPorts(),orderByFields:d,outSpatialReference:b.spatialReference.toJSON(),metadata:{fieldsIndex:e,geometryType:g,objectIdField:d,spatialReference:h,globalIdField:null,subtypeField:null,subtypes:null,timeInfo:null,timeReferenceUnknownClient:null,typeIdField:null,types:null},queryMetadata:{maxRecordCount:c.query.maxRecordCount,
supportsCompactGeometry:c.query.supportsCompactGeometry,supportsDefaultSpatialReference:c.query.supportsDefaultSpatialReference,supportsFormatPBF:c.query.supportsFormatPBF,supportsMaxRecordCountFactor:c.query.supportsMaxRecordCountFactor,supportsQuantization:c.query.supportsQuantization,lastEditDate:null,snapshotInfo:null}}}createSourceSchema(b,a){const {definitionExpression:c}=this.layer;return n.createFeatureSourceSchema({definitionExpression:c,customParameters:null},b,a,null)}createProcessorSchema(b,
a,c){const {fields:d,renderer:e,geometryType:g,labelingInfo:h,labelsVisible:t,objectIdField:u}=this.layer,w={fields:d.map(v=>v.toJSON()),renderer:e?.clone(),featureReduction:l.getEffectiveFeatureReduction(this.layer,a),geometryType:g,labelingInfo:h,labelsVisible:t,objectIdField:u,orderBy:"default"};return p.createSimpleProcessorSchema(b,a,w,c)}get hasRequiredSupport(){return q.isRendererSupported(this.layer.renderer)}getUpdateHashProperties(b){const a=this.layer,{definitionExpression:c,renderer:d}=
a,e=this.layer.labelsVisible?this.layer.labelingInfo:null;b=l.getEffectiveFeatureReduction(a,b);return{definitionExpression:c,renderer:d,labelingInfo:e,featureReduction:b}}}k.KnowledgeGraphSublayerAdapter=r;Object.defineProperty(k,Symbol.toStringTag,{value:"Module"})});
// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.30/esri/copyright.txt for details.
//>>built
define("exports ../../../../../core/lang ./featureReductionUtils ./geometryUtils ./labelingUtils ../schema/SourceSchema ../schema/processor/SimpleProcessorSchema ../support/rendererUtils".split(" "),function(n,q,p,r,h,t,u,v){class w{constructor(b){this.layer=b}getLabelingDeconflictionInfo(b){const a=this.layer;b=h.getFeatureReductionDeconflictionEnabled(a,b)??h.getLayerDeconflictionEnabled(a);return[{vvEvaluators:{0:h.createLabelVVEvaluator(a.renderer)},deconflictionEnabled:b}]}async createServiceOptions(b){var a=
this.layer;const {capabilities:d,objectIdField:e}=a,f=a.fieldsIndex.toJSON(),g=r.getEffectiveGeometryType(a),k=a.timeInfo?.toJSON(),l=a.spatialReference.toJSON();a=a.source.getSource();const m=this.layer.objectIdField,c=q.clone(d);c.query.maxRecordCount=a.maxRecordCount;return{type:"ogc",source:a,orderByFields:m,outSpatialReference:b.spatialReference.toJSON(),metadata:{fieldsIndex:f,geometryType:g,objectIdField:e,timeInfo:k,spatialReference:l,globalIdField:null,subtypeField:null,subtypes:null,timeReferenceUnknownClient:null,
typeIdField:null,types:null},queryMetadata:{maxRecordCount:c.query.maxRecordCount,supportsCompactGeometry:c.query.supportsCompactGeometry,supportsDefaultSpatialReference:c.query.supportsDefaultSpatialReference,supportsFormatPBF:c.query.supportsFormatPBF,supportsMaxRecordCountFactor:c.query.supportsMaxRecordCountFactor,supportsQuantization:c.query.supportsQuantization,lastEditDate:null,snapshotInfo:null}}}createSourceSchema(b,a){const {customParameters:d,timeExtent:e,apiKey:f}=this.layer;return t.createFeatureSourceSchema({customParameters:d,
timeExtent:e},b,a,f)}createProcessorSchema(b,a,d){const {fields:e,renderer:f,geometryType:g,labelingInfo:k,labelsVisible:l,orderBy:m,objectIdField:c}=this.layer,y={fields:e.map(x=>x.toJSON()),renderer:f?.clone(),featureReduction:p.getEffectiveFeatureReduction(this.layer,a),geometryType:g,labelingInfo:k,labelsVisible:l,objectIdField:c,orderBy:m??"default"};return u.createSimpleProcessorSchema(b,a,y,d)}get hasRequiredSupport(){return v.isRendererSupported(this.layer.renderer)}get timeOptions(){return this.layer}getUpdateHashProperties(b){var a=
this.layer;const {renderer:d,apiKey:e}=a,f=this.layer.labelsVisible?this.layer.labelingInfo:null,g=JSON.stringify(a.customParameters);b=p.getEffectiveFeatureReduction(a,b);a=JSON.stringify(a.orderBy);return{apiKey:e,customParameters:g,featureReduction:b,labelingInfo:f,orderBy:a,renderer:d}}}n.OGCFeatureLayerAdapter=w;Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})});
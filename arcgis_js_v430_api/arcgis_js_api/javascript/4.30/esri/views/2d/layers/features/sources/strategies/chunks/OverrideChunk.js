// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.30/esri/copyright.txt for details.
//>>built
define(["exports","./ASourceChunk","../../../support/FeatureSetReaderJSON"],function(h,k,l){class m extends k.ASourceChunk{constructor(a,c){super();this.metadata=a;this.removed=new Set;this.overriddenIds=new Set;this._features=[];this.normalizedChunkId=this.chunkId=c}get reader(){return l.FeatureSetReaderJSON.fromOptimizedFeatures(this._features,this.metadata)}get queryInfo(){return{}}get first(){return!1}get end(){return!1}get isTiled(){return!1}applyOverrides(a){super.invalidate();const {reader:c,
removed:d}=a;a=[];const f=new Set;var e=c.getCursor();const n=new Set(d);for(this.overriddenIds.clear();e.next();){const b=e.readOptimizedFeatureWorldSpace(),g=b.objectId;a.push(b);f.add(g);this.overriddenIds.add(g);this.removed.delete(g)}for(const b of this._features)e=b.objectId,n.has(e)||f.has(e)||(a.push(b),this.overriddenIds.add(e));this._features=a;for(const b of f.values())this.removed.delete(b);for(const b of d)this.removed.add(b),this.overriddenIds.add(b)}removeOverrides(a){this.invalidate();
a=a.reader.getCursor();const c=new Set;for(;a.next();){const d=a.getObjectId();this.overriddenIds.has(d)&&(c.add(d),this.overriddenIds.delete(d))}this._features=this._features.filter(d=>!c.has(d.objectId))}getTileReader(a){if(!this._features.length)return null;const c=this.queryFeaturesInBounds(a.bounds);c.setTransformForDisplay(a.transform);return c}}h.OverrideChunk=m;Object.defineProperty(h,Symbol.toStringTag,{value:"Module"})});
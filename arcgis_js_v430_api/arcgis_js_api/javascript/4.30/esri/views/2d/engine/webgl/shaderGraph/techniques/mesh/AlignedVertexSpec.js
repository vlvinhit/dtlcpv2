// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.30/esri/copyright.txt for details.
//>>built
define(["exports","../../../../../../../core/has","./utils","../../../../../../webgl/enums"],function(n,v,u,g){function p(a){switch(a){case g.DataType.BYTE:case g.DataType.UNSIGNED_BYTE:return 1;case g.DataType.SHORT:case g.DataType.UNSIGNED_SHORT:case g.DataType.HALF_FLOAT:return 2;case g.DataType.FLOAT:case g.DataType.INT:case g.DataType.UNSIGNED_INT:return 4}}function q(a){const b=[],e=[],f=[];for(const d of a)switch(a=p(d.type)*d.count,a%2||a%4||4){case 4:b.push(d);continue;case 2:e.push(d);continue;
case 1:f.push(d);continue;default:throw Error("Found unexpected dataType byte count");}b.push(...e);b.push(...f);return b}class r{static fromVertexSpec(a,b){const {attributes:e,optionalAttributes:f}=a;let d,m,t;a=[];for(var c in e){const l=e[c];"position"===l.pack?d={...l,name:c,offset:0}:"id"===l.pack?m={...l,name:c,offset:4}:"bitset"===c?t={...l,name:c,offset:7}:a.push({...l,name:c})}for(var k in f)!0===b[k]&&a.push({...f[k],name:k});a=q(a);b=[];c=8;k=1;for(var h of a)b.push({...h,offset:c}),c+=
p(h.type)*h.count,h.packAlternating&&(k=Math.max(h.packAlternating.count,k));h=Uint32Array.BYTES_PER_ELEMENT;a=c%h;return new r(d,m,t,b,c+(a?h-a:0),k)}constructor(a,b,e,f,d,m){this.position=a;this.id=b;this.bitset=e;this.standardAttributes=f;this.stride=d;this.packVertexCount=m;f.push(e);this._attributes=[a,b,e,...f]}get attributeLayout(){if(!this._attributeLayout){const a=u.vertexLayoutHash(this._attributes);this._attributeLayout={attributes:this._attributes.map(b=>({name:b.name,count:b.count,offset:b.offset,
type:b.type,packPrecisionFactor:b.packPrecisionFactor,normalized:b.normalized??!1})),hash:a,stride:this.stride}}return this._attributeLayout}}n.AlignedVertexSpec=r;n.sortByAlignment=q;Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})});
// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.30/esri/copyright.txt for details.
//>>built
define(["../definitions","../Utils","./WGLBrush","../../../../webgl/enums"],function(g,k,l,c){class m extends l{constructor(){super(...arguments);this._desc={vsPath:"overlay/overlay",fsPath:"overlay/overlay",attributes:new Map([["a_pos",0],["a_uv",1]])}}dispose(){}prepareState({context:a}){a.setBlendingEnabled(!0);a.setColorMask(!0,!0,!0,!0);a.setBlendFunctionSeparate(c.BlendFactor.ONE,c.BlendFactor.ONE_MINUS_SRC_ALPHA,c.BlendFactor.ONE,c.BlendFactor.ONE_MINUS_SRC_ALPHA);a.setStencilWriteMask(0);
a.setStencilTestEnabled(!0);a.setStencilFunction(c.CompareFunction.GREATER,255,255)}draw(a,d){const {context:e,painter:n,requestRender:h,allowDelayedRender:p}=a;if(d.isReady){var {computedOpacity:q,dvsMat3:r,isWrapAround:t,perspectiveTransform:u,texture:v,wrapAroundShift:w}=d;a.timeline.begin(this.name);var b=n.materialManager.getProgram(this._desc);if(p&&null!=h&&!b.compiled)h();else{var f=k.createProgramDescriptor("overlay",{geometry:[{location:0,name:"a_pos",count:2,type:c.DataType.FLOAT}],tex:[{location:1,
name:"a_uv",count:2,type:c.DataType.UNSIGNED_SHORT}]});if(f=d.getVAO(e,f.bufferLayouts,f.attributes))e.bindVAO(f),e.useProgram(b),e.bindTexture(v,g.textureBindingBitmap),b.setUniformMatrix3fv("u_dvsMat3",r),b.setUniform1i("u_texture",g.textureBindingBitmap),b.setUniform1f("u_opacity",q),b.setUniform2fv("u_perspective",u),b.setUniform2fv("u_texSize",d.textureSize),b.setUniform1f("u_wrapAroundShift",0),d.draw(a.context),t&&(b.setUniform1f("u_wrapAroundShift",w),d.draw(a.context)),e.bindVAO(),a.timeline.end(this.name)}}}}
return m});
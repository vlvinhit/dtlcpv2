// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.30/esri/copyright.txt for details.
//>>built
define(["exports","../../../../../../core/unitUtils","../../definitions","../../enums","../../../../../webgl/enums"],function(f,t,g,n,h){function p({pixelRatio:a,state:b,displayLevel:d,requiredLevel:e},c){const k=1/2**(d-c.key.level);e=1/2**(e-c.key.level);return{displayMat3:Array.from(b.displayMat3),displayViewMat3:Array.from(b.displayViewMat3),displayViewScreenMat3:Array.from(c.transforms.displayViewScreenMat3),viewMat3:Array.from(b.viewMat3),tileMat3:Array.from(c.transforms.tileMat3),displayZoomFactor:k,
requiredZoomFactor:e,tileOffset:[c.x,c.y],currentScale:b.scale,currentZoom:d,metersPerSRUnit:t.getMetersPerUnitForSR(b.spatialReference),rotation:b.rotation,pixelRatio:a}}function l(a){return"highlight"===a.passOptions?.type}function m(a){return"hittest"===a.passOptions?.type}const q={color:{write:[!0,!0,!0,!0],blendMode:"composite"},depth:!1,stencil:{write:!1,test:{ref:a=>a.stencilRef,compare:h.CompareFunction.EQUAL,mask:255,op:{fail:h.StencilOperation.KEEP,zFail:h.StencilOperation.KEEP,zPass:h.StencilOperation.REPLACE}}}},
u={color:{write:[!0,!0,!0,!0],blendMode:"additive"},depth:!1,stencil:!1},v={...q,color:{write:[!0,!0,!0,!0],blendMode:"delete"}};f.getFeaturePipelineState=function(a){return m(a)?u:l(a)&&"clear"===a.passOptions.stepType?v:q};f.getFeatureUniforms=function(a,b){const {attributeView:d,context:e}=a;var c=d.getUniforms(e);b=p(a,b);if(m(a)){var {position:k,distance:w,smallSymbolDistance:x,smallSymbolSizeThreshold:y}=a.passOptions;var r={position:k,distance:w,smallSymbolDistance:x,smallSymbolSizeThreshold:y}}else r=
null;if(l(a)){var {activeReasons:z,highlightAll:A}=a.passOptions;a={activeReasons:z,highlightAll:A?1:0}}else a=null;return{storage:c,view:b,hittestRequest:r,highlight:a}};f.getLocalTileOffset=function(a){const {row:b,col:d}=a.key;a=d*g.tileSize;const e=b*g.tileSize;return{tileOffsetFromLocalOrigin:[a%g.maxRepresentableInt,e%g.maxRepresentableInt],maxIntsToLocalOrigin:[Math.floor(a/g.maxRepresentableInt),Math.floor(e/g.maxRepresentableInt)]}};f.getSelectionDefines=function(a){return{inside:a.selection===
n.FeatureSelection.InsideEffect,outside:a.selection===n.FeatureSelection.OutsideEffect}};f.getViewUniforms=p;f.isHighlight=l;f.isHittest=m;f.resolveDynamicUniforms=function(a,b,d){const e={};for(const c in d)e[c]=d[c]instanceof Function?d[c](a,b):d[c];return e};Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})});
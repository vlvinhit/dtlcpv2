// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.30/esri/copyright.txt for details.
//>>built
define("../../chunks/tslib.es6 ../../core/Error ../../core/promiseUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../geometry/Point ../../layers/support/timeSupport ../../rest/support/Query ./support/popupUtils".split(" "),function(c,n,p,e,z,A,B,q,l,r,t,u){return a=>{a=class extends a{constructor(){super(...arguments);this.view=null}get timeExtent(){return r.combineTimeExtent(this.layer,this.view?.timeExtent,
this._get("timeExtent"))}async fetchPopupFeaturesAtLocation(d,h){const {layer:f}=this;if(!d)throw new n("imagerylayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:f});var {popupEnabled:b}=f;const k=u.getFetchPopupTemplate(f,h);if(!b||null==k)return[];const v=await k.getRequiredFields();p.throwIfAborted(h);b=new t;b.timeExtent=this.timeExtent;b.geometry=d;b.outFields=v;b.outSpatialReference=d.spatialReference;const {resolution:g,spatialReference:m}=this.view;d="2d"===this.view.type?
new l(g,g,m):new l(.5*g,.5*g,m);const {returnTopmostRaster:w,showNoDataRecords:x}=k.layerOptions||{returnTopmostRaster:!0,showNoDataRecords:!1};return f.queryVisibleRasters(b,{returnDomainValues:!0,returnTopmostRaster:w,pixelSize:d,showNoDataRecords:x,signal:h?.signal}).then(y=>y)}canResume(){return!super.canResume()||this.timeExtent?.isEmpty?!1:!0}};c.__decorate([e.property()],a.prototype,"layer",void 0);c.__decorate([e.property()],a.prototype,"suspended",void 0);c.__decorate([e.property({readOnly:!0})],
a.prototype,"timeExtent",null);c.__decorate([e.property()],a.prototype,"view",void 0);return a=c.__decorate([q.subclass("esri.views.layers.ImageryLayerView")],a)}});
// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.30/esri/copyright.txt for details.
//>>built
define("../../chunks/tslib.es6 ../../core/Collection ../../core/Evented ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../LayerList/ListItem ../LayerList/support/layerListUtils".split(" "),function(f,c,m,h,g,r,t,u,n,k,p){const l=c.ofType(k);c=class extends m.EventedAccessor{constructor(a){super(a);this.catalogItems=new l;this.checkPublishStatusEnabled=!1;this.listItemCreatedFunction=
this.catalogLayer=null;this.listModeDisabled=!1;this.view=null}initialize(){this.addHandles([h.watch(()=>[this.catalogLayer?.loaded,this.view?.ready],()=>this._compileList(),h.initial),h.on(()=>this.catalogLayer?.dynamicGroupLayer.layers,"change",()=>this._compileList()),h.watch(()=>[this.listItemCreatedFunction,this.checkPublishStatusEnabled,this.listModeDisabled],()=>this._recompileList())])}destroy(){this.view=null;this.catalogItems.removeAll()}get state(){const {view:a,catalogLayer:b}=this;return a?.ready&&
b?.loaded?"ready":a&&b?"loading":"disabled"}get totalItems(){return this.catalogItems.flatten(a=>a.children).length}triggerAction(a,b){a&&!a.disabled&&this.emit("trigger-action",{action:a,item:b})}_createListItem(a){const {view:b,listItemCreatedFunction:d,checkPublishStatusEnabled:e,listModeDisabled:q}=this;return new k({checkPublishStatusEnabled:e,listModeDisabled:q,layer:a,listItemCreatedFunction:d,view:b})}_removeAllItems(){this.catalogItems.removeAll()}_getViewableLayers(a){return a?this.listModeDisabled?
a:a.filter(b=>"hide"!==p.findLayerListMode(b)):void 0}_watchLayersListMode(a){this.removeHandles("layer-list-mode");a&&!this.listModeDisabled&&this.addHandles(h.watch(()=>a.filter(b=>"listMode"in b).map(b=>b.listMode).toArray(),()=>this._compileList()),"layer-list-mode")}_compileList(){var {catalogLayer:a}=this;a?.loaded&&(a=a?.dynamicGroupLayer.layers,this._watchLayersListMode(a),a=this._getViewableLayers(a),a?.length?(this._createNewItems(a),this._removeItems(a),this._sortItems(a)):this._removeAllItems())}_createNewItems(a){const {catalogItems:b}=
this;a.forEach(d=>{b.some(e=>e.layer===d)||b.add(this._createListItem(d))})}_removeItems(a){const {catalogItems:b}=this,d=[];b.forEach(e=>{e&&a?.includes(e.layer)||d.push(e)});b.removeMany(d)}_sortItems(a){const {catalogItems:b}=this;b.sort((d,e)=>{d=a.indexOf(d.layer);e=a.indexOf(e.layer);return d>e?-1:d<e?1:0})}_recompileList(){this._removeAllItems();this._compileList()}};f.__decorate([g.property({type:l})],c.prototype,"catalogItems",void 0);f.__decorate([g.property()],c.prototype,"checkPublishStatusEnabled",
void 0);f.__decorate([g.property()],c.prototype,"catalogLayer",void 0);f.__decorate([g.property()],c.prototype,"listItemCreatedFunction",void 0);f.__decorate([g.property({nonNullable:!0})],c.prototype,"listModeDisabled",void 0);f.__decorate([g.property({readOnly:!0})],c.prototype,"state",null);f.__decorate([g.property()],c.prototype,"totalItems",null);f.__decorate([g.property()],c.prototype,"view",void 0);return c=f.__decorate([n.subclass("esri.widgets.CatalogLayerList.CatalogLayerListViewModel")],
c)});
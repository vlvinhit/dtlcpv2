// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.30/esri/copyright.txt for details.
//>>built
define("require ../../chunks/tslib.es6 ../../core/Identifiable ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../Widget ./support/layerListUtils ../support/widget ../support/jsxFactory".split(" "),function(n,e,c,l,h,f,t,u,v,p,q,r,m,g){c=class extends c.IdentifiableMixin(q){constructor(a,b){super(a,b);this.content=this.className=this._legend=null;this.flowEnabled=
!1;this.listItem=this.image=null;this.open=!1;this.visible=!0}initialize(){this.addHandles([h.watch(()=>this._canCreateLegend,()=>this._createLegend(),h.initial),h.watch(()=>[this._legend,this._legendOptions],()=>this._updateLegend(),h.initial)])}destroy(){this._legend=l.destroyMaybe(this._legend)}get _canCreateLegend(){const {content:a,listItem:b}=this;return b?"legend"===a?!0:null!=a&&(Array.isArray(a)?a.includes("legend"):!1):!1}get _legendOptions(){const {listItem:a,_legendLayerInfo:b}=this,d=
a?.view;return b&&d?{view:d,layerInfos:[b]}:{}}get _legendLayerInfo(){const a=this.listItem?.layer;if(!a||"subtype-sublayer"===a.type)return null;var b=r.isSublayer(a)?a:null;const d=a?.parent;return(b=null!=d&&"type"in d&&"map-image"===d.type?b?.source:null)&&d?{layer:d,title:"",sublayerIds:[b.mapLayerId]}:{layer:a,title:""}}get disabled(){const {listItem:a,_legend:b,content:d}=this;return a?Array.isArray(d)&&1<d.length?!1:b?!b.activeLayerInfos?.length||!a.visibleAtCurrentScale||!a.visible:!1:!0}set disabled(a){this._overrideIfSome("disabled",
a)}get icon(){const {image:a}=this,b=this._getFirstWidget();return this._get("icon")??(!a&&b?b.icon:null)}set icon(a){this._overrideIfSome("icon",a)}get title(){return this._get("title")||(this._getFirstWidget()?.label??"")}set title(a){this._override("title",a)}render(){return g.tsx("div",{class:"esri-list-item-panel"},this._renderContents())}_renderContent(a){const {_legend:b,disabled:d,open:k}=this;return a&&!d&&k?"legend"===a&&b?g.tsx("div",{key:"legend-widget"},b.render()):"string"===typeof a?
g.tsx("div",{innerHTML:a,key:a}):m.isWidget(a)?g.tsx("div",{key:"content-widget"},a.render()):a instanceof HTMLElement?g.tsx("div",{afterCreate:this._attachToNode,bind:a,key:"content-element"}):null:null}_renderContents(){const {content:a,open:b}=this;return b?Array.isArray(a)?a.map(d=>this._renderContent(d)):this._renderContent(a):null}async _createLegend(){l.destroyMaybe(this._legend);this._legend=null;if(this._canCreateLegend){var {default:a}=await new Promise((b,d)=>n(["../Legend"],k=>b(Object.freeze(Object.defineProperty({__proto__:null,
default:k},Symbol.toStringTag,{value:"Module"}))),d));this._legend=new a(this._legendOptions)}}_attachToNode(a){a.appendChild(this)}_updateLegend(){const a=this._legend;a&&a.set(this._legendOptions)}_getWidget(a){return"legend"===a?this._legend:m.isWidget(a)?a:null}_getFirstWidget(){const {content:a}=this;return Array.isArray(a)?a.map(b=>this._getWidget(b)).find(b=>b):this._getWidget(a)}};e.__decorate([f.property()],c.prototype,"_legend",void 0);e.__decorate([f.property()],c.prototype,"_canCreateLegend",
null);e.__decorate([f.property()],c.prototype,"_legendOptions",null);e.__decorate([f.property()],c.prototype,"_legendLayerInfo",null);e.__decorate([f.property()],c.prototype,"className",void 0);e.__decorate([f.property()],c.prototype,"content",void 0);e.__decorate([f.property()],c.prototype,"disabled",null);e.__decorate([f.property()],c.prototype,"flowEnabled",void 0);e.__decorate([f.property()],c.prototype,"icon",null);e.__decorate([f.property()],c.prototype,"image",void 0);e.__decorate([f.property()],
c.prototype,"listItem",void 0);e.__decorate([f.property()],c.prototype,"open",void 0);e.__decorate([f.property()],c.prototype,"title",null);e.__decorate([f.property()],c.prototype,"visible",void 0);return c=e.__decorate([p.subclass("esri.widgets.LayerList.ListItemPanel")],c)});
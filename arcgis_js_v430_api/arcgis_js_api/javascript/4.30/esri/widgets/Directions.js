// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.30/esri/copyright.txt for details.
//>>built
define("require ../chunks/tslib.es6 ../intl ../core/events ../core/handleUtils ../core/maybe ../core/reactiveUtils ../core/string ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/RandomLCG ../core/has ../core/accessorSupport/decorators/subclass ../properties/defaultUnit ../rest/support/Stop ../symbols/SimpleMarkerSymbol ./Search ./Widget ./Directions/css ./Directions/DirectionsViewModel ./Directions/components/SaveLayer ./Directions/support/directionsUtils ./Search/support/locatorUtils ../chunks/componentsUtils ./support/globalCss ./support/Heading ./support/legacyIcon ./support/decorators/accessibleHandler ./support/decorators/messageBundle ./support/jsxFactory ./support/widgetUtils ../intl/number".split(" "),
function(va,C,vc,wa,Vb,ub,Y,Wb,K,Xb,wc,xc,Yb,Zb,$b,ac,bc,cc,h,vb,dc,T,wb,ec,R,ma,ba,ra,cb,m,yc,fc){function xb(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}));c.push.apply(c,d)}return c}function ca(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{};b%2?xb(Object(c),!0).forEach(function(d){var e=c[d];d in a?Object.defineProperty(a,d,{value:e,
enumerable:!0,configurable:!0,writable:!0}):a[d]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):xb(Object(c)).forEach(function(d){Object.defineProperty(a,d,Object.getOwnPropertyDescriptor(c,d))})}return a}function db(a){"@babel/helpers - typeof";db="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(b){return typeof b}:function(b){return b&&"function"===typeof Symbol&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b};
return db(a)}function ha(){ha=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b],d;for(d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a};return ha.apply(this,arguments)}function gc(a,b){if(null==a)return{};if(null==a)var c={};else{c={};var d=Object.keys(a),e;for(e=0;e<d.length;e++){var f=d[e];0<=b.indexOf(f)||(c[f]=a[f])}}if(Object.getOwnPropertySymbols)for(e=Object.getOwnPropertySymbols(a),f=0;f<e.length;f++)d=e[f],0<=b.indexOf(d)||Object.prototype.propertyIsEnumerable.call(a,
d)&&(c[d]=a[d]);return c}function ia(a){if("undefined"!==typeof window&&window.navigator)return!!navigator.userAgent.match(a)}function x(a,b,c){a.addEventListener(b,c,!ja&&yb)}function w(a,b,c){a.removeEventListener(b,c,!ja&&yb)}function Oa(a,b){if(b){"\x3e"===b[0]&&(b=b.substring(1));if(a)try{if(a.matches)return a.matches(b);if(a.msMatchesSelector)return a.msMatchesSelector(b);if(a.webkitMatchesSelector)return a.webkitMatchesSelector(b)}catch(c){}return!1}}function Z(a,b,c,d){if(a){c=c||document;
do{if(null!=b&&("\x3e"===b[0]?a.parentNode===c&&Oa(a,b):Oa(a,b))||d&&a===c)return a;if(a===c)break}while(a=a.host&&a!==document&&a.host.nodeType?a.host:a.parentNode)}return null}function U(a,b,c){if(a&&b)if(a.classList)a.classList[c?"add":"remove"](b);else{var d=(" "+a.className+" ").replace(zb," ").replace(" "+b+" "," ");a.className=(d+(c?" "+b:"")).replace(zb," ")}}function t(a,b,c){var d=a&&a.style;if(d){if(void 0===c)return document.defaultView&&document.defaultView.getComputedStyle?c=document.defaultView.getComputedStyle(a,
""):a.currentStyle&&(c=a.currentStyle),void 0===b?c:c[b];b in d||-1!==b.indexOf("webkit")||(b="-webkit-"+b);d[b]=c+("string"===typeof c?"":"px")}}function xa(a,b){var c="";if("string"===typeof a)c=a;else{do{var d=t(a,"transform");d&&"none"!==d&&(c=d+" "+c)}while(!b&&(a=a.parentNode))}return(a=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix)&&new a(c)}function Ab(a,b,c){if(a){a=a.getElementsByTagName(b);b=0;var d=a.length;if(c)for(;b<d;b++)c(a[b],b);return a}return[]}
function ka(){var a=document.scrollingElement;return a?a:document.documentElement}function H(a,b,c,d,e){if(a.getBoundingClientRect||a===window){if(a!==window&&a.parentNode&&a!==ka()){var f=a.getBoundingClientRect();var g=f.top;var k=f.left;var l=f.bottom;var p=f.right;var q=f.height;var r=f.width}else k=g=0,l=window.innerHeight,p=window.innerWidth,q=window.innerHeight,r=window.innerWidth;if((b||c)&&a!==window&&(e=e||a.parentNode,!ja)){do if(e&&e.getBoundingClientRect&&("none"!==t(e,"transform")||
c&&"static"!==t(e,"position"))){l=e.getBoundingClientRect();g-=l.top+parseInt(t(e,"border-top-width"));k-=l.left+parseInt(t(e,"border-left-width"));l=g+f.height;p=k+f.width;break}while(e=e.parentNode)}d&&a!==window&&(d=(a=xa(e||a))&&a.a,e=a&&a.d,a&&(g/=e,k/=d,r/=d,q/=e,l=g+q,p=k+r));return{top:g,left:k,bottom:l,right:p,width:r,height:q}}}function Bb(a,b,c){var d=na(a,!0);for(a=H(a)[b];d;){b=H(d)[c];var e=void 0;e=a>=b;if(!e)return d;if(d===ka())break;d=na(d,!1)}return!1}function ya(a,b,c,d){for(var e=
0,f=0,g=a.children;f<g.length;){if("none"!==g[f].style.display&&g[f]!==u.ghost&&(d||g[f]!==u.dragged)&&Z(g[f],c.draggable,a,!1)){if(e===b)return g[f];e++}f++}return null}function eb(a,b){for(a=a.lastElementChild;a&&(a===u.ghost||"none"===t(a,"display")||b&&!Oa(a,b));)a=a.previousElementSibling;return a||null}function X(a,b){var c=0;if(!a||!a.parentNode)return-1;for(;a=a.previousElementSibling;)"TEMPLATE"===a.nodeName.toUpperCase()||a===u.clone||b&&!Oa(a,b)||c++;return c}function Cb(a){var b=0,c=0,
d=ka();if(a){do{var e=xa(a),f=e.d;b+=a.scrollLeft*e.a;c+=a.scrollTop*f}while(a!==d&&(a=a.parentNode))}return[b,c]}function na(a,b){if(!a||!a.getBoundingClientRect)return ka();var c=!1;do if(a.clientWidth<a.scrollWidth||a.clientHeight<a.scrollHeight){var d=t(a);if(a.clientWidth<a.scrollWidth&&("auto"==d.overflowX||"scroll"==d.overflowX)||a.clientHeight<a.scrollHeight&&("auto"==d.overflowY||"scroll"==d.overflowY)){if(!a.getBoundingClientRect||a===document.body)break;if(c||b)return a;c=!0}}while(a=a.parentNode);
return ka()}function fb(a,b){return Math.round(a.top)===Math.round(b.top)&&Math.round(a.left)===Math.round(b.left)&&Math.round(a.height)===Math.round(b.height)&&Math.round(a.width)===Math.round(b.width)}function Db(a,b){return function(){if(!Ea){var c=arguments;1===c.length?a.call(this,c[0]):a.apply(this,c);Ea=setTimeout(function(){Ea=void 0},b)}}}function Eb(a,b,c){a.scrollLeft+=b;a.scrollTop+=c}function Fb(a){var b=window.Polymer,c=window.jQuery||window.Zepto;return b&&b.dom?b.dom(a).cloneNode(!0):
c?c(a).clone(!0)[0]:a.cloneNode(!0)}function Gb(a,b,c){var d={};Array.from(a.children).forEach(function(e){var f,g,k,l;Z(e,b.draggable,a,!1)&&!e.animated&&e!==c&&(e=H(e),d.left=Math.min(null!==(f=d.left)&&void 0!==f?f:Infinity,e.left),d.top=Math.min(null!==(g=d.top)&&void 0!==g?g:Infinity,e.top),d.right=Math.max(null!==(k=d.right)&&void 0!==k?k:-Infinity,e.right),d.bottom=Math.max(null!==(l=d.bottom)&&void 0!==l?l:-Infinity,e.bottom))});d.width=d.right-d.left;d.height=d.bottom-d.top;d.x=d.left;d.y=
d.top;return d}function hc(){var a=[],b;return{captureAnimationState:function(){a=[];this.options.animation&&[].slice.call(this.el.children).forEach(function(c){if("none"!==t(c,"display")&&c!==u.ghost){a.push({target:c,rect:H(c)});var d=ca({},a[a.length-1].rect);if(c.thisAnimationDuration){var e=xa(c,!0);e&&(d.top-=e.f,d.left-=e.e)}c.fromRect=d}})},addAnimationState:function(c){a.push(c)},removeAnimationState:function(c){var d=a,e=d.splice;a:{var f=a;c={target:c};for(var g in f)if(f.hasOwnProperty(g))for(var k in c)if(c.hasOwnProperty(k)&&
c[k]===f[g][k]){f=Number(g);break a}f=-1}e.call(d,f,1)},animateAll:function(c){var d=this;if(this.options.animation){var e=!1,f=0;a.forEach(function(g){var k=0,l=g.target,p=l.fromRect,q=H(l),r=l.prevFromRect,y=l.prevToRect;g=g.rect;var E=xa(l,!0);E&&(q.top-=E.f,q.left-=E.e);l.toRect=q;l.thisAnimationDuration&&fb(r,q)&&!fb(p,q)&&(g.top-q.top)/(g.left-q.left)===(p.top-q.top)/(p.left-q.left)&&(k=Math.sqrt(Math.pow(r.top-g.top,2)+Math.pow(r.left-g.left,2))/Math.sqrt(Math.pow(r.top-y.top,2)+Math.pow(r.left-
y.left,2))*d.options.animation);fb(q,p)||(l.prevFromRect=p,l.prevToRect=q,k||(k=d.options.animation),d.animate(l,g,q,k));k&&(e=!0,f=Math.max(f,k),clearTimeout(l.animationResetTimer),l.animationResetTimer=setTimeout(function(){l.animationTime=0;l.prevFromRect=null;l.fromRect=null;l.prevToRect=null;l.thisAnimationDuration=null},k),l.thisAnimationDuration=k)});clearTimeout(b);e?b=setTimeout(function(){"function"===typeof c&&c()},f):"function"===typeof c&&c();a=[]}else clearTimeout(b),"function"===typeof c&&
c()},animate:function(c,d,e,f){if(f){t(c,"transition","");t(c,"transform","");var g=xa(this.el),k=(d.left-e.left)/(g&&g.a||1);d=(d.top-e.top)/(g&&g.d||1);c.animatingX=!!k;c.animatingY=!!d;t(c,"transform","translate3d("+k+"px,"+d+"px,0)");this.forRepaintDummy=c.offsetWidth;t(c,"transition","transform "+f+"ms"+(this.options.easing?" "+this.options.easing:""));t(c,"transform","translate3d(0,0,0)");"number"===typeof c.animated&&clearTimeout(c.animated);c.animated=setTimeout(function(){t(c,"transition",
"");t(c,"transform","");c.animated=!1;c.animatingX=!1;c.animatingY=!1},f)}}}}function O(a){var b=ca({putSortable:L,cloneEl:F,targetEl:n,rootEl:D,oldIndex:za,oldDraggableIndex:Fa,newIndex:V,newDraggableIndex:oa},a);a=b.sortable;var c=b.rootEl,d=b.name,e=b.targetEl,f=b.cloneEl,g=b.toEl,k=b.fromEl,l=b.oldIndex,p=b.newIndex,q=b.oldDraggableIndex,r=b.newDraggableIndex,y=b.originalEvent,E=b.putSortable,J=b.extraEventProperties;if(a=a||c&&c[W]){var z=a.options,M="on"+d.charAt(0).toUpperCase()+d.substr(1);
!window.CustomEvent||ja||Ga?(b=document.createEvent("Event"),b.initEvent(d,!0,!0)):b=new CustomEvent(d,{bubbles:!0,cancelable:!0});b.to=g||c;b.from=k||c;b.item=e||c;b.clone=f;b.oldIndex=l;b.newIndex=p;b.oldDraggableIndex=q;b.newDraggableIndex=r;b.originalEvent=y;b.pullMode=E?E.lastPutMode:void 0;d=ca(ca({},J),Ha.getEventProperties(d,a));for(var P in d)b[P]=d[P];c&&c.dispatchEvent(b);z[M]&&z[M].call(a,b)}}function u(a,b){if(!a||!a.nodeType||1!==a.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(a));
this.el=a;this.options=b=ha({},b);a[W]=this;var c={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(a.nodeName)?"\x3eli":"\x3e*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Hb(a,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(f,g){f.setData("Text",g.textContent)},dropBubble:!1,
dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==u.supportPointer&&"PointerEvent"in window&&!Ia,emptyInsertThreshold:5};Ha.initializePlugins(this,a,c);for(var d in c)d in b||(b[d]=c[d]);Ib(b);for(var e in this)"_"===e.charAt(0)&&"function"===typeof this[e]&&
(this[e]=this[e].bind(this));if(this.nativeDraggable=b.forceFallback?!1:ic)this.options.touchStartThreshold=1;b.supportPointer?x(a,"pointerdown",this._onTapStart):(x(a,"mousedown",this._onTapStart),x(a,"touchstart",this._onTapStart));this.nativeDraggable&&(x(a,"dragover",this),x(a,"dragenter",this));Pa.push(this.el);b.store&&b.store.get&&this.sort(b.store.get(this)||[]);ha(this,hc())}function Qa(a,b,c,d,e,f,g,k){var l=a[W],p=l.options.onMove,q;if(!window.CustomEvent||ja||Ga){var r=document.createEvent("Event");
r.initEvent("move",!0,!0)}else r=new CustomEvent("move",{bubbles:!0,cancelable:!0});r.to=b;r.from=a;r.dragged=c;r.draggedRect=d;r.related=e||b;r.relatedRect=f||H(b);r.willInsertAfter=k;r.originalEvent=g;a.dispatchEvent(r);p&&(q=p.call(l,r,g));return q}function gb(a){a.draggable=!1}function jc(){hb=!1}function kc(a,b,c){var d=H(ya(c.el,0,c.options,!0));c=Gb(c.el,c.options,v);return b?a.clientX<c.left-10||a.clientY<d.top&&a.clientX<d.right:a.clientY<c.top-10||a.clientY<d.bottom&&a.clientX<d.left}function lc(a,
b,c){var d=H(eb(c.el,c.options.draggable));c=Gb(c.el,c.options,v);return b?a.clientX>c.right+10||a.clientY>d.bottom&&a.clientX>d.left:a.clientY>c.bottom+10||a.clientX>d.right&&a.clientY>d.top}function mc(a,b,c,d,e,f,g,k){a=d?a.clientY:a.clientX;var l=d?c.height:c.width,p=d?c.top:c.left;c=d?c.bottom:c.right;d=!1;if(!g)if(k&&Ra<l*e)if(!Ja&&(1===Ka?a>p+l*f/2:a<c-l*f/2)&&(Ja=!0),Ja)d=!0;else{if(1===Ka?a<p+Ra:a>c-Ra)return-Ka}else if(a>p+l*(1-e)/2&&a<c-l*(1-e)/2)return b=X(n)<X(b)?1:-1,b;if(d||g)if(a<
p+l*f/2||a>c-l*f/2)return a>p+l/2?1:-1;return 0}function nc(a){Sa.length=0;a=a.getElementsByTagName("input");for(var b=a.length;b--;){var c=a[b];c.checked&&Sa.push(c)}}function Ta(a){return setTimeout(a,0)}function Ua(){I.forEach(function(a){clearInterval(a.pid)});I=[]}function ib(){}function jb(){}function oc(a){const {branchName:b,displayText:c,exitName:d,intersectingName:e,name:f,objectId:g,towardName:k}=a;if(null==c)return null;a=[b,d,e,f,k].filter(Boolean).sort((q,r)=>r.length-q.length).map(q=>
Wb.escapeRegExpString(q));if(!a.length)return c;a=new RegExp(a.join("|"),"g");a=c.matchAll(a);let l=0;const p=[];for(const {0:q,index:r}of a)p.push(c.slice(l,r),m.tsx("span",{class:h.css.maneuverPlaceName},q)),l=r+q.length;p.push(c.slice(l));return m.tsx("span",{id:`${h.css.maneuver}-${g}`},p)}function Jb(a){return!!a.composedPath?.().find(b=>b.classList?.contains("esri-search__suggestions-list"))}function pc(a){a=new Date(a);return new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate())}function kb(a){return a?.["data-stop-index"]}
var ja=ia(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Ga=ia(/Edge/i),Kb=ia(/firefox/i),Ia=ia(/safari/i)&&!ia(/chrome/i)&&!ia(/android/i),La=ia(/iP(ad|od|hone)/i),Lb=ia(/chrome/i)&&ia(/android/i),yb={capture:!1,passive:!1},zb=/\s+/g,Ea,W="Sortable"+(new Date).getTime(),Aa=[],lb={initializeByDefault:!0},Ha={mount:function(a){for(var b in lb)!lb.hasOwnProperty(b)||b in a||(a[b]=lb[b]);Aa.forEach(function(c){if(c.pluginName===a.pluginName)throw"Sortable: Cannot mount plugin ".concat(a.pluginName,
" more than once");});Aa.push(a)},pluginEvent:function(a,b,c){var d=this;this.eventCanceled=!1;c.cancel=function(){d.eventCanceled=!0};var e=a+"Global";Aa.forEach(function(f){if(b[f.pluginName]){if(b[f.pluginName][e])b[f.pluginName][e](ca({sortable:b},c));if(b.options[f.pluginName]&&b[f.pluginName][a])b[f.pluginName][a](ca({sortable:b},c))}})},initializePlugins:function(a,b,c,d){Aa.forEach(function(f){var g=f.pluginName;if(a.options[g]||f.initializeByDefault)f=new f(a,b,a.options),f.sortable=a,f.options=
a.options,a[g]=f,ha(c,f.defaults)});for(var e in a.options)a.options.hasOwnProperty(e)&&(d=this.modifyOption(a,e,a.options[e]),"undefined"!==typeof d&&(a.options[e]=d))},getEventProperties:function(a,b){var c={};Aa.forEach(function(d){"function"===typeof d.eventProperties&&ha(c,d.eventProperties.call(b[d.pluginName],a))});return c},modifyOption:function(a,b,c){var d;Aa.forEach(function(e){a[e.pluginName]&&e.optionListeners&&"function"===typeof e.optionListeners[b]&&(d=e.optionListeners[b].call(a[e.pluginName],
c))});return d}},qc=["evt"],S=function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},d=c.evt;c=gc(c,qc);Ha.pluginEvent.bind(u)(a,b,ca({dragEl:n,parentEl:G,ghostEl:v,rootEl:D,nextEl:sa,lastDownEl:Va,cloneEl:F,cloneHidden:pa,dragStarted:Ma,putSortable:L,activeSortable:u.active,originalEvent:d,oldIndex:za,oldDraggableIndex:Fa,newIndex:V,newDraggableIndex:oa,hideGhostForTarget:Mb,unhideGhostForTarget:Nb,cloneNowHidden:function(){pa=!0},cloneNowShown:function(){pa=!1},dispatchSortableEvent:function(e){O({sortable:b,
name:e,originalEvent:d})}},c))},n,G,v,D,sa,Va,F,pa,za,V,Fa,oa,Wa,L,Ba=!1,Xa=!1,Pa=[],ta,aa,mb,nb,Ob,Pb,Ma,Ca,Ka,Ja=!1,Ya=!1,Ra,N,ob=[],hb=!1,Sa=[],Za="undefined"!==typeof document,Qb=Ga||ja?"cssFloat":"float",ic=Za&&!Lb&&!La&&"draggable"in document.createElement("div"),Rb=function(){if(Za){if(ja)return!1;var a=document.createElement("x");a.style.cssText="pointer-events:auto";return"auto"===a.style.pointerEvents}}(),Hb=function(a,b){var c=t(a),d=parseInt(c.width)-parseInt(c.paddingLeft)-parseInt(c.paddingRight)-
parseInt(c.borderLeftWidth)-parseInt(c.borderRightWidth),e=ya(a,0,b);a=ya(a,1,b);var f=e&&t(e);b=a&&t(a);var g=f&&parseInt(f.marginLeft)+parseInt(f.marginRight)+H(e).width,k=b&&parseInt(b.marginLeft)+parseInt(b.marginRight)+H(a).width;return"flex"===c.display?"column"===c.flexDirection||"column-reverse"===c.flexDirection?"vertical":"horizontal":"grid"===c.display?1>=c.gridTemplateColumns.split(" ").length?"vertical":"horizontal":e&&f["float"]&&"none"!==f["float"]?(c="left"===f["float"]?"left":"right",
!a||"both"!==b.clear&&b.clear!==c?"horizontal":"vertical"):e&&("block"===f.display||"flex"===f.display||"table"===f.display||"grid"===f.display||g>=d&&"none"===c[Qb]||a&&"none"===c[Qb]&&g+k>d)?"vertical":"horizontal"},rc=function(a,b,c){var d=c?a.left:a.top,e=c?a.right:a.bottom;a=c?a.width:a.height;var f=c?b.left:b.top,g=c?b.right:b.bottom;b=c?b.width:b.height;return d===f||e===g||d+a/2===f+b/2},sc=function(a,b){var c;Pa.some(function(d){var e=d[W].options.emptyInsertThreshold;if(e&&!eb(d)){var f=
H(d),g=b>=f.top-e&&b<=f.bottom+e;if(a>=f.left-e&&a<=f.right+e&&g)return c=d}});return c},Ib=function(a){function b(e,f){return function(g,k,l,p){var q=g.options.group.name&&k.options.group.name&&g.options.group.name===k.options.group.name;if(null==e&&(f||q))return!0;if(null==e||!1===e)return!1;if(f&&"clone"===e)return e;if("function"===typeof e)return b(e(g,k,l,p),f)(g,k,l,p);g=(f?g:k).options.group.name;return!0===e||"string"===typeof e&&e===g||e.join&&-1<e.indexOf(g)}}var c={},d=a.group;d&&"object"==
db(d)||(d={name:d});c.name=d.name;c.checkPull=b(d.pull,!0);c.checkPut=b(d.put);c.revertClone=d.revertClone;a.group=c},Mb=function(){!Rb&&v&&t(v,"display","none")},Nb=function(){!Rb&&v&&t(v,"display","")};Za&&!Lb&&document.addEventListener("click",function(a){if(Xa)return a.preventDefault(),a.stopPropagation&&a.stopPropagation(),a.stopImmediatePropagation&&a.stopImmediatePropagation(),Xa=!1},!0);var ua=function(a){if(n){a=a.touches?a.touches[0]:a;var b=sc(a.clientX,a.clientY);if(b){var c={},d;for(d in a)a.hasOwnProperty(d)&&
(c[d]=a[d]);c.target=c.rootEl=b;c.preventDefault=void 0;c.stopPropagation=void 0;b[W]._onDragOver(c)}}},tc=function(a){n&&n.parentNode[W]._isOutsideThisEl(a.target)};u.prototype={constructor:u,_isOutsideThisEl:function(a){this.el.contains(a)||a===this.el||(Ca=null)},_getDirection:function(a,b){return"function"===typeof this.options.direction?this.options.direction.call(this,a,b,n):this.options.direction},_onTapStart:function(a){if(a.cancelable){var b=this,c=this.el,d=this.options,e=d.preventOnFilter,
f=a.type,g=a.touches&&a.touches[0]||a.pointerType&&"touch"===a.pointerType&&a,k=(g||a).target,l=a.target.shadowRoot&&(a.path&&a.path[0]||a.composedPath&&a.composedPath()[0])||k,p=d.filter;nc(c);if(!(n||/mousedown|pointerdown/.test(f)&&0!==a.button||d.disabled||l.isContentEditable||!this.nativeDraggable&&Ia&&k&&"SELECT"===k.tagName.toUpperCase()||(k=Z(k,d.draggable,c,!1),k&&k.animated||Va===k))){za=X(k);Fa=X(k,d.draggable);if("function"===typeof p){if(p.call(this,a,k,this)){O({sortable:b,rootEl:l,
name:"filter",targetEl:k,toEl:c,fromEl:c});S("filter",b,{evt:a});e&&a.cancelable&&a.preventDefault();return}}else if(p&&(p=p.split(",").some(function(q){if(q=Z(l,q.trim(),c,!1))return O({sortable:b,rootEl:q,name:"filter",targetEl:k,fromEl:c,toEl:c}),S("filter",b,{evt:a}),!0}))){e&&a.cancelable&&a.preventDefault();return}d.handle&&!Z(l,d.handle,c,!1)||this._prepareDragStart(a,g,k)}}},_prepareDragStart:function(a,b,c){var d=this,e=d.el,f=d.options,g=e.ownerDocument;if(c&&!n&&c.parentNode===e){var k=
H(c);D=e;n=c;G=n.parentNode;sa=n.nextSibling;Va=c;Wa=f.group;u.dragged=n;ta={target:n,clientX:(b||a).clientX,clientY:(b||a).clientY};Ob=ta.clientX-k.left;Pb=ta.clientY-k.top;this._lastX=(b||a).clientX;this._lastY=(b||a).clientY;n.style["will-change"]="all";c=function(){S("delayEnded",d,{evt:a});u.eventCanceled?d._onDrop():(d._disableDelayedDragEvents(),!Kb&&d.nativeDraggable&&(n.draggable=!0),d._triggerDragStart(a,b),O({sortable:d,name:"choose",originalEvent:a}),U(n,f.chosenClass,!0))};f.ignore.split(",").forEach(function(l){Ab(n,
l.trim(),gb)});x(g,"dragover",ua);x(g,"mousemove",ua);x(g,"touchmove",ua);x(g,"mouseup",d._onDrop);x(g,"touchend",d._onDrop);x(g,"touchcancel",d._onDrop);Kb&&this.nativeDraggable&&(this.options.touchStartThreshold=4,n.draggable=!0);S("delayStart",this,{evt:a});!f.delay||f.delayOnTouchOnly&&!b||this.nativeDraggable&&(Ga||ja)?c():u.eventCanceled?this._onDrop():(x(g,"mouseup",d._disableDelayedDrag),x(g,"touchend",d._disableDelayedDrag),x(g,"touchcancel",d._disableDelayedDrag),x(g,"mousemove",d._delayedDragTouchMoveHandler),
x(g,"touchmove",d._delayedDragTouchMoveHandler),f.supportPointer&&x(g,"pointermove",d._delayedDragTouchMoveHandler),d._dragStartTimer=setTimeout(c,f.delay))}},_delayedDragTouchMoveHandler:function(a){a=a.touches?a.touches[0]:a;Math.max(Math.abs(a.clientX-this._lastX),Math.abs(a.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){n&&gb(n);clearTimeout(this._dragStartTimer);
this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var a=this.el.ownerDocument;w(a,"mouseup",this._disableDelayedDrag);w(a,"touchend",this._disableDelayedDrag);w(a,"touchcancel",this._disableDelayedDrag);w(a,"mousemove",this._delayedDragTouchMoveHandler);w(a,"touchmove",this._delayedDragTouchMoveHandler);w(a,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(a,b){b=b||"touch"==a.pointerType&&a;!this.nativeDraggable||b?this.options.supportPointer?x(document,
"pointermove",this._onTouchMove):b?x(document,"touchmove",this._onTouchMove):x(document,"mousemove",this._onTouchMove):(x(n,"dragend",this),x(D,"dragstart",this._onDragStart));try{document.selection?Ta(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch(c){}},_dragStarted:function(a,b){Ba=!1;if(D&&n){S("dragStarted",this,{evt:b});this.nativeDraggable&&x(document,"dragover",tc);var c=this.options;!a&&U(n,c.dragClass,!1);U(n,c.ghostClass,!0);u.active=this;a&&this._appendGhost();
O({sortable:this,name:"start",originalEvent:b})}else this._nulling()},_emulateDragOver:function(){if(aa){this._lastX=aa.clientX;this._lastY=aa.clientY;Mb();for(var a=document.elementFromPoint(aa.clientX,aa.clientY),b=a;a&&a.shadowRoot;){a=a.shadowRoot.elementFromPoint(aa.clientX,aa.clientY);if(a===b)break;b=a}n.parentNode[W]._isOutsideThisEl(a);if(b){do{if(b[W]){var c=void 0;if((c=b[W]._onDragOver({clientX:aa.clientX,clientY:aa.clientY,target:a,rootEl:b}))&&!this.options.dragoverBubble)break}a=b}while(b=
b.parentNode)}Nb()}},_onTouchMove:function(a){if(ta){var b=this.options,c=b.fallbackTolerance,d=b.fallbackOffset;b=a.touches?a.touches[0]:a;var e=v&&xa(v,!0),f=v&&e&&e.a,g=v&&e&&e.d,k=La&&N&&Cb(N);f=(b.clientX-ta.clientX+d.x)/(f||1)+(k?k[0]-ob[0]:0)/(f||1);d=(b.clientY-ta.clientY+d.y)/(g||1)+(k?k[1]-ob[1]:0)/(g||1);if(!u.active&&!Ba){if(c&&Math.max(Math.abs(b.clientX-this._lastX),Math.abs(b.clientY-this._lastY))<c)return;this._onDragStart(a,!0)}v&&(e?(e.e+=f-(mb||0),e.f+=d-(nb||0)):e={a:1,b:0,c:0,
d:1,e:f,f:d},c="matrix(".concat(e.a,",").concat(e.b,",").concat(e.c,",").concat(e.d,",").concat(e.e,",").concat(e.f,")"),t(v,"webkitTransform",c),t(v,"mozTransform",c),t(v,"msTransform",c),t(v,"transform",c),mb=f,nb=d,aa=b);a.cancelable&&a.preventDefault()}},_appendGhost:function(){if(!v){var a=this.options.fallbackOnBody?document.body:D,b=H(n,!0,La,!0,a),c=this.options;if(La){for(N=a;"static"===t(N,"position")&&"none"===t(N,"transform")&&N!==document;)N=N.parentNode;N!==document.body&&N!==document.documentElement?
(N===document&&(N=ka()),b.top+=N.scrollTop,b.left+=N.scrollLeft):N=ka();ob=Cb(N)}v=n.cloneNode(!0);U(v,c.ghostClass,!1);U(v,c.fallbackClass,!0);U(v,c.dragClass,!0);t(v,"transition","");t(v,"transform","");t(v,"box-sizing","border-box");t(v,"margin",0);t(v,"top",b.top);t(v,"left",b.left);t(v,"width",b.width);t(v,"height",b.height);t(v,"opacity","0.8");t(v,"position",La?"absolute":"fixed");t(v,"zIndex","100000");t(v,"pointerEvents","none");u.ghost=v;a.appendChild(v);t(v,"transform-origin",Ob/parseInt(v.style.width)*
100+"% "+Pb/parseInt(v.style.height)*100+"%")}},_onDragStart:function(a,b){var c=this,d=a.dataTransfer,e=c.options;S("dragStart",this,{evt:a});u.eventCanceled?this._onDrop():(S("setupClone",this),u.eventCanceled||(F=Fb(n),F.removeAttribute("id"),F.draggable=!1,F.style["will-change"]="",this._hideClone(),U(F,this.options.chosenClass,!1),u.clone=F),c.cloneId=Ta(function(){S("clone",c);u.eventCanceled||(c.options.removeCloneOnHide||D.insertBefore(F,n),c._hideClone(),O({sortable:c,name:"clone"}))}),!b&&
U(n,e.dragClass,!0),b?(Xa=!0,c._loopId=setInterval(c._emulateDragOver,50)):(w(document,"mouseup",c._onDrop),w(document,"touchend",c._onDrop),w(document,"touchcancel",c._onDrop),d&&(d.effectAllowed="move",e.setData&&e.setData.call(c,d,n)),x(document,"drop",c),t(n,"transform","translateZ(0)")),Ba=!0,c._dragStartId=Ta(c._dragStarted.bind(c,b,a)),x(document,"selectstart",c),Ma=!0,Ia&&t(document.body,"user-select","none"))},_onDragOver:function(a){function b(qa,$a){S(qa,z,ca({evt:a,isOwner:y,axis:P?"vertical":
"horizontal",revert:l,dragRect:da,targetRect:k,canSort:E,fromSortable:J,target:g,completed:d,onMove:function(Sb,uc){return Qa(D,f,n,da,Sb,H(Sb),a,uc)},changed:e},$a))}function c(){b("dragOverAnimationCapture");z.captureAnimationState();z!==J&&J.captureAnimationState()}function d(qa){b("dragOverCompleted",{insertion:qa});qa&&(y?r._hideClone():r._showClone(z),z!==J&&(U(n,L?L.options.ghostClass:r.options.ghostClass,!1),U(n,p.ghostClass,!0)),L!==z&&z!==u.active?L=z:z===u.active&&L&&(L=null),J===z&&(z._ignoreWhileAnimating=
g),z.animateAll(function(){b("dragOverAnimationComplete");z._ignoreWhileAnimating=null}),z!==J&&(J.animateAll(),J._ignoreWhileAnimating=null));if(g===n&&!n.animated||g===f&&!g.animated)Ca=null;p.dragoverBubble||a.rootEl||g===document||(n.parentNode[W]._isOutsideThisEl(a.target),!qa&&ua(a));!p.dragoverBubble&&a.stopPropagation&&a.stopPropagation();return M=!0}function e(){V=X(n);oa=X(n,p.draggable);O({sortable:z,name:"change",toEl:f,newIndex:V,newDraggableIndex:oa,originalEvent:a})}var f=this.el,g=
a.target,k,l,p=this.options,q=p.group,r=u.active,y=Wa===q,E=p.sort,J=L||r,z=this,M=!1;if(!hb){void 0!==a.preventDefault&&a.cancelable&&a.preventDefault();g=Z(g,p.draggable,f,!0);b("dragOver");if(u.eventCanceled)return M;if(n.contains(a.target)||g.animated&&g.animatingX&&g.animatingY||z._ignoreWhileAnimating===g)return d(!1);Xa=!1;if(r&&!p.disabled&&(y?E||(l=G!==D):L===this||(this.lastPutMode=Wa.checkPull(this,r,n,a))&&q.checkPut(this,r,n,a))){var P="vertical"===this._getDirection(a,g);var da=H(n);
b("dragOverValid");if(u.eventCanceled)return M;if(l)return G=D,c(),this._hideClone(),b("revert"),u.eventCanceled||(sa?D.insertBefore(n,sa):D.appendChild(n)),d(!0);q=eb(f,p.draggable);if(!q||lc(a,P,this)&&!q.animated){if(q===n)return d(!1);q&&f===a.target&&(g=q);g&&(k=H(g));if(!1!==Qa(D,f,n,da,g,k,a,!!g))return c(),q&&q.nextSibling?f.insertBefore(n,q.nextSibling):f.appendChild(n),G=f,e(),d(!0)}else if(q&&kc(a,P,this)){var ea=ya(f,0,p,!0);if(ea===n)return d(!1);g=ea;k=H(g);if(!1!==Qa(D,f,n,da,g,k,a,
!1))return c(),f.insertBefore(n,ea),G=f,e(),d(!0)}else if(g.parentNode===f){k=H(g);var A=0;A=n.parentNode!==f;var Q=!rc(n.animated&&n.toRect||da,g.animated&&g.toRect||k,P);q=P?"top":"left";var la=Bb(g,"top","top")||Bb(n,"top","top"),ab=la?la.scrollTop:void 0;Ca!==g&&(ea=k[q],Ja=!1,Ya=!Q&&p.invertSwap||A);A=mc(a,g,k,P,Q?1:p.swapThreshold,null==p.invertedSwapThreshold?p.swapThreshold:p.invertedSwapThreshold,Ya,Ca===g);if(0!==A){Q=X(n);do{Q-=A;var fa=G.children[Q]}while(fa&&("none"===t(fa,"display")||
fa===v))}if(0===A||fa===g)return d(!1);Ca=g;Ka=A;fa=g.nextElementSibling;Q=!1;Q=1===A;A=Qa(D,f,n,da,g,k,a,Q);if(!1!==A){if(1===A||-1===A)Q=1===A;hb=!0;setTimeout(jc,30);c();Q&&!fa?f.appendChild(n):g.parentNode.insertBefore(n,Q?fa:g);la&&Eb(la,0,ab-la.scrollTop);G=n.parentNode;void 0===ea||Ya||(Ra=Math.abs(ea-H(g)[q]));e();return d(!0)}}if(f.contains(n))return d(!1)}return!1}},_ignoreWhileAnimating:null,_offMoveEvents:function(){w(document,"mousemove",this._onTouchMove);w(document,"touchmove",this._onTouchMove);
w(document,"pointermove",this._onTouchMove);w(document,"dragover",ua);w(document,"mousemove",ua);w(document,"touchmove",ua)},_offUpEvents:function(){var a=this.el.ownerDocument;w(a,"mouseup",this._onDrop);w(a,"touchend",this._onDrop);w(a,"pointerup",this._onDrop);w(a,"touchcancel",this._onDrop);w(document,"selectstart",this)},_onDrop:function(a){var b=this.el,c=this.options;V=X(n);oa=X(n,c.draggable);S("drop",this,{evt:a});G=n&&n.parentNode;V=X(n);oa=X(n,c.draggable);if(!u.eventCanceled&&(Ja=Ya=Ba=
!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),clearTimeout(this.cloneId),clearTimeout(this._dragStartId),this.nativeDraggable&&(w(document,"drop",this),w(b,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Ia&&t(document.body,"user-select",""),t(n,"transform",""),a&&(Ma&&(a.cancelable&&a.preventDefault(),!c.dropBubble&&a.stopPropagation()),v&&v.parentNode&&v.parentNode.removeChild(v),(D===G||L&&"clone"!==L.lastPutMode)&&F&&F.parentNode&&F.parentNode.removeChild(F),
n&&(this.nativeDraggable&&w(n,"dragend",this),gb(n),n.style["will-change"]="",Ma&&!Ba&&U(n,L?L.options.ghostClass:this.options.ghostClass,!1),U(n,this.options.chosenClass,!1),O({sortable:this,name:"unchoose",toEl:G,newIndex:null,newDraggableIndex:null,originalEvent:a}),D!==G?(0<=V&&(O({rootEl:G,name:"add",toEl:G,fromEl:D,originalEvent:a}),O({sortable:this,name:"remove",toEl:G,originalEvent:a}),O({rootEl:G,name:"sort",toEl:G,fromEl:D,originalEvent:a}),O({sortable:this,name:"sort",toEl:G,originalEvent:a})),
L&&L.save()):V!==za&&0<=V&&(O({sortable:this,name:"update",toEl:G,originalEvent:a}),O({sortable:this,name:"sort",toEl:G,originalEvent:a})),u.active)))){if(null==V||-1===V)V=za,oa=Fa;O({sortable:this,name:"end",toEl:G,originalEvent:a});this.save()}this._nulling()},_nulling:function(){S("nulling",this);D=n=G=v=sa=F=Va=pa=ta=aa=Ma=V=oa=za=Fa=Ca=Ka=L=Wa=u.dragged=u.ghost=u.clone=u.active=null;Sa.forEach(function(a){a.checked=!0});Sa.length=mb=nb=0},handleEvent:function(a){switch(a.type){case "drop":case "dragend":this._onDrop(a);
break;case "dragenter":case "dragover":n&&(this._onDragOver(a),a.dataTransfer&&(a.dataTransfer.dropEffect="move"),a.cancelable&&a.preventDefault());break;case "selectstart":a.preventDefault()}},toArray:function(){for(var a=[],b,c=this.el.children,d=0,e=c.length,f=this.options;d<e;d++)if(b=c[d],Z(b,f.draggable,this.el,!1)){var g=a,k=g.push,l;if(!(l=b.getAttribute(f.dataIdAttr))){b=b.tagName+b.className+b.src+b.href+b.textContent;l=b.length;for(var p=0;l--;)p+=b.charCodeAt(l);l=p.toString(36)}k.call(g,
l)}return a},sort:function(a,b){var c={},d=this.el;this.toArray().forEach(function(e,f){f=d.children[f];Z(f,this.options.draggable,d,!1)&&(c[e]=f)},this);b&&this.captureAnimationState();a.forEach(function(e){c[e]&&(d.removeChild(c[e]),d.appendChild(c[e]))});b&&this.animateAll()},save:function(){var a=this.options.store;a&&a.set&&a.set(this)},closest:function(a,b){return Z(a,b||this.options.draggable,this.el,!1)},option:function(a,b){var c=this.options;if(void 0===b)return c[a];var d=Ha.modifyOption(this,
a,b);c[a]="undefined"!==typeof d?d:b;"group"===a&&Ib(c)},destroy:function(){S("destroy",this);var a=this.el;a[W]=null;w(a,"mousedown",this._onTapStart);w(a,"touchstart",this._onTapStart);w(a,"pointerdown",this._onTapStart);this.nativeDraggable&&(w(a,"dragover",this),w(a,"dragenter",this));Array.prototype.forEach.call(a.querySelectorAll("[draggable]"),function(b){b.removeAttribute("draggable")});this._onDrop();this._disableDelayedDragEvents();Pa.splice(Pa.indexOf(this.el),1);this.el=a=null},_hideClone:function(){pa||
(S("hideClone",this),u.eventCanceled||(t(F,"display","none"),this.options.removeCloneOnHide&&F.parentNode&&F.parentNode.removeChild(F),pa=!0))},_showClone:function(a){"clone"!==a.lastPutMode?this._hideClone():pa&&(S("showClone",this),u.eventCanceled||(n.parentNode!=D||this.options.group.revertClone?sa?D.insertBefore(F,sa):D.appendChild(F):D.insertBefore(F,n),this.options.group.revertClone&&this.animate(n,F),t(F,"display",""),pa=!1))}};Za&&x(document,"touchmove",function(a){(u.active||Ba)&&a.cancelable&&
a.preventDefault()});u.utils={on:x,off:w,css:t,find:Ab,is:function(a,b){return!!Z(a,b,a,!1)},extend:function(a,b){if(a&&b)for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},throttle:Db,closest:Z,toggleClass:U,clone:Fb,index:X,nextTick:Ta,cancelNextTick:function(a){return clearTimeout(a)},detectDirection:Hb,getChild:ya};u.get=function(a){return a[W]};u.mount=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];b[0].constructor===Array&&(b=b[0]);b.forEach(function(d){if(!d.prototype||
!d.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(d));d.utils&&(u.utils=ca(ca({},u.utils),d.utils));Ha.mount(d)})};u.create=function(a,b){return new u(a,b)};u.version="1.15.2";var I=[],Na,pb,qb=!1,rb,sb,bb,Da,tb=Db(function(a,b,c,d){if(b.scroll){var e=(a.touches?a.touches[0]:a).clientX,f=(a.touches?a.touches[0]:a).clientY,g=b.scrollSensitivity,k=b.scrollSpeed,l=ka(),p=!1;if(pb!==c){pb=c;Ua();Na=b.scroll;var q=b.scrollFn;!0===Na&&
(Na=na(c,!0))}c=0;var r=Na;do{var y=r,E=H(y),J=E.top,z=E.bottom,M=E.left,P=E.right,da=E.width;E=E.height;var ea=void 0,A=void 0,Q=y.scrollWidth,la=y.scrollHeight;A=t(y);var ab=y.scrollLeft,fa=y.scrollTop;y===l?(ea=da<Q&&("auto"===A.overflowX||"scroll"===A.overflowX||"visible"===A.overflowX),A=E<la&&("auto"===A.overflowY||"scroll"===A.overflowY||"visible"===A.overflowY)):(ea=da<Q&&("auto"===A.overflowX||"scroll"===A.overflowX),A=E<la&&("auto"===A.overflowY||"scroll"===A.overflowY));M=ea&&(Math.abs(P-
e)<=g&&ab+da<Q)-(Math.abs(M-e)<=g&&!!ab);J=A&&(Math.abs(z-f)<=g&&fa+E<la)-(Math.abs(J-f)<=g&&!!fa);if(!I[c])for(z=0;z<=c;z++)I[z]||(I[z]={});if(I[c].vx!=M||I[c].vy!=J||I[c].el!==y)if(I[c].el=y,I[c].vx=M,I[c].vy=J,clearInterval(I[c].pid),0!=M||0!=J)p=!0,I[c].pid=setInterval(function(){d&&0===this.layer&&u.active._onTouchMove(bb);var qa=I[this.layer].vy?I[this.layer].vy*k:0,$a=I[this.layer].vx?I[this.layer].vx*k:0;"function"===typeof q&&"continue"!==q.call(u.dragged.parentNode[W],$a,qa,a,bb,I[this.layer].el)||
Eb(I[this.layer].el,$a,qa)}.bind({layer:c}),24);c++}while(b.bubbleScroll&&r!==l&&(r=na(r,!1)));qb=p}},30),Tb=function(a){var b=a.originalEvent,c=a.putSortable,d=a.dragEl,e=a.activeSortable,f=a.dispatchSortableEvent,g=a.hideGhostForTarget;a=a.unhideGhostForTarget;b&&(e=c||e,g(),b=b.changedTouches&&b.changedTouches.length?b.changedTouches[0]:b,b=document.elementFromPoint(b.clientX,b.clientY),a(),e&&!e.el.contains(b)&&(f("spill"),this.onSpill({dragEl:d,putSortable:c})))};ib.prototype={startIndex:null,
dragStart:function(a){this.startIndex=a.oldDraggableIndex},onSpill:function(a){var b=a.dragEl;a=a.putSortable;this.sortable.captureAnimationState();a&&a.captureAnimationState();var c=ya(this.sortable.el,this.startIndex,this.options);c?this.sortable.el.insertBefore(b,c):this.sortable.el.appendChild(b);this.sortable.animateAll();a&&a.animateAll()},drop:Tb};ha(ib,{pluginName:"revertOnSpill"});jb.prototype={onSpill:function(a){var b=a.dragEl;a=a.putSortable||this.sortable;a.captureAnimationState();b.parentNode&&
b.parentNode.removeChild(b);a.animateAll()},drop:Tb};ha(jb,{pluginName:"removeOnSpill"});u.mount(new function(){function a(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var b in this)"_"===b.charAt(0)&&"function"===typeof this[b]&&(this[b]=this[b].bind(this))}a.prototype={dragStarted:function(b){b=b.originalEvent;this.sortable.nativeDraggable?x(document,"dragover",this._handleAutoScroll):this.options.supportPointer?x(document,"pointermove",
this._handleFallbackAutoScroll):b.touches?x(document,"touchmove",this._handleFallbackAutoScroll):x(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(b){b=b.originalEvent;this.options.dragOverBubble||b.rootEl||this._handleAutoScroll(b)},drop:function(){this.sortable.nativeDraggable?w(document,"dragover",this._handleAutoScroll):(w(document,"pointermove",this._handleFallbackAutoScroll),w(document,"touchmove",this._handleFallbackAutoScroll),w(document,"mousemove",this._handleFallbackAutoScroll));
clearInterval(Da);Ua();clearTimeout(Ea);Ea=void 0},nulling:function(){bb=pb=Na=qb=Da=rb=sb=null;I.length=0},_handleFallbackAutoScroll:function(b){this._handleAutoScroll(b,!0)},_handleAutoScroll:function(b,c){var d=this,e=(b.touches?b.touches[0]:b).clientX,f=(b.touches?b.touches[0]:b).clientY,g=document.elementFromPoint(e,f);bb=b;if(c||this.options.forceAutoScrollFallback||Ga||ja||Ia){tb(b,this.options,g,c);var k=na(g,!0);!qb||Da&&e===rb&&f===sb||(Da&&clearInterval(Da),Da=setInterval(function(){var l=
na(document.elementFromPoint(e,f),!0);l!==k&&(k=l,Ua());tb(b,d.options,l,c)},10),rb=e,sb=f)}else this.options.bubbleScroll&&na(g,!0)!==ka()?tb(b,this.options,na(g,!1),!1):Ua()}};return ha(a,{pluginName:"scroll",initializeByDefault:!0})});u.mount(jb,ib);const Ub={departureTime:!0,layerDetails:!0,printButton:!1,saveAsButton:!0,saveButton:!0,stops:!0,traveMode:!0};let B=class extends cc{constructor(a,b){super(a,b);this._activeManeuver=this._activeStop=null;this._autoStopRemovalDelay=100;this._autoStopRemovalTimeoutId=
void 0;this._saveAsButtonNode=this._renderSavePopoverFunction=this._pointerPressedSearchSuggestionStop=this._pointerDownUpHandle=this._newPlaceholderStop=this._focusedManeuver=null;this._saveLayer=new dc.SaveLayer;this._sortable=this._sections=null;this._stopsToSearches=new Map;this._viewClickHandle=null;this.headingLevel=2;this.searchProperties=this.messagesUnits=this.messagesCommon=this.messages=null;this.viewModel=new vb;this.visibleElements={...Ub};this._setUpDragAndDropStops=c=>{this._sortable=
u.create(c,{draggable:`.${h.css.validStopRow}`,ghostClass:h.css.stopRowGhost,handle:`.${h.css.stopHandle}`,onEnd:this._handleStopInputDragEnd})};this._handleDragHandlePointerDown=()=>this.viewModel.layer?.stops.forEach(c=>this.acquireSearch(c).activeMenu="none");this._handleStopInputDragEnd=({oldIndex:c,newIndex:d,target:e})=>{if(c!==d&&null!=d&&null!=c){var {children:f}=e,g=f[c];e.insertBefore(f[d],0>d-c?g.nextElementSibling:g);({stops:e}=this.viewModel.layer);e.reorder(e.at(c),d);for(const k of e)k.sequence=
null;this._solveRoute()}}}initialize(){this.addHandles([Y.watch(()=>this.viewModel.layer?.routeInfo,()=>{this._focusedManeuver=this._activeManeuver=null;this._sections=this._getSections();this.scheduleRender()},Y.initial),Y.when(()=>[this.view,this.view?.surface],([a,b],c)=>{if(c=c?.[0])this._viewClickHandle=null,c&&this.removeHandles(c);if(a&&b){c=this._prepPointerDownUpClick();const d=this._prepViewClick();c.pause();d.pause();this.addHandles([wa.on(b,"mousedown",()=>this._autoStopRemovalDelay=500),
wa.on(b,"mouseup",()=>this._autoStopRemovalDelay=100),c,d],a);this._pointerDownUpHandle=c;this._viewClickHandle=d}},Y.initial),Y.when(()=>null==this.viewModel.serviceDescription,()=>{try{this.viewModel.load()}catch{}},Y.initial),Y.watch(()=>this._saveLayer.state,()=>{this.scheduleRender()})]);this.when(()=>{!this.destroyed&&this.visibleElements.saveAsButton&&(this._renderSavePopoverFunction=this._renderSavePopover.bind(this),this._projector.append(document.body,this._renderSavePopoverFunction))})}loadDependencies(){return ec.loadCalciteComponents({button:()=>
new Promise((a,b)=>va(["../chunks/calcite-button"],a,b)),icon:()=>new Promise((a,b)=>va(["../chunks/calcite-icon"],a,b)),"input-date-picker":()=>new Promise((a,b)=>va(["../chunks/calcite-input-date-picker"],a,b)),"input-time-picker":()=>new Promise((a,b)=>va(["../chunks/calcite-input-time-picker"],a,b)),link:()=>new Promise((a,b)=>va(["../chunks/calcite-link"],a,b)),popover:()=>new Promise((a,b)=>va(["../chunks/calcite-popover"],a,b))})}destroy(){for(const a of this._stopsToSearches.values())a.destroy();
this._sortable?.destroy();null!=this._renderSavePopoverFunction&&this._projector.detach(this._renderSavePopoverFunction)}get apiKey(){return this.viewModel.apiKey}set apiKey(a){this.viewModel.apiKey=a}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(a){this.viewModel.goToOverride=a}get icon(){return"right"}set icon(a){this._overrideIfSome("icon",a)}get label(){return this.messages?.widgetLabel??""}set label(a){this._overrideIfSome("label",a)}get lastRoute(){return this.viewModel.lastRoute}get layer(){return this.viewModel.layer}set layer(a){this.viewModel.layer=
a}get maxStops(){return this.viewModel.maxStops}set maxStops(a){this.viewModel.maxStops=a}get unit(){return this.defaultUnit}set unit(a){this._overrideIfSome("unit",a)}get view(){return this.viewModel.view}set view(a){this.viewModel.view=a}castVisibleElements(a){return{...Ub,...a}}acquireSearch(a){const {view:b}=this.viewModel;if(this._stopsToSearches.has(a)){const d=this._stopsToSearches.get(a);d.view=b;this._overrideDefaultSources(d);return d}const c=new bc({view:b,resultGraphicEnabled:!1,popupEnabled:!1,
...this.searchProperties});this._normalizeSearchSources(c);this.addHandles([Y.on(()=>c.allSources,"change",()=>this._normalizeSearchSources(c)),c.on("select-result",()=>{a.geometry=c.selectedResult?.feature.geometry;a.name=c.selectedResult?.name;this._solveRoute()}),c.on("search-focus",()=>this._handleStopInputFocus(c,a)),c.on("search-blur",()=>this._handleStopInputBlur(c,a)),c.on("search-clear",()=>{a.geometry=null;a.name=null;this._activeStop=a;this.viewModel.layer?.removeResult()}),Y.watch(()=>
c.searchTerm,d=>{a.name=d})],c);this._stopsToSearches.set(a,c);return c}getDirections(){return this.viewModel.getDirections()}render(){return m.tsx("div",{class:this.classes(h.css.base,R.globalCss.widget,R.globalCss.panel,h.css.scroller)},this._renderPanelContent())}save(){return this.viewModel.save()}saveAs(a,b={}){return this.viewModel.saveAs(a,b)}zoomToRoute(){return this.viewModel.zoomToRoute()}_renderPanelContent(){const {layer:a,serviceDescription:b,state:c}=this.viewModel;var d="initializing"===
c;const e="error"===c&&!b,f="unauthenticated"===c,g={[h.css.panelContentLoading]:d,[h.css.panelContentError]:e||!a,[h.css.panelContentSignIn]:f},k=d?"presentation":"group";d=a?f?this._renderSignIn():e?this._renderMessage(this._getErrorMessage()):d?this._renderLoader():this._renderReadyContent():this._renderMessage(this.messages.missingLayer);return m.tsx("div",{class:this.classes(h.css.panelContent,g),role:k},d)}_renderReadyContent(){return[this._renderStopsContainer(),this._renderTravelModeOptions(),
this._renderDepartureTimeControls(),this._renderSaveContainer(),this._renderSectionSplitter(),this._renderDirectionsContainer()]}_renderSignIn(){return m.tsx("div",{class:h.css.signInContent,key:"sign-in"},m.tsx(ma.Heading,{class:h.css.contentTitle,level:this.headingLevel},this.messages.widgetLabel),this._renderPlaceholder(),m.tsx(ma.Heading,{level:ma.incrementHeadingLevel(this.headingLevel)},this.messages.signInRequired),m.tsx("button",{bind:this,class:this.classes(R.globalCss.button,R.globalCss.buttonSecondary,
h.css.signInButton),onclick:this._handleSignInClick,tabIndex:0,type:"button"},this.messagesCommon.auth.signIn))}_handleSignInClick(){this.viewModel.load().catch(()=>{})}_renderTravelModeOptions(){if(!this.visibleElements.traveMode)return null;const {selectedTravelMode:a,travelModes:b}=this.viewModel;if(0===b.length)return null;const c=null!=a?a.name:this.messages.travelMode;return m.tsx("div",{"aria-disabled":this._saveLayer.opened.toString(),class:this.classes(h.css.travelMode,this._saveLayer.opened&&
R.globalCss.buttonDisabled),key:"esri-directions__travel-mode-controls",role:"group"},m.tsx("select",{"aria-label":c,bind:this,class:this.classes(h.css.travelModeSelect,R.globalCss.select),key:"esri-directions__travel-mode-options",onchange:this._handleTravelModeChange,title:c},b.map((d,e)=>m.tsx("option",{"data-mode":d,key:`esri-directions__travel-mode-${e}`,selected:a===d,value:`${e}`},d.name))))}_handleTravelModeChange(a){var b=a.currentTarget;a=this.viewModel;b=b.item(b.selectedIndex)?.["data-mode"];
a.selectedTravelMode=b;this._solveRoute()}_renderStopsContainer(){return this.visibleElements.stops?m.tsx("div",{"aria-disabled":this._saveLayer.opened.toString(),class:this.classes(h.css.section,this._saveLayer.opened&&R.globalCss.buttonDisabled),key:"esri-directions__stops-container",role:"group"},this._renderStops()):null}_renderDepartureTimeControls(){if(!this.visibleElements.departureTime)return null;const {messages:{departAt:a,departureTime:b,leaveNow:c,timeUnspecified:d},viewModel:{departureOption:e}}=
this;return m.tsx("div",{"aria-disabled":this._saveLayer.opened.toString(),class:this.classes(h.css.departureTime,this._saveLayer.opened&&R.globalCss.buttonDisabled),key:"esri-directions__departure-time-controls",role:"group"},m.tsx("select",{"aria-label":b,bind:this,class:this.classes(h.css.departureTimeSelect,R.globalCss.select),onchange:this._handleDepartureOptionChange,title:b},m.tsx("option",{selected:e===T.DepartureTimeOption.NOW,value:T.DepartureTimeOption.NOW},c),m.tsx("option",{selected:e===
T.DepartureTimeOption.DEPART_AT,value:T.DepartureTimeOption.DEPART_AT},a),m.tsx("option",{selected:e===T.DepartureTimeOption.UNSPECIFIED,value:T.DepartureTimeOption.UNSPECIFIED},d)),e===T.DepartureTimeOption.DEPART_AT?this._renderTimeControls():null)}_renderStops(){const {stops:a}=this.viewModel.layer;let b=0;for(var c of this._stopsToSearches.keys())a.includes(c)||this._disposeSearch(c);for(var d of a)c=this.acquireSearch(d),"none"!==c.activeMenu&&(b+=1),null!=d.name&&(c.searchTerm=d.name);d=a.toArray().map((e,
f)=>{var g=a.length;const k={[ba.legacyIcon.radioUnchecked]:0<=f&&f<g-1,[ba.legacyIcon.radioChecked]:f===g-1},l={[h.css.lastStopIconContainer]:f===g-1},p={[h.css.validStopRow]:!(1<f&&null==e.geometry)};var q=a.at(f+1),r=f===g-1,y=f===g-2;q=2===g&&0===f||2<g&&!r&&!y||2<g&&y&&null!=q?.geometry||2<g&&r&&null==e.geometry;g=3>g;r=this.acquireSearch(e);({messages:y}=this);const {removeStop:E,reverseStops:J,unlocated:z}=y;var M=null!=e.geometry&&null!=e.name?e.name:z,P=fc.formatNumber(f+1);y=`${y.stopLabel} ${P} (${M})`;
M=`${this.id}__stop--${f}`;e=!!r.searchTerm&&!!r.selectedResult&&null!=e.geometry&&r.selectedResult.name===e.name;P={zIndex:"none"!==r.activeMenu?`${b--}`:""};return m.tsx("li",{afterCreate:this._handleStopFieldCreation,"aria-label":y,bind:this,class:this.classes(h.css.stopRow,p),"data-stop-index":f,id:M,key:f,styles:P},m.tsx("div",{class:h.css.stopHandle},m.tsx("span",{"aria-hidden":"true",class:this.classes(h.css.stopIcon,ba.legacyIcon.handleVertical,h.css.stopHandleIcon,h.css.interactiveStopIcon),
onpointerdown:this._handleDragHandlePointerDown}),m.tsx("div",{"aria-labelledby":M,bind:this,class:this.classes(h.css.stopIconContainer,l),"data-stop-index":f,onclick:this._handleStopIconClick,onkeydown:this._handleStopIconClick,role:"button"},m.tsx("span",{class:this.classes(h.css.stopIcon,k),tabIndex:e?0:void 0}))),m.tsx("div",{class:h.css.stopInput},r.render()),m.tsx("div",{class:h.css.stopOptions,role:"group"},m.tsx("div",{"aria-label":E,bind:this,class:h.css.removeStopButton,"data-stop-index":f,
hidden:g,onclick:this._handleRemoveStop,onkeydown:this._handleRemoveStop,role:"button",tabIndex:0,title:E},m.tsx("span",{"aria-hidden":"true",class:this.classes(h.css.stopIcon,h.css.removeStop,ba.legacyIcon.trash,h.css.interactiveStopIcon)}),m.tsx("span",{class:ba.legacyIcon.fontFallbackText},"removeStopTitle")),m.tsx("div",{"aria-label":J,bind:this,class:h.css.reverseStops,hidden:q,onclick:this._handleReverseStops,onkeydown:this._handleReverseStops,role:"button",tabIndex:0,title:J},m.tsx("span",
{"aria-hidden":"true",class:this.classes(h.css.stopIcon,ba.legacyIcon.upDownArrows,h.css.interactiveStopIcon)}),m.tsx("span",{class:ba.legacyIcon.fontFallbackText},"removeStopTitle"))))});c=this._renderAddStop();return m.tsx("div",null,m.tsx("ol",{afterCreate:this._setUpDragAndDropStops,class:h.css.stops,role:"group"},d),c)}_renderAddStop(){var a=this.viewModel.layer?.stops;if(!a)return null;const b=a.filter(({geometry:c})=>null!=c);a=a.at(-1);return 1<b.length&&b.length<this.maxStops&&null!=a?.geometry?
m.tsx("div",{class:h.css.toolbarSection},m.tsx("div",{class:h.css.toolbarButtons},m.tsx("calcite-button",{appearance:"outline",class:h.css.addStopButton,iconStart:"plus",key:h.css.addStopButton,kind:"neutral",label:this.messages.addStop,onclick:()=>{this._addNewPlaceholder()},round:!0,scale:"s",width:"full"},this.messages.addStop))):null}_handleStopIconClick(a){a=kb(a.currentTarget);a=null!=a?this.viewModel.layer?.stops.at(a):void 0;a?.geometry&&this._centerAtStop(a)}_handleClearRouteClick(){this.viewModel.reset()}_centerAtStop(a){this.viewModel.centerAt(a)}_handleStopFieldCreation(a){const b=
this._newPlaceholderStop;if(b){a=kb(a);a=null!=a?this.viewModel.layer?.stops.at(a):void 0;if(b===a){const c=this.acquireSearch(a);c.when(()=>{this.renderNow();c.focus()})}this._newPlaceholderStop=null}}_handleStopInputBlur(a,b){if(!this._saveLayer.opened)if(this.removeHandles("search-term"),a.selectedResult&&null!=b.geometry&&null!=a.selectedResult?.feature.geometry&&b.geometry===a.selectedResult?.feature.geometry)this._pointerDownUpHandle?.pause();else{var c=null!=b.geometry&&null!=a.selectedResult?.feature.geometry&&
b.geometry!==a.selectedResult?.feature.geometry;(null==b.geometry&&null==a.selectedResult?.feature.geometry||c)&&"none"===a.activeMenu&&a.searchTerm?(a.search(),this._pointerDownUpHandle?.pause()):a.searchTerm||(this._viewClickHandle?.resume(),clearTimeout(this._autoStopRemovalTimeoutId),this._autoStopRemovalTimeoutId=setTimeout(()=>{this.destroyed||(this._viewClickHandle?.pause(),"searching"===a.viewModel.state?this._pointerDownUpHandle?.pause():this._pointerPressedSearchSuggestionStop||(null!=b.geometry&&
(b.geometry=null,this._solveRoute()),this.scheduleRender()))},this._autoStopRemovalDelay))}}_handleStopInputFocus(a,b){this._pointerDownUpHandle?.resume();const {view:c}=this;if(!this.hasHandles("search-term")&&c){var d=c.cursor;this.addHandles([Vb.makeHandle(()=>{c.cursor=d}),Y.watch(()=>a.searchTerm,e=>{a.destroyed||(c.cursor=e.length?d:"copy")},Y.initial)],"search-term");this._activeStop=b}}_prepViewClick(){const {view:a}=this.viewModel;ub.assertIsSome(a);ub.assertIsSome(a.surface);const b=wa.pausable(a,
"click",this._handleViewClick.bind(this)),c=wa.pausable(a.surface,"click",()=>{clearTimeout(this._autoStopRemovalTimeoutId);c.pause()});return{remove(){c.remove();b.remove()},pause(){c.pause();b.pause()},resume(){c.resume();b.resume()}}}_prepPointerDownUpClick(){const a=wa.pausable(document,"pointerdown",c=>{this._pointerPressedSearchSuggestionStop=Jb(c)?this._activeStop:null}),b=wa.pausable(document,"pointerup",c=>{this._pointerDownUpHandle?.pause();c=Jb(c);const d=this._activeStop;c||d!==this._pointerPressedSearchSuggestionStop||
this._removeStop(d);this.scheduleRender();this._pointerPressedSearchSuggestionStop=c?d:null});return{remove(){b.remove();a.remove()},pause(){b.pause();a.pause()},resume(){a.resume()}}}_handleViewClick(a){a.stopPropagation();const b=this._activeStop,c=b?this._stopsToSearches.get(b):null;b&&c&&!c.searchTerm&&(c.search(a.mapPoint).then(d=>{if(d=d?.results[0].results){var {feature:e,name:f}=d[0];b.geometry=e.geometry;b.name=f;c.searchTerm=f}}),this.scheduleRender());this._viewClickHandle?.pause();clearTimeout(this._autoStopRemovalTimeoutId)}_addNewPlaceholder(){this._pointerDownUpHandle?.pause();
if(!this._newPlaceholderStop){var a=new $b({symbol:new ac});this.viewModel.layer?.stops.add(a);this._newPlaceholderStop=a}}_handleReverseStops(){this._reverseStops()}_reverseStops(){const a=this.viewModel.layer?.stops??[];a.reverse();for(const b of a)b.sequence=null;this._solveRoute()}_handleRemoveStop(a){var {layer:b}=this.viewModel;if(b&&(a=kb(a.currentTarget),null!=a)){var {stops:c,routeInfo:d}=b;b=c.at(a);this._removeStop(b);null==b.geometry&&null!=d||this._solveRoute()}}_removeStop(a){const {stops:b}=
this.viewModel.layer;!a||2>=b.length||(this._disposeSearch(a),b.remove(a))}_handleDepartureOptionChange(a){a=a.currentTarget;a=a.item(a.selectedIndex);this.viewModel.departureOption=a.value;this._solveRoute()}_renderTimeControls(){return this.viewModel.departureIsoDate&&this.viewModel.departureIsoTime?m.tsx("div",{class:h.css.departureTimeControls,key:h.css.departureTimeControls,role:"group"},m.tsx("div",{class:h.css.departureDateTimePickers},m.tsx("calcite-input-date-picker",{valueAsDate:pc(this.viewModel.departureIsoDate),
onCalciteInputDatePickerChange:({target:a})=>{this.viewModel.departureIsoDate=a.value;this._solveRoute()}}),m.tsx("calcite-input-time-picker",{value:this.viewModel.departureIsoTime,onCalciteInputTimePickerChange:({target:a})=>{this.viewModel.departureIsoTime=a.value;this._solveRoute()}}))):null}_renderSectionSplitter(){return m.tsx("div",{class:h.css.sectionSplitter})}_renderSaveContainer(){const {saveButton:a,saveAsButton:b,printButton:c,layerDetails:d}=this.visibleElements;return a||b||c||d?m.tsx("div",
{class:h.css.saveSection,key:h.css.saveSection},this._renderSaveButtons(),this._renderRouteLayerDetailsLink()):null}_renderSaveButtons(){const {saveButton:a,saveAsButton:b,printButton:c}=this.visibleElements;return a||b||c?m.tsx("div",{class:h.css.saveButtons,key:h.css.saveButtons},this._renderSaveButton(),this._renderSaveAsButton(),this._renderPrintButton()):null}_renderSaveButton(){if(!this.visibleElements.saveButton)return null;const {portalItem:a,routeInfo:b}=this.viewModel.layer,c=a?.itemControl;
return m.tsx("calcite-button",{appearance:"outline",class:h.css.saveButton,disabled:!(null!=b&&("admin"===c||"update"===c)),iconStart:"save",key:h.css.saveButton,label:this.messagesCommon.save,onclick:()=>{this._handleSaveButtonClick()},width:"full"},this.messagesCommon.save)}_renderSaveAsButton(){return this.visibleElements.saveAsButton?m.tsx("div",{class:h.css.saveAsButtonPopover,key:h.css.saveAsButtonPopover},m.tsx("calcite-button",{afterCreate:a=>{this._saveAsButtonNode=a},appearance:"outline",
class:h.css.saveAsButton,disabled:null==this.viewModel.layer.routeInfo,iconStart:"duplicate",key:h.css.saveAsButton,label:this.messagesCommon.saveAs,onclick:()=>this._handleSaveAsButtonClick(),width:"full"},this.messagesCommon.saveAs)):null}_renderSavePopover(){return m.tsx("calcite-popover",{class:h.css.savePopover,label:this._saveLayer.label,open:this._saveLayer.opened,overlayPositioning:"fixed",referenceElement:this._saveAsButtonNode,triggerDisabled:!0},this._saveLayer.render())}_handleSaveAsButtonClick(){this._saveLayer.opened?
this._saveLayer.close():this._saveLayer.open(this.viewModel.layer)}_renderPrintButton(){return this.visibleElements.printButton?m.tsx("calcite-button",{appearance:"outline",class:h.css.printButton,iconStart:"print",key:h.css.printButton,label:this.messagesCommon.print}):null}_renderRouteLayerDetailsLink(){if(!this.visibleElements.layerDetails)return null;const {portalItem:a}=this.viewModel.layer;if(!a)return null;const {id:b,portal:{url:c}}=a;return m.tsx("calcite-link",{class:h.css.layerDetailsLink,
href:`${c}/home/item.html?id=${b}`,key:h.css.layerDetailsLink,target:"_blank"},this.messages.viewLayerDetails)}_handleSaveButtonClick(){this.viewModel.layer.save()}_renderDirectionsContainer(){return m.tsx("div",{class:this.classes(h.css.directionsSection,h.css.section),key:"esri-directions__container"},this._renderDirectionsContainerContent())}_renderLoader(){return m.tsx("div",{class:h.css.loader,key:"loader"})}_renderWarningCard(){return m.tsx("div",{class:h.css.warningCard,role:"alert"},m.tsx("div",
{class:h.css.warningHeader},m.tsx("span",{"aria-hidden":"true",class:ba.legacyIcon.noticeTriangle}),m.tsx(ma.Heading,{class:h.css.warningHeading,level:this.headingLevel},this.messagesCommon.warning)),m.tsx("div",{class:h.css.warningMessage},this._getErrorMessage()))}_renderDirectionsContainerContent(){const {layer:a,state:b}=this.viewModel,c="routing"===b;return"error"===b?this._renderWarningCard():c?this._renderLoader():null!=a.directionLines?m.tsx("div",{"aria-disabled":this._saveLayer.opened.toString(),
class:this.classes(h.css.summary,this._saveLayer.opened&&R.globalCss.buttonDisabled),key:h.css.summary,role:"group"},this._renderCosts(),this._renderRouteActions(),this._renderManeuverSections()):m.tsx("div",{class:R.globalCss.empty,key:"esri-directions__placeholder"},this._renderPlaceholder(),m.tsx(ma.Heading,{class:h.css.message,level:this.headingLevel},this.messages.directionsPlaceholder))}_renderPlaceholder(){return m.tsx("svg",{class:R.globalCss.emptyIllustration,viewBox:"0 0 256 256",xmlns:"http://www.w3.org/2000/svg"},
m.tsx("path",{d:"M192 36c-15.477 0-24 6.034-24 16.99v45.822l24 24 24-24v-45.82C216 42.033 207.477 36 192 36zm20 61.155l-20 20-20-20V52.99c0-8.62 6.73-12.99 20-12.99s20 4.37 20 12.99zM192 52a12 12 0 1 0 12 12 12.013 12.013 0 0 0-12-12zm0 20a8 8 0 1 1 8-8 8.008 8.008 0 0 1-8 8zM92 140.99C92 130.035 83.477 124 68 124s-24 6.034-24 16.99v45.822l24 24 24-24zm-4 44.165l-20 20-20-20V140.99c0-8.62 6.73-12.99 20-12.99s20 4.37 20 12.99zM68 140a12 12 0 1 0 12 12 12.013 12.013 0 0 0-12-12zm0 20a8 8 0 1 1 8-8 8.008 8.008 0 0 1-8 8zm84-44h16v4h-16zm-24 80h4v12h-12v-4h8zm0-28h4v16h-4zm0-52h12v4h-8v8h-4zm0 24h4v16h-4zm-36 64h16v4H92z",
fill:"currentcolor"}))}_renderMessage(a){return m.tsx(ma.Heading,{class:h.css.messageHeading,level:this.headingLevel},a)}_renderRouteActions(){return m.tsx("div",{class:h.css.routeActions},m.tsx("button",{"aria-label":this.messages.clearRoute,bind:this,class:this.classes(h.css.clearRouteButton,R.globalCss.button,R.globalCss.buttonTertiary),onclick:this._handleClearRouteClick,tabIndex:0,type:"button"},this.messages.clearRoute))}_getSections(){var {layer:a}=this.viewModel;if(!a)return null;const {directionPoints:b,
directionLines:c,stops:d}=a;if(null==b||null==c)return null;a=[];let e=null;for(const g of b){const {objectId:k,stopId:l}=g;if(null!=l){var f=d.find(({objectId:q})=>q===l);const p=0===a.length;if(null==e||e.stop!==f)e={stop:f,directions:[],open:p},a.push(e)}else null!=e&&(f=c.find(({directionPointId:p})=>p===k),null!=f&&e.directions.push({directionPoint:g,directionLine:f}))}return a}_renderManeuverSections(){return null==this._sections?null:m.tsx("div",{class:h.css.maneuvers,role:"group"},this._sections.map((a,
b)=>{const {open:c}=a;let d;0<a.directions.length&&c&&(d=m.tsx("ol",{class:h.css.maneuverList},a.directions.map(l=>this._renderManeuver(l))));var e=2<this._sections.length;const f=b===this._sections.length-1,g={[h.css.collapsibleSection]:e},k={[ba.legacyIcon.down]:!c,[ba.legacyIcon.up]:c};e&&!f?(e=c?this.messagesCommon.close:this.messagesCommon.open,a=m.tsx("header",{class:this.classes(h.css.maneuverSectionHeader,h.css.maneuverSectionToggle),key:h.css.maneuverSectionHeader},m.tsx("div",{"aria-expanded":c.toString(),
"aria-label":e,bind:this,class:h.css.maneuverSectionHeaderButton,"data-maneuver-section":a,onclick:this._handleSectionToggle,onkeydown:this._handleSectionToggle,role:"button",tabIndex:0,title:e},m.tsx(ma.Heading,{class:h.css.maneuverSectionTitle,level:this.headingLevel},a.stop.name),m.tsx("span",{"aria-hidden":"true",class:this.classes(k)})))):a=m.tsx("header",{class:h.css.maneuverSectionHeader,key:h.css.maneuverSectionHeader},m.tsx(ma.Heading,{class:h.css.maneuverSectionTitle,level:this.headingLevel},
a.stop.name));return m.tsx("section",{class:this.classes(h.css.maneuverSection,g),key:b},a,d)}))}_handleSectionToggle(a){if(a=a.currentTarget?.["data-maneuver-section"])a.open=!a.open}_renderCosts(){var a=this._getCostSummary();const {directionPoints:b}=this.viewModel.layer;if(null==b||null==a)return null;const {distance:c,duration:d}=a,{primaryCosts:e,secondaryCosts:f,zoomToRoute:g}=this.messages;a=this._renderEta();return m.tsx("div",{"aria-label":g,bind:this,class:h.css.directionCosts,onclick:this._handleSummaryInteraction,
onkeydown:this._handleSummaryInteraction,role:"button",tabIndex:0,title:g},m.tsx("div",{class:h.css.costsDetails,role:"group"},m.tsx("div",{class:h.css.primaryCosts,title:e},d),m.tsx("div",{class:h.css.verticalSplitter}),m.tsx("div",{class:h.css.secondaryCosts,title:f},c)),a)}_renderEta(){return this.viewModel.departureOption===T.DepartureTimeOption.UNSPECIFIED?null:m.tsx("div",{class:h.css.arrivalTimeContainer,title:this.messages.eta},m.tsx("span",{class:h.css.arrivalTime},this.viewModel.formattedEta))}_handleSummaryInteraction(){this._focusedManeuver=
this._activeManeuver=null;this.viewModel.clearHighlights();this.zoomToRoute()}_getErrorMessage(){switch(this.viewModel.lastError?.name){case "directions-view-model:unable-to-route":return this.messages.errors.unableToRoute;case "directions-view-model:service-metadata-unavailable":return this.messages.errors.unableToLoadServiceMetadata;default:return this.messages.errors.unknownError}}_normalizeSearchSources(a){this._overrideDefaultSources(a);this._applyLocatorSourceOverrides(a)}_overrideDefaultSources(a){a.viewModel.defaultSources.forEach(b=>
{b.autoNavigate=!1})}_applyLocatorSourceOverrides({allSources:a}){for(const b of a)if("url"in b&&b.url){let c;(c=b).locationType??(c.locationType="street");wb.isArcGISWorldGeocoder(b.url)&&this.apiKey&&null==b.apiKey&&(b.apiKey=this.apiKey,b.url=wb.meteredArcGISLocatorUrl)}}_disposeSearch(a){if(a&&this._stopsToSearches.has(a)){var b=this._stopsToSearches.get(a);this.removeHandles(b);b.destroy();this._stopsToSearches.delete(a)}}_renderManeuver(a){const {directionPoint:b,directionLine:c}=a,{distance:d,
duration:e}=c,{messages:f,messagesUnits:g,unit:k}=this;a=T.formatDistance(g,d??0,k);var l=T.formatDuration(e??0);a=a&&l?`${a}&nbsp;&middot;&nbsp;${l}`:`${a}${l}`;l=oc(b);const {objectId:p,directionPointType:q}=b,r=T.getIconName(q),y=`${h.css.intermediateCost}-${p}`;return m.tsx("li",{"aria-labelledby":`${`${h.css.maneuver}-${p}`} ${y}`,bind:this,class:this.classes(h.css.maneuver,{[h.css.maneuverActive]:this._activeManeuver===c}),"data-maneuver":c,key:c,onblur:this._handleManeuverBlur,onclick:this._handleManeuverClick,
onfocus:this._handleManeuverFocus,onkeydown:this._handleManeuverClick,onmouseout:this._handleManeuverMouseOut,onmouseover:this._handleManeuverMouseOver,tabIndex:0},m.tsx("calcite-icon",{alt:"",class:h.css.maneuverIcon,icon:r}),m.tsx("div",{class:h.css.maneuverCostsContainer},l,m.tsx("div",{class:h.css.maneuverCosts},m.tsx("div",{class:h.css.horizontalSplitter}),m.tsx("div",{"aria-hidden":"true",class:h.css.intermediateCost,id:y,innerHTML:a,title:f.intermediateCosts}))))}_handleManeuverClick(a){if(a=
a.currentTarget?.["data-maneuver"])if(this._activeManeuver===a)this._activeManeuver=null,this.zoomToRoute();else{this._activeManeuver=a;var {geometry:b}=a;this.viewModel.centerAt(b);this.viewModel.highlight(a)}}_handleManeuverMouseOver(a){this._activeManeuver||this._focusedManeuver||(a=a.currentTarget?.["data-maneuver"])&&this.viewModel.highlight(a)}_handleManeuverMouseOut(){this._activeManeuver||this._focusedManeuver||this.viewModel.clearHighlights()}_handleManeuverBlur(){this._activeManeuver||(this._focusedManeuver=
null,this.viewModel.clearHighlights())}_handleManeuverFocus(a){!this._activeManeuver&&(a=a.currentTarget?.["data-maneuver"])&&(this._focusedManeuver=a,this.viewModel.highlight(a))}_getCostSummary(){const {messagesUnits:a,unit:b,viewModel:c}=this;var {routeInfo:d}=c.layer;if(null==d)return null;var e=d.totalDuration??0;d=T.formatDistance(a,d.totalDistance??0,b);e=T.formatDuration(e);return{distance:d,duration:e}}async _solveRoute(){this.viewModel.updateDepartureTime();const a=this.viewModel.layer?.stops.filter(({geometry:b})=>
null!=b);if(a&&!(2>a.length))try{await this.viewModel.getDirections()}catch{}}};C.__decorate([K.property()],B.prototype,"apiKey",null);C.__decorate([K.property(Zb.defaultUnitPropertyMetadata)],B.prototype,"defaultUnit",void 0);C.__decorate([K.property()],B.prototype,"goToOverride",null);C.__decorate([K.property()],B.prototype,"headingLevel",void 0);C.__decorate([K.property()],B.prototype,"icon",null);C.__decorate([K.property()],B.prototype,"label",null);C.__decorate([K.property({readOnly:!0})],B.prototype,
"lastRoute",null);C.__decorate([K.property()],B.prototype,"layer",null);C.__decorate([K.property()],B.prototype,"maxStops",null);C.__decorate([K.property(),cb.messageBundle("esri/widgets/Directions/t9n/Directions")],B.prototype,"messages",void 0);C.__decorate([K.property(),cb.messageBundle("esri/t9n/common")],B.prototype,"messagesCommon",void 0);C.__decorate([K.property(),cb.messageBundle("esri/core/t9n/Units")],B.prototype,"messagesUnits",void 0);C.__decorate([K.property()],B.prototype,"searchProperties",
void 0);C.__decorate([K.property()],B.prototype,"unit",null);C.__decorate([K.property()],B.prototype,"view",null);C.__decorate([K.property({type:vb})],B.prototype,"viewModel",void 0);C.__decorate([K.property()],B.prototype,"visibleElements",void 0);C.__decorate([Xb.cast("visibleElements")],B.prototype,"castVisibleElements",null);C.__decorate([ra.accessibleHandler()],B.prototype,"_handleStopIconClick",null);C.__decorate([ra.accessibleHandler()],B.prototype,"_handleClearRouteClick",null);C.__decorate([ra.accessibleHandler()],
B.prototype,"_handleReverseStops",null);C.__decorate([ra.accessibleHandler()],B.prototype,"_handleRemoveStop",null);C.__decorate([ra.accessibleHandler()],B.prototype,"_handleSectionToggle",null);C.__decorate([ra.accessibleHandler()],B.prototype,"_handleSummaryInteraction",null);C.__decorate([ra.accessibleHandler()],B.prototype,"_handleManeuverClick",null);return B=C.__decorate([Yb.subclass("esri.widgets.Directions")],B)});
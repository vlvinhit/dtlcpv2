// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.30/esri/copyright.txt for details.
//>>built
define("../../chunks/tslib.es6 ../../core/Error ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../renderers/support/authoringInfoUtils ../../renderers/visualVariables/support/ColorSizeStop ../../renderers/visualVariables/support/ColorStop ../../renderers/visualVariables/support/SizeStop ./SmartMappingSliderBase ./ColorSizeSlider/ColorSizeSliderViewModel ./support/utils ../support/globalCss ../support/widgetUtils ../support/decorators/messageBundle ../support/jsxFactory".split(" "),
function(t,B,v,p,O,P,H,C,D,E,F,I,J,G,z,K,L,u){var A;p=A=class extends I.SmartMappingSliderBase{constructor(a,b){super(a,b);this._backgroundFillColor="#e0e0e0";this._minRampFillWidth=.2;this._rampNode=null;this._maxRampFillWidth=1;this.messages=null;this.viewModel=new J;this._bgFillId=`${this.id}-bg-fill`;this._rampFillId=`${this.id}-linear-gradient`}get handlesSyncedToPrimary(){return this.viewModel.handlesSyncedToPrimary}set handlesSyncedToPrimary(a){this.viewModel.handlesSyncedToPrimary=a}get label(){return this.messages?.widgetLabel??
""}set label(a){this._overrideIfSome("label",a)}get persistSizeRangeEnabled(){return this.viewModel.persistSizeRangeEnabled}set persistSizeRangeEnabled(a){this.viewModel.persistSizeRangeEnabled=a}get primaryHandleEnabled(){return this.viewModel.primaryHandleEnabled}set primaryHandleEnabled(a){this.viewModel.primaryHandleEnabled=a}get stops(){return this.viewModel.stops}set stops(a){this.viewModel.stops=a}static fromRendererResult(a,b){const g=a.size.visualVariables;var c=a.renderer.authoringInfo?.univariateTheme;
const e=a.color?.visualVariable.stops,{statistics:h}=a,{avg:d,stddev:k}=h;if(!e)throw new B("ColorSizeSlider-fromRendererResult:invalid-renderer-result","'result' must include 'color' variable.");c="above-and-below"===c;const [q,n]=C.authoringInfoFirstVariableSliderMinMax(a.renderer.authoringInfo),l=g.find(f=>"outline"!==f?.target&&!(f?.axis&&!f?.field&&!f?.valueExpression)&&(f?.field||f?.valueExpression)),m=l.stops;a=e.map((f,r)=>{const {color:w,label:x,value:y}=f;return new D({color:w,label:x,value:y,
size:m&&0<m.length?m[r].size:0===r?l.minSize:r===e.length-1?l.maxSize:null})});return new A({max:n,min:q,stops:a,primaryHandleEnabled:c,handlesSyncedToPrimary:c,persistSizeRangeEnabled:c,histogramConfig:{average:d??void 0,standardDeviation:k??void 0,bins:b?b.bins:[]}})}updateFromRendererResult(a,b){const g=a.size.visualVariables;var c=a.renderer.authoringInfo?.univariateTheme;const e=a.color?.visualVariable.stops,{statistics:h}=a,{avg:d,stddev:k}=h;if(!e)throw new B("ColorSizeSlider-fromRendererResult:invalid-renderer-result",
"'result' must include 'color' variable.");c="above-and-below"===c;const [q,n]=C.authoringInfoFirstVariableSliderMinMax(a.renderer.authoringInfo),l=g.find(f=>"outline"!==f?.target&&!(f?.axis&&!f?.field&&!f?.valueExpression)&&(f?.field||f?.valueExpression)),m=l.stops;a=e.map((f,r)=>{const {color:w,label:x,value:y}=f;return new D({color:w,label:x,value:y,size:m&&0<m.length?m[r].size:0===r?l.minSize:r===e.length-1?l.maxSize:null})});this.set({max:n,min:q,stops:a,primaryHandleEnabled:c,handlesSyncedToPrimary:c,
persistSizeRangeEnabled:c,histogramConfig:{average:d,standardDeviation:k,bins:b?b.bins:[]}})}updateRenderer(a){const {stops:b}=this,g=b[0],c=b[b.length-1];var e=b[Math.floor(b.length/2)];a=a.clone();const h=a.visualVariables.map(d=>{if("size"===d.type){if("outline"===d?.target||d?.axis&&!d?.field&&!d?.valueExpression)return d;null!=d.minSize&&null!=d.maxSize?d.set({maxDataValue:c.value,minDataValue:g.value,maxSize:c.size,minSize:g.size}):d.stops&&d.set({stops:b.map(k=>{const {label:q,size:n,value:l}=
k;return new F({label:q,size:n,value:l})})})}else"color"===d.type&&d.set({stops:this.stops.map(k=>{const {color:q,label:n,value:l}=k;return new E({color:q,label:n,value:l})})});return d});a.visualVariables=h;1<a.classBreakInfos.length&&(e=e.value,a.classBreakInfos[0].maxValue=e,a.classBreakInfos[1].minValue=e);return a}updateVisualVariables(a){return a.map(b=>{const g=b.clone();if("size"===b.type){if("outline"===b?.target||b?.axis&&!b?.field&&!b?.valueExpression)return g;if(null!=b.minSize&&null!=
b.maxSize){var {stops:c}=this;b=c[0];c=c[c.length-1];g.set({maxDataValue:c.value,minDataValue:b.value,maxSize:c.size,minSize:b.size})}else b.stops&&g.set({stops:this.stops.map(e=>{const {label:h,size:d,value:k}=e;return new F({label:h,size:d,value:k})})})}else"color"===b.type&&g.set({stops:this.stops.map(e=>{const {color:h,label:d,value:k}=e;return new E({color:h,label:d,value:k})})});return g})}render(){const {label:a,primaryHandleEnabled:b,state:g,visibleElements:c}=this,e="disabled"===g,h=this.classes("esri-color-size-slider",
z.globalCss.widget,z.globalCss.panel,{[z.globalCss.disabled]:e,["esri-color-size-slider--primary-handle"]:b,["esri-color-size-slider--interactive-track"]:!!c.interactiveTrack});return u.tsx("div",{"aria-label":a,class:h},e?null:this.renderContent(this._renderRamp(),"esri-color-size-slider__slider-container","esri-color-size-slider__histogram-container"))}_renderRamp(){const {_bgFillId:a,_rampFillId:b,viewModel:g,zoomOptions:c}=this,e=g.getStopInfo();return u.tsx("div",{afterCreate:K.storeNode,bind:this,
class:"esri-color-size-slider__ramp","data-node-ref":"_rampNode"},u.tsx("svg",{xmlns:"http://www.w3.org/2000/svg"},u.tsx("defs",null,this.renderRampFillDefinition(b,e),this.renderBackgroundFillDefinition(a)),u.tsx("rect",{fill:this._backgroundFillColor,height:"100%",width:"100%",x:"0",y:"0"}),this._renderPaths()),c?this.renderZoomCaps():null)}_renderPaths(){if(this._rampNode){var {offsetHeight:a=0,offsetWidth:b=0}=this._rampNode;if(null!=a&&null!=b){var {primaryHandleEnabled:g,stops:c,values:e,viewModel:{max:h,
min:d},_bgFillId:k,_maxRampFillWidth:q,_minRampFillWidth:n,_rampFillId:l}=this,m=[q,n];c[0].size<c[c.length-1].size&&m.reverse();var f=e.slice().sort((M,N)=>M>N?1:-1),[r,w]=m,[x,y]=f;m=g?G.getDynamicPathForSizeStops({max:h,min:d,pathHeight:a,pathWidth:b,stops:c,padding:n}):G.getPathForSizeStops({bottomValue:x,bottomWidth:r,max:h,min:d,pathHeight:a,pathWidth:b,topValue:y,topWidth:w});return[u.tsx("path",{d:m,fill:`url(#${k})`,key:"background"}),u.tsx("path",{d:m,fill:`url(#${l})`,key:"fill"})]}}}};
t.__decorate([v.property()],p.prototype,"label",null);t.__decorate([v.property(),L.messageBundle("esri/widgets/smartMapping/ColorSizeSlider/t9n/ColorSizeSlider")],p.prototype,"messages",void 0);t.__decorate([v.property()],p.prototype,"persistSizeRangeEnabled",null);t.__decorate([v.property()],p.prototype,"primaryHandleEnabled",null);t.__decorate([v.property()],p.prototype,"stops",null);t.__decorate([v.property()],p.prototype,"viewModel",void 0);return p=A=t.__decorate([H.subclass("esri.widgets.smartMapping.ColorSizeSlider")],
p)});
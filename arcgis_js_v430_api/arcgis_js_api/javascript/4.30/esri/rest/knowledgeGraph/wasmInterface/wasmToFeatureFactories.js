// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.30/esri/copyright.txt for details.
//>>built
define(["exports","../ProtoFeatureCollection","./WasmDataModelWrapperInterfaces","./WasmSerializedLayerData"],function(n,p,r,w){function t(a){const e=new p.CompressedGeometry;e.geometryType=r.EsriGeometryTypes[a.geometry_type.value];const c=[],d=[];for(var b=0;b<a.lengths.length;b++)c.push(a.lengths[b]);for(b=0;b<a.coords.length;b++)d.push(a.coords[b]);e.lengths=c;e.coords=d;return e}function u(a){const e=new p.Field;e.name=a.name;e.alias=a.alias;e.fieldType=r.EsriFieldTypes[a.field_type.value];e.sqlType=
w.SqlTypeCode[a.sql_type.value];e.domain=a.domain;e.defaultValue=a.default_value;return e}function x(a){const e=u(a);e.geometryType=r.EsriGeometryTypes[a.geometry_type.value];return e}function y(a){const e=new p.Transform;e.quantizeOriginPosition=w.WasmQuantizeOriginPositionTypeCode[a.quantizeOriginPosition.value];var c=e.scale;const d=a.scale;c.xScale=d.xScale;c.yScale=d.yScale;c.mScale=d.mScale;c.zScale=d.zScale;c=e.translate;a=a.translate;c.xTranslate=a.xTranslate;c.yTranslate=a.yTranslate;c.mTranslate=
a.mTranslate;c.zTranslate=a.zTranslate;return e}n.wasmToCompressedGeometry=t;n.wasmToField=u;n.wasmToGeometryField=x;n.wasmToProtoFeatureCollection=function(a){const e=new p.ProtoFeatureCollection;e.version=a.version;a=a.get_query_result();if(0!==a.results_type.value)throw Error("Got a non-feature collection type");a=a.get_feature_result();var c=e.queryResult.featureResult;c.objectIdFieldName=a.objectid_field_name;c.exceededTransferLimit=a.exceeded_transfer_limit;c.hasM=a.has_m;c.hasZ=a.has_z;c.geometryType=
r.EsriGeometryTypes[a.geometry_type.value];c.globalIdFieldName=a.globalid_field_name;c.geohashFieldName=a.geohash_field_name;var d=c.uniqueIdField,b=a.unique_id_field;d.name=b.name;d.isSystemMaintained=b.isSystemMaintained;d=c.geometryProperties;b=a.geometry_properties;d.shapeAreaFieldName=b.shapeAreaFieldName;d.shapeLengthFieldName=b.shapeLengthFieldName;d.units=b.units;d=c.spatialReference;b=a.spatial_reference;d.wkid=b.wkid;d.latestWkid=b.latestWkid;d.vcsWkid=b.vcsWkid;d.latestVcsWkid=b.latestVcsWkid;
d.wkt=b.wkt;c.transform=y(a.transform);d=c.fields;var h=c.fieldNameToAttributeIndexMap;b=a.fields;var g=b.size();for(var f=0;f<g;f++){var k=b.get(f),l=u(k);d.push(l);h[l.name]=f;k.delete()}b.delete();d=c.values;b=a.values_count();for(g=0;g<b;g++)d.push(a.get_value_at(g));d=c.features;b=a.features;g=b.size();if(0<g)for(var m of p.ProtoInboundFeatureCollectionRequiredAttributes)if(void 0===h[m])throw Error(`Feature collection missing required attribute: ${m}`);for(m=0;m<g;m++){h=new p.Feature;f=b.get(m);
k=h.attributes;l=f.attributes_count();for(var q=0;q<l;q++)k.push(f.get_attribute_at(q));if(k=f.get_compressed_geometry())h.compressedGeometry=t(k),h.centroid=t(f.get_centroid());k=h.aggregateGeometries;l=f.aggregate_geometries;q=l.size();for(let v=0;v<q;v++){const z=l.get(v),A=t(z);k.push(A);z.delete()}l.delete();d.push(h);f.delete()}b.delete();c=c.geometryFields;a=a.geometry_fields;m=a.size();for(d=0;d<m;d++)b=a.get(d),g=x(b),c.push(g),b.delete();a.delete();return e};n.wasmToTransform=y;Object.defineProperty(n,
Symbol.toStringTag,{value:"Module"})});
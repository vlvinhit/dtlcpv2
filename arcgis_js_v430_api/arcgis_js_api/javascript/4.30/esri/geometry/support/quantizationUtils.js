// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.30/esri/copyright.txt for details.
//>>built
define(["exports","./jsonUtils"],function(h,B){function u(a){if("lowerLeft"===a.originPosition&&4===a.scale.length&&4===a.translate.length)return a;const {originPosition:b,scale:c,translate:d}=a;a=c[1]??1;return{originPosition:"lowerLeft",scale:[c[0]??1,"lowerLeft"===b?a:-a,c[2]??1,c[3]??1],translate:[d[0]??0,d[1]??0,d[2]??0,d[3]??0]}}function r({scale:a,translate:b},c){return Math.round((c-b[0])/a[0])}function t({scale:a,translate:b},c){return Math.round((c-b[1])/a[1])}function x({scale:a,translate:b},
c){return Math.round(((c??0)-b[2])/a[2])}function y({scale:a,translate:b},c){return c?Math.round((c-b[3])/a[3]):0}function D(a,b){return a&&b?K:a&&!b?L:!a&&b?M:N}function v({scale:a,translate:b},c){return c*a[0]+b[0]}function w({scale:a,translate:b},c){return c*a[1]+b[1]}function z({scale:a,translate:b},c){return(c??0)*a[2]+b[2]}function A({scale:a,translate:b},c){return c?c*a[3]+b[3]:0}function E(a,b){return a&&b?O:a&&!b?P:!a&&b?Q:R}function F(a,b,c){const d=Array(c.length);for(let e=0;e<c.length;e++)d[e]=
b(a,c[e]);return d}function G(a,b,c){let [d,e]=c[0],f=Math.min(d,b[0]),g=Math.min(e,b[1]),l=Math.max(d,b[2]);b=Math.max(e,b[3]);for(let m=1;m<c.length;m++){const [k,n]=c[m];d+=k;e+=n;0>k&&(f=Math.min(f,d));0<k&&(l=Math.max(l,d));0>n?g=Math.min(g,e):0<n&&(b=Math.max(b,e))}a[0]=f;a[1]=g;a[2]=l;a[3]=b;return a}function H(a,b){if(!b.length)return null;a[0]=a[1]=Number.POSITIVE_INFINITY;a[2]=a[3]=Number.NEGATIVE_INFINITY;for(let c=0;c<b.length;c++)G(a,a,b[c]);return a}function S(a,b,c){a=u(a);b.xmin=r(a,
c.xmin);b.ymin=t(a,c.ymin);b.xmax=r(a,c.xmax);b.ymax=t(a,c.ymax);c.hasZ&&(b.zmin=x(a,c.zmin),b.zmax=x(a,c.zmax));c.hasM&&(b.mmin=y(a,c.mmin),b.mmax=y(a,c.mmax));b.hasZ=c.hasZ??!1;b.hasM=c.hasM??!1;return b}function T(a,b,c){a=u(a);b.points=D(c.hasZ,c.hasM)(a,c.points)??[];b.hasZ=c.hasZ??!1;b.hasM=c.hasM??!1;return b}function U(a,b,c){a=u(a);b.x=r(a,c.x);b.y=t(a,c.y);null!=c.z&&(b.z=x(a,c.z));null!=c.m&&(b.m=y(a,c.m));return b}function V(a,b,c){{a=u(a);var d=c.rings;const e=[],f=D(c.hasZ,c.hasM);for(let g=
0;g<d.length;g++){const l=f(a,d[g]);l&&3<=l.length&&e.push(l)}a=e.length?e:null}if(!a)return null;b.rings=a;b.hasZ=c.hasZ??!1;b.hasM=c.hasM??!1;return b}function W(a,b,c){{a=u(a);var d=c.paths;const e=[],f=D(c.hasZ,c.hasM);for(let g=0;g<d.length;g++){const l=f(a,d[g]);l&&2<=l.length&&e.push(l)}a=e.length?e:null}if(!a)return null;b.paths=a;b.hasZ=c.hasZ??!1;b.hasM=c.hasM??!1;return b}const N=(a,b)=>{const c=[];if(!b.length)return null;var d=b[0];let e=r(a,d[0]);d=t(a,d[1]);c.push([e,d]);for(let f=
1;f<b.length;f++){const [g,l]=b[f],m=r(a,g),k=t(a,l);m===e&&k===d||c.push([m-e,k-d]);e=m;d=k}return c},L=(a,b)=>{const c=[];if(!b.length)return null;var d=b[0];let e=r(a,d[0]),f=t(a,d[1]);d=x(a,d[2]);c.push([e,f,d]);for(let g=1;g<b.length;g++){const [l,m,k]=b[g],n=r(a,l),q=t(a,m),p=x(a,k);n===e&&q===f&&p===d||c.push([n-e,q-f,p]);e=n;f=q;d=p}return c},M=(a,b)=>{const c=[];if(!b.length)return null;var d=b[0];let e=r(a,d[0]),f=t(a,d[1]);d=y(a,d[2]);c.push([e,f,d]);for(let g=1;g<b.length;g++){const [l,
m,k]=b[g],n=r(a,l),q=t(a,m),p=y(a,k);n===e&&q===f&&p===d||c.push([n-e,q-f,p]);e=n;f=q;d=p}return c},K=(a,b)=>{const c=[];if(!b.length)return null;var d=b[0];let e=r(a,d[0]),f=t(a,d[1]),g=x(a,d[2]);d=y(a,d[3]);c.push([e,f,g,d]);for(let l=1;l<b.length;l++){const [m,k,n,q]=b[l],p=r(a,m),C=t(a,k),I=x(a,n),J=y(a,q);p===e&&C===f&&I===g&&J===d||c.push([p-e,C-f,I,J]);e=p;f=C;g=I;d=J}return c},R=(a,b)=>{const c=Array(b.length);if(!b.length)return c;var d=b[0];let e=v(a,d[0]);d=w(a,d[1]);c[0]=[e,d];const {scale:f,
originPosition:g}=a;a=f[0];const l="lowerLeft"===g?f[1]:-f[1];for(let m=1;m<b.length;m++){const [k,n]=b[m];e+=a*k;d+=l*n;c[m]=[e,d]}return c},P=(a,b)=>{const c=Array(b.length);if(!b.length)return c;var d=b[0];let e=v(a,d[0]),f=w(a,d[1]);c[0]=[e,f,z(a,d[2])];const {scale:g,originPosition:l}=a;d=g[0];const m="lowerLeft"===l?g[1]:-g[1];for(let k=1;k<b.length;k++){const [n,q,p]=b[k];e+=d*n;f+=m*q;c[k]=[e,f,z(a,p)]}return c},Q=(a,b)=>{const c=Array(b.length);if(!b.length)return c;var d=b[0];let e=v(a,
d[0]),f=w(a,d[1]);c[0]=[e,f,A(a,d[2])];const {scale:g,originPosition:l}=a;d=g[0];const m="lowerLeft"===l?g[1]:-g[1];for(let k=1;k<b.length;k++){const [n,q,p]=b[k];e+=d*n;f+=m*q;c[k]=[e,f,A(a,p)]}return c},O=(a,b)=>{const c=Array(b.length);if(!b.length)return c;var d=b[0];let e=v(a,d[0]),f=w(a,d[1]);c[0]=[e,f,z(a,d[2]),A(a,d[3])];const {scale:g,originPosition:l}=a;d=g[0];const m="lowerLeft"===l?g[1]:-g[1];for(let k=1;k<b.length;k++){const [n,q,p,C]=b[k];e+=d*n;f+=m*q;c[k]=[e,f,z(a,p),A(a,C)]}return c};
h.getQuantizedBoundsCoordsArray=G;h.getQuantizedBoundsCoordsArrayArray=H;h.getQuantizedBoundsPaths=function(a){return H([0,0,0,0],a)};h.getQuantizedBoundsPoints=function(a){const b=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return G(b,b,a)};h.getQuantizedBoundsRings=function(a){return H([0,0,0,0],a)};h.normalizeTransform=u;h.quantizeBounds=function(a,b,c){a=u(a);b[0]=r(a,c[0]);b[3]=t(a,c[1]);b[2]=r(a,c[2]);b[1]=t(a,c[3]);return b};h.quantizeCoordsArrayXY=
N;h.quantizeCoordsArrayXYM=M;h.quantizeCoordsArrayXYZ=L;h.quantizeCoordsArrayXYZM=K;h.quantizeExtent=S;h.quantizeGeometry=function(a,b){return a&&b?B.isPoint(b)?U(a,{},b):B.isPolyline(b)?W(a,{},b):B.isPolygon(b)?V(a,{},b):B.isMultipoint(b)?T(a,{},b):B.isExtent(b)?S(a,{},b):null:null};h.quantizeM=y;h.quantizeMultipoint=T;h.quantizePoint=U;h.quantizePolygon=V;h.quantizePolyline=W;h.quantizeX=r;h.quantizeY=t;h.quantizeZ=x;h.toQuantizationTransform=function(a){return a?{originPosition:"upper-left"===
a.originPosition?"upperLeft":"lower-left"===a.originPosition?"lowerLeft":a.originPosition,scale:a.tolerance?[a.tolerance,a.tolerance,1,1]:[1,1,1,1],translate:null!=a.extent?[a.extent.xmin,a.extent.ymax,a.extent.zmin??0,a.extent.mmin??0]:[0,0,0,0]}:null};h.unquantizeBounds=function(a,b,c){a=u(a);return c?(b[0]=v(a,c[0]),b[1]=w(a,c[3]),b[2]=v(a,c[2]),b[3]=w(a,c[1]),b):[v(a,b[0]),w(a,b[3]),v(a,b[2]),w(a,b[1])]};h.unquantizeCoordsArrayArray=F;h.unquantizeCoordsArrayXY=R;h.unquantizeCoordsArrayXYM=Q;h.unquantizeCoordsArrayXYZ=
P;h.unquantizeCoordsArrayXYZM=O;h.unquantizeExtent=function(a,b,c,d=c.hasZ??!1,e=c.hasM??!1){a=u(a);b.xmin=v(a,c.xmin);b.xmax=v(a,c.xmax);b.ymin=w(a,c.ymin);b.ymax=w(a,c.ymax);d&&(b.zmin=z(a,c.zmin),b.zmax=z(a,c.zmax));e&&(b.mmin=A(a,c.mmin),b.mmax=A(a,c.mmax));b.hasZ=d;b.hasM=e;return b};h.unquantizeM=A;h.unquantizeMultipoint=function(a,b,c,d=c?.hasZ??!1,e=c?.hasM??!1){null!=c&&(a=u(a),b.points=E(d,e)(a,c.points),b.hasZ=d,b.hasM=e);return b};h.unquantizePoint=function(a,b,c,d=null!=c?.z,e=null!=
c?.m){if(null==c)return b;a=u(a);b.x=v(a,c.x);b.y=w(a,c.y);d&&(b.z=z(a,c.z));e&&(b.m=A(a,c.m));return b};h.unquantizePolygon=function(a,b,c,d=c?.hasZ??!1,e=c?.hasM??!1){null!=c&&(a=u(a),b.rings=F(a,E(d,e),c.rings),b.hasZ=d,b.hasM=e);return b};h.unquantizePolyline=function(a,b,c,d=c?.hasZ??!1,e=c?.hasM??!1){null!=c&&(a=u(a),b.paths=F(a,E(d,e),c.paths),b.hasZ=d,b.hasM=e);return b};h.unquantizeX=v;h.unquantizeY=w;h.unquantizeZ=z;Object.defineProperty(h,Symbol.toStringTag,{value:"Module"})});
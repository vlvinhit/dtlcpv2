// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.30/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/graphics/featureConversionUtils":function(){define("exports ../../core/Error ../../core/Logger ../../core/maybe ../../geometry/support/aaBoundingBox ../../geometry/support/aaBoundingRect ../../geometry/support/jsonUtils ./OptimizedFeature ./OptimizedFeatureSet ./OptimizedGeometry".split(" "),function(d,g,y,x,G,A,f,p,e,v){function z(B,K){return B?K?4:3:K?3:2}function E(B,K,L,V){if(B){if(L)return K&&V?F:Oa;if(K&&V)return l}else if(K&&V)return Oa;return Ta}function J({scale:B,
translate:K},L){return Math.round((L-K[0])/B[0])}function r({scale:B,translate:K},L){return Math.round((K[1]-L)/B[1])}function q({scale:B,translate:K},L,V){return L*B[V]+K[V]}function b(B){B=B.coords;return{x:B[0],y:B[1]}}function t(B,K){B.coords[0]=K.x;B.coords[1]=K.y;return B}function n(B){B=B.coords;return{x:B[0],y:B[1],z:B[2]}}function D(B,K){B.coords[0]=K.x;B.coords[1]=K.y;B.coords[2]=K.z;return B}function Q(B){B=B.coords;return{x:B[0],y:B[1],m:B[2]}}function a(B,K){B.coords[0]=K.x;B.coords[1]=
K.y;B.coords[2]=K.m;return B}function C(B){B=B.coords;return{x:B[0],y:B[1],z:B[2],m:B[3]}}function P(B,K){B.coords[0]=K.x;B.coords[1]=K.y;B.coords[2]=K.z;B.coords[3]=K.m;return B}function R(B,K){return B&&K?P:B?D:K?a:t}function Z(B,K,L,V,aa){L=R(L,V);for(const {geometry:ca,attributes:fa}of K)K=null!=ca?L(new v,ca):null,B.push(new p.OptimizedFeature(K,fa,null,aa?fa[aa]:void 0));return B}function W(B,K,L=R(null!=K.z,null!=K.m)){return L(B,K)}function U(B,K,L,V){for(const {geometry:aa,attributes:ca}of K)B.push({attributes:ca,
geometry:null!=aa?u(aa,L,V):null});return B}function u(B,K,L){if(null==B)return null;const V=z(K,L),aa=[];for(let ca=0;ca<B.coords.length;ca+=V){const fa=[];for(let la=0;la<V;la++)fa.push(B.coords[ca+la]);aa.push(fa)}return K?L?{points:aa,hasZ:K,hasM:L}:{points:aa,hasZ:K}:L?{points:aa,hasM:L}:{points:aa}}function I(B,K,L,V,aa){L=z(L,V);for(const {geometry:ca,attributes:fa}of K)K=null!=ca?k(new v,ca,L):null,B.push(new p.OptimizedFeature(K,fa,null,aa?fa[aa]:void 0));return B}function k(B,K,L=z(K.hasZ,
K.hasM)){B.lengths[0]=K.points.length;const V=B.coords;let aa=0;for(const ca of K.points)for(K=0;K<L;K++)V[aa++]=ca[K];return B}function h(B,K,L){if(!B)return null;const V=z(K,L),{coords:aa,lengths:ca}=B;B=[];let fa=0;for(const la of ca){const ma=[];for(let ua=0;ua<la;ua++){const pa=[];for(let sa=0;sa<V;sa++)pa.push(aa[fa++]);ma.push(pa)}B.push(ma)}return K?L?{paths:B,hasZ:K,hasM:L}:{paths:B,hasZ:K}:L?{paths:B,hasM:L}:{paths:B}}function w(B,K,L,V,aa){L=z(L,V);for(const {geometry:ca,attributes:fa,
centroid:la}of K)K=null!=ca?O(new v,ca,L):null,V=null!=la?W(new v,la):null,B.push(new p.OptimizedFeature(K,fa,V,aa?fa[aa]:void 0));return B}function O(B,K,L=z(K.hasZ,K.hasM)){const {lengths:V,coords:aa}=B;let ca=0;for(const fa of K.paths){for(const la of fa)for(K=0;K<L;K++)aa[ca++]=la[K];V.push(fa.length)}return B}function M(B,K,L){if(!B)return null;const V=z(K,L),{coords:aa,lengths:ca}=B;B=[];let fa=0;for(const la of ca){const ma=[];for(let ua=0;ua<la;ua++){const pa=[];for(let sa=0;sa<V;sa++)pa.push(aa[fa++]);
ma.push(pa)}B.push(ma)}return K?L?{rings:B,hasZ:K,hasM:L}:{rings:B,hasZ:K}:L?{rings:B,hasM:L}:{rings:B}}function T(B,K,L=K.hasZ,V=K.hasM){return Y(B,K.rings,L,V)}function Y(B,K,L,V){L=z(L,V);const {lengths:aa,coords:ca}=B;V=0;Ea(B);for(const fa of K){for(const la of fa)for(K=0;K<L;K++)ca[V++]=la[K];aa.push(fa.length)}return B}function ea(B,K,L,V,aa,ca){Da(B);if(!L){for(const fa of K)B.push(new p.OptimizedFeature(null,fa.attributes,null,ca?fa.attributes[ca]:void 0));return B}switch(L){case "esriGeometryPoint":return Z(B,
K,V,aa,ca);case "esriGeometryMultipoint":return I(B,K,V,aa,ca);case "esriGeometryPolyline":return w(B,K,V,aa,ca);case "esriGeometryPolygon":for(const {geometry:fa,centroid:la,attributes:ma}of K)K=null!=fa?T(new v,fa,V,aa):null,L=ca?ma[ca]:void 0,null!=la?B.push(new p.OptimizedFeature(K,ma,t(new v,la),L)):B.push(new p.OptimizedFeature(K,ma,null,L));break;default:Pa().error("convertToFeatureSet:unknown-geometry",new g(`Unable to parse unknown geometry type '${L}'`)),Da(B)}return B}function ia(B,K,L,
V){B=B&&("coords"in B?B:B.geometry);if(null==B)return null;switch(K){case "esriGeometryPoint":return K=b,L&&V?K=C:L?K=n:V&&(K=Q),K(B);case "esriGeometryMultipoint":return u(B,L,V);case "esriGeometryPolyline":return h(B,L,V);case "esriGeometryPolygon":return M(B,L,V);default:return Pa().error("convertToGeometry:unknown-geometry",new g(`Unable to parse unknown geometry type '${K}'`)),null}}function na(B,K,L,V,aa){Da(B);if(null==L){for(const fa of K)B.push({attributes:fa.attributes});return B}switch(L){case "esriGeometryPoint":L=
b;V&&aa?L=C:V?L=n:aa&&(L=Q);for(var ca of K){const {geometry:fa,attributes:la}=ca;V=null!=fa?L(fa):null;B.push({attributes:la,geometry:V})}break;case "esriGeometryMultipoint":return U(B,K,V,aa);case "esriGeometryPolyline":for(const {geometry:fa,attributes:la}of K)B.push({attributes:la,geometry:null!=fa?h(fa,V,aa):null});break;case "esriGeometryPolygon":for(const {geometry:fa,attributes:la,centroid:ma}of K)ca=null!=fa?M(fa,V,aa):null,null!=ma?(K=b(ma),B.push({attributes:la,centroid:K,geometry:ca})):
B.push({attributes:la,geometry:ca});break;default:Pa().error("convertToFeatureSet:unknown-geometry",new g(`Unable to parse unknown geometry type '${L}'`))}return B}function qa(B,K,L,V,aa,ca,fa=L,la=V){Ea(B);if(!K?.coords.length)return null;aa=Sa[aa];const {coords:ma,lengths:ua}=K;K=z(L,V);const pa=z(L&&fa,V&&la);L=E(L,V,fa,la);if(!ua.length)return L(B.coords,ma,0,0,J(ca,ma[0]),r(ca,ma[1])),Ea(B,K,0),B;let sa,Ca=0,xa,Ba=0;for(const Aa of ua){if(Aa<aa)continue;let ya=0;xa=Ba;la=V=J(ca,ma[Ca]);sa=fa=
r(ca,ma[Ca+1]);L(B.coords,ma,xa,Ca,la,sa);ya++;Ca+=K;xa+=pa;for(let Ia=1;Ia<Aa;Ia++,Ca+=K)if(la=J(ca,ma[Ca]),sa=r(ca,ma[Ca+1]),la!==V||sa!==fa)L(B.coords,ma,xa,Ca,la-V,sa-fa),xa+=pa,ya++,V=la,fa=sa;ya>=aa&&(B.lengths.push(ya),Ba=xa)}Da(B.coords,Ba);return B.coords.length?B:null}function va(B,K,L,V,aa,ca,fa){let la=V,ma=0;for(let pa=ca+L;pa<fa;pa+=L){var ua=K[pa];const sa=K[pa+1],Ca=K[fa],xa=K[fa+1];let Ba=K[ca],Aa=K[ca+1],ya=Ca-Ba,Ia=xa-Aa;if(0!==ya||0!==Ia){const Qa=((ua-Ba)*ya+(sa-Aa)*Ia)/(ya*ya+
Ia*Ia);1<Qa?(Ba=Ca,Aa=xa):0<Qa&&(Ba+=ya*Qa,Aa+=Ia*Qa)}ya=ua-Ba;Ia=sa-Aa;ua=ya*ya+Ia*Ia;ua>la&&(ma=pa,la=ua)}la>V&&(ma-ca>L&&va(B,K,L,V,aa,ca,ma),aa(B,K,B.length,ma,K[ma],K[ma+1]),fa-ma>L&&va(B,K,L,V,aa,ma,fa))}function ta(B,K,L,V,aa){const {coords:ca,lengths:fa}=K;L=z(L,V);if(!ca.length)return B!==K&&Ea(B),B;x.assertIsSome(aa);const {originPosition:la,scale:ma,translate:ua}=aa;aa=ja;aa.originPosition=la;V=aa.scale;V[0]=ma[0]??1;V[1]=-(ma[1]??1);V[2]=ma[2]??1;V[3]=ma[3]??1;var pa=aa.translate;pa[0]=
ua[0]??0;pa[1]=ua[1]??0;pa[2]=ua[2]??0;pa[3]=ua[3]??0;if(!fa.length){for(V=0;V<L;++V)B.coords[V]=q(aa,ca[V],V);B!==K&&Ea(B,L,0);return B}pa=0;for(let Ca=0;Ca<fa.length;Ca++){const xa=fa[Ca];B.lengths[Ca]=xa;for(var sa=0;sa<L;++sa)B.coords[pa+sa]=q(aa,ca[pa+sa],sa);sa=B.coords[pa];let Ba=B.coords[pa+1];pa+=L;for(let Aa=1;Aa<xa;Aa++,pa+=L){sa+=ca[pa]*V[0];Ba+=ca[pa+1]*V[1];B.coords[pa]=sa;B.coords[pa+1]=Ba;for(let ya=2;ya<L;++ya)B.coords[pa+ya]=q(aa,ca[pa+ya],ya)}}B!==K&&Ea(B,ca.length,fa.length);return B}
function wa(B,K,L,V){let aa=0,ca=B[V*K],fa=B[V*(K+1)];for(let la=1;la<L;la++){const ma=ca+B[V*(K+la)],ua=fa+B[V*(K+la)+1],pa=(ma-ca)*(ua+fa);ca=ma;fa=ua;aa+=pa}return.5*aa}function Ea(B,K=0,L=0){Da(B.lengths,L);Da(B.coords,K)}function Da(B,K=0){B.length!==K&&(B.length=K)}const Pa=()=>y.getLogger("esri.layers.graphics.featureConversionUtils"),Sa={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0,esriGeometryEnvelope:0},Ta=(B,K,L,V,aa,ca)=>{B[L]=aa;B[L+1]=ca},
Oa=(B,K,L,V,aa,ca)=>{B[L]=aa;B[L+1]=ca;B[L+2]=K[V+2]},l=(B,K,L,V,aa,ca)=>{B[L]=aa;B[L+1]=ca;B[L+2]=K[V+3]},F=(B,K,L,V,aa,ca)=>{B[L]=aa;B[L+1]=ca;B[L+2]=K[V+2];B[L+3]=K[V+3]},X=[],ba=[],ja={originPosition:"lowerLeft",scale:[1,1,1,1],translate:[0,0,0,0]};d.convertFromFeature=function(B,K,L,V,aa){X[0]=B;[B]=ea(ba,X,K,L,V,aa);Da(X);Da(ba);return B};d.convertFromFeatureSet=function(B,K){const L=new e,{hasM:V,hasZ:aa,features:ca,objectIdFieldName:fa,spatialReference:la,geometryType:ma,exceededTransferLimit:ua,
transform:pa,fields:sa}=B;sa&&(L.fields=sa);L.geometryType=ma??null;L.objectIdFieldName=fa??K??null;L.spatialReference=la??null;if(!L.objectIdFieldName)return Pa().error(new g("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),L;ca&&ea(L.features,ca,ma,aa,V,L.objectIdFieldName);ua&&(L.exceededTransferLimit=ua);V&&(L.hasM=V);aa&&(L.hasZ=aa);pa&&(L.transform=pa);return L};d.convertFromFeatures=ea;d.convertFromGeometry=function(B,K,L){if(null==B)return null;const V=new v;
"hasZ"in B&&null==K&&(K=B.hasZ);"hasM"in B&&null==L&&(L=B.hasM);if(f.isPoint(B))return R(null!=K?K:null!=B.z,null!=L?L:null!=B.m)(V,B);if(f.isPolygon(B))return T(V,B,K,L);if(f.isPolyline(B))return O(V,B,z(K,L));if(f.isMultipoint(B))return k(V,B,z(K,L));Pa().error("convertFromGeometry:unknown-geometry",new g(`Unable to parse unknown geometry type '${B}'`))};d.convertFromMultipoint=k;d.convertFromMultipointFeatures=I;d.convertFromNestedArray=Y;d.convertFromPoint=W;d.convertFromPointFeatures=Z;d.convertFromPolygon=
T;d.convertFromPolyline=O;d.convertFromPolylineFeatures=w;d.convertToFeature=function(B,K,L,V){ba[0]=B;na(X,ba,K,L,V);B=X[0];Da(X);Da(ba);return B};d.convertToFeatureSet=function(B){const {objectIdFieldName:K,spatialReference:L,transform:V,fields:aa,hasM:ca,hasZ:fa,features:la,geometryType:ma,exceededTransferLimit:ua,uniqueIdField:pa,queryGeometry:sa,queryGeometryType:Ca}=B;B=na([],la,ma,fa,ca);const xa=ia(sa,Ca,!1,!1);B={features:B,fields:aa,geometryType:ma,objectIdFieldName:K,spatialReference:L,
uniqueIdField:pa,queryGeometry:xa};V&&(B.transform=V);ua&&(B.exceededTransferLimit=ua);ca&&(B.hasM=ca);fa&&(B.hasZ=fa);return B};d.convertToFeatures=na;d.convertToGeometry=ia;d.convertToMultipoint=u;d.convertToMultipointFeatures=U;d.convertToPoint=function(B,K,L){return B?K?L?C(B):n(B):L?Q(B):b(B):null};d.convertToPolygon=M;d.convertToPolyline=h;d.generalizeOptimizedGeometry=function(B,K,L,V,aa,ca,fa=L,la=V){Ea(B);if(!K?.coords.length)return null;aa=Sa[aa];const {coords:ma,lengths:ua}=K;K=z(L,V);
const pa=z(L&&fa,V&&la);L=E(L,V,fa,la);if(!ua.length)return L(B.coords,ma,0,0,ma[0],ma[1]),Ea(B,K,0),B;V=0;ca*=ca;for(const sa of ua){if(sa<aa){V+=sa*K;continue}fa=B.coords.length/pa;la=V;const Ca=V+(sa-1)*K;L(B.coords,ma,B.coords.length,la,ma[la],ma[la+1]);va(B.coords,ma,K,ca,L,la,Ca);L(B.coords,ma,B.coords.length,Ca,ma[Ca],ma[Ca+1]);la=B.coords.length/pa-fa;la>=aa?B.lengths.push(la):Da(B.coords,fa*pa);V+=sa*K}return B.coords.length?B:null};d.getBoundsOptimizedGeometry=function(B,K,L,V){if(!K?.coords?.length)return null;
L=z(L,V);let aa=V=Number.POSITIVE_INFINITY,ca=Number.NEGATIVE_INFINITY,fa=Number.NEGATIVE_INFINITY;if(K&&K.coords){K=K.coords;for(let la=0;la<K.length;la+=L){const ma=K[la],ua=K[la+1];V=Math.min(V,ma);ca=Math.max(ca,ma);aa=Math.min(aa,ua);fa=Math.max(fa,ua)}}G.is(B)?G.fromRectValues(B,V,aa,ca,fa):A.fromValues(V,aa,ca,fa,B);return B};d.getQuantizedArea=function(B,K){const {coords:L,lengths:V}=B;let aa=B=0;for(let ca=0;ca<V.length;ca++){const fa=V[ca];aa+=wa(L,B,fa,K);B+=fa}return Math.abs(aa)};d.getQuantizedBoundsOptimizedGeometry=
function(B,K,L,V){L=z(L,V);const {lengths:aa,coords:ca}=K;V=K=Number.POSITIVE_INFINITY;let fa=Number.NEGATIVE_INFINITY,la=Number.NEGATIVE_INFINITY,ma=0;for(const ua of aa){let pa=ca[ma],sa=ca[ma+1];K=Math.min(pa,K);V=Math.min(sa,V);fa=Math.max(pa,fa);la=Math.max(sa,la);ma+=L;for(let Ca=1;Ca<ua;Ca++,ma+=L){const xa=ca[ma],Ba=ca[ma+1];pa+=xa;sa+=Ba;0>xa&&(K=Math.min(K,pa));0<xa&&(fa=Math.max(fa,pa));0>Ba?V=Math.min(V,sa):0<Ba&&(la=Math.max(la,sa))}}B[0]=K;B[1]=V;B[2]=fa;B[3]=la;return B};d.getSignedQuantizedRingArea=
wa;d.quantizeOptimizedFeatureSet=function(B,K){const {geometryType:L,features:V,hasM:aa,hasZ:ca}=K;if(!B)return K;for(let fa=0;fa<V.length;fa++){const la=V[fa],ma=la.weakClone();ma.geometry=new v;qa(ma.geometry,la.geometry,aa,ca,L,B);la.centroid&&(ma.centroid=new v,qa(ma.centroid,la.centroid,aa,ca,"esriGeometryPoint",B));V[fa]=ma}K.transform=B;return K};d.quantizeOptimizedGeometry=qa;d.quantizeX=J;d.quantizeY=r;d.removeCollinearVertices=function(B,K,L,V,aa){if(!K?.coords?.length)return null;L=Sa[L];
const {coords:ca,lengths:fa}=K;K=E(V,aa,V,aa);V=z(V,aa);let la=aa=0,ma=0,ua=0;for(const Ca of fa){la=ua;K(B.coords,ca,la,aa,ca[aa],ca[aa+1]);aa+=V;var pa=ca[aa];let xa=ca[aa+1],Ba=pa,Aa=xa;var sa=xa/pa;la+=V;K(B.coords,ca,la,aa,Ba,Aa);aa+=V;for(let ya=2;ya<Ca;ya++){pa=ca[aa];xa=ca[aa+1];const Ia=xa/pa,Qa=sa===Ia||!isFinite(sa)&&!isFinite(Ia);sa=Qa&&isFinite(Ia)?0<=sa&&0<=Ia||0>=sa&&0>=Ia:0<=Aa&&0<=xa||0>=Aa&&0>=xa;Qa&&sa?(Ba+=pa,Aa+=xa):(Ba=pa,Aa=xa,la+=V);K(B.coords,ca,la,aa,Ba,Aa);aa+=V;sa=Ia}la+=
V;pa=(la-ua)/V;pa>=L&&(B.lengths[ma]=pa,ua=la,ma++)}B.coords.length>ua&&(B.coords.length=ua);B.lengths.length>ma&&(B.lengths.length=ma);return B.coords.length&&B.lengths.length?B:null};d.removeZMValues=function(B,K,L,V,aa,ca){Ea(B);B.lengths.push(...K.lengths);if(L===aa&&V===ca)for(var fa=0;fa<K.coords.length;fa++)B.coords.push(K.coords[fa]);else for(fa=z(L,V),L=E(L,V,aa,ca),K=K.coords,V=0;V<K.length;V+=fa)L(B.coords,K,B.coords.length,V,K[V],K[V+1]);return B};d.unquantizeOptimizedFeatureSet=function(B){const {transform:K,
features:L,hasM:V,hasZ:aa}=B;if(!K)return B;for(const ca of L)null!=ca.geometry&&ta(ca.geometry,ca.geometry,V,aa,K),null!=ca.centroid&&ta(ca.centroid,ca.centroid,V,aa,K);B.transform=null;return B};d.unquantizeOptimizedGeometry=ta;d.unquantizeValue=q;d.unquantizeX=function(B,K){return q(B,K,0)};d.unquantizeY=function(B,K){return q(B,-K,1)};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/aaBoundingBox":function(){define(["exports","../Extent","./aaBoundingRect"],
function(d,g,y){function x(q=J){return[q[0],q[1],q[2],q[3],q[4],q[5]]}function G(q,b,t,n,D,Q,a=x()){a[0]=q;a[1]=b;a[2]=t;a[3]=n;a[4]=D;a[5]=Q;return a}function A(q){return q[0]>=q[3]?0:q[3]-q[0]}function f(q){return q[1]>=q[4]?0:q[4]-q[1]}function p(q){return q[2]>=q[5]?0:q[5]-q[2]}function e(q,b){return Math.max(b[0],q[0])<=Math.min(b[3],q[3])&&Math.max(b[1],q[1])<=Math.min(b[4],q[4])&&Math.max(b[2],q[2])<=Math.min(b[5],q[5])}function v(q,b){q[0]=b[0];q[1]=b[1];q[2]=b[2];q[3]=b[3];q[4]=b[4];q[5]=
b[5];return q}function z(q){return 6===q.length}const E=[Infinity,Infinity,Infinity,-Infinity,-Infinity,-Infinity],J=[0,0,0,0,0,0],r=x();d.allFinite=function(q){for(let b=0;6>b;b++)if(!isFinite(q[b]))return!1;return!0};d.center=function(q,b=[0,0,0]){b[0]=q[0]+A(q)/2;b[1]=q[1]+f(q)/2;b[2]=q[2]+p(q)/2;return b};d.contains=function(q,b){return b[0]>=q[0]&&b[1]>=q[1]&&b[2]>=q[2]&&b[3]<=q[3]&&b[4]<=q[4]&&b[5]<=q[5]};d.containsPoint=function(q,b){return b[0]>=q[0]&&b[1]>=q[1]&&b[2]>=q[2]&&b[0]<=q[3]&&b[1]<=
q[4]&&b[2]<=q[5]};d.containsPointWithMargin=function(q,b,t){return b[0]>=q[0]-t&&b[1]>=q[1]-t&&b[2]>=q[2]-t&&b[0]<=q[3]+t&&b[1]<=q[4]+t&&b[2]<=q[5]+t};d.create=x;d.depth=f;d.diameter=function(q){const b=A(q),t=p(q);q=f(q);return Math.sqrt(b*b+t*t+q*q)};d.empty=function(q){return q?v(q,E):x(E)};d.equals=function(q,b,t){if(null==q||null==b)return q===b;if(!z(q)||!z(b))return!1;if(t)for(let n=0;n<q.length;n++){if(!t(q[n],b[n]))return!1}else for(t=0;t<q.length;t++)if(q[t]!==b[t])return!1;return!0};d.expandWithAABB=
function(q,b){q[0]=Math.min(q[0],b[0]);q[1]=Math.min(q[1],b[1]);q[2]=Math.min(q[2],b[2]);q[3]=Math.max(q[3],b[3]);q[4]=Math.max(q[4],b[4]);q[5]=Math.max(q[5],b[5])};d.expandWithBuffer=function(q,b,t=0,n=b.length/3){let D=q[0],Q=q[1],a=q[2],C=q[3],P=q[4],R=q[5];for(let Z=0;Z<n;Z++)D=Math.min(D,b[t+3*Z]),Q=Math.min(Q,b[t+3*Z+1]),a=Math.min(a,b[t+3*Z+2]),C=Math.max(C,b[t+3*Z]),P=Math.max(P,b[t+3*Z+1]),R=Math.max(R,b[t+3*Z+2]);q[0]=D;q[1]=Q;q[2]=a;q[3]=C;q[4]=P;q[5]=R};d.expandWithNestedArray=function(q,
b,t){const n=b.length;let D=q[0],Q=q[1],a=q[2],C=q[3],P=q[4],R=q[5];if(t)for(t=0;t<n;t++){var Z=b[t];D=Math.min(D,Z[0]);Q=Math.min(Q,Z[1]);a=Math.min(a,Z[2]);C=Math.max(C,Z[0]);P=Math.max(P,Z[1]);R=Math.max(R,Z[2])}else for(t=0;t<n;t++)Z=b[t],D=Math.min(D,Z[0]),Q=Math.min(Q,Z[1]),C=Math.max(C,Z[0]),P=Math.max(P,Z[1]);q[0]=D;q[1]=Q;q[2]=a;q[3]=C;q[4]=P;q[5]=R};d.expandWithOffset=function(q,b,t,n){q[0]=Math.min(q[0],q[0]+b);q[3]=Math.max(q[3],q[3]+b);q[1]=Math.min(q[1],q[1]+t);q[4]=Math.max(q[4],q[4]+
t);q[2]=Math.min(q[2],q[2]+n);q[5]=Math.max(q[5],q[5]+n)};d.expandWithRect=function(q,b){q[0]=Math.min(q[0],b[0]);q[1]=Math.min(q[1],b[1]);q[3]=Math.max(q[3],b[2]);q[4]=Math.max(q[4],b[3])};d.expandWithVec3=function(q,b){q[0]=Math.min(q[0],b[0]);q[1]=Math.min(q[1],b[1]);q[2]=Math.min(q[2],b[2]);q[3]=Math.max(q[3],b[0]);q[4]=Math.max(q[4],b[1]);q[5]=Math.max(q[5],b[2])};d.fromExtent=function(q,b=x()){b[0]=q.xmin;b[1]=q.ymin;b[2]=q.hasZ?q.zmin:-Infinity;b[3]=q.xmax;b[4]=q.ymax;b[5]=q.hasZ?q.zmax:Infinity;
return b};d.fromMinMax=function(q,b,t=x()){t[0]=q[0];t[1]=q[1];t[2]=q[2];t[3]=b[0];t[4]=b[1];t[5]=b[2];return t};d.fromRect=function(q,b){q[0]=b[0];q[1]=b[1];q[2]=Number.NEGATIVE_INFINITY;q[3]=b[2];q[4]=b[3];q[5]=Number.POSITIVE_INFINITY;return q};d.fromRectValues=function(q,b,t,n,D){q[0]=b;q[1]=t;q[2]=Number.NEGATIVE_INFINITY;q[3]=n;q[4]=D;q[5]=Number.POSITIVE_INFINITY;return q};d.fromValues=G;d.getMax=function(q,b){b[0]=q[3];b[1]=q[4];b[2]=q[5];return b};d.getMin=function(q,b){b[0]=q[0];b[1]=q[1];
b[2]=q[2];return b};d.height=p;d.intersects=e;d.intersectsClippingArea=function(q,b){return null==b?!0:e(q,b)};d.is=z;d.isPoint=function(q){return 0===A(q)&&0===f(q)&&0===p(q)};d.maximumDimension=function(q){return Math.max(A(q),p(q),f(q))};d.negativeInfinity=E;d.offset=function(q,b,t,n,D=q){D[0]=q[0]+b;D[1]=q[1]+t;D[2]=q[2]+n;D[3]=q[3]+b;D[4]=q[4]+t;D[5]=q[5]+n;return D};d.positiveInfinity=[-Infinity,-Infinity,-Infinity,Infinity,Infinity,Infinity];d.scale=function(q,b,t=q){const n=q[0]+A(q)/2,D=
q[1]+f(q)/2,Q=q[2]+p(q)/2;t[0]=n+(q[0]-n)*b;t[1]=D+(q[1]-D)*b;t[2]=Q+(q[2]-Q)*b;t[3]=n+(q[3]-n)*b;t[4]=D+(q[4]-D)*b;t[5]=Q+(q[5]-Q)*b;return t};d.set=v;d.setMax=function(q,b,t=q){t[3]=b[0];t[4]=b[1];t[5]=b[2];t!==q&&(t[0]=q[0],t[1]=q[1],t[2]=q[2]);return q};d.setMin=function(q,b,t=q){t[0]=b[0];t[1]=b[1];t[2]=b[2];t!==q&&(t[3]=q[3],t[4]=q[4],t[5]=q[5]);return t};d.size=function(q,b=[0,0,0]){b[0]=A(q);b[1]=f(q);b[2]=p(q);return b};d.toExtent=function(q,b){return isFinite(q[2])||isFinite(q[5])?new g({xmin:q[0],
xmax:q[3],ymin:q[1],ymax:q[4],zmin:q[2],zmax:q[5],spatialReference:b}):new g({xmin:q[0],xmax:q[3],ymin:q[1],ymax:q[4],spatialReference:b})};d.toRect=function(q,b){b||=y.create();b[0]=q[0];b[1]=q[1];b[2]=q[3];b[3]=q[4];return b};d.width=A;d.wrap=function(q,b,t,n,D,Q){return G(q,b,t,n,D,Q,r)};d.zero=J;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/OptimizedFeature":function(){define(["exports","./OptimizedGeometry"],function(d,g){class y{constructor(G=null,A={},
f,p){this.geometry=G;this.attributes=A;this.centroid=f;this.objectId=p;this.geohashY=this.geohashX=this.displayId=0}static fromJSON(G,A){const f=G.geometry?g.fromJSON(G.geometry):null,p=G.centroid?g.fromJSON(G.centroid):null;return new y(f,G.attributes,p,G.attributes[A])}weakClone(){const G=new y(this.geometry,this.attributes,this.centroid,this.objectId);G.displayId=this.displayId;G.geohashX=this.geohashX;G.geohashY=this.geohashY;return G}clone(){var G=this.geometry?.clone();G=new y(G,{...this.attributes},
this.centroid?.clone(),this.objectId);G.displayId=this.displayId;G.geohashX=this.geohashX;G.geohashY=this.geohashY;return G}}class x extends y{}d.OptimizedFeature=y;d.OptimizedFeatureWithGeometry=x;d.hasGeometry=function(G){return!!G.geometry?.coords?.length};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/OptimizedGeometry":function(){define(function(){class d{constructor(g=[],y=[],x=!1){this.lengths=g??[];this.coords=y??[];this.hasIndeterminateRingOrder=x}static fromJSON(g){return new d(g.lengths,
g.coords,g.hasIndeterminateRingOrder)}static fromRect(g){const [y,x,G,A]=g;g=G-y;const f=A-x;return new d([5],[y,x,g,0,0,f,-g,0,0,-f])}get isPoint(){return 0===this.lengths.length}get maxLength(){return Math.max(...this.lengths)}get size(){return this.lengths.reduce((g,y)=>g+y)}forEachVertex(g){let y=0;this.lengths.length||g(this.coords[0],this.coords[1]);for(let x=0;x<this.lengths.length;x++){const G=this.lengths[x];for(let A=0;A<G;A++)g(this.coords[2*(A+y)],this.coords[2*(A+y)+1]);y+=G}}deltaDecode(){const g=
this.clone(),{coords:y,lengths:x}=g;let G=0;for(const A of x){for(let f=1;f<A;f++)y[2*(G+f)]+=y[2*(G+f)-2],y[2*(G+f)+1]+=y[2*(G+f)-1];G+=A}return g}clone(g){if(0===this.lengths.length)return new d([],[this.coords[0],this.coords[1]]);var y=2*(0===this.lengths.length?1:this.lengths.reduce((x,G)=>x+G));y=this.coords.slice(0,y);return g?(g.set(y),new d(this.lengths,g,this.hasIndeterminateRingOrder)):new d(Array.from(this.lengths),Array.from(y),this.hasIndeterminateRingOrder)}}return d})},"esri/layers/graphics/OptimizedFeatureSet":function(){define(function(){class d{constructor(){this.spatialReference=
this.geometryType=this.geometryProperties=this.geohashFieldName=this.globalIdFieldName=this.objectIdFieldName=null;this.hasM=this.hasZ=!1;this.features=[];this.fields=[];this.transform=null;this.exceededTransferLimit=!1;this.queryGeometry=this.queryGeometryType=this.uniqueIdField=null}weakClone(){const g=new d;g.objectIdFieldName=this.objectIdFieldName;g.globalIdFieldName=this.globalIdFieldName;g.geohashFieldName=this.geohashFieldName;g.geometryProperties=this.geometryProperties;g.geometryType=this.geometryType;
g.spatialReference=this.spatialReference;g.hasZ=this.hasZ;g.hasM=this.hasM;g.features=this.features;g.fields=this.fields;g.transform=this.transform;g.exceededTransferLimit=this.exceededTransferLimit;g.uniqueIdField=this.uniqueIdField;g.queryGeometry=this.queryGeometry;g.queryGeometryType=this.queryGeometryType;return g}}return d})},"esri/layers/graphics/data/FeatureStore":function(){define("../../../core/arrayUtils ../../../core/Error ../../../core/Evented ../../../core/Logger ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../featureConversionUtils ./BoundsStore ./geometryUtils ./optimizedFeatureQueryEngineAdapter".split(" "),
function(d,g,y,x,G,A,f,p,e,v){const z=G.create();class E{constructor(J){this.geometryInfo=J;this._boundsStore=new p.BoundsStore;this._featuresById=new Map;this._markedIds=new Set;this.events=new y;this.featureAdapter=v.optimizedFeatureQueryEngineAdapter}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let J=
0;this._featuresById.forEach(r=>{null!=r.geometry&&r.geometry.coords&&(J+=r.geometry.coords.length)});return{featureCount:this._featuresById.size,vertexCount:J/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}getFullExtent(J){if(null==this.fullBounds)return null;const [r,q,b,t]=this.fullBounds;return{xmin:r,ymin:q,xmax:b,ymax:t,spatialReference:e.cleanFromGeometryEngine(J)}}add(J){this._add(J);this._emitChanged()}addMany(J){for(const r of J)this._add(r);this._emitChanged()}upsertMany(J){J=J.map(r=>this._upsert(r));
this._emitChanged();return J.filter(d.isSome)}clear(){this._featuresById.clear();this._boundsStore.clear();this._emitChanged()}removeById(J){J=this._featuresById.get(J);if(!J)return null;this._remove(J);this._emitChanged();return J}removeManyById(J){this._boundsStore.invalidateIndex();for(const r of J)(J=this._featuresById.get(r))&&this._remove(J);this._emitChanged()}forEachBounds(J,r){for(const q of J)(J=this._boundsStore.get(q.objectId))&&r(G.fromRect(z,J))}getFeature(J){return this._featuresById.get(J)}has(J){return this._featuresById.has(J)}forEach(J){this._featuresById.forEach(r=>
J(r))}forEachInBounds(J,r){this._boundsStore.forEachInBounds(J,q=>{r(this._featuresById.get(q))})}startMarkingUsedFeatures(){this._boundsStore.invalidateIndex();this._markedIds.clear()}sweep(){let J=!1;this._featuresById.forEach((r,q)=>{this._markedIds.has(q)||(J=!0,this._remove(r))});this._markedIds.clear();J&&this._emitChanged()}_emitChanged(){this.events.emit("changed",void 0)}_add(J){if(J){var r=J.objectId;if(null==r)x.getLogger("esri.layers.graphics.data.FeatureStore").error(new g("featurestore:invalid-feature",
"feature id is missing",{feature:J}));else{var q=this._featuresById.get(r);this._markedIds.add(r);if(q){J.displayId=q.displayId;var b=this._boundsStore.get(r);this._boundsStore.delete(r)}else if(null!=this.onFeatureAdd)this.onFeatureAdd(J);J.geometry?.coords?.length?(b=f.getBoundsOptimizedGeometry(null!=b?b:A.create(),J.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),null!=b&&this._boundsStore.set(r,b)):this._boundsStore.set(r,null);this._featuresById.set(r,J)}}}_upsert(J){const r=J?.objectId;
if(null==r)return x.getLogger("esri.layers.graphics.data.FeatureStore").error(new g("featurestore:invalid-feature","feature id is missing",{feature:J})),null;const q=this._featuresById.get(r);if(!q)return this._add(J),J;this._markedIds.add(r);const {geometry:b,attributes:t}=J;for(const n in t)q.attributes[n]=t[n];b&&(q.geometry=b,this._boundsStore.set(r,f.getBoundsOptimizedGeometry(A.create(),b,this.geometryInfo.hasZ,this.geometryInfo.hasM)??null));return q}_remove(J){if(null!=this.onFeatureRemove)this.onFeatureRemove(J);
const r=J.objectId;this._markedIds.delete(r);this._boundsStore.delete(r);this._featuresById.delete(r);return J}}return E})},"esri/layers/graphics/data/BoundsStore":function(){define(["exports","../../../core/has","../../../core/libs/rbush/PooledRBush","../../../geometry/support/aaBoundingRect"],function(d,g,y,x){function G(p,e,v){A.minX=e[0];A.minY=e[1];A.maxX=e[2];A.maxY=e[3];p.search(A,v)}const A={minX:0,minY:0,maxX:0,maxY:0};class f{constructor(){this._indexInvalid=!1;this._boundsToLoad=[];this._boundsById=
new Map;this._idByBounds=new Map;this._index=new y.PooledRBush(9,g("esri-csp-restrictions")?p=>({minX:p[0],minY:p[1],maxX:p[2],maxY:p[3]}):["[0]","[1]","[2]","[3]"]);this._loadIndex=()=>{if(this._indexInvalid){const p=Array(this._idByBounds.size);let e=0;this._idByBounds.forEach((v,z)=>{p[e++]=z});this._indexInvalid=!1;this._index.clear();this._index.load(p)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter(p=>this._idByBounds.has(p))))),this._boundsToLoad.length=
0)}}get fullBounds(){if(!this._boundsById.size)return null;const p=x.empty();for(const e of this._boundsById.values())e&&(p[0]=Math.min(e[0],p[0]),p[1]=Math.min(e[1],p[1]),p[2]=Math.max(e[2],p[2]),p[3]=Math.max(e[3],p[3]));return p}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1;this._boundsToLoad.length=0;this._boundsById.clear();this._idByBounds.clear();this._index.clear()}delete(p){const e=this._boundsById.get(p);this._boundsById.delete(p);e&&(this._idByBounds.delete(e),this._indexInvalid||
this._index.remove(e))}forEachInBounds(p,e){this._loadIndex();G(this._index,p,v=>e(this._idByBounds.get(v)))}get(p){return this._boundsById.get(p)}has(p){return this._boundsById.has(p)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(p,e){if(!this._indexInvalid){const v=this._boundsById.get(p);v&&(this._index.remove(v),this._idByBounds.delete(v))}this._boundsById.set(p,e);e&&(this._idByBounds.set(e,p),this._indexInvalid||(this._boundsToLoad.push(e),5E4<
this._boundsToLoad.length&&this._loadIndex()))}}d.BoundsStore=f;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/rbush/PooledRBush":function(){define(["exports","../../arrayUtils","../../has","../../PooledArray","../../../chunks/quickselect"],function(d,g,y,x,G){function A(W,U){for(D.clear();W;){if(!0===W.leaf)for(const u of W.children)U(u);else D.pushArray(W.children);W=D.pop()??null}}function f(W,U){p(W,0,W.children.length,U,W)}function p(W,U,u,I,k){k||=new R([]);
k.minX=Infinity;k.minY=Infinity;k.maxX=-Infinity;k.maxY=-Infinity;for(let h=U,w;h<u;h++)w=W.children[h],e(k,W.leaf?I(w):w);return k}function e(W,U){W.minX=Math.min(W.minX,U.minX);W.minY=Math.min(W.minY,U.minY);W.maxX=Math.max(W.maxX,U.maxX);W.maxY=Math.max(W.maxY,U.maxY)}function v(W,U){return W.minX-U.minX}function z(W,U){return W.minY-U.minY}function E(W){return(W.maxX-W.minX)*(W.maxY-W.minY)}function J(W){return W.maxX-W.minX+(W.maxY-W.minY)}function r(W,U){return W.minX<=U.minX&&W.minY<=U.minY&&
U.maxX<=W.maxX&&U.maxY<=W.maxY}function q(W,U){return U.minX<=W.maxX&&U.minY<=W.maxY&&U.maxX>=W.minX&&U.maxY>=W.minY}function b(W,U,u,I,k){for(U=[U,u];U.length;){u=U.pop();const h=U.pop();if(u-h<=I)continue;const w=h+Math.ceil((u-h)/I/2)*I;G.quickselect(W,w,h,u,k);U.push(h,w,w,u)}}class t{constructor(W=9,U){this._compareMinX=v;this._compareMinY=z;this._toBBox=u=>u;this._maxEntries=Math.max(4,W||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));U&&("function"===typeof U?this._toBBox=U:
this._initFormat(U));this.clear()}destroy(){this.clear();n.prune();D.prune();Q.prune();a.prune()}all(W){A(this._data,W)}search(W,U){let u=this._data;const I=this._toBBox;if(q(W,u))for(n.clear();u;){for(let k=0,h=u.children.length;k<h;k++){const w=u.children[k],O=u.leaf?I(w):w;q(W,O)&&(u.leaf?U(w):r(W,O)?A(w,U):n.push(w))}u=n.pop()}}collides(W){let U=this._data;const u=this._toBBox;if(!q(W,U))return!1;for(n.clear();U;){for(let I=0,k=U.children.length;I<k;I++){const h=U.children[I],w=U.leaf?u(h):h;
if(q(W,w)){if(U.leaf||r(W,w))return!0;n.push(h)}}U=n.pop()}return!1}load(W){if(!W.length)return this;if(W.length<this._minEntries){for(let U=0,u=W.length;U<u;U++)this.insert(W[U]);return this}W=this._build(W.slice(0,W.length),0,W.length-1,0);if(this._data.children.length)if(this._data.height===W.height)this._splitRoot(this._data,W);else{if(this._data.height<W.height){const U=this._data;this._data=W;W=U}this._insert(W,this._data.height-W.height-1,!0)}else this._data=W;return this}insert(W){W&&this._insert(W,
this._data.height-1);return this}clear(){this._data=new R([]);return this}remove(W){if(!W)return this;let U=this._data,u=null,I=0,k=!1,h;const w=this._toBBox(W);Q.clear();for(a.clear();U||0<Q.length;){U||(U=Q.pop(),u=Q.data[Q.length-1],I=a.pop()??0,k=!0);if(U.leaf&&(h=g.indexOf(U.children,W,U.children.length,U.indexHint),-1!==h)){U.children.splice(h,1);Q.push(U);this._condense(Q);break}k||U.leaf||!r(U,w)?u?(I++,U=u.children[I],k=!1):U=null:(Q.push(U),a.push(I),I=0,u=U,U=U.children[0])}return this}toJSON(){return this._data}fromJSON(W){this._data=
W;return this}_build(W,U,u,I){var k=u-U+1,h=this._maxEntries;if(k<=h)return W=new R(W.slice(U,u+1)),f(W,this._toBBox),W;I||(I=Math.ceil(Math.log(k)/Math.log(h)),h=Math.ceil(k/h**(I-1)));const w=new Z([]);w.height=I;k=Math.ceil(k/h);h=k*Math.ceil(Math.sqrt(h));for(b(W,U,u,h,this._compareMinX);U<=u;U+=h){const O=Math.min(U+h-1,u);b(W,U,O,k,this._compareMinY);for(let M=U;M<=O;M+=k)w.children.push(this._build(W,M,Math.min(M+k-1,O),I-1))}f(w,this._toBBox);return w}_insert(W,U,u){var I=this._toBBox;u=u?
W:I(W);Q.clear();I=this._data;for(var k=U,h=Q;;){h.push(I);if(!0===I.leaf||h.length-1===k)break;let w=Infinity,O=Infinity,M=void 0;for(let T=0,Y=I.children.length;T<Y;T++){const ea=I.children[T],ia=E(ea),na=(Math.max(ea.maxX,u.maxX)-Math.min(ea.minX,u.minX))*(Math.max(ea.maxY,u.maxY)-Math.min(ea.minY,u.minY))-ia;na<O?(O=na,w=ia<w?ia:w,M=ea):na===O&&ia<w&&(w=ia,M=ea)}I=M||I.children[0]}I.children.push(W);for(e(I,u);0<=U;)if(Q.data[U].children.length>this._maxEntries)this._split(Q,U),U--;else break;
for(W=Q;0<=U;U--)e(W.data[U],u)}_split(W,U){const u=W.data[U];var I=u.children.length;const k=this._minEntries;this._chooseSplitAxis(u,k,I);if(I=this._chooseSplitIndex(u,k,I))I=u.children.splice(I,u.children.length-I),I=u.leaf?new R(I):new Z(I),I.height=u.height,f(u,this._toBBox),f(I,this._toBBox),U?W.data[U-1].children.push(I):this._splitRoot(u,I)}_splitRoot(W,U){this._data=new Z([W,U]);this._data.height=W.height+1;f(this._data,this._toBBox)}_chooseSplitIndex(W,U,u){let I,k,h=void 0;I=k=Infinity;
for(let O=U;O<=u-U;O++){var w=p(W,0,O,this._toBBox);const M=p(W,O,u,this._toBBox),T=Math.max(0,Math.min(w.maxX,M.maxX)-Math.max(w.minX,M.minX))*Math.max(0,Math.min(w.maxY,M.maxY)-Math.max(w.minY,M.minY));w=E(w)+E(M);T<I?(I=T,h=O,k=w<k?w:k):T===I&&w<k&&(k=w,h=O)}return h}_chooseSplitAxis(W,U,u){const I=W.leaf?this._compareMinX:v,k=W.leaf?this._compareMinY:z,h=this._allDistMargin(W,U,u,I);U=this._allDistMargin(W,U,u,k);h<U&&W.children.sort(I)}_allDistMargin(W,U,u,I){W.children.sort(I);I=this._toBBox;
var k=p(W,0,U,I);const h=p(W,u-U,u,I);let w=J(k)+J(h);for(let O=U;O<u-U;O++){const M=W.children[O];e(k,W.leaf?I(M):M);w+=J(k)}for(u=u-U-1;u>=U;u--)k=W.children[u],e(h,W.leaf?I(k):k),w+=J(h);return w}_condense(W){for(let U=W.length-1;0<=U;U--){const u=W.data[U];if(0===u.children.length)if(0<U){const I=W.data[U-1],k=I.children;k.splice(g.indexOf(k,u,k.length,I.indexHint),1)}else this.clear();else f(u,this._toBBox)}}_initFormat(W){const U=["return a"," - b",";"];this._compareMinX=new Function("a","b",
U.join(W[0]));this._compareMinY=new Function("a","b",U.join(W[1]));this._toBBox=new Function("a","return {minX: a"+W[0]+", minY: a"+W[1]+", maxX: a"+W[2]+", maxY: a"+W[3]+"};")}}const n=new x,D=new x,Q=new x,a=new x({deallocator:void 0});class C{constructor(){this.minY=this.minX=Infinity;this.maxY=this.maxX=-Infinity}}class P extends C{constructor(){super(...arguments);this.height=1;this.indexHint=new g.PositionHint}}class R extends P{constructor(W){super();this.children=W;this.leaf=!0}}class Z extends P{constructor(W){super();
this.children=W;this.leaf=!1}}d.BBox=C;d.PooledRBush=t;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/quickselect":function(){define(["exports","./_commonjsHelpers"],function(d,g){var y={exports:{}};(function(x){(function(G){G=G();void 0!==G&&(x.exports=G)})(function(){function G(p,e,v,z,E){for(;z>v;){if(600<z-v){var J=z-v+1,r=e-v+1,q=Math.log(J),b=.5*Math.exp(2*q/3);q=.5*Math.sqrt(q*b*(J-b)/J)*(0>r-J/2?-1:1);G(p,e,Math.max(v,Math.floor(e-r*b/J+q)),Math.min(z,Math.floor(e+
(J-r)*b/J+q)),E)}J=p[e];r=v;b=z;A(p,v,e);for(0<E(p[z],J)&&A(p,v,z);r<b;){A(p,r,b);r++;for(b--;0>E(p[r],J);)r++;for(;0<E(p[b],J);)b--}0===E(p[v],J)?A(p,v,b):(b++,A(p,b,z));b<=e&&(v=b+1);e<=b&&(z=b-1)}}function A(p,e,v){var z=p[e];p[e]=p[v];p[v]=z}function f(p,e){return p<e?-1:p>e?1:0}return function(p,e,v,z,E){G(p,e,v||0,z||p.length-1,E||f)}})})(y);g=g.getDefaultExportFromCjs(y.exports);d.quickselect=g})},"esri/layers/graphics/data/geometryUtils":function(){define(["exports","../featureConversionUtils",
"../OptimizedGeometry"],function(d,g,y){const x=new y,G=new y,A=new y,f={esriGeometryPoint:g.convertToPoint,esriGeometryPolyline:g.convertToPolyline,esriGeometryPolygon:g.convertToPolygon,esriGeometryMultipoint:g.convertToMultipoint},p=(e,v)=>"_geVersion"!==e?v:void 0;d.cleanFromGeometryEngine=function(e){return e&&"_geVersion"in e?JSON.parse(JSON.stringify(e,p)):e};d.getGeometry=function(e,v,z,E,J,r,q=v,b=z){const t=v&&q,n=z&&b;E=null!=E?"coords"in E?E:E.geometry:null;if(null==E)return null;if(J)return v=
g.generalizeOptimizedGeometry(G,E,v,z,e,J,q,b),r&&(v=g.quantizeOptimizedGeometry(A,v,t,n,e,r)),f[e]?.(v,t,n)??null;if(r)return r=g.quantizeOptimizedGeometry(A,E,v,z,e,r,q,b),f[e]?.(r,t,n)??null;g.removeZMValues(x,E,v,z,q,b);return f[e]?.(x,t,n)??null};d.transformCentroid=function(e,v,z,E=e.hasZ,J=e.hasM){if(null==v)return null;const r=e.hasZ&&E,q=e.hasM&&J;return z?(e=g.quantizeOptimizedGeometry(A,v,e.hasZ,e.hasM,"esriGeometryPoint",z,E,J),g.convertToPoint(e,r,q)):g.convertToPoint(v,r,q)};Object.defineProperty(d,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/optimizedFeatureQueryEngineAdapter":function(){define(["exports","../centroid","../OptimizedFeature","../OptimizedGeometry"],function(d,g,y,x){d.optimizedFeatureQueryEngineAdapter={getObjectId(G){return G.objectId},getAttributes(G){return G.attributes},getAttribute(G,A){return G.attributes[A]},cloneWithGeometry(G,A){return new y.OptimizedFeature(A,G.attributes,null,G.objectId)},getGeometry(G){return G.geometry},getCentroid(G,A){null==
G.centroid&&(G.centroid=g.getCentroidOptimizedGeometry(new x,G.geometry,A.hasZ,A.hasM));return G.centroid}};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/centroid":function(){define(["exports"],function(d){function g(x,G,A,f,p,e){e=p?e?4:3:e?3:2;let v=A,z=A+e,E=0,J=0,r=A=0,q=0;for(let b=0,t=f-1;b<t;b++,v+=e,z+=e){f=G[v];const n=G[v+1],D=G[v+2],Q=G[z],a=G[z+1],C=G[z+2];let P=f*a-Q*n;r+=P;E+=(f+Q)*P;J+=(n+a)*P;p&&(P=f*C-Q*D,A+=(D+C)*P,q+=P);f<x[0]&&(x[0]=f);f>
x[1]&&(x[1]=f);n<x[2]&&(x[2]=n);n>x[3]&&(x[3]=n);p&&(D<x[4]&&(x[4]=D),D>x[5]&&(x[5]=D))}0<r&&(r*=-1);0<q&&(q*=-1);if(!r)return null;x=[E,J,.5*r];p&&(x[3]=A,x[4]=.5*q);return x}function y(x,G,A,f,p){p=f?p?4:3:p?3:2;let e=G,v=G+p,z=0,E=0,J=0,r=0;for(let n=0,D=A-1;n<D;n++,e+=p,v+=p){var q=x[e];const Q=x[e+1],a=x[e+2],C=x[v],P=x[v+1],R=x[v+2];if(f){var b=C-q;var t=P-Q;const Z=R-a;b=Math.sqrt(b*b+t*t+Z*Z)}else b=C-q,t=P-Q,b=Math.sqrt(b*b+t*t);b&&(z+=b,f?(q=[q+.5*(C-q),Q+.5*(P-Q),a+.5*(R-a)],E+=b*q[0],
J+=b*q[1],r+=b*q[2]):(q=[q+.5*(C-q),Q+.5*(P-Q)],E+=b*q[0],J+=b*q[1]))}return 0<z?f?[E/z,J/z,r/z]:[E/z,J/z]:0<A?f?[x[G],x[G+1],x[G+2]]:[x[G],x[G+1]]:null}d.getCentroidOptimizedGeometry=function(x,G,A,f){if(!G?.lengths.length)return null;x.lengths.length&&(x.lengths.length=0);x.coords.length&&(x.coords.length=0);const p=x.coords,e=[],v=A?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,
Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:z,coords:E}=G;var J=A?f?4:3:f?3:2;let r=0;for(const q of z){const b=g(v,E,r,q,A,f);b&&e.push(b);r+=q*J}e.sort((q,b)=>{let t=q[2]-b[2];0===t&&A&&(t=q[4]-b[4]);return t});e.length&&(J=6*e[0][2],p[0]=e[0][0]/J,p[1]=e[0][1]/J,A&&(J=6*e[0][4],p[2]=0!==J?e[0][3]/J:0),p[0]<v[0]||p[0]>v[1]||p[1]<v[2]||p[1]>v[3]||A&&(p[2]<v[4]||p[2]>v[5]))&&(p.length=0);if(!p.length)if(G=G.lengths[0]?y(E,0,z[0],A,f):null)p[0]=G[0],p[1]=G[1],
A&&2<G.length&&(p[2]=G[2]);else return null;return x};d.lineCentroid=y;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/projectionSupport":function(){define("exports ../../../core/arrayUtils ../../../core/promiseUtils ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),function(d,g,y,x,G,A,f){function p(b,t){if(!t)return null;if("x"in t){var n=
{x:0,y:0};[n.x,n.y]=b(t.x,t.y,z);null!=t.z&&(n.z=t.z);null!=t.m&&(n.m=t.m);return n}return"xmin"in t?(n={xmin:0,ymin:0,xmax:0,ymax:0},[n.xmin,n.ymin]=b(t.xmin,t.ymin,z),[n.xmax,n.ymax]=b(t.xmax,t.ymax,z),t.hasZ&&(n.zmin=t.zmin,n.zmax=t.zmax,n.hasZ=!0),t.hasM&&(n.mmin=t.mmin,n.mmax=t.mmax,n.hasM=!0),n):"rings"in t?{rings:e(t.rings,b),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:e(t.paths,b),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:v(t.points,b),hasM:t.hasM,hasZ:t.hasZ}:null}function e(b,t){const n=
[];for(const D of b)n.push(v(D,t));return n}function v(b,t){const n=[];for(const D of b)b=t(D[0],D[1],[0,0]),n.push(b),2<D.length&&b.push(D[2]),3<D.length&&b.push(D[3]);return n}const z=[0,0],E=p.bind(null,f.lngLatToXY),J=p.bind(null,f.xyToLngLat);class r{constructor(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}async push(b,t,n,D){if(!b?.length||!t||!n||A.equals(t,n))return b;b={geometries:b,inSpatialReference:t,outSpatialReference:n,geographicTransformation:D,resolve:y.createResolver()};
this._jobs.push(b);this._timer??(this._timer=setTimeout(this._process,10));return b.resolve.promise}_process(){this._timer=null;const b=this._jobs.shift();if(b){var {geometries:t,inSpatialReference:n,outSpatialReference:D,resolve:Q,geographicTransformation:a}=b;f.canProject(n,D)?A.isWebMercator(D)?Q(t.map(E)):Q(t.map(J)):Q(x.projectMany(G.jsonAdapter,t,n,D,a,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}}}const q=new r;d.checkProjectionSupport=async function(b,t){b&&t&&(b=
Array.isArray(b)?b.map(n=>null!=n.geometry?n.geometry.spatialReference:null).filter(g.isSome):[b],await x.initializeProjection(b.map(n=>({source:n,dest:t}))))};d.project=function(b,t,n,D){if(!b)return b;n||(n=t,t=b.spatialReference);return A.isValid(t)&&A.isValid(n)&&!A.equals(t,n)?f.canProject(t,n)?(b=A.isWebMercator(n)?E(b):J(b),b.spatialReference=n,b):x.projectMany(G.jsonAdapter,[b],t,n,null,D)[0]:b};d.projectMany=function(b,t,n,D){return q.push(b,t,n,D)};Object.defineProperty(d,Symbol.toStringTag,
{value:"Module"})})},"esri/geometry/geometryAdapters/json":function(){define(["exports"],function(d){class g{constructor(f,p,e){this.x=f;this.y=p;this.spatialReference=e;this.m=this.z=void 0}}class y{constructor(f,p,e,v){this.rings=f;this.spatialReference=p;this.hasM=this.hasZ=void 0;e&&(this.hasZ=e);v&&(this.hasM=v)}}class x{constructor(f,p,e,v){this.paths=f;this.spatialReference=p;this.hasM=this.hasZ=void 0;e&&(this.hasZ=e);v&&(this.hasM=v)}}class G{constructor(f,p,e,v){this.points=f;this.spatialReference=
p;this.hasM=this.hasZ=void 0;e&&(this.hasZ=e);v&&(this.hasM=v)}}class A{constructor(f,p,e,v,z){this.xmin=f;this.ymin=p;this.xmax=e;this.ymax=v;this.spatialReference=z;this.mmax=this.mmin=this.zmax=this.zmin=void 0}}d.jsonAdapter={convertToGEGeometry:function(f,p){return null==p?null:f.convertJSONToGeometry(p)},exportPoint:function(f,p,e){e=new g(f.getPointX(p),f.getPointY(p),e);const v=f.hasZ(p),z=f.hasM(p);v&&(e.z=f.getPointZ(p));z&&(e.m=f.getPointM(p));return e},exportPolygon:function(f,p,e){return new y(f.exportPaths(p),
e,f.hasZ(p),f.hasM(p))},exportPolyline:function(f,p,e){return new x(f.exportPaths(p),e,f.hasZ(p),f.hasM(p))},exportMultipoint:function(f,p,e){return new G(f.exportPoints(p),e,f.hasZ(p),f.hasM(p))},exportExtent:function(f,p,e){var v=f.hasZ(p);const z=f.hasM(p);e=new A(f.getXMin(p),f.getYMin(p),f.getXMax(p),f.getYMax(p),e);v&&(v=f.getZExtent(p),e.zmin=v.vmin,e.zmax=v.vmax);z&&(f=f.getMExtent(p),e.mmin=f.vmin,e.mmax=f.vmax);return e}};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngine":function(){define("exports ../../../core/arrayUtils ../../../core/Error ../../../core/JSONSupport ../../../core/lang ../../../core/maybe ../../../core/MemCache ../../../core/promiseUtils ../../../core/unitUtils ../../../geometry/projection ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./attributeSupport ./geometryUtils ./projectionSupport ./QueryEngineCapabilities ./QueryEngineResult ./queryUtils ./queryValidationUtils ./spatialQuerySupport ./timeSupport ../../support/FieldsIndex ../../../views/support/Scheduler".split(" "),
function(d,g,y,x,G,A,f,p,e,v,z,E,J,r,q,b,t,n,D,Q,a,C,P,R,Z,W,U,u){function I(M){if(Z.canQueryWithRBush(M)){if(r.isExtent(M))return[E.fromValues(Math.min(M.xmin,M.xmax),Math.min(M.ymin,M.ymax),Math.max(M.xmin,M.xmax),Math.max(M.ymin,M.ymax))];if(r.isPolygon(M))return M.rings.map(T=>E.fromValues(Math.min(T[0][0],T[2][0]),Math.min(T[0][1],T[2][1]),Math.max(T[0][0],T[2][0]),Math.max(T[0][1],T[2][1])))}return[J.getBoundsXY(E.create(),M)]}class k{constructor(M,T=null,Y,ea,ia){this.attributes=M;this.geometry=
Y;this.centroid=ea;this.filterFlags=ia;this.groupId=-1;this.displayId=T}}const h=new f.MemCacheStorage(2E6);let w=0;class O{constructor(M){this._changeHandle=this._geometryQueryCache=null;this.capabilities={query:a.queryCapabilities};this.geometryType=M.geometryType;this.hasM=!!M.hasM;this.hasZ=!!M.hasZ;this.objectIdField=M.objectIdField;this.spatialReference=M.spatialReference;this.definitionExpression=M.definitionExpression;this.featureStore=M.featureStore;this.aggregateAdapter=M.aggregateAdapter;
this._changeHandle=this.featureStore.events.on("changed",()=>this.clearCache());this.timeInfo=M.timeInfo;M.cacheSpatialQueries&&(this._geometryQueryCache=new f.MemCache(w++ +"$$",h));this.fieldsIndex=x.isSerializable(M.fieldsIndex)?M.fieldsIndex:U.fromJSON(M.fieldsIndex);this.availableFields=!M.availableFields||1===M.availableFields.length&&"*"===M.availableFields[0]?new Set(this.fieldsIndex.fields.map(T=>T.name)):new Set(M.availableFields.map(T=>this.fieldsIndex.get(T)?.name).filter(T=>null!=T));
M.scheduler&&M.priority&&(this._frameTask=M.scheduler.registerTask(M.priority))}destroy(){this._frameTask=A.removeMaybe(this._frameTask);this.clearCache();A.destroyMaybe(this._geometryQueryCache);this._changeHandle=A.removeMaybe(this._changeHandle)}get featureAdapter(){return this.featureStore.featureAdapter}clearCache(){this._geometryQueryCache?.clear();this._fullExtentPromise=this._timeExtentPromise=this._allFeaturesPromise=null}async executeQuery(M,T){T=p.signalFromSignalOrOptions(T);try{return(await this._executeQuery(M,
{},T)).createQueryResponse()}catch(Y){if(Y!==P.queryEngineEmptyResult)throw Y;return(new C.QueryEngineResult([],M,this)).createQueryResponse()}}async executeQueryForCount(M={},T){T=p.signalFromSignalOrOptions(T);try{return(await this._executeQuery(M,{returnGeometry:!1,returnCentroid:!1,outSR:null},T)).createQueryResponseForCount()}catch(Y){if(Y!==P.queryEngineEmptyResult)throw Y;return 0}}async executeQueryForExtent(M,T){T=p.signalFromSignalOrOptions(T);const Y=M.outSR;try{const ea=await this._executeQuery(M,
{returnGeometry:!0,returnCentroid:!1,outSR:null},T),ia=ea.size;if(!ia)return{count:0,extent:null};const na=await this._getBounds(ea.items,ea.spatialReference,Y||this.spatialReference);return{count:ia,extent:na}}catch(ea){if(ea===P.queryEngineEmptyResult)return{count:0,extent:null};throw ea;}}async executeQueryForIds(M,T){return this.executeQueryForIdSet(M,T).then(Y=>Array.from(Y))}async executeQueryForIdSet(M,T){T=p.signalFromSignalOrOptions(T);try{const Y=await this._executeQuery(M,{returnGeometry:!0,
returnCentroid:!1,outSR:null},T),ea=Y.items,ia=new Set;await this._reschedule(()=>{for(const na of ea)ia.add(Y.featureAdapter.getObjectId(na))},T);return ia}catch(Y){if(Y===P.queryEngineEmptyResult)return new Set;throw Y;}}async executeQueryForSnapping(M,T){const Y=p.signalFromSignalOrOptions(T),{point:ea,distance:ia,returnEdge:na,vertexMode:qa}=M;if(!na&&"none"===qa)return{candidates:[]};let va=G.clone(M.query);va=await this._schedule(()=>P.normalizeQueryLike(va,this.definitionExpression,this.spatialReference),
Y);va=await this._reschedule(()=>R.validateQuery(va,{availableFields:this.availableFields,fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference}),Y);(T=!b.equals(ea.spatialReference,this.spatialReference))&&await Q.checkProjectionSupport(ea.spatialReference,this.spatialReference);var ta="number"===typeof ia?ia:ia.x,wa="number"===typeof ia?ia:ia.y;ta={xmin:ea.x-ta,xmax:ea.x+ta,ymin:ea.y-wa,ymax:ea.y+wa,spatialReference:ea.spatialReference};ta=T?Q.project(ta,
this.spatialReference):ta;if(!ta)return{candidates:[]};wa=(await q.normalizeCentralMeridian(r.fromJSON(ea),null,{signal:Y}))[0];const Ea=(await q.normalizeCentralMeridian(r.fromJSON(ta),null,{signal:Y}))[0];if(null==wa||null==Ea)return{candidates:[]};const Da=new C.QueryEngineResult(await this._reschedule(()=>this._searchFeatures(I(Ea.toJSON())),Y),va,this);await this._reschedule(()=>this._executeObjectIdsQuery(Da),Y);await this._reschedule(()=>this._executeTimeQuery(Da),Y);await this._reschedule(()=>
this._executeAttributesQuery(Da),Y);await this._reschedule(()=>this._executeGeometryQueryForSnapping(Da,Y),Y);wa=wa.toJSON();wa=T?Q.project(wa,this.spatialReference):wa;return Da.createSnappingResponse({...M,point:wa,distance:T?Math.max(ta.xmax-ta.xmin,ta.ymax-ta.ymin)/2:ia},ea.spatialReference)}async executeQueryForLatestObservations(M,T){T=p.signalFromSignalOrOptions(T);if(!this.timeInfo?.trackIdField)throw new y("unsupported-query","Missing timeInfo or timeInfo.trackIdField",{query:M,timeInfo:this.timeInfo});
try{const Y=await this._executeQuery(M,{},T);await this._reschedule(()=>this._filterLatest(Y),T);return Y.createQueryResponse()}catch(Y){if(Y!==P.queryEngineEmptyResult)throw Y;return(new C.QueryEngineResult([],M,this)).createQueryResponse()}}async executeQueryForSummaryStatistics(M={},T,Y){Y=p.signalFromSignalOrOptions(Y);const {field:ea,normalizationField:ia,valueExpression:na}=T;return(await this._executeQueryForStatistics(M,{field:ea,normalizationField:ia,valueExpression:na},Y)).createSummaryStatisticsResponse(T)}async executeQueryForUniqueValues(M=
{},T,Y){Y=p.signalFromSignalOrOptions(Y);const {field:ea,field2:ia,field3:na,valueExpression:qa}=T;return(await this._executeQueryForStatistics(M,{field:ea,field2:ia,field3:na,valueExpression:qa},Y)).createUniqueValuesResponse(T)}async executeQueryForClassBreaks(M={},T,Y){Y=p.signalFromSignalOrOptions(Y);const {field:ea,normalizationField:ia,valueExpression:na}=T;return(await this._executeQueryForStatistics(M,{field:ea,normalizationField:ia,valueExpression:na},Y)).createClassBreaksResponse(T)}async executeQueryForHistogram(M=
{},T,Y){Y=p.signalFromSignalOrOptions(Y);const {field:ea,normalizationField:ia,valueExpression:na}=T;return(await this._executeQueryForStatistics(M,{field:ea,normalizationField:ia,valueExpression:na},Y)).createHistogramResponse(T)}async fetchRecomputedExtents(M){M=p.signalFromSignalOrOptions(M);this._timeExtentPromise||(this._timeExtentPromise=W.getTimeExtent(this.timeInfo,this.featureStore));const [T,Y]=await Promise.all([this._getFullExtent(),this._timeExtentPromise]);p.throwIfAborted(M);return{fullExtent:T,
timeExtent:Y}}async _getBounds(M,T,Y){const ea=z.set(z.create(),z.negativeInfinity);await this.featureStore.forEachBounds(M,ia=>z.expandWithAABB(ea,ia));M={xmin:ea[0],ymin:ea[1],xmax:ea[3],ymax:ea[4],spatialReference:D.cleanFromGeometryEngine(this.spatialReference)};this.hasZ&&isFinite(ea[2])&&isFinite(ea[5])&&(M.zmin=ea[2],M.zmax=ea[5],M.hasZ=!0);T=Q.project(M,T,Y);T.spatialReference=D.cleanFromGeometryEngine(Y);0===T.xmax-T.xmin&&(Y=e.getMetersPerUnitForSR(T.spatialReference),T.xmin-=Y,T.xmax+=
Y);0===T.ymax-T.ymin&&(Y=e.getMetersPerUnitForSR(T.spatialReference),T.ymin-=Y,T.ymax+=Y);this.hasZ&&null!=T.zmin&&null!=T.zmax&&0===T.zmax-T.zmin&&(Y=e.getMetersPerUnitForSR(T.spatialReference),T.zmin-=Y,T.zmax+=Y);return T}_getFullExtent(){this._fullExtentPromise||(this._fullExtentPromise="getFullExtent"in this.featureStore&&this.featureStore.getFullExtent?Promise.resolve(this.featureStore.getFullExtent(this.spatialReference)):this._getAllFeatures().then(M=>this._getBounds(M,this.spatialReference,
this.spatialReference)));return this._fullExtentPromise}async _schedule(M,T){return null!=this._frameTask?this._frameTask.schedule(M,T):M(u.noBudget)}async _reschedule(M,T){return null!=this._frameTask?this._frameTask.reschedule(M,T):M(u.noBudget)}async _getAllFeaturesQueryEngineResult(M){return new C.QueryEngineResult(await this._getAllFeatures(),M,this)}async _getAllFeatures(){if(null==this._allFeaturesPromise){const Y=[];this._allFeaturesPromise=(async()=>{await this.featureStore.forEach(ea=>Y.push(ea))})().then(()=>
Y)}const M=this._allFeaturesPromise,T=await M;return M===this._allFeaturesPromise?T.slice():this._getAllFeatures()}async _executeQuery(M,T,Y){M=G.clone(M);M=await this._schedule(()=>P.normalizeQuery(M,this.definitionExpression,this.spatialReference),Y);M=await this._reschedule(()=>R.validateQuery(M,{availableFields:this.availableFields,fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference}),Y);M={...M,...T};const ea=await this._reschedule(()=>this._executeSceneFilterQuery(M,
Y),Y),ia=await this._reschedule(()=>this._executeGeometryQuery(M,ea,Y),Y);await this._reschedule(()=>this._executeAggregateIdsQuery(ia),Y);await this._reschedule(()=>this._executeObjectIdsQuery(ia),Y);await this._reschedule(()=>this._executeTimeQuery(ia),Y);await this._reschedule(()=>this._executeAttributesQuery(ia),Y);return ia}async _executeSceneFilterQuery(M,T){if(null==M.sceneFilter)return null;const {outSR:Y,returnGeometry:ea,returnCentroid:ia}=M;var na=this.featureStore.featureSpatialReference,
qa=M.sceneFilter.geometry;const va=null==na||b.equals(na,qa.spatialReference)?qa:Q.project(qa,na);if(!va)return null;na=ea||ia;na=b.isValid(Y)&&!b.equals(this.spatialReference,Y)&&na?async Da=>this._project(Da,Y):Da=>Da;const ta=this.featureAdapter;qa=await this._reschedule(()=>this._searchFeatures(I(va)),T);if("disjoint"===M.sceneFilter.spatialRelationship){if(!qa.length)return null;const Da=new Set;for(var wa of qa)Da.add(ta.getObjectId(wa));const Pa=await this._reschedule(()=>this._getAllFeatures(),
T);wa=await this._reschedule(async()=>{const Sa=await Z.getSpatialQueryOperator("esriSpatialRelDisjoint",va,this.geometryType,this.hasZ,this.hasM),Ta=await this._runSpatialFilter(Pa,Oa=>!Da.has(ta.getObjectId(Oa))||Sa(ta.getGeometry(Oa)),T);return new C.QueryEngineResult(Ta,M,this)},T);return na(wa)}if(!qa.length)return new C.QueryEngineResult([],M,this);if(this._canExecuteSinglePass(va,M))return na(new C.QueryEngineResult(qa,M,this));const Ea=await Z.getSpatialQueryOperator("esriSpatialRelContains",
va,this.geometryType,this.hasZ,this.hasM);wa=await this._runSpatialFilter(qa,Da=>Ea(ta.getGeometry(Da)),T);return na(new C.QueryEngineResult(wa,M,this))}async _executeGeometryQuery(M,T,Y){if(null!=T&&0===T.items.length)return T;M=null!=T?T.query:M;const {geometry:ea,outSR:ia,spatialRel:na,returnGeometry:qa,returnCentroid:va}=M;var ta=this.featureStore.featureSpatialReference;const wa=!ea||null==ta||b.equals(ta,ea.spatialReference)?ea:Q.project(ea,ta),Ea=qa||va,Da=b.isValid(ia)&&!b.equals(this.spatialReference,
ia),Pa=this._geometryQueryCache&&null==T?Da&&Ea?JSON.stringify({originalFilterGeometry:ea,spatialRelationship:na,outSpatialReference:ia}):JSON.stringify({originalFilterGeometry:ea,spatialRelationship:na}):null;ta=Pa?this._geometryQueryCache.get(Pa):null;if(null!=ta)return new C.QueryEngineResult(ta,M,this);ta=async F=>{Da&&Ea&&await this._project(F,ia);Pa&&this._geometryQueryCache.put(Pa,F.items,F.items.length+1);return F};if(!wa)return ta(null!=T?T:await this._getAllFeaturesQueryEngineResult(M));
const Sa=this.featureAdapter;let Ta=await this._reschedule(()=>this._searchFeatures(I(ea)),Y);if("esriSpatialRelDisjoint"===na){if(!Ta.length)return ta(null!=T?T:await this._getAllFeaturesQueryEngineResult(M));const F=new Set;for(var Oa of Ta)F.add(Sa.getObjectId(Oa));const X=null!=T?T.items:await this._reschedule(()=>this._getAllFeatures(),Y);Oa=await this._reschedule(async()=>{const ba=await Z.getSpatialQueryOperator(na,wa,this.geometryType,this.hasZ,this.hasM),ja=await this._runSpatialFilter(X,
B=>!F.has(Sa.getObjectId(B))||ba(Sa.getGeometry(B)),Y);return new C.QueryEngineResult(ja,M,this)},Y);return ta(Oa)}if(null!=T){const F=new g.PositionHint;Ta=Ta.filter(X=>0<=g.indexOf(T.items,X,T.items.length,F))}if(!Ta.length)return ta=new C.QueryEngineResult([],M,this),Pa&&this._geometryQueryCache.put(Pa,ta.items,1),ta;if(this._canExecuteSinglePass(wa,M))return ta(new C.QueryEngineResult(Ta,M,this));const l=await Z.getSpatialQueryOperator(na,wa,this.geometryType,this.hasZ,this.hasM);Oa=await this._runSpatialFilter(Ta,
F=>l(Sa.getGeometry(F)),Y);return ta(new C.QueryEngineResult(Oa,M,this))}async _executeGeometryQueryForSnapping(M,T){const {query:Y}=M,{spatialRel:ea}=Y;if(M?.items?.length&&Y.geometry&&ea){var ia=await Z.getSpatialQueryOperator(ea,Y.geometry,this.geometryType,this.hasZ,this.hasM);T=await this._runSpatialFilter(M.items,na=>ia(na.geometry),T);M.items=T}}_executeAggregateIdsQuery(M){if(0!==M.items.length&&M.query.aggregateIds?.length&&null!=this.aggregateAdapter){var T=new Set;for(const ea of M.query.aggregateIds)this.aggregateAdapter.getFeatureObjectIds(ea).forEach(ia=>
T.add(ia));var Y=this.featureAdapter.getObjectId;M.items=M.items.filter(ea=>T.has(Y(ea)))}}_executeObjectIdsQuery(M){if(0!==M.items.length&&M.query.objectIds?.length){var T=new Set(M.query.objectIds),Y=this.featureAdapter.getObjectId;M.items=M.items.filter(ea=>T.has(Y(ea)))}}_executeTimeQuery(M){if(0!==M.items.length){var T=W.getTimeOperator(this.timeInfo,M.query.timeExtent,this.featureAdapter);null!=T&&(M.items=M.items.filter(T))}}_executeAttributesQuery(M){if(0!==M.items.length){var T=n.getWhereClause(M.query.where,
this.fieldsIndex);if(T){if(!T.isStandardized)throw new TypeError("Where clause is not standardized");M.items=M.items.filter(Y=>T.testFeature(Y,this.featureAdapter))}}}async _runSpatialFilter(M,T,Y){if(!T)return M;if(null==this._frameTask)return M.filter(qa=>T(qa));let ea=0;const ia=[],na=async qa=>{for(;ea<M.length;){const va=M[ea++];T(va)&&(ia.push(va),qa.madeProgress());qa.done&&await this._reschedule(ta=>na(ta),Y)}};return this._reschedule(qa=>na(qa),Y).then(()=>ia)}_filterLatest(M){const {trackIdField:T,
startTimeField:Y,endTimeField:ea}=this.timeInfo,ia=ea||Y,na=new Map,qa=this.featureAdapter.getAttribute;for(const va of M.items){const ta=qa(va,T),wa=qa(va,ia),Ea=na.get(ta);(!Ea||wa>qa(Ea,ia))&&na.set(ta,va)}M.items=Array.from(na.values())}_canExecuteSinglePass(M,T){({spatialRel:T}=T);return Z.canQueryWithRBush(M)&&("esriSpatialRelEnvelopeIntersects"===T||"esriGeometryPoint"===this.geometryType&&("esriSpatialRelIntersects"===T||"esriSpatialRelContains"===T))}async _project(M,T){if(!T||b.equals(this.spatialReference,
T))return M;const Y=this.featureAdapter;let ea=void 0;try{const ia=await this._getFullExtent();ea=v.getTransformation(this.spatialReference,T,ia)}catch{}T=await Q.projectMany(M.items.map(ia=>D.getGeometry(this.geometryType,this.hasZ,this.hasM,Y.getGeometry(ia))),this.spatialReference,T,ea);M.items=T.map((ia,na)=>Y.cloneWithGeometry(M.items[na],t.convertFromGeometry(ia,this.hasZ,this.hasM)));return M}async _searchFeatures(M){const T=new Set;await Promise.all(M.map(Y=>this.featureStore.forEachInBounds(Y,
ea=>T.add(ea))));M=Array.from(T.values());T.clear();return M}async _executeQueryForStatistics(M,T,Y){M=G.clone(M);try{M=await this._schedule(()=>P.normalizeQuery(M,this.definitionExpression,this.spatialReference),Y);M=await this._reschedule(()=>R.validateStatisticsQuery(M,T,{availableFields:this.availableFields,fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference}),Y);const ea=await this._reschedule(()=>this._executeSceneFilterQuery(M,Y),Y),ia=await this._reschedule(()=>
this._executeGeometryQuery(M,ea,Y),Y);await this._reschedule(()=>this._executeAggregateIdsQuery(ia),Y);await this._reschedule(()=>this._executeObjectIdsQuery(ia),Y);await this._reschedule(()=>this._executeTimeQuery(ia),Y);await this._reschedule(()=>this._executeAttributesQuery(ia),Y);return ia}catch(ea){if(ea!==P.queryEngineEmptyResult)throw ea;return new C.QueryEngineResult([],M,this)}}}d.Feature=k;d.QueryEngine=O;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/MemCache":function(){define(["exports",
"./PooledArray"],function(d,g){d.RemoveMode=void 0;(function(f){f[f.ALL=0]="ALL";f[f.SOME=1]="SOME"})(d.RemoveMode||(d.RemoveMode={}));class y{constructor(f,p,e){this.name=f;this._storage=p;this.id=`${G++}:`;this.size=0;this.maxSize=-1;this._removeFunc=!1;this._miss=this._hit=0;this._storage.register(this);e&&(this._storage.registerRemoveFunc(this.id,e),this._removeFunc=!0)}destroy(){this._storage.clear(this);this._removeFunc&&this._storage.deregisterRemoveFunc(this.id);this._storage.deregister(this);
this._storage=null}get hitRate(){return this._hit/(this._hit+this._miss)}get storageSize(){return this._storage.size}getSize(f){return this._storage.getSize(this,f)}resetHitRate(){this._hit=this._miss=0}put(f,p,e,v=0){this._storage.put(this,f,p,e,v)}pop(f){f=this._storage.pop(this,f);void 0===f?++this._miss:++this._hit;return f}get(f){f=this._storage.get(this,f);void 0===f?++this._miss:++this._hit;return f}peek(f){return this._storage.peek(this,f)}updateSize(f,p,e){this._storage.updateSize(this,f,
p,e)}clear(){this._storage.clear(this)}clearAll(){this._storage.clearAll()}get performanceInfo(){return this._storage.performanceInfo}resetStats(){this._storage.resetStats()}}class x{get size(){return this._size}constructor(f=10485760){this._maxSize=f;this._db=new Map;this._miss=this._hit=this._size=0;this._removeFuncs=new g;this._users=new g}destroy(){this.clearAll();this._removeFuncs.clear();this._users.clear();this._db=null}register(f){this._users.push(f)}deregister(f){this._users.removeUnordered(f)}registerRemoveFunc(f,
p){this._removeFuncs.push([f,p])}deregisterRemoveFunc(f){this._removeFuncs.filterInPlace(p=>p[0]!==f)}get maxSize(){return this._maxSize}set maxSize(f){this._maxSize=Math.max(f,-1);this._checkSize()}getSize(f,p){return this._db.get(f.id+p)?.size??0}put(f,p,e,v,z){p=f.id+p;const E=this._db.get(p);E&&(this._size-=E.size,f.size-=E.size,this._db.delete(p),E.entry!==e&&this._notifyRemove(p,E.entry,E.size,d.RemoveMode.ALL));v>this._maxSize?this._notifyRemove(p,e,v,d.RemoveMode.ALL):void 0===e?console.warn("Refusing to cache undefined entry "):
!v||0>v?(console.warn(`Refusing to cache entry with size ${v} for key ${p}`),this._notifyRemove(p,e,0,d.RemoveMode.ALL)):(this._db.set(p,new A(e,v,1+Math.max(z,-4)- -3)),this._size+=v,f.size+=v,this._checkSize())}updateSize(f,p,e,v){p=f.id+p;const z=this._db.get(p);if(z&&z.entry===e){this._size-=z.size;for(f.size-=z.size;v>this._maxSize;)if(v=this._notifyRemove(p,e,v,d.RemoveMode.SOME),!(null!=v&&0<v)){this._db.delete(p);return}z.size=v;this._size+=v;f.size+=v;this._checkSize()}}pop(f,p){p=f.id+p;
const e=this._db.get(p);if(e)return this._size-=e.size,f.size-=e.size,this._db.delete(p),++this._hit,e.entry;++this._miss}get(f,p){p=f.id+p;f=this._db.get(p);if(void 0===f)++this._miss;else return this._db.delete(p),f.lives=f.lifetime,this._db.set(p,f),++this._hit,f.entry}peek(f,p){(f=this._db.get(f.id+p))?++this._hit:++this._miss;return f?.entry}get performanceInfo(){const f={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+
"%",Entries:this._db.size.toString()},p={},e=[];this._db.forEach((E,J)=>{const r=E.lifetime;e[r]=(e[r]||0)+E.size;this._users.forAll(q=>{const {id:b,name:t}=q;J.startsWith(b)&&(p[t]=(p[t]||0)+E.size)})});const v={};this._users.forAll(E=>{const J=E.name;"hitRate"in E&&"number"===typeof E.hitRate&&!isNaN(E.hitRate)&&0<E.hitRate?(p[J]=p[J]||0,v[J]=Math.round(100*E.hitRate)+"%"):v[J]="0%"});var z=Object.keys(p);z.sort((E,J)=>p[J]-p[E]);z.forEach(E=>f[E]=Math.round(p[E]/2**20)+"MB / "+v[E]);for(z=e.length-
1;0<=z;--z){const E=e[z];E&&(f["Priority "+(z+-3-1)]=Math.round(E/this._size*100)+"%")}return f}resetStats(){this._hit=this._miss=0;this._users.forAll(f=>f.resetHitRate())}clear(f){const p=f.id;this._db.forEach((e,v)=>{v.startsWith(p)&&(this._size-=e.size,this._db.delete(v),this._notifyRemove(v,e.entry,e.size,d.RemoveMode.ALL))});f.size=0}clearAll(){this._db.forEach((f,p)=>this._notifyRemove(p,f.entry,f.size,d.RemoveMode.ALL));this._users.forAll(f=>f.size=0);this._size=0;this._db.clear()}_getHitRate(){return this._hit/
(this._hit+this._miss)}_notifyRemove(f,p,e,v){let z;this._removeFuncs.some(E=>f.startsWith(E[0])?(E=E[1](p,v,e),"number"===typeof E&&(z=E),!0):!1);return z}_checkSize(){this._users.forAll(f=>this._checkSizeLimits(f));this._checkSizeLimits()}_checkSizeLimits(f){const p=f??this;if(!(0>p.maxSize||p.size<=p.maxSize)){for(var e=f?.id,v=!0;v;){v=!1;for(const [z,E]of this._db)if(0===E.lifetime&&(!e||z.startsWith(e))){this._purgeItem(z,E,f);if(p.size<=.9*p.maxSize)return;v||=this._db.has(z)}}for(const [z,
E]of this._db)if(!e||z.startsWith(e))if(this._purgeItem(z,E,f),p.size<=.9*p.maxSize)break}}_purgeItem(f,p,e=this._users.find(v=>f.startsWith(v.id))){this._db.delete(f);if(1>=p.lives){this._size-=p.size;e&&(e.size-=p.size);const v=this._notifyRemove(f,p.entry,p.size,d.RemoveMode.SOME);null!=v&&0<v&&(this._size+=v,e&&(e.size+=v),p.lives=p.lifetime,p.size=v,this._db.set(f,p))}else--p.lives,this._db.set(f,p)}}let G=0;class A{constructor(f,p,e){this.entry=f;this.size=p;this.lives=this.lifetime=e}}d.MemCache=
y;d.MemCacheStorage=x;d.MinPriority=-3;d.NoPriority=-4;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/normalizeUtils":function(){define("exports ../../config ../../core/Error ../../core/Logger ../Polygon ../Polyline ./normalizeUtilsCommon ./spatialReferenceUtils ./webMercatorUtils ../../rest/geometryService/cut ../../rest/geometryService/simplify".split(" "),function(d,g,y,x,G,A,f,p,e,v,z){function E(D){const Q=[];let a=0,C=0;for(let P=0;P<D.length;P++){const R=
D[P];let Z=null;for(let W=0;W<R.length;W++)Z=R[W],Q.push(Z),0===W?C=a=Z[0]:(a=Math.min(a,Z[0]),C=Math.max(C,Z[0]));Z&&Q.push([(a+C)/2,0])}return Q}function J(D,Q){if(!(D instanceof A||D instanceof G))throw n().error("straightLineDensify: the input geometry is neither polyline nor polygon"),new y("straightLineDensify: the input geometry is neither polyline nor polygon");var a=f.getGeometryParts(D);const C=[];for(const R of a){a=[];C.push(a);a.push([R[0][0],R[0][1]]);for(let Z=0;Z<R.length-1;Z++){const W=
R[Z][0],U=R[Z][1],u=R[Z+1][0],I=R[Z+1][1];var P=Math.sqrt((u-W)*(u-W)+(I-U)*(I-U));const k=(I-U)/P,h=(u-W)/P,w=P/Q;if(1<w){for(let O=1;O<=w-1;O++){const M=O*Q;a.push([h*M+W,k*M+U])}P=(P+Math.floor(w-1)*Q)/2;a.push([h*P+W,k*P+U])}a.push([u,I])}}return"polygon"===D.type?new G({rings:C,spatialReference:D.spatialReference}):new A({paths:C,spatialReference:D.spatialReference})}function r(D,Q,a){Q&&(D=J(D,1E6),D=e.webMercatorToGeographic(D,!0));a&&(D=f.updatePolyGeometry(D,a));return D}function q(D,Q,a){if(Array.isArray(D)){var C=
D[0];C>Q?(a=f.offsetMagnitude(C,Q),D[0]=C+-2*a*Q):C<a&&(Q=f.offsetMagnitude(C,a),D[0]=C+-2*Q*a)}else C=D.x,C>Q?(a=f.offsetMagnitude(C,Q),D=D.clone().offset(-2*a*Q,0)):C<a&&(Q=f.offsetMagnitude(C,a),D=D.clone().offset(-2*Q*a,0));return D}function b(D,Q){let a=-1;for(let C=0;C<Q.cutIndexes.length;C++){const P=Q.cutIndexes[C],R=Q.geometries[C],Z=f.getGeometryParts(R);for(let W=0;W<Z.length;W++){const U=Z[W];U.some(u=>{if(180>u[0])return!0;u=0;for(var I=0;I<U.length;I++){var k=U[I][0];u=k>u?k:u}u=Number(u.toFixed(9));
u=-360*f.offsetMagnitude(u,180);for(I=0;I<U.length;I++)k=R.getPoint(W,I),R.setPoint(W,I,k.clone().offset(u,0));return!0})}if(P===a)if("polygon"===D[0].type)for(const W of f.getGeometryParts(R))D[P]=D[P].addRing(W);else{if("polyline"===D[0].type)for(const W of f.getGeometryParts(R))D[P]=D[P].addPath(W)}else a=P,D[P]=R}return D}async function t(D,Q,a){if(!Array.isArray(D))return t([D],Q);Q&&"string"!==typeof Q&&n().warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");
var C="string"===typeof Q?Q:Q?.url??g.geometryServiceUrl;let P,R,Z;let W=0;var U=[];Q=[];for(var u of D)if(null==u)Q.push(u);else{if(!I){var I=u.spatialReference;var k=p.getInfo(I);var h=(P=I.isWebMercator)?102100:4326;R=f.cutParams[h].maxX;Z=f.cutParams[h].minX;var w=f.cutParams[h].plus180Line;h=f.cutParams[h].minus180Line}if(k)if("mesh"===u.type)Q.push(u);else if("point"===u.type)Q.push(q(u.clone(),R,Z));else if("multipoint"===u.type){var O=u.clone();O.points=O.points.map(M=>q(M,R,Z));Q.push(O)}else if("extent"===
u.type)O=u.clone()._normalize(!1,!1,k),Q.push(O.rings?new G(O):O);else if(u.extent){O=u.extent;const M=2*f.offsetMagnitude(O.xmin,Z)*R;let T=0===M?u.clone():f.updatePolyGeometry(u.clone(),M);O.offset(M,0);let {xmin:Y,xmax:ea}=O;Y=Number(Y.toFixed(9));ea=Number(ea.toFixed(9));O.intersects(w)&&ea!==R?(W=ea>W?ea:W,T=r(T,P),U.push(T),Q.push("cut")):O.intersects(h)&&Y!==Z?(W=2*ea*R>W?2*ea*R:W,T=r(T,P,360),U.push(T),Q.push("cut")):Q.push(T)}else Q.push(u.clone());else Q.push(u)}I=f.offsetMagnitude(W,R);
k=-90;w=I;for(u=new A;0<I;)h=-180+360*I,u.addPath([[h,k],[h,-1*k]]),k*=-1,I--;if(0<U.length&&0<w){I=await v.cut(C,U,u,a);I=b(U,I);k=[];U=[];for(w=0;w<Q.length;w++)u=Q[w],"cut"!==u?U.push(u):(u=I.shift(),h=D[w],null!=h&&"polygon"===h.type&&h.rings&&1<h.rings.length&&u.rings.length>=h.rings.length?(k.push(u),U.push("simplify")):U.push(P?e.geographicToWebMercator(u):u));if(!k.length)return U;Q=await z.simplify(C,k,a);D=[];for(a=0;a<U.length;a++)C=U[a],"simplify"!==C?D.push(C):D.push(P?e.geographicToWebMercator(Q.shift()):
Q.shift());return D}D=[];for(a=0;a<Q.length;a++)C=Q[a],"cut"!==C?D.push(C):(C=U.shift(),D.push(!0===P?e.geographicToWebMercator(C):C));return D}const n=()=>x.getLogger("esri.geometry.support.normalizeUtils");d.getClosestDenormalizedXToReference=function(D,Q,a){a=p.getInfo(a);if(null==a)return D;const [C,P]=a.valid;a=2*P;let R=0,Z=0;Q>P?R=Math.ceil(Math.abs(Q-P)/a):Q<C&&(R=-Math.ceil(Math.abs(Q-C)/a));D>P?Z=Math.ceil(Math.abs(D-P)/a):D<C&&(Z=-Math.ceil(Math.abs(D-C)/a));D+=(R-Z)*a;Q=D-Q;Q>P?D-=a:Q<
C&&(D+=a);return D};d.getDenormalizedExtent=function(D){if(!D)return null;const Q=D.extent;if(!Q)return null;var a=D.spatialReference&&p.getInfo(D.spatialReference);if(!a)return Q;const [C,P]=a.valid;({width:a}=Q);let {xmin:R,xmax:Z}=Q;[R,Z]=[Z,R];if("extent"===D.type||0===a||a<=P||a>2*P||R<C||Z>P)return Q;let W;switch(D.type){case "polygon":if(1<D.rings.length)W=E(D.rings);else return Q;break;case "polyline":if(1<D.paths.length)W=E(D.paths);else return Q;break;case "multipoint":W=D.points}D=Q.clone();
for(let U=0;U<W.length;U++){let u=W[U][0];0>u?(u+=P,Z=Math.max(u,Z)):(u-=P,R=Math.min(u,R))}D.xmin=R;D.xmax=Z;return D.width<a?(D.xmin-=P,D.xmax-=P,D):Q};d.normalizeCentralMeridian=t;d.normalizeMapX=function(D,Q){if(Q=p.getInfo(Q)){const [a,C]=Q.valid;Q=C-a;if(D<a)for(;D<a;)D+=Q;if(D>C)for(;D>C;)D-=Q}return D};d.straightLineDensify=J;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/normalizeUtilsCommon":function(){define(["exports","../Polyline","../SpatialReference",
"./jsonUtils"],function(d,g,y,x){function G(A){return x.isPolygon(A)?A.rings:A.paths}g={102100:{maxX:2.0037508342788905E7,minX:-2.0037508342788905E7,plus180Line:new g({paths:[[[2.0037508342788905E7,-2.0037508342788905E7],[2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:y.WebMercator}),minus180Line:new g({paths:[[[-2.0037508342788905E7,-2.0037508342788905E7],[-2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:y.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new g({paths:[[[180,
-180],[180,180]]],spatialReference:y.WGS84}),minus180Line:new g({paths:[[[-180,-180],[-180,180]]],spatialReference:y.WGS84})}};d.cutParams=g;d.getGeometryParts=G;d.offsetMagnitude=function(A,f){return Math.ceil((A-f)/(2*f))};d.updatePolyGeometry=function(A,f){const p=G(A);for(const e of p)for(const v of e)v[0]+=f;return A};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/rest/geometryService/cut":function(){define("exports ../../geometry ../../request ../../geometry/support/jsonUtils ../../geometry/support/spatialReferenceUtils ../utils".split(" "),
function(d,g,y,x,G,A){d.cut=async function(f,p,e,v){f=A.parseUrl(f);const z=p[0].spatialReference;p={...v,responseType:"json",query:{...f.query,f:"json",sr:G.srToRESTValue(z),target:JSON.stringify({geometryType:x.getJsonType(p[0]),geometries:p}),cutter:JSON.stringify(e)}};p=await y(f.path+"/cut",p);const {cutIndexes:E,geometries:J=[]}=p.data;return{cutIndexes:E,geometries:J.map(r=>{r=x.fromJSON(r);r.spatialReference=z;return r})}};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/rest/utils":function(){define("exports ../config ../kernel ../core/lang ../core/urlUtils ../support/apiKeyUtils".split(" "),
function(d,g,y,x,G,A){function f(p,e,v){const z={};for(const J in p)if("declaredClass"!==J){var E=p[J];null!=E&&"function"!==typeof E&&(Array.isArray(E)?z[J]=E.map(r=>f(r)):"object"===typeof E?E.toJSON?(E=E.toJSON(v?.[J]),z[J]=e?E:JSON.stringify(E)):z[J]=e?E:JSON.stringify(E):z[J]=E)}return z}d.asValidOptions=function(p,e){return e?{...e,query:{...(p??{}),...e.query}}:{query:p}};d.encode=f;d.getToken=function(p,e){return p?A.supportsApiKey(p)&&(e||g.apiKey)?e||g.apiKey:y.id?.findCredential(p)?.token:
null};d.parseUrl=function(p){return"string"===typeof p?G.urlToObject(p):x.clone(p)};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/rest/geometryService/simplify":function(){define("exports ../../request ../../core/urlUtils ../../geometry/support/jsonUtils ../../geometry/support/spatialReferenceUtils ./utils".split(" "),function(d,g,y,x,G,A){d.simplify=async function(f,p,e){const v="string"===typeof f?y.urlToObject(f):f;f=p[0].spatialReference;const z=x.getJsonType(p[0]);p={...e,
query:{...v.query,f:"json",sr:G.srToRESTValue(f),geometries:JSON.stringify(A.encodeGeometries(p))}};({data:p}=await g(v.path+"/simplify",p));return A.decodeGeometries(p.geometries,z,f)};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/rest/geometryService/utils":function(){define(["exports","../../geometry/support/jsonUtils"],function(d,g){d.decodeGeometries=function(y,x,G){const A=g.getGeometryType(x);return y.map(f=>{f=A.fromJSON(f);f.spatialReference=G;return f})};d.encodeGeometries=
function(y){return{geometryType:g.getJsonType(y[0]),geometries:y.map(x=>x.toJSON())}};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/attributeSupport":function(){define(["exports","../../../core/Error","../../../core/sql/WhereClauseCache","../../support/fieldType"],function(d,g,y,x){function G(r,q,b={}){const t=A(q,r);if(!t)throw b=z.getError(q,r),new g("unsupported-query","invalid SQL expression",{expression:q,error:b});r=b.expressionName||"expression";
if(b.validateStandardized&&!t.isStandardized)throw new g("unsupported-query",`${r} is not standard`,{expression:q});if(b.validateAggregate&&!t.isAggregate)throw new g("unsupported-query",`${r} does not contain a valid aggregate function`,{expression:q});return t.fieldNames}function A(r,q){return r?z.get(r,q):null}function f(r){return/\((.*?)\)/.test(r)?r:r.split(" as ")[0]}function p(r,q,b,t={}){const n=new Map;e(n,r,q,t.allowedFieldTypes??J,b);if(n.size)throw new g("unsupported-query",`${t.expressionName??
"expression"} contains invalid or missing fields`,{errors:Array.from(n.values()),query:t.query});}function e(r,q,b,t,n){n=n.includes("*")?[...b,...n.filter(D=>"*"!==D)]:n;for(const D of n)if(q.get(D))v(r,q,b,t,D);else try{const Q=f(D),a=G(q,Q,{validateStandardized:!0});for(const C of a)v(r,q,b,t,C)}catch(Q){r.set(D,{type:"expression-error",expression:D,error:Q})}}function v(r,q,b,t,n){(q=q.get(n))?b.has(q.name)?"all"!==t&&!1===t?.has(q.type)&&r.set(n,{type:"invalid-type",fieldName:q.name,fieldType:x.kebabDict.fromJSON(q.type),
allowedFieldTypes:Array.from(t,D=>x.kebabDict.fromJSON(D))}):r.set(n,{type:"missing-field",fieldName:q.name}):r.set(n,{type:"invalid-field",fieldName:n})}const z=new y.WhereClauseCache(50,500);y=new Set("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeBigInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong".split(" "));const E=new Set(["esriFieldTypeDate","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]),J=new Set(["esriFieldTypeString",
"esriFieldTypeGUID","esriFieldTypeGlobalID",...y,...E]);d.allDateAndTimeFieldTypes=E;d.getAliasFromFieldName=function(r){return r.split(" as ")[1]};d.getExpressionFromFieldName=f;d.getWhereClause=A;d.numericFieldTypes=y;d.validateFields=p;d.validateHaving=function(r,q,b,t,n){if(!b)return!0;const D=G(r,b,{validateAggregate:!0,expressionName:"having clause"});p(r,q,D,{expressionName:"having clause",query:n});if(!A(b,r)?.getExpressions().every(Q=>{const {aggregateType:a,field:C}=Q,P=r.get(C)?.name;return t.some(R=>
{const {onStatisticField:Z,statisticType:W}=R;return r.get(Z)?.name===P&&W.toLowerCase().trim()===a})}))throw new g("unsupported-query","expressions in having clause should also exist in outStatistics",{having:b});return!0};d.validateWhere=function(r,q,b,t){if(!b)return!0;b=G(r,b,{validateStandardized:!0,expressionName:"where clause"});p(r,q,b,{expressionName:"where clause",query:t});return!0};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereClauseCache":function(){define(["exports",
"../LRUCache","./WhereClause"],function(d,g,y){class x{constructor(G,A){this._cache=new g.LRUCache(G);this._invalidCache=new g.LRUCache(A)}get(G,A){const f=`${A.uid}:${G}`,p=this._cache.get(f);if(p)return p;if(null!=this._invalidCache.get(f))return null;try{const e=y.WhereClause.create(G,A);this._cache.put(f,e);return e}catch(e){return this._invalidCache.put(f,e),null}}getError(G,A){return this._invalidCache.get(`${A.uid}:${G}`)??null}}d.WhereClauseCache=x;Object.defineProperty(d,Symbol.toStringTag,
{value:"Module"})})},"esri/core/LRUCache":function(){define(["exports","./MemCache"],function(d,g){class y{constructor(x,G){this._storage=new g.MemCacheStorage;this.name=this.id="";this.size=0;this._storage.maxSize=x;this._storage.register(this);G&&this._storage.registerRemoveFunc("",G)}destroy(){this._storage.deregister(this);this._storage.destroy()}put(x,G,A=1){this._storage.put(this,x,G,A,1)}pop(x){return this._storage.pop(this,x)}get(x){return this._storage.get(this,x)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(x){this._storage.maxSize=
x}resetHitRate(){}}d.LRUCache=y;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereClause":function(){define("exports ../../arcade/ArcadeDate ../../arcade/featureset/support/errorsupport ../has ./AggregateFunctions ./DateOnly ./sqlArithmeticUtils ./sqlCompareUtils ./sqlDateParsingUtils ./SqlInterval ./SqlTimestampOffset ./StandardizedFunctions ./TimeOnly ./WhereGrammar ../../chunks/datetime".split(" "),function(d,g,y,x,G,A,f,p,e,v,z,E,J,r,q){function b(u){return Array.isArray(u)?
u:[u]}function t(u){return null!==u?!0!==u:null}function n(u,I){return null!=u&&null!=I?!0===u&&!0===I:!1===u||!1===I?!1:null}function D(u,I){return null!=u&&null!=I?!0===u||!0===I:!0===u||!0===I?!0:null}function Q(u,I,k){if(null==u)return null;k=!1;for(const h of I)if(null==h)k=null;else if(u===h){k=!0;break}else if(p.isDateOrTimeValue(u)&&p.isDateOrTimeValue(h)&&(k=p.sqlCompare(u,h,"\x3d")))break;return k}function a(u,I,k){if(null==u)return null;let h="",w=W.Normal;for(let O=0;O<I.length;O++){const M=
I.charAt(O);switch(w){case W.Normal:M===k?w=W.Escaped:h="-[]/{}()*+?.\\^$|".includes(M)?h+("\\"+M):"%"===M?h+".*":"_"===M?h+".":h+M;break;case W.Escaped:h="-[]/{}()*+?.\\^$|".includes(M)?h+("\\"+M):h+M,w=W.Normal}}return(new RegExp("^"+h+"$","m")).test(u)}function C(u,I,k,h){u=h.getAttribute(u,I);I=k?.get(I);return null==u||"esriFieldTypeDate"!==I?.type&&"date"!==I?.type?null==u||"esriFieldTypeDateOnly"!==I?.type&&"date-only"!==I?.type?null==u||"esriFieldTypeTimeOnly"!==I?.type&&"time-only"!==I?.type?
null==u||"esriFieldTypeTimestampOffset"!==I?.type&&"timestamp-offset"!==I?.type?u:new z.SqlTimeStampOffset(u):J.TimeOnly.fromReader(u):A.DateOnly.fromReader(u):e.convertToExecutingTimeZone(new Date(u),k?.getLuxonTimeZone(I.name)??q.FixedOffsetZone.utcInstance)}const P=new Set(["current_timestamp","current_date","current_time"]);class R{static makeBool(u){return!0===u}static featureValue(u,I,k,h){return C(u,I,k,h)}static equalsNull(u){return null===u}static applyLike(u,I,k){return a(u,I,k)}static ensureArray(u){return b(u)}static applyIn(u,
I,k){return Q(u,I)}static currentDate(u){return A.DateOnly.fromNow(u)}static makeSqlInterval(u,I,k){return v.SqlInterval.createFromValueAndQualifier(u,I,k)}static convertInterval(u){return u instanceof v.SqlInterval?u.valueInMilliseconds():u}static currentTimestamp(u){return e.convertToExecutingTimeZone(new Date,u)}static compare(u,I,k,h){return p.sqlCompare(I,k,u)}static calculate(u,I,k,h){return f.sqlCalculateFunction(u,I,k,h)}static evaluateTime(u){return e.parseTime(u)}static evaluateTimestamp(u,
I,k){return e.parseTimestamp(u,I,k)}static evaluateDate(u,I){return e.parseDate(u,I)}static evaluateFunction(u,I,k){return E.evaluateFunction(u,I,k)}static lookup(u,I){u=I[u];return void 0===u?null:u}static between(u,I,k){return null==u||null==I[0]||null==I[1]?null:p.sqlCompare(u,I[0],"\x3e\x3d")&&p.sqlCompare(u,I[1],"\x3c\x3d")}static notbetween(u,I,k){return null==u||null==I[0]||null==I[1]?null:p.sqlCompare(u,I[0],"\x3c")||p.sqlCompare(u,I[1],"\x3e")}static ternaryNot(u){return t(u)}static ternaryAnd(u,
I){return n(u,I)}static ternaryOr(u,I){return D(u,I)}}class Z{constructor(u,I,k="UTC"){this.fieldsIndex=I;this.timeZone=k;this.parameters={};this._hasDateFunctions=void 0;this.parseTree=r.WhereGrammar.parse(u);const {isStandardized:h,isAggregate:w,referencedFieldNames:O}=this._extractExpressionInfo(I);this._referencedFieldNames=O;this.isStandardized=h;this.isAggregate=w}static convertValueToStorageFormat(u,I=null){if(null===I)return e.isDate(u)?u.getTime():e.isDateTime(u)?u.toMillis():e.isTimestampOffset(u)?
u.toStorageFormat():e.isTimeOnly(u)?u.toStorageString():e.isDateOnly(u)?u.toStorageFormat():u;switch(I){case "date":if(e.isDate(u))return u.getTime();if(e.isDateTime(u))return u.toMillis();if(e.isTimestampOffset(u))return u.toMilliseconds();if(e.isDateOnly(u))return u.toNumber();break;case "date-only":if(e.isDate(u))return A.DateOnly.fromDateJS(u).toString();if(e.isTimestampOffset(u))return A.DateOnly.fromSqlTimeStampOffset(u).toString();if(e.isDateTime(u))return A.DateOnly.fromDateTime(u).toString();
break;case "time-only":if(e.isDate(u))return J.TimeOnly.fromDateJS(u).toStorageString();if(e.isDateTime(u))return J.TimeOnly.fromDateTime(u).toStorageString();if(e.isTimestampOffset(u))return J.TimeOnly.fromSqlTimeStampOffset(u).toStorageString();if(e.isTimeOnly(u))return u.toStorageString();break;case "timestamp-offset":if(e.isDate(u))return z.SqlTimeStampOffset.fromJSDate(u).toStorageFormat();if(e.isDateTime(u))return z.SqlTimeStampOffset.fromDateTime(u).toStorageFormat();if(e.isTimestampOffset(u))return u.toStorageFormat()}return u}static create(u,
I,k="UTC"){return new Z(u,I,k)}get fieldNames(){return this._referencedFieldNames}testSet(u,I=U){return!!this._evaluateNode(this.parseTree,null,I,u)}calculateValue(u,I=U){u=this._evaluateNode(this.parseTree,u,I,null);return u instanceof v.SqlInterval?u.valueInMilliseconds()/864E5:u}calculateValueCompiled(u,I=U){if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(u,this.parameters,I,this.fieldsIndex,this.timeZone);if(x("esri-csp-restrictions"))return this.calculateValue(u,
I);this._compileMe();return this.parseTree._compiledVersion(u,this.parameters,I,this.fieldsIndex,this.timeZone)}testFeature(u,I=U){return!!this._evaluateNode(this.parseTree,u,I,null)}testFeatureCompiled(u,I=U){if(null!=this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(u,this.parameters,I,this.fieldsIndex,this.timeZone);if(x("esri-csp-restrictions"))return this.testFeature(u,I);this._compileMe();return!!this.parseTree._compiledVersion(u,this.parameters,I,this.fieldsIndex,this.timeZone)}get hasDateFunctions(){if(null!=
this._hasDateFunctions)return this._hasDateFunctions;this._hasDateFunctions=!1;this._visitAll(this.parseTree,u=>{"current-time"===u.type?this._hasDateFunctions=!0:"function"===u.type&&(this._hasDateFunctions=this._hasDateFunctions||P.has(u.name.toLowerCase()))});return this._hasDateFunctions}getFunctions(){const u=new Set;this._visitAll(this.parseTree,I=>{"function"===I.type&&u.add(I.name.toLowerCase())});return Array.from(u)}getExpressions(){const u=new Map;this._visitAll(this.parseTree,I=>{if("function"===
I.type){const k=I.name.toLowerCase();I=I.args.value[0];if("column-reference"===I.type){I=I.column;const h=`${k}-${I}`;u.has(h)||u.set(h,{aggregateType:k,field:I})}}});return[...u.values()]}getVariables(){const u=new Set;this._visitAll(this.parseTree,I=>{"parameter"===I.type&&u.add(I.value.toLowerCase())});return Array.from(u)}_compileMe(){const u="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter",
"fieldsIndex","timeZone",u)).bind(R)}_extractExpressionInfo(u){const I=[],k=new Set;let h=!0,w=!1;this._visitAll(this.parseTree,O=>{switch(O.type){case "column-reference":var M=u?.get(O.column);let T;M?M=T=M.name??"":(T=O.column,M=T.toLowerCase());k.has(M)||(k.add(M),I.push(T));O.column=T;break;case "function":const {name:Y,args:ea}=O;O=ea.value.length;h&&=E.isStandardized(Y,O);!1===w&&(w=G.isAggregate(Y,O))}});return{referencedFieldNames:Array.from(I),isStandardized:h,isAggregate:w}}_visitAll(u,
I){if(null!=u)switch(I(u),u.type){case "when-clause":this._visitAll(u.operand,I);this._visitAll(u.value,I);break;case "case-expression":for(const k of u.clauses)this._visitAll(k,I);"simple"===u.format&&this._visitAll(u.operand,I);null!==u.else&&this._visitAll(u.else,I);break;case "expression-list":for(const k of u.value)this._visitAll(k,I);break;case "unary-expression":this._visitAll(u.expr,I);break;case "binary-expression":this._visitAll(u.left,I);this._visitAll(u.right,I);break;case "function":this._visitAll(u.args,
I)}}evaluateNodeToJavaScript(u){switch(u.type){case "interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(u.value)+", "+JSON.stringify(u.qualifier)+","+JSON.stringify(u.op)+")";case "case-expression":var I="";if("simple"===u.format){var k=this.evaluateNodeToJavaScript(u.operand);I="( ";for(let h=0;h<u.clauses.length;h++)I+=" (this.compare('\x3d',"+k+","+this.evaluateNodeToJavaScript(u.clauses[h].operand)+") ? ("+this.evaluateNodeToJavaScript(u.clauses[h].value)+") : "}else for(I=
"( ",k=0;k<u.clauses.length;k++)I+=" this.makeBool("+this.evaluateNodeToJavaScript(u.clauses[k].operand)+")\x3d\x3d\x3dtrue ? ("+this.evaluateNodeToJavaScript(u.clauses[k].value)+") : ";I=null!==u.else?I+this.evaluateNodeToJavaScript(u.else):I+"null";return I+" )";case "parameter":return"this.lookup("+JSON.stringify(u.value.toLowerCase())+",lookups)";case "expression-list":I="[";for(k of u.value)"["!==I&&(I+=","),I+=this.evaluateNodeToJavaScript(k);return I+"]";case "unary-expression":return"this.ternaryNot("+
this.evaluateNodeToJavaScript(u.expr)+")";case "binary-expression":switch(u.operator){case "AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(u.left)+","+this.evaluateNodeToJavaScript(u.right)+" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(u.left)+","+this.evaluateNodeToJavaScript(u.right)+" )";case "IS":if("null"!==u.right.type)throw new y.SqlError(y.SqlErrorCodes.UnsupportedIsRhs);return"this.equalsNull("+this.evaluateNodeToJavaScript(u.left)+")";case "ISNOT":if("null"!==
u.right.type)throw new y.SqlError(y.SqlErrorCodes.UnsupportedIsRhs);return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(u.left)+")))";case "IN":return"this.applyIn("+this.evaluateNodeToJavaScript(u.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(u.right)+"), timeZone)";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(u.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(u.right)+"), timeZone))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(u.left)+
","+this.evaluateNodeToJavaScript(u.right)+", timeZone)";case "NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(u.left)+","+this.evaluateNodeToJavaScript(u.right)+", timeZone)";case "LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(u.left)+","+this.evaluateNodeToJavaScript(u.right)+","+JSON.stringify(u.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(u.left)+","+this.evaluateNodeToJavaScript(u.right)+","+JSON.stringify(u.escape)+
"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+JSON.stringify(u.operator)+","+this.evaluateNodeToJavaScript(u.left)+","+this.evaluateNodeToJavaScript(u.right)+", timeZone)";case "*":case "-":case "+":case "/":case "||":return"this.calculate("+JSON.stringify(u.operator)+","+this.evaluateNodeToJavaScript(u.left)+","+this.evaluateNodeToJavaScript(u.right)+", timeZone)"}throw new y.SqlError(y.SqlErrorCodes.UnsupportedOperator,{operator:u.operator});
case "null":case "boolean":case "string":case "number":return JSON.stringify(u.value);case "time":return"this.evaluateTime("+JSON.stringify(u.value)+")";case "date":return"this.evaluateDate("+JSON.stringify(u.value)+", 'unknown')";case "timestamp":return"this.evaluateTimestamp("+JSON.stringify(u.value)+", 'unknown')";case "current-time":return"date"===u.mode?"this.currentDate(timeZone)":"this.currentTimestamp(timeZone)";case "column-reference":return"this.featureValue(feature,"+JSON.stringify(u.column)+
",fieldsIndex,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(u.name)+","+this.evaluateNodeToJavaScript(u.args)+", timeZone)"}throw new y.SqlError(y.SqlErrorCodes.UnsupportedSyntax,{node:u.type});}_evaluateNode(u,I,k,h){switch(u.type){case "interval":return k=this._evaluateNode(u.value,I,k,h),v.SqlInterval.createFromValueAndQualifier(k,u.qualifier,u.op);case "case-expression":if("simple"===u.format){var w=this._evaluateNode(u.operand,I,k,h);for(var O=0;O<u.clauses.length;O++)if(p.sqlCompare(w,
this._evaluateNode(u.clauses[O].operand,I,k,h),"\x3d",this.timeZone))return this._evaluateNode(u.clauses[O].value,I,k,h)}else for(w=0;w<u.clauses.length;w++)if(!0===this._evaluateNode(u.clauses[w].operand,I,k,h))return this._evaluateNode(u.clauses[w].value,I,k,h);return null!==u.else?this._evaluateNode(u.else,I,k,h):null;case "parameter":return u=this.parameters[u.value.toLowerCase()],e.isDate(u)?q.DateTime.fromJSDate(u):u instanceof g.ArcadeDate?u.toDateTime():u;case "expression-list":w=[];for(var M of u.value)w.push(this._evaluateNode(M,
I,k,h));return w;case "unary-expression":return t(this._evaluateNode(u.expr,I,k,h));case "binary-expression":switch(u.operator){case "AND":return n(this._evaluateNode(u.left,I,k,h),this._evaluateNode(u.right,I,k,h));case "OR":return D(this._evaluateNode(u.left,I,k,h),this._evaluateNode(u.right,I,k,h));case "IS":if("null"!==u.right.type)throw new y.SqlError(y.SqlErrorCodes.UnsupportedIsRhs);return null===this._evaluateNode(u.left,I,k,h);case "ISNOT":if("null"!==u.right.type)throw new y.SqlError(y.SqlErrorCodes.UnsupportedIsRhs);
return null!==this._evaluateNode(u.left,I,k,h);case "IN":return w=b(this._evaluateNode(u.right,I,k,h)),Q(this._evaluateNode(u.left,I,k,h),w,this.timeZone);case "NOT IN":return w=b(this._evaluateNode(u.right,I,k,h)),t(Q(this._evaluateNode(u.left,I,k,h),w,this.timeZone));case "BETWEEN":return w=this._evaluateNode(u.left,I,k,h),u=this._evaluateNode(u.right,I,k,h),null==w||null==u[0]||null==u[1]?null:p.sqlCompare(w,u[0],"\x3e\x3d",this.timeZone)&&p.sqlCompare(w,u[1],"\x3c\x3d",this.timeZone);case "NOTBETWEEN":return w=
this._evaluateNode(u.left,I,k,h),u=this._evaluateNode(u.right,I,k,h),null==w||null==u[0]||null==u[1]?null:p.sqlCompare(w,u[0],"\x3c",this.timeZone)||p.sqlCompare(w,u[1],"\x3e",this.timeZone);case "LIKE":return a(this._evaluateNode(u.left,I,k,h),this._evaluateNode(u.right,I,k,h),u.escape);case "NOT LIKE":return t(a(this._evaluateNode(u.left,I,k,h),this._evaluateNode(u.right,I,k,h),u.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return p.sqlCompare(this._evaluateNode(u.left,
I,k,h),this._evaluateNode(u.right,I,k,h),u.operator,this.timeZone);case "-":case "+":case "*":case "/":case "||":return f.sqlCalculateFunction(u.operator,this._evaluateNode(u.left,I,k,h),this._evaluateNode(u.right,I,k,h),this.timeZone)}case "null":case "boolean":case "string":case "number":return u.value;case "date":return u.parsedValue??(u.parsedValue=e.parseDate(u.value,"unknown")),u.parsedValue;case "timestamp":return u.parsedValue??(u.parsedValue=e.parseTimestamp(u.value,"unknown")),u.parsedValue;
case "time":return e.parseTime(u.value);case "current-time":return"date"===u.mode?A.DateOnly.fromNow(this.timeZone):e.convertToExecutingTimeZone(new Date,this.timeZone);case "column-reference":return C(I,u.column,this.fieldsIndex,k);case "data-type":return u.value;case "function":if(this.isAggregate&&G.isAggregate(u.name,u.args.value.length)){I=[];for(w of u.args?.value||[]){M=[];for(O of h||[])M.push(this._evaluateNode(w,O,k,null));I.push(M)}return G.aggregateFunction(u.name,I)}k=this._evaluateNode(u.args,
I,k,h);return E.evaluateFunction(u.name,k,this.timeZone)}throw new y.SqlError(y.SqlErrorCodes.UnsupportedSyntax,{node:u.type});}}var W;(function(u){u[u.Normal=0]="Normal";u[u.Escaped=1]="Escaped"})(W||={});const U={getAttribute(u,I){return(u&&"object"===typeof u.attributes?u.attributes:u)[I]}};d.WhereClause=Z;d.defaultAttributeAdapter=U;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/ArcadeDate":function(){define(["exports","../core/string","../core/sql/UnknownTimeZone",
"../chunks/datetime"],function(d,g,y,x){function G(v,z,E){return v<z?v-z:v>E?v-E:0}function A(v,z=!0){if(v instanceof x.Zone)return v;if("system"===v.toLowerCase())return"system";if("utc"===v.toLowerCase())return"UTC";if("unknown"===v.toLowerCase())return y.UnknownTimeZone.instance;if(/^[+-]?[0-9]{1,2}([:][0-9]{2})?$/.test(v)){const E=x.FixedOffsetZone.parseSpecifier("UTC"+(v.startsWith("+")||v.startsWith("-")?"":"+")+v);if(E)return E}v=x.IANAZone.create(v);if(!v.isValid){if(z)throw new p(d.ArcadeDateErrorCodes.TimeZoneNotRecognized);
return null}return v}d.ArcadeDateErrorCodes=void 0;(d.ArcadeDateErrorCodes||(d.ArcadeDateErrorCodes={})).TimeZoneNotRecognized="TimeZoneNotRecognized";const f={[d.ArcadeDateErrorCodes.TimeZoneNotRecognized]:"Timezone identifier has not been recognized."};class p extends Error{constructor(v,z){super(g.replace(f[v],z));this.declaredRootClass="esri.arcade.arcadedate.dateerror";Error.captureStackTrace&&Error.captureStackTrace(this,p)}}class e{constructor(v){this._date=v;this.declaredRootClass="esri.arcade.arcadedate"}static fromParts(v=
0,z=1,E=1,J=0,r=0,q=0,b=0,t){if(isNaN(v)||isNaN(z)||isNaN(E)||isNaN(J)||isNaN(r)||isNaN(q)||isNaN(b))return null;const n=x.DateTime.local(v,z).daysInMonth;v=x.DateTime.fromObject({day:1>E?1:E>n?n:E,year:v,month:1>z?1:12<z?12:z,hour:0>J?0:23<J?23:J,minute:0>r?0:59<r?59:r,second:0>q?0:59<q?59:q,millisecond:0>b?0:999<b?999:b},{zone:A(t)});v=v.plus({months:G(z,1,12),days:G(E,1,n),hours:G(J,0,23),minutes:G(r,0,59),seconds:G(q,0,59),milliseconds:G(b,0,999)});return new e(v)}static get systemTimeZoneCanonicalName(){return Intl.DateTimeFormat().resolvedOptions().timeZone??
"system"}static arcadeDateAndZoneToArcadeDate(v,z){z=A(z);return v.isUnknownTimeZone||z===y.UnknownTimeZone.instance?e.fromParts(v.year,v.monthJS+1,v.day,v.hour,v.minute,v.second,v.millisecond,z):new e(v._date.setZone(z))}static dateJSToArcadeDate(v){return new e(x.DateTime.fromJSDate(v,{zone:"system"}))}static dateJSAndZoneToArcadeDate(v,z="system"){z=A(z);return new e(x.DateTime.fromJSDate(v,{zone:z}))}static unknownEpochToArcadeDate(v){return new e(x.DateTime.fromMillis(v,{zone:y.UnknownTimeZone.instance}))}static unknownDateJSToArcadeDate(v){return new e(x.DateTime.fromMillis(v.getTime(),
{zone:y.UnknownTimeZone.instance}))}static epochToArcadeDate(v,z="system"){z=A(z);return new e(x.DateTime.fromMillis(v,{zone:z}))}static dateTimeToArcadeDate(v){return new e(v)}clone(){return new e(this._date)}changeTimeZone(v){v=A(v);return e.dateTimeToArcadeDate(this._date.setZone(v))}static dateTimeAndZoneToArcadeDate(v,z){z=A(z);return v.zone===y.UnknownTimeZone.instance||z===y.UnknownTimeZone.instance?e.fromParts(v.year,v.month,v.day,v.hour,v.minute,v.second,v.millisecond,z):new e(v.setZone(z))}static nowToArcadeDate(v){v=
A(v);return new e(x.DateTime.fromJSDate(new Date,{zone:v}))}static nowUTCToArcadeDate(){return new e(x.DateTime.utc())}get isSystem(){return"system"===this.timeZone||this.timeZone===e.systemTimeZoneCanonicalName}equals(v){return this.isSystem&&v.isSystem?this.toNumber()===v.toNumber():this.isUnknownTimeZone!==v.isUnknownTimeZone?!1:this._date.equals(v._date)}get isUnknownTimeZone(){return this._date.zone===y.UnknownTimeZone.instance}get isValid(){return this._date.isValid}get hour(){return this._date.hour}get second(){return this._date.second}get day(){return this._date.day}get dayOfWeekISO(){return this._date.weekday}get dayOfWeekJS(){let v=
this._date.weekday;6<v&&(v=0);return v}get millisecond(){return this._date.millisecond}get monthISO(){return this._date.month}get weekISO(){return this._date.weekNumber}get yearISO(){return this._date.weekYear}get monthJS(){return this._date.month-1}get year(){return this._date.year}get minute(){return this._date.minute}get zone(){return this._date.zone}get timeZoneOffset(){return this.isUnknownTimeZone?0:this._date.offset}get timeZone(){if(this.isUnknownTimeZone)return"unknown";if("system"===this._date.zone.type)return"system";
const v=this.zone;return"fixed"===v.type?0===v.fixed?"UTC":v.formatOffset(0,"short"):v.name}stringify(){return JSON.stringify(this.toJSDate())}plus(v){return new e(this._date.plus(v))}diff(v,z="milliseconds"){return this._date.diff(v._date,z)[z]}toISODate(){return this._date.toISODate()}toISOString(v){return v?this._date.toISO({suppressMilliseconds:!0,includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})}toISOTime(v,z){return this._date.toISOTime({suppressMilliseconds:v,
includeOffset:z&&!this.isUnknownTimeZone})}toFormat(v,z){this.isUnknownTimeZone&&(v=v.replaceAll("Z",""));return this._date.toFormat(v,z)}toJSDate(){return this._date.toJSDate()}toSQLValue(){return this._date.toFormat("yyyy-LL-dd HH:mm:ss")}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}toDateTime(){return this._date}toNumber(){return this._date.toMillis()}getTime(){return this._date.toMillis()}toUTC(){return new e(this._date.toUTC())}toLocal(){return new e(this._date.toLocal())}toString(){return this.toISOString(!0)}static fromReaderAsTimeStampOffset(v){if(!v)return null;
v=x.DateTime.fromISO(v,{setZone:!0});return new e(v)}}d.ArcadeDate=e;d.ArcadeDateError=p;d.arcadeDateErrorMessages=f;d.createDateTimeZone=A;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/UnknownTimeZone":function(){define(["exports","../../chunks/datetime"],function(d,g){function y(G){return G instanceof g.Zone?G===x.instance?!0:!1:"unknown"===G?.toString().toLowerCase()?!0:!1}class x{}x.instance=new g.IANAZone("Etc/UTC");d.UnknownTimeZone=x;d.adoptTimeZone=function(G,
A){return g.DateTime.fromObject({day:G.day,year:G.year,month:G.month,hour:G.hour,minute:G.minute,second:G.second,millisecond:G.millisecond},{zone:A})};d.isUnknownTimeZone=y;d.substituteUnknownTimezone=function(G){return y(G)?x.instance:G};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/featureset/support/errorsupport":function(){define(["exports","../../../core/string"],function(d,g){d.SqlErrorCodes=void 0;(function(f){f.InvalidFunctionParameters="InvalidFunctionParameters";
f.InvalidValueForAggregateFunction="InvalidValueForAggregateFunction";f.UnsupportedSqlFunction="UnsupportedSqlFunction";f.UnsupportedOperator="UnsupportedOperator";f.UnsupportedSyntax="UnsupportedSyntax";f.UnsupportedIsRhs="UnsupportedIsRhs";f.UnsupportedIsLhs="UnsupportedIsLhs";f.InvalidDataType="InvalidDataType";f.CannotCastValue="CannotCastValue";f.FunctionNotRecognized="FunctionNotRecognized";f.InvalidTime="InvalidTime";f.InvalidParameterCount="InvalidParameterCount";f.InvalidTimeStamp="InvalidTimeStamp";
f.InvalidDate="InvalidDate";f.InvalidOperator="InvalidOperator";f.IllegalInterval="IllegalInterval";f.YearMonthIntervals="YearMonthIntervals";f.PrimarySecondaryQualifiers="PrimarySecondaryQualifiers";f.MissingStatisticParameters="MissingStatisticParameters"})(d.SqlErrorCodes||(d.SqlErrorCodes={}));const y={[d.SqlErrorCodes.InvalidValueForAggregateFunction]:"Invalid value used in aggregate function",[d.SqlErrorCodes.MissingStatisticParameters]:"Statistic does not have 1 or 0 Parameters",[d.SqlErrorCodes.InvalidFunctionParameters]:"Invalid parameters for call to {function}",
[d.SqlErrorCodes.UnsupportedIsLhs]:"Unsupported left hand expression in is statement",[d.SqlErrorCodes.UnsupportedIsRhs]:"Unsupported right hand expression in is statement",[d.SqlErrorCodes.UnsupportedOperator]:"Unsupported operator - {operator}",[d.SqlErrorCodes.UnsupportedSyntax]:"Unsupported syntax - {node}",[d.SqlErrorCodes.UnsupportedSqlFunction]:"Sql function not found \x3d {function}",[d.SqlErrorCodes.InvalidDataType]:"Invalid sql data type",[d.SqlErrorCodes.InvalidDate]:"Invalid date encountered",
[d.SqlErrorCodes.InvalidOperator]:"Invalid operator encountered",[d.SqlErrorCodes.InvalidTime]:"Invalid time encountered",[d.SqlErrorCodes.IllegalInterval]:"Illegal interval",[d.SqlErrorCodes.FunctionNotRecognized]:"Function not recognized",[d.SqlErrorCodes.InvalidTimeStamp]:"Invalid timestamp encountered",[d.SqlErrorCodes.InvalidParameterCount]:"Invalid parameter count for call to {name}",[d.SqlErrorCodes.PrimarySecondaryQualifiers]:"Primary and Secondary SqlInterval qualifiers not supported",[d.SqlErrorCodes.YearMonthIntervals]:"Year-Month Intervals not supported",
[d.SqlErrorCodes.CannotCastValue]:"Cannot cast value to the required data type"};class x extends Error{constructor(f,p){super(g.replace(y[f],p));this.declaredRootClass="esri.arcade.featureset.support.sqlerror";Error.captureStackTrace&&Error.captureStackTrace(this,x)}}d.FeatureSetErrorCodes=void 0;(function(f){f.NeverReach="NeverReach";f.NotImplemented="NotImplemented";f.Cancelled="Cancelled";f.InvalidStatResponse="InvalidStatResponse";f.InvalidRequest="InvalidRequest";f.RequestFailed="RequestFailed";
f.MissingFeatures="MissingFeatures";f.AggregationFieldNotFound="AggregationFieldNotFound";f.DataElementsNotFound="DataElementsNotFound"})(d.FeatureSetErrorCodes||(d.FeatureSetErrorCodes={}));const G={[d.FeatureSetErrorCodes.Cancelled]:"Cancelled",[d.FeatureSetErrorCodes.InvalidStatResponse]:"Invalid statistics response from service",[d.FeatureSetErrorCodes.InvalidRequest]:"Invalid request",[d.FeatureSetErrorCodes.RequestFailed]:"Request failed - {reason}",[d.FeatureSetErrorCodes.MissingFeatures]:"Missing features",
[d.FeatureSetErrorCodes.AggregationFieldNotFound]:"Aggregation field not found",[d.FeatureSetErrorCodes.DataElementsNotFound]:"Data elements not found on service",[d.FeatureSetErrorCodes.NeverReach]:"Encountered unreachable logic",[d.FeatureSetErrorCodes.NotImplemented]:"Not implemented"};class A extends Error{constructor(f,p){super(g.replace(G[f],p));this.declaredRootClass="esri.arcade.featureset.support.featureseterror";Error.captureStackTrace&&Error.captureStackTrace(this,A)}}d.FeatureSetError=
A;d.SqlError=x;d.featureSetErrorMessages=G;d.sqlErrorMessages=y;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/AggregateFunctions":function(){define("exports ../../arcade/featureset/support/errorsupport ./DateOnly ./SqlTimestampOffset ./TimeOnly ../../chunks/datetime".split(" "),function(d,g,y,x,G,A){function f(z){if(null===z)return null;let E=0,J=0;for(let r=0;r<z.length;r++){const q=z[r];if(null!==q){if("number"!==typeof q)throw new g.SqlError(g.SqlErrorCodes.InvalidValueForAggregateFunction);
J++;E+=q}}return 0===J?null:E/z.length}function p(z,E){if(null===z)return null;let J=null,r=null;for(const q of z)z=q,z=q instanceof y.DateOnly?q.toNumber():q instanceof G.TimeOnly?q.toNumber():q instanceof A.DateTime?q.toMillis():q instanceof x.SqlTimeStampOffset?q.toMilliseconds():q,null===J?(J=q,r=z):"max"===E&&null!==r&&null!==z&&r<=z?(J=q,r=z):"min"===E&&null!==r&&null!==z&&r>=z&&(J=q,r=z);return J}function e(z){if(null===z)return null;z=z.filter(r=>null!==r);if(0===z.length)return null;const E=
f(z);if(null===E)return null;let J=0;for(const r of z){if("number"!==typeof r)throw new g.SqlError(g.SqlErrorCodes.InvalidValueForAggregateFunction);J+=(E-r)**2}return J/(z.length-1)}const v={min:{minParams:1,maxParams:1,evaluate:z=>p(z[0],"min")},max:{minParams:1,maxParams:1,evaluate:z=>p(z[0],"max")},avg:{minParams:1,maxParams:1,evaluate:z=>f(z[0])},sum:{minParams:1,maxParams:1,evaluate:z=>{z=z[0];if(null===z)z=null;else{var E=0;for(let J=0;J<z.length;J++){const r=z[J];if(null!==r){if("number"!==
typeof r)throw new g.SqlError(g.SqlErrorCodes.InvalidValueForAggregateFunction);E+=r}}z=E}return z}},stddev:{minParams:1,maxParams:1,evaluate:z=>{z=z[0];null===z?z=null:(z=e(z),z=null===z?null:Math.sqrt(z));return z}},count:{minParams:1,maxParams:1,evaluate:z=>null==z[0]?null:z[0].length},var:{minParams:1,maxParams:1,evaluate:z=>e(z[0])}};d.aggregateFunction=function(z,E){const J=v[z.toLowerCase()];if(null==J)throw new g.SqlError(g.SqlErrorCodes.FunctionNotRecognized);if(E.length<J.minParams||E.length>
J.maxParams)throw new g.SqlError(g.SqlErrorCodes.InvalidParameterCount,{name:z.toUpperCase()});return J.evaluate(E)};d.isAggregate=function(z,E){z=v[z.toLowerCase()];return null!=z&&E>=z.minParams&&E<=z.maxParams};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/DateOnly":function(){define(["exports","../../arcade/ArcadeDate","../../intl/locale","../../chunks/datetime"],function(d,g,y,x){function G(f){f=f.replaceAll(/LTS|LT|L{1,4}|l{1,4}/g,"[$\x26]");let p="";const e=
/(\[[^[]*\])|(\\)?([Hh]mm(ss)?|Mo|M{1,4}|Do|DDDo|D{1,4}|d{2,4}|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;for(const v of f.match(e)||[])switch(v){case "D":p+="d";break;case "DD":p+="dd";break;case "DDD":p+="o";break;case "d":p+="c";break;case "ddd":p+="ccc";break;case "dddd":p+="cccc";break;case "M":p+="L";break;case "MM":p+="LL";break;case "MMM":p+="LLL";break;case "MMMM":p+="LLLL";break;case "YY":p+="yy";
break;case "Y":case "YYYY":p+="yyyy";break;case "Q":p+="q";break;case "X":case "x":p+=v;break;default:p=2<=v.length&&"["===v.slice(0,1)&&"]"===v.slice(-1)?p+`'${v.slice(1,-1)}'`:p+`'${v}'`}return p}class A{constructor(f,p,e){this._year=f;this._month=p;this._day=e;this.declaredRootClass="esri.core.sql.dateonly"}get month(){return this._month}get monthJS(){return this._month-1}get year(){return this._year}get day(){return this._day}get isValid(){return this.toDateTime("unknown").isValid}equals(f){return f instanceof
A&&f.day===this.day&&f.month===this.month&&f.year===this.year}clone(){return new A(this._year,this._month,this._day)}toDateTime(f){return x.DateTime.fromObject({day:this.day,month:this.month,year:this.year},{zone:g.createDateTimeZone(f)})}toDateTimeLuxon(f){return x.DateTime.fromObject({day:this.day,month:this.month,year:this.year},{zone:g.createDateTimeZone(f)})}toString(){return`${this.year.toString().padStart(4,"0")}-${this.month.toString().padStart(2,"0")}-${this.day.toString().padStart(2,"0")}`}toFormat(f=
null,p=!0){if(null===f||""===f)return this.toString();p&&(f=G(f));if(!f)return"";p=this.toDateTime("unknown");return g.ArcadeDate.dateTimeToArcadeDate(p).toFormat(f,{locale:y.getLocale(),numberingSystem:"latn"})}toArcadeDate(){const f=this.toDateTime("unknown");return g.ArcadeDate.dateTimeToArcadeDate(f)}toNumber(){return this.toDateTime("unknown").toMillis()}toJSDate(){return this.toDateTime("unknown").toJSDate()}toStorageFormat(){return this.toFormat("yyyy-LL-dd",!1)}toSQLValue(){return this.toFormat("yyyy-LL-dd",
!1)}toSQLWithKeyword(){return"date '"+this.toFormat("yyyy-LL-dd",!1)+"'"}plus(f,p){return A.fromDateTime(this.toUTCDateTime().plus({[f]:p}))}toUTCDateTime(){return x.DateTime.utc(this.year,this.month,this.day,0,0,0,0)}difference(f,p){switch(p.toLowerCase()){case "days":case "day":case "d":return this.toUTCDateTime().diff(f.toUTCDateTime(),"days").days;case "months":case "month":return this.toUTCDateTime().diff(f.toUTCDateTime(),"months").months;case "minutes":case "minute":case "m":return"M"===p?
this.toUTCDateTime().diff(f.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(f.toUTCDateTime(),"minutes").minutes;case "seconds":case "second":case "s":return this.toUTCDateTime().diff(f.toUTCDateTime(),"seconds").seconds;case "milliseconds":case "millisecond":case "ms":return this.toUTCDateTime().diff(f.toUTCDateTime(),"milliseconds").milliseconds;case "hours":case "hour":case "h":return this.toUTCDateTime().diff(f.toUTCDateTime(),"hours").hours;case "years":case "year":case "y":return this.toUTCDateTime().diff(f.toUTCDateTime(),
"years").years;default:return this.toUTCDateTime().diff(f.toUTCDateTime(),"milliseconds").milliseconds}}static fromMilliseconds(f){f=x.DateTime.fromMillis(f,{zone:x.FixedOffsetZone.utcInstance});return f.isValid?A.fromParts(f.year,f.month,f.day):null}static fromSeconds(f){f=x.DateTime.fromSeconds(f,{zone:x.FixedOffsetZone.utcInstance});return f.isValid?A.fromParts(f.year,f.month,f.day):null}static fromReader(f){if(!f)return null;f=f.split("-");return 3!==f.length?null:new A(parseInt(f[0],10),parseInt(f[1],
10),parseInt(f[2],10))}static fromParts(f,p,e){f=new A(f,p,e);return!1===f.isValid?null:f}static fromDateJS(f){return A.fromParts(f.getFullYear(),f.getMonth()+1,f.getDay())}static fromDateTime(f){return A.fromParts(f.year,f.month,f.day)}static fromSqlTimeStampOffset(f){return this.fromDateTime(f.toDateTime())}static fromString(f,p=null){if(""===f||null===f)return null;var e=[];if(p)(p=G(p))&&e.push(p);else if(null===p||""===p)return f=x.DateTime.fromISO(f,{setZone:!0}),f.isValid?A.fromParts(f.year,
f.month,f.day):null;for(const v of e)if(e=x.DateTime.fromFormat(f,p??v),e.isValid)return new A(e.year,e.month,e.day);return null}static fromNow(f="system"){f=x.DateTime.fromJSDate(new Date).setZone(g.createDateTimeZone(f));return new A(f.year,f.month,f.day)}}d.DateOnly=A;d.standardizeDateOnlyFormat=G;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/SqlTimestampOffset":function(){define(["exports","../../chunks/datetime"],function(d,g){function y(G){return Number.isNaN(G)||
0===G?G:Math.trunc(G)}class x{constructor(G){this._timeStampOffset=G;this._date=null}toDateTime(){this._date??(this._date=g.DateTime.fromISO(this._timeStampOffset,{setZone:!0}));return this._date}get isValid(){return this.toDateTime().isValid}get timezoneOffsetHour(){return y(this.toDateTime().offset/60)}get timezoneOffsetMinutes(){return y(this.toDateTime().offset%60)}toMilliseconds(){return this.toDateTime().toMillis()}get hour(){return this.toDateTime().hour}get minute(){return this.toDateTime().minute}get second(){return this.toDateTime().second}get day(){return this.toDateTime().day}get month(){return this.toDateTime().month}get year(){return this.toDateTime().year}startOfDay(){return x.fromDateTime(this.toDateTime().startOf("day"))}static fromJSDate(G){return new x(g.DateTime.fromJSDate(G).toISO({includeOffset:!0}))}static fromDateTime(G){return new x(G.toISO({includeOffset:!0}))}static fromParts(G,
A,f=0,p=0,e=0,v=0,z=0,E=!1,J=0,r=0){G=`${G.toString().padStart(4,"0")}-${A.toString().padStart(2,"0")}-${f.toString().padStart(2,"0")}`;A="";10>v&&(A="0");p=`${p.toString().padStart(2,"0")}:${e.toString().padStart(2,"0")}:${A+v.toString()}`;0!==z&&(p+="."+z.toString().padStart(3,"0"));z=`${E?"-":"+"}${J.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`;return new x(G+"T"+p+z)}toStorageFormat(){return this._timeStampOffset}toString(){return this._timeStampOffset}toSQLValue(){let G=this.toDateTime().toSQL({includeOffset:!0,
includeOffsetSpace:!0});G&&=G.replace(".000","");return G}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}addMilliseconds(G){G=this.toDateTime().plus(G);return x.fromDateTime(G)}}d.SqlTimeStampOffset=x;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/TimeOnly":function(){define(["exports","../../arcade/kernel","../../intl/locale","../../chunks/datetime"],function(d,g,y,x){function G(f){if(!f)return"";const p=/(a|A|hh?|HH?|mm?|ss?|SSS|S|.)/g;let e="";for(const v of f.match(p)||
[])switch(v){case "SSS":e+=v;break;case "A":case "a":e+="a";break;case "m":case "mm":case "h":case "hh":case "H":case "HH":case "s":case "ss":e+=v;break;default:e+=`'${v}'`}return e}class A{constructor(f,p,e,v){this._hour=f;this._minute=p;this._second=e;this._millisecond=v;this.declaredRootClass="esri.core.sql.timeonly"}get hour(){return this._hour}get minute(){return this._minute}get second(){return this._second}get millisecond(){return this._millisecond}equals(f){return f instanceof A&&f.hour===
this.hour&&f.minute===this.minute&&f.second===this.second&&f.millisecond===this.millisecond}clone(){return new A(this.hour,this.minute,this.second,this.millisecond)}isValid(){return g.isInteger(this.hour)&&g.isInteger(this.minute)&&g.isInteger(this.second)&&g.isInteger(this.millisecond)&&0<=this.hour&&24>this.hour&&0<=this.minute&&60>this.minute&&0<=this.second&&60>this.second&&0<=this.millisecond&&1E3>this.millisecond}toString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,
"0")}:${this.second.toString().padStart(2,"0")}`+(0<this.millisecond?"."+this.millisecond.toString().padStart(3,"0"):"")}toSQLValue(){return this.toString()}toSQLWithKeyword(){return`time '${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}${0<this.millisecond?"."+this.millisecond.toString().padStart(3,"0"):""}'`}toStorageString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,
"0")}`}toFormat(f=null){return null===f||""===f?this.toString():(f=G(f))?x.DateTime.local(1970,1,1,this._hour,this._minute,this._second,this._millisecond).toFormat(f,{locale:y.getLocale(),numberingSystem:"latn"}):""}toNumber(){return this.millisecond+1E3*this.second+6E4*this.minute+36E5*this.hour}static fromParts(f,p,e,v){f=new A(f,p,e,v);return f.isValid()?f:null}static fromReader(f){if(!f)return null;f=f.split(":");return 3!==f.length?null:new A(parseInt(f[0],10),parseInt(f[1],10),parseInt(f[2],
10),0)}static fromMilliseconds(f){return 864E5<f||0>f?null:new A(Math.floor(f/36E5%24),Math.floor(f/6E4%60),Math.floor(f/1E3%60),Math.floor(f%1E3))}static fromDateJS(f){return new A(f.getHours(),f.getMinutes(),f.getSeconds(),f.getMilliseconds())}static fromDateTime(f){return new A(f.hour,f.minute,f.second,f.millisecond)}static fromSqlTimeStampOffset(f){return this.fromDateTime(f.toDateTime())}static fromString(f,p=null){if(""===f||null===f)return null;const e=[];if(p)(p=G(p))&&e.push(p);else if(null===
p||""===p)e.push("HH:mm:ss"),e.push("HH:mm:ss.SSS"),e.push("hh:mm:ss a"),e.push("hh:mm:ss.SSS a"),e.push("HH:mm"),e.push("hh:mm a"),e.push("H:mm"),e.push("h:mm a"),e.push("H:mm:ss"),e.push("h:mm:ss a"),e.push("H:mm:ss.SSS"),e.push("h:mm:ss.SSS a");for(const v of e)if(p=x.DateTime.fromFormat(f,v),p.isValid)return new A(p.hour,p.minute,p.second,p.millisecond);return null}plus(f,p){switch(f){case "days":case "years":case "months":return this.clone();case "hours":case "minutes":case "seconds":case "milliseconds":return A.fromDateTime(this.toUTCDateTime().plus({[f]:p}))}return null}toUTCDateTime(){return x.DateTime.utc(1970,
1,1,this.hour,this.minute,this.second,this.millisecond)}difference(f,p){switch(p.toLowerCase()){case "days":case "day":case "d":return this.toUTCDateTime().diff(f.toUTCDateTime(),"days").days;case "months":case "month":return this.toUTCDateTime().diff(f.toUTCDateTime(),"months").months;case "minutes":case "minute":case "m":return"M"===p?this.toUTCDateTime().diff(f.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(f.toUTCDateTime(),"minutes").minutes;case "seconds":case "second":case "s":return this.toUTCDateTime().diff(f.toUTCDateTime(),
"seconds").seconds;case "milliseconds":case "millisecond":case "ms":return this.toUTCDateTime().diff(f.toUTCDateTime(),"milliseconds").milliseconds;case "hours":case "hour":case "h":return this.toUTCDateTime().diff(f.toUTCDateTime(),"hours").hours;case "years":case "year":case "y":return this.toUTCDateTime().diff(f.toUTCDateTime(),"years").years;default:return this.toUTCDateTime().diff(f.toUTCDateTime(),"milliseconds").milliseconds}}}d.TimeOnly=A;d.standardizeTimeFormat=G;Object.defineProperty(d,
Symbol.toStringTag,{value:"Module"})})},"esri/arcade/kernel":function(){define(["exports","../geometry/Extent"],function(d,g){d.cloneGeometry=function(y){if(null==y)return null;const x=y.clone();void 0!==y.cache._geVersion&&(x.cache._geVersion=y.cache._geVersion);return x};d.convertLinearUnitsToCode=function(y){if(null==y)return null;if("number"===typeof y)return y;y=y.toLowerCase();y=y.replaceAll(/\s/g,"");y=y.replaceAll("-","");switch(y){case "meters":case "meter":case "m":case "squaremeters":case "squaremeter":return 9001;
case "miles":case "mile":case "squaremile":case "squaremiles":return 9093;case "kilometers":case "kilometer":case "squarekilometers":case "squarekilometer":case "km":return 9036;case "yard":case "yd":case "yards":case "squareyards":case "squareyard":return 9096;case "feet":case "ft":case "foot":case "squarefeet":case "squarefoot":return 9002;case "nmi":case "nauticalmile":case "nauticalmiles":case "squarenauticalmile":case "squarenauticalmiles":return 9030}return null};d.convertSquareUnitsToCode=
function(y){if(null==y)return null;if("number"===typeof y)return y;y=y.toLowerCase();y=y.replaceAll(/\s/g,"");y=y.replaceAll("-","");switch(y){case "meters":case "meter":case "m":case "squaremeters":case "squaremeter":return 109404;case "miles":case "mile":case "squaremile":case "squaremiles":return 109439;case "kilometers":case "kilometer":case "squarekilometers":case "squarekilometer":case "km":return 109414;case "acres":case "acre":case "ac":return 109402;case "hectares":case "hectare":case "ha":return 109401;
case "yard":case "yd":case "yards":case "squareyards":case "squareyard":return 109442;case "feet":case "ft":case "foot":case "squarefeet":case "squarefoot":return 109405;case "nmi":case "nauticalmile":case "nauticalmiles":case "squarenauticalmile":case "squarenauticalmiles":return 109409}return null};d.isInteger=function(y){return"number"===typeof y&&isFinite(y)&&Math.floor(y)===y};d.sameGeomType=function(y,x){return y===x||"point"===y&&"esriGeometryPoint"===x||"polyline"===y&&"esriGeometryPolyline"===
x||"polygon"===y&&"esriGeometryPolygon"===x||"extent"===y&&"esriGeometryEnvelope"===x||"multipoint"===y&&"esriGeometryMultipoint"===x||"point"===x&&"esriGeometryPoint"===y||"polyline"===x&&"esriGeometryPolyline"===y||"polygon"===x&&"esriGeometryPolygon"===y||"extent"===x&&"esriGeometryEnvelope"===y||"multipoint"===x&&"esriGeometryMultipoint"===y?!0:!1};d.shapeExtent=function(y){if(null==y)return null;switch(y.type){case "polygon":case "multipoint":case "polyline":return y.extent;case "point":return new g({xmin:y.x,
ymin:y.y,xmax:y.x,ymax:y.y,spatialReference:y.spatialReference});case "extent":return y}return null};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/sqlArithmeticUtils":function(){define(["exports","../../arcade/featureset/support/errorsupport","./sqlDateParsingUtils","./SqlInterval","./StandardizedFunctions"],function(d,g,y,x,G){function A(B,K,L){switch(L){case "+":return B+K;case "-":return B-K;case "*":return B*K;case "/":return B/K}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);
}function f(B,K,L){switch(L){case "+":return K.plus({milliseconds:B.valueInMilliseconds()});case "-":return B.valueInMilliseconds()-K.toMillis()}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function p(B,K,L){switch(L){case "+":return K.plus("milliseconds",B.valueInMilliseconds())}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function e(B,K,L){switch(L){case "+":return K.plus("milliseconds",B.valueInMilliseconds())}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function v(B,
K,L){switch(L){case "+":return B.plus("milliseconds",K.valueInMilliseconds());case "-":return B.plus("milliseconds",-1*K.valueInMilliseconds())}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function z(B,K,L){switch(L){case "+":return K.addMilliseconds(B.valueInMilliseconds())}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function E(B,K,L){switch(L){case "+":return x.SqlInterval.createFromMilliseconds(B.valueInMilliseconds()+K.valueInMilliseconds());case "-":return x.SqlInterval.createFromMilliseconds(B.valueInMilliseconds()-
K.valueInMilliseconds());case "*":return x.SqlInterval.createFromMilliseconds(B.valueInMilliseconds()*K.valueInMilliseconds());case "/":return x.SqlInterval.createFromMilliseconds(B.valueInMilliseconds()/K.valueInMilliseconds())}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function J(B,K,L){switch(L){case "+":return x.SqlInterval.createFromMilliseconds(B.valueInMilliseconds()+K);case "-":return x.SqlInterval.createFromMilliseconds(B.valueInMilliseconds()-K);case "*":return x.SqlInterval.createFromMilliseconds(B.valueInMilliseconds()*
K);case "/":return x.SqlInterval.createFromMilliseconds(B.valueInMilliseconds()/K)}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function r(B,K,L){switch(L){case "+":return x.SqlInterval.createFromMilliseconds(B+K.valueInMilliseconds());case "-":return x.SqlInterval.createFromMilliseconds(B-K.valueInMilliseconds());case "*":return x.SqlInterval.createFromMilliseconds(B*K.valueInMilliseconds());case "/":return x.SqlInterval.createFromMilliseconds(B/K.valueInMilliseconds())}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);
}function q(B,K,L){switch(L){case "+":return B.plus("milliseconds",K.valueInMilliseconds());case "-":return B.plus("milliseconds",-1*K.valueInMilliseconds())}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function b(B,K,L){switch(L){case "+":return B.plus({milliseconds:K.valueInMilliseconds()});case "-":return B.minus({milliseconds:K.valueInMilliseconds()})}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function t(B,K,L){switch(L){case "+":return B.addMilliseconds(K.valueInMilliseconds());
case "-":return B.addMilliseconds(-1*K.valueInMilliseconds())}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function n(B,K,L){K*=864E5;switch(L){case "+":return B.plus({milliseconds:K});case "-":return B.minus({milliseconds:K})}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function D(B,K,L){K*=864E5;switch(L){case "+":return B.plus("milliseconds",K);case "-":return B.plus("milliseconds",-1*K)}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function Q(B,K,L){K*=864E5;switch(L){case "+":return B.plus("milliseconds",
K);case "-":return B.plus("milliseconds",-1*K)}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function a(B,K,L){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function C(B,K,L){K*=864E5;switch(L){case "+":return B.addMilliseconds(K);case "-":return B.addMilliseconds(-1*K)}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function P(B,K,L){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function R(B,K,L){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function Z(B,
K,L){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function W(B,K,L){K=parseFloat(K);if(isNaN(K))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);return A(B,K,L)}function U(B,K,L){B=parseFloat(B);if(isNaN(B))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);return A(B,K,L)}function u(B,K,L){switch(L){case "+":return B+K}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function I(B,K,L){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function k(B,K,L){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);
}function h(B,K,L){switch(L){case "-":return B.toDateTimeLuxon(K.zone).diff(K).as("days")}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function w(B,K,L){switch(L){case "-":return B.toDateTimeLuxon(K.toDateTime().zone).diff(K.toDateTime()).as("days")}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function O(B,K,L){switch(L){case "-":return B.toDateTimeLuxon("UTC").diff(K.toDateTimeLuxon("UTC")).as("days")}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function M(B,K,L){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);
}function T(B,K,L){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function Y(B,K,L){switch(L){case "-":return B.toDateTime().diff(K.toDateTimeLuxon(B.toDateTime().zone)).as("days")}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function ea(B,K,L){switch(L){case "-":return B.toDateTime().diff(K).as("days")}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function ia(B,K,L){switch(L){case "-":return B.toDateTime().diff(K.toDateTime()).as("days")}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);
}function na(B,K,L){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function qa(B,K,L){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function va(B,K,L){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function ta(B,K,L){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function wa(B,K,L){switch(L){case "-":return B.diff(K).as("days")}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function Ea(B,K,L){switch(L){case "-":return B.diff(K.toDateTimeLuxon(B.zone)).as("days")}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);
}function Da(B,K,L){switch(L){case "-":return B.diff(K.toDateTime()).as("days")}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function Pa(B,K,L){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function Sa(B,K,L){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function Ta(B,K,L){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function Oa(B,K,L){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function l(B,K,L){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);
}function F(B,K,L){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function X(B,K,L){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function ba(B,K,L){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function ja(B,K,L){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}d.calculateDateOnlyAndDateOnly=O;d.calculateDateOnlyAndDateTime=h;d.calculateDateOnlyAndNumber=D;d.calculateDateOnlyAndSqlInterval=q;d.calculateDateOnlyAndString=Sa;d.calculateDateOnlyAndTimeOnly=M;d.calculateDateOnlyAndTimestamp=
w;d.calculateDateTimeAndDateOnly=Ea;d.calculateDateTimeAndDateTime=wa;d.calculateDateTimeAndNumber=n;d.calculateDateTimeAndSqlInterval=b;d.calculateDateTimeAndString=Oa;d.calculateDateTimeAndTimeOnly=Pa;d.calculateDateTimeAndTimestamp=Da;d.calculateNumberAndDateOnly=Z;d.calculateNumberAndDateTime=a;d.calculateNumberAndNumber=A;d.calculateNumberAndSqlInterval=r;d.calculateNumberAndString=W;d.calculateNumberAndTimeOnly=R;d.calculateNumberAndTimestamp=P;d.calculateSqlIntervalAndDateOnly=e;d.calculateSqlIntervalAndDateTime=
f;d.calculateSqlIntervalAndNumber=J;d.calculateSqlIntervalAndSqlInterval=E;d.calculateSqlIntervalAndString=I;d.calculateSqlIntervalAndTimeOnly=p;d.calculateSqlIntervalAndTimestamp=z;d.calculateStringAndDateOnly=X;d.calculateStringAndDateTime=ba;d.calculateStringAndNumber=U;d.calculateStringAndSqlInterval=k;d.calculateStringAndString=u;d.calculateStringAndTimeOnly=F;d.calculateStringAndTimestamp=ja;d.calculateTimeOnlyAndDateOnly=qa;d.calculateTimeOnlyAndDateTime=na;d.calculateTimeOnlyAndNumber=Q;d.calculateTimeOnlyAndSqlInterval=
v;d.calculateTimeOnlyAndString=Ta;d.calculateTimeOnlyAndTimeOnly=ta;d.calculateTimeOnlyAndTimestamp=va;d.calculateTimestampAndDateOnly=Y;d.calculateTimestampAndDateTime=ea;d.calculateTimestampAndNumber=C;d.calculateTimestampAndSqlInterval=t;d.calculateTimestampAndString=l;d.calculateTimestampAndTimeOnly=T;d.calculateTimestampAndTimestamp=ia;d.sqlCalculateFunction=function(B,K,L,V){if("||"===B)return G.evaluateFunction("concat",[K,L],V);if(null===K||null===L)return null;if(y.isNumber(K)){if(y.isNumber(L))return A(K,
L,B);if(y.isSqlInterval(L))return r(K,L,B);if(y.isTimeOnly(L))return R();if(y.isDateOnly(L))return Z();if(y.isTimestampOffset(L))return P();if(y.isDateTime(L))return a();if(y.isString(L))return W(K,L,B)}else if(y.isDateOnly(K)){if(y.isNumber(L))return D(K,L,B);if(y.isSqlInterval(L))return q(K,L,B);if(y.isTimeOnly(L))return M();if(y.isDateOnly(L))return O(K,L,B);if(y.isTimestampOffset(L))return w(K,L,B);if(y.isDateTime(L))return h(K,L,B);if(y.isString(L))return Sa()}else if(y.isTimeOnly(K)){if(y.isNumber(L))return Q(K,
L,B);if(y.isSqlInterval(L))return v(K,L,B);if(y.isTimeOnly(L))return ta();if(y.isDateOnly(L))return qa();if(y.isTimestampOffset(L))return va();if(y.isDateTime(L))return na();if(y.isString(L))return Ta()}else if(y.isSqlInterval(K)){if(y.isNumber(L))return J(K,L,B);if(y.isSqlInterval(L))return E(K,L,B);if(y.isTimeOnly(L))return p(K,L,B);if(y.isDateOnly(L))return e(K,L,B);if(y.isTimestampOffset(L))return z(K,L,B);if(y.isDateTime(L))return f(K,L,B);if(y.isString(L))return I()}else if(y.isDateTime(K)){if(y.isNumber(L))return n(K,
L,B);if(y.isSqlInterval(L))return b(K,L,B);if(y.isTimeOnly(L))return Pa();if(y.isDateOnly(L))return Ea(K,L,B);if(y.isTimestampOffset(L))return Da(K,L,B);if(y.isDateTime(L))return wa(K,L,B);if(y.isString(L))return Oa()}else if(y.isTimestampOffset(K)){if(y.isNumber(L))return C(K,L,B);if(y.isSqlInterval(L))return t(K,L,B);if(y.isTimeOnly(L))return T();if(y.isDateOnly(L))return Y(K,L,B);if(y.isTimestampOffset(L))return ia(K,L,B);if(y.isDateTime(L))return ea(K,L,B);if(y.isString(L))return l()}else if(y.isString(K)){if(y.isNumber(L))return U(K,
L,B);if(y.isSqlInterval(L))return k();if(y.isTimeOnly(L))return F();if(y.isDateOnly(L))return X();if(y.isTimestampOffset(L))return ja();if(y.isDateTime(L))return ba();if(y.isString(L))return u(K,L,B)}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/sqlDateParsingUtils":function(){define("exports ../../arcade/featureset/support/errorsupport ./DateOnly ./SqlInterval ./SqlTimestampOffset ./TimeOnly ./UnknownTimeZone ../../chunks/datetime".split(" "),
function(d,g,y,x,G,A,f,p){function e(n,D,Q){Q=r.exec(n);if(null!==Q){const [,a,C,P,R,Z,W,U]=Q;n=p.DateTime.fromObject({year:parseInt(a,10),month:parseInt(C,10),day:parseInt(P,10),hour:parseInt(R,10),minute:parseInt(Z,10),second:parseInt(W,10),millisecond:U?parseInt(U.replace(".",""),10):0},{zone:f.substituteUnknownTimezone(D)});if(!1===n.isValid)throw new g.SqlError(g.SqlErrorCodes.InvalidTimeStamp);return n}Q=q.exec(n);if(null!==Q){const [,a,C,P,R,Z,W,U,u,I,k]=Q;n=G.SqlTimeStampOffset.fromParts(parseInt(a,
10),parseInt(C,10),parseInt(P,10),parseInt(R,10),parseInt(Z,10),parseInt(W,10),U?parseInt(U.replace(".",""),10):0,"-"===u,parseInt(I,10),parseInt(k,10));if(!1===n.isValid)throw new g.SqlError(g.SqlErrorCodes.InvalidTimeStamp);return n}Q=b.exec(n);if(null!==Q){const [,a,C,P,R,Z,W,U,u]=Q;n=G.SqlTimeStampOffset.fromParts(parseInt(a,10),parseInt(C,10),parseInt(P,10),parseInt(R,10),parseInt(Z,10),0,0,"-"===W,parseInt(U,10),parseInt(u,10));if(!1===n.isValid)throw new g.SqlError(g.SqlErrorCodes.InvalidTimeStamp);
return n}Q=t.exec(n);if(null!==Q){const [,a,C,P,R,Z]=Q;n=p.DateTime.fromObject({year:parseInt(a,10),month:parseInt(C,10),day:parseInt(P,10),hour:parseInt(R,10),minute:parseInt(Z,10),second:0},{zone:f.substituteUnknownTimezone(D)});if(!1===n.isValid)throw new g.SqlError(g.SqlErrorCodes.InvalidTimeStamp);return n}Q=J.exec(n);if(null!==Q){const [,a,C,P]=Q;n=p.DateTime.fromObject({year:parseInt(a,10),month:parseInt(C,10),day:parseInt(P,10),hour:0,minute:0,second:0},{zone:f.substituteUnknownTimezone(D)});
if(!1===n.isValid)throw new g.SqlError(g.SqlErrorCodes.InvalidTimeStamp);return n}throw new g.SqlError(g.SqlErrorCodes.InvalidTimeStamp);}const v=/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/,z=/^(\d{1,2}):(\d{1,2})$/,E=/^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/,J=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,r=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$/,q=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,b=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,
t=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/;d.convertToExecutingTimeZone=function(n,D){if(D instanceof p.Zone)return D===f.UnknownTimeZone.instance?p.DateTime.fromMillis(n.getTime(),{zone:f.UnknownTimeZone.instance}):p.DateTime.fromJSDate(n,{zone:D});switch(D){case "system":case "local":case null:return p.DateTime.fromJSDate(n);default:return"unknown"===D?.toLowerCase()?p.DateTime.fromMillis(n.getTime(),{zone:f.UnknownTimeZone.instance}):p.DateTime.fromJSDate(n,{zone:D})}};d.isDate=function(n){return n instanceof
Date};d.isDateOnly=function(n){return n instanceof y.DateOnly};d.isDateTime=function(n){return n instanceof p.DateTime};d.isNumber=function(n){return"number"===typeof n};d.isSqlInterval=function(n){return n instanceof x.SqlInterval};d.isString=function(n){return"string"===typeof n||n instanceof String};d.isTimeOnly=function(n){return n instanceof A.TimeOnly};d.isTimestampOffset=function(n){return n instanceof G.SqlTimeStampOffset};d.parseDate=function(n,D){const Q=J.exec(n);if(null===Q)try{return e(n,
D)}catch{throw new g.SqlError(g.SqlErrorCodes.InvalidDate);}const [,a,C,P]=Q;n=y.DateOnly.fromParts(parseInt(a,10),parseInt(C,10),parseInt(P,10));if(null===n)throw new g.SqlError(g.SqlErrorCodes.InvalidDate);return n};d.parseTime=function(n){let D=v.exec(n);if(null!==D){const [,Q,a,C]=D;n=A.TimeOnly.fromParts(parseInt(Q,10),parseInt(a,10),parseInt(C,10),0);if(null!==n)return n;throw new g.SqlError(g.SqlErrorCodes.InvalidTime);}D=z.exec(n);if(null!==D){const [,Q,a]=D;n=A.TimeOnly.fromParts(parseInt(Q,
10),parseInt(a,10),0,0);if(null!==n)return n;throw new g.SqlError(g.SqlErrorCodes.InvalidTime);}D=E.exec(n);if(null!==D){const [,Q,a,C,P]=D;n=A.TimeOnly.fromParts(parseInt(Q,10),parseInt(a,10),parseInt(C,10),parseInt(P,10));if(null!==n)return n}throw new g.SqlError(g.SqlErrorCodes.InvalidTime);};d.parseTimestamp=e;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/SqlInterval":function(){define(["exports","../../arcade/featureset/support/errorsupport"],function(d,g){class y{constructor(){this.op=
"+";this.millis=this.minute=this.year=this.month=this.hour=this.second=this.day=0}static _fixDefaults(x){if(null!==x.precision||null!==x.secondary)throw new g.SqlError(g.SqlErrorCodes.PrimarySecondaryQualifiers);}static _parseSecondsComponent(x,G){G.includes(".")?(G=G.split("."),x.second=parseFloat(G[0]),x.millis=parseInt(G[1],10)):x.second=parseFloat(G)}static createFromMilliseconds(x){const G=new y;G.second=x/1E3;return G}static createFromValueAndQualifier(x,G,A){let f=null;const p=new y;p.op="-"===
A?"-":"+";if("interval-period"===G.type){y._fixDefaults(G);A=RegExp("^[0-9]{1,}$");if("year"===G.period||"month"===G.period)throw new g.SqlError(g.SqlErrorCodes.YearMonthIntervals);if("second"===G.period)if(/^[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/.test(x))y._parseSecondsComponent(p,x);else throw new g.SqlError(g.SqlErrorCodes.IllegalInterval);else if(A.test(x))p[G.period]=parseFloat(x);else throw new g.SqlError(g.SqlErrorCodes.IllegalInterval);}else{y._fixDefaults(G.start);y._fixDefaults(G.end);if("year"===
G.start.period||"month"===G.start.period||"year"===G.end.period||"month"===G.end.period)throw new g.SqlError(g.SqlErrorCodes.YearMonthIntervals);switch(G.start.period){case "day":switch(G.end.period){case "hour":f=RegExp("^[0-9]{1,} [0-9]{1,}$");if(f.test(x))p[G.start.period]=parseFloat(x.split(" ")[0]),p[G.end.period]=parseFloat(x.split(" ")[1]);else throw new g.SqlError(g.SqlErrorCodes.IllegalInterval);break;case "minute":f=RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$");if(f.test(x))p[G.start.period]=
parseFloat(x.split(" ")[0]),x=x.split(" ")[1].split(":"),p.hour=parseFloat(x[0]),p.minute=parseFloat(x[1]);else throw new g.SqlError(g.SqlErrorCodes.IllegalInterval);break;case "second":f=RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(f.test(x))p[G.start.period]=parseFloat(x.split(" ")[0]),x=x.split(" ")[1].split(":"),p.hour=parseFloat(x[0]),p.minute=parseFloat(x[1]),y._parseSecondsComponent(p,x[2]);else throw new g.SqlError(g.SqlErrorCodes.IllegalInterval);break;default:throw new g.SqlError(g.SqlErrorCodes.IllegalInterval);
}break;case "hour":switch(G.end.period){case "minute":f=RegExp("^[0-9]{1,}:[0-9]{1,}$");if(f.test(x))p.hour=parseFloat(x.split(":")[0]),p.minute=parseFloat(x.split(":")[1]);else throw new g.SqlError(g.SqlErrorCodes.IllegalInterval);break;case "second":f=RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(f.test(x))x=x.split(":"),p.hour=parseFloat(x[0]),p.minute=parseFloat(x[1]),y._parseSecondsComponent(p,x[2]);else throw new g.SqlError(g.SqlErrorCodes.IllegalInterval);break;default:throw new g.SqlError(g.SqlErrorCodes.IllegalInterval);
}break;case "minute":switch(G.end.period){case "second":f=RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(f.test(x))x=x.split(":"),p.minute=parseFloat(x[0]),y._parseSecondsComponent(p,x[1]);else throw new g.SqlError(g.SqlErrorCodes.IllegalInterval);break;default:throw new g.SqlError(g.SqlErrorCodes.IllegalInterval);}break;default:throw new g.SqlError(g.SqlErrorCodes.IllegalInterval);}}return p}valueInMilliseconds(){return("-"===this.op?-1:1)*(this.millis+1E3*this.second+6E4*this.minute+36E5*
this.hour+864E5*this.day+365/12*this.month*864E5+31536E6*this.year)}}d.SqlInterval=y;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/StandardizedFunctions":function(){define("exports ../../arcade/featureset/support/errorsupport ../string ./DateOnly ./sqlCompareUtils ./sqlDateParsingUtils ./TimeOnly ../../chunks/datetime".split(" "),function(d,g,y,x,G,A,f,p){function e(b){return"string"===typeof b||b instanceof String}function v(b){return A.isDate(b)||A.isDateOnly(b)||
A.isDateTime(b)||A.isTimeOnly(b)||A.isTimestampOffset(b)?!1:!0}function z(b){return A.isDateOnly(b)||A.isTimeOnly(b)?b.toString():A.isTimestampOffset(b)?b.toSQLValue():A.isDateTime(b)?0===b.millisecond?b.toFormat("yyyy-LL-dd HH:mm:ss"):b.toSQL({includeOffset:!1}):A.isDate(b)?z(p.DateTime.fromJSDate(b)):b.toString()}function E(b){if(A.isDate(b))return x.DateOnly.fromDateJS(b);if(A.isDateTime(b))return x.DateOnly.fromParts(b.year,b.month,b.day);if(A.isDateOnly(b))return b;if(A.isTimeOnly(b))throw new g.SqlError(g.SqlErrorCodes.CannotCastValue);
if(A.isTimestampOffset(b)&&null===x.DateOnly.fromParts(b.year,b.month,b.day))throw new g.SqlError(g.SqlErrorCodes.CannotCastValue);if(e(b)&&(b=x.DateOnly.fromReader(b),null!==b&&b.isValid))return b;throw new g.SqlError(g.SqlErrorCodes.CannotCastValue);}function J(b,t,n){if(A.isDate(b))return A.convertToExecutingTimeZone(b,t);if(A.isDateTime(b))return b;if(A.isDateOnly(b))return b.toDateTimeLuxon("unknown");if(A.isTimeOnly(b))throw new g.SqlError(g.SqlErrorCodes.CannotCastValue);if(A.isTimestampOffset(b))return b;
if(e(b))return A.parseTimestamp(b,"unknown",n);throw new g.SqlError(g.SqlErrorCodes.CannotCastValue);}function r(b){if(A.isDate(b))return f.TimeOnly.fromDateJS(b);if(A.isDateTime(b))return f.TimeOnly.fromDateTime(b);if(A.isDateOnly(b))throw new g.SqlError(g.SqlErrorCodes.CannotCastValue);if(A.isTimeOnly(b))return b;if(A.isTimestampOffset(b))return f.TimeOnly.fromSqlTimeStampOffset(b);if(e(b))return A.parseTime(b);throw new g.SqlError(g.SqlErrorCodes.CannotCastValue);}const q={extract:{minParams:2,
maxParams:2,evaluate:([b,t])=>{if(null==t)return null;if(A.isDate(t))switch(b.toUpperCase()){case "SECOND":return t.getSeconds();case "MINUTE":return t.getMinutes();case "HOUR":return t.getHours();case "DAY":return t.getDate();case "MONTH":return t.getMonth()+1;case "YEAR":return t.getFullYear();case "TIMEZONE_HOUR":return 0;case "TIMEZONE_MINUTE":return 0}else if(A.isDateTime(t))switch(b.toUpperCase()){case "SECOND":return t.second;case "MINUTE":return t.minute;case "HOUR":return t.hour;case "DAY":return t.day;
case "MONTH":return t.month;case "YEAR":return t.year}else if(A.isDateOnly(t))switch(b.toUpperCase()){case "DAY":return t.day;case "MONTH":return t.month;case "YEAR":return t.year}else if(A.isTimeOnly(t))switch(b.toUpperCase()){case "SECOND":return t.second;case "MINUTE":return t.minute;case "HOUR":return t.hour}else if(A.isTimestampOffset(t))switch(b.toUpperCase()){case "SECOND":return t.second;case "MINUTE":return t.minute;case "HOUR":return t.hour;case "DAY":return t.day;case "MONTH":return t.month;
case "YEAR":return t.year;case "TIMEZONE_HOUR":return t.timezoneOffsetHour;case "TIMEZONE_MINUTE":return t.timezoneOffsetMinutes}throw new g.SqlError(g.SqlErrorCodes.InvalidFunctionParameters,{function:"EXTRACT"});}},substring:{minParams:2,maxParams:3,evaluate:b=>{if(2===b.length){const [t,n]=b;return null==t||null==n?null:t.toString().substring(n-1)}if(3===b.length){const [t,n,D]=b;return null==t||null==n||null==D?null:0>=D?"":t.toString().substring(n-1,n+D-1)}}},position:{minParams:2,maxParams:2,
evaluate:([b,t])=>null==b||null==t?null:t.indexOf(b)+1},trim:{minParams:2,maxParams:3,evaluate:b=>{var t=3===b.length,n=t?b[1]:" ";t=t?b[2]:b[1];if(null==n||null==t)return null;n=`(${y.escapeRegExpString(n)})`;switch(b[0]){case "BOTH":return t.replaceAll(new RegExp(`^${n}*|${n}*$`,"g"),"");case "LEADING":return t.replaceAll(new RegExp(`^${n}*`,"g"),"");case "TRAILING":return t.replaceAll(new RegExp(`${n}*$`,"g"),"")}throw new g.SqlError(g.SqlErrorCodes.InvalidFunctionParameters,{function:"TRIM"});
}},abs:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:Math.abs(b[0])},ceiling:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:Math.ceil(b[0])},floor:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:Math.floor(b[0])},log:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:Math.log(b[0])},log10:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:Math.log(b[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:Math.sin(b[0])},cos:{minParams:1,maxParams:1,evaluate:b=>
null==b[0]?null:Math.cos(b[0])},tan:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:Math.tan(b[0])},asin:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:Math.asin(b[0])},acos:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:Math.acos(b[0])},atan:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:Math.atan(b[0])},sign:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:0<b[0]?1:0>b[1]?-1:0},power:{minParams:2,maxParams:2,evaluate:b=>null==b[0]||null==b[1]?null:b[0]**b[1]},mod:{minParams:2,
maxParams:2,evaluate:b=>null==b[0]||null==b[1]?null:b[0]%b[1]},round:{minParams:1,maxParams:2,evaluate:b=>{const t=b[0];b=2===b.length?10**b[1]:1;return null==t?null:Math.round(t*b)/b}},truncate:{minParams:1,maxParams:2,evaluate:b=>null==b[0]?null:1===b.length?parseInt(b[0].toFixed(0),10):parseFloat(b[0].toFixed(b[1]))},char_length:{minParams:1,maxParams:1,evaluate:b=>e(b[0])?b[0].length:0},concat:{minParams:1,maxParams:Infinity,evaluate:b=>{let t="";for(let n=0;n<b.length;n++){if(null==b[n])return null;
t+=b[n].toString()}return t}},lower:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:b[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:b[0].toString().toUpperCase()},coalesce:{minParams:1,maxParams:Infinity,evaluate:b=>{for(const t of b)if(null!==t)return t;return null}},cosh:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:Math.cosh(b[0])},sinh:{minParams:1,maxParams:1,evaluate:b=>null==b[0]?null:Math.sinh(b[0])},tanh:{minParams:1,maxParams:1,evaluate:b=>
null==b[0]?null:Math.tanh(b[0])},nullif:{minParams:2,maxParams:2,evaluate:(b,t)=>G.sqlCompare(b[0],b[1],"\x3d")?null:b[0]},cast:{minParams:2,maxParams:2,evaluate:(b,t)=>{const n=b[0];b=b[1];if(null===n)return null;switch(b.type){case "integer":if(!v(n))throw new g.SqlError(g.SqlErrorCodes.CannotCastValue);t=parseInt(n,10);if(isNaN(t))throw new g.SqlError(g.SqlErrorCodes.CannotCastValue);return t;case "smallint":if(!v(n))throw new g.SqlError(g.SqlErrorCodes.CannotCastValue);t=parseInt(n,10);if(isNaN(t))throw new g.SqlError(g.SqlErrorCodes.CannotCastValue);
if(32767<t||-32767>t)throw new g.SqlError(g.SqlErrorCodes.CannotCastValue);return t;case "float":case "real":if(!v(n))throw new g.SqlError(g.SqlErrorCodes.CannotCastValue);t=parseFloat(n);if(isNaN(t))throw new g.SqlError(g.SqlErrorCodes.CannotCastValue);return t;case "time":return r(n);case "date":return E(n);case "timestamp":return J(n,t,!0===b.withtimezone);case "varchar":t=z(n);if(t.length>b.size)throw new g.SqlError(g.SqlErrorCodes.CannotCastValue);return t;default:throw new g.SqlError(g.SqlErrorCodes.InvalidDataType);
}}}};d.evaluateFunction=function(b,t,n){const D=q[b.toLowerCase()];if(null==D)throw new g.SqlError(g.SqlErrorCodes.FunctionNotRecognized);if(t.length<D.minParams||t.length>D.maxParams)throw new g.SqlError(g.SqlErrorCodes.InvalidParameterCount,{name:b.toUpperCase()});return D.evaluate(t,n)};d.isStandardized=function(b,t){b=q[b.toLowerCase()];return null!=b&&t>=b.minParams&&t<=b.maxParams};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/sqlCompareUtils":function(){define("exports ../../arcade/featureset/support/errorsupport ./sqlDateParsingUtils ./SqlTimestampOffset ./UnknownTimeZone ../../chunks/datetime".split(" "),
function(d,g,y,x,G,A){function f(b){return y.isDateTime(b)||y.isTimestampOffset(b)?!0:!1}function p(b){return y.isDateTime(b)||y.isDateOnly(b)||y.isTimestampOffset(b)||y.isTimeOnly(b)?!0:!1}function e(b){if(y.isDateTime(b))return b.toMillis();if(y.isDateOnly(b))return b.toNumber();if(y.isTimestampOffset(b))return b.toMilliseconds();throw new g.SqlError(g.SqlErrorCodes.InvalidDataType);}function v(b,t,n){switch(n){case "\x3c\x3e":return b!==t;case "\x3d":return b===t;case "\x3e":return b>t;case "\x3c":return b<
t;case "\x3e\x3d":return b>=t;case "\x3c\x3d":return b<=t}}function z(b,t,n){const D=parseFloat(t);if(!isNaN(D))return v(b,D,n);b=b.toString();switch(n){case "\x3c\x3e":return b!==t;case "\x3d":return b===t;case "\x3e":return b>t;case "\x3c":return b<t;case "\x3e\x3d":return b>=t;case "\x3c\x3d":return b<=t}}function E(b,t,n){const D=parseFloat(b);if(!isNaN(D))return v(D,t,n);t=t.toString();switch(n){case "\x3c\x3e":return b!==t;case "\x3d":return b===t;case "\x3e":return b>t;case "\x3c":return b<
t;case "\x3e\x3d":return b>=t;case "\x3c\x3d":return b<=t}}function J(b,t,n){switch(n){case "\x3c\x3e":return b!==t;case "\x3d":return b===t;case "\x3e":return b>t;case "\x3c":return b<t;case "\x3e\x3d":return b>=t;case "\x3c\x3d":return b<=t}}function r(b,t,n){b instanceof x.SqlTimeStampOffset&&(b=b.toDateTime());t instanceof x.SqlTimeStampOffset&&(t=t.toDateTime());b=q(b);t=q(t);switch(n){case "\x3c\x3e":return b!==t;case "\x3d":return b===t;case "\x3e":return b>t;case "\x3c":return b<t;case "\x3e\x3d":return b>=
t;case "\x3c\x3d":return b<=t}}function q(b){return 321408E5*b.year+26784E5*b.month+864E5*b.day+36E5*b.hour+6E4*b.minute+1E3*b.second+b.millisecond}d.dateValueInMilliseconds=e;d.isDateOrTimeValue=p;d.isDateTimeComparableValue=f;d.sqlCompare=function(b,t,n,D){if(null==b||null==t)return null;if(y.isNumber(b)){if(y.isNumber(t))return v(b,t,n);if(y.isString(t))return z(b,t,n);if(p(t))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);if(y.isDateOnly(t))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);
}else if(y.isString(b)){if(y.isNumber(t))return E(b,t,n);if(y.isString(t))return J(b,t,n);if(y.isDateTime(t))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);if(y.isDateOnly(t))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);if(y.isTimeOnly(t))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);if(y.isTimestampOffset(t))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}else if(y.isDateTime(b)){if(f(t)){if(b instanceof A.DateTime&&G.isUnknownTimeZone(b.zone)){if(t instanceof A.DateTime&&
!1===G.isUnknownTimeZone(t.zone)||t instanceof x.SqlTimeStampOffset)return r(b,t,n)}else if(t instanceof A.DateTime&&G.isUnknownTimeZone(t.zone)&&(b instanceof A.DateTime&&!1===G.isUnknownTimeZone(b.zone)||b instanceof x.SqlTimeStampOffset))return r(b,t,n);return v(e(b),e(t),n)}if(y.isString(t))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);if(y.isDateOnly(t))return t=t.toDateTimeLuxon(b.zone),b=b.startOf("day"),v(b.toMillis(),t.toMillis(),n);if(y.isTimeOnly(t))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);
if(y.isNumber(t))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}else if(y.isDateOnly(b)){if(y.isTimestampOffset(t))return b=b.toDateTimeLuxon(t.toDateTime().zone),t=t.startOfDay(),v(b.toMillis(),t.toMilliseconds(),n);if(y.isDateTime(t))return b=b.toDateTimeLuxon(t.zone),t=t.startOf("day"),v(b.toMillis(),t.toMillis(),n);if(y.isString(t))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);if(y.isDateOnly(t))return v(b.toNumber(),t.toNumber(),n);if(y.isTimeOnly(t))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);
if(y.isNumber(t))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}else if(y.isTimeOnly(b)){if(y.isTimeOnly(t))return v(b.toNumber(),t.toNumber(),n);if(y.isString(t))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);if(y.isNumber(t))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);if(y.isDateOnly(t))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);if(f(t))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}else if(y.isTimestampOffset(b)){if(f(t))return t instanceof A.DateTime&&
G.isUnknownTimeZone(t.zone)?r(b,t,n):v(e(b),e(t),n);if(y.isString(t))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);if(y.isDateOnly(t))return t=t.toDateTimeLuxon(b.toDateTime().zone),b=b.startOfDay(),v(b.toMilliseconds(),t.toMillis(),n);if(y.isTimeOnly(t))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);if(y.isNumber(t))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}switch(n){case "\x3c\x3e":return b!==t;case "\x3d":return b===t;case "\x3e":return b>t;case "\x3c":return b<t;case "\x3e\x3d":return b>=
t;case "\x3c\x3d":return b<=t}};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereGrammar":function(){define(["exports","../../chunks/_commonjsHelpers"],function(d,g){var y={exports:{}};(function(A){(function(f,p){A.exports&&(A.exports=p())})(g.commonjsGlobal,function(){function f(e,v,z,E){e=Error.call(this,e);Object.setPrototypeOf&&Object.setPrototypeOf(e,f.prototype);e.expected=v;e.found=z;e.location=E;e.name="SyntaxError";return e}function p(e,v,z){z=z||" ";if(e.length>
v)return e;v-=e.length;z+=z.repeat(v);return e+z.slice(0,v)}(function(e,v){function z(){this.constructor=e}z.prototype=v.prototype;e.prototype=new z})(f,Error);f.prototype.format=function(e){var v="Error: "+this.message;if(this.location){var z=null,E;for(E=0;E<e.length;E++)if(e[E].source===this.location.source){z=e[E].text.split(/\r\n|\n|\r/g);break}e=this.location.start;E=this.location.source&&"function"===typeof this.location.source.offset?this.location.source.offset(e):e;var J=this.location.source+
":"+E.line+":"+E.column;if(z){var r=this.location.end,q=p("",E.line.toString().length," ");z=z[e.line-1];r=(e.line===r.line?r.column:z.length+1)-e.column||1;v+="\n --\x3e "+J+"\n"+q+" |\n"+E.line+" | "+z+"\n"+q+" | "+p("",e.column-1," ")+p("",r,"^")}else v+="\n at "+J}return v};f.buildMessage=function(e,v){function z(b){return b.charCodeAt(0).toString(16).toUpperCase()}function E(b){return b.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,
"\\r").replace(/[\x00-\x0F]/g,function(t){return"\\x0"+z(t)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(t){return"\\x"+z(t)})}function J(b){return b.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(t){return"\\x0"+z(t)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(t){return"\\x"+z(t)})}function r(b){return q[b.type](b)}var q={literal:function(b){return'"'+
E(b.text)+'"'},class:function(b){var t=b.parts.map(function(n){return Array.isArray(n)?J(n[0])+"-"+J(n[1]):J(n)});return"["+(b.inverted?"^":"")+t.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(b){return b.description}};return"Expected "+function(b){b=b.map(r);var t,n;b.sort();if(0<b.length){for(n=t=1;t<b.length;t++)b[t-1]!==b[t]&&(b[n]=b[t],n++);b.length=n}switch(b.length){case 1:return b[0];case 2:return b[0]+" or "+b[1];default:return b.slice(0,
-1).join(", ")+", or "+b[b.length-1]}}(e)+" but "+(v?'"'+E(v)+'"':"end of input")+" found."};return{SyntaxError:f,parse:function(e,v){function z(H,N){N=void 0!==N?N:q(oa,m);throw new f(H,null,null,N);}function E(H,N){return{type:"literal",text:H,ignoreCase:N}}function J(H,N,S){return{type:"class",parts:H,inverted:N,ignoreCase:S}}function r(H){var N=Yb[H],S;if(!N){for(S=H-1;!Yb[S];)S--;N=Yb[S];for(N={line:N.line,column:N.column};S<H;)10===e.charCodeAt(S)?(N.line++,N.column=1):N.column++,S++;Yb[H]=
N}return N}function q(H,N,S){S=r(H);var da=r(N);return{source:Md,start:{offset:H,line:S.line,column:S.column},end:{offset:N,line:da.line,column:da.column}}}function b(H){m<eb||(m>eb&&(eb=m,yc=[]),yc.push(H))}function t(){var H=m;ka();var N=D();N!==c?(ka(),oa=H,H=N):(m=H,H=c);return H}function n(){var H=m;var N=D();if(N!==c){var S=[];var da=m;var ra=ka();var za=Wa();if(za!==c){var Fa=ka();var Ga=D();Ga!==c?da=ra=[ra,za,Fa,Ga]:(m=da,da=c)}else m=da,da=c;for(;da!==c;)S.push(da),da=m,ra=ka(),za=Wa(),
za!==c?(Fa=ka(),Ga=D(),Ga!==c?da=ra=[ra,za,Fa,Ga]:(m=da,da=c)):(m=da,da=c);oa=H;H={type:"expression-list"};N=[N];for(da=0;da<S.length;da++)N.push(S[da][3]);H.value=N}else m=H,H=c;return H}function D(){var H=m;var N=Q();if(N!==c){var S=[];var da=m;var ra=ka();var za=L();if(za!==c){var Fa=ka();var Ga=Q();Ga!==c?da=ra=[ra,za,Fa,Ga]:(m=da,da=c)}else m=da,da=c;for(;da!==c;)S.push(da),da=m,ra=ka(),za=L(),za!==c?(Fa=ka(),Ga=Q(),Ga!==c?da=ra=[ra,za,Fa,Ga]:(m=da,da=c)):(m=da,da=c);oa=H;H=nb(N,S)}else m=H,
H=c;return H}function Q(){var H=m;var N=a();if(N!==c){var S=[];var da=m;var ra=ka();var za=K();if(za!==c){var Fa=ka();var Ga=a();Ga!==c?da=ra=[ra,za,Fa,Ga]:(m=da,da=c)}else m=da,da=c;for(;da!==c;)S.push(da),da=m,ra=ka(),za=K(),za!==c?(Fa=ka(),Ga=a(),Ga!==c?da=ra=[ra,za,Fa,Ga]:(m=da,da=c)):(m=da,da=c);oa=H;H=nb(N,S)}else m=H,H=c;return H}function a(){var H=m;var N=B();if(N===c){N=m;if(33===e.charCodeAt(m)){var S=Nd;m++}else S=c,0===ha&&b(Od);if(S!==c){var da=m;ha++;if(61===e.charCodeAt(m)){var ra=
Rc;m++}else ra=c,0===ha&&b(Sc);ha--;ra===c?da=void 0:(m=da,da=c);da!==c?N=S=[S,da]:(m=N,N=c)}else m=N,N=c}N!==c?(S=ka(),da=a(),da!==c?(oa=H,H={type:"unary-expression",operator:"NOT",expr:da}):(m=H,H=c)):(m=H,H=c);if(H===c){N=m;H=Z();if(H!==c){ka();S=m;da=[];ra=m;var za=ka();var Fa=C();if(Fa!==c){var Ga=ka();var ob=Z();ob!==c?ra=za=[za,Fa,Ga,ob]:(m=ra,ra=c)}else m=ra,ra=c;if(ra!==c)for(;ra!==c;)da.push(ra),ra=m,za=ka(),Fa=C(),Fa!==c?(Ga=ka(),ob=Z(),ob!==c?ra=za=[za,Fa,Ga,ob]:(m=ra,ra=c)):(m=ra,ra=
c);else da=c;da!==c&&(oa=S,da={type:"arithmetic",tail:da});S=da;S===c&&(S=m,da=R(),da!==c?(ka(),ra=Ja(),ra!==c?(ka(),ra=n(),ra!==c?(ka(),za=Ka(),za!==c?(oa=S,S={op:da,right:ra}):(m=S,S=c)):(m=S,S=c)):(m=S,S=c)):(m=S,S=c),S===c&&(S=m,da=R(),da!==c?(ka(),ra=Ja(),ra!==c?(ka(),ra=Ka(),ra!==c?(oa=S,S={op:da,right:{type:"expression-list",value:[]}}):(m=S,S=c)):(m=S,S=c)):(m=S,S=c),S===c&&(S=m,da=R(),da!==c?(ka(),ra=Y(),ra!==c?(oa=S,S={op:da,right:ra}):(m=S,S=c)):(m=S,S=c))),S===c&&(S=m,za=B(),za!==c?(ka(),
da=V(),da!==c?(ka(),ra=Z(),ra!==c?(ka(),Fa=K(),Fa!==c?(ka(),za=Z(),za!==c?(oa=S,S={op:"NOT"+da,right:{type:"expression-list",value:[ra,za]}}):(m=S,S=c)):(m=S,S=c)):(m=S,S=c)):(m=S,S=c)):(m=S,S=c),S===c&&(S=m,za=V(),za!==c?(ka(),da=Z(),da!==c?(ka(),ra=K(),ra!==c?(ka(),Fa=Z(),Fa!==c?(oa=S,S={op:za,right:{type:"expression-list",value:[da,Fa]}}):(m=S,S=c)):(m=S,S=c)):(m=S,S=c)):(m=S,S=c)),S===c&&(S=m,da=ba(),da!==c?(ka(),ra=B(),ra!==c?(ka(),ra=Z(),ra!==c?(oa=S,S={op:da+"NOT",right:ra}):(m=S,S=c)):(m=
S,S=c)):(m=S,S=c),S===c&&(S=m,da=ba(),da!==c?(ka(),ra=Z(),ra!==c?(oa=S,S={op:da,right:ra}):(m=S,S=c)):(m=S,S=c)),S===c&&(S=m,da=P(),da!==c?(ka(),ra=ta(),ra!==c?(ka(),za=m,e.substr(m,6).toLowerCase()===Pd?(Fa=e.substr(m,6),m+=6):(Fa=c,0===ha&&b(Qd)),Fa!==c?(Fa=m,ha++,Ga=w(),ha--,Ga===c?Fa=void 0:(m=Fa,Fa=c),Fa!==c?(oa=za,za="ESCAPE"):(m=za,za=c)):(m=za,za=c),za!==c?(ka(),za=wa(),za!==c?(oa=S,S={op:da,right:ra,escape:za.value}):(m=S,S=c)):(m=S,S=c)):(m=S,S=c)):(m=S,S=c),S===c&&(S=m,da=P(),da!==c?(ka(),
ra=ta(),ra!==c?(oa=S,S={op:da,right:ra,escape:""}):(m=S,S=c)):(m=S,S=c))))));S===c&&(S=null);oa=N;N=S;""==N||void 0==N||null==N?N=H:(S=null,N=S="arithmetic"==N.type?nb(H,N.tail):Mb(N.op,H,N.right,N.escape))}else m=N,N=c;H=N}return H}function C(){if(e.substr(m,2)===Tc){var H=Tc;m+=2}else H=c,0===ha&&b(Rd);H===c&&(62===e.charCodeAt(m)?(H=Sd,m++):(H=c,0===ha&&b(Td)),H===c&&(e.substr(m,2)===Uc?(H=Uc,m+=2):(H=c,0===ha&&b(Ud)),H===c&&(e.substr(m,2)===Vc?(H=Vc,m+=2):(H=c,0===ha&&b(Vd)),H===c&&(60===e.charCodeAt(m)?
(H=Wd,m++):(H=c,0===ha&&b(Xd)),H===c&&(61===e.charCodeAt(m)?(H=Rc,m++):(H=c,0===ha&&b(Sc)),H===c&&(e.substr(m,2)===Wc?(H=Wc,m+=2):(H=c,0===ha&&b(Yd))))))));return H}function P(){var H;var N=H=m;var S=B();if(S!==c){var da=ka();var ra=ja();ra!==c?N=S=[S,da,ra]:(m=N,N=c)}else m=N,N=c;N!==c&&(oa=H,N=N[0]+" "+N[2]);H=N;H===c&&(H=ja());return H}function R(){var H;var N=H=m;var S=B();if(S!==c){var da=ka();var ra=X();ra!==c?N=S=[S,da,ra]:(m=N,N=c)}else m=N,N=c;N!==c&&(oa=H,N=N[0]+" "+N[2]);H=N;H===c&&(H=
X());return H}function Z(){var H=m;var N=U();if(N!==c){var S=[];var da=m;var ra=ka();var za=W();if(za!==c){var Fa=ka();var Ga=U();Ga!==c?da=ra=[ra,za,Fa,Ga]:(m=da,da=c)}else m=da,da=c;for(;da!==c;)S.push(da),da=m,ra=ka(),za=W(),za!==c?(Fa=ka(),Ga=U(),Ga!==c?da=ra=[ra,za,Fa,Ga]:(m=da,da=c)):(m=da,da=c);oa=H;H=nb(N,S)}else m=H,H=c;return H}function W(){if(43===e.charCodeAt(m)){var H=zc;m++}else H=c,0===ha&&b(Ac);H===c&&(45===e.charCodeAt(m)?(H=Bc,m++):(H=c,0===ha&&b(Cc)),H===c&&(e.substr(m,2)===Xc?
(H=Xc,m+=2):(H=c,0===ha&&b(Zd))));return H}function U(){var H=m;var N=I();if(N!==c){var S=[];var da=m;var ra=ka();var za=u();if(za!==c){var Fa=ka();var Ga=I();Ga!==c?da=ra=[ra,za,Fa,Ga]:(m=da,da=c)}else m=da,da=c;for(;da!==c;)S.push(da),da=m,ra=ka(),za=u(),za!==c?(Fa=ka(),Ga=I(),Ga!==c?da=ra=[ra,za,Fa,Ga]:(m=da,da=c)):(m=da,da=c);oa=H;H=nb(N,S)}else m=H,H=c;return H}function u(){if(42===e.charCodeAt(m)){var H=$d;m++}else H=c,0===ha&&b(ae);H===c&&(47===e.charCodeAt(m)?(H=be,m++):(H=c,0===ha&&b(ce)));
return H}function I(){var H=wa();if(H===c){var N=m;var S=m;var da=Sa();if(da!==c){var ra=Ta();if(ra!==c){var za=Oa();za!==c?(oa=S,S=parseFloat(da+ra+za)):(m=S,S=c)}else m=S,S=c}else m=S,S=c;S===c&&(S=m,da=Sa(),da!==c?(ra=Ta(),ra!==c?(oa=S,S=parseFloat(da+ra)):(m=S,S=c)):(m=S,S=c),S===c&&(S=m,da=Sa(),da!==c?(ra=Oa(),ra!==c?(oa=S,S=parseFloat(da+ra)):(m=S,S=c)):(m=S,S=c),S===c&&(S=m,da=Sa(),da!==c&&(oa=S,da=parseFloat(da)),S=da)));var Fa=S;if(Fa!==c){var Ga=m;ha++;var ob=h();ha--;ob===c?Ga=void 0:(m=
Ga,Ga=c);Ga!==c?(oa=N,N={type:"number",value:Fa}):(m=N,N=c)}else m=N,N=c;H=N;if(H===c){var pb=m;var Jb=m;if(e.substr(m,4).toLowerCase()===de){var Zb=e.substr(m,4);m+=4}else Zb=c,0===ha&&b(ee);if(Zb!==c){var Nb=m;ha++;var fe=w();ha--;fe===c?Nb=void 0:(m=Nb,Nb=c);Nb!==c?Jb=Zb=[Zb,Nb]:(m=Jb,Jb=c)}else m=Jb,Jb=c;var qb=Jb;qb!==c&&(oa=pb,qb={type:"boolean",value:!0});pb=qb;if(pb===c){pb=m;var Kb=m;if(e.substr(m,5).toLowerCase()===ge){var $b=e.substr(m,5);m+=5}else $b=c,0===ha&&b(he);if($b!==c){var Ob=
m;ha++;var ie=w();ha--;ie===c?Ob=void 0:(m=Ob,Ob=c);Ob!==c?Kb=$b=[$b,Ob]:(m=Kb,Kb=c)}else m=Kb,Kb=c;qb=Kb;qb!==c&&(oa=pb,qb={type:"boolean",value:!1});pb=qb}H=pb;if(H===c){var je=m;var Lb=m;if(e.substr(m,4).toLowerCase()===ke){var ac=e.substr(m,4);m+=4}else ac=c,0===ha&&b(le);if(ac!==c){var Pb=m;ha++;var me=w();ha--;me===c?Pb=void 0:(m=Pb,Pb=c);Pb!==c?Lb=ac=[ac,Pb]:(m=Lb,Lb=c)}else m=Lb,Lb=c;var Dc=Lb;Dc!==c&&(oa=je,Dc={type:"null",value:null});H=Dc;if(H===c){var rb=m;if(la()!==c){ka();var bc=ta();
bc!==c?(oa=rb,"string"===bc.type&&!0!==/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(bc.value)&&z("Date literal is invalid"),rb={type:"date",value:bc.value}):(m=rb,rb=c)}else m=rb,rb=c;H=rb;if(H===c){var sb=
m;if(fa()!==c){ka();var cc=ta();cc!==c?(oa=sb,"string"===cc.type&&!0!==/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(cc.value)&&z("Timestamp literal is invalid"),sb={type:"timestamp",value:cc.value}):
(m=sb,sb=c)}else m=sb,sb=c;H=sb;if(H===c){var Ua=m;var Ec=ua();if(Ec!==c){ka();if(45===e.charCodeAt(m)){var hb=Bc;m++}else hb=c,0===ha&&b(Cc);hb===c&&(43===e.charCodeAt(m)?(hb=zc,m++):(hb=c,0===ha&&b(Ac)));if(hb!==c){ka();var Qb=ta();if(Qb!==c){ka();var Yc=ia();Yc!==c?(oa=Ua,Ua={type:"interval",value:Qb,qualifier:Yc,op:hb}):(m=Ua,Ua=c)}else m=Ua,Ua=c}else m=Ua,Ua=c}else m=Ua,Ua=c;Ua===c&&(Ua=m,Ec=ua(),Ec!==c?(ka(),hb=ta(),hb!==c?(ka(),Qb=ia(),Qb!==c?(oa=Ua,Ua={type:"interval",value:hb,qualifier:Qb,
op:""}):(m=Ua,Ua=c)):(m=Ua,Ua=c)):(m=Ua,Ua=c));H=Ua;if(H===c){var tb=m;if(ma()!==c){ka();var dc=ta();dc!==c?(oa=tb,"string"===dc.type&&!0!==/^(\d{1,2}):(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/.test(dc.value)&&z("Time literal is invalid"),tb={type:"time",value:dc.value}):(m=tb,tb=c)}else m=tb,tb=c;H=tb}}}}}}}var La=H;if(La===c){var Za=m;var ub=m;if(e.substr(m,7).toLowerCase()===ne){var Zc=e.substr(m,7);m+=7}else Zc=c,0===ha&&b(oe);if(Zc!==c){var ec=m;ha++;
var pe=w();ha--;pe===c?ec=void 0:(m=ec,ec=c);ec!==c?(oa=ub,ub="EXTRACT"):(m=ub,ub=c)}else m=ub,ub=c;if(ub!==c){ka();var qe=Ja();if(qe!==c){ka();var $a=pa();if($a===c&&($a=sa(),$a===c&&($a=Ca(),$a===c&&($a=xa(),$a===c&&($a=Ba(),$a===c&&($a=Aa(),$a===c)))))){var vb=m;if(e.substr(m,13).toLowerCase()===re){var $c=e.substr(m,13);m+=13}else $c=c,0===ha&&b(se);if($c!==c){var fc=m;ha++;var te=w();ha--;te===c?fc=void 0:(m=fc,fc=c);fc!==c?(oa=vb,vb="TIMEZONE_HOUR"):(m=vb,vb=c)}else m=vb,vb=c;$a=vb;if($a===
c){var wb=m;if(e.substr(m,15).toLowerCase()===ue){var ad=e.substr(m,15);m+=15}else ad=c,0===ha&&b(ve);if(ad!==c){var gc=m;ha++;var we=w();ha--;we===c?gc=void 0:(m=gc,gc=c);gc!==c?(oa=wb,wb="TIMEZONE_MINUTE"):(m=wb,wb=c)}else m=wb,wb=c;$a=wb}}var bd=$a;if(bd!==c){ka();var xe=aa();if(xe!==c){ka();var cd=D();if(cd!==c){ka();var ye=Ka();ye!==c?(oa=Za,Za={type:"function",name:"extract",args:{type:"expression-list",value:[{type:"string",value:bd},cd]}}):(m=Za,Za=c)}else m=Za,Za=c}else m=Za,Za=c}else m=
Za,Za=c}else m=Za,Za=c}else m=Za,Za=c;La=Za;if(La===c){var ab=m;var xb=m;if(e.substr(m,9).toLowerCase()===ze){var dd=e.substr(m,9);m+=9}else dd=c,0===ha&&b(Ae);if(dd!==c){var hc=m;ha++;var Be=w();ha--;Be===c?hc=void 0:(m=hc,hc=c);hc!==c?(oa=xb,xb="SUBSTRING"):(m=xb,xb=c)}else m=xb,xb=c;if(xb!==c){ka();var Ce=Ja();if(Ce!==c){ka();var Fc=D();if(Fc!==c){ka();var De=aa();if(De!==c){ka();var Gc=D();if(Gc!==c){ka();var ib=m;var yb=m;if(e.substr(m,3).toLowerCase()===Ee){var ed=e.substr(m,3);m+=3}else ed=
c,0===ha&&b(Fe);if(ed!==c){var ic=m;ha++;var Ge=w();ha--;Ge===c?ic=void 0:(m=ic,ic=c);ic!==c?(oa=yb,yb="FOR"):(m=yb,yb=c)}else m=yb,yb=c;var Rb=yb;if(Rb!==c){var He=ka();var fd=D();if(fd!==c){var Ie=ka();ib=Rb=[Rb,He,fd,Ie]}else m=ib,ib=c}else m=ib,ib=c;ib===c&&(ib=null);Rb=Ka();Rb!==c?(oa=ab,ab={type:"function",name:"substring",args:{type:"expression-list",value:ib?[Fc,Gc,ib[2]]:[Fc,Gc]}}):(m=ab,ab=c)}else m=ab,ab=c}else m=ab,ab=c}else m=ab,ab=c}else m=ab,ab=c}else m=ab,ab=c;La=ab;if(La===c){var Na=
m;var Hc=ca();if(Hc!==c){ka();var Ic=Ja();if(Ic!==c){ka();var jb=ea();jb===c&&(jb=null);ka();var Sb=D();if(Sb!==c){ka();var Jc=aa();if(Jc!==c){ka();var gd=D();if(gd!==c){ka();var Je=Ka();Je!==c?(oa=Na,Na={type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:null==jb?"BOTH":jb},Sb,gd]}}):(m=Na,Na=c)}else m=Na,Na=c}else m=Na,Na=c}else m=Na,Na=c}else m=Na,Na=c}else m=Na,Na=c;Na===c&&(Na=m,Hc=ca(),Hc!==c?(ka(),Ic=Ja(),Ic!==c?(ka(),jb=ea(),jb===c&&(jb=null),ka(),Sb=D(),
Sb!==c?(ka(),Jc=Ka(),Jc!==c?(oa=Na,Na={type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:null==jb?"BOTH":jb},Sb]}}):(m=Na,Na=c)):(m=Na,Na=c)):(m=Na,Na=c)):(m=Na,Na=c));La=Na;if(La===c){var bb=m;var zb=m;if(e.substr(m,8).toLowerCase()===Ke){var hd=e.substr(m,8);m+=8}else hd=c,0===ha&&b(Le);if(hd!==c){var jc=m;ha++;var Me=w();ha--;Me===c?jc=void 0:(m=jc,jc=c);jc!==c?(oa=zb,zb="POSITION"):(m=zb,zb=c)}else m=zb,zb=c;if(zb!==c){ka();var Ne=Ja();if(Ne!==c){ka();var id=
D();if(id!==c){ka();var Oe=X();if(Oe!==c){ka();var jd=D();if(jd!==c){ka();var Pe=Ka();Pe!==c?(oa=bb,bb={type:"function",name:"position",args:{type:"expression-list",value:[id,jd]}}):(m=bb,bb=c)}else m=bb,bb=c}else m=bb,bb=c}else m=bb,bb=c}else m=bb,bb=c}else m=bb,bb=c;La=bb;if(La===c){var cb=m;var Ab=m;if(e.substr(m,4).toLowerCase()===Qe){var kd=e.substr(m,4);m+=4}else kd=c,0===ha&&b(Re);if(kd!==c){var kc=m;ha++;var Se=w();ha--;Se===c?kc=void 0:(m=kc,kc=c);kc!==c?(oa=Ab,Ab="CAST"):(m=Ab,Ab=c)}else m=
Ab,Ab=c;if(Ab!==c){ka();var Te=Ja();if(Te!==c){ka();var ld=D();if(ld!==c){ka();var Bb=m;if(e.substr(m,2).toLowerCase()===Ue){var md=e.substr(m,2);m+=2}else md=c,0===ha&&b(Ve);if(md!==c){var lc=m;ha++;var We=w();ha--;We===c?lc=void 0:(m=lc,lc=c);lc!==c?(oa=Bb,Bb="AS"):(m=Bb,Bb=c)}else m=Bb,Bb=c;var Xe=Bb;if(Xe!==c){ka();var Ha=m;var Cb=m;if(e.substr(m,7).toLowerCase()===Ye){var nd=e.substr(m,7);m+=7}else nd=c,0===ha&&b(Ze);if(nd!==c){var mc=m;ha++;var $e=w();ha--;$e===c?mc=void 0:(m=mc,mc=c);mc!==
c?(oa=Cb,Cb="INTEGER"):(m=Cb,Cb=c)}else m=Cb,Cb=c;var Ma=Cb;Ma!==c&&(oa=Ha,Ma={type:"data-type",value:{type:"integer"}});Ha=Ma;if(Ha===c){Ha=m;var Db=m;if(e.substr(m,8).toLowerCase()===af){var od=e.substr(m,8);m+=8}else od=c,0===ha&&b(bf);if(od!==c){var nc=m;ha++;var cf=w();ha--;cf===c?nc=void 0:(m=nc,nc=c);nc!==c?(oa=Db,Db="SMALLINT"):(m=Db,Db=c)}else m=Db,Db=c;Ma=Db;Ma!==c&&(oa=Ha,Ma={type:"data-type",value:{type:"smallint"}});Ha=Ma;if(Ha===c){Ha=m;var Eb=m;if(e.substr(m,5).toLowerCase()===df){var pd=
e.substr(m,5);m+=5}else pd=c,0===ha&&b(ef);if(pd!==c){var oc=m;ha++;var ff=w();ha--;ff===c?oc=void 0:(m=oc,oc=c);oc!==c?(oa=Eb,Eb="FLOAT"):(m=Eb,Eb=c)}else m=Eb,Eb=c;Ma=Eb;Ma!==c&&(oa=Ha,Ma={type:"data-type",value:{type:"float"}});Ha=Ma;if(Ha===c){Ha=m;var Fb=m;if(e.substr(m,4).toLowerCase()===gf){var qd=e.substr(m,4);m+=4}else qd=c,0===ha&&b(hf);if(qd!==c){var pc=m;ha++;var jf=w();ha--;jf===c?pc=void 0:(m=pc,pc=c);pc!==c?(oa=Fb,Fb="REAL"):(m=Fb,Fb=c)}else m=Fb,Fb=c;Ma=Fb;Ma!==c&&(oa=Ha,Ma={type:"data-type",
value:{type:"real"}});Ha=Ma;if(Ha===c&&(Ha=m,Ma=la(),Ma!==c&&(oa=Ha,Ma={type:"data-type",value:{type:"date"}}),Ha=Ma,Ha===c&&(Ha=m,Ma=fa(),Ma!==c&&(oa=Ha,Ma={type:"data-type",value:{type:"timestamp"}}),Ha=Ma,Ha===c&&(Ha=m,Ma=ma(),Ma!==c&&(oa=Ha,Ma={type:"data-type",value:{type:"time"}}),Ha=Ma,Ha===c)))){Ha=m;var Gb=m;if(e.substr(m,7).toLowerCase()===kf){var rd=e.substr(m,7);m+=7}else rd=c,0===ha&&b(lf);if(rd!==c){var qc=m;ha++;var mf=w();ha--;mf===c?qc=void 0:(m=qc,qc=c);qc!==c?(oa=Gb,Gb="VARCHAR"):
(m=Gb,Gb=c)}else m=Gb,Gb=c;Ma=Gb;if(Ma!==c){ka();var nf=Ja();if(nf!==c){ka();var sd=l();if(sd!==c){ka();var of=Ka();of!==c?(oa=Ha,Ha={type:"data-type",value:{type:"varchar",size:parseInt(sd)}}):(m=Ha,Ha=c)}else m=Ha,Ha=c}else m=Ha,Ha=c}else m=Ha,Ha=c}}}}var td=Ha;if(td!==c){ka();var pf=Ka();pf!==c?(oa=cb,cb={type:"function",name:"cast",args:{type:"expression-list",value:[ld,td]}}):(m=cb,cb=c)}else m=cb,cb=c}else m=cb,cb=c}else m=cb,cb=c}else m=cb,cb=c}else m=cb,cb=c;La=cb;if(La===c){var kb=m;var db=
m;var Tb=k();Tb!==c&&(oa=db);db=Tb;if(db===c)if(db=m,96===e.charCodeAt(m)?(Tb=ud,m++):(Tb=c,0===ha&&b(vd)),Tb!==c){var rc=[];if(wd.test(e.charAt(m))){var lb=e.charAt(m);m++}else lb=c,0===ha&&b(xd);if(lb!==c)for(;lb!==c;)rc.push(lb),wd.test(e.charAt(m))?(lb=e.charAt(m),m++):(lb=c,0===ha&&b(xd));else rc=c;rc!==c?(96===e.charCodeAt(m)?(lb=ud,m++):(lb=c,0===ha&&b(vd)),lb!==c?(oa=db,db=rc.join("")):(m=db,db=c)):(m=db,db=c)}else m=db,db=c;var yd=db;if(yd!==c){ka();var qf=Ja();if(qf!==c){ka();var sc=n();
sc===c&&(sc=null);ka();var rf=Ka();rf!==c?(oa=kb,kb={type:"function",name:yd,args:sc?sc:{type:"expression-list",value:[]}}):(m=kb,kb=c)}else m=kb,kb=c}else m=kb,kb=c;La=kb;if(La===c){var fb;var Va=m;var Kc=ya();if(Kc!==c){ka();var Ub=D();if(Ub!==c){ka();var Vb=[];for(fb=Da();fb!==c;)Vb.push(fb),fb=Da();fb=ka();var tc=Ia();tc!==c?(oa=Va,Va={type:"case-expression",format:"simple",operand:Ub,clauses:Vb,else:null}):(m=Va,Va=c)}else m=Va,Va=c}else m=Va,Va=c;if(Va===c)if(Va=m,Kc=ya(),Kc!==c)if(ka(),Ub=
D(),Ub!==c){ka();Vb=[];for(fb=Da();fb!==c;)Vb.push(fb),fb=Da();fb=ka();tc=Pa();if(tc!==c){ka();var sf=Ia();sf!==c?(oa=Va,Va={type:"case-expression",format:"simple",operand:Ub,clauses:Vb,else:tc.value}):(m=Va,Va=c)}else m=Va,Va=c}else m=Va,Va=c;else m=Va,Va=c;var Lc=Va;if(Lc===c){var gb;var Xa=m;var Mc=ya();if(Mc!==c){ka();var Wb=[];for(gb=Ea();gb!==c;)Wb.push(gb),gb=Ea();gb=ka();var uc=Ia();uc!==c?(oa=Xa,Xa={type:"case-expression",format:"searched",clauses:Wb,else:null}):(m=Xa,Xa=c)}else m=Xa,Xa=
c;if(Xa===c)if(Xa=m,Mc=ya(),Mc!==c){ka();Wb=[];for(gb=Ea();gb!==c;)Wb.push(gb),gb=Ea();gb=ka();uc=Pa();if(uc!==c){ka();var tf=Ia();tf!==c?(oa=Xa,Xa={type:"case-expression",format:"searched",clauses:Wb,else:uc.value}):(m=Xa,Xa=c)}else m=Xa,Xa=c}else m=Xa,Xa=c;Lc=Xa}La=Lc;if(La===c){var Hb=m;var uf=m;var vc;var Xb=m;var zd=h();if(zd!==c){var Ad=[];for(vc=O();vc!==c;)Ad.push(vc),vc=O();oa=Xb;Xb=zd+Ad.join("")}else m=Xb,Xb=c;var Bd=Xb;Bd!==c&&(oa=uf);var mb=Bd;if(mb!==c){oa=Hb;var Nc=mb;mb=/^CURRENT_DATE$/i.test(Nc)?
{type:"current-time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(Nc)?{type:"current-time",mode:"timestamp"}:{type:"column-reference",table:"",column:Nc}}Hb=mb;if(Hb===c){Hb=m;var Ib=m;if(T()!==c){var wc;var vf=m;var Oc=[];for(wc=M();wc!==c;)Oc.push(wc),wc=M();oa=vf;var wf=Oc=Oc.join("");var xf=T();xf!==c?(oa=Ib,Ib=wf):(m=Ib,Ib=c)}else m=Ib,Ib=c;mb=Ib;mb!==c&&(oa=Hb,mb={type:"column-reference",table:"",column:mb,delimited:!0});Hb=mb}La=Hb;if(La===c&&(La=Y(),La===c)){La=m;var yf=Ja();if(yf!==c){ka();var Pc=
D();if(Pc!==c){ka();var zf=Ka();zf!==c?(oa=La,Pc.paren=!0,La=Pc):(m=La,La=c)}else m=La,La=c}else m=La,La=c}}}}}}}}}return La}function k(){var H;var N=m;var S=h();if(S!==c){var da=[];for(H=w();H!==c;)da.push(H),H=w();oa=N;N=S+da.join("")}else m=N,N=c;return N}function h(){if(Af.test(e.charAt(m))){var H=e.charAt(m);m++}else H=c,0===ha&&b(Bf);return H}function w(){if(Cf.test(e.charAt(m))){var H=e.charAt(m);m++}else H=c,0===ha&&b(Df);return H}function O(){if(Cd.test(e.charAt(m))){var H=e.charAt(m);m++}else H=
c,0===ha&&b(Dd);return H}function M(){if(Cd.test(e.charAt(m))){var H=e.charAt(m);m++}else H=c,0===ha&&b(Dd);if(H===c)if(H=m,T()!==c){var N=T();N!==c?(oa=H,H='"'):(m=H,H=c)}else m=H,H=c;return H}function T(){if(Ef.test(e.charAt(m))){var H=e.charAt(m);m++}else H=c,0===ha&&b(Ff);return H}function Y(){var H;var N=H=m;if(64===e.charCodeAt(m)){var S=Gf;m++}else S=c,0===ha&&b(Hf);if(S!==c){var da=k();da!==c?N=S=[S,da]:(m=N,N=c)}else m=N,N=c;N!==c&&(oa=H,N={type:"parameter",value:N[1]});return N}function ea(){var H=
m;if(e.substr(m,7).toLowerCase()===If){var N=e.substr(m,7);m+=7}else N=c,0===ha&&b(Jf);if(N!==c){N=m;ha++;var S=w();ha--;S===c?N=void 0:(m=N,N=c);N!==c?(oa=H,H="LEADING"):(m=H,H=c)}else m=H,H=c;H===c&&(H=m,e.substr(m,8).toLowerCase()===Kf?(N=e.substr(m,8),m+=8):(N=c,0===ha&&b(Lf)),N!==c?(N=m,ha++,S=w(),ha--,S===c?N=void 0:(m=N,N=c),N!==c?(oa=H,H="TRAILING"):(m=H,H=c)):(m=H,H=c),H===c&&(H=m,e.substr(m,4).toLowerCase()===Mf?(N=e.substr(m,4),m+=4):(N=c,0===ha&&b(Nf)),N!==c?(N=m,ha++,S=w(),ha--,S===c?
N=void 0:(m=N,N=c),N!==c?(oa=H,H="BOTH"):(m=H,H=c)):(m=H,H=c)));return H}function ia(){var H=m;var N=m;var S=na();if(S!==c){ka();var da=Ja();if(da!==c)if(ka(),da=va(),da!==c){ka();var ra=Ka();ra!==c?(oa=N,N={type:"interval-period",period:S.value,precision:da,secondary:null}):(m=N,N=c)}else m=N,N=c;else m=N,N=c}else m=N,N=c;N===c&&(N=m,S=na(),S!==c&&(oa=N,S={type:"interval-period",period:S.value,precision:null,secondary:null}),N=S);if(N!==c)if(ka(),S=m,e.substr(m,2).toLowerCase()===Of?(da=e.substr(m,
2),m+=2):(da=c,0===ha&&b(Pf)),da!==c?(da=m,ha++,ra=w(),ha--,ra===c?da=void 0:(m=da,da=c),da!==c?(oa=S,S="TO"):(m=S,S=c)):(m=S,S=c),S!==c){ka();S=m;da=na();da!==c&&(oa=S,da={type:"interval-period",period:da.value,precision:null,secondary:null});S=da;if(S===c){S=m;da=Aa();if(da!==c)if(ka(),da=Ja(),da!==c)if(ka(),da=va(),da!==c)if(ka(),ra=Wa(),ra!==c)if(ka(),ra=qa(),ra!==c){ka();var za=Ka();za!==c?(oa=S,S={type:"interval-period",period:"second",precision:da,secondary:ra}):(m=S,S=c)}else m=S,S=c;else m=
S,S=c;else m=S,S=c;else m=S,S=c;else m=S,S=c;S===c&&(S=m,da=Aa(),da!==c?(ka(),da=Ja(),da!==c?(ka(),da=va(),da!==c?(ka(),ra=Ka(),ra!==c?(oa=S,S={type:"interval-period",period:"second",precision:da,secondary:null}):(m=S,S=c)):(m=S,S=c)):(m=S,S=c)):(m=S,S=c),S===c&&(S=m,da=Aa(),da!==c&&(oa=S,da={type:"interval-period",period:"second",precision:null,secondary:null}),S=da))}S!==c?(oa=H,H={type:"interval-qualifier",start:N,end:S}):(m=H,H=c)}else m=H,H=c;else m=H,H=c;H===c&&(H=m,S=na(),S!==c?(ka(),N=Ja(),
N!==c?(ka(),N=qa(),N!==c?(ka(),da=Ka(),da!==c?(oa=H,H={type:"interval-period",period:S.value,precision:N,secondary:null}):(m=H,H=c)):(m=H,H=c)):(m=H,H=c)):(m=H,H=c),H===c&&(H=m,S=na(),S!==c&&(oa=H,S={type:"interval-period",period:S.value,precision:null,secondary:null}),H=S,H===c&&(H=m,S=Aa(),S!==c?(ka(),N=Ja(),N!==c?(ka(),N=va(),N!==c?(ka(),da=Wa(),da!==c?(ka(),S=qa(),S!==c?(ka(),da=Ka(),da!==c?(oa=H,H={type:"interval-period",period:"second",precision:N,secondary:S}):(m=H,H=c)):(m=H,H=c)):(m=H,H=
c)):(m=H,H=c)):(m=H,H=c)):(m=H,H=c),H===c&&(H=m,S=Aa(),S!==c?(ka(),N=Ja(),N!==c?(ka(),N=qa(),N!==c?(ka(),da=Ka(),da!==c?(oa=H,H={type:"interval-period",period:"second",precision:N,secondary:null}):(m=H,H=c)):(m=H,H=c)):(m=H,H=c)):(m=H,H=c),H===c&&(H=m,S=Aa(),S!==c&&(oa=H,S={type:"interval-period",period:"second",precision:null,secondary:null}),H=S)))));return H}function na(){var H=m;var N=Ca();N!==c&&(oa=H,N={type:"string",value:"day"});H=N;H===c&&(H=m,N=xa(),N!==c&&(oa=H,N={type:"string",value:"hour"}),
H=N,H===c&&(H=m,N=Ba(),N!==c&&(oa=H,N={type:"string",value:"minute"}),H=N,H===c&&(H=m,N=sa(),N!==c&&(oa=H,N={type:"string",value:"month"}),H=N,H===c&&(H=m,N=pa(),N!==c&&(oa=H,N={type:"string",value:"year"}),H=N))));return H}function qa(){var H=m;var N=l();N!==c&&(oa=H,N=parseFloat(N));return N}function va(){var H=m;var N=l();N!==c&&(oa=H,N=parseFloat(N));return N}function ta(){var H=wa();H===c&&(H=Y());return H}function wa(){var H=m;if(39===e.charCodeAt(m)){var N=Ed;m++}else N=c,0===ha&&b(Fd);N===
c&&(e.substr(m,2)===Gd?(N=Gd,m+=2):(N=c,0===ha&&b(Qf)));if(N!==c){N=[];var S=m;if(e.substr(m,2)===xc){var da=xc;m+=2}else da=c,0===ha&&b(Hd);da!==c&&(oa=S,da="'");S=da;S===c&&(Id.test(e.charAt(m))?(S=e.charAt(m),m++):(S=c,0===ha&&b(Jd)));for(;S!==c;)N.push(S),S=m,e.substr(m,2)===xc?(da=xc,m+=2):(da=c,0===ha&&b(Hd)),da!==c&&(oa=S,da="'"),S=da,S===c&&(Id.test(e.charAt(m))?(S=e.charAt(m),m++):(S=c,0===ha&&b(Jd)));39===e.charCodeAt(m)?(S=Ed,m++):(S=c,0===ha&&b(Fd));S!==c?(oa=H,H={type:"string",value:N.join("")}):
(m=H,H=c)}else m=H,H=c;return H}function Ea(){var H=m;if(Qa()!==c){ka();var N=D();if(N!==c){ka();var S=Ya();S!==c?(ka(),S=D(),S!==c?(oa=H,H={type:"when-clause",operand:N,value:S}):(m=H,H=c)):(m=H,H=c)}else m=H,H=c}else m=H,H=c;return H}function Da(){var H=m;if(Qa()!==c){ka();var N=D();if(N!==c){ka();var S=Ya();S!==c?(ka(),S=D(),S!==c?(oa=H,H={type:"when-clause",operand:N,value:S}):(m=H,H=c)):(m=H,H=c)}else m=H,H=c}else m=H,H=c;return H}function Pa(){var H=m;var N=m;if(e.substr(m,4).toLowerCase()===
Rf){var S=e.substr(m,4);m+=4}else S=c,0===ha&&b(Sf);if(S!==c){S=m;ha++;var da=w();ha--;da===c?S=void 0:(m=S,S=c);S!==c?(oa=N,N="ELSE"):(m=N,N=c)}else m=N,N=c;N!==c?(ka(),N=D(),N!==c?(oa=H,H={type:"else-clause",value:N}):(m=H,H=c)):(m=H,H=c);return H}function Sa(){var H=l();if(H===c){H=m;if(45===e.charCodeAt(m)){var N=Bc;m++}else N=c,0===ha&&b(Cc);N===c&&(43===e.charCodeAt(m)?(N=zc,m++):(N=c,0===ha&&b(Ac)));if(N!==c){var S=l();S!==c?(oa=H,H=N[0]+S):(m=H,H=c)}else m=H,H=c}return H}function Ta(){var H=
m;if(46===e.charCodeAt(m)){var N=Tf;m++}else N=c,0===ha&&b(Uf);N!==c?(N=l(),N===c&&(N=null),oa=H,H="."+(null!=N?N:"")):(m=H,H=c);return H}function Oa(){var H;var N=H=m;if(Vf.test(e.charAt(m))){var S=e.charAt(m);m++}else S=c,0===ha&&b(Wf);S!==c?(Xf.test(e.charAt(m))?(S=e.charAt(m),m++):(S=c,0===ha&&b(Yf)),S===c&&(S=null),oa=N,N="e"+(null===S?"":S)):(m=N,N=c);N!==c?(S=l(),S!==c?(oa=H,H=N+S):(m=H,H=c)):(m=H,H=c);return H}function l(){var H=m;var N=[];var S=F();if(S!==c)for(;S!==c;)N.push(S),S=F();else N=
c;N!==c&&(oa=H,N=N.join(""));return N}function F(){if(Zf.test(e.charAt(m))){var H=e.charAt(m);m++}else H=c,0===ha&&b($f);return H}function X(){var H=m;if(e.substr(m,2).toLowerCase()===ag){var N=e.substr(m,2);m+=2}else N=c,0===ha&&b(bg);if(N!==c){N=m;ha++;var S=w();ha--;S===c?N=void 0:(m=N,N=c);N!==c?(oa=H,H="IN"):(m=H,H=c)}else m=H,H=c;return H}function ba(){var H=m;if(e.substr(m,2).toLowerCase()===cg){var N=e.substr(m,2);m+=2}else N=c,0===ha&&b(dg);if(N!==c){N=m;ha++;var S=w();ha--;S===c?N=void 0:
(m=N,N=c);N!==c?(oa=H,H="IS"):(m=H,H=c)}else m=H,H=c;return H}function ja(){var H=m;if(e.substr(m,4).toLowerCase()===eg){var N=e.substr(m,4);m+=4}else N=c,0===ha&&b(fg);if(N!==c){N=m;ha++;var S=w();ha--;S===c?N=void 0:(m=N,N=c);N!==c?(oa=H,H="LIKE"):(m=H,H=c)}else m=H,H=c;return H}function B(){var H=m;if(e.substr(m,3).toLowerCase()===gg){var N=e.substr(m,3);m+=3}else N=c,0===ha&&b(hg);if(N!==c){N=m;ha++;var S=w();ha--;S===c?N=void 0:(m=N,N=c);N!==c?(oa=H,H="NOT"):(m=H,H=c)}else m=H,H=c;return H}function K(){var H=
m;if(e.substr(m,3).toLowerCase()===ig){var N=e.substr(m,3);m+=3}else N=c,0===ha&&b(jg);if(N!==c){N=m;ha++;var S=w();ha--;S===c?N=void 0:(m=N,N=c);N!==c?(oa=H,H="AND"):(m=H,H=c)}else m=H,H=c;return H}function L(){var H=m;if(e.substr(m,2).toLowerCase()===kg){var N=e.substr(m,2);m+=2}else N=c,0===ha&&b(lg);if(N!==c){N=m;ha++;var S=w();ha--;S===c?N=void 0:(m=N,N=c);N!==c?(oa=H,H="OR"):(m=H,H=c)}else m=H,H=c;return H}function V(){var H=m;if(e.substr(m,7).toLowerCase()===mg){var N=e.substr(m,7);m+=7}else N=
c,0===ha&&b(ng);if(N!==c){N=m;ha++;var S=w();ha--;S===c?N=void 0:(m=N,N=c);N!==c?(oa=H,H="BETWEEN"):(m=H,H=c)}else m=H,H=c;return H}function aa(){var H=m;if(e.substr(m,4).toLowerCase()===og){var N=e.substr(m,4);m+=4}else N=c,0===ha&&b(pg);if(N!==c){N=m;ha++;var S=w();ha--;S===c?N=void 0:(m=N,N=c);N!==c?(oa=H,H="FROM"):(m=H,H=c)}else m=H,H=c;return H}function ca(){var H=m;if(e.substr(m,4).toLowerCase()===qg){var N=e.substr(m,4);m+=4}else N=c,0===ha&&b(rg);if(N!==c){N=m;ha++;var S=w();ha--;S===c?N=
void 0:(m=N,N=c);N!==c?(oa=H,H="TRIM"):(m=H,H=c)}else m=H,H=c;return H}function fa(){var H=m;if(e.substr(m,9).toLowerCase()===sg){var N=e.substr(m,9);m+=9}else N=c,0===ha&&b(tg);if(N!==c){N=m;ha++;var S=w();ha--;S===c?N=void 0:(m=N,N=c);N!==c?(oa=H,H="TIMESTAMP"):(m=H,H=c)}else m=H,H=c;return H}function la(){var H=m;if(e.substr(m,4).toLowerCase()===ug){var N=e.substr(m,4);m+=4}else N=c,0===ha&&b(vg);if(N!==c){N=m;ha++;var S=w();ha--;S===c?N=void 0:(m=N,N=c);N!==c?(oa=H,H="DATE"):(m=H,H=c)}else m=
H,H=c;return H}function ma(){var H=m;if(e.substr(m,4).toLowerCase()===wg){var N=e.substr(m,4);m+=4}else N=c,0===ha&&b(xg);if(N!==c){N=m;ha++;var S=w();ha--;S===c?N=void 0:(m=N,N=c);N!==c?(oa=H,H="TIME"):(m=H,H=c)}else m=H,H=c;return H}function ua(){var H=m;if(e.substr(m,8).toLowerCase()===yg){var N=e.substr(m,8);m+=8}else N=c,0===ha&&b(zg);if(N!==c){N=m;ha++;var S=w();ha--;S===c?N=void 0:(m=N,N=c);N!==c?(oa=H,H="INTERVAL"):(m=H,H=c)}else m=H,H=c;return H}function pa(){var H=m;if(e.substr(m,4).toLowerCase()===
Ag){var N=e.substr(m,4);m+=4}else N=c,0===ha&&b(Bg);if(N!==c){N=m;ha++;var S=w();ha--;S===c?N=void 0:(m=N,N=c);N!==c?(oa=H,H="YEAR"):(m=H,H=c)}else m=H,H=c;return H}function sa(){var H=m;if(e.substr(m,5).toLowerCase()===Cg){var N=e.substr(m,5);m+=5}else N=c,0===ha&&b(Dg);if(N!==c){N=m;ha++;var S=w();ha--;S===c?N=void 0:(m=N,N=c);N!==c?(oa=H,H="MONTH"):(m=H,H=c)}else m=H,H=c;return H}function Ca(){var H=m;if(e.substr(m,3).toLowerCase()===Eg){var N=e.substr(m,3);m+=3}else N=c,0===ha&&b(Fg);if(N!==c){N=
m;ha++;var S=w();ha--;S===c?N=void 0:(m=N,N=c);N!==c?(oa=H,H="DAY"):(m=H,H=c)}else m=H,H=c;return H}function xa(){var H=m;if(e.substr(m,4).toLowerCase()===Gg){var N=e.substr(m,4);m+=4}else N=c,0===ha&&b(Hg);if(N!==c){N=m;ha++;var S=w();ha--;S===c?N=void 0:(m=N,N=c);N!==c?(oa=H,H="HOUR"):(m=H,H=c)}else m=H,H=c;return H}function Ba(){var H=m;if(e.substr(m,6).toLowerCase()===Ig){var N=e.substr(m,6);m+=6}else N=c,0===ha&&b(Jg);if(N!==c){N=m;ha++;var S=w();ha--;S===c?N=void 0:(m=N,N=c);N!==c?(oa=H,H="MINUTE"):
(m=H,H=c)}else m=H,H=c;return H}function Aa(){var H=m;if(e.substr(m,6).toLowerCase()===Kg){var N=e.substr(m,6);m+=6}else N=c,0===ha&&b(Lg);if(N!==c){N=m;ha++;var S=w();ha--;S===c?N=void 0:(m=N,N=c);N!==c?(oa=H,H="SECOND"):(m=H,H=c)}else m=H,H=c;return H}function ya(){var H=m;if(e.substr(m,4).toLowerCase()===Mg){var N=e.substr(m,4);m+=4}else N=c,0===ha&&b(Ng);if(N!==c){N=m;ha++;var S=w();ha--;S===c?N=void 0:(m=N,N=c);N!==c?(oa=H,H="CASE"):(m=H,H=c)}else m=H,H=c;return H}function Ia(){var H=m;if(e.substr(m,
3).toLowerCase()===Og){var N=e.substr(m,3);m+=3}else N=c,0===ha&&b(Pg);if(N!==c){N=m;ha++;var S=w();ha--;S===c?N=void 0:(m=N,N=c);N!==c?(oa=H,H="END"):(m=H,H=c)}else m=H,H=c;return H}function Qa(){var H=m;if(e.substr(m,4).toLowerCase()===Qg){var N=e.substr(m,4);m+=4}else N=c,0===ha&&b(Rg);if(N!==c){N=m;ha++;var S=w();ha--;S===c?N=void 0:(m=N,N=c);N!==c?(oa=H,H="WHEN"):(m=H,H=c)}else m=H,H=c;return H}function Ya(){var H=m;if(e.substr(m,4).toLowerCase()===Sg){var N=e.substr(m,4);m+=4}else N=c,0===ha&&
b(Tg);if(N!==c){N=m;ha++;var S=w();ha--;S===c?N=void 0:(m=N,N=c);N!==c?(oa=H,H="THEN"):(m=H,H=c)}else m=H,H=c;return H}function Wa(){if(44===e.charCodeAt(m)){var H=Ug;m++}else H=c,0===ha&&b(Vg);return H}function Ja(){if(40===e.charCodeAt(m)){var H=Wg;m++}else H=c,0===ha&&b(Xg);return H}function Ka(){if(41===e.charCodeAt(m)){var H=Yg;m++}else H=c,0===ha&&b(Zg);return H}function ka(){var H;var N=[];for(H=Ra();H!==c;)N.push(H),H=Ra();return N}function Ra(){if($g.test(e.charAt(m))){var H=e.charAt(m);
m++}else H=c,0===ha&&b(ah);return H}function Mb(H,N,S,da){H={type:"binary-expression",operator:H,left:N,right:S};void 0!==da&&(H.escape=da);return H}function nb(H,N){for(var S=0;S<N.length;S++)H=Mb(N[S][1],H,N[S][3]);return H}v=void 0!==v?v:{};var c={},Md=v.grammarSource,Kd={start:t},Ld=t,Nd="!",Rc="\x3d",Tc="\x3e\x3d",Sd="\x3e",Uc="\x3c\x3d",Vc="\x3c\x3e",Wd="\x3c",Wc="!\x3d",zc="+",Bc="-",Xc="||",$d="*",be="/",Gf="@",Ed="'",Gd="N'",xc="''",Tf=".",ke="null",de="true",ge="false",ag="in",cg="is",eg=
"like",Pd="escape",gg="not",ig="and",kg="or",mg="between",og="from",Ee="for",ze="substring",ne="extract",qg="trim",Ke="position",sg="timestamp",ug="date",wg="time",If="leading",Kf="trailing",Mf="both",Qe="cast",Ue="as",Ye="integer",af="smallint",df="float",gf="real",kf="varchar",Of="to",yg="interval",Ag="year",re="timezone_hour",ue="timezone_minute",Cg="month",Eg="day",Gg="hour",Ig="minute",Kg="second",Mg="case",Og="end",Qg="when",Sg="then",Rf="else",Ug=",",Wg="(",Yg=")",ud="`",Af=/^[A-Za-z_\x80-\uFFFF]/,
Cf=/^[A-Za-z0-9_]/,Cd=/^[A-Za-z0-9_.\x80-\uFFFF]/,Ef=/^["]/,Id=/^[^']/,Zf=/^[0-9]/,Vf=/^[eE]/,Xf=/^[+\-]/,$g=/^[ \t\n\r]/,wd=/^[^`]/,Od=E("!",!1),Sc=E("\x3d",!1),Rd=E("\x3e\x3d",!1),Td=E("\x3e",!1),Ud=E("\x3c\x3d",!1),Vd=E("\x3c\x3e",!1),Xd=E("\x3c",!1),Yd=E("!\x3d",!1),Ac=E("+",!1),Cc=E("-",!1),Zd=E("||",!1),ae=E("*",!1),ce=E("/",!1),Bf=J([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),Df=J([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),Dd=J([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],
!1,!1),Ff=J(['"'],!1,!1),Hf=E("@",!1),Fd=E("'",!1),Qf=E("N'",!1),Hd=E("''",!1),Jd=J(["'"],!0,!1),Uf=E(".",!1),$f=J([["0","9"]],!1,!1),Wf=J(["e","E"],!1,!1),Yf=J(["+","-"],!1,!1),le=E("NULL",!0),ee=E("TRUE",!0),he=E("FALSE",!0),bg=E("IN",!0),dg=E("IS",!0),fg=E("LIKE",!0),Qd=E("ESCAPE",!0),hg=E("NOT",!0),jg=E("AND",!0),lg=E("OR",!0),ng=E("BETWEEN",!0),pg=E("FROM",!0),Fe=E("FOR",!0),Ae=E("SUBSTRING",!0),oe=E("EXTRACT",!0),rg=E("TRIM",!0),Le=E("POSITION",!0),tg=E("TIMESTAMP",!0),vg=E("DATE",!0),xg=E("TIME",
!0),Jf=E("LEADING",!0),Lf=E("TRAILING",!0),Nf=E("BOTH",!0),Re=E("CAST",!0),Ve=E("AS",!0),Ze=E("INTEGER",!0),bf=E("SMALLINT",!0),ef=E("FLOAT",!0),hf=E("REAL",!0),lf=E("VARCHAR",!0),Pf=E("TO",!0),zg=E("INTERVAL",!0),Bg=E("YEAR",!0),se=E("TIMEZONE_HOUR",!0),ve=E("TIMEZONE_MINUTE",!0),Dg=E("MONTH",!0),Fg=E("DAY",!0),Hg=E("HOUR",!0),Jg=E("MINUTE",!0),Lg=E("SECOND",!0),Ng=E("CASE",!0),Pg=E("END",!0),Rg=E("WHEN",!0),Tg=E("THEN",!0),Sf=E("ELSE",!0),Vg=E(",",!1),Xg=E("(",!1),Zg=E(")",!1),ah=J([" ","\t","\n",
"\r"],!1,!1),vd=E("`",!1),xd=J(["`"],!0,!1),m=0,oa=0,Yb=[{line:1,column:1}],eb=0,yc=[],ha=0;if("startRule"in v){if(!(v.startRule in Kd))throw Error("Can't start parsing from rule \""+v.startRule+'".');Ld=Kd[v.startRule]}var Qc=Ld();if(Qc!==c&&m===e.length)return Qc;Qc!==c&&m<e.length&&b({type:"end"});throw function(H,N,S){return new f(f.buildMessage(H,N),H,N,S)}(yc,eb<e.length?e.charAt(eb):null,eb<e.length?q(eb,eb+1):q(eb,eb));}}})})(y);var x=y.exports;class G{static parse(A){return x.parse(A)}}d.WhereGrammar=
G;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/fieldType":function(){define(["exports","../../core/jsonMap"],function(d,g){g=new g.JSONMap({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",
esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"});d.kebabDict=g;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngineCapabilities":function(){define(["exports"],function(d){d.queryCapabilities={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,
centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByAnonymous:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,
supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports ../../../core/lang ../../../geometry/support/centroid ../../../geometry/support/extentUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ./AttributesBuilder ./geometryUtils ./projectionSupport ./SnappingCandidate ../../support/fieldUtils ../../../statistics/utils".split(" "),
function(d,g,y,x,G,A,f,p,e,v,z,E,J){function r(n,D,Q,a){const C=a.x-Q.x;a=a.y-Q.y;D=Math.min(1,Math.max(0,((D.x-Q.x)*C+(D.y-Q.y)*a)/(C*C+a*a)));n.x=Q.x+C*D;n.y=Q.y+a*D}function q(n,D){return n?D?4:3:D?3:2}class b{constructor(n,D,Q){this.items=n;this.query=D;this.geometryType=Q.geometryType;this.hasM=Q.hasM;this.hasZ=Q.hasZ;this.fieldsIndex=Q.fieldsIndex;this.objectIdField=Q.objectIdField;this.spatialReference=Q.spatialReference;this.featureAdapter=Q.featureAdapter}get size(){return this.items.length}createQueryResponseForCount(){const n=
new p(this.query,this.featureAdapter,this.fieldsIndex);if(!this.query.outStatistics)return n.countDistinctValues(this.items);const {groupByFieldsForStatistics:D,having:Q,outStatistics:a}=this.query;if(!D?.length)return 1;const C=new Map,P=new Map,R=new Set;for(const U of a){var {statisticType:Z}=U;Z="exceedslimit"!==Z?U.onStatisticField:void 0;if(!P.has(Z)){var W=[];for(const u of D){const I=this._getAttributeValues(n,u,C);W.push(I)}P.set(Z,this._calculateUniqueValues(W,n.returnDistinctValues))}Z=
P.get(Z);for(const u in Z){const {data:I,items:k}=Z[u];W=I.join(",");Q&&!n.validateItems(k,Q)||R.add(W)}}return R.size}async createQueryResponse(){let n;n=this.query.outStatistics?this.query.outStatistics.some(D=>"exceedslimit"===D.statisticType)?this._createExceedsLimitQueryResponse(this.query):await this._createStatisticsQueryResponse(this.query):this._createFeatureQueryResponse(this.query);if(this.query.returnQueryGeometry){const D=this.query.geometry;f.isValid(this.query.outSR)&&!f.equals(D.spatialReference,
this.query.outSR)?n.queryGeometry=e.cleanFromGeometryEngine({spatialReference:this.query.outSR,...v.project(D,D.spatialReference,this.query.outSR)}):n.queryGeometry=e.cleanFromGeometryEngine({spatialReference:this.query.outSR,...D})}return n}createSnappingResponse(n,D){const Q=this.featureAdapter,a=q(this.hasZ,this.hasM),{point:C,mode:P}=n,R="number"===typeof n.distance?n.distance:n.distance.x,Z="number"===typeof n.distance?n.distance:n.distance.y,W={candidates:[]},U="esriGeometryPolygon"===this.geometryType;
D=this._getPointCreator(P,this.spatialReference,D);const u=new t(null,0),I=new t(null,0),k={x:0,y:0,z:0};for(const ea of this.items){var h=Q.getGeometry(ea);if(null==h)continue;const {coords:ia,lengths:na}=h;u.coords=ia;I.coords=ia;if(n.returnEdge){h=0;for(var w=0;w<na.length;w++){var O=na[w];for(var M=0;M<O;M++,h+=a){var T=u;T.coordsIndex=h;if(M!==O-1){const qa=I;qa.coordsIndex=h+a;const va=k;r(k,C,T,qa);var Y=(C.x-va.x)/R;const ta=(C.y-va.y)/Z;Y=Y*Y+ta*ta;1>=Y&&W.candidates.push(z.makeEdgeCandidate(Q.getObjectId(ea),
D(va),Math.sqrt(Y),D(T),D(qa)))}}}}if("none"!==n.vertexMode)if(h=U?ia.length-a:ia.length,"all"===n.vertexMode)for(w=0;w<h;w+=a)O=u,O.coordsIndex=w,M=(C.x-O.x)/R,T=(C.y-O.y)/Z,M=M*M+T*T,1>=M&&W.candidates.push(z.makeVertexCandidate(Q.getObjectId(ea),D(O),Math.sqrt(M)));else if("ends"===n.vertexMode){h=[0];U||h.push(ia.length-a);for(const qa of h)h=u,h.coordsIndex=qa,w=(C.x-h.x)/R,O=(C.y-h.y)/Z,w=w*w+O*O,1>=w&&W.candidates.push(z.makeVertexCandidate(Q.getObjectId(ea),D(h),Math.sqrt(w)))}}W.candidates.sort((ea,
ia)=>ea.distance-ia.distance);return W}_getPointCreator(n,D,Q){const a=null==Q||f.equals(D,Q)?P=>P:P=>v.project(P,D,Q),{hasZ:C}=this;return"3d"===n?C?({x:P,y:R,z:Z})=>a({x:P,y:R,z:Z}):({x:P,y:R})=>a({x:P,y:R,z:0}):({x:P,y:R})=>a({x:P,y:R})}async createSummaryStatisticsResponse(n){const {field:D,valueExpression:Q,normalizationField:a,normalizationType:C,normalizationTotal:P,minValue:R,maxValue:Z,scale:W,timeZone:U}=n;var u=this.fieldsIndex.get(D);n=E.isDateField(u)||E.isDateOnlyField(u)||E.isTimestampOffsetField(u);
const I=await this._getDataValues({field:D,valueExpression:Q,normalizationField:a,normalizationType:C,normalizationTotal:P,scale:W,timeZone:U}),k=J.isNullCountSupported({normalizationType:C,normalizationField:a,minValue:R,maxValue:Z}),h={value:.5,fieldType:u?.type};u=E.isStringField(u)?J.calculateStringStatistics({values:I,supportsNullCount:k,percentileParams:h}):J.calculateStatistics({values:I,minValue:R,maxValue:Z,useSampleStdDev:!C,supportsNullCount:k,percentileParams:h});return J.processSummaryStatisticsResult(u,
n)}async createUniqueValuesResponse(n){const {field:D,valueExpression:Q,domains:a,returnAllCodedValues:C,scale:P,timeZone:R}=n;var Z=await this._getDataValues({field:D,field2:n.field2,field3:n.field3,fieldDelimiter:n.fieldDelimiter,valueExpression:Q,scale:P,timeZone:R},!1);Z=J.calculateUniqueValuesCount(Z);return J.createUVResult(Z,a,C,n.fieldDelimiter)}async createClassBreaksResponse(n){const {field:D,valueExpression:Q,normalizationField:a,normalizationType:C,normalizationTotal:P,classificationMethod:R,
standardDeviationInterval:Z,minValue:W,maxValue:U,numClasses:u,scale:I,timeZone:k}=n;n=await this._getDataValues({field:D,valueExpression:Q,normalizationField:a,normalizationType:C,normalizationTotal:P,scale:I,timeZone:k});n=J.calculateClassBreaks(n,{field:D,normalizationField:a,normalizationType:C,normalizationTotal:P,classificationMethod:R,standardDeviationInterval:Z,minValue:W,maxValue:U,numClasses:u});return J.resolveCBResult(n,R)}async createHistogramResponse(n){const {field:D,valueExpression:Q,
normalizationField:a,normalizationType:C,normalizationTotal:P,classificationMethod:R,standardDeviationInterval:Z,minValue:W,maxValue:U,numBins:u,scale:I,timeZone:k}=n;n=await this._getDataValues({field:D,valueExpression:Q,normalizationField:a,normalizationType:C,normalizationTotal:P,scale:I,timeZone:k});return J.calculateHistogram(n,{field:D,normalizationField:a,normalizationType:C,normalizationTotal:P,classificationMethod:R,standardDeviationInterval:Z,minValue:W,maxValue:U,numBins:u})}_sortFeatures(n,
D,Q){if(1<n.length&&D?.length)for(const a of D.reverse()){D=a.split(" ");const C=D[0],P=this.fieldsIndex.get(C);D=D[1]?"desc"===D[1].toLowerCase():!1;const R=J.getAttributeComparator(P?.type,D);n.sort((Z,W)=>{Z=Q(Z,C,P);W=Q(W,C,P);return R(Z,W)})}}_createFeatureQueryResponse(n){const D=this.items,{geometryType:Q,hasM:a,hasZ:C,objectIdField:P,spatialReference:R}=this,{outFields:Z,outSR:W,quantizationParameters:U,resultRecordCount:u,resultOffset:I,returnZ:k,returnM:h}=n,w=null!=u?D.length>(I||0)+u:
!1,O=Z&&(Z.includes("*")?[...this.fieldsIndex.fields]:Z.map(M=>this.fieldsIndex.get(M)));return{exceededTransferLimit:w,features:this._createFeatures(n,D),fields:O,geometryType:Q,hasM:a&&h,hasZ:C&&k,objectIdFieldName:P,spatialReference:e.cleanFromGeometryEngine(W||R),transform:U&&A.toQuantizationTransform(U)||null}}_createFeatures(n,D){const Q=new p(n,this.featureAdapter,this.fieldsIndex),{hasM:a,hasZ:C}=this,{orderByFields:P,quantizationParameters:R,returnGeometry:Z,returnCentroid:W,maxAllowableOffset:U,
resultOffset:u,resultRecordCount:I,returnZ:k=!1,returnM:h=!1}=n,w=C&&k,O=a&&h;n=[];var M=0;const T=[...D];this._sortFeatures(T,P,(qa,va,ta)=>Q.getFieldValue(qa,va,ta));if(this.geometryType&&(Z||W)){var Y=A.toQuantizationTransform(R)??void 0;D="esriGeometryPolygon"===this.geometryType||"esriGeometryPolyline"===this.geometryType;if(Z&&!W)for(var ea of T){var ia=this.featureAdapter.getGeometry(ea),na={attributes:Q.getAttributes(ea),geometry:e.getGeometry(this.geometryType,this.hasZ,this.hasM,ia,U,Y,
w,O)};D&&ia&&!na.geometry&&(na.centroid=e.transformCentroid(this,this.featureAdapter.getCentroid(ea,this),Y));n[M++]=na}else if(!Z&&W)for(ia of T)n[M++]={attributes:Q.getAttributes(ia),centroid:e.transformCentroid(this,this.featureAdapter.getCentroid(ia,this),Y)};else for(na of T)n[M++]={attributes:Q.getAttributes(na),centroid:e.transformCentroid(this,this.featureAdapter.getCentroid(na,this),Y),geometry:e.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(na),U,Y,w,
O)}}else for(Y of T)(ea=Q.getAttributes(Y))&&(n[M++]={attributes:ea});M=u||0;null!=I&&(n=n.slice(M,Math.min(n.length,M+I)));return n}_createExceedsLimitQueryResponse(n){var D=!1;let Q=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY;D=Number.POSITIVE_INFINITY;for(const C of n.outStatistics??[])if("exceedslimit"===C.statisticType){Q=null!=C.maxPointCount?C.maxPointCount:Number.POSITIVE_INFINITY;a=null!=C.maxRecordCount?C.maxRecordCount:Number.POSITIVE_INFINITY;D=null!=C.maxVertexCount?C.maxVertexCount:
Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===this.geometryType)D=this.items.length>Q;else if(this.items.length>a)D=!0;else{n=q(this.hasZ,this.hasM);const C=this.featureAdapter;D=this.items.reduce((P,R)=>{R=C.getGeometry(R);return P+(null!=R&&R.coords.length||0)},0)/n>D}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(D)}}]}}async _createStatisticsQueryResponse(n){var D=
{attributes:{}};const Q=[],a=new Map,C=new Map,P=new Map,R=new Map,Z=new p(n,this.featureAdapter,this.fieldsIndex);var W=n.outStatistics;const {groupByFieldsForStatistics:U,having:u,orderByFields:I,resultRecordCount:k}=n;n=U?.length;const h=!!n,w=h?U[0]:null,O=h&&!this.fieldsIndex.get(w);for(const ia of W??[]){const {outStatisticFieldName:na,statisticType:qa}=ia;W=ia;const va="exceedslimit"!==qa?ia.onStatisticField:void 0,ta="percentile_disc"===qa||"percentile_cont"===qa;var M="EnvelopeAggregate"===
qa||"CentroidAggregate"===qa||"ConvexHullAggregate"===qa;const wa=h&&1===n&&(va===w||O)&&"count"===qa;if(h){if(!P.has(va)){var T=[];for(const Ea of U){var Y=this._getAttributeValues(Z,Ea,a);T.push(Y)}P.set(va,this._calculateUniqueValues(T,M?!1:Z.returnDistinctValues))}T=P.get(va);if(!T)continue;Y=Object.keys(T);for(const Ea of Y){const {count:Da,data:Pa,items:Sa,itemPositions:Ta}=T[Ea];Y=Pa.join(",");if(!u||Z.validateItems(Sa,u)){const Oa=R.get(Y)||{attributes:{}};if(M){Oa.aggregateGeometries||(Oa.aggregateGeometries=
{});const {aggregateGeometries:F,outStatisticFieldName:X}=await this._getAggregateGeometry(W,Sa);Oa.aggregateGeometries[X]=F}else{var ea=null;if(wa)ea=Da;else{const F=this._getAttributeValues(Z,va,a);ea=Ta.map(X=>F[X]);ea=ta&&"statisticParameters"in W?this._getPercentileValue(W,ea):this._getStatisticValue(W,ea,null,Z.returnDistinctValues)}Oa.attributes[na]=ea}let l=0;U.forEach((F,X)=>Oa.attributes[this.fieldsIndex.get(F)?F:`EXPR_${++l}`]=Pa[X]);R.set(Y,Oa)}}}else if(M){D.aggregateGeometries||(D.aggregateGeometries=
{});const {aggregateGeometries:Ea,outStatisticFieldName:Da}=await this._getAggregateGeometry(W,this.items);D.aggregateGeometries[Da]=Ea}else M=this._getAttributeValues(Z,va,a),D.attributes[na]=ta&&"statisticParameters"in W?this._getPercentileValue(W,M):this._getStatisticValue(W,M,C,Z.returnDistinctValues);W="min"!==qa&&"max"!==qa||!E.isStringField(this.fieldsIndex.get(va))&&!this._isAnyDateField(va)?null:this.fieldsIndex.get(va)?.type;Q.push({name:na,alias:na,type:W||"esriFieldTypeDouble"})}D=h?Array.from(R.values()):
[D];this._sortFeatures(D,I,(ia,na)=>ia.attributes[na]);k&&(D.length=Math.min(k,D.length));return{fields:Q,features:D}}_isAnyDateField(n){n=this.fieldsIndex.get(n);return E.isDateField(n)||E.isDateOnlyField(n)||E.isTimestampOffsetField(n)||E.isTimeOnlyField(n)}async _getAggregateGeometry(n,D){const {convexHull:Q,union:a}=await new Promise((k,h)=>d(["../../../geometry/geometryEngineJSON"],k,h)),{statisticType:C,outStatisticFieldName:P}=n,{featureAdapter:R,spatialReference:Z,geometryType:W,hasZ:U,hasM:u}=
this;D=D.map(k=>e.getGeometry(W,U,u,R.getGeometry(k)));const I=Q(Z,D,!0)[0];n={aggregateGeometries:null,outStatisticFieldName:null};"EnvelopeAggregate"===C?(D=I?G.getPolygonExtent(I):G.getGeometryExtent(a(Z,D)),n.aggregateGeometries={...D,spatialReference:Z},n.outStatisticFieldName=P||"extent"):"CentroidAggregate"===C?(D=I?x.polygonCentroid(I):x.extentCentroid(G.getGeometryExtent(a(Z,D))),n.aggregateGeometries={x:D[0],y:D[1],spatialReference:Z},n.outStatisticFieldName=P||"centroid"):"ConvexHullAggregate"===
C&&(n.aggregateGeometries=I,n.outStatisticFieldName=P||"convexHull");return n}_getStatisticValue(n,D,Q,a){const {onStatisticField:C,statisticType:P}=n;n=null;n=Q?.has(C)?Q.get(C):E.isStringField(this.fieldsIndex.get(C))||this._isAnyDateField(C)?J.calculateStringStatistics({values:D,returnDistinct:a}):J.calculateStatistics({values:a?[...(new Set(D))]:D,minValue:null,maxValue:null,useSampleStdDev:!0});Q&&Q.set(C,n);return n["var"===P?"variance":P]}_getPercentileValue(n,D){const {onStatisticField:Q,
statisticParameters:a,statisticType:C}=n,{value:P,orderBy:R}=a;n=this.fieldsIndex.get(Q);return J.calculatePercentile(D,{value:P,orderBy:R,fieldType:n?.type,isDiscrete:"percentile_disc"===C})}_getAttributeValues(n,D,Q){if(Q.has(D))return Q.get(D);const a=this.fieldsIndex.get(D),C=this.items.map(P=>n.getFieldValue(P,D,a));Q.set(D,C);return C}_calculateUniqueValues(n,D){const Q={},a=this.items,C=a.length;for(let P=0;P<C;P++){const R=a[P],Z=[];for(const U of n)Z.push(U[P]);const W=Z.join(",");null==
Q[W]?Q[W]={count:1,data:Z,items:[R],itemPositions:[P]}:(D||Q[W].count++,Q[W].items.push(R),Q[W].itemPositions.push(P))}return Q}async _getDataValues(n,D=!0){const Q=new p(this.query,this.featureAdapter,this.fieldsIndex),{valueExpression:a,scale:C,timeZone:P}=n;return a?Q.getExpressionValues(this.items,a,{viewingMode:"map",scale:C,spatialReference:this.query.outSR||this.spatialReference},{geometryType:this.geometryType,hasZ:this.hasZ,hasM:this.hasM},P):Q.getDataValues(this.items,y.clone(n),D)}}class t{constructor(n,
D){this.coords=n;this.coordsIndex=D}get x(){return this.coords[this.coordsIndex]}get y(){return this.coords[this.coordsIndex+1]}get z(){return this.coords[this.coordsIndex+2]}}g.QueryEngineResult=b;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/quantizationUtils":function(){define(["exports","./jsonUtils"],function(d,g){function y(k){if("lowerLeft"===k.originPosition&&4===k.scale.length&&4===k.translate.length)return k;const {originPosition:h,scale:w,translate:O}=
k;k=w[1]??1;return{originPosition:"lowerLeft",scale:[w[0]??1,"lowerLeft"===h?k:-k,w[2]??1,w[3]??1],translate:[O[0]??0,O[1]??0,O[2]??0,O[3]??0]}}function x({scale:k,translate:h},w){return Math.round((w-h[0])/k[0])}function G({scale:k,translate:h},w){return Math.round((w-h[1])/k[1])}function A({scale:k,translate:h},w){return Math.round(((w??0)-h[2])/k[2])}function f({scale:k,translate:h},w){return w?Math.round((w-h[3])/k[3]):0}function p(k,h){return k&&h?Z:k&&!h?P:!k&&h?R:C}function e({scale:k,translate:h},
w){return w*k[0]+h[0]}function v({scale:k,translate:h},w){return w*k[1]+h[1]}function z({scale:k,translate:h},w){return(w??0)*k[2]+h[2]}function E({scale:k,translate:h},w){return w?w*k[3]+h[3]:0}function J(k,h){return k&&h?I:k&&!h?U:!k&&h?u:W}function r(k,h,w){const O=Array(w.length);for(let M=0;M<w.length;M++)O[M]=h(k,w[M]);return O}function q(k,h,w){let [O,M]=w[0],T=Math.min(O,h[0]),Y=Math.min(M,h[1]),ea=Math.max(O,h[2]);h=Math.max(M,h[3]);for(let ia=1;ia<w.length;ia++){const [na,qa]=w[ia];O+=na;
M+=qa;0>na&&(T=Math.min(T,O));0<na&&(ea=Math.max(ea,O));0>qa?Y=Math.min(Y,M):0<qa&&(h=Math.max(h,M))}k[0]=T;k[1]=Y;k[2]=ea;k[3]=h;return k}function b(k,h){if(!h.length)return null;k[0]=k[1]=Number.POSITIVE_INFINITY;k[2]=k[3]=Number.NEGATIVE_INFINITY;for(let w=0;w<h.length;w++)q(k,k,h[w]);return k}function t(k,h,w){k=y(k);h.xmin=x(k,w.xmin);h.ymin=G(k,w.ymin);h.xmax=x(k,w.xmax);h.ymax=G(k,w.ymax);w.hasZ&&(h.zmin=A(k,w.zmin),h.zmax=A(k,w.zmax));w.hasM&&(h.mmin=f(k,w.mmin),h.mmax=f(k,w.mmax));h.hasZ=
w.hasZ??!1;h.hasM=w.hasM??!1;return h}function n(k,h,w){k=y(k);h.points=p(w.hasZ,w.hasM)(k,w.points)??[];h.hasZ=w.hasZ??!1;h.hasM=w.hasM??!1;return h}function D(k,h,w){k=y(k);h.x=x(k,w.x);h.y=G(k,w.y);null!=w.z&&(h.z=A(k,w.z));null!=w.m&&(h.m=f(k,w.m));return h}function Q(k,h,w){{k=y(k);var O=w.rings;const M=[],T=p(w.hasZ,w.hasM);for(let Y=0;Y<O.length;Y++){const ea=T(k,O[Y]);ea&&3<=ea.length&&M.push(ea)}k=M.length?M:null}if(!k)return null;h.rings=k;h.hasZ=w.hasZ??!1;h.hasM=w.hasM??!1;return h}function a(k,
h,w){{k=y(k);var O=w.paths;const M=[],T=p(w.hasZ,w.hasM);for(let Y=0;Y<O.length;Y++){const ea=T(k,O[Y]);ea&&2<=ea.length&&M.push(ea)}k=M.length?M:null}if(!k)return null;h.paths=k;h.hasZ=w.hasZ??!1;h.hasM=w.hasM??!1;return h}const C=(k,h)=>{const w=[];if(!h.length)return null;var O=h[0];let M=x(k,O[0]);O=G(k,O[1]);w.push([M,O]);for(let T=1;T<h.length;T++){const [Y,ea]=h[T],ia=x(k,Y),na=G(k,ea);ia===M&&na===O||w.push([ia-M,na-O]);M=ia;O=na}return w},P=(k,h)=>{const w=[];if(!h.length)return null;var O=
h[0];let M=x(k,O[0]),T=G(k,O[1]);O=A(k,O[2]);w.push([M,T,O]);for(let Y=1;Y<h.length;Y++){const [ea,ia,na]=h[Y],qa=x(k,ea),va=G(k,ia),ta=A(k,na);qa===M&&va===T&&ta===O||w.push([qa-M,va-T,ta]);M=qa;T=va;O=ta}return w},R=(k,h)=>{const w=[];if(!h.length)return null;var O=h[0];let M=x(k,O[0]),T=G(k,O[1]);O=f(k,O[2]);w.push([M,T,O]);for(let Y=1;Y<h.length;Y++){const [ea,ia,na]=h[Y],qa=x(k,ea),va=G(k,ia),ta=f(k,na);qa===M&&va===T&&ta===O||w.push([qa-M,va-T,ta]);M=qa;T=va;O=ta}return w},Z=(k,h)=>{const w=
[];if(!h.length)return null;var O=h[0];let M=x(k,O[0]),T=G(k,O[1]),Y=A(k,O[2]);O=f(k,O[3]);w.push([M,T,Y,O]);for(let ea=1;ea<h.length;ea++){const [ia,na,qa,va]=h[ea],ta=x(k,ia),wa=G(k,na),Ea=A(k,qa),Da=f(k,va);ta===M&&wa===T&&Ea===Y&&Da===O||w.push([ta-M,wa-T,Ea,Da]);M=ta;T=wa;Y=Ea;O=Da}return w},W=(k,h)=>{const w=Array(h.length);if(!h.length)return w;var O=h[0];let M=e(k,O[0]);O=v(k,O[1]);w[0]=[M,O];const {scale:T,originPosition:Y}=k;k=T[0];const ea="lowerLeft"===Y?T[1]:-T[1];for(let ia=1;ia<h.length;ia++){const [na,
qa]=h[ia];M+=k*na;O+=ea*qa;w[ia]=[M,O]}return w},U=(k,h)=>{const w=Array(h.length);if(!h.length)return w;var O=h[0];let M=e(k,O[0]),T=v(k,O[1]);w[0]=[M,T,z(k,O[2])];const {scale:Y,originPosition:ea}=k;O=Y[0];const ia="lowerLeft"===ea?Y[1]:-Y[1];for(let na=1;na<h.length;na++){const [qa,va,ta]=h[na];M+=O*qa;T+=ia*va;w[na]=[M,T,z(k,ta)]}return w},u=(k,h)=>{const w=Array(h.length);if(!h.length)return w;var O=h[0];let M=e(k,O[0]),T=v(k,O[1]);w[0]=[M,T,E(k,O[2])];const {scale:Y,originPosition:ea}=k;O=Y[0];
const ia="lowerLeft"===ea?Y[1]:-Y[1];for(let na=1;na<h.length;na++){const [qa,va,ta]=h[na];M+=O*qa;T+=ia*va;w[na]=[M,T,E(k,ta)]}return w},I=(k,h)=>{const w=Array(h.length);if(!h.length)return w;var O=h[0];let M=e(k,O[0]),T=v(k,O[1]);w[0]=[M,T,z(k,O[2]),E(k,O[3])];const {scale:Y,originPosition:ea}=k;O=Y[0];const ia="lowerLeft"===ea?Y[1]:-Y[1];for(let na=1;na<h.length;na++){const [qa,va,ta,wa]=h[na];M+=O*qa;T+=ia*va;w[na]=[M,T,z(k,ta),E(k,wa)]}return w};d.getQuantizedBoundsCoordsArray=q;d.getQuantizedBoundsCoordsArrayArray=
b;d.getQuantizedBoundsPaths=function(k){return b([0,0,0,0],k)};d.getQuantizedBoundsPoints=function(k){const h=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return q(h,h,k)};d.getQuantizedBoundsRings=function(k){return b([0,0,0,0],k)};d.normalizeTransform=y;d.quantizeBounds=function(k,h,w){k=y(k);h[0]=x(k,w[0]);h[3]=G(k,w[1]);h[2]=x(k,w[2]);h[1]=G(k,w[3]);return h};d.quantizeCoordsArrayXY=C;d.quantizeCoordsArrayXYM=R;d.quantizeCoordsArrayXYZ=
P;d.quantizeCoordsArrayXYZM=Z;d.quantizeExtent=t;d.quantizeGeometry=function(k,h){return k&&h?g.isPoint(h)?D(k,{},h):g.isPolyline(h)?a(k,{},h):g.isPolygon(h)?Q(k,{},h):g.isMultipoint(h)?n(k,{},h):g.isExtent(h)?t(k,{},h):null:null};d.quantizeM=f;d.quantizeMultipoint=n;d.quantizePoint=D;d.quantizePolygon=Q;d.quantizePolyline=a;d.quantizeX=x;d.quantizeY=G;d.quantizeZ=A;d.toQuantizationTransform=function(k){return k?{originPosition:"upper-left"===k.originPosition?"upperLeft":"lower-left"===k.originPosition?
"lowerLeft":k.originPosition,scale:k.tolerance?[k.tolerance,k.tolerance,1,1]:[1,1,1,1],translate:null!=k.extent?[k.extent.xmin,k.extent.ymax,k.extent.zmin??0,k.extent.mmin??0]:[0,0,0,0]}:null};d.unquantizeBounds=function(k,h,w){k=y(k);return w?(h[0]=e(k,w[0]),h[1]=v(k,w[3]),h[2]=e(k,w[2]),h[3]=v(k,w[1]),h):[e(k,h[0]),v(k,h[3]),e(k,h[2]),v(k,h[1])]};d.unquantizeCoordsArrayArray=r;d.unquantizeCoordsArrayXY=W;d.unquantizeCoordsArrayXYM=u;d.unquantizeCoordsArrayXYZ=U;d.unquantizeCoordsArrayXYZM=I;d.unquantizeExtent=
function(k,h,w,O=w.hasZ??!1,M=w.hasM??!1){k=y(k);h.xmin=e(k,w.xmin);h.xmax=e(k,w.xmax);h.ymin=v(k,w.ymin);h.ymax=v(k,w.ymax);O&&(h.zmin=z(k,w.zmin),h.zmax=z(k,w.zmax));M&&(h.mmin=E(k,w.mmin),h.mmax=E(k,w.mmax));h.hasZ=O;h.hasM=M;return h};d.unquantizeM=E;d.unquantizeMultipoint=function(k,h,w,O=w?.hasZ??!1,M=w?.hasM??!1){null!=w&&(k=y(k),h.points=J(O,M)(k,w.points),h.hasZ=O,h.hasM=M);return h};d.unquantizePoint=function(k,h,w,O=null!=w?.z,M=null!=w?.m){if(null==w)return h;k=y(k);h.x=e(k,w.x);h.y=v(k,
w.y);O&&(h.z=z(k,w.z));M&&(h.m=E(k,w.m));return h};d.unquantizePolygon=function(k,h,w,O=w?.hasZ??!1,M=w?.hasM??!1){null!=w&&(k=y(k),h.rings=r(k,J(O,M),w.rings),h.hasZ=O,h.hasM=M);return h};d.unquantizePolyline=function(k,h,w,O=w?.hasZ??!1,M=w?.hasM??!1){null!=w&&(k=y(k),h.paths=r(k,J(O,M),w.paths),h.hasZ=O,h.hasM=M);return h};d.unquantizeX=e;d.unquantizeY=v;d.unquantizeZ=z;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/AttributesBuilder":function(){define("./attributeSupport ./geometryUtils ../../support/fieldUtils ../../../smartMapping/statistics/support/utils ../../../statistics/utils ../../../support/arcadeOnDemand".split(" "),
function(d,g,y,x,G,A){class f{constructor(p,e,v){this._fieldDataCache=new Map;this._returnDistinctMap=new Map;this.returnDistinctValues=p.returnDistinctValues??!1;this.fieldsIndex=v;this.featureAdapter=e;if((e=p.outFields)&&!e.includes("*")){this.outFields=e;p=0;for(const E of e){var z=d.getExpressionFromFieldName(E);z=(e=this.fieldsIndex.get(z))?null:d.getWhereClause(z,v);e=e?e.name:d.getAliasFromFieldName(E)||`FIELD_EXP_${p++}`;this._fieldDataCache.set(E,{alias:e,clause:z})}}}countDistinctValues(p){if(!this.returnDistinctValues)return p.length;
p.forEach(e=>this.getAttributes(e));return this._returnDistinctMap.size}getAttributes(p){p=this._processAttributesForOutFields(p);return this._processAttributesForDistinctValues(p)}getFieldValue(p,e,v){const z=v?v.name:e;let E=null;this._fieldDataCache.has(z)?E=this._fieldDataCache.get(z)?.clause:v||(E=d.getWhereClause(e,this.fieldsIndex),this._fieldDataCache.set(z,{alias:z,clause:E}));return v?this.featureAdapter.getAttribute(p,z):E?.calculateValue(p,this.featureAdapter)}getDataValues(p,e,v=!0){const z=
e.normalizationType,E=e.normalizationTotal,J=this.fieldsIndex.get(e.field),r=y.isDateOnlyField(J)||y.isTimestampOffsetField(J),q=y.isTimeOnlyField(J);return p.map(b=>{let t=e.field&&this.getFieldValue(b,e.field,this.fieldsIndex.get(e.field));e.field2?(t=`${G.processNullValue(t)}${e.fieldDelimiter}${G.processNullValue(this.getFieldValue(b,e.field2,this.fieldsIndex.get(e.field2)))}`,e.field3&&(t=`${t}${e.fieldDelimiter}${G.processNullValue(this.getFieldValue(b,e.field3,this.fieldsIndex.get(e.field3)))}`)):
"string"===typeof t&&v&&(r?t=t?(new Date(t)).getTime():null:q&&(t=t?x.timeOnlyToMilliseconds(t):null));z&&Number.isFinite(t)&&(b="field"===z&&e.normalizationField?this.getFieldValue(b,e.normalizationField,this.fieldsIndex.get(e.normalizationField)):null,t=G.getNormalizedValue(t,z,b,E));return t})}async getExpressionValues(p,e,v,z,E){const {arcadeUtils:J}=await A.loadArcade(),r=J.hasGeometryOperations(e);r&&await J.enableGeometryOperations();const q=J.createFunction(e),b=J.getViewInfo(v),t={fields:this.fieldsIndex.fields};
return p.map(n=>{n={attributes:this.featureAdapter.getAttributes(n),layer:t,geometry:r?{...g.getGeometry(z.geometryType,z.hasZ,z.hasM,this.featureAdapter.getGeometry(n)),spatialReference:v?.spatialReference}:null};n=J.createExecContext(n,b,E);return J.executeFunction(q,n)})}validateItem(p,e){this._fieldDataCache.has(e)||this._fieldDataCache.set(e,{alias:e,clause:d.getWhereClause(e,this.fieldsIndex)});return this._fieldDataCache.get(e)?.clause?.testFeature(p,this.featureAdapter)??!1}validateItems(p,
e){this._fieldDataCache.has(e)||this._fieldDataCache.set(e,{alias:e,clause:d.getWhereClause(e,this.fieldsIndex)});return this._fieldDataCache.get(e)?.clause?.testSet(p,this.featureAdapter)??!1}_processAttributesForOutFields(p){const e=this.outFields;if(!e?.length)return this.featureAdapter.getAttributes(p);const v={};for(const z of e){const {alias:E,clause:J}=this._fieldDataCache.get(z);v[E]=J?J.calculateValue(p,this.featureAdapter):this.featureAdapter.getAttribute(p,E)}return v}_processAttributesForDistinctValues(p){if(null==
p||!this.returnDistinctValues)return p;var e=this.outFields,v=[];if(e)for(const E of e){var {alias:z}=this._fieldDataCache.get(E);v.push(p[z])}else for(z in p)v.push(p[z]);e=`${(e||["*"]).join(",")}=${v.join(",")}`;v=this._returnDistinctMap.get(e)||0;this._returnDistinctMap.set(e,++v);return 1<v?null:p}}return f})},"esri/smartMapping/statistics/support/utils":function(){define("exports ../../../geometry ../../../core/Error ../../../core/screenUtils ../../../core/timeUtils ../../../geometry/SpatialReference ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ../../../layers/support/fieldUtils ../../../renderers/support/heatmapUtils ../../support/utils ../../../statistics/utils ../../../support/arcadeOnDemand ../../../geometry/Point".split(" "),
function(d,g,y,x,G,A,f,p,e,v,z,E,J,r){function q(a){a=Q.exec(a);if(!a)return null;const {hh:C,mm:P,ss:R,ms:Z}=a.groups;return Number(C)*G.millisecondsPerTimeUnit.hours+Number(P)*G.millisecondsPerTimeUnit.minutes+Number(R)*G.millisecondsPerTimeUnit.seconds+Number(Z||0)}function b(a,C){a=null!=a?a:"";null!=C&&C&&(a=a?"("+a+") AND ("+C+")":C);return a}function t(a){const C=a.layer;return a.fields.filter(P=>!C.getField(P))}function n(a){const C=a.layer;return a.fields.filter(P=>{P=C.getFieldUsageInfo(P);
return!P||!P.supportsStatistics})}let D=null;const Q=/^(?<hh>([0-1][0-9])|([2][0-3])):(?<mm>[0-5][0-9])(:(?<ss>[0-5][0-9]))?([.](?<ms>\d+))?$/;d.calculateHeatmapStats=function(a,C=18,P,R,Z){const W=new Float64Array(R*Z);C=Math.round(x.pt2px(C));let U=Number.POSITIVE_INFINITY,u=Number.NEGATIVE_INFINITY;P=v.createValueFunction(P);for(const {geometry:h,attributes:w}of a){const {x:O,y:M}=h;a=Math.max(0,O-C);var I=Math.max(0,M-C);const T=Math.min(Z,M+C),Y=Math.min(R,O+C),ea=+P(w);for(;I<T;I++)for(let ia=
a;ia<Y;ia++){var k=I*R+ia;const na=v.evaluateDensityKernel(ia-O,I-M,C)*ea;k=W[k]+=na;U=Math.min(U,k);u=Math.max(u,k)}}return{min:U,max:u}};d.getDataValues=async function(a,C,P=!0){if(!C)return[];const {field:R,field2:Z,field3:W,fieldDelimiter:U,fieldInfos:u,timeZone:I}=a;var k=R&&u?.find(va=>va.name.toLowerCase()===R.toLowerCase());const h=k?e.isTimeOnlyField(k):!1,w=k?z.isAnyDateField(k):!1,O=a.valueExpression,M=a.normalizationType,T=a.normalizationField,Y=a.normalizationTotal,ea=[];k=a.viewInfoParams;
let ia=null,na=null;if(O){if(!D){const {arcadeUtils:va}=await J.loadArcade();D=va}D.hasGeometryOperations(O)&&await D.enableGeometryOperations();ia=D.createFunction(O);na=k?D.getViewInfo({viewingMode:k.viewingMode,scale:k.scale,spatialReference:new A(k.spatialReference)}):null}a=a.fieldInfos;const qa=C[0]&&"declaredClass"in C[0]&&"esri.Graphic"===C[0].declaredClass||!a?null:{fields:a};C.forEach(va=>{var ta=va.attributes;if(O){var wa=D.createExecContext(qa?{...va,layer:qa}:va,na,I);wa=D.executeFunction(ia,
wa)}else ta&&(wa=ta[R],Z?(wa=`${E.processNullValue(wa)}${U}${E.processNullValue(ta[Z])}`,W&&(wa=`${wa}${U}${E.processNullValue(ta[W])}`)):"string"===typeof wa&&P&&(w?wa=wa?(new Date(wa)).getTime():null:h&&(wa=wa?q(wa):null)));M&&"number"===typeof wa&&isFinite(wa)&&(ta=ta&&parseFloat(ta[T]),wa=E.getNormalizedValue(wa,M,ta,Y));ea.push(wa)});return ea};d.getRangeExpr=function(a,C,P){C=null!=C?a+" \x3e\x3d "+C:"";a=null!=P?a+" \x3c\x3d "+P:"";P="";return(P=C&&a?b(C,a):C||a)?"("+P+")":""};d.getSQLFilterForNormalization=
function(a){const C=a.field,P=a.normalizationType;a=a.normalizationField;let R;if("field"===P)R="(NOT "+a+" \x3d 0)";else if("log"===P||"natural-log"===P||"square-root"===P)R=`(${C} > 0)`;return R};d.getSumOfAttributesExpr=function(a,C,P){const R=[],Z=[],W=[],U=[],u=[];a.forEach((h,w)=>{const O=h.field?"field":"expression",M=h.field||h.valueExpression;h.field?(u.push(M),Z.push(`var ${O}${w} = Number($feature["${M}"]);`)):(R.push(`function getValueForExpr${w}() {\n  ${M} \n}`),Z.push(`var ${O}${w} = Number(getValueForExpr${w}());`));
P||W.push(`${O}${w} = IIf(${O}${w} < 0, 0, ${O}${w});`);U.push(`${O}${w}`)});a="return sum;";const I=R.length?null:u.reduce((h,w)=>`${h} + ${w}`);let k=null;C||P?C?P||(a="return IIf(sum \x3e\x3d 0, sum, null);",I&&(k=`(( ${I} ) >= 0)`)):(a="return IIf(sum !\x3d 0, sum, null);",I&&(k=`(( ${I} ) <> 0)`)):(a="return IIf(sum \x3e 0, sum, null);",I&&(k=`(( ${I} ) > 0)`));return{valueExpression:[R.length?R.join("\n"):"",Z.join("\n"),W.join("\n"),`var sum = ${U.join(" + ")};`,a].filter(Boolean).join("\n\n"),
sqlExpression:I,sqlWhere:k}};d.mergeWhereClauses=b;d.quantizeFeatures=function(a,C,P,R){const Z=p.isWrappable(P)?p.getInfo(P):null,W=Z?Math.round((Z.valid[1]-Z.valid[0])/C.scale[0]):null;return a.map(U=>{const u=new r(U.geometry);f.quantizePoint(C,u,u);if(Z){var I=W??0,k=R[0];0>u.x?u.x+=I:u.x>k&&(u.x-=I)}U.geometry=u;return U})};d.timeOnlyToMilliseconds=q;d.verifyBasicFieldValidity=function(a,C,P){const R=t({layer:a,fields:C});if(R.length)return new y(P,"Unknown fields: "+R.join(", ")+". You can only use fields defined in the layer schema");
a=n({layer:a,fields:C});if(a.length)return new y(P,"Unsupported fields: "+a.join(", ")+". You can only use fields that can be fetched i.e. AdapterFieldUsageInfo.supportsStatistics must be true")};d.verifyFieldType=function(a,C,P,R){let Z;C?C.name!==a.objectIdField&&R.includes(C.type)||(Z=new y(P,"'field' should be one of these types: "+R.join(","))):Z=new y(P,"'field' is not defined in the layer schema");return Z};d.verifyFilterValidty=function(a,C){if(a&&"intersects"!==a.spatialRelationship)return new y(C,
"Only 'intersects' spatialRelationship is supported for featureFilter")};d.verifyNumericField=function(a,C,P){let R;C?C.name!==a.objectIdField&&e.isNumericField(C)||(R=new y(P,"'field' should be one of these numeric types: "+e.numericTypes.join(","))):R=new y(P,"'field' is not defined in the layer schema");return R};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/screenUtils":function(){define(["exports"],function(d){function g(x){return x?72*x/96:0}const y=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i;
d.castRenderScreenPointArray=function(x){return x};d.castRenderScreenPointArray3=function(x){return x};d.castScreenPointArray=function(x){return x};d.createRenderScreenPoint=function(x=0,G=0){return{x,y:G}};d.createRenderScreenPointArray=function(x=0,G=0){return[x,G]};d.createRenderScreenPointArray3=function(x=0,G=0,A=0){return[x,G,A]};d.createScreenPoint=function(x=0,G=0){return{x,y:G}};d.createScreenPointArray=function(x=0,G=0){return[x,G]};d.pt2px=function(x){return x?x/72*96:0};d.px2pt=g;d.screenPointArrayToObject=
function(x,G){return G?(G.x=x[0],G.y=x[1],G):{x:x[0],y:x[1]}};d.screenPointObjectToArray=function(x,G){return G?(G[0]=x.x,G[1]=x.y,2<G.length&&(G[2]=0),G):[x.x,x.y]};d.toPt=function(x){if("string"===typeof x){var G=x.match(y);if(G){var A=Number(G[1]);G=G[3]&&G[3].toLowerCase();x="-"===x.charAt(0);A="px"===G?g(A):A;return x?-A:A}console.warn("screenUtils.toPt: input not recognized!");return null}return x};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/timeUtils":function(){define(["exports",
"../intl/date","../time/timeZoneUtils","../chunks/datetime"],function(d,g,y,x){function G(p,e,v){return 0===p?0:p*f[e]/f[v]}function A(p){switch(p){case "milliseconds":return"millisecond";case "seconds":return"second";case "minutes":return"minute";case "hours":return"hour";case "days":return"day";case "weeks":return"week";case "months":return"month";case "years":return"year"}}const f={milliseconds:1,seconds:1E3,minutes:6E4,hours:36E5,days:864E5,weeks:6048E5,months:26784E5,years:31536E6,decades:31536E7,
centuries:31536E8};d.convertTime=G;d.isValidDate=function(p){return p instanceof Date&&!isNaN(p.getTime())};d.makeUTCTime=function(p,e,v="milliseconds"){e=new Date(G(e,v,"milliseconds"));e.setUTCFullYear(p.getUTCFullYear(),p.getUTCMonth(),p.getUTCDate());return e};d.mergeTimeExtents=function(p,e){return p&&e?p.intersection(e):p||e};d.millisecondsPerTimeUnit=f;d.offsetDate=function(p,e,v,z=y.system){z=new x.IANAZone(g.resolveTimeZone(z));p=x.DateTime.fromJSDate(p,{zone:z});z="decades"===v||"centuries"===
v?"year":A(v);"decades"===v&&(e*=10);"centuries"===v&&(e*=100);return p.plus({[z]:e}).toJSDate()};d.offsetDateUTC=function(p,e,v="milliseconds"){p=p.getTime();e=G(e,v,"milliseconds");return new Date(p+e)};d.resetUTCDate=function(p,e){p=new Date(p.getTime());p.setUTCFullYear(e.getFullYear(),e.getMonth(),e.getDate());return p};d.timeSinceUTCMidnight=function(p,e="milliseconds"){const v=G(p.getUTCHours(),"hours","milliseconds"),z=G(p.getUTCMinutes(),"minutes","milliseconds"),E=G(p.getUTCSeconds(),"seconds",
"milliseconds");p=p.getUTCMilliseconds();return G(v+z+E+p,"milliseconds",e)};d.truncateDate=function(p,e,v=y.system){v=new x.IANAZone(g.resolveTimeZone(v));p=x.DateTime.fromJSDate(p,{zone:v});if("decades"===e||"centuries"===e)return p=p.startOf("year"),{year:v}=p,p.set({year:v-v%("decades"===e?10:100)}).toJSDate();e=A(e);return p.startOf(e).toJSDate()};d.truncateLocalTime=function(p){const e=new Date(0);e.setHours(0);e.setMinutes(0);e.setSeconds(0);e.setMilliseconds(0);e.setFullYear(p.getUTCFullYear(),
p.getUTCMonth(),p.getUTCDate());return e};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/heatmapUtils":function(){define(["exports","../../core/mathUtils","../../core/screenUtils","../../chunks/vec42","../../core/libs/gl-matrix-2/factories/vec4f64"],function(d,g,y,x,G){function A(f,p,e,v){let {color:z,ratio:E}=p,{color:J,ratio:r}=e;r===E&&(1===r?E-=1E-6:r+=1E-6);p=g.clamp((v-E)/(r-E),0,1);x.lerp(f,z.toArray(),J.toArray(),p)}d.createValueFunction=function(f){return"function"===
typeof f?f:f?p=>+p[f]:()=>1};d.evaluateDensityKernel=function(f,p,e){f=Math.sqrt(f**2+p**2)/e;return 1<f?0:3/(Math.PI*e**2)*(1-f**2)**2};d.gaussianBlurRadiusPxToKernelDensityRadiusPt=function(f){return y.px2pt(2.4*f)};d.generateGradient=function(f){const p=new Uint8ClampedArray(2048);f=f.filter(({ratio:J})=>0<=J&&1>=J).sort((J,r)=>J.ratio-r.ratio).map(({color:J,ratio:r})=>({color:J,ratio:Math.max(r,.001)}));if(1>f.length)return p;let e=f[0],v=f[0],z=1;const E=G.create();for(let J=0;512>J;J++){const r=
(J+.5)/512;for(;r>v.ratio&&z<f.length;)e=v,v=f[z++];A(E,e,v,r);p.set(E,4*J)}return p};d.kernelDensityRadiusPtToGaussianBlurRadiusPx=function(f){return y.pt2px(f)/2.4};d.magicKernelDensityRadiusInflationFactor=2.4;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/smartMapping/support/utils":function(){define("exports ../../intl/date ../../layers/support/fieldUtils ../../support/arcadeOnDemand ../../support/basemapUtils ../../time/timeZoneUtils".split(" "),function(d,g,y,x,G,A){function f(r){return String(r).padStart(2,
"0")}function p(r,q,b){if("date"===q||"number"===q){"number"===q&&(r=new Date(r));q=b?r.getFullYear():r.getUTCFullYear();const t=f((b?r.getMonth():r.getUTCMonth())+1),n=f(b?r.getDate():r.getUTCDate()),D=f(b?r.getHours():r.getUTCHours()),Q=f(b?r.getMinutes():r.getUTCMinutes());r=f(b?r.getSeconds():r.getUTCSeconds());r=`TIMESTAMP'${q}-${t}-${n} ${D}:${Q}:${r}'`}return r}function e(r,q){if(q instanceof Date)return"date";if("number"===typeof q)return"number";if("string"===typeof q&&(r=r.getField(q),"\x3cnow\x3e"!==
q.toLowerCase()&&y.isDateField(r)))return"field"}const v={light:"streets gray topo terrain oceans osm gray-vector streets-vector topo-vector streets-relief-vector streets-navigation-vector topo-3d navigation-3d streets-3d osm-3d gray-3d arcgis-light-gray arcgis-navigation arcgis-streets arcgis-streets-relief arcgis-topographic arcgis-oceans osm-standard osm-standard-relief osm-streets osm-streets-relief osm-light-gray arcgis-terrain arcgis-charted-territory arcgis-community arcgis-colored-pencil arcgis-modern-antique arcgis-midcentury arcgis-newspaper arcgis-hillshade-light".split(" "),
dark:"satellite hybrid dark-gray dark-gray-vector streets-night-vector navigation-dark-3d streets-dark-3d dark-gray-3d arcgis-imagery arcgis-imagery-standard arcgis-dark-gray arcgis-navigation-night arcgis-streets-night osm-dark-gray arcgis-nova arcgis-hillshade-dark".split(" ")},z={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864E5},E=new Set(["integer","small-integer"]);let J=null;d.castIntegerFieldToFloat=function(r){return`cast(${r} as float)`};d.dateTypes=
["date","date-only","timestamp-offset"];d.defaultBasemapGroups=v;d.fieldDelimiter=",";d.formatAnyDate=function(r,q){const {format:b,timeZoneOptions:t,fieldType:n}=q??{};let D;t&&({timeZone:Q,timeZoneName:D}=A.getTimeZoneFormattingOptions(t.layerTimeZone,t.datesInUnknownTimezone,t.viewTimeZone,g.convertDateFormatToIntlOptions(b||"short-date-short-time"),n));if("string"===typeof r&&isNaN(Date.parse("time-only"===n?`1970-01-01T${r}Z`:r)))return r;switch(n){case "date-only":var Q=g.convertDateFormatToIntlOptions(b||
"short-date");return"string"===typeof r?g.formatDateOnly(r,{...Q}):g.formatDate(r,{...Q,timeZone:A.utc});case "time-only":return Q=g.convertDateFormatToIntlOptions(b||"short-time"),"string"===typeof r?g.formatTimeOnly(r,Q):g.formatDate(r,{...Q,timeZone:A.utc});case "timestamp-offset":if(!Q&&"string"===typeof r&&(new Date(r)).toISOString()!==r)return r;Q=(q=b||t?g.convertDateFormatToIntlOptions(b||"short-date-short-time"):void 0)?{...q,timeZone:Q,timeZoneName:D}:void 0;return"string"===typeof r?g.formatTimestamp(r,
Q):g.formatDate(r,Q);default:return q=b||t?g.convertDateFormatToIntlOptions(b||"short-date-short-time"):void 0,g.formatDate("string"===typeof r?new Date(r):r,q?{...q,timeZone:Q,timeZoneName:D}:void 0)}};d.getBasemapGroup=function(r,q=v){for(const b in q)if(q[b].includes(r))return b};d.getBasemapId=function(r,q,b=!0){let t=null;r&&("string"===typeof r?q.includes(r)&&(t=r):t=G.getWellKnownBasemapId(r));return b?t||"gray":t};d.getDateDiffSQL=function(r,q,b,t){const {hasQueryEngine:n}=r;b=p(b,e(r,b),
n);r=p(q,e(r,q),n);r=`(${b} - ${r})`;t=z[t];q="/";1>t&&(t=1/t,q="*");return{sqlExpression:1===t?r:`(${r} ${q} ${t})`,sqlWhere:null}};d.getDateType=e;d.getFieldsList=async function(r){const {field:q,field2:b,field3:t,normalizationField:n,valueExpression:D}=r;r=[];D&&(J||({arcadeUtils:r}=await x.loadArcade(),J=r),r=J.extractFieldNames(D));q&&r.push(q);b&&r.push(b);t&&r.push(t);n&&r.push(n);return r};d.getNormalizationType=function(r){let q=r.normalizationType;q||(r.normalizationField?q="field":null!=
r.normalizationTotal&&(q="percent-of-total"));return q??void 0};d.isAnyDateField=function(r){return y.isDateField(r)||y.isDateOnlyField(r)||y.isTimestampOffsetField(r)};d.isIntegerField=function(r,q){r=q&&r.getField(q);return!!r&&E.has(r.type)};d.unitValueInDays=z;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/support/basemapUtils":function(){define("exports ../Basemap ../config ../core/Collection ../core/Logger ../core/maybe ../core/urlUtils ../core/accessorSupport/ensureType ../layers/effects/utils ./basemapDefinitions".split(" "),
function(d,g,y,x,G,A,f,p,e,v){function z(I,k){let h;if("string"===typeof I){const w=I in v.esriBasemapDefinitions,O=!w&&I.includes("/");if(!w&&!O)return k=Object.entries(v.esriBasemapDefinitions).filter(([,M])=>y.apiKey&&!M.classic||!y.apiKey&&(M.classic||M.is3d)).map(([M])=>`"${M}"`).sort().join(", "),G.getLogger("esri.support.basemapUtils").warn(`Unable to find basemap definition for: ${I}. Try one of these: ${k}`),null;k&&(h=k[I]);h||(h=w?g.fromId(I):new g({style:{id:I}}),k&&(k[I]=h))}else h=p.ensureType(g,
I);h?.destroyed&&(G.getLogger("esri.support.basemapUtils").warn("The provided basemap is already destroyed",{basemap:h}),h=null);return h}function E(I){if(U)return U(I);let k=null;I=b(I);const h=!I?.baseLayers.length;for(const O in v.esriBasemapDefinitions){var w=Q(v.esriBasemapDefinitions[O]);w=C(I,w,{mustMatchReferences:h});if("equal"===w){k=O;break}"base-layers-equal"===w&&(k=O)}return k}function J(I,k){const h=new x;I.forEach(w=>{const O=k.find(M=>"scene"!==M.type&&R(n(w),n(M)))||w;h.includes(O)?
h.push(w):h.push(O)});return h}function r(I){if(q(I.url))return!0;if("vector-tile"===I.type)for(const k in I.sourceNameToSource)if(q(I.sourceNameToSource[k]?.sourceUrl))return!0;return!1}function q(I){if(!I)return!1;I=new f.Url(f.makeAbsolute(I));return!!I.authority&&u.test(I.authority)}function b(I){return I?!I.loaded&&I.resourceInfo?Q(I.resourceInfo.data):{baseLayers:t(I.baseLayers),referenceLayers:t(I.referenceLayers)}:null}function t(I){return(x.isCollection(I)?I.toArray():I).map(n)}function n(I){return{type:I.type,
effect:"effect"in I?I.effect:void 0,url:Z("urlTemplate"in I&&I.urlTemplate||I.url||"styleUrl"in I&&I.styleUrl||""),minScale:"minScale"in I&&null!=I.minScale?I.minScale:0,maxScale:"maxScale"in I&&null!=I.maxScale?I.maxScale:0,opacity:null!=I.opacity?I.opacity:1,visible:null!=I.visible?!!I.visible:!0,sublayers:"map-image"!==I.type&&"wms"!==I.type||null==I.sublayers?void 0:I.sublayers?.map(k=>({id:k.id,visible:k.visible})),activeLayerId:"wmts"===I.type?I.activeLayer?.id:void 0}}function D(I){return I.isReference||
"ArcGISSceneServiceLayer"===I.layerType}function Q(I){return I?{baseLayers:a((I.baseMapLayers??[]).filter(k=>!D(k))),referenceLayers:a((I.baseMapLayers??[]).filter(k=>D(k)))}:null}function a(I){return I.map(k=>{let h;switch(k.layerType){case "VectorTileLayer":h="vector-tile";break;case "ArcGISTiledMapServiceLayer":h="tile";break;case "ArcGISSceneServiceLayer":h="scene";break;default:h="unknown"}return{type:h,effect:k.effect,url:Z(k.templateUrl||k.urlTemplate||k.styleUrl||k.url),minScale:k.minScale??
0,maxScale:k.maxScale??0,opacity:k.opacity??1,visible:null!=k.visibility?!!k.visibility:!0,sublayers:void 0,activeLayerId:void 0}})}function C(I,k,h){return null!=I!==(null!=k)?"not-equal":I&&k?P(I.baseLayers,k.baseLayers)?P(I.referenceLayers,k.referenceLayers)?"equal":h.mustMatchReferences?"not-equal":"base-layers-equal":"not-equal":"equal"}function P(I,k){if(I.length!==k.length)return!1;for(let h=0;h<I.length;h++)if(!R(I[h],k[h]))return!1;return!0}function R(I,k){if(I.type!==k.type||I.url!==k.url||
I.minScale!==k.minScale||I.maxScale!==k.maxScale||I.visible!==k.visible||I.opacity!==k.opacity||!e.effectEquals(I.effect,k.effect))return!1;if(null!=I.activeLayerId||null!=k.activeLayerId)return I.activeLayerId===k.activeLayerId;if(null!=I.sublayers||null!=k.sublayers){if(null==I.sublayers||null==k.sublayers||I.sublayers.length!==k.sublayers.length)return!1;for(let h=0;h<I.sublayers.length;h++){const w=I.sublayers.at(h),O=k.sublayers.at(h);if(w?.id!==O?.id||w?.visible!==O?.visible)return!1}}return!0}
function Z(I){return I?f.normalize(I).replace(/^\s*https?:/i,"").toLowerCase():""}function W(I){return"portalItem"in I?I.portalItem?.thumbnailUrl:void 0}let U;const u=/^(basemaps|ibasemaps).*-api\.arcgis\.com$/i;d.clonePreservingTiledLayers=function(I,k=null){I=z(I);if(!I)return null;I=I.clone();k&&(I.baseLayers=J(I.baseLayers,k.baseLayers),I.referenceLayers=J(I.referenceLayers,k.referenceLayers));return I};d.contentEquals=function(I,k){if(I===k||null!=I?.portalItem?.id&&I.portalItem.id===k?.portalItem?.id)return!0;
I=b(I);k=b(k);return"equal"===C(I,k,{mustMatchReferences:!0})};d.createCache=function(){return{}};d.destroyCache=function(I){for(const k in I)A.destroyMaybe(I[k]),delete I[k]};d.ensureType=z;d.findSpatialReference=function(I,k){if(null==k||null==I)return{spatialReference:null,updating:!1};if("not-loaded"===k.loadStatus)return k.load(),{spatialReference:null,updating:!0};if(k.spatialReference)return{spatialReference:k.spatialReference,updating:!1};if(0===k.baseLayers.length)return{spatialReference:null,
updating:!1};k=k.baseLayers.at(0);switch(k.loadStatus){case "not-loaded":k.load();case "loading":return{spatialReference:null,updating:!0};case "failed":return{spatialReference:null,updating:!1}}k=(("supportedSpatialReferences"in k?k.supportedSpatialReferences:null)||["tileInfo"in k?k.tileInfo?.spatialReference:k.spatialReference]).filter(Boolean);const h=I.spatialReference;return h?{spatialReference:k.find(w=>h.equals(w))??k[0]??null,updating:!1}:{spatialReference:k[0],updating:!1}};d.getBasemapThumbnailUrl=
function(I){if(!I)return null;var {thumbnailUrl:k}=I;return k?k:(k=E(I))?v.esriBasemapDefinitions[k].thumbnailUrl:A.mappedFind(I.baseLayers,W)};d.getWellKnownBasemapId=E;d.hasDeveloperBasemapLayer=function(I){return!!I?.baseLayers.concat(I.referenceLayers).some(r)};d.isBasemap3D=function(I){return"Web Scene"===I.portalItem?.type||I.referenceLayers.some(k=>"scene"===k.type)};d.isBasemapInBeta=function(I){return!!I?.portalItem?.tags?.some(k=>"beta"===k.toLowerCase())};d.isBasemapLayer=function(I,k){return I.basemap?.referenceLayers?.some(h=>
h.uid===k)||I.basemap?.baseLayers?.some(h=>h.uid===k)};d.isDeveloperBasemapLayer=r;d.overrideGetWellKnownBasemapId=function(I){U=I};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/Basemap":function(){define("require ./chunks/tslib.es6 ./request ./core/Collection ./core/collectionUtils ./core/JSONSupport ./core/lang ./core/Loadable ./core/loadAll ./core/Logger ./core/maybe ./core/promiseUtils ./core/urlUtils ./core/accessorSupport/decorators/property ./core/has ./core/accessorSupport/decorators/subclass ./core/accessorSupport/decorators/writer ./geometry/SpatialReference ./portal/Portal ./portal/PortalItem ./support/basemapDefinitions ./support/BasemapStyle ./webdoc/support/writeUtils".split(" "),
function(d,g,y,x,G,A,f,p,e,v,z,E,J,r,q,b,t,n,D,Q,a,C,P){var R;let Z=0;A=R=class extends A.JSONSupportMixin(p){constructor(u){super(u);this.thumbnailUrl=this.style=this.spatialReference=this.portalItem=this.id=null;this.title="Basemap";this.id=Date.now().toString(16)+"-basemap-"+Z++;this.baseLayers=new x;this.referenceLayers=new x;const I=k=>{k.parent&&k.parent!==this&&"remove"in k.parent&&k.parent.remove(k);k.parent=this;"elevation"===k.type&&v.getLogger(this).error(`Layer '${k.title}, id:${k.id}' of type '${k.type}' is not supported as a basemap layer and will therefore be ignored.`)};
this.addHandles([this.baseLayers.on("after-add",k=>I(k.item)),this.referenceLayers.on("after-add",k=>I(k.item)),this.baseLayers.on("after-remove",k=>{k.item.parent=null}),this.referenceLayers.on("after-remove",k=>{k.item.parent=null})])}initialize(){this.when().catch(u=>{v.getLogger(this).error("#load()",`Failed to load basemap (title: '${this.title}', id: '${this.id}')`,u)});this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){var u=this.baseLayers.toArray();for(const I of u)I.destroy();
u=this.referenceLayers.toArray();for(const I of u)I.destroy();this.baseLayers.destroy();this.referenceLayers.destroy();this.portalItem=z.destroyMaybe(this.portalItem)}normalizeCtorArgs(u){u&&"resourceInfo"in u&&(this._set("resourceInfo",u.resourceInfo),u={...u},delete u.resourceInfo);return u}set baseLayers(u){this._set("baseLayers",G.referenceSetter(u,this._get("baseLayers")))}_writeBaseLayers(u,I,k){const h=[];u&&(k={...k,layerContainerType:"basemap"},this.baseLayers.forEach(w=>{w=P.getLayerJSON(w,
k.webmap?k.webmap.getLayerJSONFromResourceInfo(w):null,k);null!=w&&h.push(w)}),this.referenceLayers.forEach(w=>{const O=P.getLayerJSON(w,k.webmap?k.webmap.getLayerJSONFromResourceInfo(w):null,k);null!=O&&("scene"!==w.type&&(O.isReference=!0),h.push(O))}));I.baseMapLayers=h}set referenceLayers(u){this._set("referenceLayers",G.referenceSetter(u,this._get("referenceLayers")))}writeTitle(u,I){I.title=u||"Basemap"}load(u){this.addResolvingPromise(this._loadFromSource(u));return Promise.resolve(this)}loadAll(){return e.loadAll(this,
u=>{u(this.baseLayers,this.referenceLayers)})}clone(){const u={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.map(I=>f.isClonable(I)?I.clone():I),referenceLayers:this.referenceLayers.map(I=>f.isClonable(I)?I.clone():I)};this.loaded&&(u.loadStatus="loaded");return(new R({resourceInfo:this.resourceInfo})).set(u)}read(u,I){this.resourceInfo||this._set("resourceInfo",{data:u,context:I});super.read(u,I)}write(u,I){u=u||{};I?.origin||(I={origin:"web-map",...I});super.write(u,
I);!this.loaded&&this.resourceInfo?.data.baseMapLayers&&(u.baseMapLayers=this.resourceInfo.data.baseMapLayers.map(k=>{k=f.clone(k);k.url&&J.isProtocolRelative(k.url)&&(k.url=`https:${k.url}`);k.templateUrl&&J.isProtocolRelative(k.templateUrl)&&(k.templateUrl=`https:${k.templateUrl}`);return k}));return u}async _loadFromSource(u){const {resourceInfo:I,portalItem:k,style:h}=this;E.throwIfAborted(u);const w=[];I?(w.push(this._loadLayersFromJSON(I.data,I.context?I.context.url:null,u)),I.data.id&&!I.data.title&&
w.push(a.getBasemapTitle(I.data.id).then(O=>{O&&this.read({title:O},I.context)}))):k?w.push(this._loadFromItem(k,u)):h&&w.push(this._loadFromStylesService(h,u));await Promise.all(w)}async _loadLayersFromJSON(u,I,k){const h=this.resourceInfo?.context,w=this.portalItem?.portal||h?.portal||null,O=U[h?.origin||""]??"web-map",{populateOperationalLayers:M}=await new Promise((Y,ea)=>d(["./layers/support/layersCreator"],Y,ea)),T=[];E.throwIfAborted(k);if(u.baseMapLayers&&Array.isArray(u.baseMapLayers)){I=
{context:{...h,origin:O,url:I,portal:w,layerContainerType:"basemap"},defaultLayerType:"DefaultTileLayer"};const Y=ea=>"web-scene"===O&&"ArcGISSceneServiceLayer"===ea.layerType||ea.isReference;k=M(this.baseLayers,u.baseMapLayers.filter(ea=>!Y(ea)),I);T.push(k);u=M(this.referenceLayers,u.baseMapLayers.filter(Y),I);T.push(u)}await Promise.allSettled(T)}async _loadFromItem(u,I){const k=await (await u.load(I)).fetchData("json",I),h=J.urlToObject(u.itemUrl??"");this._set("resourceInfo",{data:k.baseMap??
{},context:{origin:W[u.type||""]??"web-map",portal:u.portal||D.getDefault(),url:h}});this.read(this.resourceInfo.data,this.resourceInfo.context);this.read({spatialReference:k.spatialReference},this.resourceInfo.context);this.read({title:u.title,thumbnailUrl:u.thumbnailUrl},{origin:"portal-item",portal:u.portal||D.getDefault(),url:h});return this._loadLayersFromJSON(this.resourceInfo.data,h,I)}async _loadFromStylesService(u,I){var k=`${u.serviceUrl}/${u.id}`;u=(await y(k,{query:{language:u.getLanguageParamValue(),
places:u.places,worldview:u.worldview},signal:I?.signal})).data;k=J.urlToObject(k);this._set("resourceInfo",{data:u.baseMap??{},context:{origin:"web-map",url:k}});this.read(this.resourceInfo.data,this.resourceInfo.context);this.read({spatialReference:u.spatialReference},this.resourceInfo.context);return this._loadLayersFromJSON(this.resourceInfo.data,k,I)}static fromId(u){return(u=a.esriBasemapDefinitions[u])?u.itemId?new R({portalItem:{id:u.itemId,portal:{url:"https://www.arcgis.com"}}}):R.fromJSON(u,
{origin:u.is3d?"web-scene":"web-map"}):null}};g.__decorate([r.property({json:{write:{ignoreOrigin:!0,target:"baseMapLayers",writer(u,I,k,h){this._writeBaseLayers(u,I,h)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:x}},writer(u,I,k,h){this._writeBaseLayers(u,I,h)}}}}}})],A.prototype,"baseLayers",null);g.__decorate([r.property({type:String,json:{origins:{"web-scene":{write:!0}}}})],A.prototype,"id",void 0);g.__decorate([r.property({type:Q})],A.prototype,"portalItem",void 0);
g.__decorate([r.property()],A.prototype,"referenceLayers",null);g.__decorate([r.property({readOnly:!0})],A.prototype,"resourceInfo",void 0);g.__decorate([r.property({type:n})],A.prototype,"spatialReference",void 0);g.__decorate([r.property({type:C})],A.prototype,"style",void 0);g.__decorate([r.property()],A.prototype,"thumbnailUrl",void 0);g.__decorate([r.property({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],A.prototype,"title",void 0);g.__decorate([t.writer("title")],A.prototype,
"writeTitle",null);A=R=g.__decorate([b.subclass("esri.Basemap")],A);const W={"Web Scene":"web-scene","Web Map":"web-map","Link Chart":"link-chart"},U={"web-scene":"web-scene","web-map":"web-map","link-chart":"link-chart"};return A})},"esri/core/collectionUtils":function(){define(["exports","./Collection"],function(d,g){d.castForReferenceSetter=function(y){return y};d.referenceSetter=function(y,x,G=g){x||=new G;if(x===y)return x;x.removeAll();y&&(Array.isArray(y)||"items"in y&&Array.isArray(y.items))?
x.addMany(y):y&&x.add(y);return x};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/Loadable":function(){define("../chunks/tslib.es6 ./Error ./maybe ./Promise ./promiseUtils ./Warning ./accessorSupport/decorators/property ./accessorSupport/decorators/subclass".split(" "),function(d,g,y,x,G,A,f,p){const e=v=>{v=class extends v{constructor(...z){super(...z);this.loadError=this._loadController=null;this.loadStatus="not-loaded";this._set("loadWarnings",[]);this.addResolvingPromise(new Promise(E=>
{const J=this.load.bind(this);this.load=r=>{const q=new Promise((b,t)=>{const n=G.onAbortOrThrow(r,t);this.destroyed&&t(new g("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this}));this.when(b,t).finally(()=>{n&&n.remove()})});if("not-loaded"===this.loadStatus){this._set("loadStatus","loading");const b=this._loadController=new AbortController;J({signal:b.signal})}E();return q}}));this.when(()=>{this._set("loadStatus","loaded");
this._loadController=null},E=>{this._set("loadStatus","failed");this._set("loadError",E);this._loadController=null})}destroy(){this._loadController&&(this._loadController=y.abortMaybe(this._loadController),this._promiseProps.abort());this._set("loadError",null);this._set("loadWarnings",[])}get loaded(){return"loaded"===this.loadStatus}get loadWarnings(){return this._get("loadWarnings")}load(){return null}cancelLoad(){if(this.isFulfilled())return this;this._set("loadError",new g("load:cancelled","Cancelled"));
this._loadController?.abort();this._promiseProps.abort();return this}};d.__decorate([f.property({readOnly:!0})],v.prototype,"loaded",null);d.__decorate([f.property({readOnly:!0})],v.prototype,"loadError",void 0);d.__decorate([f.property({clonable:!1})],v.prototype,"loadStatus",void 0);d.__decorate([f.property({type:[A],readOnly:!0})],v.prototype,"loadWarnings",null);return v=d.__decorate([p.subclass("esri.core.Loadable")],v)};x=class extends e(x.EsriPromise){};x=d.__decorate([p.subclass("esri.core.Loadable")],
x);(function(v){v.LoadableMixin=e;v.isLoadable=function(z){return!(!z||!z.load)}})(x||={});return x})},"esri/core/Promise":function(){define(["exports","../chunks/tslib.es6","./Accessor","./promiseUtils","./accessorSupport/decorators/subclass"],function(d,g,y,x,G){var A;(function(e){e[e.PENDING=0]="PENDING";e[e.RESOLVED=1]="RESOLVED";e[e.REJECTED=2]="REJECTED"})(A||={});class f{constructor(){this._resolver=x.createResolver();this._status=A.PENDING;this._resolvingPromises=[];this._resolver.promise.then(()=>
{this._status=A.RESOLVED;this._cleanUp()},()=>{this._status=A.REJECTED;this._cleanUp()});this.promise=this._resolver.promise}destroy(){this._cleanUp()}addResolvingPromise(e){this._resolvingPromises.push(e);this._tryResolve()}isResolved(){return this._status===A.RESOLVED}isRejected(){return this._status===A.REJECTED}isFulfilled(){return this._status!==A.PENDING}abort(){this._resolver.reject(x.createAbortError())}_cleanUp(){this._resolvingPromises=this._allPromise=null}_tryResolve(){if(!this.isFulfilled()){var e=
x.createResolver(),v=[...this._resolvingPromises,e.promise],z=this._allPromise=Promise.all(v);z.then(()=>{this.isFulfilled()||this._allPromise!==z||this._resolver.resolve()},E=>{this.isFulfilled()||this._allPromise!==z||x.isAbortError(E)||this._resolver.reject(E)});e.resolve()}}}const p=e=>{e=class extends e{constructor(...v){super(...v);this._promiseProps=new f;this.addResolvingPromise(Promise.resolve())}destroy(){this._promiseProps.destroy()}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(v,
z){return this._promiseProps.promise.then(()=>this).then(v,z)}catch(v){return this.when(null,v)}addResolvingPromise(v){v&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in v?v.when():v)}};return e=g.__decorate([G.subclass("esri.core.Promise")],e)};d.EsriPromise=class extends p(y){};d.EsriPromise=g.__decorate([G.subclass("esri.core.Promise")],d.EsriPromise);d.EsriPromiseMixin=p;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/loadAll":function(){define(["exports",
"./asyncUtils","./Collection","./Loadable"],function(d,g,y,x){async function G(A,f){const p=[],e=(...z)=>{for(const E of z)null!=E&&(Array.isArray(E)?e(...E):y.isCollection(E)?E.forEach(J=>e(J)):x.isLoadable(E)&&p.push(E))};f(e);let v=null;await g.map(p,async z=>{z=await g.result("loadAll"in z&&"function"===typeof z.loadAll?z.loadAll():z.load());!1!==z.ok||v||(v=z)});if(v)throw v.error;return A}d.loadAll=async function(A,f){await A.load();return G(A,f)};d.loadAllChildren=G;Object.defineProperty(d,
Symbol.toStringTag,{value:"Module"})})},"esri/portal/Portal":function(){define("require ../chunks/tslib.es6 ../config ../kernel ../request ../core/Error ../core/JSONSupport ../core/Loadable ../core/maybe ../core/promiseUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/RandomLCG ../core/has ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../geometry/Extent ../intl/locale ./portalDefault ./PortalGroup ./PortalQueryParams ./PortalQueryResult ./PortalUser ../support/apiKeyUtils".split(" "),
function(d,g,y,x,G,A,f,p,e,v,z,E,J,r,q,b,t,n,D,Q,a,C,P,R){function Z(h){const w=x.id;return()=>{const O=h.deref();O&&w.findCredential(O.restUrl)&&O.signIn().catch(()=>{})}}const W=h=>Object.freeze(Object.defineProperty({__proto__:null,default:h},Symbol.toStringTag,{value:"Module"}));var U;let u;const I={PortalGroup:()=>Promise.resolve({default:Q}),PortalItem:()=>new Promise((h,w)=>d(["./PortalItem"],O=>h(W(O)),w)),PortalUser:()=>Promise.resolve({default:P})};f=U=class extends f.JSONSupportMixin(p){constructor(h){super(h);
this.access=this._esriIdCredentialCreateHandle=null;this.allSSL=!1;this.authMode="auto";this.bingKey=this.basemapGalleryGroupQuery3D=this.basemapGalleryGroupQuery=this.authorizedCrossOriginDomains=null;this.canProvisionDirectPurchase=this.canListPreProvisionedItems=this.canListData=this.canListApps=!1;this.canSearchPublic=!0;this.canSignInIDP=this.canSignInArcGIS=this.canSharePublic=this.canShareBingPublic=!1;this.colorSetsGroupQuery=null;this.commentsEnabled=!1;this.livingAtlasGroupQuery=this.layoutGroupQuery=
this.galleryTemplatesGroupQuery=this.featuredItemsGroupQuery=this.featuredGroups=this.eueiEnabled=this.devBasemapGalleryGroupQuery=this.description=this.defaultVectorBasemap=this.defaultExtent=this.defaultDevBasemap=this.defaultBasemap=this.customBaseUrl=this.culture=this.created=null;this.hasCategorySchema=!1;this.ipCntryCode=this.id=this.httpsPort=this.httpPort=this.homePageFeaturedContentCount=this.homePageFeaturedContent=this.helperServices=null;this.isReadOnly=this.isPortal=!1;this.region=this.portalProperties=
this.portalMode=this.portalHostname=this.name=this.modified=this.maxTokenExpirationMinutes=this.layerTemplatesGroupQuery=null;this.recycleBinEnabled=!1;this.rotatorPanels=null;this.showHomePageDescription=!1;this.sourceJSON=null;this.supportsHostedServices=!1;this.units=this.templatesGroupQuery=this.symbolSetsGroupQuery=null;this.url=y.portalUrl;this.user=this.urlKey=null;this.use3dBasemaps=!0;this.useVectorBasemaps=this.useStandardizedQuery=!1;this.vectorBasemapGalleryGroupQuery=null}normalizeCtorArgs(h){return"string"===
typeof h?{url:h}:h}destroy(){k.unregister(this);this.defaultBasemap=e.destroyMaybe(this.defaultBasemap);this.defaultDevBasemap=e.destroyMaybe(this.defaultDevBasemap);this.defaultVectorBasemap=e.destroyMaybe(this.defaultVectorBasemap);this._esriIdCredentialCreateHandle=e.removeMaybe(this._esriIdCredentialCreateHandle)}readAuthorizedCrossOriginDomains(h){if(h)for(const w of h)y.request.trustedServers.includes(w)||y.request.trustedServers.push(w);return h}readDefaultBasemap(h){return this._readBasemap(h)}readDefaultDevBasemap(h){return this._readBasemap(h)}readDefaultVectorBasemap(h){return this._readBasemap(h)}get extraQuery(){const h=
!this.user?.orgId||this.canSearchPublic;return this.id&&!h?` AND orgid:${this.id}`:null}get isOrganization(){return!!this.access}get itemPageUrl(){return this.url?`${this.url}/home/item.html`:null}get restUrl(){let h=this.url;if(h){const w=h.indexOf("/sharing");h=0<w?h.substring(0,w):this.url.replace(/\/+$/,"");h+="/sharing/rest"}return h}get thumbnailUrl(){const h=this.restUrl,w=this.thumbnail;return h&&w?this._normalizeSSL(h+"/portals/self/resources/"+w):null}readUrlKey(h){return h?h.toLowerCase():
h}readUser(h){let w=null;h&&(w=P.fromJSON(h),w.portal=this);return w}load(h){const w=(new Promise((O,M)=>d(["../Basemap"],T=>O(W(T)),M))).then(({default:O})=>{v.throwIfAborted(h);u=O}).then(()=>this.sourceJSON?this.sourceJSON:this.fetchSelf(this.authMode,!1,h)).then(O=>{if(x.id){const M=x.id;this.credential=M.findCredential(this.restUrl);this.credential||this.authMode!==U.AUTH_MODE_AUTO&&this.authMode!==U.AUTH_MODE_NO_PROMPT||(this._esriIdCredentialCreateHandle?.remove(),this._esriIdCredentialCreateHandle=
M.on("credential-create",Z(new WeakRef(this))),k.register(this,this._esriIdCredentialCreateHandle,this))}this.sourceJSON=O;this.read(O)});this.addResolvingPromise(w);return Promise.resolve(this)}async createElevationLayers(){await this.load();const h=this._getHelperService("defaultElevationLayers"),w=(await new Promise((O,M)=>d(["../layers/ElevationLayer"],T=>O(W(T)),M))).default;return h?h.map(O=>new w({id:O.id,url:O.url})):[]}async fetchBasemaps(h,w){const O=await this._fetchBasemaps(h,w);!0===
w?.include3d&&!1!==this.use3dBasemaps&&(h=await this._fetchBasemaps3D(h,w),O.unshift(...h));return O}fetchCategorySchema(h){return this.hasCategorySchema?this.request(this.restUrl+"/portals/self/categorySchema",h).then(w=>w.categorySchema):v.isAborted(h)?Promise.reject(v.createAbortError()):Promise.resolve([])}fetchFeaturedGroups(h){const w=this.featuredGroups,O=new a({num:100,sortField:"title"});if(w?.length){const M=[];for(const T of w)M.push(`(title:"${T.title}" AND owner:${T.owner})`);O.query=
M.join(" OR ");return this.queryGroups(O,h).then(T=>T.results)}return v.isAborted(h)?Promise.reject(v.createAbortError()):Promise.resolve([])}fetchRegions(h){const w=this.user?.culture||this.culture||n.getLocale();return this.request(this.restUrl+"/portals/regions",{...h,query:{culture:w}})}fetchSettings(h){const w=this.user?.culture||this.culture||n.getLocale();return this.request(this.restUrl+"/portals/self/settings",{...h,query:{culture:w}})}static getDefault(){return D.ensureDefaultPortalInstance(()=>
new U)}queryGroups(h,w){return this.queryPortal("/community/groups",h,"PortalGroup",w)}queryItems(h,w){return this.queryPortal("/search",h,"PortalItem",w)}queryUsers(h,w){h.sortField||(h.sortField="username");return this.queryPortal("/community/users",h,"PortalUser",w)}fetchSelf(h=this.authMode,w=!1,O){const M=this.restUrl+"/portals/self";h={authMode:h,query:{culture:n.getLocale().toLowerCase()},withCredentials:!0,...O};"auto"===h.authMode&&(h.authMode="no-prompt");w&&(h.query.default=!0);return this.request(M,
h)}queryPortal(h,w,O,M){const T=E.ensureType(a,w),Y=ea=>this.request(this.restUrl+h,{...T.toRequestOptions(this),...M}).then(ia=>{const na=T.clone();na.start=ia.nextStart;return new C({nextQueryParams:na,queryParams:T,total:ia.total,results:U._resultsToTypedArray(ea,{portal:this},ia,M)})}).then(ia=>Promise.all(ia.results.map(na=>"function"===typeof na.when?na.when():ia)).then(()=>ia,na=>{v.throwIfAbortError(na);return ia}));return O&&I[O]?I[O]().then(({default:ea})=>{v.throwIfAborted(M);return Y(ea)}):
Y()}signIn(){if(this.authMode===U.AUTH_MODE_ANONYMOUS||this.authMode===U.AUTH_MODE_NO_PROMPT&&!x.id)return Promise.reject(new A("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if("failed"===this.loadStatus)return Promise.reject(this.loadError);const h=w=>Promise.resolve().then(()=>{if("not-loaded"===this.loadStatus)return w||(this.authMode="immediate"),this.load().then(()=>null);if("loading"===this.loadStatus)return this.load().then(()=>{if(this.credential)return null;this.credential=
w;return this.fetchSelf("immediate")});if(this.user&&this.credential===w)return null;this.credential=w;return this.fetchSelf("immediate")}).then(O=>{O&&(this.sourceJSON=O,this.read(O))});return x.id?x.id.getCredential(this.restUrl,{prompt:this.authMode!==U.AUTH_MODE_NO_PROMPT}).then(w=>h(w)):h(this.credential)}normalizeUrl(h){const w=this.credential?.token;return this._normalizeSSL(w?h+(h.includes("?")?"\x26":"?")+"token\x3d"+w:h)}requestToTypedArray(h,w,O){return this.request(h,w).then(M=>{const T=
U._resultsToTypedArray(O,{portal:this},M);return Promise.all(T.map(Y=>"function"===typeof Y.when?Y.when():M)).then(()=>T,()=>T)})}request(h,w={}){var O={f:"json",...w.query};const {authMode:M=this.authMode===U.AUTH_MODE_ANONYMOUS||this.authMode===U.AUTH_MODE_NO_PROMPT?this.authMode:"auto",body:T=null,cacheBust:Y=!1,method:ea="auto",responseType:ia="json",signal:na}=w;O={authMode:M,body:T,cacheBust:Y,method:ea,query:O,responseType:ia,timeout:0,signal:na};w.withCredentials&&(O.withCredentials=!0);return G(this._normalizeSSL(h),
O).then(qa=>qa.data)}toJSON(){throw new A("internal:not-yet-implemented","Portal.toJSON is not yet implemented");}static fromJSON(h){if(!h)return null;if(h.declaredClass)throw Error("JSON object is already hydrated");return new U({sourceJSON:h})}_getHelperService(h){const w=this.helperServices&&this.helperServices[h];if(!w)throw new A("portal:service-not-found",`The \`helperServices\` do not include an entry named "${h}"`);return w}async _fetchBasemaps(h,w){const O=new a;O.query=h||(y.apiKey&&R.supportsApiKey(this.url)?
this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery);O.disableExtraQuery=!0;h=await this.queryGroups(O,w);if(!h.total)return[];h=h.results[0];O.num=100;O.query='type:"Web Map" -type:"Web Application"';O.sortField=h.sortField||"name";O.sortOrder=h.sortOrder||"desc";w=await h.queryItems(O,w);return w.total?w.results.filter(M=>"Web Map"===M.type).map(M=>new u({portalItem:M})):[]}async _fetchBasemaps3D(h,w){h=h||this.basemapGalleryGroupQuery3D;
if(!h)return[];h=new a({query:h,disableExtraQuery:!0});var O=await this.queryGroups(h,w);if(!O.total)return[];O=O.results[0];h.num=100;h.query='type:"Web Scene"';h.sortField=O.sortField||"name";h.sortOrder=O.sortOrder||"desc";w=await O.queryItems(h,w);return w.total?w.results.filter(M=>"Web Scene"===M.type).map(M=>new u({portalItem:M})):[]}_normalizeSSL(h){return h.replace(/^http:/i,"https:").replace(":7080",":7443")}_readBasemap(h){return h?(h=u.fromJSON(h),h.portalItem={portal:this},h):null}static _resultsToTypedArray(h,
w,O,M){if(O){const T=null!=M?M.signal:null;O=O.listings||O.notifications||O.userInvitations||O.tags||O.items||O.groups||O.comments||O.provisions||O.results||O.relatedItems||O;if(h||w)O=O.map(Y=>{Y=Object.assign(h?h.fromJSON(Y):Y,w);"function"===typeof Y.load&&Y.load(T);return Y})}else O=[];return O}};f.AUTH_MODE_ANONYMOUS="anonymous";f.AUTH_MODE_AUTO="auto";f.AUTH_MODE_IMMEDIATE="immediate";f.AUTH_MODE_NO_PROMPT="no-prompt";g.__decorate([z.property()],f.prototype,"access",void 0);g.__decorate([z.property()],
f.prototype,"allSSL",void 0);g.__decorate([z.property()],f.prototype,"authMode",void 0);g.__decorate([z.property()],f.prototype,"authorizedCrossOriginDomains",void 0);g.__decorate([q.reader("authorizedCrossOriginDomains")],f.prototype,"readAuthorizedCrossOriginDomains",null);g.__decorate([z.property()],f.prototype,"basemapGalleryGroupQuery",void 0);g.__decorate([z.property({json:{name:"3DBasemapGalleryGroupQuery"}})],f.prototype,"basemapGalleryGroupQuery3D",void 0);g.__decorate([z.property()],f.prototype,
"bingKey",void 0);g.__decorate([z.property()],f.prototype,"canListApps",void 0);g.__decorate([z.property()],f.prototype,"canListData",void 0);g.__decorate([z.property()],f.prototype,"canListPreProvisionedItems",void 0);g.__decorate([z.property()],f.prototype,"canProvisionDirectPurchase",void 0);g.__decorate([z.property()],f.prototype,"canSearchPublic",void 0);g.__decorate([z.property()],f.prototype,"canShareBingPublic",void 0);g.__decorate([z.property()],f.prototype,"canSharePublic",void 0);g.__decorate([z.property()],
f.prototype,"canSignInArcGIS",void 0);g.__decorate([z.property()],f.prototype,"canSignInIDP",void 0);g.__decorate([z.property()],f.prototype,"colorSetsGroupQuery",void 0);g.__decorate([z.property()],f.prototype,"commentsEnabled",void 0);g.__decorate([z.property({type:Date})],f.prototype,"created",void 0);g.__decorate([z.property()],f.prototype,"credential",void 0);g.__decorate([z.property()],f.prototype,"culture",void 0);g.__decorate([z.property()],f.prototype,"currentVersion",void 0);g.__decorate([z.property()],
f.prototype,"customBaseUrl",void 0);g.__decorate([z.property()],f.prototype,"defaultBasemap",void 0);g.__decorate([q.reader("defaultBasemap")],f.prototype,"readDefaultBasemap",null);g.__decorate([z.property()],f.prototype,"defaultDevBasemap",void 0);g.__decorate([q.reader("defaultDevBasemap")],f.prototype,"readDefaultDevBasemap",null);g.__decorate([z.property({type:t})],f.prototype,"defaultExtent",void 0);g.__decorate([z.property()],f.prototype,"defaultVectorBasemap",void 0);g.__decorate([q.reader("defaultVectorBasemap")],
f.prototype,"readDefaultVectorBasemap",null);g.__decorate([z.property()],f.prototype,"description",void 0);g.__decorate([z.property()],f.prototype,"devBasemapGalleryGroupQuery",void 0);g.__decorate([z.property()],f.prototype,"eueiEnabled",void 0);g.__decorate([z.property({readOnly:!0})],f.prototype,"extraQuery",null);g.__decorate([z.property()],f.prototype,"featuredGroups",void 0);g.__decorate([z.property()],f.prototype,"featuredItemsGroupQuery",void 0);g.__decorate([z.property()],f.prototype,"galleryTemplatesGroupQuery",
void 0);g.__decorate([z.property()],f.prototype,"layoutGroupQuery",void 0);g.__decorate([z.property()],f.prototype,"livingAtlasGroupQuery",void 0);g.__decorate([z.property()],f.prototype,"hasCategorySchema",void 0);g.__decorate([z.property()],f.prototype,"helpBase",void 0);g.__decorate([z.property()],f.prototype,"helperServices",void 0);g.__decorate([z.property()],f.prototype,"helpMap",void 0);g.__decorate([z.property()],f.prototype,"homePageFeaturedContent",void 0);g.__decorate([z.property()],f.prototype,
"homePageFeaturedContentCount",void 0);g.__decorate([z.property()],f.prototype,"httpPort",void 0);g.__decorate([z.property()],f.prototype,"httpsPort",void 0);g.__decorate([z.property()],f.prototype,"id",void 0);g.__decorate([z.property()],f.prototype,"ipCntryCode",void 0);g.__decorate([z.property({readOnly:!0})],f.prototype,"isOrganization",null);g.__decorate([z.property()],f.prototype,"isPortal",void 0);g.__decorate([z.property()],f.prototype,"isReadOnly",void 0);g.__decorate([z.property({readOnly:!0})],
f.prototype,"itemPageUrl",null);g.__decorate([z.property()],f.prototype,"layerTemplatesGroupQuery",void 0);g.__decorate([z.property()],f.prototype,"maxTokenExpirationMinutes",void 0);g.__decorate([z.property({type:Date})],f.prototype,"modified",void 0);g.__decorate([z.property()],f.prototype,"name",void 0);g.__decorate([z.property()],f.prototype,"portalHostname",void 0);g.__decorate([z.property()],f.prototype,"portalMode",void 0);g.__decorate([z.property()],f.prototype,"portalProperties",void 0);
g.__decorate([z.property()],f.prototype,"region",void 0);g.__decorate([z.property()],f.prototype,"recycleBinEnabled",void 0);g.__decorate([z.property({readOnly:!0})],f.prototype,"restUrl",null);g.__decorate([z.property()],f.prototype,"rotatorPanels",void 0);g.__decorate([z.property()],f.prototype,"showHomePageDescription",void 0);g.__decorate([z.property()],f.prototype,"sourceJSON",void 0);g.__decorate([z.property()],f.prototype,"staticImagesUrl",void 0);g.__decorate([z.property({json:{name:"2DStylesGroupQuery"}})],
f.prototype,"stylesGroupQuery2d",void 0);g.__decorate([z.property({json:{name:"stylesGroupQuery"}})],f.prototype,"stylesGroupQuery3d",void 0);g.__decorate([z.property()],f.prototype,"supportsHostedServices",void 0);g.__decorate([z.property()],f.prototype,"symbolSetsGroupQuery",void 0);g.__decorate([z.property()],f.prototype,"templatesGroupQuery",void 0);g.__decorate([z.property()],f.prototype,"thumbnail",void 0);g.__decorate([z.property({readOnly:!0})],f.prototype,"thumbnailUrl",null);g.__decorate([z.property()],
f.prototype,"units",void 0);g.__decorate([z.property()],f.prototype,"url",void 0);g.__decorate([z.property()],f.prototype,"urlKey",void 0);g.__decorate([q.reader("urlKey")],f.prototype,"readUrlKey",null);g.__decorate([z.property()],f.prototype,"user",void 0);g.__decorate([q.reader("user")],f.prototype,"readUser",null);g.__decorate([z.property()],f.prototype,"use3dBasemaps",void 0);g.__decorate([z.property()],f.prototype,"useStandardizedQuery",void 0);g.__decorate([z.property()],f.prototype,"useVectorBasemaps",
void 0);g.__decorate([z.property()],f.prototype,"vectorBasemapGalleryGroupQuery",void 0);g=f=U=g.__decorate([b.subclass("esri.portal.Portal")],f);const k=new FinalizationRegistry(h=>{h.remove()});return g})},"esri/portal/portalDefault":function(){define(["exports"],function(d){let g;d.clearDefaultPortalInstance=function(){g=void 0};d.ensureDefaultPortalInstance=function(y){if(!g||g.destroyed)g=y();return g};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/portal/PortalGroup":function(){define("../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/RandomLCG ../core/has ../core/accessorSupport/decorators/subclass ./PortalQueryParams".split(" "),
function(d,g,y,x,G,A,f,p,e){var v;y=v=class extends y.JSONSupport{constructor(z){super(z);this.id=this.description=this.created=this.access=null;this.isInvitationOnly=!1;this.title=this.tags=this.sourceJSON=this.sortOrder=this.sortField=this.snippet=this.portal=this.owner=this.modified=null}get thumbnailUrl(){const z=this.url,E=this.thumbnail;return z&&E&&this.portal?this.portal?.normalizeUrl(`${z}/info/${E}?f=json`):null}get url(){const z=this.portal?.restUrl;return z?z+"/community/groups/"+this.id:
null}fetchCategorySchema(z){return this.portal.request(this.url+"/categorySchema",z).then(E=>{E=E.categorySchema||[];return E.some(J=>"contentCategorySetsGroupQuery.LivingAtlas"===J.source)?this._fetchCategorySchemaSet("LivingAtlas",z):E})}fetchMembers(z){return this.portal.request(this.url+"/users",z)}getThumbnailUrl(z){let E=this.thumbnailUrl;E&&z&&(E+=`&w=${z}`);return E}toJSON(){throw new g("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented");}static fromJSON(z){if(!z)return null;
if(z.declaredClass)throw Error("JSON object is already hydrated");const E=new v({sourceJSON:z});E.read(z);return E}queryItems(z,E){z=G.ensureType(e,z);const J=this.portal;if(5<parseFloat(J.currentVersion))return z=z||new e,J.queryPortal(`/content/groups/${this.id}/search`,z,"PortalItem",E);z=z?z.clone():new e;z.query="group:"+this.id+(z.query?" "+z.query:"");return J.queryItems(z,E)}_fetchCategorySchemaSet(z,E){const J=this.portal;return J.fetchSelf(J.authMode,!0,E).then(r=>{if(r=r.contentCategorySetsGroupQuery)return r=
new e({disableExtraQuery:!0,num:1,query:r}),J.queryGroups(r,E);throw new g("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found");}).then(r=>{if(r.total){r=r.results[0];const q=new e({num:1,query:`typekeywords:"${z}"`});return r.queryItems(q,E)}throw new g("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found");}).then(r=>r.total?r.results[0].fetchData("json",E).then(q=>{q=q?.categorySchema;return q?.length?q:[]}):[])}};d.__decorate([x.property()],
y.prototype,"access",void 0);d.__decorate([x.property({type:Date})],y.prototype,"created",void 0);d.__decorate([x.property()],y.prototype,"description",void 0);d.__decorate([x.property()],y.prototype,"id",void 0);d.__decorate([x.property()],y.prototype,"isInvitationOnly",void 0);d.__decorate([x.property({type:Date})],y.prototype,"modified",void 0);d.__decorate([x.property()],y.prototype,"owner",void 0);d.__decorate([x.property()],y.prototype,"portal",void 0);d.__decorate([x.property()],y.prototype,
"snippet",void 0);d.__decorate([x.property()],y.prototype,"sortField",void 0);d.__decorate([x.property()],y.prototype,"sortOrder",void 0);d.__decorate([x.property()],y.prototype,"sourceJSON",void 0);d.__decorate([x.property()],y.prototype,"tags",void 0);d.__decorate([x.property()],y.prototype,"thumbnail",void 0);d.__decorate([x.property({readOnly:!0})],y.prototype,"thumbnailUrl",null);d.__decorate([x.property()],y.prototype,"title",void 0);d.__decorate([x.property({readOnly:!0})],y.prototype,"url",
null);return y=v=d.__decorate([p.subclass("esri.portal.PortalGroup")],y)})},"esri/portal/PortalQueryParams":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/jsonMap ../core/lang ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/accessorSupport/decorators/subclass ../geometry/Extent ../geometry/SpatialReference ../geometry/support/webMercatorUtils".split(" "),function(d,g,y,x,G,A,f,p,e,v,z){var E;const J=new y.JSONMap({avgRating:"avg-rating",numRatings:"num-ratings",
numComments:"num-comments",numViews:"num-views"});g=E=class extends g{constructor(r){super(r);this.categories=null;this.disableExtraQuery=!1;this.filter=this.extent=null;this.num=10;this.sortField=this.query=null;this.start=1}get sortOrder(){return this._get("sortOrder")||"asc"}set sortOrder(r){"asc"!==r&&"desc"!==r||this._set("sortOrder",r)}clone(){return new E({categories:this.categories?x.clone(this.categories):null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():
null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}toRequestOptions(r,q){let b=[];this.categories&&(b=this.categories.map(D=>Array.isArray(D)?JSON.stringify(D):D));let t="";if(this.extent){var n=z.project(this.extent,v.WGS84);null!=n&&(t=`${n.xmin},${n.ymin},${n.xmax},${n.ymax}`)}n=this.query;!this.disableExtraQuery&&r.extraQuery&&(n="("+n+")"+r.extraQuery);r={categories:b,bbox:t,q:n,filter:this.filter,num:this.num,sortField:null,
sortOrder:null,start:this.start};this.sortField&&(r.sortField=this.sortField.split(",").map(D=>J.toJSON(D.trim())).join(","),r.sortOrder=this.sortOrder);return{query:{...q,...r}}}};d.__decorate([G.property()],g.prototype,"categories",void 0);d.__decorate([G.property()],g.prototype,"disableExtraQuery",void 0);d.__decorate([G.property({type:e})],g.prototype,"extent",void 0);d.__decorate([G.property()],g.prototype,"filter",void 0);d.__decorate([G.property()],g.prototype,"num",void 0);d.__decorate([G.property()],
g.prototype,"query",void 0);d.__decorate([G.property()],g.prototype,"sortField",void 0);d.__decorate([G.property()],g.prototype,"sortOrder",null);d.__decorate([G.property()],g.prototype,"start",void 0);return g=E=d.__decorate([p.subclass("esri.portal.PortalQueryParams")],g)})},"esri/portal/PortalQueryResult":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass".split(" "),
function(d,g,y,x,G,A,f){g=class extends g{constructor(p){super(p);this.total=this.results=this.queryParams=this.nextQueryParams=null}};d.__decorate([y.property()],g.prototype,"nextQueryParams",void 0);d.__decorate([y.property()],g.prototype,"queryParams",void 0);d.__decorate([y.property()],g.prototype,"results",void 0);d.__decorate([y.property()],g.prototype,"total",void 0);return g=d.__decorate([f.subclass("esri.portal.PortalQueryResult")],g)})},"esri/portal/PortalUser":function(){define("require ../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass ./PortalFolder ./PortalGroup".split(" "),
function(d,g,y,x,G,A,f,p,e,v,z){var E;x=E=class extends x.JSONSupport{constructor(J){super(J);this.userType=this.userLicenseTypeId=this.username=this.units=this.sourceJSON=this.roleId=this.role=this.region=this.privileges=this.preferredView=this.portal=this.orgId=this.modified=this.fullName=this.email=this.description=this.culture=this.created=this.access=null}get thumbnailUrl(){const J=this.url,r=this.thumbnail;return J&&r?this.portal.normalizeUrl(`${J}/info/${r}?f=json`):null}get userContentUrl(){const J=
this.portal?.restUrl;return J?`${J}/content/users/${this.username}`:null}get url(){const J=this.portal?.restUrl;return J?`${J}/community/users/${this.username}`:null}addItem(J){const r=J&&J.item;var q=J?.data;J=J?.folder;const b={method:"post"};r&&(b.query=r.createPostQuery(),null!=q&&("string"===typeof q?b.query.text=q:"object"===typeof q&&(b.query.text=JSON.stringify(q))));q=this.userContentUrl;J&&(q+="/"+("string"===typeof J?J:J.id));return this.portal.request(q+"/addItem",b).then(t=>{r.id=t.id;
r.portal=this.portal;return r.loaded?r.reload():r.load()})}async deleteItem(J,r=!1){let q=this.userContentUrl;J.ownerFolder&&(q+="/"+J.ownerFolder);await this.portal.request(q+`/items/${J.id}/delete`,{method:"post",query:r?{permanentDelete:!0}:{}});J.id=null;J.portal=null}async deleteItems(J,r=!1){J=J.concat();var q=this.userContentUrl+"/deleteItems";const b=[];var t=J.map(n=>n.id);if(t.length){r={method:"post",query:{items:t.join(","),permanentDelete:r}};q=await this.portal.request(q,r);for(const n of q.results)q=
J.find(D=>n.itemId===D.id),r=n.success,t=null,r?(q.id=null,q.portal=null):n.error&&(t=new y("portal:delete-item-failed",n.error.message,n.error)),b.push({item:q,success:r,error:t})}return b}fetchFolders(){return this.portal.request(this.userContentUrl??"",{query:{num:1}}).then(J=>J&&J.folders?J.folders.map(r=>{r=v.fromJSON(r);r.portal=this.portal;return r}):[])}fetchGroups(){return this.portal.request(this.url??"").then(J=>J&&J.groups?J.groups.map(r=>{r=z.fromJSON(r);r.portal=this.portal;return r}):
[])}async fetchItems(J){J??={};var r=this.userContentUrl??"";J.folder&&(r+="/"+J.folder.id);const {default:q}=await new Promise((b,t)=>d(["./PortalItem"],n=>b(Object.freeze(Object.defineProperty({__proto__:null,default:n},Symbol.toStringTag,{value:"Module"}))),t));J=await this.portal.request(r,{query:{folders:!1,inRecycleBin:J.inRecycleBin?!0:null,foldersContent:!J.folder&&J.includeSubfolderItems?!0:null,num:J.num||10,start:J.start||1,sortField:J.sortField||"created",sortOrder:J.sortOrder||"asc"}});
return J?.items?(r=J.items.map(b=>{b=q.fromJSON(b);b.portal=this.portal;return b}),await Promise.all(r.map(b=>b.load())),{items:r,nextStart:J.nextStart,total:J.total}):{items:[],nextStart:-1,total:0}}fetchTags(){return this.portal.request(this.url+"/tags").then(J=>J.tags)}getThumbnailUrl(J){let r=this.thumbnailUrl;r&&J&&(r+=`&w=${J}`);return r}queryFavorites(J){return this.favGroupId?(this._favGroup||(this._favGroup=new z({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(J)):Promise.reject(new y("internal:unknown",
"Unknown internal error",{internalError:"Unknown favGroupId"}))}async restoreItem(J,r){await this.portal.request(this.userContentUrl+`/items/${J.id}/restore`,{method:"post",query:r?{folderID:"string"===typeof r?r:r.id}:null})}toJSON(){throw new y("internal:not-yet-implemented","PortalUser.toJSON is not yet implemented");}static fromJSON(J){if(!J)return null;if(J.declaredClass)throw Error("JSON object is already hydrated");const r=new E({sourceJSON:J});r.read(J);return r}};g.__decorate([G.property()],
x.prototype,"access",void 0);g.__decorate([G.property({type:Date})],x.prototype,"created",void 0);g.__decorate([G.property()],x.prototype,"culture",void 0);g.__decorate([G.property()],x.prototype,"description",void 0);g.__decorate([G.property()],x.prototype,"email",void 0);g.__decorate([G.property()],x.prototype,"favGroupId",void 0);g.__decorate([G.property()],x.prototype,"fullName",void 0);g.__decorate([G.property({type:Date})],x.prototype,"modified",void 0);g.__decorate([G.property()],x.prototype,
"orgId",void 0);g.__decorate([G.property()],x.prototype,"portal",void 0);g.__decorate([G.property()],x.prototype,"preferredView",void 0);g.__decorate([G.property()],x.prototype,"privileges",void 0);g.__decorate([G.property()],x.prototype,"region",void 0);g.__decorate([G.property()],x.prototype,"role",void 0);g.__decorate([G.property()],x.prototype,"roleId",void 0);g.__decorate([G.property()],x.prototype,"sourceJSON",void 0);g.__decorate([G.property()],x.prototype,"thumbnail",void 0);g.__decorate([G.property({readOnly:!0})],
x.prototype,"thumbnailUrl",null);g.__decorate([G.property()],x.prototype,"units",void 0);g.__decorate([G.property({readOnly:!0})],x.prototype,"userContentUrl",null);g.__decorate([G.property({readOnly:!0})],x.prototype,"url",null);g.__decorate([G.property()],x.prototype,"username",void 0);g.__decorate([G.property()],x.prototype,"userLicenseTypeId",void 0);g.__decorate([G.property()],x.prototype,"userType",void 0);return x=E=g.__decorate([e.subclass("esri.portal.PortalUser")],x)})},"esri/portal/PortalFolder":function(){define("../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass".split(" "),
function(d,g,y,x,G,A,f,p){y=class extends y.JSONSupport{constructor(e){super(e);this.username=this.title=this.portal=this.id=this.created=null}get url(){const e=this.portal?.restUrl;return e?`${e}/content/users/${this.username}/${this.id}`:null}toJSON(){throw new g("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented");}};d.__decorate([x.property({type:Date})],y.prototype,"created",void 0);d.__decorate([x.property()],y.prototype,"id",void 0);d.__decorate([x.property()],y.prototype,
"portal",void 0);d.__decorate([x.property()],y.prototype,"title",void 0);d.__decorate([x.property({readOnly:!0})],y.prototype,"url",null);d.__decorate([x.property()],y.prototype,"username",void 0);return y=d.__decorate([p.subclass("esri.portal.PortalFolder")],y)})},"esri/portal/PortalItem":function(){define("require ../chunks/tslib.es6 ../assets ../core/Error ../core/JSONSupport ../core/lang ../core/Loadable ../core/urlUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../geometry/Extent ./Portal ./PortalItemResource ./PortalRating ../chunks/persistableUrlUtils".split(" "),
function(d,g,y,x,G,A,f,p,e,v,z,E,J,r,q,b,t){var n;const D=new Set("3DTiles Service;CSV;Feature Collection;Feature Service;Feed;GeoJson;Group Layer;Image Service;KML;Map Service;Media Layer;Scene Service;Stream Service;Vector Tile Service;WFS;WMS;WMTS".split(";")),Q=new Set(["KML","GeoJson","CSV"]);G=n=class extends G.JSONSupportMixin(f){static from(a){return v.ensureClass(n,a)}constructor(a){super(a);this.id=this.groupCategories=this.extent=this.description=this.culture=this.created=this.categories=
this.avgRating=this.applicationProxies=this.apiKey=this.accessInformation=this.access=null;this.isOrgItem=!1;this.url=this.typeKeywords=this.type=this.title=this.tags=this.spatialReference=this.sourceUrl=this.sourceJSON=this.snippet=this.size=this.screenshots=this.portal=this.ownerFolder=this.owner=this.numViews=this.numRatings=this.numComments=this.name=this.modified=this.licenseInfo=this.itemControl=null}destroy(){this.portal=null}get displayName(){const a=this.type,C=this.typeKeywords||[];let P=
a;"Feature Service"===a||"Feature Collection"===a?P=C.includes("Table")?"Table":C.includes("Route Layer")?"Route Layer":C.includes("Markup")?"Markup":"Feature Layer":"Image Service"===a?P=C.includes("Elevation 3D Layer")?"Elevation Layer":C.includes("Tiled Imagery")?"Tiled Imagery Layer":"Imagery Layer":"Scene Service"===a?P="Scene Layer":"Video Service"===a?P="Video Layer":"Scene Package"===a?P="Scene Layer Package":"Stream Service"===a?P="Feature Layer":"Geoprocessing Service"===a?P=C.includes("Web Tool")?
"Tool":"Geoprocessing Service":"Geoenrichment Service"===a?P="GeoEnrichment Service":"Geocoding Service"===a?P="Locator":"Microsoft Powerpoint"===a?P="Microsoft PowerPoint":"GeoJson"===a?P="GeoJSON":"Globe Service"===a?P="Globe Layer":"Vector Tile Service"===a?P="Tile Layer":"netCDF"===a?P="NetCDF":"Map Service"===a?P=C.includes("Spatiotemporal")||!C.includes("Hosted Service")&&!C.includes("Tiled")||C.includes("Relational")?"Map Image Layer":"Tile Layer":a?.toLowerCase().includes("add in")?P=a.replaceAll(/(add in)/gi,
"Add-In"):"datastore catalog service"===a?P="Big Data File Share":"Compact Tile Package"===a?P="Tile Package (tpkx)":"Raster function template"===a?P="Raster Function Template":"OGCFeatureServer"===a?P="OGC Feature Layer":"web mapping application"===a&&C.includes("configurableApp")?P="Instant App":"Insights Page"===a?P="Insights Report":"Excalibur Imagery Project"===a?P="Excalibur Project":"3DTiles Service"===a?P="3D tiles layer":"3DTiles Package"===a&&(P="3D tiles package");return P}readExtent(a){return a&&
a.length?new J(a[0][0],a[0][1],a[1][0],a[1][1]):null}get iconUrl(){var a=this.type?.toLowerCase()||"";const C=this.typeKeywords||[];var P=!1,R=!1;let Z=!1,W=!1,U=!1,u=!1;P=R=!1;0<a.indexOf("service")||"feature collection"===a||"kml"===a||"wms"===a||"wmts"===a||"wfs"===a?(P=C.includes("Hosted Service"),"feature service"===a||"feature collection"===a||"kml"===a||"wfs"===a?(R=C.includes("Table"),Z=C.includes("Route Layer"),W=C.includes("Markup"),U=C.includes("Spatiotemporal"),u=C.includes("UtilityNetwork"),
a=U&&R?"spatiotemporaltable":R?"table":Z?"routelayer":W?"markup":U?"spatiotemporal":u?"utilitynetwork":P?"featureshosted":"features"):"map service"===a||"wms"===a||"wmts"===a?(U=C.includes("Spatiotemporal"),R=C.includes("Relational"),a=U||R?"mapimages":P||C.includes("Tiled")||"wmts"===a?"maptiles":"mapimages"):a="scene service"===a?C.includes("Line")?"sceneweblayerline":C.includes("3DObject")?"sceneweblayermultipatch":C.includes("Point")?"sceneweblayerpoint":C.includes("IntegratedMesh")?"sceneweblayermesh":
C.includes("PointCloud")?"sceneweblayerpointcloud":C.includes("Polygon")?"sceneweblayerpolygon":C.includes("Building")?"sceneweblayerbuilding":C.includes("Voxel")?"sceneweblayervoxel":"sceneweblayer":"image service"===a?C.includes("Elevation 3D Layer")?"elevationlayer":C.includes("Tiled Imagery")?"tiledimagerylayer":"imagery":"stream service"===a?"streamlayer":"vector tile service"===a?"vectortile":"datastore catalog service"===a?"datastorecollection":"geocoding service"===a?"geocodeservice":"video service"===
a?C.includes("Live Stream")?"livestreamvideolayer":"videolayer":"geoprocessing service"===a?C.includes("Web Tool")?"tool":"layers":"geodata service"===a?"geodataservice":"3dtiles service"===a?C.includes("3DObject")?"3dobjecttileslayer":C.includes("IntegratedMesh")?"integratedmeshtileslayer":"3dtileslayer":"layers"):a="web map"===a||"cityengine web scene"===a?"maps":"web scene"===a?C.includes("ViewingMode-Local")?"webscenelocal":"websceneglobal":"web mapping application"===a&&C.includes("configurableApp")?
"instantapps":"web mapping application"===a||"mobile application"===a||"application"===a||"operation view"===a||"desktop application"===a?"apps":"map document"===a||"map package"===a||"published map"===a||"scene document"===a||"globe document"===a||"basemap package"===a||"mobile basemap package"===a||"mobile map package"===a||"project package"===a||"project template"===a||"pro map"===a||"layout"===a||"layer"===a&&C.includes("ArcGIS Pro")||"explorer map"===a&&C.indexOf("Explorer Document")?"mapsgray":
"service definition"===a||"shapefile"===a||"cad drawing"===a||"geojson"===a||"netcdf"===a||"administrative report"===a?"datafiles":"360 vr experience"===a?"360vr":"explorer add in"===a||"desktop add in"===a||"windows viewer add in"===a||"windows viewer configuration"===a?"appsgray":"arcgis pro add in"===a||"arcgis pro configuration"===a?"addindesktop":"pdf"===a?"pdf":"microsoft word"===a?"word":"microsoft excel"===a?"excel":"microsoft powerpoint"===a?"ppt":"rule package"===a||"file geodatabase"===
a||"sqlite geodatabase"===a||"csv collection"===a||"kml collection"===a||"windows mobile package"===a||"map template"===a||"desktop application template"===a||"gml"===a||"arcpad package"===a||"code sample"===a||"document link"===a||"earth configuration"===a||"operations dashboard add in"===a||"rules package"===a||"workflow manager package"===a||"explorer map"===a&&C.includes("Explorer Mapping Application")||C.includes("Document")?"datafilesgray":"network analysis service"===a||"geoprocessing service"===
a||"geodata service"===a||"geometry service"===a||"geoprocessing package"===a||"locator package"===a||"geoprocessing sample"===a||"workflow manager service"===a?"toolsgray":"layer"===a||"layer package"===a||"explorer layer"===a?"layersgray":"analysis model"===a?"analysismodel":"scene package"===a?"scenepackage":"3dtiles package"===a?"3dtileslayerpackage":"3dtiles service"===a?"3dtileslayer":"mobile scene package"===a?"mobilescenepackage":"tile package"===a||"compact tile package"===a?"tilepackage":
"task file"===a?"taskfile":"report template"===a?"report-template":"statistical data collection"===a?"statisticaldatacollection":"insights workbook"===a?"workbook":"insights model"===a?"insightsmodel":"insights page"===a?"insightspage":"insights theme"===a?"insightstheme":"hub initiative"===a?"hubinitiative":"hub page"===a?"hubpage":"hub site application"===a?"hubsite":"hub event"===a?"hubevent":"hub project"===a?"hubproject":"relational database connection"===a?"relationaldatabaseconnection":"big data file share"===
a?"datastorecollection":"image collection"===a?"imagecollection":"desktop style"===a?"desktopstyle":"style"===a?C.includes("Dictionary")?"dictionarystyle":"style":"dashboard"===a?"dashboard":"raster function template"===a?"rasterprocessingtemplate":"vector tile package"===a?"vectortilepackage":"ortho mapping project"===a?"orthomappingproject":"ortho mapping template"===a?"orthomappingtemplate":"solution"===a?"solutions":"geopackage"===a?"geopackage":"deep learning package"===a?"deeplearningpackage":
"real time analytic"===a?"realtimeanalytics":"big data analytic"===a?"bigdataanalytics":"feed"===a?"feed":"excalibur imagery project"===a?"excaliburimageryproject":"notebook"===a?"notebook":"storymap"===a?"storymap":"survey123 add in"===a?"survey123addin":"mission"===a?"mission":"mission report"===a?"missionreport":"mission template"===a?"missiontemplate":"quickcapture project"===a?"quickcaptureproject":"pro report"===a?"proreport":"pro report template"===a?"proreporttemplate":"urban model"===a?"urbanmodel":
"web experience"===a?"experiencebuilder":"web experience template"===a?"webexperiencetemplate":"experience builder widget"===a?"experiencebuilderwidget":"experience builder widget package"===a?"experiencebuilderwidgetpackage":"workflow"===a?"workflow":"kernel gateway connection"===a?"kernelgatewayconnection":"insights script"===a?"insightsscript":"hub initiative template"===a?"hubinitiativetemplate":"storymap theme"===a?"storymaptheme":"knowledge graph"===a?"knowledgegraph":"knowledge graph layer"===
a?"knowledgegraphlayer":"knowledge studio project"===a?"knowledgestudio":"native application"===a?"nativeapp":"native application installer"===a?"nativeappinstaller":"web link chart"===a?"linkchart":"knowledge graph web investigation"===a?"investigation":"ogcfeatureserver"===a?"features":"pro project"===a?"proproject":"insights workbook package"===a?"insightsworkbookpackage":"apache parquet"===a?"apacheparquet":"notebook code snippet library"===a?"notebookcodesnippets":"suitability model"===a?"suitabilitymodel":
"esri classifier definition"===a?"classifierdefinition":"esri classification schema"===a?"classificationschema":"insights data engineering workbook"===a?"dataengineeringworkbook":"insights data engineering model"===a?"dataengineeringmodel":"deep learning studio project"===a?"deeplearningproject":"discussion"===a?"discussion":"allsource project"===a?"allsourceproject":"api key"===a?"apikey":"data pipeline"===a?"datapipelines":"group layer"===a?(P=C.includes("Map"))?"layergroup2d":"layergroup":"media layer"===
a?"onlinemedialayer":"form"===a?C.includes("Survey123")?"survey":"datafilesgray":"csv"===a?"csv":"image"===a?"image":"maps";return a?y.getAssetUrl("esri/images/portal/"+a+"16.png"):null}get isLayer(){return null!=this.type&&D.has(this.type)}get itemCdnUrl(){return t.toCDNUrl(this.itemUrl)}get itemPageUrl(){const a=this.portal?.itemPageUrl;return a&&this.id?`${a}?id=${this.id}`:null}get itemUrl(){const a=this.portal?.restUrl;return a&&this.id?`${a}/content/items/${this.id}`:null}get thumbnailUrl(){const a=
this.itemUrl,C=this.thumbnail;return a&&C?this.portal?.normalizeUrl(`${a}/info/${C}?f=json`)??null:null}get userItemUrl(){const a=this.portal?.restUrl;if(!a)return null;const C=this.owner||this.portal?.user?.username;return C?`${a}/content/users/${this.ownerFolder?`${C}/${this.ownerFolder}`:C}/items/${this.id}`:null}load(a){const C=this.portal??(this.portal=r.getDefault()),P=C.load(a).then(()=>this.sourceJSON?this.sourceJSON:this.id&&this.itemUrl?C.request(this.itemUrl,{signal:null!=a?a.signal:null,
query:{token:this.apiKey}}):{}).then(R=>{this.sourceJSON=R;this.read(R)});this.addResolvingPromise(P);return Promise.resolve(this)}async addRating(a){const C={method:"post",query:{}};a instanceof b&&(a=a.rating);null==a||isNaN(a)||"number"!==typeof a||(C.query.rating=a);if(!this.portal)return null;await this.portal.request(this.itemUrl+"/addRating",C);return new b({rating:a,created:new Date})}clone(){var a={access:this.access,accessInformation:this.accessInformation,applicationProxies:A.clone(this.applicationProxies),
avgRating:this.avgRating,categories:A.clone(this.categories),created:A.clone(this.created),culture:this.culture,description:this.description,extent:A.clone(this.extent),groupCategories:A.clone(this.groupCategories),id:this.id,itemControl:this.itemControl,licenseInfo:this.licenseInfo,modified:A.clone(this.modified),name:this.name,numComments:this.numComments,numRatings:this.numRatings,numViews:this.numViews,owner:this.owner,ownerFolder:this.ownerFolder,portal:this.portal,screenshots:A.clone(this.screenshots),
size:this.size,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:A.clone(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:A.clone(this.typeKeywords),url:this.url};this.loaded&&(a.loadStatus="loaded");a=(new n({sourceJSON:this.sourceJSON})).set(a);a._set("isOrgItem",this.isOrgItem);return a}createPostQuery(){const a=this.toJSON();for(var C of["tags","typeKeywords","categories"])a[C]=a[C]?.join(", ");({extent:C}=a);C&&(a.extent=
JSON.stringify(C));return a}async deleteRating(){await this.portal.request(this.itemUrl+"/deleteRating",{method:"post"})}fetchData(a="json",C){return this.portal.request(this.itemUrl+"/data",{responseType:a,...C,query:{token:this.apiKey}})}async fetchRating(a){a=await this.portal.request(this.itemUrl+"/rating",{query:{token:this.apiKey},...a});return null!=a.rating?(a.created=new Date(a.created),new b(a)):null}fetchRelatedItems(a,C){return this.portal.requestToTypedArray(this.itemUrl+"/relatedItems",
{query:{...a,token:this.apiKey},...C},n)}getThumbnailUrl(a){let C=this.thumbnailUrl;C&&a&&(C+=`&w=${a}`);return C}reload(){return this.portal.request(this.itemUrl??"",{cacheBust:!0,query:{token:this.apiKey}}).then(a=>{this.sourceJSON=a;this.read(a);return this})}update(a){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const C=a?.data,P={method:"post"};P.query=this.createPostQuery();for(const R in P.query)null===P.query[R]&&(P.query[R]="");P.query.clearEmptyFields=!0;null!=C&&
("string"===typeof C?P.query.text=C:"object"===typeof C&&(P.query.text=JSON.stringify(C)));return this.portal.request(`${this.userItemUrl}/update`,P).then(()=>this.reload())}):Promise.reject(new x("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async copy(a){if(!this.id)throw new x("portal:item-does-not-exist","The item does not exist yet");await this.load();const {portal:C,itemUrl:P}=this;await C.signIn();const {copyResources:R,folder:Z,tags:W,title:U}=a||{};a=
{method:"post",query:{copyPrivateResources:"all"===R,folder:"string"===typeof Z?Z:Z?.id,includeResources:!!R,tags:W?.join(","),title:U}};({itemId:a}=await C.request(`${P}/copy`,a));return new n({id:a,portal:C})}updateThumbnail(a){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const C=a.thumbnail,P=a.filename,R={method:"post"};if("string"===typeof C)p.isDataProtocol(C)?R.query={data:C}:R.query={url:p.makeAbsolute(C)},null!=P&&(R.query.filename=P);else{const Z=new FormData;null!=
P?Z.append("file",C,P):Z.append("file",C);R.body=Z}return this.portal.request(`${this.userItemUrl}/updateThumbnail`,R).then(()=>this.reload())}):Promise.reject(new x("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async fetchResources(a={},C){const {fetchResources:P}=await new Promise((R,Z)=>d(["./support/resourceUtils"],R,Z));return P(this,a,C)}async addResource(a,C,P){const {addOrUpdateResources:R}=await new Promise((Z,W)=>d(["./support/resourceUtils"],Z,W));a.portalItem=
this;await R(this,[{resource:a,content:C,compress:P?.compress,access:P?.access}],"add",P);return a}async removeResource(a,C){const {removeResource:P}=await new Promise((R,Z)=>d(["./support/resourceUtils"],R,Z));if(a.portalItem&&a.portalItem.itemUrl!==this.itemUrl)throw new x("removeresource:portal-item-mismatch","The portal item associated with the provided resource does not match the item");return P(this,a,C)}async removeAllResources(a){const {removeAllResources:C}=await new Promise((P,R)=>d(["./support/resourceUtils"],
P,R));return C(this,a)}resourceFromPath(a){return new q({portalItem:this,path:a})}toJSON(){var a=this.extent;a={accessInformation:this.accessInformation,categories:A.clone(this.categories),created:this.created?.getTime(),description:this.description,extent:a&&[[a.xmin,a.ymin],[a.xmax,a.ymax]],id:this.id,isOrgItem:this.isOrgItem,licenseInfo:this.licenseInfo,modified:this.modified?.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,
tags:A.clone(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:A.clone(this.typeKeywords),url:this.url};return A.fixJson(a)}static fromJSON(a){if(!a)return null;if(a.declaredClass)throw Error("JSON object is already hydrated");return new n({sourceJSON:a})}_getPostQuery(){const a=this.toJSON();for(const C in a)"tags"===C&&null!==a[C]&&(a[C]=a[C].join(", ")),"typeKeywords"===C&&null!==a[C]&&(a[C]=a[C].join(", ")),"extent"===C&&a[C]&&(a[C]=JSON.stringify(a[C]));return a}};
g.__decorate([e.property({type:["private","shared","org","public"]})],G.prototype,"access",void 0);g.__decorate([e.property()],G.prototype,"accessInformation",void 0);g.__decorate([e.property({type:String})],G.prototype,"apiKey",void 0);g.__decorate([e.property({json:{read:{source:"appProxies"}}})],G.prototype,"applicationProxies",void 0);g.__decorate([e.property()],G.prototype,"avgRating",void 0);g.__decorate([e.property()],G.prototype,"categories",void 0);g.__decorate([e.property({type:Date})],
G.prototype,"created",void 0);g.__decorate([e.property()],G.prototype,"culture",void 0);g.__decorate([e.property()],G.prototype,"description",void 0);g.__decorate([e.property({readOnly:!0})],G.prototype,"displayName",null);g.__decorate([e.property({type:J})],G.prototype,"extent",void 0);g.__decorate([z.reader("extent")],G.prototype,"readExtent",null);g.__decorate([e.property()],G.prototype,"groupCategories",void 0);g.__decorate([e.property({readOnly:!0})],G.prototype,"iconUrl",null);g.__decorate([e.property()],
G.prototype,"id",void 0);g.__decorate([e.property({readOnly:!0})],G.prototype,"isLayer",null);g.__decorate([e.property({type:Boolean,readOnly:!0})],G.prototype,"isOrgItem",void 0);g.__decorate([e.property()],G.prototype,"itemControl",void 0);g.__decorate([e.property({readOnly:!0})],G.prototype,"itemPageUrl",null);g.__decorate([e.property({readOnly:!0})],G.prototype,"itemUrl",null);g.__decorate([e.property()],G.prototype,"licenseInfo",void 0);g.__decorate([e.property({type:Date})],G.prototype,"modified",
void 0);g.__decorate([e.property()],G.prototype,"name",void 0);g.__decorate([e.property()],G.prototype,"numComments",void 0);g.__decorate([e.property()],G.prototype,"numRatings",void 0);g.__decorate([e.property()],G.prototype,"numViews",void 0);g.__decorate([e.property()],G.prototype,"owner",void 0);g.__decorate([e.property()],G.prototype,"ownerFolder",void 0);g.__decorate([e.property({type:r})],G.prototype,"portal",void 0);g.__decorate([e.property()],G.prototype,"screenshots",void 0);g.__decorate([e.property()],
G.prototype,"size",void 0);g.__decorate([e.property()],G.prototype,"snippet",void 0);g.__decorate([e.property()],G.prototype,"sourceJSON",void 0);g.__decorate([e.property({type:String})],G.prototype,"sourceUrl",void 0);g.__decorate([e.property({type:String})],G.prototype,"spatialReference",void 0);g.__decorate([e.property()],G.prototype,"tags",void 0);g.__decorate([e.property()],G.prototype,"thumbnail",void 0);g.__decorate([e.property({readOnly:!0})],G.prototype,"thumbnailUrl",null);g.__decorate([e.property()],
G.prototype,"title",void 0);g.__decorate([e.property()],G.prototype,"type",void 0);g.__decorate([e.property()],G.prototype,"typeKeywords",void 0);g.__decorate([e.property({type:String,json:{read(a,C){Q.has(C.type)&&(C=this.portal?.restUrl,a||=C&&this.id?`${C}/content/items/${this.id}/data`:null);return a}}})],G.prototype,"url",void 0);g.__decorate([e.property({readOnly:!0})],G.prototype,"userItemUrl",null);return G=n=g.__decorate([E.subclass("esri.portal.PortalItem")],G)})},"esri/portal/PortalItemResource":function(){define("require ../chunks/tslib.es6 ../core/Accessor ../core/Error ../core/Logger ../core/urlUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/RandomLCG ../core/has ../core/accessorSupport/decorators/subclass".split(" "),
function(d,g,y,x,G,A,f,p,e,v,z){function E(J,r){if(null==J)return J;J=J.replace(/^\/+/,"");null!=r&&A.isAbsolute(J)&&(J=A.makeRelative(J,r.itemUrl));return J?.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,"")}y=class extends y{constructor(J){super(J);this.portalItem=null}normalizeCtorArgs(J){return J?.portalItem&&J.path?{...J,path:E(J.path,J.portalItem)}:J}set path(J){null!=J&&A.isAbsolute(J)?G.getLogger(this).error("portalitemresource:invalid-path","A portal item resource path must be relative"):
this._set("path",J)}_castPath(J){return E(J,this.portalItem)}get url(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}get cdnUrl(){return this.portalItem&&this.path?`${this.portalItem.itemCdnUrl}/resources/${this.path}`:null}get itemRelativeUrl(){return this.portalItem&&this.path?`./resources/${this.path}`:null}fetch(J="json",r){const q=this.cdnUrl;if(null==q)throw new x("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");
return this.portalItem.portal.request(q,{responseType:J,query:{token:this.portalItem.apiKey},signal:r?.signal})}async update(J,r){const {addOrUpdateResources:q}=await new Promise((b,t)=>d(["./support/resourceUtils"],b,t));await q(this.portalItem,[{resource:this,content:J,compress:r?.compress,access:r?.access}],"update",r);return this}hasPath(){return null!=this.path}};g.__decorate([f.property()],y.prototype,"portalItem",void 0);g.__decorate([f.property({type:String,value:null})],y.prototype,"path",
null);g.__decorate([p.cast("path")],y.prototype,"_castPath",null);g.__decorate([f.property({type:String,readOnly:!0})],y.prototype,"url",null);g.__decorate([f.property({type:String,readOnly:!0})],y.prototype,"cdnUrl",null);g.__decorate([f.property({type:String,readOnly:!0})],y.prototype,"itemRelativeUrl",null);return y=g.__decorate([z.subclass("esri.portal.PortalItemResource")],y)})},"esri/portal/PortalRating":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass".split(" "),
function(d,g,y,x,G,A,f){g=class extends g{constructor(p){super(p);this.rating=this.created=null}};d.__decorate([y.property()],g.prototype,"created",void 0);d.__decorate([y.property()],g.prototype,"rating",void 0);return g=d.__decorate([f.subclass("esri.portal.PortalRating")],g)})},"esri/chunks/persistableUrlUtils":function(){define(["exports","../kernel","../core/urlUtils","../portal/support/urlUtils"],function(d,g,y,x){function G(n,D){var Q=D?.url?.path;n&&Q&&(n=y.makeAbsolute(n,Q,{preserveProtocolRelative:!0}),
D.portalItem&&D.readResourcePaths&&(Q=y.makeRelative(n,D.portalItem.itemUrl),null!=Q&&b.test(Q)&&D.readResourcePaths.push(D.portalItem.resourceFromPath(Q).path)));return(n=E(n,D?.portal))&&q.test(n)?J(n):n}function A(n,D,Q=d.MarkKeep.YES){n=n&&q.test(n)?r(n):n;if(null==n)return n;!y.isAbsolute(n)&&D?.blockedRelativeUrls&&D.blockedRelativeUrls.push(n);let a=y.makeAbsolute(n);if(D){var C=D.verifyItemRelativeUrls?.rootPath||D.url?.path;if(C){C=E(C,D.portal);const P=E(a,D.portal);a=y.makeRelative(P,C,
C);null!=a&&a!==P&&a!==n&&D.verifyItemRelativeUrls&&D.verifyItemRelativeUrls.writtenUrls.push(a)}}a=z(a,D?.portal);y.isAbsolute(a)&&(a=y.normalize(a));D?.resources&&D?.portalItem&&!y.isAbsolute(a)&&!y.isDataProtocol(a)&&Q===d.MarkKeep.YES&&D.resources.toKeep.push({resource:D.portalItem.resourceFromPath(a),compress:!1});return a}function f(n,D,Q){return G(n,Q)}function p(n,D,Q,a){n=A(n,a);void 0!==n&&(D[Q]=n)}function e(n){return(n?.match(q)??null)?.[1]??null}function v(n){n=n?.match(q)??null;if(null==
n)return null;n=n[2];const D=n.lastIndexOf("/");if(-1===D){const {path:C,extension:P}=y.splitPathExtension(n);return{prefix:null,filename:C,extension:P}}const {path:Q,extension:a}=y.splitPathExtension(n.slice(D+1));return{prefix:n.slice(0,D),filename:Q,extension:a}}function z(n,D){return D&&!D.isPortal&&D.urlKey&&D.customBaseUrl?y.changeDomain(n,`${D.urlKey}.${D.customBaseUrl}`,D.portalHostname):n}function E(n,D){if(!D||D.isPortal||!D.urlKey||!D.customBaseUrl)return n;const Q=`${D.urlKey}.${D.customBaseUrl}`,
a=y.getAppUrl();return y.hasSameOrigin(a,`${a.scheme}://${Q}`)?y.changeDomain(n,D.portalHostname,Q):y.changeDomain(n,Q,D.portalHostname)}function J(n){if(!n)return n||null;n&&g.id&&!g.id.findCredential(n)&&(n=x.normalizeArcGISOnlineOrgDomain(n),n=n.replace(/^https?:\/\/www\.arcgis\.com/,"https://cdn.arcgis.com"),n=n.replace(/^https?:\/\/devext\.arcgis\.com/,"https://cdndev.arcgis.com"),n=n.replace(/^https?:\/\/qaext\.arcgis\.com/,"https://cdnqa.arcgis.com"));return n}function r(n){if(!n)return n||
null;n=n.replace(/^https?:\/\/cdn\.arcgis\.com/,"https://www.arcgis.com");n=n.replace(/^https?:\/\/cdndev\.arcgis\.com/,"https://devext.arcgis.com");(n=n.replace(/^https?:\/\/cdnqa\.arcgis\.com/,"https://qaext.arcgis.com"))&&g.id&&!g.id.findCredential(n)&&(n=x.normalizeArcGISOnlineOrgDomain(n));return n}const q=/\/items\/([^/]+)\/resources\/(.*)/,b=/^\.\/resources\//;d.MarkKeep=void 0;(function(n){n[n.YES=0]="YES";n[n.NO=1]="NO"})(d.MarkKeep||(d.MarkKeep={}));const t=Object.freeze(Object.defineProperty({__proto__:null,
get MarkKeep(){return d.MarkKeep},ensureMainOnlineDomain:z,fromCDNUrl:r,fromJSON:G,itemIdFromResourceUrl:e,prefixAndFilenameFromResourceUrl:v,read:f,toCDNUrl:J,toJSON:A,write:p},Symbol.toStringTag,{value:"Module"}));d.ensureMainOnlineDomain=z;d.fromCDNUrl=r;d.fromJSON=G;d.itemIdFromResourceUrl=e;d.persistableUrlUtils=t;d.prefixAndFilenameFromResourceUrl=v;d.read=f;d.toCDNUrl=J;d.toJSON=A;d.write=p})},"esri/support/basemapDefinitions":function(){define(["exports","../assets","../intl/messages"],function(d,
g,y){d.esriBasemapDefinitions={satellite:{id:"satellite",classic:!0,get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/satellite.jpg")},baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",classic:!0,get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/hybrid.jpg")},baseMapLayers:[{id:"hybrid-base-layer",
url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/30d6b8271e1849cd9c3042060001f425/resources/styles/root.json",layerType:"VectorTileLayer",title:"Hybrid Reference Layer",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",classic:!0,get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/terrain.jpg")},
baseMapLayers:[{id:"terrain-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Terrain Base",showLegend:!1,visibility:!0,opacity:1},{id:"terrain-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Reference Overlay",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},oceans:{id:"oceans",
classic:!0,get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/oceans.jpg")},baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Reference",
isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},osm:{id:"osm",classic:!0,get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/osm.jpg")},baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",classic:!0,get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/dark-gray-vector.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json",
layerType:"VectorTileLayer",title:"Dark Gray Base",visibility:!0,opacity:1},{id:"dark-gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get "dark-gray"(){return{...this["dark-gray-vector"],id:"dark-gray"}},"gray-vector":{id:"gray-vector",classic:!0,get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/gray-vector.jpg")},
baseMapLayers:[{id:"gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Base",visibility:!0,opacity:1},{id:"gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get gray(){return{...this["gray-vector"],
id:"gray"}},"streets-vector":{id:"streets-vector",classic:!0,get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/streets-vector.jpg")},baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,opacity:1}]},get streets(){return{...this["streets-vector"],id:"streets"}},"topo-vector":{id:"topo-vector",classic:!0,get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/topo-vector.jpg")},
baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"topo-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},get topo(){return{...this["topo-vector"],id:"topo"}},
"streets-night-vector":{id:"streets-night-vector",classic:!0,get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/streets-night.jpg")},baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",classic:!0,get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/streets-relief.jpg")},
baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",title:"World Streets Relief",layerType:"VectorTileLayer",visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",
classic:!0,get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/streets-navigation.jpg")},baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]},"topo-3d":{id:"topo-3d",is3d:!0,get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/topo-3d.png")},baseMapLayers:[{id:"topo-3d-base-layer",
styleUrl:"https://www.arcgis.com/sharing/rest/content/items/1e7d1784d1ef4b79ba6764d0bd6c3150/resources/styles/root.json",layerType:"VectorTileLayer",title:"Topographic",visibility:!0,opacity:1},{id:"topo-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",
itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-3d":{id:"navigation-3d",is3d:!0,get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/navigation-3d.jpg")},baseMapLayers:[{id:"navigation-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/ccc904ff872b4144b94934e55e32784b/resources/styles/root.json",
layerType:"VectorTileLayer",title:"Navigation",visibility:!0,opacity:1},{id:"navigation-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",
layerType:"ArcGISSceneServiceLayer"}]},"streets-3d":{id:"streets-3d",is3d:!0,get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/streets-3d.png")},baseMapLayers:[{id:"streets-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/198298c4c64c4cb19de5b46aa00c198d/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"streets-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",
itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"streets-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"osm-3d":{id:"osm-3d",is3d:!0,get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/osm-3d.png")},baseMapLayers:[{id:"osm-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/8628d259c9d14bdc848771c23c513940/resources/styles/root.json",
layerType:"VectorTileLayer",title:"OpenStreetMap",visibility:!0,opacity:1},{id:"osm-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},
{id:"osm-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"gray-3d":{id:"gray-3d",is3d:!0,get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/gray-3d.png")},baseMapLayers:[{id:"gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/01a14b466345455ba4176d2e6390db92/resources/styles/root.json",layerType:"VectorTileLayer",
title:"Streets",visibility:!0,opacity:1},{id:"gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-dark-3d":{id:"navigation-dark-3d",
itemId:"5a1365328b4943f09a54cf5fd1205707",is3d:!0,baseMapLayers:[{id:"navigation-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/451a1777ab3f4bf095fae24a117439d9/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation Dark"},{id:"navigation-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},
{id:"navigation-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"streets-dark-3d":{id:"streets-dark-3d",itemId:"8a4efa2c20484ec9b4557895e65736ff",is3d:!0,baseMapLayers:[{id:"streets-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/bc599b6d741a4ac084b7eea7bf8c5938/resources/styles/root.json",layerType:"VectorTileLayer",
title:"OpenStreetMap Streets Night (for 3D)"},{id:"streets-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"streets-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},
"dark-gray-3d":{id:"dark-gray-3d",itemId:"a8b7322a5fe94002bb0f5e0eeb0c5c18",is3d:!0,baseMapLayers:[{id:"dark-gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/4178f71acb934fb89f169e7d667c20c6/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Dark Gray Canvas (for 3D)"},{id:"dark-gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",
layerType:"ArcGISSceneServiceLayer"},{id:"dark-gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"arcgis-imagery":{get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/hybrid.jpg")},title:"Imagery Hybrid",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"},
{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-imagery-standard":{get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/satellite.jpg")},title:"Imagery",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"}]},"arcgis-imagery-labels":{title:"Hybrid [Reference]",
baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-light-gray":{get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/gray-vector.jpg")},title:"Light Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Base",title:"Light Gray Canvas Base"},{layerType:"VectorTileLayer",
styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Labels",title:"Light Gray Canvas Labels",isReference:!0}]},"arcgis-dark-gray":{get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/dark-gray.jpg")},title:"Dark Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Base",title:"Dark Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Labels",
title:"Dark Gray Canvas Labels",isReference:!0}]},"arcgis-navigation":{get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/streets-navigation.jpg")},title:"Navigation",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Navigation",title:"World Navigation Map"}]},"arcgis-navigation-night":{title:"Navigation (Dark Mode)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:NavigationNight",
title:"World Navigation Map (Dark Mode)"}]},"arcgis-streets":{get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/streets-vector.jpg")},title:"Streets",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Streets",title:"World Street Map"}]},"arcgis-streets-night":{get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/streets-night.jpg")},title:"Streets (Night)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsNight",
title:"World Street Map (Night)"}]},"arcgis-streets-relief":{get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/streets-relief.jpg")},title:"Streets (with Relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsRelief:Base",title:"World Street Map (with Relief)"}]},
"arcgis-topographic":{get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/topo.jpg")},title:"Topographic",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Topographic:Base",title:"World Topographic Map"}]},"arcgis-oceans":{get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/oceans.jpg")},
title:"Oceans",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Ocean Base",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Oceans:Labels",title:"World Ocean Reference",isReference:!0}]},"osm-standard":{title:"OpenStreetMap",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Standard",
title:"OpenStreetMap"}]},"osm-standard-relief":{title:"OpenStreetMap (with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StandardRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-streets":{title:"OpenStreetMap (Streets)",baseMapLayers:[{layerType:"VectorTileLayer",
styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Streets",title:"OpenStreetMap (Streets)"}]},"osm-streets-relief":{title:"OpenStreetMap (Streets with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StreetsRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},
"osm-light-gray":{title:"OpenStreetMap (Light Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Base",title:"OSM (Light Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Labels",title:"OSM (Light Gray Reference)",isReference:!0}]},"osm-dark-gray":{title:"OpenStreetMap (Dark Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",
styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Base",title:"OSM (Dark Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Labels",title:"OSM (Dark Gray Reference)",isReference:!0}]},"arcgis-terrain":{title:"Terrain with Labels",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},
{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Base",title:"World Terrain Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Detail",title:"World Terrain Reference",isReference:!0}]},"arcgis-community":{title:"Community",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Community",title:"Community"}]},
"arcgis-charted-territory":{title:"Charted Territory",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ChartedTerritory:Base",title:"Charted Territory"}]},"arcgis-colored-pencil":{title:"Colored Pencil",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ColoredPencil",
title:"Colored Pencil"}]},"arcgis-nova":{title:"Nova",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Nova",title:"Nova"}]},"arcgis-modern-antique":{title:"Modern Antique",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ModernAntique:Base",
title:"Modern Antique"}]},"arcgis-midcentury":{title:"Mid-Century",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Midcentury",title:"Mid-Century"}]},"arcgis-newspaper":{title:"Newspaper",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Newspaper",title:"Newspaper"}]},"arcgis-hillshade-light":{title:"Hillshade",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",
showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"}]},"arcgis-hillshade-dark":{title:"Hillshade (Dark)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade (Dark)",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade_Dark/MapServer"}]},"arcgis-human-geography":{title:"Human Geography",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Base",
title:"Human Geography Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Detail",title:"Human Geography Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Label",title:"Human Geography Label",isReference:!0}]},"arcgis-human-geography-dark":{title:"Human Geography (Dark)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Base",
title:"Human Geography Dark Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Detail",title:"Human Geography Dark Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Label",title:"Human Geography Dark Label",isReference:!0}]}};d.getBasemapTitle=async function(x){if(x){var G=x.includes("-vector")?x.slice(0,x.indexOf("-vector")):
x.includes("-3d")?x.slice(0,x.indexOf("-3d")):x,A=await y.fetchMessageBundle("esri/t9n/basemaps");return A[x]||A[G]}};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/support/BasemapStyle":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass ../intl/locale".split(" "),function(d,g,y,x,G,A,f,p){const e=new Set("ar bs ca hr cs da nl en et fi fr de el he hu id it ja ko lv lt nb pl ro ru sr es sv th tr uk vi".split(" "));
g=class extends g{constructor(v){super(v);this.places=this.language=this.id=null;this.serviceUrl="https://basemapstyles-api.arcgis.com/arcgis/rest/services/styles/v2/webmaps";this.worldview=null}getLanguageParamValue(){if(this.language)return this.language;var v=p.getLocale().toLowerCase();switch(v){case "pt-br":return"pt-BR";case "pt-pt":return"pt-PT";case "zh-cn":return"zh-CN";case "zh-hk":return"zh-HK";case "zh-tw":return"zh-TW"}v=p.getLanguage(v);return"pt"===v?"pt-BR":v&&e.has(v)?v:"global"}};
d.__decorate([y.property()],g.prototype,"id",void 0);d.__decorate([y.property()],g.prototype,"language",void 0);d.__decorate([y.property()],g.prototype,"places",void 0);d.__decorate([y.property()],g.prototype,"serviceUrl",void 0);d.__decorate([y.property()],g.prototype,"worldview",void 0);return g=d.__decorate([f.subclass("esri.support.BasemapStyle")],g)})},"esri/webdoc/support/writeUtils":function(){define("exports ../../core/Error ../../core/lang ../../core/object ../../core/accessorSupport/extensions/serializableProperty/writer ../../layers/support/layerUtils".split(" "),
function(d,g,y,x,G,A){function f(v,z){"maxScale"in v&&(z.maxScale=G.numberToJSON(v.maxScale)??void 0);"minScale"in v&&(z.minScale=G.numberToJSON(v.minScale)??void 0)}const p=new Set("bing-maps imagery imagery-tile map-image open-street-map tile unknown unsupported vector-tile web-tile wms wmts".split(" ")),e=new Set("catalog csv feature geo-rss geojson group imagery imagery-tile kml knowledge-graph map-image map-notes media ogc-feature oriented-imagery route stream subtype-group tile unknown unsupported vector-tile web-tile wfs wms wmts".split(" "));
d.disableRestrictedWriting=function(v){p.add(v);e.add(v)};d.enableRestrictedWriting=function(v){p.delete(v);e.delete(v)};d.getLayerJSON=function(v,z,E){if(!v.persistenceEnabled)return null;if(!("write"in v&&v.write))return E?.messages&&E.messages.push(new g("layer:unsupported",`Layers (${v.title}, ${v.id}) of type '${v.declaredClass}' cannot be persisted`,{layer:v})),null;if(A.isFeatureCollectionLayer(v)&&!v.isTable)z=v.resourceInfo;else{if(E.restrictedWebMapWriting){var J="basemap"===E.layerContainerType?
p:"operational-layers"===E.layerContainerType?e:null;J=null!=J?J.has(v.type)&&!A.isFeatureCollectionLayer(v):!0}else J=!0;if(J)return z={},v.write(z,E)?z:null}if(null!=z){z=y.clone(z);if(E=z)A.isFeatureCollectionLayer(v)?(J=x.getDeepValue("featureCollection.layers",E)?.[0]?.layerDefinition)&&f(v,J):"group"!==v.type&&f(v,E);if(E&&(E.id=v.id,"blendMode"in v&&(E.blendMode=v.blendMode,"normal"===E.blendMode&&delete E.blendMode),E.opacity=G.numberToJSON(v.opacity)??void 0,E.title=v.title||"Layer",E.visibility=
v.visible,"legendEnabled"in v&&"wmts"!==v.type))if(A.isFeatureCollectionLayer(v)){if(E=E.featureCollection)E.showLegend=v.legendEnabled}else E.showLegend=v.legendEnabled}return z};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/layerUtils":function(){define(["exports","../../kernel","../../request"],function(d,g,y){function x(A){return"scene"===A?.type}function G(A){A=A?.type;return"imagery-tile"===A||"tile"===A||"open-street-map"===A||"vector-tile"===A||"web-tile"===
A||"wmts"===A}d.getEffectiveEditingEnabled=function(A){a:if("editingEnabled"in A)switch(A.type){case "csv":case "feature":case "geojson":case "oriented-imagery":case "scene":case "subtype-group":case "subtype-sublayer":var f=!0;break a;default:f=!1}else f=!1;return f?"effectiveEditingEnabled"in A?A.effectiveEditingEnabled:A.editingEnabled:!1};d.getEffectiveLayerCapabilities=function(A){a:if("capabilities"in A)switch(A.type){case "catalog":case "catalog-footprint":case "csv":case "feature":case "geojson":case "imagery":case "knowledge-graph-sublayer":case "ogc-feature":case "oriented-imagery":case "scene":case "sublayer":case "subtype-group":case "subtype-sublayer":case "wfs":var f=
!0;break a;default:f=!1}else f=!1;return f?"effectiveCapabilities"in A?A.effectiveCapabilities:A.capabilities:null};d.getOwningPortalUrl=async function(A,f){var p=g.id?.findServerInfo(A);if(null!=p?.currentVersion)return p.owningSystemUrl||null;p=A.toLowerCase().indexOf("/rest/services");if(-1===p)return null;A=`${A.substring(0,p)}/rest/info`;({data:f}=await y(A,{query:{f:"json"},responseType:"json",signal:null!=f?f.signal:null}));return f?.owningSystemUrl||null};d.getTileMaxtrixSetFromActiveLayer=
function(A){if(A.activeLayer){const f=A.activeLayer.tileMatrixSet;if(f)return f;if(A=A.activeLayer.tileMatrixSets)return A}return null};d.isBaseLayer=function(A){return null!=A?.parent&&"declaredClass"in A.parent&&"esri.Basemap"===A.parent.declaredClass&&A.parent.baseLayers.includes(A)};d.isBasemap3DSupportedLayer=function(A){return G(A)||x(A)};d.isBasemapSupportedTiledLayer=G;d.isFeatureCollectionLayer=function(A){return"feature"===A?.type&&!A.url&&"memory"===A.source?.type};d.isFeatureLayer=function(A){return null!=
A&&"object"===typeof A&&"type"in A&&"feature"===A.type};d.isFeatureServiceLayer=function(A){return"feature"===A?.type&&"feature-layer"===A.source?.type};d.isGraphicsLayer=function(A){return null!=A&&"object"===typeof A&&"type"in A&&"graphics"===A.type};d.isGroupLayer=function(A){return null!=A&&"type"in A&&"group"===A.type};d.isImageryTileLayer=function(A){return"imagery-tile"===A?.type};d.isIntegratedMeshLayer=function(A){return"integrated-mesh"===A||"integrated-mesh-3dtiles"===A};d.isIntegratedMeshOperationalLayer=
function(A){return"IntegratedMeshLayer"===A||"IntegratedMesh3DTilesLayer"===A};d.isKnowledgeGraphLayer=function(A){return null!=A&&"object"===typeof A&&"type"in A&&"knowledge-graph"===A.type&&"layers"in A};d.isLayerWithFeatureLayerSource=function(A){return("feature"===A?.type||"subtype-group"===A?.type)&&"feature-layer"===A.source?.type};d.isLinkChartLayer=function(A){return null!=A&&"object"===typeof A&&"type"in A&&"link-chart"===A.type&&"layers"in A};d.isMapNotesLayer=function(A){return null!=A&&
"object"===typeof A&&"type"in A&&"map-notes"===A.type&&"sublayers"in A};d.isSceneLayer=x;d.isSceneServiceLayer=function(A){A=A?.type;return"building-scene"===A||"integrated-mesh"===A||"point-cloud"===A||"scene"===A};d.isSubtypeGroupLayer=function(A){return null!=A&&"object"===typeof A&&"type"in A&&"subtype-group"===A.type&&"sublayers"in A};d.isSubtypeSublayer=function(A){return"subtype-sublayer"===A?.type};d.isTable=function(A){return null!=A&&"object"===typeof A&&"isTable"in A&&!!A.isTable};d.isTiledLayer=
function(A){A=A?.type;return"base-tile"===A||"tile"===A||"elevation"===A||"imagery-tile"===A||"base-elevation"===A||"open-street-map"===A||"wcs"===A||"web-tile"===A||"wmts"===A||"vector-tile"===A};d.isVoxelLayer=function(A){return"voxel"===A?.type};d.sceneServiceLayerTypeToClassName={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};d.serializeLayerDefinitions=function(A){const f=/[:;]/,p=[];let e=!1;if(A&&(A.forEach((v,
z)=>{p.push([z,v]);!e&&f.test(v)&&(e=!0)}),0<p.length)){if(e){const v={};p.forEach(z=>{v[z[0]]=z[1]});A=JSON.stringify(v)}else{const v=[];p.forEach(z=>{v.push(z[0]+":"+z[1])});A=v.join(";")}return A}return null};d.serializeTimeOptions=function(A){if(A){var f=[];A.forEach((p,e)=>{f.push('"'+e+'":'+JSON.stringify(p))});if(f.length)return"{"+f.join(",")+"}"}};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/effects/utils":function(){define(["exports","./effects"],function(d,
g){d.canInterpolateEffects=function(y,x){const G=y.length>x.length?y:x;return(y.length>x.length?x:y).every((A,f)=>A.type===G[f].type)};d.effectEquals=function(y,x){y=JSON.stringify(y??null);x=JSON.stringify(x??null);return y===x};d.isEffectFunctions=function(y){return(y=y[0])?"type"in y:!1};d.normalizeEffects=function(y,x){const G=y.length>x.length?y:x;y=y.length>x.length?x:y;for(x=y.length;x<G.length;x++)y.push(g.createEffectWithInitialValues(G[x]))};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/effects/effects":function(){define(["exports","../../colorUtils","../../core/screenUtils","../../core/libs/gl-matrix-2/factories/mat4f32","./colorMatrixFunctions"],function(d,g,y,x,G){function A(r,q,b){return r+(q-r)*b}function f(r){return Math.round(1E3*y.px2pt(r))/1E3}class p{constructor(r,q,b){this.strength=r;this.radius=q;this.threshold=b;this.type="bloom"}interpolate(r,q,b){this.strength=A(r.strength,q.strength,b);this.radius=A(r.radius,q.radius,b);this.threshold=A(r.threshold,q.threshold,
b)}clone(){return new p(this.strength,this.radius,this.threshold)}toJSON(){return{type:"bloom",radius:f(this.radius),strength:this.strength,threshold:this.threshold}}}class e{constructor(r){this.radius=r;this.type="blur"}interpolate(r,q,b){this.radius=Math.round(A(r.radius,q.radius,b))}clone(){return new e(this.radius)}toJSON(){return{type:"blur",radius:f(this.radius)}}}class v{constructor(r,q){this.type=r;this.amount=q;if("invert"===this.type||"grayscale"===this.type||"sepia"===this.type)this.amount=
Math.min(this.amount,1)}get colorMatrix(){this._colorMatrix||this._updateMatrix();return this._colorMatrix}interpolate(r,q,b){this.amount=A(r.amount,q.amount,b);this._updateMatrix()}clone(){return new v(this.type,this.amount)}toJSON(){return{type:this.type,amount:this.amount}}_updateMatrix(){const r=this._colorMatrix||x.create();switch(this.type){case "brightness":this._colorMatrix=G.brightness(r,this.amount);break;case "contrast":this._colorMatrix=G.contrast(r,this.amount);break;case "grayscale":this._colorMatrix=
G.grayscale(r,this.amount);break;case "invert":this._colorMatrix=G.invert(r,this.amount);break;case "saturate":this._colorMatrix=G.saturate(r,this.amount);break;case "sepia":this._colorMatrix=G.sepia(r,this.amount)}}}class z{constructor(r,q,b,t){this.offsetX=r;this.offsetY=q;this.blurRadius=b;this.color=t;this.type="drop-shadow"}interpolate(r,q,b){this.offsetX=A(r.offsetX,q.offsetX,b);this.offsetY=A(r.offsetY,q.offsetY,b);this.blurRadius=A(r.blurRadius,q.blurRadius,b);this.color[0]=Math.round(A(r.color[0],
q.color[0],b));this.color[1]=Math.round(A(r.color[1],q.color[1],b));this.color[2]=Math.round(A(r.color[2],q.color[2],b));this.color[3]=A(r.color[3],q.color[3],b)}clone(){return new z(this.offsetX,this.offsetY,this.blurRadius,[...this.color])}toJSON(){const r=[...this.color];r[3]*=255;return{type:"drop-shadow",xoffset:f(this.offsetX),yoffset:f(this.offsetY),blurRadius:f(this.blurRadius),color:r}}}class E{constructor(r){this.angle=r;this.type="hue-rotate"}get colorMatrix(){this._colorMatrix||this._updateMatrix();
return this._colorMatrix}interpolate(r,q,b){this.angle=A(r.angle,q.angle,b);this._updateMatrix()}clone(){return new E(this.angle)}toJSON(){return{type:"hue-rotate",angle:this.angle}}_updateMatrix(){const r=this._colorMatrix||x.create();this._colorMatrix=G.rotateHue(r,this.angle)}}class J{constructor(r){this.amount=r;this.type="opacity";this.amount=Math.min(this.amount,1)}interpolate(r,q,b){this.amount=A(r.amount,q.amount,b)}clone(){return new J(this.amount)}toJSON(){return{type:"opacity",amount:this.amount}}}
d.BloomEffect=p;d.BlurEffect=e;d.ColorMatrixEffect=v;d.DropShadowEffect=z;d.HueRotateEffect=E;d.OpacityEffect=J;d.createEffectWithInitialValues=function(r){switch(r.type){case "grayscale":case "sepia":case "invert":return new v(r.type,0);case "saturate":case "brightness":case "contrast":return new v(r.type,1);case "opacity":return new J(1);case "hue-rotate":return new E(0);case "blur":return new e(0);case "drop-shadow":return new z(0,0,0,[...g.getNamedColor("transparent")]);case "bloom":return new p(0,
0,1)}};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/factories/mat4f32":function(){define(["exports"],function(d){function g(){const p=new Float32Array(16);p[0]=1;p[5]=1;p[10]=1;p[15]=1;return p}function y(p){const e=new Float32Array(16);e[0]=p[0];e[1]=p[1];e[2]=p[2];e[3]=p[3];e[4]=p[4];e[5]=p[5];e[6]=p[6];e[7]=p[7];e[8]=p[8];e[9]=p[9];e[10]=p[10];e[11]=p[11];e[12]=p[12];e[13]=p[13];e[14]=p[14];e[15]=p[15];return e}function x(p,e,v,z,E,J,r,q,b,t,n,D,Q,
a,C,P){const R=new Float32Array(16);R[0]=p;R[1]=e;R[2]=v;R[3]=z;R[4]=E;R[5]=J;R[6]=r;R[7]=q;R[8]=b;R[9]=t;R[10]=n;R[11]=D;R[12]=Q;R[13]=a;R[14]=C;R[15]=P;return R}function G(p,e){return new Float32Array(p,e,16)}const A=g(),f=Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:A,clone:y,create:g,createView:G,fromValues:x},Symbol.toStringTag,{value:"Module"}));d.IDENTITY=A;d.clone=y;d.create=g;d.createView=G;d.fromValues=x;d.mat4f32=f;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/effects/colorMatrixFunctions":function(){define(["exports","../../core/libs/gl-matrix-2/math/mat4"],function(d,g){d.brightness=(y,x)=>{y=g.set(y,x,0,0,0,0,x,0,0,0,0,x,0,0,0,0,1);return g.transpose(y,y)};d.contrast=(y,x)=>{y=g.set(y,x,0,0,.5-.5*x,0,x,0,.5-.5*x,0,0,x,.5-.5*x,0,0,0,1);return g.transpose(y,y)};d.grayscale=(y,x)=>{x=1-x;y=g.set(y,.2126+.7874*x,.7152-.7152*x,.0722-.0722*x,0,.2126-.2126*x,.7152+.2848*x,.0722-.0722*x,0,.2126-.2126*x,.7152-.7152*x,.0722+.9278*x,0,0,0,0,1);return g.transpose(y,
y)};d.invert=(y,x)=>{const G=1-2*x;y=g.set(y,G,0,0,x,0,G,0,x,0,0,G,x,0,0,0,1);return g.transpose(y,y)};d.rotateHue=(y,x)=>{const G=Math.sin(x*Math.PI/180);x=Math.cos(x*Math.PI/180);y=g.set(y,.213+.787*x-.213*G,.715-.715*x-.715*G,.072-.072*x+.928*G,0,.213-.213*x+.143*G,.715+.285*x+.14*G,.072-.072*x-.283*G,0,.213-.213*x-.787*G,.715-.715*x+.715*G,.072+.928*x+.072*G,0,0,0,0,1);return g.transpose(y,y)};d.saturate=(y,x)=>{y=g.set(y,.213+.787*x,.715-.715*x,.072-.072*x,0,.213-.213*x,.715+.285*x,.072-.072*
x,0,.213-.213*x,.715-.715*x,.072+.928*x,0,0,0,0,1);return g.transpose(y,y)};d.sepia=(y,x)=>{x=1-x;y=g.set(y,.393+.607*x,.769-.769*x,.189-.189*x,0,.349-.349*x,.686+.314*x,.168-.168*x,0,.272-.272*x,.534-.534*x,.131+.869*x,0,0,0,0,1);return g.transpose(y,y)};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/math/mat4":function(){define(["exports","../factories/vec3f64","./common"],function(d,g,y){function x(l,F){l[0]=F[0];l[1]=F[1];l[2]=F[2];l[3]=F[3];l[4]=F[4];
l[5]=F[5];l[6]=F[6];l[7]=F[7];l[8]=F[8];l[9]=F[9];l[10]=F[10];l[11]=F[11];l[12]=F[12];l[13]=F[13];l[14]=F[14];l[15]=F[15];return l}function G(l,F,X,ba,ja,B,K,L,V,aa,ca,fa,la,ma,ua,pa,sa){l[0]=F;l[1]=X;l[2]=ba;l[3]=ja;l[4]=B;l[5]=K;l[6]=L;l[7]=V;l[8]=aa;l[9]=ca;l[10]=fa;l[11]=la;l[12]=ma;l[13]=ua;l[14]=pa;l[15]=sa;return l}function A(l){l[0]=1;l[1]=0;l[2]=0;l[3]=0;l[4]=0;l[5]=1;l[6]=0;l[7]=0;l[8]=0;l[9]=0;l[10]=1;l[11]=0;l[12]=0;l[13]=0;l[14]=0;l[15]=1;return l}function f(l,F){if(l===F){const X=F[1],
ba=F[2],ja=F[3],B=F[6],K=F[7],L=F[11];l[1]=F[4];l[2]=F[8];l[3]=F[12];l[4]=X;l[6]=F[9];l[7]=F[13];l[8]=ba;l[9]=B;l[11]=F[14];l[12]=ja;l[13]=K;l[14]=L}else l[0]=F[0],l[1]=F[4],l[2]=F[8],l[3]=F[12],l[4]=F[1],l[5]=F[5],l[6]=F[9],l[7]=F[13],l[8]=F[2],l[9]=F[6],l[10]=F[10],l[11]=F[14],l[12]=F[3],l[13]=F[7],l[14]=F[11],l[15]=F[15];return l}function p(l,F){e(l,F)||A(l);return l}function e(l,F){const X=F[0],ba=F[1],ja=F[2],B=F[3],K=F[4],L=F[5],V=F[6],aa=F[7],ca=F[8],fa=F[9],la=F[10],ma=F[11],ua=F[12],pa=F[13],
sa=F[14];F=F[15];const Ca=X*L-ba*K,xa=X*V-ja*K,Ba=X*aa-B*K,Aa=ba*V-ja*L,ya=ba*aa-B*L,Ia=ja*aa-B*V,Qa=ca*pa-fa*ua,Ya=ca*sa-la*ua,Wa=ca*F-ma*ua,Ja=fa*sa-la*pa,Ka=fa*F-ma*pa,ka=la*F-ma*sa;let Ra=Ca*ka-xa*Ka+Ba*Ja+Aa*Wa-ya*Ya+Ia*Qa;if(!Ra)return null;Ra=1/Ra;l[0]=(L*ka-V*Ka+aa*Ja)*Ra;l[1]=(ja*Ka-ba*ka-B*Ja)*Ra;l[2]=(pa*Ia-sa*ya+F*Aa)*Ra;l[3]=(la*ya-fa*Ia-ma*Aa)*Ra;l[4]=(V*Wa-K*ka-aa*Ya)*Ra;l[5]=(X*ka-ja*Wa+B*Ya)*Ra;l[6]=(sa*Ba-ua*Ia-F*xa)*Ra;l[7]=(ca*Ia-la*Ba+ma*xa)*Ra;l[8]=(K*Ka-L*Wa+aa*Qa)*Ra;l[9]=
(ba*Wa-X*Ka-B*Qa)*Ra;l[10]=(ua*ya-pa*Ba+F*Ca)*Ra;l[11]=(fa*Ba-ca*ya-ma*Ca)*Ra;l[12]=(L*Ya-K*Ja-V*Qa)*Ra;l[13]=(X*Ja-ba*Ya+ja*Qa)*Ra;l[14]=(pa*xa-ua*Aa-sa*Ca)*Ra;l[15]=(ca*Aa-fa*xa+la*Ca)*Ra;return l}function v(l,F){const X=F[0],ba=F[1],ja=F[2],B=F[3],K=F[4],L=F[5],V=F[6],aa=F[7],ca=F[8],fa=F[9],la=F[10],ma=F[11],ua=F[12],pa=F[13],sa=F[14];F=F[15];l[0]=L*(la*F-ma*sa)-fa*(V*F-aa*sa)+pa*(V*ma-aa*la);l[1]=-(ba*(la*F-ma*sa)-fa*(ja*F-B*sa)+pa*(ja*ma-B*la));l[2]=ba*(V*F-aa*sa)-L*(ja*F-B*sa)+pa*(ja*aa-B*
V);l[3]=-(ba*(V*ma-aa*la)-L*(ja*ma-B*la)+fa*(ja*aa-B*V));l[4]=-(K*(la*F-ma*sa)-ca*(V*F-aa*sa)+ua*(V*ma-aa*la));l[5]=X*(la*F-ma*sa)-ca*(ja*F-B*sa)+ua*(ja*ma-B*la);l[6]=-(X*(V*F-aa*sa)-K*(ja*F-B*sa)+ua*(ja*aa-B*V));l[7]=X*(V*ma-aa*la)-K*(ja*ma-B*la)+ca*(ja*aa-B*V);l[8]=K*(fa*F-ma*pa)-ca*(L*F-aa*pa)+ua*(L*ma-aa*fa);l[9]=-(X*(fa*F-ma*pa)-ca*(ba*F-B*pa)+ua*(ba*ma-B*fa));l[10]=X*(L*F-aa*pa)-K*(ba*F-B*pa)+ua*(ba*aa-B*L);l[11]=-(X*(L*ma-aa*fa)-K*(ba*ma-B*fa)+ca*(ba*aa-B*L));l[12]=-(K*(fa*sa-la*pa)-ca*(L*
sa-V*pa)+ua*(L*la-V*fa));l[13]=X*(fa*sa-la*pa)-ca*(ba*sa-ja*pa)+ua*(ba*la-ja*fa);l[14]=-(X*(L*sa-V*pa)-K*(ba*sa-ja*pa)+ua*(ba*V-ja*L));l[15]=X*(L*la-V*fa)-K*(ba*la-ja*fa)+ca*(ba*V-ja*L);return l}function z(l){const F=l[0],X=l[1],ba=l[2],ja=l[3],B=l[4],K=l[5],L=l[6],V=l[7],aa=l[8],ca=l[9],fa=l[10],la=l[11],ma=l[12],ua=l[13],pa=l[14];l=l[15];return(F*K-X*B)*(fa*l-la*pa)-(F*L-ba*B)*(ca*l-la*ua)+(F*V-ja*B)*(ca*pa-fa*ua)+(X*L-ba*K)*(aa*l-la*ma)-(X*V-ja*K)*(aa*pa-fa*ma)+(ba*V-ja*L)*(aa*ua-ca*ma)}function E(l,
F,X){const ba=F[0],ja=F[1],B=F[2],K=F[3],L=F[4],V=F[5],aa=F[6],ca=F[7],fa=F[8],la=F[9],ma=F[10],ua=F[11],pa=F[12],sa=F[13],Ca=F[14];F=F[15];let xa=X[0],Ba=X[1],Aa=X[2],ya=X[3];l[0]=xa*ba+Ba*L+Aa*fa+ya*pa;l[1]=xa*ja+Ba*V+Aa*la+ya*sa;l[2]=xa*B+Ba*aa+Aa*ma+ya*Ca;l[3]=xa*K+Ba*ca+Aa*ua+ya*F;xa=X[4];Ba=X[5];Aa=X[6];ya=X[7];l[4]=xa*ba+Ba*L+Aa*fa+ya*pa;l[5]=xa*ja+Ba*V+Aa*la+ya*sa;l[6]=xa*B+Ba*aa+Aa*ma+ya*Ca;l[7]=xa*K+Ba*ca+Aa*ua+ya*F;xa=X[8];Ba=X[9];Aa=X[10];ya=X[11];l[8]=xa*ba+Ba*L+Aa*fa+ya*pa;l[9]=xa*ja+
Ba*V+Aa*la+ya*sa;l[10]=xa*B+Ba*aa+Aa*ma+ya*Ca;l[11]=xa*K+Ba*ca+Aa*ua+ya*F;xa=X[12];Ba=X[13];Aa=X[14];ya=X[15];l[12]=xa*ba+Ba*L+Aa*fa+ya*pa;l[13]=xa*ja+Ba*V+Aa*la+ya*sa;l[14]=xa*B+Ba*aa+Aa*ma+ya*Ca;l[15]=xa*K+Ba*ca+Aa*ua+ya*F;return l}function J(l,F,X){const ba=X[0],ja=X[1];X=X[2];if(F===l)l[12]=F[0]*ba+F[4]*ja+F[8]*X+F[12],l[13]=F[1]*ba+F[5]*ja+F[9]*X+F[13],l[14]=F[2]*ba+F[6]*ja+F[10]*X+F[14],l[15]=F[3]*ba+F[7]*ja+F[11]*X+F[15];else{const B=F[0],K=F[1],L=F[2],V=F[3],aa=F[4],ca=F[5],fa=F[6],la=F[7],
ma=F[8],ua=F[9],pa=F[10],sa=F[11];l[0]=B;l[1]=K;l[2]=L;l[3]=V;l[4]=aa;l[5]=ca;l[6]=fa;l[7]=la;l[8]=ma;l[9]=ua;l[10]=pa;l[11]=sa;l[12]=B*ba+aa*ja+ma*X+F[12];l[13]=K*ba+ca*ja+ua*X+F[13];l[14]=L*ba+fa*ja+pa*X+F[14];l[15]=V*ba+la*ja+sa*X+F[15]}return l}function r(l,F,X){const ba=X[0],ja=X[1];X=X[2];l[0]=F[0]*ba;l[1]=F[1]*ba;l[2]=F[2]*ba;l[3]=F[3]*ba;l[4]=F[4]*ja;l[5]=F[5]*ja;l[6]=F[6]*ja;l[7]=F[7]*ja;l[8]=F[8]*X;l[9]=F[9]*X;l[10]=F[10]*X;l[11]=F[11]*X;l[12]=F[12];l[13]=F[13];l[14]=F[14];l[15]=F[15];return l}
function q(l,F,X,ba){let ja=ba[0],B=ba[1];ba=ba[2];let K=Math.sqrt(ja*ja+B*B+ba*ba);var L=void 0,V=void 0;let aa=void 0,ca=void 0,fa=void 0,la=void 0,ma=void 0,ua=void 0,pa=void 0,sa=void 0,Ca=void 0,xa=void 0,Ba=void 0,Aa=void 0,ya=void 0,Ia=void 0,Qa=void 0,Ya=void 0,Wa=void 0,Ja=void 0,Ka=void 0,ka=void 0;V=L=void 0;if(K<y.getEpsilon())return null;K=1/K;ja*=K;B*=K;ba*=K;L=Math.sin(X);V=Math.cos(X);aa=1-V;ca=F[0];fa=F[1];la=F[2];ma=F[3];ua=F[4];pa=F[5];sa=F[6];Ca=F[7];xa=F[8];Ba=F[9];Aa=F[10];ya=
F[11];Ia=ja*ja*aa+V;Qa=B*ja*aa+ba*L;Ya=ba*ja*aa-B*L;Wa=ja*B*aa-ba*L;Ja=B*B*aa+V;Ka=ba*B*aa+ja*L;ka=ja*ba*aa+B*L;L=B*ba*aa-ja*L;V=ba*ba*aa+V;l[0]=ca*Ia+ua*Qa+xa*Ya;l[1]=fa*Ia+pa*Qa+Ba*Ya;l[2]=la*Ia+sa*Qa+Aa*Ya;l[3]=ma*Ia+Ca*Qa+ya*Ya;l[4]=ca*Wa+ua*Ja+xa*Ka;l[5]=fa*Wa+pa*Ja+Ba*Ka;l[6]=la*Wa+sa*Ja+Aa*Ka;l[7]=ma*Wa+Ca*Ja+ya*Ka;l[8]=ca*ka+ua*L+xa*V;l[9]=fa*ka+pa*L+Ba*V;l[10]=la*ka+sa*L+Aa*V;l[11]=ma*ka+Ca*L+ya*V;F!==l&&(l[12]=F[12],l[13]=F[13],l[14]=F[14],l[15]=F[15]);return l}function b(l,F,X){const ba=
Math.sin(X);X=Math.cos(X);const ja=F[4],B=F[5],K=F[6],L=F[7],V=F[8],aa=F[9],ca=F[10],fa=F[11];F!==l&&(l[0]=F[0],l[1]=F[1],l[2]=F[2],l[3]=F[3],l[12]=F[12],l[13]=F[13],l[14]=F[14],l[15]=F[15]);l[4]=ja*X+V*ba;l[5]=B*X+aa*ba;l[6]=K*X+ca*ba;l[7]=L*X+fa*ba;l[8]=V*X-ja*ba;l[9]=aa*X-B*ba;l[10]=ca*X-K*ba;l[11]=fa*X-L*ba;return l}function t(l,F,X){const ba=Math.sin(X);X=Math.cos(X);const ja=F[0],B=F[1],K=F[2],L=F[3],V=F[8],aa=F[9],ca=F[10],fa=F[11];F!==l&&(l[4]=F[4],l[5]=F[5],l[6]=F[6],l[7]=F[7],l[12]=F[12],
l[13]=F[13],l[14]=F[14],l[15]=F[15]);l[0]=ja*X-V*ba;l[1]=B*X-aa*ba;l[2]=K*X-ca*ba;l[3]=L*X-fa*ba;l[8]=ja*ba+V*X;l[9]=B*ba+aa*X;l[10]=K*ba+ca*X;l[11]=L*ba+fa*X;return l}function n(l,F,X){const ba=Math.sin(X);X=Math.cos(X);const ja=F[0],B=F[1],K=F[2],L=F[3],V=F[4],aa=F[5],ca=F[6],fa=F[7];F!==l&&(l[8]=F[8],l[9]=F[9],l[10]=F[10],l[11]=F[11],l[12]=F[12],l[13]=F[13],l[14]=F[14],l[15]=F[15]);l[0]=ja*X+V*ba;l[1]=B*X+aa*ba;l[2]=K*X+ca*ba;l[3]=L*X+fa*ba;l[4]=V*X-ja*ba;l[5]=aa*X-B*ba;l[6]=ca*X-K*ba;l[7]=fa*
X-L*ba;return l}function D(l,F){l[0]=1;l[1]=0;l[2]=0;l[3]=0;l[4]=0;l[5]=1;l[6]=0;l[7]=0;l[8]=0;l[9]=0;l[10]=1;l[11]=0;l[12]=F[0];l[13]=F[1];l[14]=F[2];l[15]=1;return l}function Q(l,F){l[0]=F[0];l[1]=0;l[2]=0;l[3]=0;l[4]=0;l[5]=F[1];l[6]=0;l[7]=0;l[8]=0;l[9]=0;l[10]=F[2];l[11]=0;l[12]=0;l[13]=0;l[14]=0;l[15]=1;return l}function a(l,F,X){if(0===F)return A(l);let ba=X[0],ja=X[1];X=X[2];let B=Math.sqrt(ba*ba+ja*ja+X*X),K=void 0,L=void 0,V=void 0;if(B<y.getEpsilon())return null;B=1/B;ba*=B;ja*=B;X*=B;
K=Math.sin(F);L=Math.cos(F);V=1-L;l[0]=ba*ba*V+L;l[1]=ja*ba*V+X*K;l[2]=X*ba*V-ja*K;l[3]=0;l[4]=ba*ja*V-X*K;l[5]=ja*ja*V+L;l[6]=X*ja*V+ba*K;l[7]=0;l[8]=ba*X*V+ja*K;l[9]=ja*X*V-ba*K;l[10]=X*X*V+L;l[11]=0;l[12]=0;l[13]=0;l[14]=0;l[15]=1;return l}function C(l,F){const X=Math.sin(F);F=Math.cos(F);l[0]=1;l[1]=0;l[2]=0;l[3]=0;l[4]=0;l[5]=F;l[6]=X;l[7]=0;l[8]=0;l[9]=-X;l[10]=F;l[11]=0;l[12]=0;l[13]=0;l[14]=0;l[15]=1;return l}function P(l,F){const X=Math.sin(F);F=Math.cos(F);l[0]=F;l[1]=0;l[2]=-X;l[3]=0;l[4]=
0;l[5]=1;l[6]=0;l[7]=0;l[8]=X;l[9]=0;l[10]=F;l[11]=0;l[12]=0;l[13]=0;l[14]=0;l[15]=1;return l}function R(l,F){const X=Math.sin(F);F=Math.cos(F);l[0]=F;l[1]=X;l[2]=0;l[3]=0;l[4]=-X;l[5]=F;l[6]=0;l[7]=0;l[8]=0;l[9]=0;l[10]=1;l[11]=0;l[12]=0;l[13]=0;l[14]=0;l[15]=1;return l}function Z(l,F,X){var ba=F[0],ja=F[1],B=F[2],K=F[3],L=ba+ba,V=ja+ja;const aa=B+B;F=ba*L;const ca=ba*V;ba*=aa;const fa=ja*V;ja*=aa;B*=aa;L*=K;V*=K;K*=aa;l[0]=1-(fa+B);l[1]=ca+K;l[2]=ba-V;l[3]=0;l[4]=ca-K;l[5]=1-(F+B);l[6]=ja+L;l[7]=
0;l[8]=ba+V;l[9]=ja-L;l[10]=1-(F+fa);l[11]=0;l[12]=X[0];l[13]=X[1];l[14]=X[2];l[15]=1;return l}function W(l,F){const X=Oa,ba=-F[0],ja=-F[1],B=-F[2],K=F[3],L=F[4],V=F[5],aa=F[6],ca=F[7],fa=ba*ba+ja*ja+B*B+K*K;0<fa?(X[0]=2*(L*K+ca*ba+V*B-aa*ja)/fa,X[1]=2*(V*K+ca*ja+aa*ba-L*B)/fa,X[2]=2*(aa*K+ca*B+L*ja-V*ba)/fa):(X[0]=2*(L*K+ca*ba+V*B-aa*ja),X[1]=2*(V*K+ca*ja+aa*ba-L*B),X[2]=2*(aa*K+ca*B+L*ja-V*ba));Z(l,F,X);return l}function U(l,F){l[0]=F[12];l[1]=F[13];l[2]=F[14];return l}function u(l,F){const X=F[0],
ba=F[1],ja=F[2],B=F[4],K=F[5],L=F[6],V=F[8],aa=F[9];F=F[10];l[0]=Math.sqrt(X*X+ba*ba+ja*ja);l[1]=Math.sqrt(B*B+K*K+L*L);l[2]=Math.sqrt(V*V+aa*aa+F*F);return l}function I(l,F){const X=F[0]+F[5]+F[10];let ba=0;0<X?(ba=2*Math.sqrt(X+1),l[3]=.25*ba,l[0]=(F[6]-F[9])/ba,l[1]=(F[8]-F[2])/ba,l[2]=(F[1]-F[4])/ba):F[0]>F[5]&&F[0]>F[10]?(ba=2*Math.sqrt(1+F[0]-F[5]-F[10]),l[3]=(F[6]-F[9])/ba,l[0]=.25*ba,l[1]=(F[1]+F[4])/ba,l[2]=(F[8]+F[2])/ba):F[5]>F[10]?(ba=2*Math.sqrt(1+F[5]-F[0]-F[10]),l[3]=(F[8]-F[2])/ba,
l[0]=(F[1]+F[4])/ba,l[1]=.25*ba,l[2]=(F[6]+F[9])/ba):(ba=2*Math.sqrt(1+F[10]-F[0]-F[5]),l[3]=(F[1]-F[4])/ba,l[0]=(F[8]+F[2])/ba,l[1]=(F[6]+F[9])/ba,l[2]=.25*ba);return l}function k(l,F,X,ba){var ja=F[0],B=F[1],K=F[2],L=F[3],V=ja+ja,aa=B+B,ca=K+K;F=ja*V;const fa=ja*aa;ja*=ca;const la=B*aa;B*=ca;K*=ca;V*=L;aa*=L;L*=ca;ca=ba[0];const ma=ba[1];ba=ba[2];l[0]=(1-(la+K))*ca;l[1]=(fa+L)*ca;l[2]=(ja-aa)*ca;l[3]=0;l[4]=(fa-L)*ma;l[5]=(1-(F+K))*ma;l[6]=(B+V)*ma;l[7]=0;l[8]=(ja+aa)*ba;l[9]=(B-V)*ba;l[10]=(1-
(F+la))*ba;l[11]=0;l[12]=X[0];l[13]=X[1];l[14]=X[2];l[15]=1;return l}function h(l,F,X,ba,ja){var B=F[0],K=F[1],L=F[2],V=F[3],aa=B+B,ca=K+K,fa=L+L;F=B*aa;var la=B*ca,ma=B*fa;B=K*ca;K*=fa;var ua=L*fa;L=V*aa;ca*=V;const pa=V*fa;var sa=ba[0],Ca=ba[1];fa=ba[2];ba=ja[0];V=ja[1];ja=ja[2];aa=(1-(B+ua))*sa;const xa=(la+pa)*sa;sa*=ma-ca;la=(la-pa)*Ca;ua=(1-(F+ua))*Ca;Ca*=K+L;ma=(ma+ca)*fa;K=(K-L)*fa;F=(1-(F+B))*fa;l[0]=aa;l[1]=xa;l[2]=sa;l[3]=0;l[4]=la;l[5]=ua;l[6]=Ca;l[7]=0;l[8]=ma;l[9]=K;l[10]=F;l[11]=0;
l[12]=X[0]+ba-(aa*ba+la*V+ma*ja);l[13]=X[1]+V-(xa*ba+ua*V+K*ja);l[14]=X[2]+ja-(sa*ba+Ca*V+F*ja);l[15]=1;return l}function w(l,F){var X=F[0],ba=F[1],ja=F[2];F=F[3];var B=X+X,K=ba+ba;const L=ja+ja;X*=B;const V=ba*B;ba*=K;const aa=ja*B,ca=ja*K;ja*=L;B*=F;K*=F;F*=L;l[0]=1-ba-ja;l[1]=V+F;l[2]=aa-K;l[3]=0;l[4]=V-F;l[5]=1-X-ja;l[6]=ca+B;l[7]=0;l[8]=aa+K;l[9]=ca-B;l[10]=1-X-ba;l[11]=0;l[12]=0;l[13]=0;l[14]=0;l[15]=1;return l}function O(l,F,X,ba,ja,B,K){const L=1/(X-F),V=1/(ja-ba),aa=1/(B-K);l[0]=2*B*L;l[1]=
0;l[2]=0;l[3]=0;l[4]=0;l[5]=2*B*V;l[6]=0;l[7]=0;l[8]=(X+F)*L;l[9]=(ja+ba)*V;l[10]=(K+B)*aa;l[11]=-1;l[12]=0;l[13]=0;l[14]=K*B*2*aa;l[15]=0;return l}function M(l,F,X,ba,ja){F=1/Math.tan(F/2);let B=void 0;l[0]=F/X;l[1]=0;l[2]=0;l[3]=0;l[4]=0;l[5]=F;l[6]=0;l[7]=0;l[8]=0;l[9]=0;l[11]=-1;l[12]=0;l[13]=0;l[15]=0;null!=ja&&Infinity!==ja?(B=1/(ba-ja),l[10]=(ja+ba)*B,l[14]=2*ja*ba*B):(l[10]=-1,l[14]=-2*ba);return l}function T(l,F,X,ba){const ja=Math.tan(F.upDegrees*Math.PI/180),B=Math.tan(F.downDegrees*Math.PI/
180),K=Math.tan(F.leftDegrees*Math.PI/180);F=Math.tan(F.rightDegrees*Math.PI/180);const L=2/(K+F),V=2/(ja+B);l[0]=L;l[1]=0;l[2]=0;l[3]=0;l[4]=0;l[5]=V;l[6]=0;l[7]=0;l[8]=-((K-F)*L*.5);l[9]=(ja-B)*V*.5;l[10]=ba/(X-ba);l[11]=-1;l[12]=0;l[13]=0;l[14]=ba*X/(X-ba);l[15]=0;return l}function Y(l,F,X,ba,ja,B,K){const L=1/(F-X),V=1/(ba-ja),aa=1/(B-K);l[0]=-2*L;l[1]=0;l[2]=0;l[3]=0;l[4]=0;l[5]=-2*V;l[6]=0;l[7]=0;l[8]=0;l[9]=0;l[10]=2*aa;l[11]=0;l[12]=(F+X)*L;l[13]=(ja+ba)*V;l[14]=(K+B)*aa;l[15]=1;return l}
function ea(l,F,X,ba){const ja=F[0],B=F[1];F=F[2];let K=ja-X[0],L=B-X[1];X=F-X[2];var V=y.getEpsilon();if(Math.abs(K)<V&&Math.abs(L)<V&&Math.abs(X)<V)A(l);else{var aa=1/Math.sqrt(K*K+L*L+X*X);K*=aa;L*=aa;X*=aa;aa=ba[0];var ca=ba[1];V=ba[2];ba=ca*X-V*L;V=V*K-aa*X;ca=aa*L-ca*K;(aa=Math.sqrt(ba*ba+V*V+ca*ca))?(aa=1/aa,ba*=aa,V*=aa,ca*=aa):ca=V=ba=0;var fa=L*ca-X*V,la=X*ba-K*ca,ma=K*V-L*ba;(aa=Math.sqrt(fa*fa+la*la+ma*ma))?(aa=1/aa,fa*=aa,la*=aa,ma*=aa):ma=la=fa=0;l[0]=ba;l[1]=fa;l[2]=K;l[3]=0;l[4]=V;
l[5]=la;l[6]=L;l[7]=0;l[8]=ca;l[9]=ma;l[10]=X;l[11]=0;l[12]=-(ba*ja+V*B+ca*F);l[13]=-(fa*ja+la*B+ma*F);l[14]=-(K*ja+L*B+X*F);l[15]=1}}function ia(l,F,X,ba){const ja=F[0],B=F[1];F=F[2];var K=ba[0];const L=ba[1];var V=ba[2];ba=ja-X[0];let aa=B-X[1];X=F-X[2];let ca=ba*ba+aa*aa+X*X;0<ca&&(ca=1/Math.sqrt(ca),ba*=ca,aa*=ca,X*=ca);let fa=L*X-V*aa;V=V*ba-K*X;K=K*aa-L*ba;ca=fa*fa+V*V+K*K;0<ca&&(ca=1/Math.sqrt(ca),fa*=ca,V*=ca,K*=ca);l[0]=fa;l[1]=V;l[2]=K;l[3]=0;l[4]=aa*K-X*V;l[5]=X*fa-ba*K;l[6]=ba*V-aa*fa;
l[7]=0;l[8]=ba;l[9]=aa;l[10]=X;l[11]=0;l[12]=ja;l[13]=B;l[14]=F;l[15]=1;return l}function na(l){return"mat4("+l[0]+", "+l[1]+", "+l[2]+", "+l[3]+", "+l[4]+", "+l[5]+", "+l[6]+", "+l[7]+", "+l[8]+", "+l[9]+", "+l[10]+", "+l[11]+", "+l[12]+", "+l[13]+", "+l[14]+", "+l[15]+")"}function qa(l){return Math.sqrt(l[0]**2+l[1]**2+l[2]**2+l[3]**2+l[4]**2+l[5]**2+l[6]**2+l[7]**2+l[8]**2+l[9]**2+l[10]**2+l[11]**2+l[12]**2+l[13]**2+l[14]**2+l[15]**2)}function va(l,F,X){l[0]=F[0]+X[0];l[1]=F[1]+X[1];l[2]=F[2]+
X[2];l[3]=F[3]+X[3];l[4]=F[4]+X[4];l[5]=F[5]+X[5];l[6]=F[6]+X[6];l[7]=F[7]+X[7];l[8]=F[8]+X[8];l[9]=F[9]+X[9];l[10]=F[10]+X[10];l[11]=F[11]+X[11];l[12]=F[12]+X[12];l[13]=F[13]+X[13];l[14]=F[14]+X[14];l[15]=F[15]+X[15];return l}function ta(l,F,X){l[0]=F[0]-X[0];l[1]=F[1]-X[1];l[2]=F[2]-X[2];l[3]=F[3]-X[3];l[4]=F[4]-X[4];l[5]=F[5]-X[5];l[6]=F[6]-X[6];l[7]=F[7]-X[7];l[8]=F[8]-X[8];l[9]=F[9]-X[9];l[10]=F[10]-X[10];l[11]=F[11]-X[11];l[12]=F[12]-X[12];l[13]=F[13]-X[13];l[14]=F[14]-X[14];l[15]=F[15]-X[15];
return l}function wa(l,F,X){l[0]=F[0]*X;l[1]=F[1]*X;l[2]=F[2]*X;l[3]=F[3]*X;l[4]=F[4]*X;l[5]=F[5]*X;l[6]=F[6]*X;l[7]=F[7]*X;l[8]=F[8]*X;l[9]=F[9]*X;l[10]=F[10]*X;l[11]=F[11]*X;l[12]=F[12]*X;l[13]=F[13]*X;l[14]=F[14]*X;l[15]=F[15]*X;return l}function Ea(l,F,X,ba){l[0]=F[0]+X[0]*ba;l[1]=F[1]+X[1]*ba;l[2]=F[2]+X[2]*ba;l[3]=F[3]+X[3]*ba;l[4]=F[4]+X[4]*ba;l[5]=F[5]+X[5]*ba;l[6]=F[6]+X[6]*ba;l[7]=F[7]+X[7]*ba;l[8]=F[8]+X[8]*ba;l[9]=F[9]+X[9]*ba;l[10]=F[10]+X[10]*ba;l[11]=F[11]+X[11]*ba;l[12]=F[12]+X[12]*
ba;l[13]=F[13]+X[13]*ba;l[14]=F[14]+X[14]*ba;l[15]=F[15]+X[15]*ba;return l}function Da(l,F){return l[0]===F[0]&&l[1]===F[1]&&l[2]===F[2]&&l[3]===F[3]&&l[4]===F[4]&&l[5]===F[5]&&l[6]===F[6]&&l[7]===F[7]&&l[8]===F[8]&&l[9]===F[9]&&l[10]===F[10]&&l[11]===F[11]&&l[12]===F[12]&&l[13]===F[13]&&l[14]===F[14]&&l[15]===F[15]}function Pa(l,F){if(l===F)return!0;const X=l[0],ba=l[1],ja=l[2],B=l[3],K=l[4],L=l[5],V=l[6],aa=l[7],ca=l[8],fa=l[9],la=l[10],ma=l[11],ua=l[12],pa=l[13],sa=l[14];l=l[15];const Ca=F[0],
xa=F[1],Ba=F[2],Aa=F[3],ya=F[4],Ia=F[5],Qa=F[6],Ya=F[7],Wa=F[8],Ja=F[9],Ka=F[10],ka=F[11],Ra=F[12],Mb=F[13],nb=F[14];F=F[15];const c=y.getEpsilon();return Math.abs(X-Ca)<=c*Math.max(1,Math.abs(X),Math.abs(Ca))&&Math.abs(ba-xa)<=c*Math.max(1,Math.abs(ba),Math.abs(xa))&&Math.abs(ja-Ba)<=c*Math.max(1,Math.abs(ja),Math.abs(Ba))&&Math.abs(B-Aa)<=c*Math.max(1,Math.abs(B),Math.abs(Aa))&&Math.abs(K-ya)<=c*Math.max(1,Math.abs(K),Math.abs(ya))&&Math.abs(L-Ia)<=c*Math.max(1,Math.abs(L),Math.abs(Ia))&&Math.abs(V-
Qa)<=c*Math.max(1,Math.abs(V),Math.abs(Qa))&&Math.abs(aa-Ya)<=c*Math.max(1,Math.abs(aa),Math.abs(Ya))&&Math.abs(ca-Wa)<=c*Math.max(1,Math.abs(ca),Math.abs(Wa))&&Math.abs(fa-Ja)<=c*Math.max(1,Math.abs(fa),Math.abs(Ja))&&Math.abs(la-Ka)<=c*Math.max(1,Math.abs(la),Math.abs(Ka))&&Math.abs(ma-ka)<=c*Math.max(1,Math.abs(ma),Math.abs(ka))&&Math.abs(ua-Ra)<=c*Math.max(1,Math.abs(ua),Math.abs(Ra))&&Math.abs(pa-Mb)<=c*Math.max(1,Math.abs(pa),Math.abs(Mb))&&Math.abs(sa-nb)<=c*Math.max(1,Math.abs(sa),Math.abs(nb))&&
Math.abs(l-F)<=c*Math.max(1,Math.abs(l),Math.abs(F))}function Sa(l){const F=y.getEpsilon(),X=l[0],ba=l[1],ja=l[2],B=l[4],K=l[5],L=l[6],V=l[8],aa=l[9];l=l[10];return Math.abs(1-(X*X+B*B+V*V))<=F&&Math.abs(1-(ba*ba+K*K+aa*aa))<=F&&Math.abs(1-(ja*ja+L*L+l*l))<=F}function Ta(l){return 1===l[0]&&0===l[1]&&0===l[2]&&0===l[4]&&1===l[5]&&0===l[6]&&0===l[8]&&0===l[9]&&1===l[10]}const Oa=g.create();g=Object.freeze(Object.defineProperty({__proto__:null,add:va,adjoint:v,copy:x,determinant:z,equals:Pa,exactEquals:Da,
frob:qa,fromQuat:w,fromQuat2:W,fromRotation:a,fromRotationTranslation:Z,fromRotationTranslationScale:k,fromRotationTranslationScaleOrigin:h,fromScaling:Q,fromTranslation:D,fromXRotation:C,fromYRotation:P,fromZRotation:R,frustum:O,getRotation:I,getScaling:u,getTranslation:U,hasIdentityRotation:Ta,identity:A,invert:e,invertOrIdentity:p,isOrthoNormal:Sa,lookAt:ea,mul:E,multiply:E,multiplyScalar:wa,multiplyScalarAndAdd:Ea,ortho:Y,perspective:M,perspectiveFromFieldOfView:T,rotate:q,rotateX:b,rotateY:t,
rotateZ:n,scale:r,set:G,str:na,sub:ta,subtract:ta,targetTo:ia,translate:J,transpose:f},Symbol.toStringTag,{value:"Module"}));d.add=va;d.adjoint=v;d.copy=x;d.determinant=z;d.equals=Pa;d.exactEquals=Da;d.frob=qa;d.fromQuat=w;d.fromQuat2=W;d.fromRotation=a;d.fromRotationTranslation=Z;d.fromRotationTranslationScale=k;d.fromRotationTranslationScaleOrigin=h;d.fromScaling=Q;d.fromTranslation=D;d.fromXRotation=C;d.fromYRotation=P;d.fromZRotation=R;d.frustum=O;d.getRotation=I;d.getScaling=u;d.getTranslation=
U;d.hasIdentityRotation=Ta;d.identity=A;d.invert=e;d.invertOrIdentity=p;d.isOrthoNormal=Sa;d.lookAt=ea;d.mat4=g;d.mul=E;d.multiply=E;d.multiplyScalar=wa;d.multiplyScalarAndAdd=Ea;d.ortho=Y;d.perspective=M;d.perspectiveFromFieldOfView=T;d.rotate=q;d.rotateX=b;d.rotateY=t;d.rotateZ=n;d.scale=r;d.set=G;d.str=na;d.sub=ta;d.subtract=ta;d.targetTo=ia;d.translate=J;d.transpose=f;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/statistics/utils":function(){define(["exports","../rest/support/ClassBreaksDefinition",
"../rest/support/generateRendererUtils"],function(d,g,y){function x(k){return null==k||"string"===typeof k&&!k?"\x3cNull\x3e":k}function G(k){const h=null!=k.minValue||null!=k.maxValue,w=!!k.sqlExpression&&k.supportsSQLExpression;return!(null!=k.normalizationField||null!=k.normalizationType)&&!h&&!w}function A(k){const {values:h,useSampleStdDev:w,supportsNullCount:O}=k;var M=Number.POSITIVE_INFINITY;let T=Number.NEGATIVE_INFINITY,Y=null,ea=null;var ia=null;let na=null,qa=0;const va=null==k.minValue?
-Infinity:k.minValue,ta=null==k.maxValue?Infinity:k.maxValue;for(const wa of h)Number.isFinite(wa)?wa>=va&&wa<=ta&&(Y=null===Y?wa:Y+wa,M=Math.min(M,wa),T=Math.max(T,wa),qa++):"string"===typeof wa&&qa++;if(qa&&null!=Y){ea=Y/qa;ia=0;for(const wa of h)Number.isFinite(wa)&&wa>=va&&wa<=ta&&(ia+=(wa-ea)**2);na=w?1<qa?ia/(qa-1):0:0<qa?ia/qa:0;ia=Math.sqrt(na)}else T=M=null;M={avg:ea,count:qa,max:T,min:M,stddev:ia,sum:Y,variance:na};O&&(M.nullcount=h.length-qa);k.percentileParams&&(M.median=f(h,k.percentileParams));
return M}function f(k,h){const {fieldType:w,value:O,orderBy:M,isDiscrete:T}=h,Y=p(w,"desc"===M);k=[...k].filter(qa=>null!=qa).sort((qa,va)=>Y(qa,va));if(0===k.length)return null;if(0>=O)return k[0];if(1<=O)return k[k.length-1];var ea=(k.length-1)*O,ia=Math.floor(ea);h=ia+1;ea%=1;ia=k[ia];const na=k[h];return h>=k.length||T||"string"===typeof ia||"string"===typeof na?ia:ia*(1-ea)+na*ea}function p(k,h){if(k){if(D.has(k))return h?u:I;if(Q.has(k))return e(h,!1);if("esriFieldTypeTimestampOffset"===k)return h?
Z:R;const T=e(h,!0);if("esriFieldTypeString"===k)return T;if("esriFieldTypeGUID"===k||"esriFieldTypeGlobalID"===k)return(Y,ea)=>T(v(Y),v(ea))}const w=h?1:-1,O=h?u:I,M=e(h,!0);return(T,Y)=>"number"===typeof T&&"number"===typeof Y?O(T,Y):"string"===typeof T&&"string"===typeof Y?M(T,Y):w}function e(k,h){if(!h)return k?U:W;const w=k?C:P;return k?(O,M)=>{const T=w(O,M);if(null!=T)return T;O=O.toUpperCase();M=M.toUpperCase();return O>M?-1:O<M?1:0}:(O,M)=>{const T=w(O,M);if(null!=T)return T;O=O.toUpperCase();
M=M.toUpperCase();return O<M?-1:O>M?1:0}}function v(k){return k.substr(24,12)+k.substr(19,4)+k.substr(16,2)+k.substr(14,2)+k.substr(11,2)+k.substr(9,2)+k.substr(6,2)+k.substr(4,2)+k.substr(2,2)+k.substr(0,2)}function z(k){return"coded-value"!==k?.type?[]:k.codedValues.map(h=>h.code)}function E(k,h){const w=r({field:h.field,normalizationType:h.normalizationType,normalizationField:h.normalizationField,classificationMethod:h.classificationMethod,standardDeviationInterval:h.standardDeviationInterval,
breakCount:h.numClasses||5});k=J(k,h.minValue,h.maxValue);return y.createGenerateRendererClassBreaks({definition:w,values:k,normalizationTotal:h.normalizationTotal})}function J(k,h,w){const O=null==h?-Infinity:h,M=null==w?Infinity:w;return k.filter(T=>Number.isFinite(T)&&T>=O&&T<=M)}function r(k){const {breakCount:h,field:w,normalizationField:O,normalizationType:M}=k,T=k.classificationMethod||"equal-interval";return new g({breakCount:h,classificationField:w,classificationMethod:T,normalizationField:"field"===
M?O:void 0,normalizationType:M,standardDeviationInterval:"standard-deviation"===T?k.standardDeviationInterval||1:void 0})}function q(k,h){const {field:w,classificationMethod:O,standardDeviationInterval:M,normalizationType:T,normalizationField:Y,normalizationTotal:ea,minValue:ia,maxValue:na}=h,qa=h.numBins||10;let va=h=null,ta=null;O&&"equal-interval"!==O||T?({classBreaks:k}=E(k,{field:w,normalizationType:T,normalizationField:Y,normalizationTotal:ea,classificationMethod:O,standardDeviationInterval:M,
minValue:ia,maxValue:na,numClasses:qa}),h=k[0].minValue,va=k[k.length-1].maxValue,ta=k.map(wa=>[wa.minValue,wa.maxValue])):(null!=ia&&null!=na?(h=ia,va=na):(k=A({values:k,minValue:ia,maxValue:na,useSampleStdDev:!T,supportsNullCount:G({normalizationType:T,normalizationField:Y,minValue:ia,maxValue:na})}),h=k.min??null,va=k.max??null),ta=t(h??0,va??0,qa));return{min:h,max:va,intervals:ta}}function b(k,h){let w=-1;for(let O=k.length-1;0<=O;O--)if(h>=k[O][0]){w=O;break}return w}function t(k,h,w){const O=
(h-k)/w,M=[];let T;for(let Y=1;Y<=w;Y++)T=k+O,T=Number(T.toFixed(16)),M.push([k,Y===w?h:T]),k=T;return M}const n=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,D=new Set("esriFieldTypeDate esriFieldTypeInteger esriFieldTypeSmallInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeOID esriFieldTypeBigInteger".split(" ")),Q=new Set(["esriFieldTypeTimeOnly","esriFieldTypeDateOnly"]),a="min max avg stddev count sum variance nullcount median".split(" "),C=(k,h)=>null==k?null==h?0:1:
null==h?-1:null,P=(k,h)=>null==k?null==h?0:-1:null==h?1:null,R=(k,h)=>P(k,h)??(k===h?0:(new Date(k)).getTime()-(new Date(h)).getTime()),Z=(k,h)=>C(k,h)??(k===h?0:(new Date(h)).getTime()-(new Date(k)).getTime()),W=(k,h)=>P(k,h)??(k===h?0:k<h?-1:1),U=(k,h)=>C(k,h)??(k===h?0:k<h?1:-1),u=(k,h)=>C(k,h)??h-k,I=(k,h)=>P(k,h)??k-h;d.calculateClassBreaks=E;d.calculateHistogram=function(k,h){var w=q(k,h);if(null==w.min&&null==w.max)return{bins:[],minValue:w.min,maxValue:w.max,normalizationTotal:h.normalizationTotal};
const O=w.intervals,M=w.min??0;w=w.max??0;const T=O.map((Y,ea)=>({minValue:O[ea][0],maxValue:O[ea][1],count:0}));for(const Y of k)null!=Y&&Y>=M&&Y<=w&&(k=b(O,Y),-1<k&&T[k].count++);return{bins:T,minValue:M,maxValue:w,normalizationTotal:h.normalizationTotal}};d.calculatePercentile=f;d.calculateStatistics=A;d.calculateStringStatistics=function(k){const h=k.returnDistinct?[...(new Set(k.values))]:k.values;var w=h.filter(M=>null!=M).sort();const O=w.length;w={count:O,min:w[0],max:w[O-1]};k.supportsNullCount&&
(w.nullcount=h.length-O);k.percentileParams&&(w.median=f(h,k.percentileParams));return w};d.calculateUniqueValuesCount=function(k){const h={};for(let w of k){if(null==w||"string"===typeof w&&""===w.trim())w=null;null==h[w]?h[w]={count:1,data:w}:h[w].count++}return{count:h}};d.createClassBreaksDefinition=r;d.createUVResult=function(k,h,w,O){k=k.count;const M=[];if(w&&h){w=[];var T=z(h[0]);for(const Y of T)if(h[1]){T=z(h[1]);for(const ea of T)if(h[2]){T=z(h[2]);for(const ia of T)w.push(`${x(Y)}${O}${x(ea)}${O}${x(ia)}`)}else w.push(`${x(Y)}${O}${x(ea)}`)}else w.push(Y);
for(const Y of w)k.hasOwnProperty(Y)||(k[Y]={data:Y,count:0})}for(const Y in k)h=k[Y],M.push({value:h.data,count:h.count,label:h.label});return{uniqueValueInfos:M}};d.getAttributeComparator=p;d.getEqualIntervalBins=t;d.getNormalizedValue=function(k,h,w,O){let M=null;switch(h){case "log":0!==k&&(M=Math.log(k)*Math.LOG10E);break;case "percent-of-total":Number.isFinite(O)&&0!==O&&(M=k/O*100);break;case "field":Number.isFinite(w)&&0!==w&&(M=k/w);break;case "natural-log":0<k&&(M=Math.log(k));break;case "square-root":0<
k&&(M=k**.5)}return M};d.isNullCountSupported=G;d.processNullValue=x;d.processSummaryStatisticsResult=function(k,h){let w;for(w in k)a.includes(w)&&(Number.isFinite(k[w])||(k[w]=null));if(!h)return k;["avg","stddev","variance"].forEach(O=>{null!=k[O]&&(k[O]=Math.ceil(k[O]??0))});return k};d.resolveCBResult=function(k,h){let w=k.classBreaks;const O=w[0]?.minValue,M=w[w.length-1]?.maxValue,T="standard-deviation"===h;w=w.map(Y=>{const ea=Y.label;Y={minValue:Y.minValue,maxValue:Y.maxValue,label:ea};if(T&&
ea){const ia=ea.match(n)?.map(na=>+na.trim())??[];2===ia.length?(Y.minStdDev=ia[0],Y.maxStdDev=ia[1],0>ia[0]&&0<ia[1]&&(Y.hasAvg=!0)):1===ia.length&&(ea.includes("\x3c")?(Y.minStdDev=null,Y.maxStdDev=ia[0]):ea.includes("\x3e")&&(Y.minStdDev=ia[0],Y.maxStdDev=null))}return Y});return{minValue:O,maxValue:M,classBreakInfos:w,normalizationTotal:k.normalizationTotal}};d.statisticTypes=a;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/ClassBreaksDefinition":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),
function(d,g,y,x,G,A,f,p,e){G=new g.JSONMap({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"});g=new g.JSONMap({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});y=class extends y.JSONSupport{constructor(v){super(v);this.type="class-breaks-definition";
this.normalizationType=this.normalizationField=this.classificationMethod=this.classificationField=this.breakCount=null}set standardDeviationInterval(v){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",v)}set definedInterval(v){"defined-interval"===this.classificationMethod&&this._set("definedInterval",v)}};d.__decorate([p.enumeration({classBreaksDef:"class-breaks-definition"})],y.prototype,"type",void 0);d.__decorate([x.property({json:{write:!0}})],y.prototype,
"breakCount",void 0);d.__decorate([x.property({json:{write:!0}})],y.prototype,"classificationField",void 0);d.__decorate([x.property({type:String,json:{read:G.read,write:G.write}})],y.prototype,"classificationMethod",void 0);d.__decorate([x.property({json:{write:!0}})],y.prototype,"normalizationField",void 0);d.__decorate([x.property({json:{read:g.read,write:g.write}})],y.prototype,"normalizationType",void 0);d.__decorate([x.property({value:null,json:{write:!0}})],y.prototype,"standardDeviationInterval",
null);d.__decorate([x.property({value:null,json:{write:!0}})],y.prototype,"definedInterval",null);return y=d.__decorate([e.subclass("esri.rest.support.ClassBreaksDefinition")],y)})},"esri/core/accessorSupport/decorators/enumeration":function(){define(["exports","../../jsonMap","./property"],function(d,g,y){d.enumeration=function(x,G={}){x=x instanceof g.JSONMap?x:new g.JSONMap(x,G);x={type:G?.ignoreUnknown??!0?x.apiValues:String,json:{type:x.jsonValues,read:G?.readOnly?!1:{reader:x.read},write:{writer:x.write}}};
void 0!==G?.readOnly&&(x.readOnly=!!G.readOnly);void 0!==G?.default&&(x.json.default=G.default);void 0!==G?.name&&(x.json.name=G.name);void 0!==G?.nonNullable&&(x.nonNullable=G.nonNullable);return y.property(x)};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/generateRendererUtils":function(){define(["exports","../../core/Logger"],function(d,g){function y(E){var J=E.definition;const {classificationMethod:r,normalizationType:q,definedInterval:b}=J;J=J.breakCount??
1;const t=[];var n=E.values;if(0===n.length)return[];n=n.sort((R,Z)=>R-Z);var D=n[0],Q=n[n.length-1];if("equal-interval"===r)if(n.length>=J){n=(Q-D)/J;E=D;for(var a=1;a<J;a++){var C=Number((D+a*n).toFixed(6));t.push({minValue:E,maxValue:C,label:x(E,C,q)});E=C}t.push({minValue:E,maxValue:Q,label:x(E,Q,q)})}else n.forEach(R=>{t.push({minValue:R,maxValue:R,label:x(R,R,q)})});else if("natural-breaks"===r){n=G(n);E=A(n.uniqueValues,E.valueFrequency||n.valueFrequency,J);for(a=1;a<J;a++)n.uniqueValues.length>
a&&(C=Number(n.uniqueValues[E[a]].toFixed(6)),t.push({minValue:D,maxValue:C,label:x(D,C,q)}),D=C);t.push({minValue:D,maxValue:Q,label:x(D,Q,q)})}else if("quantile"===r)if(n.length>=J&&D!==Q){E=Math.ceil(n.length/J);a=0;for(C=1;C<J;C++){var P=E+a-1;P>n.length&&(P=n.length-1);0>P&&(P=0);t.push({minValue:D,maxValue:n[P],label:x(D,n[P],q)});D=n[P];a+=E;E=Math.ceil((n.length-a)/(J-C))}t.push({minValue:D,maxValue:Q,label:x(D,Q,q)})}else for(J=-1,Q=0;Q<n.length;Q++)D=n[Q],D!==J&&(J=D,t.push({minValue:J,
maxValue:D,label:x(J,D,q)}),J=D);else if("standard-deviation"===r)if(E=e(n),a=v(n,E),0===a)t.push({minValue:n[0],maxValue:n[0],label:x(n[0],n[0],q)});else{n=p(D,Q,J,E,a)*a;a=0;for(C=J;1<=C;C--)P=Number((E-(C-.5)*n).toFixed(6)),t.push({minValue:D,maxValue:P,label:x(D,P,q)}),D=P,a++;C=Number((E+.5*n).toFixed(6));t.push({minValue:D,maxValue:C,label:x(D,C,q)});D=C;a++;for(P=1;P<=J;P++)C=a===2*J?Q:Number((E+(P+.5)*n).toFixed(6)),t.push({minValue:D,maxValue:C,label:x(D,C,q)}),D=C,a++}else if("defined-interval"===
r){if(!b)return t;J=n[0];Q=n[n.length-1];n=Math.ceil((Q-J)/b);D=J;for(E=1;E<n;E++)a=Number((J+E*b).toFixed(6)),t.push({minValue:D,maxValue:a,label:x(D,a,q)}),D=a;t.push({minValue:D,maxValue:Q,label:x(D,Q,q)})}return t}function x(E,J,r){let q=null;return q=E===J?r&&"percent-of-total"===r?E+"%":E.toString():r&&"percent-of-total"===r?E+"% - "+J+"%":E+" - "+J}function G(E){const J=[],r=[];let q=Number.MIN_VALUE,b=1,t=-1;for(let n=0;n<E.length;n++){const D=E[n];D===q?(b++,r[t]=b):null!==D&&(J.push(D),
q=D,b=1,r.push(b),t++)}return{uniqueValues:J,valueFrequency:r}}function A(E,J,r){var q=E.length;const b=[];r>q&&(r=q);for(var t=0;t<r;t++)b.push(Math.round(t*q/r-1));b.push(q-1);t=f(b,E,J,r);q=t.mean;t=t.sdcm;var n=r,D=0,Q=0;let a=0,C=0,P=!0;for(let Z=0;2>Z&&P;Z++){0===Z&&(P=!1);for(var R=0;R<n-1;R++)for(;b[R+1]+1!==b[R+2];)if(b[R+1]+=1,D=z(R,b,E,J),a=D.sbMean,D=D.sbSdcm,Q=z(R+1,b,E,J),C=Q.sbMean,Q=Q.sbSdcm,D+Q<t[R]+t[R+1])t[R]=D,t[R+1]=Q,q[R]=a,q[R+1]=C,P=!0;else{--b[R+1];break}for(R=n-1;0<R;R--)for(;b[R]!==
b[R-1]+1;)if(--b[R],D=z(R-1,b,E,J),a=D.sbMean,D=D.sbSdcm,Q=z(R,b,E,J),C=Q.sbMean,Q=Q.sbSdcm,D+Q<t[R-1]+t[R])t[R-1]=D,t[R]=Q,q[R-1]=a,q[R]=C,P=!0;else{b[R]+=1;break}}P&&(t=f(b,E,J,r));return b}function f(E,J,r,q){let b=[];var t=[],n=[];let D=0;const Q=[],a=[];for(var C=0;C<q;C++){var P=z(C,E,J,r);Q.push(P.sbMean);a.push(P.sbSdcm);D+=a[C]}P=D;for(C=!0;C||D<P;){C=!1;b=[];for(t=0;t<q;t++)b.push(E[t]);for(n=0;n<q;n++)for(P=E[n]+1;P<=E[n+1];P++)if(t=J[P],0<n&&P!==E[n+1]&&Math.abs(t-Q[n])>Math.abs(t-Q[n-
1]))E[n]=P;else if(n<q-1&&E[n]!==P-1&&Math.abs(t-Q[n])>Math.abs(t-Q[n+1])){E[n+1]=P-1;break}P=D;D=0;t=[];n=[];for(let R=0;R<q;R++){t.push(Q[R]);n.push(a[R]);const Z=z(R,E,J,r);Q[R]=Z.sbMean;a[R]=Z.sbSdcm;D+=a[R]}}if(D>P){for(J=0;J<q;J++)E[J]=b[J],Q[J]=t[J],a[J]=n[J];D=P}return{mean:Q,sdcm:a}}function p(E,J,r,q,b){E=Math.max(q-E,J-q)/b/r;return 1<=E?1:.5<=E?.5:.25}function e(E){let J=0;for(let r=0;r<E.length;r++)J+=E[r];return J/=E.length}function v(E,J){let r=0;for(let q=0;q<E.length;q++){const b=
E[q];r+=(b-J)*(b-J)}r/=E.length;return Math.sqrt(r)}function z(E,J,r,q){var b=0,t=0;for(var n=J[E]+1;n<=J[E+1];n++){const D=q[n];b+=r[n]*D;t+=D}0>=t&&g.getLogger("esri.rest.support.generateRendererUtils").warn("Exception in Natural Breaks calculation");b/=t;t=0;for(n=J[E]+1;n<=J[E+1];n++)t+=q[n]*(r[n]-b)**2;return{sbMean:b,sbSdcm:t}}d.createGenerateRendererClassBreaks=function(E){const {normalizationTotal:J}=E;return{classBreaks:y(E),normalizationTotal:J}};d.createGenerateRendererUniqueValues=function(E){E=
G(E);const J=[],r=E.uniqueValues.length;for(let q=0;q<r;q++){const b=E.uniqueValues[q];J.push({value:b,count:E.valueFrequency[q],label:b.toString()})}return{uniqueValues:J}};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/SnappingCandidate":function(){define(["exports"],function(d){d.makeEdgeCandidate=function(g,y,x,G,A,f=!1){return{objectId:g,target:y,distance:x,type:"edge",start:G,end:A,draped:f}};d.makeVertexCandidate=function(g,y,x){return{objectId:g,
target:y,distance:x,type:"vertex"}};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/queryUtils":function(){define("require exports ../../../core/jsonMap ../../../core/unitUtils ../../../geometry/projection ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ./projectionSupport".split(" "),function(d,g,y,x,G,A,f,p,e,v){async function z(t,n,D){if(!t)return null;
var {where:Q}=t;t.where=Q=Q?.trim();if(!Q||/^1 *= *1$/.test(Q)||n&&n===Q)t.where=null;if(!t.geometry)return t;n=await J(t);t.distance=0;t.units=null;"esriSpatialRelEnvelopeIntersects"===t.spatialRel&&({spatialReference:Q}=t.geometry,n=A.getGeometryExtent(n),n.spatialReference=Q);if(n){await v.checkProjectionSupport(n.spatialReference,D);Q=n.spatialReference;n=E(n,D)&&f.isExtent(n)?{spatialReference:Q,rings:[[[n.xmin,n.ymin],[n.xmin,n.ymax],[n.xmax,n.ymax],[n.xmax,n.ymin],[n.xmin,n.ymin]]]}:n;Q=(await p.normalizeCentralMeridian(f.fromJSON(n)))[0];
if(null==Q)throw b;const a="quantizationParameters"in t&&t.quantizationParameters?.tolerance||"maxAllowableOffset"in t&&t.maxAllowableOffset||0;n=a&&E(n,D)?{densificationStep:8*a}:void 0;Q=Q.toJSON();n=v.project(Q,Q.spatialReference,D,n);if(!n)throw b;n.spatialReference=D;t.geometry=n}return t}function E(t,n){if(!t)return!1;const D=t.spatialReference;return(f.isExtent(t)||f.isPolygon(t)||f.isPolyline(t))&&!e.equals(D,n)&&!G.canProjectWithoutEngine(D,n)}async function J(t){const {distance:n,units:D}=
t,Q=t.geometry;if(null==n||"vertexAttributes"in Q)return Q;var a=Q.spatialReference;t=D?q.fromJSON(D):x.getUnitString(a);a=a&&(e.isGeographic(a)||e.isWebMercator(a))?Q:await v.checkProjectionSupport(a,e.wgs84).then(()=>v.project(Q,e.wgs84));return(await r())(a.spatialReference,a,n,t)}async function r(){return(await new Promise((t,n)=>d(["../../../geometry/geometryEngineJSON"],t,n))).geodesicBuffer}const q=new y.JSONMap({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",
esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),b=Object.freeze({});g.normalizeQuery=async function(t,n,D){const {outFields:Q,orderByFields:a,groupByFieldsForStatistics:C,outStatistics:P}=t;if(Q)for(var R=0;R<Q.length;R++)Q[R]=Q[R].trim();if(a)for(R=0;R<a.length;R++)a[R]=a[R].trim();if(C)for(R=0;R<C.length;R++)C[R]=C[R].trim();if(P)for(R=0;R<P.length;R++)P[R].onStatisticField&&(P[R].onStatisticField=P[R].onStatisticField.trim());
t.geometry&&!t.outSR&&(t.outSR=t.geometry.spatialReference);return z(t,n,D)};g.normalizeQueryLike=z;g.queryEngineEmptyResult=b;g.unitsKebabDict=q;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/queryValidationUtils":function(){define("exports ../../../core/Error ./attributeSupport ./projectionSupport ./spatialQuerySupport ../../../support/arcadeOnDemand".split(" "),function(d,g,y,x,G,A){function f(E,J,r){const {outFields:q,orderByFields:b,returnDistinctValues:t,
outStatistics:n}=r,D=n?n.map(Q=>Q.outStatisticFieldName&&Q.outStatisticFieldName.toLowerCase()).filter(Boolean):[];if(b&&0<b.length){const Q=b.map(a=>{const C=a.toLowerCase();return C.includes(" asc")?C.split(" asc")[0]:C.includes(" desc")?C.split(" desc")[0]:a}).filter(a=>!D.includes(a));y.validateFields(E,J,Q,{expressionName:"orderByFields",query:r})}if(q&&0<q.length)y.validateFields(E,J,q,{expressionName:"outFields",query:r,allowedFieldTypes:"all"});else if(t)throw new g("unsupported-query","outFields should be specified for returnDistinctValues",
{query:r});y.validateWhere(E,J,r.where,r)}function p(E,J,r){const {outStatistics:q,groupByFieldsForStatistics:b,having:t}=r;var n=b?.length,D=q?.length;if(t){if(!n||!D)throw new g("unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:r});y.validateHaving(E,J,t,q,r)}if(D&&v(q)){D=q.map(Q=>Q.onStatisticField).filter(Boolean);y.validateFields(E,J,D,{expressionName:"onStatisticFields",query:r});n&&y.validateFields(E,J,b,{expressionName:"groupByFieldsForStatistics",
query:r});for(const Q of q){const {onStatisticField:a,statisticType:C}=Q;if(("percentile_disc"===C||"percentile_cont"===C)&&"statisticParameters"in Q){if({statisticParameters:n}=Q,!n)throw new g("unsupported-query","statisticParameters should be set for percentile type",{definition:Q,query:r});}else E.get(a)&&"count"!==C&&"min"!==C&&"max"!==C&&y.validateFields(E,J,[a],{expressionName:`outStatistics with '${C}' statistic type`,allowedFieldTypes:z,query:r})}}}async function e(E,J,r,q){var b=[];r.valueExpression&&
({arcadeUtils:b}=await A.loadArcade(),b=b.extractFieldNames(r.valueExpression));r.field&&b.push(r.field);r.field2&&b.push(r.field2);r.field3&&b.push(r.field3);r.normalizationField&&b.push(r.normalizationField);if(!b.length&&!r.valueExpression)throw new g("unsupported-query","field or valueExpression is required",{params:r});y.validateFields(E,J,b,{expressionName:"statistics",query:q})}function v(E){return null!=E&&E.every(J=>"exceedslimit"!==J.statisticType)}const z=new Set([...y.numericFieldTypes,
...y.allDateAndTimeFieldTypes]);d.validateQuery=async function(E,{fieldsIndex:J,geometryType:r,spatialReference:q,availableFields:b}){if(0>(E.distance??0)||null!=E.geometryPrecision||E.multipatchOption&&"xyFootprint"!==E.multipatchOption||E.pixelSize||E.relationParam||E.text)throw new g("unsupported-query","Unsupported query options",{query:E});f(J,b,E);p(J,b,E);return Promise.all([G.checkSpatialQuerySupport(E,r,q),x.checkProjectionSupport(q,E.outSR)]).then(()=>E)};d.validateStatisticsQuery=async function(E,
J,{fieldsIndex:r,geometryType:q,spatialReference:b,availableFields:t}){if(0>(E.distance??0)||null!=E.geometryPrecision||E.multipatchOption||E.pixelSize||E.relationParam||E.text||E.outStatistics||E.groupByFieldsForStatistics||E.having||E.orderByFields)throw new g("unsupported-query","Unsupported query options",{query:E});f(r,t,E);return Promise.all([e(r,t,J,E),G.checkSpatialQuerySupport(E,q,b),x.checkProjectionSupport(b,E.outSR)]).then(()=>E)};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/graphics/data/spatialQuerySupport":function(){define("require exports ../../../core/Error ../../../geometry/support/contains ../../../geometry/support/intersects ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ../contains ../featureConversionUtils ../OptimizedGeometry ./geometryUtils ./projectionSupport".split(" "),function(d,g,y,x,G,A,f,p,e,v,z,E){function J(){return new Promise((n,D)=>d(["../../../geometry/geometryEngineJSON"],n,D))}const r={esriSpatialRelIntersects:"intersects",
esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null};var q={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,
esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},b={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},t={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};g.canQueryWithRBush=function(n){if(A.isExtent(n))return!0;if(A.isPolygon(n)){for(const D of n.rings)if(5!==D.length||D[0][0]!==D[1][0]||D[0][0]!==D[4][0]||D[2][0]!==D[3][0]||D[0][1]!==D[3][1]||D[0][1]!==
D[4][1]||D[1][1]!==D[2][1])return!1;return!0}return!1};g.checkSpatialQuerySupport=async function(n,D,Q){const {spatialRel:a,geometry:C}=n;if(C){if(null==a||!0!==q[a])throw new y("unsupported-query","Unsupported query spatial relationship",{query:n});if(f.isValid(C.spatialReference)&&f.isValid(Q)){if(null==C||!0!==b[A.getJsonType(C)])throw new y("unsupported-query","Unsupported query geometry type",{query:n});if(null==D||!0!==t[D])throw new y("unsupported-query","Unsupported layer geometry type",{query:n});
if(n.outSR)return E.checkProjectionSupport(n.geometry?.spatialReference,n.outSR)}}};g.getSpatialQueryOperator=function(n,D,Q,a,C){if(A.isPolygon(D)&&"esriGeometryPoint"===Q&&("esriSpatialRelIntersects"===n||"esriSpatialRelContains"===n)){const P=e.convertFromPolygon(new v,D,!1,!1);return Promise.resolve(R=>p.polygonContainsPoint(P,!1,!1,R))}if(A.isPolygon(D)&&"esriGeometryMultipoint"===Q){const P=e.convertFromPolygon(new v,D,!1,!1);if("esriSpatialRelContains"===n)return Promise.resolve(R=>p.polygonContainsMultipoint(P,
!1,!1,R,a,C))}if(A.isExtent(D)&&"esriGeometryPoint"===Q&&("esriSpatialRelIntersects"===n||"esriSpatialRelContains"===n))return Promise.resolve(P=>x.extentContainsPoint(D,z.getGeometry(Q,a,C,P)));if(A.isExtent(D)&&"esriGeometryMultipoint"===Q&&"esriSpatialRelContains"===n)return Promise.resolve(P=>x.extentContainsMultipoint(D,z.getGeometry(Q,a,C,P)));if(A.isExtent(D)&&"esriSpatialRelIntersects"===n){const P=G.getExtentIntersector(Q);return Promise.resolve(R=>P(D,z.getGeometry(Q,a,C,R)))}return J().then(P=>
{const R=P[r[n]].bind(null,D.spatialReference,D);return Z=>R(z.getGeometry(Q,a,C,Z))})};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/intersects":function(){define(["exports","./intersectsBase"],function(d,g){d.extentIntersectsExtent=g.extentIntersectsExtent;d.extentIntersectsMultipoint=g.extentIntersectsMultipoint;d.extentIntersectsPoint=g.extentIntersectsPoint;d.extentIntersectsPolygon=g.extentIntersectsPolygon;d.extentIntersectsPolyline=g.extentIntersectsPolyline;
d.getFeatureExtentIntersector=g.getFeatureExtentIntersector;d.isSelfIntersecting=g.isSelfIntersecting;d.segmentIntersects=g.segmentIntersects;d.getExtentIntersector=function(y){return"mesh"===y?g.extentIntersectsExtent:g.getFeatureExtentIntersector(y)};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/contains":function(){define(["exports"],function(d){function g(y,x,G,A,f){if(!y)return!1;x=x?G?4:3:G?3:2;const {coords:p,lengths:e}=y;G=!1;y=0;for(const z of e){var v=
y;for(let E=y,J=y+z*x;E<J;E+=x){v=E+x;v===J&&(v=y);const r=p[E],q=p[E+1],b=p[v];v=p[v+1];(q<f&&v>=f||v<f&&q>=f)&&r+(f-q)/(v-q)*(b-r)<A&&(G=!G)}y+=z*x}return G}d.polygonContainsCoords=g;d.polygonContainsMultipoint=function(y,x,G,A,f,p){f=f?p?4:3:p?3:2;const {coords:e,lengths:v}=A;if(!v)return!1;for(let z=0,E=0;z<v.length;z++,E+=f)if(!g(y,x,G,e[E],e[E+1]))return!1;return!0};d.polygonContainsPoint=function(y,x,G,A){return g(y,x,G,A.coords[0],A.coords[1])};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/graphics/data/timeSupport":function(){define(["exports"],function(d){function g(G,A,f,p,e){if(null!=p&&null!=e)return v=>{const z=G(v,A);v=G(v,f);return(null==z||z<=e)&&(null==v||v>=p)};if(null!=p)return v=>{v=G(v,f);return null==v||v>=p};if(null!=e)return v=>{v=G(v,A);return null==v||v<=e}}function y(G,A,f,p){if(null!=f&&null!=p&&f===p)return e=>G(e,A)===f;if(null!=f&&null!=p)return e=>{e=G(e,A);return null!=e&&e>=f&&e<=p};if(null!=f)return e=>{e=G(e,A);return null!=e&&e>=f};if(null!=
p)return e=>{e=G(e,A);return null!=e&&e<=p}}function x(){return()=>!1}d.getTimeExtent=async function(G,A){if(!G)return null;const f=A.featureAdapter,{startTimeField:p,endTimeField:e}=G;let v=Number.POSITIVE_INFINITY,z=Number.NEGATIVE_INFINITY;if(p&&e)await A.forEach(E=>{const J=f.getAttribute(E,p);E=f.getAttribute(E,e);null==J||isNaN(J)||(v=Math.min(v,J));null==E||isNaN(E)||(z=Math.max(z,E))});else{const E=p||e;await A.forEach(J=>{J=f.getAttribute(J,E);null==J||isNaN(J)||(v=Math.min(v,J),z=Math.max(z,
J))})}return{start:v,end:z}};d.getTimeOperator=function(G,A,f){if(!A||!G)return null;const {startTimeField:p,endTimeField:e}=G;if(!p&&!e)return null;const {start:v,end:z}=A;if(null===v&&null===z)return null;if(void 0===v&&void 0===z)return x();G=f.getAttributeAsTimestamp?.bind(f)??f.getAttribute.bind(f);return p&&e?g(G,p,e,v,z):y(G,p||e,v,z)};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/FieldsIndex":function(){define("../../core/Error ../../core/JSONSupport ../../core/Logger ../../core/MapUtils ../../core/sql/UnknownTimeZone ./fieldUtils ../../time/timeZoneUtils ../../chunks/datetime".split(" "),
function(d,g,y,x,G,A,f,p){function e(r){return r.trim().toLowerCase()}function v(r){const q=new Map;if(!r.fields)return q;const b=!0===r.datesInUnknownTimezone,{timeInfo:t,editFieldsInfo:n}=r;var D=(t?"startField"in t?t.startField:t.startTimeField:"")??"";const Q=(t?"endField"in t?t.endField:t.endTimeField:"")??"",a="dateFieldsTimeZone"in r?r.dateFieldsTimeZone??null:r.dateFieldsTimeReference?f.fromTimeReference(r.dateFieldsTimeReference):null,C=n?"timeZone"in n?n.timeZone??a:n.dateFieldsTimeReference?
f.fromTimeReference(n.dateFieldsTimeReference):a??f.utc:null,P=t?"timeZone"in t?t.timeZone??a:t.timeReference?f.fromTimeReference(t.timeReference):a:null;D=new Map([[e(n?.creationDateField??""),C],[e(n?.editDateField??""),C],[e(D),P],[e(Q),P]]);for(const {name:R,type:Z}of r.fields)J.has(Z)?q.set(R,f.unknown):"date"!==Z&&"esriFieldTypeDate"!==Z?q.set(R,null):b?q.set(R,f.unknown):(r=D.get(e(R??""))??a,q.set(R,r));return q}const z=new Map;class E{static fromJSON(r){return new E(r.fields,r.timeZoneByFieldName)}static fromLayer(r){return new E(r.fields??
[],v(r))}static fromLayerJSON(r){return new E(r.fields??[],v(r))}constructor(r=[],q){this._fieldsMap=new Map;this._normalizedFieldsMap=new Map;this._dateFieldsSet=new Set;this._numericFieldsSet=new Set;this._requiredFields=null;this.dateFields=[];this.numericFields=[];this.fields=r||[];this._timeZoneByFieldName=q?new Map(q):null;r=[];for(const b of this.fields){q=b?.name;const t=A.normalizeFieldName(q)?.toLowerCase()??"";if(q&&t){const n=e(q);this._fieldsMap.set(q,b);this._fieldsMap.set(n,b);this._normalizedFieldsMap.set(t,
b);r.push(`${n}:${b.type}:${this._timeZoneByFieldName?.get(q)}`);A.isDateField(b)?(this.dateFields.push(b),this._dateFieldsSet.add(b)):A.isNumericField(b)&&(this._numericFieldsSet.add(b),this.numericFields.push(b));A.isObjectIDField(b)||A.isGlobalIDField(b)||(b.editable=null==b.editable||!!b.editable,b.nullable=null==b.nullable||!!b.nullable)}}r.sort();this.uid=r.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const r of this.fields)A.isObjectIDField(r)||A.isGlobalIDField(r)||
r.nullable||void 0!==A.getFieldDefaultValue(r)||this._requiredFields.push(r)}return this._requiredFields}equals(r){return this.uid===r?.uid}has(r){return null!=this.get(r)}get(r){if(r){var q=this._fieldsMap.get(r);if(q)return q;(q=this._fieldsMap.get(e(r))??this._normalizedFieldsMap.get(A.normalizeFieldName(r)?.toLowerCase()??""))&&this._fieldsMap.set(r,q);return q}}getTimeZone(r){r=this.get(r&&"string"!==typeof r?r.name:r);return r?this._timeZoneByFieldName?this._timeZoneByFieldName.get(r.name):
"date"===r.type||"esriFieldTypeDate"===r.type?(y.getLogger("esri.layers.support.FieldsIndex").error(new d("getTimeZone:no-timezone-information",`no time zone information for field '${r.name}'`)),f.utc):J.has(r.type)?f.unknown:null:null}getLuxonTimeZone(r){const q=this.getTimeZone(r);return q?q===f.unknown?G.UnknownTimeZone.instance:q===f.utc?p.FixedOffsetZone.utcInstance:x.getOrCreateMapValue(z,q,()=>p.IANAZone.create(q)):null}isDateField(r){return this._dateFieldsSet.has(this.get(r))}isTimeOnlyField(r){return A.isTimeOnlyField(this.get(r))}isNumericField(r){return this._numericFieldsSet.has(this.get(r))}normalizeFieldName(r){return this.get(r)?.name??
void 0}toJSON(){return{fields:this.fields.map(r=>g.isSerializable(r)?r.toJSON():r),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}}const J=new Set("time-only date-only timestamp-offset esriFieldTypeDateOnly esriFieldTypeTimeOnly esriFieldTypeTimestampOffset".split(" "));return E})},"esri/views/support/Scheduler":function(){define("exports ../../core/Handles ../../core/has ../../core/Logger ../../core/maybe ../../core/PerformanceSampler ../../core/PooledArray ../../core/promiseUtils ../../core/reactiveUtils ../../core/signal ../../core/time ../../layers/support/PromiseQueue ./debugFlags ./RenderState ./Yield".split(" "),
function(d,g,y,x,G,A,f,p,e,v,z,E,J,r,q){function b(U){return t.has(U)?t.get(U):"number"===typeof U?U:1}d.TaskPriority=void 0;(function(U){U.RESOURCE_CONTROLLER_IMMEDIATE="immediate";U.RESOURCE_CONTROLLER="schedule";U.SLIDE="slide";U.STREAM_DATA_LOADER="stream loader";U.ELEVATION_QUERY="elevation query";U.TERRAIN_SURFACE="terrain";U.SURFACE_GEOMETRY_UPDATES="surface geometry updates";U.LOD_RENDERER="LoD renderer";U.GRAPHICS_CORE="Graphics3D";U.I3S_CONTROLLER="I3S";U.POINT_CLOUD_LAYER="point cloud";
U.FEATURE_TILE_FETCHER="feature fetcher";U.OVERLAY="overlay";U.STAGE="stage";U.GRAPHICS_DECONFLICTOR="graphics deconflictor";U.FILTER_VISIBILITY="Graphics3D filter visibility";U.SCALE_VISIBILITY="Graphics3D scale visibility";U.FRUSTUM_VISIBILITY="Graphics3D frustum visibility";U.POINT_OF_INTEREST_FREQUENT="POI frequent";U.POINT_OF_INTEREST_INFREQUENT="POI infrequent";U.LABELER="labeler";U.FEATURE_QUERY_ENGINE="feature query";U.FEATURE_TILE_TREE="feature tile tree";U.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree";
U.ELEVATION_ALIGNMENT="elevation alignment";U.ELEVATION_ALIGNMENT_SCENE="elevation alignment scene";U.TEXT_TEXTURE_ATLAS="text texture atlas";U.TEXTURE_UNLOAD="texture unload";U.LINE_OF_SIGHT_TOOL="line of sight tool";U.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool";U.ELEVATION_PROFILE="elevation profile";U.SNAPPING="snapping";U.SHADOW_ACCUMULATOR="shadow accumulator";U.CLOUDS_GENERATOR="clouds generator";U[U.NONE=0]="NONE";U[U.TEST_PRIO=1]="TEST_PRIO"})(d.TaskPriority||(d.TaskPriority=
{}));const t=new Map([[d.TaskPriority.RESOURCE_CONTROLLER_IMMEDIATE,0],[d.TaskPriority.RESOURCE_CONTROLLER,4],[d.TaskPriority.SLIDE,0],[d.TaskPriority.STREAM_DATA_LOADER,0],[d.TaskPriority.ELEVATION_QUERY,0],[d.TaskPriority.TERRAIN_SURFACE,1],[d.TaskPriority.SURFACE_GEOMETRY_UPDATES,1],[d.TaskPriority.LOD_RENDERER,2],[d.TaskPriority.GRAPHICS_CORE,2],[d.TaskPriority.I3S_CONTROLLER,2],[d.TaskPriority.POINT_CLOUD_LAYER,2],[d.TaskPriority.FEATURE_TILE_FETCHER,2],[d.TaskPriority.OVERLAY,4],[d.TaskPriority.STAGE,
4],[d.TaskPriority.GRAPHICS_DECONFLICTOR,4],[d.TaskPriority.FILTER_VISIBILITY,4],[d.TaskPriority.SCALE_VISIBILITY,4],[d.TaskPriority.FRUSTUM_VISIBILITY,4],[d.TaskPriority.CLOUDS_GENERATOR,4],[d.TaskPriority.POINT_OF_INTEREST_FREQUENT,6],[d.TaskPriority.POINT_OF_INTEREST_INFREQUENT,30],[d.TaskPriority.LABELER,8],[d.TaskPriority.FEATURE_QUERY_ENGINE,8],[d.TaskPriority.FEATURE_TILE_TREE,16],[d.TaskPriority.FEATURE_TILE_TREE_ACTIVE,0],[d.TaskPriority.ELEVATION_ALIGNMENT,12],[d.TaskPriority.ELEVATION_ALIGNMENT_SCENE,
14],[d.TaskPriority.TEXT_TEXTURE_ATLAS,12],[d.TaskPriority.TEXTURE_UNLOAD,12],[d.TaskPriority.LINE_OF_SIGHT_TOOL,16],[d.TaskPriority.LINE_OF_SIGHT_TOOL_INTERACTIVE,0],[d.TaskPriority.SNAPPING,0],[d.TaskPriority.SHADOW_ACCUMULATOR,30]]),n=z.Milliseconds(6.5),D=z.Milliseconds(1),Q=z.Milliseconds(30),a=z.Milliseconds(1E3/30),C=z.Milliseconds(100);var P;(function(U){class u{get updating(){return this._updating.value}_updatingChanged(){this._updating.value=this._tasks.some(h=>h.needsUpdate)}constructor(){this._updating=
v.signal(!0);this._microTaskQueued=!1;this._frameNumber=0;this.performanceInfo={total:new A("total"),tasks:new Map};this._frameTaskTimes=new Map;this._budget=new k;this._state=r.RenderState.INTERACTING;this._tasks=new f;this._runQueue=new f;this._load=0;this._idleStateCallbacks=new f;this._debug=this._forceTask=this._idleUpdatesStartFired=!1;this._debugHandle=e.watch(()=>J.SCHEDULER_LOG_SLOW_TASKS,h=>this._debug=h,e.initial);for(const h of Object.keys(d.TaskPriority))this.performanceInfo.tasks.set(d.TaskPriority[h],
new A(d.TaskPriority[h]))}destroy(){this._tasks.toArray().forEach(h=>h.remove());this._tasks.clear();G.removeMaybe(this._debugHandle);this._microTaskQueued=!1;this._updatingChanged()}taskRunningChanged(h){this._updatingChanged();h&&0<this._budget.remaining&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask(()=>{this._microTaskQueued&&(this._microTaskQueued=!1,0<this._budget.remaining&&this._schedule()&&this.frame())}))}registerTask(h,w){w=new I(this,h,w);this._tasks.push(w);this._updatingChanged();
this.performanceInfo.tasks.has(h)||this.performanceInfo.tasks.set(h,new A(h));return w}registerIdleStateCallbacks(h,w){const O={idleBegin:h,idleEnd:w};this._idleStateCallbacks.push(O);this.state===r.RenderState.IDLE&&this._idleUpdatesStartFired&&O.idleBegin();const M=this;return{remove:()=>this._removeIdleStateCallbacks(O),set idleBegin(T){M._idleUpdatesStartFired&&(O.idleEnd(),M._state===r.RenderState.IDLE&&T());O.idleBegin=T},set idleEnd(T){O.idleEnd=T}}}get load(){return this._load}set state(h){this._state!==
h&&(this._state=h,this.state!==r.RenderState.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll(w=>w.idleEnd())))}get state(){return this._state}updateBudget(h){++this._frameNumber;let w=n,O=h.frameDuration,M=D;switch(this.state){case r.RenderState.IDLE:w=z.Milliseconds(0);O=z.Milliseconds(Math.max(C,h.frameDuration));M=Q;break;case r.RenderState.INTERACTING:O=z.Milliseconds(Math.max(a,h.frameDuration))}O=z.Milliseconds(O-h.elapsedFrameTime-w);if(this.state!==
r.RenderState.IDLE&&O<D&&!this._forceTask)return this._forceTask=!0,!1;O=z.Milliseconds(Math.max(O,M));this._budget.reset(O,this.state);this._updateLoad();return this._schedule()}frame(){this._microTaskQueued=this._forceTask=!1;switch(this.state){case r.RenderState.IDLE:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll(h=>h.idleBegin()));this._runIdle();break;case r.RenderState.INTERACTING:this._runInteracting();break;default:this._runAnimating()}}stopFrame(){this._budget.reset(z.Milliseconds(0),
this._state);this._budget.madeProgress()}_removeIdleStateCallbacks(h){this._idleUpdatesStartFired&&h.idleEnd();this._idleStateCallbacks.removeUnordered(h)}removeTask(h){this._tasks.removeUnordered(h);this._runQueue.removeUnordered(h);this._updatingChanged()}_updateTask(h){this._tasks.forAll(w=>{w.name===h&&w.setPriority(h)})}_getState(h){if(this._runQueue.some(O=>O.name===h))return d.TaskState.SCHEDULED;let w=d.TaskState.IDLE;this._tasks.forAll(O=>{O.name===h&&O.needsUpdate&&(1>=O.schedulePriority?
w=d.TaskState.READY:w!==d.TaskState.READY&&(w=d.TaskState.WAITING))});return w}_getRuntime(h){let w=0;this._tasks.forAll(O=>{O.name===h&&(w+=O.runtime)});return w}_resetRuntimes(){this._tasks.forAll(h=>h.runtime=0)}_getRunning(){const h=new Map;this._tasks.forAll(O=>{O.needsUpdate&&h.set(O.name,(h.get(O.name)||0)+1)});if(0===h.size)return null;let w="";h.forEach((O,M)=>{w=1<O?w+` ${O}x ${M}`:w+` ${M}`});return w}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const h=
this._tasks.reduce((w,O)=>O.needsUpdate?++w:w,0);this._load=.9*this._load+h*(1-.9)}_schedule(){this._runQueue.filterInPlace(h=>{if(h.needsUpdate)return!0;h.schedulePriority=h.basePriority;return!1});for(this._tasks.forAll(h=>{0===h.basePriority&&h.needsUpdate&&!this._runQueue.includes(h)&&h.blockFrame!==this._frameNumber&&this._runQueue.unshift(h)});0===this._runQueue.length;){let h=!1;this._tasks.forAll(w=>{if(w.needsUpdate&&0!==w.schedulePriority&&0!==w.basePriority&&w.blockFrame!==this._frameNumber)switch(h=
!0,w.schedulePriority){case 1:w.schedulePriority=0;this._runQueue.push(w);break;default:--w.schedulePriority}});if(!h)return this._updatingChanged(),!1}this._updatingChanged();return!0}_run(){const h=this._budget.now();this._startFrameTaskTimes();do for(;0<this._runQueue.length;){var w=this._budget.now();const O=this._runQueue.pop();this._budget.resetProgress();try{O.task.runTask(this._budget)===q.Yield&&(O.blockFrame=this._frameNumber)}catch(M){x.getLogger("esri.views.support.Scheduler").error(`Exception in task "${O.name}"`,
M),O.blockFrame=this._frameNumber}!this._budget.hasProgressed&&O.blockFrame!==this._frameNumber&&O.needsUpdate&&(O.blockFrame=this._frameNumber);O.schedulePriority=O.basePriority;w=this._budget.now()-w;O.runtime+=w;this._frameTaskTimes.set(O.priority,this._frameTaskTimes.get(O.priority)+w);if(0>=this._budget.remaining){this._updatingChanged();this._recordFrameTaskTimes(this._budget.now()-h);return}}while(this._schedule());this._updatingChanged();this._recordFrameTaskTimes(this._budget.now()-h)}_startFrameTaskTimes(){for(const h of Object.keys(d.TaskPriority))this._frameTaskTimes.set(d.TaskPriority[h],
0)}_recordFrameTaskTimes(h){this._frameTaskTimes.forEach((w,O)=>this.performanceInfo.tasks.get(O).record(w));this.performanceInfo.total.record(h)}get test(){}}U.Scheduler=u;class I{get task(){return this._task.value}get updating(){return this._queue.running}constructor(h,w,O){this._scheduler=h;this.name=w;this.runtime=this.blockFrame=0;this._queue=new E.PromiseQueue;this._handles=new g;this.schedulePriority=this._basePriority=b(w);this._task=v.signal(null!=O?O:this._queue);this._handles.add(e.when(()=>
this.task.running,M=>h.taskRunningChanged(M)))}remove(){this.processQueue(R);this._scheduler.removeTask(this);this.schedule=W.schedule;this.reschedule=W.reschedule;this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(h){if(this.name!==h){this.name=h;h=b(h);if(0===this._basePriority||0!==this.schedulePriority)this.schedulePriority=h;this._basePriority=h}}get priority(){return this.name}set priority(h){this.setPriority(h)}get needsUpdate(){return this.updating||this.task.running}schedule(h,
w,O){return this._queue.push(h,w,O)}reschedule(h,w,O){return this._queue.unshift(h,w,O)}processQueue(h){return this._queue.runTask(h)}}class k{constructor(){this._begin="undefined"!==typeof performance?performance.now():0;this._budget=0;this._state=r.RenderState.IDLE;this._progressed=this._done=!1;this._enabled=!0}run(h){if(this.done)return!1;!0===h()&&this.madeProgress();return!0}get done(){return this._done}get budget(){return this._budget}madeProgress(){this._progressed=!0;return this._done=this.elapsed>=
this._budget&&this._enabled}get state(){return this._state}get enabled(){return this._enabled}set enabled(h){this._enabled=h}reset(h,w){this._begin=this.now();this._budget=h;this._state=w;this.resetProgress()}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return this.now()-this._begin}resetProgress(){this._done=this._progressed=!1}get hasProgressed(){return this._progressed}}U.Budget=k})(P||={});d.TaskState=void 0;(function(U){U.SCHEDULED=
"s";U.READY="r";U.WAITING="w";U.IDLE="i"})(d.TaskState||(d.TaskState={}));const R=(()=>{const U=new P.Budget;U.enabled=!1;return U})();class Z{remove(){}processQueue(){}schedule(U,u,I){try{if(p.isAborted(u)){const k=p.createAbortError();return I?Promise.resolve(I(k)):Promise.reject(k)}return p.when(U(R))}catch(k){return Promise.reject(k)}}reschedule(U,u,I){return this.schedule(U,u,I)}}const W=new Z;d.ImmediateTask=W;d.getTaskPriority=b;d.newScheduler=function(){return new P.Scheduler};d.noBudget=
R;d.taskPriorities=t;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/signal":function(){define(["exports","./lang","./accessorSupport/tracking","./accessorSupport/tracking/SimpleObservable"],function(d,g,y,x){class G{constructor(A,f){this._observable=new x.SimpleObservable;this._value=A;this._equalityFunction=f}get value(){y.trackAccess(this._observable);return this._value}set value(A){this._equalityFunction(A,this._value)||(this._value=A,this._observable.notify())}mutate(A){A(this._value);
this._observable.notify()}}d.signal=function(A,f=g.equalsShallow){return new G(A,f)};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/PromiseQueue":function(){define(["exports","../../core/promiseUtils","../../core/signal","../../views/support/Yield"],function(d,g,y,x){class G{constructor(){this._tasks=[];this._runningTasks=y.signal(0)}get length(){return this._tasks.length}get running(){return 0<this._runningTasks.value}destroy(){this.cancelAll()}runTask(f){if(0===
this.length)return x.Yield;for(;!f.done&&this._process(f);)f.madeProgress()}push(f,p,e){++this._runningTasks.value;return(new Promise((v,z)=>this._tasks.push(new A(v,z,f,p,e)))).finally(()=>--this._runningTasks.value)}unshift(f,p,e){++this._runningTasks.value;return(new Promise((v,z)=>this._tasks.unshift(new A(v,z,f,p,e)))).finally(()=>--this._runningTasks.value)}_process(f){if(0===this._tasks.length)return!1;const p=this._tasks.shift();try{const e=g.isAborted(p.signal);if(e&&!p.abortCallback)p.reject(g.createAbortError());
else{const v=e?p.abortCallback?.(g.createAbortError()):p.callback(f);g.isPromiseLike(v)?v.then(p.resolve,p.reject):p.resolve(v)}}catch(e){p.reject(e)}return!0}cancelAll(){const f=g.createAbortError();for(const p of this._tasks)if(p.abortCallback){const e=p.abortCallback(f);p.resolve(e)}else p.reject(f);this._tasks.length=0}}class A{constructor(f,p,e,v,z){this.resolve=f;this.reject=p;this.callback=e;this.signal=v;this.abortCallback=z}}d.PromiseQueue=G;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},
"esri/views/support/Yield":function(){define(["exports"],function(d){const g=Symbol("Yield");d.Yield=g;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/debugFlags":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),function(d,g,y,x,G,A,f){g=class extends g{constructor(){super(...arguments);this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=
this.SCHEDULER_LOG_SLOW_TASKS=!1}};d.__decorate([y.property()],g.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0);d.__decorate([y.property()],g.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0);g=d.__decorate([f.subclass("esri.views.support.debugFlags")],g);return new g})},"esri/views/support/RenderState":function(){define(["exports"],function(d){d.RenderState=void 0;var g=d.RenderState||(d.RenderState={});g[g.ANIMATING=0]="ANIMATING";g[g.INTERACTING=1]="INTERACTING";g[g.IDLE=2]=
"IDLE";Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/sources/geojson/geojson":function(){define("exports ../../../../core/date ../../../../core/Error ../../../../geometry/support/spatialReferenceUtils ../../OptimizedFeature ../../OptimizedGeometry ../../../support/fieldUtils".split(" "),function(d,g,y,x,G,A,f){function*p(a){switch(a.type){case "Feature":yield a;break;case "FeatureCollection":for(const C of a.features)C&&(yield C)}}function*e(a){if(a)switch(a.type){case "Point":yield a.coordinates;
break;case "LineString":case "MultiPoint":yield*a.coordinates;break;case "MultiLineString":case "Polygon":for(const C of a.coordinates)yield*C;break;case "MultiPolygon":for(const C of a.coordinates)for(const P of C)yield*P}}function*v(a,C={}){const {geometryType:P,objectIdField:R}=C;for(const Z of a){const {geometry:W,properties:U,id:u}=Z;if(W&&Q[W.type]!==P)continue;a=U||{};let I=void 0;R&&(I=a[R],null==u||I||(a[R]=I=u));yield new G.OptimizedFeature(W?r(new A,W,C):null,a,null,I??void 0)}}function z(a){for(const C of a)if(2<
C.length)return!0;return!1}function E(a){let C=0;for(let P=0;P<a.length;P++){const R=a[P],Z=a[(P+1)%a.length];C+=R[0]*Z[1]-Z[0]*R[1]}return 0>=C}function J(a){const C=a[0],P=a[a.length-1];C[0]===P[0]&&C[1]===P[1]&&C[2]===P[2]||a.push(C);return a}function r(a,C,P){switch(C.type){case "LineString":return t(a,C.coordinates,P),a;case "MultiLineString":for(const Z of C.coordinates)t(a,Z,P);return a;case "MultiPoint":return t(a,C.coordinates,P),a;case "MultiPolygon":for(var R of C.coordinates)for(q(a,R[0],
P),C=1;C<R.length;C++)b(a,R[C],P);return a;case "Point":return D(a,C.coordinates,P),a;case "Polygon":R=C.coordinates;q(a,R[0],P);for(C=1;C<R.length;C++)b(a,R[C],P);return a}}function q(a,C,P){C=J(C);E(C)?t(a,C,P):n(a,C,P)}function b(a,C,P){C=J(C);E(C)?n(a,C,P):t(a,C,P)}function t(a,C,P){for(const R of C)D(a,R,P);a.lengths.push(C.length)}function n(a,C,P){for(let R=C.length-1;0<=R;R--)D(a,C[R],P);a.lengths.push(C.length)}function D(a,C,P){const [R,Z,W]=C;a.coords.push(R,Z);P.hasZ&&a.coords.push(W||
0)}const Q={LineString:"esriGeometryPolyline",MultiLineString:"esriGeometryPolyline",MultiPoint:"esriGeometryMultipoint",Point:"esriGeometryPoint",Polygon:"esriGeometryPolygon",MultiPolygon:"esriGeometryPolygon"};d.createOptimizedFeatures=function(a,C){return Array.from(v(p(a),C))};d.getGeometryType=function(a){return Q[a]};d.inferLayerProperties=function(a,C={}){const P=[];var R=new Set;const Z=new Set;var W=!1;let U=null,u=!1,I=void 0;({geometryType:C=null}=C);var k=!1;for(const h of p(a)){const {geometry:w,
properties:O,id:M}=h;if(w&&(C||=Q[w.type],Q[w.type]!==C))continue;W||(W=e(w),W=z(W));!u&&(u=null!=M)&&(I=typeof M,O&&(U=Object.keys(O).filter(T=>O[T]===M)));O&&U&&u&&null!=M&&(1<U.length?U=U.filter(T=>O[T]===M):1===U.length&&(U=O[U[0]]===M?U:[]));if(!k&&O){a=!0;for(const T in O){if(R.has(T))continue;k=O[T];if(null==k){a=!1;Z.add(T);continue}a:switch(typeof k){case "string":k=g.isISO8601Date(k)?"esriFieldTypeDate":"esriFieldTypeString";break a;case "number":k="esriFieldTypeDouble";break a;default:k=
"unknown"}if("unknown"===k){Z.add(T);continue}Z.delete(T);R.add(T);const Y=f.normalizeFieldName(T);Y&&P.push({name:Y,alias:T,type:k})}k=a}}if(R=f.normalizeFieldName(1===U?.length&&U[0]||null)??void 0)for(const h of P)if(h.name===R&&f.isNumericField(h)){h.type="esriFieldTypeOID";break}return{fields:P,geometryType:C,hasZ:W,objectIdFieldName:R,objectIdFieldType:I,unknownFields:Array.from(Z)}};d.validateGeoJSON=function(a,C=4326){if(!a)throw new y("geojson-layer:empty","GeoJSON data is empty");if("Feature"!==
a.type&&"FeatureCollection"!==a.type)throw new y("geojson-layer:unsupported-geojson-object","missing or not supported GeoJSON object type",{data:a});({crs:a}=a);if(a){var P="string"===typeof a?a:"name"===a.type?a.properties.name:"EPSG"===a.type?a.properties.code:null;C=x.isWGS84({wkid:C})?RegExp(".*(CRS84H?|4326)$","i"):new RegExp(`.*(${C})$`,"i");if(!P||!C.test(P))throw new y("geojson:unsupported-crs","unsupported GeoJSON 'crs' member",{crs:a});}};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},
"esri/core/date":function(){define(["exports"],function(d){function g(f){const p=new Date(f);if(Number.isNaN(p.getTime()))f=!1;else{var e=!0;if(A&&/\d+\W*$/.test(f)&&(f=f.match(/[a-zA-Z]{2,}/))){e=!1;let v=0;for(;!e&&v<=f.length;)e=!G.test(f[v]),v++;e=!e}f=e}return f?Number.isNaN(p.getTime())?null:p.getTime()-6E4*p.getTimezoneOffset():null}function y(f){f=x.exec(f);if(!f?.groups)return null;f=f.groups;const p=+f.year,e=+f.month-1,v=+f.day,z=+(f.hours??0),E=+(f.minutes??0),J=+(f.seconds??0);if(23<
z||59<E||59<J)return null;var r=f.ms??"0";r=r?+r.padEnd(3,"0").substring(0,3):0;f=f.isUTC||!f.offsetSign?Date.UTC(p,e,v,z,E,J,r):6E4*("+"===f.offsetSign?-1:1)*(60*+f.offsetHours+ +f.offsetMinutes)+Date.UTC(p,e,v,z,E,J,r);return Number.isNaN(f)?null:f}const x=/^(?:(?<year>-?\d{4,})-(?<month>\d{2})-(?<day>\d{2}))(?:T(?<hours>\d{2}):(?<minutes>\d{2}):(?<seconds>\d{2})(?:\.(?<ms>\d+))?)?(?:(?<isUTC>Z)|(?:(?<offsetSign>\+|-)(?<offsetHours>\d{2}):(?<offsetMinutes>\d{2})))?$/,G=/^((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(tember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)|(am)|(pm)|(gmt)|(utc))$/i,
A=!Number.isNaN((new Date("technology 10")).getTime());d.isDateString=function(f){return null!=y(f)||null!=g(f)};d.isISO8601Date=function(f){return x.test(f)};d.parseDate=function(f){return y(f)??g(f)};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/sources/support/clientSideDefaults":function(){define(["exports","../../../../core/has","../../../../core/lang","../../data/QueryEngineCapabilities","../../../../symbols/support/defaultsJSON"],function(d,g,y,x,G){function A(e){return f.test(e)?
`.${e}`:`["${e}"]`}const f=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let p=1;d.createCapabilities=function(e,v){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:e},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:v,supportsDelete:v,supportsEditing:v,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,
supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:v,supportsExceedsLimitStatistics:!0,supportsAsyncConvert3D:!1},query:x.queryCapabilities,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsGeometryUpdate:v,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,
supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1,zDefault:void 0}}};d.createDefaultAttributesFunction=function(e,v){if(g("esri-csp-restrictions"))return()=>({[v]:null,...e});try{let z=`this${A(v)} = null;`;for(const J in e){const r=A(J);z+=`this${r} = ${JSON.stringify(e[J])};`}const E=(new Function(`\n      return class AttributesClass$${p++} {\n        constructor() {\n          ${z};\n        }\n      }\n    `))();return()=>new E}catch(z){return()=>
({[v]:null,...e})}};d.createDefaultTemplate=function(e={}){return[{name:"New Feature",description:"",prototype:{attributes:y.clone(e)}}]};d.createDrawingInfo=function(e){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===e||"esriGeometryMultipoint"===e?G.defaultPointSymbolJSON:"esriGeometryPolyline"===e?G.defaultPolylineSymbolJSON:G.defaultPolygonSymbolJSON}}};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/defaultsJSON":function(){define(["exports"],
function(d){const g=[252,146,31,255],y={type:"esriSMS",style:"esriSMSCircle",size:6,color:g,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},x={type:"esriSLS",style:"esriSLSSolid",width:.75,color:g};d.defaultColor=g;d.defaultOutlineColor=[153,153,153,255];d.defaultPointSymbolJSON=y;d.defaultPolygonSymbolJSON={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}};d.defaultPolylineSymbolJSON=
x;d.defaultTextSymbolJSON={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0};d.errorPointSymbolJSON={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5};d.errorPolygonSymbolJSON={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null};d.errorPolylineSymbolJSON={type:"esriSLS",style:"esriSLSSolid",
color:[0,0,0,255],width:1.5};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/sources/support/sourceUtils":function(){define(["require","exports","../../../../core/date","../../../../geometry/support/spatialReferenceUtils","../../../support/fieldUtils"],function(d,g,y,x,G){function A(J){return new e(J)}async function f(){null==E&&(E=await new Promise((J,r)=>d(["../../../../geometry/geometryEngineJSON"],J,r)));return E}class p{constructor(){this.description=this.code=
null}}class e{constructor(J){this.error=new p;this.objectId=this.globalId=null;this.success=!1;this.uniqueId=null;this.error.description=J}}class v{constructor(J){this.globalId=null;this.success=!0;this.objectId=this.uniqueId=J}}const z=new Set;let E;g.createFeatureEditErrorResult=A;g.createFeatureEditSuccessResult=function(J){return new v(J)};g.loadGeometryEngineForSimplify=async function(J,r){!x.isValid(J)||"esriGeometryPolygon"!==r&&"esriGeometryPolyline"!==r||await f()};g.mixAttributes=function(J,
r,q,b=!1){z.clear();for(const D in q){const Q=J.get(D);if(!Q)continue;var t=Q,n=q[D];let a=n;G.isNumericField(t)&&"string"===typeof n?a=parseFloat(n):G.isStringField(t)&&null!=n&&"string"!==typeof n?a=String(n):G.isDateField(t)&&"string"===typeof n&&(a=y.parseDate(n));t=G.sanitizeNullFieldValue(a);z.add(Q.name);if(Q&&(b||Q.editable)){if(n=G.validateFieldValue(Q,t))return A(G.validationErrorToString(n,Q,t));r[Q.name]=t}}for(const D of J?.requiredFields??[])if(!z.has(D.name))return A(`missing required field "${D.name}"`);
return null};g.simplify=function(J,r){if(!J||!x.isValid(r))return J;if("rings"in J||"paths"in J){if(null==E)throw new TypeError("geometry engine not loaded");return E.simplify(r,J)}return J};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("../../../../request ../../../../core/asyncUtils ../../../../core/Error ../../../../core/Logger ../../../../core/promiseUtils ../../../../geometry/support/jsonUtils ../../../../geometry/support/spatialReferenceUtils ../../featureConversionUtils ../../data/FeatureStore ../../data/projectionSupport ../../data/QueryEngine ./geojson ../support/clientSideDefaults ../support/sourceUtils ../../../support/FieldsIndex ../../../support/fieldType ../../../support/fieldUtils ../../../../time/timeZoneUtils".split(" "),function(d,
g,y,x,G,A,f,p,e,v,z,E,J,r,q,b,t,n){const D={hasAttachments:!1,capabilities:"query, editing, create, delete, update",useStandardizedQueries:!0,supportsCoordinatesQuantization:!0,supportsReturningQueryGeometry:!0,advancedQueryCapabilities:{supportsQueryAttachments:!1,supportsStatistics:!0,supportsPercentileStatistics:!0,supportsReturningGeometryCentroid:!0,supportsQueryWithDistance:!0,supportsDistinct:!0,supportsReturningQueryExtent:!0,supportsReturningGeometryProperties:!1,supportsHavingClause:!0,
supportsOrderBy:!0,supportsPagination:!0,supportsQueryWithResultType:!1,supportsSqlExpression:!0,supportsDisjointSpatialRel:!0}};class Q{constructor(){this._queryEngine=null;this._snapshotFeatures=async a=>{a=await this._fetch(a);return this._createFeatures(a)}}destroy(){this._queryEngine?.destroy();this._queryEngine=this._createDefaultAttributes=null}async load(a,C={}){this._loadOptions={url:a.url,customParameters:a.customParameters};var P=[];[C]=await Promise.all([a.url?this._fetch(C?.signal):null,
this._checkProjection(a.spatialReference)]);var R=E.inferLayerProperties(C,{geometryType:a.geometryType}),Z=a.fields||R.fields||[];const W=null!=a.hasZ?a.hasZ:R.hasZ,U=R.geometryType;let u=a.objectIdField||R.objectIdFieldName||"__OBJECTID";const I=a.spatialReference||f.wgs84;a=a.timeInfo;Z===R.fields&&0<R.unknownFields.length&&P.push({name:"geojson-layer:unknown-field-types",message:"Some fields types couldn't be inferred from the features and were dropped",details:{unknownFields:R.unknownFields}});
var k=new q(Z);let h=k.get(u);h?("esriFieldTypeString"!==h.type&&(h.type="esriFieldTypeOID"),h.editable=!1,h.nullable=!1,u=h.name):(h={alias:u,name:u,type:"string"===R.objectIdFieldType?"esriFieldTypeString":"esriFieldTypeOID",editable:!1,nullable:!1},Z.unshift(h));R={};for(var w of Z){null==w.name&&(w.name=w.alias);null==w.alias&&(w.alias=w.name);if(!w.name)throw new y("geojson-layer:invalid-field-name","field name is missing",{field:w});if(!b.kebabDict.jsonValues.includes(w.type))throw new y("geojson-layer:invalid-field-type",
`invalid type for field "${w.name}"`,{field:w});if(w.name!==h.name){const T=t.getFieldDefaultValue(w);void 0!==T&&(R[w.name]=T)}null==w.length&&(w.length=t.getFieldDefaultLength(w))}a&&(a.startTimeField&&((w=k.get(a.startTimeField))?(a.startTimeField=w.name,w.type="esriFieldTypeDate"):a.startTimeField=null),a.endTimeField&&((w=k.get(a.endTimeField))?(a.endTimeField=w.name,w.type="esriFieldTypeDate"):a.endTimeField=null),a.trackIdField&&((w=k.get(a.trackIdField))?a.trackIdField=w.name:(a.trackIdField=
null,P.push({name:"geojson-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:a}}))),a.startTimeField||a.endTimeField||(P.push({name:"geojson-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing",details:{timeInfo:a}}),a=null));w=U?J.createDrawingInfo(U):void 0;k=k.dateFields.length?{timeZoneIANA:n.utc}:null;P={warnings:P,featureErrors:[],layerDefinition:{...D,drawingInfo:w??void 0,templates:J.createDefaultTemplate(R),extent:void 0,geometryType:U,
objectIdField:u,fields:Z,hasZ:!!W,timeInfo:a,dateFieldsTimeReference:k}};this._queryEngine=new z.QueryEngine({fieldsIndex:q.fromLayerJSON({fields:Z,timeInfo:a,dateFieldsTimeReference:k}),geometryType:U,hasM:!1,hasZ:W,objectIdField:u,spatialReference:I,timeInfo:a,featureStore:new e({geometryType:U,hasM:!1,hasZ:W}),cacheSpatialQueries:!0});Z=this._queryEngine.fieldsIndex.requiredFields.indexOf(h);-1<Z&&this._queryEngine.fieldsIndex.requiredFields.splice(Z,1);this._createDefaultAttributes=J.createDefaultAttributesFunction(R,
u);C=await this._createFeatures(C);this._objectIdGenerator=this._createObjectIdGenerator(this._queryEngine,C);C=this._normalizeFeatures(C,P.featureErrors);this._queryEngine.featureStore.addMany(C);const {fullExtent:O,timeExtent:M}=await this._queryEngine.fetchRecomputedExtents();P.layerDefinition.extent=O;if(M){const {start:T,end:Y}=M;P.layerDefinition.timeInfo.timeExtent=[T,Y]}return P}async applyEdits(a){const {spatialReference:C,geometryType:P}=this._queryEngine;await Promise.all([r.loadGeometryEngineForSimplify(C,
P),v.checkProjectionSupport(a.adds,C),v.checkProjectionSupport(a.updates,C)]);await this._waitSnapshotComplete();return this._applyEdits(a)}async queryFeatures(a={},C={}){await this._waitSnapshotComplete();return this._queryEngine.executeQuery(a,C.signal)}async queryFeatureCount(a={},C={}){await this._waitSnapshotComplete();return this._queryEngine.executeQueryForCount(a,C.signal)}async queryObjectIds(a={},C={}){await this._waitSnapshotComplete();return this._queryEngine.executeQueryForIds(a,C.signal)}async queryExtent(a=
{},C={}){await this._waitSnapshotComplete();return this._queryEngine.executeQueryForExtent(a,C.signal)}async querySnapping(a,C={}){await this._waitSnapshotComplete();return this._queryEngine.executeQueryForSnapping(a,C.signal)}async refresh(a){this._loadOptions.customParameters=a;this._snapshotTask?.abort();this._snapshotTask=g.createTask(this._snapshotFeatures);this._snapshotTask.promise.then(R=>{this._queryEngine.featureStore.clear();this._objectIdGenerator=this._createObjectIdGenerator(this._queryEngine,
R);(R=this._normalizeFeatures(R))&&this._queryEngine.featureStore.addMany(R)},R=>{this._queryEngine.featureStore.clear();G.isAbortError(R)||x.getLogger("esri.layers.GeoJSONLayer").error(new y("geojson-layer:refresh","An error occurred during refresh",{error:R}))});await this._waitSnapshotComplete();const {fullExtent:C,timeExtent:P}=await this._queryEngine.fetchRecomputedExtents();return{extent:C,timeExtent:P}}async _createFeatures(a){if(null==a)return[];const {geometryType:C,hasZ:P,objectIdField:R}=
this._queryEngine;a=E.createOptimizedFeatures(a,{geometryType:C,hasZ:P,objectIdField:R});if(!f.equals(this._queryEngine.spatialReference,f.wgs84))for(const Z of a)null!=Z.geometry&&(Z.geometry=p.convertFromGeometry(v.project(p.convertToGeometry(Z.geometry,this._queryEngine.geometryType,this._queryEngine.hasZ,!1),f.wgs84,this._queryEngine.spatialReference)));return a}async _waitSnapshotComplete(){if(this._snapshotTask&&!this._snapshotTask.finished){try{await this._snapshotTask.promise}catch{}return this._waitSnapshotComplete()}}async _fetch(a){const {url:C,
customParameters:P}=this._loadOptions;a=(await d(C??"",{responseType:"json",query:{...P},signal:a})).data;E.validateGeoJSON(a);return a}_normalizeFeatures(a,C){const {objectIdField:P,fieldsIndex:R}=this._queryEngine,Z=[];for(const W of a){a=this._createDefaultAttributes();const U=r.mixAttributes(R,a,W.attributes,!0);U?C?.push(U):(this._assignObjectId(a,W.attributes,!0),W.attributes=a,W.objectId=a[P],Z.push(W))}return Z}async _applyEdits(a){const {adds:C,updates:P,deletes:R}=a;a={addResults:[],deleteResults:[],
updateResults:[],uidToObjectId:{}};C?.length&&this._applyAddEdits(a,C);P?.length&&this._applyUpdateEdits(a,P);if(R?.length){for(const U of R)a.deleteResults.push(r.createFeatureEditSuccessResult(U));this._queryEngine.featureStore.removeManyById(R)}const {fullExtent:Z,timeExtent:W}=await this._queryEngine.fetchRecomputedExtents();return{extent:Z,timeExtent:W,featureEditResults:a}}_applyAddEdits(a,C){const {addResults:P}=a,{geometryType:R,hasM:Z,hasZ:W,objectIdField:U,spatialReference:u,featureStore:I,
fieldsIndex:k}=this._queryEngine,h=[];for(const w of C){if(w.geometry&&R!==A.getJsonType(w.geometry)){P.push(r.createFeatureEditErrorResult("Incorrect geometry type."));continue}C=this._createDefaultAttributes();const O=r.mixAttributes(k,C,w.attributes);O?P.push(O):(this._assignObjectId(C,w.attributes),w.attributes=C,null!=w.uid&&(a.uidToObjectId[w.uid]=w.attributes[U]),null!=w.geometry&&(C=w.geometry.spatialReference??u,w.geometry=v.project(r.simplify(w.geometry,C),C,u)),h.push(w),P.push(r.createFeatureEditSuccessResult(w.attributes[U])))}I.addMany(p.convertFromFeatures([],
h,R,W,Z,U))}_applyUpdateEdits({updateResults:a},C){const {geometryType:P,hasM:R,hasZ:Z,objectIdField:W,spatialReference:U,featureStore:u,fieldsIndex:I}=this._queryEngine;for(const h of C){const {attributes:w,geometry:O}=h;C=w?.[W];if(null==C){a.push(r.createFeatureEditErrorResult(`Identifier field ${W} missing`));continue}if(!u.has(C)){a.push(r.createFeatureEditErrorResult(`Feature with object id ${C} missing`));continue}const M=p.convertToFeature(u.getFeature(C),P,Z,R);if(null!=O){if(P!==A.getJsonType(O)){a.push(r.createFeatureEditErrorResult("Incorrect geometry type."));
continue}var k=O.spatialReference??U;M.geometry=v.project(r.simplify(O,k),k,U)}if(w&&(k=r.mixAttributes(I,M.attributes,w))){a.push(k);continue}u.add(p.convertFromFeature(M,P,Z,R,W));a.push(r.createFeatureEditSuccessResult(C))}}_createObjectIdGenerator(a,C){const P=a.fieldsIndex.get(a.objectIdField);if("esriFieldTypeString"===P.type)return()=>P.name+"-"+Date.now().toString(16);let R=Number.NEGATIVE_INFINITY;for(const Z of C)Z.objectId&&(R=Math.max(R,Z.objectId));R=Math.max(0,R)+1;return()=>R++}_assignObjectId(a,
C,P=!1){const R=this._queryEngine.objectIdField;a[R]=P&&R in C?C[R]:this._objectIdGenerator()}async _checkProjection(a){try{await v.checkProjectionSupport(f.wgs84,a)}catch{throw new y("geojson-layer","Projection not supported");}}}return Q});
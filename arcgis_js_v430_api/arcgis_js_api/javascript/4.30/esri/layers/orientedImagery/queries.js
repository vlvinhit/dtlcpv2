// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.30/esri/copyright.txt for details.
//>>built
define("exports ../../geometry ../../core/promiseUtils ../../geometry/support/webMercatorUtils ../OrientedImageryLayer ./core/ExposurePoint ../../rest/support/Query ../../geometry/Extent".split(" "),function(h,x,m,n,p,q,r,t){function u(b){return e=>{const {features:f,spatialReference:d}=e;f.forEach(a=>{a.geometry&&(a.geometry.spatialReference=d);const c=q.fromJSON({...a.toJSON(),layer:b});c&&(a.attributes=c);a.layer=b;a.spatialReference=d});return e}}function l(b,e){return new t({xmin:b.x-e,xmax:b.x+
e,ymin:b.y-e,ymax:b.y+e,spatialReference:b.spatialReference})}const g={};h.createExtentFromPointAtDistance=l;h.searchImages=async function(b,e){const {point:f,queryParams:d}=b;if(null==f)return null;const a={};var c=b.layerInstanceOrURL;b=f.spatialReference.isGeographic?n.geographicToWebMercator(f.clone()):f.clone();a.outSpatialReference=b.spatialReference;d&&(a.maxRecordCountFactor=d.maxRecordCountFactor??5,a.outFields=d.outFields??["*"],a.where=d.where??"1\x3d1",a.returnGeometry=d.returnGeometry??
!0,a.outSpatialReference=d.outSpatialReference);"string"===typeof c&&(g.layer&&g.layer.url===c?c=g.layer:(g.layer?.destroy(),c=g.layer=new p({url:c})));if(c)try{await c.load();const k=l(b,d?.maximumDistance??c.maximumDistance??1E3);a.returnZ=c.hasZ;const v=new r({geometry:k,...a}),w=await c.queryFeatures(v,e);return u(c)(w)}catch(k){m.throwIfNotAbortError(k)}return null};Object.defineProperty(h,Symbol.toStringTag,{value:"Module"})});
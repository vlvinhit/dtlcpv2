// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.30/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/support/PixelBlock":function(){define("../../chunks/tslib.es6 ../../core/Error ../../core/JSONSupport ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/subclass ./SimpleBandStatistics ./rasterFormats/pixelRangeUtils".split(" "),function(m,x,u,K,F,T,N,M,H,v){var n;u=n=class extends u.JSONSupport{static createEmptyBand(e,g){return new (n.getPixelArrayConstructor(e))(g)}static combineBandMasks(e){if(2>
e.length)return e[0];const g=e[0].length,k=(new Uint8Array(g)).fill(255);for(let y=0;y<e.length;y++){const h=e[y];for(let B=0;B<g;B++)h[B]||(k[B]=0)}return k}static getPixelArrayConstructor(e){let g;switch(e){case "u1":case "u2":case "u4":case "u8":g=Uint8Array;break;case "u16":g=Uint16Array;break;case "u32":g=Uint32Array;break;case "s8":g=Int8Array;break;case "s16":g=Int16Array;break;case "s32":g=Int32Array;break;case "f32":g=Float32Array;break;case "f64":g=Float64Array;break;case "c64":case "c128":case "unknown":g=
Float32Array}return g}constructor(e){super(e);this.height=this.width=null;this.pixelType="f32";this.mask=this.validPixelCount=null;this.premultiplyAlpha=this.maskIsAlpha=!1;this.statistics=null;this.depthCount=1}castPixelType(e){if(!e)return"f32";e=e.toLowerCase();["u1","u2","u4"].includes(e)?e="u8":"unknown u8 s8 u16 s16 u32 s32 f32 f64".split(" ").includes(e)||(e="f32");return e}getPlaneCount(){return this.pixels?.length}addData(e){if(!e.pixels||e.pixels.length!==this.width*this.height)throw new x("pixelblock:invalid-or-missing-pixels",
"add data requires valid pixels array that has same length defined by pixel block width * height");this.pixels||(this.pixels=[]);this.statistics||(this.statistics=[]);this.pixels.push(e.pixels);this.statistics.push(e.statistics??new H.SimpleBandStatistics)}getAsRGBA(){const e=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case "s8":case "s16":case "u16":case "s32":case "u32":case "f32":case "f64":this._fillFromNon8Bit(e);break;default:this._fillFrom8Bit(e)}return new Uint8ClampedArray(e)}getAsRGBAFloat(){const e=
new Float32Array(this.width*this.height*4);this._fillFrom32Bit(e);return e}updateStatistics(){if(this.pixels){this.statistics=this.pixels.map(k=>{var y=this.mask;let h=Infinity,B=-Infinity;const D=k.length;let E,a=0;if(null!=y)for(E=0;E<D;E++)y[E]&&(a=k[E],h=a<h?a:h,B=a>B?a:B);else for(E=0;E<D;E++)a=k[E],h=a<h?a:h,B=a>B?a:B;return new H.SimpleBandStatistics(h,B)});var e=this.mask,g=0;if(null!=e)for(let k=0;k<e.length;k++)e[k]&&g++;else g=this.width*this.height;this.validPixelCount=g}}clamp(e){if(e&&
"f64"!==e&&"f32"!==e&&this.pixels){var [g,k]=v.getPixelValueRange(e),y=this.pixels,h=this.width*this.height,B=y.length,D=[];for(let c=0;c<B;c++){var E=n.createEmptyBand(e,h);var a=y[c];for(let b=0;b<h;b++){var d=a[b];E[b]=d>k?k:d<g?g:d}D.push(E)}this.pixels=D;this.pixelType=e}}extractBands(e){const {pixels:g,statistics:k}=this;if(null==e||0===e.length||!g||0===g.length)return this;var y=g.length;const h=e.some(c=>c>=g.length),B=y===e.length&&!e.some((c,b)=>c!==b);if(h||B)return this;y=this.bandMasks?.length===
y?e.map(c=>this.bandMasks[c]):void 0;let {mask:D,validPixelCount:E}=this;const {width:a,height:d}=this;y?.length&&(D=n.combineBandMasks(y),E=D.filter(c=>!!c).length);return new n({pixelType:this.pixelType,width:a,height:d,mask:D,bandMasks:y,validPixelCount:E,maskIsAlpha:this.maskIsAlpha,pixels:e.map(c=>g[c]),statistics:k&&e.map(c=>k[c])})}clone(){const e=new n({width:this.width,height:this.height,pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,validPixelCount:this.validPixelCount});null!=this.mask&&
(e.mask=new Uint8Array(this.mask));this.bandMasks&&(e.bandMasks=this.bandMasks.map(y=>new Uint8Array(y)));let g;const k=n.getPixelArrayConstructor(this.pixelType);if(this.pixels&&0<this.pixels.length){e.pixels=[];const y=!!this.pixels[0].slice;for(g=0;g<this.pixels.length;g++)e.pixels[g]=y?this.pixels[g].slice(0,this.pixels[g].length):new k(this.pixels[g])}if(this.statistics)for(e.statistics=[],g=0;g<this.statistics.length;g++)e.statistics[g]=K.clone(this.statistics[g]);e.premultiplyAlpha=this.premultiplyAlpha;
return e}_fillFrom8Bit(e){const {mask:g,maskIsAlpha:k,premultiplyAlpha:y,pixels:h}=this;if(e&&h?.length){var B,D;var E=B=D=h[0];3<=h.length?(B=h[1],D=h[2]):2===h.length&&(B=h[1]);var a=new Uint32Array(e),d=this.width*this.height;if(E.length!==d)F.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");else if(null!=g&&g.length===d)if(k)for(e=0;e<d;e++){const c=g[e];if(c){const b=c/255;a[e]=y?c<<24|D[e]*b<<16|B[e]*b<<8|E[e]*b:c<<24|D[e]<<16|B[e]<<8|E[e]}}else for(e=
0;e<d;e++)g[e]&&(a[e]=-16777216|D[e]<<16|B[e]<<8|E[e]);else for(e=0;e<d;e++)a[e]=-16777216|D[e]<<16|B[e]<<8|E[e]}else F.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")}_fillFromNon8Bit(e){const {pixels:g,mask:k,statistics:y}=this;if(e&&g?.length){var h=this.pixelType,B=1,D=0;B=1;if(y&&0<y.length){for(var E of y)null!=E.minValue&&(D=Math.min(D,E.minValue)),null!=E.maxValue&&null!=E.minValue&&(B=Math.max(B,E.maxValue-E.minValue));B=255/B}else B=255,
"s8"===h?(D=-128,B=127):"u16"===h?B=65535:"s16"===h?(D=-32768,B=32767):"u32"===h?B=4294967295:"s32"===h?(D=-2147483648,B=2147483647):"f32"===h?(D=-3.4*1E39,B=3.4*1E39):"f64"===h&&(D=-Number.MAX_VALUE,B=Number.MAX_VALUE),B=255/(B-D);e=new Uint32Array(e);h=this.width*this.height;var a,d,c;E=a=d=g[0];if(E.length!==h)return F.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");if(2<=g.length)if(a=g[1],3<=g.length&&(d=g[2]),null!=k&&k.length===h)for(c=0;c<h;c++)k[c]&&
(e[c]=-16777216|(d[c]-D)*B<<16|(a[c]-D)*B<<8|(E[c]-D)*B);else for(c=0;c<h;c++)e[c]=-16777216|(d[c]-D)*B<<16|(a[c]-D)*B<<8|(E[c]-D)*B;else if(null!=k&&k.length===h)for(c=0;c<h;c++)a=(E[c]-D)*B,k[c]&&(e[c]=-16777216|a<<16|a<<8|a);else for(c=0;c<h;c++)a=(E[c]-D)*B,e[c]=-16777216|a<<16|a<<8|a}else F.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")}_fillFrom32Bit(e){const {pixels:g,mask:k}=this;if(!e||!g?.length)return F.getLogger(this).error("getAsRGBAFloat()",
"Unable to convert to RGBA. The input pixel block is empty.");let y,h,B,D;y=h=B=g[0];3<=g.length?(h=g[1],B=g[2]):2===g.length&&(h=g[1]);const E=this.width*this.height;if(y.length!==E)return F.getLogger(this).error("getAsRGBAFloat()","Unable to convert to RGBA. The pixelblock is invalid.");let a=0;if(null!=k&&k.length===E)for(D=0;D<E;D++)e[a++]=y[D],e[a++]=h[D],e[a++]=B[D],e[a++]=k[D]&1;else for(D=0;D<E;D++)e[a++]=y[D],e[a++]=h[D],e[a++]=B[D],e[a++]=1}};m.__decorate([T.property({json:{write:!0}})],
u.prototype,"width",void 0);m.__decorate([T.property({json:{write:!0}})],u.prototype,"height",void 0);m.__decorate([T.property({json:{write:!0}})],u.prototype,"pixelType",void 0);m.__decorate([N.cast("pixelType")],u.prototype,"castPixelType",null);m.__decorate([T.property({json:{write:!0}})],u.prototype,"validPixelCount",void 0);m.__decorate([T.property({json:{write:!0}})],u.prototype,"mask",void 0);m.__decorate([T.property({json:{write:!0}})],u.prototype,"maskIsAlpha",void 0);m.__decorate([T.property({json:{write:!0}})],
u.prototype,"pixels",void 0);m.__decorate([T.property()],u.prototype,"premultiplyAlpha",void 0);m.__decorate([T.property({json:{write:!0}})],u.prototype,"statistics",void 0);m.__decorate([T.property({json:{write:!0}})],u.prototype,"depthCount",void 0);m.__decorate([T.property({json:{write:!0}})],u.prototype,"noDataValues",void 0);m.__decorate([T.property({json:{write:!0}})],u.prototype,"bandMasks",void 0);return u=n=m.__decorate([M.subclass("esri.layers.support.PixelBlock")],u)})},"esri/layers/support/SimpleBandStatistics":function(){define(["exports"],
function(m){class x{constructor(u=null,K=null,F=null){this.minValue=u;this.maxValue=K;this.noDataValue=F}}m.SimpleBandStatistics=x;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/pixelRangeUtils":function(){define(["exports"],function(m){function x(K){return u[K]??[-3.4028234663852886E38,3.4028234663852886E38]}const u={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],
f32:[-3.4028234663852886E38,3.4028234663852886E38],f64:[-Number.MAX_VALUE,Number.MAX_VALUE],unknown:void 0,c64:void 0,c128:void 0};m.convertNoDataToMask=function(K,F,T){if(!(K.depthCount&&1<K.depthCount)){var {pixels:N,statistics:M,pixelType:H}=K,v=N[0].length,n=K.bandMasks??[];v=K.mask??(new Uint8Array(v)).fill(255);var e="f32"===H||"f64"===H,g=x(H),k=!1;for(let B=0;B<N.length;B++){const D="number"===typeof F?F:F[B];if(null==D)continue;var y=M?.[B]?.maxValue??g[1];if((M?.[B]?.minValue??g[0])>D+Number.EPSILON||
y<D-Number.EPSILON)continue;y=n[B]||v.slice();const E=N[B];var h=T?.customFloatTolerance;if(e&&0!==h){h||=9.999999E37<=Math.abs(D)?2E-7*Math.abs(D):"f32"===H?2**-23:Number.EPSILON;for(let a=0;a<E.length;a++)y[a]&&Math.abs(E[a]-D)<h&&(E[a]=0,y[a]=0,v[a]=0,k=!0)}else for(h=0;h<E.length;h++)y[h]&&E[h]===D&&(E[h]=0,y[h]=0,v[h]=0,k=!0);n[B]=y}k&&(K.bandMasks=K.bandMasks||1<K.pixels.length?n:null,K.mask=v);k&&"updateStatistics"in K&&K.updateStatistics()}};m.getIntegerPixelType=function(K,F){return null==
K||null==F?"s32":0>K?-128<=K&&128>F?"s8":-32768<=K&&32768>F?"s16":"s32":256>F?"u8":65536>F?"u16":"u32"};m.getPixelValueRange=x;m.isIntegerPixelType=function(K){return(K?.startsWith("s")||K?.startsWith("u"))??!1};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/RasterCodec":function(){define("exports ../../../core/Error ../../../core/maybe ../PixelBlock ../SimpleBandStatistics ./ImageCanvasDecoder ./JpgPlus ./Lerc ./Lzw ./pixelRangeUtils ../../../chunks/Zlib ./Raw ./TiffDecoder ./utils".split(" "),
function(m,x,u,K,F,T,N,M,H,v,n,e,g,k){async function y(p,z){if(!k.isPlatformLittleEndian)throw new x("rasterCoded:decode","lerc decoder is not supported on big endian platform");await M.load();const {offset:I}=z,{width:G,height:R,pixelType:J,statistics:V,depthCount:A,noDataValues:C,bandMasks:P,pixels:X,mask:O}=M.decode(p,{inputOffset:I,returnInterleaved:z.returnInterleaved});p=new K({width:G,height:R,pixelType:J.toLowerCase(),pixels:X,mask:O,statistics:V.map(({minValue:Y,maxValue:S})=>new F.SimpleBandStatistics(Y,
S)),bandMasks:P,depthCount:A,noDataValues:C});V?.length||p.updateStatistics();return p}async function h(p,z){p=await g.decode(p,{...z,noDataValue:null});u.assertIsSome(p);p=new K({width:p.width,height:p.height,pixels:p.pixels,pixelType:p.pixelType.toLowerCase(),mask:p.mask,bandMasks:p.bandMasks,statistics:null});p.updateStatistics();return p}async function B(p,z){p=await g.decodeTileOrStrip(p,z.customOptions);p=new K({width:p.width,height:p.height,pixels:p.pixels,pixelType:p.pixelType.toLowerCase(),
mask:p.mask,statistics:null});p.updateStatistics();return p}function D(p,z){const I=z.pixelType||"u8",G=K.getPixelArrayConstructor(I),R="u8"===I?p:new G(p.buffer),J=[],V=z.planes||1;if(1===V)J.push(R);else for(let A=0;A<V;A++){const C=(z.width||1)*(z.height||p.length),P=new G(C);for(let X=0;X<C;X++)P[X]=R[X*V+A];J.push(P)}p=new K({width:z.width||1,height:z.height||p.length,pixels:J,pixelType:I,statistics:null});p.updateStatistics();return p}function E(p,z){p=(new n.Zlib(new Uint8Array(p))).getBytes();
return D(p,z)}function a(p,z){p=H.decode(p,z.offset,z.eof,!z.isInputBigEndian);return D(p,z)}function d(p,z){p=N.decode(p,z.hasNoZlibMask??void 0);p=new K({width:p.width,height:p.height,pixels:p.pixels,pixelType:"u8",mask:p.mask,statistics:null});p.updateStatistics();return p}function c(p,z){p=new Uint8Array(p);p=new q(p);const {width:I,height:G}=z;z=I*G;p=p.decode();let R=0;var J=0;let V;J=new Uint8Array(z);for(R=0;R<z;R++)J[R]=p[4*R+3];const A=new K({width:I,height:G,pixels:[],pixelType:"u8",mask:J,
statistics:[]});for(R=0;3>R;R++){V=new Uint8Array(z);for(J=0;J<z;J++)V[J]=p[4*J+R];A.addData({pixels:V})}A.updateStatistics();return A}async function b(p,z,I,G){p=await (new T).decode(p,{applyJpegMask:!1,format:z,...I},G);p=new K(p);p.updateStatistics();return p}function f(p){if(null==p)throw new x("rasterCodec:decode","parameter encodeddata is required.");p=new Uint8Array(p,0,10);let z="";255===p[0]&&216===p[1]?z="jpg":137===p[0]&&80===p[1]&&78===p[2]&&71===p[3]?z="png":67===p[0]&&110===p[1]&&116===
p[2]&&90===p[3]&&73===p[4]&&109===p[5]&&97===p[6]&&103===p[7]&&101===p[8]&&32===p[9]?z="lerc":76===p[0]&&101===p[1]&&114===p[2]&&99===p[3]&&50===p[4]&&32===p[5]?z="lerc2":73===p[0]&&73===p[1]&&42===p[2]&&0===p[3]||77===p[0]&&77===p[1]&&0===p[2]&&42===p[3]||73===p[0]&&73===p[1]&&43===p[2]&&0===p[3]||77===p[0]&&77===p[1]&&0===p[2]&&43===p[3]?z="tiff":71===p[0]&&73===p[1]&&70===p[2]?z="gif":66===p[0]&&77===p[1]?z="bmp":String.fromCharCode.apply(null,p).toLowerCase().includes("error")&&(z="error");return z}
function l(p){let z=null;switch(p){case "lerc":case "lerc2":z=y;break;case "jpg":z=d;break;case "png":z=c;break;case "bsq":case "bip":z=(I,G)=>{var R=G.pixelType,J=null;let V=null;switch(R?R.toLowerCase():"f32"){case "u1":case "u2":case "u4":case "u8":V=255;J=Uint8Array;break;case "u16":V=V||65535;J=Uint16Array;break;case "u32":V=V||2**32-1;J=Uint32Array;break;case "s8":V=V||-128;J=Int8Array;break;case "s16":V=V||-32768;J=Int16Array;break;case "s32":V=V||-(2**31);J=Int32Array;break;default:J=Float32Array}({pixelTypeCtor:R}=
{pixelTypeCtor:J,noDataValue:V});J=e.decode;I=J(I,{width:G.width,height:G.height,pixelType:R,format:p});G=new K({width:G.width,height:G.height,pixels:I.pixels,pixelType:G.pixelType,mask:I.mask,statistics:null});G.updateStatistics();return G};break;case "tiff":z=h;break;case "deflate":z=E;break;case "lzw":z=a;break;case "error":z=()=>{throw new x("rasterCodec:decode","input data contains error");};break;default:z=()=>{throw new x("rasterCodec:decode","unsupported raster format");}}return z}function r(p,
z=1){if(p){var {pixels:I,width:G,height:R,mask:J}=p;if(I&&0!==I.length){var V=I.length,A=G-1,C=R-1,P=[],X,O,Y=null,S=K.getPixelArrayConstructor(p.pixelType);if(0===z){for(z=0;z<V;z++){var aa=I[z];var t=new S(A*C);for(X=0;X<C;X++){var L=X*G;for(O=0;O<A;O++)t[X*A+O]=aa[L+O]}P.push(t)}if(null!=J)for(Y=new Uint8Array(A*C),X=0;X<C;X++)for(L=X*G,O=0;O<A;O++)Y[X*A+O]=J[L+O]}else{for(z=0;z<V;z++){aa=I[z];t=new S(A*C);for(X=0;X<C;X++)for(L=X*G,O=0;O<A;O++)t[X*A+O]=(aa[L+O]+aa[L+O+1]+aa[L+G+O]+aa[L+G+O+1])/
4;P.push(t)}if(J)for(Y=new Uint8Array(A*C),X=0;X<C;X++)for(L=X*G,O=0;O<A;O++)Y[X*A+O]=Math.min.apply(null,[J[L+O],J[L+O+1],J[L+G+O],J[L+G+O+1]])}p.width=A;p.height=C;p.mask=Y;p.pixels=P}}}var q=function(p){function z(J){var V,A;this.data=J;this.pos=8;this.palette=[];this.imgData=[];this.transparency={};this.animation=null;this.text={};for(A=null;;){var C=this.readUInt32();var P=J=void 0;J=[];for(P=0;4>P;++P)J.push(String.fromCharCode(this.data[this.pos++]));J=J.join("");switch(J){case "IHDR":this.width=
this.readUInt32();this.height=this.readUInt32();this.bits=this.data[this.pos++];this.colorType=this.data[this.pos++];this.compressionMethod=this.data[this.pos++];this.filterMethod=this.data[this.pos++];this.interlaceMethod=this.data[this.pos++];break;case "acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||Infinity,frames:[]};break;case "PLTE":this.palette=this.read(C);break;case "fcTL":A&&this.animation.frames.push(A);this.pos+=4;A={width:this.readUInt32(),height:this.readUInt32(),
xOffset:this.readUInt32(),yOffset:this.readUInt32()};J=this.readUInt16();C=this.readUInt16()||100;A.delay=1E3*J/C;A.disposeOp=this.data[this.pos++];A.blendOp=this.data[this.pos++];A.data=[];break;case "IDAT":case "fdAT":"fdAT"===J&&(this.pos+=4,C-=4);J=(null!=A?A.data:void 0)||this.imgData;for(P=0;0<=C?P<C:P>C;0<=C?++P:--P)J.push(this.data[this.pos++]);break;case "tRNS":this.transparency={};switch(this.colorType){case 3:this.transparency.indexed=this.read(C);C=255-this.transparency.indexed.length;
if(0<C)for(J=0;0<=C?J<C:J>C;0<=C?++J:--J)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(C)[0];break;case 2:this.transparency.rgb=this.read(C)}break;case "tEXt":P=this.read(C);C=P.indexOf(0);J=String.fromCharCode.apply(String,P.slice(0,C));this.text[J]=String.fromCharCode.apply(String,P.slice(C+1));break;case "IEND":A&&this.animation.frames.push(A);a:{switch(this.colorType){case 0:case 3:case 4:A=1;break a;case 2:case 6:A=3;break a}A=void 0}this.colors=A;this.hasAlphaChannel=
4===(V=this.colorType)||6===V;V=this.colors+(this.hasAlphaChannel?1:0);this.pixelBitlength=this.bits*V;a:{switch(this.colors){case 1:V="DeviceGray";break a;case 3:V="DeviceRGB";break a}V=void 0}this.colorSpace=V;this.imgData=new Uint8Array(this.imgData);return;default:this.pos+=C}this.pos+=4;if(this.pos>this.data.length)throw Error("Incomplete or corrupt PNG file");}}var I;z.load=function(J,V,A){"function"===typeof V&&(A=V);var C=new XMLHttpRequest;C.open("GET",J,!0);C.responseType="arraybuffer";
C.onload=function(){var P=new Uint8Array(C.response||C.mozResponseArrayBuffer);P=new z(P);"function"===typeof(null!=V?V.getContext:void 0)&&P.render(V);return"function"===typeof A?A(P):void 0};return C.send(null)};z.prototype.read=function(J){var V;var A=[];for(V=0;0<=J?V<J:V>J;0<=J?++V:--V)A.push(this.data[this.pos++]);return A};z.prototype.readUInt32=function(){var J=this.data[this.pos++]<<24;var V=this.data[this.pos++]<<16;var A=this.data[this.pos++]<<8;var C=this.data[this.pos++];return J|V|A|
C};z.prototype.readUInt16=function(){var J=this.data[this.pos++]<<8;var V=this.data[this.pos++];return J|V};z.prototype.decodePixels=function(J){var V,A,C,P,X,O,Y,S;null==J&&(J=this.imgData);if(0===J.length)return new Uint8Array(0);J=new n.Zlib(J);J=J.getBytes();var aa=this.pixelBitlength/8;var t=aa*this.width;var L=new Uint8Array(t*this.height);var U=J.length;for(A=P=X=0;P<U;){switch(J[P++]){case 0:for(C=V=0;V<t;C=V+=1)L[A++]=J[P++];break;case 1:for(C=O=0;O<t;C=O+=1){V=J[P++];var Q=C<aa?0:L[A-aa];
L[A++]=(V+Q)%256}break;case 2:for(C=Q=0;Q<t;C=Q+=1){V=J[P++];var ca=(C-C%aa)/aa;O=X&&L[(X-1)*t+ca*aa+C%aa];L[A++]=(O+V)%256}break;case 3:for(C=S=0;S<t;C=S+=1)V=J[P++],ca=(C-C%aa)/aa,Q=C<aa?0:L[A-aa],O=X&&L[(X-1)*t+ca*aa+C%aa],L[A++]=(V+Math.floor((Q+O)/2))%256;break;case 4:for(C=S=0;S<t;C=S+=1){V=J[P++];ca=(C-C%aa)/aa;Q=C<aa?0:L[A-aa];0===X?O=Y=0:(O=L[(X-1)*t+ca*aa+C%aa],Y=ca&&L[(X-1)*t+(ca-1)*aa+C%aa]);var W=Q+O-Y;C=Math.abs(W-Q);ca=Math.abs(W-O);W=Math.abs(W-Y);Q=C<=ca&&C<=W?Q:ca<=W?O:Y;L[A++]=
(V+Q)%256}break;default:throw Error("Invalid filter algorithm: "+J[P-1]);}X++}return L};z.prototype.decodePalette=function(){var J,V,A,C;var P=this.palette;var X=this.transparency.indexed||[];var O=new Uint8Array((X.length||0)+P.length);var Y=0;P.length;var S=V=J=0;for(A=P.length;V<A;S=V+=3)O[Y++]=P[S],O[Y++]=P[S+1],O[Y++]=P[S+2],O[Y++]=null!=(C=X[J++])?C:255;return O};z.prototype.copyToImageData=function(J,V){var A,C;var P=this.colors;var X=null;var O=this.hasAlphaChannel;this.palette.length&&(X=
null!=(A=this._decodedPalette)?A:this._decodedPalette=this.decodePalette(),P=4,O=!0);J=J.data||J;var Y=J.length;var S=X||V;A=C=0;if(1===P)for(;A<Y;)P=X?4*V[A/4]:C,C=S[P++],J[A++]=C,J[A++]=C,J[A++]=C,J[A++]=O?S[P++]:this.transparency.grayscale&&this.transparency.grayscale===C?0:255,C=P;else for(;A<Y;)P=X?4*V[A/4]:C,J[A++]=S[P++],J[A++]=S[P++],J[A++]=S[P++],J[A++]=O?S[P++]:this.transparency.rgb&&this.transparency.rgb[1]===S[P-3]&&this.transparency.rgb[3]===S[P-2]&&this.transparency.rgb[5]===S[P-1]?
0:255,C=P};z.prototype.decode=function(){var J=new Uint8Array(this.width*this.height*4);this.copyToImageData(J,this.decodePixels());return J};var G=(I=p.document&&p.document.createElement("canvas"))&&I.getContext("2d");var R=function(J){G.width=J.width;G.height=J.height;G.clearRect(0,0,J.width,J.height);G.putImageData(J,0,0);J=new Image;J.src=I.toDataURL();return J};z.prototype.decodeFrames=function(J){var V,A;if(this.animation){var C=this.animation.frames;var P=[];var X=V=0;for(A=C.length;V<A;X=
++V){X=C[X];var O=J.createImageData(X.width,X.height);var Y=this.decodePixels(new Uint8Array(X.data));this.copyToImageData(O,Y);X.imageData=O;P.push(X.image=R(O))}return P}};z.prototype.renderFrame=function(J,V){var A=this.animation.frames;var C=A[V];A=A[V-1];0===V&&J.clearRect(0,0,this.width,this.height);1===(null!=A?A.disposeOp:void 0)?J.clearRect(A.xOffset,A.yOffset,A.width,A.height):2===(null!=A?A.disposeOp:void 0)&&J.putImageData(A.imageData,A.xOffset,A.yOffset);0===C.blendOp&&J.clearRect(C.xOffset,
C.yOffset,C.width,C.height);return J.drawImage(C.image,C.xOffset,C.yOffset)};z.prototype.animate=function(J){var V,A=this;var C=0;var P=this.animation;var X=P.numFrames;var O=P.frames;var Y=P.numPlays;return(V=function(){var S=C++%X;var aa=O[S];A.renderFrame(J,S);if(1<X&&C/X<Y)return A.animation._timeout=setTimeout(V,aa.delay)})()};z.prototype.stopAnimation=function(){var J;return clearTimeout(null!=(J=this.animation)?J._timeout:void 0)};z.prototype.render=function(J){J._png&&J._png.stopAnimation();
J._png=this;J.width=this.width;J.height=this.height;J=J.getContext("2d");if(this.animation)return this.decodeFrames(J),this.animate(J);var V=J.createImageData(this.width,this.height);this.copyToImageData(V,this.decodePixels());return J.putImageData(V,0,0)};return z}(self);const w=new Set(["jpg","png","bmp","gif"]);m.decode=async function(p,z={},I){if(null==p)throw new x("rasterCodec:decode","missing encodeddata parameter.");let G=z.format?.toLowerCase();if(!("bsq"!==G&&"bip"!==G||null!=z.width&&null!=
z.height))throw new x("rasterCodec:decode","requires width and height in options parameter.");if("tiff"===G&&z.customOptions)return B(p,z);if(!G||"bsq"!==G&&"bip"!==G&&"deflate"!==G&&"lzw"!==G)G=f(p);if(z.useCanvas&&w.has(G))return b(p,G,z,I);const R=l(G);z.isPoint&&(z={...z},null!=z.width&&z.width++,null!=z.height&&z.height++);let J;const {offsets:V}=z;if(V&&1<V.length){I=V.map((C,P)=>R(p.slice(C,V[P+1]),z));I=await Promise.all(I);J=I[0];J.pixels=I.map(C=>C.pixels[0]);const A=I.map(C=>C.mask);I.some(C=>
null!=C)&&(A.forEach((C,P)=>{null==C&&(A[P]=(new Uint8Array(J.width*J.height)).fill(255))}),J.bandMasks=A,J.mask=K.combineBandMasks(A));J.updateStatistics()}else J=await R(p,{...z,offset:V?.[0]??z.offset});"jpg"!==G&&null!=z.noDataValue&&1===J.depthCount&&v.convertNoDataToMask(J,z.noDataValue,{customFloatTolerance:z.tolerance});z.isPoint&&r(J);return J};m.getFormat=function(p){p=f(p);"lerc2"===p?p="lerc":"error"===p&&(p="");return p};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/support/rasterFormats/ImageCanvasDecoder":function(){define(["../../../core/Error","../../../core/promiseUtils","../../../chunks/Zlib"],function(m,x,u){class K{constructor(F){this._ctx=this._canvas=null;F&&(this._canvas=F.canvas,this._ctx=F.ctx||F.canvas&&F.canvas.getContext("2d"))}decode(F,T,N){if(!F||10>F.byteLength)throw new m("imagecanvasdecoder: decode","required a valid encoded data as input.");let {width:M=0,height:H=0,format:v}=T;const {applyJpegMask:n}=T;if(n&&(!M||!H))throw new m("imagecanvasdecoder: decode",
"image width and height are needed to apply jpeg mask directly to canvas");return new Promise((e,g)=>{let k=null;"jpg"===v&&n&&(k=K._getMask(F,{width:M,height:H}));const y=new Blob([new Uint8Array(F)],{type:"jpg"==="image/"+v?"jpeg":v}),h=URL.createObjectURL(y),B=new Image;let D;B.src=h;B.onload=()=>{URL.revokeObjectURL(h);if(x.isAborted(N))g(x.createAbortError());else{M=B.width;H=B.height;if(this._canvas&&this._ctx){if(this._canvas.width!==M||this._canvas.height!==H)this._canvas.width=M,this._canvas.height=
H;this._ctx.clearRect(0,0,M,H)}else this._canvas=document.createElement("canvas"),this._canvas.width=M,this._canvas.height=H,this._ctx=this._canvas.getContext("2d");this._ctx.drawImage(B,0,0);var E=this._ctx.getImageData(0,0,M,H);D=E.data;var a;if(T.renderOnCanvas){if(k)for(a=0;a<k.length;a++)D[4*a+3]=k[a]?255:0;this._ctx.putImageData(E,0,0);e(null)}else{E=M*H;var d=new Uint8Array(E),c=new Uint8Array(E),b=new Uint8Array(E);if(k)for(a=0;a<E;a++)d[a]=D[4*a],c[a]=D[4*a+1],b[a]=D[4*a+2];else for(k=new Uint8Array(E),
a=0;a<E;a++)d[a]=D[4*a],c[a]=D[4*a+1],b[a]=D[4*a+2],k[a]=D[4*a+3];e({width:M,height:H,pixels:[d,c,b],mask:k,pixelType:"u8"})}}};B.onerror=()=>{URL.revokeObjectURL(h);g("cannot load image")}})}static _getMask(F,T){let N=null;try{var M=new Uint8Array(F);F=0;var H=M.length-2;for(F=Math.ceil(M.length/2);F<H&&(255!==M[F]||217!==M[F+1]);F++);F+=2;if(F<M.length-1){const v=(new u.Zlib(M.subarray(F))).getBytes();N=new Uint8Array(T.width*T.height);T=0;for(M=0;M<v.length;M++)for(H=7;0<=H;H--)N[T++]=v[M]>>H&
1}}catch(v){}return N}}return K})},"esri/chunks/Zlib":function(){define(["exports","./_commonjsHelpers"],function(m,x){var u={exports:{}};(function(K){(function(F){F=F();void 0!==F&&(K.exports=F)})(function(){var F=function(){function T(){this.bufferLength=this.pos=0;this.eof=!1;this.buffer=null}T.prototype={ensureBuffer:function(N){var M=this.buffer,H=M?M.byteLength:0;if(N<H)return M;for(var v=512;v<N;)v<<=1;N=new Uint8Array(v);for(v=0;v<H;++v)N[v]=M[v];return this.buffer=N},getByte:function(){for(var N=
this.pos;this.bufferLength<=N;){if(this.eof)return null;this.readBlock()}return this.buffer[this.pos++]},getBytes:function(N){var M=this.pos;if(N){this.ensureBuffer(M+N);for(N=M+N;!this.eof&&this.bufferLength<N;)this.readBlock();var H=this.bufferLength;N>H&&(N=H)}else{for(;!this.eof;)this.readBlock();N=this.bufferLength}this.pos=N;return this.buffer.subarray(M,N)},lookChar:function(){for(var N=this.pos;this.bufferLength<=N;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos])},
getChar:function(){for(var N=this.pos;this.bufferLength<=N;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos++])},makeSubStream:function(N,M,H){for(var v=N+M;this.bufferLength<=v&&!this.eof;)this.readBlock();return new Stream(this.buffer,N,M,H)},skip:function(N){N||=1;this.pos+=N},reset:function(){this.pos=0}};return T}();return function(){function T(g){throw Error(g);}function N(g){var k=0,y=g[k++],h=g[k++];-1!=y&&-1!=h||T("Invalid header in flate stream");
8!=(y&15)&&T("Unknown compression method in flate stream");0!=((y<<8)+h)%31&&T("Bad FCHECK in flate stream");h&32&&T("FDICT bit set in flate stream");this.bytes=g;this.bytesPos=k;this.codeBuf=this.codeSize=0;F.call(this)}if(!self||!self.Uint32Array)return null;var M=new Uint32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),H=new Uint32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,
258,258,258]),v=new Uint32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]),n=[new Uint32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59E4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,
524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,
524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,
524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,
524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,
524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,
524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,
524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],e=[new Uint32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,
327707,327687,327703,327695,0]),5];N.prototype=Object.create(F.prototype);N.prototype.getBits=function(g){for(var k=this.codeSize,y=this.codeBuf,h=this.bytes,B=this.bytesPos,D;k<g;)"undefined"==typeof(D=h[B++])&&T("Bad encoding in flate stream"),y|=D<<k,k+=8;this.codeBuf=y>>g;this.codeSize=k-=g;this.bytesPos=B;return y&(1<<g)-1};N.prototype.getCode=function(g){var k=g[0],y=g[1];g=this.codeSize;for(var h=this.codeBuf,B=this.bytes,D=this.bytesPos;g<y;){var E;"undefined"==typeof(E=B[D++])&&T("Bad encoding in flate stream");
h|=E<<g;g+=8}y=k[h&(1<<y)-1];k=y>>16;y&=65535;(0==g||g<k||0==k)&&T("Bad encoding in flate stream");this.codeBuf=h>>k;this.codeSize=g-k;this.bytesPos=D;return y};N.prototype.generateHuffmanTable=function(g){for(var k=g.length,y=0,h=0;h<k;++h)g[h]>y&&(y=g[h]);for(var B=1<<y,D=new Uint32Array(B),E=1,a=0,d=2;E<=y;++E,a<<=1,d<<=1)for(var c=0;c<k;++c)if(g[c]==E){var b=0,f=a;for(h=0;h<E;++h)b=b<<1|f&1,f>>=1;for(h=b;h<B;h+=d)D[h]=E<<16|c;++a}return[D,y]};N.prototype.readBlock=function(){function g(b,f,l,
r,q){for(b=b.getBits(l)+r;0<b--;)f[a++]=q}var k=this.getBits(3);k&1&&(this.eof=!0);k>>=1;if(0==k){var y=this.bytes,h=this.bytesPos,B;"undefined"==typeof(B=y[h++])&&T("Bad block header in flate stream");var D=B;"undefined"==typeof(B=y[h++])&&T("Bad block header in flate stream");D|=B<<8;"undefined"==typeof(B=y[h++])&&T("Bad block header in flate stream");k=B;"undefined"==typeof(B=y[h++])&&T("Bad block header in flate stream");(k|B<<8)!=(~D&65535)&&T("Bad uncompressed block length in flate stream");
this.codeSize=this.codeBuf=0;B=this.bufferLength;k=this.ensureBuffer(B+D);this.bufferLength=D=B+D;for(var E=B;E<D;++E){if("undefined"==typeof(B=y[h++])){this.eof=!0;break}k[E]=B}this.bytesPos=h}else{if(1==k)h=n,B=e;else if(2==k){k=this.getBits(5)+257;B=this.getBits(5)+1;y=this.getBits(4)+4;h=Array(M.length);for(var a=0;a<y;)h[M[a++]]=this.getBits(3);h=this.generateHuffmanTable(h);a=y=0;B=k+B;for(D=Array(B);a<B;)E=this.getCode(h),16==E?g(this,D,2,3,y):17==E?g(this,D,3,3,y=0):18==E?g(this,D,7,11,y=
0):D[a++]=y=E;h=this.generateHuffmanTable(D.slice(0,k));B=this.generateHuffmanTable(D.slice(k,B))}else T("Unknown block type in flate stream");D=(k=this.buffer)?k.length:0;for(E=this.bufferLength;;){var d=this.getCode(h);if(256>d)E+1>=D&&(k=this.ensureBuffer(E+1),D=k.length),k[E++]=d;else{if(256==d){this.bufferLength=E;break}d-=257;d=H[d];var c=d>>16;0<c&&(c=this.getBits(c));y=(d&65535)+c;d=this.getCode(B);d=v[d];c=d>>16;0<c&&(c=this.getBits(c));d=(d&65535)+c;E+y>=D&&(k=this.ensureBuffer(E+y),D=k.length);
for(c=0;c<y;++c,++E)k[E]=k[E-d]}}}};return N}()})})(u);x=x.getDefaultExportFromCjs(u.exports);m.Zlib=x})},"esri/layers/support/rasterFormats/JpgPlus":function(){define(["../../../chunks/Jpg","../../../chunks/Zlib"],function(m,x){class u{static decode(K,F=!1){const T=new Uint8Array(K);K=new m.JpegImage;K.parse(T);const {width:N,height:M,numComponents:H,eof:v}=K,n=K.getData(N,M,!0),e=N*M;K=null;let g=0,k=0,y=0;if(!F&&v<T.length-1)try{var h=(new x.Zlib(T.subarray(v))).getBytes();K=new Uint8Array(e);
for(g=F=0;g<h.length;g++)for(y=7;0<=y;y--)K[F++]=h[g]>>y&1}catch{}if(1===H&&n.length===N*M)h=new Uint8Array(n.buffer),h=[h,h,h];else{h=[];for(g=0;3>g;g++)h.push(new Uint8Array(e));for(k=y=0;k<e;k++)for(g=0;3>g;g++)h[g][k]=n[y++]}return{width:N,height:M,pixels:h,mask:K}}}return u})},"esri/chunks/Jpg":function(){define(["exports","./_commonjsHelpers"],function(m,x){var u={exports:{}};(function(K){(function(F){F=F();void 0!==F&&(K.exports=F)})(function(){var F=function(){function T(N){this.message="JPEG error: "+
N}T.prototype=Error();T.prototype.name="JpegError";return T.constructor=T}();return function(){function T(){this.decodeTransform=null;this.colorTransform=-1}function N(e,g){for(var k=0,y=[],h,B,D=16;0<D&&!e[D-1];)D--;y.push({children:[],index:0});var E=y[0],a;for(h=0;h<D;h++){for(B=0;B<e[h];B++){E=y.pop();for(E.children[E.index]=g[k];0<E.index;)E=y.pop();E.index++;for(y.push(E);y.length<=h;)y.push(a={children:[],index:0}),E.children[E.index]=a.children,E=a;k++}h+1<D&&(y.push(a={children:[],index:0}),
E.children[E.index]=a.children,E=a)}return y[0].children}function M(e,g,k,y,h,B,D,E,a){function d(){if(0<R)return R--,G>>R&1;G=e[g++];if(255===G){var Q=e[g++];if(Q)throw new F("unexpected marker "+(G<<8|Q).toString(16));}R=7;return G>>>7}function c(Q){for(;;){Q=Q[d()];if("number"===typeof Q)return Q;if("object"!==typeof Q)throw new F("invalid huffman sequence");}}function b(Q){for(var ca=0;0<Q;)ca=ca<<1|d(),Q--;return ca}function f(Q){if(1===Q)return 1===d()?1:-1;var ca=b(Q);return ca>=1<<Q-1?ca:
ca+(-1<<Q)+1}function l(Q,ca){var W=c(Q.huffmanTableDC);W=0===W?0:f(W);Q.blockData[ca]=Q.pred+=W;for(W=1;64>W;){var da=c(Q.huffmanTableAC),fa=da&15;da>>=4;if(0===fa){if(15>da)break;W+=16}else W+=da,Q.blockData[ca+n[W]]=f(fa),W++}}function r(Q,ca){var W=c(Q.huffmanTableDC);W=0===W?0:f(W)<<a;Q.blockData[ca]=Q.pred+=W}function q(Q,ca){Q.blockData[ca]|=d()<<a}function w(Q,ca){if(0<J)J--;else for(var W=B;W<=D;){var da=c(Q.huffmanTableAC),fa=da&15;da>>=4;if(0===fa){if(15>da){J=b(da)+(1<<da)-1;break}W+=
16}else W+=da,Q.blockData[ca+n[W]]=f(fa)*(1<<a),W++}}function p(Q,ca){for(var W=B,da=0,fa;W<=D;){fa=n[W];switch(V){case 0:da=c(Q.huffmanTableAC);fa=da&15;da>>=4;if(0===fa)15>da?(J=b(da)+(1<<da),V=4):(da=16,V=1);else{if(1!==fa)throw new F("invalid ACn encoding");A=f(fa);V=da?2:3}continue;case 1:case 2:Q.blockData[ca+fa]?Q.blockData[ca+fa]+=d()<<a:(da--,0===da&&(V=2===V?3:0));break;case 3:Q.blockData[ca+fa]?Q.blockData[ca+fa]+=d()<<a:(Q.blockData[ca+fa]=A<<a,V=0);break;case 4:Q.blockData[ca+fa]&&(Q.blockData[ca+
fa]+=d()<<a)}W++}4===V&&(J--,0===J&&(V=0))}var z=k.mcusPerLine,I=g,G=0,R=0,J=0,V=0,A,C=y.length,P,X,O,Y;E=k.progressive?0===B?0===E?r:q:0===E?w:p:l;var S=0;k=1===C?y[0].blocksPerLine*y[0].blocksPerColumn:z*k.mcusPerColumn;for(var aa,t;S<k;){var L=h?Math.min(k-S,h):k;for(P=0;P<C;P++)y[P].pred=0;J=0;if(1===C){var U=y[0];for(Y=0;Y<L;Y++)E(U,64*((U.blocksPerLine+1)*(S/U.blocksPerLine|0)+S%U.blocksPerLine)),S++}else for(Y=0;Y<L;Y++){for(P=0;P<C;P++)for(U=y[P],aa=U.h,t=U.v,X=0;X<t;X++)for(O=0;O<aa;O++)E(U,
64*((U.blocksPerLine+1)*((S/z|0)*U.v+X)+(S%z*U.h+O)));S++}R=0;(U=v(e,g))&&U.invalid&&(console.log("decodeScan - unexpected MCU data, next marker is: "+U.invalid),g=U.offset);U=U&&U.marker;if(!U||65280>=U)throw new F("marker was not found");if(65488<=U&&65495>=U)g+=2;else break}(U=v(e,g))&&U.invalid&&(console.log("decodeScan - unexpected Scan data, next marker is: "+U.invalid),g=U.offset);return g-I}function H(e,g){e=g.blocksPerLine;for(var k=g.blocksPerColumn,y=new Int16Array(64),h=0;h<k;h++)for(var B=
0;B<e;B++){var D=void 0,E=void 0,a=void 0,d=void 0,c=void 0,b=void 0,f=void 0,l=void 0,r=c=b=d=E=D=void 0,q=void 0,w=void 0,p=void 0,z=64*((g.blocksPerLine+1)*h+B),I=y,G=g.quantizationTable,R=g.blockData;if(!G)throw new F("missing required Quantization Table.");for(var J=0;64>J;J+=8)D=R[z+J],l=R[z+J+1],f=R[z+J+2],b=R[z+J+3],c=R[z+J+4],d=R[z+J+5],a=R[z+J+6],E=R[z+J+7],D*=G[J],0===(l|f|b|c|d|a|E)?(D=5793*D+512>>10,I[J]=D,I[J+1]=D,I[J+2]=D,I[J+3]=D,I[J+4]=D,I[J+5]=D,I[J+6]=D,I[J+7]=D):(l*=G[J+1],f*=
G[J+2],b*=G[J+3],c*=G[J+4],d*=G[J+5],a*=G[J+6],E*=G[J+7],p=5793*D+128>>8,w=5793*c+128>>8,q=f,r=a,c=2896*(l-E)+128>>8,E=2896*(l+E)+128>>8,b<<=4,d<<=4,p=p+w+1>>1,w=p-w,D=3784*q+1567*r+128>>8,q=1567*q-3784*r+128>>8,r=D,c=c+d+1>>1,d=c-d,E=E+b+1>>1,b=E-b,p=p+r+1>>1,r=p-r,w=w+q+1>>1,q=w-q,D=2276*c+3406*E+2048>>12,c=3406*c-2276*E+2048>>12,E=D,D=799*b+4017*d+2048>>12,b=4017*b-799*d+2048>>12,d=D,I[J]=p+E,I[J+7]=p-E,I[J+1]=w+d,I[J+6]=w-d,I[J+2]=q+b,I[J+5]=q-b,I[J+3]=r+c,I[J+4]=r-c);for(G=0;8>G;++G)D=I[G],l=
I[G+8],f=I[G+16],b=I[G+24],c=I[G+32],d=I[G+40],a=I[G+48],E=I[G+56],0===(l|f|b|c|d|a|E)?(D=5793*D+8192>>14,D=-2040>D?0:2024<=D?255:D+2056>>4,R[z+G]=D,R[z+G+8]=D,R[z+G+16]=D,R[z+G+24]=D,R[z+G+32]=D,R[z+G+40]=D,R[z+G+48]=D,R[z+G+56]=D):(p=5793*D+2048>>12,w=5793*c+2048>>12,q=f,r=a,c=2896*(l-E)+2048>>12,E=2896*(l+E)+2048>>12,p=(p+w+1>>1)+4112,w=p-w,D=3784*q+1567*r+2048>>12,q=1567*q-3784*r+2048>>12,r=D,c=c+d+1>>1,d=c-d,E=E+b+1>>1,b=E-b,p=p+r+1>>1,r=p-r,w=w+q+1>>1,q=w-q,D=2276*c+3406*E+2048>>12,c=3406*c-
2276*E+2048>>12,E=D,D=799*b+4017*d+2048>>12,b=4017*b-799*d+2048>>12,d=D,D=p+E,E=p-E,l=w+d,a=w-d,f=q+b,d=q-b,b=r+c,c=r-c,D=16>D?0:4080<=D?255:D>>4,l=16>l?0:4080<=l?255:l>>4,f=16>f?0:4080<=f?255:f>>4,b=16>b?0:4080<=b?255:b>>4,c=16>c?0:4080<=c?255:c>>4,d=16>d?0:4080<=d?255:d>>4,a=16>a?0:4080<=a?255:a>>4,E=16>E?0:4080<=E?255:E>>4,R[z+G]=D,R[z+G+8]=l,R[z+G+16]=f,R[z+G+24]=b,R[z+G+32]=c,R[z+G+40]=d,R[z+G+48]=a,R[z+G+56]=E)}return g.blockData}function v(e,g,k){var y=e.length-1;k=k<g?k:g;if(g>=y)return null;
var h=e[g]<<8|e[g+1];if(65472<=h&&65534>=h)return{invalid:null,marker:h,offset:g};for(g=e[k]<<8|e[k+1];!(65472<=g&&65534>=g);){if(++k>=y)return null;g=e[k]<<8|e[k+1]}return{invalid:h.toString(16),marker:g,offset:k}}if(!self||!self.Uint8ClampedArray)return null;var n=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]);T.prototype={parse:function(e){function g(){var G=
e[h]<<8|e[h+1];h+=2;return G}function k(){var G=g();G=h+G-2;var R=v(e,G,h);R&&R.invalid&&(console.log("readDataBlock - incorrect length, next marker is: "+R.invalid),G=R.offset);G=e.subarray(h,G);h+=G.length;return G}function y(G){for(var R=Math.ceil(G.samplesPerLine/8/G.maxH),J=Math.ceil(G.scanLines/8/G.maxV),V=0;V<G.components.length;V++){I=G.components[V];var A=Math.ceil(Math.ceil(G.samplesPerLine/8)*I.h/G.maxH),C=Math.ceil(Math.ceil(G.scanLines/8)*I.v/G.maxV);I.blockData=new Int16Array(64*J*I.v*
(R*I.h+1));I.blocksPerLine=A;I.blocksPerColumn=C}G.mcusPerLine=R;G.mcusPerColumn=J}var h=0,B=null,D=null,E=[],a=[],d=[],c=g();if(65496!==c)throw new F("SOI not found");for(c=g();65497!==c;){switch(c){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var b=k();65504===c&&74===b[0]&&70===b[1]&&73===b[2]&&70===b[3]&&0===b[4]&&(B={version:{major:b[5],minor:b[6]},densityUnits:b[7],
xDensity:b[8]<<8|b[9],yDensity:b[10]<<8|b[11],thumbWidth:b[12],thumbHeight:b[13],thumbData:b.subarray(14,14+3*b[12]*b[13])});65518===c&&65===b[0]&&100===b[1]&&111===b[2]&&98===b[3]&&101===b[4]&&(D={version:b[5]<<8|b[6],flags0:b[7]<<8|b[8],flags1:b[9]<<8|b[10],transformCode:b[11]});break;case 65499:c=g()+h-2;for(var f;h<c;){var l=e[h++],r=new Uint16Array(64);if(0===l>>4)for(b=0;64>b;b++)f=n[b],r[f]=e[h++];else if(1===l>>4)for(b=0;64>b;b++)f=n[b],r[f]=g();else throw new F("DQT - invalid table spec");
E[l&15]=r}break;case 65472:case 65473:case 65474:if(q)throw new F("Only single frame JPEGs supported");g();var q={};q.extended=65473===c;q.progressive=65474===c;q.precision=e[h++];q.scanLines=g();q.samplesPerLine=g();q.components=[];q.componentIds={};b=e[h++];for(c=r=l=0;c<b;c++){f=e[h];var w=e[h+1]>>4;var p=e[h+1]&15;l<w&&(l=w);r<p&&(r=p);w=q.components.push({h:w,v:p,quantizationId:e[h+2],quantizationTable:null});q.componentIds[f]=w-1;h+=3}q.maxH=l;q.maxV=r;y(q);break;case 65476:f=g();for(c=2;c<
f;){l=e[h++];r=new Uint8Array(16);for(b=w=0;16>b;b++,h++)w+=r[b]=e[h];p=new Uint8Array(w);for(b=0;b<w;b++,h++)p[b]=e[h];c+=17+w;(0===l>>4?d:a)[l&15]=N(r,p)}break;case 65501:g();var z=g();break;case 65498:g();f=e[h++];b=[];for(c=0;c<f;c++){l=q.componentIds[e[h++]];var I=q.components[l];l=e[h++];I.huffmanTableDC=d[l>>4];I.huffmanTableAC=a[l&15];b.push(I)}c=e[h++];f=e[h++];l=e[h++];c=M(e,h,q,b,z,c,f,l>>4,l&15);h+=c;break;case 65535:255!==e[h]&&h--;break;default:if(255===e[h-3]&&192<=e[h-2]&&254>=e[h-
2])h-=3;else throw new F("unknown marker "+c.toString(16));}c=g()}this.width=q.samplesPerLine;this.height=q.scanLines;this.jfif=B;this.eof=h;this.adobe=D;this.components=[];for(c=0;c<q.components.length;c++){I=q.components[c];if(B=E[I.quantizationId])I.quantizationTable=B;this.components.push({output:H(q,I),scaleX:I.h/q.maxH,scaleY:I.v/q.maxV,blocksPerLine:I.blocksPerLine,blocksPerColumn:I.blocksPerColumn})}this.numComponents=this.components.length},_getLinearizedBlockData:function(e,g){var k=this.width/
e,y=this.height/g,h,B,D=0,E=this.components.length,a=e*g*E,d=new Uint8ClampedArray(a),c=new Uint32Array(e);for(B=0;B<E;B++){var b=this.components[B];var f=b.scaleX*k;var l=b.scaleY*y;D=B;var r=b.output;var q=b.blocksPerLine+1<<3;for(h=0;h<e;h++)b=0|h*f,c[h]=(b&4294967288)<<3|b&7;for(f=0;f<g;f++)for(b=0|f*l,b=q*(b&4294967288)|(b&7)<<3,h=0;h<e;h++)d[D]=r[b+c[h]],D+=E}if(g=this.decodeTransform)for(B=0;B<a;)for(e=b=0;b<E;b++,B++,e+=2)d[B]=(d[B]*g[e]>>8)+g[e+1];return d},_isColorConversionNeeded:function(){return this.adobe?
!!this.adobe.transformCode:3===this.numComponents?0===this.colorTransform?!1:!0:1===this.colorTransform?!0:!1},_convertYccToRgb:function(e){for(var g,k,y,h=0,B=e.length;h<B;h+=3)g=e[h],k=e[h+1],y=e[h+2],e[h]=g-179.456+1.402*y,e[h+1]=g+135.459-.344*k-.714*y,e[h+2]=g-226.816+1.772*k;return e},_convertYcckToRgb:function(e){for(var g,k,y,h,B=0,D=0,E=e.length;D<E;D+=4)g=e[D],k=e[D+1],y=e[D+2],h=e[D+3],e[B++]=-122.67195406894+k*(-6.60635669420364E-5*k+4.37130475926232E-4*y-5.4080610064599E-5*g+4.8449797120281E-4*
h-.154362151871126)+y*(-9.57964378445773E-4*y+8.17076911346625E-4*g-.00477271405408747*h+1.53380253221734)+g*(9.61250184130688E-4*g-.00266257332283933*h+.48357088451265)+h*(-3.36197177618394E-4*h+.484791561490776),e[B++]=107.268039397724+k*(2.19927104525741E-5*k-6.40992018297945E-4*y+6.59397001245577E-4*g+4.26105652938837E-4*h-.176491792462875)+y*(-7.78269941513683E-4*y+.00130872261408275*g+7.70482631801132E-4*h-.151051492775562)+g*(.00126935368114843*g-.00265090189010898*h+.25802910206845)+h*(-3.18913117588328E-4*
h-.213742400323665),e[B++]=-20.810012546947+k*(-5.70115196973677E-4*k-2.63409051004589E-5*y+.0020741088115012*g-.00288260236853442*h+.814272968359295)+y*(-1.53496057440975E-5*y-1.32689043961446E-4*g+5.60833691242812E-4*h-.195152027534049)+g*(.00174418132927582*g-.00255243321439347*h+.116935020465145)+h*(-3.43531996510555E-4*h+.24165260232407);return e},_convertYcckToCmyk:function(e){for(var g,k,y,h=0,B=e.length;h<B;h+=4)g=e[h],k=e[h+1],y=e[h+2],e[h]=434.456-g-1.402*y,e[h+1]=119.541-g+.344*k+.714*
y,e[h+2]=481.816-g-1.772*k;return e},_convertCmykToRgb:function(e){for(var g,k,y,h,B=0,D=1/255,E=0,a=e.length;E<a;E+=4)g=e[E]*D,k=e[E+1]*D,y=e[E+2]*D,h=e[E+3]*D,e[B++]=255+g*(-4.387332384609988*g+54.48615194189176*k+18.82290502165302*y+212.25662451639585*h-285.2331026137004)+k*(1.7149763477362134*k-5.6096736904047315*y-17.873870861415444*h-5.497006427196366)+y*(-2.5217340131683033*y-21.248923337353073*h+17.5119270841813)-h*(21.86122147463605*h+189.48180835922747),e[B++]=255+g*(8.841041422036149*g+
60.118027045597366*k+6.871425592049007*y+31.159100130055922*h-79.2970844816548)+k*(-15.310361306967817*k+17.575251261109482*y+131.35250912493976*h-190.9453302588951)+y*(4.444339102852739*y+9.8632861493405*h-24.86741582555878)-h*(20.737325471181034*h+187.80453709719578),e[B++]=255+g*(.8842522430003296*g+8.078677503112928*k+30.89978309703729*y-.23883238689178934*h-14.183576799673286)+k*(10.49593273432072*k+63.02378494754052*y+50.606957656360734*h-112.23884253719248)+y*(.03296041114873217*y+115.60384449646641*
h-193.58209356861505)-h*(22.33816807309886*h+180.12613974708367);return e},getData:function(e,g,k){if(4<this.numComponents)throw new F("Unsupported color mode");e=this._getLinearizedBlockData(e,g);if(1===this.numComponents&&k){k=e.length;g=new Uint8ClampedArray(3*k);for(var y=0,h=0;h<k;h++){var B=e[h];g[y++]=B;g[y++]=B;g[y++]=B}return g}if(3===this.numComponents&&this._isColorConversionNeeded())return this._convertYccToRgb(e);if(4===this.numComponents){if(this._isColorConversionNeeded())return k?
this._convertYcckToRgb(e):this._convertYcckToCmyk(e);if(k)return this._convertCmykToRgb(e)}return e}};return T}()})})(u);x=x.getDefaultExportFromCjs(u.exports);m.JpegImage=x})},"esri/layers/support/rasterFormats/Lerc":function(){define(["require","exports","../../../assets"],function(m,x,u){function K(H,v,n){n.set(H.slice(v,v+n.length))}function F(H){const {_malloc:v,_free:n,_lerc_getBlobInfo:e,_lerc_getDataRanges:g,_lerc_decode_4D:k,asm:y}=H;let h;const B=Object.values(y).find(E=>E&&"buffer"in E&&
E.buffer===H.HEAPU8.buffer),D=E=>{E=E.map(c=>(c>>3<<3)+16);var a=E.reduce((c,b)=>c+b),d=v(a);h=new Uint8Array(B.buffer);a=E[0];E[0]=d;for(d=1;d<E.length;d++){const c=E[d];E[d]=E[d-1]+a;a=c}return E};M.getBlobInfo=E=>{var a=new Uint8Array(48),d=new Uint8Array(24);const [c,b,f]=D([E.length,a.length,d.length]);h.set(E,c);h.set(a,b);h.set(d,f);var l=e(c,E.length,b,f,12,3);if(l)throw n(c),Error(`lerc-getBlobInfo: error code is ${l}`);h=new Uint8Array(B.buffer);K(h,b,a);K(h,f,d);a=new Uint32Array(a.buffer);
var r=new Float64Array(d.buffer);const [q,w,,p,z,I,G,R,J,V,A]=a;d={version:q,depthCount:V,width:p,height:z,validPixelCount:G,bandCount:I,blobSize:R,maskCount:J,dataType:w,minValue:r[0],maxValue:r[1],maxZerror:r[2],statistics:[],bandCountWithNoData:A};if(A&&1<V)return n(c),d;if(1===V&&1===I)return n(c),d.statistics.push({minValue:r[0],maxValue:r[1]}),d;l=V*I*8;var C=new Uint8Array(l),P=new Uint8Array(l);a=c;var X=r=0;let O=!1;h.byteLength<c+2*l?(n(c),O=!0,[a,r,X]=D([E.length,l,l]),h.set(E,a)):[r,X]=
D([l,l]);h.set(C,r);h.set(P,X);if(l=g(a,E.length,V,I,r,X))throw n(a),O||n(r),Error(`lerc-getDataRanges: error code is ${l}`);h=new Uint8Array(B.buffer);K(h,r,C);K(h,X,P);E=new Float64Array(C.buffer);l=new Float64Array(P.buffer);P=d.statistics;for(C=0;C<I;C++)if(1<V){X=E.slice(C*V,(C+1)*V);const Y=l.slice(C*V,(C+1)*V),S=Math.min.apply(null,X),aa=Math.max.apply(null,Y);P.push({minValue:S,maxValue:aa,depthStats:{minValues:X,maxValues:Y}})}else P.push({minValue:E[C],maxValue:l[C]});n(a);O||n(r);return d};
M.decode=(E,a)=>{const {maskCount:d,depthCount:c,bandCount:b,width:f,height:l,dataType:r,bandCountWithNoData:q}=a;var w=T[r],p=f*l;a=new Uint8Array(p*b);w=new Uint8Array(p*c*b*w.size);p=new Uint8Array(b);var z=new Uint8Array(8*b);const [I,G,R,J,V]=D([E.length,a.length,w.length,p.length,z.length]);h.set(E,I);h.set(a,G);h.set(w,R);h.set(p,J);h.set(z,V);if(E=k(I,E.length,d,G,c,f,l,b,r,R,J,V))throw n(I),Error(`lerc-decode: error code is ${E}`);h=new Uint8Array(B.buffer);K(h,R,w);K(h,G,a);E=null;if(q){K(h,
J,p);K(h,V,z);E=[];z=new Float64Array(z.buffer);for(let A=0;A<p.length;A++)E.push(p[A]?z[A]:null)}n(I);return{data:w,maskData:a,noDataValues:E}}}const T=[{pixelType:"S8",size:1,ctor:Int8Array,range:[-128,127]},{pixelType:"U8",size:1,ctor:Uint8Array,range:[0,255]},{pixelType:"S16",size:2,ctor:Int16Array,range:[-32768,32767]},{pixelType:"U16",size:2,ctor:Uint16Array,range:[0,65536]},{pixelType:"S32",size:4,ctor:Int32Array,range:[-2147483648,2147483647]},{pixelType:"U32",size:4,ctor:Uint32Array,range:[0,
4294967296]},{pixelType:"F32",size:4,ctor:Float32Array,range:[-3.4027999387901484E38,3.4027999387901484E38]},{pixelType:"F64",size:8,ctor:Float64Array,range:[-1.7976931348623157E308,1.7976931348623157E308]}];let N=null;const M={getBlobInfo:null,decode:null};x.decode=function(H,v={}){var n=v.inputOffset??0;H=H instanceof Uint8Array?H.subarray(n):new Uint8Array(H,n);n=M.getBlobInfo(H);const {data:e,maskData:g,noDataValues:k}=M.decode(H,n),{width:y,height:h,bandCount:B,depthCount:D,dataType:E,maskCount:a,
statistics:d}=n;var c=T[E],b=new c.ctor(e.buffer);H=[];n=[];const f=y*h;var l=f*D;for(var r=0;r<B;r++){var q=b.subarray(r*l,(r+1)*l);if(v.returnInterleaved)H.push(q);else{a:{var w=f,p=D;if(2>p)break a;const z=new c.ctor(w*p);for(let I=0,G=0;I<w;I++)for(let R=0,J=I;R<p;R++,J+=w)z[J]=q[G++];q=z}H.push(q)}n.push(g.subarray(r*l,(r+1)*l))}b=0===a?null:1===a?n[0]:new Uint8Array(f);if(1<a)for(b.set(n[0]),l=1;l<n.length;l++)for(r=n[l],q=0;q<f;q++)b[q]&=r[q];({noDataValue:v}=v);l=null!=v&&c.range[0]<=v&&c.range[1]>=
v;if(0<a&&l)for(l=0;l<B;l++)for(r=H[l],q=n[l]||b,w=0;w<f;w++)0===q[w]&&(r[w]=v);({pixelType:c}=c);return{width:y,height:h,bandCount:B,pixelType:c,depthCount:D,statistics:d,pixels:H,mask:b,bandMasks:a===B&&1<B?n:null,noDataValues:k}};x.getBlobInfo=function(H,v={}){H=H instanceof Uint8Array?H.subarray(v.inputOffset??0):new Uint8Array(H,v.inputOffset??0);return M.getBlobInfo(H)};x.load=function(){return N?N:N=(new Promise((H,v)=>m(["../../../chunks/lerc-wasm"],H,v))).then(H=>H.lercWasm).then(({default:H})=>
H({locateFile:v=>u.getAssetUrl(`esri/layers/support/rasterFormats/${v}`)})).then(H=>{F(H)})};x.pixelTypeInfoMap=T;Object.defineProperty(x,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/Lzw":function(){define(["exports"],function(m){function x(T,N,M,H=!0){if(0!==N%4||0!==M%4){var v=new ArrayBuffer(4*Math.ceil(M/4));v=new Uint8Array(v);T=new Uint8Array(T,N,M);if(H)for(H=0;H<v.length;H+=4)v[H]=T[H+3],v[H+1]=T[H+2],v[H+2]=T[H+1],v[H+3]=T[H];else v.set(T);return new Uint32Array(v.buffer)}if(H){H=
new Uint8Array(T,N,M);v=new Uint8Array(H.length);for(T=0;T<v.length;T+=4)v[T]=H[T+3],v[T+1]=H[T+2],v[T+2]=H[T+1],v[T+3]=H[T];return new Uint32Array(v.buffer)}return new Uint32Array(T,N,M/4)}function u(){const T=[];for(let N=0;257>=N;N++)T[N]=[N];return T}function K(T,N){for(let M=0;M<N.length;M++)T.push(N[M])}const F=new Set;F.add(511);F.add(1023);F.add(2047);F.add(4095);F.add(8191);m.decode=function(T,N,M,H=!0){T=x(T,N,M,H);N=9;H=u();let v=32,n=H.length,e=[],g=1,k=T[0],y=0;const h=T.length;M=8*(4*
h-M);const B=[];for(;null!=k;){if(v>=N)v-=N,y=k>>>32-N,k<<=N;else{y=k>>>32-v;k=T[g++];var D=N-v;v=32-D;y=(y<<D)+(k>>>v);k<<=D}if(257===y)break;if(256===y)N=9,H=u(),n=H.length,e=[];else{D=H[y];if(null==D){if(y>H.length)throw Error("data integrity issue: code does not exist on code page");e.push(e[0]);H[n++]=e.slice();K(B,e)}else K(B,D),e.push(D[0]),1<e.length&&(H[n++]=e.slice()),e=D.slice();F.has(n)&&N++;0===v&&(k=T[g++],v=32);if(g>h||g===h&&v<=M)break}}return new Uint8Array(B)};Object.defineProperty(m,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/Raw":function(){define(function(){const m=u=>{let K=1;switch(u){case Uint8Array:case Int8Array:K=1;break;case Uint16Array:case Int16Array:K=2;break;case Uint32Array:case Int32Array:case Float32Array:K=4;break;case Float64Array:K=8}return K};class x{static decode(u,K){var F=K.pixelType;const T=[],N=K.width*K.height;var M=Math.floor(u.byteLength/(K.width*K.height*m(K.pixelType)));const {bandIds:H,format:v}=K;K=H?.length||Math.floor(u.byteLength/
(K.width*K.height*m(K.pixelType)));var n=u.byteLength-u.byteLength%(N*m(F)),e=new F(u,0,N*M);let g,k,y,h,B=null;if("bip"===v)for(g=0;g<K;g++){y=new F(N);h=H?H[g]:g;for(k=0;k<N;k++)y[k]=e[k*M+h];T.push(y)}else if("bsq"===v)for(g=0;g<K;g++)h=H?H[g]:g,T.push(e.subarray(h*N,(h+1)*N));if(n<u.byteLength-1)if(u=u.slice(n),8*u.byteLength<N)B=null;else{u=new Uint8Array(u,0,Math.ceil(N/8));F=new Uint8Array(N);for(n=e=n=K=M=0;n<u.length-1;n++)for(K=u[n],e=7;0<=e;e--)F[M++]=K>>e&1;for(e=7;M<N-1;)K=u[u.length-
1],F[M++]=K>>e&1,e--;B=F}return{pixels:T,mask:B}}}return x})},"esri/layers/support/rasterFormats/TiffDecoder":function(){define("exports ../../../core/has ../rasterDatasets/byteStreamUtils ../../../chunks/Jpg ./Lerc ./Lzw ./pixelRangeUtils ./TiffTags ./utils ../../../chunks/Zlib".split(" "),function(m,x,u,K,F,T,N,M,H,v){function n(A,C){let P="unknown";3===A?P=64===C?"f64":"f32":1===A?1===C?P="u1":2===C?P="u2":4===C?P="u4":8>=C?P="u8":16>=C?P="u16":32>=C&&(P="u32"):2===A&&(8>=C?P="s8":16>=C?P="s16":
32>=C&&(P="s32"));return P}function e(A){let C=null;switch(A?A.toLowerCase():"f32"){case "u1":case "u2":case "u4":case "u8":C=Uint8Array;break;case "u16":C=Uint16Array;break;case "u32":C=Uint32Array;break;case "s8":C=Int8Array;break;case "s16":C=Int16Array;break;case "s32":C=Int32Array;break;case "f64":C=Float64Array;break;default:C=Float32Array}return C}function g(A,C){return{x:C[0]*A.x+C[1]*A.y+C[2],y:C[3]*A.x+C[4]*A.y+C[5]}}function k(A,C){return A.get(C)?.values?.[0]}function y(A,C,P,X=0,O=M.tiffTags,
Y=4){var S=8===Y;const aa=S?q(new DataView(A,P,8),0,C):(new DataView(A,P,2)).getUint16(0,C),t=4+2*Y;var L=S?8:2;S=L+aa*t;if(P+S>A.byteLength)return{success:!1,ifd:null,nextIFD:null,requiredBufferSize:S};const U=P+S+4<=A.byteLength?w(new DataView(A,P+S,8===Y?8:4),0,C,8===Y):null;P+=L;L=new Map;let Q,ca,W,da=0,fa=0;for(let la=0;la<aa;la++){var ha=new DataView(A,P+t*la,t);Q=ha.getUint16(0,C);W=ha.getUint16(2,C);ca=M.getTagName(Q,O);const ka=[];2===Y?(da=ha.getUint16(4,C),fa=ha.getUint16(6,C)):4===Y?
(da=ha.getUint32(4,C),fa=ha.getUint32(8,C)):8===Y&&(da=w(ha,4,C,!0),fa=w(ha,12,C,!0),ka.push(ha.getUint32(12,C)),ka.push(ha.getUint32(16,C)));ha={id:Q,type:W,valueCount:da,valueOffset:fa,valueOffsets:ka,values:null};d(A,C,ha,X,!1,Y);L.set(ca,ha)}return{success:!0,ifd:L,nextIFD:U,requiredBufferSize:S}}function h(A,C){if(1!==C&&2!==C&&4!==C)return A;const P=new Uint8Array(A),X=8/C;A=new Uint8Array(A.byteLength*X);let O=0;const Y=2**C-1;for(let S=0;S<P.length;S++){const aa=P[S];for(let t=0;t<X;t++)A[O++]=
aa<<C*t>>>8-C&Y}return A.buffer}function B(A,C,P){const X=new K.JpegImage;X.parse(A);X.colorTransform=6===P?-1:0;A=X.getData(X.width,X.height,1!==C&&4!==C);return new Uint8Array(A.buffer)}function D(A){A=(new v.Zlib(A)).getBytes();var C=new ArrayBuffer(A.length);C=new Uint8Array(C);C.set(A);return C}async function E(A,C,P,X,O){var Y=H.isPlatformLittleEndian===C,S=k(P,"BITSPERSAMPLE"),aa=k(P,"SAMPLESPERPIXEL")??1,t=k(P,"PHOTOMETRICINTERPRETATION"),L=k(P,"SAMPLEFORMAT")??1,U=n(L,S),Q=k(P,"COMPRESSION")??
1,ca=e(U);if(34887===Q)return await F.load(),F.decode(A,{inputOffset:X}).pixels[0];if(1===Q)t=A.slice(X,X+O),C=new Uint8Array(t);else if(8===Q||32946===Q)C=new Uint8Array(A,X,O),C=D(C),t=C.buffer;else if(6===Q)C=new Uint8Array(A,X,O),C=B(C,aa,t),t=C.buffer;else if(7===Q){const W=P.get("JPEGTABLES").values,da=W.length-2;C=new Uint8Array(da+O-2);for(let fa=0;fa<da;fa++)C[fa]=W[fa];A=new Uint8Array(A,X+2,O-2);for(X=0;X<A.length;X++)C[da+X]=A[X];C=B(C,aa,t);t=C.buffer}else if(5===Q)C=T.decode(A,X,O,C),
t=C.buffer;else throw Error("tiff-decode: unsupport compression "+Q);t=h(t,S);if("u8"!==U&&"s8"!==U&&!Y)switch(t=new ArrayBuffer(C.length),Y=new Uint8Array(t),U){case "u16":case "s16":for(U=0;U<C.length;U+=2)Y[U]=C[U+1],Y[U+1]=C[U];break;case "u32":case "s32":case "f32":for(U=0;U<C.length;U+=4)Y[U]=C[U+3],Y[U+1]=C[U+2],Y[U+2]=C[U+1],Y[U+3]=C[U]}S=new ca(t);Y=k(P,"PREDICTOR")??1;U=k(P,"TILEWIDTH");C=k(P,"TILELENGTH");if(1<Y&&(5===Q||8===Q||32946===Q)&&U&&C){Q=b(P);ca=new ca(S.length);ca.set(S);P=3===
L&&3===Y;Q=Q?1:aa;aa=P?4:1;L=U*aa*Q;P&&(ca=new Uint8Array(ca.buffer));for(Y=0;Y<C;Y++)for(S=Y*L,t=Q;t<L;t++)ca[S+t]+=ca[S+t-Q];if(P){P=new Uint8Array(ca.length);Q*=U;for(U=0;U<C;U++)for(Y=U*L,S=0;S<Q;S++)for(t=0;t<aa;t++)P[Y+S*aa+t]=ca[Y+S+(aa-t-1)*Q];S=new Float32Array(P.buffer)}else S=ca}return S}async function a(A,C,P){const X=P.get("TILEOFFSETS")?.values;if(void 0===X)return null;const O=P.get("TILEBYTECOUNTS")?.values,{width:Y,height:S,pixelType:aa,tileWidth:t,tileHeight:L}=c([P]);var U=b(P,
C);const Q=k(P,"SAMPLESPERPIXEL")||C.planes;var ca=Y*S,W=k(P,"BITSPERSAMPLE"),da=34887===(k(P,"COMPRESSION")??1),fa=e(aa);const ha=[];for(var la=0;la<Q;la++)ha.push(new fa(ca));let ka,pa,na,oa,sa,ta,ua,qa,xa;fa=Math.ceil(Y/t);ca=(new Uint8Array(ca)).fill(255);la=!1;if(0===W%8)if(da&&U&&1<Q)for(U=Math.round(X.length/Q),W=0;W<U;W++){var va=Math.floor(W/fa)*L;na=W%fa*t;oa=va*Y+na;for(da=0;da<Q;da++){var ya=W*Q+da;0===O[ya]?(ya=null,la=!0):ya=await E(A,C.littleEndian,P,X[ya],O[ya]);ta=0;sa=oa;qa=Math.min(t,
Y-na);ua=Math.min(L,S-va);xa=ha[da];for(ka=0;ka<ua;ka++)for(sa=oa+ka*Y,ta=ka*t,pa=0;pa<qa;pa++,sa++,ta++)ya?xa[sa]=ya[ta]:ca[sa]=0}}else for(W=0;W<X.length;W++)for(va=Math.floor(W/fa)*L,na=W%fa*t,oa=va*Y+na,0===O[W]?(ya=null,la=!0):ya=await E(A,C.littleEndian,P,X[W],O[W]),ta=0,sa=oa,qa=Math.min(t,Y-na),ua=Math.min(L,S-va),va=0;va<Q;va++)if(xa=ha[va],U||da)for(ka=0;ka<ua;ka++)for(sa=oa+ka*Y,ta=t*L*va+ka*t,pa=0;pa<qa;pa++,sa++,ta++)ya?xa[sa]=ya[ta]:ca[sa]=0;else for(ka=0;ka<ua;ka++)for(sa=oa+ka*Y,ta=
ka*t*Q+va,pa=0;pa<qa;pa++,sa++,ta+=Q)ya?xa[sa]=ya[ta]:ca[sa]=0;return{width:Y,height:S,pixelType:aa,pixels:ha,mask:la?ca:void 0}}function d(A,C,P,X=0,O=!1,Y=4){if(P.values)return!0;var S=P.type,aa=P.valueCount,t=P.valueOffset;let L=[];var U=G[S],Q=8*U,ca=aa*U,W=aa*G[S]*8,da=8===Y?64:32;Y=P.valueOffsets;if(W>da&&ca>(O?A.byteLength:A?A.byteLength-t+X:0))return P.offlineOffsetSize=[t,ca],P.values=null,!1;if(W<=da)if(C||(32>=da?t>>>=32-W:(A=Y?.length?Y[0]:t>>>0,C=Y?.length?Y[1]:Math.round((t-A)/4294967296),
32>=W?(t=A>>>32-W,Y[0]=t):(t=A*2**(32-W)+(C>>>32-W),Y[0]=A,Y[1]=C>>>32-W))),1===aa&&Q===da)L=[t];else if(64===da)for(A=Y?.length?Y[0]:t>>>0,t=Y?.length?Y[1]:Math.round((t-A)/4294967296),C=A,U=32,A=1;A<=aa;A++)ca=32-Q*A%32,U<Q?(ca=C<<ca>>>32-U,W=t<<32-U>>>32-U,C=t,L.push(ca+W*2**(Q-U)),U-=32-(Q-U)):(L.push(C<<ca>>>32-Q),U-=Q),0===U&&(U=32,C=t);else for(A=1;A<=aa;A++)L.push(t<<32-Q*A>>>32-Q);else for(t-=X,O&&(t=0),aa=t;aa<t+ca;aa+=U){switch(S){case 1:Q=(new DataView(A,aa,1)).getUint8(0);break;case 2:Q=
(new DataView(A,aa,1)).getUint8(0);break;case 3:Q=(new DataView(A,aa,2)).getUint16(0,C);break;case 4:case 13:Q=(new DataView(A,aa,4)).getUint32(0,C);break;case 5:Q=(new DataView(A,aa,4)).getUint32(0,C)/(new DataView(A,aa+4,4)).getUint32(0,C);break;case 6:Q=(new DataView(A,aa,1)).getInt8(0);break;case 7:Q=(new DataView(A,aa,1)).getUint8(0);break;case 8:Q=(new DataView(A,aa,2)).getInt16(0,C);break;case 9:Q=(new DataView(A,aa,4)).getInt32(0,C);break;case 10:Q=(new DataView(A,aa,4)).getInt32(0,C)/(new DataView(A,
aa+4,4)).getInt32(0,C);break;case 11:Q=(new DataView(A,aa,4)).getFloat32(0,C);break;case 12:Q=(new DataView(A,aa,8)).getFloat64(0,C);break;case 16:case 18:Q=q(new DataView(A,aa,8),0,C);break;case 17:Y=new DataView(A,aa,8);W=(Q=C)?Y.getInt32(0,Q):Y.getUint32(0,Q);Y=Q?Y.getUint32(4,Q):Y.getInt32(4,Q);da=0<=(Q?W:Y)?1:-1;Q?W*=da:Y*=da;Q=da*(Q?4294967296*Y+W:4294967296*W+Y);break;default:Q=null}L.push(Q)}if(2===S){S="";t=L;L=[];for(A=0;A<t.length;A++)0===t[A]&&""!==S?(L.push(S),S=""):S+=String.fromCharCode(t[A]);
""===S&&0!==L.length||L.push(S)}P.values=L;return!0}function c(A){var C=A[0];const P=k(C,"TILEWIDTH"),X=k(C,"TILELENGTH"),O=k(C,"IMAGEWIDTH"),Y=k(C,"IMAGELENGTH");var S=k(C,"BITSPERSAMPLE");const aa=k(C,"SAMPLESPERPIXEL");var t=k(C,"SAMPLEFORMAT")??1;const L=n(t,S),U=b(C);var Q=C.get("GDAL_NODATA")?.values;let ca=null;Q?.length&&(ca=Q.map(xa=>parseFloat(xa)),ca.some(xa=>isNaN(xa))&&(ca=null));var W=k(C,"COMPRESSION")??1;switch(W){case 1:Q="NONE";break;case 2:case 3:case 4:case 32771:Q="CCITT";break;
case 5:Q="LZW";break;case 6:case 7:Q="JPEG";break;case 32773:Q="PACKBITS";break;case 8:case 32946:Q="DEFLATE";break;case 34712:Q="JPEG2000";break;case 34887:Q="LERC";break;default:Q=String(W)}let da=!0,fa="";R.has(W)||(da=!1,fa+="unsupported tag compression "+W);3<t&&(da=!1,fa+="unsupported tag sampleFormat "+t);1!==S&&2!==S&&4!==S&&0!==S%8&&(da=!1,fa+="unsupported tag bitsPerSample "+S);S=C.get("GEOASCIIPARAMS")?.values?.[0];if(S){S=(S=S.split("|").find(xa=>xa.includes("ESRI PE String \x3d ")))?
S.replace("ESRI PE String \x3d ",""):"";var ha=S.startsWith("COMPD_CS")||S.startsWith("PROJCS")||S.startsWith("GEOGCS")?{wkid:null,wkt:S}:null}t=C.get("GEOTIEPOINTS")?.values;S=C.get("GEOPIXELSCALE")?.values;W=C.get("GEOTRANSMATRIX")?.values;var la=C.has("GEOKEYDIRECTORY")?C.get("GEOKEYDIRECTORY").data:null,ka=!1;C=!1;if(la){ka=2===k(la,"GTRasterTypeGeoKey");var pa=k(la,"GTModelTypeGeoKey");2===pa?(la=k(la,"GeographicTypeGeoKey"),1024<=la&&32766>=la&&(ha={wkid:la}),ha||32767!==la||(C=!0,ha={wkid:4326})):
1===pa&&(la=k(la,"ProjectedCSTypeGeoKey"),1024<=la&&32766>=la&&(ha={wkid:la}))}let na;S&&t&&6<=t.length?(na=[S[0],0,t[3]-t[0]*S[0],0,-Math.abs(S[1]),t[4]-t[1]*S[1]],ka&&(na[2]-=.5*na[0]+.5*na[1],na[5]-=.5*na[3]+.5*na[4])):W&&16===W.length&&(na=ka?[W[0],W[1],W[3]-.5*W[0],W[4],W[5],W[7]-.5*W[5]]:[W[0],W[1],W[3],W[4],W[5],W[7]]);if(na){t=[{x:0,y:Y},{x:0,y:0},{x:O,y:Y},{x:O,y:0}];la=ka=Number.POSITIVE_INFINITY;let xa=pa=Number.NEGATIVE_INFINITY;for(let va=0;va<t.length;va++)W=g(t[va],na),ka=W.x>ka?ka:
W.x,pa=W.x<pa?pa:W.x,la=W.y>la?la:W.y,xa=W.y<xa?xa:W.y;t={xmin:ka,xmax:pa,ymin:la,ymax:xa,spatialReference:ha}}else t={xmin:-.5,ymin:.5-Y,xmax:O-.5,ymax:.5,spatialReference:ha};C&&(400<t.xmax-t.xmin||361<Math.max(Math.abs(t.xmin),Math.abs(t.xmax)))&&(ha=null,t.spatialReference=null);ha=f(A);let oa;let sa,ta;if(0<ha.length){sa=Math.round(Math.log(O/k(ha[0],"IMAGEWIDTH"))/Math.LN2);var ua=ha[ha.length-1];ta=ha.length;oa=k(ua,"TILEWIDTH");ua=k(ua,"TILELENGTH")}oa=null!=ta&&0<ta?oa||P:null;ua=null!=ta&&
0<ta?ua||X:null;let qa;P&&(qa=[{maxCol:Math.ceil(O/P)-1,maxRow:Math.ceil(Y/X)-1,minRow:0,minCol:0}],ha.forEach(xa=>{qa.push({maxCol:Math.ceil(k(xa,"IMAGEWIDTH")/k(xa,"TILEWIDTH"))-1,maxRow:Math.ceil(k(xa,"IMAGELENGTH")/k(xa,"TILELENGTH"))-1,minRow:0,minCol:0})}));W=A[0].get("GDAL_METADATA")?.values?.[0];W=V(W);fa+=" "+I({width:O,height:Y,tileWidth:P,tileHeight:X,planes:aa,ifds:A});A=l(A).length===ha.length+1;ha=ha?.length?ha.map(xa=>{const va=O/k(xa,"IMAGEWIDTH");xa=Y/k(xa,"IMAGELENGTH");return{x:va,
y:xa}}):void 0;return{width:O,height:Y,tileWidth:P,tileHeight:X,planes:aa,isBSQ:U,pixelType:L,compression:Q,noData:ca,hasMaskBand:A,isSupported:da,pyramidResolutions:ha,message:fa,extent:t,isPseudoGeographic:C,affine:S?null:na,firstPyramidLevel:sa,maximumPyramidLevel:ta,pyramidBlockWidth:oa,pyramidBlockHeight:ua,tileBoundary:qa,metadata:W}}function b(A,C){return(A=A.get("PLANARCONFIGURATION")?.values)?2===A[0]:C?C.isBSQ:!1}function f(A){return A.filter(C=>1===k(C,"NEWSUBFILETYPE"))}function l(A){return A.filter(C=>
{const P=4===((k(C,"NEWSUBFILETYPE")??0)&4);C=4===k(C,"PHOTOMETRICINTERPRETATION");return P&&C})}function r(A){const {littleEndian:C,isBigTiff:P,firstIFDPos:X}=p(A);var O=X;const Y=[];do if(O=z(A,C,O,0,M.tiffTags,P?8:4),O.success)Y.push(O.ifd),O=O.nextIFD;else break;while(0<O);A=c(Y);O=f(Y);const S=l(Y);return{...A,littleEndian:C,isBigTiff:P,ifds:Y,pyramidIFDs:O,maskIFDs:S}}function q(A,C,P){const X=A.getUint32(C,P);A=A.getUint32(C+4,P);return P?4294967296*A+X:4294967296*X+A}function w(A,C,P,X){return X?
q(A,C,P):A.getUint32(C,P)}function p(A){var C=new DataView(A,0,16),P=C.getUint16(0,!1);A=null;if(18761===P)A=!0;else if(19789===P)A=!1;else throw Error("unexpected endianess byte");var X=C.getUint16(2,A);if(42!==X&&43!==X)throw Error("unexpected tiff identifier");P=4;if(X=43===X){const O=C.getUint16(P,A);P+=2;if(8!==O)throw Error("unsupported bigtiff version");if(0!==C.getUint16(P,A))throw Error("unsupported bigtiff version");P+=2}C=w(C,P,A,X);return{littleEndian:A,isBigTiff:X,firstIFDPos:C}}function z(A,
C,P,X=0,O=M.tiffTags,Y=4){P=y(A,C,P,X,O,Y);let S;const aa=P.ifd;aa&&(M.ifdTags.forEach((t,L)=>{aa.has(L)&&(S=aa.get(L),S.data=y(A,C,S.valueOffset-X,X,t).ifd)}),aa.has("GEOKEYDIRECTORY")&&(S=aa.get("GEOKEYDIRECTORY"),(O=S.values)&&4<O.length&&(O=O[0]+"."+O[1]+"."+O[2],S.data=y(A,C,S.valueOffset+6-X,X,M.geoKeys,2).ifd,S.data&&S.data.set("GEOTIFFVersion",{id:0,type:2,valueCount:1,valueOffset:null,values:[O]}))),aa.has("XMP")&&(S=aa.get("XMP"),O=S.values,"number"===typeof O[0]&&7===S.type&&(S.values=
[u.bytesToUTF8(new Uint8Array(O))])));return P}function I(A){const {width:C,height:P,tileHeight:X,tileWidth:O}=A,Y=A.planes,S=O?O*X:C*P;A=k(A.ifds[0],"BITSPERSAMPLE");let aa="";S*Y>2**30/(8<A?A/8:1)&&(aa=O?"tiled tiff exceeding 1 gigabits per tile is not supported":"scanline tiff exceeding 1 gigabits is not supported");return aa}const G=[0,1,1,2,4,8,1,1,2,4,8,4,8,-1,-1,-1,8,8,8],R=new Set([1,5,6,7,8,34712,34887]),J=(A,C,P)=>{if(!(A&&0<A.length&&C&&P))return null;let X,O,Y;const S=A[0].length,aa=A.length,
t=new Uint8Array(S);for(let U=0;U<aa;U++)if(X=A[U],O=C[U],Y=P[U],0===U)for(var L=0;L<S;L++)t[L]=X[L]<O||X[L]>Y?0:1;else for(L=0;L<S;L++)t[L]&&(t[L]=X[L]<O||X[L]>Y?0:1);return t},V=A=>{if(!A)return null;var C=A.match(/<Item(.*?)Item>/gi);if(!C||0===C.length)return null;A=new Map;var P;for(var X=0;X<C.length;X++){var O=C[X];var Y=O.slice(6,O.indexOf("\x3e"));var S=O.indexOf("sample\x3d");-1<S&&(P=O.slice(S+8,O.indexOf('"',S+8)));S=O.indexOf("name\x3d");-1<S&&(Y=O.slice(S+6,O.indexOf('"',S+6)));Y&&(O=
O.slice(O.indexOf("\x3e")+1,O.indexOf("\x3c/Item\x3e")).trim(),null!=P?A.has(Y)?A.get(Y)[P]=O:A.set(Y,[O]):A.set(Y,O));P=null}C=A.get("STATISTICS_MINIMUM");Y=A.get("STATISTICS_MAXIMUM");X=A.get("STATISTICS_MEAN");O=A.get("STATISTICS_STDDEV");P=null;if(C&&Y)for(P=[],S=0;S<C.length;S++)P.push({min:parseFloat(C[S]),max:parseFloat(Y[S]),avg:X&&parseFloat(X[S]),stddev:O&&parseFloat(O[S])});Y=A.get("BandName");X=A.get("WavelengthMin");O=A.get("WavelengthMax");C=null;if(Y)for(C=[],S=0;S<Y.length;S++)C.push({BandName:Y[S],
WavelengthMin:X&&parseFloat(X[S]),WavelengthMax:O&&parseFloat(O[S])});Y=A.get("DataType");return{statistics:P,bandProperties:C,dataType:Y,rawMetadata:A}};m.decode=async function(A,C={}){var P=C.pyramidLevel||0,X=C.headerInfo||r(A);const {ifds:O,noData:Y}=X;if(0===O.length)throw Error("no valid image file directory");var S=I(X);if(S)throw S;S=null;var aa=-1===P?O[O.length-1]:O[P];C=Y??C.noDataValue;if(X.tileWidth)S=await a(A,X,aa);else{{const ta=H.isPlatformLittleEndian===X.littleEndian,ua=aa.get("STRIPOFFSETS")?.values;
if(void 0===ua)S=null;else{var {width:t,height:L,pixelType:U}=c([aa]);P=k(aa,"SAMPLESPERPIXEL")||X.planes;var Q=k(aa,"PHOTOMETRICINTERPRETATION");S=t*L;var ca=k(aa,"BITSPERSAMPLE"),W=e(U),da=new W(S*P),fa=aa.get("STRIPBYTECOUNTS")?.values,ha=k(aa,"ROWSPERSTRIP"),la=k(aa,"COMPRESSION")??1,ka;if(0===ca%8)for(aa=0;aa<ua.length;aa++){var pa=aa*ha*t*P;if("u8"===U||"s8"===U||ta)if(8===la||32946===la){var na=new Uint8Array(A,ua[aa],fa[aa]);na=D(na);var oa=na.buffer}else 6===la?(na=new Uint8Array(A,ua[aa],
fa[aa]),na=B(na,P,Q),oa=na.buffer):5===la?(na=T.decode(A,ua[aa],fa[aa],X.littleEndian),oa=na.buffer):oa=A.slice(ua[aa],ua[aa]+fa[aa]);else{if(6===la||8===la||32946===la){na=new Uint8Array(A,ua[aa],fa[aa]);var sa=D(na);oa=sa.buffer}else oa=new ArrayBuffer(fa[aa]),na=new Uint8Array(A,ua[aa],fa[aa]),sa=new Uint8Array(oa);switch(U){case "u16":case "s16":for(ka=0;ka<na.length;ka+=2)sa[ka]=na[ka+1],sa[ka+1]=na[ka];break;case "u32":case "s32":case "f32":for(ka=0;ka<na.length;ka+=4)sa[ka]=na[ka+3],sa[ka+
1]=na[ka+2],sa[ka+2]=na[ka+1],sa[ka+3]=na[ka]}}oa=h(oa,ca);ka=new W(oa);da.set(ka,pa)}Q=[];if(1===P)Q.push(da);else for(aa=0;aa<P;aa++){X=new W(S);for(A=0;A<S;A++)X[A]=da[A*P+aa];Q.push(X)}S={width:t,height:L,pixelType:U,pixels:Q}}}}if(!S)return S;null!=C&&N.convertNoDataToMask(S,C);return S};m.decodeTileOrStrip=async function(A,C){const {headerInfo:P,ifd:X,offsets:O,sizes:Y}=C;var S=[];for(var aa=0;aa<O.length;aa++){0===Y[aa]?1:0;var t=await E(A,P.littleEndian,X,O[aa],Y[aa]||A.byteLength);S.push(t)}var L=
b(X,P);A=k(X,"BITSPERSAMPLE");aa=k(X,"SAMPLEFORMAT")??1;aa=n(aa,A);var U=k(X,"SAMPLESPERPIXEL")||P.planes;const Q=e(aa);t=k(X,"TILEWIDTH");const ca=k(X,"TILELENGTH");var W=k(X,"COMPRESSION")??1;const da=t*ca;A=[];let fa=S[0];const ha=34887===W;for(let la=0;la<U;la++){W=new Q(da);if(S.length===U)fa=S[la],fa.length===da&&(W=fa);else if(fa.length)if(L||ha)W=fa.length===da?fa:fa.slice(da*la,da*(la+1));else for(let ka=0;ka<da;ka++)W[ka]=fa[ka*U+la];A.push(W)}S=P.noData?P.noData[0]:C.noDataValue;L=(U=P.metadata?
P.metadata.statistics:null)?U.map(la=>la.min):null;U=U?U.map(la=>la.max):null;aa={pixelType:aa,width:t,height:ca,pixels:A,noDataValue:S};null!=S?N.convertNoDataToMask(aa,S):L&&U&&C.applyMinMaxConstraint&&(aa.mask=J(A,L,U));return aa};m.getImageInfo=c;m.getMaskIFDs=l;m.getPyramidIFDs=f;m.isBSQConfig=b;m.parseFieldValues=d;m.parseHeader=r;m.parseIFD=z;m.parseSignature=p;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/byteStreamUtils":function(){define(["exports"],
function(m){m.bytesToUTF8=function(x,u){let K=0,F="",T=0,N=0;const M=x.length;for(;K<M;)if(N=x[K++],T=N>>4,8>T?T=1:15===T?(T=4,N=(N&7)<<18|(x[K++]&63)<<12|(x[K++]&63)<<6|x[K++]&63):14===T?(T=3,N=(N&15)<<12|(x[K++]&63)<<6|x[K++]&63):(T=2,N=(N&31)<<6|x[K++]&63),0!==N||u)F+=String.fromCharCode(N);return F};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/TiffTags":function(){define(function(){const m=(()=>{const F=[];F[254]="NEWSUBFILETYPE";F[255]="SUBFILETYPE";
F[256]="IMAGEWIDTH";F[257]="IMAGELENGTH";F[258]="BITSPERSAMPLE";F[259]="COMPRESSION";F[262]="PHOTOMETRICINTERPRETATION";F[263]="THRESHHOLDING";F[264]="CELLWIDTH";F[265]="CELLLENGTH";F[266]="FILLORDER";F[269]="DOCUMENTNAME";F[270]="IMAGEDESCRIPTION";F[271]="MAKE";F[272]="MODEL";F[273]="STRIPOFFSETS";F[274]="ORIENTATION";F[277]="SAMPLESPERPIXEL";F[278]="ROWSPERSTRIP";F[279]="STRIPBYTECOUNTS";F[280]="MINSAMPLEVALUE";F[281]="MAXSAMPLEVALUE";F[282]="XRESOLUTION";F[283]="YRESOLUTION";F[284]="PLANARCONFIGURATION";
F[285]="PAGENAME";F[286]="XPOSITION";F[287]="YPOSITION";F[288]="FREEOFFSETS";F[289]="FREEBYTECOUNTS";F[290]="GRAYRESPONSEUNIT";F[291]="GRAYRESPONSECURVE";F[292]="T4OPTIONS";F[293]="T6OPTIONS";F[296]="RESOLUTIONUNIT";F[297]="PAGENUMBER";F[300]="COLORRESPONSEUNIT";F[301]="TRANSFERFUNCTION";F[305]="SOFTWARE";F[306]="DATETIME";F[315]="ARTIST";F[316]="HOSTCOMPUTER";F[317]="PREDICTOR";F[318]="WHITEPOINT";F[319]="PRIMARYCHROMATICITIES";F[320]="COLORMAP";F[321]="HALFTONEHINTS";F[322]="TILEWIDTH";F[323]="TILELENGTH";
F[324]="TILEOFFSETS";F[325]="TILEBYTECOUNTS";F[326]="BADFAXLINES";F[327]="CLEANFAXDATA";F[328]="CONSECUTIVEBADFAXLINES";F[330]="SUBIFD";F[332]="INKSET";F[333]="INKNAMES";F[334]="NUMBEROFINKS";F[336]="DOTRANGE";F[337]="TARGETPRINTER";F[338]="EXTRASAMPLES";F[339]="SAMPLEFORMAT";F[340]="SMINSAMPLEVALUE";F[341]="SMAXSAMPLEVALUE";F[342]="TRANSFERRANGE";F[347]="JPEGTABLES";F[512]="JPEGPROC";F[513]="JPEGIFOFFSET";F[514]="JPEGIFBYTECOUNT";F[515]="JPEGRESTARTINTERVAL";F[517]="JPEGLOSSLESSPREDICTORS";F[518]=
"JPEGPOINTTRANSFORM";F[519]="JPEGQTABLES";F[520]="JPEGDCTABLES";F[521]="JPEGACTABLES";F[529]="YCBCRCOEFFICIENTS";F[530]="YCBCRSUBSAMPLING";F[531]="YCBCRPOSITIONING";F[532]="REFERENCEBLACKWHITE";F[700]="XMP";F[33550]="GEOPIXELSCALE";F[33922]="GEOTIEPOINTS";F[33432]="COPYRIGHT";F[42112]="GDAL_METADATA";F[42113]="GDAL_NODATA";F[50844]="RPCCOEFFICIENT";F[34264]="GEOTRANSMATRIX";F[34735]="GEOKEYDIRECTORY";F[34736]="GEODOUBLEPARAMS";F[34737]="GEOASCIIPARAMS";F[34665]="EXIFIFD";F[34853]="GPSIFD";F[40965]=
"INTEROPERABILITYIFD";return F})(),x=(()=>{const F=m.slice();F[36864]="ExifVersion";F[40960]="FlashpixVersion";F[40961]="ColorSpace";F[42240]="Gamma";F[37121]="ComponentsConfiguration";F[37122]="CompressedBitsPerPixel";F[40962]="PixelXDimension";F[40963]="PixelYDimension";F[37500]="MakerNote";F[37510]="UserComment";F[40964]="RelatedSoundFile";F[36867]="DateTimeOriginal";F[36868]="DateTimeDigitized";F[36880]="OffsetTime";F[36881]="OffsetTimeOriginal";F[36882]="OffsetTimeDigitized";F[37520]="SubSecTime";
F[37521]="SubSecTimeOriginal";F[37522]="SubSecTimeDigitized";F[37888]="Temperature";F[37889]="Humidity";F[37890]="Pressure";F[37891]="WaterDepth";F[37892]="Acceleration";F[37893]="CameraElevationAngle";F[42016]="ImageUniqueID";F[42032]="CameraOwnerName";F[42033]="BodySerialNumber";F[42034]="LensSpecification";F[42035]="LensMake";F[42036]="LensModel";F[42037]="LensSerialNumber";F[33434]="ExposureTime";F[33437]="FNumber";F[34850]="ExposureProgram";F[34852]="SpectralSensitivity";F[34855]="PhotographicSensitivity";
F[34856]="OECF";F[34864]="SensitivityType";F[34865]="StandardOutputSensitivity";F[34866]="RecommendedExposureIndex";F[34867]="ISOSpeed";F[34868]="ISOSpeedLatitudeyyy";F[34869]="ISOSpeedLatitudezzz";F[37377]="ShutterSpeedValue";F[37378]="ApertureValue";F[37379]="BrightnessValue";F[37380]="ExposureBiasValue";F[37381]="MaxApertureValue";F[37382]="SubjectDistance";F[37383]="MeteringMode";F[37384]="LightSource";F[37385]="Flash";F[37386]="FocalLength";F[37396]="SubjectArea";F[41483]="FlashEnergy";F[41484]=
"SpatialFrequencyResponse";F[41486]="FocalPlaneXResolution";F[41487]="FocalPlaneYResolution";F[41488]="FocalPlaneResolutionUnit";F[41492]="SubjectLocation";F[41493]="ExposureIndex";F[41495]="SensingMethod";F[41728]="FileSource";F[41729]="SceneType";F[41730]="CFAPattern";F[41985]="CustomRendered";F[41986]="ExposureMode";F[41987]="WhiteBalance";F[41988]="DigitalZoomRatio";F[41989]="FocalLengthIn35mmFilm";F[41990]="SceneCaptureType";F[41991]="GainControl";F[41992]="Contrast";F[41993]="Saturation";F[41994]=
"Sharpness";F[41995]="DeviceSettingDescription";F[41996]="SubjectDistanceRange";return F})(),u=(()=>{const F=[];F[1024]="GTModelTypeGeoKey";F[1025]="GTRasterTypeGeoKey";F[1026]="GTCitationGeoKey";F[2048]="GeographicTypeGeoKey";F[2049]="GeogCitationGeoKey";F[2050]="GeogGeodeticDatumGeoKey";F[2051]="GeogPrimeMeridianGeoKey";F[2052]="GeogLinearUnitsGeoKey";F[2053]="GeogLinearUnitSizeGeoKey";F[2054]="GeogAngularUnitsGeoKey";F[2055]="GeogAngularUnitSizeGeoKey";F[2056]="GeogEllipsoidGeoKey";F[2057]="GeogSemiMajorAxisGeoKey";
F[2058]="GeogSemiMinorAxisGeoKey";F[2059]="GeogInvFlatteningGeoKey";F[2061]="GeogPrimeMeridianLongGeoKey";F[2060]="GeogAzimuthUnitsGeoKey";F[3072]="ProjectedCSTypeGeoKey";F[3073]="PCSCitationGeoKey";F[3074]="ProjectionGeoKey";F[3075]="ProjCoordTransGeoKey";F[3076]="ProjLinearUnitsGeoKey";F[3077]="ProjLinearUnitSizeGeoKey";F[3078]="ProjStdParallel1GeoKey";F[3079]="ProjStdParallel2GeoKey";F[3080]="ProjNatOriginLongGeoKey";F[3081]="ProjNatOriginLatGeoKey";F[3082]="ProjFalseEastingGeoKey";F[3083]="ProjFalseNorthingGeoKey";
F[3084]="ProjFalseOriginLongGeoKey";F[3085]="ProjFalseOriginLatGeoKey";F[3086]="ProjFalseOriginEastingGeoKey";F[3087]="ProjFalseOriginNorthingGeoKey";F[3088]="ProjCenterLongGeoKey";F[3090]="ProjCenterEastingGeoKey";F[3091]="ProjCenterNorthingGeoKey";F[3092]="ProjScaleAtNatOriginGeoKey";F[3093]="ProjScaleAtCenterGeoKey";F[3094]="ProjAzimuthAngleGeoKey";F[3095]="ProjStraightVertPoleLongGeoKey";F[4096]="VerticalCSTypeGeoKey";F[4097]="VerticalCitationGeoKey";F[4098]="VerticalDatumGeoKey";F[4099]="VerticalUnitsGeoKey";
return F})(),K=new Map;K.set("EXIFIFD",x);K.set("GPSIFD","GPSVersionID GPSLatitudeRef GPSLatitude GPSLongitudeRef GPSLongitude GPSAltitudeRef GPSAltitude GPSTimeStamp GPSSatellites GPSStatus GPSMeasureMode GPSDOP GPSSpeedRef GPSSpeed GPSTrackRef GPSTrack GPSImgDirectionRef GPSImgDirection GPSMapDatum GPSDestLatitudeRef GPSDestLatitude GPSDestLongitudeRef GPSDestLongitude GPSDestBearingRef GPSDestBearing GPSDestDistanceRef GPSDestDistance GPSProcessingMethod GPSAreaInformation GPSDateStamp GPSDifferential GPSHPositioningError".split(" "));
return{tiffTags:m,ifdTags:K,geoKeys:u,getTagName:(F,T)=>{T=(T||m)[F];void 0===T&&(T="unknown"+String(F));return T}}})},"esri/layers/support/rasterFormats/utils":function(){define(["exports"],function(m){const x=new ArrayBuffer(4),u=new Uint8Array(x);(new Uint32Array(x))[0]=1;m.isPlatformLittleEndian=1===u[0];Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/pixelUtils":function(){define(["exports","../PixelBlock","../rasterFormats/pixelRangeUtils"],
function(m,x,u){function K(a){return null!=a&&"esri.layers.support.PixelBlock"===a.declaredClass&&a.pixels&&0<a.pixels.length}function F(a,d,c,b,f){const l=a.length;f=x.createEmptyBand(f,l);if(d)for(let r=0;r<l;r++)d[r]&&(f[r]=c[a[r]-b]);else for(d=0;d<l;d++)f[d]=c[a[d]-b];return f}function T(a,d,c,b){const f=null!=c&&2<=c.length?new Set(c):null;c=1===c?.length?c[0]:null;const l=!!d?.length;for(let r=0;r<a.length;r++)if(b[r]){const q=a[r];if(l){let w=!1;for(let p=0;p<d.length;p+=2)if(q>=d[p]&&q<=
d[p+1]){w=!0;break}w||(b[r]=0)}b[r]&&(q===c||f?.has(q))&&(b[r]=0)}}function N(a,d){const c=a[0].length;for(let b=0;b<c;b++)if(d[b]){let f=!1;for(let l=0;l<a.length;l++)if(a[l][b]){f=!0;break}f||(d[b]=0)}}function M(a,d){const c=a[0].length;for(let b=0;b<c;b++)if(d[b]){let f=!1;for(let l=0;l<a.length;l++)if(0===a[l][b]){f=!0;break}f&&(d[b]=0)}}function H(a,d,c,b,f,l,r,q){return{xmin:f<=c*a?0:f<c*a+a?f-c*a:a,ymin:l<=b*d?0:l<b*d+d?l-b*d:d,xmax:f+r<=c*a?0:f+r<c*a+a?f+r-c*a:a,ymax:l+q<=b*d?0:l+q<b*d+d?
l+q-b*d:d}}function v(a,d,c,b,f,l){const {width:r,height:q}=c.block,{x:w,y:p}=c.offset,{width:z,height:I}=c.mosaic;c=H(r,q,b,f,w,p,z,I);let G=0;var R=0;if(l){var J=l.hasGCSSShiftTransform?360:l.halfWorldWidth??0,V=r*l.resolutionX;const A=l.startX+b*V;A<J&&A+V>J?R=l.rightPadding:A>=J&&(G=l.leftMargin-l.rightPadding,R=0)}c.xmax-=R;if("number"===typeof d)for(l=c.ymin;l<c.ymax;l++)for(R=(f*q+l-p)*z+(b*r-w)+G,J=c.xmin;J<c.xmax;J++)a[R+J]=d;else for(l=c.ymin;l<c.ymax;l++)for(R=(f*q+l-p)*z+(b*r-w)+G,J=l*
r,V=c.xmin;V<c.xmax;V++)a[R+V]=d[J+V]}function n(a,d,c={}){const {clipOffset:b,clipSize:f,alignmentInfo:l,blockWidths:r}=c;if(r)return e(a,d,{blockWidths:r});var q=a.find(X=>K(X));if(null==q)return null;c=f?f.width:d.width;const w=f?f.height:d.height;var p=q.width,z=q.height;const I=d.width/p,G=d.height/z;d={offset:b||{x:0,y:0},mosaic:f||d,block:{width:p,height:z}};p=q.pixelType;var R=x.getPixelArrayConstructor(p);q=q.pixels.length;z=[];for(var J=0;J<q;J++){var V=new R(c*w);for(var A=0;A<G;A++)for(var C=
0;C<I;C++){var P=a[A*I+C];K(P)&&(P=P.pixels[J],v(V,P,d,C,A,l))}z.push(V)}R=a.some(X=>null==X||null!=X.mask&&0<X.mask.length);V=a.some(X=>X?.bandMasks&&1<X.bandMasks.length);R=R?new Uint8Array(c*w):void 0;V=V?[]:void 0;if(R){for(J=0;J<G;J++)for(A=0;A<I;A++)C=a[J*I+A],P=null!=C?C.mask:null,null!=P?v(R,P,d,A,J,l):C?v(R,255,d,A,J,l):v(R,0,d,A,J,l);if(V)for(J=0;J<q;J++){A=new Uint8Array(c*w);for(C=0;C<G;C++)for(P=0;P<I;P++){const X=a[C*I+P],O=X?.bandMasks?.[J]??X?.mask;null!=O?v(A,O,d,P,C,l):X?v(A,255,
d,P,C,l):v(A,0,d,P,C,l)}V.push(A)}}a=new x({width:c,height:w,pixels:z,pixelType:p,bandMasks:V,mask:R});a.updateStatistics();return a}function e(a,d,c){const b=a.find(A=>null!=A);if(null==b)return null;var f=a.some(A=>null!=A?!!A.mask:!0);const {width:l,height:r}=d;d=f?new Uint8Array(l*r):null;({blockWidths:c}=c);const q=[],w=b.getPlaneCount(),p=x.getPixelArrayConstructor(b.pixelType);if(f)for(let A=0,C=0;A<a.length;C+=c[A],A++)if(f=a[A],K(f)){var z=f.mask;for(var I=0;I<r;I++)for(var G=0;G<c[A];G++)d[I*
l+G+C]=null==z?255:z[I*f.width+G]}z=(f=a.some(A=>A?.bandMasks&&1<A.bandMasks.length))?[]:void 0;I=l*r;for(G=0;G<w;G++){const A=new p(I),C=f?new Uint8Array(I):void 0;for(let P=0,X=0;P<a.length;X+=c[P],P++){const O=a[P];if(K(O)){var R=O.pixels[G];if(null!=R){for(var J=0;J<r;J++)for(var V=0;V<c[P];V++)A[J*l+V+X]=R[J*O.width+V];if(C)for(R=O.bandMasks?.[G]??O.mask,J=0;J<r;J++)for(V=0;V<c[P];V++)C[J*l+V+X]=R?R[J*O.width+V]:255}}}q.push(A);z&&C&&z.push(C)}a=new x({width:l,height:r,mask:d,bandMasks:z,pixels:q,
pixelType:b.pixelType});a.updateStatistics();return a}function g(a){if(!K(a))return null;const d=a.clone(),{width:c,height:b,pixels:f}=a;var l=f[0];const r=d.pixels[0];a=a.mask;for(let p=2;p<b-1;p++){const z=new Map;for(var q=p-2;q<p+2;q++)for(var w=0;4>w;w++){const I=q*c+w;h(z,l[I],a?a[I]:1)}r[p*c]=k(z);r[p*c+1]=r[p*c+2]=r[p*c];for(q=3;q<c-1;q++)w=(p-2)*c+q+1,h(z,l[w],a?a[w]:1),w=(p-1)*c+q+1,h(z,l[w],a?a[w]:1),w=p*c+q+1,h(z,l[w],a?a[w]:1),w=(p+1)*c+q+1,h(z,l[w],a?a[w]:1),w=(p-2)*c+q-3,y(z,l[w],a?
a[w]:1),w=(p-1)*c+q-3,y(z,l[w],a?a[w]:1),w=p*c+q-3,y(z,l[w],a?a[w]:1),w=(p+1)*c+q-3,y(z,l[w],a?a[w]:1),r[p*c+q]=k(z);r[p*c+q+1]=r[p*c+q]}for(l=0;l<c;l++)r[l]=r[c+l]=r[2*c+l],r[(b-1)*c+l]=r[(b-2)*c+l];d.updateStatistics();return d}function k(a){if(0===a.size)return 0;let d=0,c=-1,b=0;const f=a.keys();let l=f.next();for(;!l.done;)b=a.get(l.value),b>d&&(c=l.value,d=b),l=f.next();return c}function y(a,d,c){0!==c&&(c=a.get(d),1===c?a.delete(d):a.set(d,c-1))}function h(a,d,c){0!==c&&a.set(d,a.has(d)?a.get(d)+
1:1)}function B(a,d,c){let {x:b,y:f}=d;const {width:l,height:r}=c;if(0===b&&0===f&&r===a.height&&l===a.width)return a;const {width:q,height:w}=a;d=Math.max(0,f);const p=Math.max(0,b),z=Math.min(b+l,q),I=Math.min(f+r,w);if(0>z||0>I||!K(a))return null;b=Math.max(0,-b);f=Math.max(0,-f);var {pixels:G}=a,R=l*r,J=G.length;const V=[];for(var A=0;A<J;A++){var C=G[A],P=x.createEmptyBand(a.pixelType,R);for(let X=d;X<I;X++){const O=X*q;let Y=(X+f-d)*l+b;for(let S=p;S<z;S++)P[Y++]=C[O+S]}V.push(P)}G=new Uint8Array(R);
R=a.mask;for(J=d;J<I;J++)for(A=J*q,C=(J+f-d)*l+b,P=p;P<z;P++)G[C++]=R?R[A+P]:1;a=new x({width:c.width,height:c.height,pixelType:a.pixelType,pixels:V,mask:G});a.updateStatistics();return a}function D(a,d=!0){if(!K(a))return null;const {pixels:c,width:b,height:f,mask:l,pixelType:r}=a;a=[];const q=Math.round(b/2),w=Math.round(f/2),p=f-1,z=b-1;for(var I=0;I<c.length;I++){var G=c[I],R=x.createEmptyBand(r,q*w),J=0;for(var V=0;V<f;V+=2)for(var A=0;A<b;A+=2){var C=G[V*b+A];if(d){var P=A===z?C:G[V*b+A+1];
const X=V===p?C:G[V*b+A+b],O=A===z?X:V===p?P:G[V*b+A+b+1];R[J++]=(C+P+X+O)/4}else R[J++]=C}a.push(R)}I=null;if(null!=l)for(I=new Uint8Array(q*w),G=0,R=0;R<f;R+=2)for(J=0;J<b;J+=2)V=l[R*b+J],d?(A=J===z?V:l[R*b+J+1],C=R===p?V:l[R*b+J+b],P=J===z?C:R===p?A:l[R*b+J+b+1],I[G++]=V*A*C*P?1:0):I[G++]=V;return new x({width:q,height:w,pixelType:r,pixels:a,mask:I})}function E(a,d,c,b,f=0){const {width:l,height:r}=a,{width:q,height:w}=d;a=b.cols;b=b.rows;d=Math.ceil(q/a-.1/a);const p=Math.ceil(w/b-.1/b);let z,
I,G,R,J;const V=d*a;var A=V*p*b;const C=new Float32Array(A),P=new Float32Array(A),X=new Uint32Array(A),O=new Uint32Array(A);let Y=0,S,aa;for(let U=0;U<p;U++)for(let Q=0;Q<d;Q++){var t=12*(U*d+Q);A=c[t];z=c[t+1];I=c[t+2];G=c[t+3];R=c[t+4];J=c[t+5];for(var L=0;L<b;L++){Y=(U*b+L)*V+Q*a;aa=(L+.5)/b;for(let ca=0;ca<L;ca++)S=(ca+.5)/a,C[Y+ca]=(A*S+z*aa+I)*l+f,P[Y+ca]=(G*S+R*aa+J)*r+f,X[Y+ca]=Math.floor(C[Y+ca]),O[Y+ca]=Math.floor(P[Y+ca])}t+=6;A=c[t];z=c[t+1];I=c[t+2];G=c[t+3];R=c[t+4];J=c[t+5];for(t=0;t<
b;t++)for(Y=(U*b+t)*V+Q*a,aa=(t+.5)/b,L=t;L<a;L++)S=(L+.5)/a,C[Y+L]=(A*S+z*aa+I)*l+f,P[Y+L]=(G*S+R*aa+J)*r+f,X[Y+L]=Math.floor(C[Y+L]),O[Y+L]=Math.floor(P[Y+L])}return{offsets_x:C,offsets_y:P,offsets_xi:X,offsets_yi:O,gridWidth:V}}m.NoDataInterpretation=void 0;(function(a){a[a.matchAny=0]="matchAny";a[a.matchAll=1]="matchAll"})(m.NoDataInterpretation||(m.NoDataInterpretation={}));m.MissingBandAction=void 0;(function(a){a[a.bestMatch=0]="bestMatch";a[a.fail=1]="fail"})(m.MissingBandAction||(m.MissingBandAction=
{}));m.approximateTransform=function(a,d,c,b,f="nearest"){if(!K(a))return null;"majority"===f&&(a=g(a));const {pixels:l,mask:r,bandMasks:q,pixelType:w}=a,p=a.width;var z=a.height;const I=x.getPixelArrayConstructor(w),G=l.length,{width:R,height:J}=d;a=!1;for(var V=0;V<c.length;V+=3)-1===c[V]&&-1===c[V+1]&&-1===c[V+2]&&(a=!0);const {offsets_x:A,offsets_y:C,offsets_xi:P,offsets_yi:X,gridWidth:O}=E({width:p,height:z},d,c,b,"majority"===f?.5:0);let Y;d=(aa,t,L,U)=>{const Q=aa instanceof Float32Array||
aa instanceof Float64Array?0:.5;for(let ca=0;ca<J;ca++){Y=ca*O;for(let W=0;W<R;W++){if(0>A[Y]||0>C[Y])aa[ca*R+W]=0;else if(U)aa[ca*R+W]=t[P[Y]+X[Y]*p];else{const da=Math.floor(A[Y]),fa=Math.floor(C[Y]),ha=Math.ceil(A[Y]),la=Math.ceil(C[Y]),ka=A[Y]-da,pa=C[Y]-fa;aa[ca*R+W]=!L||L[da+fa*p]&&L[ha+fa*p]&&L[da+la*p]&&L[ha+la*p]?(1-pa)*((1-ka)*t[da+fa*p]+ka*t[ha+fa*p])+pa*((1-ka)*t[da+la*p]+ka*t[ha+la*p])+Q:t[P[Y]+X[Y]*p]}Y++}}};c=[];b=q?.length===G;z=[];for(V=0;V<G;V++){if(b){var S=new Uint8Array(R*J);
d(S,q[V],q[V],!0);z.push(S)}S=new I(R*J);d(S,l[V],b?q[V]:r,"nearest"===f||"majority"===f);c.push(S)}f=new x({width:R,height:J,pixelType:w,pixels:c,bandMasks:b?z:void 0});if(null!=r)f.mask=new Uint8Array(R*J),d(f.mask,r,r,!0);else if(a)for(f.mask=new Uint8Array(R*J),a=0;a<R*J;a++)f.mask[a]=0>A[a]||0>C[a]?0:1;f.updateStatistics();return f};m.clip=B;m.clipTile=function(a){const {pixelBlock:d,tileSize:c,level:b,row:f,col:l,useBilinear:r}=a;if(!K(d))return null;const {width:q,height:w}=c;var p=2**b;a=
p*q;p*=w;a=B(d,{y:f*p,x:l*a},{width:a,height:p});if(!a)return null;for(p=b;0<p;p--)a=D(a,r);return a};m.colorize=function(a,d){if(!K(a)||!d||!d.indexedColormap&&!d.indexed2DColormap)return a;const c=a.clone();var b=c.pixels;let f=c.mask;const l=c.width*c.height;if(1!==b.length)return a;const {indexedColormap:r,indexed2DColormap:q,offset:w,alphaSpecified:p}=d;a=0;b=b[0];d=new Uint8Array(b.length);const z=new Uint8Array(b.length),I=new Uint8Array(b.length);var G=0;if(r){const R=r.length-1;if(null!=
f)for(a=0;a<l;a++)f[a]&&(G=4*(b[a]-w),G<w||G>R?f[a]=0:(d[a]=r[G],z[a]=r[G+1],I[a]=r[G+2],f[a]=r[G+3]));else{f=new Uint8Array(l);for(a=0;a<l;a++)G=4*(b[a]-w),G<w||G>R?f[a]=0:(d[a]=r[G],z[a]=r[G+1],I[a]=r[G+2],f[a]=r[G+3]);c.mask=f}}else if(q)if(null!=f)for(a=0;a<l;a++)f[a]&&(G=q[b[a]],d[a]=G[0],z[a]=G[1],I[a]=G[2],f[a]=G[3]);else{f=new Uint8Array(l);for(a=0;a<l;a++)G=q[b[a]],d[a]=G[0],z[a]=G[1],I[a]=G[2],f[a]=G[3];c.mask=f}c.pixels=[d,z,I];c.statistics=null;c.pixelType="u8";c.maskIsAlpha=p;return c};
m.compositeBands=function(a){if(!a?.length||a.some(w=>!K(w)))return null;if(1===a.length)return a[0]?.clone()??null;const {width:d,height:c,pixelType:b}=a[0];if(a.some(w=>w.width!==d||w.height!==c))return null;const f=a.map(({mask:w})=>w).filter(w=>null!=w);let l=null;f.length&&(l=new Uint8Array(d*c),l.set(f[0]),1<f.length&&M(f.slice(1),l));const r=[];a.forEach(({pixels:w})=>r.push(...w));const q=[];a.map(({statistics:w})=>w).filter(w=>w?.length).forEach(w=>q.push(...w));return new x({pixelType:b,
width:d,height:c,mask:l,pixels:r,statistics:q.length?q:null})};m.createColormapLUT=function(a){if(a){var d=a.colormap;if(d&&0!==d.length){d=d.sort((p,z)=>p[0]-z[0]);var c=0;0>d[0][0]&&(c=d[0][0]);var b=Math.max(256,d[d.length-1][0]-c+1),f=new Uint8Array(4*b),l=[],r=0,q=0,w=5===d[0].length;if(65536<b)return d.forEach(p=>{l[p[0]-c]=w?p.slice(1):p.slice(1).concat([255])}),{indexed2DColormap:l,offset:c,alphaSpecified:w};if(a.fillUnspecified)for(a=d[q],r=a[0]-c;r<b;r++)f[4*r]=a[1],f[4*r+1]=a[2],f[4*r+
2]=a[3],f[4*r+3]=w?a[4]:255,r===a[0]-c&&(a=q===d.length-1?a:d[++q]);else for(r=0;r<d.length;r++)a=d[r],q=4*(a[0]-c),f[q]=a[1],f[q+1]=a[2],f[q+2]=a[3],f[q+3]=w?a[4]:255;return{indexedColormap:f,offset:c,alphaSpecified:w}}}};m.createMaskLUT=function(a,d,c){if("u8"!==a&&"s8"!==a&&"u16"!==a&&"s16"!==a)return null;var b=a.includes("16")?65536:256;a=a.includes("s")?-b/2:0;b=new Uint8Array(b);if(d)for(let l=0;l<d.length;l++){var f=Math.ceil(d[2*l]-a);const r=Math.floor(d[2*l+1]-a);for(;f<=r;f++)b[f]=255}else b.fill(255);
if(c)for(d=0;d<c.length;d++)b[c[d]-a]=0;return{lut:b,offset:a}};m.createRemapLUT=function(a){const {srcPixelType:d,inputRanges:c,outputValues:b,allowUnmatched:f,noDataRanges:l,isLastInputRangeInclusive:r,outputPixelType:q}=a;if("u8"!==d&&"s8"!==d&&"u16"!==d&&"s16"!==d)return null;var w=d.includes("16")?65536:256;a=d.includes("s")?-w/2:0;const p=x.createEmptyBand(q,w);w=new Uint8Array(w);f&&w.fill(255);const [z,I]=u.getPixelValueRange(q);if(c?.length&&b?.length){var G=c.map(A=>A-1E-6);G[0]=c[0];r&&
(G[G.length-1]=c[c.length-1]);for(var R=0;R<G.length;R++){var J=b[R]>I?I:b[R]<z?z:b[R],V=Math.ceil(G[2*R]-a);const A=Math.floor(G[2*R+1]-a);for(;V<=A;V++)p[V]=J,w[V]=255}}if(l?.length)for(G=0;G<l.length;G++)for(J=Math.ceil(l[2*G]-a),R=Math.floor(l[2*G+1]-a);J<=R;J++)w[J]=0;return{lut:p,offset:a,mask:w}};m.extractBands=function(a,d){return d?.length&&K(a)?a.extractBands(d):a};m.getClipBounds=H;m.getLocalArithmeticNorthRotations=function(a,d){const {coefficients:c,spacing:b}=d,{offsets_x:f,offsets_y:l,
gridWidth:r}=E(a,a,c,{rows:b[0],cols:b[1]}),{width:q,height:w}=a;a=new Float32Array(q*w);d=180/Math.PI;for(let I=0;I<w;I++)for(let G=0;G<q;G++){var p=I*r+G,z=0===I?p:p-r;const R=I===w-1?p:p+r;p=f[z]-f[R];z=l[R]-l[z];isNaN(p)||isNaN(z)?a[I*q+G]=90:(z=Math.atan2(z,p)*d,z=(360+z)%360,a[I*q+G]=z)}return a};m.interpolateOffsets=E;m.isValidPixelBlock=K;m.lookupBandValues=F;m.lookupPixels=function(a,d){if(!K(a))return null;const {pixels:c,mask:b}=a,f=c.length;let l=d.lut;const {offset:r}=d;l&&1===l[0].length&&
(l=c.map(()=>l));const q=[];d=d.outputPixelType||"u8";for(let w=0;w<f;w++){const p=F(c[w],b,l[w],r||0,d);q.push(p)}a=new x({width:a.width,height:a.height,pixels:q,mask:b,pixelType:d});a.updateStatistics();return a};m.mask=function(a,d){if(!K(a))return null;const {width:c,height:b,pixels:f}=a;var l=c*b;const r=new Uint8Array(l);a.mask?r.set(a.mask):r.fill(255);a=f.length;const {includedRanges:q,noDataValues:w,outputPixelType:p,matchAll:z,lookups:I}=d;if(I){l=[];for(d=0;d<a;d++){var G=I[d];G=F(f[d],
r,G.lut,G.offset||0,"u8");l.push(G)}1===l.length?r.set(l[0]):z?N(l,r):M(l,r)}else if(z){d=[];for(G=0;G<a;G++){const R=new Uint8Array(l);R.set(r);T(f[G],q?.slice(2*G,2*G+2),w?.[G],R);d.push(R)}1===d.length?r.set(d[0]):N(d,r)}else for(l=0;l<a;l++)T(f[l],q?.slice(2*l,2*l+2),w?.[l],r);return new x({width:c,height:b,pixelType:p,pixels:f,mask:r})};m.maxMapSizeGpu=6;m.mosaic=n;m.mosaicPixelData=function(a,d){if(!a||0===a.length)return null;var c=a.find(I=>I.pixelBlock);if(null==c?.pixelBlock)return null;
var b=(c.extent.xmax-c.extent.xmin)/c.pixelBlock.width;const f=(c.extent.ymax-c.extent.ymin)/c.pixelBlock.height,l=.01*Math.min(b,f),r=a.sort((I,G)=>Math.abs(I.extent.ymax-G.extent.ymax)>l?G.extent.ymax-I.extent.ymax:Math.abs(I.extent.xmin-G.extent.xmin)>l?I.extent.xmin-G.extent.xmin:0);var q=Math.min.apply(null,r.map(I=>I.extent.xmin));const w=Math.min.apply(null,r.map(I=>I.extent.ymin)),p=Math.max.apply(null,r.map(I=>I.extent.xmax)),z=Math.max.apply(null,r.map(I=>I.extent.ymax));a={x:Math.round((d.xmin-
q)/b),y:Math.round((z-d.ymax)/f)};q={width:Math.round((p-q)/b),height:Math.round((z-w)/f)};b={width:Math.round((d.xmax-d.xmin)/b),height:Math.round((d.ymax-d.ymin)/f)};if(Math.round(q.width/c.pixelBlock.width)*Math.round(q.height/c.pixelBlock.height)!==r.length||0>a.x||0>a.y||q.width<b.width||q.height<b.height)return null;c=r.map(I=>I.pixelBlock);c=n(c,q,{clipOffset:a,clipSize:b});return{extent:d,pixelBlock:c}};m.remap=function(a,d){if(!K(a))return null;const {width:c,height:b}=a,{inputRanges:f,outputValues:l,
outputPixelType:r,noDataRanges:q,allowUnmatched:w,isLastInputRangeInclusive:p}=d;d=a.pixels[0];const z=x.createEmptyBand(r,d.length),I=a.mask,G=new Uint8Array(c*b);I?G.set(I):G.fill(255);const R=a.pixelType.startsWith("f")?1E-6:0;a=f.map(Y=>Y-R);a[0]=f[0];a[a.length-1]=f[f.length-1]+(p?1E-6:0);var J=f.length/2;const [V,A]=u.getPixelValueRange(r);for(var C=0;C<b;C++)for(var P=0;P<c;P++){var X=C*c+P;if(G[X]){var O=d[X];let Y=!1;for(let S=J-1;0<=S;S--)if(O===a[2*S]||O>a[2*S]&&O<a[2*S+1]){z[X]=l[S];Y=
!0;break}Y||(w?z[X]=O>A?A:O<V?V:O:G[X]=0)}}if(a=q?.length)for(J=0;J<b;J++)for(C=0;C<c;C++)if(P=J*c+C,!I||I[P])for(X=d[P],O=0;O<a;O+=2)if(X>=q[O]&&X<=q[O+1]){z[P]=0;G[P]=0;break}return new x({width:c,height:b,pixelType:r,pixels:[z],mask:G})};m.remapColor=function(a,d){if(!K(a))return null;a=a.clone();var {pixels:c}=a;const b=a.width*a.height,f=d.length,l=Math.floor(f/2),r=d[Math.floor(l)];c=c[0];let q,w,p,z,I,G,R=!1;const J=new Uint8Array(b),V=new Uint8Array(b),A=new Uint8Array(b);let C=a.mask;const P=
4===d[0].mappedColor.length;C||(C=new Uint8Array(b),C.fill(P?255:1),a.mask=C);for(I=0;I<b;I++)if(C[I]){q=c[I];R=!1;G=l;w=r;p=0;for(z=f-1;1<z-p;){if(q===w.value){R=!0;break}q>w.value?p=G:z=G;G=Math.floor((p+z)/2);w=d[Math.floor(G)]}R||(q===d[p].value?(w=d[p],R=!0):q===d[z].value?(w=d[z],R=!0):q<d[p].value?(R=!1,w=null):q>d[p].value&&(q<d[z].value?(w=d[p],R=!0):z===f-1?(R=!1,w=null):(w=d[z],R=!0)));R?(J[I]=w.mappedColor[0],V[I]=w.mappedColor[1],A[I]=w.mappedColor[2],C[I]=w.mappedColor[3]):J[I]=V[I]=
A[I]=C[I]=0}a.pixels=[J,V,A];a.mask=C;a.pixelType="u8";a.maskIsAlpha=P;return a};m.resampleByMajority=g;m.setValidBoundary=function(a,d,c){if(!K(a))return null;const {width:b,height:f}=a,l=d.x;d=d.y;const r=c.width+l;c=c.height+d;if(0>l||0>d||r>b||c>f||0===l&&0===d&&r===b&&c===f)return a;a.mask||(a.mask=new Uint8Array(b*f));const q=a.mask;for(let w=0;w<f;w++){const p=w*b;for(let z=0;z<b;z++)q[p+z]=w<d||w>=c||z<l||z>=r?0:1}a.updateStatistics();return a};m.split=function(a,d,c=0,b=!0){if(!K(a))return null;
const {width:f,height:l}=d;let {width:r,height:q}=a;const w=new Map,p={x:0,y:0};c=1+c;for(let z=0;z<c;z++){const I=Math.ceil(r/f),G=Math.ceil(q/l);for(let R=0;R<G;R++){p.y=R*l;for(let J=0;J<I;J++){p.x=J*f;const V=B(a,p,d);w.set(`${z}/${R}/${J}`,V)}}z<c-1&&(a=D(a,b));r=Math.round(r/2);q=Math.round(q/2)}return w};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/rasterFunctionHelper":function(){define("exports ../../../core/colorUtils ../../../core/Error ../../../core/lang ./ArithmeticFunction ./AspectFunction ./BandArithmeticFunction ./ClipFunction ./ColormapFunction ./CompositeBandFunction ./ComputeChangeFunction ./ContrastBrightnessFunction ./ConvolutionFunction ./CurvatureFunction ./ExtractBandFunction ./GrayscaleFunction ./LocalFunction ./MaskFunction ./NDVIFunction ./RemapFunction ./SlopeFunction ./StatisticsFunction ./StatisticsHistogramFunction ./StretchFunction ./TableFunction".split(" "),
function(m,x,u,K,F,T,N,M,H,v,n,e,g,k,y,h,B,D,E,a,d,c,b,f,l){function r(O,Y){({rasterFunctionArguments:O}=O);O&&(O.rasters||[O.raster,O.raster2]).forEach(S=>{S&&"number"!==typeof S&&("string"===typeof S?S.startsWith("http")&&(Y.includes(S)||Y.push(S)):"rasterFunctionArguments"in S&&r(S,Y))})}function q(O,Y){return"rasters"===Y[0]&&Array.isArray(O.rasters)?O.rasters:Y.map(S=>O[S])}function w(O){return!!(O&&"object"===typeof O&&O.rasterFunction&&O.rasterFunctionArguments)}function p(O){const {rasterFunction:Y,
rasterFunctionArguments:S}=O,aa={};for(const L in S){let U=S[L];var t=L.toLowerCase();if("rasters"===t&&Array.isArray(U))aa.rasters=U.map(Q=>w(Q)?p(Q):Q);else switch(w(U)&&(U=p(U)),t){case "dra":aa.dra=U;break;case "pspower":aa.psPower=U;break;case "pszfactor":aa.psZFactor=U;break;case "bandids":aa.bandIds=U;break;default:t=L[0].toLowerCase()+L.slice(1),aa[t]=U}}"Local"!==Y||aa.rasters?.length||(aa.rasters=["$$"]);return{...O,rasterFunctionArguments:aa}}function z(O,Y){const {rasterFunction:S,rasterFunctionArguments:aa}=
O;var t=O.outputPixelType?.toLowerCase();if(null==S||!X.has(S))throw new u("raster-function-helper",`unsupported raster function: ${S}`);var L=X.get(S);const U=("function"===typeof L.ctor?L.ctor:L.ctor["default"]).fromJSON({...O,outputPixelType:t});({rasterArgumentNames:O}=U);t=[];L=q(aa,O);const Q="rasters"===O[0]||1<O.length,ca=[];for(let W=0;W<L.length;W++){const da=L[W];let fa;null==da||"string"===typeof da&&da.startsWith("$")?t.push(Y?.raster):"string"===typeof da?Y[da]&&t.push(Y[da]):"number"!==
typeof da&&"rasterFunction"in da&&(fa=z(da,Y),Q||(U.functionArguments[O[W]]=fa),t.push(fa));Q&&ca.push(fa??da)}Q&&("rasters"===O[0]?U.functionArguments.rasters=ca:O.forEach((W,da)=>{U.functionArguments[W]=ca[da]}));Y&&(U.sourceRasters=t,Y=Y.raster?.url)&&(U.mainPrimaryRasterId=Y);return U}function I(O,Y){if(O&&Y)for(const S in O){const aa=O[S];aa&&"object"===typeof aa&&"type"in aa&&("RasterFunctionTemplate"===aa.type?I(aa.arguments,Y):"RasterFunctionVariable"===aa.type&&null!=Y[aa.name]&&(aa.value=
Y[aa.name]))}}function G(O,Y){if(!O||"object"!==typeof O)return O;const {value:S}=O;if(!S||"object"!==typeof S)return O.isDataset?"$$":S;if(Array.isArray(S))return 0===S.length?[]:S.map(t=>"object"===typeof t&&"RasterFunctionVariable"===t.type?G(t,Y):t);if("value"in S&&["number","string","boolean"].includes(typeof S.value))return S.value;if(O.isDataset&&"Scalar"!==S.type)return"$$";if(!("type"in S))return S;O=S;switch(S.type){case "Scalar":O=S.value;break;case "AlgorithmicColorRamp":O=R(S);break;
case "MultiPartColorRamp":O={type:"multipart",colorRamps:S.ArrayOfColorRamp.map(R)};break;case "ArgumentArray":if(S.elements?.length&&"RasterStatistics"!==S.elements[0].type){O=[];for(let t=0;t<S.elements.length;t++){const L=S.elements[t];var {type:aa}=L;if(aa)if("RasterFunctionTemplate"===aa)({renderingRule:aa}=J(L,Y)),O.push(aa),null!=L._object_id&&Y.set(L._object_id,aa);else if("RasterFunctionVariable"===aa)aa=G(L,Y),O.push(aa),null!=L._object_id&&Y.set(L._object_id,aa);else throw new u("raster-function-helper",
"unsupported raster function json.");else O.push(L)}}else O=S.elements}null!=S._object_id&&Y.set(S._object_id,O);return O}function R(O){const Y=O.algorithm??"esriHSVAlgorithm";let {FromColor:S,ToColor:aa}=O;if(!Array.isArray(S)){const {r:t,g:L,b:U}=x.toRGB({h:S.Hue,s:S.Saturation,v:S.Value});S=[t,L,U,S.AlphaValue]}if(!Array.isArray(aa)){const {r:t,g:L,b:U}=x.toRGB({h:aa.Hue,s:aa.Saturation,v:aa.Value});aa=[t,L,U,aa.AlphaValue]}return{type:"algorithmic",algorithm:Y,fromColor:S,toColor:aa}}function J(O,
Y,S){S&&I(O,S);Y={renderingRule:{},templates:Y};V(O,Y);return Y}function V(O,Y){if(O&&Y.renderingRule){var {renderingRule:S,templates:aa}=Y,{function:t,arguments:L,_object_id:U}=O;if(t&&L){null!=U&&aa.set(U,S);S.rasterFunction=t.type.replace("Function","");S.outputPixelType=t.pixelType;O={};S.rasterFunctionArguments=O;for(const Q in L)"type"!==Q&&"object_id"!==Q&&"_object_ref_id"!==Q&&((Y=L[Q])&&"object"===typeof Y&&"type"in Y&&("RasterFunctionTemplate"===Y.type||"RasterFunctionVariable"===Y.type)?
("RasterFunctionVariable"===Y.type?O[Q]=G(Y,aa):(S.rasterFunctionArguments[Q]={},V(Y,{renderingRule:S.rasterFunctionArguments[Q],templates:aa})),null!=Y._object_id&&aa.set(Y._object_id,O[Q])):O[Q]=Y);O.DEM&&!O.Raster&&(O.Raster=O.DEM,delete O.DEM);switch(S.rasterFunction){case "Stretch":C(O);break;case "Colormap":"randomcolorramp"===O.ColorRamp?.type?.toLowerCase()&&(delete O.ColorRamp,O.ColormapName="Random");0===O.ColorSchemeType&&delete O.ColorRamp;break;case "Convolution":null!=O.ConvolutionType&&
(O.Type=O.ConvolutionType,delete O.ConvolutionType);break;case "Mask":P(O)}}}}function A(O){const {renderingRule:Y,templates:S}=O;if("object"===typeof Y&&Y?.rasterFunctionArguments&&S.size){({rasterFunctionArguments:O}=Y);for(const aa in O){const t=O[aa],L="_object_ref_id"===aa?t:t&&"object"===typeof t&&"_object_ref_id"in t?t._object_ref_id:null;if(null!=L){if(!S.has(L))throw new u("raster-function-helper",`unsupported raster function json. _object_ref_id: ${L} does not exist`);const U=S.get(L);"_object_ref_id"!==
aa?O[aa]=U:U&&"object"===typeof U&&Object.assign(O,U)}else t&&"object"===typeof t&&(t.rasterFunctionArguments&&A({renderingRule:t,templates:S}),Array.isArray(t)&&t.forEach((U,Q)=>{if("object"===typeof U)if(null!=U._object_ref_id){if(!S.has(U._object_ref_id))throw new u("raster-function-helper",`unsupported raster function json. _object_ref_id: ${t} does not exist`);const ca=S.get(L);ca&&"object"===typeof ca?Object.assign(U,ca):t[Q]=ca}else A({renderingRule:U,templates:S})}))}}}function C(O){O.Statistics?.length&&
"object"===typeof O.Statistics&&(O.Statistics=O.Statistics.map(Y=>[Y.min,Y.max,Y.mean,Y.standardDeviation]));null!=O.NumberOfStandardDeviation&&(O.NumberOfStandardDeviations=O.NumberOfStandardDeviation,delete O.NumberOfStandardDeviation)}function P(O){O.NoDataValues?.length&&"string"===typeof O.NoDataValues[0]&&(O.NoDataValues=O.NoDataValues.filter(Y=>""!==Y).map(Y=>Number(Y)))}const X=new Map;X.set("Arithmetic",{desc:"Arithmetic Function",ctor:F,rasterArgumentNames:["rasters"]});X.set("Aspect",{desc:"Aspect Function",
ctor:T,rasterArgumentNames:["raster"]});X.set("BandArithmetic",{desc:"Band Arithmetic Function",ctor:N,rasterArgumentNames:["raster"]});X.set("Colormap",{desc:"Colormap Function",ctor:H,rasterArgumentNames:["raster"]});X.set("CompositeBand",{desc:"CompositeBand Function",ctor:v,rasterArgumentNames:["rasters"]});X.set("ComputeChange",{desc:"ComputeChange Function",ctor:n,rasterArgumentNames:["rasters"]});X.set("Convolution",{desc:"Convolution Function",ctor:g,rasterArgumentNames:["raster"]});X.set("ContrastBrightness",
{desc:"Contrast Brightness Function",ctor:e,rasterArgumentNames:["raster"]});X.set("ExtractBand",{desc:"ExtractBand Function",ctor:y,rasterArgumentNames:["raster"]});X.set("Curvature",{desc:"Curvature Function",ctor:k,rasterArgumentNames:["raster"]});X.set("Grayscale",{desc:"Grayscale Function",ctor:h,rasterArgumentNames:["raster"]});X.set("Clip",{desc:"Clip Function",ctor:M,rasterArgumentNames:["raster"]});X.set("Local",{desc:"Local Function",ctor:B,rasterArgumentNames:["rasters"]});X.set("Mask",
{desc:"Mask Function",ctor:D,rasterArgumentNames:["raster"]});X.set("NDVI",{desc:"NDVI Function",ctor:E,rasterArgumentNames:["raster"]});X.set("Remap",{desc:"Remap Function",ctor:a,rasterArgumentNames:["raster"]});X.set("Slope",{desc:"Slope Function",ctor:d,rasterArgumentNames:["raster"]});X.set("Statistics",{desc:"Focal Statistics Function",ctor:c,rasterArgumentNames:["raster"]});X.set("StatisticsHistogram",{desc:"Statistics Histogram Function",ctor:b,rasterArgumentNames:["raster"]});X.set("Stretch",
{desc:"Stretch Function",ctor:f,rasterArgumentNames:["raster"]});X.set("Table",{desc:"Attribute Table Function",ctor:l,rasterArgumentNames:["raster"]});m.create=function(O,Y){Y=Y??{};O=K.clone(O);if("function"in O&&"arguments"in O&&O.arguments){const S=new Map;O=J(O,S,Y);A(O);if(!O.renderingRule)throw new u("raster-function-helper","Unsupported raster function json.");O=O.renderingRule}if("rasterFunction"in O)return O=p(O),z(O,Y);throw new u("raster-function-helper","unsupported raster function json.");
};m.getPrimaryRasterUrls=r;m.getRasterValues=q;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/ArithmeticFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../rasterFormats/pixelRangeUtils ./ArithmeticFunctionArguments ./BaseRasterFunction ./localUtils".split(" "),function(m,x,u,K,
F,T,N,M,H,v){u=class extends H{constructor(){super(...arguments);this.functionName="Arithmetic";this.functionArguments=null;this.rasterArgumentNames=["raster","raster2"]}_bindSourceRasters(){var {operation:n}=this.functionArguments;if(1>n||6<n)return{success:!1,supportsGPU:!1,error:"unsupported operation"};n=this.sourceRasterInfos[0].clone();this.outputPixelType=this._getOutputPixelType(n.pixelType);n.pixelType=this.outputPixelType;this._removeStatsHistColormapVAT(n);this.rasterInfo=n;return{success:!0,
supportsGPU:3>=n.bandCount}}_processPixels(n){({pixelBlocks:n}=n);return null==n?.[0]||null==n?.[1]?null:v.arithmetic(n,this.functionArguments.operation,this.outputPixelType)}_getWebGLParameters(){var {operation:n}=this.functionArguments;n=" plus minus times divide power mod".split(" ")[n];var e=this.outputPixelType??"f32";let [g,k]=N.getPixelValueRange(e);if(e=N.isIntegerPixelType(e))g-=1E-4,k+=1E-4;return{imageCount:2,operationName:n,domainRange:[g,k],isOutputRounded:e}}};m.__decorate([x.property({json:{write:!0,
name:"rasterFunction"}})],u.prototype,"functionName",void 0);m.__decorate([x.property({type:M,json:{write:!0,name:"rasterFunctionArguments"}})],u.prototype,"functionArguments",void 0);m.__decorate([x.property()],u.prototype,"rasterArgumentNames",void 0);return u=m.__decorate([T.subclass("esri.layers.support.rasterFunctions.ArithmeticFunction")],u)})},"esri/layers/support/rasterFunctions/ArithmeticFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(m,x,u,K,F,T,N){var M;u=M=class extends N{constructor(){super(...arguments);this.raster2=void 0}get rasters(){return[this.raster,this.raster2]}clone(){return new M({raster:this.raster,raster2:this.raster2,operation:this.operation})}};m.__decorate([x.property({json:{write:!0}})],u.prototype,"operation",void 0);m.__decorate([x.property({json:{write:!0}})],u.prototype,"raster2",void 0);m.__decorate([x.property({readOnly:!0})],u.prototype,"rasters",null);return u=M=m.__decorate([T.subclass("esri.layers.support.rasterFunctions.ArithmeticFunctionArguments")],
u)})},"esri/layers/support/rasterFunctions/BaseFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),function(m,x,u,K,F,T,N){x=class extends x.JSONSupport{constructor(){super(...arguments);this.raster=void 0}};m.__decorate([u.property({json:{write:!0}})],x.prototype,"raster",void 0);return x=
m.__decorate([N.subclass("esri.layers.support.rasterFunctions.BaseFunctionArguments")],x)})},"esri/layers/support/rasterFunctions/BaseRasterFunction":function(){define("../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/cast ../../../core/RandomLCG ../../../core/has ../../../core/accessorSupport/decorators/subclass ../PixelBlock ../RasterInfo".split(" "),function(m,x,u,K,F,T,N,M,H){const v=new Set("slope aspect curvature hillshade shadedrelief statistics".split(" "));
x=class extends x.JSONSupport{constructor(){super(...arguments);this.functionArguments=null;this.readingBufferSize=0;this.id=-1;this.isNoopProcess=!1;this.rawInputBandIds=[];this.rawSourceRasterInfos=null;this.isInputBandIdsSwizzled=!1;this.swizzledBandSelection=[];this.isBranch=!1;this._bindingResult=null}get supportsGPU(){return this._bindingResult.supportsGPU}get flatWebGLFunctionChain(){var n=this.getWebGLProcessorDefinition();if(!n)return null;const e=[n];({parameters:n}=n);for(n=n.rasters||
n.raster&&[n.raster];n?.length;){e.unshift(...n);var g=[];for(var k=0;k<n.length;k++){var {parameters:y}=n[k];y=y.rasters||y.raster&&[y.raster];y?.length&&g.push(...y)}n=g}for(n=e.length-1;0<=n;n--)e[n].isNoopProcess&&e.splice(n,1);n=!1;for(g=0;g<e.length;g++)k=e[g],k.id=e.length-g-1,{rasters:k}=k.parameters,n=n||null!=k&&1<k.length;g=e.some(({name:h})=>v.has(h.toLowerCase()));({rawSourceRasterInfos:k}=this);return{functions:e,hasBranches:n,hasFocalFunction:g,isSourceSingleBand:1===k?.[0]?.bandCount}}bind(n,
e=!1,g=-1){this.id=g+1;g=this._getRasterValues();let k=!0;for(let h=0;h<g.length;h++){var y=g[h];if(null!=y&&this._isRasterFunctionValue(y)){y=y.bind(n,e,this.id+h);if(!y.success)return this._bindingResult=y;k=k&&y.supportsGPU}}if(!this.rasterInfo||e)return this.sourceRasterInfos=this._getSourceRasterInfos(n),this._bindingResult=this._bindSourceRasters(),this._bindingResult.success&&this._patchRasterInfo(),this._bindingResult.supportsGPU=k&&this._bindingResult.supportsGPU,this.processInputBandIds(),
this._bindingResult;this._bindingResult={success:!0,supportsGPU:!0};this.processInputBandIds();return this._bindingResult}process(n){var e=this._getRasterValues();e=0===e.length?n.pixelBlocks??n.primaryPixelBlocks:e.map(g=>this._readRasterValue(g,n));return this._processPixels({...n,pixelBlocks:e})}processInputBandIds(){var n=this._getRasterValues().filter(this._isRasterFunctionValue);if(1<n.length)return this.rawInputBandIds=n.map(g=>g.processInputBandIds()[0]),this.isInputBandIdsSwizzled=this.rawInputBandIds.some((g,
k)=>g!==k),n=n.filter(g=>"ExtractBand"===g.functionName),n.length&&n.forEach((g,k)=>{g.isInputBandIdsSwizzled=!0;g.swizzledBandSelection=[k,k,k]}),this.rawInputBandIds;var e=n[0];if(e){if(n=e.processInputBandIds(),e.isInputBandIdsSwizzled)return this.rawInputBandIds=n}else{n=[];({bandCount:e}=this.sourceRasterInfos[0]);for(let g=0;g<e;g++)n.push(g)}n=this._getInputBandIds(n);this.isInputBandIdsSwizzled=n.some((g,k)=>g!==k);return this.rawInputBandIds=n}getPrimaryRasters(){const n=[],e=[];this._getPrimaryRasters(this,
n,e);return{rasters:n,rasterIds:e}}getWebGLProcessorDefinition(){const n=this._getWebGLParameters(),{raster:e,rasters:g}=this.functionArguments;g&&Array.isArray(g)&&g.length?(n.rasters=g.map(k=>this._isRasterFunctionValue(k)?k.getWebGLProcessorDefinition():"number"===typeof k?{name:"Constant",parameters:{value:k},pixelType:"f32",id:-1,isNoopProcess:!1}:{name:"Identity",parameters:{value:k},pixelType:"f32",id:-1,isNoopProcess:!1}),n.rasters.some(k=>null!=k)||(n.rasters=null)):this._isRasterFunctionValue(e)&&
(n.raster=e.getWebGLProcessorDefinition());return{name:this.functionName,parameters:n,pixelType:this.outputPixelType,id:this.id,isNoopProcess:this.isNoopProcess}}getClippingGeometries(){const n=[];"Clip"===this.functionName&&n.push(this.functionArguments);const {raster:e,rasters:g}=this.functionArguments;if(g&&Array.isArray(g)&&g.length)g.forEach(k=>{this._isRasterFunctionValue(k)&&(k=k.getClippingGeometries(),n.push(...k))});else if(this._isRasterFunctionValue(e)){const k=e.getClippingGeometries();
n.push(...k)}return n}_getOutputPixelType(n){return"unknown"===this.outputPixelType?n:this.outputPixelType??n}_getWebGLParameters(){return{}}_getInputBandIds(n){return n}_removeStatsHistColormapVAT(n){n.statistics=null;n.histograms=null;n.colormap=null;n.attributeTable=null}_getRasterValues(){const {rasterArgumentNames:n}=this;return"rasters"===n[0]?this.functionArguments.rasters??[]:n.flatMap(e=>this.functionArguments[e])}_getSourceRasterInfos(n){const e=this._getRasterValues(),{rasterInfos:g,rasterIds:k}=
n;if(0===e.length)return g;const y=e.map(B=>{if(B&&"object"===typeof B&&"bind"in B&&B.rasterInfo)return B.rasterInfo;if("string"===typeof B&&k.includes(B))return g[k.indexOf(B)];if("number"!==typeof B)return g[0]}),h=y.find(B=>B)??g[0];y.forEach((B,D)=>{void 0===B&&(y[D]=h)});return y}_getPrimaryRasterId(n){return n?.rasterId}_getPrimaryRasters(n,e=[],g=[]){for(let y=0;y<n.sourceRasters.length;y++){var k=n.sourceRasters[y];if("number"!==typeof k)if("bind"in k)this._getPrimaryRasters(k,e,g);else{const h=
this._getPrimaryRasterId(k);null==h||g.includes(h)||(this.mainPrimaryRasterId===h?(e.unshift(k),g.unshift(h)):(e.push(k),g.push(h)))}}}_isRasterFunctionValue(n){return null!=n&&"object"===typeof n&&"getWebGLProcessorDefinition"in n}_readRasterValue(n,e){var {primaryPixelBlocks:g}=e;if(null==n||"$$"===n)return n=g[0],null==n?null:n.clone();if("string"===typeof n)return n=e.primaryRasterIds.indexOf(n),-1===n?null:g[n];if("number"===typeof n){g=g[0];if(null==g)return null;const {width:k,height:y,pixelType:h}=
g;g=new Float32Array(k*y);g.fill(n);n=Array(this.sourceRasterInfos[0].bandCount).fill(g);return new M({width:k,height:y,pixelType:h,pixels:n})}return n.process(e)}_patchRasterInfo(){const {rasterInfo:n}=this;if(n?.keyProperties){var {bandCount:e,keyProperties:g,statistics:k,histograms:y}=n,h=g.BandProperties;h&&h.length!==e&&(n.keyProperties={...g,BandProperties:void 0});k&&k.length!==e&&(n.statistics=k.length>e?k.slice(0,e):null);y&&y.length!==e&&(n.histograms=y.length>e?y.slice(0,e):null);g.BAND_COUNT&&
Number(g.BAND_COUNT)!==e&&(n.keyProperties={...g,BAND_COUNT:"string"===typeof g.BAND_COUNT?String(e):e})}}};m.__decorate([u.property({json:{write:!0}})],x.prototype,"functionName",void 0);m.__decorate([u.property({json:{write:!0}})],x.prototype,"functionArguments",void 0);m.__decorate([u.property()],x.prototype,"rasterArgumentNames",void 0);m.__decorate([u.property({json:{write:!0}}),K.cast(n=>n?.toLowerCase())],x.prototype,"outputPixelType",void 0);m.__decorate([u.property({json:{write:!0}})],x.prototype,
"mainPrimaryRasterId",void 0);m.__decorate([u.property()],x.prototype,"sourceRasters",void 0);m.__decorate([u.property({type:[H],json:{write:!0}})],x.prototype,"sourceRasterInfos",void 0);m.__decorate([u.property({json:{write:!0}})],x.prototype,"rasterInfo",void 0);m.__decorate([u.property({json:{write:!0}})],x.prototype,"readingBufferSize",void 0);m.__decorate([u.property({json:{write:!0}})],x.prototype,"id",void 0);m.__decorate([u.property()],x.prototype,"isNoopProcess",void 0);m.__decorate([u.property()],
x.prototype,"supportsGPU",null);m.__decorate([u.property()],x.prototype,"rawInputBandIds",void 0);m.__decorate([u.property()],x.prototype,"rawSourceRasterInfos",void 0);m.__decorate([u.property()],x.prototype,"isInputBandIdsSwizzled",void 0);m.__decorate([u.property()],x.prototype,"swizzledBandSelection",void 0);m.__decorate([u.property()],x.prototype,"isBranch",void 0);m.__decorate([u.property({readOnly:!0})],x.prototype,"flatWebGLFunctionChain",null);m.__decorate([u.property()],x.prototype,"_bindingResult",
void 0);return x=m.__decorate([N.subclass("esri.layers.support.rasterFunctions.BaseRasterFunction")],x)})},"esri/layers/support/RasterInfo":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/subclass ../../geometry/Extent ../../geometry/SpatialReference ./RasterBandInfo ./RasterSensorInfo ./RasterStorageInfo".split(" "),function(m,x,u,K,F,T,N,M,H,v,n,
e){var g;x=g=class extends x.JSONSupport{constructor(k){super(k);this.extent=this.colormap=this.bandCount=this.attributeTable=null;this.format=void 0;this.histograms=this.width=this.height=null;this.keyProperties={};this.pixelType=this.pixelSize=this.noDataValue=this.multidimensionalInfo=null;this.isPseudoSpatialReference=!1;this.transform=this.storageInfo=this.statistics=this.spatialReference=null}get bandInfos(){var k=this.keyProperties.BandProperties,{bandCount:y}=this;if(!k?.length||k.length<
y){k=[];for(let h=1;h<=y;h++)k.push(new v({name:"band_"+h}));return k}y=k.map(h=>v.fromJSON(h));for(k=0;k<y.length;k++)y[k].name=y[k].name||"band_"+(k+1);return y}get dataType(){const k=this.keyProperties?.DataType?.toLowerCase()??"generic";return"stdtime"===k?"standard-time":k}get nativeExtent(){return this._get("nativeExtent")||this.extent}set nativeExtent(k){k&&this._set("nativeExtent",k)}get nativePixelSize(){if(null==this.transform||!this.transform.affectsPixelSize)return this.pixelSize;const k=
this.nativeExtent;return{x:k.width/this.width,y:k.height/this.height}}get hasMultidimensionalTranspose(){return!!this.storageInfo?.transposeInfo}get sensorInfo(){if(this.keyProperties?.SensorName)return n.fromJSON(this.keyProperties)}clone(){return new g({attributeTable:u.clone(this.attributeTable),bandCount:this.bandCount,colormap:u.clone(this.colormap),extent:u.clone(this.extent),format:this.format,height:this.height,width:this.width,histograms:u.clone(this.histograms),keyProperties:u.clone(this.keyProperties),
multidimensionalInfo:u.clone(this.multidimensionalInfo),noDataValue:this.noDataValue,pixelSize:u.clone(this.pixelSize),pixelType:this.pixelType,isPseudoSpatialReference:this.isPseudoSpatialReference,spatialReference:u.clone(this.spatialReference),statistics:u.clone(this.statistics),storageInfo:u.clone(this.storageInfo),transform:u.clone(this.transform)})}};m.__decorate([K.property({json:{write:!0}})],x.prototype,"attributeTable",void 0);m.__decorate([K.property({json:{write:!0}})],x.prototype,"bandCount",
void 0);m.__decorate([K.property({readOnly:!0})],x.prototype,"bandInfos",null);m.__decorate([K.property({json:{write:!0}})],x.prototype,"colormap",void 0);m.__decorate([K.property({type:String,readOnly:!0})],x.prototype,"dataType",null);m.__decorate([K.property({type:M,json:{write:!0}})],x.prototype,"extent",void 0);m.__decorate([K.property({type:M,json:{write:!0}})],x.prototype,"nativeExtent",null);m.__decorate([K.property({json:{write:!0}})],x.prototype,"nativePixelSize",null);m.__decorate([K.property({json:{write:!0}})],
x.prototype,"format",void 0);m.__decorate([K.property({json:{write:!0}})],x.prototype,"height",void 0);m.__decorate([K.property({json:{write:!0}})],x.prototype,"width",void 0);m.__decorate([K.property({json:{write:!0}})],x.prototype,"hasMultidimensionalTranspose",null);m.__decorate([K.property({json:{write:!0}})],x.prototype,"histograms",void 0);m.__decorate([K.property({json:{write:!0}})],x.prototype,"keyProperties",void 0);m.__decorate([K.property({json:{write:!0}})],x.prototype,"multidimensionalInfo",
void 0);m.__decorate([K.property({json:{write:!0}})],x.prototype,"noDataValue",void 0);m.__decorate([K.property({json:{write:!0}})],x.prototype,"pixelSize",void 0);m.__decorate([K.property({json:{write:!0}})],x.prototype,"pixelType",void 0);m.__decorate([K.property()],x.prototype,"isPseudoSpatialReference",void 0);m.__decorate([K.property({readOnly:!0})],x.prototype,"sensorInfo",null);m.__decorate([K.property({type:H,json:{write:!0}})],x.prototype,"spatialReference",void 0);m.__decorate([K.property({json:{write:!0}})],
x.prototype,"statistics",void 0);m.__decorate([K.property({type:e,json:{write:!0}})],x.prototype,"storageInfo",void 0);m.__decorate([K.property({json:{write:!0}})],x.prototype,"transform",void 0);return x=g=m.__decorate([N.subclass("esri.layers.support.RasterInfo")],x)})},"esri/layers/support/RasterBandInfo":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),
function(m,x,u,K,F,T,N){function M(v){v=Number(v);return isNaN(v)?void 0:v}var H;x=H=class extends x.JSONSupport{constructor(){super(...arguments);this.name=null;this.solarIrradiance=this.reflectanceGain=this.reflectanceBias=this.radianceGain=this.radianceBias=this.maxWavelength=this.minWavelength=void 0}clone(){return new H({name:this.name,minWavelength:this.minWavelength,maxWavelength:this.maxWavelength,radianceBias:this.radianceBias,radianceGain:this.radianceGain,reflectanceBias:this.reflectanceBias,
reflectanceGain:this.reflectanceGain,solarIrradiance:this.solarIrradiance})}};m.__decorate([u.property({json:{name:"BandName",write:!0}})],x.prototype,"name",void 0);m.__decorate([u.property({json:{name:"WavelengthMin",read:{reader:M},write:!0}})],x.prototype,"minWavelength",void 0);m.__decorate([u.property({json:{name:"WavelengthMax",read:{reader:M},write:!0}})],x.prototype,"maxWavelength",void 0);m.__decorate([u.property({json:{name:"RadianceBias",read:{reader:M},write:!0}})],x.prototype,"radianceBias",
void 0);m.__decorate([u.property({json:{name:"RadianceGain",read:{reader:M},write:!0}})],x.prototype,"radianceGain",void 0);m.__decorate([u.property({json:{name:"ReflectanceBias",read:{reader:M},write:!0}})],x.prototype,"reflectanceBias",void 0);m.__decorate([u.property({json:{name:"ReflectanceGain",read:{reader:M},write:!0}})],x.prototype,"reflectanceGain",void 0);m.__decorate([u.property({json:{name:"SolarIrradiance",read:{reader:M},write:!0}})],x.prototype,"solarIrradiance",void 0);return x=H=
m.__decorate([N.subclass("esri.layers.support.RasterBandInfo")],x)})},"esri/layers/support/RasterSensorInfo":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer".split(" "),function(m,x,u,K,F,T,N,M,H){function v(e){e=Number(e);return isNaN(e)?void 0:
e}var n;x=n=class extends x.JSONSupport{constructor(){super(...arguments);this.productName=this.cloudCover=this.acquisitionDate=void 0;this.sensorName=null;this.sunElevation=this.sunAzimuth=this.sensorElevation=this.sensorAzimuth=void 0}readAcquisitionDate(e){return new Date(e)}writeAcquisitionDate(e,g){g.AcquisitionDate=e.getTime()}clone(){return new n({acquisitionDate:this.acquisitionDate,cloudCover:this.cloudCover,productName:this.productName,sensorName:this.sensorName,sensorAzimuth:this.sensorAzimuth,
sensorElevation:this.sensorElevation,sunAzimuth:this.sunAzimuth,sunElevation:this.sunElevation})}};m.__decorate([u.property({json:{name:"AcquisitionDate",write:!0}})],x.prototype,"acquisitionDate",void 0);m.__decorate([N.reader("acquisitionDate")],x.prototype,"readAcquisitionDate",null);m.__decorate([H.writer("acquisitionDate")],x.prototype,"writeAcquisitionDate",null);m.__decorate([u.property({json:{name:"CloudCover",read:{reader:v},write:!0}})],x.prototype,"cloudCover",void 0);m.__decorate([u.property({json:{name:"ProductName",
write:!0}})],x.prototype,"productName",void 0);m.__decorate([u.property({json:{name:"SensorName",write:!0}})],x.prototype,"sensorName",void 0);m.__decorate([u.property({json:{name:"SensorAzimuth",read:{reader:v},write:!0}})],x.prototype,"sensorAzimuth",void 0);m.__decorate([u.property({json:{name:"SensorElevation",read:{reader:v},write:!0}})],x.prototype,"sensorElevation",void 0);m.__decorate([u.property({json:{name:"SunAzimuth",read:{reader:v},write:!0}})],x.prototype,"sunAzimuth",void 0);m.__decorate([u.property({json:{name:"SunElevation",
read:{reader:v},write:!0}})],x.prototype,"sunElevation",void 0);return x=n=m.__decorate([M.subclass("esri.layers.support.RasterSensorInfo")],x)})},"esri/layers/support/RasterStorageInfo":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/subclass ../../geometry/Point".split(" "),function(m,x,u,K,F,T,N,M){var H;x=H=class extends x.JSONSupport{constructor(){super(...arguments);
this.blockHeight=this.blockWidth=void 0;this.maximumPyramidLevel=this.firstPyramidLevel=this.origin=this.compression=null;this.pyramidScalingFactor=2;this.pyramidBlockHeight=this.pyramidBlockWidth=null;this.isVirtualTileInfo=!1;this.blockBoundary=this.transposeInfo=this.tileInfo=null}clone(){return new H({blockWidth:this.blockWidth,blockHeight:this.blockHeight,compression:this.compression,origin:u.clone(this.origin),firstPyramidLevel:this.firstPyramidLevel,maximumPyramidLevel:this.maximumPyramidLevel,
pyramidResolutions:u.clone(this.pyramidResolutions),pyramidScalingFactor:this.pyramidScalingFactor,pyramidBlockWidth:this.pyramidBlockWidth,pyramidBlockHeight:this.pyramidBlockHeight,isVirtualTileInfo:this.isVirtualTileInfo,tileInfo:u.clone(this.tileInfo),transposeInfo:u.clone(this.transposeInfo),blockBoundary:u.clone(this.blockBoundary)})}};m.__decorate([K.property({type:Number,json:{write:!0}})],x.prototype,"blockWidth",void 0);m.__decorate([K.property({type:Number,json:{write:!0}})],x.prototype,
"blockHeight",void 0);m.__decorate([K.property({type:String,json:{write:!0}})],x.prototype,"compression",void 0);m.__decorate([K.property({type:M,json:{write:!0}})],x.prototype,"origin",void 0);m.__decorate([K.property({type:Number,json:{write:!0}})],x.prototype,"firstPyramidLevel",void 0);m.__decorate([K.property({type:Number,json:{write:!0}})],x.prototype,"maximumPyramidLevel",void 0);m.__decorate([K.property({json:{write:!0}})],x.prototype,"pyramidResolutions",void 0);m.__decorate([K.property({type:Number,
json:{write:!0}})],x.prototype,"pyramidScalingFactor",void 0);m.__decorate([K.property({type:Number,json:{write:!0}})],x.prototype,"pyramidBlockWidth",void 0);m.__decorate([K.property({type:Number,json:{write:!0}})],x.prototype,"pyramidBlockHeight",void 0);m.__decorate([K.property({type:Boolean,json:{write:!0}})],x.prototype,"isVirtualTileInfo",void 0);m.__decorate([K.property({json:{write:!0}})],x.prototype,"tileInfo",void 0);m.__decorate([K.property()],x.prototype,"transposeInfo",void 0);m.__decorate([K.property()],
x.prototype,"blockBoundary",void 0);return x=H=m.__decorate([N.subclass("esri.layers.support.RasterStorageInfo")],x)})},"esri/layers/support/rasterFunctions/localUtils":function(){define(["exports","../PixelBlock","../rasterFunctionConstants","../rasterFormats/pixelRangeUtils"],function(m,x,u,K){function F(Z,ia=!1){var ba=Z.map(ea=>ea.mask);const ja=ba.filter(ea=>null!=ea);Z=Z[0].pixels[0].length;if(0===ja.length||ia&&ja.length!==ba.length)return(new Uint8Array(Z)).fill(255);ba=new Uint8Array(ja[0]);
if(1===ja.length)return ba;if(!ia){for(ia=1;ia<ja.length;ia++){Z=ja[ia];for(var ma=0;ma<ba.length;ma++)ba[ma]&&(ba[ma]=Z[ma]?255:0)}return ba}for(ia=1;ia<ja.length;ia++)for(Z=ja[ia],ma=0;ma<ba.length;ma++)0===ba[ma]&&(ba[ma]=Z[ma]?255:0);return ba}function T(Z,ia,ba){const [ja,ma]=Z;Z=ja.length;ba=x.createEmptyBand(ba,Z);for(let ea=0;ea<Z;ea++)if(!ia||ia[ea])ba[ea]=ja[ea]+ma[ea];return ba}function N(Z,ia,ba){[Z]=Z;ia=x.createEmptyBand("f32",Z.length);ia.set(Z);return ia}function M(Z,ia,ba){[Z]=Z;
const ja=Z.length;ba=x.createEmptyBand(ba,ja);for(let ma=0;ma<ja;ma++)if(!ia||ia[ma])ba[ma]=Z[ma]*Z[ma];return ba}function H(Z,ia,ba){const [ja,ma]=Z;Z=ja.length;ba=x.createEmptyBand(ba,Z);for(let ea=0;ea<Z;ea++)if(!ia||ia[ea])ba[ea]=ja[ea]-ma[ea];return ba}function v(Z,ia,ba){const [ja,ma]=Z;Z=ja.length;ba=x.createEmptyBand(ba,Z);for(let ea=0;ea<Z;ea++)if(!ia||ia[ea])ba[ea]=ja[ea]*ma[ea];return ba}function n(Z,ia,ba){[Z]=Z;const ja=Z.length;ba=x.createEmptyBand(ba,ja);for(let ma=0;ma<ja;ma++)if(!ia||
ia[ma])ba[ma]=Math.sign(Z[ma])*Math.floor(Math.abs(Z[ma]));return ba}function e(Z,ia,ba){const [ja,ma]=Z;Z=ja.length;ba=x.createEmptyBand(ba,Z);for(let ea=0;ea<Z;ea++)if(!ia||ia[ea])ba[ea]=ja[ea]/ma[ea];return ba}function g(Z,ia,ba){return e(Z,ia,"f32")}function k(Z,ia,ba){const [ja,ma]=Z;Z=ja.length;ba=x.createEmptyBand(ba,Z);for(let ea=0;ea<Z;ea++)if(!ia||ia[ea])ba[ea]=Math.floor(ja[ea]/ma[ea]);return ba}function y(Z,ia,ba,ja){Z=Z[0];const ma=Z.length;ba=x.createEmptyBand(ba,ma);if(ja===u.localTrigonometricOperation.atanh){for(ja=
0;ja<ma;ja++)if(ia[ja]){var ea=Z[ja];1<=Math.abs(ea)?ia[ja]=0:ba[ja]=Math.atanh(ea)}return ba}ja=ja===u.localTrigonometricOperation.asin?Math.asin:Math.acos;for(ea=0;ea<ma;ea++)if(ia[ea]){const ra=Z[ea];1<Math.abs(ra)?ia[ea]=0:ba[ea]=ja(ra)}return ba}function h(Z,ia,ba,ja){[Z]=Z;const ma=Z.length;ba=x.createEmptyBand(ba,ma);for(let ea=0;ea<ma;ea++)if(!ia||ia[ea])ba[ea]=ja(Z[ea]);return ba}function B(Z,ia,ba,ja){const [ma,ea]=Z;Z=ma.length;ba=x.createEmptyBand(ba,Z);for(let ra=0;ra<Z;ra++)if(!ia||
ia[ra])ba[ra]=ja(ma[ra],ea[ra]);return ba}function D(Z,ia,ba){const [ja,ma]=Z;Z=ja.length;ba=x.createEmptyBand(ba,Z);for(let ea=0;ea<Z;ea++)if(!ia||ia[ea])ba[ea]=ja[ea]&ma[ea];return ba}function E(Z,ia,ba){const [ja,ma]=Z;Z=ja.length;ba=x.createEmptyBand(ba,Z);for(let ea=0;ea<Z;ea++)if(!ia||ia[ea])ba[ea]=ja[ea]<<ma[ea];return ba}function a(Z,ia,ba){[Z]=Z;const ja=Z.length;ba=x.createEmptyBand(ba,ja);for(let ma=0;ma<ja;ma++)if(!ia||ia[ma])ba[ma]=~Z[ma];return ba}function d(Z,ia,ba){const [ja,ma]=Z;
Z=ja.length;ba=x.createEmptyBand(ba,Z);for(let ea=0;ea<Z;ea++)if(!ia||ia[ea])ba[ea]=ja[ea]|ma[ea];return ba}function c(Z,ia,ba){const [ja,ma]=Z;Z=ja.length;ba=x.createEmptyBand(ba,Z);for(let ea=0;ea<Z;ea++)if(!ia||ia[ea])ba[ea]=ja[ea]>>ma[ea];return ba}function b(Z,ia,ba){const [ja,ma]=Z;Z=ja.length;ba=x.createEmptyBand(ba,Z);for(let ea=0;ea<Z;ea++)if(!ia||ia[ea])ba[ea]=ja[ea]^ma[ea];return ba}function f(Z,ia,ba){const [ja,ma]=Z;Z=ja.length;ba=x.createEmptyBand(ba,Z);for(let ea=0;ea<Z;ea++)if(!ia||
ia[ea])ba[ea]=ja[ea]&&ma[ea]?1:0;return ba}function l(Z,ia,ba){[Z]=Z;const ja=Z.length;ba=x.createEmptyBand(ba,ja);for(let ma=0;ma<ja;ma++)if(!ia||ia[ma])ba[ma]=Z[ma]?0:1;return ba}function r(Z,ia,ba){const [ja,ma]=Z;Z=ja.length;ba=x.createEmptyBand(ba,Z);for(let ea=0;ea<Z;ea++)if(!ia||ia[ea])ba[ea]=ja[ea]||ma[ea]?1:0;return ba}function q(Z,ia,ba){const [ja,ma]=Z;Z=ja.length;ba=x.createEmptyBand(ba,Z);for(let ea=0;ea<Z;ea++)if(!ia||ia[ea])ba[ea]=(ja[ea]?1:0)^(ma[ea]?1:0);return ba}function w(Z,ia,
ba){const [ja,ma]=Z;Z=ja.length;ba=x.createEmptyBand(ba,Z);for(let ea=0;ea<Z;ea++)if(!ia||ia[ea])ba[ea]=ja[ea]===ma[ea]?1:0;return ba}function p(Z,ia,ba,ja){[Z]=Z;const ma=Z.length;ba=x.createEmptyBand(ba,ma);const ea=ja===Math.E;for(let ra=0;ra<ma;ra++)if(!ia||ia[ra])ba[ra]=ea?Math.exp(Z[ra]):ja**Z[ra];return ba}function z(Z,ia,ba){return p(Z,ia,ba,10)}function I(Z,ia,ba){return p(Z,ia,ba,2)}function G(Z,ia,ba){return p(Z,ia,ba,Math.E)}function R(Z,ia,ba,ja){[Z]=Z;const ma=Z.length;ba=x.createEmptyBand(ba,
ma);for(let ea=0;ea<ma;ea++)if(!ia||ia[ea])0>=Z[ea]?ia[ea]=0:ba[ea]=ja(Z[ea]);return ba}function J(Z,ia,ba){return R(Z,ia,ba,Math.log10)}function V(Z,ia,ba){return R(Z,ia,ba,Math.log2)}function A(Z,ia,ba){return R(Z,ia,ba,Math.log)}function C(Z,ia,ba){const [ja,ma]=Z;Z=ja.length;ba=x.createEmptyBand(ba,Z);for(let ea=0;ea<Z;ea++)if(!ia||ia[ea])ba[ea]=ja[ea]>ma[ea]?1:0;return ba}function P(Z,ia,ba){const [ja,ma]=Z;Z=ja.length;ba=x.createEmptyBand(ba,Z);for(let ea=0;ea<Z;ea++)if(!ia||ia[ea])ba[ea]=ja[ea]>=
ma[ea]?1:0;return ba}function X(Z,ia,ba){const [ja,ma]=Z;Z=ja.length;ba=x.createEmptyBand(ba,Z);for(let ea=0;ea<Z;ea++)if(!ia||ia[ea])ba[ea]=ja[ea]<ma[ea]?1:0;return ba}function O(Z,ia,ba){const [ja,ma]=Z;Z=ja.length;ba=x.createEmptyBand(ba,Z);for(let ea=0;ea<Z;ea++)if(!ia||ia[ea])ba[ea]=ja[ea]<=ma[ea]?1:0;return ba}function Y(Z,ia,ba){[Z]=Z;Z=Z.length;ba=x.createEmptyBand(ba,Z);if(!ia)return ba;for(let ja=0;ja<Z;ja++)ba[ja]=ia[ja]?0:1;return ba}function S(Z,ia,ba){const [ja,ma]=Z;Z=ja.length;ba=
x.createEmptyBand(ba,Z);for(let ea=0;ea<Z;ea++)if(!ia||ia[ea])ba[ea]=ja[ea]%ma[ea];return ba}function aa(Z,ia,ba){[Z]=Z;const ja=Z.length;ba=x.createEmptyBand(ba,ja);for(let ma=0;ma<ja;ma++)if(!ia||ia[ma])ba[ma]=-Z[ma];return ba}function t(Z,ia,ba){const [ja,ma]=Z;Z=ja.length;ba=x.createEmptyBand(ba,Z);for(let ea=0;ea<Z;ea++)if(!ia||ia[ea])ba[ea]=ja[ea]===ma[ea]?0:1;return ba}function L(Z,ia,ba){const [ja,ma]=Z;Z=ja.length;ba=x.createEmptyBand(ba,Z);const ea=new Uint8Array(Z);for(let ra=0;ra<Z;ra++)null!=
ia&&!ia[ra]||0!==ja[ra]||(ba[ra]=ma[ra],ea[ra]=255);return{band:ba,mask:ea}}function U(Z,ia,ba){const [ja,ma,ea]=Z;Z=ja.length;ba=x.createEmptyBand(ba,Z);for(let ra=0;ra<Z;ra++)if(!ia||ia[ra])ba[ra]=ja[ra]?ma[ra]:ea[ra];return ba}function Q(Z,ia,ba){const ja=Z.length;if(2>ja)return Z[0];const [ma]=Z,ea=ma.length;ba=x.createEmptyBand(ba,ea);for(let ra=0;ra<ea;ra++)if(!ia||ia[ra]){let wa=ma[ra];for(let za=1;za<ja;za++){const Ba=Z[za][ra];wa<Ba&&(wa=Ba)}ba[ra]=wa}return ba}function ca(Z,ia,ba){const ja=
Z.length;if(2>ja)return Z[0];const [ma]=Z,ea=ma.length;ba=x.createEmptyBand(ba,ea);for(let ra=0;ra<ea;ra++)if(!ia||ia[ra]){let wa=ma[ra];for(let za=1;za<ja;za++){const Ba=Z[za][ra];wa>Ba&&(wa=Ba)}ba[ra]=wa}return ba}function W(Z,ia,ba){const ja=Z.length;if(2>ja)return Z[0];const [ma]=Z,ea=ma.length;ba=x.createEmptyBand(ba,ea);for(let ra=0;ra<ea;ra++)if(!ia||ia[ra]){let wa=ma[ra],za=wa;for(let Ba=1;Ba<ja;Ba++){const Aa=Z[Ba][ra];za<Aa?za=Aa:wa>Aa&&(wa=Aa)}ba[ra]=za-wa}return ba}function da(Z,ia,ba){const ja=
Z.length;if(2>ja)return Z[0];var [ma]=Z;ma=ma.length;ba=x.createEmptyBand(ba,ma);for(let ea=0;ea<ma;ea++)if(!ia||ia[ea]){let ra=0;for(let wa=0;wa<ja;wa++)ra+=Z[wa][ea];ba[ea]=ra/ja}return ba}function fa(Z,ia,ba){const ja=Z.length;if(2>ja)return Z[0];var [ma]=Z;ma=ma.length;ba=x.createEmptyBand(ba,ma);for(let ea=0;ea<ma;ea++)if(!ia||ia[ea])for(let ra=0;ra<ja;ra++)ba[ea]+=Z[ra][ea];return ba}function ha(Z,ia,ba){const ja=Z.length;if(2>ja)return Z[0];var [ma]=Z;ma=ma.length;ba=x.createEmptyBand(ba,ma);
for(let wa=0;wa<ma;wa++)if(!ia||ia[wa]){const za=new Float32Array(ja);let Ba=0;for(var ea=0;ea<ja;ea++){var ra=Z[ea];Ba+=ra[wa];za[ea]=ra[wa]}Ba/=ja;ea=0;for(ra=0;ra<ja;ra++)ea+=(za[ra]-Ba)**2;ba[wa]=Math.sqrt(ea/ja)}return ba}function la(Z,ia,ba){const ja=Z.length;if(2>ja)return Z[0];const ma=Math.floor(ja/2);var [ea]=Z;ea=ea.length;ba=x.createEmptyBand(ba,ea);const ra=new Float32Array(ja),wa=1===ja%2;for(let za=0;za<ea;za++)if(!ia||ia[za]){for(let Ba=0;Ba<ja;Ba++)ra[Ba]=Z[Ba][za];ra.sort();ba[za]=
wa?ra[ma]:(ra[ma]+ra[ma-1])/2}return ba}function ka(Z,ia,ba){const [ja,ma]=Z;if(null==ma)return ja;Z=ja.length;ba=x.createEmptyBand(ba,Z);for(let ea=0;ea<Z;ea++)ia[ea]&&(ja[ea]===ma[ea]?ba[ea]=ja[ea]:ia[ea]=0);return ba}function pa(Z,ia,ba){const ja=Z.length;if(2>=ja)return ka(Z,ia,ba);const ma=Z[0].length;ba=x.createEmptyBand(ba,ma);const ea=new Map;for(let wa=0;wa<ma;wa++)if(!ia||ia[wa]){ea.clear();let za;for(var ra=0;ra<ja;ra++)za=Z[ra][wa],ea.set(za,ea.has(za)?ea.get(za)+1:1);let Ba=ra=0;for(const Aa of ea.keys())ra=
ea.get(Aa),ra>Ba&&(Ba=ra,za=Aa);ba[wa]=za}return ba}function na(Z,ia,ba){const ja=Z.length;if(2>=ja)return ka(Z,ia,ba);const ma=Z[0].length;ba=x.createEmptyBand(ba,ma);const ea=new Map;for(let wa=0;wa<ma;wa++)if(!ia||ia[wa]){ea.clear();let za;for(var ra=0;ra<ja;ra++)za=Z[ra][wa],ea.set(za,ea.has(za)?ea.get(za)+1:1);ra=0;let Ba=Z.length;for(const Aa of ea.keys())ra=ea.get(Aa),ra<Ba&&(Ba=ra,za=Aa);ba[wa]=za}return ba}function oa(Z,ia,ba){const ja=Z.length;if(2>ja)return Z[0];var [ma]=Z;ma=ma.length;
ba=x.createEmptyBand(ba,ma);const ea=new Set;for(let ra=0;ra<ma;ra++)if(!ia||ia[ra]){ea.clear();let wa;for(let za=0;za<ja;za++)wa=Z[za][ra],ea.add(wa);ba[ra]=ea.size}return ba}function sa(Z,ia,ba,ja){let [ma,ea]=K.getPixelValueRange(ba);if(ba=K.isIntegerPixelType(ba))ma-=1E-5,ea+=1E-5;for(let ra=0;ra<ia.length;ra++)if(ia[ra]){const wa=Z[ra];isNaN(wa)||wa<ma||wa>ea?ia[ra]=0:ja[ra]=ba?Math.round(wa):wa}}function ta(Z,ia,ba={}){qa.size||(qa.set(4,Math.sqrt),qa.set(6,Math.acos),qa.set(7,Math.asin),qa.set(8,
Math.atan),qa.set(9,Math.atanh),qa.set(10,Math.abs),qa.set(21,Math.cos),qa.set(22,Math.cosh),qa.set(48,Math.floor),qa.set(49,Math.ceil),qa.set(51,Math.sin),qa.set(52,Math.sinh),qa.set(56,Math.tan),qa.set(57,Math.tanh),qa.set(59,Math.acosh),qa.set(60,Math.asinh),qa.set(65,Math.floor),xa.set(5,Math.pow),xa.set(61,Math.atan2),va.set(1,T),va.set(2,H),va.set(3,v),va.set(11,D),va.set(12,E),va.set(13,a),va.set(14,d),va.set(15,c),va.set(16,b),va.set(17,f),va.set(18,l),va.set(19,r),va.set(20,q),va.set(23,
e),va.set(24,w),va.set(25,G),va.set(26,z),va.set(27,I),va.set(28,C),va.set(29,P),va.set(30,n),va.set(31,Y),va.set(32,N),va.set(33,X),va.set(34,O),va.set(35,A),va.set(36,J),va.set(37,V),va.set(44,S),va.set(45,aa),va.set(46,t),va.set(53,M),va.set(64,g),va.set(65,k),va.set(76,U),va.set(78,U),ya.set(38,pa),ya.set(39,Q),ya.set(40,da),ya.set(41,la),ya.set(42,ca),ya.set(43,na),ya.set(47,W),ya.set(54,ha),ya.set(55,fa),ya.set(58,oa),ya.set(66,pa),ya.set(67,Q),ya.set(68,da),ya.set(69,la),ya.set(70,ca),ya.set(71,
na),ya.set(72,W),ya.set(73,ha),ya.set(74,fa),ya.set(75,oa));var ja=F(Z,66<=ia&&75>=ia);const {outputPixelType:ma="f32"}=ba,ea=!ya.has(ia)||ba.processAsMultiband,ra=ea?Z[0].pixels.length:1;ba=[];for(let Ba=0;Ba<ra;Ba++){var wa=ya.has(ia)&&!ea?Z.flatMap(Aa=>Aa.pixels):Z.map(Aa=>Aa.pixels[Ba]),za=!0;ia===u.localConditionalOperation.setNull?(ja=L(wa,ja,ma),wa=ja.band,ja=ja.mask,za=!1):va.has(ia)?wa=va.get(ia)(wa,ja,"f64"):qa.has(ia)?wa=ia===u.localTrigonometricOperation.asin||ia===u.localTrigonometricOperation.acos||
ia===u.localTrigonometricOperation.atanh?y(wa,ja,"f64",ia):h(wa,ja,"f64",qa.get(ia)):xa.has(ia)?wa=B(wa,ja,"f64",xa.get(ia)):ya.has(ia)?wa=ya.get(ia)(wa,ja,"f64"):(wa=wa[0],za=!1);za&&ia!==u.localLogicalOperation.isNull&&!ua.has(ia)&&(za=x.createEmptyBand(ma,wa.length),ja||=(new Uint8Array(wa.length)).fill(255),sa(wa,ja,ma,za),wa=za);ba.push(wa)}Z=Z[0];return new x({width:Z.width,height:Z.height,pixelType:ma,mask:ia===u.localLogicalOperation.isNull?null:ja,pixels:ba})}const ua=new Map([[u.localTrigonometricOperation.acos,
{domain:[0,Math.PI],isInteger:!1}],[u.localTrigonometricOperation.asin,{domain:[-Math.PI/2,Math.PI/2],isInteger:!1}],[u.localTrigonometricOperation.atan,{domain:[-Math.PI/2,Math.PI/2],isInteger:!1}],[u.localTrigonometricOperation.cos,{domain:[-1,1],isInteger:!1}],[u.localTrigonometricOperation.sin,{domain:[-1,1],isInteger:!1}],[u.localLogicalOperation.booleanAnd,{domain:[0,1],isInteger:!0}],[u.localLogicalOperation.booleanNot,{domain:[0,1],isInteger:!0}],[u.localLogicalOperation.booleanOr,{domain:[0,
1],isInteger:!0}],[u.localLogicalOperation.booleanXOr,{domain:[0,1],isInteger:!0}],[u.localLogicalOperation.equalTo,{domain:[0,1],isInteger:!0}],[u.localLogicalOperation.notEqual,{domain:[0,1],isInteger:!0}],[u.localLogicalOperation.greaterThan,{domain:[0,1],isInteger:!0}],[u.localLogicalOperation.greaterThanEqual,{domain:[0,1],isInteger:!0}],[u.localLogicalOperation.lessThan,{domain:[0,1],isInteger:!0}],[u.localLogicalOperation.lessThanEqual,{domain:[0,1],isInteger:!0}],[u.localLogicalOperation.isNull,
{domain:[0,1],isInteger:!0}]]),qa=new Map,xa=new Map,va=new Map,ya=new Map;m.arithmetic=function(Z,ia,ba){ia=[null,1,2,3,23,5,44][ia]??1;return ta(Z,ia,{outputPixelType:ba})};m.getOutputDomain=function(Z){return ua.get(Z)};m.local=ta;m.operandsCount=[0,2,2,2,1,2,1,1,1,1,1,2,2,1,2,2,2,2,1,2,2,1,1,2,2,1,1,1,2,2,1,1,1,2,2,1,1,1,999,999,999,999,999,999,2,1,2,999,1,1,2,1,1,1,999,999,1,1,999,1,1,2,999,999,2,2,999,999,999,999,999,999,999,999,999,999,3,999,3];Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/support/rasterFunctionConstants":function(){define(["exports"],function(m){const x={plus:1,minus:2,times:3,sqrt:4,power:5,abs:10,divide:23,exp:25,exp10:26,exp2:27,int:30,float:32,ln:35,log10:36,log2:37,mod:44,negate:45,roundDown:48,roundUp:49,square:53,floatDivide:64,floorDivide:65},u={bitwiseAnd:11,bitwiseLeftShift:12,bitwiseNot:13,bitwiseOr:14,bitwiseRightShift:15,bitwiseXOr:16,booleanAnd:17,booleanNot:18,booleanOr:19,booleanXOr:20,equalTo:24,greaterThan:28,greaterThanEqual:29,lessThan:33,
lessThanEqual:34,isNull:31,notEqual:46},K={acos:6,asin:7,atan:8,atanh:9,cos:21,cosh:22,sin:51,sinh:52,tan:56,tanh:57,acosh:59,asinh:60,atan2:61},F={majority:38,max:39,mean:40,med:41,min:42,minority:43,range:47,stddev:54,sum:55,variety:58,majorityIgnoreNoData:66,maxIgnoreNoData:67,meanIgnoreNoData:68,medIgnoreNoData:69,minIgnoreNoData:70,minorityIgnoreNoData:71,rangeIgnoreNoData:72,stddevIgnoreNoData:73,sumIgnoreNoData:74,varietyIgnoreNoData:75},T={setNull:50,conditional:78},N={...x,...u,...K,...F,
...T};m.arithmeticOperation={plus:1,minus:2,multiply:3,divide:4,power:5,mod:6};m.bandIndexType={userDefined:0,NDVI:1,SAVI:2,TSAVI:3,MSAVI:4,GEMI:5,PVI:6,GVITM:7,Sultan:8,VARI:9,GNDVI:10,SR:11,NDVIRe:12,SRRe:13,MTVI2:14,RTVICore:15,CIRe:16,CIG:17,NDWI:18,EVI:19,ironOxide:20,ferrousMinerals:21,clayMinerals:22,WNDWI:23,BAI:24,NBR:25,NDBI:26,NDMI:27,NDSI:28,MNDWI:29};m.cellStatisticalOperation=F;m.clippingType={outside:1,inside:2};m.colorRampName={aspect:"Aspect",blackToWhite:"Black to White",blueBright:"Blue Bright",
blueLightToDark:"Blue Light to Dark",blueGreenBright:"Blue-Green Bright",blueGreenLightToDark:"Blue-Green Light to Dark",brownLightToDark:"Brown Light to Dark",brownToBlueGreenDivergingBright:"Brown to Blue Green Diverging, Bright",brownToBlueGreenDivergingDark:"Brown to Blue Green Diverging, Dark",coefficientBias:"Coefficient Bias",coldToHotDiverging:"Cold to Hot Diverging",conditionNumber:"Condition Number",cyanToPurple:"Cyan to Purple",cyanLightToBlueDark:"Cyan-Light to Blue-Dark",distance:"Distance",
elevation1:"Elevation #1",elevation2:"Elevation #2",errors:"Errors",grayLightToDark:"Gray Light to Dark",greenBright:"Green Bright",greenLightToDark:"Green Light to Dark",greenToBlue:"Green to Blue",orangeBright:"Orange Bright",orangeLightToDark:"Orange Light to Dark",partialSpectrum:"Partial Spectrum",partialSpectrum1Diverging:"Partial Spectrum 1 Diverging",partialSpectrum2Diverging:"Partial Spectrum 2 Diverging",pinkToYellowGreenDivergingBright:"Pink to YellowGreen Diverging, Bright",pinkToYellowGreenDivergingDark:"Pink to YellowGreen Diverging, Dark",
precipitation:"Precipitation",prediction:"Prediction",purpleBright:"Purple Bright",purpleToGreenDivergingBright:"Purple to Green Diverging, Bright",purpleToGreenDivergingDark:"Purple to Green Diverging, Dark",purpleBlueBright:"Purple-Blue Bright",purpleBlueLightToDark:"Purple-Blue Light to Dark",purpleRedBright:"Purple-Red Bright",purpleRedLightToDark:"Purple-Red Light to Dark",redBright:"Red Bright",redLightToDark:"Red Light to Dark",redToBlueDivergingBright:"Red to Blue Diverging, Bright",redToBlueDivergingDark:"Red to Blue Diverging, Dark",
redToGreen:"Red to Green",redToGreenDivergingBright:"Red to Green Diverging, Bright",redToGreenDivergingDark:"Red to Green Diverging, Dark",slope:"Slope",spectrumFullBright:"Spectrum-Full Bright",spectrumFullDark:"Spectrum-Full Dark",spectrumFullLight:"Spectrum-Full Light",surface:"Surface",temperature:"Temperature",whiteToBlack:"White to Black",yellowToDarkRed:"Yellow to Dark Red",yellowToGreenToDarkBlue:"Yellow to Green to Dark Blue",yellowToRed:"Yellow to Red",yellowGreenBright:"Yellow-Green Bright",
yellowGreenLightToDark:"Yellow-Green Light to Dark"};m.colormapName={random:"Random",NDVI:"NDVI",NDVI2:"NDVI2",NDVI3:"NDVI3",elevation:"Elevation",gray:"Gray",hillshade:"Hillshade"};m.computeChangeMethod={difference:0,relativeDifference:1,categorical:2,spectralEuclidianDistance:3,spectralAngleDifference:4,bandWithMostChange:5};m.convolutionKernel={userDefined:-1,lineDetectionHorizontal:0,lineDetectionVertical:1,lineDetectionLeftDiagonal:2,lineDetectionRightDiagonal:3,gradientNorth:4,gradientWest:5,
gradientEast:6,gradientSouth:7,gradientNorthEast:8,gradientNorthWest:9,smoothArithmeticMean:10,smoothing3x3:11,smoothing5x5:12,sharpening3x3:13,sharpening5x5:14,laplacian3x3:15,laplacian5x5:16,sobelHorizontal:17,sobelVertical:18,sharpen:19,sharpen2:20,pointSpread:21,none:255};m.curvatureType={standard:0,platform:1,profile:2};m.localArithmeticOperation=x;m.localConditionalOperation=T;m.localLogicalOperation=u;m.localOperators=N;m.localTrigonometricOperation=K;m.missingBandAction={bestMatch:0,fail:1};
m.noDataInterpretation={matchAny:0,matchAll:1};m.slopeType={degree:1,percentRise:2,adjusted:3};m.statisticsType={min:1,max:2,mean:3,standardDeviation:4,median:5,majority:6,minority:7};m.stretchType={none:0,standardDeviation:3,histogramEqualization:4,minMax:5,percentClip:6,sigmoid:9};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/AspectFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./AspectFunctionArguments ./BaseRasterFunction ./surfaceUtils".split(" "),
function(m,x,u,K,F,T,N,M,H){u=class extends M{constructor(){super(...arguments);this.functionName="Aspect";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.isGCS=!1}_bindSourceRasters(){var v=this.sourceRasterInfos[0];this.isGCS=v.spatialReference?.isGeographic??!1;this.outputPixelType=this._getOutputPixelType("f32");v=v.clone();v.pixelType=this.outputPixelType;v.statistics=[{min:-1,max:360,avg:180,stddev:30}];v.histograms=null;v.colormap=null;v.attributeTable=null;v.bandCount=
1;this.rasterInfo=v;return{success:!0,supportsGPU:!0}}_processPixels(v){const n=v.pixelBlocks?.[0];if(null==n)return null;const {extent:e,primaryPixelSizes:g}=v;v=g?.[0];return H.aspect(n,{resolution:null==v?e?{x:e.width/n.width,y:e.height/n.height}:{x:1,y:1}:v})}};m.__decorate([x.property({json:{write:!0,name:"rasterFunction"}})],u.prototype,"functionName",void 0);m.__decorate([x.property({type:N,json:{write:!0,name:"rasterFunctionArguments"}})],u.prototype,"functionArguments",void 0);m.__decorate([x.property()],
u.prototype,"rasterArgumentNames",void 0);m.__decorate([x.property({json:{write:!0}})],u.prototype,"isGCS",void 0);return u=m.__decorate([T.subclass("esri.layers.support.rasterFunctions.AspectFunction")],u)})},"esri/layers/support/rasterFunctions/AspectFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/Logger ../../../core/has ../../../core/RandomLCG ../../../core/Error ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),function(m,x,u,
K,F,T,N){var M;x=M=class extends N{clone(){return new M({raster:this.raster})}};return x=M=m.__decorate([T.subclass("esri.layers.support.rasterFunctions.AspectFunctionArguments")],x)})},"esri/layers/support/rasterFunctions/surfaceUtils":function(){define(["exports","../PixelBlock","../SimpleBandStatistics","./pixelUtils"],function(m,x,u,K){function F(H){let {altitude:v,azimuth:n}=H;const {hillshadeType:e,pixelSizePower:g=1,pixelSizeFactor:k=1,scalingType:y,isGCS:h,resolution:B}=H;var D="multi-directional"===
e?2*H.zFactor:H.zFactor;const {x:E,y:a}=B;H=D/(8*E);var d=D/(8*a);h&&.001<D&&(H/=M,d/=M);"adjusted"===y&&(h?(H=E*M,d=a*M,H=(D+H**g*k)/(8*H),d=(D+d**g*k)/(8*d)):(H=(D+E**g*k)/(8*E),d=(D+a**g*k)/(8*a)));var c=(90-v)*Math.PI/180;D=Math.cos(c);let b=(360-n+90)*Math.PI/180,f=Math.sin(c)*Math.cos(b);c=Math.sin(c)*Math.sin(b);const l=[315,270,225,360,180,0],r=[60,60,60,60,60,90];var q=new Float32Array([3,5,3,2,1,4]);const w=q.reduce((R,J)=>R+J);q=q.map(R=>R/w);const p="multi-directional"===e?l.length:1,
z=new Float32Array(6),I=new Float32Array(6),G=new Float32Array(6);if("multi-directional"===e)for(let R=0;R<p;R++)v=r[R],n=l[R],c=(90-v)*Math.PI/180,D=Math.cos(c),b=(360-n+90)*Math.PI/180,f=Math.sin(c)*Math.cos(b),c=Math.sin(c)*Math.sin(b),z[R]=D,I[R]=f,G[R]=c;else z.fill(D),I.fill(f),G.fill(c);return{resolution:B,factor:[H,d],sinZcosA:f,sinZsinA:c,cosZ:D,sinZcosAs:I,sinZsinAs:G,cosZs:z,weights:q,hillshadeType:["traditional","multi-directional"].indexOf(e)}}function T(H,v){const {width:n,height:e}=
H;var g=n*e;const k=new Uint8Array(g),y=null!=H.mask;let h;if(y){h=new Uint8Array(H.mask);for(var B=0;B<h.length;B++)h[B]&&(k[B]=1,h[B]=1)}H=H.pixels[0];B=new Float32Array(g);const D=new Float32Array(g);let E=0;if(v){({resolution:a}=v);var a=a?(a.x+a.y)/2:1;E=200*v.zFactor/(a*a);a=new Float32Array(g)}v=v?.curvatureType;let d;let c;for(g=1;g<e-1;g++){const z=g*n;for(let I=1;I<n-1;I++){const G=z+I;if(!h||0!==h[G]){if(h){if(7>h[G-n-1]+h[G-n]+h[G-n+1]+h[G-1]+h[G+1]+h[G+n-1]+h[G+n]+h[G+n+1]){k[G]=0;continue}var b=
h[G-n-1]?H[G-n-1]:H[G];var f=h[G-n]?H[G-n]:H[G];var l=h[G-n+1]?H[G-n+1]:H[G];var r=h[G-1]?H[G-1]:H[G];var q=h[G+1]?H[G+1]:H[G];d=h[G+n-1]?H[G+n-1]:H[G];var w=h[G+n]?H[G+n]:H[G];c=h[G+n+1]?H[G+n+1]:H[G]}else b=H[G-n-1],f=H[G-n],l=H[G-n+1],r=H[G-1],q=H[G+1],d=H[G+n-1],w=H[G+n],c=H[G+n+1];B[G]=l+q+q+c-(b+r+r+d);D[G]=d+w+w+c-(b+f+f+l);if(null!=a){var p=H[G];const R=.5*(r+q)-p;p=.5*(f+w)-p;"standard"===v?a[G]=-E*(R+p):(b=(-b+l+d-c)/4,r=(-r+q)/2,f=(f-w)/2,w=r*r,q=f*f,(l=w+q)&&(a[G]="profile"===v?E*(R*w+
p*q+b*r*f)/l:-E*(R*q+p*w-b*r*f)/l))}}}}return{outMask:y?k:null,dzxs:B,dzys:D,curvatures:a}}function N(H,v,n){for(var e=0;e<n;e++)H[e*v]=H[e*v+1],H[(e+1)*v-1]=H[(e+1)*v-2];for(e=1;e<v-1;e++)H[e]=H[e+v],H[e+(n-1)*v]=H[e+(n-2)*v]}const M=1/111E3;m.aspect=function(H,v={}){if(!K.isValidPixelBlock(H))return H;var {resolution:n}=v;v=n?1/n.x:1;n=n?1/n.y:1;const {dzxs:e,dzys:g,outMask:k}=T(H),{width:y,height:h}=H,B=new Float32Array(y*h);for(let E=1;E<h-1;E++){const a=E*y;for(let d=1;d<y-1;d++){var D=a+d;if(!k||
k[D]){const c=e[D]*v;D=g[D]*n;let b=-1;if(0!==c||0!==D)b=90-57.29578*Math.atan2(D,-c),0>b&&(b+=360),360===b?b=0:360<b&&(b%=360);B[a+d]=b}}}N(B,y,h);return new x({width:y,height:h,pixels:[B],mask:k,pixelType:"f32",validPixelCount:H.validPixelCount,statistics:[new u.SimpleBandStatistics(-1,360)]})};m.calculateHillshadeParams=F;m.curvature=function(H,v){if(!K.isValidPixelBlock(H))return H;const {curvatures:n,outMask:e}=T(H,v),{width:g,height:k}=H;N(n,g,k);H=new x({width:g,height:k,pixels:[n],mask:e,
pixelType:"f32",validPixelCount:H.validPixelCount});H.updateStatistics();return H};m.gcsFactor=M;m.hillshade=function(H,v){if(!K.isValidPixelBlock(H))return H;const {factor:n,sinZcosA:e,sinZsinA:g,cosZ:k,sinZcosAs:y,sinZsinAs:h,cosZs:B,weights:D}=F(v),[E,a]=n;v="traditional"===v.hillshadeType;const {width:d,height:c}=H,b=new Uint8Array(d*c),{dzxs:f,dzys:l,outMask:r}=T(H);for(let w=1;w<c-1;w++){const p=w*d;for(let z=1;z<d-1;z++){const I=p+z;if(!r||r[I]){var q=f[I]*E;const G=l[I]*a,R=Math.sqrt(1+q*
q+G*G);let J=0;if(v)q=255*(k+g*G-e*q)/R,0>q&&(q=0),J=q;else{const V=h.length;for(let A=0;A<V;A++){let C=255*(B[A]+h[A]*G-y[A]*q)/R;0>C&&(C=0);J+=C*D[A]}}b[I]=J&255}}}N(b,d,c);return new x({width:d,height:c,pixels:[b],mask:r,pixelType:"u8",validPixelCount:H.validPixelCount,statistics:[new u.SimpleBandStatistics(0,255)]})};m.slope=function(H,v){if(!K.isValidPixelBlock(H))return H;var n=v.zFactor,e=v.pixelSizePower??1,g=v.pixelSizeFactor??1;const k=v.slopeType;var y=v.isGCS;const {x:h,y:B}=v.resolution;
v=n/(8*h);let D=n/(8*B);y&&1E-4>Math.abs(n-1)&&(v/=M,D/=M);"adjusted"===k&&(v=(n+h**e*g)/(8*h),D=(n+B**e*g)/(8*B));const {dzxs:E,dzys:a,outMask:d}=T(H),{width:c,height:b}=H;n=new Float32Array(c*b);for(e=1;e<b-1;e++)for(g=e*c,y=1;y<c-1;y++){var f=g+y;if(!d||d[f]){var l=E[f]*v;f=a[f]*D;l=Math.sqrt(l*l+f*f);n[g+y]="percent-rise"===k?100*l:57.2957795*Math.atan(l)}}N(n,c,b);H=new x({width:c,height:b,pixels:[n],mask:d,pixelType:"f32",validPixelCount:H.validPixelCount});H.updateStatistics();return H};m.tintHillshade=
function(H,v,n,e){if(K.isValidPixelBlock(H)&&K.isValidPixelBlock(v)){var {min:g,max:k}=e;e=H.pixels[0];var {pixels:y,mask:h}=v;v=y[0];var B=255.00001/(k-g),D=new Uint8ClampedArray(v.length),E=new Uint8ClampedArray(v.length),a=new Uint8ClampedArray(v.length),d=n.length-1;for(let f=0;f<v.length;f++){if(h&&0===h[f])continue;var c=Math.floor((v[f]-g)*B);const [l,r]=n[0>c?0:c>d?d:c];var b=e[f];c=b*r;const q=c*(1-Math.abs(l%2-1));b-=c;switch(Math.floor(l)){case 0:D[f]=c+b;E[f]=q+b;a[f]=b;break;case 1:D[f]=
q+b;E[f]=c+b;a[f]=b;break;case 2:D[f]=b;E[f]=c+b;a[f]=q+b;break;case 3:D[f]=b;E[f]=q+b;a[f]=c+b;break;case 4:D[f]=q+b;E[f]=b;a[f]=c+b;break;case 5:case 6:D[f]=c+b,E[f]=b,a[f]=q+b}}H.pixels=[D,E,a];H.updateStatistics()}};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/BandArithmeticFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BandArithmeticFunctionArguments ./bandIndexUtils ./BaseRasterFunction".split(" "),
function(m,x,u,K,F,T,N,M,H){const v=new Set(["vari","mtvi2","rtvi-core","evi"]);u=class extends H{constructor(){super(...arguments);this.functionName="BandArithmetic";this.functionArguments=null;this.rasterArgumentNames=["raster"]}_bindSourceRasters(){this.outputPixelType=this._getOutputPixelType("f32");var n=this.sourceRasterInfos[0];if(2>n.bandCount)return{success:!1,supportsGPU:!1,error:"band-arithmetic-function: source raster has insufficient amount of raster bands"};n=n.clone();n.pixelType=this.outputPixelType;
n.bandCount="sultan"===this.functionArguments.method?3:1;this._removeStatsHistColormapVAT(n);n.keyProperties={...n.keyProperties,BandProperties:void 0};this.rasterInfo=n;return{success:!0,supportsGPU:!["custom","gvitm","sultan"].includes(this.functionArguments.method)}}_processPixels(n){n=n.pixelBlocks?.[0];if(null==n)return n;const {method:e,bandIndexes:g}=this.functionArguments,k=g.split(" ").map(y=>parseFloat(y));return M.calculateBandIndex(n,{method:e,bandIndexes:k,equation:g})}_getWebGLParameters(){const n=
this.functionArguments.bandIndexes.split(" ").map(y=>parseFloat(y)-1);2===n.length&&n.push(0);var e=this.isInputBandIdsSwizzled?[0,1,2]:n;const g=new Float32Array(3);({method:k}=this.functionArguments);switch(k){case "gndvi":case "nbr":case "ndbi":case "ndvi":case "ndvi-re":case "ndsi":case "ndmi":case "mndwi":e=M.getBandMatrix3([e[0],e[1],0]);var k="ndxi";break;case "ndwi":e=M.getBandMatrix3([e[1],e[0],0]);k="ndxi";break;case "sr":case "sr-re":case "iron-oxide":case "ferrous-minerals":case "clay-minerals":e=
M.getBandMatrix3([e[0],e[1],0]);k="sr";break;case "ci-g":case "ci-re":e=M.getBandMatrix3([e[0],e[1],0]);k="ci";break;case "savi":e=M.getBandMatrix3([e[0],e[1],0]);k="savi";g[0]=n[2]+1;break;case "tsavi":e=M.getBandMatrix3([e[0],e[1],0]);k="tsavi";g[0]=n[2]+1;g[1]=n[3]+1;g[2]=n[4]+1;break;case "msavi":e=M.getBandMatrix3([e[0],e[1],0]);k="msavi";break;case "gemi":e=M.getBandMatrix3([e[0],e[1],0]);k="gemi";break;case "pvi":e=M.getBandMatrix3([e[0],e[1],0]);k="tsavi";g[0]=n[2]+1;g[1]=n[3]+1;break;case "vari":e=
M.getBandMatrix3([e[0],e[1],e[2]]);k="vari";break;case "mtvi2":e=M.getBandMatrix3([e[0],e[1],e[2]]);k="mtvi";break;case "rtvi-core":e=M.getBandMatrix3([e[0],e[1],e[2]]);k="rtvicore";break;case "evi":e=M.getBandMatrix3([e[0],e[1],e[2]]);k="evi";break;case "wndwi":e=M.getBandMatrix3([e[0],e[1],0]);k="wndwi";g[0]=n[3]?n[3]+1:.5;break;case "bai":e=M.getBandMatrix3([e[1],e[0],0]);k="bai";break;default:e=M.getBandMatrix3([0,1,2]),k="custom"}return{bandIndexMat3:e,indexType:k,adjustments:g}}_getInputBandIds(n){if("custom"===
this.functionArguments.method)return n;var e=this.functionArguments.bandIndexes.split(" ").map(y=>parseFloat(y)-1);const g=n.length;e=e.map(y=>y>=g?g-1:y);const k=v.has(this.functionArguments.method)?3:2;e=e.slice(0,k).map(y=>n[y]);2===e.length&&e.push(0);return e}};m.__decorate([x.property({json:{write:!0,name:"rasterFunction"}})],u.prototype,"functionName",void 0);m.__decorate([x.property({type:N,json:{write:!0,name:"rasterFunctionArguments"}})],u.prototype,"functionArguments",void 0);m.__decorate([x.property()],
u.prototype,"rasterArgumentNames",void 0);return u=m.__decorate([T.subclass("esri.layers.support.rasterFunctions.BandArithmeticFunction")],u)})},"esri/layers/support/rasterFunctions/BandArithmeticFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./bandIndexUtils ./BaseFunctionArguments".split(" "),
function(m,x,u,K,F,T,N,M,H){var v;K=v=class extends H{constructor(){super(...arguments);this.method="custom"}clone(){return new v({method:this.method,bandIndexes:this.bandIndexes,raster:x.clone(this.raster)})}};m.__decorate([u.property({json:{type:String,write:!0}})],K.prototype,"bandIndexes",void 0);m.__decorate([T.enumeration(M.bandIndexMethodMap)],K.prototype,"method",void 0);return K=v=m.__decorate([N.subclass("esri.layers.support.rasterFunctions.BandArithmeticFunctionArguments")],K)})},"esri/core/accessorSupport/decorators/enumeration":function(){define(["exports",
"../../jsonMap","./property"],function(m,x,u){m.enumeration=function(K,F={}){K=K instanceof x.JSONMap?K:new x.JSONMap(K,F);K={type:F?.ignoreUnknown??!0?K.apiValues:String,json:{type:K.jsonValues,read:F?.readOnly?!1:{reader:K.read},write:{writer:K.write}}};void 0!==F?.readOnly&&(K.readOnly=!!F.readOnly);void 0!==F?.default&&(K.json.default=F.default);void 0!==F?.name&&(K.json.name=F.name);void 0!==F?.nonNullable&&(K.nonNullable=F.nonNullable);return u.property(K)};Object.defineProperty(m,Symbol.toStringTag,
{value:"Module"})})},"esri/layers/support/rasterFunctions/bandIndexUtils":function(){define(["exports","../../../core/jsonMap","../PixelBlock","./customBandIndexUtils","./pixelUtils"],function(m,x,u,K,F){function T(c,b,f){const l=f.length,r=new Float32Array(l);for(let q=0;q<l;q++)if(null==c||c[q]){const w=b[q],p=f[q],z=w+p;z&&(r[q]=(w-p)/z)}return[r]}function N(c,b,f){const l=f.length,r=new Float32Array(l);for(let q=0;q<l;q++)if(null==c||c[q]){const w=b[q],p=f[q];p&&(r[q]=w/p)}return[r]}function M(c,
b,f){const l=b.length,r=new Float32Array(l);for(let q=0;q<l;q++)if(null==c||c[q]){const w=b[q],p=f[q];p&&(r[q]=w/p-1)}return[r]}function H(c,b,f,l){const r=f.length,q=new Float32Array(r);for(let w=0;w<r;w++)if(null==c||c[w]){const p=f[w],z=b[w],I=z+p+l;I&&(q[w]=(z-p)/I*(1+l))}return[q]}function v(c,b,f,l,r,q){const w=f.length,p=new Float32Array(w);q=-r*l+q*(1+l*l);for(let z=0;z<w;z++)if(null==c||c[z]){const I=f[z],G=b[z],R=r*G+I+q;R&&(p[z]=l*(G-l*I-r)/R)}return[p]}function n(c,b,f){const l=f.length,
r=new Float32Array(l);for(let q=0;q<l;q++)if(null==c||c[q]){const w=b[q],p=2*w+1;r[q]=.5*(p-Math.sqrt(p*p-8*(w-f[q])))}return[r]}function e(c,b,f){const l=f.length,r=new Float32Array(l);for(let w=0;w<l;w++)if(null==c||c[w]){const p=f[w];var q=b[w];1!==p&&0!==q+p+.5&&(q=(2*(q*q-p*p)+1.5*q+.5*p)/(q+p+.5),r[w]=q*(1-.25*q)-(p-.125)/(1-p))}return[r]}function g(c,b,f,l,r){const q=f.length,w=new Float32Array(q),p=1/Math.sqrt(1+l*l);for(let z=0;z<q;z++)if(null==c||c[z])w[z]=(b[z]-l*f[z]-r)*p;return[w]}function k(c,
b){const [f,l,r,q,w,p]=b;b=f.length;const z=new Float32Array(b);for(let I=0;I<b;I++)if(null==c||c[I])z[I]=-.2848*f[I]-.2435*l[I]-.5436*r[I]+.7243*q[I]+.084*w[I]-.18*p[I];return[z]}function y(c,b){const [f,l,r,q,w]=b;b=f.length;const p=new Float32Array(b),z=new Float32Array(b),I=new Float32Array(b);for(let G=0;G<b;G++)if(null==c||c[G])p[G]=w[G]?q[G]/w[G]*100:0,z[G]=f[G]?q[G]/f[G]*100:0,I[G]=r[G]?l[G]/r[G]*(q[G]/r[G])*100:0;return[p,z,I]}function h(c,b){const [f,l,r]=b;b=f.length;const q=new Float32Array(b);
for(let w=0;w<b;w++)if(null==c||c[w])for(w=0;w<b;w++){const p=f[w],z=l[w],I=z+p-r[w];I&&(q[w]=(z-p)/I)}return[q]}function B(c,b){const [f,l,r]=b;b=f.length;const q=new Float32Array(b);for(let w=0;w<b;w++)if(null==c||c[w])for(w=0;w<b;w++){const p=f[w],z=l[w],I=r[w],G=Math.sqrt((2*p+1)**2-(6*p-5*Math.sqrt(z))-.5);G&&(q[w]=1.5*(1.2*(p-I)-2.5*(z-I))/G)}return[q]}function D(c,b){const [f,l,r]=b;b=f.length;const q=new Float32Array(b);for(let w=0;w<b;w++)if(null==c||c[w])for(w=0;w<b;w++){const p=f[w];q[w]=
100*(p-l[w])-10*(p-r[w])}return[q]}function E(c,b){const [f,l,r]=b;b=f.length;const q=new Float32Array(b);for(let w=0;w<b;w++)if(null==c||c[w])for(w=0;w<b;w++){const p=f[w],z=l[w],I=p+6*z-7.5*r[w]+1;I&&(q[w]=2.5*(p-z)/I)}return[q]}function a(c,b,f=.5){const [l,r,q]=b;b=r.length;const w=new Float32Array(b);for(let p=0;p<b;p++)if(null==c||c[p])for(p=0;p<b;p++){const z=l[p],I=r[p],G=q[p],R=z+f*I+(1-f)*G;R&&(w[p]=(z-f*I-(1-f)*G)/R)}return[w]}function d(c,b,f){const l=f.length,r=new Float32Array(l);for(let q=
0;q<l;q++)if(null==c||c[q])for(q=0;q<l;q++){const w=(.1-b[q])**2+(.06-f[q])**2;w&&(r[q]=1/w)}return[r]}x=new x.JSONMap({0:"custom",1:"ndvi",2:"savi",3:"tsavi",4:"msavi",5:"gemi",6:"pvi",7:"gvitm",8:"sultan",9:"vari",10:"gndvi",11:"sr",12:"ndvi-re",13:"sr-re",14:"mtvi2",15:"rtvi-core",16:"ci-re",17:"ci-g",18:"ndwi",19:"evi",20:"iron-oxide",21:"ferrous-minerals",22:"clay-minerals",23:"wndwi",24:"bai",25:"nbr",26:"ndbi",27:"ndmi",28:"ndsi",29:"mndwi"},{useNumericKeys:!0});m.bandIndexMethodMap=x;m.calculateBandIndex=
function(c,b){if(!F.isValidPixelBlock(c))return c;const {equation:f,method:l}=b;b=b.bandIndexes.map(p=>p-1);const {pixels:r,mask:q}=c;switch(l){case "gndvi":case "nbr":case "ndbi":case "ndvi":case "ndvi-re":case "ndsi":case "ndmi":case "mndwi":b=T(q,r[b[0]],r[b[1]]);break;case "ndwi":b=T(q,r[b[1]],r[b[0]]);break;case "sr":case "sr-re":case "iron-oxide":case "ferrous-minerals":case "clay-minerals":b=N(q,r[b[0]],r[b[1]]);break;case "ci-g":case "ci-re":b=M(q,r[b[0]],r[b[1]]);break;case "savi":b=H(q,
r[b[0]],r[b[1]],b[2]+1);break;case "tsavi":b=v(q,r[b[0]],r[b[1]],b[2]+1,b[3]+1,b[4]+1);break;case "msavi":b=n(q,r[b[0]],r[b[1]]);break;case "gemi":b=e(q,r[b[0]],r[b[1]]);break;case "pvi":b=g(q,r[b[0]],r[b[1]],b[2]+1,b[3]+1);break;case "gvitm":b=k(q,[r[b[0]],r[b[1]],r[b[2]],r[b[3]],r[b[4]],r[b[5]]]);break;case "sultan":b=y(q,[r[b[0]],r[b[1]],r[b[2]],r[b[3]],r[b[4]]]);break;case "vari":b=h(q,[r[b[0]],r[b[1]],r[b[2]]]);break;case "mtvi2":b=B(q,[r[b[0]],r[b[1]],r[b[2]]]);break;case "rtvi-core":b=D(q,
[r[b[0]],r[b[1]],r[b[2]]]);break;case "evi":b=E(q,[r[b[0]],r[b[1]],r[b[2]]]);break;case "wndwi":b=a(q,[r[b[0]],r[b[1]],r[b[2]]],b[3]?b[3]+1:.5);break;case "bai":b=d(q,r[b[0]],r[b[1]]);break;case "custom":b=K.calculateCustomBandIndex(q,r,f);break;default:return c}const w=null!=q?new Uint8Array(q.length):null;null!=q&&null!=w&&w.set(q);c=new u({width:c.width,height:c.height,pixelType:"f32",pixels:b,mask:w});c.updateStatistics();return c};m.calculateNDVI=function(c,b,f,l){const {mask:r,pixels:q,width:w,
height:p}=c;c=q[f];b=q[b];f=b.length;const z=l?new Uint8Array(f):new Float32Array(f),I=l?100:1,G=l?100.5:0;for(let R=0;R<f;R++)if(null==r||r[R]){const J=c[R],V=b[R],A=J+V;A&&(z[R]=(J-V)/A*I+G)}l=new u({width:w,height:p,mask:r,pixelType:l?"u8":"f32",pixels:[z]});l.updateStatistics();return l};m.getBandMatrix3=function(c){const b=new Float32Array(9);b[3*c[0]]=1;b[3*c[1]+1]=1;b[3*c[2]+2]=1;return b};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/customBandIndexUtils":function(){define(["exports",
"../../../core/has"],function(m,x){function u(F,T){return F.toLowerCase().startsWith("b")?T[parseInt(F.slice(1),10)-1]:parseFloat(F)}const K=new Set("+-*/()".split(""));m.calculateCustomBandIndex=function(F,T,N){N=N.replaceAll(" ","");N.startsWith("-")&&(N="0"+N);N.startsWith("+")&&(N=N.slice(1,N.length));N=N.split("");var M=[],H=[],v="";for(var n=0;n<N.length;n++){const y=N[n];K.has(y)?(v.length&&H.push(u(v,T)),M.push(y),v=""):v=v.concat(y)}v.length&&H.push(u(v,T));let {ops:e,nums:g}={ops:M,nums:H};
if(0===e.length){F=1===g.length?g[0]:T[0];if(F instanceof Float32Array)return[F];var k=new Float32Array(T[0].length);"number"===typeof F?k.fill(F):k.set(F);return[k]}for(;0<e.length;){k=e;if(1===k.length)k={opIndex:0,numIndex:0};else{M=N=0;for(T=0;T<k.length;T++)if("("===k[T])N=T;else if(")"===k[T]){M=T;break}H=0===M?k:k.slice(N+1,M);T=-1;for(v=0;v<H.length;v++)if("*"===H[v]||"/"===H[v]){T=v;break}if(!(-1<T))for(v=0;v<H.length;v++)if("+"===H[v]||"-"===H[v]){T=v;break}0<M&&(T+=N+1);N=0;for(M=0;M<T;M++)"("===
k[M]&&N++;k={opIndex:T,numIndex:T-N}}const {numIndex:y,opIndex:h}=k;M=N=T=void 0;k=F;v=e[h];H=g[y];n=g[y+1];if("number"===typeof H&&"number"===typeof n)k=H+n;else{"number"===typeof H?(T=n,M=T.length,N=new Float32Array(M),N.fill(H)):(M=H.length,N=H,n.constructor===Number?(T=new Float32Array(M),T.fill(n)):T=n);H=new Float32Array(M);switch(v){case "+":for(v=0;v<M;v++)if(null==k||k[v])H[v]=N[v]+T[v];break;case "-":for(v=0;v<M;v++)if(null==k||k[v])H[v]=N[v]-T[v];break;case "*":for(v=0;v<M;v++)if(null==
k||k[v])H[v]=N[v]*T[v];break;case "/":for(v=0;v<M;v++)(null==k||k[v])&&T[v]&&(H[v]=N[v]/T[v]);break;case "(":case ")":throw Error("encountered error with custom band index equation");}k=H}if(1===e.length)break;else{T=e;T.splice(h,1);M=N=0;do{M=N=0;for(H=0;H<T.length;H++)if("("===T[H])N=H;else if(")"===T[H]){M=H;break}M===N+1&&T.splice(N,2)}while(M===N+1);e=T;g.splice(y,2,k)}}return[k]};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/ClipFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./ClipFunctionArguments".split(" "),
function(m,x,u,K,F,T,N,M){u=class extends N{constructor(){super(...arguments);this.functionName="Clip";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.isNoopProcess=!0}_bindSourceRasters(){const H=this.sourceRasterInfos[0].clone();this.outputPixelType=this._getOutputPixelType(H.pixelType);H.pixelType=this.outputPixelType;this.rasterInfo=H;return{success:!0,supportsGPU:!0}}_processPixels(H){return H.pixelBlocks?.[0]}_getWebGLParameters(){const {clippingGeometry:H,clippingType:v}=
this.functionArguments;return{clippingGeometry:H.toJSON(),clippingType:v}}};m.__decorate([x.property({json:{write:!0,name:"rasterFunction"}})],u.prototype,"functionName",void 0);m.__decorate([x.property({type:M,json:{write:!0,name:"rasterFunctionArguments"}})],u.prototype,"functionArguments",void 0);m.__decorate([x.property()],u.prototype,"rasterArgumentNames",void 0);m.__decorate([x.property()],u.prototype,"isNoopProcess",void 0);return u=m.__decorate([T.subclass("esri.layers.support.rasterFunctions.ClipFunction")],
u)})},"esri/layers/support/rasterFunctions/ClipFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../geometry ../../../core/jsonMap ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../../geometry/support/jsonUtils ./BaseFunctionArguments".split(" "),function(m,x,u,K,F,T,N,M,H,v){var n;u=new u.JSONMap({1:"outside",2:"inside"},{useNumericKeys:!0});v=n=class extends v{constructor(){super(...arguments);
this.clippingType="outside"}clone(){return new n({clippingGeometry:this.clippingGeometry.clone(),clippingType:this.clippingType})}};m.__decorate([K.property({types:x.geometryTypes,json:{read:H.fromJSON,write:!0}})],v.prototype,"clippingGeometry",void 0);m.__decorate([K.property({json:{read:u.read,write:u.write}})],v.prototype,"clippingType",void 0);return v=n=m.__decorate([M.subclass("esri.layers.support.rasterFunctions.ClipFunctionArguments")],v)})},"esri/layers/support/rasterFunctions/ColormapFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./ColormapFunctionArguments ./colormaps ../../../renderers/support/colorRampUtils ../../../rest/support/colorRamps".split(" "),
function(m,x,u,K,F,T,N,M,H,v,n,e){u=class extends M{constructor(){super(...arguments);this.functionName="Colormap";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.isNoopProcess=!0}_bindSourceRasters(){var g=this.sourceRasterInfos[0];if(1<g.bandCount)return{success:!1,supportsGPU:!1,error:"colormap-function: source data must be single band"};let {colormap:k,colormapName:y,colorRamp:h,colorRampName:B}=this.functionArguments;if(!k?.length)if(h)this.colorRamp=h,k=n.convertColorRampToColormap(h,
{interpolateAlpha:!0});else if(B){var D=n.getColorRampJSON(B);D&&(k=n.convertColorRampToColormap(D),this.colorRamp=e.fromJSON(D))}else y&&(k=v.getColormapByName(y));if(!k?.length)return{success:!1,supportsGPU:!1,error:"colormap-function: missing colormap argument"};D=this._getOutputPixelType(g.pixelType);this.outputPixelType=D.startsWith("f")?"s32":D;g=g.clone();g.pixelType=this.outputPixelType;g.colormap=k;g.bandCount=1;this.rasterInfo=g;return{success:!0,supportsGPU:!0}}_processPixels(g){g=g.pixelBlocks?.[0];
if(!g||N.isIntegerPixelType(g.pixelType))return g;g=g.clone();g.clamp(this.outputPixelType);return g}};m.__decorate([x.property({json:{write:!0,name:"rasterFunction"}})],u.prototype,"functionName",void 0);m.__decorate([x.property({type:H,json:{write:!0,name:"rasterFunctionArguments"}})],u.prototype,"functionArguments",void 0);m.__decorate([x.property()],u.prototype,"rasterArgumentNames",void 0);m.__decorate([x.property()],u.prototype,"isNoopProcess",void 0);m.__decorate([x.property({json:{write:!0}})],
u.prototype,"indexedColormap",void 0);m.__decorate([x.property()],u.prototype,"colorRamp",void 0);return u=m.__decorate([T.subclass("esri.layers.support.rasterFunctions.ColormapFunction")],u)})},"esri/layers/support/rasterFunctions/ColormapFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/cast ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ../../../renderers/support/colorRampUtils ../../../rest/support/colorRamps".split(" "),
function(m,x,u,K,F,T,N,M,H){var v;N=v=class extends N{castColormapName(n){if(!n)return null;n=n.toLowerCase();return M.rasterColormapNames.includes(n)?n:null}readColorRamp(n){return H.fromJSON(n)}readColorRampName(n,e){return n?(e=M.colorRampDict.jsonValues.find(g=>g.toLowerCase()===n.toLowerCase()))?M.colorRampDict.fromJSON(e):null:null}clone(){return new v({colormap:x.clone(this.colormap),colormapName:this.colormapName,colorRamp:this.colorRamp?.clone(),colorRampName:this.colorRampName})}};m.__decorate([u.property({type:[[Number]],
json:{write:!0}})],N.prototype,"colormap",void 0);m.__decorate([u.property({type:String,json:{write:!0}})],N.prototype,"colormapName",void 0);m.__decorate([K.cast("colormapName")],N.prototype,"castColormapName",null);m.__decorate([u.property({types:H.types,json:{write:!0}})],N.prototype,"colorRamp",void 0);m.__decorate([F.reader("colorRamp")],N.prototype,"readColorRamp",null);m.__decorate([u.property({type:M.colorRampDict.apiValues,json:{type:M.colorRampDict.jsonValues,write:M.colorRampDict.write}})],
N.prototype,"colorRampName",void 0);m.__decorate([F.reader("colorRampName")],N.prototype,"readColorRampName",null);return N=v=m.__decorate([T.subclass("esri.layers.support.rasterFunctions.ColormapFunctionArguments")],N)})},"esri/renderers/support/colorRampUtils":function(){define(["exports","../../Color","../../core/colorUtils","../../core/jsonMap","../../core/JSONSupport"],function(m,x,u,K,F){function T(a,d){if(!a||!d||a.length!==d.length)return!1;for(let c=0;c<a.length;c++)if(a[c]>d[c]+2||a[c]<
d[c]-2)return!1;return!0}function N(a){const d=a.clone();d.fromColor=a.toColor;d.toColor=a.fromColor;d.algorithm=a.algorithm;return d}function M(a){if("multipart"===a.type){a=a.clone();if(!a.colorRamps?.length)return a;a.colorRamps=a.colorRamps.reverse().map(d=>N(d));return a}return N(a)}function H(a,d){if(a){d=d??D;var c=null;"algorithmic"===a.type?d.some(b=>{if(T(a.fromColor.toRgb(),b.fromColor)&&T(a.toColor.toRgb(),b.toColor))return c=b.id,!0}):"multipart"===a.type&&d.some(b=>{const f=a.colorRamps,
l=b.colorRamps;if(f&&l&&f.length===l.length&&!l.some((r,q)=>{if(!T(f[q].fromColor.toRgb(),(new x(r.fromColor)).toRgb())||!T(f[q].toColor.toRgb(),(new x(r.toColor)).toRgb()))return!0})){if(c)return!0;c=b.id}});return c}}function v(a,d,c=!1){if(a){var b=!1,f=H(a,d);null!=f||c||(b=!0,a=M(a),f=H(a,d));return f?{id:f,inverted:b}:void 0}}function n(a,d=!1){return(a="string"===typeof a?a:v(a,void 0,d)?.id)?E.toJSON(a):null}function e(a){a=a||{};const d=a.numColors||256;return{...a,numColors:d,distanceOffset:a.distanceOffset||
0,interpolateAlpha:!!a.interpolateAlpha,distanceInterval:a.distanceInterval||1/(d-1),isCustomInterval:null!=a.isCustomInterval?a.isCustomInterval:null!==a.distanceInterval&&a.distanceInterval!==1/(d-1),weights:a.weights}}function g(a,d){let {fromColor:c,toColor:b}=a;c=[...c];b=[...b];3===c.length&&(c=c.concat([255]));3===b.length&&(b=b.concat([255]));a=a.algorithm||"esriCIELabAlgorithm";var f=e(d);const {numColors:l,distanceOffset:r,isCustomInterval:q,interpolateAlpha:w}=f;if(1===l&&0===r)return[c];
if(2===l&&0===r&&!q)return[c,b];var p={r:c[0],g:c[1],b:c[2]};d={r:b[0],g:b[1],b:b[2]};if("esriCIELabAlgorithm"===a){a=u.toLAB(p);d=u.toLAB(d);const {numColors:R,distanceOffset:J,distanceInterval:V,isCustomInterval:A}=f;let {l:C,a:P,b:X}=a;a=(d.l-C)*V;p=(d.a-P)*V;f=(d.b-X)*V;var z=[];if(J){var I=J/V;C+=I*a;P+=I*p;X+=I*f}for(I=0;I<R-1;I++)z.push({l:C,a:P,b:X}),C+=a,P+=p,X+=f;z.push(A?{l:C,a:P,b:X}:d);d=z}else if("esriHSVAlgorithm"===a){a=u.toHSV(p);d=u.toHSV(d);const {numColors:R,distanceOffset:J,distanceInterval:V,
isCustomInterval:A}=f;z=0===a.s;I=0===d.s;p=a.h;f=d.h;z&&!I?p=f:I&&!z&&(d={...d,h:p},f=p);z=Math.abs(f-p);180>z?f=(f-p)*V:(z=360-z,f=p>f?z*V:-z*V);z=(d.s-a.s)*V;I=(d.v-a.v)*V;let {s:C,v:P}=a;a=p;J&&(p=J/V,a=(a+p*f+360)%360,C+=p*z,P+=p*I);p=[];for(var G=0;G<R-1;G++)p.push({h:a,s:C,v:P}),a=(a+f+360)%360,C+=z,P+=I;p.push(A?{h:a,s:C,v:P}:d);d=p}else{p=u.toLCH(p);d=u.toLCH(d);const {numColors:R,distanceOffset:J,distanceInterval:V,isCustomInterval:A}=f;f=p.h;z=d.h;a=2*Math.PI;f<=z?(I=z-f,f=z-f-a,f=Math.abs(f)<
Math.abs(I)?f:I):(I=z+a-f,f=z-f,f=Math.abs(f)<Math.abs(I)?f:I);f*=V;z=(d.l-p.l)*V;I=(d.c-p.c)*V;let {l:C,c:P,h:X}=p;J&&(p=J/V,C+=p*z,P+=p*I,X=(X+p*f+a)%a);p=[];for(G=0;G<R-1;G++)p.push({l:C,c:P,h:X}),C+=z,P+=I,X=(X+f+a)%a;p.push(A?{l:C,c:P,h:X}:d);d=p}a=[];p=c[3]??255;f=((b[3]??255)-p)/(l-1);for(z=0;z<l;z++){const {r:R,g:J,b:V}=u.toRGB(d[z]);a.push([R,J,V,w?Math.round(p+f*z):255])}return a}function k(a,d){const {numColors:c,interpolateAlpha:b}=e(d);d=d?.weights;({colorRamps:a}=a);if(d){const z=d.reduce((I,
G)=>I+G);d=d.map(I=>I/z)}else{d=[];for(var f=0;f<a.length;f++)d[f]=1/a.length}f=[];const l=1/(c-1);let r=0,q=!1;for(let z=0;z<a.length;z++){var w=f.length,p=q?0:w*l-r;r+=d[z];w=z===a.length-1?c-1-w:(d[z]-p)/l;q=Math.ceil(w)===w;w=Math.ceil(w);0!==w&&(p=g(a[z],{numColors:w,interpolateAlpha:b,distanceOffset:p/d[z],distanceInterval:l/d[z]}),f.push(...p))}d=[...a[a.length-1].toColor];3===d.length&&d.push(255);f.push(d);return f}function y(a,d){a=F.isSerializable(a)?a.toJSON():a;return"multipart"===a.type?
k(a,d):g(a,d)}function h(a){a=u.toHSV(a);return{type:"HsvColor",Hue:a.h,Saturation:a.s,Value:a.v,AlphaValue:255}}function B(a){return{Algorithm:a.toJSON()?.Algorithm||"esriHSVAlgorithm",type:"AlgorithmicColorRamp",FromColor:h(a.fromColor),ToColor:h(a.toColor)}}const D=[{id:"aspect",type:"multipart",colorRamps:[{fromColor:[190,190,190],toColor:[255,45,8]},{fromColor:[255,45,8],toColor:[255,181,61]},{fromColor:[255,181,61],toColor:[255,254,52]},{fromColor:[255,254,52],toColor:[0,251,50]},{fromColor:[0,
251,50],toColor:[255,254,52]},{fromColor:[0,253,255],toColor:[0,181,255]},{fromColor:[0,181,255],toColor:[26,35,253]},{fromColor:[26,35,253],toColor:[255,57,251]},{fromColor:[255,57,251],toColor:[255,45,8]}]},{id:"black-to-white",fromColor:[0,0,0],toColor:[255,255,255]},{id:"blue-bright",fromColor:[204,204,255],toColor:[0,0,224]},{id:"blue-light-to-dark",fromColor:[211,229,232],toColor:[46,100,140]},{id:"blue-green-bright",fromColor:[203,245,234],toColor:[48,207,146]},{id:"blue-green-light-to-dark",
fromColor:[216,242,237],toColor:[21,79,74]},{id:"brown-light-to-dark",fromColor:[240,236,170],toColor:[102,72,48]},{id:"brown-to-blue-green-diverging-right",type:"multipart",colorRamps:[{fromColor:[156,85,31],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[33,130,145]}]},{id:"brown-to-blue-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[110,70,45],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[48,100,102]}]},{id:"coefficient-bias",fromColor:[214,214,255],toColor:[0,
57,148]},{id:"cold-to-hot-diverging",type:"multipart",colorRamps:[{fromColor:[69,117,181],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[214,47,39]}]},{id:"condition-number",type:"multipart",colorRamps:[{fromColor:[0,97,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,34,0]}]},{id:"cyan-to-purple",type:"multipart",colorRamps:[{fromColor:[0,245,245],toColor:[0,0,245]},{fromColor:[0,0,245],toColor:[245,0,245]}]},{id:"cyan-light-to-blue-dark",type:"multipart",colorRamps:[{fromColor:[182,
237,240],toColor:[31,131,224]},{fromColor:[31,131,224],toColor:[9,9,145]}]},{id:"distance",fromColor:[255,200,0],toColor:[0,0,255]},{id:"elevation1",type:"multipart",colorRamps:[{fromColor:[175,240,233],toColor:[255,255,179]},{fromColor:[255,255,179],toColor:[0,128,64]},{fromColor:[0,128,64],toColor:[252,186,3]},{fromColor:[252,186,3],toColor:[128,0,0]},{fromColor:[120,0,0],toColor:[105,48,13]},{fromColor:[105,48,13],toColor:[171,171,171]},{fromColor:[171,171,171],toColor:[255,252,255]}]},{id:"elevation2",
type:"multipart",colorRamps:[{fromColor:[118,219,211],toColor:[255,255,199]},{fromColor:[255,255,199],toColor:[255,255,128]},{fromColor:[255,255,128],toColor:[217,194,121]},{fromColor:[217,194,121],toColor:[135,96,38]},{fromColor:[135,96,38],toColor:[150,150,181]},{fromColor:[150,150,181],toColor:[181,150,181]},{fromColor:[181,150,181],toColor:[255,252,255]}]},{id:"errors",fromColor:[255,235,214],toColor:[196,10,10]},{id:"gray-light-to-dark",fromColor:[219,219,219],toColor:[69,69,69]},{id:"green-bright",
fromColor:[204,255,204],toColor:[14,204,14]},{id:"green-light-to-dark",fromColor:[220,245,233],toColor:[34,102,51]},{id:"green-to-blue",type:"multipart",colorRamps:[{fromColor:[32,204,16],toColor:[0,242,242]},{fromColor:[0,242,242],toColor:[2,33,227]}]},{id:"orange-bright",fromColor:[255,235,204],toColor:[240,118,5]},{id:"orange-light-to-dark",fromColor:[250,233,212],toColor:[171,65,36]},{id:"partial-spectrum",type:"multipart",colorRamps:[{fromColor:[242,241,162],toColor:[255,255,0]},{fromColor:[255,
255,0],toColor:[255,0,0]},{fromColor:[252,3,69],toColor:[176,7,237]},{fromColor:[176,7,237],toColor:[2,29,173]}]},{id:"partial-spectrum-1-diverging",type:"multipart",colorRamps:[{fromColor:[135,38,38],toColor:[240,149,12]},{fromColor:[240,149,12],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[74,80,181]},{fromColor:[74,80,181],toColor:[39,32,122]}]},{id:"partial-spectrum-2-diverging",type:"multipart",colorRamps:[{fromColor:[115,77,42],toColor:[201,137,52]},{fromColor:[201,137,52],toColor:[255,
255,191]},{fromColor:[255,255,191],toColor:[91,63,176]},{fromColor:[91,63,176],toColor:[81,13,97]}]},{id:"pink-to-yellow-green-diverging-bright",type:"multipart",colorRamps:[{fromColor:[158,30,113],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[99,110,45]}]},{id:"pink-to-yellow-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[97,47,73],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[22,59,15]}]},{id:"precipitation",type:"multipart",colorRamps:[{fromColor:[194,82,60],
toColor:[237,161,19]},{fromColor:[237,161,19],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,219,0]},{fromColor:[0,219,0],toColor:[32,153,143]},{fromColor:[32,153,143],toColor:[11,44,122]}]},{id:"prediction",type:"multipart",colorRamps:[{fromColor:[40,146,199],toColor:[250,250,100]},{fromColor:[250,250,100],toColor:[232,16,20]}]},{id:"purple-bright",fromColor:[255,204,255],toColor:[199,0,199]},{id:"purple-to-green-diverging-bright",type:"multipart",colorRamps:[{fromColor:[77,32,150],toColor:[255,
255,191]},{fromColor:[255,255,191],toColor:[20,122,11]}]},{id:"purple-to-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[67,14,89],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[24,79,15]}]},{id:"purple-blue-bright",fromColor:[223,184,230],toColor:[112,12,242]},{id:"purple-blue-light-to-dark",fromColor:[229,213,242],toColor:[93,44,112]},{id:"purple-red-bright",fromColor:[255,204,225],toColor:[199,0,99]},{id:"purple-red-light-to-dark",fromColor:[250,215,246],toColor:[143,17,
57]},{id:"red-bright",fromColor:[255,204,204],toColor:[219,0,0]},{id:"red-light-to-dark",fromColor:[255,224,224],toColor:[143,10,10]},{id:"red-to-blue-diverging-bright",type:"multipart",colorRamps:[{fromColor:[196,69,57],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[48,95,207]}]},{id:"red-to-blue-diverging-dark",type:"multipart",colorRamps:[{fromColor:[107,13,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[13,53,97]}]},{id:"red-to-green",type:"multipart",colorRamps:[{fromColor:[245,
0,0],toColor:[245,245,0]},{fromColor:[245,245,0],toColor:[0,245,0]}]},{id:"red-to-green-diverging-bright",type:"multipart",colorRamps:[{fromColor:[186,20,20],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[54,145,33]}]},{id:"red-to-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[97,21,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[16,69,16]}]},{id:"slope",type:"multipart",colorRamps:[{fromColor:[56,168,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,
0,0]}]},{id:"spectrum-full-bright",type:"multipart",colorRamps:[{fromColor:[255,0,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,0,255]}]},{id:"spectrum-full-dark",type:"multipart",colorRamps:[{fromColor:[153,0,0],toColor:[153,153,0]},{fromColor:[153,153,0],toColor:[0,153,153]},{fromColor:[0,153,153],toColor:[0,0,153]}]},{id:"spectrum-full-light",type:"multipart",colorRamps:[{fromColor:[255,153,153],toColor:[255,255,153]},{fromColor:[255,255,
153],toColor:[153,255,255]},{fromColor:[153,255,255],toColor:[153,153,255]}]},{id:"surface",type:"multipart",colorRamps:[{fromColor:[112,153,89],toColor:[242,238,162]},{fromColor:[242,238,162],toColor:[242,206,133]},{fromColor:[242,206,133],toColor:[194,140,124]},{fromColor:[194,140,124],toColor:[255,242,255]}]},{id:"temperature",type:"multipart",colorRamps:[{fromColor:[255,252,255],toColor:[255,0,255]},{fromColor:[255,0,255],toColor:[0,0,255]},{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,
255,255],toColor:[0,255,0]},{fromColor:[0,255,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,128,0]},{fromColor:[255,128,0],toColor:[128,0,0]}]},{id:"white-to-black",fromColor:[255,255,255],toColor:[0,0,0]},{id:"yellow-to-dark-red",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[242,167,46]},{fromColor:[242,167,46],toColor:[107,0,0]}]},{id:"yellow-to-green-to-dark-blue",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[56,224,9]},{fromColor:[56,224,9],toColor:[26,
147,171]},{fromColor:[26,147,171],toColor:[12,16,120]}]},{id:"yellow-to-red",fromColor:[245,245,0],toColor:[255,0,0]},{id:"yellow-green-bright",fromColor:[236,252,204],toColor:[157,204,16]},{id:"yellow-green-light-to-dark",fromColor:[215,240,175],toColor:[96,107,45]}],E=new K.JSONMap({Aspect:"aspect","Black to White":"black-to-white","Blue Bright":"blue-bright","Blue Light to Dark":"blue-light-to-dark","Blue-Green Bright":"blue-green-bright","Blue-Green Light to Dark":"blue-green-light-to-dark","Brown Light to Dark":"brown-light-to-dark",
"Brown to Blue Green Diverging, Bright":"brown-to-blue-green-diverging-right","Brown to Blue Green Diverging, Dark":"brown-to-blue-green-diverging-dark","Coefficient Bias":"coefficient-bias","Cold to Hot Diverging":"cold-to-hot-diverging","Condition Number":"condition-number","Cyan to Purple":"cyan-to-purple","Cyan-Light to Blue-Dark":"cyan-light-to-blue-dark",Distance:"distance","Elevation #1":"elevation1","Elevation #2":"elevation2",Errors:"errors","Gray Light to Dark":"gray-light-to-dark","Green Bright":"green-bright",
"Green Light to Dark":"green-light-to-dark","Green to Blue":"green-to-blue","Orange Bright":"orange-bright","Orange Light to Dark":"orange-light-to-dark","Partial Spectrum":"partial-spectrum","Partial Spectrum 1 Diverging":"partial-spectrum-1-diverging","Partial Spectrum 2 Diverging":"partial-spectrum-2-diverging","Pink to YellowGreen Diverging, Bright":"pink-to-yellow-green-diverging-bright","Pink to YellowGreen Diverging, Dark":"pink-to-yellow-green-diverging-dark",Precipitation:"precipitation",
Prediction:"prediction","Purple Bright":"purple-bright","Purple to Green Diverging, Bright":"purple-to-green-diverging-bright","Purple to Green Diverging, Dark":"purple-to-green-diverging-dark","Purple-Blue Bright":"purple-blue-bright","Purple-Blue Light to Dark":"purple-blue-light-to-dark","Purple-Red Bright":"purple-red-bright","Purple-Red Light to Dark":"purple-red-light-to-dark","Red Bright":"red-bright","Red Light to Dark":"red-light-to-dark","Red to Blue Diverging, Bright":"red-to-blue-diverging-bright",
"Red to Blue Diverging, Dark":"red-to-blue-diverging-dark","Red to Green":"red-to-green","Red to Green Diverging, Bright":"red-to-green-diverging-bright","Red to Green Diverging, Dark":"red-to-green-diverging-dark",Slope:"slope","Spectrum-Full Bright":"spectrum-full-bright","Spectrum-Full Dark":"spectrum-full-dark","Spectrum-Full Light":"spectrum-full-light",Surface:"surface",Temperature:"temperature","White to Black":"white-to-black","Yellow to Dark Red":"yellow-to-dark-red","Yellow to Green to Dark Blue":"yellow-to-green-to-dark-blue",
"Yellow to Red":"yellow-to-red","Yellow-Green Bright":"yellow-green-bright","Yellow-Green Light to Dark":"yellow-green-light-to-dark"});m.colorRampDict=E;m.convertColorRampToColormap=function(a,d){a=y(a,d);const c=d?.interpolateAlpha;a.forEach((b,f)=>{b.unshift(f);c||b.pop()});return a};m.convertColorRampToColors=y;m.convertRGBATo32Bit=function(a){a=a.reverse().map(d=>{d=d.toString(16);return 2>d.length?"0"+d:d});return 4294967295&Number.parseInt(a.join(""),16)};m.getColorRampId=v;m.getColorRampJSON=
function(a,d="esriCIELabAlgorithm"){const c=D.find(({id:b})=>b===a);return c?c.colorRamps?{type:"multipart",colorRamps:c.colorRamps.map(b=>({type:"algorithmic",algorithm:d,fromColor:[...b.fromColor],toColor:[...b.toColor]}))}:{type:"algorithmic",algorithm:d,fromColor:[...c.fromColor],toColor:[...c.toColor]}:null};m.getColorRampName=n;m.getRFxArgColorRampValue=function(a){const d=n(a);return d?"algorithmic"===a.type?{...B(a),Name:d}:a.colorRamps?(a=a.colorRamps.map(B),{type:"MultiPartColorRamp",NumColorRamps:a.length,
ArrayOfColorRamp:a,Name:d}):null:null};m.predefinedJsonColorRamps=D;m.rasterColormapNames="random ndvi ndvi2 ndvi3 elevation gray hillshade".split(" ");Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/colorRamps":function(){define(["exports","./AlgorithmicColorRamp","./ColorRamp","./MultipartColorRamp"],function(m,x,u,K){u={key:"type",base:u,typeMap:{algorithmic:x,multipart:K}};m.fromJSON=function(F){return F?.type?"algorithmic"===F.type?x.fromJSON(F):"multipart"===
F.type?K.fromJSON(F):null:null};m.types=u;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/AlgorithmicColorRamp":function(){define("../../chunks/tslib.es6 ../../Color ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./ColorRamp".split(" "),function(m,x,u,K,F,T,N,M){var H;M=H=class extends M{constructor(v){super(v);this.toColor=
this.fromColor=this.algorithm=null;this.type="algorithmic"}clone(){return new H({fromColor:u.clone(this.fromColor),toColor:u.clone(this.toColor),algorithm:this.algorithm})}};m.__decorate([T.enumeration({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],M.prototype,"algorithm",void 0);m.__decorate([K.property({type:x,json:{type:[F.Integer],write:!0}})],M.prototype,"fromColor",void 0);m.__decorate([K.property({type:x,json:{type:[F.Integer],write:!0}})],M.prototype,
"toColor",void 0);m.__decorate([K.property({type:["algorithmic"]})],M.prototype,"type",void 0);return M=H=m.__decorate([N.subclass("esri.rest.support.AlgorithmicColorRamp")],M)})},"esri/rest/support/ColorRamp":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),function(m,x,u,K,F,T,N){x=class extends x.JSONSupport{constructor(M){super(M);
this.type=null}};m.__decorate([u.property({readOnly:!0,json:{read:!1,write:!0}})],x.prototype,"type",void 0);return x=m.__decorate([N.subclass("esri.rest.support.ColorRamp")],x)})},"esri/rest/support/MultipartColorRamp":function(){define("../../chunks/tslib.es6 ../../core/lang ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/subclass ./AlgorithmicColorRamp ./ColorRamp".split(" "),function(m,x,u,K,F,T,N,M){var H;K=H=class extends M{constructor(v){super(v);
this.colorRamps=null;this.type="multipart"}clone(){return new H({colorRamps:x.clone(this.colorRamps)})}};m.__decorate([u.property({type:[N],json:{write:!0}})],K.prototype,"colorRamps",void 0);m.__decorate([u.property({type:["multipart"]})],K.prototype,"type",void 0);return K=H=m.__decorate([T.subclass("esri.rest.support.MultipartColorRamp")],K)})},"esri/layers/support/rasterFunctions/colormaps":function(){define(["exports","../../../renderers/support/colorRampUtils"],function(m,x){function u(M,H){const v=
[],n=[];for(let e=0;e<M.length-1;e++)v.push({type:"algorithmic",algorithm:"esriHSVAlgorithm",fromColor:M[e].slice(1),toColor:M[e+1].slice(1)}),n.push(M[e+1][0]-M[e][0]);M=M[M.length-1][0];H=H??n;return x.convertColorRampToColors({type:"multipart",colorRamps:v},{numColors:M,weights:H})}function K(){const M=u([[0,255,255,255],[70,0,255,0],[80,205,173,193],[100,150,150,150],[110,120,51,100],[130,120,100,200],[140,28,3,144],[160,6,0,55],[180,10,25,30],[201,6,7,27]]);for(let H=M.length;256>H;H++)M.push([6,
27,7]);return M}function F(){const M=[];for(let H=0;256>H;H++){const v=[];for(let n=0;3>n;n++)v.push(Math.round(255*Math.random()));M.push(v)}return M}const T=[[36,0,255],[36,0,255],[36,0,255],[36,0,255],[112,75,3],[113,76,3],[114,77,3],[115,77,3],[116,78,3],[117,79,3],[118,79,3],[119,80,3],[121,81,4],[122,82,4],[123,82,4],[124,83,4],[125,84,4],[126,84,4],[127,85,4],[128,86,4],[129,86,4],[130,87,4],[131,88,4],[132,89,4],[133,89,4],[134,90,4],[135,91,4],[136,91,4],[137,92,4],[138,93,4],[139,94,4],
[140,94,4],[142,95,5],[143,96,5],[144,96,5],[145,97,5],[146,98,5],[147,99,5],[148,99,5],[149,100,5],[150,101,5],[151,101,5],[152,102,5],[153,103,5],[154,104,5],[155,104,5],[156,105,5],[157,106,5],[158,106,5],[159,107,5],[160,108,5],[161,108,5],[162,109,5],[164,110,6],[165,111,6],[166,111,6],[167,112,6],[168,113,6],[169,113,6],[170,114,6],[171,115,6],[172,116,6],[173,116,6],[174,117,6],[245,0,0],[245,5,0],[245,10,0],[246,15,0],[246,20,0],[246,25,0],[246,30,0],[247,35,0],[247,40,0],[247,45,0],[247,
50,0],[247,55,0],[248,60,0],[248,65,0],[248,70,0],[248,75,0],[249,81,0],[249,86,0],[249,91,0],[249,96,0],[250,101,0],[250,106,0],[250,111,0],[250,116,0],[250,121,0],[251,126,0],[251,131,0],[251,136,0],[251,141,0],[252,146,0],[252,151,0],[252,156,0],[252,156,0],[251,159,0],[250,162,0],[249,165,0],[248,168,0],[247,171,0],[246,174,0],[245,177,0],[245,179,0],[244,182,0],[243,185,0],[242,188,0],[241,191,0],[240,194,0],[239,197,0],[238,200,0],[237,203,0],[236,206,0],[235,209,0],[234,212,0],[233,215,0],
[232,218,0],[231,221,0],[230,224,0],[230,226,0],[229,229,0],[228,232,0],[227,235,0],[226,238,0],[225,241,0],[224,244,0],[223,247,0],[165,247,0],[163,244,0],[161,240,0],[158,237,0],[156,233,1],[154,230,1],[152,227,1],[149,223,1],[147,220,1],[145,216,1],[143,213,1],[140,210,2],[138,206,2],[136,203,2],[134,200,2],[132,196,2],[129,193,2],[127,189,2],[125,186,3],[123,183,3],[120,179,3],[118,176,3],[116,172,3],[114,169,3],[111,166,3],[109,162,4],[107,159,4],[105,155,4],[103,152,4],[100,149,4],[98,145,4],
[96,142,4],[94,138,5],[91,135,5],[89,132,5],[87,128,5],[85,125,5],[82,121,5],[80,118,5],[78,115,6],[76,111,6],[73,108,6],[71,105,6],[69,101,6],[67,98,6],[65,94,6],[62,91,7],[60,88,7],[58,84,7],[56,81,7],[53,77,7],[51,74,7],[49,71,7],[47,67,8],[44,64,8],[42,60,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],
[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8]],N=[[36,0,255],[36,0,
255],[36,0,255],[36,0,255],[245,20,0],[245,24,0],[245,29,0],[245,31,0],[247,33,0],[247,33,0],[247,37,0],[247,41,0],[247,41,0],[247,41,0],[247,45,0],[247,45,0],[247,47,0],[247,49,0],[247,49,0],[247,54,0],[247,54,0],[247,56,0],[247,58,0],[247,58,0],[250,62,0],[250,62,0],[250,62,0],[250,67,0],[250,67,0],[250,67,0],[250,69,0],[250,71,0],[250,71,0],[250,75,0],[250,75,0],[250,78,0],[250,79,0],[250,79,0],[250,79,0],[250,81,0],[250,83,0],[250,83,0],[250,87,0],[250,87,0],[250,90,0],[250,92,0],[252,93,0],[252,
93,0],[252,97,0],[252,97,0],[252,97,0],[252,97,0],[252,101,0],[252,101,0],[252,101,0],[252,101,0],[252,105,0],[252,105,0],[252,107,0],[252,109,0],[252,109,0],[252,113,13],[255,118,20],[255,119,23],[255,121,25],[255,126,33],[255,132,38],[255,133,40],[255,135,43],[255,141,48],[255,144,54],[255,150,59],[255,152,61],[255,153,64],[255,159,69],[255,163,77],[255,165,79],[255,168,82],[255,174,87],[255,176,92],[255,181,97],[255,183,99],[255,186,102],[255,191,107],[255,197,115],[255,201,120],[255,203,123],
[255,205,125],[255,209,130],[255,214,138],[255,216,141],[255,218,143],[255,224,150],[255,228,156],[255,234,163],[255,236,165],[255,238,168],[255,243,173],[255,248,181],[255,252,186],[253,252,186],[250,252,187],[244,250,180],[238,247,176],[234,246,173],[231,245,169],[223,240,163],[217,237,157],[211,235,150],[205,233,146],[200,230,142],[195,227,136],[189,224,132],[184,222,126],[180,220,123],[174,217,119],[169,214,114],[163,212,108],[160,210,105],[154,207,101],[148,204,96],[143,201,93],[138,199,88],
[134,197,84],[130,194,81],[126,191,77],[117,189,70],[115,186,68],[112,184,64],[106,181,60],[100,179,55],[94,176,49],[92,174,47],[90,173,45],[81,168,37],[75,166,33],[71,163,28],[66,160,24],[62,158,21],[56,156,14],[51,153,0],[51,153,0],[51,153,0],[50,150,0],[50,150,0],[50,150,0],[50,150,0],[49,148,0],[49,148,0],[49,148,0],[48,145,0],[48,145,0],[48,145,0],[48,145,0],[48,143,0],[48,143,0],[48,143,0],[48,143,0],[47,140,0],[47,140,0],[47,140,0],[47,140,0],[46,138,0],[46,138,0],[46,138,0],[46,138,0],[45,
135,0],[45,135,0],[45,135,0],[45,135,0],[44,133,0],[44,133,0],[44,133,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[42,128,0],[42,128,0],[42,128,0],[42,125,0],[42,125,0],[42,125,0],[42,125,0],[41,122,0],[41,122,0],[41,122,0],[41,122,0],[40,120,0],[40,120,0],[40,120,0],[40,120,0],[40,120,0],[39,117,0],[39,117,0],[39,117,0],[39,117,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],
[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0]];m.getColormapByName=
function(M){let H;switch(M){case "elevation":H=u([[0,0,191,191],[51,0,0,255],[102,255,0,255],[153,255,0,127],[204,191,63,127],[256,20,20,20]]);break;case "gray":H=x.convertColorRampToColors({type:"algorithmic",algorithm:"esriHSVAlgorithm",fromColor:[0,0,0],toColor:[255,255,255]});break;case "hillshade":H=u([[0,38,41,54],[69,79,82,90],[131,156,156,156],[256,253,253,241]],[.268,.238,.495]);break;case "ndvi":H=T;break;case "ndvi2":H=K();break;case "ndvi3":H=N;break;case "random":H=F()}return H?H=H.map((v,
n)=>[n,...v]):null};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/CompositeBandFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./CompositeBandFunctionArguments ./pixelUtils".split(" "),function(m,x,u,K,F,T,N,M,H){u=class extends N{constructor(){super(...arguments);
this.functionName="CompositeBand";this.functionArguments=null;this.rasterArgumentNames=["rasters"]}_bindSourceRasters(){var {sourceRasterInfos:v}=this,n=v[0];this.outputPixelType=this._getOutputPixelType(n.pixelType);n=n.clone();n.attributeTable=null;n.colormap=null;n.pixelType=this.outputPixelType;n.bandCount=v.map(({bandCount:e})=>e).reduce((e,g)=>e+g);if(v.every(({statistics:e})=>null!=e&&e.length)){const e=[];v.forEach(({statistics:g})=>null!=g&&e.push(...g));n.statistics=e}if(v.every(({histograms:e})=>
null!=e&&e.length)){const e=[];v.forEach(({histograms:g})=>null!=g&&e.push(...g));n.histograms=e}1<n.bandCount&&(n.colormap=null,n.attributeTable=null);v=v.every(e=>e.keyProperties.BandProperties?.length)?v.flatMap(e=>e.keyProperties.BandProperties):void 0;n.keyProperties={...n.keyProperties,BandProperties:v};this.rasterInfo=n;return{success:!0,supportsGPU:3>=n.bandCount}}_processPixels(v){({pixelBlocks:v}=v);return v&&null!=v?.[0]?H.compositeBands(v):null}_getWebGLParameters(){return{bandCount:this.rasterInfo.bandCount}}};
m.__decorate([x.property({json:{write:!0,name:"rasterFunction"}})],u.prototype,"functionName",void 0);m.__decorate([x.property({type:M,json:{write:!0,name:"rasterFunctionArguments"}})],u.prototype,"functionArguments",void 0);m.__decorate([x.property()],u.prototype,"rasterArgumentNames",void 0);return u=m.__decorate([T.subclass("esri.layers.support.rasterFunctions.CompositeBandFunction")],u)})},"esri/layers/support/rasterFunctions/CompositeBandFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),
function(m,x,u,K,F,T,N,M){var H;K=H=class extends M{constructor(){super(...arguments);this.rasters=[]}writeRasters(v,n){n.rasters=v.map(e=>"number"===typeof e||"string"===typeof e?e:e.toJSON())}clone(){return new H({rasters:x.clone(this.rasters)})}};m.__decorate([u.property({json:{write:!0}})],K.prototype,"rasters",void 0);m.__decorate([N.writer("rasters")],K.prototype,"writeRasters",null);return K=H=m.__decorate([T.subclass("esri.layers.support.rasterFunctions.CompositeBandFunctionArguments")],K)})},
"esri/layers/support/rasterFunctions/ComputeChangeFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../Field ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./changeDetectionUtils ./ComputeChangeFunctionArguments".split(" "),function(m,x,u,K,F,T,N,M,H,v,n){u=class extends H{constructor(){super(...arguments);this.functionName=
"ComputeChange";this.functionArguments=null;this.rasterArgumentNames=["raster","raster2"]}_bindSourceRasters(){const {method:e}=this.functionArguments,g=this.sourceRasterInfos[0].clone();this.outputPixelType=this._getOutputPixelType(g.pixelType);g.pixelType=this.outputPixelType;this._removeStatsHistColormapVAT(g);if("categorical"===e){var k=this.sourceRasterInfos.map(h=>h.attributeTable);const y=this._getFieldNames(k,"value");k=k.map(h=>this._getClassFieldName(h));if(null==y[0]||null==y[1]||null==
k[0]||null==k[1])return{success:!1,supportsGPU:!1,error:"both inputs must have proper attribute table with value and class fields"};this._updateAttributeTable(g,y,k)}g.bandCount=1;this.rasterInfo=g;return{success:!0,supportsGPU:"difference"===e||"relative-difference"===e}}_processPixels(e){({pixelBlocks:e}=e);if(null==e?.[0]||null==e?.[1])return null;const {method:g}=this.functionArguments;return v.computeChange(e,g,this.outputPixelType,this._categoryConfig)}_getWebGLParameters(){var e=this.outputPixelType??
"f32";let [g,k]=M.getPixelValueRange(e);if(e=M.isIntegerPixelType(e))g-=1E-4,k+=1E-4;return{method:this.functionArguments.method,domainRange:[g,k],isOutputRounded:e}}_updateAttributeTable(e,g,k){var y=this.sourceRasterInfos.map(w=>w.attributeTable),h=y.map((w,p)=>w.features.map(z=>z.attributes[g[p]])),B=y.map((w,p)=>w.features.map(z=>z.attributes[k[p]])),D=h.map(w=>{const p=[];w.forEach((z,I)=>p[z]=I);return p});const {keepMethod:E}=this.functionArguments;this._categoryConfig={categoryIndexLookups:D,
classNames:B,keepMethod:E};D=y[0].clone();D.fields=[new N({name:"OID",type:"oid"}),new N({name:"Value",type:"integer"}),new N({name:"ClassName",type:"string"}),new N({name:"Class_From",type:"string"}),new N({name:"Class_To",type:"string"})];const a=this._getFieldNames(y,"red"),d=this._getFieldNames(y,"green"),c=this._getFieldNames(y,"blue"),b=[],f=2===a.length&&2===d.length&&2===c.length;f&&(b.push(...y.map((w,p)=>w.features.map(z=>[z.attributes[a[p]],z.attributes[d[p]],z.attributes[c[p]]]))),D.fields.push(new N({name:"Red",
type:"integer"}),new N({name:"Green",type:"integer"}),new N({name:"Blue",type:"integer"})));const l=D.features[0].clone();l.geometry=null;y=[];const [r,q]=h.map(w=>w.length);h=1;for(let w=0;w<r;w++){const p=B[0][w];for(let z=0;z<q;z++){const I=B[1][z];if("changed"===E&&p===I||"unchanged"===E&&p!==I)continue;const G=l.clone();G.attributes={OID:h++,Value:w*q+z,ClassName:p===I?p:`${p} -> ${I}`,Class_From:p,Class_To:I};f&&(G.attributes.Red=b[0][w][0]+b[1][z][0]>>1,G.attributes.Green=b[0][w][1]+b[1][z][1]>>
1,G.attributes.Blue=b[0][w][2]+b[1][z][2]>>1);y.push(G)}}"changed"===E?(B=l.clone(),B.attributes={OID:h++,Value:r*q+1,ClassName:"No Change",Class_From:"Same",Class_To:"Same"},y.push(B)):"unchanged"===E&&(B=l.clone(),B.attributes={OID:h++,Value:r*q+2,ClassName:"Changed",Class_From:"Any",Class_To:"Any"},y.push(B));D.features=y;e.attributeTable=D}_getFieldNames(e,g){return e.map(({fields:k})=>k.find(y=>y.name.toLowerCase()===g)?.name).filter(k=>k)}_getClassFieldName(e){return(e.fields.find(g=>"string"===
g.type&&g.name.toLowerCase().startsWith("class"))??e.fields.find(g=>"string"===g.type&&g.name.toLowerCase().includes("class")||g.name.toLowerCase().includes("type")||g.name.toLowerCase().includes("name"))??e.fields.find(g=>"string"===g.type))?.name}};m.__decorate([x.property({json:{write:!0,name:"rasterFunction"}})],u.prototype,"functionName",void 0);m.__decorate([x.property({type:n,json:{write:!0,name:"rasterFunctionArguments"}})],u.prototype,"functionArguments",void 0);m.__decorate([x.property()],
u.prototype,"rasterArgumentNames",void 0);m.__decorate([x.property({json:{write:!0}})],u.prototype,"_categoryConfig",void 0);return u=m.__decorate([T.subclass("esri.layers.support.rasterFunctions.ComputeChangeFunction")],u)})},"esri/layers/support/Field":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/RandomLCG ../../core/has ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ./domains ./fieldType".split(" "),
function(m,x,u,K,F,T,N,M,H,v,n,e){var g;const k=new x.JSONMap({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});x=g=class extends u.JSONSupport{constructor(y){super(y);
this.alias=null;this.defaultValue=void 0;this.domain=this.description=null;this.editable=!0;this.length=void 0;this.name=null;this.nullable=!0;this.valueType=this.type=null;this.visible=!0}readDescription(y,{description:h}){y=null;try{y=h?JSON.parse(h):null}catch(B){}return y?.value??null}readValueType(y,{description:h}){y=null;try{y=h?JSON.parse(h):null}catch(B){}return y?k.fromJSON(y.fieldValueType):null}clone(){return new g({alias:this.alias,defaultValue:this.defaultValue,description:this.description,
domain:this.domain?.clone()??null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}};m.__decorate([K.property({type:String,json:{write:!0}})],x.prototype,"alias",void 0);m.__decorate([K.property({type:[String,Number],json:{write:{allowNull:!0}}})],x.prototype,"defaultValue",void 0);m.__decorate([K.property()],x.prototype,"description",void 0);m.__decorate([H.reader("description")],x.prototype,"readDescription",
null);m.__decorate([K.property({types:n.types,json:{read:{reader:n.fromJSON},write:!0}})],x.prototype,"domain",void 0);m.__decorate([K.property({type:Boolean,json:{write:!0}})],x.prototype,"editable",void 0);m.__decorate([K.property({type:F.Integer,json:{write:{overridePolicy(y){return{enabled:Number.isFinite(y)}}}}})],x.prototype,"length",void 0);m.__decorate([K.property({type:String,json:{write:!0}})],x.prototype,"name",void 0);m.__decorate([K.property({type:Boolean,json:{write:!0}})],x.prototype,
"nullable",void 0);m.__decorate([M.enumeration(e.kebabDict)],x.prototype,"type",void 0);m.__decorate([K.property()],x.prototype,"valueType",void 0);m.__decorate([H.reader("valueType",["description"])],x.prototype,"readValueType",null);m.__decorate([K.property({type:Boolean,json:{read:!1}})],x.prototype,"visible",void 0);return x=g=m.__decorate([v.subclass("esri.layers.support.Field")],x)})},"esri/layers/support/domains":function(){define("exports ../../core/has ./CodedValueDomain ./Domain ./InheritedDomain ./RangeDomain".split(" "),
function(m,x,u,K,F,T){x={key:"type",base:K,typeMap:{range:T,"coded-value":u,inherited:F}};m.CodedValueDomain=u;m.DomainBase=K;m.InheritedDomain=F;m.RangeDomain=T;m.fromJSON=function(N){if(!N?.type)return null;switch(N.type){case "range":return T.fromJSON(N);case "codedValue":return u.fromJSON(N);case "inherited":return F.fromJSON(N)}return null};m.types=x;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/CodedValueDomain":function(){define("../../chunks/tslib.es6 ../../core/lang ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./CodedValue ./Domain".split(" "),
function(m,x,u,K,F,T,N,M,H){var v;K=v=class extends H{constructor(n){super(n);this.codedValues=null;this.type="coded-value"}getName(n){let e=null;if(this.codedValues){const g=String(n);this.codedValues.some(k=>{String(k.code)===g&&(e=k.name);return!!e})}return e}clone(){return new v({codedValues:x.clone(this.codedValues),name:this.name})}};m.__decorate([u.property({type:[M.CodedValue],json:{write:!0}})],K.prototype,"codedValues",void 0);m.__decorate([T.enumeration({codedValue:"coded-value"})],K.prototype,
"type",void 0);return K=v=m.__decorate([N.subclass("esri.layers.support.CodedValueDomain")],K)})},"esri/layers/support/CodedValue":function(){define("exports ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),function(m,x,u,K,F,T,N,M){var H;m.CodedValue=H=class extends u.JSONSupport{constructor(v){super(v);this.code=this.name=null}clone(){return new H({name:this.name,
code:this.code})}};x.__decorate([K.property({type:String,json:{write:!0}})],m.CodedValue.prototype,"name",void 0);x.__decorate([K.property({type:[String,Number],json:{write:!0}})],m.CodedValue.prototype,"code",void 0);m.CodedValue=H=x.__decorate([M.subclass("esri.layers.support.CodedValue")],m.CodedValue);Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/Domain":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),
function(m,x,u,K,F,T,N,M,H){x=new x.JSONMap({inherited:"inherited",codedValue:"coded-value",range:"range"});u=class extends u.JSONSupport{constructor(v){super(v);this.type=this.name=null}};m.__decorate([K.property({type:String,json:{write:!0}})],u.prototype,"name",void 0);m.__decorate([M.enumeration(x)],u.prototype,"type",void 0);return u=m.__decorate([H.subclass("esri.layers.support.Domain")],u)})},"esri/layers/support/InheritedDomain":function(){define("../../chunks/tslib.es6 ../../core/Logger ../../core/has ../../core/RandomLCG ../../core/Error ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./Domain".split(" "),
function(m,x,u,K,F,T,N,M){var H;x=H=class extends M{constructor(v){super(v);this.type="inherited"}clone(){return new H}};m.__decorate([T.enumeration({inherited:"inherited"})],x.prototype,"type",void 0);return x=H=m.__decorate([N.subclass("esri.layers.support.InheritedDomain")],x)})},"esri/layers/support/RangeDomain":function(){define("../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./Domain".split(" "),
function(m,x,u,K,F,T,N,M){var H;u=H=class extends M{constructor(v){super(v);this.minValue=this.maxValue=null;this.type="range"}clone(){return new H({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}};m.__decorate([x.property({json:{type:[Number],read:{source:"range",reader(v,n){return n.range?.[1]}},write:{enabled:!1,overridePolicy(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",writer(v,n,e){n[e]=[this.minValue||0,v]}}}})],u.prototype,"maxValue",void 0);m.__decorate([x.property({json:{type:[Number],
read:{source:"range",reader(v,n){return n.range?.[0]}},write:{target:"range",writer(v,n,e){n[e]=[v,this.maxValue||0]}}}})],u.prototype,"minValue",void 0);m.__decorate([T.enumeration({range:"range"})],u.prototype,"type",void 0);return u=H=m.__decorate([N.subclass("esri.layers.support.RangeDomain")],u)})},"esri/layers/support/fieldType":function(){define(["exports","../../core/jsonMap"],function(m,x){x=new x.JSONMap({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",
esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"});m.kebabDict=x;Object.defineProperty(m,Symbol.toStringTag,
{value:"Module"})})},"esri/layers/support/rasterFunctions/changeDetectionUtils":function(){define(["exports","../../../core/has","../../../core/jsonMap","../PixelBlock","../rasterFormats/pixelRangeUtils"],function(m,x,u,K,F){function T(n){const {bands:[e,g],mask:k,isRelative:y,isRoundingNeeded:h,outBand:B}=n;n=e.length;for(let D=0;D<n;D++)if(!k||k[D]){let E=e[D]-g[D];if(y){const a=Math.max(Math.abs(e[D])-Math.abs(g[D]));E=0<a?E/a:0}B[D]=h?Math.round(E):E}}function N(n){const {bands:[e,g],categoryIndexLookups:[k,
y],classNames:[h,B],mask:D,keepMethod:E,outBand:a}=n;n=e.length;const d=B.length,c=h.length*d,b=c+1,f=c+2;for(let l=0;l<n;l++)if(!D||D[l]){const r=k[e[l]],q=y[g[l]],w=h[r],p=B[q];a[l]=null==r||null==q?c:"changed"===E&&w===p?b:"unchanged"===E&&w!==p?f:r*d+q}}function M(n){const {pixels:[e,g],mask:k,outBand:y}=n;n=e[0].length;const h=e.length;for(let B=0;B<n;B++)if(!k||k[B]){let D=0;for(let E=0;E<h;E++){const a=e[E][B]-g[E][B];D+=a*a}y[B]=Math.sqrt(D)}}function H(n){const {pixels:[e,g],mask:k,outBand:y}=
n;n=e[0].length;const h=e.length;for(let D=0;D<n;D++)if(!k||k[D]){let E=0;var B=0;let a=0;for(let d=0;d<h;d++){const c=e[d][D],b=g[d][D];E+=c*b;B+=c*c;a+=b*b}B=Math.sqrt(B*a);y[D]=B?Math.acos(E/B):1.5707963267948966}}function v(n){const {pixels:[e,g],mask:k,outBand:y}=n;n=e[0].length;const h=e.length;for(let B=0;B<n;B++)if(!k||k[B]){let D=0,E=0;for(let a=0;a<h;a++){const d=Math.abs(e[a][B]-g[a][B]);d>D&&(D=d,E=a)}y[B]=E}}x=new u.JSONMap({0:"difference",1:"relative-difference",2:"categorical",3:"euclidean-distance",
4:"angle-difference",5:"band-with-most-change"},{useNumericKeys:!0});u=new u.JSONMap({0:"all",1:"changed",2:"unchanged"},{useNumericKeys:!0});m.changeMethodMap=x;m.computeChange=function(n,e,g,k){const [y,h]=n,B=F.isIntegerPixelType(g)&&!F.isIntegerPixelType(y.pixelType)&&!F.isIntegerPixelType(h.pixelType);var D=[y.mask,h.mask].filter(b=>b);D=K.combineBandMasks(D);const E=n.map(b=>b.pixels[0]),{width:a,height:d}=y,c=K.createEmptyBand(g,a*d);switch(e){case "difference":case "relative-difference":T({bands:E,
mask:D,outBand:c,isRoundingNeeded:B,isRelative:"relative-difference"===e});break;case "categorical":N({bands:E,mask:D,outBand:c,...k});break;case "euclidean-distance":M({pixels:n.map(b=>b.pixels),mask:D,outBand:c});break;case "angle-difference":H({pixels:n.map(b=>b.pixels),mask:D,outBand:c});break;case "band-with-most-change":v({pixels:n.map(b=>b.pixels),mask:D,outBand:c})}n=new K({width:a,height:d,pixels:[c],pixelType:g,mask:D});n.updateStatistics();return n};m.keepMethodMap=u;Object.defineProperty(m,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/ComputeChangeFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ./changeDetectionUtils".split(" "),function(m,x,u,K,F,T,N,M,H){var v;u=v=class extends M{constructor(){super(...arguments);
this.method="difference";this.keepMethod="all";this.raster2=void 0}get rasters(){return[this.raster,this.raster2]}clone(){return new v({raster:this.raster,raster2:this.raster2,method:this.method,keepMethod:this.keepMethod})}};m.__decorate([T.enumeration(H.changeMethodMap)],u.prototype,"method",void 0);m.__decorate([T.enumeration(H.keepMethodMap)],u.prototype,"keepMethod",void 0);m.__decorate([x.property({json:{write:!0}})],u.prototype,"raster2",void 0);m.__decorate([x.property({readOnly:!0})],u.prototype,
"rasters",null);return u=v=m.__decorate([N.subclass("esri.layers.support.rasterFunctions.ComputeChangeFunctionArguments")],u)})},"esri/layers/support/rasterFunctions/ContrastBrightnessFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./ContrastBrightnessFunctionArguments ./pixelUtils ./stretchUtils".split(" "),
function(m,x,u,K,F,T,N,M,H,v){u=class extends N{constructor(){super(...arguments);this.functionName="ContrastBrightness";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.lookup=null}_bindSourceRasters(){var {sourceRasterInfos:n}=this;n=n[0];if("u8"!==n.pixelType)return{success:!1,supportsGPU:!1,error:"Only unsigned 8 bit raster is supported by ContrastBrightness function."};this.outputPixelType=this._getOutputPixelType("u8");n=n.clone();this._removeStatsHistColormapVAT(n);this.rasterInfo=
n;const {contrastOffset:e,brightnessOffset:g}=this.functionArguments;this.lookup=v.createContrastBrightnessLUT(e,g);return{success:!0,supportsGPU:!0}}_processPixels(n){n=n.pixelBlocks?.[0];return null==n?null:H.lookupPixels(n,{lut:n.pixels.map(()=>this.lookup),offset:0,outputPixelType:"u8"})}_getWebGLParameters(){const {contrastOffset:n,brightnessOffset:e}=this.functionArguments;return{contrastOffset:n,brightnessOffset:e}}};m.__decorate([x.property({json:{write:!0,name:"rasterFunction"}})],u.prototype,
"functionName",void 0);m.__decorate([x.property({type:M,json:{write:!0,name:"rasterFunctionArguments"}})],u.prototype,"functionArguments",void 0);m.__decorate([x.property()],u.prototype,"rasterArgumentNames",void 0);m.__decorate([x.property({json:{write:!0}})],u.prototype,"lookup",void 0);return u=m.__decorate([T.subclass("esri.layers.support.rasterFunctions.ContrastBrightnessFunction")],u)})},"esri/layers/support/rasterFunctions/ContrastBrightnessFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(m,x,u,K,F,T,N){var M;u=M=class extends N{constructor(){super(...arguments);this.brightnessOffset=this.contrastOffset=0}clone(){return new M({contrastOffset:this.contrastOffset,brightnessOffset:this.brightnessOffset,raster:this.raster})}};m.__decorate([x.property({json:{write:!0}})],u.prototype,"contrastOffset",void 0);m.__decorate([x.property({json:{write:!0}})],u.prototype,"brightnessOffset",void 0);return u=M=m.__decorate([T.subclass("esri.layers.support.rasterFunctions.ContrastBrightnessFunctionArguments")],
u)})},"esri/layers/support/rasterFunctions/stretchUtils":function(){define(["exports","../../../core/maybe","../PixelBlock","../rasterFormats/pixelRangeUtils","../../../renderers/support/stretchRendererUtils"],function(m,x,u,K,F){function T(g,k=256){k=Math.min(k,256);const {size:y,counts:h}=g;g=new Uint8Array(y);var B=h.reduce((c,b)=>c+b/k,0);let D=0;var E=0;let a=0,d=B;for(let c=0;c<y;c++)if(a+=h[c],!(c<y-1&&a+h[c+1]<d)){for(;D<k-1&&d<a;)D++,d+=B;for(;E<=c;E++)g[E]=D;E=c+1}for(B=E;B<y;B++)g[B]=k-
1;return g}function N(g,k){g=Math.min(Math.max(g,-100),100);k=Math.min(Math.max(k??0,-100),100);let y=0,h=0;const B=new Uint8Array(256);for(y=0;256>y;y++)0<g&&100>g?h=(200*y-25500+510*k)/(2*(100-g))+128:0>=g&&-100<g?h=(200*y-25500+510*k)*(100+g)/2E4+128:100===g?(h=200*y-25500+256*(100-g)+510*k,h=0<h?255:0):-100===g&&(h=128),B[y]=255<h?255:0>h?0:h;return B}function M(g,k,y,h){h=Infinity;let B=-Infinity;var D=0,E=0,a=0,d=0;const c=g.length;var b=new Map,f=[];for(let l=0;l<c;l++){const r=g[l];if(!k||
k[l]){f.push(r);const q=(b.get(r)??0)+1;b.set(r,q);q>d&&(d=q,a=r);h=r<h?r:h;B=r>B?r:B;D+=r;E++}}if(0===E)return{statistics:{min:0,max:0,avg:0,stddev:0,mode:0,median:0},histogram:null};D/=E;d=0;for(b=0;b<c;b++)if(!k||k[b])d+=(g[b]-D)**2;b=k?k.filter(l=>l).length:c;d=1>=b?0:Math.sqrt(d/(b-1));f.sort((l,r)=>l-r);b=E>>>1;a={min:h,max:B,avg:D,stddev:d,mode:a,median:E%2?f[Math.floor(b)]:(f[b-1]+f[b])/2};if(["u8","s8","u4","u2","u1"].includes(y)){E=B-h+1;y=new Uint32Array(E);for(f=0;f<c;f++)k&&!k[f]||y[g[f]-
h]++;return{statistics:a,histogram:{min:h-.5,max:B+.5,size:E,counts:y}}}y=new Uint32Array(256);f=(B-h)/256;if(0===f)return{statistics:a,histogram:{min:h,max:B,size:1,counts:(new Uint32Array(1)).fill(E)}};E=new Uint32Array(257);for(D=0;D<c;D++)k&&!k[D]||E[Math.floor((g[D]-h)/f)]++;for(g=0;255>g;g++)y[g]=E[g];y[255]=E[255]+E[256];return{statistics:a,histogram:{min:h,max:B,size:256,counts:y}}}function H(g){if(!g?.pixels?.length)return null;const {pixels:k,mask:y,bandMasks:h,pixelType:B}=g,D=g.width*
g.height,E=k.length,a=[],d=[];let c,b;for(let I=0;I<E;I++){var f=new Uint32Array(256);var l=k[I],r=h?.[I]??y;if("u8"===B){c=255;b=0;if(r)for(var q=0;q<D;q++){if(r[q]){var w=l[q];c=w<c?w:c;b=w>b?w:b;f[w]++}}else for(r=0;r<D;r++)q=l[r],c=q<c?q:c,b=q>b?q:b,f[q]++;f=f.slice(c,b+1)}else{w=!1;g.statistics||(g.updateStatistics(),w=!0);var p=g.statistics;c=p[I].minValue;b=p[I].maxValue;q=(b-c)/256;if(0===q)for(!p||g.validPixelCount||w||g.updateStatistics(),l=(g.validPixelCount||g.width*g.height)/256,r=0;256>
r;r++)f[r]=Math.round(l*(r+1))-Math.round(l*r);else{w=new Uint32Array(257);for(p=0;p<D;p++)r&&!r[p]||w[Math.floor((l[p]-c)/q)]++;for(l=0;255>l;l++)f[l]=w[l];f[255]=w[255]+w[256]}}q="u8"===B?c-.5:c;w="u8"===B?b+.5:b;a.push({min:q,max:w,size:f.length,counts:f});r=p=l=0;for(var z=0;z<f.length;z++)l+=f[z],p+=z*f[z];p/=l;for(z=0;z<f.length;z++)r+=f[z]*(z-p)**2;f=(w-q)/f.length;d.push({min:c,max:b,avg:(p+("u8"===B?0:.5))*f+c,stddev:Math.sqrt(r/(l-1))*f})}return{statistics:d,histograms:a}}function v(g,k){if(null==
k||0===k.length)return g;const y=Math.max.apply(null,k),{minCutOff:h,maxCutOff:B,outMin:D,outMax:E,histogramLut:a}=g;return h.length===k.length||h.length<=y?g:{minCutOff:k.map(d=>h[d]),maxCutOff:k.map(d=>B[d]),histogramLut:a?k.map(d=>a[d]):null,outMin:D,outMax:E}}function n(g,k){const y=new Float32Array(g);for(let h=0;h<g;h++)y[h]=1<k[h]?2<k[h]?6.5+(k[h]-2)**2.5:6.5+100*(2-k[h])**4:1;return y}const e=[.299,.587,.114];m.computeGammaCorrection=n;m.computeGammaValues=function(g,k,y){const h=[];for(let d=
0;d<k.length;d++){var B=0,D=0,E=0;"min"in k[d]?{min:B,max:D,avg:E}=k[d]:[B,D,E]=k[d];E=E??0;"u8"!==g&&(E=255*(E-B)/(D-B));y&&(E*=e[d]);B=h;D=B.push;if(0>=E||255<=E)E=1;else{var a=0;150!==E&&(a=150>=E?45*Math.cos(.01047*E):17*Math.sin(.021*E));a=Math.log((E+a)/255);0===a?E=1:(E=Math.log(E/255)/a,E=isNaN(E)?1:Math.min(9.9,Math.max(.01,E)))}D.call(B,E)}return h};m.computeStatisticsHistograms=function(g){const {pixels:k,mask:y,pixelType:h,bandMasks:B}=g;var D=k.map((E,a)=>M(E,B?.[a]??y,h));g=D.map(({statistics:E})=>
E);D=D.map(({histogram:E})=>E);return{statistics:g,histograms:D}};m.createContrastBrightnessLUT=N;m.createHistogramEqualizationLUT=T;m.createStretchLUT=function(g){const {minCutOff:k,maxCutOff:y,gamma:h,pixelType:B,rounding:D}=g,E=g.outMin||0,a=g.outMax||255;if(!["u8","u16","s8","s16"].includes(B))return null;const d=k.length;let c,b,f=0;"s8"===B?f=-127:"s16"===B&&(f=-32767);let l=256;["u16","s16"].includes(B)&&(l=65536);var r=[],q=[];const w=a-E;for(c=0;c<d;c++)q[c]=y[c]-k[c],r[c]=0===q[c]?0:w/q[c];
let p;const z=[];let I,G;if(h&&h.length>=d)for(r=n(d,h),c=0;c<d;c++){G=[];for(b=0;b<l;b++)if(0===q[c])G[b]=E;else{var R=b+f;p=(R-k[c])/q[c];I=1;1<h[c]&&(I-=(1/w)**(p*r[c]));R<y[c]&&R>k[c]?(R=I*w*p**(1/h[c])+E,G[b]="floor"===D?Math.floor(R):"round"===D?Math.round(R):R):G[b]=R>=y[c]?a:E}z[c]=G}else for(c=0;c<d;c++){G=[];for(b=0;b<l;b++)R=b+f,R<=k[c]?G[b]=E:R>=y[c]?G[b]=a:(q=(R-k[c])*r[c]+E,G[b]="floor"===D?Math.floor(q):"round"===D?Math.round(q):q);z[c]=G}if(null!=g.contrastOffset)for(g=N(g.contrastOffset,
g.brightnessOffset),c=0;c<d;c++)for(G=z[c],b=0;b<l;b++)G[b]=g[G[b]];return{lut:z,offset:f}};m.estimateStatisticsFromHistograms=function(g){const k=[];for(let D=0;D<g.length;D++){const {min:E,max:a,size:d,counts:c}=g[D];let b=0;var y=0;for(var h=0;h<d;h++)b+=c[h],y+=h*c[h];y/=b;h=0;for(var B=0;B<d;B++)h+=c[B]*(B-y)**2;B=(a-E)/d;k.push({min:E,max:a,avg:(y+.5)*B+E,stddev:Math.sqrt(h/(b-1))*B})}return k};m.estimateStatisticsHistograms=H;m.getStretchCutoff=function(g,k){const {pixelBlock:y,bandIds:h,returnHistogramLut:B,
rasterInfo:D}=k;var E=null;k=null;var a=g.stretchType;"number"===typeof a&&(a=F.stretchTypeFunctionEnum[a]);g.dra?"minMax"===a&&y?.statistics?E=y.statistics.map(R=>[R.minValue,R.maxValue,0,0]):(k=H(y),E=null!=k?k.statistics:null,k=null!=k?k.histograms:null):(E=g.statistics?.length?g.statistics:D.statistics,k="histograms"in g?g.histograms:void 0,k||(k=D.histograms));"percentClip"!==a&&"histogramEqualization"!==a||k?.length||(a="minMax");var d=E?.length||k?.length||D.bandCount;const c=[],b=[];let f,
l,r;E&&!Array.isArray(E[0])&&(E=E.map(R=>[R.min,R.max,R.avg,R.stddev]));const [q,w]=K.getPixelValueRange(D.pixelType);if(!E?.length){E=[];for(l=0;l<d;l++)E.push([q,w,1,1]);"standardDeviation"===a&&(a="minMax")}switch(a){case "none":for(l=0;l<d;l++)c[l]=q,b[l]=w;break;case "minMax":for(l=0;l<d;l++){var p=E[l];c[l]=p[0];b[l]=p[1]}break;case "standardDeviation":({numberOfStandardDeviations:p=2}=g);for(l=0;l<d;l++){var z=E[l];c[l]=z[2]-p*z[3];b[l]=z[2]+p*z[3];c[l]<z[0]&&(c[l]=z[0]);b[l]>z[1]&&(b[l]=z[1])}break;
case "histogramEqualization":x.assertIsSome(k);for(l=0;l<d;l++)c[l]=k[l].min,b[l]=k[l].max;break;case "percentClip":x.assertIsSome(k);for(l=0;l<k.length;l++){E=k[l];z=new Uint32Array(E.size);var I=[...E.counts];20<=I.length&&(I[0]=I[1]=I[2]=I[I.length-1]=I[I.length-2]=0);p=0;d=(E.max-E.min)/E.size;f=-.5===E.min&&1===d?.5:0;for(r=0;r<E.size;r++)p+=I[r],z[r]=p;I=(g.minPercent||0)*p/100;c[l]=E.min+f;for(r=0;r<E.size;r++)if(z[r]>I){c[l]=E.min+d*(r+f);break}I=(1-(g.maxPercent||0)/100)*p;b[l]=E.max+f;for(r=
E.size-2;0<=r;r--)if(z[r]<I){b[l]=E.min+d*(r+2-f);break}b[l]<c[l]&&(E=c[l],c[l]=b[l],b[l]=E)}break;default:for(l=0;l<d;l++)p=E[l],c[l]=p[0],b[l]=p[1]}let G;"histogramEqualization"===a?(x.assertIsSome(k),a=k[0].size||256,g=0,B&&(G=k.map(R=>T(R)))):(a=g.max||255,g=g.min||0);return v({minCutOff:c,maxCutOff:b,outMax:a,outMin:g,histogramLut:G},h)};m.stretch=function(g,k){if(!g?.pixels?.length)return g;const {mask:y,bandMasks:h,width:B,height:D,pixels:E}=g,{minCutOff:a,maxCutOff:d,gamma:c}=k;var b=k.outMin||
0;const f=k.outMax||255,l=B*D,r=k.outputPixelType||"u8";g=g.pixels.map(()=>u.createEmptyBand(r,l));const q=g.length;var w=f-b,p=[],z=[];for(var I=0;I<q;I++)z[I]=d[I]-a[I],p[I]=0===z[I]?0:w/z[I];I=r.startsWith("u")||r.startsWith("s");k=!!k.isRenderer;if(c&&c.length>=q){p=n(q,c);for(var G=0;G<q;G++){var R=h?.[G]??y;for(let V=0;V<l;V++)if(null==R||R[V]){if(0===z[G]){g[G][V]=b;continue}var J=E[G][V];const A=(J-a[G])/z[G];let C=1;1<c[G]&&(C-=(1/w)**(A*p[G]));J<d[G]&&J>a[G]?(J=C*w*A**(1/c[G])+b,g[G][V]=
k?Math.floor(J):I?Math.round(J):J):g[G][V]=J>=d[G]?f:b}}}else for(w=0;w<q;w++)for(z=h?.[w]??y,G=0;G<l;G++)if(null==z||z[G])R=E[w][G],R<d[w]&&R>a[w]?(R=(R-a[w])*p[w]+b,g[w][G]=k?Math.floor(R):I?Math.round(R):R):g[w][G]=R>=d[w]?f:b;b=new u({width:B,height:D,mask:y,bandMasks:h,pixels:g,pixelType:r});b.updateStatistics();return b};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/stretchRendererUtils":function(){define(["exports","../../core/jsonMap"],function(m,
x){x=new x.JSONMap({none:"none",standardDeviation:"standard-deviation",histogramEqualization:"histogram-equalization",minMax:"min-max",percentClip:"percent-clip",sigmoid:"sigmoid"});m.stretchTypeFunctionEnum={0:"none",3:"standardDeviation",4:"histogramEqualization",5:"minMax",6:"percentClip",9:"sigmoid"};m.stretchTypeJSONDict=x;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/ConvolutionFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../rasterFunctionConstants ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./ConvolutionFunctionArguments ./convolutionUtils".split(" "),
function(m,x,u,K,F,T,N,M,H,v,n){u=class extends H{constructor(){super(...arguments);this.functionName="Convolution";this.rasterArgumentNames=["raster"]}get _normalizedKernel(){const {kernel:e,convolutionType:g}=this.functionArguments,k=e.reduce((y,h)=>y+h);return-1===g||0===k||1===k?e:e.map(y=>y/k)}_bindSourceRasters(){const {convolutionType:e,rows:g,cols:k,kernel:y}=this.functionArguments;if(!Object.values(N.convolutionKernel).includes(e))return{success:!1,supportsGPU:!1,error:`convolution-function: the specified kernel type is not supported ${e}`};
if(e!==N.convolutionKernel.none&&g*k!==y.length)return{success:!1,supportsGPU:!1,error:"convolution-function: the specified rows and cols do not match the length of the kernel"};var h=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType(h.pixelType);h=h.clone();h.pixelType=this.outputPixelType;const B=[N.convolutionKernel.none,N.convolutionKernel.sharpen,N.convolutionKernel.sharpen2,N.convolutionKernel.sharpening3x3,N.convolutionKernel.sharpening5x5];if(-1===e||"u8"!==this.outputPixelType&&
!B.includes(e))h.statistics=null,h.histograms=null;h.colormap=null;h.attributeTable=null;this.rasterInfo=h;return{success:!0,supportsGPU:25>=y.length}}_processPixels(e){e=e.pixelBlocks?.[0];if(null==e||this.functionArguments.convolutionType===N.convolutionKernel.none)return e;const {rows:g,cols:k}=this.functionArguments,{_normalizedKernel:y}=this;return n.convolute(e,{kernel:y,rows:g,cols:k,outputPixelType:this.outputPixelType})}_getWebGLParameters(){const e=new Float32Array(25);e.set(this._normalizedKernel);
return{kernelRows:this.functionArguments.rows,kernelCols:this.functionArguments.cols,kernel:e,clampRange:M.getPixelValueRange(this.outputPixelType)}}};m.__decorate([x.property({json:{write:!0,name:"rasterFunction"}})],u.prototype,"functionName",void 0);m.__decorate([x.property({type:v,json:{write:!0,name:"rasterFunctionArguments"}})],u.prototype,"functionArguments",void 0);m.__decorate([x.property()],u.prototype,"rasterArgumentNames",void 0);m.__decorate([x.property()],u.prototype,"_normalizedKernel",
null);return u=m.__decorate([T.subclass("esri.layers.support.rasterFunctions.ConvolutionFunction")],u)})},"esri/layers/support/rasterFunctions/ConvolutionFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../rasterFunctionConstants ./BaseFunctionArguments ./convolutionUtils".split(" "),function(m,x,u,K,F,T,N,M,H){var v;K=v=class extends M{constructor(){super(...arguments);
this.cols=this.rows=3;this.kernel=[0,0,0,0,1,0,0,0,0]}set convolutionType(n){this._set("convolutionType",n);const e=H.convolutionKernels.get(n);e&&n!==N.convolutionKernel.userDefined&&n!==N.convolutionKernel.none&&(n=Math.sqrt(e.length),this._set("kernel",e),this._set("cols",n),this._set("rows",n))}clone(){return new v({cols:this.cols,rows:this.rows,kernel:[...this.kernel],convolutionType:this.convolutionType,raster:x.clone(this.raster)})}};m.__decorate([u.property({json:{type:Number,write:!0}})],
K.prototype,"rows",void 0);m.__decorate([u.property({json:{type:Number,write:!0}})],K.prototype,"cols",void 0);m.__decorate([u.property({json:{name:"type",type:Number,write:!0}})],K.prototype,"convolutionType",null);m.__decorate([u.property({json:{type:[Number],write:!0}})],K.prototype,"kernel",void 0);return K=v=m.__decorate([T.subclass("esri.layers.support.rasterFunctions.ConvolutionFunctionArguments")],K)})},"esri/layers/support/rasterFunctions/convolutionUtils":function(){define(["exports","../PixelBlock",
"../rasterFunctionConstants","./mirror"],function(m,x,u,K){function F(v){const n=Math.sqrt(v.length),e=v.slice(0,n),g=[1];for(let k=1;k<n;k++){let y=null;for(let h=0;h<n;h++){const B=v[h+k*n],D=v[h];if(null==y)if(0===D){if(B)return{separable:!1,row:null,col:null}}else y=B/D;else if(B/D!==y)return{separable:!1,row:null,col:null}}if(null==y)return{separable:!1,row:null,col:null};g.push(y)}return{separable:!0,row:e,col:g}}function T(v,n,e,g,k,y,h){const B=new Float32Array(n*e),D=y.length,E=h?0:g,a=h?
g:0;h=h?1:n;for(let d=E;d<e-E;d++){const c=d*n;for(let b=a;b<n-a;b++){if(k&&!k[c+b])continue;let f=0;for(let l=0;l<D;l++)f+=v[c+b+(l-g)*h]*y[l];B[c+b]=f}}return B}function N(v,n,e=!0){const {pixels:g,width:k,height:y,pixelType:h,mask:B}=v;v=g.length;const D=[],{kernel:E,rows:a,cols:d}=n;for(n=0;n<v;n++){var c=g[n],b=k,f=y,l=a,r=d,q=B,w=E;const p=new Float32Array(b*f),z=Math.floor(l/2),I=Math.floor(r/2);for(let G=z;G<f-z;G++){const R=G*b;for(let J=I;J<b-I;J++){if(q&&!q[R+J])continue;let V=0;for(let A=
0;A<l;A++)for(let C=0;C<r;C++)V+=c[R+J+(A-z)*b+C-I]*w[A*r+C];p[R+J]=V}}c=p;e&&K.mirror(c,k,y,a,d);D.push(c)}return new x({width:k,height:y,pixelType:h,pixels:D,mask:B})}function M(v,n,e,g=!0){const {pixels:k,width:y,height:h,pixelType:B,mask:D}=v;v=k.length;const E=[],a=n.length,d=e.length,c=Math.floor(a/2),b=Math.floor(d/2);for(let f=0;f<v;f++){let l=T(k[f],y,h,c,D,n,!0);l=T(l,y,h,b,D,e,!1);g&&K.mirror(l,y,h,a,d);E.push(l)}return new x({width:y,height:h,pixelType:B,pixels:E,mask:D})}const H=new Map;
H.set(u.convolutionKernel.none,[0,0,0,0,1,0,0,0,0]);H.set(u.convolutionKernel.lineDetectionHorizontal,[-1,-1,-1,2,2,2,-1,-1,-1]);H.set(u.convolutionKernel.lineDetectionVertical,[-1,2,-1,-1,2,-1,-1,2,-1]);H.set(u.convolutionKernel.lineDetectionLeftDiagonal,[2,-1,-1,-1,2,-1,-1,-1,2]);H.set(u.convolutionKernel.lineDetectionRightDiagonal,[-1,-1,2,-1,2,-1,2,-1,-1]);H.set(u.convolutionKernel.gradientNorth,[-1,-2,-1,0,0,0,1,2,1]);H.set(u.convolutionKernel.gradientWest,[-1,0,1,-2,0,2,-1,0,1]);H.set(u.convolutionKernel.gradientEast,
[1,0,-1,2,0,-2,1,0,-1]);H.set(u.convolutionKernel.gradientSouth,[1,2,1,0,0,0,-1,-2,-1]);H.set(u.convolutionKernel.gradientNorthEast,[0,-1,-2,1,0,-1,2,1,0]);H.set(u.convolutionKernel.gradientNorthWest,[-2,-1,0,-1,0,1,0,1,2]);H.set(u.convolutionKernel.smoothArithmeticMean,[.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111]);H.set(u.convolutionKernel.smoothing3x3,[.0625,.125,.0625,.125,.25,.125,.0625,.125,.0625]);H.set(u.convolutionKernel.smoothing5x5,
[1,1,1,1,1,1,4,4,4,1,1,4,12,4,1,1,4,4,4,1,1,1,1,1,1]);H.set(u.convolutionKernel.sharpening3x3,[-1,-1,-1,-1,9,-1,-1,-1,-1]);H.set(u.convolutionKernel.sharpening5x5,[-1,-3,-4,-3,-1,-3,0,6,0,-3,-4,6,21,6,-4,-3,0,6,0,-3,-1,-3,-4,-3,-1]);H.set(u.convolutionKernel.laplacian3x3,[0,-1,0,-1,4,-1,0,-1,0]);H.set(u.convolutionKernel.laplacian5x5,[0,0,-1,0,0,0,-1,-2,-1,0,-1,-2,17,-2,-1,0,-1,-2,-1,0,0,0,-1,0,0]);H.set(u.convolutionKernel.sobelHorizontal,[-1,-2,-1,0,0,0,1,2,1]);H.set(u.convolutionKernel.sobelVertical,
[-1,0,1,-2,0,2,-1,0,1]);H.set(u.convolutionKernel.sharpen,[0,-.25,0,-.25,2,-.25,0,-.25,0]);H.set(u.convolutionKernel.sharpen2,[-.25,-.25,-.25,-.25,3,-.25,-.25,-.25,-.25]);H.set(u.convolutionKernel.pointSpread,[-.627,.352,-.627,.352,2.923,.352,-.627,.352,-.627]);m.convolute=function(v,n){const e=F(n.kernel),g=!1!==n.mirrorEdges;v=e.separable?M(v,e.row,e.col,g):N(v,n,g);({outputPixelType:n}=n);n&&v.clamp(n);return v};m.convoluteSeparable=M;m.convolutionKernels=H;m.separateKernels=F;Object.defineProperty(m,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/mirror":function(){define(["exports"],function(m){m.mirror=function(x,u,K,F,T){F=Math.floor(F/2);for(var N=0;N<F;N++)for(var M=0;M<u;M++)x[N*u+M]=x[(T-1-N)*u+M],x[(K-1-N)*u+M]=x[(K-T+N)*u+M];F=Math.floor(T/2);for(N=0;N<K;N++){M=N*u;for(let H=0;H<F;H++)x[M+H]=x[M+T-1-H],x[M+u-H-1]=x[M+u+H-T]}};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/CurvatureFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./CurvatureFunctionArguments ./surfaceUtils".split(" "),
function(m,x,u,K,F,T,N,M,H){u=class extends N{constructor(){super(...arguments);this.functionName="Curvature";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.isGCS=!1}_bindSourceRasters(){this.outputPixelType=this._getOutputPixelType("f32");const v=this.sourceRasterInfos[0].clone();v.pixelType=this.outputPixelType;v.bandCount=1;this._removeStatsHistColormapVAT(v);this.rasterInfo=v;this.isGCS=v.spatialReference?.isGeographic??!1;return{success:!0,supportsGPU:!0}}_processPixels(v){const n=
v.pixelBlocks?.[0];if(null==n)return null;const {zFactor:e,curvatureType:g}=this.functionArguments,{extent:k,primaryPixelSizes:y}=v;v=y?.[0];return H.curvature(n,{zFactor:this.isGCS&&1<=e?e*H.gcsFactor:e,curvatureType:g,resolution:null==v?k?{x:k.width/n.width,y:k.height/n.height}:{x:1,y:1}:v})}_getWebGLParameters(){const {zFactor:v,curvatureType:n}=this.functionArguments;return{curvatureType:n,zFactor:this.isGCS&&1<=v?v*H.gcsFactor:v}}};m.__decorate([x.property({json:{write:!0,name:"rasterFunction"}})],
u.prototype,"functionName",void 0);m.__decorate([x.property({type:M,json:{write:!0,name:"rasterFunctionArguments"}})],u.prototype,"functionArguments",void 0);m.__decorate([x.property()],u.prototype,"rasterArgumentNames",void 0);m.__decorate([x.property({json:{write:!0}})],u.prototype,"isGCS",void 0);return u=m.__decorate([T.subclass("esri.layers.support.rasterFunctions.CurvatureFunction")],u)})},"esri/layers/support/rasterFunctions/CurvatureFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(m,x,u,K,F,T,N,M,H,v){var n;const e=new x.JSONMap({0:"standard",1:"platform",2:"profile"},{useNumericKeys:!0});x=n=class extends v{constructor(){super(...arguments);this.curvatureType="standard";this.zFactor=1}readCurvatureType(g,k){return e.fromJSON(k.type??k.curvatureType??0)}clone(){return new n({curvatureType:this.curvatureType,zFactor:this.zFactor,raster:this.raster})}};m.__decorate([u.property({json:{write:{target:"type"}}}),N.enumeration(e)],x.prototype,"curvatureType",void 0);m.__decorate([M.reader("curvatureType",
["type","curvatureType"])],x.prototype,"readCurvatureType",null);m.__decorate([u.property({type:Number,json:{write:!0}})],x.prototype,"zFactor",void 0);return x=n=m.__decorate([H.subclass("esri.layers.support.rasterFunctions.CurvatureFunctionArguments")],x)})},"esri/layers/support/rasterFunctions/ExtractBandFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./bandIndexUtils ./BaseRasterFunction ./ExtractBandFunctionArguments ./pixelUtils".split(" "),
function(m,x,u,K,F,T,N,M,H,v){function n(k,y){k=k.bandInfos.map(({name:B})=>B.toLowerCase());const h=[];for(let B=0;B<y.length;B++){const D=y[B].toLowerCase();let E=k.indexOf(D);-1===E&&"nearinfrared"===D&&(E=k.findIndex(a=>a.startsWith("nearinfrared_1")),-1===E&&(E=k.findIndex(a=>a.startsWith("nearinfrared"))));if(-1===E)return null;h.push(E)}return h}function e(k,y,h){const {bandCount:B}=k;return!y?.length||h&&y.some(D=>0>D||D>=B)?null:y}function g(k,y,{wavelengthMatchTolerance:h},B){var {bandInfos:D}=
k;k=[];for(var E=0;E<D.length;E++){const {minWavelength:a,maxWavelength:d}=D[E];if(!a||!d)return null;k.push({minWavelength:a,maxWavelength:d})}D=[];for(E=0;E<y.length;E++){const a=y[E];let d=!1,c=-1,b=Number.MAX_VALUE;for(let f=0;f<k.length;f++){const l=k[f],r=Math.abs(a-(l.minWavelength+l.maxWavelength)/2);a>=l.minWavelength&&a<=l.maxWavelength?r<b&&(d=!0,c=f,b=r):!d&&r<b&&(c=f,b=r)}!d&&h&&b<h&&(d=!0);if(!d&&B)return null;D.push(c)}return D}u=class extends M{constructor(){super(...arguments);this.functionName=
"ExtractBand";this.functionArguments=null;this.rasterArgumentNames=["raster"]}_bindSourceRasters(){const {functionArguments:k,sourceRasterInfos:y}=this;var h=y[0];const {method:B,bandNames:D,bandWavelengths:E,bandIds:a,missingBandAction:d}=k,c=D?.length&&("name"===B||"id"!==B&&!a?.length),b=E?.length&&("wavelength"===B||"id"!==B&&!a?.length);var f=d===v.MissingBandAction.fail;f=c?n(h,D):b?g(h,E,this.functionArguments,f):e(h,a,f);if(null==f)return{success:!1,supportsGPU:!1,error:`extract-band-function: Invalid ${c?
"band names":b?"band wavelengths":"band ids"} for the imagery data source`};this.functionArguments.bandIds=f;this.functionArguments.method="id";this.outputPixelType=this._getOutputPixelType("f32");h=h.clone();h.pixelType=this.outputPixelType;h.bandCount=f.length;const {statistics:l,histograms:r}=h;null!=l&&l.length&&(h.statistics=f.map(w=>l[w]||l[l.length-1]));null!=r&&r.length&&(h.histograms=f.map(w=>r[w]||r[r.length-1]));let q=h.keyProperties?.BandProperties;q?.length&&(q=f.map(w=>w>=q.length?q[q.length-
1]:q[w]),h.keyProperties={...h.keyProperties,BandProperties:q});this.rasterInfo=h;return{success:!0,supportsGPU:3>=h.bandCount}}_processPixels(k){k=k.pixelBlocks?.[0];if(null==k)return null;const y=k.pixels.length,h=this.functionArguments.bandIds.map(B=>B>=y?y-1:B);return k.extractBands(h)}_getWebGLParameters(){let k;if(this.isInputBandIdsSwizzled)k=this.swizzledBandSelection.length?this.swizzledBandSelection:[0,1,2];else{k=[...this.functionArguments.bandIds];0===k.length?k=[0,1,2]:3>k.length&&(k[1]=
k[1]??k[0],k[2]=k[2]??k[1]);for(let y=0;3>y;y++)k[y]=Math.min(k[y],2)}return{bandIndexMat3:N.getBandMatrix3(k)}}_getInputBandIds(k){const y=k.length;return this.functionArguments.bandIds.map(h=>h>=y?y-1:h).map(h=>k[h])}};m.__decorate([x.property({json:{write:!0,name:"rasterFunction"}})],u.prototype,"functionName",void 0);m.__decorate([x.property({type:H,json:{write:!0,name:"rasterFunctionArguments"}})],u.prototype,"functionArguments",void 0);m.__decorate([x.property()],u.prototype,"rasterArgumentNames",
void 0);return u=m.__decorate([T.subclass("esri.layers.support.rasterFunctions.ExtractBandFunction")],u)})},"esri/layers/support/rasterFunctions/ExtractBandFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ./pixelUtils".split(" "),function(m,x,u,K,
F,T,N,M,H){var v;u=v=class extends M{constructor(){super(...arguments);this.bandIds=[];this.bandNames=[];this.bandWavelengths=[];this.missingBandAction=H.MissingBandAction.bestMatch}clone(){return new v({bandIds:this.bandIds?.slice(),bandNames:this.bandNames?.slice(),bandWavelengths:this.bandWavelengths?.slice(),missingBandAction:this.missingBandAction,method:this.method,wavelengthMatchTolerance:this.wavelengthMatchTolerance})}};m.__decorate([x.property({json:{write:!0}})],u.prototype,"bandIds",void 0);
m.__decorate([x.property({json:{write:!0}})],u.prototype,"bandNames",void 0);m.__decorate([x.property({json:{write:!0}})],u.prototype,"bandWavelengths",void 0);m.__decorate([T.enumeration({0:"name",1:"wavelength",2:"id"})],u.prototype,"method",void 0);m.__decorate([x.property({json:{write:!0}})],u.prototype,"missingBandAction",void 0);m.__decorate([x.property({json:{write:!0}})],u.prototype,"wavelengthMatchTolerance",void 0);return u=v=m.__decorate([N.subclass("esri.layers.support.rasterFunctions.ExtractBandFunctionArguments")],
u)})},"esri/layers/support/rasterFunctions/GrayscaleFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./conversionUtils ./GrayscaleFunctionArguments".split(" "),function(m,x,u,K,F,T,N,M,H){u=class extends N{constructor(){super(...arguments);this.functionName="Grayscale";this.functionArguments=null;this.rasterArgumentNames=
["raster"]}get _normalizedWeights(){const {conversionParameters:v}=this.functionArguments,n=v.reduce((e,g)=>e+g);return v.map(e=>e/n)}_bindSourceRasters(){var {conversionParameters:v}=this.functionArguments;if(!v?.length)return{success:!1,supportsGPU:!1,error:"missing valid conversion parameters."};const n=this.sourceRasterInfos[0].clone();this.outputPixelType=this._getOutputPixelType(n.pixelType);n.pixelType=this.outputPixelType;v=3===v.length||3===n.bandCount&&3<v.length;n.bandCount=1;this._removeStatsHistColormapVAT(n);
this.rasterInfo=n;return{success:!0,supportsGPU:v}}_processPixels(v){v=v.pixelBlocks?.[0];return null==v?null:M.grayscale(v,this._normalizedWeights,this.outputPixelType)}_getWebGLParameters(){return{weights:this._normalizedWeights}}};m.__decorate([x.property({json:{write:!0,name:"rasterFunction"}})],u.prototype,"functionName",void 0);m.__decorate([x.property({type:H,json:{write:!0,name:"rasterFunctionArguments"}})],u.prototype,"functionArguments",void 0);m.__decorate([x.property()],u.prototype,"rasterArgumentNames",
void 0);m.__decorate([x.property()],u.prototype,"_normalizedWeights",null);return u=m.__decorate([T.subclass("esri.layers.support.rasterFunctions.GrayscaleFunction")],u)})},"esri/layers/support/rasterFunctions/conversionUtils":function(){define(["exports","../PixelBlock","../rasterFormats/pixelRangeUtils"],function(m,x,u){m.grayscale=function(K,F,T){const {pixels:N,width:M,height:H,mask:v,bandMasks:n}=K;var e=M*H;const g=n?.length?x.combineBandMasks(n):v,k=Math.min(F.length,N.length),y=T.startsWith("f");
K=!y&&T!==K.pixelType;const [h,B]=u.getPixelValueRange(T);e=x.createEmptyBand(T,e);for(let D=0;D<H;D++){let E=D*M;for(let a=0;a<M;a++,E++)if(!g||g[E]){let d=0;for(let c=0;c<k;c++)d+=F[c]*N[c][E];y||(d=Math.round(d),K&&(d=d>B?B:d<h?h:d));e[E]=d}}F=new x({width:M,height:H,pixels:[e],pixelType:T,mask:g});F.updateStatistics();return F};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/GrayscaleFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(m,x,u,K,F,T,N){var M;u=M=class extends N{clone(){return new M({conversionParameters:[...this.conversionParameters],raster:this.raster})}};m.__decorate([x.property({type:[Number],json:{write:!0}})],u.prototype,"conversionParameters",void 0);return u=M=m.__decorate([T.subclass("esri.layers.support.rasterFunctions.GrayscaleFunctionArguments")],u)})},"esri/layers/support/rasterFunctions/LocalFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../rasterFunctionConstants ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./LocalFunctionArguments ./localUtils".split(" "),
function(m,x,u,K,F,T,N,M,H,v,n){u=class extends H{constructor(){super(...arguments);this.functionName="Local";this.functionArguments=null;this.rasterArgumentNames=["rasters"]}_bindSourceRasters(){var {sourceRasterInfos:e}=this,g=e[0];const {bandCount:k}=g,{processAsMultiband:y}=this.functionArguments;if(e.some(D=>D.bandCount!==k))return{success:!1,supportsGPU:!1,error:"local-function: input rasters do not have same band count"};const {operation:h,rasters:B}=this.functionArguments;e=n.operandsCount[h];
if(!(999===e||B.length===e||1>=B.length&&1===e))return{success:!1,supportsGPU:!1,error:`local-function: the length of functionArguments.rasters does not match operation's requirement: ${e}`};g=g.clone();g.bandCount=999!==e||y?k:1;this._removeStatsHistColormapVAT(g);this._updateStatistics(g);this._updatePixelType(g);this.rasterInfo=g;return{success:!0,supportsGPU:1===g.bandCount&&3>=e&&(11>h||16<h)}}_processPixels(e){({pixelBlocks:e}=e);return null==e||e.some(g=>null==g)?null:n.local(e,this.functionArguments.operation,
{processAsMultiband:this.functionArguments.processAsMultiband,outputPixelType:this.outputPixelType??void 0})}_getWebGLParameters(){const {operation:e}=this.functionArguments,g=n.operandsCount[e],k=Object.keys(N.localOperators).find(D=>N.localOperators[D]===e)?.toLowerCase()??"undefined";var y=this.outputPixelType??"f32";let [h,B]=M.getPixelValueRange(y);if(y=M.isIntegerPixelType(y))h-=1E-4,B+=1E-4;return{imageCount:g,operationName:k,domainRange:[h,B],isOutputRounded:y}}_updateStatistics(e){var g=
this.sourceRasterInfos[0];const {operation:k}=this.functionArguments,y=n.getOutputDomain(k)?.domain;if(y)for(e.statistics=[],g=0;g<e.bandCount;g++)e.statistics[g]={min:y[0],max:y[1],avg:(y[0]+y[1])/2,stddev:(y[0]+y[1])/10};else 45===k&&g.statistics?.length&&(e.statistics=g.statistics.map(h=>({min:-h.max,max:-h.min,avg:null!=h.avg?-h.avg:void 0,stddev:null!=h.stddev?-h.stddev:void 0})))}_updatePixelType(e){const {statistics:g,pixelType:k}=this.sourceRasterInfos[0];var {operation:y}=this.functionArguments;
const {domain:h,isInteger:B}=n.getOutputDomain(y)??{domain:null,isInteger:!1};var D="f32";h&&B?D=M.getIntegerPixelType(h[0],h[1]):30===y?D=(y=g?.[0])?M.getIntegerPixelType(y.min,y.max):M.isIntegerPixelType(k)?k:"s32":45===y&&M.isIntegerPixelType(k)&&(D=g?.map(({max:E})=>-E),y=g?.map(({min:E})=>-E),D=D?.length?Math.min(...D):null,y=y?.length?Math.min(...y):null,D=null!=D&&null!=y?M.getIntegerPixelType(D,y):k.startsWith("s")?k.replace("s","u"):"u1"===k||"u2"===k||"u4"===k?"s8":"u8"===k?"s16":"s32");
e.pixelType=this.outputPixelType=this._getOutputPixelType(D)}};m.__decorate([x.property({json:{write:!0,name:"rasterFunction"}})],u.prototype,"functionName",void 0);m.__decorate([x.property({type:v,json:{write:!0,name:"rasterFunctionArguments"}})],u.prototype,"functionArguments",void 0);m.__decorate([x.property()],u.prototype,"rasterArgumentNames",void 0);return u=m.__decorate([T.subclass("esri.layers.support.rasterFunctions.LocalFunction")],u)})},"esri/layers/support/rasterFunctions/LocalFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),
function(m,x,u,K,F,T,N,M){var H;K=H=class extends M{constructor(){super(...arguments);this.rasters=[];this.processAsMultiband=!0}writeRasters(v,n){n.rasters=v.map(e=>"number"===typeof e||"string"===typeof e?e:e.toJSON())}clone(){return new H({operation:this.operation,processAsMultiband:this.processAsMultiband,rasters:x.clone(this.rasters)})}};m.__decorate([u.property({json:{write:!0}})],K.prototype,"operation",void 0);m.__decorate([u.property({json:{write:!0}})],K.prototype,"rasters",void 0);m.__decorate([N.writer("rasters")],
K.prototype,"writeRasters",null);m.__decorate([u.property({json:{write:!0}})],K.prototype,"processAsMultiband",void 0);return K=H=m.__decorate([T.subclass("esri.layers.support.rasterFunctions.LocalFunctionArguments")],K)})},"esri/layers/support/rasterFunctions/MaskFunction":function(){define("../../../chunks/tslib.es6 ../../../core/mathUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./MaskFunctionArguments ./pixelUtils".split(" "),
function(m,x,u,K,F,T,N,M,H,v){K=class extends M{constructor(){super(...arguments);this.functionName="Mask";this.functionArguments=null;this.rasterArgumentNames=["raster"]}_bindSourceRasters(){var n=this.sourceRasterInfos[0].clone();const {pixelType:e}=n;this.outputPixelType=this._getOutputPixelType(e);n.pixelType=this.outputPixelType;this.rasterInfo=n;const {includedRanges:g,normalizedNoDataValues:k}=this.functionArguments;if(!g?.length&&!k?.length)return{success:!1,supportsGPU:!1,error:"missing includedRanges or noDataValues argument"};
let y=[];for(let h=0;h<n.bandCount;h++){const B=v.createMaskLUT(e,g?.slice(2*h,2*h+2),k?.[h]);if(null==B){y=null;break}y.push(B)}this.lookups=y;n=null!=k&&k.every(h=>h?.length===k[0]?.length);return{success:!0,supportsGPU:(!g||g.length<=2*v.maxMapSizeGpu)&&(!k||n&&k[0].length<=v.maxMapSizeGpu)}}_processPixels(n){n=n.pixelBlocks?.[0];if(null==n)return null;const {outputPixelType:e,lookups:g}=this,{includedRanges:k,noDataInterpretation:y,normalizedNoDataValues:h}=this.functionArguments;return v.mask(n,
{includedRanges:k,noDataValues:h,outputPixelType:e,matchAll:y===v.NoDataInterpretation.matchAll,lookups:g})}_getWebGLParameters(){const {includedRanges:n,normalizedNoDataValues:e}=this.functionArguments,g=new Float32Array(v.maxMapSizeGpu);g.fill(x.numberMaxFloat32);e?.[0]?.length&&g.set(e[0]);const k=new Float32Array(v.maxMapSizeGpu);for(let y=0;y<k.length;y+=2)k[y]=n?.[y]??-x.numberMaxFloat32,k[y+1]=n?.[y+1]??x.numberMaxFloat32;n?.length&&k.set(n);return{bandCount:this.sourceRasterInfos[0].bandCount,
noDataValues:g,includedRanges:k}}};m.__decorate([u.property({json:{write:!0,name:"rasterFunction"}})],K.prototype,"functionName",void 0);m.__decorate([u.property({type:H,json:{write:!0,name:"rasterFunctionArguments"}})],K.prototype,"functionArguments",void 0);m.__decorate([u.property()],K.prototype,"rasterArgumentNames",void 0);m.__decorate([u.property({json:{write:!0}})],K.prototype,"lookups",void 0);return K=m.__decorate([N.subclass("esri.layers.support.rasterFunctions.MaskFunction")],K)})},"esri/layers/support/rasterFunctions/MaskFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ./pixelUtils".split(" "),
function(m,x,u,K,F,T,N,M){var H;u=H=class extends N{constructor(){super(...arguments);this.noDataValues=this.includedRanges=null;this.noDataInterpretation=M.NoDataInterpretation.matchAny}get normalizedNoDataValues(){var {noDataValues:v}=this;if(!v?.length)return null;let n=!1;v=v.map(e=>"number"===typeof e?(n=!0,[e]):"string"===typeof e?(e=e.trim().split(" ").filter(g=>""!==g.trim()).map(g=>Number(g)),n=n||0<e.length,0===e.length?null:e):null);return n?v:null}clone(){return new H({includedRanges:this.includedRanges?.slice()??
[],noDataValues:this.noDataValues?.slice()??[],noDataInterpretation:this.noDataInterpretation})}};m.__decorate([x.property({json:{write:!0}})],u.prototype,"includedRanges",void 0);m.__decorate([x.property({json:{write:!0}})],u.prototype,"noDataValues",void 0);m.__decorate([x.property()],u.prototype,"normalizedNoDataValues",null);m.__decorate([x.property({json:{write:!0}})],u.prototype,"noDataInterpretation",void 0);return u=H=m.__decorate([T.subclass("esri.layers.support.rasterFunctions.MaskFunctionArguments")],
u)})},"esri/layers/support/rasterFunctions/NDVIFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./bandIndexUtils ./BaseRasterFunction ./NDVIFunctionArguments".split(" "),function(m,x,u,K,F,T,N,M,H){u=class extends M{constructor(){super(...arguments);this.functionName="NDVI";this.functionArguments=null;this.rasterArgumentNames=["raster"]}_bindSourceRasters(){const {scientificOutput:v,
visibleBandID:n,infraredBandID:e}=this.functionArguments;this.outputPixelType=this._getOutputPixelType(v?"f32":"u8");var g=this.sourceRasterInfos[0];const k=Math.max(n,e);if(2>g.bandCount||k>=g.bandCount)return{success:!1,supportsGPU:!1,error:"ndvi-function: source raster has insufficient amount of raster bands"};g=g.clone();g.pixelType=this.outputPixelType;g.colormap=null;g.histograms=null;g.bandCount=1;g.keyProperties={...g.keyProperties,BandProperties:void 0};const [y,h,B,D]=v?[-1,1,0,.1]:[0,200,
100,10];g.statistics=[{min:y,max:h,avg:B,stddev:D}];this.rasterInfo=g;return{success:!0,supportsGPU:!0}}_processPixels(v){v=v.pixelBlocks?.[0];if(null==v)return null;const {visibleBandID:n,infraredBandID:e,scientificOutput:g}=this.functionArguments;return N.calculateNDVI(v,n,e,!g)}_getWebGLParameters(){const {visibleBandID:v,infraredBandID:n,scientificOutput:e}=this.functionArguments;return{bandIndexMat3:N.getBandMatrix3(this.isInputBandIdsSwizzled?[0,1,2]:[n,v,0]),scaled:!e}}_getInputBandIds(v){const {visibleBandID:n,
infraredBandID:e}=this.functionArguments;return[e,n,0].map(g=>v[g])}};m.__decorate([x.property({json:{write:!0,name:"rasterFunction"}})],u.prototype,"functionName",void 0);m.__decorate([x.property({type:H,json:{write:!0,name:"rasterFunctionArguments"}})],u.prototype,"functionArguments",void 0);m.__decorate([x.property()],u.prototype,"rasterArgumentNames",void 0);return u=m.__decorate([T.subclass("esri.layers.support.rasterFunctions.NDVIFunction")],u)})},"esri/layers/support/rasterFunctions/NDVIFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(m,x,u,K,F,T,N){var M;u=M=class extends N{constructor(){super(...arguments);this.visibleBandID=0;this.infraredBandID=1;this.scientificOutput=!1}clone(){const {visibleBandID:H,infraredBandID:v,scientificOutput:n}=this;return new M({visibleBandID:H,infraredBandID:v,scientificOutput:n})}};m.__decorate([x.property({json:{write:!0}})],u.prototype,"visibleBandID",void 0);m.__decorate([x.property({json:{write:!0}})],u.prototype,"infraredBandID",void 0);m.__decorate([x.property({json:{write:!0}})],
u.prototype,"scientificOutput",void 0);return u=M=m.__decorate([T.subclass("esri.layers.support.rasterFunctions.NDVIFunctionArguments")],u)})},"esri/layers/support/rasterFunctions/RemapFunction":function(){define("../../../chunks/tslib.es6 ../../../core/mathUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./pixelUtils ./RemapFunctionArguments".split(" "),
function(m,x,u,K,F,T,N,M,H,v,n){K=class extends H{constructor(){super(...arguments);this.functionName="Remap";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.lookup=null}_bindSourceRasters(){const e=this.sourceRasterInfos[0].clone(),{pixelType:g}=e;this.outputPixelType=this._getOutputPixelType(g);e.pixelType=this.outputPixelType;e.colormap=null;e.histograms=null;e.bandCount=1;e.attributeTable=null;const {statistics:k}=e,{allowUnmatched:y,outputValues:h,inputRanges:B,noDataRanges:D,
isLastInputRangeInclusive:E}=this.functionArguments;if(null!=k&&k.length&&h?.length)if(y){var a=Math.min.apply(null,[...h,k[0].min]),d=Math.max.apply(null,[...h,k[0].max]);e.statistics=[{...k[0],min:a,max:d}]}else{d=a=h[0];for(let c=0;c<h.length;c++)a=a>h[c]?h[c]:a,d=d>h[c]?d:h[c];e.statistics=[{...k[0],min:a,max:d}]}this.rasterInfo=e;this.lookup=y?null:v.createRemapLUT({srcPixelType:g,inputRanges:B,outputValues:h,noDataRanges:D,allowUnmatched:y,isLastInputRangeInclusive:E,outputPixelType:this.outputPixelType});
return{success:!0,supportsGPU:(!h||h.length<=v.maxMapSizeGpu)&&(!D||D.length<=v.maxMapSizeGpu)}}_processPixels(e){e=e.pixelBlocks?.[0];if(null==e)return null;const {lookup:g,outputPixelType:k}=this;if(g){const a=v.lookupPixels(e,{lut:[g.lut],offset:g.offset,outputPixelType:k});null!=a&&g.mask&&(a.mask=v.lookupBandValues(e.pixels[0],e.mask,g.mask,g.offset,"u8"));return a}const {inputRanges:y,outputValues:h,noDataRanges:B,allowUnmatched:D,isLastInputRangeInclusive:E}=this.functionArguments;return v.remap(e,
{inputRanges:y,outputValues:h,noDataRanges:B,outputPixelType:k,allowUnmatched:D,isLastInputRangeInclusive:E})}_getWebGLParameters(){const {allowUnmatched:e,noDataRanges:g,isLastInputRangeInclusive:k}=this.functionArguments,y=new Float32Array(3*v.maxMapSizeGpu);var h=this.functionArguments.inputRanges??[],B=this.functionArguments.outputValues??[];const D=B.length;for(let E=0;E<v.maxMapSizeGpu;E++)if(y[3*E]=h[2*E]??x.numberMaxFloat32-1,y[3*E+1]=h[2*E+1]??x.numberMaxFloat32,y[3*E+2]=B[E]??0,E<D&&(0<
E&&(y[3*E]-=1E-5),E<D-1||!k))y[3*E+1]-=1E-5;h=new Float32Array(2*v.maxMapSizeGpu);h.fill(x.numberMaxFloat32);g?.length&&h.set(g);B=M.getPixelValueRange(this.outputPixelType);return{allowUnmatched:e,rangeMaps:y,noDataRanges:h,clampRange:B}}};m.__decorate([u.property({json:{write:!0,name:"rasterFunction"}})],K.prototype,"functionName",void 0);m.__decorate([u.property({type:n,json:{write:!0,name:"rasterFunctionArguments"}})],K.prototype,"functionArguments",void 0);m.__decorate([u.property()],K.prototype,
"rasterArgumentNames",void 0);m.__decorate([u.property({json:{write:!0}})],K.prototype,"lookup",void 0);return K=m.__decorate([N.subclass("esri.layers.support.rasterFunctions.RemapFunction")],K)})},"esri/layers/support/rasterFunctions/RemapFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(m,x,u,K,F,T,N){var M;u=M=class extends N{constructor(){super(...arguments);this.noDataRanges=this.outputValues=this.inputRanges=null;this.isLastInputRangeInclusive=this.allowUnmatched=!1}clone(){return new M({inputRanges:[...this.inputRanges],outputValues:[...this.outputValues],noDataRanges:[...this.noDataRanges],allowUnmatched:this.allowUnmatched,isLastInputRangeInclusive:this.isLastInputRangeInclusive})}};m.__decorate([x.property({json:{write:!0}})],u.prototype,"inputRanges",void 0);m.__decorate([x.property({json:{write:!0}})],
u.prototype,"outputValues",void 0);m.__decorate([x.property({json:{write:!0}})],u.prototype,"noDataRanges",void 0);m.__decorate([x.property({json:{write:!0}})],u.prototype,"allowUnmatched",void 0);m.__decorate([x.property({json:{write:!0}})],u.prototype,"isLastInputRangeInclusive",void 0);return u=M=m.__decorate([T.subclass("esri.layers.support.rasterFunctions.RemapFunctionArguments")],u)})},"esri/layers/support/rasterFunctions/SlopeFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./SlopeFunctionArguments ./surfaceUtils".split(" "),
function(m,x,u,K,F,T,N,M,H){u=class extends N{constructor(){super(...arguments);this.functionName="Slope";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.isGCS=!1}_bindSourceRasters(){this.outputPixelType=this._getOutputPixelType("f32");const v=this.sourceRasterInfos[0].clone();v.pixelType=this.outputPixelType;v.statistics="percent-rise"!==this.functionArguments.slopeType?[{min:0,max:90,avg:1,stddev:1}]:null;v.histograms=null;v.colormap=null;v.attributeTable=null;v.bandCount=
1;this.rasterInfo=v;this.isGCS=v.spatialReference?.isGeographic??!1;return{success:!0,supportsGPU:!0}}_processPixels(v){const n=v.pixelBlocks?.[0];if(null==n)return null;const {zFactor:e,slopeType:g,pixelSizePower:k,pixelSizeFactor:y}=this.functionArguments,{isGCS:h}=this,{extent:B,primaryPixelSizes:D}=v;v=D?.[0];return H.slope(n,{zFactor:e,slopeType:g,pixelSizePower:k,pixelSizeFactor:y,isGCS:h,resolution:null==v?B?{x:B.width/n.width,y:B.height/n.height}:{x:1,y:1}:v})}_getWebGLParameters(){const {zFactor:v,
slopeType:n,pixelSizeFactor:e,pixelSizePower:g}=this.functionArguments;return{zFactor:this.isGCS&&1<=v?v*H.gcsFactor:v,slopeType:n,pixelSizeFactor:e??0,pixelSizePower:g??0}}};m.__decorate([x.property({json:{write:!0,name:"rasterFunction"}})],u.prototype,"functionName",void 0);m.__decorate([x.property({type:M,json:{write:!0,name:"rasterFunctionArguments"}})],u.prototype,"functionArguments",void 0);m.__decorate([x.property()],u.prototype,"rasterArgumentNames",void 0);m.__decorate([x.property({json:{write:!0}})],
u.prototype,"isGCS",void 0);return u=m.__decorate([T.subclass("esri.layers.support.rasterFunctions.SlopeFunction")],u)})},"esri/layers/support/rasterFunctions/SlopeFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(m,x,u,K,F,T,N,M,H){var v;x=new x.JSONMap({1:"degree",2:"percent-rise",3:"adjusted"},{useNumericKeys:!0});H=v=class extends H{constructor(){super(...arguments);this.slopeType="degree";this.zFactor=1;this.pixelSizePower=.664;this.pixelSizeFactor=.024;this.removeEdgeEffect=!1}clone(){return new v({slopeType:this.slopeType,zFactor:this.zFactor,pixelSizePower:this.pixelSizePower,pixelSizeFactor:this.pixelSizeFactor,removeEdgeEffect:this.removeEdgeEffect,raster:this.raster})}};m.__decorate([N.enumeration(x)],
H.prototype,"slopeType",void 0);m.__decorate([u.property({type:Number,json:{write:!0}})],H.prototype,"zFactor",void 0);m.__decorate([u.property({type:Number,json:{name:"psPower",write:!0}})],H.prototype,"pixelSizePower",void 0);m.__decorate([u.property({type:Number,json:{name:"psZFactor",write:!0}})],H.prototype,"pixelSizeFactor",void 0);m.__decorate([u.property({type:Boolean,json:{write:!0}})],H.prototype,"removeEdgeEffect",void 0);return H=v=m.__decorate([M.subclass("esri.layers.support.rasterFunctions.SlopeFunctionArguments")],
H)})},"esri/layers/support/rasterFunctions/StatisticsFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./focalStatUtils ./StatisticsFunctionArguments".split(" "),function(m,x,u,K,F,T,N,M,H,v){u=class extends M{constructor(){super(...arguments);this.functionName="Statistics";this.rasterArgumentNames=
["raster"]}_bindSourceRasters(){const {type:n}=this.functionArguments.toJSON();if(1>n||7<n)return{success:!1,supportsGPU:!1,error:`statistics-function: the given statistics type is not supported ${n}`};var e=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType(e.pixelType);e=e.clone();e.pixelType=this.outputPixelType;const {statisticsType:g}=this.functionArguments;"stddev"===g&&this._removeStatsHistColormapVAT(e);this.rasterInfo=e;return{success:!0,supportsGPU:3>=e.bandCount&&5>
n}}_processPixels(n){n=n.pixelBlocks?.[0];if(null==n)return n;const {statisticsType:e,rows:g,cols:k,fillNoDataOnly:y}=this.functionArguments;return H.computeFocalStatistics(n,{kernelRows:g,kernelCols:k,fillNoDataOnly:y,outputPixelType:this.outputPixelType,statisticsType:e,mirrorEdges:!0})}_getWebGLParameters(){const {rows:n,cols:e,statisticsType:g,fillNoDataOnly:k}=this.functionArguments;return{fillNoDataOnly:k,kernelRows:n,kernelCols:e,statisticsType:g,clampRange:N.getPixelValueRange(this.outputPixelType)}}};
m.__decorate([x.property({json:{write:!0,name:"rasterFunction"}})],u.prototype,"functionName",void 0);m.__decorate([x.property({type:v,json:{write:!0,name:"rasterFunctionArguments"}})],u.prototype,"functionArguments",void 0);m.__decorate([x.property()],u.prototype,"rasterArgumentNames",void 0);return u=m.__decorate([T.subclass("esri.layers.support.rasterFunctions.StatisticsFunction")],u)})},"esri/layers/support/rasterFunctions/focalStatUtils":function(){define(["exports","../../../core/has","../../../core/jsonMap",
"../PixelBlock","./mirror"],function(m,x,u,K,F){function T(N,M){const {fillNoDataOnly:H}=M,{band:v,width:n,height:e,mask:g,outBand:k}=N;if(H&&!g)k.set(v);else{var {kernelRows:y,kernelCols:h}=M;N=Math.floor(y/2);M=Math.floor(h/2);var B=k.slice(),D=new Uint32Array(n*e);for(var E=N;E<e-N;E++){var a=E*n;for(var d=M;d<n-M;d++){if(H&&g?.[a+d])continue;const c=[];for(let b=0;b<y;b++)for(let f=0;f<h;f++){const l=a+d+(b-N)*n+f-M;g&&!g[l]||c.push(v[l])}c.length&&(c.sort((b,f)=>b-f),g?(B[a+d]=c[Math.floor((c.length-
1)/2)],D[a+d]=c.length):k[a+d]=c[Math.floor((c.length-1)/2)])}}if(g)for(E=N;E<e-N;E++)for(a=E*n,d=M;d<n-M;d++)!D[a+d]||H&&g[a+d]||(k[a+d]=B[a+d],g[a+d]=255)}}x=new u.JSONMap({1:"min",2:"max",3:"mean",4:"stddev",5:"median",6:"majority",7:"minority"},{useNumericKeys:!0});m.computeFocalStatistics=function(N,M){const {mask:H}=N,{fillNoDataOnly:v}=M;if(v&&!H)return N;const {pixels:n,width:e,height:g,bandMasks:k,pixelType:y}=N,h=n.length,B=e*g,D=[],{kernelRows:E,kernelCols:a,statisticsType:d,mirrorEdges:c}=
M;if(v&&!H)return N;const b=M.outputPixelType??y,f=[];for(let z=0;z<h;z++){const I=n[z],G=K.createEmptyBand(b,B);v&&G.set(I);const R=(k?.[z]??H)?.slice()??null,J={band:I,width:e,height:g,mask:R,outBand:G};switch(d){case "min":case "max":a:{var l=M;const {fillNoDataOnly:V}=l,{band:A,width:C,height:P,mask:X,outBand:O}=J;if(V&&!X){O.set(A);break a}const {kernelRows:Y,kernelCols:S,statisticsType:aa}=l,t=Math.floor(Y/2),L=Math.floor(S/2),U="min"===aa,Q=O.slice(),ca=new Uint32Array(C*P);for(let W=t;W<P-
t;W++){const da=W*C;for(let fa=L;fa<C-L;fa++){let ha=U?Number.MAX_VALUE:-Number.MAX_VALUE,la=0;for(let ka=0;ka<Y;ka++)for(let pa=0;pa<S;pa++){const na=da+fa+(ka-t)*C+pa-L;if(!X||X[na])ha=U?Math.min(ha,A[na]):Math.max(ha,A[na]),la++}X?(Q[da+fa]=0===la?0:ha,ca[da+fa]=la):O[da+fa]=0===la?0:ha}}if(X)for(let W=t;W<P-t;W++){const da=W*C;for(let fa=L;fa<C-L;fa++)!ca[da+fa]||V&&X[da+fa]||(O[da+fa]=Q[da+fa],X[da+fa]=255)}}break;case "mean":case "stddev":a:{var r=M;const {fillNoDataOnly:V}=r,{band:A,width:C,
height:P,mask:X,outBand:O}=J;if(V&&!X){O.set(A);break a}const {statisticsType:Y,kernelRows:S,kernelCols:aa}=r,t="stddev"===Y,L=C*P,U=new Float64Array(L),Q=new Float64Array(L),ca=new Uint32Array(L);for(let pa=0;pa<P;pa++){const na=pa*C;let oa=0,sa=0,ta=0;for(let ua=0;ua<aa;ua++)if(!X||X[na+ua])oa+=A[na+ua],t&&(sa+=A[na+ua]**2),ta++;U[na]=oa;Q[na]=sa;ca[na]=ta;for(let ua=1;ua<=C-aa;ua++){const qa=na+ua-1,xa=qa+aa;X?(X[qa]&&(ta--,oa-=A[qa],t&&(sa-=A[qa]**2)),X[xa]&&(ta++,oa+=A[xa],t&&(sa+=A[xa]**2))):
(oa-=A[qa],oa+=A[xa],t&&(sa-=A[qa]**2,sa+=A[xa]**2));U[na+ua]=oa;ca[na+ua]=ta;t&&(Q[na+ua]=sa)}}const W=new Float64Array(L),da=new Float64Array(L),fa=new Uint32Array(L),ha=S*C;for(let pa=0;pa<=C-aa;pa++){let na=0,oa=0,sa=0;for(let ta=0;ta<S;ta++){const ua=ta*C+pa;na+=U[ua];sa+=ca[ua];t&&(oa+=Q[ua])}W[pa]=na;da[pa]=oa;fa[pa]=sa;for(let ta=1;ta<=P-S;ta++){const ua=(ta-1)*C+pa,qa=ua+ha;na-=U[ua];na+=U[qa];sa-=ca[ua];sa+=ca[qa];t&&(oa-=Q[ua],oa+=Q[qa]);W[ta*C+pa]=na;da[ta*C+pa]=oa;fa[ta*C+pa]=sa}}const la=
Math.floor(S/2),ka=Math.floor(aa/2);for(let pa=la;pa<P-la;pa++){const na=pa*C;for(let oa=ka;oa<C-ka;oa++){const sa=(pa-la)*C+oa-ka,ta=fa[sa];if(0===ta||V&&(!X||X[na+oa]))continue;const ua=W[sa]/ta;O[na+oa]=t?Math.sqrt((da[sa]-W[sa]*ua)/ta):ua;X&&(X[na+oa]=255)}}}break;case "median":T(J,M);break;case "majority":case "minority":a:{var q=M;const {fillNoDataOnly:V}=q,{band:A,width:C,height:P,mask:X,outBand:O}=J;if(V&&!X){O.set(A);break a}const {kernelRows:Y,kernelCols:S}=q,aa=Math.floor(Y/2),t=Math.floor(S/
2),L="majority"===q.statisticsType,U=Y*S,Q=O.slice(),ca=new Uint32Array(C*P);for(let W=aa;W<P-aa;W++){const da=W*C;for(let fa=t;fa<C-t;fa++){if(V&&X?.[da+fa])continue;const ha=new Map;for(let na=0;na<Y;na++)for(let oa=0;oa<S;oa++){const sa=da+fa+(na-aa)*C+oa-t;if(X&&!X[sa])continue;const ta=A[sa];ha.set(ta,ha.has(ta)?ha.get(ta)+1:1)}if(0===ha.size)continue;let la=0,ka=0,pa=L?0:U+1;for(const na of ha.keys())ka=ha.get(na),L===ka>pa&&(pa=ka,la=na);X?(Q[da+fa]=la,ca[da+fa]=ha.size):O[da+fa]=la}}if(X)for(let W=
aa;W<P-aa;W++){const da=W*C;for(let fa=t;fa<C-t;fa++)!ca[da+fa]||V&&X[da+fa]||(O[da+fa]=Q[da+fa],X[da+fa]=255)}}}c&&!v&&F.mirror(G,e,g,E,a);D.push(G);R&&f.push(R)}let w=f[0]??H;f.length!==h&&(f.length=0);1<h&&k?.length&&(w=K.combineBandMasks(k));const p=new K({pixelType:b,width:e,height:g,pixels:D,bandMasks:k&&f.length?f:null,mask:w});p.updateStatistics();return p};m.statisticsTypeMap=x;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/StatisticsFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ./focalStatUtils".split(" "),
function(m,x,u,K,F,T,N,M,H){var v;K=v=class extends M{constructor(){super(...arguments);this.cols=this.rows=3;this.fillNoDataOnly=!1;this.statisticsType="min"}clone(){return new v({rows:this.rows,cols:this.cols,fillNoDataOnly:this.fillNoDataOnly,statisticsType:this.statisticsType,raster:x.clone(this.raster)})}};m.__decorate([u.property({json:{write:!0,read:{source:["kernelRows","rows"],reader:(n,e)=>Number(n??e?.kernelRows??3)}}})],K.prototype,"rows",void 0);m.__decorate([u.property({json:{write:!0,
read:{source:["kernelCols","cols"],reader:(n,e)=>Number(n??e?.kernelCols??3)}}})],K.prototype,"cols",void 0);m.__decorate([u.property({json:{write:!0}})],K.prototype,"fillNoDataOnly",void 0);m.__decorate([u.property({json:{read:{source:["statisticsType","type"],reader:(n,e)=>H.statisticsTypeMap.fromJSON(e?.statisticsType??e?.type)??"min"},write:{target:"type"}}}),T.enumeration(H.statisticsTypeMap)],K.prototype,"statisticsType",void 0);return K=v=m.__decorate([N.subclass("esri.layers.support.rasterFunctions.StatisticsFunctionArguments")],
K)})},"esri/layers/support/rasterFunctions/StatisticsHistogramFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./StatisticsHistogramFunctionArguments".split(" "),function(m,x,u,K,F,T,N,M){u=class extends N{constructor(){super(...arguments);this.functionName="StatisticsHistogram";this.functionArguments=null;this.rasterArgumentNames=
["raster"];this.isNoopProcess=!0}_bindSourceRasters(){var H=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType("u8");H=H.clone();const {statistics:v,histograms:n}=this.functionArguments;n&&(H.histograms=n);v&&(H.statistics=v);this.rasterInfo=H;return{success:!0,supportsGPU:!0}}_processPixels(H){return H.pixelBlocks?.[0]}};m.__decorate([x.property({json:{write:!0,name:"rasterFunction"}})],u.prototype,"functionName",void 0);m.__decorate([x.property({type:M,json:{write:!0,name:"rasterFunctionArguments"}})],
u.prototype,"functionArguments",void 0);m.__decorate([x.property()],u.prototype,"rasterArgumentNames",void 0);m.__decorate([x.property({json:{write:!0}})],u.prototype,"indexedColormap",void 0);m.__decorate([x.property()],u.prototype,"isNoopProcess",void 0);return u=m.__decorate([T.subclass("esri.layers.support.rasterFunctions.StatisticsHistogramFunction")],u)})},"esri/layers/support/rasterFunctions/StatisticsHistogramFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),
function(m,x,u,K,F,T,N,M,H){var v;K=v=class extends H{constructor(){super(...arguments);this.histograms=this.statistics=null}readStatistics(n,e){if(!n?.length)return null;const g=[];n.forEach(k=>{g.push({min:k.min,max:k.max,avg:k.avg??k.mean,stddev:k.stddev??k.standardDeviation})});return g}writeStatistics(n,e,g){if(n?.length){var k=[];n.forEach(y=>{y={...y,mean:y.avg,standardDeviation:y.stddev};delete y.avg;delete y.stddev;k.push(y)});e[g]=k}}clone(){return new v({statistics:x.clone(this.statistics),
histograms:x.clone(this.histograms)})}};m.__decorate([u.property({json:{write:!0}})],K.prototype,"statistics",void 0);m.__decorate([T.reader("statistics")],K.prototype,"readStatistics",null);m.__decorate([M.writer("statistics")],K.prototype,"writeStatistics",null);m.__decorate([u.property({json:{write:!0}})],K.prototype,"histograms",void 0);return K=v=m.__decorate([N.subclass("esri.layers.support.rasterFunctions.StatisticsHistogramFunctionArguments")],K)})},"esri/layers/support/rasterFunctions/StretchFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./pixelUtils ./StretchFunctionArguments ./stretchUtils".split(" "),
function(m,x,u,K,F,T,N,M,H,v,n){u=class extends M{constructor(){super(...arguments);this.functionName="Stretch";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.cutOffs=this.lookup=null}_bindSourceRasters(){this.cutOffs=this.lookup=null;var e=this.sourceRasterInfos[0],{pixelType:g}=e,{functionArguments:k}=this;const {dynamicRangeAdjustment:y,gamma:h,useGamma:B}=k;if(!y&&["u8","u16","s8","s16"].includes(g)){k=n.getStretchCutoff(k.toJSON(),{rasterInfo:e});const a=N.isIntegerPixelType(this.outputPixelType)?
"round":"float";this.lookup=n.createStretchLUT({pixelType:g,...k,gamma:B?h:null,rounding:a});this.cutOffs=k}else y||(this.cutOffs=n.getStretchCutoff(k.toJSON(),{rasterInfo:e}));this.outputPixelType=this._getOutputPixelType(g);e=e.clone();e.pixelType=this.outputPixelType;this._removeStatsHistColormapVAT(e);"u8"===this.outputPixelType&&(e.keyProperties.DataType="processed");const {outputMin:D=0,outputMax:E=255}=this.functionArguments;e.statistics=[];for(g=0;g<e.bandCount;g++)e.statistics[g]={min:D,
max:E};this.rasterInfo=e;return{success:!0,supportsGPU:!y}}_processPixels(e){e=e.pixelBlocks?.[0];if(null==e)return e;var {lookup:g}=this;if(g)return H.lookupPixels(e,{...g,outputPixelType:this.rasterInfo.pixelType});({functionArguments:g}=this);const k=this.cutOffs||n.getStretchCutoff(g.toJSON(),{rasterInfo:this.sourceRasterInfos[0],pixelBlock:e});return n.stretch(e,{...k,gamma:g.useGamma?g.gamma:null,outputPixelType:this.outputPixelType})}_getWebGLParameters(){const {outputMin:e=0,outputMax:g=255,
gamma:k,useGamma:y}=this.functionArguments,h=2<=this.rasterInfo.bandCount?3:1,B=y&&k?.length?n.computeGammaCorrection(h,k):[1,1,1],{minCutOff:D,maxCutOff:E}=this.cutOffs??{minCutOff:[0,0,0],maxCutOff:[255,255,255]};1===D.length&&(D[1]=D[2]=D[0],E[1]=E[2]=E[0]);const a=new Float32Array(h);var d;for(d=0;d<h;d++)a[d]=(g-e)/(E[d]-D[d]);d=N.isIntegerPixelType(this.outputPixelType);return{bandCount:h,outMin:e,outMax:g,minCutOff:D,maxCutOff:E,factor:a,useGamma:y,gamma:y&&k?k:[1,1,1],gammaCorrection:y&&B?
B:[1,1,1],stretchType:this.functionArguments.stretchType,isOutputRounded:d,type:"stretch"}}};m.__decorate([x.property({json:{write:!0,name:"rasterFunction"}})],u.prototype,"functionName",void 0);m.__decorate([x.property({type:v,json:{write:!0,name:"rasterFunctionArguments"}})],u.prototype,"functionArguments",void 0);m.__decorate([x.property()],u.prototype,"rasterArgumentNames",void 0);m.__decorate([x.property({json:{write:!0}})],u.prototype,"lookup",void 0);m.__decorate([x.property({json:{write:!0}})],
u.prototype,"cutOffs",void 0);return u=m.__decorate([T.subclass("esri.layers.support.rasterFunctions.StretchFunction")],u)})},"esri/layers/support/rasterFunctions/StretchFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),
function(m,x,u,K,F,T,N,M,H,v){var n;x=new x.JSONMap({0:"none",3:"standard-deviation",4:"histogram-equalization",5:"min-max",6:"percent-clip",9:"sigmoid"},{useNumericKeys:!0});v=n=class extends v{constructor(){super(...arguments);this.dynamicRangeAdjustment=this.computeGamma=!1;this.gamma=[];this.statistics=this.histograms=null;this.stretchType="none";this.useGamma=!1}writeStatistics(e,g,k){e?.length&&(Array.isArray(e[0])||(e=e.map(y=>[y.min,y.max,y.avg,y.stddev])),g[k]=e)}clone(){return new n({stretchType:this.stretchType,
outputMin:this.outputMin,outputMax:this.outputMax,useGamma:this.useGamma,computeGamma:this.computeGamma,statistics:u.clone(this.statistics),gamma:u.clone(this.gamma),sigmoidStrengthLevel:this.sigmoidStrengthLevel,numberOfStandardDeviations:this.numberOfStandardDeviations,minPercent:this.minPercent,maxPercent:this.maxPercent,histograms:u.clone(this.histograms),dynamicRangeAdjustment:this.dynamicRangeAdjustment,raster:this.raster})}};m.__decorate([K.property({type:Boolean,json:{write:!0}})],v.prototype,
"computeGamma",void 0);m.__decorate([K.property({type:Boolean,json:{name:"dra",write:!0}})],v.prototype,"dynamicRangeAdjustment",void 0);m.__decorate([K.property({type:[Number],json:{write:!0}})],v.prototype,"gamma",void 0);m.__decorate([K.property()],v.prototype,"histograms",void 0);m.__decorate([K.property({type:Number,json:{write:!0}})],v.prototype,"maxPercent",void 0);m.__decorate([K.property({type:Number,json:{write:!0}})],v.prototype,"minPercent",void 0);m.__decorate([K.property({type:Number,
json:{write:!0}})],v.prototype,"numberOfStandardDeviations",void 0);m.__decorate([K.property({type:Number,json:{name:"max",write:!0}})],v.prototype,"outputMax",void 0);m.__decorate([K.property({type:Number,json:{name:"min",write:!0}})],v.prototype,"outputMin",void 0);m.__decorate([K.property({type:Number,json:{write:!0}})],v.prototype,"sigmoidStrengthLevel",void 0);m.__decorate([K.property({json:{type:[[Number]],write:!0}})],v.prototype,"statistics",void 0);m.__decorate([H.writer("statistics")],v.prototype,
"writeStatistics",null);m.__decorate([N.enumeration(x)],v.prototype,"stretchType",void 0);m.__decorate([K.property({type:Boolean,json:{write:!0}})],v.prototype,"useGamma",void 0);return v=n=m.__decorate([M.subclass("esri.layers.support.rasterFunctions.StretchFunctionArguments")],v)})},"esri/layers/support/rasterFunctions/TableFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./TableFunctionArguments".split(" "),
function(m,x,u,K,F,T,N,M){u=class extends N{constructor(){super(...arguments);this.functionName="Table";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.isNoopProcess=!0}_bindSourceRasters(){var H=this.sourceRasterInfos[0];if(1<H.bandCount||H.pixelType.startsWith("f"))return{success:!1,supportsGPU:!1,error:"table-function: Source data must be single band and integer pixel type."};const {attributeTableAsRecordSet:v}=this.functionArguments;if(!v)return{success:!1,supportsGPU:!1,
error:"table-function: Missing attributeTableAsRecordSet argument."};this.outputPixelType=this._getOutputPixelType(H.pixelType);H=H.clone();H.pixelType=this.outputPixelType;H.bandCount=1;"thematic"!==H.dataType&&(H.keyProperties=H.keyProperties?{...H.keyProperties,DataType:"thematic"}:{DataType:"thematic"});this.rasterInfo=H;return{success:!0,supportsGPU:!0}}_processPixels(H){return H.pixelBlocks?.[0]}};m.__decorate([x.property({json:{write:!0,name:"rasterFunction"}})],u.prototype,"functionName",
void 0);m.__decorate([x.property({type:M,json:{write:!0,name:"rasterFunctionArguments"}})],u.prototype,"functionArguments",void 0);m.__decorate([x.property()],u.prototype,"rasterArgumentNames",void 0);m.__decorate([x.property()],u.prototype,"isNoopProcess",void 0);return u=m.__decorate([T.subclass("esri.layers.support.rasterFunctions.TableFunction")],u)})},"esri/layers/support/rasterFunctions/TableFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(m,x,u,K,F,T,N){var M;K=M=class extends N{constructor(){super(...arguments);this.attributeTableAsRecordSet=null}clone(){return new M({attributeTableAsRecordSet:x.clone(this.attributeTableAsRecordSet)})}};m.__decorate([u.property({json:{write:!0}})],K.prototype,"attributeTableAsRecordSet",void 0);return K=M=m.__decorate([T.subclass("esri.layers.support.rasterFunctions.TableFunctionArguments")],K)})},"esri/layers/support/rasterFunctions/rasterProjectionHelper":function(){define("exports ../../../geometry ../../../core/arrayUtils ../../../core/Error ../../../core/unitUtils ../../../chunks/pe ../../../geometry/projection ../../../geometry/support/spatialReferenceUtils ../../../geometry/Extent ../../../geometry/Point ../../../geometry/Polygon ../../../geometry/SpatialReference".split(" "),
function(m,x,u,K,F,T,N,M,H,v,n,e){function g(t,L,U){return!N.canProjectWithoutEngine(t,L,U)}function k(t,L,U){if((t=g(t,L,U))&&!N.isLoaded())throw new K("rasterprojectionhelper-project","projection engine is not loaded");return t}function y(t,L,U){k(t.spatialReference,L);return U?N.getTransformation(L,t.spatialReference,t):N.getTransformation(t.spatialReference,L,t)}function h(t,L,U,Q=null){const ca=t.spatialReference;if(ca.equals(L))return t;k(ca,L,Q);U=U.center;U=new H({xmin:U.x-t.x/2,xmax:U.x+
t.x/2,ymin:U.y-t.y/2,ymax:U.y+t.y/2,spatialReference:ca});Q=N.project(U,L,Q);U=I(L);null==Q||null!=U&&Q.width>=U?(L=F.getMetersPerUnitForSR(ca)/F.getMetersPerUnitForSR(L),t={x:t.x*L,y:t.y*L}):t={x:Q.width,y:Q.height};return t}function B(t,L=.01){return F.getMetersPerUnitForSR(t)?L/F.getMetersPerUnitForSR(t):0}function D(t,L,U=null,Q=!0){const ca=t.spatialReference;if(ca.equals(L))return t;k(ca,L,U);U=N.project(t,L,U);if(!Q||!U)return U;E([t],[U],ca,L);return U}function E(t,L,U,Q){const ca=G(U,!0),
W=G(Q,!0);U=B(U,500);Q=B(Q,500);if(U&&null!=ca&&null!=W)for(let da=0;da<t.length;da++){const fa=L[da];if(!fa)continue;const {x:ha}=t[da],{x:la}=fa;la>=W[1]-Q&&Math.abs(ha-ca[0])<U?fa.x-=W[1]-W[0]:la<=W[0]+Q&&Math.abs(ha-ca[1])<U&&(fa.x+=W[1]-W[0])}}function a(t){const {inSR:L,outSR:U,datumTransformation:Q,preferPE:ca}=t;if(L.equals(U))return{points:t}=l(t,null),t;if(L.isWebMercator&&U.isWGS84||L.isWGS84&&U.isWebMercator){const {cols:ha,rows:la,xres:ka,yres:pa,usePixelCenter:na,inSR:oa,outSR:sa}=t;
let {xmin:ta,ymax:ua}=t;na&&(ta+=ka/2,ua-=pa/2);t=[];const qa=[];var W=Math.max(ha,la);for(var da=0;da<W;da++){var fa=N.project(new v({x:ta+ka*Math.min(ha,da),y:ua-pa*Math.min(la,da),spatialReference:oa}),sa);da<=ha&&t.push(fa.x);da<=la&&qa.push(fa.y)}W=[];for(da=0;da<ha;da++)for(fa=0;fa<la;fa++)W.push([t[da],qa[fa]]);return W}return k(L,U,Q)&&ca&&(L.isGeographic||null!=b(L))?c(t):d(t)}function d(t){var {points:L}=l(t,null);const {inSR:U,outSR:Q,datumTransformation:ca}=t;t=L.map(W=>new v(W[0],W[1],
U));L=N.project(t,Q,ca);ca&&E(t,L,U,Q);return L.map(W=>W?[W.x,W.y]:[NaN,NaN])}function c(t){const {inSR:L,outSR:U,datumTransformation:Q}=t;var ca=b(L);const {points:W,mask:da}=l(t,ca);L.isGeographic||(t=L.wkid?T.PeFactory.coordsys(L.wkid):T.PeFactory.fromString(L.isGeographic?T.PeDefs.PE_TYPE_GEOGCS:T.PeDefs.PE_TYPE_PROJCS,L.wkt2||L.wkt),T.PeCSTransformations.projToGeog(t,W.length,W));if(null!=Q&&Q.steps.length){var fa;U.isGeographic&&(fa=W.map(([ha])=>179.9955<ha?1:-179.9955>ha?-1:0));Q.steps.forEach(ha=>
{const la=ha.wkid?T.PeFactory.geogtran(ha.wkid):T.PeFactory.fromString(T.PeDefs.PE_TYPE_GEOGTRAN,ha.wkt);T.PeGTTransformations.geogToGeog(la,W.length,W,null,ha.isInverse?T.PeDefs.PE_TRANSFORM_2_TO_1:T.PeDefs.PE_TRANSFORM_1_TO_2)});if(fa)for(t=0;t<W.length;t++){ca=fa[t];const ha=W[t][0],la=179.9955<ha?1:-179.9955>ha?-1:0;ca&&la&&ca!==la&&(W[t][0]=0<ca?ha+360:ha-360)}}U.isGeographic||(fa=b(U,!0),r(W,null!=fa&&fa.isEnvelope?[fa.bbox[1],fa.bbox[3]]:[-90,90]),fa=U.wkid?T.PeFactory.coordsys(U.wkid):T.PeFactory.fromString(U.isGeographic?
T.PeDefs.PE_TYPE_GEOGCS:T.PeDefs.PE_TYPE_PROJCS,U.wkt2||U.wkt),T.PeCSTransformations.geogToProj(fa,W.length,W));fa=W;if(da&&W.length!==da.length){fa=[];for(let ha=0,la=0;ha<da.length;ha++)da[ha]?fa.push(W[la++]):fa.push([NaN,NaN])}return fa}function b(t,L=!1){var U=t.wkid||t.wkt2||t.wkt;if(!U||t.isGeographic)return null;U=String(U);if(S.has(U))return U=S.get(U),L?U?.gcs:U?.pcs;var Q=t.wkid?T.PeFactory.coordsys(t.wkid):T.PeFactory.fromString(t.isGeographic?T.PeDefs.PE_TYPE_GEOGCS:T.PeDefs.PE_TYPE_PROJCS,
t.wkt2||t.wkt);t=B(t,1E-4);t=f(Q,t);Q=f(Q,0,!0);S.set(U,{pcs:t,gcs:Q});return L?Q:t}function f(t,L=0,U=!1){var Q=T.PePCSInfo.generate(t),ca=U?t.horizonGcsGenerate():t.horizonPcsGenerate();if(!Q||!ca?.length)return null;t=!1;var W=ca.find(ka=>1===ka.getInclusive()&&1===ka.getKind());if(!W){W=ca.find(ka=>1===ka.getInclusive()&&0===ka.getKind());if(!W)return null;t=!0}U=U?0:(2===Q.getNorthPoleLocation()?1:0)|(2===Q.getSouthPoleLocation()?2:0);Q=Q.isPannableRectangle();W=W.getCoord();if(t)return{isEnvelope:t,
isPannable:Q,vertices:W,coef:null,bbox:[W[0][0]-L,W[0][1]-L,W[1][0]+L,W[1][1]+L],poleLocation:U};L=0;t=[];let [da,fa]=W[0],[ha,la]=W[0];for(let ka=0,pa=W.length;ka<pa;ka++){L++;L===pa&&(L=0);const [na,oa]=W[ka],[sa,ta]=W[L];if(ta===oa)t.push([na,sa,oa,ta,2]);else{ca=(sa-na)/(ta-oa||1E-4);const ua=na-ca*oa;oa<ta?t.push([ca,ua,oa,ta,0]):t.push([ca,ua,ta,oa,1])}da=da<na?da:na;fa=fa<oa?fa:oa;ha=ha>na?ha:na;la=la>oa?la:oa}return{isEnvelope:!1,isPannable:Q,vertices:W,coef:t,bbox:[da,fa,ha,la],poleLocation:U}}
function l(t,L){const U=[],{cols:Q,rows:ca,xres:W,yres:da,usePixelCenter:fa}=t;let {xmin:ha,ymax:la}=t;fa&&(ha+=W/2,la-=da/2);if(null==L){for(t=0;t<Q;t++)for(L=0;L<ca;L++)U.push([ha+W*t,la-da*L]);return{points:U}}t=new Uint8Array(Q*ca);if(L.isEnvelope){const {bbox:[ua,qa,xa,va]}=L;for(let ya=0,Z=0;ya<Q;ya++){var ka=ha+W*ya,pa=L.isPannable||ka>=ua&&ka<=xa;for(var na=0;na<ca;na++,Z++){var oa=la-da*na;pa&&oa>=qa&&oa<=va&&(U.push([ka,oa]),t[Z]=1)}}return{points:U,mask:t}}ka=L.coef;L=[];for(pa=0;pa<ca;pa++){var sa=
la-da*pa;na=[];oa=[];for(var ta=0;ta<ka.length;ta++){const [ua,qa,xa,va,ya]=ka[ta];sa===xa&&xa===va?(na.push(ua),na.push(qa),oa.push(2),oa.push(2)):sa>=xa&&sa<=va&&(na.push(ua*sa+qa),oa.push(ya))}sa=na;if(2<na.length){ta=2===oa[0]?0:oa[0];let ua=na[0];sa=[];for(let qa=1;qa<oa.length;qa++)if(2!==oa[qa]||qa===oa.length-1)oa[qa]!==ta&&(sa.push(0===ta?Math.min(ua,na[qa-1]):Math.max(ua,na[qa-1])),ta=oa[qa],ua=na[qa]),qa===oa.length-1&&sa.push(0===oa[qa]?Math.min(ua,na[qa]):Math.max(ua,na[qa]));sa.sort((qa,
xa)=>qa-xa)}else na[0]>na[1]&&(sa=[na[1],na[0]]);L.push(sa)}for(let ua=0,qa=0;ua<Q;ua++)for(ka=ha+W*ua,pa=0;pa<ca;pa++,qa++)if(na=la-da*pa,oa=L[pa],2===oa.length)ka>=oa[0]&&ka<=oa[1]&&(U.push([ka,na]),t[qa]=1);else if(2<oa.length){sa=!1;for(ta=0;ta<oa.length;ta+=2)if(ka>=oa[ta]&&ka<=oa[ta+1]){sa=!0;break}sa&&(U.push([ka,na]),t[qa]=1)}return{points:U,mask:t}}function r(t,L){const [U,Q]=L;for(L=0;L<t.length;L++){const ca=t[L][1];if(ca<U||ca>Q)t[L]=[NaN,NaN]}}function q(t,L){const U=I(t[0].spatialReference);
if(2>t.length||null==U)return t[0];L=L??B(t[0].spatialReference);t=t.filter(fa=>fa.width>L);if(1===t.length)return t[0];let {xmin:Q,xmax:ca,ymin:W,ymax:da}=t[0];for(let fa=1;fa<t.length;fa++){const ha=t[fa];ca=ha.xmax+U*fa;W=Math.min(W,ha.ymin);da=Math.max(da,ha.ymax)}return new H({xmin:Q,xmax:ca,ymin:W,ymax:da,spatialReference:t[0].spatialReference})}function w(t,L,U=null,Q=!0){var ca=t.spatialReference;if(ca.equals(L))return t;var W=J(t);const da=I(ca,!0);var fa=I(L);if(0===W||null==da||null==fa)return W=
z(t,L,U,Q),null==da&&null!=fa&&Math.abs(W.width-fa)<B(L)&&N.isLoaded()&&(ca=b(ca),null!=ca&&ca.poleLocation===X.None&&t.width<(ca.bbox[2]-ca.bbox[0])/2)?p(t,L)||W:W;fa=t.clone().normalize();if(1===fa.length&&t.xmax<da&&t.xmax-da/2>B(ca)){const {xmin:ha,xmax:la}=t;for(let ka=0;ka<=W;ka++)fa[ka]=new H({xmin:0===ka?ha:-da/2,xmax:ka===W?la-da*ka:da/2,ymin:t.ymin,ymax:t.ymax,spatialReference:ca})}t=fa.map(ha=>z(ha,L,U,Q));return q(t.filter(u.isSome))}function p(t,L){const U=I(L);if(null==U)return null;
let {xmin:Q,ymin:ca,xmax:W,ymax:da}=t;var fa=t.spatialReference;t=new n({spatialReference:fa,rings:[[[Q,ca],[W,ca],[W,da],[Q,da],[Q,ca]]]});t=N.project(t,L);if(2!==t.rings.length||!t.rings[0].length||!t.rings[1].length)return null;({rings:t}=t);fa=B(fa);L=new H({spatialReference:L});for(let ha=0;2>ha;ha++){Q=W=t[ha][0][0];ca=da=t[ha][0][1];for(let la=0;la<t[ha].length;la++)Q=Q>t[ha][la][0]?t[ha][la][0]:Q,W=W<t[ha][la][0]?t[ha][la][0]:W,ca=ca>t[ha][la][1]?t[ha][la][1]:ca,da=da<t[ha][la][1]?t[ha][la][1]:
da;if(0===ha)L.ymin=ca,L.ymax=da,L.xmin=Q,L.xmax=W;else if(L.ymin=Math.min(L.ymin,ca),L.ymax=Math.max(L.ymax,da),Math.abs(W-U/2)<fa)L.xmin=Q,L.xmax+=U;else if(Math.abs(Q+U/2)<fa)L.xmax=W+U;else return null}return L}function z(t,L,U=null,Q=!0,ca=!0){const W=t.spatialReference;if(W.equals(L)||!L)return t;k(W,L,U);const da=N.project(t,L,U);if(ca&&L.isWebMercator&&da&&(da.ymax=Math.min(2.0037508342787E7,da.ymax),da.ymin=Math.max(-2.0037508342787E7,da.ymin),da.ymin>=da.ymax))return null;if(!Q||!da)return da;
var fa=G(W,!0);Q=G(L,!0);if(null==fa||null==Q)return da;ca=B(W,.001);const ha=B(W,500);var la=B(L,.001);if(Math.abs(da.xmin-Q[0])<la&&Math.abs(da.xmax-Q[1])<la){la=Math.abs(t.xmin-fa[0]);fa=Math.abs(fa[1]-t.xmax);if(la<ca&&fa>ha){da.xmin=Q[0];var ka=[];ka.push(new v(t.xmax,t.ymin,W));ka.push(new v(t.xmax,(t.ymin+t.ymax)/2,W));ka.push(new v(t.xmax,t.ymax,W));ka=ka.map(pa=>D(pa,L,U)).filter(pa=>!isNaN(pa?.x)).map(pa=>pa.x);da.xmax=Math.max.apply(null,ka)}fa<ca&&la>ha&&(da.xmax=Q[1],Q=[],Q.push(new v(t.xmin,
t.ymin,W)),Q.push(new v(t.xmin,(t.ymin+t.ymax)/2,W)),Q.push(new v(t.xmin,t.ymax,W)),t=Q.map(pa=>D(pa,L,U)).filter(pa=>!isNaN(pa?.x)).map(pa=>pa.x),da.xmin=Math.min.apply(null,t))}else t=B(L,.001),Math.abs(da.xmin-Q[0])<t&&(da.xmin=Q[0]),Math.abs(da.xmax-Q[1])<t&&(da.xmax=Q[1]);return da}function I(t,L=!1){return t?t.isWebMercator?2*(L?2.0037508342787E7:2.0037508342788905E7):t.wkid&&t.isGeographic?360:2*Y[t.wkid]||null:null}function G(t,L=!1){if(t.isGeographic)return[-180,180];t=I(t,L);return null!=
t?[-t/2,t/2]:null}function R(t,L,U,Q){t=(t-L)/U;0!==t-Math.floor(t)?t=Math.floor(t):Q&&--t;return t}function J(t,L=!1){var U=I(t.spatialReference);if(null==U)return 0;const Q=L?0:-(U/2),ca=B(t.spatialReference),W=!L&&Math.abs(t.xmin+U/2)<ca?-U/2:t.xmin;t=R(!L&&Math.abs(t.xmax-U/2)<ca?U/2:t.xmax,Q,U,!0);U=R(W,Q,U,!1);return t-U}function V(t){const {projectedExtent:L,srcBufferExtent:U,pixelSize:Q,datumTransformation:ca,rasterTransform:W}=t;var da=L.spatialReference;const fa=U.spatialReference;var ha=
k(da,fa);const {xmin:la,ymin:ka,xmax:pa,ymax:na}=L,oa=I(fa),sa=null!=oa&&(t.hasWrapAround||"gcs-shift"===W?.type);t=t.spacing||[32,32];var ta=t[0]*Q.x,ua=t[1]*Q.y;const qa=1===t[0],xa=Math.ceil((pa-la)/ta-.1/t[0])+(qa?0:1),va=Math.ceil((na-ka)/ua-.1/t[1])+(qa?0:1);ta=a({cols:xa,rows:va,xmin:la,ymax:na,xres:ta,yres:ua,inSR:da,outSR:fa,datumTransformation:ca,preferPE:4>=t[0],usePixelCenter:qa});ua=[];let ya,Z=0;const ia=qa?-1:NaN,{xmin:ba,xmax:ja,ymax:ma,width:ea,height:ra}=U,wa=B(fa,500),za=null!=
oa&&0<ba&&ja>oa/2;var Ba=!1;ha&&(Ba=b(da),Ba=null!=Ba&&0<Ba.poleLocation);for(da=0;da<xa;da++){ha=[];for(let Ca=0;Ca<va;Ca++){var Aa=ta[da*va+Ca];sa&&Aa[0]>ja&&Aa[0]>oa/2-wa?Aa[0]-=oa:sa&&0===da&&0>Aa[0]&&za&&!W&&(Aa[0]+=oa);!Aa||isNaN(Aa[0])||isNaN(Aa[1])?(ua.push(ia),ua.push(ia),ha.push(null),Z++):(W&&(Aa=W.inverseTransform(new v({x:Aa[0],y:Aa[1],spatialReference:fa})),Aa=[Aa.x,Aa.y]),ha.push(Aa),0<da&&sa&&ya[Ca]&&Aa[0]<ya[Ca][0]&&(Aa[0]+=oa,Ba&&Aa[0]>ja&&Aa[0]>oa&&(Aa[0]-=oa)),ua.push((Aa[0]-ba)/
ea),ua.push((ma-Aa[1])/ra))}ya=ha}return{offsets:ua,error:null,coefficients:null,outofBoundPointCount:Z,spacing:t,size:qa?[xa,va]:[xa-1,va-1]}}function A(t,L,U){const {cols:Q,rows:ca}=L;L=new Float32Array((Q-1)*(ca-1)*12);const W=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),da=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let na=0;na<Q-1;na++){for(var fa=0;fa<ca-1;fa++){var ha=na*ca*2+2*fa,la=t[ha];const oa=t[ha+1];var ka=t[ha+2],pa=t[ha+3];ha+=2*ca;const sa=t[ha],ta=t[ha+1],ua=t[ha+2];ha=t[ha+3];let qa=
0,xa=12*(fa*(Q-1)+na);for(let va=0;3>va;va++)L[xa++]=W[qa++]*la+W[qa++]*ka+W[qa++]*ua;qa=0;for(ka=0;3>ka;ka++)L[xa++]=W[qa++]*oa+W[qa++]*pa+W[qa++]*ha;qa=0;for(pa=0;3>pa;pa++)L[xa++]=da[qa++]*la+da[qa++]*sa+da[qa++]*ua;qa=0;for(la=0;3>la;la++)L[xa++]=da[qa++]*oa+da[qa++]*ta+da[qa++]*ha}if(U)for(fa=0;fa<L.length;fa++)isNaN(L[fa])&&(L[fa]=-1)}return L}function C(t,L){t=t.clone().normalize();return 1===t.length?t[0]:q(t,L)}function P(t,L){const {pixelSize:U,extent:Q}=t;t=y(Q,L,!1);const ca=C(Q,(U.x+
U.y)/16);return w(ca,L,t)}var X;(function(t){t[t.None=0]="None";t[t.North=1]="North";t[t.South=2]="South";t[t.Both=3]="Both"})(X||={});const O=(t,L,U,Q=0)=>{if(1===U[0])return[0,0];var ca=1,W=-1,da=1,fa=-1;for(var ha=0;ha<t.length;ha+=2)isNaN(t[ha])||(ca=ca>t[ha]?t[ha]:ca,W=W>t[ha]?W:t[ha],da=da>t[ha+1]?t[ha+1]:da,fa=fa>t[ha+1]?fa:t[ha+1]);const {cols:la,rows:ka}=L;L=(W-ca)/la/U[0];U=(fa-da)/ka/U[1];Q*=2;da=0;fa=!1;ca=[0,0];for(W=0;W<la-3;W++){for(ha=0;ha<ka-3;ha++){var pa=W*ka*2+2*ha;const na=Math.abs(((t[pa]+
t[pa+4]+t[pa+4*ka]+t[pa+4*ka+4])/4-t[pa+2*ka+2])/L);pa=Math.abs(((t[pa+1]+t[pa+5]+t[pa+4*ka+1]+t[pa+4*ka+5])/4-t[pa+2*ka+3])/U);na+pa>da&&(da=na+pa,ca=[na,pa]);if(Q&&da>Q){fa=!0;break}}if(fa)break}return ca},Y={3395:2.0037508342789244E7,3410:1.7334193943686873E7,3857:2.0037508342788905E7,3975:1.7367530445161372E7,4087:2.0037508342789244E7,4088:2.0015108787169147E7,6933:1.7367530445161372E7,32662:2.0037508342789244E7,53001:2.001508679602057E7,53002:1.000754339801029E7,53003:2.001508679602057E7,53004:2.001508679602057E7,
53016:1.4152803599503474E7,53017:1.7333573624304302E7,53034:2.001508679602057E7,53079:2.0015114352186374E7,53080:2.0015114352186374E7,54001:2.0037508342789244E7,54002:1.0018754171394624E7,54003:2.0037508342789244E7,54004:2.0037508342789244E7,54016:1.4168658027268292E7,54017:1.736753044516137E7,54034:2.0037508342789244E7,54079:2.0037508342789244E7,54080:2.0037508342789244E7,54100:2.0037508342789244E7,54101:2.0037508342789244E7},S=new Map,aa=new Map;m.computeProjectedScales=function(t,L,U){var Q=U?.tileSize??
512,ca=U?.alignGlobalDatasetWithAGOL??!0,W=!!U?.limitToSrcResolution;const {extent:da,spatialReference:fa,pixelSize:ha}=t;U=h(new v({x:ha.x,y:ha.y,spatialReference:fa}),L,da);if(null==U)return{projectedPixelSize:null,scales:null,srcResolutions:null,isCustomTilingScheme:!1};const la=(U.x+U.y)/2,ka=F.getMetersPerUnitForSR(L);var pa=la*ka*96*39.37,na=L.isGeographic?256/Q*2.958287637958547E8:256/Q*5.91657527591555E8,oa="vector-magdir"===t.dataType||"vector-uv"===t.dataType,sa=P(t,L),ta=Math.min(Math.ceil(Math.log(Math.min(t.width,
t.height)/32)/Math.LN2),Math.ceil(Math.log(na/2/pa)/Math.LN2));if(!oa&&ca&&(L.isGeographic||L.isWebMercator)&&(ca=I(L),oa=0<J(sa)||null!=ca&&sa.width>ca/4,!oa&&null!=ca)){oa=-1;if(3>ta)oa=2**ta*la*Q;else if(t.storageInfo){const {maximumPyramidLevel:ua=0,pyramidScalingFactor:qa=2}=t.storageInfo;oa=qa**ua*la*Q}Q=Math.ceil(ca/oa);oa=1===Q||2===Q&&ca/2-sa.xmax<oa}Q=pa;t=Math.min(2,Math.max(1.414,t.storageInfo?.pyramidScalingFactor||2));if(oa)Q=na,na=L.isGeographic?1.341104507446289E-6:.29858214164761665,
ta=96*na*ka*39.37,L=h(new v({x:na,y:na,spatialReference:{wkid:L.isGeographic?4326:3857}}),fa,sa),L.x*=Q/ta,L.y*=Q/ta;else{L={x:ha.x,y:ha.y};for(sa=0;Q<.5005*na&&sa<ta;)sa++,Q*=t,L.x*=t,L.y*=t;1.001>=Math.max(Q,na)/Math.min(Q,na)&&(Q=na)}na=[Q];sa=[{x:L.x,y:L.y}];for(pa=Math.min(70.5310735,pa)/1.001;Q>=pa;)Q/=t,L.x/=t,L.y/=t,na.push(Q),sa.push({x:L.x,y:L.y});if(W){const ua=.001*ha.x;W=sa.findIndex(qa=>qa.x>=ha.x-ua&&qa.x<=ha.x+ua);-1<W?(sa.length=W+1,na.length=W+1):(W=sa.findIndex(qa=>qa.x<=ha.x+ua),
0<W&&(sa.length=W,na.length=W))}return{projectedPixelSize:U,scales:na,srcResolutions:sa,isCustomTilingScheme:!oa}};m.defaultGridSpacing=32;m.defaultProjectionToleranceInPixels=4;m.getDefaultDatumTransformationForDataset=y;m.getProjectedGridPoints=a;m.getProjectionOffsetGrid=function(t){var L=t.isAdaptive&&null==t.spacing;let U=t.spacing||[32,32],Q=V(t);var ca={cols:Q.size[0]+1,rows:Q.size[1]+1};const W=0<Q.outofBoundPointCount&&Q.outofBoundPointCount<Q.offsets.length/2;let da=Q.outofBoundPointCount===
Q.offsets.length/2||L&&W?[0,0]:O(Q.offsets,ca,U,4);const fa=(da[0]+da[1])/2;var ha=t.projectedExtent.spatialReference;const la=t.srcBufferExtent.spatialReference;L&&(W||4<fa)&&(g(ha,la,t.datumTransformation)&&(ha.isGeographic||null!=b(ha)),U=[4,4],Q=V({...t,spacing:U}),ca={cols:Q.size[0]+1,rows:Q.size[1]+1},da=O(Q.offsets,ca,U,4));Q.error=da;1<U[0]&&(Q.coefficients=A(Q.offsets,ca,W));!t.includeGCSGrid||ha.isGeographic||ha.isWebMercator||(la.isGeographic?Q.gcsGrid={offsets:Q.offsets,coefficients:Q.coefficients,
spacing:U}:(L=b(ha),null==L||L.isEnvelope||(ha&&!ha.isGeographic&&(L=String(ha.wkid||ha.wkt2||ha.wkt),aa.has(L)?ha=aa.get(L):(ha=(ha.wkid?T.PeFactory.coordsys(ha.wkid):T.PeFactory.fromString(T.PeDefs.PE_TYPE_PROJCS,ha.wkt2||ha.wkt)).getGeogcs().getCode(),aa.set(L,ha)),ha=new e({wkid:ha})),ha=w(t.projectedExtent,ha),{offsets:t}=V({...t,srcBufferExtent:ha,spacing:U}),ca=A(t,ca,W),Q.gcsGrid={offsets:t,coefficients:ca,spacing:U})));return Q};m.getRasterDatasetAlignmentInfo=function(t){const L=t.storageInfo.origin.x;
var U=I(t.spatialReference,!0);if(null==U)return{originX:L,halfWorldWidth:null,pyramidsInfo:null};const Q=U/2,{nativePixelSize:ca,storageInfo:W,extent:da}=t,{maximumPyramidLevel:fa,blockWidth:ha,pyramidScalingFactor:la}=W;let ka=ca.x;const pa=[];t=null!=t.transform&&"gcs-shift"===t.transform.type;const na=L+(t?0:Q);U=t?U-L:Q-L;for(let oa=0;oa<=fa;oa++){const sa=(da.xmax-L)/ka/ha,ta=U/ka/ha;pa.push({resolutionX:ka,blockWidth:ha,datasetColumnCount:0===sa-Math.floor(sa)?sa:Math.ceil(sa),worldColumnCountFromOrigin:0===
ta-Math.floor(ta)?ta:Math.ceil(ta),leftMargin:Math.round(na/ka)%ha,rightPadding:(ha-Math.round(U/ka)%ha)%ha,originColumnOffset:Math.floor(na/ka/ha)});ka*=la}return{originX:L,halfWorldWidth:Q,pyramidsInfo:pa,hasGCSSShiftTransform:t}};m.getWorldWidth=I;m.getWorldWrapCount=J;m.load=async function(){N.isLoaded()||await N.load()};m.minimumGridSpacing=4;m.projectDatasetExtent=P;m.projectExtent=w;m.projectPoint=D;m.projectPolygon=function(t,L,U){if("extent"===t.type){const {xmin:Q,ymin:ca,xmax:W,ymax:da,
spatialReference:fa}=t;t=new n({rings:[[[Q,da],[W,da],[W,ca],[Q,ca],[Q,da]]],spatialReference:fa})}if(t.spatialReference.equals(L))return t;k(t.spatialReference,L,U);return N.project(t,L,U)};m.projectResolution=h;m.requirePE=g;m.shiftExtent=function(t){var {spatialReference:L}=t;L=M.getInfo(L);if(!L)return t;const [U,Q]=L.valid;L=Q-U;let ca=0;t.xmin<U?ca=Math.ceil((U-t.xmin)/L):t.xmin>Q&&(ca=-Math.ceil((t.xmin-Q)/L));return new H({spatialReference:t.spatialReference,xmin:t.xmin+ca*L,ymin:t.ymin,xmax:t.xmax+
ca*L,ymax:t.ymax})};m.snapExtent=C;m.snapPyramid=function(t,L,U){const {storageInfo:Q,pixelSize:ca}=L;var W=0;let da=!1;var {pyramidResolutions:fa}=Q,ha="mixed"===Q.tileInfo.format?.toLowerCase()?Math.max(1,Math.min(3,Q.tileInfo.dpi/96)):1;ha=(t.x+t.y)/2/ha;if(null!=fa&&fa.length){t=fa[fa.length-1];t=(t.x+t.y)/2;var la=(ca.x+ca.y)/2;if(ha<=la)W=0;else if(ha>=t)W=fa.length,da=8<ha/t;else{t=la;for(let ka=1;ka<=fa.length;ka++){la=(fa[ka-1].x+fa[ka-1].y)/2;if(ha<=la){ha===la?W=ka:"down"===U?(W=ka-1,da=
8<ha/t):W="up"===U?ka:ha-t>la-ha||2<ha/t?ka:ka-1;break}t=la}}U=0===W?ca:fa[W-1];da&&(fa=Math.min(U.x,U.y),ha=F.getMetersPerUnitForSR(L.spatialReference),19567<fa*ha&&(da=!1));return{pyramidLevel:W,pyramidResolution:new v({x:U.x,y:U.y,spatialReference:L.spatialReference}),excessiveReading:da}}W=Math.log(t.x/ca.x)/Math.LN2;ha=Math.log(t.y/ca.y)/Math.LN2;fa=L.storageInfo.maximumPyramidLevel||0;W="down"===U?Math.floor(Math.min(W,ha)):"up"===U?Math.ceil(Math.max(W,ha)):Math.round((W+ha)/2);0>W?W=0:W>fa&&
(da=W>fa+3,W=fa);U=2**W;L=new v({x:U*L.nativePixelSize.x,y:U*L.nativePixelSize.y,spatialReference:L.spatialReference});return{pyramidLevel:W,pyramidResolution:L,excessiveReading:da}};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/vectorFieldUtils":function(){define(["exports","../../../core/jsonMap","../PixelBlock","./pixelUtils"],function(m,x,u,K){function F(f,l){return h.get(f)/h.get(l)||1}function T(f,l="geographic"){const [r,q]=f;f=Math.sqrt(r*
r+q*q);let w=Math.atan2(q,r)*B;w=(360+w)%360;"geographic"===l&&(w=(450-w)%360);return[f,w]}function N(f,l="geographic"){let r=f[1];"geographic"===l&&(r=(450-r)%360);r%=360;f=f[0];return[f*Math.cos(r/B),f*Math.sin(r/B)]}function M(f,l,r="geographic",q=1){if(!K.isValidPixelBlock(f))return f;const {pixels:w,width:p,height:z}=f;var I=p*z;const G=w[0],R=w[1],J=f.pixelType.startsWith("f")?f.pixelType:"f32",V=u.createEmptyBand(J,I);I=u.createEmptyBand(J,I);let A=0;for(let C=0;C<z;C++)for(let P=0;P<p;P++)"vector-uv"===
l?([V[A],I[A]]=T([G[A],R[A]],r),V[A]*=q):([V[A],I[A]]=N([G[A],R[A]],r),V[A]*=q,I[A]*=q),A++;f=new u({pixelType:J,width:f.width,height:f.height,mask:f.mask,validPixelCount:f.validPixelCount,maskIsAlpha:f.maskIsAlpha,pixels:[V,I]});f.updateStatistics();return f}function H(f=0,l=0,r=Math.PI,q=!0){q&&(r=(2*Math.PI-r)%(2*Math.PI));q=q?-1:1;const w=-7*q,p=-2*q,z=-16*q,[I,G]=n(0,l+13*q,r,21.75),[R,J]=n(f-5.5,l+w,r,21.75),[V,A]=n(f+5.5,l+w,r,21.75),[C,P]=n(f-1.5,l+p,r,21.75),[X,O]=n(f+1.5,l+p,r,21.75),[Y,
S]=n(f-1.5,l+z,r,21.75),[aa,t]=n(f+1.5,l+z,r,21.75);return[I,G,R,J,C,P,X,O,V,A,Y,S,aa,t]}function v(f=0,l=Math.PI,r=!0){r&&(l=(2*Math.PI-l)%(2*Math.PI));var q=r?-1:1,w=5*q;const p=20*q,z=25*q;q*=2;const I=r?1:-1;r=5*I;let [G,R]=[0+r,0-p],[J,V]=[G+2*I,R],[A,C]=[J-0*I,V+q],[P,X]=[0-r,0-z],[O,Y]=[P+0*I,X-q],S=Math.ceil(f/5),aa=Math.floor(S/10);S-=8*aa;f=[];const t=[];for(let la=0;la<S/2;la++,aa--){0>=aa&&1===S%2&&la===(S-1)/2&&(P=0,O=P+0*I,X=(X+R)/2,Y=X-q);const [ka,pa]=n(P,X,l,45);if(0<aa){const [na,
oa]=n(J,X,l,45),[sa,ta]=n(G,R,l,45);f.push(na);f.push(oa);f.push(ka);f.push(pa);f.push(sa);f.push(ta)}else{const [na,oa]=n(J,V,l,45),[sa,ta]=n(A,C,l,45),[ua,qa]=n(O,Y,l,45);t.push(ka);t.push(pa);t.push(ua);t.push(qa);t.push(sa);t.push(ta);t.push(na);t.push(oa)}X+=w;R+=w;V+=w;C+=w;Y+=w}const [L,U]=n(0+r,0+p,l,45);w=7*I;const [Q,ca]=n(0+w,0+p,l,45),[W,da]=n(0+r,0-z,l,45),[fa,ha]=n(0+w,0-z,l,45);return{pennants:f,barbs:t,shaft:[L,U,Q,ca,W,da,fa,ha]}}function n(f,l,r,q=1){return[Math.sqrt(f*f+l*l)/q,
(2*Math.PI+(2*Math.PI+Math.atan2(l,f))%(2*Math.PI)-r)%(2*Math.PI)]}function e(f,l,r,q){r=F(q||"knots",r);for(q=1;q<l.length;q++)if(q===l.length-1){if(f<l[q]*r)break}else if(f<=l[q]*r)break;return Math.min(q-1,l.length-2)}function g(f,l,r,q,w){let p=0;switch(l){case "beaufort_kn":p=e(f,a,"knots",r);break;case "beaufort_km":p=e(f,a,"kilometer-per-hour",r);break;case "beaufort_ft":p=e(f,a,"feet-per-second",r);break;case "beaufort_m":p=e(f,a,"meter-per-second",r);break;case "classified_arrow":p=e(f,w??
[],q,r);break;case "ocean_current_m":p=e(f,d,"meter-per-second",r);break;case "ocean_current_kn":p=e(f,c,"knots",r)}return p}function k(f,l){const {style:r,inputUnit:q,outputUnit:w,breakValues:p}=l,z=D.fromJSON(q),I=D.fromJSON(w);let G=0,R=0;const {width:J,height:V,mask:A}=f,C=f.pixels[0];f=f.pixels[1];var P=null!=A?A.filter(Y=>0<Y).length:J*V;const X=new Float32Array(42*P);P=new Uint32Array(15*P);l=l.invertDirection?H(0,0,0,!1):E;for(let Y=0;Y<V;Y++)for(let S=0;S<J;S++){var O=Y*J+S;if(!A||A[Y*J+
S]){const aa=(f[O]+360)%360/180*Math.PI,t=g(C[O],r,z,I,p);for(let L=0;L<l.length;L+=2)X[G++]=(S+.5)/J,X[G++]=(Y+.5)/V,X[G++]=l[L],X[G++]=l[L+1]+aa,X[G++]=t,X[G++]=C[O];O=7*(G/42-1);P[R++]=O;P[R++]=O+1;P[R++]=O+2;P[R++]=O+0;P[R++]=O+4;P[R++]=O+3;P[R++]=O+0;P[R++]=O+2;P[R++]=O+3;P[R++]=O+2;P[R++]=O+5;P[R++]=O+3;P[R++]=O+5;P[R++]=O+6;P[R++]=O+3}}return{vertexData:X,indexData:P}}function y(f,l){let r=0,q=0;const {width:w,height:p,mask:z}=f;f=f.pixels[0];const I=[],G=[];var R=D.fromJSON(l.inputUnit);R=
F(R,"knots");l="wind_speed"===l.style?5:Number.MAX_VALUE;for(let V=0;V<p;V++)for(let A=0;A<w;A++){var J=f[V*w+A]*R;if((!z||z[V*w+A])&&J<l){for(let C=0;4>C;C++)I[r++]=(A+.5)/w,I[r++]=(V+.5)/p,I[r++]=2>C?-.5:.5,I[r++]=0===C%2?-.5:.5,I[r++]=0,I[r++]=J;J=4*(r/24-1);G[q++]=J;G[q++]=J+1;G[q++]=J+2;G[q++]=J+1;G[q++]=J+2;G[q++]=J+3}}return{vertexData:new Float32Array(I),indexData:new Uint32Array(G)}}const h=new Map;h.set("meter-per-second",1);h.set("kilometer-per-hour",.277778);h.set("knots",.514444);h.set("feet-per-second",
.3048);h.set("mile-per-hour",.44704);const B=180/Math.PI,D=new x.JSONMap({esriMetersPerSecond:"meter-per-second",esriKilometersPerHour:"kilometer-per-hour",esriKnots:"knots",esriFeetPerSecond:"feet-per-second",esriMilesPerHour:"mile-per-hour"}),E=H(0,0,0),a=[0,1,3,6,10,16,21,27,33,40,47,55,63],d=[0,.5,1,1.5,2],c=[0,.25,.5,1,1.5,2,2.5,3,3.5,4],b=[];m.convertToLocalDirections=function(f,l,r,q="geographic"){if(!K.isValidPixelBlock(f)||null==r)return f;f="vector-magdir"===l?f.clone():M(f,l);const w=f.pixels[1];
for(let p=0;p<w.length;p++)w[p]="geographic"===q?(w[p]+r[p]+270)%360:(w[p]+360-r[p])%360;return"vector-magdir"===l?f:M(f,"vector-magdir")};m.convertVectorFieldData=M;m.convertVectorFieldUnit=function(f,l,r=1){if(1===r||!K.isValidPixelBlock(f))return f;f=f.clone();const {pixels:q,width:w,height:p}=f,z=q[0],I=q[1];let G=0;for(let R=0;R<p;R++)for(let J=0;J<w;J++)"vector-uv"===l?(z[G]*=r,I[G]*=r):z[G]*=r,G++;f.updateStatistics();return f};m.createVFMesh=function(f,l){if("simple_scalar"===l.style)l=y(f,
l);else if("wind_speed"===l.style){if(0===b.length)for(var r=0;30>r;r++)b.push(v(5*r,0,!l.invertDirection));l=D.fromJSON(l.inputUnit);l=F(l,"knots");const {width:z,height:I,mask:G}=f;r=f.pixels[0];f=f.pixels[1];const R=[],J=[];let V=0,A=0;for(let C=0;C<I;C++)for(let P=0;P<z;P++){var q=C*z+P,w=r[q]*l;if((!G||G[C*z+P])&&5<=w){const X=(f[q]+360)%360/180*Math.PI,{pennants:O,barbs:Y,shaft:S}=b[Math.min(Math.floor(w/5),29)];if(0===O.length+Y.length)continue;q=R.length/6;const aa=(P+.5)/z,t=(C+.5)/I;for(var p=
0;p<O.length;p+=2)R[V++]=aa,R[V++]=t,R[V++]=O[p],R[V++]=O[p+1]+X,R[V++]=0,R[V++]=w;for(p=0;p<Y.length;p+=2)R[V++]=aa,R[V++]=t,R[V++]=Y[p],R[V++]=Y[p+1]+X,R[V++]=0,R[V++]=w;for(p=0;p<S.length;p+=2)R[V++]=aa,R[V++]=t,R[V++]=S[p],R[V++]=S[p+1]+X,R[V++]=0,R[V++]=w;for(w=0;w<O.length/6;w++)J[A++]=q,J[A++]=q+1,J[A++]=q+2,q+=3;for(w=0;w<Y.length/8;w++)J[A++]=q,J[A++]=q+1,J[A++]=q+2,J[A++]=q+1,J[A++]=q+2,J[A++]=q+3,q+=4;J[A++]=q+0;J[A++]=q+1;J[A++]=q+2;J[A++]=q+1;J[A++]=q+3;J[A++]=q+2;q+=4}}l={vertexData:new Float32Array(R),
indexData:new Uint32Array(J)}}else l=k(f,l);return l};m.createVFMeshScalar=y;m.getUnitConversionFactor=F;m.sampleVectorField=function(f,l,r,q=[0,0],w=.5){const {width:p,height:z,mask:I}=f,[G,R]=f.pixels,[J,V]=q;f=Math.round((p-J)/r);q=Math.round((z-V)/r);var A=f*q;const C=new Float32Array(A),P=new Float32Array(A);A=new Uint8Array(A);l="vector-uv"===l;for(let O=0;O<q;O++)for(let Y=0;Y<f;Y++){let S=0;const aa=O*f+Y,t=Math.max(0,O*r+V),L=Math.max(0,Y*r+J),U=Math.min(z,t+r),Q=Math.min(p,L+r);for(let ca=
t;ca<U;ca++)for(let W=L;W<Q;W++){var X=ca*p+W;if(!I||I[X]){S++;X=l?[G[X],R[X]]:[G[X],(360+R[X])%360];const [da,fa]=l?X:N(X);C[aa]+=da;P[aa]+=fa}}if(S>=(U-t)*(Q-L)*(1-w)){A[aa]=1;const [ca,W]=T([C[aa]/S,P[aa]/S]);C[aa]=ca;P[aa]=W}else A[aa]=0,C[aa]=0,P[aa]=0}r=new u({width:f,height:q,pixels:[C,P],mask:A});r.updateStatistics();return r};m.snapImageToSymbolTile=function(f,l,r,q,w){if(null==w||!w.spatialReference.equals(f.spatialReference))return{extent:f,width:Math.round(l/q),height:Math.round(r/q),
resolution:f.width/l};const p=w.xmin;w=w.ymax;l=(f.xmax-f.xmin)/l*q;r=(f.ymax-f.ymin)/r*q;f.xmin=p+Math.floor((f.xmin-p)/l)*l;f.xmax=p+Math.ceil((f.xmax-p)/l)*l;f.ymin=w+Math.floor((f.ymin-w)/r)*r;f.ymax=w+Math.ceil((f.ymax-w)/r)*r;return{extent:f,width:Math.round(f.width/l),height:Math.round(f.height/r),resolution:(l+r)/2}};m.unitKebabDict=D;m.uvComponentToVector=T;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterTransforms/utils":function(){define(["exports",
"./GCSShiftTransform","./IdentityTransform","./PolynomialTransform"],function(m,x,u,K){const F={GCSShiftXform:x,IdentityXform:u,PolynomialXform:K},T=Object.keys(F);m.isTransformSupported=function(N){return!N||T.includes(N?.type)};m.readTransform=function(N){if(!N?.type)return null;var M=F[N?.type];return M?(M=new M,M.read(N),M):null};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterTransforms/GCSShiftTransform":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseRasterTransform".split(" "),
function(m,x,u,K,F,T,N,M){var H;u=H=class extends M{constructor(){super(...arguments);this.type="gcs-shift";this.tolerance=1E-8}forwardTransform(v){v=v.clone();if("point"===v.type)return v.x>180+this.tolerance&&(v.x-=360),v;v.xmin>=180-this.tolerance?(v.xmax-=360,v.xmin-=360):v.xmax>180+this.tolerance&&(v.xmin=-180,v.xmax=180);return v}inverseTransform(v){v=v.clone();if("point"===v.type)return v.x<-this.tolerance&&(v.x+=360),v;v.xmin<-this.tolerance&&(v.xmin+=360,v.xmax+=360);return v}clone(){return new H({tolerance:this.tolerance})}};
m.__decorate([T.enumeration({GCSShiftXform:"gcs-shift"})],u.prototype,"type",void 0);m.__decorate([x.property()],u.prototype,"tolerance",void 0);return u=H=m.__decorate([N.subclass("esri.layers.support.rasterTransforms.GCSShiftTransform")],u)})},"esri/layers/support/rasterTransforms/BaseRasterTransform":function(){define("../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),
function(m,x,u,K,F,T,N){x=class extends x.JSONSupport{get affectsPixelSize(){return!1}forwardTransform(M){return M}inverseTransform(M){return M}};m.__decorate([u.property()],x.prototype,"affectsPixelSize",null);m.__decorate([u.property({json:{write:!0}})],x.prototype,"spatialReference",void 0);return x=m.__decorate([N.subclass("esri.layers.support.rasterTransforms.BaseRasterTransform")],x)})},"esri/layers/support/rasterTransforms/IdentityTransform":function(){define("../../../chunks/tslib.es6 ../../../core/Logger ../../../core/has ../../../core/RandomLCG ../../../core/Error ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseRasterTransform".split(" "),
function(m,x,u,K,F,T,N,M){var H;x=H=class extends M{constructor(){super(...arguments);this.type="identity"}clone(){return new H}};m.__decorate([T.enumeration({IdentityXform:"identity"})],x.prototype,"type",void 0);return x=H=m.__decorate([N.subclass("esri.layers.support.rasterTransforms.IdentityTransform")],x)})},"esri/layers/support/rasterTransforms/PolynomialTransform":function(){define("../../../chunks/tslib.es6 ../../../geometry ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseRasterTransform ../../../geometry/Point ../../../geometry/Extent".split(" "),
function(m,x,u,K,F,T,N,M,H,v,n,e,g){function k(B,D,E){const {x:a,y:d}=D;if(2>E)return{x:B[0]+a*B[2]+d*B[4],y:B[1]+a*B[3]+d*B[5]};if(2===E){D=a*a;E=d*d;var c=a*d;return{x:B[0]+a*B[2]+d*B[4]+D*B[6]+c*B[8]+E*B[10],y:B[1]+a*B[3]+d*B[5]+D*B[7]+c*B[9]+E*B[11]}}D=a*a;E=d*d;c=a*d;const b=D*a,f=D*d,l=a*E,r=d*E;return{x:B[0]+a*B[2]+d*B[4]+D*B[6]+c*B[8]+E*B[10]+b*B[12]+f*B[14]+l*B[16]+r*B[18],y:B[1]+a*B[3]+d*B[5]+D*B[7]+c*B[9]+E*B[11]+b*B[13]+f*B[15]+l*B[17]+r*B[19]}}function y(B,D,E){const {xmin:a,ymin:d,xmax:c,
ymax:b,spatialReference:f}=D;D=[];if(2>E)D.push({x:a,y:b}),D.push({x:c,y:b}),D.push({x:a,y:d}),D.push({x:c,y:d});else{var l=10;for(var r=0;r<l;r++)D.push({x:a,y:d+(b-d)*r/(l-1)}),D.push({x:c,y:d+(b-d)*r/(l-1)});l=8;for(r=1;r<=l;r++)D.push({x:a+(c-a)*r/l,y:d}),D.push({x:a+(c-a)*r/l,y:b})}D=D.map(q=>k(B,q,E));l=D.map(q=>q.x);D=D.map(q=>q.y);return new g({xmin:Math.min.apply(null,l),xmax:Math.max.apply(null,l),ymin:Math.min.apply(null,D),ymax:Math.max.apply(null,D),spatialReference:f})}var h;x=h=class extends n{constructor(){super(...arguments);
this.polynomialOrder=1;this.type="polynomial"}readForwardCoefficients(B,D){const {coeffX:E,coeffY:a}=D;if(!E?.length||!a?.length||E.length!==a.length)return null;B=[];for(D=0;D<E.length;D++)B.push(E[D]),B.push(a[D]);return B}writeForwardCoefficients(B,D,E){E=[];const a=[];for(let d=0;d<B?.length;d++)0===d%2?E.push(B[d]):a.push(B[d]);D.coeffX=E;D.coeffY=a}get inverseCoefficients(){var B=this._get("inverseCoefficients"),D=this._get("forwardCoefficients");if(!B&&D&&2>this.polynomialOrder){const [E,a,
d,c,b,f]=D;B=d*f-b*c;D=b*c-d*f;B=[(b*a-E*f)/B,(d*a-E*c)/D,f/B,c/D,-b/B,-d/D]}return B}set inverseCoefficients(B){this._set("inverseCoefficients",B)}readInverseCoefficients(B,D){const {inverseCoeffX:E,inverseCoeffY:a}=D;if(!E?.length||!a?.length||E.length!==a.length)return null;B=[];for(D=0;D<E.length;D++)B.push(E[D]),B.push(a[D]);return B}writeInverseCoefficients(B,D,E){E=[];const a=[];for(let d=0;d<B?.length;d++)0===d%2?E.push(B[d]):a.push(B[d]);D.inverseCoeffX=E;D.inverseCoeffY=a}get affectsPixelSize(){return 0<
this.polynomialOrder}forwardTransform(B){if("point"===B.type){const D=k(this.forwardCoefficients,B,this.polynomialOrder);return new e({x:D.x,y:D.y,spatialReference:B.spatialReference})}return y(this.forwardCoefficients,B,this.polynomialOrder)}inverseTransform(B){if("point"===B.type){const D=k(this.inverseCoefficients,B,this.polynomialOrder);return new e({x:D.x,y:D.y,spatialReference:B.spatialReference})}return y(this.inverseCoefficients,B,this.polynomialOrder)}clone(){return new h({polynomialOrder:this.polynomialOrder,
forwardCoefficients:this.forwardCoefficients?[...this.forwardCoefficients]:null,inverseCoefficients:this.inverseCoefficients?[...this.inverseCoefficients]:null})}};m.__decorate([u.property({json:{write:!0}})],x.prototype,"polynomialOrder",void 0);m.__decorate([u.property()],x.prototype,"forwardCoefficients",void 0);m.__decorate([M.reader("forwardCoefficients",["coeffX","coeffY"])],x.prototype,"readForwardCoefficients",null);m.__decorate([v.writer("forwardCoefficients")],x.prototype,"writeForwardCoefficients",
null);m.__decorate([u.property({json:{write:!0}})],x.prototype,"inverseCoefficients",null);m.__decorate([M.reader("inverseCoefficients",["inverseCoeffX","inverseCoeffY"])],x.prototype,"readInverseCoefficients",null);m.__decorate([v.writer("inverseCoefficients")],x.prototype,"writeInverseCoefficients",null);m.__decorate([u.property()],x.prototype,"affectsPixelSize",null);m.__decorate([N.enumeration({PolynomialXform:"polynomial"})],x.prototype,"type",void 0);return x=h=m.__decorate([H.subclass("esri.layers.support.rasterTransforms.PolynomialTransform")],
x)})},"esri/renderers/support/RasterSymbolizer":function(){define("../../chunks/tslib.es6 ../../core/colorUtils ../../core/JSONSupport ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/has ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../layers/support/RasterInfo ../../layers/support/rasterFunctions/pixelUtils ../../layers/support/rasterFunctions/stretchUtils ../../layers/support/rasterFunctions/surfaceUtils ./colorRampUtils ./rasterRendererChecks".split(" "),
function(m,x,u,K,F,T,N,M,H,v,n,e,g,k){function y(a){return!!a?.length&&16384>=a.length}function h(a){return"percentClip"===a||"histogramEqualization"===a}function B(a){return null!=a&&0<a.length&&null!=a[0].min&&null!=a[0].max}function D(a){return v.isValidPixelBlock(a)&&0!==a.validPixelCount}function E(a){return"algorithmic"===a.type&&["0,0,0,255","0,0,0"].includes(a.fromColor.join(","))&&["255,255,255,255","255,255,255"].includes(a.toColor.join(","))}u=class extends u.JSONSupport{constructor(a){super(a)}bind(){const {rendererJSON:a}=
this;if(!a)return{success:!1};this.lookup={rendererJSON:{}};let d;switch(a.type){case "uniqueValue":d=this._updateUVRenderer(a);break;case "rasterColormap":d=this._updateColormapRenderer(a);break;case "rasterStretch":d=this._updateStretchRenderer(a);break;case "classBreaks":d=this._updateClassBreaksRenderer(a);break;case "rasterShadedRelief":d=this._updateShadedReliefRenderer(a);break;case "vectorField":d=this._updateVectorFieldRenderer();break;case "flowRenderer":d=this._updateFlowRenderer()}return d}symbolize(a){let d=
a?.pixelBlock;if(!D(d))return d;if(a.simpleStretchParams&&"rasterStretch"===this.rendererJSON.type)return this.simpleStretch(d,a.simpleStretchParams);try{3<d.pixels.length&&(d=d.extractBands(a.bandIds??[0,1,2]));let c;switch(this.rendererJSON.type){case "uniqueValue":case "rasterColormap":c=this._symbolizeColormap(d);break;case "classBreaks":c=this._symbolizeClassBreaks(d);break;case "rasterStretch":c=this._symbolizeStretch(d,a.bandIds);break;case "rasterShadedRelief":const b=a.extent;c=this._symbolizeShadedRelief(d,
{isGCS:b.spatialReference.isGeographic,resolution:{x:(b.xmax-b.xmin)/d.width,y:(b.ymax-b.ymin)/d.height}})}return c}catch(c){return K.getLogger(this).error("symbolize",c.message),d}}simpleStretch(a,d){if(!D(a))return a;try{return 3<a.pixels.length&&(a=a.extractBands([0,1,2])),n.stretch(a,{...d,isRenderer:!0})}catch(c){return K.getLogger(this).error("symbolize",c.message),a}}generateWebGLParameters(a){if(["uniqueValue","rasterColormap","classBreaks"].includes(this.rendererJSON.type)){const {indexedColormap:l,
offset:r}=this.lookup.colormapLut||{};return{colormap:l,colormapOffset:r,type:"lut"}}const {pixelBlock:d,isGCS:c,resolution:b,bandIds:f}=a;({rendererJSON:a}=this);return"rasterStretch"===a.type?this._generateStretchWebGLParams(d,a,f):"rasterShadedRelief"===a.type?this._generateShadedReliefWebGLParams(a,c,b??void 0):"vectorField"===a.type?this._generateVectorFieldWebGLParams(a):null}_isLUTChanged(a){if(!this.lookup||!this.lookup.rendererJSON)return!0;if("colorRamp"in this.rendererJSON){const d=this.rendererJSON.colorRamp;
if(a)return JSON.stringify(d)!==JSON.stringify(this.lookup.rendererJSON.colorRamp);({...this.rendererJSON});({...this.lookup.rendererJSON})}return JSON.stringify(this.rendererJSON)!==JSON.stringify(this.lookup.rendererJSON)}_symbolizeColormap(a){return this._isLUTChanged()&&!this.bind().success?a:v.colorize(a,this.lookup.colormapLut)}_symbolizeClassBreaks(a){const {canUseIndexedLUT:d}=this._analyzeClassBreaks(this.rendererJSON);return this._isLUTChanged()&&!this.bind().success?a:d?v.colorize(a,this.lookup.colormapLut):
v.remapColor(a,this.lookup.remapLut??[])}_symbolizeStretch(a,d){const {rasterInfo:c}=this,{pixelType:b,bandCount:f}=c,l=this.rendererJSON;var r=["u8","u16","s8","s16"].includes(b);let q;var {dra:w}=l;({gamma:p}=this.lookup);if("histogramEqualization"===l.stretchType){r=w?null:this.lookup?.histogramLut;d=n.getStretchCutoff(l,{rasterInfo:c,pixelBlock:a,bandIds:d,returnHistogramLut:!r});var p=n.stretch(a,{...d,gamma:p,isRenderer:!0});p=v.lookupPixels(p,{lut:w?d.histogramLut:r,offset:0})}else if(r){if(w)w=
n.getStretchCutoff(l,{rasterInfo:c,pixelBlock:a,bandIds:d}),q=n.createStretchLUT({pixelType:b,...w,gamma:p,rounding:"floor"});else{if(this._isLUTChanged()&&!this.bind().success)return a;q=this.lookup?this.lookup.stretchLut:null}if(!q)return a;1<f&&null!=d&&d.length===a?.pixels.length&&q?.lut.length===f&&(q={lut:d.map(z=>q.lut[z]),offset:q.offset});p=v.lookupPixels(a,q)}else w=n.getStretchCutoff(l,{rasterInfo:c,pixelBlock:a,bandIds:d}),p=n.stretch(a,{...w,gamma:p,isRenderer:!0});if(l.colorRamp){if(this._isLUTChanged(!0)&&
!this.bind().success)return a;p=v.colorize(p,this.lookup?.colormapLut)}return p}_symbolizeShadedRelief(a,d){var c=this.rendererJSON;d=e.hillshade(a,{...c,...d});if(!c.colorRamp||this._isLUTChanged(!0)&&!this.bind().success)return d;c=this.lookup?this.lookup.hsvMap:null;if(!c)return d;e.tintHillshade(d,a,c,this.rasterInfo.statistics?.[0]??{min:0,max:8E3});return d}_isVectorFieldData(){const {bandCount:a,dataType:d}=this.rasterInfo;return 2===a&&("vector-magdir"===d||"vector-uv"===d)}_updateVectorFieldRenderer(){return this._isVectorFieldData()?
{success:!0}:{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; VectorFieldRenderer only supports "vector-magdir" and "vector-uv".`}}_updateFlowRenderer(){return this._isVectorFieldData()?{success:!0}:{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; FlowRenderer only supports "vector-magdir" and "vector-uv".`}}_updateUVRenderer(a){const {bandCount:d,attributeTable:c,pixelType:b}=this.rasterInfo,f=a.field1;if(!f)return{success:!1,error:"Unsupported renderer; missing UniqueValueRenderer.field."};
const l=a.defaultSymbol;var r=1===d&&["u8","s8"].includes(b);if(!k.isUVRendererSupported(this.rasterInfo,f)&&!r)return{success:!1,error:"Unsupported data; UniqueValueRenderer is only supported on single band data with a valid raster attribute table."};const q=[];if(null!=c){const w=c.fields.find(p=>"value"===p.name.toLowerCase());if(!w)return{success:!1,error:"Unsupported data; the data's raster attribute table does not have a value field."};c.features.forEach(p=>{const z=a.uniqueValueInfos?.find(I=>
String(I.value)===String(p.attributes[f]))?.symbol?.color;z?q.push([p.attributes[w.name]].concat(z)):l&&q.push([p.attributes[w.name]].concat(l.color))})}else{if("value"!==f.toLowerCase())return{success:!1,error:'Unsupported renderer; UniqueValueRenderer.field must be "Value" when raster attribute table is not available.'};a.uniqueValueInfos?.forEach(w=>{const p=w?.symbol?.color;p?q.push([parseInt(""+w.value,10)].concat(p)):l&&q.push([parseInt(""+w.value,10)].concat(l?.color))})}if(0===q.length)return{success:!1,
error:"Invalid UniqueValueRenderer. Cannot find matching records in the raster attribute table."};r=v.createColormapLUT({colormap:q});this.lookup={rendererJSON:a,colormapLut:r};this.canRenderInWebGL=y(r?.indexedColormap);return{success:!0}}_updateColormapRenderer(a){if(!k.isColormapRendererSupported(this.rasterInfo))return{success:!1,error:"Unsupported data; the data source does not have a colormap."};var d=a.colormapInfos.map(c=>[c.value].concat(c.color)).sort((c,b)=>c[0]-b[0]);if(!d||0===d.length)return{success:!1,
error:"Unsupported renderer; ColormapRenderer must have meaningful colormapInfos."};d=v.createColormapLUT({colormap:d});this.lookup={rendererJSON:a,colormapLut:d};this.canRenderInWebGL=y(d?.indexedColormap);return{success:!0}}_updateShadedReliefRenderer(a){if(!k.isShadedReliefRendererSupported(this.rasterInfo))return{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; ShadedReliefRenderer only supports "elevation", or single band float/s16 data.`};if(a.colorRamp){var d=g.convertColorRampToColormap(a.colorRamp,
{interpolateAlpha:!0});d=v.createColormapLUT({colormap:d});const c=[],b=d.indexedColormap;for(let f=0;f<b.length;f+=4){const l=x.toHSV({r:b[f],g:b[f+1],b:b[f+2]});c.push([l.h/60,l.s/100,255*l.v/100])}this.lookup={rendererJSON:a,colormapLut:d,hsvMap:c}}else this.lookup=null;this.canRenderInWebGL=!0;return{success:!0}}_analyzeClassBreaks(a){const {attributeTable:d,pixelType:c}=this.rasterInfo,b=null!=d?d.fields.find(r=>"value"===r.name.toLowerCase()):null,f=null!=d?d.fields.find(r=>r.name.toLowerCase()===
a.field.toLowerCase()):null,l=null!=b&&null!==f;return{canUseIndexedLUT:["u8","u16","s8","s16"].includes(c)||l,tableValueField:b,tableBreakField:f}}_updateClassBreaksRenderer(a){var {attributeTable:d}=this.rasterInfo;const {canUseIndexedLUT:c,tableValueField:b,tableBreakField:f}=this._analyzeClassBreaks(a);var l=a.classBreakInfos;if(!l?.length)return{success:!1,error:"Unsupported renderer; missing or invalid ClassBreaksRenderer.classBreakInfos."};l=l.sort((z,I)=>z.classMaxValue-I.classMaxValue);var r=
l[l.length-1],q=a.minValue;if(!c){var w=[];for(var p=0;p<l.length;p++)w.push({value:l[p].classMinValue??q,mappedColor:l[p].symbol.color}),q=l[p].classMaxValue;w.push({value:r.classMaxValue,mappedColor:r.symbol.color});this.lookup={rendererJSON:a,remapLut:w};this.canRenderInWebGL=!1;return{success:!0}}w=[];if(null!=d&&null!=b&&null!==f&&b!==f){r=b.name;const z=f.name,I=l[l.length-1],{classMaxValue:G}=I;q=a.minValue;for(p of d.features){d=p.attributes[r];const R=p.attributes[z],J=R===G?I:R<q?null:l.find(({classMaxValue:V})=>
V>R);J&&w.push([d].concat(J.symbol.color))}}else{q=Math.floor(a.minValue);for(p=0;p<l.length;p++){for(d=l[p];q<d.classMaxValue;q++)w.push([q].concat(d.symbol.color));q=Math.ceil(d.classMaxValue)}r.classMaxValue===q&&w.push([r.classMaxValue].concat(r.symbol.color))}l=v.createColormapLUT({colormap:w,fillUnspecified:!1});this.lookup={rendererJSON:a,colormapLut:l};this.canRenderInWebGL=y(l?.indexedColormap);return{success:!0}}_updateStretchRenderer(a){let {stretchType:d,dra:c}=a;if(!("none"===d||a.statistics?.length||
B(this.rasterInfo.statistics)||c))return{success:!1,error:"Unsupported renderer; StretchRenderer.statistics is required when dynamic range adjustment is not used."};var b=a.histograms||this.rasterInfo.histograms;!h(a.stretchType)||b?.length||c||(d="minMax");const {computeGamma:f,useGamma:l,colorRamp:r}=a;let {gamma:q}=a;l&&f&&!q?.length&&(q=n.computeGammaValues(this.rasterInfo.pixelType,a.statistics?.length?a.statistics:this.rasterInfo.statistics));var w=this.rasterInfo.pixelType;const p=!c&&["u8",
"u16","s8","s16"].includes(w);"histogramEqualization"===d?(w=b.map(z=>n.createHistogramEqualizationLUT(z)),this.lookup={rendererJSON:a,histogramLut:w}):p&&(b=n.getStretchCutoff(a,{rasterInfo:this.rasterInfo}),w=n.createStretchLUT({pixelType:w,...b,gamma:l?q:null,rounding:"floor"}),this.lookup={rendererJSON:a,stretchLut:w});r&&!E(r)&&(w=g.convertColorRampToColormap(r,{interpolateAlpha:!0}),this.lookup||(this.lookup={rendererJSON:a}),this.lookup.colormapLut=v.createColormapLUT({colormap:w}),this.lookup.rendererJSON=
a);this.lookup.gamma=l&&q?.length?q:null;this.canRenderInWebGL=!0;return{success:!0}}_generateStretchWebGLParams(a,d,c){let b=null,f=null;var l=this.lookup?.colormapLut;d.colorRamp&&l&&(b=l.indexedColormap,f=l.offset);"histogramEqualization"===d.stretchType&&(d={...d,stretchType:"minMax"});({gamma:l}=this.lookup);const r=!(!d.useGamma||!l?.some(J=>1!==J)),{minCutOff:q,maxCutOff:w,outMin:p,outMax:z}=n.getStretchCutoff(d,{rasterInfo:this.rasterInfo,pixelBlock:a,bandIds:c});var I=0;null!=a&&(I=a.getPlaneCount(),
2===I&&(a=a.clone(),a.statistics=[a.statistics[0]],a.pixels=[a.pixels[0]]));({bandCount:a}=this.rasterInfo);c=Math.min(3,c?.length||I||a,a);a=new Float32Array(c);I=b||r?1:255;let G;for(G=0;G<q.length;G++)a[G]=w[G]===q[G]?0:(z-p)/(w[G]-q[G])/I;const R=new Float32Array(c);if(r&&l)for(G=0;G<c;G++)R[G]=1<l[G]?2<l[G]?6.5+(l[G]-2)**2.5:6.5+100*(2-l[G])**4:1;return{bandCount:c,outMin:p/I,outMax:z/I,minCutOff:q,maxCutOff:w,factor:a,useGamma:r,gamma:r?l:[1,1,1],gammaCorrection:r?R:[1,1,1],colormap:b,colormapOffset:f,
stretchType:d.stretchType,type:"stretch"}}_generateShadedReliefWebGLParams(a,d=!1,c={x:0,y:0}){let b=null,f=null;const l=this.lookup?.colormapLut;a.colorRamp&&l&&(b=l.indexedColormap,f=l.offset);d=e.calculateHillshadeParams({...a,isGCS:d,resolution:c});c=this.rasterInfo.statistics?.[0];return{...d,minValue:c?.min??0,maxValue:c?.max??8E3,hillshadeType:"traditional"===a.hillshadeType?0:1,type:"hillshade",colormap:b,colormapOffset:f}}_generateVectorFieldWebGLParams(a){const {style:d,inputUnit:c,outputUnit:b,
visualVariables:f,symbolTileSize:l,flowRepresentation:r}=a;let q;var w=this.rasterInfo.statistics?.[0].min??0,p=this.rasterInfo.statistics?.[0].max??50,z=f?.find(R=>"sizeInfo"===R.type)??{type:"sizeInfo",field:"Magnitude",maxDataValue:p,maxSize:.8*l,minDataValue:w,minSize:.2*l},I=z.minDataValue??w,G=z.maxDataValue??p;p=null!=z.maxSize&&null!=z.minSize?[z.minSize/l,z.maxSize/l]:[.2,.8];"wind_speed"===d&&(p[0]=p[1]=(p[0]+p[1])/2);w=null!=I&&null!=G?[I,G]:null;if("classified_arrow"===d)if(null!=I&&null!=
G&&null!=z)for(q=[],I=(z.maxDataValue-z.minDataValue)/5,G=0;6>G;G++)q.push(z.minDataValue+I*G);else q=[0,1E-6,3.5,7,10.5,14];z="flow_to"===r===("ocean_current_kn"===d||"ocean_current_m"===d)?0:Math.PI;I=f?.find(R=>"rotationInfo"===R.type);return{breakValues:q,dataRange:w,inputUnit:c,outputUnit:b,symbolTileSize:l,symbolPercentRange:p,style:d||"single_arrow",rotation:z,rotationType:this.rasterInfo.storageInfo?.tileInfo&&"vector-uv"===this.rasterInfo.dataType?"geographic":I?.rotationType||a.rotationType,
type:"vectorField"}}};m.__decorate([F.property({json:{write:!0}})],u.prototype,"rendererJSON",void 0);m.__decorate([F.property({type:H,json:{write:!0}})],u.prototype,"rasterInfo",void 0);m.__decorate([F.property({json:{write:!0}})],u.prototype,"lookup",void 0);m.__decorate([F.property()],u.prototype,"canRenderInWebGL",void 0);return u=m.__decorate([M.subclass("esri.renderers.support.RasterSymbolizer")],u)})},"esri/renderers/support/rasterRendererChecks":function(){define(["exports"],function(m){function x(u){return["u8",
"s8"].includes(u.pixelType)&&null!=u.statistics?.[0]?.min&&null!=u.statistics[0]?.max&&1===u.bandCount}m.isClassBreaksSupported=function(u,K=!1){const {attributeTable:F,bandCount:T}=u;return 1===T&&(!K||null!=F||null!=u.histograms)};m.isColormapRendererSupported=function(u,K=!1){const {bandCount:F,colormap:T,pixelType:N}=u;return 1===F&&(!!T?.length||!K&&"u8"===N)};m.isFlowRendererSupported=function(u){({dataType:u}=u);return"vector-uv"===u||"vector-magdir"===u};m.isShadedReliefRendererSupported=
function(u){const {bandCount:K,dataType:F,pixelType:T}=u;return"elevation"===F||"generic"===F&&1===K&&("s16"===T||"s32"===T||"f32"===T||"f64"===T)};m.isSingleBand8BitRasterWithStats=x;m.isUVRendererSupported=function(u,K){const {attributeTable:F,bandCount:T}=u;return null==F&&x(u)?!0:null==F||1<T||K&&null==F.fields.find(N=>N.name.toLowerCase()===K.toLowerCase())?!1:!0};m.isVectorFieldRendererSupported=function(u){({dataType:u}=u);return"vector-uv"===u||"vector-magdir"===u};Object.defineProperty(m,
Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/flow/dataUtils":function(){define("exports ../../../../geometry ../../../../core/has ../../../../core/Logger ../../../../core/mathUtils ../../../../core/promiseUtils ../../../../core/RandomLCG ../../../../geometry/support/spatialReferenceUtils ../../../../geometry/Extent".split(" "),function(m,x,u,K,F,T,N,M,H){function v(a,d){const c=g(d.data,d.width,d.height,a.smoothing);return a.interpolate?(b,f)=>{const l=Math.floor(b),r=Math.floor(f);
if(0>l||l>=d.width||0>r||r>=d.height)return[0,0];b-=l;f-=r;const q=l<d.width-1?l+1:l,w=r<d.height-1?r+1:r;return[(c[2*(r*d.width+l)]*(1-f)+c[2*(w*d.width+l)]*f)*(1-b)+(c[2*(r*d.width+q)]*(1-f)+c[2*(w*d.width+q)]*f)*b,(c[2*(r*d.width+l)+1]*(1-f)+c[2*(w*d.width+l)+1]*f)*(1-b)+(c[2*(r*d.width+q)+1]*(1-f)+c[2*(w*d.width+q)+1]*f)*b]}:(b,f)=>{b=Math.round(b);f=Math.round(f);return 0>b||b>=d.width||0>f||f>=d.height?[0,0]:[c[2*(f*d.width+b)],c[2*(f*d.width+b)+1]]}}function n(a,d,c,b,f,l,r,q,w){const p=[];
let z=0,[I,G]=d(c,b);I*=a.velocityScale;G*=a.velocityScale;p.push({x:c,y:b,t:z,speed:Math.sqrt(I*I+G*G)});for(let V=0;V<a.verticesPerLine;V++){let [A,C]=d(c,b);A*=a.velocityScale;C*=a.velocityScale;const P=Math.sqrt(A*A+C*C);if(P<a.minSpeedThreshold)break;const X=A/P,O=C/P;c+=X*a.segmentLength;b+=O*a.segmentLength;z+=a.segmentLength/P;if(Math.acos(X*R+O*J)>a.maxTurnAngle)break;if(a.collisions){var R=Math.round(c*w);var J=Math.round(b*w);if(0>R||R>r-1||0>J||J>q-1)break;const Y=l[J*r+R];if(-1!==Y&&
Y!==f)break;l[J*r+R]=f}p.push({x:c,y:b,t:z,speed:P});R=X;J=O}return p}function e(a,d,c,b){const f=[],l=new N,r=1/Math.max(a.lineCollisionWidth,1),q=Math.round(c*r),w=Math.round(b*r),p=new Int32Array(q*w);for(var z=0;z<p.length;z++)p[z]=-1;z=[];for(let I=0;I<b;I+=a.lineSpacing)for(let G=0;G<c;G+=a.lineSpacing)z.push({x:G,y:I,sort:l.getFloat()});z.sort((I,G)=>I.sort-G.sort);for(const {x:I,y:G}of z)l.getFloat()<a.density&&(c=n(a,d,I,G,f.length,p,q,w,r),2>c.length||f.push(c));return f}function g(a,d,
c,b){if(0===b)return a;const f=Math.round(3*b),l=Array(2*f+1);var r=0;for(var q=-f;q<=f;q++){var w=Math.exp(-q*q/(b*b));l[q+f]=w;r+=w}for(b=-f;b<=f;b++)l[b+f]/=r;r=new Float32Array(a.length);for(b=0;b<c;b++)for(q=0;q<d;q++){var p=w=0;for(var z=-f;z<=f;z++)if(!(0>q+z||q+z>=d)){var I=l[z+f];w+=I*a[2*(b*d+(q+z))];p+=I*a[2*(b*d+(q+z))+1]}r[2*(b*d+q)]=w;r[2*(b*d+q)+1]=p}a=new Float32Array(a.length);for(b=0;b<d;b++)for(q=0;q<c;q++){p=w=0;for(z=-f;z<=f;z++)0>q+z||q+z>=c||(I=l[z+f],w+=I*r[2*((q+z)*d+b)],
p+=I*r[2*((q+z)*d+b)+1]);a[2*(q*d+b)]=w;a[2*(q*d+b)+1]=p}return a}function k(a,d){const c=new N;var b=a.reduce((q,w)=>q+w.length,0);b=new Float32Array(4*b);const f=Array(a.length);let l=0,r=0;for(const q of a){a=l;for(const w of q)b[4*l]=w.x,b[4*l+1]=w.y,b[4*l+2]=w.t,b[4*l+3]=w.speed,l++;f[r++]={startVertex:a,numberOfVertices:q.length,totalTime:q[q.length-1].t,timeSeed:d?c.getFloat():0}}return{lineVertices:b,lineDescriptors:f}}function y(a,d){function c(R,J,V,A,C,P,X,O){const Y=9*w;let S=0;q[Y+S++]=
R;q[Y+S++]=J;q[Y+S++]=1;q[Y+S++]=V;q[Y+S++]=P;q[Y+S++]=X;q[Y+S++]=A/2;q[Y+S++]=C/2;q[Y+S++]=O;w++;q[Y+S++]=R;q[Y+S++]=J;q[Y+S++]=-1;q[Y+S++]=V;q[Y+S++]=P;q[Y+S++]=X;q[Y+S++]=-A/2;q[Y+S++]=-C/2;q[Y+S++]=O;w++}const {lineVertices:b,lineDescriptors:f}=a;var l=a=0;for(var r of f)a+=2*r.numberOfVertices,l+=6*(r.numberOfVertices-1);const q=new Float32Array(9*a);r=new Uint32Array(l);let w=0;a=0;for(const R of f){const {totalTime:J,timeSeed:V}=R;let A=l=null,C=null;var p=null,z=null,I=null;for(let P=0;P<
R.numberOfVertices;P++){p=b[4*(R.startVertex+P)];const X=b[4*(R.startVertex+P)+1],O=b[4*(R.startVertex+P)+2],Y=b[4*(R.startVertex+P)+3];let S=null,aa=null;var G=null;let t=null;0<P&&(S=p-l,aa=X-A,G=Math.sqrt(S*S+aa*aa),S/=G,aa/=G,1<P?(z=S+z,I=aa+I,G=Math.sqrt(z*z+I*I),z/=G,I/=G,G=Math.min(1/(z*S+I*aa),d),z*=G,I*=G,G=-I,t=z):(G=-aa,t=S),null!==G&&null!==t&&(c(l,A,C,G,t,J,V,Y),r[a++]=w-2,r[a++]=w,r[a++]=w-1,r[a++]=w,r[a++]=w+1,r[a++]=w-1));l=p;A=X;C=O;z=S;I=aa;p=Y}c(l,A,C,-I,z,J,V,p)}return{vertexData:q,
indexData:r}}function h(a){function d(U,Q){var ca=O+S,W=Y+aa,da=Math.sqrt(ca*ca+W*W);ca/=da;W/=da;var fa=O*ca+Y*W,ha=S+t,la=aa+L;da=Math.sqrt(ha*ha+la*la);ha/=da;la/=da;var ka=S*ha+aa*la;da=G;var pa=R,na=J,oa=V;W=-(W/fa);ca/=fa;fa=A;var sa=C,ta=P,ua=X;la=-(la/ka);ha/=ka;ka=16*z;let qa=0;for(const xa of[1,2])for(const va of[1,2,3,4])w[ka+qa++]=da,w[ka+qa++]=pa,w[ka+qa++]=na,w[ka+qa++]=oa,w[ka+qa++]=fa,w[ka+qa++]=sa,w[ka+qa++]=ta,w[ka+qa++]=ua,w[ka+qa++]=xa,w[ka+qa++]=va,w[ka+qa++]=U,w[ka+qa++]=Q,w[ka+
qa++]=W/2,w[ka+qa++]=ca/2,w[ka+qa++]=la/2,w[ka+qa++]=ha/2,z++;p[I++]=z-8;p[I++]=z-7;p[I++]=z-6;p[I++]=z-7;p[I++]=z-5;p[I++]=z-6;p[I++]=z-4;p[I++]=z-3;p[I++]=z-2;p[I++]=z-3;p[I++]=z-1;p[I++]=z-2}function c(U,Q,ca,W,da,fa){O=S;Y=aa;S=t;aa=L;null==O&&null==Y&&(O=S,Y=aa);if(null!=A&&null!=C){t=U-A;L=Q-C;const ha=Math.sqrt(t*t+L*L);t/=ha;L/=ha}null!=O&&null!=Y&&d(da,fa);G=A;R=C;J=P;V=X;A=U;C=Q;P=ca;X=W}function b(U,Q){O=S;Y=aa;S=t;aa=L;null==O&&null==Y&&(O=S,Y=aa);null!=O&&null!=Y&&d(U,Q)}const {lineVertices:f,
lineDescriptors:l}=a;let r=a=0;for(var q of l){const U=q.numberOfVertices-1;a+=8*U;r+=12*U}const w=new Float32Array(16*a),p=new Uint32Array(r);let z=0,I=0,G,R,J,V,A,C,P,X,O,Y,S,aa,t,L;for(const U of l){L=t=aa=S=Y=O=X=P=C=A=V=J=R=G=null;const {totalTime:Q,timeSeed:ca}=U;for(q=0;q<U.numberOfVertices;q++)c(f[4*(U.startVertex+q)],f[4*(U.startVertex+q)+1],f[4*(U.startVertex+q)+2],f[4*(U.startVertex+q)+3],Q,ca);b(Q,ca)}return{vertexData:w,indexData:p}}function B(a,d){const c=d.pixels,{width:b,height:f}=
d,l=new Float32Array(b*f*2),r=d.mask||new Uint8Array(b*f*2);d.mask||r.fill(255);if("vector-uv"===a)for(a=0;a<b*f;a++)l[2*a]=c[0][a],l[2*a+1]=-c[1][a];else if("vector-magdir"===a)for(a=0;a<b*f;a++){d=c[0][a];const q=F.deg2rad(c[1][a]),w=Math.sin(q-Math.PI/2);l[2*a]=Math.cos(q-Math.PI/2)*d;l[2*a+1]=w*d}return{data:l,mask:r,width:b,height:f}}async function D(a,d,c,b,f,l){const r={requestProjectedLocalDirections:!0,signal:l};null!=f&&(r.timeExtent=f);if("imagery"===a.type)return await a.load({signal:l}),
f=a.rasterInfo.dataType,a=await a.fetchImage(d,c,b,r),null==a?.pixelData?.pixelBlock?{data:new Float32Array(c*b*2),mask:new Uint8Array(c*b),width:c,height:b}:B(f,a.pixelData.pixelBlock);await a.load({signal:l});f=a.serviceRasterInfo.dataType;a=await a.fetchPixels(d,c,b,r);return null==a?.pixelBlock?{data:new Float32Array(c*b*2),mask:new Uint8Array(c*b),width:c,height:b}:B(f,a.pixelBlock)}const E=()=>K.getLogger("esri.views.2d.engine.flow.dataUtils");m.createAnimatedLinesData=k;m.createFlowMesh=async function(a,
d,c,b){const f=performance.now();var l=v(d,c);const r=performance.now();c=e(d,l,c.width,c.height);d=performance.now();l=k(c,!0);c=performance.now();a="Streamlines"===a?y(l,10):h(l);l=performance.now();u("esri-2d-profiler")&&(E().info("I.1","_createFlowFieldFromData (ms)",Math.round(r-f)),E().info("I.2","_getStreamlines (ms)",Math.round(d-r)),E().info("I.3","createAnimatedLinesData (ms)",Math.round(c-d)),E().info("I.4","create{Streamlines|Particles}Mesh (ms)",Math.round(l-c)),E().info("I.5","createFlowMesh (ms)",
Math.round(l-f)),E().info("I.6","Mesh size (bytes)",a.vertexData.buffer.byteLength+a.indexData.buffer.byteLength));await Promise.resolve();T.throwIfAborted(b);return a};m.createParticlesMesh=h;m.createStreamlinesMesh=y;m.loadImagery=async function(a,d,c,b,f,l){const r=performance.now();var q=M.getInfo(d.spatialReference);if(!q)return c=await D(a,d,c,b,f,l),u("esri-2d-profiler")&&E().info("I.7","loadImagery, early exit (ms)",Math.round(performance.now()-r)),u("esri-2d-profiler")&&E().info("I.9","Number of parts",
1),c;const [w,p]=q.valid,z=Math.ceil(d.width/(p-w)),I=d.width/z,G=Math.round(c/z);let R=d.xmin;const J=[];q=performance.now();for(let V=0;V<z;V++){const A=new H({xmin:R,xmax:R+I,ymin:d.ymin,ymax:d.ymax,spatialReference:d.spatialReference});J.push(D(a,A,G,b,f,l));R+=I}a=await Promise.all(J);u("esri-2d-profiler")&&E().info("I.8","All calls to _fetchPart (ms)",Math.round(performance.now()-q));u("esri-2d-profiler")&&E().info("I.9","Number of parts",a.length);b={data:new Float32Array(c*b*2),mask:new Uint8Array(c*
b),width:c,height:b};d=0;for(const V of a){for(a=0;a<V.height;a++)for(f=0;f<V.width;f++)d+f>=c||(b.data[2*(a*c+d+f)]=V.data[2*(a*V.width+f)],b.data[2*(a*c+d+f)+1]=V.data[2*(a*V.width+f)+1],b.mask[a*c+d+f]=V.mask[a*V.width+f]);d+=V.width}u("esri-2d-profiler")&&E().info("I.10","loadImagery, general exit (ms)",Math.round(performance.now()-r));return b};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("../../geometry ../../geometry/support/GeographicTransformation ./PixelBlock ./rasterFormats/RasterCodec ./rasterFunctions/pixelUtils ./rasterFunctions/rasterFunctionHelper ./rasterFunctions/rasterProjectionHelper ./rasterFunctions/stretchUtils ./rasterFunctions/vectorFieldUtils ./rasterTransforms/utils ../../renderers/support/RasterSymbolizer ../../views/2d/engine/flow/dataUtils ../../geometry/Extent ../../geometry/Point".split(" "),function(m,x,u,K,F,T,N,M,H,v,n,e,g,k){class y{convertVectorFieldData(h){const B=
u.fromJSON(h.pixelBlock);h=H.convertVectorFieldData(B,h.type);return Promise.resolve(null!=h?h.toJSON():null)}computeStatisticsHistograms(h){h=u.fromJSON(h.pixelBlock);h=M.computeStatisticsHistograms(h);return Promise.resolve(h)}async decode(h){return(h=await K.decode(h.data,h.options))&&h.toJSON()}symbolize(h){h.pixelBlock=u.fromJSON(h.pixelBlock);h.extent=h.extent?g.fromJSON(h.extent):null;h=this.symbolizer.symbolize(h);return Promise.resolve(null!=h?h.toJSON():null)}async updateSymbolizer(h){this.symbolizer=
n.fromJSON(h.symbolizerJSON);h.histograms&&"rasterStretch"===this.symbolizer?.rendererJSON.type&&(this.symbolizer.rendererJSON.histograms=h.histograms)}async updateRasterFunction(h){this.rasterFunction=T.create(h.rasterFunctionJSON)}async process(h){h=this.rasterFunction.process({extent:g.fromJSON(h.extent),primaryPixelBlocks:h.primaryPixelBlocks.map(B=>null!=B?u.fromJSON(B):null),primaryPixelSizes:h.primaryPixelSizes?.map(B=>null!=B?k.fromJSON(B):null),primaryRasterIds:h.primaryRasterIds});return null!=
h?h.toJSON():null}stretch(h){h=this.symbolizer.simpleStretch(u.fromJSON(h.srcPixelBlock),h.stretchParams);return Promise.resolve(h?.toJSON())}estimateStatisticsHistograms(h){h=M.estimateStatisticsHistograms(u.fromJSON(h.srcPixelBlock));return Promise.resolve(h)}split(h){const B=F.split(u.fromJSON(h.srcPixelBlock),h.tileSize,h.maximumPyramidLevel??0,!1===h.useBilinear);B&&B.forEach((D,E)=>{B.set(E,D?.toJSON())});return Promise.resolve(B)}clipTile(h){const B=u.fromJSON(h.pixelBlock);h=F.clipTile({...h,
pixelBlock:B});return Promise.resolve(h?.toJSON())}async mosaicAndTransform(h){var B=h.srcPixelBlocks.map(a=>a?new u(a):null);let D=B=F.mosaic(B,h.srcMosaicSize,{blockWidths:h.blockWidths,alignmentInfo:h.alignmentInfo,clipOffset:h.clipOffset,clipSize:h.clipSize});h.coefs&&(D=F.approximateTransform(B,h.destDimension,h.coefs,h.sampleSpacing,h.interpolation));let E;h.projectDirections&&h.gcsGrid&&(E=F.getLocalArithmeticNorthRotations(h.destDimension,h.gcsGrid),D=H.convertToLocalDirections(D,h.isUV?"vector-uv":
"vector-magdir",E));return{pixelBlock:D?.toJSON(),localNorthDirections:E}}async createFlowMesh(h,B){const D={data:new Float32Array(h.flowData.buffer),mask:new Uint8Array(h.flowData.maskBuffer),width:h.flowData.width,height:h.flowData.height},{vertexData:E,indexData:a}=await e.createFlowMesh(h.meshType,h.simulationSettings,D,B.signal);return{result:{vertexBuffer:E.buffer,indexBuffer:a.buffer},transferList:[E.buffer,a.buffer]}}async getProjectionOffsetGrid(h){const B=g.fromJSON(h.projectedExtent),D=
g.fromJSON(h.srcBufferExtent);let E=null;h.datumTransformationSteps&&(E=new x({steps:h.datumTransformationSteps}));(h.includeGCSGrid||N.requirePE(B.spatialReference,D.spatialReference,E))&&await N.load();const a=h.rasterTransform?v.readTransform(h.rasterTransform):null;return N.getProjectionOffsetGrid({...h,projectedExtent:B,srcBufferExtent:D,datumTransformation:E,rasterTransform:a})}}return y});
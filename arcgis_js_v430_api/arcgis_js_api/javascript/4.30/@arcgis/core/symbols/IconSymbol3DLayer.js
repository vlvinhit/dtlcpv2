/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.30/esri/copyright.txt for details.
*/
import{_ as r}from"../chunks/tslib.es6.js";import{clone as o}from"../core/lang.js";import{L as t}from"../chunks/Logger.js";import{isDataProtocol as e,isAbsolute as s,normalize as i,makeData as n}from"../core/urlUtils.js";import{property as c}from"../core/accessorSupport/decorators/property.js";import{e as l}from"../chunks/enumeration.js";import{subclass as a}from"../core/accessorSupport/decorators/subclass.js";import p from"./Symbol3DLayer.js";import{w as m,i as h}from"../chunks/colors.js";import{s as u}from"../chunks/jsonMap.js";import{JSONSupport as y}from"../core/JSONSupport.js";import{r as f}from"../chunks/reader.js";import{w as d}from"../chunks/writer.js";import{f as j,a as b}from"../chunks/persistableUrlUtils.js";import{c as v,s as k}from"../chunks/materialUtils.js";import g from"../core/Accessor.js";import w from"../Color.js";import{p as S}from"../chunks/screenUtils.js";import{S as x}from"../chunks/Symbol3DMaterial.js";import"../config.js";import"../core/Error.js";import"../core/Handles.js";import"../chunks/maybe.js";import"../chunks/metadata.js";import"../chunks/utils.js";import"../chunks/handleUtils.js";import"../chunks/tracking.js";import"../chunks/ensureType.js";import"../chunks/ObservableBase.js";import"../core/scheduling.js";import"../core/promiseUtils.js";import"../kernel.js";import"../chunks/opacityUtils.js";import"../chunks/colorUtils.js";import"../chunks/mathUtils.js";import"../chunks/vec3.js";import"../chunks/vec3f64.js";import"../chunks/common.js";var z;const U=u()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"});let I=z=class extends y{constructor(r){super(r)}readHref(r,o,t){return r?j(r,t):o.dataURI}writeHref(r,o,t,n){r&&(e(r)?o.dataURI=r:(o.href=b(r,n),s(o.href)&&(o.href=i(o.href))))}clone(){return new z({href:this.href,primitive:this.primitive})}};r([c({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],I.prototype,"href",void 0),r([f("href")],I.prototype,"readHref",null),r([d("href",{href:{type:String},dataURI:{type:String}})],I.prototype,"writeHref",null),r([l(U)],I.prototype,"primitive",void 0),I=z=r([a("esri.symbols.support.IconSymbol3DLayerResource")],I);const P="circle";var L;let D=L=class extends g{constructor(){super(...arguments),this.x=0,this.y=0}clone(){return new L({x:this.x,y:this.y})}};var R;r([c({type:Number})],D.prototype,"x",void 0),r([c({type:Number})],D.prototype,"y",void 0),D=L=r([a("esri.symbols.support.Symbol3DAnchorPosition2D")],D);let H=R=class extends y{constructor(r){super(r),this.color=new w([0,0,0,1]),this.size=S(1)}clone(){const r={color:null!=this.color?this.color.clone():null,size:this.size};return new R(r)}};var M;r([c(v)],H.prototype,"color",void 0),r([c(k)],H.prototype,"size",void 0),H=R=r([a("esri.symbols.support.Symbol3DIconOutline")],H);const N="esri.symbols.IconSymbol3DLayer";let O=M=class extends p{constructor(r){super(r),this.material=null,this.resource=null,this.type="icon",this.size=12,this.anchor="center",this.anchorPosition=null,this.outline=null}clone(){return new M({anchor:this.anchor,anchorPosition:o(this.anchorPosition),enabled:this.enabled,material:o(this.material),outline:o(this.outline),resource:o(this.resource),size:this.size})}static fromSimpleMarkerSymbol(r){const o=r.color||m,e=A(r),s=r.outline&&r.outline.width>0?{size:r.outline.width,color:(r.outline.color||m).clone()}:null;return new M({size:r.size,resource:{primitive:(i=r.style,F[i]||(t.getLogger(N).warn(`${i} cannot be mapped to Icon symbol. Fallback to "circle"`),"circle"))},material:{color:o},outline:s,anchor:e?"relative":void 0,anchorPosition:e});var i}static fromPictureMarkerSymbol(r){const o=!r.color||h(r.color)?m:r.color,t=A(r);return new M({size:r.width<=r.height?r.height:r.width,resource:{href:r.url},material:{color:o.clone()},anchor:t?"relative":void 0,anchorPosition:t})}static fromCIMSymbol(r){return new M({resource:{href:n({mediaType:"application/json",data:JSON.stringify(r.data)})}})}};r([c({type:x,json:{write:!0}})],O.prototype,"material",void 0),r([c({type:I,json:{write:!0}})],O.prototype,"resource",void 0),r([l({Icon:"icon"},{readOnly:!0})],O.prototype,"type",void 0),r([c(k)],O.prototype,"size",void 0),r([l({center:"center",left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"}),c({json:{default:"center"}})],O.prototype,"anchor",void 0),r([c({type:D,json:{type:[Number],read:{reader:r=>new D({x:r[0],y:r[1]})},write:{writer:(r,o)=>{o.anchorPosition=[r.x,r.y]},overridePolicy(){return{enabled:"relative"===this.anchor}}}}})],O.prototype,"anchorPosition",void 0),r([c({type:H,json:{write:!0}})],O.prototype,"outline",void 0),O=M=r([a(N)],O);const q=O;function A(r){const o="width"in r?r.width:r.size,t="height"in r?r.height:r.size,e=C(r.xoffset),s=C(r.yoffset);return(e||s)&&o&&t?{x:-e/o,y:s/t}:null}function C(r){return isFinite(r)?r:0}const F={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};export{D as S,P as d,q as default};

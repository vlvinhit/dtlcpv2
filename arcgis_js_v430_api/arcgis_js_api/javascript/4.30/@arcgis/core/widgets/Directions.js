/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.30/esri/copyright.txt for details.
*/
import{_ as e}from"../chunks/tslib.es6.js";import"../intl.js";import{isAbortError as t,o,p as n}from"../core/promiseUtils.js";import{m as r}from"../chunks/handleUtils.js";import{b as i}from"../chunks/maybe.js";import{watch as s,initial as a,when as l,on as c}from"../core/reactiveUtils.js";import{e as u}from"../chunks/Logger.js";import{property as d}from"../core/accessorSupport/decorators/property.js";import{cast as p}from"../core/accessorSupport/decorators/cast.js";import"../core/lang.js";import{subclass as h}from"../core/accessorSupport/decorators/subclass.js";import{d as m}from"../chunks/defaultUnit.js";import v from"../rest/support/Stop.js";import g from"../symbols/SimpleMarkerSymbol.js";import f from"./Search.js";import _,{l as b}from"./Widget.js";import y,{D as S,f as w,a as j,g as k}from"./Directions/DirectionsViewModel.js";import C from"../portal/Portal.js";import"../chunks/widgetUtils.js";import{m as D}from"../chunks/messageBundle.js";import{t as M}from"../chunks/jsxFactory.js";import{i as T,m as E}from"./Search/LocatorSearchSource.js";import{g as I}from"../chunks/globalCss.js";import{H as P,i as x}from"../chunks/Heading.js";import{l as L}from"../chunks/legacyIcon.js";import{a as R}from"../chunks/accessibleHandler.js";import{f as $}from"../chunks/number.js";import"../chunks/date.js";import"../chunks/jsonMap.js";import"../config.js";import"../chunks/locale.js";import"../chunks/timeZoneUtils.js";import"../chunks/datetime.js";import"../chunks/substitute.js";import"../chunks/messages.js";import"../core/Error.js";import"../request.js";import"../kernel.js";import"../core/urlUtils.js";import"../core/JSONSupport.js";import"../core/Accessor.js";import"../core/Handles.js";import"../chunks/metadata.js";import"../chunks/utils.js";import"../chunks/ObservableBase.js";import"../chunks/tracking.js";import"../core/scheduling.js";import"../chunks/ensureType.js";import"../chunks/assets.js";import"../chunks/asyncUtils.js";import"../core/Collection.js";import"../core/Evented.js";import"../chunks/shared.js";import"../chunks/SimpleObservable.js";import"../chunks/getDefaultUnitForView.js";import"../chunks/unitUtils.js";import"../Graphic.js";import"../geometry.js";import"../geometry/Extent.js";import"../geometry/Geometry.js";import"../chunks/reader.js";import"../geometry/SpatialReference.js";import"../chunks/writer.js";import"../geometry/Point.js";import"../geometry/support/webMercatorUtils.js";import"../geometry/Multipoint.js";import"../chunks/zmUtils.js";import"../geometry/Polygon.js";import"../chunks/coordsUtils.js";import"../chunks/Axis.js";import"../chunks/extentUtils.js";import"../chunks/aaBoundingRect.js";import"../chunks/mathUtils.js";import"../chunks/vec3.js";import"../chunks/vec3f64.js";import"../chunks/common.js";import"../geometry/Polyline.js";import"../chunks/typeUtils.js";import"../geometry/support/jsonUtils.js";import"../PopupTemplate.js";import"../core/Clonable.js";import"../layers/support/fieldUtils.js";import"../core/sql.js";import"../popup/content.js";import"../popup/content/AttachmentsContent.js";import"../popup/content/Content.js";import"../popup/content/CustomContent.js";import"../popup/content/ExpressionContent.js";import"../popup/ElementExpressionInfo.js";import"../popup/content/FieldsContent.js";import"../popup/FieldInfo.js";import"../chunks/enumeration.js";import"../popup/support/FieldInfoFormat.js";import"../popup/content/MediaContent.js";import"../popup/content/BarChartMediaInfo.js";import"../popup/content/mixins/ChartMediaInfo.js";import"../popup/content/mixins/MediaInfo.js";import"../popup/content/support/ChartMediaInfoValue.js";import"../Color.js";import"../chunks/colorUtils.js";import"../popup/content/support/ChartMediaInfoValueSeries.js";import"../chunks/chartMediaInfoUtils.js";import"../popup/content/ColumnChartMediaInfo.js";import"../popup/content/ImageMediaInfo.js";import"../popup/content/support/ImageMediaInfoValue.js";import"../popup/content/LineChartMediaInfo.js";import"../popup/content/PieChartMediaInfo.js";import"../popup/content/RelationshipContent.js";import"../popup/support/RelatedRecordsInfoFieldOrder.js";import"../popup/content/TextContent.js";import"../popup/ExpressionInfo.js";import"../popup/LayerOptions.js";import"../popup/RelatedRecordsInfo.js";import"../support/actions/ActionBase.js";import"../core/Identifiable.js";import"../support/actions/ActionButton.js";import"../support/actions/ActionToggle.js";import"../symbols.js";import"../symbols/CIMSymbol.js";import"../symbols/Symbol.js";import"../symbols/ExtrudeSymbol3DLayer.js";import"../symbols/Symbol3DLayer.js";import"../chunks/utils4.js";import"../symbols/edges/Edges3D.js";import"../chunks/screenUtils.js";import"../chunks/materialUtils.js";import"../chunks/opacityUtils.js";import"../symbols/edges/SketchEdges3D.js";import"../symbols/edges/SolidEdges3D.js";import"../chunks/Symbol3DMaterial.js";import"../symbols/FillSymbol.js";import"../symbols/SimpleLineSymbol.js";import"../symbols/LineSymbol.js";import"../symbols/LineSymbolMarker.js";import"../chunks/lineMarkers.js";import"../symbols/FillSymbol3DLayer.js";import"../symbols/patterns/LineStylePattern3D.js";import"../symbols/patterns/StylePattern3D.js";import"../chunks/utils5.js";import"../chunks/colors.js";import"../chunks/symbolLayerUtils3D.js";import"../chunks/aaBoundingBox.js";import"../symbols/Font.js";import"../symbols/IconSymbol3DLayer.js";import"../chunks/persistableUrlUtils.js";import"../symbols/LabelSymbol3D.js";import"../symbols/Symbol3D.js";import"../chunks/collectionUtils.js";import"../symbols/LineSymbol3DLayer.js";import"../symbols/LineStyleMarker3D.js";import"../symbols/ObjectSymbol3DLayer.js";import"../symbols/PathSymbol3DLayer.js";import"../symbols/TextSymbol3DLayer.js";import"../symbols/WaterSymbol3DLayer.js";import"../symbols/support/StyleOrigin.js";import"../core/Loadable.js";import"../core/Promise.js";import"../portal/PortalGroup.js";import"../portal/PortalQueryParams.js";import"../portal/PortalQueryResult.js";import"../portal/PortalUser.js";import"../portal/PortalFolder.js";import"../chunks/Thumbnail.js";import"../chunks/calloutUtils.js";import"../symbols/callouts/Callout3D.js";import"../symbols/callouts/LineCallout3D.js";import"../symbols/support/Symbol3DVerticalOffset.js";import"../symbols/LineSymbol3D.js";import"../symbols/MarkerSymbol.js";import"../symbols/MeshSymbol3D.js";import"../symbols/PictureFillSymbol.js";import"../chunks/urlUtils.js";import"../symbols/PictureMarkerSymbol.js";import"../symbols/PointSymbol3D.js";import"../symbols/PolygonSymbol3D.js";import"../symbols/SimpleFillSymbol.js";import"../symbols/TextSymbol.js";import"../symbols/WebStyleSymbol.js";import"../chunks/utils13.js";import"../chunks/networkEnums.js";import"./Search/SearchResultRenderer.js";import"./Search/SearchViewModel.js";import"../chunks/geometryUtils2.js";import"../chunks/scaleUtils.js";import"../chunks/layerViewUtils.js";import"./Search/LayerSearchSource.js";import"./Search/SearchSource.js";import"../chunks/FullTextSearch.js";import"../chunks/geolocationUtils.js";import"../chunks/project.js";import"../chunks/utils8.js";import"../chunks/utils9.js";import"../rest/support/ProjectParameters.js";import"./support/GoTo.js";import"../chunks/suggestLocations.js";import"../rest/support/AddressCandidate.js";import"../chunks/commonProperties3.js";import"../chunks/domUtils.js";import"../chunks/uuid.js";import"../chunks/projector.js";import"../chunks/jsxWidgetSupport.js";import"../chunks/vmEvent.js";import"../rest/networkService.js";import"../rest/support/TravelMode.js";import"../rest/support/RouteParameters.js";import"../rest/support/DataLayer.js";import"../rest/support/FeatureSet.js";import"../layers/support/Field.js";import"../chunks/domains.js";import"../layers/support/CodedValueDomain.js";import"../layers/support/Domain.js";import"../layers/support/InheritedDomain.js";import"../layers/support/RangeDomain.js";import"../chunks/fieldType.js";import"../rest/support/NetworkFeatureSet.js";import"../rest/support/NetworkUrl.js";import"../chunks/quantityUtils.js";import"../chunks/unitFormatUtils.js";import"../chunks/ByteSizeUnit.js";import"../chunks/Cyclical.js";const A="esri-directions",O={base:A,addStopButton:`${A}__add-stop-button`,arrivalTime:`${A}__arrival-time`,arrivalTimeContainer:`${A}__arrival-time-container`,clearRouteButton:`${A}__clear-route-button`,collapsibleSection:`${A}__maneuver-section--collapsible`,contentTitle:`${A}__content-title`,costsDetails:`${A}__costs-details`,departureDateTimePickers:`${A}__departure-date-time-pickers`,departureTime:`${A}__departure-time`,departureTimeControls:`${A}__departure-time-controls`,departureTimeSelect:`${A}__departure-time-select`,directionCosts:`${A}__costs`,directionsSection:`${A}__directions-section`,horizontalSplitter:`${A}__horizontal-splitter`,interactiveStopIcon:`${A}__stop-icon--interactive`,intermediateCost:`${A}__cost--intermediate`,lastStopIconContainer:`${A}__stop-icon-container--last`,layerDetailsLink:`${A}__layer-details-link`,loader:`${A}__loader`,maneuver:`${A}__maneuver`,maneuverActive:`${A}__maneuver--active`,maneuverCosts:`${A}__maneuver-costs`,maneuverCostsContainer:`${A}__maneuver-costs-container`,maneuverIcon:`${A}__maneuver-icon`,maneuverList:`${A}__maneuver-list`,maneuverPlaceName:`${A}__maneuver-place-name`,maneuverSection:`${A}__maneuver-section`,maneuverSectionHeader:`${A}__maneuver-section-header`,maneuverSectionHeaderButton:`${A}__maneuver-section-header-toggle-button`,maneuverSectionTitle:`${A}__maneuver-section-title`,maneuverSectionToggle:`${A}__maneuver-section-toggle`,maneuvers:`${A}__maneuvers`,message:`${A}__message`,messageHeading:`${A}__message_heading`,panelContent:`${A}__panel-content`,panelContentError:`${A}__panel-content--error`,panelContentLoading:`${A}__panel-content--loading`,panelContentSignIn:`${A}__panel-content--sign-in`,primaryCosts:`${A}__costs-value`,printButton:`${A}__print-button`,removeStop:`${A}__remove-stop-icon`,removeStopButton:`${A}__remove-stop`,reverseStops:`${A}__reverse-stops`,routeActions:`${A}__route-actions`,saveAsButton:`${A}__save-as-button`,saveAsButtonPopover:`${A}__save-as-button-with-popover`,saveButton:`${A}__save-button`,saveButtons:`${A}__save-buttons`,savePopover:`${A}__save-popover`,saveSection:`${A}__save-section`,scroller:`${A}__scroller`,secondaryCosts:`${A}__other-costs-total`,section:`${A}__section`,sectionSplitter:`${A}__section-splitter`,signInButton:`${A}__sign-in-button`,signInContent:`${A}__sign-in-content`,stopHandle:`${A}__stop-handle`,stopHandleIcon:`${A}__stop-handle-icon`,stopIcon:`${A}__stop-icon`,stopIconContainer:`${A}__stop-icon-container`,stopInput:`${A}__stop-input`,stopOptions:`${A}__stop-options`,stopRow:`${A}__stop-row`,stopRowGhost:`${A}__stop-row-ghost`,stops:`${A}__stops`,summary:`${A}__summary`,toolbarButtons:`${A}__toolbar-buttons`,toolbarSection:`${A}__toolbar-section`,travelMode:`${A}__travel-modes`,travelModeSelect:`${A}__travel-modes-select`,validStopRow:`${A}__stop-row--valid`,verticalSplitter:`${A}__vertical-splitter`,warningCard:`${A}__warning-card`,warningHeader:`${A}__warning-header`,warningHeading:`${A}__warning-heading`,warningMessage:`${A}__warning-message`},B="esri-save-layer",N={panel:`${B}`,error:`${B}__error`,errorIcon:`${B}__error-icon`,errorLabel:`${B}__error-label`,layerNameLabel:`${B}__layer-name-label`,portalFolderLabel:`${B}__portal-folder-label`,processLabel:`${B}__process-label`,processLoader:`${B}__process-loader`};let H=class extends _{constructor(e,t){super(e,t),this._folders=null,this._layer=null,this._layerNameInput=null,this._portalFolderCombobox=null,this._userName=null,this.messages=null,this.messagesCommon=null,this.messagesIdentity=null,this.opened=!1,this.state="initialized",this.close=()=>{this.opened=!1,this.state="initialized"}}loadDependencies(){return b({button:()=>import("../chunks/calcite-button.js"),combobox:()=>import("../chunks/calcite-combobox.js"),"combobox-item":()=>import("../chunks/calcite-combobox-item.js"),icon:()=>import("../chunks/calcite-icon.js"),input:()=>import("../chunks/calcite-input.js"),label:()=>import("../chunks/calcite-label.js"),loader:()=>import("../chunks/calcite-loader.js"),panel:()=>import("../chunks/calcite-panel.js")})}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}async open(e){this.state="initialized",this.opened=!0,this._layer=e,this.state="connect-to-portal";const o=C.getDefault();try{await o.signIn()}catch(e){return void(t(e)||"identity-manager:user-aborted"===e.name?this.close():this.state="connect-to-portal-error")}this.state="fetch-portal-information";const{user:n}=o;this._userName=n?.username;try{this._folders=await(n?.fetchFolders())}catch{return void(this.state="fetch-portal-information-error")}this.state="save-layer"}render(){switch(this.state){case"initialized":return this._renderInitialized();case"connect-to-portal":return this._renderProcess(this.messagesIdentity.lblSigning);case"connect-to-portal-error":return this._renderError(this.messages.errors.authenticating);case"fetch-portal-information":return this._renderProcess(this.messages.processing.fetching);case"fetch-portal-information-error":return this._renderError(this.messages.errors.fetching);case"save-layer":return this._renderSaveLayer();case"saving":return this._renderProcess(this.messages.processing.saving);case"saving-error":return this._renderError(this.messages.errors.saving)}}_renderError(e){return M("calcite-panel",{class:N.panel,heading:this.messages.widgetLabel,key:`${B}-error-panel`},M("div",{class:N.error},M("calcite-icon",{class:N.errorIcon,icon:"exclamation-mark-triangle",scale:"l",textLabel:this.messagesCommon.errorMessage}),M("calcite-label",{class:N.errorLabel},e)),M("calcite-button",{appearance:"outline",onclick:this.close,slot:"footer-actions",width:"half"},this.messagesCommon.close))}_renderInitialized(){return M("calcite-panel",{class:N.panel,heading:this.messages.widgetLabel,key:`${B}-initialize-panel`})}_renderProcess(e){return M("calcite-panel",{class:N.panel,heading:this.messages.widgetLabel,key:`${B}-process-panel`},M("calcite-loader",{class:N.processLoader,label:e}),M("calcite-label",{alignment:"center",class:N.processLabel},e))}_renderSaveLayer(){if(null==this._layer||null==this._folders||null==this._userName)return this._renderInitialized();const{stops:e}=this._layer,t=`${e.at(0).name} - ${e.at(-1).name}`,o=this._folders.map((e=>M("calcite-combobox-item",{key:`${B}-folder-${e.id}`,textLabel:e.title??"",value:e.id})));return o.unshift(M("calcite-combobox-item",{key:`${B}-folder-home`,selected:!0,textLabel:`${this._userName} (${this.messagesCommon.home})`,value:null})),M("calcite-panel",{class:N.panel,heading:this.messages.widgetLabel,key:`${B}-save-panel`},M("calcite-label",{class:N.layerNameLabel},this.messages.laverName,M("calcite-input",{afterCreate:e=>{this._layerNameInput=e},label:this.messages.laverName,value:t})),M("calcite-label",{class:N.portalFolderLabel},this.messages.saveInFolder,M("calcite-combobox",{afterCreate:e=>{this._portalFolderCombobox=e},label:this.messages.saveInFolder,overlayPositioning:"fixed",selectionMode:"single"},o)),M("calcite-button",{onclick:()=>this._saveButtonClick(),slot:"footer-actions",width:"half"},this.messagesCommon.save),M("calcite-button",{appearance:"outline",onclick:()=>{this.close()},slot:"footer-actions",width:"half"},this.messagesCommon.cancel))}_saveButtonClick(){this.state="saving",this._saveLayer().then((()=>{this.close()})).catch((()=>{this.state="saving-error"}))}async _saveLayer(){if(null==this._layer||null==this._folders)return;const e=this._layerNameInput?.value,t=this._portalFolderCombobox?.value,o=this._folders.find((e=>e.id===t));await this._layer.saveAs({title:e},{folder:o})}};function U(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function F(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?U(Object(o),!0).forEach((function(t){Y(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):U(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function z(e){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},z(e)}function Y(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function X(){return X=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},X.apply(this,arguments)}function W(e){if("undefined"!=typeof window&&window.navigator)return!!navigator.userAgent.match(e)}e([d()],H.prototype,"label",null),e([d(),D("esri/widgets/support/t9n/SaveLayer")],H.prototype,"messages",void 0),e([d(),D("esri/t9n/common")],H.prototype,"messagesCommon",void 0),e([d(),D("esri/identity/t9n/identity")],H.prototype,"messagesIdentity",void 0),e([d()],H.prototype,"opened",void 0),e([d()],H.prototype,"state",void 0),H=e([h("esri.widgets.Directions.components.SaveLayer")],H);var V=W(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),q=W(/Edge/i),G=W(/firefox/i),K=W(/safari/i)&&!W(/chrome/i)&&!W(/android/i),Q=W(/iP(ad|od|hone)/i),Z=W(/chrome/i)&&W(/android/i),J={capture:!1,passive:!1};function ee(e,t,o){e.addEventListener(t,o,!V&&J)}function te(e,t,o){e.removeEventListener(t,o,!V&&J)}function oe(e,t){if(t){if(">"===t[0]&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(e){return!1}return!1}}function ne(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function re(e,t,o,n){if(e){o=o||document;do{if(null!=t&&(">"===t[0]?e.parentNode===o&&oe(e,t):oe(e,t))||n&&e===o)return e;if(e===o)break}while(e=ne(e))}return null}var ie,se=/\s+/g;function ae(e,t,o){if(e&&t)if(e.classList)e.classList[o?"add":"remove"](t);else{var n=(" "+e.className+" ").replace(se," ").replace(" "+t+" "," ");e.className=(n+(o?" "+t:"")).replace(se," ")}}function le(e,t,o){var n=e&&e.style;if(n){if(void 0===o)return document.defaultView&&document.defaultView.getComputedStyle?o=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(o=e.currentStyle),void 0===t?o:o[t];t in n||-1!==t.indexOf("webkit")||(t="-webkit-"+t),n[t]=o+("string"==typeof o?"":"px")}}function ce(e,t){var o="";if("string"==typeof e)o=e;else do{var n=le(e,"transform");n&&"none"!==n&&(o=n+" "+o)}while(!t&&(e=e.parentNode));var r=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return r&&new r(o)}function ue(e,t,o){if(e){var n=e.getElementsByTagName(t),r=0,i=n.length;if(o)for(;r<i;r++)o(n[r],r);return n}return[]}function de(){return document.scrollingElement||document.documentElement}function pe(e,t,o,n,r){if(e.getBoundingClientRect||e===window){var i,s,a,l,c,u,d;if(e!==window&&e.parentNode&&e!==de()?(s=(i=e.getBoundingClientRect()).top,a=i.left,l=i.bottom,c=i.right,u=i.height,d=i.width):(s=0,a=0,l=window.innerHeight,c=window.innerWidth,u=window.innerHeight,d=window.innerWidth),(t||o)&&e!==window&&(r=r||e.parentNode,!V))do{if(r&&r.getBoundingClientRect&&("none"!==le(r,"transform")||o&&"static"!==le(r,"position"))){var p=r.getBoundingClientRect();s-=p.top+parseInt(le(r,"border-top-width")),a-=p.left+parseInt(le(r,"border-left-width")),l=s+i.height,c=a+i.width;break}}while(r=r.parentNode);if(n&&e!==window){var h=ce(r||e),m=h&&h.a,v=h&&h.d;h&&(l=(s/=v)+(u/=v),c=(a/=m)+(d/=m))}return{top:s,left:a,bottom:l,right:c,width:d,height:u}}}function he(e,t,o){for(var n=_e(e,!0),r=pe(e)[t];n;){if(!(r>=pe(n)[o]))return n;if(n===de())break;n=_e(n,!1)}return!1}function me(e,t,o,n){for(var r=0,i=0,s=e.children;i<s.length;){if("none"!==s[i].style.display&&s[i]!==St.ghost&&(n||s[i]!==St.dragged)&&re(s[i],o.draggable,e,!1)){if(r===t)return s[i];r++}i++}return null}function ve(e,t){for(var o=e.lastElementChild;o&&(o===St.ghost||"none"===le(o,"display")||t&&!oe(o,t));)o=o.previousElementSibling;return o||null}function ge(e,t){var o=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)"TEMPLATE"===e.nodeName.toUpperCase()||e===St.clone||t&&!oe(e,t)||o++;return o}function fe(e){var t=0,o=0,n=de();if(e)do{var r=ce(e),i=r.a,s=r.d;t+=e.scrollLeft*i,o+=e.scrollTop*s}while(e!==n&&(e=e.parentNode));return[t,o]}function _e(e,t){if(!e||!e.getBoundingClientRect)return de();var o=e,n=!1;do{if(o.clientWidth<o.scrollWidth||o.clientHeight<o.scrollHeight){var r=le(o);if(o.clientWidth<o.scrollWidth&&("auto"==r.overflowX||"scroll"==r.overflowX)||o.clientHeight<o.scrollHeight&&("auto"==r.overflowY||"scroll"==r.overflowY)){if(!o.getBoundingClientRect||o===document.body)return de();if(n||t)return o;n=!0}}}while(o=o.parentNode);return de()}function be(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}function ye(e,t){return function(){if(!ie){var o=arguments;1===o.length?e.call(this,o[0]):e.apply(this,o),ie=setTimeout((function(){ie=void 0}),t)}}}function Se(e,t,o){e.scrollLeft+=t,e.scrollTop+=o}function we(e){var t=window.Polymer,o=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):o?o(e).clone(!0)[0]:e.cloneNode(!0)}function je(e,t,o){var n={};return Array.from(e.children).forEach((function(r){var i,s,a,l;if(re(r,t.draggable,e,!1)&&!r.animated&&r!==o){var c=pe(r);n.left=Math.min(null!==(i=n.left)&&void 0!==i?i:1/0,c.left),n.top=Math.min(null!==(s=n.top)&&void 0!==s?s:1/0,c.top),n.right=Math.max(null!==(a=n.right)&&void 0!==a?a:-1/0,c.right),n.bottom=Math.max(null!==(l=n.bottom)&&void 0!==l?l:-1/0,c.bottom)}})),n.width=n.right-n.left,n.height=n.bottom-n.top,n.x=n.left,n.y=n.top,n}var ke="Sortable"+(new Date).getTime(),Ce=[],De={initializeByDefault:!0},Me={mount:function(e){for(var t in De)De.hasOwnProperty(t)&&!(t in e)&&(e[t]=De[t]);Ce.forEach((function(t){if(t.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")})),Ce.push(e)},pluginEvent:function(e,t,o){var n=this;this.eventCanceled=!1,o.cancel=function(){n.eventCanceled=!0};var r=e+"Global";Ce.forEach((function(n){t[n.pluginName]&&(t[n.pluginName][r]&&t[n.pluginName][r](F({sortable:t},o)),t.options[n.pluginName]&&t[n.pluginName][e]&&t[n.pluginName][e](F({sortable:t},o)))}))},initializePlugins:function(e,t,o,n){for(var r in Ce.forEach((function(n){var r=n.pluginName;if(e.options[r]||n.initializeByDefault){var i=new n(e,t,e.options);i.sortable=e,i.options=e.options,e[r]=i,X(o,i.defaults)}})),e.options)if(e.options.hasOwnProperty(r)){var i=this.modifyOption(e,r,e.options[r]);void 0!==i&&(e.options[r]=i)}},getEventProperties:function(e,t){var o={};return Ce.forEach((function(n){"function"==typeof n.eventProperties&&X(o,n.eventProperties.call(t[n.pluginName],e))})),o},modifyOption:function(e,t,o){var n;return Ce.forEach((function(r){e[r.pluginName]&&r.optionListeners&&"function"==typeof r.optionListeners[t]&&(n=r.optionListeners[t].call(e[r.pluginName],o))})),n}},Te=["evt"],Ee=function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=o.evt,r=function(e,t){if(null==e)return{};var o,n,r=function(e,t){if(null==e)return{};var o,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)o=i[n],t.indexOf(o)>=0||(r[o]=e[o]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)o=i[n],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(r[o]=e[o])}return r}(o,Te);Me.pluginEvent.bind(St)(e,t,F({dragEl:Pe,parentEl:xe,ghostEl:Le,rootEl:Re,nextEl:$e,lastDownEl:Ae,cloneEl:Oe,cloneHidden:Be,dragStarted:Qe,putSortable:Ye,activeSortable:St.active,originalEvent:n,oldIndex:Ne,oldDraggableIndex:Ue,newIndex:He,newDraggableIndex:Fe,hideGhostForTarget:ft,unhideGhostForTarget:_t,cloneNowHidden:function(){Be=!0},cloneNowShown:function(){Be=!1},dispatchSortableEvent:function(e){Ie({sortable:t,name:e,originalEvent:n})}},r))};function Ie(e){!function(e){var t=e.sortable,o=e.rootEl,n=e.name,r=e.targetEl,i=e.cloneEl,s=e.toEl,a=e.fromEl,l=e.oldIndex,c=e.newIndex,u=e.oldDraggableIndex,d=e.newDraggableIndex,p=e.originalEvent,h=e.putSortable,m=e.extraEventProperties;if(t=t||o&&o[ke]){var v,g=t.options,f="on"+n.charAt(0).toUpperCase()+n.substr(1);!window.CustomEvent||V||q?(v=document.createEvent("Event")).initEvent(n,!0,!0):v=new CustomEvent(n,{bubbles:!0,cancelable:!0}),v.to=s||o,v.from=a||o,v.item=r||o,v.clone=i,v.oldIndex=l,v.newIndex=c,v.oldDraggableIndex=u,v.newDraggableIndex=d,v.originalEvent=p,v.pullMode=h?h.lastPutMode:void 0;var _=F(F({},m),Me.getEventProperties(n,t));for(var b in _)v[b]=_[b];o&&o.dispatchEvent(v),g[f]&&g[f].call(t,v)}}(F({putSortable:Ye,cloneEl:Oe,targetEl:Pe,rootEl:Re,oldIndex:Ne,oldDraggableIndex:Ue,newIndex:He,newDraggableIndex:Fe},e))}var Pe,xe,Le,Re,$e,Ae,Oe,Be,Ne,He,Ue,Fe,ze,Ye,Xe,We,Ve,qe,Ge,Ke,Qe,Ze,Je,et,tt,ot=!1,nt=!1,rt=[],it=!1,st=!1,at=[],lt=!1,ct=[],ut="undefined"!=typeof document,dt=Q,pt=q||V?"cssFloat":"float",ht=ut&&!Z&&!Q&&"draggable"in document.createElement("div"),mt=function(){if(ut){if(V)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}}(),vt=function(e,t){var o=le(e),n=parseInt(o.width)-parseInt(o.paddingLeft)-parseInt(o.paddingRight)-parseInt(o.borderLeftWidth)-parseInt(o.borderRightWidth),r=me(e,0,t),i=me(e,1,t),s=r&&le(r),a=i&&le(i),l=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+pe(r).width,c=a&&parseInt(a.marginLeft)+parseInt(a.marginRight)+pe(i).width;if("flex"===o.display)return"column"===o.flexDirection||"column-reverse"===o.flexDirection?"vertical":"horizontal";if("grid"===o.display)return o.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(r&&s.float&&"none"!==s.float){var u="left"===s.float?"left":"right";return!i||"both"!==a.clear&&a.clear!==u?"horizontal":"vertical"}return r&&("block"===s.display||"flex"===s.display||"table"===s.display||"grid"===s.display||l>=n&&"none"===o[pt]||i&&"none"===o[pt]&&l+c>n)?"vertical":"horizontal"},gt=function(e){function t(e,o){return function(n,r,i,s){var a=n.options.group.name&&r.options.group.name&&n.options.group.name===r.options.group.name;if(null==e&&(o||a))return!0;if(null==e||!1===e)return!1;if(o&&"clone"===e)return e;if("function"==typeof e)return t(e(n,r,i,s),o)(n,r,i,s);var l=(o?n:r).options.group.name;return!0===e||"string"==typeof e&&e===l||e.join&&e.indexOf(l)>-1}}var o={},n=e.group;n&&"object"==z(n)||(n={name:n}),o.name=n.name,o.checkPull=t(n.pull,!0),o.checkPut=t(n.put),o.revertClone=n.revertClone,e.group=o},ft=function(){!mt&&Le&&le(Le,"display","none")},_t=function(){!mt&&Le&&le(Le,"display","")};ut&&!Z&&document.addEventListener("click",(function(e){if(nt)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),nt=!1,!1}),!0);var bt=function(e){if(Pe){e=e.touches?e.touches[0]:e;var t=(r=e.clientX,i=e.clientY,rt.some((function(e){var t=e[ke].options.emptyInsertThreshold;if(t&&!ve(e)){var o=pe(e),n=r>=o.left-t&&r<=o.right+t,a=i>=o.top-t&&i<=o.bottom+t;return n&&a?s=e:void 0}})),s);if(t){var o={};for(var n in e)e.hasOwnProperty(n)&&(o[n]=e[n]);o.target=o.rootEl=t,o.preventDefault=void 0,o.stopPropagation=void 0,t[ke]._onDragOver(o)}}var r,i,s},yt=function(e){Pe&&Pe.parentNode[ke]._isOutsideThisEl(e.target)};function St(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=X({},t),e[ke]=this;var o,n,r={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return vt(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==St.supportPointer&&"PointerEvent"in window&&!K,emptyInsertThreshold:5};for(var i in Me.initializePlugins(this,e,r),r)!(i in t)&&(t[i]=r[i]);for(var s in gt(t),this)"_"===s.charAt(0)&&"function"==typeof this[s]&&(this[s]=this[s].bind(this));this.nativeDraggable=!t.forceFallback&&ht,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?ee(e,"pointerdown",this._onTapStart):(ee(e,"mousedown",this._onTapStart),ee(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(ee(e,"dragover",this),ee(e,"dragenter",this)),rt.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),X(this,(n=[],{captureAnimationState:function(){n=[],this.options.animation&&[].slice.call(this.el.children).forEach((function(e){if("none"!==le(e,"display")&&e!==St.ghost){n.push({target:e,rect:pe(e)});var t=F({},n[n.length-1].rect);if(e.thisAnimationDuration){var o=ce(e,!0);o&&(t.top-=o.f,t.left-=o.e)}e.fromRect=t}}))},addAnimationState:function(e){n.push(e)},removeAnimationState:function(e){n.splice(function(e,t){for(var o in e)if(e.hasOwnProperty(o))for(var n in t)if(t.hasOwnProperty(n)&&t[n]===e[o][n])return Number(o);return-1}(n,{target:e}),1)},animateAll:function(e){var t=this;if(!this.options.animation)return clearTimeout(o),void("function"==typeof e&&e());var r=!1,i=0;n.forEach((function(e){var o=0,n=e.target,s=n.fromRect,a=pe(n),l=n.prevFromRect,c=n.prevToRect,u=e.rect,d=ce(n,!0);d&&(a.top-=d.f,a.left-=d.e),n.toRect=a,n.thisAnimationDuration&&be(l,a)&&!be(s,a)&&(u.top-a.top)/(u.left-a.left)==(s.top-a.top)/(s.left-a.left)&&(o=function(e,t,o,n){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-o.top,2)+Math.pow(t.left-o.left,2))*n.animation}(u,l,c,t.options)),be(a,s)||(n.prevFromRect=s,n.prevToRect=a,o||(o=t.options.animation),t.animate(n,u,a,o)),o&&(r=!0,i=Math.max(i,o),clearTimeout(n.animationResetTimer),n.animationResetTimer=setTimeout((function(){n.animationTime=0,n.prevFromRect=null,n.fromRect=null,n.prevToRect=null,n.thisAnimationDuration=null}),o),n.thisAnimationDuration=o)})),clearTimeout(o),r?o=setTimeout((function(){"function"==typeof e&&e()}),i):"function"==typeof e&&e(),n=[]},animate:function(e,t,o,n){if(n){le(e,"transition",""),le(e,"transform","");var r=ce(this.el),i=r&&r.a,s=r&&r.d,a=(t.left-o.left)/(i||1),l=(t.top-o.top)/(s||1);e.animatingX=!!a,e.animatingY=!!l,le(e,"transform","translate3d("+a+"px,"+l+"px,0)"),this.forRepaintDummy=function(e){return e.offsetWidth}(e),le(e,"transition","transform "+n+"ms"+(this.options.easing?" "+this.options.easing:"")),le(e,"transform","translate3d(0,0,0)"),"number"==typeof e.animated&&clearTimeout(e.animated),e.animated=setTimeout((function(){le(e,"transition",""),le(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1}),n)}}}))}function wt(e,t,o,n,r,i,s,a){var l,c,u=e[ke],d=u.options.onMove;return!window.CustomEvent||V||q?(l=document.createEvent("Event")).initEvent("move",!0,!0):l=new CustomEvent("move",{bubbles:!0,cancelable:!0}),l.to=t,l.from=e,l.dragged=o,l.draggedRect=n,l.related=r||t,l.relatedRect=i||pe(t),l.willInsertAfter=a,l.originalEvent=s,e.dispatchEvent(l),d&&(c=d.call(u,l,s)),c}function jt(e){e.draggable=!1}function kt(){lt=!1}function Ct(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,o=t.length,n=0;o--;)n+=t.charCodeAt(o);return n.toString(36)}function Dt(e){return setTimeout(e,0)}function Mt(e){return clearTimeout(e)}St.prototype={constructor:St,_isOutsideThisEl:function(e){this.el.contains(e)||e===this.el||(Ze=null)},_getDirection:function(e,t){return"function"==typeof this.options.direction?this.options.direction.call(this,e,t,Pe):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,o=this.el,n=this.options,r=n.preventOnFilter,i=e.type,s=e.touches&&e.touches[0]||e.pointerType&&"touch"===e.pointerType&&e,a=(s||e).target,l=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||a,c=n.filter;if(function(e){ct.length=0;for(var t=e.getElementsByTagName("input"),o=t.length;o--;){var n=t[o];n.checked&&ct.push(n)}}(o),!Pe&&!(/mousedown|pointerdown/.test(i)&&0!==e.button||n.disabled)&&!l.isContentEditable&&(this.nativeDraggable||!K||!a||"SELECT"!==a.tagName.toUpperCase())&&!((a=re(a,n.draggable,o,!1))&&a.animated||Ae===a)){if(Ne=ge(a),Ue=ge(a,n.draggable),"function"==typeof c){if(c.call(this,e,a,this))return Ie({sortable:t,rootEl:l,name:"filter",targetEl:a,toEl:o,fromEl:o}),Ee("filter",t,{evt:e}),void(r&&e.cancelable&&e.preventDefault())}else if(c&&(c=c.split(",").some((function(n){if(n=re(l,n.trim(),o,!1))return Ie({sortable:t,rootEl:n,name:"filter",targetEl:a,fromEl:o,toEl:o}),Ee("filter",t,{evt:e}),!0}))))return void(r&&e.cancelable&&e.preventDefault());n.handle&&!re(l,n.handle,o,!1)||this._prepareDragStart(e,s,a)}}},_prepareDragStart:function(e,t,o){var n,r=this,i=r.el,s=r.options,a=i.ownerDocument;if(o&&!Pe&&o.parentNode===i){var l=pe(o);if(Re=i,xe=(Pe=o).parentNode,$e=Pe.nextSibling,Ae=o,ze=s.group,St.dragged=Pe,Xe={target:Pe,clientX:(t||e).clientX,clientY:(t||e).clientY},Ge=Xe.clientX-l.left,Ke=Xe.clientY-l.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,Pe.style["will-change"]="all",n=function(){Ee("delayEnded",r,{evt:e}),St.eventCanceled?r._onDrop():(r._disableDelayedDragEvents(),!G&&r.nativeDraggable&&(Pe.draggable=!0),r._triggerDragStart(e,t),Ie({sortable:r,name:"choose",originalEvent:e}),ae(Pe,s.chosenClass,!0))},s.ignore.split(",").forEach((function(e){ue(Pe,e.trim(),jt)})),ee(a,"dragover",bt),ee(a,"mousemove",bt),ee(a,"touchmove",bt),ee(a,"mouseup",r._onDrop),ee(a,"touchend",r._onDrop),ee(a,"touchcancel",r._onDrop),G&&this.nativeDraggable&&(this.options.touchStartThreshold=4,Pe.draggable=!0),Ee("delayStart",this,{evt:e}),!s.delay||s.delayOnTouchOnly&&!t||this.nativeDraggable&&(q||V))n();else{if(St.eventCanceled)return void this._onDrop();ee(a,"mouseup",r._disableDelayedDrag),ee(a,"touchend",r._disableDelayedDrag),ee(a,"touchcancel",r._disableDelayedDrag),ee(a,"mousemove",r._delayedDragTouchMoveHandler),ee(a,"touchmove",r._delayedDragTouchMoveHandler),s.supportPointer&&ee(a,"pointermove",r._delayedDragTouchMoveHandler),r._dragStartTimer=setTimeout(n,s.delay)}}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){Pe&&jt(Pe),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;te(e,"mouseup",this._disableDelayedDrag),te(e,"touchend",this._disableDelayedDrag),te(e,"touchcancel",this._disableDelayedDrag),te(e,"mousemove",this._delayedDragTouchMoveHandler),te(e,"touchmove",this._delayedDragTouchMoveHandler),te(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||"touch"==e.pointerType&&e,!this.nativeDraggable||t?this.options.supportPointer?ee(document,"pointermove",this._onTouchMove):ee(document,t?"touchmove":"mousemove",this._onTouchMove):(ee(Pe,"dragend",this),ee(Re,"dragstart",this._onDragStart));try{document.selection?Dt((function(){document.selection.empty()})):window.getSelection().removeAllRanges()}catch(e){}},_dragStarted:function(e,t){if(ot=!1,Re&&Pe){Ee("dragStarted",this,{evt:t}),this.nativeDraggable&&ee(document,"dragover",yt);var o=this.options;!e&&ae(Pe,o.dragClass,!1),ae(Pe,o.ghostClass,!0),St.active=this,e&&this._appendGhost(),Ie({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(We){this._lastX=We.clientX,this._lastY=We.clientY,ft();for(var e=document.elementFromPoint(We.clientX,We.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(We.clientX,We.clientY))!==t;)t=e;if(Pe.parentNode[ke]._isOutsideThisEl(e),t)do{if(t[ke]&&t[ke]._onDragOver({clientX:We.clientX,clientY:We.clientY,target:e,rootEl:t})&&!this.options.dragoverBubble)break;e=t}while(t=t.parentNode);_t()}},_onTouchMove:function(e){if(Xe){var t=this.options,o=t.fallbackTolerance,n=t.fallbackOffset,r=e.touches?e.touches[0]:e,i=Le&&ce(Le,!0),s=Le&&i&&i.a,a=Le&&i&&i.d,l=dt&&tt&&fe(tt),c=(r.clientX-Xe.clientX+n.x)/(s||1)+(l?l[0]-at[0]:0)/(s||1),u=(r.clientY-Xe.clientY+n.y)/(a||1)+(l?l[1]-at[1]:0)/(a||1);if(!St.active&&!ot){if(o&&Math.max(Math.abs(r.clientX-this._lastX),Math.abs(r.clientY-this._lastY))<o)return;this._onDragStart(e,!0)}if(Le){i?(i.e+=c-(Ve||0),i.f+=u-(qe||0)):i={a:1,b:0,c:0,d:1,e:c,f:u};var d="matrix(".concat(i.a,",").concat(i.b,",").concat(i.c,",").concat(i.d,",").concat(i.e,",").concat(i.f,")");le(Le,"webkitTransform",d),le(Le,"mozTransform",d),le(Le,"msTransform",d),le(Le,"transform",d),Ve=c,qe=u,We=r}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!Le){var e=this.options.fallbackOnBody?document.body:Re,t=pe(Pe,!0,dt,!0,e),o=this.options;if(dt){for(tt=e;"static"===le(tt,"position")&&"none"===le(tt,"transform")&&tt!==document;)tt=tt.parentNode;tt!==document.body&&tt!==document.documentElement?(tt===document&&(tt=de()),t.top+=tt.scrollTop,t.left+=tt.scrollLeft):tt=de(),at=fe(tt)}ae(Le=Pe.cloneNode(!0),o.ghostClass,!1),ae(Le,o.fallbackClass,!0),ae(Le,o.dragClass,!0),le(Le,"transition",""),le(Le,"transform",""),le(Le,"box-sizing","border-box"),le(Le,"margin",0),le(Le,"top",t.top),le(Le,"left",t.left),le(Le,"width",t.width),le(Le,"height",t.height),le(Le,"opacity","0.8"),le(Le,"position",dt?"absolute":"fixed"),le(Le,"zIndex","100000"),le(Le,"pointerEvents","none"),St.ghost=Le,e.appendChild(Le),le(Le,"transform-origin",Ge/parseInt(Le.style.width)*100+"% "+Ke/parseInt(Le.style.height)*100+"%")}},_onDragStart:function(e,t){var o=this,n=e.dataTransfer,r=o.options;Ee("dragStart",this,{evt:e}),St.eventCanceled?this._onDrop():(Ee("setupClone",this),St.eventCanceled||((Oe=we(Pe)).removeAttribute("id"),Oe.draggable=!1,Oe.style["will-change"]="",this._hideClone(),ae(Oe,this.options.chosenClass,!1),St.clone=Oe),o.cloneId=Dt((function(){Ee("clone",o),St.eventCanceled||(o.options.removeCloneOnHide||Re.insertBefore(Oe,Pe),o._hideClone(),Ie({sortable:o,name:"clone"}))})),!t&&ae(Pe,r.dragClass,!0),t?(nt=!0,o._loopId=setInterval(o._emulateDragOver,50)):(te(document,"mouseup",o._onDrop),te(document,"touchend",o._onDrop),te(document,"touchcancel",o._onDrop),n&&(n.effectAllowed="move",r.setData&&r.setData.call(o,n,Pe)),ee(document,"drop",o),le(Pe,"transform","translateZ(0)")),ot=!0,o._dragStartId=Dt(o._dragStarted.bind(o,t,e)),ee(document,"selectstart",o),Qe=!0,K&&le(document.body,"user-select","none"))},_onDragOver:function(e){var t,o,n,r,i=this.el,s=e.target,a=this.options,l=a.group,c=St.active,u=ze===l,d=a.sort,p=Ye||c,h=this,m=!1;if(!lt){if(void 0!==e.preventDefault&&e.cancelable&&e.preventDefault(),s=re(s,a.draggable,i,!0),E("dragOver"),St.eventCanceled)return m;if(Pe.contains(e.target)||s.animated&&s.animatingX&&s.animatingY||h._ignoreWhileAnimating===s)return P(!1);if(nt=!1,c&&!a.disabled&&(u?d||(n=xe!==Re):Ye===this||(this.lastPutMode=ze.checkPull(this,c,Pe,e))&&l.checkPut(this,c,Pe,e))){if(r="vertical"===this._getDirection(e,s),t=pe(Pe),E("dragOverValid"),St.eventCanceled)return m;if(n)return xe=Re,I(),this._hideClone(),E("revert"),St.eventCanceled||($e?Re.insertBefore(Pe,$e):Re.appendChild(Pe)),P(!0);var v=ve(i,a.draggable);if(!v||function(e,t,o){var n=pe(ve(o.el,o.options.draggable)),r=je(o.el,o.options,Le);return t?e.clientX>r.right+10||e.clientY>n.bottom&&e.clientX>n.left:e.clientY>r.bottom+10||e.clientX>n.right&&e.clientY>n.top}(e,r,this)&&!v.animated){if(v===Pe)return P(!1);if(v&&i===e.target&&(s=v),s&&(o=pe(s)),!1!==wt(Re,i,Pe,t,s,o,e,!!s))return I(),v&&v.nextSibling?i.insertBefore(Pe,v.nextSibling):i.appendChild(Pe),xe=i,x(),P(!0)}else if(v&&function(e,t,o){var n=pe(me(o.el,0,o.options,!0)),r=je(o.el,o.options,Le);return t?e.clientX<r.left-10||e.clientY<n.top&&e.clientX<n.right:e.clientY<r.top-10||e.clientY<n.bottom&&e.clientX<n.left}(e,r,this)){var g=me(i,0,a,!0);if(g===Pe)return P(!1);if(o=pe(s=g),!1!==wt(Re,i,Pe,t,s,o,e,!1))return I(),i.insertBefore(Pe,g),xe=i,x(),P(!0)}else if(s.parentNode===i){o=pe(s);var f,_,b,y=Pe.parentNode!==i,S=!function(e,t,o){var n=o?e.left:e.top,r=o?e.right:e.bottom,i=o?e.width:e.height,s=o?t.left:t.top,a=o?t.right:t.bottom,l=o?t.width:t.height;return n===s||r===a||n+i/2===s+l/2}(Pe.animated&&Pe.toRect||t,s.animated&&s.toRect||o,r),w=r?"top":"left",j=he(s,"top","top")||he(Pe,"top","top"),k=j?j.scrollTop:void 0;if(Ze!==s&&(_=o[w],it=!1,st=!S&&a.invertSwap||y),f=function(e,t,o,n,r,i,s,a){var l=n?e.clientY:e.clientX,c=n?o.height:o.width,u=n?o.top:o.left,d=n?o.bottom:o.right,p=!1;if(!s)if(a&&et<c*r){if(!it&&(1===Je?l>u+c*i/2:l<d-c*i/2)&&(it=!0),it)p=!0;else if(1===Je?l<u+et:l>d-et)return-Je}else if(l>u+c*(1-r)/2&&l<d-c*(1-r)/2)return function(e){return ge(Pe)<ge(e)?1:-1}(t);return(p=p||s)&&(l<u+c*i/2||l>d-c*i/2)?l>u+c/2?1:-1:0}(e,s,o,r,S?1:a.swapThreshold,null==a.invertedSwapThreshold?a.swapThreshold:a.invertedSwapThreshold,st,Ze===s),0!==f){var C=ge(Pe);do{C-=f,b=xe.children[C]}while(b&&("none"===le(b,"display")||b===Le))}if(0===f||b===s)return P(!1);Ze=s,Je=f;var D=s.nextElementSibling,M=!1,T=wt(Re,i,Pe,t,s,o,e,M=1===f);if(!1!==T)return 1!==T&&-1!==T||(M=1===T),lt=!0,setTimeout(kt,30),I(),M&&!D?i.appendChild(Pe):s.parentNode.insertBefore(Pe,M?D:s),j&&Se(j,0,k-j.scrollTop),xe=Pe.parentNode,void 0===_||st||(et=Math.abs(_-pe(s)[w])),x(),P(!0)}if(i.contains(Pe))return P(!1)}return!1}function E(a,l){Ee(a,h,F({evt:e,isOwner:u,axis:r?"vertical":"horizontal",revert:n,dragRect:t,targetRect:o,canSort:d,fromSortable:p,target:s,completed:P,onMove:function(o,n){return wt(Re,i,Pe,t,o,pe(o),e,n)},changed:x},l))}function I(){E("dragOverAnimationCapture"),h.captureAnimationState(),h!==p&&p.captureAnimationState()}function P(t){return E("dragOverCompleted",{insertion:t}),t&&(u?c._hideClone():c._showClone(h),h!==p&&(ae(Pe,Ye?Ye.options.ghostClass:c.options.ghostClass,!1),ae(Pe,a.ghostClass,!0)),Ye!==h&&h!==St.active?Ye=h:h===St.active&&Ye&&(Ye=null),p===h&&(h._ignoreWhileAnimating=s),h.animateAll((function(){E("dragOverAnimationComplete"),h._ignoreWhileAnimating=null})),h!==p&&(p.animateAll(),p._ignoreWhileAnimating=null)),(s===Pe&&!Pe.animated||s===i&&!s.animated)&&(Ze=null),a.dragoverBubble||e.rootEl||s===document||(Pe.parentNode[ke]._isOutsideThisEl(e.target),!t&&bt(e)),!a.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),m=!0}function x(){He=ge(Pe),Fe=ge(Pe,a.draggable),Ie({sortable:h,name:"change",toEl:i,newIndex:He,newDraggableIndex:Fe,originalEvent:e})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){te(document,"mousemove",this._onTouchMove),te(document,"touchmove",this._onTouchMove),te(document,"pointermove",this._onTouchMove),te(document,"dragover",bt),te(document,"mousemove",bt),te(document,"touchmove",bt)},_offUpEvents:function(){var e=this.el.ownerDocument;te(e,"mouseup",this._onDrop),te(e,"touchend",this._onDrop),te(e,"pointerup",this._onDrop),te(e,"touchcancel",this._onDrop),te(document,"selectstart",this)},_onDrop:function(e){var t=this.el,o=this.options;He=ge(Pe),Fe=ge(Pe,o.draggable),Ee("drop",this,{evt:e}),xe=Pe&&Pe.parentNode,He=ge(Pe),Fe=ge(Pe,o.draggable),St.eventCanceled||(ot=!1,st=!1,it=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Mt(this.cloneId),Mt(this._dragStartId),this.nativeDraggable&&(te(document,"drop",this),te(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),K&&le(document.body,"user-select",""),le(Pe,"transform",""),e&&(Qe&&(e.cancelable&&e.preventDefault(),!o.dropBubble&&e.stopPropagation()),Le&&Le.parentNode&&Le.parentNode.removeChild(Le),(Re===xe||Ye&&"clone"!==Ye.lastPutMode)&&Oe&&Oe.parentNode&&Oe.parentNode.removeChild(Oe),Pe&&(this.nativeDraggable&&te(Pe,"dragend",this),jt(Pe),Pe.style["will-change"]="",Qe&&!ot&&ae(Pe,Ye?Ye.options.ghostClass:this.options.ghostClass,!1),ae(Pe,this.options.chosenClass,!1),Ie({sortable:this,name:"unchoose",toEl:xe,newIndex:null,newDraggableIndex:null,originalEvent:e}),Re!==xe?(He>=0&&(Ie({rootEl:xe,name:"add",toEl:xe,fromEl:Re,originalEvent:e}),Ie({sortable:this,name:"remove",toEl:xe,originalEvent:e}),Ie({rootEl:xe,name:"sort",toEl:xe,fromEl:Re,originalEvent:e}),Ie({sortable:this,name:"sort",toEl:xe,originalEvent:e})),Ye&&Ye.save()):He!==Ne&&He>=0&&(Ie({sortable:this,name:"update",toEl:xe,originalEvent:e}),Ie({sortable:this,name:"sort",toEl:xe,originalEvent:e})),St.active&&(null!=He&&-1!==He||(He=Ne,Fe=Ue),Ie({sortable:this,name:"end",toEl:xe,originalEvent:e}),this.save())))),this._nulling()},_nulling:function(){Ee("nulling",this),Re=Pe=xe=Le=$e=Oe=Ae=Be=Xe=We=Qe=He=Fe=Ne=Ue=Ze=Je=Ye=ze=St.dragged=St.ghost=St.clone=St.active=null,ct.forEach((function(e){e.checked=!0})),ct.length=Ve=qe=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":Pe&&(this._onDragOver(e),function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}(e));break;case"selectstart":e.preventDefault()}},toArray:function(){for(var e,t=[],o=this.el.children,n=0,r=o.length,i=this.options;n<r;n++)re(e=o[n],i.draggable,this.el,!1)&&t.push(e.getAttribute(i.dataIdAttr)||Ct(e));return t},sort:function(e,t){var o={},n=this.el;this.toArray().forEach((function(e,t){var r=n.children[t];re(r,this.options.draggable,n,!1)&&(o[e]=r)}),this),t&&this.captureAnimationState(),e.forEach((function(e){o[e]&&(n.removeChild(o[e]),n.appendChild(o[e]))})),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return re(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var o=this.options;if(void 0===t)return o[e];var n=Me.modifyOption(this,e,t);o[e]=void 0!==n?n:t,"group"===e&&gt(o)},destroy:function(){Ee("destroy",this);var e=this.el;e[ke]=null,te(e,"mousedown",this._onTapStart),te(e,"touchstart",this._onTapStart),te(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(te(e,"dragover",this),te(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),(function(e){e.removeAttribute("draggable")})),this._onDrop(),this._disableDelayedDragEvents(),rt.splice(rt.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!Be){if(Ee("hideClone",this),St.eventCanceled)return;le(Oe,"display","none"),this.options.removeCloneOnHide&&Oe.parentNode&&Oe.parentNode.removeChild(Oe),Be=!0}},_showClone:function(e){if("clone"===e.lastPutMode){if(Be){if(Ee("showClone",this),St.eventCanceled)return;Pe.parentNode!=Re||this.options.group.revertClone?$e?Re.insertBefore(Oe,$e):Re.appendChild(Oe):Re.insertBefore(Oe,Pe),this.options.group.revertClone&&this.animate(Pe,Oe),le(Oe,"display",""),Be=!1}}else this._hideClone()}},ut&&ee(document,"touchmove",(function(e){(St.active||ot)&&e.cancelable&&e.preventDefault()})),St.utils={on:ee,off:te,css:le,find:ue,is:function(e,t){return!!re(e,t,e,!1)},extend:function(e,t){if(e&&t)for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);return e},throttle:ye,closest:re,toggleClass:ae,clone:we,index:ge,nextTick:Dt,cancelNextTick:Mt,detectDirection:vt,getChild:me},St.get=function(e){return e[ke]},St.mount=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];t[0].constructor===Array&&(t=t[0]),t.forEach((function(e){if(!e.prototype||!e.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(e));e.utils&&(St.utils=F(F({},St.utils),e.utils)),Me.mount(e)}))},St.create=function(e,t){return new St(e,t)},St.version="1.15.2";var Tt,Et,It,Pt,xt,Lt,Rt=[],$t=!1;function At(){Rt.forEach((function(e){clearInterval(e.pid)})),Rt=[]}function Ot(){clearInterval(Lt)}var Bt=ye((function(e,t,o,n){if(t.scroll){var r,i=(e.touches?e.touches[0]:e).clientX,s=(e.touches?e.touches[0]:e).clientY,a=t.scrollSensitivity,l=t.scrollSpeed,c=de(),u=!1;Et!==o&&(Et=o,At(),Tt=t.scroll,r=t.scrollFn,!0===Tt&&(Tt=_e(o,!0)));var d=0,p=Tt;do{var h=p,m=pe(h),v=m.top,g=m.bottom,f=m.left,_=m.right,b=m.width,y=m.height,S=void 0,w=void 0,j=h.scrollWidth,k=h.scrollHeight,C=le(h),D=h.scrollLeft,M=h.scrollTop;h===c?(S=b<j&&("auto"===C.overflowX||"scroll"===C.overflowX||"visible"===C.overflowX),w=y<k&&("auto"===C.overflowY||"scroll"===C.overflowY||"visible"===C.overflowY)):(S=b<j&&("auto"===C.overflowX||"scroll"===C.overflowX),w=y<k&&("auto"===C.overflowY||"scroll"===C.overflowY));var T=S&&(Math.abs(_-i)<=a&&D+b<j)-(Math.abs(f-i)<=a&&!!D),E=w&&(Math.abs(g-s)<=a&&M+y<k)-(Math.abs(v-s)<=a&&!!M);if(!Rt[d])for(var I=0;I<=d;I++)Rt[I]||(Rt[I]={});Rt[d].vx==T&&Rt[d].vy==E&&Rt[d].el===h||(Rt[d].el=h,Rt[d].vx=T,Rt[d].vy=E,clearInterval(Rt[d].pid),0==T&&0==E||(u=!0,Rt[d].pid=setInterval(function(){n&&0===this.layer&&St.active._onTouchMove(xt);var t=Rt[this.layer].vy?Rt[this.layer].vy*l:0,o=Rt[this.layer].vx?Rt[this.layer].vx*l:0;"function"==typeof r&&"continue"!==r.call(St.dragged.parentNode[ke],o,t,e,xt,Rt[this.layer].el)||Se(Rt[this.layer].el,o,t)}.bind({layer:d}),24))),d++}while(t.bubbleScroll&&p!==c&&(p=_e(p,!1)));$t=u}}),30),Nt=function(e){var t=e.originalEvent,o=e.putSortable,n=e.dragEl,r=e.activeSortable,i=e.dispatchSortableEvent,s=e.hideGhostForTarget,a=e.unhideGhostForTarget;if(t){var l=o||r;s();var c=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,u=document.elementFromPoint(c.clientX,c.clientY);a(),l&&!l.el.contains(u)&&(i("spill"),this.onSpill({dragEl:n,putSortable:o}))}};function Ht(){}function Ut(){}Ht.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,o=e.putSortable;this.sortable.captureAnimationState(),o&&o.captureAnimationState();var n=me(this.sortable.el,this.startIndex,this.options);n?this.sortable.el.insertBefore(t,n):this.sortable.el.appendChild(t),this.sortable.animateAll(),o&&o.animateAll()},drop:Nt},X(Ht,{pluginName:"revertOnSpill"}),Ut.prototype={onSpill:function(e){var t=e.dragEl,o=e.putSortable||this.sortable;o.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),o.animateAll()},drop:Nt},X(Ut,{pluginName:"removeOnSpill"}),St.mount(new function(){function e(){for(var e in this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===e.charAt(0)&&"function"==typeof this[e]&&(this[e]=this[e].bind(this))}return e.prototype={dragStarted:function(e){var t=e.originalEvent;this.sortable.nativeDraggable?ee(document,"dragover",this._handleAutoScroll):this.options.supportPointer?ee(document,"pointermove",this._handleFallbackAutoScroll):t.touches?ee(document,"touchmove",this._handleFallbackAutoScroll):ee(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var t=e.originalEvent;this.options.dragOverBubble||t.rootEl||this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?te(document,"dragover",this._handleAutoScroll):(te(document,"pointermove",this._handleFallbackAutoScroll),te(document,"touchmove",this._handleFallbackAutoScroll),te(document,"mousemove",this._handleFallbackAutoScroll)),Ot(),At(),clearTimeout(ie),ie=void 0},nulling:function(){xt=Et=Tt=$t=Lt=It=Pt=null,Rt.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,t){var o=this,n=(e.touches?e.touches[0]:e).clientX,r=(e.touches?e.touches[0]:e).clientY,i=document.elementFromPoint(n,r);if(xt=e,t||this.options.forceAutoScrollFallback||q||V||K){Bt(e,this.options,i,t);var s=_e(i,!0);!$t||Lt&&n===It&&r===Pt||(Lt&&Ot(),Lt=setInterval((function(){var i=_e(document.elementFromPoint(n,r),!0);i!==s&&(s=i,At()),Bt(e,o.options,i,t)}),10),It=n,Pt=r)}else{if(!this.options.bubbleScroll||_e(i,!0)===de())return void At();Bt(e,this.options,_e(i,!1),!1)}}},X(e,{pluginName:"scroll",initializeByDefault:!0})}),St.mount(Ut,Ht);const Ft={departureTime:!0,layerDetails:!0,printButton:!1,saveAsButton:!0,saveButton:!0,stops:!0,traveMode:!0};function zt(e){return!!e.composedPath?.().find((e=>e.classList?.contains("esri-search__suggestions-list")))}function Yt(e){const t=new Date(e);return new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate())}const Xt="search-term";let Wt=class extends _{constructor(e,t){super(e,t),this._activeStop=null,this._activeManeuver=null,this._autoStopRemovalDelay=100,this._autoStopRemovalTimeoutId=void 0,this._focusedManeuver=null,this._newPlaceholderStop=null,this._pointerDownUpHandle=null,this._pointerPressedSearchSuggestionStop=null,this._renderSavePopoverFunction=null,this._saveAsButtonNode=null,this._saveLayer=new H,this._sections=null,this._sortable=null,this._stopsToSearches=new Map,this._viewClickHandle=null,this.headingLevel=2,this.messages=null,this.messagesCommon=null,this.messagesUnits=null,this.searchProperties=null,this.viewModel=new y,this.visibleElements={...Ft},this._setUpDragAndDropStops=e=>{this._sortable=St.create(e,{draggable:`.${O.validStopRow}`,ghostClass:O.stopRowGhost,handle:`.${O.stopHandle}`,onEnd:this._handleStopInputDragEnd})},this._handleDragHandlePointerDown=()=>this.viewModel.layer?.stops.forEach((e=>this.acquireSearch(e).activeMenu="none")),this._handleStopInputDragEnd=({oldIndex:e,newIndex:t,target:o})=>{if(e===t||null==t||null==e)return;const{children:n}=o,r=n[t],i=n[e],s=t-e<0;o.insertBefore(r,s?i.nextElementSibling:i);const{stops:a}=this.viewModel.layer;a.reorder(a.at(e),t);for(const e of a)e.sequence=null;this._solveRoute()}}initialize(){this.addHandles([s((()=>this.viewModel.layer?.routeInfo),(()=>{this._activeManeuver=null,this._focusedManeuver=null,this._sections=this._getSections(),this.scheduleRender()}),a),l((()=>[this.view,this.view?.surface]),(([e,t],n)=>{const r=n?.[0];if(r&&(this._viewClickHandle=null,r&&this.removeHandles(r)),e&&t){const n=this._prepPointerDownUpClick(),r=this._prepViewClick();n.pause(),r.pause(),this.addHandles([o(t,"mousedown",(()=>this._autoStopRemovalDelay=500)),o(t,"mouseup",(()=>this._autoStopRemovalDelay=100)),n,r],e),this._pointerDownUpHandle=n,this._viewClickHandle=r}}),a),l((()=>null==this.viewModel.serviceDescription),(()=>{try{this.viewModel.load()}catch{}}),a),s((()=>this._saveLayer.state),(()=>{this.scheduleRender()}))]),this.when((()=>{this.destroyed||this.visibleElements.saveAsButton&&(this._renderSavePopoverFunction=this._renderSavePopover.bind(this),this._projector.append(document.body,this._renderSavePopoverFunction))}))}loadDependencies(){return b({button:()=>import("../chunks/calcite-button.js"),icon:()=>import("../chunks/calcite-icon.js"),"input-date-picker":()=>import("../chunks/calcite-input-date-picker.js"),"input-time-picker":()=>import("../chunks/calcite-input-time-picker.js"),link:()=>import("../chunks/calcite-link.js"),popover:()=>import("../chunks/calcite-popover.js")})}destroy(){for(const e of this._stopsToSearches.values())e.destroy();this._sortable?.destroy(),null!=this._renderSavePopoverFunction&&this._projector.detach(this._renderSavePopoverFunction)}get apiKey(){return this.viewModel.apiKey}set apiKey(e){this.viewModel.apiKey=e}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get icon(){return"right"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get lastRoute(){return this.viewModel.lastRoute}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}get maxStops(){return this.viewModel.maxStops}set maxStops(e){this.viewModel.maxStops=e}get unit(){return this.defaultUnit}set unit(e){this._overrideIfSome("unit",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}castVisibleElements(e){return{...Ft,...e}}acquireSearch(e){const{view:t}=this.viewModel;if(this._stopsToSearches.has(e)){const o=this._stopsToSearches.get(e);return o.view=t,this._overrideDefaultSources(o),o}const o=new f({view:t,resultGraphicEnabled:!1,popupEnabled:!1,...this.searchProperties});return this._normalizeSearchSources(o),this.addHandles([c((()=>o.allSources),"change",(()=>this._normalizeSearchSources(o))),o.on("select-result",(()=>{e.geometry=o.selectedResult?.feature.geometry,e.name=o.selectedResult?.name,this._solveRoute()})),o.on("search-focus",(()=>this._handleStopInputFocus(o,e))),o.on("search-blur",(()=>this._handleStopInputBlur(o,e))),o.on("search-clear",(()=>{e.geometry=null,e.name=null,this._activeStop=e,this.viewModel.layer?.removeResult()})),s((()=>o.searchTerm),(t=>{e.name=t}))],o),this._stopsToSearches.set(e,o),o}getDirections(){return this.viewModel.getDirections()}render(){return M("div",{class:this.classes(O.base,I.widget,I.panel,O.scroller)},this._renderPanelContent())}save(){return this.viewModel.save()}saveAs(e,t={}){return this.viewModel.saveAs(e,t)}zoomToRoute(){return this.viewModel.zoomToRoute()}_renderPanelContent(){const{layer:e,serviceDescription:t,state:o}=this.viewModel,n="initializing"===o,r="error"===o&&!t,i="unauthenticated"===o,s={[O.panelContentLoading]:n,[O.panelContentError]:r||!e,[O.panelContentSignIn]:i},a=n?"presentation":"group",l=e?i?this._renderSignIn():r?this._renderMessage(this._getErrorMessage()):n?this._renderLoader():this._renderReadyContent():this._renderMessage(this.messages.missingLayer);return M("div",{class:this.classes(O.panelContent,s),role:a},l)}_renderReadyContent(){return[this._renderStopsContainer(),this._renderTravelModeOptions(),this._renderDepartureTimeControls(),this._renderSaveContainer(),this._renderSectionSplitter(),this._renderDirectionsContainer()]}_renderSignIn(){return M("div",{class:O.signInContent,key:"sign-in"},M(P,{class:O.contentTitle,level:this.headingLevel},this.messages.widgetLabel),this._renderPlaceholder(),M(P,{level:x(this.headingLevel)},this.messages.signInRequired),M("button",{bind:this,class:this.classes(I.button,I.buttonSecondary,O.signInButton),onclick:this._handleSignInClick,tabIndex:0,type:"button"},this.messagesCommon.auth.signIn))}_handleSignInClick(){this.viewModel.load().catch((()=>{}))}_renderTravelModeOptions(){if(!this.visibleElements.traveMode)return null;const{selectedTravelMode:e,travelModes:t}=this.viewModel;if(0===t.length)return null;const o=null!=e?e.name:this.messages.travelMode;return M("div",{"aria-disabled":this._saveLayer.opened.toString(),class:this.classes(O.travelMode,this._saveLayer.opened&&I.buttonDisabled),key:"esri-directions__travel-mode-controls",role:"group"},M("select",{"aria-label":o,bind:this,class:this.classes(O.travelModeSelect,I.select),key:"esri-directions__travel-mode-options",onchange:this._handleTravelModeChange,title:o},t.map(((t,o)=>M("option",{"data-mode":t,key:`esri-directions__travel-mode-${o}`,selected:e===t,value:`${o}`},t.name)))))}_handleTravelModeChange(e){const t=e.currentTarget;var o;this.viewModel.selectedTravelMode=(o=t.item(t.selectedIndex),o?.["data-mode"]),this._solveRoute()}_renderStopsContainer(){return this.visibleElements.stops?M("div",{"aria-disabled":this._saveLayer.opened.toString(),class:this.classes(O.section,this._saveLayer.opened&&I.buttonDisabled),key:"esri-directions__stops-container",role:"group"},this._renderStops()):null}_renderDepartureTimeControls(){if(!this.visibleElements.departureTime)return null;const{messages:{departAt:e,departureTime:t,leaveNow:o,timeUnspecified:n},viewModel:{departureOption:r}}=this;return M("div",{"aria-disabled":this._saveLayer.opened.toString(),class:this.classes(O.departureTime,this._saveLayer.opened&&I.buttonDisabled),key:"esri-directions__departure-time-controls",role:"group"},M("select",{"aria-label":t,bind:this,class:this.classes(O.departureTimeSelect,I.select),onchange:this._handleDepartureOptionChange,title:t},M("option",{selected:r===S.NOW,value:S.NOW},o),M("option",{selected:r===S.DEPART_AT,value:S.DEPART_AT},e),M("option",{selected:r===S.UNSPECIFIED,value:S.UNSPECIFIED},n)),r===S.DEPART_AT?this._renderTimeControls():null)}_renderStops(){const{stops:e}=this.viewModel.layer;let t=0;for(const t of this._stopsToSearches.keys())e.includes(t)||this._disposeSearch(t);for(const o of e){const e=this.acquireSearch(o);"none"!==e.activeMenu&&(t+=1),null!=o.name&&(e.searchTerm=o.name)}const o=e.toArray().map(((o,n)=>{const r=e.length,i=n>1&&null==o.geometry,s={[L.radioUnchecked]:n>=0&&n<r-1,[L.radioChecked]:n===r-1},a={[O.lastStopIconContainer]:n===r-1},l={[O.validStopRow]:!i},c=e.at(n+1),u=n===r-1,d=n===r-2,p=2===r&&0===n||r>2&&!u&&!d||r>2&&d&&null!=c?.geometry||r>2&&u&&null==o.geometry,h=r<3,m=this.acquireSearch(o),{messages:v}=this,{removeStop:g,reverseStops:f,unlocated:_}=v,b=null!=o.geometry&&null!=o.name?o.name:_,y=$(n+1),S=`${v.stopLabel} ${y} (${b})`,w=`${this.id}__stop--${n}`,j=!!m.searchTerm&&!!m.selectedResult&&null!=o.geometry&&m.selectedResult.name===o.name,k={zIndex:"none"!==m.activeMenu?""+t--:""};return M("li",{afterCreate:this._handleStopFieldCreation,"aria-label":S,bind:this,class:this.classes(O.stopRow,l),"data-stop-index":n,id:w,key:n,styles:k},M("div",{class:O.stopHandle},M("span",{"aria-hidden":"true",class:this.classes(O.stopIcon,L.handleVertical,O.stopHandleIcon,O.interactiveStopIcon),onpointerdown:this._handleDragHandlePointerDown}),M("div",{"aria-labelledby":w,bind:this,class:this.classes(O.stopIconContainer,a),"data-stop-index":n,onclick:this._handleStopIconClick,onkeydown:this._handleStopIconClick,role:"button"},M("span",{class:this.classes(O.stopIcon,s),tabIndex:j?0:void 0}))),M("div",{class:O.stopInput},m.render()),M("div",{class:O.stopOptions,role:"group"},M("div",{"aria-label":g,bind:this,class:O.removeStopButton,"data-stop-index":n,hidden:h,onclick:this._handleRemoveStop,onkeydown:this._handleRemoveStop,role:"button",tabIndex:0,title:g},M("span",{"aria-hidden":"true",class:this.classes(O.stopIcon,O.removeStop,L.trash,O.interactiveStopIcon)}),M("span",{class:L.fontFallbackText},"removeStopTitle")),M("div",{"aria-label":f,bind:this,class:O.reverseStops,hidden:p,onclick:this._handleReverseStops,onkeydown:this._handleReverseStops,role:"button",tabIndex:0,title:f},M("span",{"aria-hidden":"true",class:this.classes(O.stopIcon,L.upDownArrows,O.interactiveStopIcon)}),M("span",{class:L.fontFallbackText},"removeStopTitle"))))})),n=this._renderAddStop();return M("div",null,M("ol",{afterCreate:this._setUpDragAndDropStops,class:O.stops,role:"group"},o),n)}_renderAddStop(){const e=this.viewModel.layer?.stops;if(!e)return null;const t=e.filter((({geometry:e})=>null!=e)),o=e.at(-1);return t.length>1&&t.length<this.maxStops&&null!=o?.geometry?M("div",{class:O.toolbarSection},M("div",{class:O.toolbarButtons},M("calcite-button",{appearance:"outline",class:O.addStopButton,iconStart:"plus",key:O.addStopButton,kind:"neutral",label:this.messages.addStop,onclick:()=>{this._addNewPlaceholder()},round:!0,scale:"s",width:"full"},this.messages.addStop))):null}_handleStopIconClick(e){const t=qt(e.currentTarget),o=null!=t?this.viewModel.layer?.stops.at(t):void 0;o?.geometry&&this._centerAtStop(o)}_handleClearRouteClick(){this.viewModel.reset()}_centerAtStop(e){this.viewModel.centerAt(e)}_handleStopFieldCreation(e){const t=this._newPlaceholderStop;if(!t)return;const o=qt(e),n=null!=o?this.viewModel.layer?.stops.at(o):void 0;if(t===n){const e=this.acquireSearch(n);e.when((()=>{this.renderNow(),e.focus()}))}this._newPlaceholderStop=null}_handleStopInputBlur(e,t){if(this._saveLayer.opened)return;if(this.removeHandles(Xt),e.selectedResult&&null!=t.geometry&&null!=e.selectedResult?.feature.geometry&&t.geometry===e.selectedResult?.feature.geometry)return void this._pointerDownUpHandle?.pause();const o=null==t.geometry&&null==e.selectedResult?.feature.geometry,n=null!=t.geometry&&null!=e.selectedResult?.feature.geometry&&t.geometry!==e.selectedResult?.feature.geometry;if((o||n)&&"none"===e.activeMenu&&e.searchTerm)return e.search(),void this._pointerDownUpHandle?.pause();e.searchTerm||(this._viewClickHandle?.resume(),clearTimeout(this._autoStopRemovalTimeoutId),this._autoStopRemovalTimeoutId=setTimeout((()=>{this.destroyed||(this._viewClickHandle?.pause(),"searching"!==e.viewModel.state?this._pointerPressedSearchSuggestionStop||(null!=t.geometry&&(t.geometry=null,this._solveRoute()),this.scheduleRender()):this._pointerDownUpHandle?.pause())}),this._autoStopRemovalDelay))}_handleStopInputFocus(e,t){this._pointerDownUpHandle?.resume();const{view:o}=this;if(this.hasHandles(Xt)||!o)return;const n=o.cursor;this.addHandles([r((()=>{o.cursor=n})),s((()=>e.searchTerm),(t=>{e.destroyed||(o.cursor=t.length?n:"copy")}),a)],Xt),this._activeStop=t}_prepViewClick(){const{view:e}=this.viewModel;i(e),i(e.surface);const t=n(e,"click",this._handleViewClick.bind(this)),o=n(e.surface,"click",(()=>{clearTimeout(this._autoStopRemovalTimeoutId),o.pause()}));return{remove(){o.remove(),t.remove()},pause(){o.pause(),t.pause()},resume(){o.resume(),t.resume()}}}_prepPointerDownUpClick(){const e=n(document,"pointerdown",(e=>{this._pointerPressedSearchSuggestionStop=zt(e)?this._activeStop:null})),t=n(document,"pointerup",(e=>{this._pointerDownUpHandle?.pause();const t=zt(e),o=this._activeStop;t||o!==this._pointerPressedSearchSuggestionStop||this._removeStop(o),this.scheduleRender(),this._pointerPressedSearchSuggestionStop=t?o:null}));return{remove(){t.remove(),e.remove()},pause(){t.pause(),e.pause()},resume(){e.resume()}}}_handleViewClick(e){e.stopPropagation();const t=this._activeStop,o=t?this._stopsToSearches.get(t):null;t&&o&&!o.searchTerm&&(o.search(e.mapPoint).then((e=>{const n=e?.results[0].results;if(!n)return;const{feature:r,name:i}=n[0];t.geometry=r.geometry,t.name=i,o.searchTerm=i})),this.scheduleRender()),this._viewClickHandle?.pause(),clearTimeout(this._autoStopRemovalTimeoutId)}_addNewPlaceholder(){if(this._pointerDownUpHandle?.pause(),this._newPlaceholderStop)return;const e=new v({symbol:new g});this.viewModel.layer?.stops.add(e),this._newPlaceholderStop=e}_handleReverseStops(){this._reverseStops()}_reverseStops(){const e=this.viewModel.layer?.stops??[];e.reverse();for(const t of e)t.sequence=null;this._solveRoute()}_handleRemoveStop(e){const{layer:t}=this.viewModel;if(!t)return;const o=qt(e.currentTarget);if(null==o)return;const{stops:n,routeInfo:r}=t,i=n.at(o);this._removeStop(i),null==i.geometry&&null!=r||this._solveRoute()}_removeStop(e){const{stops:t}=this.viewModel.layer;!e||t.length<=2||(this._disposeSearch(e),t.remove(e))}_handleDepartureOptionChange(e){const t=e.currentTarget,o=t.item(t.selectedIndex);this.viewModel.departureOption=o.value,this._solveRoute()}_renderTimeControls(){return this.viewModel.departureIsoDate&&this.viewModel.departureIsoTime?M("div",{class:O.departureTimeControls,key:O.departureTimeControls,role:"group"},M("div",{class:O.departureDateTimePickers},M("calcite-input-date-picker",{valueAsDate:Yt(this.viewModel.departureIsoDate),onCalciteInputDatePickerChange:({target:e})=>{this.viewModel.departureIsoDate=e.value,this._solveRoute()}}),M("calcite-input-time-picker",{value:this.viewModel.departureIsoTime,onCalciteInputTimePickerChange:({target:e})=>{this.viewModel.departureIsoTime=e.value,this._solveRoute()}}))):null}_renderSectionSplitter(){return M("div",{class:O.sectionSplitter})}_renderSaveContainer(){const{saveButton:e,saveAsButton:t,printButton:o,layerDetails:n}=this.visibleElements;return e||t||o||n?M("div",{class:O.saveSection,key:O.saveSection},this._renderSaveButtons(),this._renderRouteLayerDetailsLink()):null}_renderSaveButtons(){const{saveButton:e,saveAsButton:t,printButton:o}=this.visibleElements;return e||t||o?M("div",{class:O.saveButtons,key:O.saveButtons},this._renderSaveButton(),this._renderSaveAsButton(),this._renderPrintButton()):null}_renderSaveButton(){if(!this.visibleElements.saveButton)return null;const{portalItem:e,routeInfo:t}=this.viewModel.layer,o=e?.itemControl;return M("calcite-button",{appearance:"outline",class:O.saveButton,disabled:!(null!=t&&("admin"===o||"update"===o)),iconStart:"save",key:O.saveButton,label:this.messagesCommon.save,onclick:()=>{this._handleSaveButtonClick()},width:"full"},this.messagesCommon.save)}_renderSaveAsButton(){if(!this.visibleElements.saveAsButton)return null;const e=null==this.viewModel.layer.routeInfo;return M("div",{class:O.saveAsButtonPopover,key:O.saveAsButtonPopover},M("calcite-button",{afterCreate:e=>{this._saveAsButtonNode=e},appearance:"outline",class:O.saveAsButton,disabled:e,iconStart:"duplicate",key:O.saveAsButton,label:this.messagesCommon.saveAs,onclick:()=>this._handleSaveAsButtonClick(),width:"full"},this.messagesCommon.saveAs))}_renderSavePopover(){return M("calcite-popover",{class:O.savePopover,label:this._saveLayer.label,open:this._saveLayer.opened,overlayPositioning:"fixed",referenceElement:this._saveAsButtonNode,triggerDisabled:!0},this._saveLayer.render())}_handleSaveAsButtonClick(){this._saveLayer.opened?this._saveLayer.close():this._saveLayer.open(this.viewModel.layer)}_renderPrintButton(){return this.visibleElements.printButton?M("calcite-button",{appearance:"outline",class:O.printButton,iconStart:"print",key:O.printButton,label:this.messagesCommon.print}):null}_renderRouteLayerDetailsLink(){if(!this.visibleElements.layerDetails)return null;const{portalItem:e}=this.viewModel.layer;if(!e)return null;const{id:t,portal:{url:o}}=e;return M("calcite-link",{class:O.layerDetailsLink,href:`${o}/home/item.html?id=${t}`,key:O.layerDetailsLink,target:"_blank"},this.messages.viewLayerDetails)}_handleSaveButtonClick(){this.viewModel.layer.save()}_renderDirectionsContainer(){return M("div",{class:this.classes(O.directionsSection,O.section),key:"esri-directions__container"},this._renderDirectionsContainerContent())}_renderLoader(){return M("div",{class:O.loader,key:"loader"})}_renderWarningCard(){return M("div",{class:O.warningCard,role:"alert"},M("div",{class:O.warningHeader},M("span",{"aria-hidden":"true",class:L.noticeTriangle}),M(P,{class:O.warningHeading,level:this.headingLevel},this.messagesCommon.warning)),M("div",{class:O.warningMessage},this._getErrorMessage()))}_renderDirectionsContainerContent(){const{layer:e,state:t}=this.viewModel,o="routing"===t;return"error"===t?this._renderWarningCard():o?this._renderLoader():null!=e.directionLines?M("div",{"aria-disabled":this._saveLayer.opened.toString(),class:this.classes(O.summary,this._saveLayer.opened&&I.buttonDisabled),key:O.summary,role:"group"},this._renderCosts(),this._renderRouteActions(),this._renderManeuverSections()):M("div",{class:I.empty,key:"esri-directions__placeholder"},this._renderPlaceholder(),M(P,{class:O.message,level:this.headingLevel},this.messages.directionsPlaceholder))}_renderPlaceholder(){return M("svg",{class:I.emptyIllustration,viewBox:"0 0 256 256",xmlns:"http://www.w3.org/2000/svg"},M("path",{d:"M192 36c-15.477 0-24 6.034-24 16.99v45.822l24 24 24-24v-45.82C216 42.033 207.477 36 192 36zm20 61.155l-20 20-20-20V52.99c0-8.62 6.73-12.99 20-12.99s20 4.37 20 12.99zM192 52a12 12 0 1 0 12 12 12.013 12.013 0 0 0-12-12zm0 20a8 8 0 1 1 8-8 8.008 8.008 0 0 1-8 8zM92 140.99C92 130.035 83.477 124 68 124s-24 6.034-24 16.99v45.822l24 24 24-24zm-4 44.165l-20 20-20-20V140.99c0-8.62 6.73-12.99 20-12.99s20 4.37 20 12.99zM68 140a12 12 0 1 0 12 12 12.013 12.013 0 0 0-12-12zm0 20a8 8 0 1 1 8-8 8.008 8.008 0 0 1-8 8zm84-44h16v4h-16zm-24 80h4v12h-12v-4h8zm0-28h4v16h-4zm0-52h12v4h-8v8h-4zm0 24h4v16h-4zm-36 64h16v4H92z",fill:"currentcolor"}))}_renderMessage(e){return M(P,{class:O.messageHeading,level:this.headingLevel},e)}_renderRouteActions(){return M("div",{class:O.routeActions},M("button",{"aria-label":this.messages.clearRoute,bind:this,class:this.classes(O.clearRouteButton,I.button,I.buttonTertiary),onclick:this._handleClearRouteClick,tabIndex:0,type:"button"},this.messages.clearRoute))}_getSections(){const{layer:e}=this.viewModel;if(!e)return null;const{directionPoints:t,directionLines:o,stops:n}=e;if(null==t||null==o)return null;const r=[];let i=null;for(const e of t){const{objectId:t,stopId:s}=e;if(null!=s){const e=n.find((({objectId:e})=>e===s)),t=0===r.length;null!=i&&i.stop===e||(i={stop:e,directions:[],open:t},r.push(i));continue}if(null==i)continue;const a=o.find((({directionPointId:e})=>e===t));null!=a&&i.directions.push({directionPoint:e,directionLine:a})}return r}_renderManeuverSections(){return null==this._sections?null:M("div",{class:O.maneuvers,role:"group"},this._sections.map(((e,t)=>{const{open:o}=e;let n;e.directions.length>0&&o&&(n=M("ol",{class:O.maneuverList},e.directions.map((e=>this._renderManeuver(e)))));const r=this._sections.length>2,i=t===this._sections.length-1,s={[O.collapsibleSection]:r},a={[L.down]:!o,[L.up]:o};let l;if(r&&!i){const t=o?this.messagesCommon.close:this.messagesCommon.open;l=M("header",{class:this.classes(O.maneuverSectionHeader,O.maneuverSectionToggle),key:O.maneuverSectionHeader},M("div",{"aria-expanded":o.toString(),"aria-label":t,bind:this,class:O.maneuverSectionHeaderButton,"data-maneuver-section":e,onclick:this._handleSectionToggle,onkeydown:this._handleSectionToggle,role:"button",tabIndex:0,title:t},M(P,{class:O.maneuverSectionTitle,level:this.headingLevel},e.stop.name),M("span",{"aria-hidden":"true",class:this.classes(a)})))}else l=M("header",{class:O.maneuverSectionHeader,key:O.maneuverSectionHeader},M(P,{class:O.maneuverSectionTitle,level:this.headingLevel},e.stop.name));return M("section",{class:this.classes(O.maneuverSection,s),key:t},l,n)})))}_handleSectionToggle(e){const t=(o=e.currentTarget,o?.["data-maneuver-section"]);var o;t&&(t.open=!t.open)}_renderCosts(){const e=this._getCostSummary(),{directionPoints:t}=this.viewModel.layer;if(null==t||null==e)return null;const{distance:o,duration:n}=e,{primaryCosts:r,secondaryCosts:i,zoomToRoute:s}=this.messages,a=this._renderEta();return M("div",{"aria-label":s,bind:this,class:O.directionCosts,onclick:this._handleSummaryInteraction,onkeydown:this._handleSummaryInteraction,role:"button",tabIndex:0,title:s},M("div",{class:O.costsDetails,role:"group"},M("div",{class:O.primaryCosts,title:r},n),M("div",{class:O.verticalSplitter}),M("div",{class:O.secondaryCosts,title:i},o)),a)}_renderEta(){return this.viewModel.departureOption===S.UNSPECIFIED?null:M("div",{class:O.arrivalTimeContainer,title:this.messages.eta},M("span",{class:O.arrivalTime},this.viewModel.formattedEta))}_handleSummaryInteraction(){this._activeManeuver=null,this._focusedManeuver=null,this.viewModel.clearHighlights(),this.zoomToRoute()}_getErrorMessage(){switch(this.viewModel.lastError?.name){case"directions-view-model:unable-to-route":return this.messages.errors.unableToRoute;case"directions-view-model:service-metadata-unavailable":return this.messages.errors.unableToLoadServiceMetadata;default:return this.messages.errors.unknownError}}_normalizeSearchSources(e){this._overrideDefaultSources(e),this._applyLocatorSourceOverrides(e)}_overrideDefaultSources(e){e.viewModel.defaultSources.forEach((e=>{e.autoNavigate=!1}))}_applyLocatorSourceOverrides({allSources:e}){for(const t of e)"url"in t&&t.url&&(t.locationType??="street",T(t.url)&&this.apiKey&&null==t.apiKey&&(t.apiKey=this.apiKey,t.url=E))}_disposeSearch(e){if(!e||!this._stopsToSearches.has(e))return;const t=this._stopsToSearches.get(e);this.removeHandles(t),t.destroy(),this._stopsToSearches.delete(e)}_renderManeuver(e){const{directionPoint:t,directionLine:o}=e,{distance:n,duration:r}=o,{messages:i,messagesUnits:s,unit:a}=this,l=w(s,n??0,a),c=j(r??0),d=l&&c?`${l}&nbsp;&middot;&nbsp;${c}`:`${l}${c}`,p=function(e){const{branchName:t,displayText:o,exitName:n,intersectingName:r,name:i,objectId:s,towardName:a}=e;if(null==o)return null;const l=[t,n,r,i,a].filter(Boolean).sort(((e,t)=>t.length-e.length)).map((e=>u(e)));if(!l.length)return o;const c=new RegExp(l.join("|"),"g"),d=o.matchAll(c);let p=0;const h=[];for(const{0:e,index:t}of d)h.push(o.slice(p,t),M("span",{class:O.maneuverPlaceName},e)),p=t+e.length;return h.push(o.slice(p)),M("span",{id:`${O.maneuver}-${s}`},h)}(t),{objectId:h,directionPointType:m}=t,v=k(m),g=`${O.maneuver}-${h}`,f=`${O.intermediateCost}-${h}`,_={[O.maneuverActive]:this._activeManeuver===o};return M("li",{"aria-labelledby":`${g} ${f}`,bind:this,class:this.classes(O.maneuver,_),"data-maneuver":o,key:o,onblur:this._handleManeuverBlur,onclick:this._handleManeuverClick,onfocus:this._handleManeuverFocus,onkeydown:this._handleManeuverClick,onmouseout:this._handleManeuverMouseOut,onmouseover:this._handleManeuverMouseOver,tabIndex:0},M("calcite-icon",{alt:"",class:O.maneuverIcon,icon:v}),M("div",{class:O.maneuverCostsContainer},p,M("div",{class:O.maneuverCosts},M("div",{class:O.horizontalSplitter}),M("div",{"aria-hidden":"true",class:O.intermediateCost,id:f,innerHTML:d,title:i.intermediateCosts}))))}_handleManeuverClick(e){const t=Gt(e.currentTarget);if(!t)return;if(this._activeManeuver===t)return this._activeManeuver=null,void this.zoomToRoute();this._activeManeuver=t;const{geometry:o}=t;this.viewModel.centerAt(o),this.viewModel.highlight(t)}_handleManeuverMouseOver(e){if(this._activeManeuver||this._focusedManeuver)return;const t=Gt(e.currentTarget);t&&this.viewModel.highlight(t)}_handleManeuverMouseOut(){this._activeManeuver||this._focusedManeuver||this.viewModel.clearHighlights()}_handleManeuverBlur(){this._activeManeuver||(this._focusedManeuver=null,this.viewModel.clearHighlights())}_handleManeuverFocus(e){if(this._activeManeuver)return;const t=Gt(e.currentTarget);t&&(this._focusedManeuver=t,this.viewModel.highlight(t))}_getCostSummary(){const{messagesUnits:e,unit:t,viewModel:o}=this,{routeInfo:n}=o.layer;if(null==n)return null;const r=n.totalDistance??0,i=n.totalDuration??0;return{distance:w(e,r,t),duration:j(i)}}async _solveRoute(){this.viewModel.updateDepartureTime();const e=this.viewModel.layer?.stops.filter((({geometry:e})=>null!=e));if(e&&!(e.length<2))try{await this.viewModel.getDirections()}catch{}}};e([d()],Wt.prototype,"apiKey",null),e([d(m)],Wt.prototype,"defaultUnit",void 0),e([d()],Wt.prototype,"goToOverride",null),e([d()],Wt.prototype,"headingLevel",void 0),e([d()],Wt.prototype,"icon",null),e([d()],Wt.prototype,"label",null),e([d({readOnly:!0})],Wt.prototype,"lastRoute",null),e([d()],Wt.prototype,"layer",null),e([d()],Wt.prototype,"maxStops",null),e([d(),D("esri/widgets/Directions/t9n/Directions")],Wt.prototype,"messages",void 0),e([d(),D("esri/t9n/common")],Wt.prototype,"messagesCommon",void 0),e([d(),D("esri/core/t9n/Units")],Wt.prototype,"messagesUnits",void 0),e([d()],Wt.prototype,"searchProperties",void 0),e([d()],Wt.prototype,"unit",null),e([d()],Wt.prototype,"view",null),e([d({type:y})],Wt.prototype,"viewModel",void 0),e([d()],Wt.prototype,"visibleElements",void 0),e([p("visibleElements")],Wt.prototype,"castVisibleElements",null),e([R()],Wt.prototype,"_handleStopIconClick",null),e([R()],Wt.prototype,"_handleClearRouteClick",null),e([R()],Wt.prototype,"_handleReverseStops",null),e([R()],Wt.prototype,"_handleRemoveStop",null),e([R()],Wt.prototype,"_handleSectionToggle",null),e([R()],Wt.prototype,"_handleSummaryInteraction",null),e([R()],Wt.prototype,"_handleManeuverClick",null),Wt=e([h("esri.widgets.Directions")],Wt);const Vt=Wt;function qt(e){return e?.["data-stop-index"]}function Gt(e){return e?.["data-maneuver"]}export{Vt as default};

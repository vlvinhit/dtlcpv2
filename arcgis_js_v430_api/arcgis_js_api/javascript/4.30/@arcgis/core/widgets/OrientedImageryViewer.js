/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.30/esri/copyright.txt for details.
*/
import{_ as e}from"../chunks/tslib.es6.js";import"../intl.js";import{p as t}from"../chunks/a11yUtils.js";import s,{d as i}from"../core/Accessor.js";import{L as r}from"../chunks/Logger.js";import{d as o}from"../chunks/mathUtils.js";import{watch as n,initial as a}from"../core/reactiveUtils.js";import{property as p}from"../core/accessorSupport/decorators/property.js";import"../core/lang.js";import{subclass as l}from"../core/accessorSupport/decorators/subclass.js";import m,{r as c,g as u,s as h,h as j,n as d,i as g,j as y,k,l as v,m as b}from"./OrientedImageryViewer/OrientedImageryViewerViewModel.js";import{R as f}from"../layers/ImageryTileLayer.js";import I,{l as w}from"./Widget.js";import{g as M}from"../chunks/globalCss.js";import"../chunks/widgetUtils.js";import{m as S}from"../chunks/messageBundle.js";import{t as C}from"../chunks/jsxFactory.js";import{s as T}from"../chunks/substitute.js";import"../chunks/date.js";import"../chunks/jsonMap.js";import"../config.js";import"../chunks/locale.js";import"../chunks/handleUtils.js";import"../chunks/timeZoneUtils.js";import"../chunks/datetime.js";import"../chunks/number.js";import"../chunks/messages.js";import"../core/Error.js";import"../core/promiseUtils.js";import"../chunks/maybe.js";import"../request.js";import"../kernel.js";import"../core/urlUtils.js";import"../core/JSONSupport.js";import"../chunks/utils.js";import"../core/Handles.js";import"../chunks/metadata.js";import"../chunks/tracking.js";import"../chunks/ensureType.js";import"../chunks/ObservableBase.js";import"../core/scheduling.js";import"../chunks/assets.js";import"../chunks/vec3.js";import"../chunks/vec3f64.js";import"../chunks/common.js";import"../chunks/asyncUtils.js";import"../core/Collection.js";import"../core/Evented.js";import"../chunks/shared.js";import"../chunks/SimpleObservable.js";import"../geometry.js";import"../geometry/Extent.js";import"../geometry/Geometry.js";import"../chunks/reader.js";import"../geometry/SpatialReference.js";import"../chunks/unitUtils.js";import"../chunks/writer.js";import"../geometry/Point.js";import"../core/accessorSupport/decorators/cast.js";import"../geometry/support/webMercatorUtils.js";import"../geometry/Multipoint.js";import"../chunks/zmUtils.js";import"../geometry/Polygon.js";import"../chunks/coordsUtils.js";import"../chunks/Axis.js";import"../chunks/extentUtils.js";import"../chunks/aaBoundingRect.js";import"../geometry/Polyline.js";import"../chunks/typeUtils.js";import"../geometry/support/jsonUtils.js";import"../Graphic.js";import"../PopupTemplate.js";import"../core/Clonable.js";import"../layers/support/fieldUtils.js";import"../core/sql.js";import"../popup/content.js";import"../popup/content/AttachmentsContent.js";import"../popup/content/Content.js";import"../popup/content/CustomContent.js";import"../popup/content/ExpressionContent.js";import"../popup/ElementExpressionInfo.js";import"../popup/content/FieldsContent.js";import"../popup/FieldInfo.js";import"../chunks/enumeration.js";import"../popup/support/FieldInfoFormat.js";import"../popup/content/MediaContent.js";import"../popup/content/BarChartMediaInfo.js";import"../popup/content/mixins/ChartMediaInfo.js";import"../popup/content/mixins/MediaInfo.js";import"../popup/content/support/ChartMediaInfoValue.js";import"../Color.js";import"../chunks/colorUtils.js";import"../popup/content/support/ChartMediaInfoValueSeries.js";import"../chunks/chartMediaInfoUtils.js";import"../popup/content/ColumnChartMediaInfo.js";import"../popup/content/ImageMediaInfo.js";import"../popup/content/support/ImageMediaInfoValue.js";import"../popup/content/LineChartMediaInfo.js";import"../popup/content/PieChartMediaInfo.js";import"../popup/content/RelationshipContent.js";import"../popup/support/RelatedRecordsInfoFieldOrder.js";import"../popup/content/TextContent.js";import"../popup/ExpressionInfo.js";import"../popup/LayerOptions.js";import"../popup/RelatedRecordsInfo.js";import"../support/actions/ActionBase.js";import"../core/Identifiable.js";import"../support/actions/ActionButton.js";import"../support/actions/ActionToggle.js";import"../symbols.js";import"../symbols/CIMSymbol.js";import"../symbols/Symbol.js";import"../symbols/ExtrudeSymbol3DLayer.js";import"../symbols/Symbol3DLayer.js";import"../chunks/utils4.js";import"../symbols/edges/Edges3D.js";import"../chunks/screenUtils.js";import"../chunks/materialUtils.js";import"../chunks/opacityUtils.js";import"../symbols/edges/SketchEdges3D.js";import"../symbols/edges/SolidEdges3D.js";import"../chunks/Symbol3DMaterial.js";import"../symbols/FillSymbol.js";import"../symbols/SimpleLineSymbol.js";import"../symbols/LineSymbol.js";import"../symbols/LineSymbolMarker.js";import"../chunks/lineMarkers.js";import"../symbols/FillSymbol3DLayer.js";import"../symbols/patterns/LineStylePattern3D.js";import"../symbols/patterns/StylePattern3D.js";import"../chunks/utils5.js";import"../chunks/colors.js";import"../chunks/symbolLayerUtils3D.js";import"../chunks/aaBoundingBox.js";import"../symbols/Font.js";import"../symbols/IconSymbol3DLayer.js";import"../chunks/persistableUrlUtils.js";import"../symbols/LabelSymbol3D.js";import"../symbols/Symbol3D.js";import"../chunks/collectionUtils.js";import"../portal/Portal.js";import"../core/Loadable.js";import"../core/Promise.js";import"../portal/PortalGroup.js";import"../portal/PortalQueryParams.js";import"../portal/PortalQueryResult.js";import"../portal/PortalUser.js";import"../portal/PortalFolder.js";import"../symbols/LineSymbol3DLayer.js";import"../symbols/LineStyleMarker3D.js";import"../symbols/ObjectSymbol3DLayer.js";import"../symbols/PathSymbol3DLayer.js";import"../symbols/TextSymbol3DLayer.js";import"../symbols/WaterSymbol3DLayer.js";import"../symbols/support/StyleOrigin.js";import"../chunks/Thumbnail.js";import"../chunks/calloutUtils.js";import"../symbols/callouts/Callout3D.js";import"../symbols/callouts/LineCallout3D.js";import"../symbols/support/Symbol3DVerticalOffset.js";import"../symbols/LineSymbol3D.js";import"../symbols/MarkerSymbol.js";import"../symbols/MeshSymbol3D.js";import"../symbols/PictureFillSymbol.js";import"../chunks/urlUtils.js";import"../symbols/PictureMarkerSymbol.js";import"../symbols/PointSymbol3D.js";import"../symbols/PolygonSymbol3D.js";import"../symbols/SimpleFillSymbol.js";import"../symbols/SimpleMarkerSymbol.js";import"../symbols/TextSymbol.js";import"../symbols/WebStyleSymbol.js";import"../layers/GraphicsLayer.js";import"../chunks/GraphicsCollection.js";import"../layers/Layer.js";import"../TimeExtent.js";import"../chunks/timeUtils.js";import"../layers/mixins/BlendLayer.js";import"../chunks/jsonUtils.js";import"../chunks/parser.js";import"../chunks/utils3.js";import"../chunks/mat4.js";import"../chunks/_commonjsHelpers.js";import"../layers/mixins/ScaleRangeLayer.js";import"../chunks/ElevationInfo.js";import"../chunks/unitConversionUtils.js";import"../chunks/lengthUtils.js";import"../layers/OrientedImageryLayer.js";import"../layers/FeatureLayer.js";import"../renderers/ClassBreaksRenderer.js";import"../renderers/Renderer.js";import"../renderers/support/AuthoringInfo.js";import"../renderers/support/AuthoringInfoVisualVariable.js";import"../chunks/colorRamps.js";import"../rest/support/AlgorithmicColorRamp.js";import"../rest/support/ColorRamp.js";import"../rest/support/MultipartColorRamp.js";import"../renderers/mixins/VisualVariablesMixin.js";import"../renderers/visualVariables/ColorVariable.js";import"../renderers/visualVariables/VisualVariable.js";import"../chunks/LegendOptions.js";import"../renderers/visualVariables/support/ColorStop.js";import"../renderers/visualVariables/OpacityVariable.js";import"../renderers/visualVariables/support/OpacityStop.js";import"../renderers/visualVariables/RotationVariable.js";import"../renderers/visualVariables/SizeVariable.js";import"../renderers/visualVariables/support/SizeStop.js";import"../chunks/sizeVariableUtils.js";import"../chunks/visualVariableUtils.js";import"../chunks/compilerUtils.js";import"../renderers/support/ClassBreakInfo.js";import"../chunks/commonProperties.js";import"../symbols/support/jsonUtils.js";import"../chunks/layerUtils2.js";import"../chunks/defaults.js";import"../chunks/defaultsJSON.js";import"../renderers/DictionaryRenderer.js";import"../chunks/LRUCache.js";import"../chunks/MemCache.js";import"../chunks/Version.js";import"../layers/support/FieldsIndex.js";import"../chunks/UnknownTimeZone.js";import"../chunks/OverrideHelper.js";import"../chunks/colorUtils2.js";import"../chunks/vec4.js";import"../chunks/vec4f64.js";import"../chunks/utils7.js";import"../chunks/quantizationUtils.js";import"../renderers/DotDensityRenderer.js";import"../renderers/support/AttributeColorInfo.js";import"../renderers/HeatmapRenderer.js";import"../renderers/support/HeatmapColorStop.js";import"../chunks/heatmapUtils.js";import"../renderers/PieChartRenderer.js";import"../renderers/SimpleRenderer.js";import"../renderers/UniqueValueRenderer.js";import"../chunks/diffUtils.js";import"../renderers/support/UniqueValue.js";import"../renderers/support/UniqueValueClass.js";import"../renderers/support/UniqueValueGroup.js";import"../renderers/support/UniqueValueInfo.js";import"../chunks/styleUtils.js";import"../renderers/support/jsonUtils.js";import"../chunks/MultiOriginJSONSupport.js";import"../chunks/layerContainerType.js";import"../form/FormTemplate.js";import"../form/ExpressionInfo.js";import"../form/elements/GroupElement.js";import"../form/elements/Element.js";import"../form/support/elements.js";import"../form/elements/FieldElement.js";import"../form/elements/support/inputs.js";import"../form/elements/inputs/BarcodeScannerInput.js";import"../form/elements/inputs/TextInput.js";import"../form/elements/inputs/Input.js";import"../form/elements/inputs/ComboBoxInput.js";import"../form/elements/inputs/DatePickerInput.js";import"../form/elements/inputs/DateTimeOffsetPickerInput.js";import"../form/elements/inputs/DateTimePickerInput.js";import"../form/elements/inputs/RadioButtonsInput.js";import"../form/elements/inputs/SwitchInput.js";import"../form/elements/inputs/TextAreaInput.js";import"../form/elements/inputs/TextBoxInput.js";import"../form/elements/inputs/TimePickerInput.js";import"../chunks/domains.js";import"../layers/support/CodedValueDomain.js";import"../layers/support/Domain.js";import"../layers/support/InheritedDomain.js";import"../layers/support/RangeDomain.js";import"../form/elements/RelationshipElement.js";import"../form/elements/TextElement.js";import"../chunks/formUtils.js";import"../core/workers/workers.js";import"../core/workers/Connection.js";import"../chunks/Queue.js";import"../core/workers/RemoteClient.js";import"../chunks/editsZScale.js";import"../chunks/queryZScale.js";import"../chunks/zscale.js";import"../rest/support/FeatureSet.js";import"../layers/support/Field.js";import"../chunks/fieldType.js";import"../layers/mixins/APIKeyMixin.js";import"../chunks/ArcGISService.js";import"../chunks/arcgisLayerUrl.js";import"../layers/mixins/CustomParametersMixin.js";import"../chunks/EditBusLayer.js";import"../chunks/uuid.js";import"../layers/mixins/FeatureEffectLayer.js";import"../layers/support/FeatureEffect.js";import"../layers/support/FeatureFilter.js";import"../rest/support/Query.js";import"../chunks/DataLayerSource.js";import"../chunks/FullTextSearch.js";import"../chunks/spatialRelationships.js";import"../rest/support/StatisticDefinition.js";import"../layers/mixins/FeatureLayerBase.js";import"../geometry/HeightModelInfo.js";import"../chunks/commonProperties2.js";import"../chunks/featureLayerUtils.js";import"../chunks/featureQueryAll.js";import"../rest/support/AttachmentQuery.js";import"../rest/support/RelationshipQuery.js";import"../layers/support/GeometryFieldsInfo.js";import"../layers/support/LayerFloorInfo.js";import"../layers/support/Relationship.js";import"../chunks/serviceCapabilitiesUtils.js";import"../layers/support/Subtype.js";import"../layers/mixins/FeatureReductionLayer.js";import"../layers/support/AggregateField.js";import"../layers/support/ExpressionInfo.js";import"../chunks/FeatureReduction.js";import"../layers/support/FeatureReductionBinning.js";import"../layers/support/LabelClass.js";import"../chunks/labelUtils.js";import"../layers/support/FeatureReductionCluster.js";import"../layers/support/FeatureReductionSelection.js";import"../chunks/clusterUtils.js";import"../chunks/MD5.js";import"../layers/mixins/OperationalLayer.js";import"../layers/mixins/OrderedLayer.js";import"../chunks/OrderByInfo.js";import"../layers/mixins/PortalLayer.js";import"../portal/PortalItem.js";import"../portal/PortalItemResource.js";import"../portal/PortalRating.js";import"../chunks/portalItemUtils.js";import"../geometry/projection.js";import"../chunks/projectBuffer.js";import"../chunks/geodesicConstants.js";import"../geometry/support/GeographicTransformation.js";import"../geometry/support/GeographicTransformationStep.js";import"../layers/mixins/PublishableLayer.js";import"../layers/support/PublishingInfo.js";import"../layers/mixins/RefreshableLayer.js";import"../layers/mixins/TemporalLayer.js";import"../TimeInterval.js";import"../layers/support/TimeInfo.js";import"../layers/support/FeatureTemplate.js";import"../layers/support/FeatureType.js";import"../chunks/fieldProperties.js";import"../chunks/labelingInfo.js";import"../chunks/versionUtils.js";import"../chunks/styleUtils2.js";import"../rest/support/TopFeaturesQuery.js";import"../rest/support/TopFilter.js";import"../support/popupUtils.js";import"../chunks/interfaces2.js";import"../chunks/requestPresets.js";import"../geometry/Circle.js";import"../geometry/support/geodesicUtils.js";import"../geometry/Mesh.js";import"../chunks/axisAngleDegrees.js";import"../chunks/quat.js";import"../chunks/quatf64.js";import"../geometry/support/MeshComponent.js";import"../geometry/support/MeshMaterial.js";import"../geometry/support/MeshTexture.js";import"../chunks/imageUtils.js";import"../geometry/support/MeshTextureTransform.js";import"../geometry/support/MeshMaterialMetallicRoughness.js";import"../chunks/MeshVertexAttributes.js";import"../geometry/support/MeshGeoreferencedVertexSpace.js";import"../geometry/support/MeshLocalVertexSpace.js";import"../geometry/support/MeshTransform.js";import"../chunks/mat4f64.js";import"../chunks/meshVertexSpaceUtils.js";import"../chunks/triangulationUtils.js";import"../chunks/earcut.js";import"../chunks/DoubleArray.js";import"../chunks/Indices.js";import"../chunks/plane.js";import"../chunks/mat3f64.js";import"../chunks/vec2f64.js";import"../chunks/mathUtils2.js";import"../chunks/deduplicate.js";import"../chunks/projection.js";import"../chunks/mat3.js";import"../chunks/spatialReferenceEllipsoidUtils.js";import"../chunks/computeTranslationToOriginAndRotation.js";import"../chunks/BufferView.js";import"../chunks/vec2.js";import"../chunks/vec32.js";import"../chunks/vec42.js";import"../chunks/projectPointToVector.js";import"../chunks/vertexSpaceConversion.js";import"../chunks/External.js";import"../chunks/infoFor3D.js";import"../chunks/lineSegment.js";import"../chunks/ray.js";import"../layers/ElevationLayer.js";import"../layers/mixins/ArcGISCachedService.js";import"../layers/support/TileInfo.js";import"../layers/support/LOD.js";import"../chunks/TileKey.js";import"../chunks/TileInfoTilemapCache.js";import"../chunks/TilemapCache.js";import"../chunks/ByteSizeUnit.js";import"../chunks/LercDecoder.js";import"../chunks/WorkerHandle.js";import"../layers/ImageryLayer.js";import"../layers/mixins/ArcGISImageService.js";import"../rasterRenderers.js";import"../renderers/FlowRenderer.js";import"../renderers/RasterColormapRenderer.js";import"../renderers/support/ColormapInfo.js";import"../chunks/colorRampUtils.js";import"../renderers/RasterShadedReliefRenderer.js";import"../renderers/RasterStretchRenderer.js";import"../chunks/stretchRendererUtils.js";import"../renderers/VectorFieldRenderer.js";import"../geometry/support/normalizeUtils.js";import"../chunks/normalizeUtilsCommon.js";import"../chunks/simplify.js";import"../chunks/utils8.js";import"../chunks/utils9.js";import"../chunks/vectorFieldUtils.js";import"../layers/support/PixelBlock.js";import"../chunks/pixelRangeUtils.js";import"../chunks/utils11.js";import"../symbols/support/cimSymbolUtils.js";import"../layers/support/DimensionalDefinition.js";import"../layers/support/RasterFunction.js";import"../layers/support/MosaicRule.js";import"../chunks/imageBitmapUtils.js";import"../layers/support/MultidimensionalSubset.js";import"../layers/support/RasterInfo.js";import"../layers/support/RasterBandInfo.js";import"../layers/support/RasterSensorInfo.js";import"../chunks/RasterJobHandler.js";import"../chunks/multidimensionalUtils.js";import"../chunks/RasterSymbolizer.js";import"../chunks/stretchUtils.js";import"../chunks/rasterRendererHelper.js";import"../chunks/generateRendererUtils.js";import"../rest/imageService.js";import"../rest/support/FindImagesParameters.js";import"../rest/support/FindImagesResult.js";import"../rest/support/ImageInspectionInfo.js";import"../rest/support/CameraInfoMixin.js";import"../rest/support/ImageAngleParameters.js";import"../rest/support/ImageAngleResult.js";import"../rest/support/ImageAreaParameters.js";import"../rest/support/BaseImageMeasureParameters.js";import"../rest/support/ImageAreaResult.js";import"../rest/support/BaseImageMeasureResult.js";import"../rest/support/ImageBoundaryParameters.js";import"../rest/support/ImageBoundaryResult.js";import"../rest/support/ImageDistanceParameters.js";import"../rest/support/ImageDistanceResult.js";import"../rest/support/ImageGPSInfoParameters.js";import"../rest/support/ImageGPSInfoResult.js";import"../rest/support/CameraInfo.js";import"../rest/support/ImageGPSInfo.js";import"../rest/support/ImageHeightParameters.js";import"../rest/support/ImageHeightResult.js";import"../rest/support/ImageHistogramParameters.js";import"../rest/support/ImageIdentifyParameters.js";import"../rest/support/ImageIdentifyResult.js";import"../rest/support/ImagePixelLocationParameters.js";import"../rest/support/ImagePixelLocationResult.js";import"../rest/support/ImagePointParameters.js";import"../rest/support/ImagePointResult.js";import"../rest/support/ImageSampleParameters.js";import"../rest/support/ImageSampleResult.js";import"../rest/support/ImageSample.js";import"../rest/support/ImageToMapMultirayParameters.js";import"../rest/support/ImageToMapParameters.js";import"../rest/support/ImageUrlParameters.js";import"../rest/support/ImageUrlResult.js";import"../rest/support/MapToImageParameters.js";import"../rest/support/MeasureAreaFromImageResult.js";import"../rest/support/MeasureFromImageParameters.js";import"../rest/support/MeasureLengthFromImageResult.js";import"../chunks/executeQueryJSON.js";import"../chunks/query.js";import"../chunks/pbfQueryUtils.js";import"../chunks/pbf.js";import"../chunks/OptimizedGeometry.js";import"../chunks/OptimizedFeature.js";import"../chunks/OptimizedFeatureSet.js";import"../rest/query/support/AttachmentInfo.js";import"../chunks/executeForIds.js";import"../chunks/fetchRasterInfo.js";import"../chunks/dataUtils.js";import"../layers/support/ElevationSampler.js";import"../chunks/ElevationTile.js";import"../chunks/ElevationSamplerData.js";import"../chunks/sphere.js";import"../chunks/InputManager.js";import"../core/signal.js";import"../Camera.js";import"../CameraLayout.js";import"../chunks/Cyclical.js";import"../views/SceneView.js";import"../Viewpoint.js";import"../chunks/domUtils.js";import"../chunks/projectBoundingRect.js";import"../chunks/boundedPlane.js";import"../chunks/RenderCoordsHelper.js";import"../chunks/projectVectorToPoint.js";import"../chunks/projectVectorToVector.js";import"../chunks/dehydratedPoint.js";import"../chunks/ElevationProvider.js";import"../chunks/ViewingMode.js";import"../chunks/scaleUtils.js";import"../views/View.js";import"../Map.js";import"../Basemap.js";import"../chunks/loadAll.js";import"../support/BasemapStyle.js";import"../chunks/writeUtils.js";import"../Ground.js";import"../chunks/CollectionFlattener.js";import"../chunks/editableLayers.js";import"../layers/catalog/catalogUtils.js";import"../chunks/basemapUtils.js";import"../chunks/collectionUtils2.js";import"../support/LayersMixin.js";import"../support/TablesMixin.js";import"../chunks/UpdatingHandles.js";import"../views/BasemapView.js";import"../views/Magnifier.js";import"../chunks/ReactiveMap.js";import"../chunks/selectionUtils.js";import"../views/Theme.js";import"../chunks/ViewEvents.js";import"../chunks/IViewEvents.js";import"../chunks/interfaces.js";import"../chunks/screenUtils2.js";import"../views/input/Input.js";import"../views/input/gamepad/GamepadSettings.js";import"../views/input/gamepad/GamepadInputDevice.js";import"../views/navigation/Navigation.js";import"../views/navigation/gamepad/GamepadSettings.js";import"../chunks/heightModelInfoUtils.js";import"../chunks/projectionUtils.js";import"../views/BreakpointsOwner.js";import"../views/DOMContainer.js";import"../chunks/projector.js";import"../views/GroundView.js";import"../chunks/cameraUtils.js";import"../chunks/Intersector2.js";import"../chunks/verticalOffsetUtils.js";import"../chunks/orientedBoundingBox.js";import"../chunks/Attribute.js";import"../chunks/earthUtils.js";import"../chunks/spatialReferenceSupport.js";import"../chunks/TerrainConst.js";import"../views/PopupView.js";import"../views/ViewAnimation.js";import"../views/3d/environment/SunLighting.js";import"../webscene/SunLighting.js";import"../views/3d/environment/VirtualLighting.js";import"../webscene/VirtualLighting.js";import"../webscene/Environment.js";import"../views/3d/environment/SunnyWeather.js";import"../chunks/weather.js";import"../views/3d/environment/CloudyWeather.js";import"../views/3d/environment/FoggyWeather.js";import"../views/3d/environment/RainyWeather.js";import"../views/3d/environment/SnowyWeather.js";import"../chunks/lightingTypes.js";import"../webscene/background/Background.js";import"../webscene/background/ColorBackground.js";import"../chunks/quantityUtils.js";import"../chunks/IntegerPassUniform.js";import"../chunks/NormalAttribute.glsl.js";import"../chunks/Matrix4PassUniform.js";import"../chunks/interfaces3.js";import"../chunks/BindType.js";import"../chunks/VertexAttribute.js";import"../chunks/VertexPosition.glsl.js";import"../chunks/Matrix3DrawUniform.js";import"../chunks/StencilUtils.js";import"../chunks/basicInterfaces.js";import"../chunks/Util.js";import"../chunks/Material.js";import"../chunks/triangle.js";import"../chunks/doublePrecisionUtils.js";import"../chunks/ShaderTechniqueConfiguration.js";import"../chunks/debugFlags2.js";import"../chunks/requestImageUtils.js";import"../chunks/enums.js";import"../chunks/Texture.js";import"../chunks/GLObjectType.js";import"../chunks/renderState.js";import"../chunks/RenderGeometry.js";import"../views/3d/webgl/RenderCamera.js";import"../chunks/frustum.js";import"../chunks/Scheduler.js";import"../chunks/debugFlags.js";import"../chunks/ScreenSpacePass.glsl.js";import"../chunks/Float4DrawUniform.js";import"../chunks/NestedMap.js";import"../chunks/VertexArrayObject2.js";import"../chunks/VertexArrayObject.js";import"../chunks/RibbonLineMaterial.js";import"../chunks/Octree.js";import"../chunks/InterleavedLayout.js";import"../chunks/types.js";import"../chunks/floatRGBA.js";import"../chunks/Intersector.js";import"../chunks/glUtil.js";import"../chunks/VertexElementDescriptor.js";import"../chunks/BufferObject.js";import"../chunks/objectResourceUtils.js";import"../chunks/devEnvironmentUtils.js";import"../chunks/DefaultMaterial_COLOR_GAMMA.js";import"../chunks/resourceUtils3.js";import"../chunks/vec2f32.js";import"../chunks/GLTextureMaterial.js";import"../chunks/RayIntersections.js";import"../chunks/OutputHighlight.glsl.js";import"../chunks/DecodeSymbolColor.glsl.js";import"../chunks/VerticalOffset.glsl.js";import"../chunks/Matrix4sPassUniform.js";import"../views/3d/webgl/RenderNode.js";import"../chunks/CameraSpace.glsl.js";import"../chunks/vec3f32.js";import"../chunks/Program.js";import"../chunks/GeometryUtil.js";import"../chunks/ShadowCastVisualizeTechniqueConfiguration.js";import"../chunks/euclideanLengthMeasurementUtils.js";import"../chunks/ElevationUpdateEvent.js";import"../chunks/ElevationContext.js";import"../chunks/hydratedFeatures.js";import"../chunks/graphicUtils.js";import"../chunks/HUDMaterial.js";import"../chunks/dehydratedFeatures.js";import"../chunks/featureConversionUtils.js";import"../chunks/edgeUtils.js";import"../chunks/SnappingCandidate.js";import"../chunks/Normals.js";import"../chunks/CIMSymbolHelper.js";import"../chunks/BidiEngine.js";import"../chunks/fontUtils.js";import"../chunks/GeometryUtils.js";import"../chunks/enums2.js";import"../chunks/definitions.js";import"../chunks/shapingUtils.js";import"../chunks/mat2d.js";import"../chunks/mat2df32.js";import"../chunks/Rect.js";import"../chunks/BoundingBox.js";import"../chunks/line.js";import"../chunks/line2.js";import"../chunks/lineStippleUtils.js";import"../chunks/interfaces6.js";import"../chunks/DefaultLayouts.js";import"../chunks/webStyleSymbolUtils.js";import"../chunks/Intersector3.js";import"../chunks/ColorMaterial.js";import"../chunks/TriangleMaterial.js";import"../chunks/WebGLRequirements.js";import"../chunks/capabilities2.js";import"../chunks/contextUtils.js";import"../chunks/ray2.js";import"../chunks/viewpointUtils2.js";import"../chunks/ZoomMomentumEstimator.js";import"../chunks/labelFormatUtils.js";import"../chunks/FeatureTileDescriptor3D.js";import"../chunks/elevationInfoUtils.js";import"../chunks/hitTest.js";import"../chunks/LayerConstants.js";import"../chunks/intersectorUtilsConversions.js";import"../chunks/ElevationRange.js";import"../chunks/geometryServiceUtils.js";import"../chunks/project.js";import"../rest/support/ProjectParameters.js";import"../chunks/hitTestSelectUtils.js";import"../chunks/terrainUtils.js";import"../views/3d/support/SceneViewPerformanceInfo.js";import"../chunks/LayerViewPerformanceInfo.js";import"../views/3d/support/LayerPerformanceInfo.js";import"../chunks/ElevationQueryTileCache.js";import"../chunks/RenderableTile.js";import"../chunks/mat3f32.js";import"../chunks/enums3.js";import"../chunks/TileStrategy.js";import"../chunks/TileKey2.js";import"../chunks/QueueProcessor.js";import"../chunks/config.js";import"../chunks/TiledDisplayObject.js";import"../chunks/DisplayObject.js";import"../chunks/StyleDefinition.js";import"../chunks/resources.js";import"../chunks/edgeProcessing.js";import"../chunks/Viewshed.js";import"../views/3d/webgl.js";import"../views/3d/webgl/ManagedFBO.js";import"../chunks/testSVGPremultipliedAlpha.js";import"../chunks/RenderingContext.js";import"../chunks/ProgramCache.js";import"../chunks/screenshotUtils.js";import"../chunks/layerViewUtils.js";import"../views/ui/DefaultUI.js";import"../views/ui/UI.js";import"../chunks/themeUtils.js";import"./Attribution.js";import"./Attribution/AttributionViewModel.js";import"../chunks/accessibleHandler.js";import"../chunks/jsxWidgetSupport.js";import"./Compass.js";import"./Compass/CompassViewModel.js";import"../chunks/utils20.js";import"./support/GoTo.js";import"./NavigationToggle.js";import"./NavigationToggle/NavigationToggleViewModel.js";import"./Zoom.js";import"./Zoom/ZoomViewModel.js";import"../chunks/vmEvent.js";import"../views/MapView.js";import"../chunks/ViewStateManager.js";import"../chunks/viewpointUtils.js";import"../chunks/mat2df64.js";import"../views/2d/ViewState.js";import"../chunks/unitBezier.js";import"../chunks/rbush.js";import"../chunks/quickselect.js";import"../chunks/Tile.js";import"../chunks/HighlightOptions.js";import"../chunks/clippingUtils.js";import"../chunks/Timeline.js";import"../chunks/utils6.js";import"../webmap/background/ColorBackground.js";import"../geometry/geometryEngine.js";import"../chunks/geometryEngineBase.js";import"../chunks/hydrated.js";import"../layers/support/rasterFunctionConstants.js";import"../layers/mixins/ImageryTileMixin.js";import"../chunks/RawBlockCache.js";import"../chunks/rasterProjectionHelper.js";import"../chunks/rasterFunctionHelper.js";import"../chunks/focalStatUtils.js";import"../chunks/xmlUtilities.js";import"../chunks/GCSShiftTransform.js";function R(e,t,s,i){return[[[s-e/Math.SQRT2,i-e/Math.SQRT2],[s+e/Math.SQRT2,i-e/Math.SQRT2],[s+t/Math.SQRT2,i-t/Math.SQRT2],[s-t/Math.SQRT2,i-t/Math.SQRT2]],[[s+e/Math.SQRT2,i-e/Math.SQRT2],[s+e/Math.SQRT2,i+e/Math.SQRT2],[s+t/Math.SQRT2,i+t/Math.SQRT2],[s+t/Math.SQRT2,i-t/Math.SQRT2]],[[s+e/Math.SQRT2,i+e/Math.SQRT2],[s-e/Math.SQRT2,i+e/Math.SQRT2],[s-t/Math.SQRT2,i+t/Math.SQRT2],[s+t/Math.SQRT2,i+t/Math.SQRT2]],[[s-e/Math.SQRT2,i+e/Math.SQRT2],[s-e/Math.SQRT2,i-e/Math.SQRT2],[s-t/Math.SQRT2,i-t/Math.SQRT2],[s-t/Math.SQRT2,i+t/Math.SQRT2]]]}function U(e,t,s){const[i,r,o,n]=e;return`M ${i.join(" ")} A ${t} ${t} 0 0 1 ${r.join(" ")} L ${o.join(" ")} A ${s} ${s} 0 0 0 ${n.join(" ")} Z`}let x=class extends s{constructor(){super(...arguments),this.closeButton=!0,this.coverageMenu=!0,this.imageEnhancement=!0,this.imageGallery=!0,this.mapImageConversionTool=!0,this.navigationTool=!0,this.title=!0,this.viewerTools=!0,this.showPopupsAction=!0}};e([p({type:Boolean,nonNullable:!0})],x.prototype,"closeButton",void 0),e([p({type:Boolean,nonNullable:!0})],x.prototype,"coverageMenu",void 0),e([p({type:Boolean,nonNullable:!0})],x.prototype,"imageEnhancement",void 0),e([p({type:Boolean,nonNullable:!0})],x.prototype,"imageGallery",void 0),e([p({type:Boolean,nonNullable:!0})],x.prototype,"mapImageConversionTool",void 0),e([p({type:Boolean,nonNullable:!0})],x.prototype,"navigationTool",void 0),e([p({type:Boolean,nonNullable:!0})],x.prototype,"title",void 0),e([p({type:Boolean,nonNullable:!0})],x.prototype,"viewerTools",void 0),e([p({type:Boolean,nonNullable:!0})],x.prototype,"showPopupsAction",void 0),x=e([l("esri.widgets.OrientedImageryViewer.OrientedImageryViewerVisibleElements")],x);const P=x;let V=class extends I{constructor(e,t){super(e,t),this.dockEnabled=!1,this.galleryOpened=!1,this.imageEnhancementToolActive=!1,this.navigationToolActive=!1,this.viewModel=new m,this.messagesCommon=null,this.visibleElements=new P,this._navigationToolExpanded=!1,this._navigationTool=null,this._actionItems=new Map,this._galleryController=new AbortController,this._galleryObserver=new IntersectionObserver(this._lazyLoadImage.bind(this)),this._highlight=e=>{const t=e.target?.dataset.objectid;t&&this.viewModel.highlight(t)},this._removeHighlight=()=>this.viewModel.removeHighlight(),this._scaleNavigationTool=()=>{this._navigationToolExpanded=!this._navigationToolExpanded},this._toogleImageAttributes=()=>{this.viewModel.toggleImageAttributes()},this._loadImageFromGallery=this._loadImageFromGallery.bind(this),this._registerGalleryItem=this._registerGalleryItem.bind(this),this._unregisterGalleryItem=this._unregisterGalleryItem.bind(this),this._renderViewerContainer=this._renderViewerContainer.bind(this),this.loadImageFromSource=this.loadImageFromSource.bind(this),this.updateSuitabilities=this.updateSuitabilities.bind(this)}initialize(){this.addHandles([n((()=>[this.viewModel?.bestFeatureAngle,this._navigationTool]),(([e,t])=>{t&&this._updateNavigationTool(t)}),a),n((()=>this.currentCoverageVisible),(e=>this._onCurrentCoverageVisibilityChange(e))),n((()=>this.isAdditionalCoverageVisible),(e=>this._onAdditionalCoverageVisibilityChange(e))),n((()=>this.isAdditionalPointSourcesVisible),(e=>this._onAdditionalCameraLocationsVisibility(e)))])}loadDependencies(){return w({tooltip:()=>import("../chunks/calcite-tooltip.js"),action:()=>import("../chunks/calcite-action.js"),"action-group":()=>import("../chunks/calcite-action-group.js"),"action-bar":()=>import("../chunks/calcite-action-bar.js"),label:()=>import("../chunks/calcite-label.js"),panel:()=>import("../chunks/calcite-panel.js"),slider:()=>import("../chunks/calcite-slider.js")})}destroy(){this._galleryController.abort(),this._galleryObserver.disconnect()}get activeLayer(){return i(r.getLogger(this),"activeLayer",{replacement:"layer"}),this.layer}set activeLayer(e){i(r.getLogger(this),"activeLayer",{replacement:"layer"}),this.layer=e}get currentBestFeature(){return this.viewModel.currentBestFeature}set currentBestFeature(e){this.viewModel.currentBestFeature=e}get currentCoverageVisible(){return this.viewModel.currentCoverageVisible}set currentCoverageVisible(e){this.viewModel.currentCoverageVisible=e}get disabled(){return this.viewModel.disabled}set disabled(e){this.viewModel.disabled=e}get displayMessage(){return this.viewModel.displayMessage}set drawFootprint(e){this.viewModel.drawFootprint=e}get drawFootprint(){return this.viewModel.drawFootprint}get features(){return this.viewModel.features}get imagePointsInView(){return this.viewModel.imagePointsInView}get isDocked(){return i(r.getLogger(this),"isDocked",{replacement:"dockEnabled"}),this.dockEnabled}set isDocked(e){i(r.getLogger(this),"isDocked",{replacement:"dockEnabled"}),this.dockEnabled=e}get icon(){return"oriented-imagery-widget"}set icon(e){this._overrideIfSome("icon",e)}get imageGalleryEnabled(){return this.viewModel.imageGalleryEnabled}get isAdditionalCoverageVisible(){return this.viewModel.isAdditionalCoverageVisible}set isAdditionalCoverageVisible(e){this.viewModel.isAdditionalCoverageVisible=e}get isAdditionalPointSourcesVisible(){return this.viewModel.isAdditionalPointSourcesVisible}set isAdditionalPointSourcesVisible(e){this.viewModel.isAdditionalPointSourcesVisible=e}get mapImageConversionToolState(){return this.viewModel.mapImageConversionToolState}set mapImageConversionToolState(e){this.viewModel.mapImageConversionToolState=e}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}get popupEnabled(){const{popupEnabled:e,state:t}=this.viewModel;return"image-loaded"===t&&e}get referencePoint(){return this.viewModel.referencePoint??null}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}set determineWorkflowForFeature(e){this.viewModel.determineWorkflowForFeature=e}get determineWorkflowForFeature(){return this.viewModel.determineWorkflowForFeature}set updateFootprint(e){this.viewModel.updateFootprint=e}get updateFootprint(){return this.viewModel.updateFootprint}async _getThumbnailPixelBlockInternal(e,t){const{level:s,offset:i,size:o}=this._getMaxLevelRasterParameters(e);try{const{pixelBlock:r}=await e.fetchRawPixels(s,i,o,t);return r}catch(e){r.getLogger(this).warn("failed to create canvas with pixel data",e)}return null}_getMaxLevelRasterParameters(e){const{storageInfo:t,width:s,height:i}=e.rasterInfo,{maximumPyramidLevel:r,pyramidScalingFactor:o}=t,n=o??2;return{level:r,offset:{x:0,y:0},size:{width:Math.ceil(s/n**r),height:Math.ceil(i/n**r)}}}async _getThumbnailPixelBlock(e){const{signal:t}=this._galleryController;try{const s=await f.open({url:e,signal:t});return s?await this._getThumbnailPixelBlockInternal(s,{signal:t}):null}catch(e){r.getLogger(this).error("failed to create thumbnail",e)}return null}_handleBrightnessChange(e){this.viewModel.brightness=e.target.value??0}_handleContrastChange(e){this.viewModel.contrast=e.target.value??0}_handleSharpnessChange(e){this.viewModel.sharpness=e.target.value??0}_lazyLoadImage(e,t){e.forEach((async e=>{if(e.isIntersecting){const s=e.target,i=s.getAttribute("data-src"),n=s.getAttribute("data-rotation"),a=n?parseFloat(n)%360:null;if(!i)return;const p=await this._getThumbnailPixelBlock(i);if(!p)return;s.width=p.width,s.height=p.height;const l=s.getContext("2d");if(!l)return;const m=l.createImageData(s.width,s.height);if(m.data.set(p.getAsRGBA()),"number"==typeof a&&0!==a){const e=o(a),i=document.createElement("canvas"),n=i.getContext("2d");if(n){i.width=m.width,i.height=m.height,n.putImageData(m,0,0);const r=c(0,0,e),o=c(m.width,0,e),a=c(m.width,m.height,e),p=c(0,m.height,e),u=Math.max(r[0],o[0],a[0],p[0])-Math.min(r[0],o[0],a[0],p[0]),h=Math.max(r[1],o[1],a[1],p[1])-Math.min(r[1],o[1],a[1],p[1]),j=Math.min(s.width/u,s.height/h);return l.save(),l.clearRect(0,0,s.width,s.height),l.translate(s.width/2,s.height/2),l.rotate(e),l.scale(j,j),l.drawImage(i,-m.width/2,-m.height/2,m.width,m.height),l.restore(),t.unobserve(s)}r.getLogger(this).warn("oriented-imagery-viewer:image-gallery","failed to apply rotation on thumbnail")}l.putImageData(m,0,0),t.unobserve(s)}}))}_loadImageFromGallery(e){const{target:t}=e;if(!t)return;const s=t.getAttribute("data-objectid");s&&this.viewModel.currentBestFeature?.attributes.objectId!==Number(s)&&this.viewModel.selectBestFeature(s)}_onAdditionalCoverageVisibilityChange(e){this.viewModel.setAdditionalCoverageVisibility(e)}_onAdditionalCameraLocationsVisibility(e){this.viewModel.setAdditionalCameraLocationsVisibility(e)}_onCurrentCoverageVisibilityChange(e){this.viewModel.setCurrentCoverageVisibility(e)}_registerGalleryItem(e){this._galleryObserver.observe(e)}_renderActionTooltips(){return[...this._actionItems].map((([e,t])=>C("calcite-tooltip",{key:e,referenceElement:t},C("span",null,e))))}_renderBody(){return C("div",{class:u.body},this._renderViewerContainer(),this._renderImageGallery(),this._renderImageEnhancementTools(),this._renderNavigation())}_renderImageEnhancementTools(){const{imageEnhancementToolActive:e,viewModel:{brightness:t,contrast:s,sharpness:i}}=this;return e&&C("calcite-panel",{bind:this,class:u.imageEnhancementWrapper,closable:!0,closed:!e,heading:this.messages.imageEnhancement,key:this.messages.imageEnhancement,onCalcitePanelClose:this._toggleImageEnhancementToolState},C("div",{class:u.imageEnhancementTools},C("div",{class:u.imageEnhancementToolContainer},C("calcite-label",null,this.messages.brightness,C("calcite-slider",{bind:this,labelTicks:!0,max:10,min:-10,ticks:5,value:t,onCalciteSliderInput:this._handleBrightnessChange}))),C("div",{class:u.imageEnhancementToolContainer},C("calcite-label",null,this.messages.contrast,C("calcite-slider",{bind:this,labelTicks:!0,max:10,min:-10,ticks:5,value:s,onCalciteSliderInput:this._handleContrastChange}))),C("div",{class:u.imageEnhancementToolContainer},C("calcite-label",null,this.messages.sharpness,C("calcite-slider",{bind:this,labelTicks:!0,max:1,min:0,step:.1,ticks:.5,value:i,onCalciteSliderInput:this._handleSharpnessChange})))),C("calcite-action",{bind:this,icon:"reset",onclick:this._resetImageTools,slot:"header-actions-end",text:this.messagesCommon.reset}))}_renderImageGallery(){const{container:e,galleryOpened:t,imageGalleryEnabled:s,viewModel:{thumbnails:i}}=this;return s&&t&&e&&i?C("calcite-panel",{bind:this,class:u.carousel,closable:!0,closed:!t,heading:this.messages.imageGallery,key:this.messages.imageGallery,onCalcitePanelClose:this._toggleImageGallery},C("div",{class:u.carouselContainer},this._renderThumbnails(i))):null}_renderMapImageConversionTool(){const{mapImageConversionToolState:e,viewModel:{state:t}}=this;return C("calcite-action",{active:e,afterCreate:this._storeActionElement,bind:this,disabled:"image-loaded"!==t,icon:"image-pin",onclick:this._toggleMapImageConversionToolState,text:this.messages.mapImageConversionTool})}_renderNavigation(){const{viewModel:{sectorData:e,navigatorCurrentBestFeature:s,currentBestFeature:i,state:r}}=this;if(!this.container||!i)return null;let o,n,a,p,l;if(s){const{x:e,y:t,direction:i}=s,[r,m,c,u]=h[i];o=`M ${e} ${t} L ${r} ${m} A ${y[2]} ${y[2]} 0 0 1 ${c} ${u} Z`,n=e,p=t,a=h[i][4],l=h[i][5]}const m=e=>{const t=e.target.dataset?.sector;t&&this.viewModel.handleSectorClick(+t)},c=e=>{const t=e.target.dataset;if(!t)return;const{featureIndexInSector:s,sector:i}=t;s&&i&&this.viewModel.handleFeatureClick({sector:i,featureIndexInSector:+s})},k=e=>{e.removeEventListener("click",c)},v=i.attributes.objectId,b=e?.map((e=>e?.items)).filter(Boolean).flatMap((e=>e?.map((({x:e,y:t,objectID:s,featureIndexInSector:i,sector:r})=>C("circle",{afterRemoved:k,class:this.classes(u.feature,{selected:v===s}),cx:e,cy:t,"data-feature-index-in-sector":i,"data-sector":r,key:`${u.feature}-${s}`,onclick:c,r:j}))))),f=e=>{e.removeEventListener("click",m)},I=this.classes({[u.navigationWrapper]:!0,[u.navigationZoomed]:this._navigationToolExpanded});return this.navigationToolActive&&"image-loaded"===r?C("div",{bind:this,class:I,key:this.messages.navigationTool},C("svg",{afterCreate:e=>this._storeNavigationToolReference(e),class:t()?d:u.rotateWithAnimation,focusable:"false",height:g,role:"img",width:g,xmlns:"http://www.w3.org/2000/svg"},C("defs",null,C("linearGradient",{gradientUnits:"userSpaceOnUse",id:`${this.id}-coverage-fill`,x1:n,x2:a,y1:p,y2:l},C("stop",{class:u.navigationPathOffset0,offset:0}),C("stop",{class:u.navigationPathOffset1,offset:1}))),C("g",null,C("circle",{class:this.classes(u.sector,u.outerSector),cx:y[3],cy:y[3],onclick:this._scaleNavigationTool,r:y[3]}),C("circle",{class:u.sector,cx:y[3],cy:y[3],r:y[2]}),C("circle",{class:u.sector,cx:y[3],cy:y[3],r:y[1]}),C("circle",{class:u.sector,cx:y[3],cy:y[3],r:y[0]}),C("path",{class:u.pointer,d:"M 56.5 6.06217782649107 L 60 0 L 63.5 6.06217782649107 Z",key:`${u.pointer}-west`}),C("path",{class:this.classes(u.pointer,u.north),d:"M 113.93782217350893 56.5 L 120 60 L 113.93782217350893 63.5 Z",key:`${u.pointer}-north`}),C("path",{class:u.pointer,d:"M 56.5 113.93782217350893 L 60 120 L 63.5 113.93782217350893 Z",key:`${u.pointer}-east`}),C("path",{class:u.pointer,d:"M 6.06217782649107 56.5 L 0 60 L 6.06217782649107 63.5 Z",key:`${u.pointer}-south`}),C("path",{class:this.classes(u.sector,u.sectorSeparator),d:"M 23.937554159486076 23.937554159486076 L 96.06244584051393 96.06244584051393 M 23.937554159486076 96.06244584051393 L 96.06244584051393 23.937554159486076",key:u.sectorSeparator}),function(e,t,s){const[i,r,o,n]=[...e,0];return[...R(i,r,t,s).map((e=>U(e,i,r))),...R(r,o,t,s).map((e=>U(e,r,o))),...R(o,n,t,s).map((e=>U(e,o,n)))]}([y[2],y[1],y[0]],y[3],y[3]).map(((t,s)=>C("path",{afterRemoved:f,class:this.classes(u.sector,e?.[s]?.length?u.sectorEnabled:u.sectorDisabled),d:t,"data-sector":`${s}`,key:`${u.sector}-${s}`,onclick:m}))),C("path",{class:this.classes(u.sector,u.sectorCross),d:"M 56.4 56.4 L 63.53 63.53 M 63.53 56.4 L 56.4 63.53",key:u.sectorCross}),b,i.attributes.cameraPitch>=5&&o?C("path",{class:u.selectedFeaturePath,d:o,fill:`url(#${this.id}-coverage-fill)`,key:u.selectedFeaturePath}):null))):null}_renderNavigationTool(){const{state:e}=this.viewModel;return C("calcite-action",{active:this.navigationToolActive,afterCreate:this._storeActionElement,bind:this,disabled:"image-loaded"!==e,icon:"explore",onclick:this._toggleNavigationTool,text:this.messages.navigationTool})}_renderImageEnhancementTool(){const{state:e,mode:t}=this.viewModel;return C("calcite-action",{active:this.imageEnhancementToolActive,afterCreate:this._storeActionElement,bind:this,disabled:"default"!==t||"image-loaded"!==e,icon:"sliders-horizontal",onclick:this._toggleImageEnhancementToolState,text:this.messages.imageEnhancement})}_renderMenuBarContainer(){const{currentCoverageVisible:e,isAdditionalCoverageVisible:t,isAdditionalPointSourcesVisible:s,imageGalleryEnabled:i}=this;return C("calcite-action-bar",{expandDisabled:!0,layout:"horizontal",slot:"action-bar"},C("calcite-action-group",{expanded:!0},C("calcite-action",{active:e,afterCreate:this._storeActionElement,bind:this,class:u.currentCoverage,icon:"trapezoid-area",onclick:this._toggleCurrentCoverage,text:this.messages.currentFootprint}),C("calcite-action",{active:t,afterCreate:this._storeActionElement,bind:this,class:u.addCoverage,icon:"trapezoid-area",onclick:this._toggleAdditionalCoverage,text:this.messages.additionalFootprints}),C("calcite-action",{active:s,afterCreate:this._storeActionElement,bind:this,class:u.addExpPoints,icon:"circle-area",onclick:this._toggleAdditionalCameraLocations,text:this.messages.additionalCameraLocations})),C("calcite-action-group",{layout:"horizontal"},this.visibleElements.mapImageConversionTool?this._renderMapImageConversionTool():null,this.visibleElements.navigationTool?this._renderNavigationTool():null,this.visibleElements.imageEnhancement?this._renderImageEnhancementTool():null),C("calcite-action-group",null,C("calcite-action",{active:this.galleryOpened,afterCreate:this._storeActionElement,bind:this,disabled:!i,icon:"images",onclick:this._toggleImageGallery,text:this.messages.imageGallery,textEnabled:!0}),this.visibleElements.showPopupsAction?this._renderPopupAction():null),this._renderActionTooltips())}_renderMessageBox(){const{messages:e,viewModel:{displayMessage:t}}=this;if(!t)return null;const{data:s,key:i,map:r}=t,o=`${r?T(e[i],r):e[i]}`;return C("span",{class:u.messageBox},s?`${o} ${s}`:o)}_renderPopupAction(){return C("calcite-action",{afterCreate:this._storeActionElement,bind:this,disabled:!this.popupEnabled,icon:"popup",onclick:this._toogleImageAttributes,text:this.messages.showPopups,textEnabled:!0})}_renderThumbnails(e){const{currentBestFeature:t}=this.viewModel;return t?C("div",{class:u.carouselContent},e.items.map((({url:e,objectId:s,rotation:i},r)=>C("div",{class:`${u.carouselItemWrapper}${t.attributes.objectId===s?"--selected":""}`,key:`${u.carouselItemWrapper}-${r}`},C("canvas",{afterCreate:this._registerGalleryItem,afterRemoved:this._unregisterGalleryItem,alt:`thumbnail-${s}`,class:u.carouselItem,"data-objectid":`${s}`,"data-rotation":`${i}`,"data-src":e,onclick:this._loadImageFromGallery,onmouseenter:this._highlight,onmouseleave:this._removeHighlight}))))):null}_renderViewerContainer(){return C("div",{class:u.viewerContainer},this._renderImageViewer(),this._renderPanoramicViewer(),this._renderMessageBox())}_renderImageViewer(){const{displayMessage:e,loadImageViewer:t,mode:s}=this.viewModel,i=`${u.viewer}${e||"default"!==s?"--hide":""}`;return C("calcite-panel",{afterCreate:t,bind:this,class:i})}_renderPanoramicViewer(){const{displayMessage:e,loadPanoramicViewer:t,mode:s}=this.viewModel,i=`${u.viewer}${e||"panoramic"!==s?"--hide":""}`;return C("calcite-panel",{afterCreate:t,bind:this,class:i})}_resetImageTools(){this.viewModel.sharpness=this.viewModel.brightness=this.viewModel.contrast=0}_storeActionElement(e){this._actionItems.set(e.text,e)}_storeNavigationToolReference(e){this._navigationTool=e}_toggleAdditionalCameraLocations(){this.isAdditionalPointSourcesVisible=!this.isAdditionalPointSourcesVisible}_toggleAdditionalCoverage(){this.isAdditionalCoverageVisible=!this.isAdditionalCoverageVisible}_toggleCurrentCoverage(){this.currentCoverageVisible=!this.currentCoverageVisible}_toggleImageEnhancementToolState(e){e.stopPropagation(),this.imageEnhancementToolActive=!this.imageEnhancementToolActive,this.imageEnhancementToolActive&&(this.galleryOpened&&(this.galleryOpened=!1),this.navigationToolActive&&(this.navigationToolActive=!1))}_toggleImageGallery(e){e.stopPropagation(),this.galleryOpened=!!this.imageGalleryEnabled&&!this.galleryOpened,this.galleryOpened&&(this.imageEnhancementToolActive&&(this.imageEnhancementToolActive=!1),this.navigationToolActive&&(this.navigationToolActive=!1))}_toggleNavigationTool(){this.navigationToolActive=!this.navigationToolActive,this.navigationToolActive&&(this.galleryOpened&&(this.galleryOpened=!1),this.imageEnhancementToolActive&&(this.imageEnhancementToolActive=!1))}_toggleMapImageConversionToolState(){this.mapImageConversionToolState=!this.mapImageConversionToolState}_unregisterGalleryItem(e){this._galleryObserver.unobserve(e)}_updateNavigationTool(e){const{previousFeatureAngle:t,bestFeatureAngle:s}=this.viewModel,i=(s-t+540)%360-180;e.style.setProperty(k,`${t}deg`),e.style.setProperty(v,`${t+i}deg`)}loadBestImage(e){this.viewModel.loadBestImage(e)}loadImageFromSource(e,t){return this.viewModel.loadImageFromSource(e,t)}async plotMapPoint(e){return this.viewModel.plotMapPoint(e)}plotReferencePointOnGround(e){this.viewModel.plotReferencePointOnGround(e)}plotReferencePointOnImage(e){this.viewModel.plotReferencePointOnImage(e)}resetImage(){this.viewModel.resetImage()}render(){const{dockEnabled:e,viewModel:{state:t}}=this;return C("div",{class:this.classes(M.widget,b)},C("calcite-panel",{bind:this,class:e?u.dock:u.float,heading:this.visibleElements.title?this.messages.title:void 0,loading:"image-loading"===t},this.visibleElements.coverageMenu?this._renderMenuBarContainer():null,this._renderBody()))}updateSuitabilities(e){this.viewModel.updateSuitabilities(e)}};e([p()],V.prototype,"activeLayer",null),e([p()],V.prototype,"currentBestFeature",null),e([p()],V.prototype,"currentCoverageVisible",null),e([p()],V.prototype,"disabled",null),e([p()],V.prototype,"dockEnabled",void 0),e([p()],V.prototype,"drawFootprint",null),e([p()],V.prototype,"features",null),e([p()],V.prototype,"imagePointsInView",null),e([p()],V.prototype,"isDocked",null),e([p()],V.prototype,"galleryOpened",void 0),e([p()],V.prototype,"icon",null),e([p()],V.prototype,"imageEnhancementToolActive",void 0),e([p({readOnly:!0})],V.prototype,"imageGalleryEnabled",null),e([p()],V.prototype,"isAdditionalCoverageVisible",null),e([p()],V.prototype,"isAdditionalPointSourcesVisible",null),e([p()],V.prototype,"mapImageConversionToolState",null),e([p()],V.prototype,"layer",null),e([p()],V.prototype,"navigationToolActive",void 0),e([p({type:m})],V.prototype,"viewModel",void 0),e([p(),S("esri/widgets/OrientedImageryViewer/t9n/OrientedImageryViewer")],V.prototype,"messages",void 0),e([p(),S("esri/t9n/common")],V.prototype,"messagesCommon",void 0),e([p({readOnly:!0})],V.prototype,"popupEnabled",null),e([p()],V.prototype,"referencePoint",null),e([p()],V.prototype,"view",null),e([p({type:P,nonNullable:!0})],V.prototype,"visibleElements",void 0),e([p()],V.prototype,"determineWorkflowForFeature",null),e([p()],V.prototype,"updateFootprint",null),e([p()],V.prototype,"_navigationToolExpanded",void 0),e([p()],V.prototype,"_navigationTool",void 0),V=e([l("esri.widgets.OrientedImageryViewer")],V);const _=V;export{_ as default};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.30/esri/copyright.txt for details.
*/
import{_ as e}from"../chunks/tslib.es6.js";import"../intl.js";import{i as t}from"../core/lang.js";import{L as s}from"../chunks/Logger.js";import{createResolver as i}from"../core/promiseUtils.js";import{watch as o,whenOnce as r}from"../core/reactiveUtils.js";import{property as n}from"../core/accessorSupport/decorators/property.js";import{subclass as a}from"../core/accessorSupport/decorators/subclass.js";import{isIntegerField as l,a as p,b as m,x as u,y as d,p as c,o as h,n as b,m as y,k as j}from"../layers/support/fieldUtils.js";import g,{l as f}from"./Widget.js";import{H as v,i as _}from"../chunks/Heading.js";import"../chunks/widgetUtils.js";import{t as k}from"../chunks/jsxFactory.js";import{j as C,c as F,k as R,l as I,m as w,n as S,i as O,o as x,q as D,r as M,s as L}from"../chunks/featureFormUtils.js";import V from"./FeatureForm/FeatureFormViewModel.js";import{g as U}from"../chunks/globalCss.js";import{m as T}from"../chunks/messageBundle.js";import{v as N}from"../chunks/vmEvent.js";import{s as P}from"../chunks/substitute.js";import"../chunks/date.js";import"../chunks/jsonMap.js";import"../config.js";import"../chunks/locale.js";import"../chunks/handleUtils.js";import"../chunks/timeZoneUtils.js";import"../chunks/datetime.js";import"../chunks/number.js";import"../chunks/messages.js";import"../core/Error.js";import"../request.js";import"../kernel.js";import"../core/urlUtils.js";import"../core/JSONSupport.js";import"../core/Accessor.js";import"../core/Handles.js";import"../chunks/maybe.js";import"../chunks/metadata.js";import"../chunks/utils.js";import"../chunks/ObservableBase.js";import"../chunks/tracking.js";import"../core/scheduling.js";import"../chunks/ensureType.js";import"../chunks/assets.js";import"../chunks/asyncUtils.js";import"../core/Collection.js";import"../core/Evented.js";import"../chunks/shared.js";import"../chunks/SimpleObservable.js";import"../core/sql.js";import"../chunks/mathUtils.js";import"../chunks/vec3.js";import"../chunks/vec3f64.js";import"../chunks/common.js";import"../geometry.js";import"../geometry/Extent.js";import"../geometry/Geometry.js";import"../chunks/reader.js";import"../geometry/SpatialReference.js";import"../chunks/unitUtils.js";import"../chunks/writer.js";import"../geometry/Point.js";import"../core/accessorSupport/decorators/cast.js";import"../geometry/support/webMercatorUtils.js";import"../geometry/Multipoint.js";import"../chunks/zmUtils.js";import"../geometry/Polygon.js";import"../chunks/coordsUtils.js";import"../chunks/Axis.js";import"../chunks/extentUtils.js";import"../chunks/aaBoundingRect.js";import"../geometry/Polyline.js";import"../chunks/typeUtils.js";import"../geometry/support/jsonUtils.js";import"../chunks/domUtils.js";import"../core/Promise.js";import"../chunks/uuid.js";import"../chunks/projector.js";import"../chunks/jsxWidgetSupport.js";import"../chunks/compilerUtils.js";import"../chunks/formUtils.js";import"../chunks/utils2.js";import"../chunks/basemapUtils.js";import"../Basemap.js";import"../chunks/collectionUtils.js";import"../core/Loadable.js";import"../chunks/loadAll.js";import"../portal/Portal.js";import"../portal/PortalGroup.js";import"../portal/PortalQueryParams.js";import"../portal/PortalQueryResult.js";import"../portal/PortalUser.js";import"../portal/PortalFolder.js";import"../portal/PortalItem.js";import"../portal/PortalItemResource.js";import"../portal/PortalRating.js";import"../chunks/persistableUrlUtils.js";import"../support/BasemapStyle.js";import"../chunks/writeUtils.js";import"../chunks/layerUtils2.js";import"../chunks/utils3.js";import"../chunks/colorUtils.js";import"../chunks/screenUtils.js";import"../chunks/mat4.js";import"../Graphic.js";import"../PopupTemplate.js";import"../core/Clonable.js";import"../popup/content.js";import"../popup/content/AttachmentsContent.js";import"../popup/content/Content.js";import"../popup/content/CustomContent.js";import"../popup/content/ExpressionContent.js";import"../popup/ElementExpressionInfo.js";import"../popup/content/FieldsContent.js";import"../popup/FieldInfo.js";import"../chunks/enumeration.js";import"../popup/support/FieldInfoFormat.js";import"../popup/content/MediaContent.js";import"../popup/content/BarChartMediaInfo.js";import"../popup/content/mixins/ChartMediaInfo.js";import"../popup/content/mixins/MediaInfo.js";import"../popup/content/support/ChartMediaInfoValue.js";import"../Color.js";import"../popup/content/support/ChartMediaInfoValueSeries.js";import"../chunks/chartMediaInfoUtils.js";import"../popup/content/ColumnChartMediaInfo.js";import"../popup/content/ImageMediaInfo.js";import"../popup/content/support/ImageMediaInfoValue.js";import"../popup/content/LineChartMediaInfo.js";import"../popup/content/PieChartMediaInfo.js";import"../popup/content/RelationshipContent.js";import"../popup/support/RelatedRecordsInfoFieldOrder.js";import"../popup/content/TextContent.js";import"../popup/ExpressionInfo.js";import"../popup/LayerOptions.js";import"../popup/RelatedRecordsInfo.js";import"../support/actions/ActionBase.js";import"../core/Identifiable.js";import"../support/actions/ActionButton.js";import"../support/actions/ActionToggle.js";import"../symbols.js";import"../symbols/CIMSymbol.js";import"../symbols/Symbol.js";import"../symbols/ExtrudeSymbol3DLayer.js";import"../symbols/Symbol3DLayer.js";import"../chunks/utils4.js";import"../symbols/edges/Edges3D.js";import"../chunks/materialUtils.js";import"../chunks/opacityUtils.js";import"../symbols/edges/SketchEdges3D.js";import"../symbols/edges/SolidEdges3D.js";import"../chunks/Symbol3DMaterial.js";import"../symbols/FillSymbol.js";import"../symbols/SimpleLineSymbol.js";import"../symbols/LineSymbol.js";import"../symbols/LineSymbolMarker.js";import"../chunks/lineMarkers.js";import"../symbols/FillSymbol3DLayer.js";import"../symbols/patterns/LineStylePattern3D.js";import"../symbols/patterns/StylePattern3D.js";import"../chunks/utils5.js";import"../chunks/colors.js";import"../chunks/symbolLayerUtils3D.js";import"../chunks/aaBoundingBox.js";import"../symbols/Font.js";import"../symbols/IconSymbol3DLayer.js";import"../symbols/LabelSymbol3D.js";import"../symbols/Symbol3D.js";import"../symbols/LineSymbol3DLayer.js";import"../symbols/LineStyleMarker3D.js";import"../symbols/ObjectSymbol3DLayer.js";import"../symbols/PathSymbol3DLayer.js";import"../symbols/TextSymbol3DLayer.js";import"../symbols/WaterSymbol3DLayer.js";import"../symbols/support/StyleOrigin.js";import"../chunks/Thumbnail.js";import"../chunks/calloutUtils.js";import"../symbols/callouts/Callout3D.js";import"../symbols/callouts/LineCallout3D.js";import"../symbols/support/Symbol3DVerticalOffset.js";import"../symbols/LineSymbol3D.js";import"../symbols/MarkerSymbol.js";import"../symbols/MeshSymbol3D.js";import"../symbols/PictureFillSymbol.js";import"../chunks/urlUtils.js";import"../symbols/PictureMarkerSymbol.js";import"../symbols/PointSymbol3D.js";import"../symbols/PolygonSymbol3D.js";import"../symbols/SimpleFillSymbol.js";import"../symbols/SimpleMarkerSymbol.js";import"../symbols/TextSymbol.js";import"../symbols/WebStyleSymbol.js";import"../chunks/UpdatingHandles.js";import"../form/FormTemplate.js";import"../form/ExpressionInfo.js";import"../form/elements/GroupElement.js";import"../form/elements/Element.js";import"../form/support/elements.js";import"../form/elements/FieldElement.js";import"../form/elements/support/inputs.js";import"../form/elements/inputs/BarcodeScannerInput.js";import"../form/elements/inputs/TextInput.js";import"../form/elements/inputs/Input.js";import"../form/elements/inputs/ComboBoxInput.js";import"../form/elements/inputs/DatePickerInput.js";import"../form/elements/inputs/DateTimeOffsetPickerInput.js";import"../form/elements/inputs/DateTimePickerInput.js";import"../form/elements/inputs/RadioButtonsInput.js";import"../form/elements/inputs/SwitchInput.js";import"../form/elements/inputs/TextAreaInput.js";import"../form/elements/inputs/TextBoxInput.js";import"../form/elements/inputs/TimePickerInput.js";import"../chunks/domains.js";import"../layers/support/CodedValueDomain.js";import"../layers/support/Domain.js";import"../layers/support/InheritedDomain.js";import"../layers/support/RangeDomain.js";import"../form/elements/RelationshipElement.js";import"../form/elements/TextElement.js";import"../chunks/editableLayers.js";import"../layers/catalog/catalogUtils.js";import"../chunks/arcgisLayerUrl.js";import"../layers/support/Subtype.js";import"./FeatureForm/FieldInput.js";import"../chunks/featureUtils.js";import"./FeatureForm/EditableInput.js";import"./FeatureForm/InputBase.js";import"../arcade.js";import"../chunks/TimeOnly.js";import"../chunks/UnknownTimeZone.js";import"../chunks/ImmutableArray.js";import"../layers/FeatureLayer.js";import"../renderers/ClassBreaksRenderer.js";import"../renderers/Renderer.js";import"../renderers/support/AuthoringInfo.js";import"../renderers/support/AuthoringInfoVisualVariable.js";import"../chunks/colorRamps.js";import"../rest/support/AlgorithmicColorRamp.js";import"../rest/support/ColorRamp.js";import"../rest/support/MultipartColorRamp.js";import"../renderers/mixins/VisualVariablesMixin.js";import"../renderers/visualVariables/ColorVariable.js";import"../renderers/visualVariables/VisualVariable.js";import"../chunks/LegendOptions.js";import"../renderers/visualVariables/support/ColorStop.js";import"../renderers/visualVariables/OpacityVariable.js";import"../renderers/visualVariables/support/OpacityStop.js";import"../renderers/visualVariables/RotationVariable.js";import"../renderers/visualVariables/SizeVariable.js";import"../renderers/visualVariables/support/SizeStop.js";import"../chunks/sizeVariableUtils.js";import"../chunks/visualVariableUtils.js";import"../chunks/lengthUtils.js";import"../renderers/support/ClassBreakInfo.js";import"../chunks/commonProperties.js";import"../symbols/support/jsonUtils.js";import"../chunks/defaults.js";import"../chunks/defaultsJSON.js";import"../renderers/DictionaryRenderer.js";import"../chunks/LRUCache.js";import"../chunks/MemCache.js";import"../chunks/Version.js";import"../layers/support/FieldsIndex.js";import"../chunks/OverrideHelper.js";import"../chunks/colorUtils2.js";import"../chunks/vec4.js";import"../chunks/vec4f64.js";import"../chunks/utils7.js";import"../chunks/quantizationUtils.js";import"../renderers/DotDensityRenderer.js";import"../renderers/support/AttributeColorInfo.js";import"../renderers/HeatmapRenderer.js";import"../renderers/support/HeatmapColorStop.js";import"../chunks/heatmapUtils.js";import"../renderers/PieChartRenderer.js";import"../renderers/SimpleRenderer.js";import"../renderers/UniqueValueRenderer.js";import"../chunks/diffUtils.js";import"../renderers/support/UniqueValue.js";import"../renderers/support/UniqueValueClass.js";import"../renderers/support/UniqueValueGroup.js";import"../renderers/support/UniqueValueInfo.js";import"../chunks/styleUtils.js";import"../renderers/support/jsonUtils.js";import"../chunks/MultiOriginJSONSupport.js";import"../chunks/layerContainerType.js";import"../layers/Layer.js";import"../TimeExtent.js";import"../chunks/timeUtils.js";import"../core/workers/workers.js";import"../core/workers/Connection.js";import"../chunks/Queue.js";import"../core/workers/RemoteClient.js";import"../chunks/editsZScale.js";import"../chunks/queryZScale.js";import"../chunks/zscale.js";import"../rest/support/FeatureSet.js";import"../layers/support/Field.js";import"../chunks/fieldType.js";import"../layers/mixins/APIKeyMixin.js";import"../chunks/ArcGISService.js";import"../layers/mixins/BlendLayer.js";import"../chunks/jsonUtils.js";import"../chunks/parser.js";import"../chunks/_commonjsHelpers.js";import"../layers/mixins/CustomParametersMixin.js";import"../chunks/EditBusLayer.js";import"../layers/mixins/FeatureEffectLayer.js";import"../layers/support/FeatureEffect.js";import"../layers/support/FeatureFilter.js";import"../rest/support/Query.js";import"../chunks/DataLayerSource.js";import"../chunks/FullTextSearch.js";import"../chunks/spatialRelationships.js";import"../rest/support/StatisticDefinition.js";import"../layers/mixins/FeatureLayerBase.js";import"../geometry/HeightModelInfo.js";import"../chunks/commonProperties2.js";import"../chunks/ElevationInfo.js";import"../chunks/unitConversionUtils.js";import"../chunks/featureLayerUtils.js";import"../chunks/featureQueryAll.js";import"../rest/support/AttachmentQuery.js";import"../rest/support/RelationshipQuery.js";import"../layers/support/GeometryFieldsInfo.js";import"../layers/support/LayerFloorInfo.js";import"../layers/support/Relationship.js";import"../chunks/serviceCapabilitiesUtils.js";import"../layers/mixins/FeatureReductionLayer.js";import"../layers/support/AggregateField.js";import"../layers/support/ExpressionInfo.js";import"../chunks/FeatureReduction.js";import"../layers/support/FeatureReductionBinning.js";import"../layers/support/LabelClass.js";import"../chunks/labelUtils.js";import"../layers/support/FeatureReductionCluster.js";import"../layers/support/FeatureReductionSelection.js";import"../chunks/clusterUtils.js";import"../chunks/MD5.js";import"../layers/mixins/OperationalLayer.js";import"../layers/mixins/OrderedLayer.js";import"../chunks/OrderByInfo.js";import"../layers/mixins/PortalLayer.js";import"../chunks/portalItemUtils.js";import"../geometry/projection.js";import"../chunks/projectBuffer.js";import"../chunks/geodesicConstants.js";import"../geometry/support/GeographicTransformation.js";import"../geometry/support/GeographicTransformationStep.js";import"../layers/mixins/PublishableLayer.js";import"../layers/support/PublishingInfo.js";import"../layers/mixins/RefreshableLayer.js";import"../layers/mixins/ScaleRangeLayer.js";import"../layers/mixins/TemporalLayer.js";import"../TimeInterval.js";import"../layers/support/TimeInfo.js";import"../layers/support/FeatureTemplate.js";import"../layers/support/FeatureType.js";import"../chunks/fieldProperties.js";import"../chunks/labelingInfo.js";import"../chunks/versionUtils.js";import"../chunks/styleUtils2.js";import"../rest/support/TopFeaturesQuery.js";import"../rest/support/TopFilter.js";import"../support/popupUtils.js";import"../chunks/interfaces2.js";import"./FeatureForm/GroupInput.js";import"./FeatureForm/RelationshipInput.js";import"../chunks/FeatureRelationshipViewModel.js";import"../chunks/ReactiveMap.js";import"../chunks/ReactiveSet.js";const E="exclamation-mark-triangle",$="esri-editor__prompt",A={base:$,header:`${$}__header`,heading:`${$}__header__heading`,message:`${$}__message`,divider:`${$}__divider`,actions:`${$}__actions`},B=()=>f({button:()=>import("../chunks/calcite-button.js"),icon:()=>import("../chunks/calcite-icon.js"),scrim:()=>import("../chunks/calcite-scrim.js"),label:()=>import("../chunks/calcite-label.js"),"radio-button":()=>import("../chunks/calcite-radio-button.js"),"radio-button-group":()=>import("../chunks/calcite-radio-button-group.js")});function H({actions:e,context:t,headingLevel:s,message:i,title:o,...r}){const{primary:n,secondary:a}=e;let l;switch(t){case"danger":l="danger";break;case"info":l="brand";break;default:l="neutral"}const p=k("calcite-button",{afterCreate:G,appearance:"solid","data-testid":"primary-prompt-button",key:"prompt-primary-button",kind:l,onclick:n.action,width:a?"half":"full"},n.label),m=a&&k("calcite-button",{appearance:"outline","data-testid":"secondary-prompt-button",key:"prompt-secondary-button",kind:l,onclick:a.action,width:"half"},a.label);return k("calcite-scrim",{"data-testid":"prompt",key:"prompt"},k("div",{class:`${A.base}--${t}`},k("div",{class:A.header},k("calcite-icon",{icon:E}),k(v,{class:A.heading,level:s},o)),k("div",{class:A.message},i),function({radios:e,onRadioSelection:t,defaultRadioSelection:s}){return e?.length?k("calcite-radio-button-group",{name:"PromptChoiceList"},e.map((e=>k("calcite-label",{layout:"inline"},k("calcite-radio-button",{checked:e.value===s,value:e.value,onCalciteRadioButtonChange:()=>t?.(e.value)}),e.label)))):void 0}(r)??k("div",{class:A.divider}),k("div",{class:A.actions},m,p)))}function G(e){requestAnimationFrame((()=>e.setFocus()))}const Z="esri-feature-form",q=`${Z}__group`,W=`${Z}__input`,K=`${Z}__related-records`,z={base:Z,form:`${Z}__form`,formHeader:`${Z}__form-header`,label:`${Z}__label`,labelTextContent:`${Z}__label-text-content`,fieldInput:`${W}`,inputRadio:`${W}--radio`,inputRadioGroup:`${W}--radio-group`,inputRadioLabel:`${W}--radio-label`,inputDisabled:`${W}--disabled`,inputSwitch:`${W}--switch`,centeredButton:`${Z}__centered-button`,description:`${Z}__description-text`,listObserver:`${Z}__list-observer`,relatedRecordsHeader:`${K}_header`,relatedRecordsLabel:`${K}_label`,relatedRecordsList:`${K}_list`,dateInputContainer:`${Z}__date-input-container`,textElement:`${Z}__text-element`,group:q,groupSequential:`${q}--sequential`,groupActive:`${q}--active`},Q="data-field-name";let J=class extends g{constructor(e,t){super(e,t),this._attemptFocusOnNextRender=!1,this._dateComponentMap=new Map,this._inputsWithChanges=new Set,this._focusedFieldName=null,this._pendingSubtypeChoice=null,this._listObserverNode=null,this._listObserver=new IntersectionObserver((e=>{e.length&&e[0].isIntersecting&&this._incrementRelatedRecordPage()}),{root:window.document}),this._prompt=null,this.groupDisplay="all",this.headingLevel=2,this.messages=null,this.messagesCommon=null,this.messagesFeature=null,this.messagesTemplates=null,this.viewModel=new V,this._onShowAllRelatedRecordsClick=e=>{const{feature:t,relatedRecordCallbacks:s}=this;t&&s?.showAllRelatedRecords&&s.showAllRelatedRecords({parentFeature:t,relationshipId:e})},this._onAddRelatedRecordsClick=(e,t)=>{const{feature:s,relatedRecordCallbacks:i}=this;s&&i?.addRelatedRecord&&i.addRelatedRecord({parentFeature:s,relatedLayer:t,relationshipId:e})},this._onFormKeyDown=this._onFormKeyDown.bind(this),this._onFormSubmit=this._onFormSubmit.bind(this),this._onGroupToggle=this._onGroupToggle.bind(this),this._onComponentBlur=this._onComponentBlur.bind(this),this._onComponentFocus=this._onComponentFocus.bind(this),this._onComponentKeyDown=this._onComponentKeyDown.bind(this),this._afterComponentCreate=this._afterComponentCreate.bind(this),this._afterComponentCreateOrUpdate=this._afterComponentCreateOrUpdate.bind(this),this._afterDateComponentCreate=this._afterDateComponentCreate.bind(this),this._afterDateComponentCreateOrUpdate=this._afterDateComponentCreateOrUpdate.bind(this),this._afterRadioGroupCreateOrUpdate=this._afterRadioGroupCreateOrUpdate.bind(this)}initialize(){this.addHandles([o((()=>this.feature),(()=>{this._inputsWithChanges.clear(),this._dateComponentMap.clear(),r((()=>!this.viewModel.updating)).then((()=>{const e=this._getFocusableInput("forward");this._syncGroupInputStates(),this._focusedFieldName=e?.name||null,this._attemptFocusOnNextRender=!0}))})),o((()=>this.groupDisplay),(()=>this._syncGroupInputStates())),this.on("submit",(e=>{if(e.invalid.length>0){const[t]=e.invalid;e.invalid.forEach((e=>this._inputsWithChanges.add(e))),this._focusedFieldName=t,this._attemptFocusOnNextRender=!0,this.scheduleRender()}})),o((()=>[this.viewModel.activeRelationshipInput,this._listObserverNode]),(()=>this._onObserverChange()))])}loadDependencies(){return f({block:()=>import("../chunks/calcite-block.js"),button:()=>import("../chunks/calcite-button.js"),combobox:()=>import("../chunks/calcite-combobox.js"),"combobox-item":()=>import("../chunks/calcite-combobox-item.js"),"combobox-item-group":()=>import("../chunks/calcite-combobox-item-group.js"),icon:()=>import("../chunks/calcite-icon.js"),input:()=>import("../chunks/calcite-input.js"),"input-date-picker":()=>import("../chunks/calcite-input-date-picker.js"),"input-message":()=>import("../chunks/calcite-input-message.js"),"input-number":()=>import("../chunks/calcite-input-number.js"),"input-time-picker":()=>import("../chunks/calcite-input-time-picker.js"),"input-time-zone":()=>import("../chunks/calcite-input-time-zone.js"),label:()=>import("../chunks/calcite-label.js"),list:()=>import("../chunks/calcite-list.js"),"list-item":()=>import("../chunks/calcite-list-item.js"),loader:()=>import("../chunks/calcite-loader.js"),notice:()=>import("../chunks/calcite-notice.js"),"radio-button":()=>import("../chunks/calcite-radio-button.js"),"radio-button-group":()=>import("../chunks/calcite-radio-button-group.js"),switch:()=>import("../chunks/calcite-switch.js"),"text-area":()=>import("../chunks/calcite-text-area.js")})}destroy(){this._listObserverNode&&this._listObserver.unobserve(this._listObserverNode)}get _relatedRecordsEnabled(){const e=this.relatedRecordCallbacks;return!(!e||!(e.addRelatedRecord||e.editRelatedRecord||e.showAllRelatedRecords))}get disabled(){return this.viewModel.disabled}set disabled(e){this.viewModel.disabled=e}get feature(){return this.viewModel.feature}set feature(e){this.viewModel.feature=e}get formTemplate(){return this.viewModel.formTemplate}set formTemplate(e){this.viewModel.formTemplate=e}get icon(){return"form-field"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}get map(){return this.viewModel.map}set map(e){this.viewModel.map=e}get relatedRecordCallbacks(){return this.viewModel.relatedRecordCallbacks}set relatedRecordCallbacks(e){this.viewModel.relatedRecordCallbacks=e}get relationshipId(){return this.viewModel.relationshipId}set relationshipId(e){this.viewModel.relationshipId=e}get spatialReference(){return this.viewModel.spatialReference}set spatialReference(e){this.viewModel.spatialReference=e}get strict(){return this.viewModel.strict}set strict(e){this.viewModel.strict=e}get timeZone(){return this.viewModel.timeZone}set timeZone(e){this.viewModel.timeZone=e}get showPrompt(){return e=>{this._prompt?.cancel?.(),this._prompt=e}}set showPrompt(e){this._overrideIfSome("showPrompt",e)}get clearPrompt(){return()=>this._prompt=null}set clearPrompt(e){this._overrideIfSome("clearPrompt",e)}getValues(){return this.viewModel.getValues()}submit(){return this.viewModel.submit()}render(){const{state:e}=this.viewModel;return k("div",{class:this.classes(z.base,U.widget,U.panel)},"ready"===e?this._renderForm():null)}_renderForm(){return k("div",null,k("form",{class:z.form,novalidate:!0,onkeydown:this._onFormKeyDown,onsubmit:this._onFormSubmit},this._renderHeader(),this._renderContent()),this._prompt?k(H,{...this._prompt,headingLevel:this.headingLevel}):void 0)}_renderHeader(){const e=this.viewModel;if(!e.formHeaderVisible)return;const t=null!=e.formTitle&&k(v,{key:"title",level:this.headingLevel},e.formTitle),s=null!=e.formDescription&&k("p",{class:z.description,key:"description"},e.formDescription);return k("div",{class:z.formHeader},t,s)}_renderContent(){const{viewModel:e}=this;return e.activeRelationshipInput?this._renderRelationshipInput(e.activeRelationshipInput):e.inputs.filter(t).filter((e=>e.visible)).map((e=>this._renderInput(e)))}_renderInput(e){return C(e)?this._renderGroup(e):F(e)?this._renderLabeledField(e):R(e)?this._renderRelationshipInput(e):I(e)?this._renderTextElementInput(e):void 0}_renderDescriptionOrEmpty(e,t){return null==e?null:k("div",{class:this.classes(z.description),id:t},e)}_renderGroup(e){const{disabled:t,formTemplate:s,headingLevel:i}=this,{description:o,id:r,inputs:n,label:a,open:l}=e,p=n.filter((e=>e.visible)),m=this.viewModel.findField(this._focusedFieldName),u=m?.group===e,d="sequential"===this.groupDisplay;return k("calcite-block",{class:this.classes(z.group,d?z.groupSequential:null,u?z.groupActive:null,t?z.inputDisabled:null),collapsible:!0,"data-group":e,description:o||void 0,disabled:t,heading:`${a}`,headingLevel:s?.title?_(i):i,id:r,key:r,open:l,onCalciteBlockToggle:({target:t})=>this._onGroupToggle(t,e)},p.map((e=>this._renderInput(e))))}_getFocusableInput(e,t){const s=w(this.viewModel.inputs);let i;if("backward"===e&&s.reverse(),t)if(C(t)){const e=t.inputs.find((e=>e.visible));i=e?s.indexOf(e):0}else{let o;if(S(t)&&!t.group.open){const s=t.group.inputs.filter(F);o="forward"===e?s[s.length-1]:s[0]}else o=t;i=s.indexOf(o)+1}else i=0;for(let e=i;e<s.length;e++){const t=s[e];if(t.visible&&F(t))return t}return null}_renderLabeledField(e){const{dataType:t,feature:s,label:i,layer:o,required:r}=e,n={"aria-label":r?P(this.messages.requiredFieldLabel,{name:i}):i,class:z.label,key:`${o.id}-${s.uid}-${e.name}`},a=[k("div",{class:z.labelTextContent,key:"labelTextContainer"},i,r?k("span",{"aria-hidden":"true",title:this.messagesCommon.required},"*"):void 0),"unsupported"!==t?this._renderFieldInput(e):this._renderReadOnlyComponent(e),this._renderAuxiliaryText(e)];return"date"===t&&"coded-value"!==e.domain?.type?k("label",{...n},a):k("calcite-label",{...n},a)}_renderFieldInput(e){const{dataType:t,domain:s,inputType:i,name:o}=e,r=this.getCommonInputProps(e);if("coded-value"===s?.type){const t=this.viewModel.getFieldValueOptionsForField(o,this.messages.empty);return"switch"!==i||e.hasInvalidSwitchValue?"radio-buttons"===i?this._renderRadioButtonComponents(e,t.flat(),r):this._renderComboBoxComponent(e,t,r):this._renderSwitchComponent(e,r)}return"datetime-picker"===i||"date"===t?this._renderDateComponents(e,r):"number"===t?this._renderNumberComponent(e,r):this._renderStringComponent(e,r)}_renderStringComponent(e,t){return"text-area"===e.inputType?t.readOnly?k("calcite-input",{...t,loading:e.updating,type:"textarea",onCalciteInputInput:e=>this._saveValueFromComponent(e.target)}):k("calcite-text-area",{...t,resize:"vertical",onCalciteTextAreaInput:e=>this._saveValueFromComponent(e.target)}):k("calcite-input",{...t,loading:e.updating,type:"text",onCalciteInputInput:e=>this._saveValueFromComponent(e.target)})}_renderNumberComponent(e,t){return k("calcite-input-number",{...t,integer:l(e.field),loading:e.updating,type:"number",onCalciteInputNumberInput:e=>this._saveValueFromComponent(e.target)})}_renderDateComponents(e,t){const{field:s}=e;switch(s.type){case"date":return this._renderDateFieldComponents(e,t);case"date-only":return this._renderDateOnlyFieldComponent(e,t);case"time-only":return this._renderTimeOnlyFieldComponent(e,t);case"timestamp-offset":return this._renderTimestampOffsetFieldComponents(e,t);default:return this._renderReadOnlyComponent(e,p(s,t.value,{timeZone:this.timeZone,...m(s)}))}}_renderDateOnlyFieldComponent(e,t){const{range:s,valid:i,value:o}=e,{class:r,key:n,readOnly:a}=t,{rawMax:l,rawMin:p}=s;return k("calcite-input-date-picker",{afterCreate:this._afterDateComponentCreate,afterUpdate:this._afterDateComponentCreateOrUpdate,"aria-invalid":!i,class:r,"data-date-part":"date","data-field-name":t[Q],key:`${n}-date-input`,max:u(l)?l:void 0,min:u(p)?p:void 0,numberingSystem:d,onblur:e=>{this._focusedFieldName=null,this._saveValueFromDateComponent(e.target)},onfocus:this._onComponentFocus,overlayPositioning:"fixed",readOnly:a,value:null!=o?`${o}`:void 0,onCalciteInputDatePickerChange:e=>this._saveValueFromDateComponent(e.target)})}_renderTimeOnlyFieldComponent(e,t){const{valid:s,value:i}=e,{class:o,key:r,readOnly:n}=t;return k("calcite-input-time-picker",{afterCreate:this._afterDateComponentCreate,afterUpdate:this._afterDateComponentCreateOrUpdate,"aria-invalid":!s,class:o,"data-date-part":"time","data-field-name":t[Q],key:`${r}-time-input`,numberingSystem:d,onblur:e=>{this._focusedFieldName=null,this._saveValueFromDateComponent(e.target)},onfocus:this._onComponentFocus,overlayPositioning:"fixed",readOnly:n,step:e.timeStep,value:null!=i?`${i}`:void 0,onCalciteInputTimePickerChange:e=>this._saveValueFromDateComponent(e.target)})}_renderTimestampOffsetFieldComponents(e,t){const{name:s,range:i,timeZone:o,valid:r,value:n}=e,{class:a,key:l,readOnly:p}=t,{rawMax:m,rawMin:u}=i,h={afterCreate:this._afterDateComponentCreate,afterUpdate:this._afterDateComponentCreateOrUpdate,"aria-invalid":!r,numberingSystem:d,overlayPositioning:"fixed",readOnly:p,[Q]:s,onfocus:this._onComponentFocus},b=c(m,o),y=c(u,o),j=c(n,o);return k("div",{class:z.dateInputContainer,key:`${l}-date-time-container`},k("calcite-input-date-picker",{...h,class:a,"data-date-part":"date",key:`${l}-date-input`,max:b?.date??void 0,min:y?.date??void 0,onblur:e=>{this._focusedFieldName=null,this._saveValueFromDateComponent(e.target)},value:j.date??void 0,onCalciteInputDatePickerChange:e=>this._saveValueFromDateComponent(e.target)}),k("calcite-input-time-picker",{...h,class:a,"data-date-part":"time",key:`${l}-time-input`,onblur:e=>{this._focusedFieldName=null,this._saveValueFromDateComponent(e.target)},step:e.timeStep,value:j.time??void 0,onCalciteInputTimePickerChange:e=>this._saveValueFromDateComponent(e.target)}),e.includeTimeOffset?k("calcite-input-time-zone",{...h,class:a,"data-date-part":"timeZone",disabled:p,key:`${l}-timezone-input`,onblur:e=>{this._focusedFieldName=null,this._saveValueFromDateComponent(e.target)},value:j.timeZoneOffset??"0",onCalciteInputTimeZoneChange:e=>this._saveValueFromDateComponent(e.target)}):null)}_renderDateFieldComponents(e,t){const{includeTime:s,name:i,valid:o,value:r}=e,{class:n,key:a,max:l,min:p,readOnly:m}=t,{timeZone:u}=this,c={afterCreate:this._afterDateComponentCreate,afterUpdate:this._afterDateComponentCreateOrUpdate,"aria-invalid":!o,numberingSystem:d,overlayPositioning:"fixed",readOnly:m,[Q]:i,onfocus:this._onComponentFocus},b=h(r,u),y=h(l,u),j=h(p,u);return k("div",{class:z.dateInputContainer,key:`${a}-date-time-container`},k("calcite-input-date-picker",{...c,class:n,"data-date-part":"date",key:`${a}-date-input`,max:y?.date??void 0,min:j?.date??void 0,onblur:e=>{this._focusedFieldName=null,this._saveValueFromDateComponent(e.target)},value:b.date??void 0,onCalciteInputDatePickerChange:e=>this._saveValueFromDateComponent(e.target)}),s?k("calcite-input-time-picker",{...c,class:n,"data-date-part":"time",key:`${a}-time-input`,onblur:e=>{this._focusedFieldName=null,this._saveValueFromDateComponent(e.target)},step:1,value:b.time??void 0,onCalciteInputTimePickerChange:e=>this._saveValueFromDateComponent(e.target)}):null)}_renderReadOnlyComponent(e,t){const s=this.getCommonInputProps(e);return k("calcite-input",{...s,class:this.classes(z.fieldInput,z.inputDisabled),readOnly:!0,type:"text",value:null!=t?`${t}`:s.value})}_renderComboBoxComponent(e,t,s){const{value:i,name:o}=e,{viewModel:r,_inputsWithChanges:n}=this,a="INSERT"===r.arcadeEditType,l=n.has(o),p=null==i&&(!a||l),m=a&&e.showNoValueOptionEnabled&&!l?()=>{}:s.onblur;return k("calcite-combobox",{...s,allowCustomValues:!1,clearDisabled:!0,disabled:s.readOnly,onblur:m,overlayPositioning:"fixed",selectionMode:"single",onCalciteComboboxChange:({target:t})=>{p&&0===t.selectedItems.length?this._ignoreDeselectionOfNoValueOption(t):e.isSubtypeField&&0===t.selectedItems.length?t.value=`${e.value}`:this._saveValueFromComponent(t)}},this.renderComboboxOptionsList(e,t))}renderComboboxOptionsList(e,t){const{value:s,name:i}=e,{messages:o,messagesTemplates:r,viewModel:n,_inputsWithChanges:a}=this,[l,p,m]=t.map((e=>e.map((({name:e,value:t})=>k("calcite-combobox-item",{key:`#${t}`,selected:s===t,textLabel:e,value:`${t}`}))))),u=[];p.length>0&&u.push(k("calcite-combobox-item-group",{key:"other",label:r.other},p)),m.length>0&&u.push(k("calcite-combobox-item-group",{key:"unsupported",label:o.subtypes.unsupportedDomainGroupTitle},m)),u.length>0?u.unshift(k("calcite-combobox-item-group",{key:"recommended",label:o.recommended},l)):u.push(...l);const d="INSERT"===n.arcadeEditType,c=a.has(i),h=null==s&&(!d||c);return e.showNoValueOptionEnabled&&u.unshift(k("calcite-combobox-item",{key:"empty-option",selected:h,textLabel:e.showNoValueLabel||o.empty,value:""})),u}_renderRadioButtonComponents(e,t,s){const{name:i,value:o}=e,r=t.map((({name:e,value:t})=>this._renderRadioButtonComponent({key:e,label:e,name:i,value:t,selected:t===o,props:s})));if(e.showNoValueOptionEnabled){const t="",n=e.showNoValueLabel||this.messages.empty,a=o===t||null===o;r.unshift(this._renderRadioButtonComponent({key:"empty-option",label:n,name:i,value:t,selected:a,props:s}))}return k("calcite-radio-button-group",{afterCreate:this._afterRadioGroupCreateOrUpdate,afterUpdate:this._afterRadioGroupCreateOrUpdate,class:z.inputRadioGroup,"data-field-name":s[Q],key:`${s.key}-radio-group`,layout:"vertical",name:s.key,required:s.required},r)}_renderSwitchComponent(e,t){const{value:s}=e,i=!!O(e.element,"switch")&&s===e.element.input.onValue;return k("calcite-switch",{...t,checked:i,class:z.inputSwitch,disabled:t.readOnly,onblur:()=>{this._focusedFieldName=null},onCalciteSwitchChange:e=>this._saveValueFromComponent(e.target)})}_renderRadioButtonComponent({key:e,name:t,value:s,selected:i,label:o,props:r}){return k("calcite-label",{class:z.inputRadioLabel,key:e,layout:"inline"},k("calcite-radio-button",{...r,afterCreate:void 0,afterUpdate:void 0,checked:i,class:z.inputRadio,disabled:r.readOnly,name:t,onblur:()=>{this._focusedFieldName=null},value:s,onCalciteRadioButtonChange:({target:e})=>{e.checked&&this._saveValueFromComponent(e)}}),o)}_renderAuxiliaryText(e){const t=e.name,s=this._inputsWithChanges.has(t)&&!e.valid?x(e,this.messages,this.timeZone):null!=this.viewModel.contingencyConstraintViolations.get(t)?this.messages.validationErrors.valuesIncompatible:null!=e.valueExpressionExecutor&&e.valueExpressionExecutor.stale?this.messages.valueExpressionError:null;return null!=s?k("calcite-input-message",{icon:!0,status:"invalid"},s):this._inputsWithChanges.has(t)&&e.valueIsOutOfDomain?k("calcite-input-message",{icon:!0,status:"idle"},this.messages.subtypes.fieldOutOfSubtypeDomainWarning):this._renderDescriptionOrEmpty(e.description)}_renderShowAllRelatedRecordsListItem(e){const{featureCount:t,relationshipId:s,showAllActionVisible:i}=e,{relatedRecordCallbacks:o}=this;if(!i||!o?.showAllRelatedRecords)return;const r=this.messages;return k("calcite-list-item",{description:P(r.totalCount,{count:t}),label:r.showAll,value:!0,onCalciteListItemSelect:()=>this._onShowAllRelatedRecordsClick(s)},k("calcite-icon",{icon:"list",scale:"s",slot:"content-end"}))}_renderAddRelatedRecordButton(e){const{canAddRelatedFeature:t,relationshipId:s,relatedLayer:i}=e,{messages:o,relatedRecordCallbacks:r}=this;if(t&&r?.addRelatedRecord&&i)return k("calcite-button",{alignment:"center",appearance:"outline-fill",class:z.centeredButton,disabled:e.updating||!e.originHasValidKey,iconStart:"plus",key:`${s}-add-button`,onclick:()=>{!e.updating&&e.originHasValidKey&&this._onAddRelatedRecordsClick(s,i)},round:!0,scale:"s",width:"half"},e.relatedLayerIsTable?o.addRecord:o.addFeature)}_renderRelatedRecordListItem(e,t){const{feature:s,description:i,title:o}=e,{feature:r,relatedRecordCallbacks:n}=this,{highlightHelper:a}=this.viewModel,l=a?()=>a.add(s):void 0,p=a?()=>a.remove(s):void 0;return k("calcite-list-item",{bind:this,description:i,key:`${t}-${s.uid}`,label:o,onclick:()=>{a?.removeAll(),n?.editRelatedRecord&&r&&n.editRelatedRecord({parentFeature:r,relationshipId:t,relatedFeature:s})},onmouseenter:l,onmouseleave:p,value:o},k("calcite-icon",{icon:D(s),slot:"content-start"}),k("calcite-icon",{icon:"chevron-right",scale:"s",slot:"content-end"}))}_renderRelationshipInput(e){if(!this._relatedRecordsEnabled||!e.editable)return;const{featureCount:t,relationshipId:s,showAllEnabled:i}=e,o=i?null:this._renderDescriptionOrEmpty(e.description),r=t>0?this._renderRelatedRecordsList(e):e.loaded?e.originHasValidKey?this._renderNoRelatedRecordsNotice():this._renderNoValidOriginKeyNotice(e):void 0;return k("calcite-label",{class:this.classes(z.label,z.relatedRecordsLabel),key:`relationship-${s}-container`},k("div",null,this._renderRelatedRecordsHeaderContainer(e),o,r),this._renderAddRelatedRecordButton(e))}_renderRelatedRecordsHeaderContainer(e){const t=e.updating||!e.loaded;return k("div",{class:z.relatedRecordsHeader,key:`relationship-${e.relationshipId}-header`},k("span",null,e.label),t?k("calcite-loader",{inline:!0,key:"loader",label:this.messagesCommon?.loading,scale:"s",type:"indeterminate"}):void 0)}_renderRelatedRecordsList(e){const{relationshipId:t}=e;return k("calcite-list",{class:z.relatedRecordsList},e.relatedFeatureInfos.map((e=>this._renderRelatedRecordListItem(e,t))),this._renderShowAllRelatedRecordsListItem(e),this._renderObserverNode())}_renderNoValidOriginKeyNotice(e){const{messages:t}=this,s=e.relatedLayerIsTable?t.noOriginKeyRecord:t.noOriginKeyFeature,i=e.relationship?.keyField,o=this.viewModel.findField(i),r=e.layer?.fieldsIndex.get(i),n=o?.label||r?.alias||i,a=P(s,{relatedLayerName:e.relatedLayer?.title,originKeyField:n});return k("calcite-notice",{icon:"information",kind:"brand",open:!0,scale:"s",width:"full"},k("div",{slot:"message"},a))}_renderNoRelatedRecordsNotice(){return k("calcite-notice",{icon:"information",kind:"brand",open:!0,scale:"s",width:"full"},k("div",{slot:"message"},this.messagesFeature.noRelatedFeatures))}_renderObserverNode(){if(this.viewModel.activeRelationshipInput?.showAllEnabled)return k("div",{afterCreate:this._afterListObserverCreated,afterRemoved:this._afterListObserverRemoved,bind:this,class:z.listObserver,key:"feature-observer"})}_renderTextElementInput(e){return k("div",{class:z.textElement,innerHTML:e.text,key:e.id})}getCommonInputProps(e){const{disabled:t}=this,{editable:s,hint:i,label:o,maxLength:r,minLength:n,name:a,range:{max:l,min:p},required:m,valid:u,value:d}=e,c=this._inputsWithChanges.has(a),h=!s||t;return{afterCreate:this._afterComponentCreate,afterUpdate:this._afterComponentCreateOrUpdate,"aria-invalid":u?"false":"true",class:this.classes(z.fieldInput,h?z.inputDisabled:null),status:c&&!u?"invalid":"idle",key:a,label:o,max:null!=l?l:void 0,min:null!=p?p:void 0,maxLength:r>-1?r:void 0,minLength:n>-1?n:void 0,placeholder:i??void 0,readOnly:h,required:m,value:null==d?"":`${d}`,onblur:this._onComponentBlur,onfocus:this._onComponentFocus,onkeydown:this._onComponentKeyDown,[Q]:a}}_getFieldInputFromHTMLElement(e){return this.viewModel.findField(e.getAttribute(Q))}_afterDateComponentCreate(e){const t=this._getFieldInputFromHTMLElement(e),s=e.dataset.datePart,i=this._dateComponentMap.get(t.name);if("valueAsDate"in e&&null!=e.value){const s=new ResizeObserver((()=>{switch(e.value=void 0,t.field.type){case"date":e.value=h(t.value,this.timeZone).date??"";break;case"timestamp-offset":e.value=c(t.value,this.timeZone).date??"";break;default:e.value=`${t.value}`}s.unobserve(e)}));s.observe(e)}if(null!=i)switch(s){case"date":i.date=e;break;case"time":i.time=e;break;case"timeZone":i.timeZone=e}else this._dateComponentMap.set(t.name,{[s]:e});this._afterDateComponentCreateOrUpdate(e)}_afterDateComponentCreateOrUpdate(e){this._afterComponentCreateOrUpdate(e)}_afterComponentCreate(e){const t=this._getFieldInputFromHTMLElement(e);M(t)&&null!=e.value&&"setNumberValue"in e&&e.setNumberValue({committing:!1,value:e.value,origin:"direct"}),this._afterComponentCreateOrUpdate(e)}_afterRadioGroupCreateOrUpdate(e){const t=e.selectedItem,s=e.querySelector("calcite-radio-button"),i=t||s;i&&this._afterComponentCreateOrUpdate(i)}_afterComponentCreateOrUpdate(e){const{viewModel:t}=this,s=this._getFieldInputFromHTMLElement(e),i=t.findField(this._focusedFieldName);this._attemptFocusOnNextRender&&i===s&&(this._attemptFocusOnNextRender=!1,S(s)&&(s.group.open=!0),e.setFocus())}_onComponentFocus(e){const t=e.target,s=this._getFieldInputFromHTMLElement(t);this._focusedFieldName=s.name}_onComponentBlur(e){const t=e.target;this._focusedFieldName=null,this._saveValueFromComponent(t)}_saveValueFromDateComponent(e){const{timeZone:t}=this,s=this._getFieldInputFromHTMLElement(e),i=s.field.type,{name:o,range:r}=s,n=this._dateComponentMap.get(o);if(!n)return;let a=this.viewModel.getValue(o),l=null;"date-only"===i?l=Array.isArray(e.value)?e.value[0]:e.value:"time-only"===i?(a=b(a),l=b(e.value)):l="timestamp-offset"===i?null!=e.value?y({dateComponent:n.date,timeComponent:n.time,timeZoneComponent:n.timeZone,oldValue:a,defaultTimeZone:t}):null:null!=e.value?j({oldValue:a,dateComponent:n.date,timeComponent:n.time,timeZone:t,max:r.max,min:r.min}):null,null!==l&&e.value?a!==l&&this._updateFieldValue(o,l):this._updateFieldValue(o,null)}_saveValueFromComponent(e){const t=this._getFieldInputFromHTMLElement(e),s=this._parseValue(e),i=t.value;t.isSubtypeField&&L(this.layer,i,s)?this._pendingSubtypeChoice||s===i||(this._pendingSubtypeChoice=this._handleSubtypeChoice(t,s)):this._updateFieldValue(t.name,s)}async _handleSubtypeChoice(e,t){const{value:s,name:o}=e,{layer:r,messages:n,viewModel:a,messagesCommon:l}=this;if(this._updateFieldValue(o,t),!r||!("subtypes"in r)||!r.subtypes?.length)return;const p=r.subtypes.find((e=>e.code===t)),m=r.subtypes.find((e=>e.code===s))?.name??`${s}`;if(!p)return;a.hasPendingSubtypeChoice=!0;const u=i();let d="update-fields";const c=[{label:n.subtypes.useDefaultValuesOption,value:"update-fields"},{label:n.subtypes.keepCurrentValuesOption,value:"keep-existing"}],h={context:"info",title:n.subtypes.changeWarningTitle,message:P(n.subtypes.changeWarning,{originalType:m,newType:p.name}),radios:c,defaultRadioSelection:"update-fields",onRadioSelection:e=>d=e,actions:{primary:{label:l.apply,action:()=>u.resolve(d),type:"positive"},secondary:{label:l.cancel,type:"neutral",action:()=>u.resolve("undo")}},cancel:()=>u.reject()};try{switch(this.showPrompt(h),await u.promise){case"update-fields":a.applySubtypeDefaults(p),this._validateContingenciesForNonNullFields();break;case"keep-existing":this._validateContingenciesForNonNullFields();break;case"undo":this._updateFieldValue(e.name,s)}}finally{a.hasPendingSubtypeChoice=!1,this.clearPrompt(),this._pendingSubtypeChoice=null}}_onComponentKeyDown({key:e,target:t}){const s=this._getFieldInputFromHTMLElement(t);"Enter"===e&&S(s)&&!s.group.open&&(s.group.open=!0)}_updateFieldValue(e,t){const s=this.viewModel.getValue(e);this.viewModel.setValue(e,t),this._inputsWithChanges.add(e),s!==t&&this.viewModel.fieldsWithContingentValues.has(e)&&this._validateContingenciesForNonNullFields()}_validateContingenciesForNonNullFields(){const e=Object.fromEntries(Object.entries(this.getValues()).filter((([e,t])=>null!=t)));this.viewModel.validateContingencyConstraints(e)}_parseValue(e){const t=this._getFieldInputFromHTMLElement(e),s=e.value;return O(t.element,"switch")?e.checked?t.element.input.onValue:t.element.input.offValue:null==s||""===s?null:"number"===t.dataType?"-0"===s||"-0."===s||"-0,"===s?s:parseFloat(s):"date"===t.field.type?parseFloat(s):s}_ignoreDeselectionOfNoValueOption(e){const{firstChild:t,selectedItems:i}=e;0===i.length&&t&&"selected"in t?t.selected=!0:s.getLogger(this).warnOnce("Failed to override user attempt to deselect 'No value' option.")}_onGroupToggle(e,t){e.open?(t.open=!0,this._focusedFieldName=this._getFocusableInput("forward",t)?.name||null,this._attemptFocusOnNextRender=!0,"sequential"===this.groupDisplay&&this.viewModel.allGroupInputs.forEach((e=>{e!==t&&(e.open=!1)}))):t.open=!1,this.scheduleRender()}_onFormSubmit(e){e.preventDefault()}_onFormKeyDown(e){"Enter"===e.key&&this.viewModel.submit()}_afterListObserverCreated(e){this.viewModel.activeRelationshipInput&&(this._listObserverNode=e)}_afterListObserverRemoved(){this._listObserverNode=null}_onObserverChange(){this._listObserverNode&&this._listObserver.unobserve(this._listObserverNode);const e=this.viewModel.activeRelationshipInput;e&&this._listObserverNode&&e.showAllEnabled&&this._listObserver.observe(this._listObserverNode)}_incrementRelatedRecordPage(){const e=this.viewModel.activeRelationshipInput;e?.incrementPage()}_syncGroupInputStates(){if("sequential"!==this.groupDisplay)return;const e=this.viewModel.allGroupInputs;if(!e.length)return;const t=e.filter((e=>e.open));0===t.length?e[0].open=!0:t.length>1&&t.slice(1).forEach((e=>e.open=!1))}get test(){return{inputsWithChanges:this._inputsWithChanges}}};e([n()],J.prototype,"_listObserverNode",void 0),e([n()],J.prototype,"_relatedRecordsEnabled",null),e([n()],J.prototype,"_prompt",void 0),e([n()],J.prototype,"disabled",null),e([n()],J.prototype,"feature",null),e([n()],J.prototype,"formTemplate",null),e([n()],J.prototype,"groupDisplay",void 0),e([n()],J.prototype,"headingLevel",void 0),e([n()],J.prototype,"icon",null),e([n()],J.prototype,"label",null),e([n()],J.prototype,"layer",null),e([n()],J.prototype,"map",null),e([n(),T("esri/widgets/FeatureForm/t9n/FeatureForm")],J.prototype,"messages",void 0),e([n(),T("esri/t9n/common")],J.prototype,"messagesCommon",void 0),e([n(),T("esri/widgets/Feature/t9n/Feature")],J.prototype,"messagesFeature",void 0),e([n(),T("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],J.prototype,"messagesTemplates",void 0),e([n()],J.prototype,"relatedRecordCallbacks",null),e([n()],J.prototype,"relationshipId",null),e([n()],J.prototype,"spatialReference",null),e([n()],J.prototype,"strict",null),e([n()],J.prototype,"timeZone",null),e([n()],J.prototype,"showPrompt",null),e([n()],J.prototype,"clearPrompt",null),e([n(),N(["value-change","submit"])],J.prototype,"viewModel",void 0),e([n()],J.prototype,"test",null),J=e([a("esri.widgets.FeatureForm")],J);const X=J;export{H as P,X as default,B as l,E as w};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.30/esri/copyright.txt for details.
*/
import{_ as e}from"../../chunks/tslib.es6.js";import"../../geometry.js";import t from"../../PopupTemplate.js";import"../../renderers/ClassBreaksRenderer.js";import"../../renderers/DictionaryRenderer.js";import"../../renderers/DotDensityRenderer.js";import"../../renderers/HeatmapRenderer.js";import"../../renderers/PieChartRenderer.js";import"../../renderers/Renderer.js";import"../../renderers/SimpleRenderer.js";import"../../renderers/UniqueValueRenderer.js";import{fromJSON as r,r as o}from"../../renderers/support/jsonUtils.js";import{clone as s}from"../../core/lang.js";import{M as i}from"../../chunks/MultiOriginJSONSupport.js";import"../../core/workers/workers.js";import{property as n}from"../../core/accessorSupport/decorators/property.js";import{L as a}from"../../chunks/Logger.js";import{subclass as p}from"../../core/accessorSupport/decorators/subclass.js";import{w as l}from"../../chunks/writer.js";import m,{O as u}from"../../core/Accessor.js";import{initializeProjection as c,project as d}from"../../geometry/projection.js";import h from"../../geometry/SpatialReference.js";import{w as y}from"../../chunks/unitUtils.js";import f from"../Layer.js";import{F as j}from"../../chunks/FeatureStore.js";import{Q as g}from"../../chunks/QueryEngine.js";import{d as b,c as T}from"../../chunks/clientSideDefaults.js";import k from"../../core/Error.js";import{g as w}from"../../chunks/ensureType.js";import{parseWhereClause as I}from"../../core/sql.js";import S from"../../geometry/Polygon.js";import{b as E}from"../../chunks/featureConversionUtils.js";import{O as D}from"../../chunks/OptimizedFeature.js";import{fromJSON as M}from"../../geometry/support/jsonUtils.js";import L from"../../request.js";import"../../chunks/aaBoundingBox.js";import"../../chunks/mathUtils.js";import R from"../../geometry/Extent.js";import"../../geometry/Geometry.js";import"../../geometry/Multipoint.js";import"../../geometry/Point.js";import N from"../../geometry/Polyline.js";import{g as C,executeQueryStreaming as v}from"../../rest/knowledgeGraphService.js";import O from"../../rest/knowledgeGraph/GraphQueryStreaming.js";import x from"../../rest/support/Query.js";import{d as _}from"../../chunks/fieldProperties.js";import{BlendLayer as F,blendModeProperty as A,effectProperty as G}from"../mixins/BlendLayer.js";import{FeatureEffectLayer as U,featureEffectProperty as q}from"../mixins/FeatureEffectLayer.js";import{FeatureReductionLayer as P,f as Q}from"../mixins/FeatureReductionLayer.js";import{OrderedLayer as V,orderByProperty as $}from"../mixins/OrderedLayer.js";import{RefreshableLayer as B}from"../mixins/RefreshableLayer.js";import{ScaleRangeLayer as J}from"../mixins/ScaleRangeLayer.js";import{TemporalLayer as H,useViewTimeProperty as Y}from"../mixins/TemporalLayer.js";import{l as z,a as W,m as K,b as Z,o as X,p as ee}from"../../chunks/commonProperties2.js";import te from"../support/Field.js";import{fixRendererFields as re}from"../support/fieldUtils.js";import oe from"../support/LabelClass.js";import{r as se}from"../../chunks/labelingInfo.js";import ie from"../../rest/support/FeatureSet.js";import{createPopupTemplate as ne}from"../../support/popupUtils.js";import ae from"../../core/workers/RemoteClient.js";import{f as pe}from"../../chunks/typeUtils.js";import"../../config.js";import"../../chunks/utils.js";import"../../chunks/handleUtils.js";import"../../chunks/metadata.js";import"../../chunks/tracking.js";import"../../chunks/jsonMap.js";import"../../chunks/assets.js";import"../../core/urlUtils.js";import"../../core/JSONSupport.js";import"../../core/Handles.js";import"../../chunks/maybe.js";import"../../chunks/ObservableBase.js";import"../../core/scheduling.js";import"../../core/promiseUtils.js";import"../../kernel.js";import"../../geometry/support/webMercatorUtils.js";import"../../chunks/reader.js";import"../../chunks/zmUtils.js";import"../../core/accessorSupport/decorators/cast.js";import"../../chunks/coordsUtils.js";import"../../chunks/Axis.js";import"../../chunks/extentUtils.js";import"../../chunks/aaBoundingRect.js";import"../../chunks/vec3.js";import"../../chunks/vec3f64.js";import"../../chunks/common.js";import"../../core/Clonable.js";import"../../core/Collection.js";import"../../core/Evented.js";import"../../chunks/shared.js";import"../../chunks/SimpleObservable.js";import"../../popup/content.js";import"../../popup/content/AttachmentsContent.js";import"../../popup/content/Content.js";import"../../popup/content/CustomContent.js";import"../../popup/content/ExpressionContent.js";import"../../popup/ElementExpressionInfo.js";import"../../popup/content/FieldsContent.js";import"../../popup/FieldInfo.js";import"../../chunks/enumeration.js";import"../../popup/support/FieldInfoFormat.js";import"../../chunks/date.js";import"../../chunks/locale.js";import"../../chunks/timeZoneUtils.js";import"../../chunks/datetime.js";import"../../popup/content/MediaContent.js";import"../../popup/content/BarChartMediaInfo.js";import"../../popup/content/mixins/ChartMediaInfo.js";import"../../popup/content/mixins/MediaInfo.js";import"../../popup/content/support/ChartMediaInfoValue.js";import"../../Color.js";import"../../chunks/colorUtils.js";import"../../popup/content/support/ChartMediaInfoValueSeries.js";import"../../chunks/chartMediaInfoUtils.js";import"../../popup/content/ColumnChartMediaInfo.js";import"../../popup/content/ImageMediaInfo.js";import"../../popup/content/support/ImageMediaInfoValue.js";import"../../popup/content/LineChartMediaInfo.js";import"../../popup/content/PieChartMediaInfo.js";import"../../popup/content/RelationshipContent.js";import"../../popup/support/RelatedRecordsInfoFieldOrder.js";import"../../popup/content/TextContent.js";import"../../popup/ExpressionInfo.js";import"../../popup/LayerOptions.js";import"../../popup/RelatedRecordsInfo.js";import"../../support/actions/ActionBase.js";import"../../core/Identifiable.js";import"../../support/actions/ActionButton.js";import"../../support/actions/ActionToggle.js";import"../../intl.js";import"../../chunks/number.js";import"../../chunks/substitute.js";import"../../chunks/messages.js";import"../../symbols.js";import"../../symbols/CIMSymbol.js";import"../../symbols/Symbol.js";import"../../symbols/ExtrudeSymbol3DLayer.js";import"../../symbols/Symbol3DLayer.js";import"../../chunks/utils4.js";import"../../symbols/edges/Edges3D.js";import"../../chunks/screenUtils.js";import"../../chunks/materialUtils.js";import"../../chunks/opacityUtils.js";import"../../symbols/edges/SketchEdges3D.js";import"../../symbols/edges/SolidEdges3D.js";import"../../chunks/Symbol3DMaterial.js";import"../../symbols/FillSymbol.js";import"../../symbols/SimpleLineSymbol.js";import"../../symbols/LineSymbol.js";import"../../symbols/LineSymbolMarker.js";import"../../chunks/lineMarkers.js";import"../../symbols/FillSymbol3DLayer.js";import"../../symbols/patterns/LineStylePattern3D.js";import"../../symbols/patterns/StylePattern3D.js";import"../../chunks/utils5.js";import"../../chunks/colors.js";import"../../chunks/symbolLayerUtils3D.js";import"../../symbols/Font.js";import"../../symbols/IconSymbol3DLayer.js";import"../../chunks/persistableUrlUtils.js";import"../../symbols/LabelSymbol3D.js";import"../../symbols/Symbol3D.js";import"../../chunks/collectionUtils.js";import"../../portal/Portal.js";import"../../core/Loadable.js";import"../../core/Promise.js";import"../../portal/PortalGroup.js";import"../../portal/PortalQueryParams.js";import"../../portal/PortalQueryResult.js";import"../../portal/PortalUser.js";import"../../portal/PortalFolder.js";import"../../symbols/LineSymbol3DLayer.js";import"../../symbols/LineStyleMarker3D.js";import"../../symbols/ObjectSymbol3DLayer.js";import"../../symbols/PathSymbol3DLayer.js";import"../../symbols/TextSymbol3DLayer.js";import"../../symbols/WaterSymbol3DLayer.js";import"../../symbols/support/StyleOrigin.js";import"../../chunks/Thumbnail.js";import"../../chunks/calloutUtils.js";import"../../symbols/callouts/Callout3D.js";import"../../symbols/callouts/LineCallout3D.js";import"../../symbols/support/Symbol3DVerticalOffset.js";import"../../symbols/LineSymbol3D.js";import"../../symbols/MarkerSymbol.js";import"../../symbols/MeshSymbol3D.js";import"../../symbols/PictureFillSymbol.js";import"../../chunks/urlUtils.js";import"../../symbols/PictureMarkerSymbol.js";import"../../symbols/PointSymbol3D.js";import"../../symbols/PolygonSymbol3D.js";import"../../core/reactiveUtils.js";import"../../chunks/asyncUtils.js";import"../../symbols/SimpleFillSymbol.js";import"../../symbols/SimpleMarkerSymbol.js";import"../../symbols/TextSymbol.js";import"../../symbols/WebStyleSymbol.js";import"../../renderers/mixins/VisualVariablesMixin.js";import"../../renderers/visualVariables/ColorVariable.js";import"../../renderers/visualVariables/VisualVariable.js";import"../../chunks/LegendOptions.js";import"../../renderers/visualVariables/support/ColorStop.js";import"../../renderers/visualVariables/OpacityVariable.js";import"../../renderers/visualVariables/support/OpacityStop.js";import"../../renderers/visualVariables/RotationVariable.js";import"../../renderers/visualVariables/SizeVariable.js";import"../../renderers/visualVariables/support/SizeStop.js";import"../../chunks/sizeVariableUtils.js";import"../../chunks/visualVariableUtils.js";import"../../Graphic.js";import"../../chunks/compilerUtils.js";import"../../chunks/lengthUtils.js";import"../../renderers/support/ClassBreakInfo.js";import"../../chunks/commonProperties.js";import"../../symbols/support/jsonUtils.js";import"../../chunks/layerUtils2.js";import"../../chunks/defaults.js";import"../../chunks/defaultsJSON.js";import"../../renderers/support/AuthoringInfo.js";import"../../renderers/support/AuthoringInfoVisualVariable.js";import"../../chunks/colorRamps.js";import"../../rest/support/AlgorithmicColorRamp.js";import"../../rest/support/ColorRamp.js";import"../../rest/support/MultipartColorRamp.js";import"../../chunks/LRUCache.js";import"../../chunks/MemCache.js";import"../../chunks/Version.js";import"../support/FieldsIndex.js";import"../../chunks/UnknownTimeZone.js";import"../../chunks/OverrideHelper.js";import"../../chunks/colorUtils2.js";import"../../chunks/vec4.js";import"../../chunks/vec4f64.js";import"../../chunks/utils7.js";import"../../chunks/quantizationUtils.js";import"../../renderers/support/AttributeColorInfo.js";import"../../renderers/support/HeatmapColorStop.js";import"../../chunks/heatmapUtils.js";import"../../chunks/diffUtils.js";import"../../renderers/support/UniqueValue.js";import"../../renderers/support/UniqueValueClass.js";import"../../renderers/support/UniqueValueGroup.js";import"../../renderers/support/UniqueValueInfo.js";import"../../chunks/styleUtils.js";import"../../core/workers/Connection.js";import"../../chunks/Queue.js";import"../../chunks/projectBuffer.js";import"../../chunks/geodesicConstants.js";import"../../geometry/support/GeographicTransformation.js";import"../../geometry/support/GeographicTransformationStep.js";import"../../chunks/zscale.js";import"../../TimeExtent.js";import"../../chunks/timeUtils.js";import"../../chunks/BoundsStore.js";import"../../chunks/PooledRBush.js";import"../../chunks/quickselect.js";import"../../chunks/_commonjsHelpers.js";import"../../chunks/timeSupport.js";import"../../geometry/support/normalizeUtils.js";import"../../chunks/normalizeUtilsCommon.js";import"../../chunks/simplify.js";import"../../chunks/utils8.js";import"../../chunks/utils9.js";import"../../chunks/projectionSupport.js";import"../../chunks/json.js";import"../../chunks/OptimizedGeometry.js";import"../../chunks/optimizedFeatureQueryEngineAdapter.js";import"../../chunks/centroid.js";import"../../core/sql/WhereClause.js";import"../../chunks/TimeOnly.js";import"../../chunks/fieldType.js";import"../../chunks/QueryEngineCapabilities.js";import"../../chunks/utils12.js";import"../../chunks/utils2.js";import"../../chunks/basemapUtils.js";import"../../Basemap.js";import"../../chunks/loadAll.js";import"../../portal/PortalItem.js";import"../../portal/PortalItemResource.js";import"../../portal/PortalRating.js";import"../../support/BasemapStyle.js";import"../../chunks/writeUtils.js";import"../../chunks/utils3.js";import"../../chunks/mat4.js";import"../../chunks/utils10.js";import"../../chunks/generateRendererUtils.js";import"../../chunks/SnappingCandidate.js";import"../../chunks/Scheduler.js";import"../../core/signal.js";import"../../chunks/debugFlags.js";import"../../chunks/OptimizedFeatureSet.js";import"../../rest/knowledgeGraph/GraphQueryResult.js";import"../../chunks/GraphQueryResultHeader.js";import"../../rest/knowledgeGraph/GraphQueryStreamingResult.js";import"../../rest/knowledgeGraph/KnowledgeGraph.js";import"../../rest/knowledgeGraph/DataModel.js";import"../../rest/knowledgeGraph/EntityType.js";import"../../rest/knowledgeGraph/GraphObjectType.js";import"../../rest/knowledgeGraph/FieldIndex.js";import"../../rest/knowledgeGraph/GraphProperty.js";import"../../rest/knowledgeGraph/RelationshipType.js";import"../../rest/knowledgeGraph/ServiceDefinition.js";import"../../rest/knowledgeGraph/Entity.js";import"../../rest/knowledgeGraph/GraphNamedObject.js";import"../../rest/knowledgeGraph/GraphObject.js";import"../../rest/knowledgeGraph/Relationship.js";import"../../rest/knowledgeGraph/SearchIndex.js";import"../../chunks/ObjectValue.js";import"../../rest/knowledgeGraph/Path.js";import"../../rest/knowledgeGraph/GraphApplyEditsResult.js";import"../../rest/knowledgeGraph/GraphQuery.js";import"../../chunks/DataLayerSource.js";import"../../chunks/FullTextSearch.js";import"../../chunks/spatialRelationships.js";import"../../rest/support/StatisticDefinition.js";import"../../chunks/domains.js";import"../support/CodedValueDomain.js";import"../support/Domain.js";import"../support/InheritedDomain.js";import"../support/RangeDomain.js";import"../../chunks/jsonUtils.js";import"../../chunks/parser.js";import"../support/FeatureEffect.js";import"../support/FeatureFilter.js";import"../support/AggregateField.js";import"../support/ExpressionInfo.js";import"../../chunks/layerContainerType.js";import"../../chunks/FeatureReduction.js";import"../support/FeatureReductionBinning.js";import"../../chunks/featureLayerUtils.js";import"../../chunks/featureQueryAll.js";import"../../rest/support/AttachmentQuery.js";import"../../rest/support/RelationshipQuery.js";import"../../chunks/ElevationInfo.js";import"../../chunks/unitConversionUtils.js";import"../../chunks/labelUtils.js";import"../support/FeatureReductionCluster.js";import"../support/FeatureReductionSelection.js";import"../../chunks/clusterUtils.js";import"../../chunks/MD5.js";import"../../chunks/OrderByInfo.js";import"../../TimeInterval.js";import"../support/TimeInfo.js";class le{constructor(){this._featureLookup=new Map}static getInstance(){return le.instance||(le.instance=new le),le.instance}static resetInstance(){le.instance&&(le.instance=null)}deleteFromStore(e){e.forEach((e=>{this._featureLookup.delete(e)}))}readFromStoreByList(e){const t=[];return e.forEach((e=>{const r=this.readFromStoreById(e);r&&t.push(r)})),t}readFromStoreById(e){return this._featureLookup.get(e)??null}writeToStore(e,t,r){const o=[];return e.forEach((e=>{if(!e?.id)return;e.properties||(e.properties=[]);let s,i=null;if(r&&e.properties[r]&&(i=E(e.properties[r])),"originId"in e&&"destinationId"in e&&(e.properties.ESRI__ORIGIN_ID=e.originId,e.properties.ESRI__DESTINATION_ID=e.destinationId),e.properties[t]=e.id,e.id&&this._featureLookup.has(e.id)&&this._featureLookup.get(e.id).attributes){const o=this._featureLookup.get(e.id),n=JSON.parse(JSON.stringify(Object.assign(o.attributes,e.properties)));r&&e.properties[r]&&(n[r]=M(e.properties[r])),s=new D(i?JSON.parse(JSON.stringify(i)):o?.geometry?JSON.parse(JSON.stringify(o.geometry)):null,n,null,e.properties[t])}else s=new D(i?JSON.parse(JSON.stringify(i)):null,e.properties,null,e.properties[t]);this._featureLookup.set(e.id,s),o.push(s)})),o}}var me,ue,ce,de,he,ye,fe;function je(e){if(!e.spatialReference.isWGS84)throw new k("knowledge-graph:layer-support-utils","The extentToInBoundsRings function only supports WGS84 spatial references.");return e.clone().normalize().map((e=>[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]))}async function ge(e,t){const r=[],o=new Map,s=[];if(t.dataModel?.relationshipTypes)for(const e of t.dataModel.relationshipTypes)e.name&&o.set(e.name,[]);for(const t of e)o.has(t.typeName)&&o.get(t.typeName)?.push(t.id);for(const[e,i]of o){if(i.length<1)continue;const o=new O({openCypherQuery:`MATCH (n)-[r:${e}]->(m) WHERE id(r) in $ids RETURN id(n), labels(n)[0], id(m), labels(m)[0]`,bindParameters:{ids:i}});s.push(v(t,o).then((async e=>{const t=e.resultRowsStream.getReader();for(;;){const{done:e,value:o}=await t.read();if(e)break;for(const e of o)r.push({id:e[0],typeName:e[1]}),r.push({id:e[2],typeName:e[3]})}})))}return await Promise.all(s),r}async function be(e,t){t??=!1;const r={generateAllSublayers:t,namedTypeDefinitions:new Map};return await async function(e){const t=await L(e,{responseType:"array-buffer"}),r=await t.data;return async function(e){const t=new((await C()).MapOfObjectIdentifierSetsDecoder),r=t.decode(new Uint8Array(e)),o=new Map;if(0!==r.error_code)throw new k("knowledge-graph:layer-support-utils",r.error_message);const s=t.get_map_of_identifier_sets(),i=s.keys,n=i.size();for(let e=0;e<n;e++){const t=i.get(e),r=s.query_identifier_set(t),n=[];if(r.id_array_type.value===fe.GLOBALID_ARRAY){const e=r.get_globalid_array(),t=e.count();for(let r=0;r<t;r++)n.push(e.get_globalid_at(r))}else{if(r.id_array_type.value!==fe.IDENTIFIER_ARRAY)throw new k("knowledge-graph:layer-support-utils","Tried to encode an unexpected ID Array type.");{const e=r.get_identifier_array(),t=e.count();for(let r=0;r<t;r++)n.push(e.get_identifier_at(r).toString())}}o.set(t,n)}return t.delete(),o}(new Uint8Array(r))}(e).then((e=>{!function(e,t){for(const[r,o]of e){const e=w(t.namedTypeDefinitions,r,(()=>({useAllData:!1,members:new Map})));for(const t of o)e.members.has(t)||e.members.set(t,{id:t})}}(e,r)})),r}async function Te(e){const t=await C(),r=new t.MapOfObjectIdentifierSets;!function(e,t,r){for(const[o,s]of r.namedTypeDefinitions){if(!s.members||s.useAllData)continue;const r=s.members.keys(),i=new t.GlobalIdArray,n=new t.ObjectIdentifierSet;for(const e of r)i.add_globalid(e);n.set_globalid_array(i),i.delete(),e.put_identifier_set(o,n),n.delete()}}(r,t,e);const o=new t.MapOfObjectIdentifierSetsEncoder;try{o.set_map_of_identifier_sets(r),o.encode();const e=o.get_encoding_result();if(0!==e.error.error_code)throw new k("knowledge-graph:layer-support-utils",e.error.error_message);const t=structuredClone(e.get_byte_buffer());return o.delete(),t}finally{r.delete()}}!function(e){e.ELEMENTUID="ELEMENTUID",e.TYPENAME="TYPENAME"}(me||(me={})),me.ELEMENTUID,me.TYPENAME,function(e){e[e.ELEMENTUID=0]="ELEMENTUID",e[e.TYPENAME=1]="TYPENAME"}(ue||(ue={})),function(e){e[e.ELEMENTUID=0]="ELEMENTUID",e[e.TYPENAME=1]="TYPENAME",e[e.FROMUID=2]="FROMUID",e[e.TOUID=3]="TOUID"}(ce||(ce={})),function(e){e[e.featureResult=0]="featureResult",e[e.countResult=1]="countResult",e[e.idsResult=2]="idsResult"}(de||(de={})),function(e){e[e.upperLeft=0]="upperLeft",e[e.lowerLeft=1]="lowerLeft"}(he||(he={})),function(e){e[e.sqlTypeBigInt=0]="sqlTypeBigInt",e[e.sqlTypeBinary=1]="sqlTypeBinary",e[e.sqlTypeBit=2]="sqlTypeBit",e[e.sqlTypeChar=3]="sqlTypeChar",e[e.sqlTypeDate=4]="sqlTypeDate",e[e.sqlTypeDecimal=5]="sqlTypeDecimal",e[e.sqlTypeDouble=6]="sqlTypeDouble",e[e.sqlTypeFloat=7]="sqlTypeFloat",e[e.sqlTypeGeometry=8]="sqlTypeGeometry",e[e.sqlTypeGUID=9]="sqlTypeGUID",e[e.sqlTypeInteger=10]="sqlTypeInteger",e[e.sqlTypeLongNVarchar=11]="sqlTypeLongNVarchar",e[e.sqlTypeLongVarbinary=12]="sqlTypeLongVarbinary",e[e.sqlTypeLongVarchar=13]="sqlTypeLongVarchar",e[e.sqlTypeNChar=14]="sqlTypeNChar",e[e.sqlTypeNVarChar=15]="sqlTypeNVarChar",e[e.sqlTypeOther=16]="sqlTypeOther",e[e.sqlTypeReal=17]="sqlTypeReal",e[e.sqlTypeSmallInt=18]="sqlTypeSmallInt",e[e.sqlTypeSqlXml=19]="sqlTypeSqlXml",e[e.sqlTypeTime=20]="sqlTypeTime",e[e.sqlTypeTimestamp=21]="sqlTypeTimestamp",e[e.sqlTypeTimestamp2=22]="sqlTypeTimestamp2",e[e.sqlTypeTinyInt=23]="sqlTypeTinyInt",e[e.sqlTypeVarbinary=24]="sqlTypeVarbinary",e[e.sqlTypeVarchar=25]="sqlTypeVarchar"}(ye||(ye={})),function(e){e[e.OID_ARRAY=0]="OID_ARRAY",e[e.GLOBALID_ARRAY=1]="GLOBALID_ARRAY",e[e.STRING_ARRAY=2]="STRING_ARRAY",e[e.IDENTIFIER_ARRAY=3]="IDENTIFIER_ARRAY"}(fe||(fe={}));const ke="ESRI__ID",we="ESRI__ORIGIN_ID",Ie="ESRI__DESTINATION_ID",Se="ESRI__LAYOUT_GEOMETRY",Ee="ESRI__AGGREGATION_COUNT";let De=class extends m{constructor(e){super(e),this._processingCacheUpdatesLookup=new Map,this.knowledgeGraph=null,this.inclusionModeDefinition={generateAllSublayers:!0,namedTypeDefinitions:new Map},this.entityTypeNames=new Set,this.relationshipTypeNames=new Set,this.geographicLookup=new Map,this.sublayerCaches=new Map,this.nodeConnectionsLookup=new Map,this.relationshipConnectionsLookup=new Map,this.memberIdTypeLookup=new Map;const t=new Map;e.knowledgeGraph.dataModel.entityTypes?.forEach((r=>{r.name&&(t.set(r.name,"entity"),this._processingCacheUpdatesLookup.set(r.name,[]),e.inclusionModeDefinition&&!e.inclusionModeDefinition?.generateAllSublayers||this.entityTypeNames.add(r.name),r.properties?.forEach((e=>{e.geometryType&&"esriGeometryNull"!==e.geometryType&&this.geographicLookup.set(r.name,{name:e.name??"",geometryType:e.geometryType})})))})),e.knowledgeGraph.dataModel.relationshipTypes?.forEach((r=>{r.name&&(t.set(r.name,"relationship"),this._processingCacheUpdatesLookup.set(r.name,[]),e.inclusionModeDefinition&&!e.inclusionModeDefinition?.generateAllSublayers||this.relationshipTypeNames.add(r.name),r.properties?.forEach((e=>{e.geometryType&&"esriGeometryNull"!==e.geometryType&&this.geographicLookup.set(r.name,{name:e.name??"",geometryType:e.geometryType})})))})),e.inclusionModeDefinition?.namedTypeDefinitions.forEach(((r,o)=>{if("entity"===t.get(o))this.entityTypeNames.add(o);else{if("relationship"!==t.get(o))return a.getLogger(this).warn(`A named type, ${o}, was in the inclusion list that wasn't in the data model and will be removed`),void e.inclusionModeDefinition?.namedTypeDefinitions.delete(o);this.relationshipTypeNames.add(o)}const s=new Map;r.members?.forEach((e=>{w(this.memberIdTypeLookup,e.id,(()=>new Set)).add(o);const t=this.getById(e.id);t&&s.set(e.id,t)})),this.sublayerCaches.set(o,s)}))}addToLayer(e){e.forEach((({typeName:e,id:t})=>{if(!this.inclusionModeDefinition)throw new k("knowledge-graph:layer-data-manager","You cannot add to a layer's exclusion list if it was not created with an exclusion list originally");if(this.inclusionModeDefinition.namedTypeDefinitions.has(e)){if(this.inclusionModeDefinition.namedTypeDefinitions.has(e)){const r=this.inclusionModeDefinition.namedTypeDefinitions.get(e);r.members||(r.members=new Map),r.members.set(t,{id:t}),w(this.memberIdTypeLookup,t,(()=>new Set)).add(e)}}else{const r=new Map;r.set(t,{id:t}),this.inclusionModeDefinition.namedTypeDefinitions.set(e,{useAllData:!1,members:r}),w(this.memberIdTypeLookup,t,(()=>new Set)).add(e)}}))}getById(e){return le.getInstance().readFromStoreById(e)}async getData(e,t,r){if(t.objectType.name&&this.inclusionModeDefinition?.namedTypeDefinitions&&this.inclusionModeDefinition.namedTypeDefinitions.size>0&&!this.inclusionModeDefinition.namedTypeDefinitions.has(t.objectType.name))return[];let o;if(o=e||new x({where:"1=1",outFields:["*"]}),"link-chart"===t.parentCompositeLayer.type){const e=t.parentCompositeLayer,r=this._processingCacheUpdatesLookup.get(t.objectType.name??""),s=o.outFields;s&&1===s.length&&s[0]===ke&&"1=1"===o.where||await Promise.all(r??[]);const i=this.sublayerCaches.has(t.objectType.name??"")?Array.from(this.sublayerCaches.get(t.objectType.name)?.values()):[],n=[];return i.forEach((r=>{this.relationshipTypeNames.has(t.objectType.name)?r.geometry=e.relationshipLinkChartDiagramLookup.get(r.attributes[t.objectIdField]):r.geometry=e.entityLinkChartDiagramLookup.get(r.attributes[t.objectIdField]),r.attributes[Se]=r.geometry,n.push(r)})),n}return this.retrieveDataFromService(o,t,r)}async getConnectedRecordIds(e,t){const r=[];let o="";const s=[],i=new Map;if(e.forEach((e=>{if(this.memberIdTypeLookup.has(e))for(const t of this.memberIdTypeLookup.get(e)){if(!this.entityTypeNames.has(t))return;i.has(t)?i.get(t)?.push(e):i.set(t,[e])}})),t&&0!==t?.length){for(const e of t)o=o+e+"|";o=o.slice(0,-1)}return i.forEach(((e,i)=>{let n;n=t&&0!==t?.length?`MATCH (n:${i})-[r:${o}]-(m) WHERE id(n) IN $ids RETURN id(r), type(r), id(m), labels(m)[0]`:`MATCH (n:${i})-[r]-(m) WHERE id(n) IN $ids RETURN id(r), type(r), id(m), labels(m)[0]`;const p=new Promise((t=>{(async()=>{const t=(await v(this.knowledgeGraph,new O({openCypherQuery:n,bindParameters:{ids:e}}))).resultRowsStream.getReader();try{for(;;){const{done:e,value:o}=await t.read();if(e)break;for(let e=0;e<o.length;e++){const t=o[e];r.push({id:t[0],typeName:t[1]}),r.push({id:t[2],typeName:t[3]})}}}catch(e){if("AbortError"!==e.name)throw e;a.getLogger(this).info("Request aborted as expected")}})().then((()=>{t()}))}));s.push(p)})),this.refreshCacheContent(),await Promise.all(s),r}async getAttachedRelationships(e,t){const r=[],o=(await v(this.knowledgeGraph,new O({openCypherQuery:"MATCH (n)-[r]->(m) WHERE id(n) IN $nodeIds AND id(m) in $nodeIds AND NOT id(r) IN $relationshipExclusionIds return id(r), type(r)",bindParameters:{nodeIds:e,relationshipExclusionIds:t}}))).resultRowsStream.getReader();try{for(;;){const{done:e,value:t}=await o.read();if(e)break;for(let e=0;e<t.length;e++){const o=t[e];r.push({id:o[0],typeName:o[1]})}}}catch(e){if("AbortError"!==e.name)throw e;a.getLogger(this).info("Request aborted as expected")}return r}async refreshCacheContent(e,t,r,o=!0){const s=le.getInstance(),i=[],n=new Map,a=new Map;this.knowledgeGraph.dataModel.entityTypes?.forEach((e=>{e.name&&a.set(e.name,e)})),this.knowledgeGraph.dataModel.relationshipTypes?.forEach((e=>{e.name&&a.set(e.name,e)})),e||this.inclusionModeDefinition?e?e.forEach((e=>{if(this.memberIdTypeLookup.has(e))for(const t of this.memberIdTypeLookup.get(e))n.has(t)?n.get(t)?.push(e):n.set(t,[e])})):this.inclusionModeDefinition?.namedTypeDefinitions?.forEach(((e,t)=>{e.useAllData?n.set(t,null):e.members&&e.members.forEach((e=>{n.has(t)&&null!==n.get(t)?n.get(t)?.push(e.id):n.set(t,[e.id])}))})):(this.knowledgeGraph.dataModel.entityTypes?.forEach((e=>{e.name&&n.set(e.name,null)})),this.knowledgeGraph.dataModel.entityTypes?.forEach((e=>{e.name&&n.set(e.name,null)})));for(const[e,p]of n){const n=new Promise((i=>{(async()=>{const i=new Set,n=[];let l,m="",u=!1;if(t||a.get(e)?.properties?.forEach((e=>{e.name&&i.add(e.name)})),r&&this.geographicLookup.has(e)){const t=this.geographicLookup.get(e)?.name;t&&i.add(t)}if(this.entityTypeNames.has(e))m=`MATCH (n:${e}) ${p?"WHERE id(n) IN $ids ":""}return ID(n)`,i.forEach((e=>{m+=`, n.${e}`,n.push(e)}));else{if(!this.relationshipTypeNames.has(e))throw new k("knowledge-graph:layer-data-manager",`The graph type of ${e} could not be determined. Was this type set in the KG data model and inclusion definition?`);u=!0,m=`MATCH ()-[n:${e}]->() ${p?"WHERE id(n) IN $ids ":""}return ID(n), id(startNode(n)), id(endNode(n))`,i.forEach((e=>{m+=`, n.${e}`,n.push(e)}))}l=new O(p?{openCypherQuery:m,bindParameters:{ids:p}}:{openCypherQuery:m});const c=(await v(this.knowledgeGraph,l)).resultRowsStream.getReader();for(;;){const{done:t,value:r}=await c.read();if(t)break;const i=[];for(let e=0;e<r.length;e++){const t=r[e];let o=0,s=0;const a={properties:{}};for(a.id=t[o],o++,s++,u&&(a.originId=t[o],o++,s++,a.destinationId=t[o],o++,s++,w(this.nodeConnectionsLookup,a.originId,(()=>new Set)).add(a.id),w(this.nodeConnectionsLookup,a.destinationId,(()=>new Set)).add(a.id),w(this.relationshipConnectionsLookup,a.id,(()=>[a.originId,a.destinationId])));o<t.length;o++)a.properties[n[o-s]]=t[o];i.push(a)}const a=s.writeToStore(i,ke,this.geographicLookup.get(e)?.name);this.sublayerCaches.has(e)||this.sublayerCaches.set(e,new Map),o&&!this.inclusionModeDefinition?.namedTypeDefinitions.has(e)&&this.inclusionModeDefinition?.namedTypeDefinitions.set(e,{useAllData:!1,members:new Map}),o&&!this.inclusionModeDefinition?.namedTypeDefinitions.get(e).members&&(this.inclusionModeDefinition.namedTypeDefinitions.get(e).members=new Map);const p=this.sublayerCaches.get(e);a.forEach((t=>{p?.set(t.attributes[ke],t),o&&!this.inclusionModeDefinition?.namedTypeDefinitions.get(e).members.has(t.attributes[ke])&&(this.inclusionModeDefinition?.namedTypeDefinitions.get(e).members.set(t.attributes[ke],{id:t.attributes[ke]}),w(this.memberIdTypeLookup,t.attributes[ke],(()=>new Set)).add(e))}))}})().then((()=>{i(null)}))}));i.push(n),this._processingCacheUpdatesLookup.get(e)?.push(n)}await Promise.all(i)}removeFromLayer(e){const t=new Set,r=new Set(e.map((e=>e.id)));for(const r of e)t.add(r.typeName),1===this.memberIdTypeLookup.get(r.id)?.size?this.memberIdTypeLookup.delete(r.id):this.memberIdTypeLookup.get(r.id)?.delete(r.typeName),this.inclusionModeDefinition?.namedTypeDefinitions.forEach(((e,t)=>{t===r.typeName&&e.members?.has(r.id)&&e.members.delete(r.id)}));t.forEach((e=>{this.sublayerCaches.get(e)?.forEach(((t,o)=>{r.has(o)&&this.sublayerCaches.get(e)?.delete(o)}))}))}async retrieveDataFromService(e,t,r){const o=le.getInstance(),s=new Set,i=[];let n,a="",p=[];const l="relationship"===t.graphType,m=this.inclusionModeDefinition?.namedTypeDefinitions?.get(t.objectType.name)?.useAllData,u=t.parentCompositeLayer.sublayerIdsCache.get(t.objectType.name);let h=!m&&u?Array.from(u).sort():null;if(this.inclusionModeDefinition?.namedTypeDefinitions?.get(t.objectType.name)?.useAllData)this.inclusionModeDefinition?.namedTypeDefinitions?.get(t.objectType.name)?.useAllData&&null!=e.objectIds&&(h=e.objectIds);else if(null!=e.objectIds&&h&&h.length>0){const t=e.objectIds;e.objectIds=h.filter((e=>t.includes(e)))}else if(null!=e.objectIds)h=e.objectIds;else{if(this.inclusionModeDefinition?.namedTypeDefinitions.has(t.objectType.name)&&(!this.inclusionModeDefinition.namedTypeDefinitions.get(t.objectType.name)?.members||this.inclusionModeDefinition.namedTypeDefinitions.get(t.objectType.name)?.members?.size<1))return e.objectIds=[],[];e.objectIds=h}if(null!=e.outFields){const r=e.outFields;r.includes("*")?t.fields.forEach((e=>{s.add(e.name)})):r.forEach((e=>{e!==ke&&e!==t.geometryFieldName&&s.add(e)}))}if(null!=e.geometry){const r=e.geometry;let o;const p=t.parentCompositeLayer.dataManager.knowledgeGraph.serviceDefinition,m=p?.spatialReference,u=p?.serviceCapabilities?.geometryCapabilities;let h=u?.geometryMaxBoundingRectangleSizeX,f=u?.geometryMaxBoundingRectangleSizeY;if(r?.extent?.spatialReference&&!r.spatialReference?.isWGS84?(await c(r.extent.spatialReference,y),o=d(r.extent,y)):o=r.extent,h&&f&&m){if(4326!==m.wkid){const e=new R({spatialReference:m,xmax:h,ymax:f}),t=d(e,y);h=t.xmax,f=t.ymax}if(o.xmax-o.xmin>h)throw new k("knowledge-graph:layer-data-manager",`Extent x bounds should be within ${h}° latitude, limit exceeded`);if(o.ymax-o.ymin>f)throw new k("knowledge-graph:layer-data-manager",`Extent y bounds should be within ${f}° longitude, limit exceeded`)}if(null!=e.where&&"1=1"!==e.where){const r=await I(e.where.toUpperCase(),t.fieldsIndex);t.fields.forEach((e=>{r.fieldNames.includes(e.name)&&s.add(e.name)}))}a=l?`Match ()-[n:${t.objectType.name}]->() WHERE esri.graph.ST_Intersects($param_filter_geom, n.${t.geometryFieldName}) return ID(n), id(startNode(r)), id(endNode(r))`:`Match (n:${t.objectType.name}) WHERE esri.graph.ST_Intersects($param_filter_geom, n.${t.geometryFieldName}) return ID(n)`,t.geometryFieldName&&s.add(t.geometryFieldName),s.forEach((e=>{a+=`, n.${e}`,i.push(e)})),n=new O({openCypherQuery:a,bindParameters:{param_filter_geom:new S({rings:je(o)})}})}else{let r="";if(null!=e.where&&"1=1"!==e.where){const o=await I(e.where,t.fieldsIndex);t.fields.forEach((e=>{o.fieldNames.includes(e.name)&&s.add(e.name)}));const i=new Set(["column-reference","string","number","binary-expression"]),n=new Set(["=","<","<=","<>",">",">=","AND","OR","LIKE"]);let a=!1;const p=e=>{if("column-reference"===e.type)return`n.${e.column}`;if("string"===e.type)return`'${e.value}'`;if("number"===e.type)return`${e.value}`;if("binary-expression"===e.type&&i.has(e.left.type)&&i.has(e.right.type)&&n.has(e.operator))return`${p(e.left)} ${e.operator} ${p(e.right)}`;if("binary-expression"===e.type&&"LIKE"===e.operator){let t="";if("function"===e.left.type&&"column-reference"===e.left.args.value[0].type)t+=`lower(n.${e.left.args.value[0].column})`;else{if("column-reference"!==e.left.type)return a=!0,"";t+=`lower(n.${e.left.column})`}if(t+=" CONTAINS (","string"!==e.right.type)return a=!0,"";{let r=e.right.value;"%"===r.charAt(0)&&(r=r.slice(1)),"%"===r.charAt(r.length-1)&&(r=r.slice(0,-1)),t+=`'${r.toLowerCase()}')`}return t}return a=!0,""};r=p(o.parseTree),a&&(r="")}let o="";o=l?`Match ()-[n:${t.objectType.name}]->()`:`Match (n:${t.objectType.name})`;let a=!1;h&&(a=!0,o+=" WHERE ID(n) IN $ids"),r&&(o+=a?" AND":" WHERE",o+=` ${r}`),o+=" return ID(n)",l&&(o+=", id(startNode(n)), id(endNode(n))"),e.returnGeometry&&t.geometryFieldName&&s.add(t.geometryFieldName),s.forEach((e=>{o+=`, n.${e}`,i.push(e)})),n=new O(h?{openCypherQuery:o,bindParameters:{ids:h}}:{openCypherQuery:o})}const f=(await v(t.parentCompositeLayer.dataManager.knowledgeGraph,n,r)).resultRowsStream.getReader();for(;;){const{done:e,value:r}=await f.read();if(e)break;const s=[];for(let e=0;e<r.length;e++){const t=r[e];let o=0,n=0;const a={properties:{}};for(a.id=t[o],o++,n++,l&&(a.originId=t[o],o++,n++,a.destinationId=t[o],o++,n++);o<t.length;o++)a.properties[i[o-n]]=t[o];s.push(a)}p=p.concat(o.writeToStore(s,ke,t.parentCompositeLayer.dataManager.geographicLookup.get(t.objectType.name)?.name))}return p}};e([n()],De.prototype,"knowledgeGraph",void 0),e([n()],De.prototype,"inclusionModeDefinition",void 0),e([n()],De.prototype,"entityTypeNames",void 0),e([n()],De.prototype,"relationshipTypeNames",void 0),e([n()],De.prototype,"geographicLookup",void 0),e([n()],De.prototype,"sublayerCaches",void 0),e([n()],De.prototype,"nodeConnectionsLookup",void 0),e([n()],De.prototype,"relationshipConnectionsLookup",void 0),e([n()],De.prototype,"memberIdTypeLookup",void 0),De=e([p("esri.layers.knowledgeGraph.KnowledgeGraphLayerDataManager")],De);const Me=_(),Le=t=>{let r=class extends t{constructor(){super(...arguments),this.fields=[],this.fieldsIndex=null}};return e([n(Me.fields)],r.prototype,"fields",void 0),e([n(Me.fieldsIndex)],r.prototype,"fieldsIndex",void 0),r=e([p("esri.layers.knowledgeGraph.KnowledgeGraphSublayerBase")],r),r};function Re(e){if(!e.json)return e;e.json.write=Ne(e.json.write);const t=e.json.origins;if(!t)return e;let r;for(r in t){const e=t[r];e&&(e.write=Ne(e.write))}return e}function Ne(e){return"object"==typeof e&&e?(!1!==e.enabled&&(e.overridePolicy=function(e){const{target:t,writer:r,overridePolicy:o,...s}=e;return function(e,t){const r=ve.call(this,e,t);return r.enabled?{...s,...r}:r}}(e)),e):!0===e?Ce():e}function Ce(){return{overridePolicy:ve}}function ve(e,t){const r=!!this.geometryType;let o={enabled:r};return r&&(o={...o,...Oe.call(this,e,t)}),o}function Oe(e,t){return{ignoreOrigin:this.originIdOf(t)>u.DEFAULTS}}let xe=class extends(Le(P(U(F(V(H(J(B(i(f)))))))))){constructor(e){super(e),this.blendMode="normal",this.capabilities=b(!1,!1),this.charts=null,this.definitionExpression=null,this.displayField="",this.effect=null,this.elevationInfo=null,this.featureEffect=null,this.graphType=null,this.labelsVisible=!0,this.labelingInfo=null,this.layerType=null,this.legendEnabled=!0,this.maxScale=0,this.minScale=0,this.objectIdField=ke,this.objectType=null,this.opacity=1,this.orderBy=null,this.parentCompositeLayer=null,this.persistenceEnabled=!0,this.popupEnabled=!0,this.popupTemplate=null,this.refreshInterval=0,this.source={openPorts:()=>this.load().then((()=>{const e=new MessageChannel;return new ae(e.port1,{channel:e,client:{queryFeatures:(e,t={})=>{const r=x.fromJSON(e);return this.queryFeaturesJSON(r,t)}}}),[e.port2]}))},this.title=null,this.type="knowledge-graph-sublayer",this.useViewTime=!0,this.visible=!0}get defaultPopupTemplate(){return this.createPopupTemplate()}set featureReduction(e){const t=this._normalizeFeatureReduction(e);this._set("featureReduction",t)}get fields(){const e=[];return this.objectType?.properties?.forEach((t=>{const r="esriFieldTypeOID"===t.fieldType?"esriFieldTypeInteger":t.fieldType;e.push(te.fromJSON({name:t.name,type:r,alias:t.alias,defaultValue:t.defaultValue,editable:t.editable,nullable:t.nullable}))})),e.push(te.fromJSON({name:this.objectIdField,type:"esriFieldTypeString",alias:this.objectIdField,editable:!1}),te.fromJSON({name:Ee,type:"esriFieldTypeInteger",alias:Ee,editable:!1})),e}get geometryType(){if("link-chart"===this.parentCompositeLayer?.type)return"relationship"===this.graphType?"polyline":"point";const e=this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name),t=e?.geometryType;return t&&"esriGeometryNull"!==t?pe.fromJSON(t):null}get geometryFieldName(){if("link-chart"===this.parentCompositeLayer?.type)return Se;const e=this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name);return e?.name??null}get graphTypeName(){return this.objectType?.name}get hasM(){const e=this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name),t=e?.name,r=t?this.objectType?.properties?.[t]:null;return r?.hasM??!1}get hasZ(){const e=this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name),t=e?.name,r=t?this.objectType?.properties?.[t]:null;return r?.hasZ??!1}set renderer(e){re(e,this.fieldsIndex),this._set("renderer",e)}get renderer(){return this._isOverridden("renderer")?this._get("renderer"):"link-chart"===this.parentCompositeLayer?.type?"relationship"===this.graphType?r(T(pe.toJSON("polyline")).renderer):r(T(pe.toJSON("point")).renderer):r(T(pe.toJSON(this.geometryType)).renderer)}get spatialReference(){return this.parentCompositeLayer?.dataManager?.knowledgeGraph?.dataModel?.spatialReference??h.WGS84}writeTitle(e,t){t.title=e??"Layer"}createPopupTemplate(e){return ne(this,e)}createQuery(){return new x({where:"1=1",outFields:["*"]})}getField(e){for(let t=0;t<this.fields.length;t++)if(this.fields[t].name===e)return this.fields[t];return null}getFieldDomain(e,t){return null}async queryFeatures(e,t){const{resolvedQuery:r,queryEngine:o}=await this._setupQueryObjects(e),s=ie.fromJSON(await o.executeQuery(r.toJSON(),t?.signal));return s.features.forEach((e=>{e.sourceLayer=this})),s}async queryFeaturesJSON(e,t){const{resolvedQuery:r,queryEngine:o}=await this._setupQueryObjects(e);return await o.executeQuery(r.toJSON(),t?.signal)}async queryFeatureCount(e,t){const{resolvedQuery:r,queryEngine:o}=await this._setupQueryObjects(e);return o.executeQueryForCount(r.toJSON(),t?.signal)}async queryExtent(e={},t){const r={...e,returnGeometry:!0},{resolvedQuery:o,queryEngine:s}=await this._setupQueryObjects(r),i=await s.executeQueryForExtent(o.toJSON(),t?.signal);let n;return n=null!=i.extent?.xmin&&null!=i.extent?.xmax&&null!=i.extent?.ymin&&null!=i.extent?.ymax?new R(i.extent):new R,{count:i.count,extent:n}}async queryObjectIds(e,t){const r=x.from(e);let o;if("link-chart"===this.parentCompositeLayer.type&&this._cachedQueryEngine)o=this._cachedQueryEngine;else{const e=await this.parentCompositeLayer.dataManager.getData(r,this,t);o=this.loadQueryEngine(e)}return o.executeQueryForIds(r.toJSON(),t?.signal)}loadQueryEngine(e){const t=new j({geometryType:pe.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ}),r=new g({fieldsIndex:this.fieldsIndex.toJSON(),geometryType:pe.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:this.spatialReference.toJSON(),timeInfo:null,featureStore:t});return r.featureStore.addMany(e),r}async refreshCachedQueryEngine(){const e=await this.parentCompositeLayer.dataManager.getData(new x({where:"1=1",outFields:[ke]}),this);this._cachedQueryEngine=this.loadQueryEngine(e)}async _setupQueryObjects(e,t){const r=x.from(e),o=r.geometry;let s;if(o&&!o.spatialReference?.isWGS84&&(await c(o.spatialReference,y),r.geometry=d(o instanceof S||o instanceof N?o:o.extent,y)),"link-chart"===this.parentCompositeLayer.type&&this._cachedQueryEngine)s=this._cachedQueryEngine;else{const e=await this.parentCompositeLayer.dataManager.getData(r,this,t);s=this.loadQueryEngine(e)}return{resolvedQuery:r,queryEngine:s}}};e([n(Re(s(A)))],xe.prototype,"blendMode",void 0),e([n()],xe.prototype,"capabilities",void 0),e([n({json:{origins:{"web-scene":{write:!1}},write:Ce()}})],xe.prototype,"charts",void 0),e([n({readOnly:!0})],xe.prototype,"defaultPopupTemplate",null),e([n({type:String,json:{origins:{service:{read:!1}},name:"layerDefinition.definitionExpression",write:{ignoreOrigin:!0}}})],xe.prototype,"definitionExpression",void 0),e([n()],xe.prototype,"displayField",void 0),e([n(Re(s(G)))],xe.prototype,"effect",void 0),e([n()],xe.prototype,"elevationInfo",void 0),e([n(Re(s(q)))],xe.prototype,"featureEffect",void 0),e([n(Re(s(Q)))],xe.prototype,"featureReduction",null),e([n()],xe.prototype,"fields",null),e([n()],xe.prototype,"geometryType",null),e([n()],xe.prototype,"geometryFieldName",null),e([n({type:["entity","relationship"],nonNullable:!0,json:{write:{isRequired:!0,ignoreOrigin:!0}}})],xe.prototype,"graphType",void 0),e([n({type:String,nonNullable:!0,json:{write:{isRequired:!0,ignoreOrigin:!0}}})],xe.prototype,"graphTypeName",null),e([n()],xe.prototype,"hasM",null),e([n()],xe.prototype,"hasZ",null),e([n({type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}},write:{ignoreOrigin:!0}}})],xe.prototype,"id",void 0),e([n(Re(s(z)))],xe.prototype,"labelsVisible",void 0),e([n({type:[oe],json:{name:"layerDefinition.drawingInfo.labelingInfo",read:se,write:Ce()}})],xe.prototype,"labelingInfo",void 0),e([n({readOnly:!0,json:{read:!1,write:{writer(e,t){t.layerType=this.geometryType?"KnowledgeGraphSubLayer":"KnowledgeGraphSubTable"},isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}})],xe.prototype,"layerType",void 0),e([n(Re(s(W)))],xe.prototype,"legendEnabled",void 0),e([n(Re(s(K)))],xe.prototype,"maxScale",void 0),e([n(Re(s(Z)))],xe.prototype,"minScale",void 0),e([n()],xe.prototype,"objectIdField",void 0),e([n()],xe.prototype,"objectType",void 0),e([n(Re(s(X)))],xe.prototype,"opacity",void 0),e([n(Re(s($)))],xe.prototype,"orderBy",void 0),e([n()],xe.prototype,"parentCompositeLayer",void 0),e([n(Re(s(ee)))],xe.prototype,"popupEnabled",void 0),e([n({type:t,json:{name:"popupInfo",write:{ignoreOrigin:!0}}})],xe.prototype,"popupTemplate",void 0),e([n({type:Number,json:{write:{overridePolicy:Oe}}})],xe.prototype,"refreshInterval",void 0),e([n({types:o,json:{name:"layerDefinition.drawingInfo.renderer",write:Ce()}})],xe.prototype,"renderer",null),e([n()],xe.prototype,"source",void 0),e([n()],xe.prototype,"spatialReference",null),e([n({type:String,json:{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}})],xe.prototype,"title",void 0),e([l("title")],xe.prototype,"writeTitle",null),e([n({json:{read:!1}})],xe.prototype,"type",void 0),e([n(Re(s(Y)))],xe.prototype,"useViewTime",void 0),e([n({type:Boolean,json:{name:"visibility",write:Ce()}})],xe.prototype,"visible",void 0),xe=e([p("esri.layers.knowledgeGraph.KnowledgeGraphSublayer")],xe);const _e=xe;export{De as K,we as a,Ie as b,Se as c,Ee as d,_e as default,be as f,ge as g,ke as m,Te as s};

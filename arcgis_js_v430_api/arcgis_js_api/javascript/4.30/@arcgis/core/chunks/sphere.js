/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.30/esri/copyright.txt for details.
*/
import"../core/lang.js";import"./Logger.js";import{a as t,b as n}from"./mathUtils.js";import{f as r}from"./mat4.js";import{e as s,b as o,l as e,h as i,c as a,i as c,j as u,k as f,n as l,s as m,m as g,a as p,o as h}from"./vec3.js";import{c as d}from"./vec3f64.js";import{c as j,a as M}from"./vec4.js";import{c as b,f as S}from"./vec4f64.js";import{g as y}from"./common.js";import{A}from"./Axis.js";import{f as v,c as R}from"./ray.js";import{s as x,a as P,b as q}from"./plane.js";const _=w();function w(){return b()}const C=M,O=M;function T(t,n){return j(n,t)}function k(t,n){return S(t[0],t[1],t[2],n)}function E(t){return t}function L(t,n){return t[0]=t[1]=t[2]=0,t[3]=n,t}function N(t){return t[3]}function Z(t){return t}function z(t,n,r,s){return S(t,n,r,s)}function U(t,n,r){if(null==n)return!1;if(!Y(t,n,X))return!1;let{t0:s,t1:o}=X;if((s<0||o<s&&o>0)&&(s=o),s<0)return!1;if(r){const{origin:t,direction:o}=n;r[0]=t[0]+o[0]*s,r[1]=t[1]+o[1]*s,r[2]=t[2]+o[2]*s}return!0}function V(t,n,r){const s=v(n,r);if(!Y(t,s,X))return[];const{origin:o,direction:e}=s,{t0:i,t1:a}=X,c=n=>{const r=d();return h(r,o,e,n),G(t,r,r)};return Math.abs(i-a)<y()?[c(i)]:[c(i),c(a)]}const X={t0:0,t1:0};function Y(t,n,r){const{origin:s,direction:o}=n,e=B;e[0]=s[0]-t[0],e[1]=s[1]-t[1],e[2]=s[2]-t[2];const i=o[0]*o[0]+o[1]*o[1]+o[2]*o[2];if(0===i)return!1;const a=2*(o[0]*e[0]+o[1]*e[1]+o[2]*e[2]),c=a*a-4*i*(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]-t[3]*t[3]);if(c<0)return!1;const u=Math.sqrt(c);return r.t0=(-a-u)/(2*i),r.t1=(-a+u)/(2*i),!0}const B=d();function D(t,n){return U(t,n,null)}function F(t,n,a){const c=x.get(),u=P.get();s(c,n.origin,n.direction);const f=N(t);s(a,c,n.origin),o(a,a,1/e(a)*f);const l=I(t,n.origin),m=q(n.origin,a);return r(u,m+l,c),i(a,a,u),a}function G(t,n,r){const s=a(x.get(),n,t),i=o(x.get(),s,t[3]/e(s));return c(r,i,t)}function H(t,n){const r=a(x.get(),n,t),s=f(r),o=t[3]*t[3];return Math.sqrt(Math.abs(s-o))}function I(n,r){const s=a(x.get(),r,n),o=e(s),i=N(n),c=i+Math.abs(i-o);return t(i/c)}const J=d();function K(t,r,s,o){const e=a(J,r,t);switch(s){case A.X:{const t=n(e,J)[2];return m(o,-Math.sin(t),Math.cos(t),0)}case A.Y:{const t=n(e,J),r=t[1],s=t[2],i=Math.sin(r);return m(o,-i*Math.cos(s),-i*Math.sin(s),Math.cos(r))}case A.Z:return l(o,e);default:return}}function Q(t,n){const r=a(tt,n,t);return e(r)-t[3]}function W(t,n){const r=g(t,n),s=N(t);return r<=s*s}function $(t,n,r=b()){const s=u(t,n),o=t[3],e=n[3];return s+e<o?(j(r,t),r):s+o<e?(j(r,n),r):(p(r,t,n,(s+e-o)/(2*s)),r[3]=(s+o+e)/2,r)}const tt=d(),nt=w(),rt=Object.freeze(Object.defineProperty({__proto__:null,NullSphere:_,altitudeAt:Q,angleToSilhouette:I,axisAt:K,clear:function(t){t[0]=t[1]=t[2]=t[3]=0},closestPoint:function(t,n,r){return U(t,n,r)?r:(R(n,t,r),G(t,r,r))},closestPointOnSilhouette:F,containsPoint:W,copy:T,create:w,distanceToSilhouette:H,elevate:function(t,n,r){return t!==r&&(r[0]=t[0],r[1]=t[1],r[2]=t[2]),r[3]=t[3]+n,r},equals:O,exactEquals:C,fromCenterAndRadius:k,fromRadius:L,fromValues:z,getCenter:Z,getRadius:N,intersectLine:V,intersectRay:U,intersectRayClosestSilhouette:function(t,n,r){if(U(t,n,r))return r;const s=F(t,n,x.get());return c(r,n.origin,o(x.get(),n.direction,u(n.origin,s)/e(n.direction))),r},intersectsRay:D,projectPoint:G,setAltitudeAt:function(t,n,r,s){const e=Q(t,n),i=K(t,n,A.Z,tt),a=o(tt,i,r-e);return c(s,n,a)},setExtent:function(t,n,r){return t!==r&&T(t,r),r},tmpSphere:nt,union:$,wrap:E},Symbol.toStringTag,{value:"Module"}));export{_ as N,N as a,w as b,T as c,W as d,V as e,z as f,Z as g,k as h,D as i,C as j,U as k,F as l,L as m,H as n,G as p,rt as s,nt as t,$ as u,E as w};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.30/esri/copyright.txt for details.
*/
import e from"../core/Error.js";import{L as r}from"./Logger.js";import o from"../layers/support/LabelClass.js";const t=()=>r.getLogger("esri.layers.support.labelingInfo"),n=/\[([^[\]]+)\]/gi;function l(e,r,t){return e?e.map((e=>{const l=new o;if(l.read(e,t),l.labelExpression){const e=r.fields||r.layerDefinition?.fields||this.fields;l.labelExpression=l.labelExpression.replaceAll(n,((r,o)=>`[${function(e,r){if(!r)return e;const o=e.toLowerCase();for(let e=0;e<r.length;e++){const t=r[e].name;if(t.toLowerCase()===o)return t}return e}(o,e)}]`))}return l})):null}const s={esriGeometryPoint:["above-right","above-center","above-left","center-center","center-left","center-right","below-center","below-left","below-right"],esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along","above-along","below-along"],esriGeometryMultipoint:null,esriGeometryEnvelope:null};function i(r,o){const n=[];for(const l of r){const r=l.labelPlacement,i=s[o];if(!l.symbol)return t().warn("No ILabelClass symbol specified."),[];if(!i)return t().error(new e("labeling:unsupported-geometry-type",`Unable to create labels for layer, geometry type '${o}' is not supported`)),[];if(i.includes(r))n.push(l);else{const e=i[0];r&&t().warn(`Found invalid label placement type ${r} for ${o}. Defaulting to ${e}`);const s=l.clone();s.labelPlacement=e,n.push(s)}}return n}export{l as r,i as v};

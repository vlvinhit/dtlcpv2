/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.30/esri/copyright.txt for details.
*/
import{_ as t}from"./tslib.es6.js";import e from"../core/Accessor.js";import{property as n}from"../core/accessorSupport/decorators/property.js";import"../core/lang.js";import"./Logger.js";import{subclass as i}from"../core/accessorSupport/decorators/subclass.js";import o from"../core/Evented.js";import{throwIfNotAbortError as s,throwIfAborted as l,after as r,o as a}from"../core/promiseUtils.js";import{d as c}from"./maybe.js";import{watch as d,syncAndInitial as u}from"../core/reactiveUtils.js";import{s as p}from"./themeUtils.js";import"../core/Error.js";import h,{l as v}from"../widgets/Widget.js";import{c as f,a as m}from"./widgetUtils.js";import{t as g,a as _}from"./jsxFactory.js";import{p as y}from"./a11yUtils.js";import{m as b}from"./memoize.js";import{waitTick as w,waitAnimationFrame as x}from"../core/scheduling.js";import{u as k}from"./unitFormatUtils.js";import{al as C,am as T,an as M}from"./unitUtils.js";import{g as E}from"./getDefaultUnitForView.js";import{t as I}from"./keybindings.js";import{C as j}from"./Cyclical.js";import{g as $,h as D,i as F,j as S,k as V,e as z,l as A}from"./quantityFormatUtils.js";import{e as O,c as L,t as U}from"./quantityUtils.js";import{isLoaded as R,fromLatitudeLongitude as P,fromLongitude as H,fromLatitude as X}from"../geometry/coordinateFormatter.js";import{p as Y,f as q}from"./number.js";import{g as K}from"./angularMeasurementUtils.js";import{m as N}from"./messageBundle.js";import{d as B}from"./directionModeIcons.js";const W=1,Z=6;function G(t,e){return{angleRelative:J,direction:Q,directionRelative:tt,directionRelativeBilateral:et,latitudeDecimalDegrees:it,longitudeDecimalDegrees:nt,area:(n,i)=>$(t,n,i??e.area),length:(n,i,o)=>D(t,n,i??e.length,o),lengthRelative:(n,i)=>F(t,n,i??e.length),totalLength:(n,i)=>D(t,n,i??e.length),verticalLength:(n,i)=>S(t,n,i??e.length),verticalLengthRelative:(n,i)=>V(t,n,i??e.verticalLength),percentage:at,scalar:dt,scale:ct}}function J(t){return q(t,{signDisplay:"exceptZero",...ut(W)})}function Q(t){return z(t,t.rotationType,W)}function tt(t){const e=K(t);return q(e,{style:"unit",unitDisplay:"narrow",unit:"degree",signDisplay:e>0?"never":"exceptZero",...ut(W)})}function et(t){return z(t,t.rotationType,W)}function nt(t){return lt(t,wt)}function it(t){return lt(t,xt)}function ot(t){return rt(t,wt)}function st(t){return rt(t,xt)}function lt(t,e){return z(U(t,"degrees"),"geographic",Z,e,!1)}function rt(t,e){const n=e.normalize(U(t,"degrees").value,void 0,!1);return dt(O(n),Z)}function at(t){return q(t.value,{style:"percent"})}function ct(t){return q(t,{style:"percent",maximumFractionDigits:0})}function dt(t,e){return q(t.value,ut(e))}function ut(t){return{minimumFractionDigits:t,maximumFractionDigits:t}}function pt(t){return(e,n)=>{const i=Y(e);return null!=i?t(i,n):null}}const ht=t=>{let e=`[-+]?[0-9${t.thousands}]+`;return""!==t.decimal&&(e+=`${t.decimal}[0-9]+`),new RegExp(`^(${e}\\s*)${t.separator}(\\s*${e})$`,"i")},vt=[];for(const t of[",","\\|","\\s+"])for(const e of["\\.",",",""])for(const n of["",",","\\."," ","\\s+"])t!==e&&t!==n&&e!==n&&vt.push({separator:t,decimal:e,thousands:n,pattern:ht({decimal:e,thousands:n,separator:t})});function ft(t){for(const{decimal:e,thousands:n,pattern:i}of vt){i.lastIndex=0;const o=t.match(i);if(!o)continue;const s=Y(mt(o[1],e,n)),l=Y(mt(o[2],e,n));if(null!=s&&null!=l)return{x:O(s),y:O(l)}}return null}function mt(t,e,n){let i=t.replaceAll(/[\s+]/g,"");return""!==n&&(i=i.replaceAll(n,"")),""!==e&&(i=i.replaceAll(e,".")),i}function gt(t){if(!t||null!=Y(t)||!R())return null;const e=P(t),n=bt(e?.latitude),i=bt(e?.longitude);return null!=i&&null!=n?{latitude:n,longitude:i}:null}function _t(t){return bt(H(t))}function yt(t){return bt(X(t))}function bt(t){return null!=t?L(t,"degrees","geographic"):null}const wt=new j(-180,180),xt=new j(-90,90);let kt=class extends e{constructor(t){super(t),this.helpMessage=void 0,this.viewType=void 0}get visibleElements(){return this.sketchOptions.tooltips.visibleElements}get allFields(){return[]}get editableFields(){return this.allFields.filter((t=>t.visible&&!t.readOnly))}clearInputValues(){this.allFields.forEach((t=>t.clearInputValue()))}};t([n()],kt.prototype,"sketchOptions",void 0),t([n()],kt.prototype,"visibleElements",null),t([n()],kt.prototype,"helpMessage",void 0),t([n()],kt.prototype,"viewType",void 0),t([n()],kt.prototype,"allFields",null),t([n()],kt.prototype,"editableFields",null),kt=t([i("esri.views.interactive.tooltip.infos.SketchTooltipInfo")],kt);const Ct="esri-tooltip",Tt=`${Ct}-content`,Mt=`${Ct}-content--input`,Et=`${Ct}-content__header`,It=`${Ct}-content__header__spacer`,jt=`${Ct}-content__header__actions`,$t=`${Ct}-draw-header-actions`,Dt=`${Ct}-table`,Ft=`${Ct}-help-message`,St=`${Ct}-help-message__text`,Vt=`${Ct}-help-message__icon`,zt=`${Ct}-field`,At={base:zt,inputMode:`${zt}--input`,title:`${zt}__title`,value:`${zt}__value`};let Ot=class extends h{constructor(){super(...arguments),this.hidden=!1,this.mode="feedback"}render(){return g("div",{class:this.classes({[At.base]:!0,[At.inputMode]:"input"===this.mode})},g("div",{class:At.title},this.title),g("div",{class:At.value},this.value))}};t([n()],Ot.prototype,"hidden",void 0),t([n()],Ot.prototype,"mode",void 0),t([n()],Ot.prototype,"title",void 0),t([n()],Ot.prototype,"value",void 0),Ot=t([i("esri.views.interactive.tooltip.components.TooltipField")],Ot);const Lt={base:`${Ct}-value-by-value`};let Ut=class extends h{constructor(){super(...arguments),this.divider="×"}render(){return g("div",{class:Lt.base},g("span",null,this.left),g("span",null,this.divider),g("span",null,this.right))}};t([n()],Ut.prototype,"left",void 0),t([n()],Ut.prototype,"divider",void 0),t([n()],Ut.prototype,"right",void 0),Ut=t([i("esri.views.interactive.tooltip.components.ValueByValue")],Ut);let Rt=class extends h{constructor(){super(...arguments),this._focusAbortController=new AbortController,this._transition=null,this._mode="feedback",this._getFormatters=b(G),this._onDiscard=()=>{this.info.clearInputValues(),this.exitInputMode()},this._onCommit=(t,e)=>{if("commit-and-exit"===e)return void this.exitInputMode();if("commit-on-blur"===e)return;const n=this._getFocusableElements(),i=n.length,o=n.indexOf(t);if(-1===o)return void this.exitInputMode();const s=((o+("commit-and-next"===e?1:-1))%i+i)%i;Pt(n.at(s))},this._handleTab=t=>{if(t.code!==I.next)return;const e=this._getFocusableElements(),n=e.at(0),i=e.at(-1);n&&i&&(t.shiftKey?document.activeElement===n&&(t.preventDefault(),Pt(i)):document.activeElement===i&&(t.preventDefault(),Pt(n)))}}get mode(){return this._mode}get _displayUnits(){const t=E(this.tooltip.view);return{length:t,verticalLength:t,area:t,angle:"degrees"}}get _inputUnitInfos(){const t=this._messagesUnits,e=e=>({unit:e,abbreviation:k(t,e,"abbr")}),n=E(this.tooltip.view),i=e(C(n)),o=e(T(n)),s=e(M(n)),l=e("degrees");return{length:i,lengthRelative:i,verticalLength:o,verticalLengthRelative:o,area:s,direction:l,orientation:l,rotation:l,longitudeLatitude:l}}get _formatters(){return this._getFormatters(this._messagesUnits,this._displayUnits)}get fieldContext(){return{formatters:this._formatters,inputUnitInfos:this._inputUnitInfos,messages:this._messagesTooltip,sketchOptions:this.info.sketchOptions,onCommit:this._onCommit,onDiscard:this._onDiscard}}render(){const{visibleElements:t}=this.info.sketchOptions.tooltips,e=this._renderedContent,n=this._renderedActions,i=this._renderedHelpMessage,o=e.length>0,s=o||!!i,l="input"===this.mode;return g("div",{class:f(Tt,l&&Mt),onkeydown:this._handleTab},l&&s&&t.header?g("div",{class:Et,key:"header"},g("calcite-button",{appearance:"transparent","data-testid":"tooltip-back-button",iconFlipRtl:"both",iconStart:"chevron-left",key:"discard-button",kind:"neutral",onclick:this._onDiscard,scale:"s",tabIndex:-1}),n.length>0?g(_,null,g("div",{class:It,key:"spacer"}),g("div",{class:jt,key:"actions"},n)):null):null,o?g("div",{class:Dt,key:"content"},...e):null,i)}_renderActions(){return null}loadDependencies(){return v({button:()=>import("./calcite-button.js"),icon:()=>import("./calcite-icon.js"),input:()=>import("./calcite-input.js")})}async enterInputMode(t){try{await this._transitionTo("input"),await this._focusField(t)}catch(t){s(t)}}async exitInputMode({focusOnView:t=!0}={}){try{const{container:e,info:n}=this;n.clearInputValues();const i=t?e?.closest(".esri-view")?.querySelector(".esri-view-surface"):null;await this._transitionTo("feedback"),i instanceof HTMLElement&&i.focus()}catch(t){s(t)}}get _renderedContent(){return Ht(this._renderContent())}get _renderedActions(){return Ht(this._renderActions())}get _renderedHelpMessage(){const{sketchOptions:t,visibleElements:e}=this.info;if(!e.helpMessage)return null;const n=t.tooltips.helpMessage??this._defaultHelpMessage;if(!n)return null;const i=t.tooltips.helpMessageIcon??"information";return g("div",{class:Ft,key:"help-message"},i?g("calcite-icon",{class:Vt,icon:i,scale:"s"}):null,g("div",{class:St},n))}get _defaultHelpMessage(){const{helpMessage:t,viewType:e}=this.info;if(null==t)return null;const n="3d"===e?"helpMessages3d":"helpMessages2d";return this._messagesTooltip?.sketch?.[n]?.[t]}async _focusField(t){this._focusAbortController?.abort(),this._focusAbortController=new AbortController;const{signal:e}=this._focusAbortController;await this._waitForInputs(),l(e);const n=this._getFocusableInputs(),i=t?n.find((e=>e.getAttribute("data-field-name")===t)):n.at(0);await Pt(i)}async _transitionTo(t){if(this._mode===t)return;const e=()=>{this._mode=t};if(!this.domNode?.firstChild||!document.startViewTransition||y())return void e();this.autoRenderingEnabled=!1,this._transition?.skipTransition();const n=this._transition=document.startViewTransition((()=>{if(!this.destroyed)return this.autoRenderingEnabled=!0,e(),this.renderNow(),w()}));try{await this._transition.finished}finally{n===this._transition&&(this._transition=null)}}async _waitForInputs(){const t=()=>Array.from(this.domNode?.querySelectorAll("calcite-input")??[]);for(;0===t().length;)await r(Xt);await x()}_getFocusableInputs(){return Array.from(this.domNode?.querySelectorAll("calcite-input:not([read-only]):not([disabled])")??[])}_getFocusableElements(){const t=this.domNode?.querySelector(`.${$t}`);return[...Array.from(t?.querySelectorAll(`.${jt} calcite-button:not([disabled])`)??[]),...this._getFocusableInputs()]}};async function Pt(t){await(t?.setFocus())}function Ht(t){return(Array.isArray(t)?t:[t]).flat(10).filter((t=>!!t))}t([N("esri/core/t9n/Units"),n()],Rt.prototype,"_messagesUnits",void 0),t([N("esri/views/interactive/tooltip/t9n/Tooltip"),n()],Rt.prototype,"_messagesTooltip",void 0),t([n()],Rt.prototype,"info",void 0),t([n()],Rt.prototype,"tooltip",void 0),t([n()],Rt.prototype,"_mode",void 0),t([n()],Rt.prototype,"mode",null),t([n()],Rt.prototype,"_displayUnits",null),t([n()],Rt.prototype,"_inputUnitInfos",null),t([n()],Rt.prototype,"_formatters",null),t([n()],Rt.prototype,"fieldContext",null),t([n()],Rt.prototype,"_renderedContent",null),t([n()],Rt.prototype,"_renderedActions",null),t([n()],Rt.prototype,"_renderedHelpMessage",null),t([n()],Rt.prototype,"_defaultHelpMessage",null),Rt=t([i("esri.views.interactive.tooltip.content.TooltipContent")],Rt);const Xt=20;let Yt=class extends Rt{_renderContent(){const{area:t,radius:e,xSize:n,ySize:i,visibleElements:o}=this.info,s=this._messagesTooltip.sketch,l=this._formatters;return g(_,null,o.radius&&null!=e?g(Ot,{title:s.radius,value:l.length(e)}):null,o.size&&null!=n&&null!=i?g(Ot,{title:s.size,value:g(Ut,{left:l.length(n),right:l.length(i)})}):null,o.area?g(Ot,{title:s.area,value:l.area(t)}):null)}};Yt=t([i("esri.views.interactive.tooltip.content.TooltipContentDrawCircle")],Yt);const qt=`${Ct}-editable-field`,Kt={base:qt,inputMode:`${qt}--input`,feedbackMode:`${qt}--feedback`,readOnly:`${qt}--read-only`,locked:`${qt}--locked`,title:`${qt}__title`,value:`${qt}__value`,valueContent:`${qt}__value__content`,valueContentReadOnly:`${qt}__value__content--read-only`,lockIcon:`${qt}__lock-icon`,input:`${qt}__input`,inputSuffix:`${qt}__input-suffix`,button:`${qt}__button`},Nt="lock";let Bt=class extends h{constructor(){super(...arguments),this._input=null,this._onKeyDown=t=>{t.key===I.discard&&"input"===this.mode&&this._input&&this.context.onDiscard(this._input)},this._onInputKeyDown=t=>{const e=this._input;if(e)switch(t.key){case I.commit:return this.field.onCommit("commit-and-exit",e,this.context);case I.next:{t.preventDefault(),t.stopPropagation();const n=t.shiftKey?"commit-and-previous":"commit-and-next";return this.field.onCommit(n,e,this.context)}}},this._onInput=t=>{this.field.onInput(t.target.value)},this._onInputBlur=()=>{const t=this._input;t&&this.field.onCommit("commit-on-blur",t,this.context)},this._selectText=()=>{const t=()=>{this._input===document.activeElement&&this._input?.selectText()};t(),x().then(t)}}initialize(){this.addHandles(d((()=>this._rawDisplayValue),(()=>{const{committed:t,inputValue:e}=this.field;t||e||this._input!==document.activeElement||this._selectText()})))}loadDependencies(){return v({button:()=>import("./calcite-button.js"),icon:()=>import("./calcite-icon.js"),input:()=>import("./calcite-input.js")})}render(){const{field:t,mode:e}=this,n="input"===e,{locked:i,readOnly:o}=t;return g("div",{class:this.classes({[Kt.base]:!0,[Kt.feedbackMode]:"feedback"===e,[Kt.inputMode]:"input"===e,[Kt.locked]:i,[Kt.readOnly]:o})},g("div",{class:Kt.title,key:"title"},this._title),g("div",{class:Kt.value,key:"value",onkeydown:this._onKeyDown},n?this._renderValueInputMode():this._renderValueFeedbackMode()))}get _formattedValue(){return this.field.getFormattedValue(this.context)||Wt}get _rawDisplayValue(){return this.field.getRawDisplayValue(this.context)}get _suffix(){return this.field.getSuffix(this.context)}get _title(){const{title:t}=this.field;return"string"==typeof t?t:t(this.context)}_renderValueFeedbackMode(){return g(_,null,g("div",{class:Kt.valueContent,key:"value-feedback"},this._formattedValue),this.field.locked&&"input"!==this.mode?g("calcite-icon",{class:Kt.lockIcon,icon:Nt,key:"icon",scale:"s"}):null)}_renderValueInputMode(){return this.field.readOnly?this._renderValueReadOnly():this._renderValueWritable()}_renderValueReadOnly(){return g("div",{class:this.classes(Kt.valueContent,Kt.valueContentReadOnly),key:"value-read-only"},this._formattedValue)}_renderValueWritable(){const{field:t}=this,{name:e,invalid:n,locked:i}=t,o=this.context?.messages.sketch??{},s=i?o.unlockConstraint:o.lockConstraint;return g(_,null,g("calcite-input",{afterCreate:t=>{this._input=t},class:Kt.input,"data-field-name":e,"data-testid":`tooltip-field-${e}`,onblur:this._onInputBlur,onfocus:this._selectText,onkeydown:this._onInputKeyDown,scale:"s",status:n?"invalid":"idle",type:"text",value:this._rawDisplayValue??Wt,onCalciteInputInput:this._onInput}),g("div",{class:Kt.inputSuffix,key:"suffix"},this._suffix),t.lockable?g("calcite-button",{alignment:"center",appearance:"transparent",class:Kt.button,"data-testid":`tooltip-field-${e}-lock`,iconStart:i?Nt:"unlock",key:"lock",kind:"neutral",label:s,onclick:()=>{t.toggleLock(this.context)},scale:"s",tabIndex:-1,title:s}):g("div",{key:"lock-empty"}))}};t([n()],Bt.prototype,"field",void 0),t([n()],Bt.prototype,"context",void 0),t([n()],Bt.prototype,"mode",void 0),t([n()],Bt.prototype,"_input",void 0),t([n()],Bt.prototype,"_formattedValue",null),t([n()],Bt.prototype,"_rawDisplayValue",null),t([n()],Bt.prototype,"_suffix",null),t([n()],Bt.prototype,"_title",null),Bt=t([i("esri.views.interactive.tooltip.components.TooltipEditableField")],Bt);const Wt="—";function Zt(t){const e=t.fields.filter((t=>!0===t?.visible));return 0===e.length?null:g(_,null,e.map((e=>g(Bt,{context:t.context,field:e,key:e.id,mode:t.mode}))))}let Gt=class extends Rt{_renderContent(){const{fieldContext:t,info:e,mode:n}=this,{visibleElements:i}=e;return g(Zt,{context:t,fields:[i.coordinates?e.effectiveX:void 0,i.coordinates?e.effectiveY:void 0,i.elevation?e.elevation:void 0,i.orientation?e.orientation:void 0,i.scale?e.scale:void 0],mode:n})}};Gt=t([i("esri.views.interactive.tooltip.content.TooltipContentDrawMesh")],Gt);let Jt=class extends Rt{_renderContent(){const{fieldContext:t,info:e,mode:n}=this,{elevation:i,visibleElements:o}=e;return g(Zt,{context:t,fields:[o.coordinates?e.effectiveX:void 0,o.coordinates?e.effectiveY:void 0,o.elevation?i:void 0],mode:n})}};Jt=t([i("esri.views.interactive.tooltip.content.TooltipContentDrawPoint")],Jt);let Qt=class extends h{constructor(t){super(t),this.visibleElements={}}render(){return g("div",{class:$t},this._isElementVisible("direction")?g(te,{messages:this.messages,sketchOptions:this.sketchOptions}):null)}loadDependencies(){return v({button:()=>import("./calcite-button.js"),dropdown:()=>import("./calcite-dropdown.js"),"dropdown-item":()=>import("./calcite-dropdown-item.js"),"dropdown-group":()=>import("./calcite-dropdown-group.js")})}_isElementVisible(t){return this.visibleElements?.[t]??this.sketchOptions.tooltips.visibleElements[t]}};function te(t){const{directionMode:e}=t.sketchOptions.values,n=t.messages?.sketch,i=n?.directionModeSelect?.title,o="absolute",s="relative";return g("calcite-dropdown",{key:"direction-mode",placement:"bottom-end",scale:"s",widthScale:"s",onCalciteDropdownSelect:e=>{const n=e.target.selectedItems?.[0]?.getAttribute("data-mode");t.sketchOptions.values.directionMode=n??"absolute"}},g("calcite-button",{alignment:"end",appearance:"transparent",iconStart:B[e],kind:"neutral",label:i,scale:"s",slot:"trigger",title:i}),g("calcite-dropdown-group",{selectionMode:"single"},g("calcite-dropdown-item",{"data-mode":s,"data-testid":"tooltip-direction-mode-relative",iconStart:B.relative,key:"relative",selected:e===s},n?.directionModeSelect?.relative),g("calcite-dropdown-item",{"data-mode":o,"data-testid":"tooltip-direction-mode-absolute",iconStart:B.absolute,key:"absolute",selected:e===o},n?.directionModeSelect?.absolute)))}t([N("esri/views/interactive/tooltip/t9n/Tooltip"),n()],Qt.prototype,"messages",void 0),t([n()],Qt.prototype,"sketchOptions",void 0),t([n()],Qt.prototype,"visibleElements",void 0),Qt=t([i("esri.views.interactive.tooltip.components.DrawHeaderActions")],Qt);let ee=class extends Rt{_renderContent(){const{fieldContext:t,info:e,mode:n}=this,{xyMode:i,visibleElements:o}=e;return g(Zt,{context:t,fields:[..."direction-distance"===i?[o.direction?e.direction:void 0,o.distance?e.distance:void 0]:[o.coordinates?e.effectiveX:void 0,o.coordinates?e.effectiveY:void 0],o.elevation?e.elevation:void 0,o.area?e.area:void 0],mode:n})}_renderActions(){const{xyMode:t,sketchOptions:e}=this.info;return g(Qt,{sketchOptions:e,visibleElements:{direction:"direction-distance"===t}})}};ee=t([i("esri.views.interactive.tooltip.content.TooltipContentDrawPolygon")],ee);let ne=class extends Rt{_renderContent(){const{fieldContext:t,info:e,mode:n}=this,{xyMode:i,visibleElements:o}=e;return g(Zt,{context:t,fields:[..."direction-distance"===i?[o.direction?e.direction:void 0,o.distance?e.distance:void 0]:[o.coordinates?e.effectiveX:void 0,o.coordinates?e.effectiveY:void 0],o.elevation?e.elevation:void 0,o.totalLength?e.totalLength:void 0],mode:n})}_renderActions(){const{xyMode:t,sketchOptions:e}=this.info;return g(Qt,{sketchOptions:e,visibleElements:{direction:"direction-distance"===t}})}};ne=t([i("esri.views.interactive.tooltip.content.TooltipContentDrawPolyline")],ne);let ie=class extends Rt{_renderContent(){const{area:t,xSize:e,ySize:n,visibleElements:i}=this.info,o=this._messagesTooltip.sketch,s=this._formatters;return g(_,null,i.size&&null!=e&&null!=n?g(Ot,{title:o.size,value:g(Ut,{left:s.length(e),right:s.length(n)})}):null,i.area?g(Ot,{title:o.area,value:s.area(t)}):null)}};ie=t([i("esri.views.interactive.tooltip.content.TooltipContentDrawRectangle")],ie);let oe=class extends Rt{_renderContent(){const{angle:t,visibleElements:e}=this.info,n=this._messagesTooltip.sketch;return g(_,null,e.rotation?g(Ot,{title:n.rotation,value:this._formatters.angleRelative(t)}):null)}};oe=t([i("esri.views.interactive.tooltip.content.TooltipContentExtentRotate")],oe);let se=class extends Rt{_renderContent(){const t=this.info,{visibleElements:e}=t,n=this._messagesTooltip.sketch,i=this._formatters;return g(_,null,e.size?g(Ot,{title:n.size,value:g(Ut,{left:i.length(t.xSize),right:i.length(t.ySize)})}):null,e.scale?g(Ot,{title:n.scale,value:g(Ut,{left:i.scale(t.xScale),right:i.scale(t.yScale)})}):null)}};se=t([i("esri.views.interactive.tooltip.content.TooltipContentExtentScale")],se);let le=class extends Rt{_renderContent(){const{fieldContext:t,info:e,mode:n}=this,{visibleElements:i}=e;return g(Zt,{context:t,fields:[i.coordinates?e.effectiveX:void 0,i.coordinates?e.effectiveY:void 0,i.elevation?e.elevation:void 0],mode:n})}};le=t([i("esri.views.interactive.tooltip.content.TooltipContentMovePoint")],le);let re=class extends Rt{_renderContent(){const{area:t,distance:e,totalLength:n,visibleElements:i}=this.info,o=this._messagesTooltip.sketch,s=this._formatters;return g(_,null,i.distance?g(Ot,{title:o.distance,value:s.lengthRelative(e)}):null,i.area&&null!=t?g(Ot,{title:o.area,value:s.area(t)}):null,i.totalLength&&null!=n?g(Ot,{title:o.totalLength,value:s.length(n)}):null)}};re=t([i("esri.views.interactive.tooltip.content.TooltipContentReshapeEdgeOffset")],re);let ae=class extends Rt{_renderContent(){const{fieldContext:t,info:e,mode:n}=this,{visibleElements:i}=e;return g(Zt,{context:t,fields:[i.coordinates?e.effectiveX:void 0,i.coordinates?e.effectiveY:void 0,i.elevation?e.elevation:void 0,i.area&&"polygon"===e.geometryType?e.area:null,i.totalLength&&"polyline"===e.geometryType?e.totalLength:null],mode:n})}};ae=t([i("esri.views.interactive.tooltip.content.TooltipContentSelectedVertex")],ae);let ce=class extends Rt{_renderContent(){const{info:t}=this,{visibleElements:e}=t,n=this._messagesTooltip.sketch,i=this._formatters;return g(_,null,e.orientation&&null!=t.orientation?g(Ot,{key:"orientation",title:n.orientation,value:z(t.orientation,t.rotationType,t.orientationPrecision)}):null,e.size&&null!=t.size?g(Ot,{key:"size",title:n.size,value:i.length(t.size,t.sizeUnit,t.sizePrecision)}):null)}};ce=t([i("esri.views.interactive.tooltip.content.TooltipContentTransformAbsolute")],ce);let de=class extends Rt{_renderContent(){const{fieldContext:t,info:e,mode:n}=this,{visibleElements:i}=e;return g(Zt,{context:t,fields:[i.coordinates?e.effectiveX:void 0,i.coordinates?e.effectiveY:void 0,i.elevation?e.elevation:void 0,i.orientation?e.orientation:void 0,i.scale?e.scale:void 0],mode:n})}};de=t([i("esri.views.interactive.tooltip.content.TooltipContentTransformMesh")],de);let ue=class extends Rt{_renderContent(){const{fieldContext:t,info:e,mode:n}=this,{visibleElements:i}=e;return g(Zt,{context:t,fields:[i.coordinates?e.effectiveX:void 0,i.coordinates?e.effectiveY:void 0,i.elevation?e.elevation:void 0],mode:n})}};ue=t([i("esri.views.interactive.tooltip.content.TooltipContentTransformPoint")],ue);let pe=class extends Rt{_renderContent(){const{info:t}=this,{visibleElements:e}=t,n=this._messagesTooltip.sketch;return g(_,null,e.rotation&&null!=t.rotation?g(Ot,{key:"rotation",title:n.rotation,value:A(t.rotation,t.rotationType,t.rotationPrecision)}):null,e.orientation&&null!=t.orientation?g(Ot,{key:"orientation",title:n.orientation,value:z(t.orientation,t.rotationType,t.orientationPrecision)}):null)}};pe=t([i("esri.views.interactive.tooltip.content.TooltipContentTransformRotate")],pe);let he=class extends Rt{_renderContent(){const{info:t}=this,{visibleElements:e}=t,n=this._messagesTooltip.sketch,i=this._formatters;return g(_,null,e.scale&&null!=t.scale?g(Ot,{key:"scale",title:n.scale,value:i.percentage(t.scale)}):null,e.size&&null!=t.size?g(Ot,{key:"size",title:n.size,value:i.length(t.size,t.sizeUnit,t.sizePrecision)}):null)}};he=t([i("esri.views.interactive.tooltip.content.TooltipContentTransformScale")],he);let ve=class extends Rt{_renderContent(){const{info:t}=this,{visibleElements:e}=t,n=this._messagesTooltip.sketch,i=this._formatters;return g(_,null,e.distance?g(Ot,{title:n.distance,value:i.length(t.distance)}):null)}};ve=t([i("esri.views.interactive.tooltip.content.TooltipContentTranslate")],ve);let fe=class extends Rt{_renderContent(){const{distance:t,elevation:e,area:n,totalLength:i,visibleElements:o}=this.info,s=this._messagesTooltip.sketch,l=this._formatters;return g(_,null,o.distance?g(Ot,{title:s.distance,value:l.length(t)}):null,o.elevation&&null!=e?.actual?g(Ot,{title:s.elevation,value:l.verticalLength(e.actual)}):null,o.area&&null!=n?g(Ot,{title:s.area,value:l.area(n)}):null,o.totalLength&&null!=i?g(Ot,{title:s.totalLength,value:l.length(i)}):null)}};fe=t([i("esri.views.interactive.tooltip.content.TooltipContentTranslateVertex")],fe);let me=class extends Rt{_renderContent(){const{info:t}=this,{visibleElements:e}=t,n=this._messagesTooltip.sketch,i=this._formatters;return g(_,null,e.distance?g(Ot,{title:n.distance,value:i.length(t.distance)}):null)}};me=t([i("esri.views.interactive.tooltip.content.TooltipContentTranslateXY")],me);let ge=class extends Rt{_renderContent(){const{info:t}=this,{visibleElements:e}=t,n=this._messagesTooltip.sketch;return g(_,null,e.distance?g(Ot,{title:n.distance,value:this._formatters.verticalLengthRelative(t.distance)}):null)}};ge=t([i("esri.views.interactive.tooltip.content.TooltipContentTranslateZ")],ge);const _e={base:`${Ct}`};let ye=class extends o.EventedAccessor{constructor(t){super(t),this.info=null,this.position=null,this.content=null,this.contentContainer=(()=>{const t=document.createElement("div");return t.classList.add(_e.base),p(t),t})()}initialize(){const{contentContainer:t}=this;this.addHandles([d((()=>this.view.overlay?.surface),(e=>{t.remove(),e?.appendChild(t)}),u),d((()=>this.info),((e,n)=>{if(null!=this.content&&null!=e&&null!=n&&e.type===n.type)this.content.info=e;else{this.content=c(this.content);const n=function(t,e){if(null==e)return null;const n=document.createElement("div");switch(e.type){case"draw-point":return new Jt({tooltip:t,info:e,container:n});case"draw-polygon":return new ee({tooltip:t,info:e,container:n});case"draw-polyline":return new ne({tooltip:t,info:e,container:n});case"draw-mesh":return new Gt({tooltip:t,info:e,container:n});case"draw-rectangle":return new ie({tooltip:t,info:e,container:n});case"draw-circle":return new Yt({tooltip:t,info:e,container:n});case"extent-rotate":return new oe({tooltip:t,info:e,container:n});case"extent-scale":return new se({tooltip:t,info:e,container:n});case"move-point":return new le({tooltip:t,info:e,container:n});case"selected-vertex":return new ae({tooltip:t,info:e,container:n});case"transform-absolute":return new ce({tooltip:t,info:e,container:n});case"transform-point":return new ue({tooltip:t,info:e,container:n});case"transform-mesh":return new de({tooltip:t,info:e,container:n});case"transform-rotate":return new pe({tooltip:t,info:e,container:n});case"transform-scale":return new he({tooltip:t,info:e,container:n});case"translate":return new ve({tooltip:t,info:e,container:n});case"translate-vertex":return new fe({tooltip:t,info:e,container:n});case"translate-z":return new ge({tooltip:t,info:e,container:n});case"translate-xy":return new me({tooltip:t,info:e,container:n});case"reshape-edge-offset":return new re({tooltip:t,info:e,container:n})}}(this,e);n&&(this.content=n,n.container&&t.appendChild(n.container),this.exitInputMode())}}),u),d((()=>({container:this.contentContainer,content:this.content,screenPoint:this._screenPoint,positionMode:this.positionMode,position:this.position})),be,u),a(this.contentContainer,"paste",(t=>{this.emit("paste",t)}))])}destroy(){this.info=null,this.content=c(this.content),this.contentContainer.remove()}get positionMode(){return"input"===this.content?.mode?"fixed":"follow-cursor"}get mode(){return this.content?.mode??"feedback"}get _screenPoint(){const{inputManager:t}=this.view;return t?.multiTouchActive?null:t?.latestPointerLocation}get visible(){return"none"!==this.contentContainer?.style.display}clear(){this.info=null}async enterInputMode(t){await(this.content?.enterInputMode(t))}async exitInputMode(t){await(this.content?.exitInputMode(t))}};function be(t){if("fixed"===t.positionMode&&!t.position)return;const{style:e}=t.container,n=t.position??t.screenPoint;if(null!=n&&null!=t.content){e.display="block";const i=m(t.container),o=`translate(${Math.round(n.x)+we[0]*(i?-1:1)}px, ${Math.round(n.y)+we[1]}px)`;e.transform=i?`translate(-100%, 0) ${o}`:o}else e.display="none"}t([n({nonNullable:!0})],ye.prototype,"view",void 0),t([n()],ye.prototype,"info",void 0),t([n()],ye.prototype,"positionMode",null),t([n()],ye.prototype,"position",void 0),t([n()],ye.prototype,"content",void 0),t([n()],ye.prototype,"mode",null),t([n()],ye.prototype,"contentContainer",void 0),t([n()],ye.prototype,"_screenPoint",null),ye=t([i("esri.views.interactive.tooltip.Tooltip")],ye);const we=[20,20];export{kt as S,ye as T,ft as a,_t as b,yt as c,st as d,bt as e,ot as f,pt as m,gt as p};

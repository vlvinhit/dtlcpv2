"use strict";(self.webpackChunkRemoteClient=self.webpackChunkRemoteClient||[]).push([[9292],{4335:(e,r,t)=>{t.d(r,{d:()=>o});var i=t(32816),a=t(29298),s=(t(32773),t(20266),t(69421));t(36544),t(93181),t(13671),t(40499),t(6407),t(90740),t(91047);const o=e=>{let r=class extends e{constructor(){super(...arguments),this.customParameters=null}};return(0,i._)([(0,a.MZ)({type:Object,json:{write:{overridePolicy:e=>({enabled:!!(e&&Object.keys(e).length>0)})}}})],r.prototype,"customParameters",void 0),r=(0,i._)([(0,s.$)("esri.layers.mixins.CustomParametersMixin")],r),r}},88730:(e,r,t)=>{t.d(r,{q:()=>f});var i=t(32816),a=t(66136),s=t(6407),o=t(99063),l=t(29298),n=t(36544),p=(t(32773),t(49877)),y=t(69421),d=t(56273),u=t(82530),c=t(99924),h=t(98238);t(4734),t(50214),t(93804),t(90740),t(59192),t(13671),t(78016),t(54483),t(20266),t(41390),t(40499),t(93181),t(58498),t(91047),t(45371),t(80959),t(44600),t(2160),t(7969),t(69763),t(18683),t(64604),t(29512),t(64752),t(48844),t(29208),t(1178),t(49755),t(30011),t(55270),t(95779),t(13262),t(346),t(16699),t(26809),t(2589),t(18527),t(94345),t(36533),t(84200),t(97827),t(91695),t(18169),t(48402),t(67504),t(92517),t(77037),t(54131),t(19869),t(64524);const g={ArcGISAnnotationLayer:!0,ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,CatalogLayer:!0,CSV:!0,GeoJSON:!0,GeoRSS:!0,GroupLayer:!0,KML:!0,KnowledgeGraphLayer:!0,MediaLayer:!0,OGCFeatureLayer:!0,OrientedImageryLayer:!0,SubtypeGroupLayer:!0,VectorTileLayer:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},m={ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,OpenStreetMap:!0,VectorTileLayer:!0,WMS:!0,WebTiledLayer:!0},w={ArcGISFeatureLayer:!0,SubtypeGroupTable:!0},v={"web-scene/operational-layers":{ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledElevationServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BuildingSceneLayer:!0,CatalogLayer:!0,CSV:!0,GeoJSON:!0,GroupLayer:!0,IntegratedMesh3DTilesLayer:!0,IntegratedMeshLayer:!0,KML:!0,LineOfSightLayer:!0,MediaLayer:!0,OGCFeatureLayer:!0,PointCloudLayer:!0,RasterDataLayer:!0,VectorTileLayer:!0,Voxel:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},"web-scene/basemap":{ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,WMS:!0,WebTiledLayer:!0},"web-scene/ground":{ArcGISTiledElevationServiceLayer:!0,RasterDataElevationLayer:!0},"web-scene/tables":{ArcGISFeatureLayer:!0},"web-map/operational-layers":g,"web-map/basemap":m,"web-map/tables":w,"link-chart/operational-layers":{...g,LinkChartLayer:!0},"link-chart/basemap":m,"link-chart/tables":w,"portal-item/operational-layers":{ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,BuildingSceneLayer:!0,IntegratedMesh3DTilesLayer:!0,IntegratedMeshLayer:!0,MediaLayer:!0,OrientedImageryLayer:!0,PointCloudLayer:!0,SubtypeGroupLayer:!0}},f=e=>{let r=class extends e{constructor(){super(...arguments),this.persistenceEnabled=!0,this.title=null}readId(e,r,t){return"Group Layer"===t?.portalItem?.type?void 0:e}writeListMode(e,r,t,i){(i&&"ground"===i.layerContainerType||e&&(0,c.w)(this,t,{},i))&&(r[t]=e)}writeOperationalLayerType(e,r,t,i){e&&"tables"!==i?.layerContainerType&&(r.layerType=e)}writeTitle(e,r){r.title=e??"Layer"}readTimeExtent(e){return e?a.A.fromArray(e):null}writeTimeExtent(e,r,t,i){e&&"tables"!==i.layerContainerType&&(e.isEmpty?i?.messages&&i.messages.push(new s.A("layer:invalid-visibilityTimeExtent","visibilityTimeExtent cannot be empty")):r[t]=e.toArray())}read(e,r){r&&(r.layer=this),(0,c.r)(this,e,(r=>super.read(e,r)),r)}write(e,r){if(!this.persistenceEnabled&&!r?.ignorePersistenceEnabled)return null;if(r?.origin){const e=`${r.origin}/${r.layerContainerType||"operational-layers"}`,t=v[e];let i=!!t?.[this.operationalLayerType];if("ArcGISTiledElevationServiceLayer"===this.operationalLayerType&&"web-scene/operational-layers"===e&&(i=!1),"ArcGISDimensionLayer"===this.operationalLayerType&&"web-map/operational-layers"===e&&(i=!1),!i)return r.messages?.push(new s.A("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${e}'`,{layer:this})),null}const t=super.write(e,{...r,layer:this}),i=!!r&&!!r.messages&&!!r.messages.filter((e=>e instanceof s.A&&"web-document-write:property-required"===e.name)).length;return(0,o.w8)(t?.url)?(r?.messages?.push(new s.A("layer:invalid-url",`Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' using a Blob URL cannot be written to web scenes and web maps`,{layer:this})),null):!this.url&&i?null:t}beforeSave(){}};return(0,i._)([(0,l.MZ)({type:String,json:{write:{ignoreOrigin:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0}},"portal-item":{write:!1}}}})],r.prototype,"id",void 0),(0,i._)([(0,p.r)("id",["id"])],r.prototype,"readId",null),(0,i._)([(0,l.MZ)(h.d)],r.prototype,"listMode",void 0),(0,i._)([(0,d.w)("listMode")],r.prototype,"writeListMode",null),(0,i._)([(0,l.MZ)({type:String,readOnly:!0,json:{read:!1,write:{target:"layerType",ignoreOrigin:!0},origins:{"portal-item":{write:!1},"web-scene":{name:"layerType",read:!1,write:{enabled:!0,ignoreOrigin:!0,layerContainerTypes:u.e}}}}})],r.prototype,"operationalLayerType",void 0),(0,i._)([(0,d.w)("operationalLayerType")],r.prototype,"writeOperationalLayerType",null),(0,i._)([(0,l.MZ)(h.o)],r.prototype,"opacity",void 0),(0,i._)([(0,l.MZ)({type:Boolean,readOnly:!1})],r.prototype,"persistenceEnabled",void 0),(0,i._)([(0,l.MZ)({type:String,json:{write:{ignoreOrigin:!0,writerEnsuresNonNull:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}},"portal-item":{write:!1}}},value:"Layer"})],r.prototype,"title",void 0),(0,i._)([(0,d.w)("title"),(0,d.w)(["web-scene"],"title")],r.prototype,"writeTitle",null),(0,i._)([(0,l.MZ)({type:a.A,json:{origins:{"web-scene":{write:{layerContainerTypes:u.e}}}}})],r.prototype,"visibilityTimeExtent",void 0),(0,i._)([(0,p.r)("visibilityTimeExtent")],r.prototype,"readTimeExtent",null),(0,i._)([(0,d.w)(["portal-item","web-map","web-scene"],"visibilityTimeExtent",{visibilityTimeExtent:{type:[[n.I,n.N]]}})],r.prototype,"writeTimeExtent",null),(0,i._)([(0,l.MZ)({type:Boolean,json:{origins:{"web-scene":{name:"visibility",write:{enabled:!0,layerContainerTypes:u.e}}},name:"visibility",write:!0}})],r.prototype,"visible",void 0),r=(0,i._)([(0,y.$)("esri.layers.mixins.OperationalLayer")],r),r}},38424:(e,r,t)=>{t.d(r,{A:()=>S});var i=t(32816),a=t(90740),s=t(29512),o=t(64604),l=t(73067),n=t(6407),p=t(20266),y=t(57732),d=t(80959),u=t(99063),c=t(29298),h=(t(32773),t(49877)),g=t(69421),m=t(56273),w=t(72604),v=t(82408),f=t(43059),I=t(24319),L=t(82454);t(41390),t(40499),t(93181),t(13671),t(58498),t(91047),t(45371),t(99924),t(36544),t(73509),t(28276),t(44600),t(2160),t(7969),t(69763),t(93804),t(18683),t(64752),t(48844),t(29208),t(59192),t(69277),t(70580),t(75191),t(89935),t(49813),t(1178),t(62092),t(78281),t(44945),t(2589),t(36533),t(84200),t(97827),t(91695),t(18169),t(48402),t(16699),t(26809),t(18527),t(67504),t(47387),t(46728),t(64102);const S=e=>{let r=class extends e{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0,this.userHasFullEditingPrivileges=!1,this.userHasUpdateItemPrivileges=!1}destroy(){this.portalItem=(0,y.d)(this.portalItem),this.resourceReferences.portalItem=null,this.resourceReferences.paths.length=0}set portalItem(e){e!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",e))}readPortalItem(e,r,t){if(r.itemId)return new f.default({id:r.itemId,portal:t?.portal})}writePortalItem(e,r){e?.id&&(r.itemId=e.id)}async loadFromPortal(e,r){if(this.portalItem?.id)try{const{load:i}=await Promise.all([t.e(570),t.e(4295)]).then(t.bind(t,24295));return(0,d.Te)(r),await i({instance:this,supportedTypes:e.supportedTypes,validateItem:e.validateItem,supportsData:e.supportsData,layerModuleTypeMap:e.layerModuleTypeMap},r)}catch(e){throw(0,d.zf)(e)||p.L.getLogger(this).warn(`Failed to load layer (${this.title}, ${this.id}) portal item (${this.portalItem.id})\n  ${e}`),e}}async finishLoadEditablePortalLayer(e){this._set("userHasEditingPrivileges",await this._fetchUserHasEditingPrivileges(e).catch((e=>((0,d.QP)(e),!0))))}async setUserPrivileges(e,r){if(!a.A.userPrivilegesApplied)return this.finishLoadEditablePortalLayer(r);if(this.url)try{const{features:{edit:t,fullEdit:i},content:{updateItem:a}}=await this._fetchUserPrivileges(e,r);this._set("userHasEditingPrivileges",t),this._set("userHasFullEditingPrivileges",i),this._set("userHasUpdateItemPrivileges",a)}catch(e){(0,d.QP)(e)}}async _fetchUserPrivileges(e,r){let t=this.portalItem;if(!e||!t||!t.loaded||t.sourceUrl)return this._fetchFallbackUserPrivileges(r);const i=e===t.id;if(i&&t.portal.user)return(0,L.g)(t);let a,o;if(i)a=t.portal.url;else try{a=await(0,w.f)(this.url,r)}catch(e){(0,d.QP)(e)}if(!a||!(0,u.b8)(a,t.portal.url))return this._fetchFallbackUserPrivileges(r);try{const e=null!=r?r.signal:null;o=await(s.id?.getCredential(`${a}/sharing`,{prompt:!1,signal:e}))}catch(e){(0,d.QP)(e)}const l=!0,n=!1,p=!1;if(!o)return{features:{edit:l,fullEdit:n},content:{updateItem:p}};try{if(i?await t.reload():(t=new f.default({id:e,portal:{url:a}}),await t.load(r)),t.portal.user)return(0,L.g)(t)}catch(e){(0,d.QP)(e)}return{features:{edit:l,fullEdit:n},content:{updateItem:p}}}async _fetchFallbackUserPrivileges(e){let r=!0;try{r=await this._fetchUserHasEditingPrivileges(e)}catch(e){(0,d.QP)(e)}return{features:{edit:r,fullEdit:!1},content:{updateItem:!1}}}async _fetchUserHasEditingPrivileges(e){const r=this.url?s.id?.findCredential(this.url):null;if(!r)return!0;const t=b.credential===r?b.user:await this._fetchEditingUser(e);return b.credential=r,b.user=t,null==t?.privileges||t.privileges.includes("features:user:edit")}async _fetchEditingUser(e){const r=this.portalItem?.portal?.user;if(r)return r;const t=s.id?.findServerInfo(this.url??"");if(!t?.owningSystemUrl)return null;const i=`${t.owningSystemUrl}/sharing/rest`,a=v.A.getDefault();if(a&&a.loaded&&(0,u.S8)(a.restUrl)===(0,u.S8)(i))return a.user;const n=`${i}/community/self`,p=null!=e?e.signal:null,y=await(0,l.r)((0,o.A)(n,{authMode:"no-prompt",query:{f:"json"},signal:p}));return y.ok?I.A.fromJSON(y.value.data):null}read(e,r){r&&(r.layer=this),super.read(e,r)}write(e,r){const t=r?.portal,i=this.portalItem?.id&&(this.portalItem.portal||v.A.getDefault());return t&&i&&!(0,u.ut)(i.restUrl,t.restUrl)?(r.messages&&r.messages.push(new n.A("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer`,{layer:this})),null):super.write(e,{...r,layer:this})}};return(0,i._)([(0,c.MZ)({type:f.default})],r.prototype,"portalItem",null),(0,i._)([(0,h.r)("web-document","portalItem",["itemId"])],r.prototype,"readPortalItem",null),(0,i._)([(0,m.w)("web-document","portalItem",{itemId:{type:String}})],r.prototype,"writePortalItem",null),(0,i._)([(0,c.MZ)({clonable:!1})],r.prototype,"resourceReferences",void 0),(0,i._)([(0,c.MZ)({type:Boolean,readOnly:!0})],r.prototype,"userHasEditingPrivileges",void 0),(0,i._)([(0,c.MZ)({type:Boolean,readOnly:!0})],r.prototype,"userHasFullEditingPrivileges",void 0),(0,i._)([(0,c.MZ)({type:Boolean,readOnly:!0})],r.prototype,"userHasUpdateItemPrivileges",void 0),r=(0,i._)([(0,g.$)("esri.layers.mixins.PortalLayer")],r),r},b={credential:null,user:null}},46935:(e,r,t)=>{t.d(r,{J:()=>v});var i=t(32816),a=(t(32773),t(20266)),s=t(80959),o=t(29298),l=t(48844),n=t(69421),p=t(82530),y=t(17745),d=(t(73067),t(6407),t(41390));t(90740),t(13671),t(36544),t(93181),t(40499),t(91047),t(81272),t(58498),t(45371),t(44945);const u=new y.A,c=new WeakMap;function h(e,r){return Number.isFinite(e)&&Number.isFinite(r)?r<=0?e:h(r,e%r):0}let g=0,m=0;function w(){const e=Date.now();let r=!1;for(const t of u){const i=t.deref();i?i.refreshInterval&&e-(c.get(i)??0)+5>=6e4*i.refreshInterval&&(c.set(i,e),i.refresh(e)):r=!0}if(r)for(let e=u.length-1;e>=0;e--)u.at(e).deref()||u.removeAt(e)}(0,d.a)((()=>{const e=Date.now();let r=0;for(const t of u){const i=t.deref();i&&(r=h(Math.round(6e4*i.refreshInterval),r),i.refreshInterval?c.get(i)||c.set(i,e):c.delete(i))}if(r!==m){if(m=r,clearInterval(g),0===m)return void(g=0);g=setInterval(w,m)}}));const v=e=>{let r=class extends e{constructor(...e){super(...e),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=(0,s.sg)((()=>this.hasDataChanged())),this.when().then((()=>{var e;this.destroyed||null!=(e=this)&&"object"==typeof e&&"refreshInterval"in e&&"refresh"in e&&u.push(new WeakRef(this))}),(()=>{}))}destroy(){!function(e){const r=u.find((r=>r.deref()===e));r&&u.remove(r)}(this)}castRefreshInterval(e){return e>=.1?e:e<=0?0:.1}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(e=Date.now()){(0,s.QZ)(this._debounceHasDataChanged()).then((r=>{r&&this._set("refreshTimestamp",e),this.emit("refresh",{dataChanged:r})}),(e=>{a.L.getLogger(this).error(e),this.emit("refresh",{dataChanged:!1,error:e})}))}async hasDataChanged(){return!0}get test(){}};return(0,i._)([(0,o.MZ)({type:Number,json:{write:!0,origins:{"web-scene":{write:{enabled:!0,layerContainerTypes:p.e}}}}})],r.prototype,"refreshInterval",void 0),(0,i._)([(0,l.w)("refreshInterval")],r.prototype,"castRefreshInterval",null),(0,i._)([(0,o.MZ)({readOnly:!0})],r.prototype,"refreshTimestamp",void 0),(0,i._)([(0,o.MZ)({readOnly:!0})],r.prototype,"refreshParameters",null),r=(0,i._)([(0,n.$)("esri.layers.mixins.RefreshableLayer")],r),r}},78644:(e,r,t)=>{t.d(r,{A:()=>d});var i=t(32816),a=t(52731),s=t(93804),o=t(99924),l=t(29298),n=(t(32773),t(20266),t(69421));t(41390),t(40499),t(93181),t(13671),t(58498),t(91047),t(45371),t(80959),t(6407),t(90740),t(36544);const p=new s.J({esriFeatureEditToolAutoCompletePolygon:"auto-complete-polygon",esriFeatureEditToolCircle:"circle",esriFeatureEditToolEllipse:"ellipse",esriFeatureEditToolFreehand:"freehand",esriFeatureEditToolLine:"line",esriFeatureEditToolNone:"none",esriFeatureEditToolPoint:"point",esriFeatureEditToolPolygon:"polygon",esriFeatureEditToolRectangle:"rectangle",esriFeatureEditToolArrow:"arrow",esriFeatureEditToolTriangle:"triangle",esriFeatureEditToolLeftArrow:"left-arrow",esriFeatureEditToolRightArrow:"right-arrow",esriFeatureEditToolUpArrow:"up-arrow",esriFeatureEditToolDownArrow:"down-arrow"});let y=class extends((0,a.O)(o.oY)){constructor(e){super(e),this.name=null,this.description=null,this.drawingTool=null,this.prototype=null,this.thumbnail=null}};(0,i._)([(0,l.MZ)({json:{write:!0}})],y.prototype,"name",void 0),(0,i._)([(0,l.MZ)({json:{write:!0}})],y.prototype,"description",void 0),(0,i._)([(0,l.MZ)({json:{read:p.read,write:p.write}})],y.prototype,"drawingTool",void 0),(0,i._)([(0,l.MZ)({json:{write:!0}})],y.prototype,"prototype",void 0),(0,i._)([(0,l.MZ)({json:{write:!0}})],y.prototype,"thumbnail",void 0),y=(0,i._)([(0,n.$)("esri.layers.support.FeatureTemplate")],y);const d=y}}]);
"use strict";(self.webpackChunkRemoteClient=self.webpackChunkRemoteClient||[]).push([[6702],{42614:(e,t,n)=>{n.d(t,{B:()=>a});var r=n(32773),s=n(11721),i=n(48402);const o={minX:0,minY:0,maxX:0,maxY:0};class a{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new s.P(9,(0,r.h)("esri-csp-restrictions")?e=>({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){const e=new Array(this._idByBounds.size);let t=0;this._idByBounds.forEach(((n,r)=>{e[t++]=r})),this._indexInvalid=!1,this._index.clear(),this._index.load(e)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter((e=>this._idByBounds.has(e)))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const e=(0,i.e)();for(const t of this._boundsById.values())t&&(e[0]=Math.min(t[0],e[0]),e[1]=Math.min(t[1],e[1]),e[2]=Math.max(t[2],e[2]),e[3]=Math.max(t[3],e[3]));return e}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(e){const t=this._boundsById.get(e);this._boundsById.delete(e),t&&(this._idByBounds.delete(t),this._indexInvalid||this._index.remove(t))}forEachInBounds(e,t){this._loadIndex(),function(e,t,n){!function(e){o.minX=e[0],o.minY=e[1],o.maxX=e[2],o.maxY=e[3]}(t),e.search(o,n)}(this._index,e,(e=>t(this._idByBounds.get(e))))}get(e){return this._boundsById.get(e)}has(e){return this._boundsById.has(e)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(e,t){if(!this._indexInvalid){const t=this._boundsById.get(e);t&&(this._index.remove(t),this._idByBounds.delete(t))}this._boundsById.set(e,t),t&&(this._idByBounds.set(t,e),this._indexInvalid||(this._boundsToLoad.push(t),this._boundsToLoad.length>5e4&&this._loadIndex()))}}},13141:(e,t,n)=>{n.d(t,{F:()=>y});var r=n(32773),s=n(6407),i=n(81272),o=n(20266),a=n(47239),l=n(48402),p=n(83637),u=n(42614),d=n(59700),h=n(11618);const c=(0,a.c)();class y{constructor(e){this.geometryInfo=e,this._boundsStore=new u.B,this._featuresById=new Map,this._markedIds=new Set,this.events=new i.A,this.featureAdapter=h.o}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let e=0;return this._featuresById.forEach((t=>{null!=t.geometry&&t.geometry.coords&&(e+=t.geometry.coords.length)})),{featureCount:this._featuresById.size,vertexCount:e/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}getFullExtent(e){if(null==this.fullBounds)return null;const[t,n,r,s]=this.fullBounds;return{xmin:t,ymin:n,xmax:r,ymax:s,spatialReference:(0,d.c)(e)}}add(e){this._add(e),this._emitChanged()}addMany(e){for(const t of e)this._add(t);this._emitChanged()}upsertMany(e){const t=e.map((e=>this._upsert(e)));return this._emitChanged(),t.filter(r.i)}clear(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged()}removeById(e){const t=this._featuresById.get(e);return t?(this._remove(t),this._emitChanged(),t):null}removeManyById(e){this._boundsStore.invalidateIndex();for(const t of e){const e=this._featuresById.get(t);e&&this._remove(e)}this._emitChanged()}forEachBounds(e,t){for(const n of e){const e=this._boundsStore.get(n.objectId);e&&t((0,a.g)(c,e))}}getFeature(e){return this._featuresById.get(e)}has(e){return this._featuresById.has(e)}forEach(e){this._featuresById.forEach((t=>e(t)))}forEachInBounds(e,t){this._boundsStore.forEachInBounds(e,(e=>{t(this._featuresById.get(e))}))}startMarkingUsedFeatures(){this._boundsStore.invalidateIndex(),this._markedIds.clear()}sweep(){let e=!1;this._featuresById.forEach(((t,n)=>{this._markedIds.has(n)||(e=!0,this._remove(t))})),this._markedIds.clear(),e&&this._emitChanged()}_emitChanged(){this.events.emit("changed",void 0)}_add(e){if(!e)return;const t=e.objectId;if(null==t)return void o.L.getLogger("esri.layers.graphics.data.FeatureStore").error(new s.A("featurestore:invalid-feature","feature id is missing",{feature:e}));const n=this._featuresById.get(t);let r;if(this._markedIds.add(t),n?(e.displayId=n.displayId,r=this._boundsStore.get(t),this._boundsStore.delete(t)):null!=this.onFeatureAdd&&this.onFeatureAdd(e),!e.geometry?.coords?.length)return this._boundsStore.set(t,null),void this._featuresById.set(t,e);r=(0,p.g)(null!=r?r:(0,l.c)(),e.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),null!=r&&this._boundsStore.set(t,r),this._featuresById.set(t,e)}_upsert(e){const t=e?.objectId;if(null==t)return o.L.getLogger("esri.layers.graphics.data.FeatureStore").error(new s.A("featurestore:invalid-feature","feature id is missing",{feature:e})),null;const n=this._featuresById.get(t);if(!n)return this._add(e),e;this._markedIds.add(t);const{geometry:r,attributes:i}=e;for(const e in i)n.attributes[e]=i[e];return r&&(n.geometry=r,this._boundsStore.set(t,(0,p.g)((0,l.c)(),r,this.geometryInfo.hasZ,this.geometryInfo.hasM)??null)),n}_remove(e){null!=this.onFeatureRemove&&this.onFeatureRemove(e);const t=e.objectId;return this._markedIds.delete(t),this._boundsStore.delete(t),this._featuresById.delete(t),e}}},72076:(e,t,n)=>{n.d(t,{O:()=>a});var r=n(32816),s=(n(20266),n(32773),n(6407),n(69421)),i=n(89754);let o=class extends i.A{constructor(e){super(e)}};o=(0,r._)([(0,s.$)("esri.rest.knowledgeGraph.ObjectValue")],o);const a=o},96625:(e,t,n)=>{n.d(t,{O:()=>d});var r,s=n(32816),i=n(93804),o=n(99924),a=n(29298),l=(n(32773),n(20266),n(69421));const p=new i.J({asc:"ascending",desc:"descending"});let u=r=class extends o.oY{constructor(e){super(e),this.field=null,this.valueExpression=null,this.order="ascending"}clone(){return new r({field:this.field,valueExpression:this.valueExpression,order:this.order})}};(0,s._)([(0,a.MZ)({type:String,json:{write:!0}})],u.prototype,"field",void 0),(0,s._)([(0,a.MZ)({type:String,json:{write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],u.prototype,"valueExpression",void 0),(0,s._)([(0,a.MZ)({type:p.apiValues,json:{type:p.jsonValues,read:p.read,write:p.write}})],u.prototype,"order",void 0),u=r=(0,s._)([(0,l.$)("esri.layers.support.OrderByInfo")],u);const d=u},11721:(e,t,n)=>{n.d(t,{P:()=>o});var r=n(32773),s=n(45371),i=n(32159);class o{constructor(e=9,t){this._compareMinX=d,this._compareMinY=h,this._toBBox=e=>e,this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),t&&("function"==typeof t?this._toBBox=t:this._initFormat(t)),this.clear()}destroy(){this.clear(),w.prune(),b.prune(),v.prune(),M.prune()}all(e){a(this._data,e)}search(e,t){let n=this._data;const r=this._toBBox;if(g(e,n))for(w.clear();n;){for(let s=0,i=n.children.length;s<i;s++){const i=n.children[s],o=n.leaf?r(i):i;g(e,o)&&(n.leaf?t(i):m(e,o)?a(i,t):w.push(i))}n=w.pop()}}collides(e){let t=this._data;const n=this._toBBox;if(!g(e,t))return!1;for(w.clear();t;){for(let r=0,s=t.children.length;r<s;r++){const s=t.children[r],i=t.leaf?n(s):s;if(g(e,i)){if(t.leaf||m(e,i))return!0;w.push(s)}}t=w.pop()}return!1}load(e){if(!e.length)return this;if(e.length<this._minEntries){for(let t=0,n=e.length;t<n;t++)this.insert(e[t]);return this}let t=this._build(e.slice(0,e.length),0,e.length-1,0);if(this._data.children.length)if(this._data.height===t.height)this._splitRoot(this._data,t);else{if(this._data.height<t.height){const e=this._data;this._data=t,t=e}this._insert(t,this._data.height-t.height-1,!0)}else this._data=t;return this}insert(e){return e&&this._insert(e,this._data.height-1),this}clear(){return this._data=new I([]),this}remove(e){if(!e)return this;let t,n=this._data,s=null,i=0,o=!1;const a=this._toBBox(e);for(v.clear(),M.clear();n||v.length>0;){if(n||(n=v.pop(),s=v.data[v.length-1],i=M.pop()??0,o=!0),n.leaf&&(t=(0,r.f)(n.children,e,n.children.length,n.indexHint),-1!==t))return n.children.splice(t,1),v.push(n),this._condense(v),this;o||n.leaf||!m(n,a)?s?(i++,n=s.children[i],o=!1):n=null:(v.push(n),M.push(i),i=0,s=n,n=n.children[0])}return this}toJSON(){return this._data}fromJSON(e){return this._data=e,this}_build(e,t,n,r){const s=n-t+1;let i=this._maxEntries;if(s<=i){const r=new I(e.slice(t,n+1));return l(r,this._toBBox),r}r||(r=Math.ceil(Math.log(s)/Math.log(i)),i=Math.ceil(s/i**(r-1)));const o=new E([]);o.height=r;const a=Math.ceil(s/i),p=a*Math.ceil(Math.sqrt(i));_(e,t,n,p,this._compareMinX);for(let s=t;s<=n;s+=p){const t=Math.min(s+p-1,n);_(e,s,t,a,this._compareMinY);for(let n=s;n<=t;n+=a){const s=Math.min(n+a-1,t);o.children.push(this._build(e,n,s,r-1))}}return l(o,this._toBBox),o}_insert(e,t,n){const r=this._toBBox,s=n?e:r(e);v.clear();const i=function(e,t,n,r){for(;r.push(t),!0!==t.leaf&&r.length-1!==n;){let n,r=1/0,o=1/0;for(let a=0,l=t.children.length;a<l;a++){const l=t.children[a],p=c(l),u=(s=e,i=l,(Math.max(i.maxX,s.maxX)-Math.min(i.minX,s.minX))*(Math.max(i.maxY,s.maxY)-Math.min(i.minY,s.minY))-p);u<o?(o=u,r=p<r?p:r,n=l):u===o&&p<r&&(r=p,n=l)}t=n||t.children[0]}var s,i;return t}(s,this._data,t,v);for(i.children.push(e),u(i,s);t>=0&&v.data[t].children.length>this._maxEntries;)this._split(v,t),t--;!function(e,t,n){for(let r=n;r>=0;r--)u(t.data[r],e)}(s,v,t)}_split(e,t){const n=e.data[t],r=n.children.length,s=this._minEntries;this._chooseSplitAxis(n,s,r);const i=this._chooseSplitIndex(n,s,r);if(!i)return;const o=n.children.splice(i,n.children.length-i),a=n.leaf?new I(o):new E(o);a.height=n.height,l(n,this._toBBox),l(a,this._toBBox),t?e.data[t-1].children.push(a):this._splitRoot(n,a)}_splitRoot(e,t){this._data=new E([e,t]),this._data.height=e.height+1,l(this._data,this._toBBox)}_chooseSplitIndex(e,t,n){let r,s,i;r=s=1/0;for(let o=t;o<=n-t;o++){const t=p(e,0,o,this._toBBox),a=p(e,o,n,this._toBBox),l=f(t,a),u=c(t)+c(a);l<r?(r=l,i=o,s=u<s?u:s):l===r&&u<s&&(s=u,i=o)}return i}_chooseSplitAxis(e,t,n){const r=e.leaf?this._compareMinX:d,s=e.leaf?this._compareMinY:h;this._allDistMargin(e,t,n,r)<this._allDistMargin(e,t,n,s)&&e.children.sort(r)}_allDistMargin(e,t,n,r){e.children.sort(r);const s=this._toBBox,i=p(e,0,t,s),o=p(e,n-t,n,s);let a=y(i)+y(o);for(let r=t;r<n-t;r++){const t=e.children[r];u(i,e.leaf?s(t):t),a+=y(i)}for(let r=n-t-1;r>=t;r--){const t=e.children[r];u(o,e.leaf?s(t):t),a+=y(o)}return a}_condense(e){for(let t=e.length-1;t>=0;t--){const n=e.data[t];if(0===n.children.length)if(t>0){const s=e.data[t-1],i=s.children;i.splice((0,r.f)(i,n,i.length,s.indexHint),1)}else this.clear();else l(n,this._toBBox)}}_initFormat(e){const t=["return a"," - b",";"];this._compareMinX=new Function("a","b",t.join(e[0])),this._compareMinY=new Function("a","b",t.join(e[1])),this._toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}function a(e,t){let n=e;for(b.clear();n;){if(!0===n.leaf)for(const e of n.children)t(e);else b.pushArray(n.children);n=b.pop()??null}}function l(e,t){p(e,0,e.children.length,t,e)}function p(e,t,n,r,s){s||(s=new I([])),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(let i,o=t;o<n;o++)i=e.children[o],u(s,e.leaf?r(i):i);return s}function u(e,t){e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY)}function d(e,t){return e.minX-t.minX}function h(e,t){return e.minY-t.minY}function c(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function y(e){return e.maxX-e.minX+(e.maxY-e.minY)}function f(e,t){const n=Math.max(e.minX,t.minX),r=Math.max(e.minY,t.minY),s=Math.min(e.maxX,t.maxX),i=Math.min(e.maxY,t.maxY);return Math.max(0,s-n)*Math.max(0,i-r)}function m(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function g(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function _(e,t,n,r,s){const o=[t,n];for(;o.length;){const t=o.pop(),n=o.pop();if(t-n<=r)continue;const a=n+Math.ceil((t-n)/r/2)*r;(0,i.q)(e,a,n,t,s),o.push(n,a,a,t)}}const w=new s.P,b=new s.P,v=new s.P,M=new s.P({deallocator:void 0});class T{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}class x extends T{constructor(){super(...arguments),this.height=1,this.indexHint=new r.P}}class I extends x{constructor(e){super(),this.children=e,this.leaf=!0}}class E extends x{constructor(e){super(),this.children=e,this.leaf=!1}}},41003:(e,t,n)=>{n.d(t,{Q:()=>i});var r=n(91047),s=n(44945);class i{constructor(e=(e=>e.values().next().value)){this._peeker=e,this._observable=new s.S,this._items=new Set}get length(){return(0,r.t)(this._observable),this._items.size}clear(){0!==this.length&&(this._items.clear(),this._observable.notify())}last(){if(0===this.length)return;let e;for(e of this._items);return e}peek(){if(0!==this.length)return this._peeker(this._items)}push(e){this.contains(e)||(this._items.add(e),this._observable.notify())}contains(e){return(0,r.t)(this._observable),this._items.has(e)}pop(){if(0===this.length)return;const e=this.peek();return this._items.delete(e),this._observable.notify(),e}popLast(){if(0===this.length)return;const e=this.last();return this._items.delete(e),this._observable.notify(),e}remove(e){this.contains(e)&&(this._items.delete(e),this._observable.notify())}filter(e){const t=this.length;return this._items.forEach((t=>{e(t)||this._items.delete(t)})),t!==this._items.size&&this._observable.notify(),this}*[Symbol.iterator](){(0,r.t)(this._observable),yield*this._items}}},53104:(e,t,n)=>{n.d(t,{a:()=>d,b:()=>p,c:()=>o,d:()=>h});var r=n(32773),s=n(70648),i=n(25018);function o(e){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===e||"esriGeometryMultipoint"===e?i.d:"esriGeometryPolyline"===e?i.a:i.b}}}const a=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let l=1;function p(e,t){if((0,r.h)("esri-csp-restrictions"))return()=>({[t]:null,...e});try{let n=`this${u(t)} = null;`;for(const t in e)n+=`this${u(t)} = ${JSON.stringify(e[t])};`;const r=new Function(`\n      return class AttributesClass$${l++} {\n        constructor() {\n          ${n};\n        }\n      }\n    `)();return()=>new r}catch(n){return()=>({[t]:null,...e})}}function u(e){return a.test(e)?`.${e}`:`["${e}"]`}function d(e={}){return[{name:"New Feature",description:"",prototype:{attributes:(0,r.o8)(e)}}]}function h(e,t){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:e},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:t,supportsDelete:t,supportsEditing:t,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:t,supportsExceedsLimitStatistics:!0,supportsAsyncConvert3D:!1},query:s.q,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsGeometryUpdate:t,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1,zDefault:void 0}}}},95637:(e,t,n)=>{n.d(t,{f:()=>l,t:()=>a}),n(32773);var r=n(59930),s=n(45862),i=n(72762),o=n(71613);const a={key:"type",base:s.A,typeMap:{range:o.A,"coded-value":r.A,inherited:i.A}};function l(e){if(!e?.type)return null;switch(e.type){case"range":return o.A.fromJSON(e);case"codedValue":return r.A.fromJSON(e);case"inherited":return i.A.fromJSON(e)}return null}},36309:(e,t,n)=>{n.d(t,{a:()=>T,b:()=>m,c:()=>_,d:()=>g,g:()=>f,s:()=>c,t:()=>y});var r=n(20266);const s="__begin__",i="__end__",o=new RegExp(s,"ig"),a=new RegExp(i,"ig"),l=new RegExp("^"+s,"i"),p=new RegExp(i+"$","i"),u='"',d=u+" + ",h=" + "+u;function c(e){return e.replaceAll(new RegExp("\\[","g"),"{").replaceAll(new RegExp("\\]","g"),"}")}function y(e){return e.replaceAll(new RegExp("\\{","g"),"[").replaceAll(new RegExp("\\}","g"),"]")}function f(e){const t={expression:"",type:"none"};return e.labelExpressionInfo?e.labelExpressionInfo.value?(t.expression=e.labelExpressionInfo.value,t.type="conventional"):e.labelExpressionInfo.expression&&(t.expression=e.labelExpressionInfo.expression,t.type="arcade"):null!=e.labelExpression&&(t.expression=c(e.labelExpression),t.type="conventional"),t}function m(e){const t=f(e);if(!t)return null;switch(t.type){case"conventional":return _(t.expression);case"arcade":return t.expression}return null}function g(e){const t=f(e);if(!t)return null;switch(t.type){case"conventional":return function(e){const t=e?.match(w);return t?.[1].trim()||null}(t.expression);case"arcade":return T(t.expression)}return null}function _(e){let t;return e?(t=(0,r.r)(e,(e=>s+'$feature["'+e+'"]'+i)),t=l.test(t)?t.replace(l,""):u+t,t=p.test(t)?t.replace(p,""):t+u,t=t.replaceAll(o,d).replaceAll(a,h)):t='""',t}const w=/^\s*\{([^}]+)\}\s*$/i,b=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*$/i,v=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,M=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(.+)(\1)\s*\));?\s*$/i;function T(e){if(!e)return null;let t=b.exec(e)||v.exec(e);return t?t[1]||t[3]:(t=M.exec(e),t?t[2]:null)}},339:(e,t,n)=>{n.d(t,{c:()=>o,g:()=>p,o:()=>a,u:()=>l});var r=n(67504),s=n(7969),i=n(77037);const o={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new r.A({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:s.A.WebMercator}),minus180Line:new r.A({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:s.A.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new r.A({paths:[[[180,-180],[180,180]]],spatialReference:s.A.WGS84}),minus180Line:new r.A({paths:[[[-180,-180],[-180,180]]],spatialReference:s.A.WGS84})}};function a(e,t){return Math.ceil((e-t)/(2*t))}function l(e,t){const n=p(e);for(const e of n)for(const n of e)n[0]+=t;return e}function p(e){return(0,i.Bi)(e)?e.rings:e.paths}},79281:(e,t,n)=>{n.d(t,{c:()=>p,s:()=>u}),n(94345);var r=n(64604),s=n(77037),i=n(69763),o=n(69033),a=n(99063),l=n(13978);async function p(e,t,n,a){const l=(0,o.p)(e),p=t[0].spatialReference,u={...a,responseType:"json",query:{...l.query,f:"json",sr:(0,i.Y)(p),target:JSON.stringify({geometryType:(0,s.$B)(t[0]),geometries:t}),cutter:JSON.stringify(n)}},d=await(0,r.A)(l.path+"/cut",u),{cutIndexes:h,geometries:c=[]}=d.data;return{cutIndexes:h,geometries:c.map((e=>{const t=(0,s.rS)(e);return t.spatialReference=p,t}))}}async function u(e,t,n){const o="string"==typeof e?(0,a.An)(e):e,p=t[0].spatialReference,u=(0,s.$B)(t[0]),d={...n,query:{...o.query,f:"json",sr:(0,i.Y)(p),geometries:JSON.stringify((0,l.e)(t))}},{data:h}=await(0,r.A)(o.path+"/simplify",d);return(0,l.d)(h.geometries,u,p)}},69033:(e,t,n)=>{n.d(t,{a:()=>i,e:()=>a,p:()=>o}),n(90740),n(29512);var r=n(32773),s=n(99063);function i(e,t){return t?{...t,query:{...e??{},...t.query}}:{query:e}}function o(e){return"string"==typeof e?(0,s.An)(e):(0,r.o8)(e)}function a(e,t,n){const r={};for(const s in e){if("declaredClass"===s)continue;const i=e[s];if(null!=i&&"function"!=typeof i)if(Array.isArray(i))r[s]=i.map((e=>a(e)));else if("object"==typeof i)if(i.toJSON){const e=i.toJSON(n?.[s]);r[s]=t?e:JSON.stringify(e)}else r[s]=t?i:JSON.stringify(i);else r[s]=i}return r}n(64604)},13978:(e,t,n)=>{n.d(t,{d:()=>i,e:()=>s});var r=n(77037);function s(e){return{geometryType:(0,r.$B)(e[0]),geometries:e.map((e=>e.toJSON()))}}function i(e,t,n){const s=(0,r.xD)(t);return e.map((e=>{const t=s.fromJSON(e);return t.spatialReference=n,t}))}},23381:(e,t,n)=>{async function r(e,t){const{WhereClause:r}=await Promise.all([n.e(8896),n.e(6589)]).then(n.bind(n,38896)).then((e=>e.W));return r.create(e,t)}function s(e,t){return"1=1"===e?t??e:"1=1"===t?e??t:null!=e&&""!==e?null!=t&&""!==t?`(${e}) AND (${t})`:e:t}n.d(t,{G:()=>r,m:()=>s})},6801:(e,t,n)=>{n.d(t,{A:()=>p,r:()=>l});var r=n(13671),s=(n(32773),n(80959)),i=n(41003),o=n(9380);n(6407),n(20266),n(90740),n(91047),n(93181),n(44945),n(58498),n(29512),n(99063),n(99924),n(32816),n(41390),n(69421),n(40499),n(36544),n(29298),n(45371);const a=new FinalizationRegistry((e=>{e.close()}));function l(e,t){a.register(e,t,t)}class p{constructor(){this._inUseClients=new Array,this._clients=new Array,this._clientPromises=new Array,this._ongoingJobsQueue=new i.Q}destroy(){this.close()}get closed(){return!this._clients?.length}open(e,t){return new Promise(((n,r)=>{let i=!0;const a=e=>{(0,s.Te)(t.signal),i&&(i=!1,e())};this._clients.length=e.length,this._clientPromises.length=e.length,this._inUseClients.length=e.length;for(let i=0;i<e.length;++i){const l=e[i];(0,s.$X)(l)?this._clientPromises[i]=l.then((e=>(this._clients[i]=new o.default(e,t,this._ongoingJobsQueue),a(n),this._clients[i])),(()=>(a(r),null))):(this._clients[i]=new o.default(l,t,this._ongoingJobsQueue),this._clientPromises[i]=Promise.resolve(this._clients[i]),a(n))}}))}broadcast(e,t,n){const r=new Array(this._clientPromises.length);for(let s=0;s<this._clientPromises.length;++s){const i=this._clientPromises[s];r[s]=i.then((r=>r?.invoke(e,t,n)))}return r}close(){let e;for(;e=this._ongoingJobsQueue.pop();)e.resolver.reject((0,s.NK)(`Worker closing, aborting job calling '${e.methodName}'`));for(const e of this._clientPromises)e.then((e=>e?.close()));this._clients.length=0,this._clientPromises.length=0,this._inUseClients.length=0,a.unregister(this)}invoke(e,t,n){return this.apply(e,[t],n)}apply(e,t,n){const r=(0,s.Tw)();this._ongoingJobsQueue.push({methodName:e,data:t,invokeOptions:n,resolver:r});for(let e=0;e<this._clientPromises.length;e++){const t=this._clients[e];t?t.jobAdded():this._clientPromises[e].then((e=>e?.jobAdded()))}return r.promise}createInvokeProxy(e){return(0,o.c)(this,e)}on(e,t){return Promise.all(this._clientPromises).then((()=>(0,r.h)(this._clients.map((n=>n.on(e,t))))))}openPorts(){return new Promise((e=>{const t=new Array(this._clientPromises.length);let n=t.length;for(let r=0;r<this._clientPromises.length;++r)this._clientPromises[r].then((s=>{s&&(t[r]=s.openPort()),0==--n&&e(t)}))}))}get test(){}}},11494:(e,t,n)=>{n.d(t,{ho:()=>q});var r=n(6407),s=n(32773),i=n(80959),o=n(6801),a=n(9380),l=n(20266),p=n(57732),u=n(64604),d=n(99063),h=n(90740),c=(n(55270),n(29512)),y=n(18683),f=n(45371),m=n(59192);n(13671),n(41003),n(91047),n(93181),n(44945),n(58498),n(99924),n(32816),n(41390),n(69421),n(40499),n(36544),n(29298),n(50214),n(93804),n(78016),n(54483),n(95779),n(13262),n(346);const g={async request(e,t){const n=e.options,r=n.responseType;n.signal=t?.signal,n.responseType="native"===r||"native-request-init"===r?"native-request-init":r&&["blob","json","text"].includes(r)&&(0,d.sC)(e.url)?.after?r:"array-buffer";const s=await(0,u.A)(e.url,n),i={data:s.data,httpStatus:s.httpStatus,ssl:s.ssl};switch(s.requestOptions?.responseType){case"native-request-init":return delete i.data.signal,i;case"blob":i.data=await i.data.arrayBuffer();break;case"json":i.data=(new TextEncoder).encode(JSON.stringify(i.data)).buffer;break;case"text":i.data=(new TextEncoder).encode(i.data).buffer}return{result:i,transferList:[i.data]}}};let _=null;_=(0,d.s2)((0,y.g)("esri/core/workers/init.js"));const w={};w.baseUrl=(0,d.s2)((0,y.g)("dojo/")),w.packages=[{name:"esri",location:"../esri"}];class b{constructor(){const e=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach((t=>{this[t]=(...n)=>e[t](...n)}))}}class v{constructor(){this._dispatcher=new b,this._workerPostMessage({type:a.M.HANDSHAKE})}terminate(){}get onmessage(){return this._onmessageHandler}set onmessage(e){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler),this._onmessageHandler=e,e&&this.addEventListener("message",e)}get onmessageerror(){return this._onmessageerrorHandler}set onmessageerror(e){this._onmessageerrorHandler&&this.removeEventListener("messageerror",this._onmessageerrorHandler),this._onmessageerrorHandler=e,e&&this.addEventListener("messageerror",e)}get onerror(){return this._onerrorHandler}set onerror(e){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler),this._onerrorHandler=e,e&&this.addEventListener("error",e)}postMessage(e){(0,f.n)((()=>{this._workerMessageHandler(new MessageEvent("message",{data:e}))}))}dispatchEvent(e){return this._dispatcher.dispatchEvent(e)}addEventListener(e,t,n){this._dispatcher.addEventListener(e,t,n)}removeEventListener(e,t,n){this._dispatcher.removeEventListener(e,t,n)}_workerPostMessage(e){(0,f.n)((()=>{this.dispatchEvent(new MessageEvent("message",{data:e}))}))}async _workerMessageHandler(e){const t=(0,a.r)(e);if(t&&t.type===a.M.OPEN){const{modulePath:e,jobId:n}=t;let r=await a.default.loadWorker(e);r||(r=await import(e));const s=a.default.connect(r);this._workerPostMessage({type:a.M.OPENED,jobId:n,data:s})}}}const M=()=>l.L.getLogger("esri.core.workers.workerFactory"),{HANDSHAKE:T}=a.M;let x,I;const E="Failed to create Worker. Fallback to execute module in main thread";async function A(e){return new Promise((t=>{function n(s){const i=(0,a.r)(s);i&&i.type===T&&(e.removeEventListener("message",n),e.removeEventListener("error",r),t(e))}function r(t){t.preventDefault(),e.removeEventListener("message",n),e.removeEventListener("error",r),M().warn("Failed to create Worker. Fallback to execute module in main thread",t),(e=new v).addEventListener("message",n),e.addEventListener("error",r)}e.addEventListener("message",n),e.addEventListener("error",r)}))}let S=0;const{ABORT:k,INVOKE:N,OPEN:R,OPENED:L,RESPONSE:D}=a.M;class j{static async create(e){const t=await async function(){if(!(0,s.h)("esri-workers"))return A(new v);if(!x&&!I)try{const e='let globalId=0;const outgoing=new Map,configuration={CONFIGURATION};self.esriConfig=configuration.esriConfig;const workerPath=self.esriConfig.workers.workerPath,HANDSHAKE=0,OPEN=1,OPENED=2,RESPONSE=3,INVOKE=4,ABORT=5;function createAbortError(){const e=new Error("Aborted");return e.name="AbortError",e}function receiveMessage(e){return e&&e.data?"string"==typeof e.data?JSON.parse(e.data):e.data:null}function invokeStaticMessage(e,o,r){const t=r&&r.signal,n=globalId++;let s=null;return new Promise(((r,i)=>{if(t){if(t.aborted)return i(createAbortError());s=()=>{outgoing.get(n)&&(outgoing.delete(n),self.postMessage({type:5,jobId:n}),i(createAbortError()))},t.addEventListener("abort",s)}outgoing.set(n,{resolve:r,reject:i}),self.postMessage({type:4,jobId:n,methodName:e,abortable:null!=t,data:o})})).finally((()=>{t&&t.removeEventListener("abort",s)}))}let workerRevisionChecked=!1;function checkWorkerRevision(e){if(!workerRevisionChecked&&e.kernelInfo){workerRevisionChecked=!0;const{revision:o,fullVersion:r}=configuration.kernelInfo,{revision:t,fullVersion:n,version:s}=e.kernelInfo;esriConfig.assetsPath!==esriConfig.defaultAssetsPath&&o!==t&&console.warn(`Version mismatch detected between ArcGIS Maps SDK for JavaScript modules and assets. For more information visit https://bit.ly/3QnsuSo.\nModules version: ${r}\nAssets version: ${n??s}\nAssets path: ${esriConfig.assetsPath}`)}}function messageHandler(e){const o=receiveMessage(e);if(!o)return;const r=o.jobId;switch(o.type){case 1:let n;function t(e){const o=n.connect(e);self.postMessage({type:2,jobId:r,data:o},[o])}"function"==typeof define&&define.amd?require([workerPath],(e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then((e=>e||new Promise((e=>{require([o.modulePath],e)})))).then(t)})):"System"in self&&"function"==typeof System.import?System.import(workerPath).then((e=>(n=e.default,checkWorkerRevision(n),n.loadWorker(o.modulePath)))).then((e=>e||System.import(o.modulePath))).then(t):esriConfig.workers.useDynamicImport?import(workerPath).then((e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then((e=>e||import(o.modulePath))).then(t)})):(self.RemoteClient||importScripts(workerPath),n=self.RemoteClient.default||self.RemoteClient,checkWorkerRevision(n),n.loadWorker(o.modulePath).then(t));break;case 3:if(outgoing.has(r)){const s=outgoing.get(r);outgoing.delete(r),o.error?s.reject(JSON.parse(o.error)):s.resolve(o.data)}}}self.dojoConfig=configuration.loaderConfig,esriConfig.workers.loaderUrl&&(self.importScripts(esriConfig.workers.loaderUrl),"function"==typeof require&&"function"==typeof require.config&&require.config(configuration.loaderConfig)),self.addEventListener("message",messageHandler),self.postMessage({type:0});'.split("{CONFIGURATION}").join(function(){let e;if(null!=h.A.default){const t={...h.A};delete t.default,e=JSON.parse(JSON.stringify(t))}else e=JSON.parse(JSON.stringify(h.A));e.assetsPath=(0,d.s2)(e.assetsPath),e.defaultAssetsPath=e.defaultAssetsPath?(0,d.s2)(e.defaultAssetsPath):void 0,e.request.interceptors=[],e.log.interceptors=[],e.locale=(0,m.g)(),e.has={"esri-csp-restrictions":(0,s.h)("esri-csp-restrictions"),"esri-2d-debug":!1,"esri-2d-update-debug":(0,s.h)("esri-2d-update-debug"),"esri-2d-log-updating":(0,s.h)("esri-2d-log-updating"),"featurelayer-pbf":(0,s.h)("featurelayer-pbf"),"featurelayer-fast-triangulation-enabled":(0,s.h)("featurelayer-fast-triangulation-enabled"),"featurelayer-simplify-thresholds":(0,s.h)("featurelayer-simplify-thresholds"),"featurelayer-simplify-payload-size-factors":(0,s.h)("featurelayer-simplify-payload-size-factors"),"featurelayer-simplify-mobile-factor":(0,s.h)("featurelayer-simplify-mobile-factor"),"featurelayer-query-max-depth":(0,s.h)("featurelayer-query-max-depth"),"featurelayer-query-pausing-enabled":(0,s.h)("featurelayer-query-pausing-enabled"),"featurelayer-snapshot-enabled":(0,s.h)("featurelayer-snapshot-enabled"),"esri-atomics":(0,s.h)("esri-atomics"),"esri-shared-array-buffer":(0,s.h)("esri-shared-array-buffer"),"esri-tiles-debug":(0,s.h)("esri-tiles-debug"),"esri-workers-arraybuffer-transfer":(0,s.h)("esri-workers-arraybuffer-transfer"),"feature-polyline-generalization-factor":(0,s.h)("feature-polyline-generalization-factor"),"host-webworker":1},e.workers.loaderUrl?e.workers.loaderUrl=(0,d.s2)(e.workers.loaderUrl):_&&(e.workers.loaderUrl=_),e.workers.workerPath?e.workers.workerPath=(0,d.s2)(e.workers.workerPath):e.workers.workerPath="esri/core/workers/RemoteClient",e.workers.useDynamicImport=!1;const t=h.A.workers.loaderConfig,n=function(e){const t={async:e.async,isDebug:e.isDebug,locale:e.locale,baseUrl:e.baseUrl,has:{...e.has},map:{...e.map},packages:e.packages?.concat()||[],paths:{...w.paths,...e.paths}};return e.hasOwnProperty("async")||(t.async=!0),e.hasOwnProperty("isDebug")||(t.isDebug=!1),e.baseUrl||(t.baseUrl=w.baseUrl),w.packages?.forEach((e=>{!function(e,t){for(const n of e)if(n.name===t.name)return;e.push(t)}(t.packages??[],e)})),t}({baseUrl:t?.baseUrl,locale:(0,m.g)(),has:{"csp-restrictions":1,"dojo-test-sniff":0,"host-webworker":1,...t?.has},map:{...t?.map},paths:{...t?.paths},packages:t?.packages||[]}),r={buildDate:c.$y,fullVersion:c.ol,revision:c.QL};return JSON.stringify({esriConfig:e,loaderConfig:n,kernelInfo:r})}());x=URL.createObjectURL(new Blob([e],{type:"text/javascript"}))}catch(e){I=e||{}}let e;if(x)try{e=new Worker(x,{name:"esri-worker-"+S++})}catch(t){M().warn(E,I),e=new v}else M().warn(E,I),e=new v;return A(e)}();return new j(t,e)}constructor(e,t){this._outJobs=new Map,this._inJobs=new Map,this.worker=e,this.id=t,e.addEventListener("message",this._onMessage.bind(this)),e.addEventListener("error",(e=>{e.preventDefault(),l.L.getLogger("esri.core.workers.WorkerOwner").error(e)}))}terminate(){this.worker.terminate()}async open(e,t={}){const{signal:n}=t,r=(0,a.n)();return new Promise(((t,s)=>{const o={resolve:t,reject:s,abortHandle:(0,i.NY)(n,(()=>{this._outJobs.delete(r),this._post({type:k,jobId:r})}))};this._outJobs.set(r,o),this._post({type:R,jobId:r,modulePath:e})}))}_onMessage(e){const t=(0,a.r)(e);if(t)switch(t.type){case L:this._onOpenedMessage(t);break;case D:this._onResponseMessage(t);break;case k:this._onAbortMessage(t);break;case N:this._onInvokeMessage(t)}}_onAbortMessage(e){const t=this._inJobs,n=e.jobId,r=t.get(n);r&&(r.controller&&r.controller.abort(),t.delete(n))}_onInvokeMessage(e){const{methodName:t,jobId:n,data:r,abortable:s}=e,o=s?new AbortController:null,l=this._inJobs,p=g[t];let u;try{if("function"!=typeof p)throw new TypeError(`${t} is not a function`);u=p.call(null,r,{signal:o?o.signal:null})}catch(e){return void this._post({type:D,jobId:n,error:(0,a.t)(e)})}(0,i.$X)(u)?(l.set(n,{controller:o,promise:u}),u.then((e=>{l.has(n)&&(l.delete(n),this._post({type:D,jobId:n},e))}),(e=>{l.has(n)&&(l.delete(n),e||(e={message:"Error encountered at method"+t}),(0,i.zf)(e)||this._post({type:D,jobId:n,error:(0,a.t)(e||{message:`Error encountered at method ${t}`})}))}))):this._post({type:D,jobId:n},u)}_onOpenedMessage(e){const{jobId:t,data:n}=e,r=this._outJobs.get(t);r&&(this._outJobs.delete(t),(0,p.r)(r.abortHandle),r.resolve(n))}_onResponseMessage(e){const{jobId:t,error:n,data:s}=e,i=this._outJobs.get(t);i&&(this._outJobs.delete(t),(0,p.r)(i.abortHandle),n?i.reject(r.A.fromJSON(JSON.parse(n))):i.resolve(s))}_post(e,t,n){return(0,a.p)(this.worker,e,t,n)}}const O=(0,s.h)("host-browser")?Math.min(navigator.hardwareConcurrency-1,(0,s.h)("workers-pool-size")):0;let C=(0,s.h)("esri-mobile")?Math.min(O,3):O;C||(C=(0,s.h)("safari")&&(0,s.h)("mac")?7:2);let B=0;const P=[];async function Z(e,t){const n=new o.A,{registryTarget:r,...s}=t;return await n.open(e,s),r&&(0,o.r)(r,n),n}async function q(e,t={}){if("string"!=typeof e)throw new r.A("workers:undefined-module","modulePath is missing");let n=t.strategy||"distributed";if((0,s.h)("host-webworker")&&!(0,s.h)("esri-workers")&&(n="local"),"local"===n){let n=await a.default.loadWorker(e);n||(n=await import(e)),(0,i.Te)(t.signal);const r=t.client||n;return Z([a.default.connect(n,t.schedule)],{...t,client:r})}if(await async function(){if($)return $;F=new AbortController;const e=[];for(let t=0;t<C;t++){const n=j.create(t).then((e=>(P[t]=e,e)));e.push(n)}return $=Promise.all(e),$}(),(0,i.Te)(t.signal),"dedicated"===n){const n=B++%C;return Z([await P[n].open(e,t)],t)}if(t.maxNumWorkers&&t.maxNumWorkers>0){const n=Math.min(t.maxNumWorkers,C);if(n<C){const r=new Array(n);for(let s=0;s<n;++s){const n=B++%C;r[s]=P[n].open(e,t)}return Z(r,t)}}return Z(P.map((n=>n.open(e,t))),t)}let F,$=null},3952:(e,t,n)=>{n.d(t,{el:()=>f});var r=n(90740),s=n(6407),i=n(20266),o=n(84200),a=n(67504),l=n(339),p=n(69763),u=n(29208),d=n(79281);n(32773),n(32816),n(29298),n(36544),n(93181),n(13671),n(40499),n(69421),n(91047),n(56273),n(44600),n(2160),n(99924),n(41390),n(58498),n(45371),n(80959),n(49877),n(7969),n(93804),n(18683),n(64604),n(29512),n(99063),n(64752),n(48844),n(97827),n(91695),n(18169),n(48402),n(16699),n(26809),n(2589),n(18527),n(77037),n(36533),n(94345),n(92517),n(69033),n(13978);const h=()=>i.L.getLogger("esri.geometry.support.normalizeUtils");function c(e,t,n){if(t){const t=function(e,t){if(!(e instanceof a.A||e instanceof o.A)){const e="straightLineDensify: the input geometry is neither polyline nor polygon";throw h().error(e),new s.A(e)}const n=(0,l.g)(e),r=[];for(const e of n){const n=[];r.push(n),n.push([e[0][0],e[0][1]]);for(let r=0;r<e.length-1;r++){const s=e[r][0],i=e[r][1],o=e[r+1][0],a=e[r+1][1],l=Math.sqrt((o-s)*(o-s)+(a-i)*(a-i)),p=(a-i)/l,u=(o-s)/l,d=l/t;if(d>1){for(let e=1;e<=d-1;e++){const r=e*t,o=u*r+s,a=p*r+i;n.push([o,a])}const e=(l+Math.floor(d-1)*t)/2,r=u*e+s,o=p*e+i;n.push([r,o])}n.push([o,a])}}return function(e){return"polygon"===e.type}(e)?new o.A({rings:r,spatialReference:e.spatialReference}):new a.A({paths:r,spatialReference:e.spatialReference})}(e,1e6);e=(0,u.ci)(t,!0)}return n&&(e=(0,l.u)(e,n)),e}function y(e,t,n){if(Array.isArray(e)){const r=e[0];if(r>t){const n=(0,l.o)(r,t);e[0]=r+n*(-2*t)}else if(r<n){const t=(0,l.o)(r,n);e[0]=r+t*(-2*n)}}else{const r=e.x;if(r>t){const n=(0,l.o)(r,t);e=e.clone().offset(n*(-2*t),0)}else if(r<n){const t=(0,l.o)(r,n);e=e.clone().offset(t*(-2*n),0)}}return e}async function f(e,t,n){if(!Array.isArray(e))return f([e],t);t&&"string"!=typeof t&&h().warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");const s="string"==typeof t?t:t?.url??r.A.geometryServiceUrl;let i,m,g,_,w,b,v,M,T=0;const x=[],I=[];for(const t of e)if(null!=t)if(i||(i=t.spatialReference,m=(0,p.j)(i),g=i.isWebMercator,b=g?102100:4326,_=l.c[b].maxX,w=l.c[b].minX,v=l.c[b].plus180Line,M=l.c[b].minus180Line),m)if("mesh"===t.type)I.push(t);else if("point"===t.type)I.push(y(t.clone(),_,w));else if("multipoint"===t.type){const e=t.clone();e.points=e.points.map((e=>y(e,_,w))),I.push(e)}else if("extent"===t.type){const e=t.clone()._normalize(!1,!1,m);I.push(e.rings?new o.A(e):e)}else if(t.extent){const e=t.extent,n=(0,l.o)(e.xmin,w)*(2*_);let r=0===n?t.clone():(0,l.u)(t.clone(),n);e.offset(n,0);let{xmin:s,xmax:i}=e;s=Number(s.toFixed(9)),i=Number(i.toFixed(9)),e.intersects(v)&&i!==_?(T=i>T?i:T,r=c(r,g),x.push(r),I.push("cut")):e.intersects(M)&&s!==w?(T=i*(2*_)>T?i*(2*_):T,r=c(r,g,360),x.push(r),I.push("cut")):I.push(r)}else I.push(t.clone());else I.push(t);else I.push(t);let E=(0,l.o)(T,_),A=-90;const S=E,k=new a.A;for(;E>0;){const e=360*E-180;k.addPath([[e,A],[e,-1*A]]),A*=-1,E--}if(x.length>0&&S>0){const t=function(e,t){let n=-1;for(let r=0;r<t.cutIndexes.length;r++){const s=t.cutIndexes[r],i=t.geometries[r],o=(0,l.g)(i);for(let e=0;e<o.length;e++){const t=o[e];t.some((n=>{if(n[0]<180)return!0;{let n=0;for(let e=0;e<t.length;e++){const r=t[e][0];n=r>n?r:n}n=Number(n.toFixed(9));const r=-360*(0,l.o)(n,180);for(let n=0;n<t.length;n++){const t=i.getPoint(e,n);i.setPoint(e,n,t.clone().offset(r,0))}return!0}}))}if(s===n){if("polygon"===e[0].type)for(const t of(0,l.g)(i))e[s]=e[s].addRing(t);else if("polyline"===e[0].type)for(const t of(0,l.g)(i))e[s]=e[s].addPath(t)}else n=s,e[s]=i}return e}(x,await(0,d.c)(s,x,k,n)),r=[],i=[];for(let n=0;n<I.length;n++){const s=I[n];if("cut"!==s)i.push(s);else{const s=t.shift(),o=e[n];null!=o&&"polygon"===o.type&&o.rings&&o.rings.length>1&&s.rings.length>=o.rings.length?(r.push(s),i.push("simplify")):i.push(g?(0,u.Gh)(s):s)}}if(!r.length)return i;const o=await(0,d.s)(s,r,n),a=[];for(let e=0;e<i.length;e++){const t=i[e];"simplify"!==t?a.push(t):a.push(g?(0,u.Gh)(o.shift()):o.shift())}return a}const N=[];for(let e=0;e<I.length;e++){const t=I[e];if("cut"!==t)N.push(t);else{const e=x.shift();N.push(!0===g?(0,u.Gh)(e):e)}}return N}},16702:(e,t,n)=>{n.d(t,{A:()=>Te,K:()=>ye,a:()=>ue,b:()=>de,c:()=>he,d:()=>ce,f:()=>ae,g:()=>oe,m:()=>pe,s:()=>le});var r,s,i,o,a,l,p,u,d=n(32816),h=(n(94345),n(72393)),c=(n(91381),n(49011),n(43682),n(54481),n(89253),n(60027),n(16677),n(17813),n(32397)),y=n(32773),f=n(2810),m=(n(11494),n(29298)),g=n(20266),_=n(69421),w=n(56273),b=n(41390),v=n(78281),M=n(7969),T=n(69763),x=n(73597),I=n(13141),E=n(2232),A=n(53104),S=n(6407),k=n(36544),N=n(23381),R=n(84200),L=n(83637),D=n(58003),j=n(77037),O=n(64604),C=(n(47239),n(16699),n(44600)),B=(n(2160),n(36533),n(64752),n(67504)),P=n(43551),Z=n(49197),q=n(73600),F=n(38093),$=n(31315),G=n(25643),J=n(29755),Y=n(6837),Q=n(46935),V=n(96807),U=n(69448),X=n(98238),H=n(44864),z=n(30011),W=n(10224),K=n(60408),ee=n(8824),te=n(20978),ne=n(9380),re=n(92517);n(90740),n(93181),n(13671),n(40499),n(91047),n(93804),n(18683),n(99063),n(99924),n(58498),n(45371),n(80959),n(29512),n(29208),n(49877),n(48844),n(97827),n(91695),n(18169),n(48402),n(26809),n(2589),n(18527),n(52731),n(17745),n(81272),n(44945),n(51961),n(62399),n(64995),n(33150),n(58173),n(66110),n(67520),n(27532),n(88663),n(48103),n(50214),n(59192),n(78016),n(54483),n(65085),n(33611),n(84857),n(60373),n(98187),n(35902),n(13226),n(16794),n(52357),n(11090),n(49319),n(93546),n(29570),n(34592),n(79825),n(95101),n(67578),n(14896),n(95611),n(98089),n(91366),n(80473),n(43435),n(73435),n(55270),n(95779),n(13262),n(346),n(4048),n(85232),n(93471),n(53252),n(34039),n(70061),n(3495),n(97906),n(64524),n(65023),n(31424),n(74676),n(53610),n(29447),n(78273),n(49475),n(32368),n(7391),n(22529),n(43534),n(38094),n(67723),n(59858),n(63728),n(1178),n(7182),n(47788),n(19297),n(82408),n(73509),n(28276),n(69277),n(70580),n(75191),n(24319),n(62092),n(4157),n(62401),n(89322),n(20138),n(53370),n(46946),n(3816),n(71992),n(80167),n(4478),n(91808),n(7161),n(55586),n(35121),n(92229),n(18344),n(64884),n(23351),n(51222),n(42870),n(67321),n(73067),n(54512),n(53103),n(19648),n(42948),n(56487),n(6399),n(9498),n(23105),n(24079),n(38149),n(19681),n(40328),n(84539),n(65299),n(6510),n(38641),n(27281),n(73502),n(19869),n(3827),n(65174),n(78328),n(72604),n(54616),n(25018),n(57111),n(75651),n(88614),n(1030),n(15319),n(60785),n(23787),n(22151),n(38632),n(79875),n(133),n(83002),n(24330),n(91276),n(62482),n(45476),n(69310),n(85351),n(1535),n(9943),n(3112),n(46626),n(45560),n(56303),n(85890),n(55884),n(6801),n(41003),n(47387),n(46728),n(64102),n(66136),n(4734),n(42614),n(11721),n(32159),n(67138),n(59700),n(3952),n(339),n(79281),n(69033),n(13978),n(2824),n(56764),n(11618),n(38896),n(26589),n(17872),n(70648),n(49010),n(47215),n(71044),n(172),n(65283),n(43059),n(89935),n(49813),n(81623),n(13478),n(12856),n(47812),n(47368),n(88817),n(75169),n(75377),n(33348),n(91308),n(53206),n(77e3),n(19049),n(64724),n(63402),n(17618),n(43053),n(19548),n(92975),n(7603),n(14658),n(10043),n(89754),n(76999),n(6105),n(72076),n(5370),n(76641),n(56833),n(81284),n(78860),n(26805),n(13983),n(95637),n(59930),n(45862),n(72762),n(71613),n(12119),n(13201),n(56367),n(8904),n(97511),n(32264),n(68849),n(82842),n(58196),n(86941),n(1739),n(81618),n(49755),n(54131),n(36309),n(62959),n(74159),n(90197),n(76636),n(96625),n(79205),n(35619);class se{constructor(){this._featureLookup=new Map}static getInstance(){return se.instance||(se.instance=new se),se.instance}static resetInstance(){se.instance&&(se.instance=null)}deleteFromStore(e){e.forEach((e=>{this._featureLookup.delete(e)}))}readFromStoreByList(e){const t=[];return e.forEach((e=>{const n=this.readFromStoreById(e);n&&t.push(n)})),t}readFromStoreById(e){return this._featureLookup.get(e)??null}writeToStore(e,t,n){const r=[];return e.forEach((e=>{if(!e?.id)return;e.properties||(e.properties=[]);let s,i=null;if(n&&e.properties[n]&&(i=(0,L.b)(e.properties[n])),"originId"in e&&"destinationId"in e&&(e.properties.ESRI__ORIGIN_ID=e.originId,e.properties.ESRI__DESTINATION_ID=e.destinationId),e.properties[t]=e.id,e.id&&this._featureLookup.has(e.id)&&this._featureLookup.get(e.id).attributes){const r=this._featureLookup.get(e.id),o=JSON.parse(JSON.stringify(Object.assign(r.attributes,e.properties)));n&&e.properties[n]&&(o[n]=(0,j.rS)(e.properties[n])),s=new D.O(i?JSON.parse(JSON.stringify(i)):r?.geometry?JSON.parse(JSON.stringify(r.geometry)):null,o,null,e.properties[t])}else s=new D.O(i?JSON.parse(JSON.stringify(i)):null,e.properties,null,e.properties[t]);this._featureLookup.set(e.id,s),r.push(s)})),r}}function ie(e){if(!e.spatialReference.isWGS84)throw new S.A("knowledge-graph:layer-support-utils","The extentToInBoundsRings function only supports WGS84 spatial references.");return e.clone().normalize().map((e=>[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]))}async function oe(e,t){const n=[],r=new Map,s=[];if(t.dataModel?.relationshipTypes)for(const e of t.dataModel.relationshipTypes)e.name&&r.set(e.name,[]);for(const t of e)r.has(t.typeName)&&r.get(t.typeName)?.push(t.id);for(const[e,i]of r){if(i.length<1)continue;const r=new Z.A({openCypherQuery:`MATCH (n)-[r:${e}]->(m) WHERE id(r) in $ids RETURN id(n), labels(n)[0], id(m), labels(m)[0]`,bindParameters:{ids:i}});s.push((0,P.executeQueryStreaming)(t,r).then((async e=>{const t=e.resultRowsStream.getReader();for(;;){const{done:e,value:r}=await t.read();if(e)break;for(const e of r)n.push({id:e[0],typeName:e[1]}),n.push({id:e[2],typeName:e[3]})}})))}return await Promise.all(s),n}async function ae(e,t){t??=!1;const n={generateAllSublayers:t,namedTypeDefinitions:new Map};return await async function(e){const t=await(0,O.A)(e,{responseType:"array-buffer"}),n=await t.data;return async function(e){const t=new((await(0,P.g)()).MapOfObjectIdentifierSetsDecoder),n=t.decode(new Uint8Array(e)),r=new Map;if(0!==n.error_code)throw new S.A("knowledge-graph:layer-support-utils",n.error_message);const s=t.get_map_of_identifier_sets(),i=s.keys,o=i.size();for(let e=0;e<o;e++){const t=i.get(e),n=s.query_identifier_set(t),o=[];if(n.id_array_type.value===p.GLOBALID_ARRAY){const e=n.get_globalid_array(),t=e.count();for(let n=0;n<t;n++)o.push(e.get_globalid_at(n))}else{if(n.id_array_type.value!==p.IDENTIFIER_ARRAY)throw new S.A("knowledge-graph:layer-support-utils","Tried to encode an unexpected ID Array type.");{const e=n.get_identifier_array(),t=e.count();for(let n=0;n<t;n++)o.push(e.get_identifier_at(n).toString())}}r.set(t,o)}return t.delete(),r}(new Uint8Array(n))}(e).then((e=>{!function(e,t){for(const[n,r]of e){const e=(0,k.g)(t.namedTypeDefinitions,n,(()=>({useAllData:!1,members:new Map})));for(const t of r)e.members.has(t)||e.members.set(t,{id:t})}}(e,n)})),n}async function le(e){const t=await(0,P.g)(),n=new t.MapOfObjectIdentifierSets;!function(e,t,n){for(const[r,s]of n.namedTypeDefinitions){if(!s.members||s.useAllData)continue;const n=s.members.keys(),i=new t.GlobalIdArray,o=new t.ObjectIdentifierSet;for(const e of n)i.add_globalid(e);o.set_globalid_array(i),i.delete(),e.put_identifier_set(r,o),o.delete()}}(n,t,e);const r=new t.MapOfObjectIdentifierSetsEncoder;try{r.set_map_of_identifier_sets(n),r.encode();const e=r.get_encoding_result();if(0!==e.error.error_code)throw new S.A("knowledge-graph:layer-support-utils",e.error.error_message);const t=structuredClone(e.get_byte_buffer());return r.delete(),t}finally{n.delete()}}(u=r||(r={})).ELEMENTUID="ELEMENTUID",u.TYPENAME="TYPENAME",r.ELEMENTUID,r.TYPENAME,function(e){e[e.ELEMENTUID=0]="ELEMENTUID",e[e.TYPENAME=1]="TYPENAME"}(s||(s={})),function(e){e[e.ELEMENTUID=0]="ELEMENTUID",e[e.TYPENAME=1]="TYPENAME",e[e.FROMUID=2]="FROMUID",e[e.TOUID=3]="TOUID"}(i||(i={})),function(e){e[e.featureResult=0]="featureResult",e[e.countResult=1]="countResult",e[e.idsResult=2]="idsResult"}(o||(o={})),function(e){e[e.upperLeft=0]="upperLeft",e[e.lowerLeft=1]="lowerLeft"}(a||(a={})),function(e){e[e.sqlTypeBigInt=0]="sqlTypeBigInt",e[e.sqlTypeBinary=1]="sqlTypeBinary",e[e.sqlTypeBit=2]="sqlTypeBit",e[e.sqlTypeChar=3]="sqlTypeChar",e[e.sqlTypeDate=4]="sqlTypeDate",e[e.sqlTypeDecimal=5]="sqlTypeDecimal",e[e.sqlTypeDouble=6]="sqlTypeDouble",e[e.sqlTypeFloat=7]="sqlTypeFloat",e[e.sqlTypeGeometry=8]="sqlTypeGeometry",e[e.sqlTypeGUID=9]="sqlTypeGUID",e[e.sqlTypeInteger=10]="sqlTypeInteger",e[e.sqlTypeLongNVarchar=11]="sqlTypeLongNVarchar",e[e.sqlTypeLongVarbinary=12]="sqlTypeLongVarbinary",e[e.sqlTypeLongVarchar=13]="sqlTypeLongVarchar",e[e.sqlTypeNChar=14]="sqlTypeNChar",e[e.sqlTypeNVarChar=15]="sqlTypeNVarChar",e[e.sqlTypeOther=16]="sqlTypeOther",e[e.sqlTypeReal=17]="sqlTypeReal",e[e.sqlTypeSmallInt=18]="sqlTypeSmallInt",e[e.sqlTypeSqlXml=19]="sqlTypeSqlXml",e[e.sqlTypeTime=20]="sqlTypeTime",e[e.sqlTypeTimestamp=21]="sqlTypeTimestamp",e[e.sqlTypeTimestamp2=22]="sqlTypeTimestamp2",e[e.sqlTypeTinyInt=23]="sqlTypeTinyInt",e[e.sqlTypeVarbinary=24]="sqlTypeVarbinary",e[e.sqlTypeVarchar=25]="sqlTypeVarchar"}(l||(l={})),function(e){e[e.OID_ARRAY=0]="OID_ARRAY",e[e.GLOBALID_ARRAY=1]="GLOBALID_ARRAY",e[e.STRING_ARRAY=2]="STRING_ARRAY",e[e.IDENTIFIER_ARRAY=3]="IDENTIFIER_ARRAY"}(p||(p={}));const pe="ESRI__ID",ue="ESRI__ORIGIN_ID",de="ESRI__DESTINATION_ID",he="ESRI__LAYOUT_GEOMETRY",ce="ESRI__AGGREGATION_COUNT";let ye=class extends b.T{constructor(e){super(e),this._processingCacheUpdatesLookup=new Map,this.knowledgeGraph=null,this.inclusionModeDefinition={generateAllSublayers:!0,namedTypeDefinitions:new Map},this.entityTypeNames=new Set,this.relationshipTypeNames=new Set,this.geographicLookup=new Map,this.sublayerCaches=new Map,this.nodeConnectionsLookup=new Map,this.relationshipConnectionsLookup=new Map,this.memberIdTypeLookup=new Map;const t=new Map;e.knowledgeGraph.dataModel.entityTypes?.forEach((n=>{n.name&&(t.set(n.name,"entity"),this._processingCacheUpdatesLookup.set(n.name,[]),e.inclusionModeDefinition&&!e.inclusionModeDefinition?.generateAllSublayers||this.entityTypeNames.add(n.name),n.properties?.forEach((e=>{e.geometryType&&"esriGeometryNull"!==e.geometryType&&this.geographicLookup.set(n.name,{name:e.name??"",geometryType:e.geometryType})})))})),e.knowledgeGraph.dataModel.relationshipTypes?.forEach((n=>{n.name&&(t.set(n.name,"relationship"),this._processingCacheUpdatesLookup.set(n.name,[]),e.inclusionModeDefinition&&!e.inclusionModeDefinition?.generateAllSublayers||this.relationshipTypeNames.add(n.name),n.properties?.forEach((e=>{e.geometryType&&"esriGeometryNull"!==e.geometryType&&this.geographicLookup.set(n.name,{name:e.name??"",geometryType:e.geometryType})})))})),e.inclusionModeDefinition?.namedTypeDefinitions.forEach(((n,r)=>{if("entity"===t.get(r))this.entityTypeNames.add(r);else{if("relationship"!==t.get(r))return g.L.getLogger(this).warn(`A named type, ${r}, was in the inclusion list that wasn't in the data model and will be removed`),void e.inclusionModeDefinition?.namedTypeDefinitions.delete(r);this.relationshipTypeNames.add(r)}const s=new Map;n.members?.forEach((e=>{(0,k.g)(this.memberIdTypeLookup,e.id,(()=>new Set)).add(r);const t=this.getById(e.id);t&&s.set(e.id,t)})),this.sublayerCaches.set(r,s)}))}addToLayer(e){e.forEach((({typeName:e,id:t})=>{if(!this.inclusionModeDefinition)throw new S.A("knowledge-graph:layer-data-manager","You cannot add to a layer's exclusion list if it was not created with an exclusion list originally");if(this.inclusionModeDefinition.namedTypeDefinitions.has(e)){if(this.inclusionModeDefinition.namedTypeDefinitions.has(e)){const n=this.inclusionModeDefinition.namedTypeDefinitions.get(e);n.members||(n.members=new Map),n.members.set(t,{id:t}),(0,k.g)(this.memberIdTypeLookup,t,(()=>new Set)).add(e)}}else{const n=new Map;n.set(t,{id:t}),this.inclusionModeDefinition.namedTypeDefinitions.set(e,{useAllData:!1,members:n}),(0,k.g)(this.memberIdTypeLookup,t,(()=>new Set)).add(e)}}))}getById(e){return se.getInstance().readFromStoreById(e)}async getData(e,t,n){if(t.objectType.name&&this.inclusionModeDefinition?.namedTypeDefinitions&&this.inclusionModeDefinition.namedTypeDefinitions.size>0&&!this.inclusionModeDefinition.namedTypeDefinitions.has(t.objectType.name))return[];let r;if(r=e||new q.A({where:"1=1",outFields:["*"]}),"link-chart"===t.parentCompositeLayer.type){const e=t.parentCompositeLayer,n=this._processingCacheUpdatesLookup.get(t.objectType.name??""),s=r.outFields;s&&1===s.length&&s[0]===pe&&"1=1"===r.where||await Promise.all(n??[]);const i=this.sublayerCaches.has(t.objectType.name??"")?Array.from(this.sublayerCaches.get(t.objectType.name)?.values()):[],o=[];return i.forEach((n=>{this.relationshipTypeNames.has(t.objectType.name)?n.geometry=e.relationshipLinkChartDiagramLookup.get(n.attributes[t.objectIdField]):n.geometry=e.entityLinkChartDiagramLookup.get(n.attributes[t.objectIdField]),n.attributes[he]=n.geometry,o.push(n)})),o}return this.retrieveDataFromService(r,t,n)}async getConnectedRecordIds(e,t){const n=[];let r="";const s=[],i=new Map;if(e.forEach((e=>{if(this.memberIdTypeLookup.has(e))for(const t of this.memberIdTypeLookup.get(e)){if(!this.entityTypeNames.has(t))return;i.has(t)?i.get(t)?.push(e):i.set(t,[e])}})),t&&0!==t?.length){for(const e of t)r=r+e+"|";r=r.slice(0,-1)}return i.forEach(((e,i)=>{let o;o=t&&0!==t?.length?`MATCH (n:${i})-[r:${r}]-(m) WHERE id(n) IN $ids RETURN id(r), type(r), id(m), labels(m)[0]`:`MATCH (n:${i})-[r]-(m) WHERE id(n) IN $ids RETURN id(r), type(r), id(m), labels(m)[0]`;const a=new Promise((t=>{(async()=>{const t=(await(0,P.executeQueryStreaming)(this.knowledgeGraph,new Z.A({openCypherQuery:o,bindParameters:{ids:e}}))).resultRowsStream.getReader();try{for(;;){const{done:e,value:r}=await t.read();if(e)break;for(let e=0;e<r.length;e++){const t=r[e];n.push({id:t[0],typeName:t[1]}),n.push({id:t[2],typeName:t[3]})}}}catch(e){if("AbortError"!==e.name)throw e;g.L.getLogger(this).info("Request aborted as expected")}})().then((()=>{t()}))}));s.push(a)})),this.refreshCacheContent(),await Promise.all(s),n}async getAttachedRelationships(e,t){const n=[],r=(await(0,P.executeQueryStreaming)(this.knowledgeGraph,new Z.A({openCypherQuery:"MATCH (n)-[r]->(m) WHERE id(n) IN $nodeIds AND id(m) in $nodeIds AND NOT id(r) IN $relationshipExclusionIds return id(r), type(r)",bindParameters:{nodeIds:e,relationshipExclusionIds:t}}))).resultRowsStream.getReader();try{for(;;){const{done:e,value:t}=await r.read();if(e)break;for(let e=0;e<t.length;e++){const r=t[e];n.push({id:r[0],typeName:r[1]})}}}catch(e){if("AbortError"!==e.name)throw e;g.L.getLogger(this).info("Request aborted as expected")}return n}async refreshCacheContent(e,t,n,r=!0){const s=se.getInstance(),i=[],o=new Map,a=new Map;this.knowledgeGraph.dataModel.entityTypes?.forEach((e=>{e.name&&a.set(e.name,e)})),this.knowledgeGraph.dataModel.relationshipTypes?.forEach((e=>{e.name&&a.set(e.name,e)})),e||this.inclusionModeDefinition?e?e.forEach((e=>{if(this.memberIdTypeLookup.has(e))for(const t of this.memberIdTypeLookup.get(e))o.has(t)?o.get(t)?.push(e):o.set(t,[e])})):this.inclusionModeDefinition?.namedTypeDefinitions?.forEach(((e,t)=>{e.useAllData?o.set(t,null):e.members&&e.members.forEach((e=>{o.has(t)&&null!==o.get(t)?o.get(t)?.push(e.id):o.set(t,[e.id])}))})):(this.knowledgeGraph.dataModel.entityTypes?.forEach((e=>{e.name&&o.set(e.name,null)})),this.knowledgeGraph.dataModel.entityTypes?.forEach((e=>{e.name&&o.set(e.name,null)})));for(const[e,l]of o){const o=new Promise((i=>{(async()=>{const i=new Set,o=[];let p,u="",d=!1;if(t||a.get(e)?.properties?.forEach((e=>{e.name&&i.add(e.name)})),n&&this.geographicLookup.has(e)){const t=this.geographicLookup.get(e)?.name;t&&i.add(t)}if(this.entityTypeNames.has(e))u=`MATCH (n:${e}) ${l?"WHERE id(n) IN $ids ":""}return ID(n)`,i.forEach((e=>{u+=`, n.${e}`,o.push(e)}));else{if(!this.relationshipTypeNames.has(e))throw new S.A("knowledge-graph:layer-data-manager",`The graph type of ${e} could not be determined. Was this type set in the KG data model and inclusion definition?`);d=!0,u=`MATCH ()-[n:${e}]->() ${l?"WHERE id(n) IN $ids ":""}return ID(n), id(startNode(n)), id(endNode(n))`,i.forEach((e=>{u+=`, n.${e}`,o.push(e)}))}p=new Z.A(l?{openCypherQuery:u,bindParameters:{ids:l}}:{openCypherQuery:u});const h=(await(0,P.executeQueryStreaming)(this.knowledgeGraph,p)).resultRowsStream.getReader();for(;;){const{done:t,value:n}=await h.read();if(t)break;const i=[];for(let e=0;e<n.length;e++){const t=n[e];let r=0,s=0;const a={properties:{}};for(a.id=t[r],r++,s++,d&&(a.originId=t[r],r++,s++,a.destinationId=t[r],r++,s++,(0,k.g)(this.nodeConnectionsLookup,a.originId,(()=>new Set)).add(a.id),(0,k.g)(this.nodeConnectionsLookup,a.destinationId,(()=>new Set)).add(a.id),(0,k.g)(this.relationshipConnectionsLookup,a.id,(()=>[a.originId,a.destinationId])));r<t.length;r++)a.properties[o[r-s]]=t[r];i.push(a)}const a=s.writeToStore(i,pe,this.geographicLookup.get(e)?.name);this.sublayerCaches.has(e)||this.sublayerCaches.set(e,new Map),r&&!this.inclusionModeDefinition?.namedTypeDefinitions.has(e)&&this.inclusionModeDefinition?.namedTypeDefinitions.set(e,{useAllData:!1,members:new Map}),r&&!this.inclusionModeDefinition?.namedTypeDefinitions.get(e).members&&(this.inclusionModeDefinition.namedTypeDefinitions.get(e).members=new Map);const l=this.sublayerCaches.get(e);a.forEach((t=>{l?.set(t.attributes[pe],t),r&&!this.inclusionModeDefinition?.namedTypeDefinitions.get(e).members.has(t.attributes[pe])&&(this.inclusionModeDefinition?.namedTypeDefinitions.get(e).members.set(t.attributes[pe],{id:t.attributes[pe]}),(0,k.g)(this.memberIdTypeLookup,t.attributes[pe],(()=>new Set)).add(e))}))}})().then((()=>{i(null)}))}));i.push(o),this._processingCacheUpdatesLookup.get(e)?.push(o)}await Promise.all(i)}removeFromLayer(e){const t=new Set,n=new Set(e.map((e=>e.id)));for(const n of e)t.add(n.typeName),1===this.memberIdTypeLookup.get(n.id)?.size?this.memberIdTypeLookup.delete(n.id):this.memberIdTypeLookup.get(n.id)?.delete(n.typeName),this.inclusionModeDefinition?.namedTypeDefinitions.forEach(((e,t)=>{t===n.typeName&&e.members?.has(n.id)&&e.members.delete(n.id)}));t.forEach((e=>{this.sublayerCaches.get(e)?.forEach(((t,r)=>{n.has(r)&&this.sublayerCaches.get(e)?.delete(r)}))}))}async retrieveDataFromService(e,t,n){const r=se.getInstance(),s=new Set,i=[];let o,a="",l=[];const p="relationship"===t.graphType,u=this.inclusionModeDefinition?.namedTypeDefinitions?.get(t.objectType.name)?.useAllData,d=t.parentCompositeLayer.sublayerIdsCache.get(t.objectType.name);let h=!u&&d?Array.from(d).sort():null;if(this.inclusionModeDefinition?.namedTypeDefinitions?.get(t.objectType.name)?.useAllData)this.inclusionModeDefinition?.namedTypeDefinitions?.get(t.objectType.name)?.useAllData&&null!=e.objectIds&&(h=e.objectIds);else if(null!=e.objectIds&&h&&h.length>0){const t=e.objectIds;e.objectIds=h.filter((e=>t.includes(e)))}else if(null!=e.objectIds)h=e.objectIds;else{if(this.inclusionModeDefinition?.namedTypeDefinitions.has(t.objectType.name)&&(!this.inclusionModeDefinition.namedTypeDefinitions.get(t.objectType.name)?.members||this.inclusionModeDefinition.namedTypeDefinitions.get(t.objectType.name)?.members?.size<1))return e.objectIds=[],[];e.objectIds=h}if(null!=e.outFields){const n=e.outFields;n.includes("*")?t.fields.forEach((e=>{s.add(e.name)})):n.forEach((e=>{e!==pe&&e!==t.geometryFieldName&&s.add(e)}))}if(null!=e.geometry){const n=e.geometry;let r;const l=t.parentCompositeLayer.dataManager.knowledgeGraph.serviceDefinition,u=l?.spatialReference,d=l?.serviceCapabilities?.geometryCapabilities;let h=d?.geometryMaxBoundingRectangleSizeX,c=d?.geometryMaxBoundingRectangleSizeY;if(n?.extent?.spatialReference&&!n.spatialReference?.isWGS84?(await(0,v.initializeProjection)(n.extent.spatialReference,T.w),r=(0,v.project)(n.extent,T.w)):r=n.extent,h&&c&&u){if(4326!==u.wkid){const e=new C.A({spatialReference:u,xmax:h,ymax:c}),t=(0,v.project)(e,T.w);h=t.xmax,c=t.ymax}if(r.xmax-r.xmin>h)throw new S.A("knowledge-graph:layer-data-manager",`Extent x bounds should be within ${h}° latitude, limit exceeded`);if(r.ymax-r.ymin>c)throw new S.A("knowledge-graph:layer-data-manager",`Extent y bounds should be within ${c}° longitude, limit exceeded`)}if(null!=e.where&&"1=1"!==e.where){const n=await(0,N.G)(e.where.toUpperCase(),t.fieldsIndex);t.fields.forEach((e=>{n.fieldNames.includes(e.name)&&s.add(e.name)}))}a=p?`Match ()-[n:${t.objectType.name}]->() WHERE esri.graph.ST_Intersects($param_filter_geom, n.${t.geometryFieldName}) return ID(n), id(startNode(r)), id(endNode(r))`:`Match (n:${t.objectType.name}) WHERE esri.graph.ST_Intersects($param_filter_geom, n.${t.geometryFieldName}) return ID(n)`,t.geometryFieldName&&s.add(t.geometryFieldName),s.forEach((e=>{a+=`, n.${e}`,i.push(e)})),o=new Z.A({openCypherQuery:a,bindParameters:{param_filter_geom:new R.A({rings:ie(r)})}})}else{let n="";if(null!=e.where&&"1=1"!==e.where){const r=await(0,N.G)(e.where,t.fieldsIndex);t.fields.forEach((e=>{r.fieldNames.includes(e.name)&&s.add(e.name)}));const i=new Set(["column-reference","string","number","binary-expression"]),o=new Set(["=","<","<=","<>",">",">=","AND","OR","LIKE"]);let a=!1;const l=e=>{if("column-reference"===e.type)return`n.${e.column}`;if("string"===e.type)return`'${e.value}'`;if("number"===e.type)return`${e.value}`;if("binary-expression"===e.type&&i.has(e.left.type)&&i.has(e.right.type)&&o.has(e.operator))return`${l(e.left)} ${e.operator} ${l(e.right)}`;if("binary-expression"===e.type&&"LIKE"===e.operator){let t="";if("function"===e.left.type&&"column-reference"===e.left.args.value[0].type)t+=`lower(n.${e.left.args.value[0].column})`;else{if("column-reference"!==e.left.type)return a=!0,"";t+=`lower(n.${e.left.column})`}if(t+=" CONTAINS (","string"!==e.right.type)return a=!0,"";{let n=e.right.value;"%"===n.charAt(0)&&(n=n.slice(1)),"%"===n.charAt(n.length-1)&&(n=n.slice(0,-1)),t+=`'${n.toLowerCase()}')`}return t}return a=!0,""};n=l(r.parseTree),a&&(n="")}let r="";r=p?`Match ()-[n:${t.objectType.name}]->()`:`Match (n:${t.objectType.name})`;let a=!1;h&&(a=!0,r+=" WHERE ID(n) IN $ids"),n&&(r+=a?" AND":" WHERE",r+=` ${n}`),r+=" return ID(n)",p&&(r+=", id(startNode(n)), id(endNode(n))"),e.returnGeometry&&t.geometryFieldName&&s.add(t.geometryFieldName),s.forEach((e=>{r+=`, n.${e}`,i.push(e)})),o=new Z.A(h?{openCypherQuery:r,bindParameters:{ids:h}}:{openCypherQuery:r})}const c=(await(0,P.executeQueryStreaming)(t.parentCompositeLayer.dataManager.knowledgeGraph,o,n)).resultRowsStream.getReader();for(;;){const{done:e,value:n}=await c.read();if(e)break;const s=[];for(let e=0;e<n.length;e++){const t=n[e];let r=0,o=0;const a={properties:{}};for(a.id=t[r],r++,o++,p&&(a.originId=t[r],r++,o++,a.destinationId=t[r],r++,o++);r<t.length;r++)a.properties[i[r-o]]=t[r];s.push(a)}l=l.concat(r.writeToStore(s,pe,t.parentCompositeLayer.dataManager.geographicLookup.get(t.objectType.name)?.name))}return l}};(0,d._)([(0,m.MZ)()],ye.prototype,"knowledgeGraph",void 0),(0,d._)([(0,m.MZ)()],ye.prototype,"inclusionModeDefinition",void 0),(0,d._)([(0,m.MZ)()],ye.prototype,"entityTypeNames",void 0),(0,d._)([(0,m.MZ)()],ye.prototype,"relationshipTypeNames",void 0),(0,d._)([(0,m.MZ)()],ye.prototype,"geographicLookup",void 0),(0,d._)([(0,m.MZ)()],ye.prototype,"sublayerCaches",void 0),(0,d._)([(0,m.MZ)()],ye.prototype,"nodeConnectionsLookup",void 0),(0,d._)([(0,m.MZ)()],ye.prototype,"relationshipConnectionsLookup",void 0),(0,d._)([(0,m.MZ)()],ye.prototype,"memberIdTypeLookup",void 0),ye=(0,d._)([(0,_.$)("esri.layers.knowledgeGraph.KnowledgeGraphLayerDataManager")],ye);const fe=(0,F.d)(),me=e=>{let t=class extends e{constructor(){super(...arguments),this.fields=[],this.fieldsIndex=null}};return(0,d._)([(0,m.MZ)(fe.fields)],t.prototype,"fields",void 0),(0,d._)([(0,m.MZ)(fe.fieldsIndex)],t.prototype,"fieldsIndex",void 0),t=(0,d._)([(0,_.$)("esri.layers.knowledgeGraph.KnowledgeGraphSublayerBase")],t),t};function ge(e){if(!e.json)return e;e.json.write=_e(e.json.write);const t=e.json.origins;if(!t)return e;let n;for(n in t){const e=t[n];e&&(e.write=_e(e.write))}return e}function _e(e){return"object"==typeof e&&e?(!1!==e.enabled&&(e.overridePolicy=function(e){const{target:t,writer:n,overridePolicy:r,...s}=e;return function(e,t){const n=be.call(this,e,t);return n.enabled?{...s,...n}:n}}(e)),e):!0===e?we():e}function we(){return{overridePolicy:be}}function be(e,t){const n=!!this.geometryType;let r={enabled:n};return n&&(r={...r,...ve.call(this,e,t)}),r}function ve(e,t){return{ignoreOrigin:this.originIdOf(t)>b.O.DEFAULTS}}let Me=class extends(me((0,J.J)((0,G.F)((0,$.dM)((0,Y.f)((0,U.e)((0,V.j)((0,Q.J)((0,f.M)(x.A)))))))))){constructor(e){super(e),this.blendMode="normal",this.capabilities=(0,A.d)(!1,!1),this.charts=null,this.definitionExpression=null,this.displayField="",this.effect=null,this.elevationInfo=null,this.featureEffect=null,this.graphType=null,this.labelsVisible=!0,this.labelingInfo=null,this.layerType=null,this.legendEnabled=!0,this.maxScale=0,this.minScale=0,this.objectIdField=pe,this.objectType=null,this.opacity=1,this.orderBy=null,this.parentCompositeLayer=null,this.persistenceEnabled=!0,this.popupEnabled=!0,this.popupTemplate=null,this.refreshInterval=0,this.source={openPorts:()=>this.load().then((()=>{const e=new MessageChannel;return new ne.default(e.port1,{channel:e,client:{queryFeatures:(e,t={})=>{const n=q.A.fromJSON(e);return this.queryFeaturesJSON(n,t)}}}),[e.port2]}))},this.title=null,this.type="knowledge-graph-sublayer",this.useViewTime=!0,this.visible=!0}get defaultPopupTemplate(){return this.createPopupTemplate()}set featureReduction(e){const t=this._normalizeFeatureReduction(e);this._set("featureReduction",t)}get fields(){const e=[];return this.objectType?.properties?.forEach((t=>{const n="esriFieldTypeOID"===t.fieldType?"esriFieldTypeInteger":t.fieldType;e.push(H.A.fromJSON({name:t.name,type:n,alias:t.alias,defaultValue:t.defaultValue,editable:t.editable,nullable:t.nullable}))})),e.push(H.A.fromJSON({name:this.objectIdField,type:"esriFieldTypeString",alias:this.objectIdField,editable:!1}),H.A.fromJSON({name:ce,type:"esriFieldTypeInteger",alias:ce,editable:!1})),e}get geometryType(){if("link-chart"===this.parentCompositeLayer?.type)return"relationship"===this.graphType?"polyline":"point";const e=this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name),t=e?.geometryType;return t&&"esriGeometryNull"!==t?re.f.fromJSON(t):null}get geometryFieldName(){if("link-chart"===this.parentCompositeLayer?.type)return he;const e=this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name);return e?.name??null}get graphTypeName(){return this.objectType?.name}get hasM(){const e=this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name),t=e?.name,n=t?this.objectType?.properties?.[t]:null;return n?.hasM??!1}get hasZ(){const e=this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name),t=e?.name,n=t?this.objectType?.properties?.[t]:null;return n?.hasZ??!1}set renderer(e){(0,z.yp)(e,this.fieldsIndex),this._set("renderer",e)}get renderer(){return this._isOverridden("renderer")?this._get("renderer"):"link-chart"===this.parentCompositeLayer?.type?"relationship"===this.graphType?(0,c.K)((0,A.c)(re.f.toJSON("polyline")).renderer):(0,c.K)((0,A.c)(re.f.toJSON("point")).renderer):(0,c.K)((0,A.c)(re.f.toJSON(this.geometryType)).renderer)}get spatialReference(){return this.parentCompositeLayer?.dataManager?.knowledgeGraph?.dataModel?.spatialReference??M.A.WGS84}writeTitle(e,t){t.title=e??"Layer"}createPopupTemplate(e){return(0,te.tn)(this,e)}createQuery(){return new q.A({where:"1=1",outFields:["*"]})}getField(e){for(let t=0;t<this.fields.length;t++)if(this.fields[t].name===e)return this.fields[t];return null}getFieldDomain(e,t){return null}async queryFeatures(e,t){const{resolvedQuery:n,queryEngine:r}=await this._setupQueryObjects(e),s=ee.A.fromJSON(await r.executeQuery(n.toJSON(),t?.signal));return s.features.forEach((e=>{e.sourceLayer=this})),s}async queryFeaturesJSON(e,t){const{resolvedQuery:n,queryEngine:r}=await this._setupQueryObjects(e);return await r.executeQuery(n.toJSON(),t?.signal)}async queryFeatureCount(e,t){const{resolvedQuery:n,queryEngine:r}=await this._setupQueryObjects(e);return r.executeQueryForCount(n.toJSON(),t?.signal)}async queryExtent(e={},t){const n={...e,returnGeometry:!0},{resolvedQuery:r,queryEngine:s}=await this._setupQueryObjects(n),i=await s.executeQueryForExtent(r.toJSON(),t?.signal);let o;return o=null!=i.extent?.xmin&&null!=i.extent?.xmax&&null!=i.extent?.ymin&&null!=i.extent?.ymax?new C.A(i.extent):new C.A,{count:i.count,extent:o}}async queryObjectIds(e,t){const n=q.A.from(e);let r;if("link-chart"===this.parentCompositeLayer.type&&this._cachedQueryEngine)r=this._cachedQueryEngine;else{const e=await this.parentCompositeLayer.dataManager.getData(n,this,t);r=this.loadQueryEngine(e)}return r.executeQueryForIds(n.toJSON(),t?.signal)}loadQueryEngine(e){const t=new I.F({geometryType:re.f.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ}),n=new E.Q({fieldsIndex:this.fieldsIndex.toJSON(),geometryType:re.f.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:this.spatialReference.toJSON(),timeInfo:null,featureStore:t});return n.featureStore.addMany(e),n}async refreshCachedQueryEngine(){const e=await this.parentCompositeLayer.dataManager.getData(new q.A({where:"1=1",outFields:[pe]}),this);this._cachedQueryEngine=this.loadQueryEngine(e)}async _setupQueryObjects(e,t){const n=q.A.from(e),r=n.geometry;let s;if(r&&!r.spatialReference?.isWGS84&&(await(0,v.initializeProjection)(r.spatialReference,T.w),n.geometry=(0,v.project)(r instanceof R.A||r instanceof B.A?r:r.extent,T.w)),"link-chart"===this.parentCompositeLayer.type&&this._cachedQueryEngine)s=this._cachedQueryEngine;else{const e=await this.parentCompositeLayer.dataManager.getData(n,this,t);s=this.loadQueryEngine(e)}return{resolvedQuery:n,queryEngine:s}}};(0,d._)([(0,m.MZ)(ge((0,y.o8)($.sU)))],Me.prototype,"blendMode",void 0),(0,d._)([(0,m.MZ)()],Me.prototype,"capabilities",void 0),(0,d._)([(0,m.MZ)({json:{origins:{"web-scene":{write:!1}},write:we()}})],Me.prototype,"charts",void 0),(0,d._)([(0,m.MZ)({readOnly:!0})],Me.prototype,"defaultPopupTemplate",null),(0,d._)([(0,m.MZ)({type:String,json:{origins:{service:{read:!1}},name:"layerDefinition.definitionExpression",write:{ignoreOrigin:!0}}})],Me.prototype,"definitionExpression",void 0),(0,d._)([(0,m.MZ)()],Me.prototype,"displayField",void 0),(0,d._)([(0,m.MZ)(ge((0,y.o8)($.LF)))],Me.prototype,"effect",void 0),(0,d._)([(0,m.MZ)()],Me.prototype,"elevationInfo",void 0),(0,d._)([(0,m.MZ)(ge((0,y.o8)(G.Y)))],Me.prototype,"featureEffect",void 0),(0,d._)([(0,m.MZ)(ge((0,y.o8)(J.f)))],Me.prototype,"featureReduction",null),(0,d._)([(0,m.MZ)()],Me.prototype,"fields",null),(0,d._)([(0,m.MZ)()],Me.prototype,"geometryType",null),(0,d._)([(0,m.MZ)()],Me.prototype,"geometryFieldName",null),(0,d._)([(0,m.MZ)({type:["entity","relationship"],nonNullable:!0,json:{write:{isRequired:!0,ignoreOrigin:!0}}})],Me.prototype,"graphType",void 0),(0,d._)([(0,m.MZ)({type:String,nonNullable:!0,json:{write:{isRequired:!0,ignoreOrigin:!0}}})],Me.prototype,"graphTypeName",null),(0,d._)([(0,m.MZ)()],Me.prototype,"hasM",null),(0,d._)([(0,m.MZ)()],Me.prototype,"hasZ",null),(0,d._)([(0,m.MZ)({type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}},write:{ignoreOrigin:!0}}})],Me.prototype,"id",void 0),(0,d._)([(0,m.MZ)(ge((0,y.o8)(X.l)))],Me.prototype,"labelsVisible",void 0),(0,d._)([(0,m.MZ)({type:[W.A],json:{name:"layerDefinition.drawingInfo.labelingInfo",read:K.r,write:we()}})],Me.prototype,"labelingInfo",void 0),(0,d._)([(0,m.MZ)({readOnly:!0,json:{read:!1,write:{writer(e,t){t.layerType=this.geometryType?"KnowledgeGraphSubLayer":"KnowledgeGraphSubTable"},isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}})],Me.prototype,"layerType",void 0),(0,d._)([(0,m.MZ)(ge((0,y.o8)(X.a)))],Me.prototype,"legendEnabled",void 0),(0,d._)([(0,m.MZ)(ge((0,y.o8)(X.m)))],Me.prototype,"maxScale",void 0),(0,d._)([(0,m.MZ)(ge((0,y.o8)(X.b)))],Me.prototype,"minScale",void 0),(0,d._)([(0,m.MZ)()],Me.prototype,"objectIdField",void 0),(0,d._)([(0,m.MZ)()],Me.prototype,"objectType",void 0),(0,d._)([(0,m.MZ)(ge((0,y.o8)(X.o)))],Me.prototype,"opacity",void 0),(0,d._)([(0,m.MZ)(ge((0,y.o8)(Y.n)))],Me.prototype,"orderBy",void 0),(0,d._)([(0,m.MZ)()],Me.prototype,"parentCompositeLayer",void 0),(0,d._)([(0,m.MZ)(ge((0,y.o8)(X.p)))],Me.prototype,"popupEnabled",void 0),(0,d._)([(0,m.MZ)({type:h.A,json:{name:"popupInfo",write:{ignoreOrigin:!0}}})],Me.prototype,"popupTemplate",void 0),(0,d._)([(0,m.MZ)({type:Number,json:{write:{overridePolicy:ve}}})],Me.prototype,"refreshInterval",void 0),(0,d._)([(0,m.MZ)({types:c.r,json:{name:"layerDefinition.drawingInfo.renderer",write:we()}})],Me.prototype,"renderer",null),(0,d._)([(0,m.MZ)()],Me.prototype,"source",void 0),(0,d._)([(0,m.MZ)()],Me.prototype,"spatialReference",null),(0,d._)([(0,m.MZ)({type:String,json:{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}})],Me.prototype,"title",void 0),(0,d._)([(0,w.w)("title")],Me.prototype,"writeTitle",null),(0,d._)([(0,m.MZ)({json:{read:!1}})],Me.prototype,"type",void 0),(0,d._)([(0,m.MZ)(ge((0,y.o8)(U.B)))],Me.prototype,"useViewTime",void 0),(0,d._)([(0,m.MZ)({type:Boolean,json:{name:"visibility",write:we()}})],Me.prototype,"visible",void 0),Me=(0,d._)([(0,_.$)("esri.layers.knowledgeGraph.KnowledgeGraphSublayer")],Me);const Te=Me},6837:(e,t,n)=>{n.d(t,{f:()=>p,n:()=>l});var r=n(32816),s=n(90740),i=n(29298),o=(n(32773),n(20266),n(69421)),a=n(96625);n(36544),n(93181),n(13671),n(40499),n(6407),n(91047),n(93804),n(99924),n(41390),n(58498),n(45371),n(80959);const l={type:[a.O],json:{origins:{"web-scene":{write:!1,read:!1}},name:"layerDefinition.orderBy",read:{reader:function(e,t,n){if(!e)return null;const r=e.find((e=>!!e.field));if(!r)return null;const s=new a.O;return s.read(r,n),[s]}},write:{writer:function(e,t,n,r){const i=e.find((e=>!!e.field));i&&(0,s.s)(n,[i.toJSON()],t)}}}},p=e=>{let t=class extends e{constructor(){super(...arguments),this.orderBy=null}};return(0,r._)([(0,i.MZ)(l)],t.prototype,"orderBy",void 0),t=(0,r._)([(0,o.$)("esri.layers.mixins.OrderedLayer")],t),t}},46935:(e,t,n)=>{n.d(t,{J:()=>_});var r=n(32816),s=(n(32773),n(20266)),i=n(80959),o=n(29298),a=n(48844),l=n(69421),p=n(82530),u=n(17745),d=(n(73067),n(6407),n(41390));n(90740),n(13671),n(36544),n(93181),n(40499),n(91047),n(81272),n(58498),n(45371),n(44945);const h=new u.A,c=new WeakMap;function y(e,t){return Number.isFinite(e)&&Number.isFinite(t)?t<=0?e:y(t,e%t):0}let f=0,m=0;function g(){const e=Date.now();let t=!1;for(const n of h){const r=n.deref();r?r.refreshInterval&&e-(c.get(r)??0)+5>=6e4*r.refreshInterval&&(c.set(r,e),r.refresh(e)):t=!0}if(t)for(let e=h.length-1;e>=0;e--)h.at(e).deref()||h.removeAt(e)}(0,d.a)((()=>{const e=Date.now();let t=0;for(const n of h){const r=n.deref();r&&(t=y(Math.round(6e4*r.refreshInterval),t),r.refreshInterval?c.get(r)||c.set(r,e):c.delete(r))}if(t!==m){if(m=t,clearInterval(f),0===m)return void(f=0);f=setInterval(g,m)}}));const _=e=>{let t=class extends e{constructor(...e){super(...e),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=(0,i.sg)((()=>this.hasDataChanged())),this.when().then((()=>{var e;this.destroyed||null!=(e=this)&&"object"==typeof e&&"refreshInterval"in e&&"refresh"in e&&h.push(new WeakRef(this))}),(()=>{}))}destroy(){!function(e){const t=h.find((t=>t.deref()===e));t&&h.remove(t)}(this)}castRefreshInterval(e){return e>=.1?e:e<=0?0:.1}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(e=Date.now()){(0,i.QZ)(this._debounceHasDataChanged()).then((t=>{t&&this._set("refreshTimestamp",e),this.emit("refresh",{dataChanged:t})}),(e=>{s.L.getLogger(this).error(e),this.emit("refresh",{dataChanged:!1,error:e})}))}async hasDataChanged(){return!0}get test(){}};return(0,r._)([(0,o.MZ)({type:Number,json:{write:!0,origins:{"web-scene":{write:{enabled:!0,layerContainerTypes:p.e}}}}})],t.prototype,"refreshInterval",void 0),(0,r._)([(0,a.w)("refreshInterval")],t.prototype,"castRefreshInterval",null),(0,r._)([(0,o.MZ)({readOnly:!0})],t.prototype,"refreshTimestamp",void 0),(0,r._)([(0,o.MZ)({readOnly:!0})],t.prototype,"refreshParameters",null),t=(0,r._)([(0,l.$)("esri.layers.mixins.RefreshableLayer")],t),t}},59930:(e,t,n)=>{n.d(t,{A:()=>y});var r,s=n(32816),i=n(32773),o=n(29298),a=(n(20266),n(88663)),l=n(69421),p=n(99924),u=n(45862);n(36544),n(93181),n(13671),n(40499),n(6407),n(90740),n(93804),n(91047),n(41390),n(58498),n(45371),n(80959);let d=r=class extends p.oY{constructor(e){super(e),this.name=null,this.code=null}clone(){return new r({name:this.name,code:this.code})}};var h;(0,s._)([(0,o.MZ)({type:String,json:{write:!0}})],d.prototype,"name",void 0),(0,s._)([(0,o.MZ)({type:[String,Number],json:{write:!0}})],d.prototype,"code",void 0),d=r=(0,s._)([(0,l.$)("esri.layers.support.CodedValue")],d);let c=h=class extends u.A{constructor(e){super(e),this.codedValues=null,this.type="coded-value"}getName(e){let t=null;if(this.codedValues){const n=String(e);this.codedValues.some((e=>(String(e.code)===n&&(t=e.name),!!t)))}return t}clone(){return new h({codedValues:(0,i.o8)(this.codedValues),name:this.name})}};(0,s._)([(0,o.MZ)({type:[d],json:{write:!0}})],c.prototype,"codedValues",void 0),(0,s._)([(0,a.e)({codedValue:"coded-value"})],c.prototype,"type",void 0),c=h=(0,s._)([(0,l.$)("esri.layers.support.CodedValueDomain")],c);const y=c},45862:(e,t,n)=>{n.d(t,{A:()=>d});var r=n(32816),s=n(93804),i=n(99924),o=n(29298),a=(n(32773),n(20266),n(88663)),l=n(69421);n(90740),n(41390),n(40499),n(93181),n(13671),n(58498),n(91047),n(45371),n(80959),n(6407),n(36544);const p=new s.J({inherited:"inherited",codedValue:"coded-value",range:"range"});let u=class extends i.oY{constructor(e){super(e),this.name=null,this.type=null}};(0,r._)([(0,o.MZ)({type:String,json:{write:!0}})],u.prototype,"name",void 0),(0,r._)([(0,a.e)(p)],u.prototype,"type",void 0),u=(0,r._)([(0,l.$)("esri.layers.support.Domain")],u);const d=u},44864:(e,t,n)=>{n.d(t,{A:()=>m});var r,s=n(32816),i=n(93804),o=n(99924),a=n(29298),l=n(36544),p=(n(32773),n(88663)),u=n(49877),d=n(69421),h=n(95637),c=n(17872);n(90740),n(41390),n(20266),n(40499),n(93181),n(13671),n(58498),n(91047),n(45371),n(80959),n(6407),n(59930),n(45862),n(72762),n(71613);const y=new i.J({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});let f=r=class extends o.oY{constructor(e){super(e),this.alias=null,this.defaultValue=void 0,this.description=null,this.domain=null,this.editable=!0,this.length=void 0,this.name=null,this.nullable=!0,this.type=null,this.valueType=null,this.visible=!0}readDescription(e,{description:t}){let n=null;try{n=t?JSON.parse(t):null}catch(e){}return n?.value??null}readValueType(e,{description:t}){let n=null;try{n=t?JSON.parse(t):null}catch(e){}return n?y.fromJSON(n.fieldValueType):null}clone(){return new r({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain?.clone()??null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}};(0,s._)([(0,a.MZ)({type:String,json:{write:!0}})],f.prototype,"alias",void 0),(0,s._)([(0,a.MZ)({type:[String,Number],json:{write:{allowNull:!0}}})],f.prototype,"defaultValue",void 0),(0,s._)([(0,a.MZ)()],f.prototype,"description",void 0),(0,s._)([(0,u.r)("description")],f.prototype,"readDescription",null),(0,s._)([(0,a.MZ)({types:h.t,json:{read:{reader:h.f},write:!0}})],f.prototype,"domain",void 0),(0,s._)([(0,a.MZ)({type:Boolean,json:{write:!0}})],f.prototype,"editable",void 0),(0,s._)([(0,a.MZ)({type:l.I,json:{write:{overridePolicy:e=>({enabled:Number.isFinite(e)})}}})],f.prototype,"length",void 0),(0,s._)([(0,a.MZ)({type:String,json:{write:!0}})],f.prototype,"name",void 0),(0,s._)([(0,a.MZ)({type:Boolean,json:{write:!0}})],f.prototype,"nullable",void 0),(0,s._)([(0,p.e)(c.k)],f.prototype,"type",void 0),(0,s._)([(0,a.MZ)()],f.prototype,"valueType",void 0),(0,s._)([(0,u.r)("valueType",["description"])],f.prototype,"readValueType",null),(0,s._)([(0,a.MZ)({type:Boolean,json:{read:!1}})],f.prototype,"visible",void 0),f=r=(0,s._)([(0,d.$)("esri.layers.support.Field")],f);const m=f},72762:(e,t,n)=>{n.d(t,{A:()=>p});var r,s=n(32816),i=(n(20266),n(32773),n(6407),n(88663)),o=n(69421),a=n(45862);n(90740),n(93804),n(29298),n(36544),n(93181),n(13671),n(40499),n(91047),n(99924),n(41390),n(58498),n(45371),n(80959);let l=r=class extends a.A{constructor(e){super(e),this.type="inherited"}clone(){return new r}};(0,s._)([(0,i.e)({inherited:"inherited"})],l.prototype,"type",void 0),l=r=(0,s._)([(0,o.$)("esri.layers.support.InheritedDomain")],l);const p=l},71613:(e,t,n)=>{n.d(t,{A:()=>u});var r,s=n(32816),i=n(29298),o=(n(32773),n(20266),n(88663)),a=n(69421),l=n(45862);n(36544),n(93181),n(13671),n(40499),n(6407),n(90740),n(93804),n(91047),n(99924),n(41390),n(58498),n(45371),n(80959);let p=r=class extends l.A{constructor(e){super(e),this.maxValue=null,this.minValue=null,this.type="range"}clone(){return new r({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}};(0,s._)([(0,i.MZ)({json:{type:[Number],read:{source:"range",reader:(e,t)=>t.range?.[1]},write:{enabled:!1,overridePolicy(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",writer(e,t,n){t[n]=[this.minValue||0,e]}}}})],p.prototype,"maxValue",void 0),(0,s._)([(0,i.MZ)({json:{type:[Number],read:{source:"range",reader:(e,t)=>t.range?.[0]},write:{target:"range",writer(e,t,n){t[n]=[e,this.maxValue||0]}}}})],p.prototype,"minValue",void 0),(0,s._)([(0,o.e)({range:"range"})],p.prototype,"type",void 0),p=r=(0,s._)([(0,a.$)("esri.layers.support.RangeDomain")],p);const u=p},14658:(e,t,n)=>{n.d(t,{A:()=>p});var r=n(32816),s=(n(94345),n(29298)),i=(n(32773),n(20266),n(69421)),o=n(10043),a=n(64752);n(36544),n(44600),n(2160),n(99924),n(41390),n(40499),n(93181),n(13671),n(58498),n(91047),n(45371),n(80959),n(6407),n(90740),n(49877),n(7969),n(69763),n(93804),n(18683),n(64604),n(29512),n(99063),n(56273),n(29208),n(36533),n(48844),n(84200),n(97827),n(91695),n(18169),n(48402),n(16699),n(26809),n(2589),n(18527),n(67504),n(92517),n(77037),n(89754);let l=class extends o.A{constructor(e){super(e),this.layoutGeometry=null}};(0,r._)([(0,s.MZ)({type:a.A,json:{write:!0}})],l.prototype,"layoutGeometry",void 0),l=(0,r._)([(0,i.$)("esri.rest.knowledgeGraph.Entity")],l);const p=l},10043:(e,t,n)=>{n.d(t,{A:()=>l});var r=n(32816),s=n(29298),i=(n(32773),n(20266),n(69421)),o=n(89754);n(36544),n(93181),n(13671),n(40499),n(6407),n(90740),n(91047),n(99924),n(41390),n(58498),n(45371),n(80959);let a=class extends o.A{constructor(e){super(e),this.typeName=null,this.id=null}};(0,r._)([(0,s.MZ)({type:String,json:{write:!0}})],a.prototype,"typeName",void 0),(0,r._)([(0,s.MZ)({type:String,json:{write:!0}})],a.prototype,"id",void 0),a=(0,r._)([(0,i.$)("esri.rest.knowledgeGraph.GraphNamedObject")],a);const l=a},89754:(e,t,n)=>{n.d(t,{A:()=>l});var r=n(32816),s=n(99924),i=n(29298),o=(n(32773),n(20266),n(69421));n(41390),n(40499),n(93181),n(13671),n(58498),n(91047),n(45371),n(80959),n(6407),n(90740),n(36544);let a=class extends s.oY{constructor(e){super(e),this.properties=null}};(0,r._)([(0,i.MZ)({json:{write:!0}})],a.prototype,"properties",void 0),a=(0,r._)([(0,o.$)("esri.rest.knowledgeGraph.GraphObject")],a);const l=a},56833:(e,t,n)=>{n.d(t,{A:()=>l});var r=n(32816),s=n(41390),i=n(29298),o=(n(32773),n(20266),n(69421));n(40499),n(93181),n(13671),n(58498),n(91047),n(45371),n(80959),n(6407),n(90740),n(36544);let a=class extends s.T{constructor(e){super(e),this.openCypherQuery=""}};(0,r._)([(0,i.MZ)()],a.prototype,"openCypherQuery",void 0),a=(0,r._)([(0,o.$)("esri.rest.knowledgeGraph.GraphQuery")],a);const l=a},49197:(e,t,n)=>{n.d(t,{A:()=>l});var r=n(32816),s=n(29298),i=(n(32773),n(20266),n(69421)),o=n(56833);n(36544),n(93181),n(13671),n(40499),n(6407),n(90740),n(91047),n(41390),n(58498),n(45371),n(80959);let a=class extends o.A{constructor(e){super(e),this.bindParameters=null,this.bindGeometryQuantizationParameters=null,this.outputQuantizationParameters=null,this.outputSpatialReference=null,this.provenanceBehavior=null}};(0,r._)([(0,s.MZ)()],a.prototype,"bindParameters",void 0),(0,r._)([(0,s.MZ)()],a.prototype,"bindGeometryQuantizationParameters",void 0),(0,r._)([(0,s.MZ)()],a.prototype,"outputQuantizationParameters",void 0),(0,r._)([(0,s.MZ)()],a.prototype,"outputSpatialReference",void 0),(0,r._)([(0,s.MZ)()],a.prototype,"provenanceBehavior",void 0),a=(0,r._)([(0,i.$)("esri.rest.knowledgeGraph.GraphQueryStreaming")],a);const l=a},5370:(e,t,n)=>{n.d(t,{A:()=>p});var r=n(32816),s=n(99924),i=n(29298),o=(n(32773),n(20266),n(69421)),a=n(89754);n(41390),n(40499),n(93181),n(13671),n(58498),n(91047),n(45371),n(80959),n(6407),n(90740),n(36544);let l=class extends s.oY{constructor(e){super(e),this.path=null}};(0,r._)([(0,i.MZ)({type:[a.A],json:{write:!0}})],l.prototype,"path",void 0),l=(0,r._)([(0,o.$)("esri.rest.knowledgeGraph.Path")],l);const p=l},76999:(e,t,n)=>{n.d(t,{A:()=>p});var r=n(32816),s=(n(94345),n(29298)),i=(n(32773),n(20266),n(69421)),o=n(10043),a=n(67504);n(36544),n(44600),n(2160),n(99924),n(41390),n(40499),n(93181),n(13671),n(58498),n(91047),n(45371),n(80959),n(6407),n(90740),n(49877),n(7969),n(69763),n(93804),n(18683),n(64604),n(29512),n(99063),n(56273),n(64752),n(48844),n(29208),n(36533),n(84200),n(97827),n(91695),n(18169),n(48402),n(16699),n(26809),n(2589),n(18527),n(92517),n(77037),n(89754);let l=class extends o.A{constructor(e){super(e),this.originId=null,this.destinationId=null,this.layoutGeometry=null}};(0,r._)([(0,s.MZ)({type:String,json:{write:!0}})],l.prototype,"originId",void 0),(0,r._)([(0,s.MZ)({type:String,json:{write:!0}})],l.prototype,"destinationId",void 0),(0,r._)([(0,s.MZ)({type:a.A,json:{write:!0}})],l.prototype,"layoutGeometry",void 0),l=(0,r._)([(0,i.$)("esri.rest.knowledgeGraph.Relationship")],l);const p=l},8824:(e,t,n)=>{n.d(t,{A:()=>w});var r,s=n(32816),i=n(94345),o=n(27281),a=n(93804),l=n(99924),p=n(32773),u=n(29298),d=(n(20266),n(49877)),h=n(69421),c=n(56273),y=n(7969),f=n(77037),m=n(44864);n(36544),n(44600),n(2160),n(41390),n(40499),n(93181),n(13671),n(58498),n(91047),n(45371),n(80959),n(6407),n(90740),n(69763),n(18683),n(64604),n(29512),n(99063),n(64752),n(48844),n(29208),n(36533),n(84200),n(97827),n(91695),n(18169),n(48402),n(16699),n(26809),n(2589),n(18527),n(67504),n(92517),n(72393),n(52731),n(17745),n(81272),n(44945),n(30011),n(55270),n(50214),n(59192),n(78016),n(54483),n(95779),n(13262),n(346),n(51961),n(62399),n(64995),n(33150),n(58173),n(66110),n(67520),n(27532),n(88663),n(48103),n(65085),n(33611),n(84857),n(60373),n(98187),n(35902),n(13226),n(16794),n(52357),n(11090),n(49319),n(93546),n(29570),n(34592),n(79825),n(95101),n(67578),n(14896),n(95611),n(98089),n(91366),n(80473),n(43435),n(73435),n(4048),n(85232),n(93471),n(53252),n(34039),n(70061),n(3495),n(97906),n(64524),n(65023),n(31424),n(74676),n(53610),n(29447),n(78273),n(49475),n(32368),n(7391),n(22529),n(43534),n(38094),n(67723),n(47239),n(59858),n(63728),n(1178),n(7182),n(47788),n(19297),n(82408),n(73509),n(28276),n(69277),n(70580),n(75191),n(24319),n(62092),n(4157),n(62401),n(89322),n(20138),n(53370),n(46946),n(3816),n(71992),n(80167),n(4478),n(91808),n(7161),n(55586),n(35121),n(92229),n(18344),n(64884),n(23351),n(51222),n(42870),n(67321),n(73067),n(54512),n(53103),n(19648),n(42948),n(95637),n(59930),n(45862),n(72762),n(71613),n(17872);const g=new a.J({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let _=r=class extends l.oY{constructor(e){super(e),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(e,t){const n=y.A.fromJSON(t.spatialReference),r=[];for(let t=0;t<e.length;t++){const s=e[t],i=o.A.fromJSON(s),a=s.geometry?.spatialReference;null==i.geometry||a||(i.geometry.spatialReference=n);const l=s.aggregateGeometries,p=i.aggregateGeometries;if(l&&null!=p)for(const e in p){const t=p[e],r=l[e],s=r?.spatialReference;null==t||s||(t.spatialReference=n)}r.push(i)}return r}writeGeometryType(e,t,n,r){if(e)return void g.write(e,t,n,r);const{features:s}=this;if(s)for(const e of s)if(null!=e?.geometry)return void g.write(e.geometry.type,t,n,r)}readQueryGeometry(e,t){if(!e)return null;const n=!!e.spatialReference,r=(0,f.rS)(e);return r&&!n&&t.spatialReference&&(r.spatialReference=y.A.fromJSON(t.spatialReference)),r}writeSpatialReference(e,t){if(e)return void(t.spatialReference=e.toJSON());const{features:n}=this;if(n)for(const e of n)if(e&&null!=e.geometry&&e.geometry.spatialReference)return void(t.spatialReference=e.geometry.spatialReference.toJSON())}clone(){return new r(this.cloneProperties())}cloneProperties(){return(0,p.o8)({displayFieldName:this.displayFieldName,exceededTransferLimit:this.exceededTransferLimit,features:this.features,fields:this.fields,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,queryGeometry:this.queryGeometry,spatialReference:this.spatialReference,transform:this.transform})}toJSON(e){const t=this.write();if(t.features&&Array.isArray(e)&&e.length>0)for(let n=0;n<t.features.length;n++){const r=t.features[n];if(r.geometry){const t=e?.[n];r.geometry=t?.toJSON()||r.geometry}}return t}quantize(e){const{scale:[t,n],translate:[r,s]}=e,i=this.features,o=this._getQuantizationFunction(this.geometryType,(e=>Math.round((e-r)/t)),(e=>Math.round((s-e)/n)));for(let e=0,t=i.length;e<t;e++)o?.(i[e].geometry)||(i.splice(e,1),e--,t--);return this.transform=e,this}unquantize(){const{geometryType:e,features:t,transform:n}=this;if(!n)return this;const{translate:[r,s],scale:[i,o]}=n;let a=null,l=null;if(this.hasZ&&null!=n?.scale?.[2]){const{translate:[,,e],scale:[,,t]}=n;a=n=>n*t+e}if(this.hasM&&null!=n?.scale?.[3]){const{translate:[,,,e],scale:[,,,t]}=n;l=n=>null==n?n:n*t+e}const p=this._getHydrationFunction(e,(e=>e*i+r),(e=>s-e*o),a,l);for(const{geometry:e}of t)null!=e&&p&&p(e);return this.transform=null,this}_quantizePoints(e,t,n){let r,s;const i=[];for(let o=0,a=e.length;o<a;o++){const a=e[o];if(o>0){const e=t(a[0]),o=n(a[1]);e===r&&o===s||(i.push([e-r,o-s]),r=e,s=o)}else r=t(a[0]),s=n(a[1]),i.push([r,s])}return i.length>0?i:null}_getQuantizationFunction(e,t,n){return"point"===e?e=>(e.x=t(e.x),e.y=n(e.y),e):"polyline"===e||"polygon"===e?e=>{const r=(0,f.Bi)(e)?e.rings:e.paths,s=[];for(let e=0,i=r.length;e<i;e++){const i=r[e],o=this._quantizePoints(i,t,n);o&&s.push(o)}return s.length>0?((0,f.Bi)(e)?e.rings=s:e.paths=s,e):null}:"multipoint"===e?e=>{const r=this._quantizePoints(e.points,t,n);return r&&r.length>0?(e.points=r,e):null}:"extent"===e?e=>e:null}_getHydrationFunction(e,t,n,r,s){return"point"===e?e=>{e.x=t(e.x),e.y=n(e.y),r&&(e.z=r(e.z))}:"polyline"===e||"polygon"===e?e=>{const i=(0,f.Bi)(e)?e.rings:e.paths;let o,a;for(let e=0,r=i.length;e<r;e++){const r=i[e];for(let e=0,s=r.length;e<s;e++){const s=r[e];e>0?(o+=s[0],a+=s[1]):(o=s[0],a=s[1]),s[0]=t(o),s[1]=n(a)}}if(r&&s)for(let e=0,t=i.length;e<t;e++){const t=i[e];for(let e=0,n=t.length;e<n;e++){const n=t[e];n[2]=r(n[2]),n[3]=s(n[3])}}else if(r)for(let e=0,t=i.length;e<t;e++){const t=i[e];for(let e=0,n=t.length;e<n;e++){const n=t[e];n[2]=r(n[2])}}else if(s)for(let e=0,t=i.length;e<t;e++){const t=i[e];for(let e=0,n=t.length;e<n;e++){const n=t[e];n[2]=s(n[2])}}}:"extent"===e?e=>{e.xmin=t(e.xmin),e.ymin=n(e.ymin),e.xmax=t(e.xmax),e.ymax=n(e.ymax),r&&null!=e.zmax&&null!=e.zmin&&(e.zmax=r(e.zmax),e.zmin=r(e.zmin)),s&&null!=e.mmax&&null!=e.mmin&&(e.mmax=s(e.mmax),e.mmin=s(e.mmin))}:"multipoint"===e?e=>{const i=e.points;let o,a;for(let e=0,r=i.length;e<r;e++){const r=i[e];e>0?(o+=r[0],a+=r[1]):(o=r[0],a=r[1]),r[0]=t(o),r[1]=n(a)}if(r&&s)for(let e=0,t=i.length;e<t;e++){const t=i[e];t[2]=r(t[2]),t[3]=s(t[3])}else if(r)for(let e=0,t=i.length;e<t;e++){const t=i[e];t[2]=r(t[2])}else if(s)for(let e=0,t=i.length;e<t;e++){const t=i[e];t[2]=s(t[2])}}:null}};(0,s._)([(0,u.MZ)({type:String,json:{write:!0}})],_.prototype,"displayFieldName",void 0),(0,s._)([(0,u.MZ)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],_.prototype,"exceededTransferLimit",void 0),(0,s._)([(0,u.MZ)({type:[o.A],json:{write:!0}})],_.prototype,"features",void 0),(0,s._)([(0,d.r)("features")],_.prototype,"readFeatures",null),(0,s._)([(0,u.MZ)({type:[m.A],json:{write:!0}})],_.prototype,"fields",void 0),(0,s._)([(0,u.MZ)({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:g.read}}})],_.prototype,"geometryType",void 0),(0,s._)([(0,c.w)("geometryType")],_.prototype,"writeGeometryType",null),(0,s._)([(0,u.MZ)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],_.prototype,"hasM",void 0),(0,s._)([(0,u.MZ)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],_.prototype,"hasZ",void 0),(0,s._)([(0,u.MZ)({types:i.yR,json:{write:!0}})],_.prototype,"queryGeometry",void 0),(0,s._)([(0,d.r)("queryGeometry")],_.prototype,"readQueryGeometry",null),(0,s._)([(0,u.MZ)({type:y.A,json:{write:!0}})],_.prototype,"spatialReference",void 0),(0,s._)([(0,c.w)("spatialReference")],_.prototype,"writeSpatialReference",null),(0,s._)([(0,u.MZ)({json:{write:!0}})],_.prototype,"transform",void 0),_=r=(0,s._)([(0,h.$)("esri.rest.support.FeatureSet")],_),_.prototype.toJSON.isDefaultToJSON=!0;const w=_}}]);
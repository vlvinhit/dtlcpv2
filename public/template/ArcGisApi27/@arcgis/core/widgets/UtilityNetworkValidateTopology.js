/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
import{_ as t}from"../chunks/tslib.es6.js";import{property as e}from"../core/accessorSupport/decorators/property.js";import"../chunks/ensureType.js";import"../chunks/typedArrayUtil.js";import{subclass as s}from"../core/accessorSupport/decorators/subclass.js";import o,{l as i}from"./Widget.js";import"../chunks/widgetUtils.js";import{m as r}from"../chunks/messageBundle.js";import{t as n}from"../chunks/jsxFactory.js";import c from"./UtilityNetworkValidateTopology/UtilityNetworkValidateTopologyViewModel.js";import"../chunks/Logger.js";import"../config.js";import"../chunks/object.js";import"../core/lang.js";import"../chunks/string.js";import"../chunks/get.js";import"../chunks/utils.js";import"../chunks/maybe.js";import"../chunks/metadata.js";import"../core/Error.js";import"../chunks/tracking.js";import"../intl.js";import"../chunks/date.js";import"../chunks/jsonMap.js";import"../chunks/locale.js";import"../chunks/datetime.js";import"../chunks/number.js";import"../chunks/messages.js";import"../core/promiseUtils.js";import"../request.js";import"../kernel.js";import"../core/urlUtils.js";import"../chunks/assets.js";import"../chunks/domUtils.js";import"../core/Evented.js";import"../core/Accessor.js";import"../core/Handles.js";import"../chunks/ObjectPool.js";import"../chunks/ObservableBase.js";import"../chunks/watch.js";import"../chunks/ArrayPool.js";import"../core/scheduling.js";import"../chunks/nextTick.js";import"../chunks/PooledArray.js";import"../core/Promise.js";import"../core/reactiveUtils.js";import"../chunks/uuid.js";import"../core/accessorSupport/decorators/cast.js";import"../chunks/projector.js";import"../chunks/dom.js";import"../chunks/guid.js";import"../chunks/index.js";import"../chunks/jsxWidgetSupport.js";import"../core/Collection.js";import"../chunks/shared.js";import"../chunks/SimpleObservable.js";import"../core/HandleOwner.js";import"../chunks/WatchUpdatingTracking.js";import"../geometry/Extent.js";import"../geometry/Geometry.js";import"../core/JSONSupport.js";import"../chunks/reader.js";import"../geometry/SpatialReference.js";import"../chunks/unitUtils.js";import"../chunks/writer.js";import"../geometry/Point.js";import"../geometry/support/webMercatorUtils.js";import"../chunks/layerUtils.js";import"../rest/networks/support/ValidateNetworkTopologyParameters.js";import"../geometry.js";import"../geometry/Multipoint.js";import"../chunks/zmUtils.js";import"../geometry/Polygon.js";import"../chunks/extentUtils.js";import"../chunks/aaBoundingRect.js";import"../chunks/mathUtils.js";import"../chunks/vec3.js";import"../chunks/vec3f64.js";import"../chunks/common.js";import"../chunks/vec4.js";import"../geometry/Polyline.js";import"../chunks/typeUtils.js";import"../geometry/support/jsonUtils.js";import"../chunks/typeUtils2.js";const l="esri-un-validate-topology__container",a="esri-un-validate-topology__content",p="esri-un-validate-topology__controls-container",u="esri-un-validate-topology__status-icon-error",d="esri-un-validate-topology__status-icon-container";let m=class extends o{constructor(t,e){super(t,e),this.messages=null,this.viewModel=new c}loadDependencies(){return i({action:()=>import("../chunks/calcite-action.js"),block:()=>import("../chunks/calcite-block.js"),icon:()=>import("../chunks/calcite-icon.js"),notice:()=>import("../chunks/calcite-notice.js"),option:()=>import("../chunks/calcite-option.js"),select:()=>import("../chunks/calcite-select.js"),tooltip:()=>import("../chunks/calcite-tooltip.js")})}get extentToValidate(){return this.viewModel.extentToValidate}set extentToValidate(t){this.viewModel.extentToValidate=t}get label(){return this.messages?.label??""}set label(t){this._overrideIfSome("label",t)}get utilityNetwork(){return this.viewModel.utilityNetwork}set utilityNetwork(t){this.viewModel.utilityNetwork=t}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}render(){const{viewModel:t}=this;return"disabled"===t.state?n("div",{class:l},n("calcite-block",{heading:this.label,class:a,collapsible:!1,open:!0},this._renderLoadErrorStatusIcon(),this._renderLoadErrorsNotices())):n("div",{class:l},n("calcite-block",{heading:this.label,class:a,collapsible:!0,open:!1},this._renderStatusIcon(),this._renderValidateTopologyAction(),this._renderControls()))}_extentOptionSelectChange(t){this.extentToValidate=t.target.value}_getLoadErrorMessagesAsNotices(t,e){return n("calcite-notice",{key:"error-notice-"+e,open:!0,closable:!1,kind:"warning",scale:"s"},n("div",{slot:"message"},t))}_handleValidateTopologyAction(){this.viewModel.validateTopology().catch((()=>{}))}_renderControls(){const{viewModel:t}=this;return"failed"===t.state?n("div",{class:p},this._renderExtentOptionSelect(),this._renderStatusNotice()):this._renderExtentOptionSelect()}_renderExtentOptionSelect(){const{messages:t,viewModel:e}=this;return n("div",{key:"selectExtentDiv"},n("calcite-select",{bind:this,label:t.input.extentToValidate,disabled:"loading"===e.state||"executing"===e.state,onCalciteSelectChange:this._extentOptionSelectChange},n("calcite-option",{value:"current"},t.input.currentExtent),n("calcite-option",{value:"entire"},t.input.entireExtent)))}_renderLoadErrorsNotices(){const{viewModel:t}=this;return n("div",{key:"loadErrorsDiv",class:p},t.loadErrors.items.map(this._getLoadErrorMessagesAsNotices))}_renderLoadErrorStatusIcon(){return n("div",{key:"statusDiv",slot:"control",class:d},n("calcite-icon",{icon:"exclamation-mark-triangle",scale:"s",class:u}))}_renderStatusIcon(){const{messages:t,viewModel:e}=this,s=`${this.id}-validation-status-action`,o=`${this.id}-error-status-icon`,i=`${this.id}-success-status-icon`;return"executing"===e.state?n("div",{key:"statusDivExecuting",slot:"control"},n("calcite-action",{id:s,text:t.status.executing,textEnabled:!1,loading:!0}),n("calcite-tooltip",{referenceElement:s,label:t.status.executing},n("span",null,t.status.executing))):"success"===e.state?n("div",{key:"statusDivSuccess",slot:"control",class:d,afterCreate:t=>{setTimeout((()=>{t.innerHTML=""}),3500)}},n("calcite-icon",{id:i,icon:"check-circle",scale:"s",class:"esri-un-validate-topology__status-icon-success"}),n("calcite-tooltip",{referenceElement:i,label:t.status.success},n("span",null,t.status.success))):"failed"===e.state?n("div",{key:"statusDivFailed",slot:"control",class:d},n("calcite-icon",{id:o,icon:"exclamation-mark-triangle",scale:"s",class:u}),n("calcite-tooltip",{referenceElement:o,label:e.executionError},n("span",null,e.executionError))):n("div",{key:"statusDiv",slot:"control",class:d})}_renderStatusNotice(){const{viewModel:t}=this;return n("div",{key:"executionErrorDiv"},n("calcite-notice",{open:!0,closable:!0,kind:"warning",scale:"s"},n("div",{slot:"message"},t.executionError)))}_renderValidateTopologyAction(){const{messages:t,viewModel:e}=this,s=`${this.id}-validation-action`;return n("div",{key:"actionDiv",slot:"control"},n("calcite-action",{id:s,bind:this,icon:"play-f",disabled:"executing"===e.state,text:t.input.validateTopology,textEnabled:!1,loading:"loading"===e.state,onclick:this._handleValidateTopologyAction}),n("calcite-tooltip",{referenceElement:s,label:t.input.validateTopology},n("span",null,"loading"===e.state?t.status.loading:t.input.validateTopology)))}};t([e()],m.prototype,"extentToValidate",null),t([e()],m.prototype,"label",null),t([e(),r("esri/widgets/UtilityNetworkValidateTopology/t9n/UtilityNetworkValidateTopology")],m.prototype,"messages",void 0),t([e()],m.prototype,"utilityNetwork",null),t([e()],m.prototype,"view",null),t([e({type:c})],m.prototype,"viewModel",void 0),m=t([s("esri.widgets.UtilityNetworkValidateTopology")],m);const h=m;export{h as default};

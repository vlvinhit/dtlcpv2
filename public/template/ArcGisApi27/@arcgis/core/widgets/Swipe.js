/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
import{_ as e}from"../chunks/tslib.es6.js";import{e as t}from"../core/promiseUtils.js";import{property as i}from"../core/accessorSupport/decorators/property.js";import"../chunks/ensureType.js";import"../chunks/typedArrayUtil.js";import{subclass as o}from"../core/accessorSupport/decorators/subclass.js";import r from"./Widget.js";import"../chunks/widgetUtils.js";import{m as n}from"../chunks/messageBundle.js";import{t as s}from"../chunks/jsxFactory.js";import a from"./Swipe/SwipeViewModel.js";import"../core/Error.js";import"../core/lang.js";import"../chunks/Logger.js";import"../config.js";import"../chunks/object.js";import"../chunks/string.js";import"../chunks/maybe.js";import"../chunks/get.js";import"../chunks/utils.js";import"../chunks/metadata.js";import"../chunks/tracking.js";import"../intl.js";import"../chunks/date.js";import"../chunks/jsonMap.js";import"../chunks/locale.js";import"../chunks/datetime.js";import"../chunks/number.js";import"../chunks/messages.js";import"../request.js";import"../kernel.js";import"../core/urlUtils.js";import"../chunks/assets.js";import"../chunks/domUtils.js";import"../core/Evented.js";import"../core/Accessor.js";import"../core/Handles.js";import"../chunks/ObjectPool.js";import"../chunks/ObservableBase.js";import"../chunks/watch.js";import"../chunks/ArrayPool.js";import"../core/scheduling.js";import"../chunks/nextTick.js";import"../chunks/PooledArray.js";import"../core/Promise.js";import"../core/reactiveUtils.js";import"../chunks/uuid.js";import"../core/accessorSupport/decorators/cast.js";import"../chunks/projector.js";import"../chunks/dom.js";import"../chunks/guid.js";import"../chunks/index.js";import"../chunks/jsxWidgetSupport.js";import"../core/Collection.js";import"../chunks/shared.js";import"../chunks/SimpleObservable.js";import"../chunks/ClipRect.js";import"../core/JSONSupport.js";const l="esri-swipe",d={base:l,baseDisabled:`${l}--disabled`,vertical:`${l}--vertical`,horizontal:`${l}--horizontal`,container:`${l}__container`,divider:`${l}__divider`,handle:`${l}__handle`,handleHidden:`${l}__handle--hidden`,widgetIcon:"esri-icon-up-down-arrows",handleIcon:`${l}__handle-icon`,dragIconHorizontal:"esri-icon-drag-horizontal",dragIconVertical:"esri-icon-drag-vertical",widget:"esri-widget",disabled:"esri-disabled"},c={handle:!0,divider:!0};let p=class extends r{constructor(e,t){super(e,t),this.disabled=!1,this.iconClass=d.widgetIcon,this.icon=null,this.messages=null,this.viewModel=new a,this._pointerOffset=0,this._container=null,this._onContainerPointerDown=this._onContainerPointerDown.bind(this),this._onContainerPointerMove=this._onContainerPointerMove.bind(this),this._onContainerPointerUp=this._onContainerPointerUp.bind(this)}get direction(){return this.viewModel.direction}set direction(e){this.viewModel.direction=e}get dragLabel(){return this.messages?.dragLabel??""}set dragLabel(e){this._overrideIfSome("dragLabel",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get leadingLayers(){return this.viewModel.leadingLayers}set leadingLayers(e){this.viewModel.leadingLayers=e}get position(){return this.viewModel.position}set position(e){this.viewModel.position=e}get trailingLayers(){return this.viewModel.trailingLayers}set trailingLayers(e){this.viewModel.trailingLayers=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}set visibleElements(e){this._set("visibleElements",{...c,...e})}get visibleElements(){return this._get("visibleElements")||c}render(){const{state:e,direction:t}=this.viewModel,i="disabled"===e||this.disabled,o={[d.disabled]:i,[d.baseDisabled]:i,[d.vertical]:"vertical"===t,[d.horizontal]:"horizontal"===t};return s("div",{class:this.classes(d.base,d.widget,o)},"disabled"===e?null:this.renderContainer())}renderHandle(){const{direction:e}=this.viewModel,{visibleElements:t}=this,i={[d.dragIconHorizontal]:"vertical"===e,[d.dragIconVertical]:"horizontal"===e},o=this.classes(d.handle,!t.handle&&d.handleHidden);return s("div",{key:"handle",role:"presentation",class:o},s("span",{"aria-hidden":"true",class:this.classes(d.handleIcon,i)}))}renderDivider(){const{visibleElements:e}=this;return e&&e.divider?s("div",{key:"divider",role:"presentation",class:d.divider}):null}renderContent(){return[this.renderDivider(),this.renderHandle()]}renderContainer(){const{disabled:e,dragLabel:t,viewModel:i}=this,{max:o,min:r,direction:n,position:a}=i,l=`${a}%`,c={top:"vertical"===n?l:void 0,left:"vertical"===n?void 0:l},p=this.renderContent();return s("div",e?{key:"container",role:"presentation",styles:c,class:d.container}:{tabIndex:0,key:"container",bind:this,afterCreate:this._afterContainerCreate,onkeydown:this._onContainerKeyDown,"touch-action":"none",role:"slider",title:t,"aria-label":t,"aria-orientation":n,"aria-valuemax":`${o}`,"aria-valuemin":`${r}`,"aria-valuenow":`${a}`,"aria-valuetext":l,styles:c,class:d.container},p)}_afterContainerCreate(e){this._container=e,e.addEventListener("pointerdown",this._onContainerPointerDown)}_calculatePointerOffset(e){const{direction:t}=this,i=e.target,o=("vertical"===t?i.clientHeight:i.clientWidth)/2,r=i.getBoundingClientRect(),n=e.clientX-r.left,s=e.clientY-r.top;this._pointerOffset="vertical"===t?s-o:n-o}_onContainerPointerDown(e){e.preventDefault(),this._container&&document.activeElement!==this.container&&this._container.focus(),this._calculatePointerOffset(e),document.addEventListener("pointerup",this._onContainerPointerUp),document.addEventListener("pointermove",this._onContainerPointerMove)}_onContainerPointerUp(e){e.preventDefault(),document.removeEventListener("pointerup",this._onContainerPointerUp),document.removeEventListener("pointermove",this._onContainerPointerMove)}_onContainerPointerMove(e){e.preventDefault();const{_pointerOffset:t,container:i,direction:o}=this,{clientX:r,clientY:n}=e,{top:s,left:a,width:l,height:d}=i.getBoundingClientRect(),c=("vertical"===o?n-s-t:r-a-t)/("vertical"===o?d:l)*100;this.position=c}_getKeyPosition(e){const i=t(e),{position:o}=this,{max:r,min:n,step:s,stepMultiplier:a,direction:l}=this.viewModel,d=s*a;return["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Home","End","PageUp","PageDown"].includes(i)&&(e.preventDefault(),e.stopPropagation()),("vertical"===l?"ArrowDown"===i||"ArrowRight"===i:"ArrowUp"===i||"ArrowRight"===i)?o+(e.shiftKey?d:s):("vertical"===l?"ArrowUp"===i||"ArrowLeft"===i:"ArrowDown"===i||"ArrowLeft"===i)?o-(e.shiftKey?d:s):"Home"===i?n:"End"===i?r:("vertical"===l?"PageDown"===i:"PageUp"===i)?o+d:("vertical"===l?"PageUp"===i:"PageDown"===i)?o-d:null}_onContainerKeyDown(e){const t=this._getKeyPosition(e);"number"==typeof t&&(this.position=t)}};e([i()],p.prototype,"direction",null),e([i()],p.prototype,"disabled",void 0),e([i()],p.prototype,"dragLabel",null),e([i()],p.prototype,"iconClass",void 0),e([i()],p.prototype,"icon",void 0),e([i()],p.prototype,"label",null),e([i()],p.prototype,"leadingLayers",null),e([i(),n("esri/widgets/Swipe/t9n/Swipe")],p.prototype,"messages",void 0),e([i()],p.prototype,"position",null),e([i()],p.prototype,"trailingLayers",null),e([i()],p.prototype,"view",null),e([i({type:a})],p.prototype,"viewModel",void 0),e([i()],p.prototype,"visibleElements",null),p=e([o("esri.widgets.Swipe")],p);const h=p;export{h as default};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
import{_ as t}from"../../chunks/tslib.es6.js";import{debounce as s}from"../../core/promiseUtils.js";import{watch as e,initial as i}from"../../core/reactiveUtils.js";import{property as o}from"../../core/accessorSupport/decorators/property.js";import"../../chunks/ensureType.js";import"../../chunks/typedArrayUtil.js";import{subclass as r}from"../../core/accessorSupport/decorators/subclass.js";import l from"../Slider.js";import{l as n}from"../Widget.js";import"../../chunks/widgetUtils.js";import{t as u}from"../../chunks/jsxFactory.js";import{V as p}from"../../chunks/ValuePickerBaseComponent.js";import c from"../../core/Accessor.js";import"../../core/Error.js";import"../../core/lang.js";import"../../chunks/Logger.js";import"../../config.js";import"../../chunks/object.js";import"../../chunks/string.js";import"../../chunks/maybe.js";import"../../chunks/utils.js";import"../../chunks/watch.js";import"../../chunks/ArrayPool.js";import"../../chunks/ObjectPool.js";import"../../core/scheduling.js";import"../../chunks/nextTick.js";import"../../chunks/PooledArray.js";import"../../chunks/get.js";import"../../chunks/tracking.js";import"../../chunks/metadata.js";import"../../intl.js";import"../../chunks/date.js";import"../../chunks/jsonMap.js";import"../../chunks/locale.js";import"../../chunks/datetime.js";import"../../chunks/number.js";import"../../chunks/messages.js";import"../../request.js";import"../../kernel.js";import"../../core/urlUtils.js";import"../../chunks/assets.js";import"../../core/Collection.js";import"../../core/Evented.js";import"../../core/Handles.js";import"../../chunks/ObservableBase.js";import"../../chunks/shared.js";import"../../chunks/SimpleObservable.js";import"../../core/accessorSupport/decorators/cast.js";import"../Slider/SliderViewModel.js";import"../../chunks/messageBundle.js";import"../../chunks/domUtils.js";import"../../core/Promise.js";import"../../chunks/uuid.js";import"../../chunks/projector.js";import"../../chunks/dom.js";import"../../chunks/guid.js";import"../../chunks/index.js";import"../../chunks/jsxWidgetSupport.js";let a=class extends c{constructor(t){super(t),this.steps=!1,this.thumbTooltip=!1}};t([o({nonNullable:!0})],a.prototype,"steps",void 0),t([o({nonNullable:!0})],a.prototype,"thumbTooltip",void 0),a=t([r("esri.widgets.ValuePicker.ValuePickerSliderVisibleElements")],a);const h=a,m="esri-value-picker__slider",d={minorTick:`${m}__tick-minor`,majorTick:`${m}__tick-major`,stepsTick:`${m}__tick-steps`,tooltip:`${m}__tooltip`};function j(t){return(s,e)=>{e?.classList.add(t)}}let v=class extends p{constructor(t,e){super(t,e),this._majorTickCreatedFunction=j(d.majorTick),this._minorTickCreatedFunction=j(d.minorTick),this._stepsTickCreatedFunction=j(d.stepsTick),this._thumbNode=null,this._tooltip=null,this._slider=new l({thumbCreatedFunction:(t,s,e)=>{this._thumbNode=e}}),this.labelFormatFunction=null,this.labels=null,this.min=null,this.minorTicks=null,this.majorTicks=null,this.max=null,this.reversed=!1,this.steps=null,this.type="slider",this.visibleElements=new h,this._thumbDragDebounced=s((async t=>{await(this._tooltip?.reposition(!1))}))}initialize(){this.addHandles([e((()=>this.viewModel?.values),(t=>{this._slider.values=t}),i),e((()=>this._slider.values),(t=>{this.viewModel&&this.viewModel.values!==t&&(this.viewModel.values=t)})),this._slider.on("thumb-drag",this._thumbDragDebounced)])}destroy(){this._slider.destroy()}loadDependencies(){return n({tooltip:()=>import("../../chunks/calcite-tooltip.js")})}get _ascending(){const{reversed:t,viewModel:s}=this;if(!s)return null;const{layout:e}=s;return"horizontal"===e&&!t||"vertical"===e&&t}get canNext(){const{_ascending:t,min:s,max:e,steps:i,viewModel:o}=this;if(null==t||null==s||null==e||!i?.length||!o)return!1;const{values:r}=o,l=r?.[0];return null==l||(t?l!==i[i.length-1]:l!==i[0])}get canPlay(){return null!=this.viewModel&&!!this.steps?.length&&null!=this.min&&null!=this.max}get canPrevious(){const{_ascending:t,min:s,max:e,steps:i,viewModel:o}=this;if(null==t||null==s||null==e||!i?.length||!o)return!1;const{values:r}=o,l=r?.[0];return null==l||(t?l!==i[0]:l!==i[i.length-1])}render(){const{labels:t,labelFormatFunction:s,min:e,max:i,steps:o,minorTicks:r,majorTicks:l,reversed:n,viewModel:p}=this;if(!p)return u("div",null);const{disabled:c,layout:a}=p,h=`${a}${n?"-reversed":""}`,d="position",j=[];return null!=e&&null!=i&&(r&&j.push({mode:d,values:r,tickCreatedFunction:this._minorTickCreatedFunction}),l&&j.push({mode:d,values:l,tickCreatedFunction:this._majorTickCreatedFunction}),t&&j.push({mode:d,values:t,labelsVisible:!0}),this.visibleElements.steps&&this.steps&&j.push({mode:d,values:this.steps,tickCreatedFunction:this._stepsTickCreatedFunction})),this._slider.set({disabled:c,labelFormatFunction:s,layout:h,min:e,max:i,steps:o,tickConfigs:j}),u("div",{class:m},this._slider.render(),this._renderToolTip())}animate(t){this._step(1,t)}next(){this._step(this._ascending?1:-1)}previous(){this._step(this._ascending?-1:1)}_onTooltipAfterCreate(t){this._tooltip=t}_renderToolTip(){if(!this.visibleElements.thumbTooltip||!this._thumbNode||!this._slider.values)return null;const t=this._slider.viewModel.getLabelForValue(this._slider.values[0],"value");return t?u("calcite-tooltip",{afterCreate:this._onTooltipAfterCreate,class:d.tooltip,label:t,referenceElement:this._thumbNode},t):null}_step(t,s=!1){if(!this.viewModel||!this.steps?.length)return;if(!this.viewModel.values||!this.steps.includes(this.viewModel.values[0]))return void(this.viewModel.values=[this.steps[0]]);const e=this.steps.indexOf(this.viewModel.values[0])+t;e<0||e>=this.steps.length?this.viewModel.loop||s?this.viewModel.values=[this.steps[1===t?0:this.steps.length-1]]:"playing"===this.viewModel.state&&this.viewModel.pause():this.viewModel.values=[this.steps[e]]}};t([o()],v.prototype,"_ascending",null),t([o()],v.prototype,"canNext",null),t([o()],v.prototype,"canPlay",null),t([o()],v.prototype,"canPrevious",null),t([o()],v.prototype,"labelFormatFunction",void 0),t([o()],v.prototype,"labels",void 0),t([o()],v.prototype,"min",void 0),t([o()],v.prototype,"minorTicks",void 0),t([o()],v.prototype,"majorTicks",void 0),t([o()],v.prototype,"max",void 0),t([o({nonNullable:!0})],v.prototype,"reversed",void 0),t([o()],v.prototype,"steps",void 0),t([o()],v.prototype,"type",void 0),t([o({type:h,nonNullable:!0})],v.prototype,"visibleElements",void 0),v=t([r("esri.widgets.ValuePicker.ValuePickerSlider")],v);const k=v;export{k as default};

"use strict";(self.webpackChunkRemoteClient=self.webpackChunkRemoteClient||[]).push([[2090,5777],{93314:(e,t,n)=>{n.d(t,{Z:()=>f});var i,s=n(29768),r=n(12047),o=n(71252),a=n(35197),l=n(34250),h=(n(91306),n(48578),n(97714)),c=n(17533),u=n(2906);n(21972),n(60474),n(66396),n(76506),n(86656),n(92143),n(31450),n(71552),n(40642),n(379),n(62062),n(6540),n(19657),n(91055),n(6906),n(79456),n(50406),n(60991);let d=i=class extends r.wq{static get allTime(){return p}static get empty(){return m}constructor(e){super(e),this.end=null,this.start=null}readEnd(e,t){return null!=t.end?new Date(t.end):null}writeEnd(e,t){t.end=e?e.getTime():null}get isAllTime(){return this.equals(i.allTime)}get isEmpty(){return this.equals(i.empty)}readStart(e,t){return null!=t.start?new Date(t.start):null}writeStart(e,t){t.start=e?e.getTime():null}clone(){return new i({end:this.end,start:this.start})}equals(e){if(!e)return!1;const t=null!=this.start?this.start.getTime():this.start,n=null!=this.end?this.end.getTime():this.end,i=null!=e.start?e.start.getTime():e.start,s=null!=e.end?e.end.getTime():e.end;return t===i&&n===s}expandTo(e){if(this.isEmpty||this.isAllTime)return this.clone();const t=(0,o.c)(this.start,(t=>(0,a.t)(t,e))),n=(0,o.c)(this.end,(t=>{const n=(0,a.t)(t,e);return t.getTime()===n.getTime()?n:(0,a.o)(n,1,e)}));return new i({start:t,end:n})}intersection(e){if(!e)return this.clone();if(this.isEmpty||e.isEmpty)return i.empty;if(this.isAllTime)return e.clone();if(e.isAllTime)return this.clone();const t=this.start?.getTime()??-1/0,n=this.end?.getTime()??1/0,s=e.start?.getTime()??-1/0,r=e.end?.getTime()??1/0;let o,a;if(s>=t&&s<=n?o=s:t>=s&&t<=r&&(o=t),n>=s&&n<=r?a=n:r>=t&&r<=n&&(a=r),null!=o&&null!=a&&!isNaN(o)&&!isNaN(a)){const e=new i;return e.start=o===-1/0?null:new Date(o),e.end=a===1/0?null:new Date(a),e}return i.empty}offset(e,t){if(this.isEmpty||this.isAllTime)return this.clone();const n=new i,{start:s,end:r}=this;return null!=s&&(n.start=(0,a.o)(s,e,t)),null!=r&&(n.end=(0,a.o)(r,e,t)),n}union(e){if(!e||e.isEmpty)return this.clone();if(this.isEmpty)return e.clone();if(this.isAllTime||e.isAllTime)return p.clone();const t=null!=this.start&&null!=e.start?new Date(Math.min(this.start.getTime(),e.start.getTime())):null,n=null!=this.end&&null!=e.end?new Date(Math.max(this.end.getTime(),e.end.getTime())):null;return new i({start:t,end:n})}};(0,s._)([(0,l.Cb)({type:Date,json:{write:{allowNull:!0}}})],d.prototype,"end",void 0),(0,s._)([(0,h.r)("end")],d.prototype,"readEnd",null),(0,s._)([(0,u.w)("end")],d.prototype,"writeEnd",null),(0,s._)([(0,l.Cb)({readOnly:!0,json:{read:!1}})],d.prototype,"isAllTime",null),(0,s._)([(0,l.Cb)({readOnly:!0,json:{read:!1}})],d.prototype,"isEmpty",null),(0,s._)([(0,l.Cb)({type:Date,json:{write:{allowNull:!0}}})],d.prototype,"start",void 0),(0,s._)([(0,h.r)("start")],d.prototype,"readStart",null),(0,s._)([(0,u.w)("start")],d.prototype,"writeStart",null),d=i=(0,s._)([(0,c.j)("esri.TimeExtent")],d);const p=new d,m=new d({start:void 0,end:void 0}),f=d},74395:(e,t,n)=>{n.d(t,{B:()=>a});var i=n(48578),s=n(88994),r=n(92482);const o={minX:0,minY:0,maxX:0,maxY:0};class a{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new s.P(9,(0,i.h)("esri-csp-restrictions")?e=>({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){const e=new Array(this._idByBounds.size);let t=0;this._idByBounds.forEach(((n,i)=>{e[t++]=i})),this._indexInvalid=!1,this._index.clear(),this._index.load(e)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter((e=>this._idByBounds.has(e)))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const e=(0,r.e)();for(const t of this._boundsById.values())t&&(e[0]=Math.min(t[0],e[0]),e[1]=Math.min(t[1],e[1]),e[2]=Math.max(t[2],e[2]),e[3]=Math.max(t[3],e[3]));return e}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(e){const t=this._boundsById.get(e);this._boundsById.delete(e),t&&(this._idByBounds.delete(t),this._indexInvalid||this._index.remove(t))}forEachInBounds(e,t){this._loadIndex(),function(e,t,n){!function(e){o.minX=e[0],o.minY=e[1],o.maxX=e[2],o.maxY=e[3]}(t),e.search(o,n)}(this._index,e,(e=>t(this._idByBounds.get(e))))}get(e){return this._boundsById.get(e)}has(e){return this._boundsById.has(e)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(e,t){if(!this._indexInvalid){const t=this._boundsById.get(e);t&&(this._index.remove(t),this._idByBounds.delete(t))}this._boundsById.set(e,t),t&&(this._idByBounds.set(t,e),this._indexInvalid||(this._boundsToLoad.push(t),this._boundsToLoad.length>5e4&&this._loadIndex()))}}},54179:(e,t,n)=>{n.d(t,{M:()=>g,a:()=>_});var i=n(29768),s=n(21972),r=n(71252),o=n(12047),a=n(76506),l=n(66396),h=n(17533);class c{constructor(){this._propertyOriginMap=new Map,this._originStores=new Array(s.a),this._values=new Map,this.multipleOriginsSupported=!0}clone(e){const t=new c,n=this._originStores[s.O.DEFAULTS];n&&n.forEach(((e,n)=>{t.set(n,(0,a.d9)(e),s.O.DEFAULTS)}));for(let n=s.O.SERVICE;n<s.a;n++){const i=this._originStores[n];i&&i.forEach(((i,s)=>{e&&e.has(s)||t.set(s,(0,a.d9)(i),n)}))}return t}get(e,t){const n=void 0===t?this._values:this._originStores[t];return n?n.get(e):void 0}keys(e){const t=null==e?this._values:this._originStores[e];return t?[...t.keys()]:[]}set(e,t,n=s.O.USER){let i=this._originStores[n];if(i||(i=new Map,this._originStores[n]=i),i.set(e,t),!this._values.has(e)||(0,r.a)(this._propertyOriginMap.get(e))<=n){const i=this._values.get(e);return this._values.set(e,t),this._propertyOriginMap.set(e,n),i!==t}return!1}delete(e,t=s.O.USER){const n=this._originStores[t];if(!n)return;const i=n.get(e);if(n.delete(e),this._values.has(e)&&this._propertyOriginMap.get(e)===t){this._values.delete(e);for(let n=t-1;n>=0;n--){const t=this._originStores[n];if(t&&t.has(e)){this._values.set(e,t.get(e)),this._propertyOriginMap.set(e,n);break}}}return i}has(e,t){const n=void 0===t?this._values:this._originStores[t];return!!n&&n.has(e)}revert(e,t){for(;t>0&&!this.has(e,t);)--t;const n=this._originStores[t],i=n&&n.get(e),s=this._values.get(e);return this._values.set(e,i),this._propertyOriginMap.set(e,t),s!==i}originOf(e){return this._propertyOriginMap.get(e)||s.O.DEFAULTS}forEach(e){this._values.forEach(e)}}const u=e=>{let t=class extends e{constructor(...e){super(...e);const t=(0,r.a)((0,l.g)(this)),n=t.store,i=new c;t.store=i,(0,o.s)(t,n,i)}read(e,t){(0,o.r)(this,e,t)}getAtOrigin(e,t){const n=d(this),i=(0,s.n)(t);if("string"==typeof e)return n.get(e,i);const r={};return e.forEach((e=>{r[e]=n.get(e,i)})),r}originOf(e){return(0,s.b)(this.originIdOf(e))}originIdOf(e){return d(this).originOf(e)}revert(e,t){const n=d(this),i=(0,s.n)(t),r=(0,l.g)(this);let o;o="string"==typeof e?"*"===e?n.keys(i):[e]:e,o.forEach((e=>{r.invalidate(e),n.revert(e,i),r.commit(e)}))}};return t=(0,i._)([(0,h.j)("esri.core.ReadOnlyMultiOriginJSONSupport")],t),t};function d(e){return(0,l.g)(e).store}let p=class extends(u(s.Z)){};p=(0,i._)([(0,h.j)("esri.core.ReadOnlyMultiOriginJSONSupport")],p);const m=e=>{let t=class extends e{constructor(...e){super(...e)}clear(e,t="user"){return f(this).delete(e,(0,s.n)(t))}write(e,t){return(0,o.w)(this,e=e||{},t),e}setAtOrigin(e,t,n){(0,l.g)(this).setAtOrigin(e,t,(0,s.n)(n))}removeOrigin(e){const t=f(this),n=(0,s.n)(e),i=t.keys(n);for(const e of i)t.originOf(e)===n&&t.set(e,t.get(e,n),s.O.USER)}updateOrigin(e,t){const n=f(this),i=(0,s.n)(t),r=this.get(e);for(let t=i+1;t<s.a;++t)n.delete(e,t);n.set(e,r,i)}toJSON(e){return this.write({},e)}};return t=(0,i._)([(0,h.j)("esri.core.WriteableMultiOriginJSONSupport")],t),t.prototype.toJSON.isDefaultToJSON=!0,t};function f(e){return(0,l.g)(e).store}const g=e=>{let t=class extends(m(u(e))){constructor(...e){super(...e)}};return t=(0,i._)([(0,h.j)("esri.core.MultiOriginJSONSupport")],t),t};let _=class extends(g(s.Z)){};_=(0,i._)([(0,h.j)("esri.core.MultiOriginJSONSupport")],_)},89440:(e,t,n)=>{n.d(t,{O:()=>f});var i=n(29768),s=n(60991),r=n(32101),o=n(34250),a=(n(91306),n(48578),n(17533)),l=n(2906),h=n(12047),c=n(43022);const u={ArcGISAnnotationLayer:!0,ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,CSV:!0,GeoRSS:!0,GeoJSON:!0,GroupLayer:!0,KML:!0,MediaLayer:!0,OGCFeatureLayer:!0,OrientedImageryLayer:!0,SubtypeGroupLayer:!0,VectorTileLayer:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},d={ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,WMS:!0,WebTiledLayer:!0,BingMapsAerial:!0,BingMapsRoad:!0,BingMapsHybrid:!0},p={ArcGISFeatureLayer:!0},m={"web-scene/operational-layers":{ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledElevationServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BuildingSceneLayer:!0,GroupLayer:!0,IntegratedMeshLayer:!0,OGCFeatureLayer:!0,PointCloudLayer:!0,WebTiledLayer:!0,CSV:!0,GeoJSON:!0,VectorTileLayer:!0,WFS:!0,WMS:!0,KML:!0,RasterDataLayer:!0,Voxel:!0,LineOfSightLayer:!0},"web-scene/basemap":{ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,WebTiledLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,ArcGISImageServiceLayer:!0,WMS:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0},"web-scene/ground":{ArcGISTiledElevationServiceLayer:!0,RasterDataElevationLayer:!0},"web-map/operational-layers":u,"web-map/basemap":d,"web-map/tables":p,"link-chart/operational-layers":{...u,LinkChartLayer:!0},"link-chart/basemap":d,"link-chart/tables":p,"portal-item/operational-layers":{ArcGISFeatureLayer:!0,ArcGISSceneServiceLayer:!0,PointCloudLayer:!0,BuildingSceneLayer:!0,IntegratedMeshLayer:!0,OrientedImageryLayer:!0}},f=e=>{let t=class extends e{constructor(){super(...arguments),this.title=null}writeListMode(e,t,n,i){(i&&"ground"===i.layerContainerType||e&&(0,h.a)(this,n,{},i))&&(t[n]=e)}writeOperationalLayerType(e,t,n,i){!e||i&&"tables"===i.layerContainerType||(t.layerType=e)}writeTitle(e,t){t.title=e??"Layer"}read(e,t){t&&(t.layer=this),(0,h.b)(this,e,(t=>super.read(e,t)),t)}write(e,t){if(t?.origin){const e=`${t.origin}/${t.layerContainerType||"operational-layers"}`,n=m[e];let i=!!n?.[this.operationalLayerType];if("ArcGISTiledElevationServiceLayer"===this.operationalLayerType&&"web-scene/operational-layers"===e&&(i=!1),"ArcGISDimensionLayer"===this.operationalLayerType&&"web-map/operational-layers"===e&&(i=!1),!i)return t.messages?.push(new s.Z("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${e}'`,{layer:this})),null}const n=super.write(e,{...t,layer:this}),i=!!t&&!!t.messages&&!!t.messages.filter((e=>e instanceof s.Z&&"web-document-write:property-required"===e.name)).length;return(0,r.jc)(n?.url)?(t?.messages?.push(new s.Z("layer:invalid-url",`Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' using a Blob URL cannot be written to web scenes and web maps`,{layer:this})),null):!this.url&&i?null:n}beforeSave(){}};return(0,i._)([(0,o.Cb)({type:String,json:{write:{ignoreOrigin:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0}},"portal-item":{write:!1}}}})],t.prototype,"id",void 0),(0,i._)([(0,o.Cb)(c.b)],t.prototype,"listMode",void 0),(0,i._)([(0,l.w)("listMode")],t.prototype,"writeListMode",null),(0,i._)([(0,o.Cb)({type:String,readOnly:!0,json:{read:!1,write:{target:"layerType",ignoreOrigin:!0},origins:{"portal-item":{write:!1}}}})],t.prototype,"operationalLayerType",void 0),(0,i._)([(0,l.w)("operationalLayerType")],t.prototype,"writeOperationalLayerType",null),(0,i._)([(0,o.Cb)(c.d)],t.prototype,"opacity",void 0),(0,i._)([(0,o.Cb)({type:String,json:{write:{ignoreOrigin:!0,writerEnsuresNonNull:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}},"portal-item":{write:!1}}},value:"Layer"})],t.prototype,"title",void 0),(0,i._)([(0,l.w)("title"),(0,l.w)(["web-scene"],"title")],t.prototype,"writeTitle",null),(0,i._)([(0,o.Cb)({type:Boolean,json:{name:"visibility"}})],t.prototype,"visible",void 0),t=(0,i._)([(0,a.j)("esri.layers.mixins.OperationalLayer")],t),t}},88994:(e,t,n)=>{n.d(t,{P:()=>a});var i=n(48578),s=n(71252),r=n(79456),o=n(98576);class a{constructor(e=9,t){this._compareMinX=u,this._compareMinY=d,this._toBBox=e=>e,this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),t&&("function"==typeof t?this._toBBox=t:this._initFormat(t)),this.clear()}destroy(){this.clear(),v.prune(),x.prune(),b.prune(),w.prune()}all(e){this._all(this._data,e)}search(e,t){let n=this._data;const i=this._toBBox;if(_(e,n))for(v.clear();n;){for(let s=0,r=n.children.length;s<r;s++){const r=n.children[s],o=n.leaf?i(r):r;_(e,o)&&(n.leaf?t(r):g(e,o)?this._all(r,t):v.push(r))}n=v.pop()}}collides(e){let t=this._data;const n=this._toBBox;if(!_(e,t))return!1;for(v.clear();t;){for(let i=0,s=t.children.length;i<s;i++){const s=t.children[i],r=t.leaf?n(s):s;if(_(e,r)){if(t.leaf||g(e,r))return!0;v.push(s)}}t=v.pop()}return!1}load(e){if(!e.length)return this;if(e.length<this._minEntries){for(let t=0,n=e.length;t<n;t++)this.insert(e[t]);return this}let t=this._build(e.slice(0,e.length),0,e.length-1,0);if(this._data.children.length)if(this._data.height===t.height)this._splitRoot(this._data,t);else{if(this._data.height<t.height){const e=this._data;this._data=t,t=e}this._insert(t,this._data.height-t.height-1,!0)}else this._data=t;return this}insert(e){return e&&this._insert(e,this._data.height-1),this}clear(){return this._data=new C([]),this}remove(e){if(!e)return this;let t,n=this._data,r=null,o=0,a=!1;const l=this._toBBox(e);for(b.clear(),w.clear();n||b.length>0;){if(n||(n=(0,s.a)(b.pop()),r=b.data[b.length-1],o=w.pop()??0,a=!0),n.leaf&&(t=(0,i.m)(n.children,e,n.children.length,n.indexHint),-1!==t))return n.children.splice(t,1),b.push(n),this._condense(b),this;a||n.leaf||!g(n,l)?r?(o++,n=r.children[o],a=!1):n=null:(b.push(n),w.push(o),o=0,r=n,n=n.children[0])}return this}toJSON(){return this._data}fromJSON(e){return this._data=e,this}_all(e,t){let n=e;for(x.clear();n;){if(!0===n.leaf)for(const e of n.children)t(e);else x.pushArray(n.children);n=x.pop()??null}}_build(e,t,n,i){const s=n-t+1;let r=this._maxEntries;if(s<=r){const i=new C(e.slice(t,n+1));return l(i,this._toBBox),i}i||(i=Math.ceil(Math.log(s)/Math.log(r)),r=Math.ceil(s/r**(i-1)));const o=new P([]);o.height=i;const a=Math.ceil(s/r),h=a*Math.ceil(Math.sqrt(r));y(e,t,n,h,this._compareMinX);for(let s=t;s<=n;s+=h){const t=Math.min(s+h-1,n);y(e,s,t,a,this._compareMinY);for(let n=s;n<=t;n+=a){const s=Math.min(n+a-1,t);o.children.push(this._build(e,n,s,i-1))}}return l(o,this._toBBox),o}_chooseSubtree(e,t,n,i){for(;i.push(t),!0!==t.leaf&&i.length-1!==n;){let n,i=1/0,o=1/0;for(let a=0,l=t.children.length;a<l;a++){const l=t.children[a],h=p(l),c=(s=e,r=l,(Math.max(r.maxX,s.maxX)-Math.min(r.minX,s.minX))*(Math.max(r.maxY,s.maxY)-Math.min(r.minY,s.minY))-h);c<o?(o=c,i=h<i?h:i,n=l):c===o&&h<i&&(i=h,n=l)}t=n||t.children[0]}var s,r;return t}_insert(e,t,n){const i=this._toBBox,s=n?e:i(e);b.clear();const r=this._chooseSubtree(s,this._data,t,b);for(r.children.push(e),c(r,s);t>=0&&b.data[t].children.length>this._maxEntries;)this._split(b,t),t--;this._adjustParentBBoxes(s,b,t)}_split(e,t){const n=e.data[t],i=n.children.length,s=this._minEntries;this._chooseSplitAxis(n,s,i);const r=this._chooseSplitIndex(n,s,i);if(!r)return void console.log("  Error: assertion failed at PooledRBush._split: no valid split index");const o=n.children.splice(r,n.children.length-r),a=n.leaf?new C(o):new P(o);a.height=n.height,l(n,this._toBBox),l(a,this._toBBox),t?e.data[t-1].children.push(a):this._splitRoot(n,a)}_splitRoot(e,t){this._data=new P([e,t]),this._data.height=e.height+1,l(this._data,this._toBBox)}_chooseSplitIndex(e,t,n){let i,s,r;i=s=1/0;for(let o=t;o<=n-t;o++){const t=h(e,0,o,this._toBBox),a=h(e,o,n,this._toBBox),l=f(t,a),c=p(t)+p(a);l<i?(i=l,r=o,s=c<s?c:s):l===i&&c<s&&(s=c,r=o)}return r}_chooseSplitAxis(e,t,n){const i=e.leaf?this._compareMinX:u,s=e.leaf?this._compareMinY:d;this._allDistMargin(e,t,n,i)<this._allDistMargin(e,t,n,s)&&e.children.sort(i)}_allDistMargin(e,t,n,i){e.children.sort(i);const s=this._toBBox,r=h(e,0,t,s),o=h(e,n-t,n,s);let a=m(r)+m(o);for(let i=t;i<n-t;i++){const t=e.children[i];c(r,e.leaf?s(t):t),a+=m(r)}for(let i=n-t-1;i>=t;i--){const t=e.children[i];c(o,e.leaf?s(t):t),a+=m(o)}return a}_adjustParentBBoxes(e,t,n){for(let i=n;i>=0;i--)c(t.data[i],e)}_condense(e){for(let t=e.length-1;t>=0;t--){const n=e.data[t];if(0===n.children.length)if(t>0){const s=e.data[t-1],r=s.children;r.splice((0,i.m)(r,n,r.length,s.indexHint),1)}else this.clear();else l(n,this._toBBox)}}_initFormat(e){const t=["return a"," - b",";"];this._compareMinX=new Function("a","b",t.join(e[0])),this._compareMinY=new Function("a","b",t.join(e[1])),this._toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}function l(e,t){h(e,0,e.children.length,t,e)}function h(e,t,n,i,s){s||(s=new C([])),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(let r,o=t;o<n;o++)r=e.children[o],c(s,e.leaf?i(r):r);return s}function c(e,t){e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY)}function u(e,t){return e.minX-t.minX}function d(e,t){return e.minY-t.minY}function p(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function m(e){return e.maxX-e.minX+(e.maxY-e.minY)}function f(e,t){const n=Math.max(e.minX,t.minX),i=Math.max(e.minY,t.minY),s=Math.min(e.maxX,t.maxX),r=Math.min(e.maxY,t.maxY);return Math.max(0,s-n)*Math.max(0,r-i)}function g(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function _(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function y(e,t,n,i,r){const a=[t,n];for(;a.length;){const t=(0,s.a)(a.pop()),n=(0,s.a)(a.pop());if(t-n<=i)continue;const l=n+Math.ceil((t-n)/i/2)*i;(0,o.q)(e,l,n,t,r),a.push(n,l,l,t)}}const v=new r.P,x=new r.P,b=new r.P,w=new r.P({deallocator:void 0});class M{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}class S extends M{constructor(){super(...arguments),this.height=1,this.indexHint=new i.P}}class C extends S{constructor(e){super(),this.children=e,this.leaf=!0}}class P extends S{constructor(e){super(),this.children=e,this.leaf=!1}}},23771:(e,t,n)=>{n.d(t,{W:()=>u});var i=n(29768),s=n(21972),r=n(82933),o=n(66396),a=n(58085),l=n(6906),h=n(34250),c=n(17533);let u=class extends s.Z{constructor(){super(...arguments),this.updating=!1,this._handleId=0,this._handles=new r.Z,this._scheduleHandleId=0,this._pendingPromises=new Set}destroy(){this.removeAll(),this._handles.destroy()}add(e,t,n={}){return this._installWatch(e,t,n,a.YP)}addWhen(e,t,n={}){return this._installWatch(e,t,n,a.gx)}addOnCollectionChange(e,t,{initial:n=!1,final:i=!1}={}){const s=++this._handleId;return this._handles.add([(0,a.on)(e,"after-changes",this._createSyncUpdatingCallback(),a.Z_),(0,a.on)(e,"change",t,{onListenerAdd:n?e=>t({added:e.toArray(),removed:[]}):void 0,onListenerRemove:i?e=>t({added:[],removed:e.toArray()}):void 0})],s),(0,o.b)((()=>this._handles.remove(s)))}addPromise(e){if(null==e)return e;const t=++this._handleId;this._handles.add({remove:()=>{this._pendingPromises.delete(e)&&(0!==this._pendingPromises.size||this._handles.has(d)||this._set("updating",!1))}},t),this._pendingPromises.add(e),this._set("updating",!0);const n=()=>this._handles.remove(t);return e.then(n,n),e}removeAll(){this._pendingPromises.clear(),this._handles.removeAll(),this._set("updating",!1)}_installWatch(e,t,n={},i){const s=++this._handleId;n.sync||this._installSyncUpdatingWatch(e,s);const r=i(e,t,n);return this._handles.add(r,s),(0,o.b)((()=>this._handles.remove(s)))}_installSyncUpdatingWatch(e,t){const n=this._createSyncUpdatingCallback(),i=(0,a.YP)(e,n,{sync:!0,equals:()=>!1});return this._handles.add(i,t),i}_createSyncUpdatingCallback(){return()=>{this._handles.remove(d),++this._scheduleHandleId;const e=this._scheduleHandleId;this._get("updating")||this._set("updating",!0),this._handles.add((0,l.Os)((()=>{e===this._scheduleHandleId&&(this._set("updating",this._pendingPromises.size>0),this._handles.remove(d))})),d)}}};(0,i._)([(0,h.Cb)({readOnly:!0})],u.prototype,"updating",void 0),u=(0,i._)([(0,c.j)("esri.core.support.WatchUpdatingTracking")],u);const d=-42},5777:(e,t,n)=>{n.d(t,{c:()=>i,g:()=>s});var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{};function s(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}},10401:(e,t,n)=>{n.d(t,{c:()=>r,r:()=>s});var i=n(15324);function s(e,t,n=i.Z){return t||(t=new n),t===e||(t.removeAll(),(s=e)&&(Array.isArray(s)||"items"in s&&Array.isArray(s.items))?t.addMany(e):e&&t.add(e)),t;var s}function r(e){return e}},26923:(e,t,n)=>{n.d(t,{b:()=>a,c:()=>l,f:()=>s,i:()=>u,m:()=>h,n:()=>c,s:()=>r,t:()=>o});var i=n(29794);function s(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function r(e,t,n,i,s,r,o,a,l,h){return e[0]=t,e[1]=n,e[2]=i,e[3]=s,e[4]=r,e[5]=o,e[6]=a,e[7]=l,e[8]=h,e}function o(e,t){if(e===t){const n=t[1],i=t[2],s=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=i,e[7]=s}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function a(e,t){const n=t[0],i=t[1],s=t[2],r=t[3],o=t[4],a=t[5],l=t[6],h=t[7],c=t[8],u=c*o-a*h,d=-c*r+a*l,p=h*r-o*l;let m=n*u+i*d+s*p;return m?(m=1/m,e[0]=u*m,e[1]=(-c*i+s*h)*m,e[2]=(a*i-s*o)*m,e[3]=d*m,e[4]=(c*n-s*l)*m,e[5]=(-a*n+s*r)*m,e[6]=p*m,e[7]=(-h*n+i*l)*m,e[8]=(o*n-i*r)*m,e):null}function l(e,t){const n=t[0],i=t[1],s=t[2],r=t[3],o=t[4],a=t[5],l=t[6],h=t[7],c=t[8];return e[0]=o*c-a*h,e[1]=s*h-i*c,e[2]=i*a-s*o,e[3]=a*l-r*c,e[4]=n*c-s*l,e[5]=s*r-n*a,e[6]=r*h-o*l,e[7]=i*l-n*h,e[8]=n*o-i*r,e}function h(e,t,n){const i=t[0],s=t[1],r=t[2],o=t[3],a=t[4],l=t[5],h=t[6],c=t[7],u=t[8],d=n[0],p=n[1],m=n[2],f=n[3],g=n[4],_=n[5],y=n[6],v=n[7],x=n[8];return e[0]=d*i+p*o+m*h,e[1]=d*s+p*a+m*c,e[2]=d*r+p*l+m*u,e[3]=f*i+g*o+_*h,e[4]=f*s+g*a+_*c,e[5]=f*r+g*l+_*u,e[6]=y*i+v*o+x*h,e[7]=y*s+v*a+x*c,e[8]=y*r+v*l+x*u,e}function c(e,t){const n=t[0],i=t[1],s=t[2],r=t[3],o=t[4],a=t[5],l=t[6],h=t[7],c=t[8],u=t[9],d=t[10],p=t[11],m=t[12],f=t[13],g=t[14],_=t[15],y=n*a-i*o,v=n*l-s*o,x=n*h-r*o,b=i*l-s*a,w=i*h-r*a,M=s*h-r*l,S=c*f-u*m,C=c*g-d*m,P=c*_-p*m,I=u*g-d*f,L=u*_-p*f,O=d*_-p*g;let A=y*O-v*L+x*I+b*P-w*C+M*S;return A?(A=1/A,e[0]=(a*O-l*L+h*I)*A,e[1]=(l*P-o*O-h*C)*A,e[2]=(o*L-a*P+h*S)*A,e[3]=(s*L-i*O-r*I)*A,e[4]=(n*O-s*P+r*C)*A,e[5]=(i*P-n*L-r*S)*A,e[6]=(f*M-g*w+_*b)*A,e[7]=(g*x-m*M-_*v)*A,e[8]=(m*w-f*x+_*y)*A,e):null}function u(e){const t=(0,i.g)(),n=e[0],s=e[1],r=e[2],o=e[3],a=e[4],l=e[5],h=e[6],c=e[7],u=e[8];return Math.abs(1-(n*n+o*o+h*h))<=t&&Math.abs(1-(s*s+a*a+c*c))<=t&&Math.abs(1-(r*r+l*l+u*u))<=t}},16912:(e,t,n)=>{function i(){return[1,0,0,0,1,0,0,0,1]}function s(e,t,n,i,s,r,o,a,l){return[e,t,n,i,s,r,o,a,l]}function r(e,t){return new Float64Array(e,t,9)}n.d(t,{a:()=>r,c:()=>i,f:()=>s})},94751:(e,t,n)=>{n.d(t,{c:()=>o,g:()=>h,o:()=>a,u:()=>l});var i=n(92896),s=n(60947),r=n(32422);const o={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new i.Z({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:s.Z.WebMercator}),minus180Line:new i.Z({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:s.Z.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new i.Z({paths:[[[180,-180],[180,180]]],spatialReference:s.Z.WGS84}),minus180Line:new i.Z({paths:[[[-180,-180],[-180,180]]],spatialReference:s.Z.WGS84})}};function a(e,t){return Math.ceil((e-t)/(2*t))}function l(e,t){const n=h(e);for(const e of n)for(const n of e)n[0]+=t;return e}function h(e){return(0,r.oU)(e)?e.rings:e.paths}},98576:(e,t,n)=>{n.d(t,{q:()=>a});var i,s,r=n(5777),o={exports:{}};i=o,void 0!==(s=function(){function e(n,i,s,r,o){for(;r>s;){if(r-s>600){var a=r-s+1,l=i-s+1,h=Math.log(a),c=.5*Math.exp(2*h/3),u=.5*Math.sqrt(h*c*(a-c)/a)*(l-a/2<0?-1:1);e(n,i,Math.max(s,Math.floor(i-l*c/a+u)),Math.min(r,Math.floor(i+(a-l)*c/a+u)),o)}var d=n[i],p=s,m=r;for(t(n,s,i),o(n[r],d)>0&&t(n,s,r);p<m;){for(t(n,p,m),p++,m--;o(n[p],d)<0;)p++;for(;o(n[m],d)>0;)m--}0===o(n[s],d)?t(n,s,m):t(n,++m,r),m<=i&&(s=m+1),i<=m&&(r=m-1)}}function t(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function n(e,t){return e<t?-1:e>t?1:0}return function(t,i,s,r,o){e(t,i,s||0,r||t.length-1,o||n)}}())&&(i.exports=s);const a=(0,r.g)(o.exports)},90886:(e,t,n)=>{n.d(t,{g:()=>s});var i=n(32101);function s(e){return r[function(e){return e instanceof Blob?e.type:function(e){const t=(0,i.Ml)(e);return l[t]||o}(e.url)}(e)]||a}const r={},o="text/plain",a=r[o],l={png:"image/png",jpeg:"image/jpeg",jpg:"image/jpg",bmp:"image/bmp",gif:"image/gif",json:"application/json",txt:"text/plain",xml:"application/xml",svg:"image/svg+xml",zip:"application/zip",pbf:"application/vnd.mapbox-vector-tile",gz:"application/gzip","bin.gz":"application/octet-stream"};for(const e in l)r[l[e]]=e},3530:(e,t,n)=>{function i(e){return(t,n)=>{t[n]=e}}n.d(t,{s:()=>i})},35197:(e,t,n)=>{n.d(t,{c:()=>a,o:()=>r,t:()=>o}),n(48578);const i={milliseconds:1,seconds:1e3,minutes:6e4,hours:36e5,days:864e5,weeks:6048e5,months:26784e5,years:31536e6,decades:31536e7,centuries:31536e8},s={milliseconds:{getter:"getMilliseconds",setter:"setMilliseconds",multiplier:1},seconds:{getter:"getSeconds",setter:"setSeconds",multiplier:1},minutes:{getter:"getMinutes",setter:"setMinutes",multiplier:1},hours:{getter:"getHours",setter:"setHours",multiplier:1},days:{getter:"getDate",setter:"setDate",multiplier:1},weeks:{getter:"getDate",setter:"setDate",multiplier:7},months:{getter:"getMonth",setter:"setMonth",multiplier:1},years:{getter:"getFullYear",setter:"setFullYear",multiplier:1},decades:{getter:"getFullYear",setter:"setFullYear",multiplier:10},centuries:{getter:"getFullYear",setter:"setFullYear",multiplier:100}};function r(e,t,n){const i=new Date(e.getTime());if(t&&n){const e=s[n],{getter:r,setter:o,multiplier:a}=e;if("months"===n){const e=function(e,t){const n=new Date(e,t+1,1);return n.setDate(0),n.getDate()}(i.getFullYear(),i.getMonth()+t);i.getDate()>e&&i.setDate(e)}i[o](i[r]()+t*a)}return i}function o(e,t){switch(t){case"milliseconds":return new Date(e.getTime());case"seconds":return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds());case"minutes":return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes());case"hours":return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours());case"days":return new Date(e.getFullYear(),e.getMonth(),e.getDate());case"weeks":return new Date(e.getFullYear(),e.getMonth(),e.getDate()-e.getDay());case"months":return new Date(e.getFullYear(),e.getMonth(),1);case"years":return new Date(e.getFullYear(),0,1);case"decades":return new Date(e.getFullYear()-e.getFullYear()%10,0,1);case"centuries":return new Date(e.getFullYear()-e.getFullYear()%100,0,1);default:return new Date}}function a(e,t,n){return 0===e?0:e*i[t]/i[n]}},10279:(e,t,n)=>{n.d(t,{a:()=>r,g:()=>s});const i="randomUUID"in crypto;function s(){if(i)return crypto.randomUUID();const e=crypto.getRandomValues(new Uint16Array(8));e[3]=4095&e[3]|16384,e[4]=16383&e[4]|32768;const t=t=>e[t].toString(16).padStart(4,"0");return t(0)+t(1)+"-"+t(2)+"-"+t(3)+"-"+t(4)+"-"+t(5)+t(6)+t(7)}function r(){return`{${s()}}`}},47880:(e,t,n)=>{function i(e,t,n){return e[0]=t,e[1]=n,e}function s(e,t){const n=t[0]-e[0],i=t[1]-e[1];return Math.sqrt(n*n+i*i)}function r(e,t,n,i){const s=t[0],r=t[1];return e[0]=s+i*(n[0]-s),e[1]=r+i*(n[1]-r),e}function o(e,t,n){const i=t[0],s=t[1];return e[0]=n[0]*i+n[2]*s+n[4],e[1]=n[1]*i+n[3]*s+n[5],e}function a(e,t,n,i){const s=t[0]-n[0],r=t[1]-n[1],o=Math.sin(i),a=Math.cos(i);return e[0]=s*a-r*o+n[0],e[1]=s*o+r*a+n[1],e}n.d(t,{d:()=>s,l:()=>r,r:()=>a,s:()=>i,t:()=>o}),n(29794)},32191:(e,t,n)=>{function i(){return[0,0]}function s(e,t){return[e,t]}function r(e,t){return new Float64Array(e,t,2)}n.d(t,{a:()=>i,c:()=>r,f:()=>s}),s(1,0)},15324:(e,t,n)=>{n.d(t,{Z:()=>E});var i,s,r,o=n(29768),a=n(91055),l=n(75067),h=n(76506),c=n(71252),u=n(379),d=n(6906),p=n(91306),m=n(6540),f=n(34250),g=n(3530),_=n(17533),y=n(89914);n(21972),n(60474),n(66396),n(86656),n(48578),n(92143),n(31450),n(71552),n(40642),n(62062),n(19657),n(79456),n(50406),n(60991),(r=i||(i={}))[r.ADD=1]="ADD",r[r.REMOVE=2]="REMOVE",r[r.MOVE=4]="MOVE";const v=new u.O(class{constructor(){this.target=null,this.cancellable=!1,this.defaultPrevented=!1,this.item=void 0,this.type=void 0}preventDefault(){this.cancellable&&(this.defaultPrevented=!0)}reset(e){this.defaultPrevented=!1,this.item=e}},void 0,(e=>{e.item=null,e.target=null,e.defaultPrevented=!1,e.cancellable=!1})),x=()=>{};function b(e){return e?e instanceof A?e.toArray():e.length?Array.prototype.slice.apply(e):[]:[]}function w(e){if(e&&e.length)return e[0]}function M(e,t,n,i){const s=Math.min(e.length-n,t.length-i);let r=0;for(;r<s&&e[n+r]===t[i+r];)r++;return r}function S(e,t,n,i){t&&t.forEach(((t,s,r)=>{e.push(t),S(e,n.call(i,t,s,r),n,i)}))}const C=new Set,P=new Set,I=new Set,L=new Map;let O=0,A=s=class extends l.Z.EventedAccessor{static isCollection(e){return null!=e&&e instanceof s}constructor(e){super(e),this._chgListeners=[],this._notifications=null,this._timer=null,this._observable=new y.S,this.length=0,this._items=[],Object.defineProperty(this,"uid",{value:O++})}normalizeCtorArgs(e){return e?Array.isArray(e)||e instanceof s?{items:e}:e:{}}destroy(){this._removeAllRaw()}*[Symbol.iterator](){yield*this.items}get items(){return(0,m.t)(this._observable),this._items}set items(e){this._emitBeforeChanges(i.ADD)||(this._splice(0,this.length,b(e)),this._emitAfterChanges(i.ADD))}hasEventListener(e){return"change"===e?this._chgListeners.length>0:this._emitter.hasEventListener(e)}on(e,t){if("change"===e){const e=this._chgListeners,n={removed:!1,callback:t};return e.push(n),this._notifications&&this._notifications.push({listeners:e.slice(),items:this._items.slice(),changes:[]}),{remove(){this.remove=x,n.removed=!0,e.splice(e.indexOf(n),1)}}}return this._emitter.on(e,t)}once(e,t){const n=this.on(e,t);return{remove(){n.remove()}}}add(e,t){if((0,m.t)(this._observable),this._emitBeforeChanges(i.ADD))return this;const n=this.getNextIndex(t??null);return this._splice(n,0,[e]),this._emitAfterChanges(i.ADD),this}addMany(e,t=this._items.length){if((0,m.t)(this._observable),!e||!e.length)return this;if(this._emitBeforeChanges(i.ADD))return this;const n=this.getNextIndex(t);return this._splice(n,0,b(e)),this._emitAfterChanges(i.ADD),this}at(e){if((0,m.t)(this._observable),(e=Math.trunc(e)||0)<0&&(e+=this.length),!(e<0||e>=this.length))return this._items[e]}removeAll(){if((0,m.t)(this._observable),!this.length||this._emitBeforeChanges(i.REMOVE))return[];const e=this._removeAllRaw();return this._emitAfterChanges(i.REMOVE),e}_removeAllRaw(){return 0===this.length?[]:this._splice(0,this.length)||[]}clone(){return(0,m.t)(this._observable),this._createNewInstance({items:this._items.map(h.d9)})}concat(...e){(0,m.t)(this._observable);const t=e.map(b);return this._createNewInstance({items:this._items.concat(...t)})}drain(e,t){if((0,m.t)(this._observable),!this.length||this._emitBeforeChanges(i.REMOVE))return;const n=(0,c.a)(this._splice(0,this.length)),s=n.length;for(let i=0;i<s;i++)e.call(t,n[i],i,n);this._emitAfterChanges(i.REMOVE)}every(e,t){return(0,m.t)(this._observable),this._items.every(e,t)}filter(e,t){let n;return(0,m.t)(this._observable),n=2===arguments.length?this._items.filter(e,t):this._items.filter(e),this._createNewInstance({items:n})}find(e,t){return(0,m.t)(this._observable),this._items.find(e,t)}findIndex(e,t){return(0,m.t)(this._observable),this._items.findIndex(e,t)}flatten(e,t){(0,m.t)(this._observable);const n=[];return S(n,this,e,t),new s(n)}forEach(e,t){return(0,m.t)(this._observable),this._items.forEach(e,t)}getItemAt(e){return(0,m.t)(this._observable),this._items[e]}getNextIndex(e){(0,m.t)(this._observable);const t=this.length;return(e=e??t)<0?e=0:e>t&&(e=t),e}includes(e,t=0){return(0,m.t)(this._observable),this._items.includes(e,t)}indexOf(e,t=0){return(0,m.t)(this._observable),this._items.indexOf(e,t)}join(e=","){return(0,m.t)(this._observable),this._items.join(e)}lastIndexOf(e,t=this.length-1){return(0,m.t)(this._observable),this._items.lastIndexOf(e,t)}map(e,t){(0,m.t)(this._observable);const n=this._items.map(e,t);return new s({items:n})}reorder(e,t=this.length-1){(0,m.t)(this._observable);const n=this.indexOf(e);if(-1!==n){if(t<0?t=0:t>=this.length&&(t=this.length-1),n!==t){if(this._emitBeforeChanges(i.MOVE))return e;this._splice(n,1),this._splice(t,0,[e]),this._emitAfterChanges(i.MOVE)}return e}}pop(){if((0,m.t)(this._observable),!this.length||this._emitBeforeChanges(i.REMOVE))return;const e=w(this._splice(this.length-1,1));return this._emitAfterChanges(i.REMOVE),e}push(...e){return(0,m.t)(this._observable),this._emitBeforeChanges(i.ADD)||(this._splice(this.length,0,e),this._emitAfterChanges(i.ADD)),this.length}reduce(e,t){(0,m.t)(this._observable);const n=this._items;return 2===arguments.length?n.reduce(e,t):n.reduce(e)}reduceRight(e,t){(0,m.t)(this._observable);const n=this._items;return 2===arguments.length?n.reduceRight(e,t):n.reduceRight(e)}remove(e){return(0,m.t)(this._observable),this.removeAt(this.indexOf(e))}removeAt(e){if((0,m.t)(this._observable),e<0||e>=this.length||this._emitBeforeChanges(i.REMOVE))return;const t=w(this._splice(e,1));return this._emitAfterChanges(i.REMOVE),t}removeMany(e){if((0,m.t)(this._observable),!e||!e.length||this._emitBeforeChanges(i.REMOVE))return[];const t=e instanceof s?e.toArray():e,n=this._items,r=[],o=t.length;for(let e=0;e<o;e++){const i=t[e],s=n.indexOf(i);if(s>-1){const i=1+M(t,n,e+1,s+1),o=this._splice(s,i);o&&o.length>0&&r.push.apply(r,o),e+=i-1}}return this._emitAfterChanges(i.REMOVE),r}reverse(){if((0,m.t)(this._observable),this._emitBeforeChanges(i.MOVE))return this;const e=this._splice(0,this.length);return e&&(e.reverse(),this._splice(0,0,e)),this._emitAfterChanges(i.MOVE),this}shift(){if((0,m.t)(this._observable),!this.length||this._emitBeforeChanges(i.REMOVE))return;const e=w(this._splice(0,1));return this._emitAfterChanges(i.REMOVE),e}slice(e=0,t=this.length){return(0,m.t)(this._observable),this._createNewInstance({items:this._items.slice(e,t)})}some(e,t){return(0,m.t)(this._observable),this._items.some(e,t)}sort(e){if((0,m.t)(this._observable),!this.length||this._emitBeforeChanges(i.MOVE))return this;const t=(0,c.a)(this._splice(0,this.length));return arguments.length?t.sort(e):t.sort(),this._splice(0,0,t),this._emitAfterChanges(i.MOVE),this}splice(e,t,...n){(0,m.t)(this._observable);const s=(t?i.REMOVE:0)|(n.length?i.ADD:0);if(this._emitBeforeChanges(s))return[];const r=this._splice(e,t,n)||[];return this._emitAfterChanges(s),r}toArray(){return(0,m.t)(this._observable),this._items.slice()}toJSON(){return(0,m.t)(this._observable),this.toArray()}toLocaleString(){return(0,m.t)(this._observable),this._items.toLocaleString()}toString(){return(0,m.t)(this._observable),this._items.toString()}unshift(...e){return(0,m.t)(this._observable),!e.length||this._emitBeforeChanges(i.ADD)||(this._splice(0,0,e),this._emitAfterChanges(i.ADD)),this.length}_createNewInstance(e){return new this.constructor(e)}_splice(e,t,n){const i=this._items,s=this.itemType;let r,o;if(!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._timer=(0,d.Os)((()=>this._dispatchChange()))),t){if(o=i.splice(e,t),this.hasEventListener("before-remove")){const t=v.acquire();t.target=this,t.cancellable=!0;for(let n=0,s=o.length;n<s;n++)r=o[n],t.reset(r),this.emit("before-remove",t),t.defaultPrevented&&(o.splice(n,1),i.splice(e,0,r),e+=1,n-=1,s-=1);v.release(t)}if(this.length=this._items.length,this.hasEventListener("after-remove")){const e=v.acquire();e.target=this,e.cancellable=!1;const t=o.length;for(let n=0;n<t;n++)e.reset(o[n]),this.emit("after-remove",e);v.release(e)}}if(n&&n.length){if(s){const e=[];for(const t of n){const n=s.ensureType(t);null==n&&null!=t||e.push(n)}n=e}const t=this.hasEventListener("before-add"),r=this.hasEventListener("after-add"),o=e===this.length;if(t||r){const s=v.acquire();s.target=this,s.cancellable=!0;const a=v.acquire();a.target=this,a.cancellable=!1;for(const l of n)t?(s.reset(l),this.emit("before-add",s),s.defaultPrevented||(o?i.push(l):i.splice(e++,0,l),this._set("length",i.length),r&&(a.reset(l),this.emit("after-add",a)))):(o?i.push(l):i.splice(e++,0,l),this._set("length",i.length),a.reset(l),this.emit("after-add",a));v.release(a),v.release(s)}else{if(o)for(const e of n)i.push(e);else i.splice(e,0,...n);this._set("length",i.length)}}return(n&&n.length||o&&o.length)&&this._notifyChangeEvent(n,o),o}_emitBeforeChanges(e){let t=!1;if(this.hasEventListener("before-changes")){const n=v.acquire();n.target=this,n.cancellable=!0,n.type=e,this.emit("before-changes",n),t=n.defaultPrevented,v.release(n)}return t}_emitAfterChanges(e){if(this.hasEventListener("after-changes")){const t=v.acquire();t.target=this,t.cancellable=!1,t.type=e,this.emit("after-changes",t),v.release(t)}this._observable.notify()}_notifyChangeEvent(e,t){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-1].changes.push({added:e,removed:t})}_dispatchChange(){if(this._timer&&(this._timer.remove(),this._timer=null),!this._notifications)return;const e=this._notifications;this._notifications=null;for(const t of e){const e=t.changes;C.clear(),P.clear(),I.clear();for(const{added:t,removed:n}of e){if(t)if(0===I.size&&0===P.size)for(const e of t)C.add(e);else for(const e of t)P.has(e)?(I.add(e),P.delete(e)):I.has(e)||C.add(e);if(n)if(0===I.size&&0===C.size)for(const e of n)P.add(e);else for(const e of n)C.has(e)?C.delete(e):(I.delete(e),P.add(e))}const n=a.A.acquire();C.forEach((e=>{n.push(e)}));const i=a.A.acquire();P.forEach((e=>{i.push(e)}));const s=this._items,r=t.items,o=a.A.acquire();if(I.forEach((e=>{r.indexOf(e)!==s.indexOf(e)&&o.push(e)})),t.listeners&&(n.length||i.length||o.length)){const e={target:this,added:n,removed:i,moved:o},s=t.listeners.length;for(let n=0;n<s;n++){const i=t.listeners[n];i.removed||i.callback.call(this,e)}}a.A.release(n),a.A.release(i),a.A.release(o)}C.clear(),P.clear(),I.clear()}};A.ofType=e=>{if(!e)return s;if(L.has(e))return L.get(e);let t=null;if("function"==typeof e)t=e.prototype.declaredClass;else if(e.base)t=e.base.prototype.declaredClass;else for(const n in e.typeMap){const i=e.typeMap[n].prototype.declaredClass;t?t+=` | ${i}`:t=i}let n=class extends s{};return(0,o._)([(0,g.s)({Type:e,ensureType:"function"==typeof e?(0,p.e)(e):(0,p.a)(e)})],n.prototype,"itemType",void 0),n=(0,o._)([(0,_.j)(`esri.core.Collection<${t}>`)],n),L.set(e,n),n},(0,o._)([(0,f.Cb)()],A.prototype,"length",void 0),(0,o._)([(0,f.Cb)()],A.prototype,"items",null),A=s=(0,o._)([(0,_.j)("esri.core.Collection")],A);const E=A},95873:(e,t,n)=>{n.d(t,{p:()=>h,r:()=>c});var i=n(29768),s=n(21972),r=n(82933),o=n(34250),a=n(17533),l=n(23771);n(60474),n(66396),n(76506),n(48578),n(86656),n(92143),n(31450),n(71552),n(40642),n(379),n(62062),n(6540),n(19657),n(91055),n(6906),n(79456),n(50406),n(60991),n(91306),n(58085);const h=e=>{let t=class extends e{constructor(){super(...arguments),this._handles=new r.Z,this._updatingHandles=new l.W}destroy(){this.destroyed||(this._handles.destroy(),this._updatingHandles.destroy())}get handles(){return this._handles}get updatingHandles(){return this._updatingHandles}};return(0,i._)([(0,o.Cb)({readOnly:!0})],t.prototype,"handles",null),(0,i._)([(0,o.Cb)({readOnly:!0})],t.prototype,"updatingHandles",null),t=(0,i._)([(0,a.j)("esri.core.HandleOwner")],t),t};let c=class extends(h(s.Z)){};c=(0,i._)([(0,a.j)("esri.core.HandleOwner")],c)},58085:(e,t,n)=>{n.d(t,{N1:()=>u,YP:()=>a,Z_:()=>m,gx:()=>l,nn:()=>f,on:()=>c,tX:()=>g});var i=n(50406),s=n(66396),r=n(71252),o=n(19657);function a(e,t,n={}){return h(e,t,n,d)}function l(e,t,n={}){return h(e,t,n,p)}function h(e,t,n={},i){let s=null;const a=n.once?(e,n)=>{i(e)&&((0,r.r)(s),t(e,n))}:(e,n)=>{i(e)&&t(e,n)};if(s=(0,o.b)(e,a,n.sync,n.equals),n.initial){const t=e();a(t,t)}return s}function c(e,t,n,o={}){let l=null,h=null,c=null;function u(){l&&h&&(h.remove(),o.onListenerRemove?.(l),l=null,h=null)}function d(e){o.once&&o.once&&(0,r.r)(c),n(e)}const p=a(e,((e,n)=>{u(),(0,i.i)(e)&&(l=e,h=(0,i.o)(e,t,d),o.onListenerAdd?.(e))}),{sync:o.sync,initial:!0});return c=(0,s.b)((()=>{p.remove(),u()})),c}function u(e,t){return function(e,t,n){if((0,i.Hc)(n))return Promise.reject((0,i.zE)());const o=e();if(t?.(o))return Promise.resolve(o);let a=null;function l(){a=(0,r.r)(a)}return new Promise(((r,o)=>{a=(0,s.h)([(0,i.fu)(n,(()=>{l(),o((0,i.zE)())})),h(e,(e=>{l(),r(e)}),{sync:!1,once:!0},t??d)])}))}(e,p,t)}function d(e){return!0}function p(e){return!!e}n(60991),n(76506),n(48578),n(92143),n(31450),n(71552),n(40642),n(91055),n(379),n(6906),n(79456),n(60474),n(6540);const m={sync:!0},f={initial:!0},g={sync:!0,initial:!0}},22090:(e,t,n)=>{n.r(t),n.d(t,{default:()=>nt});var i=n(29768),s=n(15324),r=n(60991),o=n(92143),a=n(54179),l=n(34250),h=n(86787),c=(n(48578),n(97714)),u=n(17533),d=n(2906),p=n(41617),m=n(80462),f=n(89440),g=n(6416),_=n(82058),y=n(32101),v=n(10279),x=(n(91306),n(3296)),b=n(12047),w=n(81184),M=n(21972),S=n(26923),C=n(16912),P=n(47880),I=n(72836);const L=(0,n(66106).c)(),O=(0,C.c)(),A=(0,C.c)(),E=(0,C.c)();function R(e,t,n){return(0,I.s)(L,t[0],t[1],1),(0,I.t)(L,L,(0,S.t)(O,n)),0===L[2]?(0,P.s)(e,L[0],L[1]):(0,P.s)(e,L[0]/L[2],L[1]/L[2])}function T(e,t,n){return B(A,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]),B(E,n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]),(0,S.m)(e,(0,S.c)(A,A),E),0!==e[8]&&(e[0]/=e[8],e[1]/=e[8],e[2]/=e[8],e[3]/=e[8],e[4]/=e[8],e[5]/=e[8],e[6]/=e[8],e[7]/=e[8],e[8]/=e[8]),e}function B(e,t,n,i,s,r,o,a,l){(0,S.s)(e,t,i,r,n,s,o,1,1,1),(0,I.s)(L,a,l,1),(0,S.c)(O,e);const[h,c,u]=(0,I.t)(L,L,(0,S.t)(O,O));return(0,S.s)(O,h,0,0,0,c,0,0,0,u),(0,S.m)(e,O,e)}var D=n(99403),j=n(32191),Y=n(91597),Z=n(44567),X=n(1623),V=n(60947),G=n(66122);let N=class extends G.j{projectOrWarn(e,t){if(null==e)return e;const{geometry:n,pending:i}=(0,X.dz)(e,t);return i?null:i||n?n:(o.L.getLogger(this).warn("geometry could not be projected to the spatial reference",{georeference:this,geometry:e,sourceSpatialReference:e.spatialReference,targetSpatialReference:t}),null)}};N=(0,i._)([(0,u.j)("esri.layers.support.GeoreferenceBase")],N);const F=N;n(60474),n(66396),n(76506),n(86656),n(379),n(62062),n(6540),n(19657),n(91055),n(6906),n(79456);var H=n(50406),W=(n(71552),n(31450),n(40642),n(29794)),z=(n(73796),n(53785)),k=(n(57251),n(35132),n(21801)),U=n(98380),q=n(92482),J=n(82426);n(7200),n(89914),n(65775),n(84069),n(12381),n(73173),n(88762),n(92896),n(92624),n(92847);const $=(0,C.c)(),K=(0,j.a)();let Q=class extends M.Z{constructor(){super(...arguments),this.sourcePoint=null,this.mapPoint=null}};(0,i._)([(0,l.Cb)()],Q.prototype,"sourcePoint",void 0),(0,i._)([(0,l.Cb)({type:Y.Z})],Q.prototype,"mapPoint",void 0),Q=(0,i._)([(0,u.j)("esri.layers.support.ControlPoint")],Q);let ee=class extends((0,b.eC)(F)){constructor(e){super(e),this.controlPoints=null,this.height=0,this.type="control-points",this.width=0}readControlPoints(e,t){const n=V.Z.fromJSON(t.spatialReference),i=(0,C.f)(...t.coefficients,1);return e.map((e=>((0,P.s)(K,e.x,e.y),R(K,K,i),{sourcePoint:e,mapPoint:new Y.Z({x:K[0],y:K[1],spatialReference:n})})))}writeControlPoints(e,t,n,i){if(null!=this.transform)null!=e&&te(e[0])&&(t.controlPoints=e.map((e=>{const t=e.sourcePoint;return{x:t.x,y:t.y}})),t.spatialReference=e[0].mapPoint.spatialReference.toJSON(),t.coefficients=this.transform.slice(0,8));else{const e=new r.Z("web-document-write:invalid-georeference","Invalid 'controlPoints', 'width', 'height' configuration.",{layer:i?.layer,georeference:this});i?.messages?i.messages.push(e):o.L.getLogger(this).error(e.name,e.message)}}get coords(){if(null==this.controlPoints)return null;const e=this._updateTransform($);if(null==e||!te(this.controlPoints[0]))return null;const t=this.controlPoints[0].mapPoint.spatialReference;return function(e,t,n,i){const s=(0,j.f)(0,n),r=(0,j.f)(0,0),o=(0,j.f)(t,0),a=(0,j.f)(t,n);return R(s,s,e),R(r,r,e),R(o,o,e),R(a,a,e),new Z.Z({rings:[[s,r,o,a,s]],spatialReference:i})}(e,this.width,this.height,t)}set coords(e){if(null==this.controlPoints||!te(this.controlPoints[0]))return;const t=this.controlPoints[0].mapPoint.spatialReference;if(null==(e=this.projectOrWarn(e,t)))return;const{width:n,height:i}=this,{rings:[[s,r,o,a]]}=e,l={sourcePoint:(0,D.c)(0,i),mapPoint:new Y.Z({x:s[0],y:s[1],spatialReference:t})},h={sourcePoint:(0,D.c)(0,0),mapPoint:new Y.Z({x:r[0],y:r[1],spatialReference:t})},c={sourcePoint:(0,D.c)(n,0),mapPoint:new Y.Z({x:o[0],y:o[1],spatialReference:t})},u={sourcePoint:(0,D.c)(n,i),mapPoint:new Y.Z({x:a[0],y:a[1],spatialReference:t})};te(l)&&te(h)&&te(c)&&te(u)&&(de($,l,h,c,u),this.controlPoints=this.controlPoints.map((({sourcePoint:e})=>((0,P.s)(K,e.x,e.y),R(K,K,$),{sourcePoint:e,mapPoint:new Y.Z({x:K[0],y:K[1],spatialReference:t})}))))}get inverseTransform(){return null==this.transform?null:(0,S.b)((0,C.c)(),this.transform)}get transform(){return this._updateTransform()}toMap(e){if(null==e||null==this.transform||null==this.controlPoints||!te(this.controlPoints[0]))return null;(0,P.s)(K,e.x,e.y);const t=this.controlPoints[0].mapPoint.spatialReference;return R(K,K,this.transform),new Y.Z({x:K[0],y:K[1],spatialReference:t})}toSource(e){if(null==e||null==this.inverseTransform||null==this.controlPoints||!te(this.controlPoints[0]))return null;const t=this.controlPoints[0].mapPoint.spatialReference;return e=e.normalize(),null==(e=(0,X.dz)(e,t).geometry)?null:((0,P.s)(K,e.x,e.y),R(K,K,this.inverseTransform),(0,D.c)(K[0],K[1]))}_updateTransform(e){const{controlPoints:t,width:n,height:i}=this;if(!(null!=t&&n>0&&i>0))return null;const[s,r,o,a]=t;if(!te(s))return null;const l=s.mapPoint.spatialReference,h=this._projectControlPoint(r,l),c=this._projectControlPoint(o,l),u=this._projectControlPoint(a,l);if(!h.valid||!c.valid||!u.valid)return null;if(!te(h.controlPoint))return null;null==e&&(e=(0,C.c)());let d=null;return d=te(c.controlPoint)&&te(u.controlPoint)?de(e,s,h.controlPoint,c.controlPoint,u.controlPoint):te(c.controlPoint)?function(e,t,n,i){return ue(ne,oe,t),ue(ie,ae,n),ue(se,le,i),(0,P.l)(re,ne,ie,.5),(0,P.r)(re,se,re,Math.PI),(0,P.l)(he,oe,ae,.5),(0,P.r)(he,le,he,Math.PI),ge(e,ne,ie,se,re,oe,ae,le,he)}(e,s,h.controlPoint,c.controlPoint):function(e,t,n){return ue(ne,oe,t),ue(ie,ae,n),(0,P.r)(se,ie,ne,ce),(0,P.r)(re,ne,ie,ce),(0,P.r)(le,ae,oe,-ce),(0,P.r)(he,oe,ae,-ce),ge(e,ne,ie,se,re,oe,ae,le,he)}(e,s,h.controlPoint),d.every((e=>0===e))?null:d}_projectControlPoint(e,t){if(!te(e))return{valid:!0,controlPoint:e};const{sourcePoint:n,mapPoint:i}=e,{geometry:s,pending:r}=(0,X.dz)(i,t);return r?{valid:!1,controlPoint:null}:r||s?{valid:!0,controlPoint:{sourcePoint:n,mapPoint:s}}:(o.L.getLogger(this).warn("map point could not be projected to the spatial reference",{georeference:this,controlPoint:e,sourceSpatialReference:i.spatialReference,targetSpatialReference:t}),{valid:!1,controlPoint:null})}};function te(e){return null!=e&&null!=e.sourcePoint&&null!=e.mapPoint}(0,i._)([(0,l.Cb)({type:[Q],json:{write:{allowNull:!1,isRequired:!0}}})],ee.prototype,"controlPoints",void 0),(0,i._)([(0,c.r)("controlPoints")],ee.prototype,"readControlPoints",null),(0,i._)([(0,d.w)("controlPoints")],ee.prototype,"writeControlPoints",null),(0,i._)([(0,l.Cb)()],ee.prototype,"coords",null),(0,i._)([(0,l.Cb)({json:{write:!0}})],ee.prototype,"height",void 0),(0,i._)([(0,l.Cb)({readOnly:!0})],ee.prototype,"inverseTransform",null),(0,i._)([(0,l.Cb)({readOnly:!0})],ee.prototype,"transform",null),(0,i._)([(0,l.Cb)({json:{write:!0}})],ee.prototype,"width",void 0),ee=(0,i._)([(0,u.j)("esri.layers.support.ControlPointsGeoreference")],ee);const ne=(0,j.a)(),ie=(0,j.a)(),se=(0,j.a)(),re=(0,j.a)(),oe=(0,j.a)(),ae=(0,j.a)(),le=(0,j.a)(),he=(0,j.a)(),ce=Math.PI/2;function ue(e,t,n){(0,P.s)(e,n.sourcePoint.x,n.sourcePoint.y),(0,P.s)(t,n.mapPoint.x,n.mapPoint.y)}function de(e,t,n,i,s){return ue(ne,oe,t),ue(ie,ae,n),ue(se,le,i),ue(re,he,s),ge(e,ne,ie,se,re,oe,ae,le,he)}const pe=new Array(8).fill(0),me=new Array(8).fill(0);function fe(e,t,n,i,s){return e[0]=t[0],e[1]=t[1],e[2]=n[0],e[3]=n[1],e[4]=i[0],e[5]=i[1],e[6]=s[0],e[7]=s[1],e}function ge(e,t,n,i,s,r,o,a,l){return T(e,fe(pe,t,n,i,s),fe(me,r,o,a,l))}const _e=ee;let ye=class extends F{constructor(e){super(e),this.bottomLeft=null,this.bottomRight=null,this.topLeft=null,this.topRight=null,this.type="corners"}get coords(){let{topLeft:e,topRight:t,bottomLeft:n,bottomRight:i}=this;if(null==e||null==t||null==n||null==i)return null;const s=e.spatialReference;return t=this.projectOrWarn(t,s),n=this.projectOrWarn(n,s),i=this.projectOrWarn(i,s),null==t||null==n||null==i?null:new Z.Z({rings:[[[n.x,n.y],[e.x,e.y],[t.x,t.y],[i.x,i.y],[n.x,n.y]]],spatialReference:s})}set coords(e){const{topLeft:t}=this;if(null==t)return;const n=t.spatialReference;if(null==(e=this.projectOrWarn(e,n)))return;const{rings:[[i,s,r,o]]}=e;this.bottomLeft=new Y.Z({x:i[0],y:i[1],spatialReference:n}),this.topLeft=new Y.Z({x:s[0],y:s[1],spatialReference:n}),this.topRight=new Y.Z({x:r[0],y:r[1],spatialReference:n}),this.bottomRight=new Y.Z({x:o[0],y:o[1],spatialReference:n})}};(0,i._)([(0,l.Cb)()],ye.prototype,"coords",null),(0,i._)([(0,l.Cb)({type:Y.Z})],ye.prototype,"bottomLeft",void 0),(0,i._)([(0,l.Cb)({type:Y.Z})],ye.prototype,"bottomRight",void 0),(0,i._)([(0,l.Cb)({type:Y.Z})],ye.prototype,"topLeft",void 0),(0,i._)([(0,l.Cb)({type:Y.Z})],ye.prototype,"topRight",void 0),ye=(0,i._)([(0,u.j)("esri.layers.support.CornersGeoreference")],ye);const ve=ye;let xe=class extends F{constructor(e){super(e),this.extent=null,this.rotation=0,this.type="extent-and-rotation"}get coords(){if(null==this.extent)return null;const{xmin:e,ymin:t,xmax:n,ymax:i,spatialReference:s}=this.extent;let r;if(this.rotation){const{x:s,y:o}=this.extent.center,a=be(s,o,this.rotation);r=[a(e,t),a(e,i),a(n,i),a(n,t)],r.push(r[0])}else r=[[e,t],[e,i],[n,i],[n,t],[e,t]];return new Z.Z({rings:[r],spatialReference:s})}set coords(e){if(null==e||null==this.extent)return;const t=this.extent.spatialReference;if(null==(e=this.projectOrWarn(e,t))||null==e.extent)return;const{rings:[[n,i,s]],extent:{center:{x:r,y:o}}}=e,a=(0,J.r)(Math.PI/2-Math.atan2(i[1]-n[1],i[0]-n[0])),l=be(r,o,-a),[h,c]=l(n[0],n[1]),[u,d]=l(s[0],s[1]);this.extent=new k.Z({xmin:h,ymin:c,xmax:u,ymax:d,spatialReference:t}),this.rotation=a}};function be(e,t,n){const i=(0,W.t)(n),s=Math.cos(i),r=Math.sin(i);return(n,i)=>[s*(n-e)+r*(i-t)+e,s*(i-t)-r*(n-e)+t]}(0,i._)([(0,l.Cb)()],xe.prototype,"coords",null),(0,i._)([(0,l.Cb)({type:k.Z})],xe.prototype,"extent",void 0),(0,i._)([(0,l.Cb)({type:Number})],xe.prototype,"rotation",void 0),xe=(0,i._)([(0,u.j)("esri.layers.support.ExtentAndRotationGeoreference")],xe);const we=xe;var Me=n(33101);const Se={key:"type",base:F,typeMap:{"control-points":_e,corners:ve,"extent-and-rotation":we}};let Ce=class extends((0,x.iv)((0,b.eC)(w.Z))){constructor(e){super(e),this.georeference=null,this.opacity=1}readGeoreference(e){return _e.fromJSON(e)}};(0,i._)([(0,l.Cb)({types:Se,json:{write:!0}})],Ce.prototype,"georeference",void 0),(0,i._)([(0,c.r)("georeference")],Ce.prototype,"readGeoreference",null),(0,i._)([(0,l.Cb)()],Ce.prototype,"opacity",void 0),Ce=(0,i._)([(0,u.j)("esri.layers.support.MediaElementBase")],Ce);const Pe=Ce;var Ie=n(90886),Le=n(38742);let Oe=class extends Pe{constructor(e){super(e),this.content=null,this.image=null,this.type="image",this.image=null}load(){const e=this.image;if("string"==typeof e){const t=(0,_.default)(e,{responseType:"image"}).then((({data:e})=>{this._set("content",e)}));this.addResolvingPromise(t)}else if(e instanceof HTMLImageElement){const t=e.decode().then((()=>{this._set("content",e)}));this.addResolvingPromise(t)}else e?this._set("content",e):this.addResolvingPromise(Promise.reject(new r.Z("image-element:invalid-image-type","Invalid image type",{image:e})));return Promise.resolve(this)}readImage(e,t,n){return(0,Le.f)(t.url,n)}writeImage(e,t,n,i){if(null==e)return;const s=i?.portalItem,r=i?.resources;if(!s||!r)return void("string"==typeof e&&(t[n]=(0,Le.t)(e,i)));const o="string"!=typeof e||(0,y.HK)(e)||(0,y.jc)(e)?null:e;if(o){if(null==(0,Le.i)(o))return void(t[n]=o);const e=(0,Le.t)(o,{...i,verifyItemRelativeUrls:i&&i.verifyItemRelativeUrls?{writtenUrls:i.verifyItemRelativeUrls.writtenUrls,rootPath:void 0}:void 0},Le.M.NO);if(s&&e&&!(0,y.YP)(e))return r.toKeep.push({resource:s.resourceFromPath(e),compress:!1}),void(t[n]=e)}t[n]="<pending>",r.pendingOperations.push(Ee(e).then((e=>{const i=function(e,t){const n=(0,v.g)(),i=`${(0,y.v_)("media",n)}.${(0,Ie.g)(e)}`;return t.resourceFromPath(i)}(e,s);t[n]=i.itemRelativeUrl,r.toAdd.push({resource:i,content:e,compress:!1,finish:e=>{this.image=e.url}})})))}};(0,i._)([(0,l.Cb)({readOnly:!0})],Oe.prototype,"content",void 0),(0,i._)([(0,l.Cb)({json:{name:"url",type:String}})],Oe.prototype,"image",void 0),(0,i._)([(0,c.r)("image",["url"])],Oe.prototype,"readImage",null),(0,i._)([(0,d.w)("image")],Oe.prototype,"writeImage",null),(0,i._)([(0,l.Cb)({readOnly:!0,json:{name:"mediaType"}})],Oe.prototype,"type",void 0),Oe=(0,i._)([(0,u.j)("esri.layers.support.ImageElement")],Oe);const Ae=Oe;async function Ee(e){if("string"==typeof e){if((0,y.jc)(e)){const{data:t}=await(0,_.default)(e,{responseType:"blob"});return t}return(0,y.HK)(e)?(0,y.fw)(e):Ee((await(0,_.default)(e,{responseType:"image"})).data)}return new Promise((t=>function(e){if(e instanceof HTMLCanvasElement)return e;const t=e instanceof HTMLImageElement?e.naturalWidth:e.width,n=e instanceof HTMLImageElement?e.naturalHeight:e.height,i=document.createElement("canvas"),s=i.getContext("2d");return i.width=t,i.height=n,e instanceof HTMLImageElement?s.drawImage(e,0,0,e.width,e.height):e instanceof ImageData&&s.putImageData(e,0,0),i}(e).toBlob(t)))}n(74569);var Re=n(10401),Te=n(75067),Be=n(95873),De=n(58085),je=n(74395),Ye=n(32422),Ze=n(94751);function Xe(e,t,n){if(Array.isArray(e)){const i=e[0];if(i>t){const n=(0,Ze.o)(i,t);e[0]=i+n*(-2*t)}else if(i<n){const t=(0,Ze.o)(i,n);e[0]=i+t*(-2*n)}}else{const i=e.x;if(i>t){const n=(0,Ze.o)(i,t);e.x+=n*(-2*t)}else if(i<n){const t=(0,Ze.o)(i,n);e.x+=t*(-2*n)}}return e}function Ve(e,t){const[n,i]=t.valid,s=2*i;let r,o=0;return e>i?(r=Math.ceil(Math.abs(e-i)/s),e-=r*s,o=r):e<n&&(r=Math.ceil(Math.abs(e-n)/s),e+=r*s,o=-r),{x:e,frameId:o}}function Ge(e,t){const{xmin:n,ymin:i,xmax:s,ymax:r}=t;return Ne(e,n,i)&&Ne(e,n,r)&&Ne(e,s,r)&&Ne(e,s,i)}function Ne(e,t,n){return t>=e.xmin&&t<=e.xmax&&n>=e.ymin&&n<=e.ymax}function Fe(e,t,n=!0){const i=!(0,Ye.l9)(e);if(i&&(0,Z.c)(e),n)return(new ze).cut(e,t);const s=i?e.rings:e.paths,r=i?4:2,o=s.length,a=-2*t;for(let e=0;e<o;e++){const t=s[e];if(t&&t.length>=r){const e=[];for(const n of t)e.push([n[0]+a,n[1]]);s.push(e)}}return i?e.rings=s:e.paths=s,e}class He{constructor(e,t){this.extent=e,this.frameIds=t}}const We=(0,q.c)();class ze{constructor(){this._linesIn=[],this._linesOut=[]}cut(e,t){let n;if(this._xCut=t,e.rings)this._closed=!0,n=e.rings,this._minPts=4;else{if(!e.paths)return null;this._closed=!1,n=e.paths,this._minPts=2}for(const e of n){if(!e||e.length<this._minPts)continue;let t=!0;for(const n of e)t?(this.moveTo(n),t=!1):this.lineTo(n);this._closed&&this.close()}this._pushLineIn(),this._pushLineOut(),n=[];for(const e of this._linesIn)e&&e.length>=this._minPts&&n.push(e);const i=-2*this._xCut;for(const e of this._linesOut)if(e&&e.length>=this._minPts){for(const t of e)t[0]+=i;n.push(e)}return this._closed?e.rings=n:e.paths=n,e}moveTo(e){this._pushLineIn(),this._pushLineOut(),this._prevSide=this._side(e[0]),this._moveTo(e[0],e[1],this._prevSide),this._prevPt=e,this._firstPt=e}lineTo(e){const t=this._side(e[0]);if(t*this._prevSide==-1){const n=this._intersect(this._prevPt,e);this._lineTo(this._xCut,n,0),this._prevSide=0,this._lineTo(e[0],e[1],t)}else this._lineTo(e[0],e[1],t);this._prevSide=t,this._prevPt=e}close(){const e=this._firstPt,t=this._prevPt;e[0]===t[0]&&e[1]===t[1]||this.lineTo(e),this._checkClosingPt(this._lineIn),this._checkClosingPt(this._lineOut)}_moveTo(e,t,n){this._closed?(this._lineIn.push([n<=0?e:this._xCut,t]),this._lineOut.push([n>=0?e:this._xCut,t])):(n<=0&&this._lineIn.push([e,t]),n>=0&&this._lineOut.push([e,t]))}_lineTo(e,t,n){this._closed?(this._addPolyVertex(this._lineIn,n<=0?e:this._xCut,t),this._addPolyVertex(this._lineOut,n>=0?e:this._xCut,t)):n<0?(0===this._prevSide&&this._pushLineOut(),this._lineIn.push([e,t])):n>0?(0===this._prevSide&&this._pushLineIn(),this._lineOut.push([e,t])):this._prevSide<0?(this._lineIn.push([e,t]),this._lineOut.push([e,t])):this._prevSide>0&&(this._lineOut.push([e,t]),this._lineIn.push([e,t]))}_addPolyVertex(e,t,n){const i=e.length;i>1&&e[i-1][0]===t&&e[i-2][0]===t?e[i-1][1]=n:e.push([t,n])}_checkClosingPt(e){const t=e.length;t>3&&e[0][0]===this._xCut&&e[t-2][0]===this._xCut&&e[1][0]===this._xCut&&(e[0][1]=e[t-2][1],e.pop())}_side(e){return e<this._xCut?-1:e>this._xCut?1:0}_intersect(e,t){const n=(this._xCut-e[0])/(t[0]-e[0]);return e[1]+n*(t[1]-e[1])}_pushLineIn(){this._lineIn&&this._lineIn.length>=this._minPts&&this._linesIn.push(this._lineIn),this._lineIn=[]}_pushLineOut(){this._lineOut&&this._lineOut.length>=this._minPts&&this._linesOut.push(this._lineOut),this._lineOut=[]}}let ke=class extends M.Z{constructor(e){super(e)}get bounds(){const e=this.coords;return null==e||null==e.extent?null:(0,q.h)(e.extent)}get coords(){const e=this.element.georeference?.coords;return(0,X.dz)(e,this.spatialReference).geometry}get normalizedCoords(){return Z.Z.fromJSON(function(e,t){if(null==e)return null;const n=e.spatialReference,i=(0,z.h)(n),s="toJSON"in e?e.toJSON():e;if(!i)return s;const r=(0,z.b)(n)?102100:4326,o=Ze.c[r].maxX,a=Ze.c[r].minX;if((0,Ye.wp)(s))return Xe(s,o,a);if((0,Ye.aW)(s))return s.points=s.points.map((e=>Xe(e,o,a))),s;if((0,Ye.YX)(s))return function(e,t){if(!t)return e;const n=function(e,t){const n=[],{ymin:i,ymax:s,xmin:r,xmax:o}=e,a=e.xmax-e.xmin,[l,h]=t.valid,{x:c,frameId:u}=Ve(e.xmin,t),{x:d,frameId:p}=Ve(e.xmax,t),m=c===d&&a>0;if(a>2*h){const e={xmin:r<o?c:d,ymin:i,xmax:h,ymax:s},t={xmin:l,ymin:i,xmax:r<o?d:c,ymax:s},a={xmin:0,ymin:i,xmax:h,ymax:s},m={xmin:l,ymin:i,xmax:0,ymax:s},f=[],g=[];Ge(e,a)&&f.push(u),Ge(e,m)&&g.push(u),Ge(t,a)&&f.push(p),Ge(t,m)&&g.push(p);for(let e=u+1;e<p;e++)f.push(e),g.push(e);n.push(new He(e,[u]),new He(t,[p]),new He(a,f),new He(m,g))}else c>d||m?n.push(new He({xmin:c,ymin:i,xmax:h,ymax:s},[u]),new He({xmin:l,ymin:i,xmax:d,ymax:s},[p])):n.push(new He({xmin:c,ymin:i,xmax:d,ymax:s},[u]));return n}(e,t).map((e=>e.extent));return n.length<2?n[0]||e:n.length>2?(e.xmin=t.valid[0],e.xmax=t.valid[1],e):{rings:n.map((e=>[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]))}}(s,i);if((0,Ye.oU)(s)||(0,Ye.l9)(s)){const e=(0,U.d)(We,s),n={xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3]},i=(0,Ze.o)(n.xmin,a)*(2*o),r=0===i?s:(0,Ze.u)(s,i);return n.xmin+=i,n.xmax+=i,n.xmax>o?Fe(r,o,t):n.xmin<a?Fe(r,a,t):r}return s}(this.coords,!0))}get normalizedBounds(){const e=null!=this.normalizedCoords?this.normalizedCoords.extent:null;return null!=e?(0,q.h)(e):null}};(0,i._)([(0,l.Cb)()],ke.prototype,"spatialReference",void 0),(0,i._)([(0,l.Cb)()],ke.prototype,"element",void 0),(0,i._)([(0,l.Cb)()],ke.prototype,"bounds",null),(0,i._)([(0,l.Cb)()],ke.prototype,"coords",null),(0,i._)([(0,l.Cb)()],ke.prototype,"normalizedCoords",null),(0,i._)([(0,l.Cb)()],ke.prototype,"normalizedBounds",null),ke=(0,i._)([(0,u.j)("esri.layers.support.MediaElementView")],ke);let Ue=class extends Pe{constructor(e){super(e),this.content=null,this.type="video"}load(){const e=this.video;if("string"==typeof e){const t=document.createElement("video");t.src=e,t.crossOrigin="anonymous",t.autoplay=!0,t.muted=!0,t.loop=!0,this.addResolvingPromise(this._loadVideo(t).then((()=>{this._set("content",t)})))}else e instanceof HTMLVideoElement?this.addResolvingPromise(this._loadVideo(e).then((()=>{this._set("content",e)}))):this.addResolvingPromise(Promise.reject(new r.Z("video-element:invalid-video-type","Invalid video type",{video:e})));return Promise.resolve(this)}set video(e){"not-loaded"===this.loadStatus?this._set("video",e):o.L.getLogger(this).error("#video","video cannot be changed after the element is loaded.")}_loadVideo(e){return new Promise(((t,n)=>{e.oncanplay=()=>{e.oncanplay=null,e.play().then(t,n)},"anonymous"!==e.crossOrigin&&(e.crossOrigin="anonymous",e.src=e.src)}))}};(0,i._)([(0,l.Cb)({readOnly:!0})],Ue.prototype,"content",void 0),(0,i._)([(0,l.Cb)()],Ue.prototype,"video",null),Ue=(0,i._)([(0,u.j)("esri.layers.support.VideoElement")],Ue);const qe=Ue;n(22781),n(23771),n(88994),n(98576),n(5777);const Je={key:"type",defaultKeyValue:"image",base:Pe,typeMap:{image:Ae,video:qe}},$e=s.Z.ofType(Je);let Ke=class extends(w.Z.LoadableMixin((0,Me.v)((0,Be.p)(Te.Z.EventedAccessor)))){constructor(e){super(e),this._index=new je.B,this._elementViewsMap=new Map,this._elementsIndexes=new Map,this._elementsChangedHandler=e=>{for(const t of e.removed){const e=this._elementViewsMap.get(t);this._elementViewsMap.delete(t),this._index.delete(e),this.handles.remove(e),e.destroy(),this.notifyChange("fullExtent")}const{spatialReference:t}=this;for(const n of e.added){if(this._elementViewsMap.get(n))continue;const e=new ke({spatialReference:t,element:n});this._elementViewsMap.set(n,e);const i=(0,De.YP)((()=>e.coords),(()=>this._updateIndexForElement(e,!1)));this._updateIndexForElement(e,!0),this.handles.add(i,e)}this._elementsIndexes.clear(),this.elements.forEach(((e,t)=>this._elementsIndexes.set(e,t))),this.emit("refresh")},this.elements=new $e}async load(e){if((0,H.k_)(e),!this.spatialReference){const e=this.elements.find((e=>null!=e.georeference&&null!=e.georeference.coords));this._set("spatialReference",e?e.georeference.coords.spatialReference:V.Z.WGS84)}return this._elementsChangedHandler({added:this.elements.items,removed:[]}),this.handles.add(this.elements.on("change",this._elementsChangedHandler)),this}destroy(){this._index.clear(),this._elementViewsMap.clear(),this._elementsIndexes.clear()}set elements(e){this._set("elements",(0,Re.r)(e,this._get("elements"),$e))}get fullExtent(){if("not-loaded"===this.loadStatus)return null;const e=this._index.fullBounds;return null==e?null:new k.Z({xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:this.spatialReference})}set spatialReference(e){"not-loaded"===this.loadStatus?this._set("spatialReference",e):o.L.getLogger(this).error("#spatialReference","spatialReference cannot be changed after the source is loaded.")}async queryElements(e,t){await this.load(),await(0,X.initializeProjection)(e.spatialReference,this.spatialReference,null,t);const n=(0,z.f)(e.spatialReference,this.spatialReference)?e:(0,X.iV)(e,this.spatialReference);if(!n)return[];const i=n.normalize(),s=[];for(const e of i)this._index.forEachInBounds((0,q.h)(e),(({normalizedCoords:t,element:n})=>{null!=t&&(0,k.c)(e,t)&&s.push(n)}));return s.sort(((e,t)=>this._elementsIndexes.get(e)-this._elementsIndexes.get(t))),s}_updateIndexForElement(e,t){const n=e.normalizedBounds,i=this._index.has(e),s=null!=n;this._index.delete(e),s&&this._index.set(e,n),this.notifyChange("fullExtent"),t||(i!==s?this.emit("refresh"):this.emit("change",{element:e.element}))}};(0,i._)([(0,l.Cb)()],Ke.prototype,"elements",null),(0,i._)([(0,l.Cb)({readOnly:!0})],Ke.prototype,"fullExtent",null),(0,i._)([(0,l.Cb)()],Ke.prototype,"spatialReference",null),Ke=(0,i._)([(0,u.j)("esri.layers.support.LocalMediaElementSource")],Ke);const Qe=Ke;function et(e){return"object"==typeof e&&null!=e&&"type"in e}n(92200),n(65949),n(54174),n(43022),n(93314),n(35197),n(1557),n(47842),n(14249),n(60217),n(17298),n(85557),n(34394);let tt=class extends((0,m.h)((0,g.M)((0,f.O)((0,a.M)(p.Z))))){constructor(e){super(e),this.effectiveSource=null,this.copyright=null,this.operationalLayerType="MediaLayer",this.spatialReference=null,this.type="media",this.source=new Qe}load(e){const t=this.source;if(!t)return this.addResolvingPromise(Promise.reject(new r.Z("media-layer:source-missing","Set 'MediaLayer.source' before loading the layer."))),Promise.resolve(this);const n=et(t)?new Qe({elements:new s.Z([t])}):t;this._set("effectiveSource",n),this.spatialReference&&(n.spatialReference=this.spatialReference);const i=n.load(e).then((()=>{this.spatialReference=n.spatialReference}));return this.addResolvingPromise(i),Promise.resolve(this)}destroy(){this.effectiveSource?.destroy(),this.source?.destroy()}get fullExtent(){return this.loaded?this.effectiveSource.fullExtent:null}set source(e){"not-loaded"===this.loadStatus?this._set("source",e):o.L.getLogger(this).error("#source","source cannot be changed after the layer is loaded.")}castSource(e){return e?Array.isArray(e)?new Qe({elements:new s.Z(e)}):e instanceof s.Z?new Qe({elements:e}):e:null}readSource(e,t,n){const i="image"===t.mediaType?new Ae:"video"===t.mediaType?new qe:null;return i?.read(t,n),i}writeSource(e,t,n,i){e&&et(e)&&"image"===e.type?e.write(t,i):i?.messages&&i?.messages?.push(new r.Z("media-layer:unsupported-source","source must be an 'ImageElement'"))}};(0,i._)([(0,l.Cb)({readOnly:!0})],tt.prototype,"effectiveSource",void 0),(0,i._)([(0,l.Cb)({type:String})],tt.prototype,"copyright",void 0),(0,i._)([(0,l.Cb)({readOnly:!0})],tt.prototype,"fullExtent",null),(0,i._)([(0,l.Cb)({type:["MediaLayer"]})],tt.prototype,"operationalLayerType",void 0),(0,i._)([(0,l.Cb)({type:["show","hide"]})],tt.prototype,"listMode",void 0),(0,i._)([(0,l.Cb)({nonNullable:!0,json:{write:{enabled:!0,allowNull:!1}}})],tt.prototype,"source",null),(0,i._)([(0,h.p)("source")],tt.prototype,"castSource",null),(0,i._)([(0,c.r)("source",["url"])],tt.prototype,"readSource",null),(0,i._)([(0,d.w)("source")],tt.prototype,"writeSource",null),(0,i._)([(0,l.Cb)()],tt.prototype,"spatialReference",void 0),(0,i._)([(0,l.Cb)({readOnly:!0})],tt.prototype,"type",void 0),tt=(0,i._)([(0,u.j)("esri.layers.MediaLayer")],tt);const nt=tt}}]);
"use strict";(self.webpackChunkRemoteClient=self.webpackChunkRemoteClient||[]).push([[4403,2058,3173],{13457:(e,t,r)=>{var n;r.d(t,{B:()=>n}),function(e){e[e.KILOBYTES=1024]="KILOBYTES",e[e.MEGABYTES=1048576]="MEGABYTES",e[e.GIGABYTES=1073741824]="GIGABYTES"}(n||(n={}))},97987:(e,t,r)=>{r.d(t,{a:()=>o,c:()=>a,d:()=>i,n:()=>s,t:()=>c});var n=r(48578);function s(e,t=!1){return e<=n.N?t?new Array(e).fill(0):new Array(e):new Float64Array(e)}function o(e){return((0,n.p)(e)?e.length:e.byteLength/8)<=n.N?Array.from(e):new Float64Array(e)}function i(e,t,r){return Array.isArray(e)?e.slice(t,t+r):e.subarray(t,t+r)}function a(e,t){for(let r=0;r<t.length;++r)e[r]=t[r];return e}function c(e){return Array.isArray(e)?new Float64Array(e):e}},64403:(e,t,r)=>{r.r(t),r.d(t,{M:()=>u,S:()=>L,a:()=>v,f:()=>O,i:()=>x,s:()=>S});var n,s,o,i,a,c,u,l,f=r(60947),h=r(97987),d=r(66705),m=r(46961),p=r(45274),y=r(79641),b=r(73173);function g(e){return(0,b.g)(`esri/libs/i3s/${e}`)}let w,M,_;function S(e){const t=e.modifications,r=_._malloc(8*t.length),n=new Float64Array(_.HEAPU8.buffer,r,t.length);for(let e=0;e<t.length;++e)n[e]=t[e];_.setModifications(e.context,r,t.length,e.isGeodetic),_._free(r)}function E(e,t){if(!_)return null;const{context:r,localOrigin:n,globalTrafo:s,mbs:o,obb:i,elevationOffset:a,geometryBuffer:u,geometryDescriptor:l,indexToVertexProjector:f,vertexToRenderProjector:h}=e,d=_._malloc(u.byteLength),m=_._malloc(33*Float64Array.BYTES_PER_ELEMENT),p=new Uint8Array(_.HEAPU8.buffer,d,u.byteLength);p.set(new Uint8Array(u));const y=new Float64Array(_.HEAPU8.buffer,m,33);T(y,n);let b=y.byteOffset+3*y.BYTES_PER_ELEMENT,g=new Float64Array(y.buffer,b);T(g,s),b+=16*y.BYTES_PER_ELEMENT,g=new Float64Array(y.buffer,b),T(g,o),b+=4*y.BYTES_PER_ELEMENT,null!=i&&(g=new Float64Array(y.buffer,b),T(g,i.center),b+=3*y.BYTES_PER_ELEMENT,g=new Float64Array(y.buffer,b),T(g,i.halfSize),b+=3*y.BYTES_PER_ELEMENT,g=new Float64Array(y.buffer,b),T(g,i.quaternion));const w=l,M={isDraco:!1,isLegacy:!1,color:e.layouts.some((e=>e.some((e=>"color"===e.name)))),normal:e.needNormals&&e.layouts.some((e=>e.some((e=>"normalCompressed"===e.name)))),uv0:e.layouts.some((e=>e.some((e=>"uv0"===e.name)))),uvRegion:e.layouts.some((e=>e.some((e=>"uvRegion"===e.name)))),featureIndex:w.featureIndex},S=_.process(r,!!e.obb,d,p.byteLength,w,M,m,a,f,h,e.normalReferenceFrame);if(_._free(m),_._free(d),S.error.length>0)throw new Error(`i3s.wasm: ${S.error}`);if(S.discarded)return null;const E=S.componentOffsets.length>0?S.componentOffsets.slice():null,v=S.featureIds.length>0?S.featureIds.slice():null,O=S.anchorIds.length>0?Array.from(S.anchorIds):null,P=S.anchors.length>0?Array.from(S.anchors):null,x=S.interleavedVertedData.slice().buffer,A=S.indicesType===c.Int16?new Uint16Array(S.indices.buffer,S.indices.byteOffset,S.indices.byteLength/2).slice():new Uint32Array(S.indices.buffer,S.indices.byteOffset,S.indices.byteLength/4).slice(),L=S.positions.slice(),C=S.positionIndicesType===c.Int16?new Uint16Array(S.positionIndices.buffer,S.positionIndices.byteOffset,S.positionIndices.byteLength/2).slice():new Uint32Array(S.positionIndices.buffer,S.positionIndices.byteOffset,S.positionIndices.byteLength/4).slice(),q={layout:e.layouts[0],interleavedVertexData:x,indices:A,hasColors:S.hasColors,hasModifications:S.hasModifications,positionData:{data:L,indices:C}};return v&&t.push(v.buffer),E&&t.push(E.buffer),t.push(x),t.push(A.buffer),t.push(L.buffer),t.push(C.buffer),{componentOffsets:E,featureIds:v,anchorIds:O,anchors:P,transformedGeometry:q,obb:S.obb}}function v(e){return 0===e?s.Unmodified:1===e?s.PotentiallyModified:2===e?s.Culled:s.Unknown}function O(e){const{context:t,buffer:r}=e,n=_._malloc(r.byteLength),s=r.byteLength/Float64Array.BYTES_PER_ELEMENT,o=new Float64Array(_.HEAPU8.buffer,n,s),i=new Float64Array(r);o.set(i),_.filterOBBs(t,n,s),i.set(o),_._free(n)}function P(e){_&&(_.destroy(e),_=null)}function T(e,t){for(let r=0;r<t.length;++r)e[r]=t[r]}function x(){return _?Promise.resolve():(M||(M=(w||(w=new Promise((e=>r.e(2599).then(r.bind(r,92599)).then((e=>e.i)).then((({default:t})=>{const r=t({locateFile:g,onRuntimeInitialized:()=>e(r)});delete r.then})))).catch((e=>{throw e}))),w).then((e=>{_=e,M=null}))),M)}r(60939),(l=n||(n={}))[l.Unmodified=0]="Unmodified",l[l.Culled=1]="Culled",l[l.NotChecked=2]="NotChecked",function(e){e[e.Unmodified=0]="Unmodified",e[e.PotentiallyModified=1]="PotentiallyModified",e[e.Culled=2]="Culled",e[e.Unknown=3]="Unknown",e[e.NotChecked=4]="NotChecked"}(s||(s={})),function(e){e[e.Unknown=0]="Unknown",e[e.Uncached=1]="Uncached",e[e.Cached=2]="Cached"}(o||(o={})),function(e){e[e.None=0]="None",e[e.MaxScreenThreshold=1]="MaxScreenThreshold",e[e.ScreenSpaceRelative=2]="ScreenSpaceRelative",e[e.RemovedFeatureDiameter=3]="RemovedFeatureDiameter",e[e.DistanceRangeFromDefaultCamera=4]="DistanceRangeFromDefaultCamera"}(i||(i={})),function(e){e[e.Hole=0]="Hole",e[e.Leaf=1]="Leaf"}(a||(a={})),function(e){e[e.None=0]="None",e[e.Int16=1]="Int16",e[e.Int32=2]="Int32"}(c||(c={})),function(e){e[e.Replace=0]="Replace",e[e.Outside=1]="Outside",e[e.Inside=2]="Inside",e[e.Finished=3]="Finished"}(u||(u={}));const A={transform:E,destroy:P},L=Object.freeze(Object.defineProperty({__proto__:null,destroyContext:function(e){P(e)},dracoDecompressPointCloudData:async function(e){await x();const t=[e.geometryBuffer],{geometryBuffer:r}=e,n=r.byteLength,s=_._malloc(n),o=new Uint8Array(_.HEAPU8.buffer,s,n);o.set(new Uint8Array(r));const i=_.dracoDecompressPointCloudData(s,o.byteLength);if(_._free(s),i.error.length>0)throw new Error(`i3s.wasm: ${i.error}`);const a=i.featureIds?.length>0?i.featureIds.slice():null,c=i.positions.slice();return a&&t.push(a.buffer),t.push(c.buffer),{result:{positions:c,featureIds:a},transferList:t}},filterObbsForModifications:async function(e){await x(),O(e);const t={buffer:e.buffer};return{result:t,transferList:[t.buffer]}},filterObbsForModificationsSync:O,initialize:x,interpretObbModificationResults:v,process:async function(e){await x();const t=[e.geometryBuffer];return{result:E(e,t),transferList:t}},project:async function(e){const{localMatrix:t,origin:n,positions:s,vertexSpace:o,local:i}=e,a=f.Z.fromJSON(e.inSpatialReference),c=f.Z.fromJSON(e.outSpatialReference),u={georeferenced:m.Z,georeferencedRelative:d.Z,local:p.Z}[o.type].fromJSON(o);let l;if("georeferenced"===u.type){const{projectBuffer:e,initializeProjection:t}=await Promise.all([r.e(1623),r.e(243),r.e(9914)]).then(r.bind(r,1623));await t(a,c),l=new Float64Array(s.length),e(s,a,0,l,c,0,l.length/3)}else{const{project:e}=await Promise.all([r.e(1623),r.e(243),r.e(4017),r.e(1796)]).then(r.bind(r,84017)).then((e=>e.d));l=(0,h.t)(e({positions:s,transform:t?{localMatrix:t}:void 0,vertexSpace:u,inSpatialReference:a,outSpatialReference:c,local:i}))}const y=l.length,[b,g,w]=n;for(let e=0;e<y;e+=3)l[e]-=b,l[e+1]-=g,l[e+2]-=w;return{result:{projected:l,original:s},transferList:[l.buffer,s.buffer]}},setLegacySchema:async function(e){await x(),_.setLegacySchema(e.context,e.jsonSchema)},setModifications:async function(e){await x(),S(e)},setModificationsSync:S,test:A,transformNormals:async function({normalMatrix:e,normals:t}){const r=new Float32Array(t.length);return(0,y.a)(r,t,e),(0,y.n)(r,r),{result:{transformed:r,original:t},transferList:[r.buffer,t.buffer]}}},Symbol.toStringTag,{value:"Module"}))},73173:(e,t,r)=>{r.d(t,{g:()=>c});var n=r(31450),s=(r(82058),r(60991)),o=r(92143),i=r(32101);const a=o.L.getLogger("esri.assets");function c(e){if(!n.default.assetsPath)throw a.errorOnce("The API assets location needs to be set using config.assetsPath. More information: https://arcg.is/1OzLe50"),new s.Z("assets:path-not-set","config.assetsPath is not set");return(0,i.v_)(n.default.assetsPath,e)}},16912:(e,t,r)=>{function n(){return[1,0,0,0,1,0,0,0,1]}function s(e,t,r,n,s,o,i,a,c){return[e,t,r,n,s,o,i,a,c]}function o(e,t){return new Float64Array(e,t,9)}r.d(t,{a:()=>o,c:()=>n,f:()=>s})},65775:(e,t,r)=>{r.d(t,{C:()=>f,D:()=>m,a:()=>d,b:()=>p,c:()=>a,d:()=>b,e:()=>y,f:()=>h,g:()=>l,i:()=>o,k:()=>w,l:()=>g,m:()=>c,n:()=>u,s:()=>s,t:()=>i});var n=r(29794);function s(e,t,r,n,s,o,i,a,c,u,l,f,h,d,m,p,y){return e[0]=t,e[1]=r,e[2]=n,e[3]=s,e[4]=o,e[5]=i,e[6]=a,e[7]=c,e[8]=u,e[9]=l,e[10]=f,e[11]=h,e[12]=d,e[13]=m,e[14]=p,e[15]=y,e}function o(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function i(e,t){if(e===t){const r=t[1],n=t[2],s=t[3],o=t[6],i=t[7],a=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=o,e[11]=t[14],e[12]=s,e[13]=i,e[14]=a}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function a(e,t){const r=t[0],n=t[1],s=t[2],o=t[3],i=t[4],a=t[5],c=t[6],u=t[7],l=t[8],f=t[9],h=t[10],d=t[11],m=t[12],p=t[13],y=t[14],b=t[15],g=r*a-n*i,w=r*c-s*i,M=r*u-o*i,_=n*c-s*a,S=n*u-o*a,E=s*u-o*c,v=l*p-f*m,O=l*y-h*m,P=l*b-d*m,T=f*y-h*p,x=f*b-d*p,A=h*b-d*y;let L=g*A-w*x+M*T+_*P-S*O+E*v;return L?(L=1/L,e[0]=(a*A-c*x+u*T)*L,e[1]=(s*x-n*A-o*T)*L,e[2]=(p*E-y*S+b*_)*L,e[3]=(h*S-f*E-d*_)*L,e[4]=(c*P-i*A-u*O)*L,e[5]=(r*A-s*P+o*O)*L,e[6]=(y*M-m*E-b*w)*L,e[7]=(l*E-h*M+d*w)*L,e[8]=(i*x-a*P+u*v)*L,e[9]=(n*P-r*x-o*v)*L,e[10]=(m*S-p*M+b*g)*L,e[11]=(f*M-l*S-d*g)*L,e[12]=(a*O-i*T-c*v)*L,e[13]=(r*T-n*O+s*v)*L,e[14]=(p*w-m*_-y*g)*L,e[15]=(l*_-f*w+h*g)*L,e):null}function c(e,t,r){const n=t[0],s=t[1],o=t[2],i=t[3],a=t[4],c=t[5],u=t[6],l=t[7],f=t[8],h=t[9],d=t[10],m=t[11],p=t[12],y=t[13],b=t[14],g=t[15];let w=r[0],M=r[1],_=r[2],S=r[3];return e[0]=w*n+M*a+_*f+S*p,e[1]=w*s+M*c+_*h+S*y,e[2]=w*o+M*u+_*d+S*b,e[3]=w*i+M*l+_*m+S*g,w=r[4],M=r[5],_=r[6],S=r[7],e[4]=w*n+M*a+_*f+S*p,e[5]=w*s+M*c+_*h+S*y,e[6]=w*o+M*u+_*d+S*b,e[7]=w*i+M*l+_*m+S*g,w=r[8],M=r[9],_=r[10],S=r[11],e[8]=w*n+M*a+_*f+S*p,e[9]=w*s+M*c+_*h+S*y,e[10]=w*o+M*u+_*d+S*b,e[11]=w*i+M*l+_*m+S*g,w=r[12],M=r[13],_=r[14],S=r[15],e[12]=w*n+M*a+_*f+S*p,e[13]=w*s+M*c+_*h+S*y,e[14]=w*o+M*u+_*d+S*b,e[15]=w*i+M*l+_*m+S*g,e}function u(e,t,r){const n=r[0],s=r[1],o=r[2];if(t===e)e[12]=t[0]*n+t[4]*s+t[8]*o+t[12],e[13]=t[1]*n+t[5]*s+t[9]*o+t[13],e[14]=t[2]*n+t[6]*s+t[10]*o+t[14],e[15]=t[3]*n+t[7]*s+t[11]*o+t[15];else{const r=t[0],i=t[1],a=t[2],c=t[3],u=t[4],l=t[5],f=t[6],h=t[7],d=t[8],m=t[9],p=t[10],y=t[11];e[0]=r,e[1]=i,e[2]=a,e[3]=c,e[4]=u,e[5]=l,e[6]=f,e[7]=h,e[8]=d,e[9]=m,e[10]=p,e[11]=y,e[12]=r*n+u*s+d*o+t[12],e[13]=i*n+l*s+m*o+t[13],e[14]=a*n+f*s+p*o+t[14],e[15]=c*n+h*s+y*o+t[15]}return e}function l(e,t,r){const n=r[0],s=r[1],o=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*s,e[5]=t[5]*s,e[6]=t[6]*s,e[7]=t[7]*s,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function f(e,t,r,s){let o,i,a,c,u,l,f,h,d,m,p,y,b,g,w,M,_,S,E,v,O,P,T,x,A=s[0],L=s[1],C=s[2],q=Math.sqrt(A*A+L*L+C*C);return q<(0,n.g)()?null:(q=1/q,A*=q,L*=q,C*=q,o=Math.sin(r),i=Math.cos(r),a=1-i,c=t[0],u=t[1],l=t[2],f=t[3],h=t[4],d=t[5],m=t[6],p=t[7],y=t[8],b=t[9],g=t[10],w=t[11],M=A*A*a+i,_=L*A*a+C*o,S=C*A*a-L*o,E=A*L*a-C*o,v=L*L*a+i,O=C*L*a+A*o,P=A*C*a+L*o,T=L*C*a-A*o,x=C*C*a+i,e[0]=c*M+h*_+y*S,e[1]=u*M+d*_+b*S,e[2]=l*M+m*_+g*S,e[3]=f*M+p*_+w*S,e[4]=c*E+h*v+y*O,e[5]=u*E+d*v+b*O,e[6]=l*E+m*v+g*O,e[7]=f*E+p*v+w*O,e[8]=c*P+h*T+y*x,e[9]=u*P+d*T+b*x,e[10]=l*P+m*T+g*x,e[11]=f*P+p*T+w*x,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function h(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function d(e,t,r){if(0===t)return o(e);let s,i,a,c=r[0],u=r[1],l=r[2],f=Math.sqrt(c*c+u*u+l*l);return f<(0,n.g)()?null:(f=1/f,c*=f,u*=f,l*=f,s=Math.sin(t),i=Math.cos(t),a=1-i,e[0]=c*c*a+i,e[1]=u*c*a+l*s,e[2]=l*c*a-u*s,e[3]=0,e[4]=c*u*a-l*s,e[5]=u*u*a+i,e[6]=l*u*a+c*s,e[7]=0,e[8]=c*l*a+u*s,e[9]=u*l*a-c*s,e[10]=l*l*a+i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function m(e,t){const r=Math.sin(t),n=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function p(e,t,r,n){const s=t[0],o=t[1],i=t[2],a=t[3],c=s+s,u=o+o,l=i+i,f=s*c,h=s*u,d=s*l,m=o*u,p=o*l,y=i*l,b=a*c,g=a*u,w=a*l,M=n[0],_=n[1],S=n[2];return e[0]=(1-(m+y))*M,e[1]=(h+w)*M,e[2]=(d-g)*M,e[3]=0,e[4]=(h-w)*_,e[5]=(1-(f+y))*_,e[6]=(p+b)*_,e[7]=0,e[8]=(d+g)*S,e[9]=(p-b)*S,e[10]=(1-(f+m))*S,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function y(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function b(e,t){if(e===t)return!0;const r=e[0],s=e[1],o=e[2],i=e[3],a=e[4],c=e[5],u=e[6],l=e[7],f=e[8],h=e[9],d=e[10],m=e[11],p=e[12],y=e[13],b=e[14],g=e[15],w=t[0],M=t[1],_=t[2],S=t[3],E=t[4],v=t[5],O=t[6],P=t[7],T=t[8],x=t[9],A=t[10],L=t[11],C=t[12],q=t[13],B=t[14],k=t[15],R=(0,n.g)();return Math.abs(r-w)<=R*Math.max(1,Math.abs(r),Math.abs(w))&&Math.abs(s-M)<=R*Math.max(1,Math.abs(s),Math.abs(M))&&Math.abs(o-_)<=R*Math.max(1,Math.abs(o),Math.abs(_))&&Math.abs(i-S)<=R*Math.max(1,Math.abs(i),Math.abs(S))&&Math.abs(a-E)<=R*Math.max(1,Math.abs(a),Math.abs(E))&&Math.abs(c-v)<=R*Math.max(1,Math.abs(c),Math.abs(v))&&Math.abs(u-O)<=R*Math.max(1,Math.abs(u),Math.abs(O))&&Math.abs(l-P)<=R*Math.max(1,Math.abs(l),Math.abs(P))&&Math.abs(f-T)<=R*Math.max(1,Math.abs(f),Math.abs(T))&&Math.abs(h-x)<=R*Math.max(1,Math.abs(h),Math.abs(x))&&Math.abs(d-A)<=R*Math.max(1,Math.abs(d),Math.abs(A))&&Math.abs(m-L)<=R*Math.max(1,Math.abs(m),Math.abs(L))&&Math.abs(p-C)<=R*Math.max(1,Math.abs(p),Math.abs(C))&&Math.abs(y-q)<=R*Math.max(1,Math.abs(y),Math.abs(q))&&Math.abs(b-B)<=R*Math.max(1,Math.abs(b),Math.abs(B))&&Math.abs(g-k)<=R*Math.max(1,Math.abs(g),Math.abs(k))}function g(e){const t=(0,n.g)(),r=e[0],s=e[1],o=e[2],i=e[4],a=e[5],c=e[6],u=e[8],l=e[9],f=e[10];return Math.abs(1-(r*r+i*i+u*u))<=t&&Math.abs(1-(s*s+a*a+l*l))<=t&&Math.abs(1-(o*o+c*c+f*f))<=t}function w(e){return 1===e[0]&&0===e[1]&&0===e[2]&&0===e[4]&&1===e[5]&&0===e[6]&&0===e[8]&&0===e[9]&&1===e[10]}},57532:(e,t,r)=>{function n(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function s(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]}function o(e,t){return new Float64Array(e,t,16)}r.d(t,{I:()=>i,a:()=>o,b:()=>s,c:()=>n});const i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},45087:(e,t,r)=>{function n(){return[0,0,0,1]}function s(e){return[e[0],e[1],e[2],e[3]]}function o(e,t){return new Float64Array(e,t,4)}r.d(t,{I:()=>i,a:()=>o,b:()=>s,c:()=>n});const i=[0,0,0,1]},2420:(e,t,r)=>{r.d(t,{O:()=>h,c:()=>g,d:()=>b,e:()=>_,s:()=>y,w:()=>M}),r(48578);var n=r(30773),s=r(72836),o=r(66106),i=r(13457),a=r(16912),c=r(57532),u=r(45087),l=r(32191),f=r(68681);class h{constructor(e){this._allocator=e,this._items=[],this._itemsPtr=0,this._grow()}get(){return 0===this._itemsPtr&&(0,n.n)((()=>this._reset())),this._itemsPtr===this._items.length&&this._grow(),this._items[this._itemsPtr++]}_reset(){const e=Math.min(3*Math.max(8,this._itemsPtr),this._itemsPtr+3*d);this._items.length=Math.min(e,this._items.length),this._itemsPtr=0}_grow(){for(let e=0;e<Math.max(8,Math.min(this._items.length,d));e++)this._items.push(this._allocator())}}const d=1024;class m{constructor(e,t,r){this._itemByteSize=e,this._itemCreate=t,this._buffers=new Array,this._items=new Array,this._itemsPtr=0,this._itemsPerBuffer=Math.ceil(r/this._itemByteSize)}get(){0===this._itemsPtr&&(0,n.n)((()=>this._reset()));const e=Math.floor(this._itemsPtr/this._itemsPerBuffer);for(;this._buffers.length<=e;){const e=new ArrayBuffer(this._itemsPerBuffer*this._itemByteSize);for(let t=0;t<this._itemsPerBuffer;++t)this._items.push(this._itemCreate(e,t*this._itemByteSize));this._buffers.push(e)}return this._items[this._itemsPtr++]}_reset(){const e=2*(Math.floor(this._itemsPtr/this._itemsPerBuffer)+1);for(;this._buffers.length>e;)this._buffers.pop(),this._items.length=this._buffers.length*this._itemsPerBuffer;this._itemsPtr=0}static createVec2f64(e=p){return new m(16,l.c,e)}static createVec3f64(e=p){return new m(24,o.g,e)}static createVec4f64(e=p){return new m(32,f.b,e)}static createMat3f64(e=p){return new m(72,a.a,e)}static createMat4f64(e=p){return new m(128,c.a,e)}static createQuatf64(e=p){return new m(32,u.a,e)}get test(){return{size:this._buffers.length*this._itemsPerBuffer*this._itemByteSize}}}const p=4*i.B.KILOBYTES,y=(m.createVec2f64(),m.createVec3f64());m.createVec4f64(),m.createMat3f64();const b=m.createMat4f64();function g(e){return e?w((0,o.e)(e.origin),(0,o.e)(e.direction)):w((0,o.c)(),(0,o.c)())}function w(e,t){return{origin:e,direction:t}}function M(e,t){const r=S.get();return r.origin=e,r.direction=t,r}function _(e,t,r){const n=(0,s.i)(e.direction,(0,s.b)(r,t,e.origin));return(0,s.a)(r,e.origin,(0,s.e)(r,e.direction,n)),r}m.createQuatf64();const S=new h((()=>g()))},60939:(e,t,r)=>{r.d(t,{a:()=>m,b:()=>y,c:()=>d,g:()=>p,i:()=>w,l:()=>P}),r(48578);var n=r(92143),s=r(82426),o=r(65775),i=r(72836),a=r(66106),c=r(7200),u=r(68681),l=r(40961),f=r(2420);const h=d();function d(){return(0,u.c)()}function m(e,t=d()){return(0,c.c)(t,e)}function p(e){return e[3]}function y(e){return e}function b(e,t,r){if(null==t)return!1;const{origin:n,direction:s}=t,o=g;o[0]=n[0]-e[0],o[1]=n[1]-e[1],o[2]=n[2]-e[2];const i=s[0]*s[0]+s[1]*s[1]+s[2]*s[2];if(0===i)return!1;const a=2*(s[0]*o[0]+s[1]*o[1]+s[2]*o[2]),c=a*a-4*i*(o[0]*o[0]+o[1]*o[1]+o[2]*o[2]-e[3]*e[3]);if(c<0)return!1;const u=Math.sqrt(c);let l=(-a-u)/(2*i);const f=(-a+u)/(2*i);return(l<0||f<l&&f>0)&&(l=f),!(l<0||(r&&(r[0]=n[0]+s[0]*l,r[1]=n[1]+s[1]*l,r[2]=n[2]+s[2]*l),0))}const g=(0,a.c)();function w(e,t){return b(e,t,null)}function M(e,t,r){const n=f.s.get(),s=f.d.get();(0,i.f)(n,t.origin,t.direction);const a=p(e);(0,i.f)(r,n,t.origin),(0,i.e)(r,r,1/(0,i.l)(r)*a);const c=S(e,t.origin),u=(0,l.a)(t.origin,r);return(0,o.a)(s,u+c,n),(0,i.d)(r,r,s),r}function _(e,t,r){const n=(0,i.b)(f.s.get(),t,e),s=(0,i.e)(f.s.get(),n,e[3]/(0,i.l)(n));return(0,i.a)(r,s,e)}function S(e,t){const r=(0,i.b)(f.s.get(),t,e),n=(0,i.l)(r),o=p(e),a=o+Math.abs(o-n);return(0,s.b)(o/a)}const E=(0,a.c)();function v(e,t,r,n){const o=(0,i.b)(E,t,e);switch(r){case l.A.X:{const e=(0,s.g)(o,E)[2];return(0,i.s)(n,-Math.sin(e),Math.cos(e),0)}case l.A.Y:{const e=(0,s.g)(o,E),t=e[1],r=e[2],a=Math.sin(t);return(0,i.s)(n,-a*Math.cos(r),-a*Math.sin(r),Math.cos(t))}case l.A.Z:return(0,i.n)(n,o);default:return}}function O(e,t){const r=(0,i.b)(T,t,e);return(0,i.l)(r)-e[3]}function P(e,t){const r=(0,i.C)(e,t),n=p(e);return r<=n*n}const T=(0,a.c)(),x=d();Object.freeze(Object.defineProperty({__proto__:null,NullSphere:h,altitudeAt:O,angleToSilhouette:S,axisAt:v,clear:function(e){e[0]=e[1]=e[2]=e[3]=0},closestPoint:function(e,t,r){return b(e,t,r)?r:((0,f.e)(t,e,r),_(e,r,r))},closestPointOnSilhouette:M,containsPoint:P,copy:m,create:d,distanceToSilhouette:function(e,t){const r=(0,i.b)(f.s.get(),t,e),n=(0,i.D)(r),s=e[3]*e[3];return Math.sqrt(Math.abs(n-s))},elevate:function(e,t,r){return e!==r&&(0,i.c)(r,e),r[3]=e[3]+t,r},fromCenterAndRadius:function(e,t){return(0,u.f)(e[0],e[1],e[2],t)},fromRadius:function(e,t){return e[0]=e[1]=e[2]=0,e[3]=t,e},fromValues:function(e,t,r,n){return(0,u.f)(e,t,r,n)},getCenter:y,getRadius:p,intersectRay:b,intersectRayClosestSilhouette:function(e,t,r){if(b(e,t,r))return r;const n=M(e,t,f.s.get());return(0,i.a)(r,t.origin,(0,i.e)(f.s.get(),t.direction,(0,i.z)(t.origin,n)/(0,i.l)(t.direction))),r},intersectsRay:w,projectPoint:_,setAltitudeAt:function(e,t,r,n){const s=O(e,t),o=v(e,t,l.A.Z,T),a=(0,i.e)(T,o,r-s);return(0,i.a)(n,t,a)},setExtent:function(e,t,r){return n.L.getLogger("esri.geometry.support.sphere").error("sphere.setExtent is not yet supported"),e===r?r:m(e,r)},tmpSphere:x,union:function(e,t,r=d()){const n=(0,i.z)(e,t),s=e[3],o=t[3];return n+o<s?((0,c.c)(r,e),r):n+s<o?((0,c.c)(r,t),r):((0,i.x)(r,e,t,(n+o-s)/(2*n)),r[3]=(n+s+o)/2,r)},wrap:function(e){return e}},Symbol.toStringTag,{value:"Module"}))},32191:(e,t,r)=>{function n(){return[0,0]}function s(e,t){return[e,t]}function o(e,t){return new Float64Array(e,t,2)}r.d(t,{a:()=>n,c:()=>o,f:()=>s}),s(1,0)},79641:(e,t,r)=>{r.d(t,{a:()=>a,b:()=>i,c:()=>s,d:()=>l,e:()=>c,m:()=>n,n:()=>f,s:()=>u,t:()=>o});const n=r(92143).L.getLogger("esri.views.3d.support.buffer.math");function s(e,t,r){o(e.typedBuffer,t.typedBuffer,r,e.typedBufferStride,t.typedBufferStride)}function o(e,t,r,s=3,o=s){if(e.length/s!==Math.ceil(t.length/o))return n.error("source and destination buffers need to have the same number of elements"),e;const i=e.length/s,a=r[0],c=r[1],u=r[2],l=r[4],f=r[5],h=r[6],d=r[8],m=r[9],p=r[10],y=r[12],b=r[13],g=r[14];let w=0,M=0;for(let r=0;r<i;r++){const r=t[w],n=t[w+1],i=t[w+2];e[M]=a*r+l*n+d*i+y,e[M+1]=c*r+f*n+m*i+b,e[M+2]=u*r+h*n+p*i+g,w+=o,M+=s}return e}function i(e,t,r){a(e.typedBuffer,t.typedBuffer,r,e.typedBufferStride,t.typedBufferStride)}function a(e,t,r,s=3,o=s){if(e.length/s!==Math.ceil(t.length/o))return void n.error("source and destination buffers need to have the same number of elements");const i=e.length/s,a=r[0],c=r[1],u=r[2],l=r[3],f=r[4],h=r[5],d=r[6],m=r[7],p=r[8];let y=0,b=0;for(let r=0;r<i;r++){const r=t[y],n=t[y+1],i=t[y+2];e[b]=a*r+l*n+d*i,e[b+1]=c*r+f*n+m*i,e[b+2]=u*r+h*n+p*i,y+=o,b+=s}}function c(e,t,r){u(e.typedBuffer,t,r,e.typedBufferStride)}function u(e,t,r,n=3){const s=Math.min(e.length/n,t.count),o=t.typedBuffer,i=t.typedBufferStride;let a=0,c=0;for(let t=0;t<s;t++)e[c]=r*o[a],e[c+1]=r*o[a+1],e[c+2]=r*o[a+2],a+=i,c+=n}function l(e,t){f(e.typedBuffer,t.typedBuffer,e.typedBufferStride,t.typedBufferStride)}function f(e,t,r=3,n=r){const s=Math.min(e.length/r,t.length/n);let o=0,i=0;for(let a=0;a<s;a++){const s=t[o],a=t[o+1],c=t[o+2],u=s*s+a*a+c*c;if(u>0){const t=1/Math.sqrt(u);e[i]=t*s,e[i+1]=t*a,e[i+2]=t*c}o+=n,i+=r}}},68681:(e,t,r)=>{function n(){return[0,0,0,0]}function s(e,t,r,n){return[e,t,r,n]}function o(e,t){return new Float64Array(e,t,4)}r.d(t,{b:()=>o,c:()=>n,f:()=>s}),s(1,1,1,1)},40961:(e,t,r)=>{r.d(t,{A:()=>n,a:()=>c});var n,s,o=r(82426),i=r(72836),a=r(66106);function c(e,t){const r=(0,i.i)(e,t)/((0,i.l)(e)*(0,i.l)(t));return-(0,o.b)(r)}(s=n||(n={}))[s.X=0]="X",s[s.Y=1]="Y",s[s.Z=2]="Z",(0,a.c)(),(0,a.c)()},66122:(e,t,r)=>{r.d(t,{J:()=>u,j:()=>l});var n=r(29768),s=r(21972),o=(r(48578),r(76506)),i=(r(92143),r(71252)),a=r(66396),c=r(17533);r(60474),r(86656),r(379),r(62062),r(6540),r(34250),r(91306),r(60991),r(71552),r(31450),r(40642),r(19657),r(91055),r(6906),r(79456),r(50406);const u=e=>{let t=class extends e{clone(){const e=(0,i.u)((0,a.g)(this),"unable to clone instance of non-accessor class"),t=e.metadatas,r=e.store,n={},c=new Map;for(const e in t){const i=t[e],a=r?.originOf(e),u=i.clonable;if(i.readOnly||!1===u||a!==s.O.USER&&a!==s.O.DEFAULTS&&a!==s.O.WEB_MAP&&a!==s.O.WEB_SCENE)continue;const l=this[e];let f=null;f="function"==typeof u?u(l):"reference"===u?l:(0,o.Vo)(l),null!=l&&null==f||(a===s.O.DEFAULTS?c.set(e,f):n[e]=f)}const u=new(0,Object.getPrototypeOf(this).constructor)(n);if(c.size){const e=(0,a.g)(u)?.store;if(e)for(const[t,r]of c)e.set(t,r,s.O.DEFAULTS)}return u}};return t=(0,n._)([(0,c.j)("esri.core.Clonable")],t),t};let l=class extends(u(s.Z)){};l=(0,n._)([(0,c.j)("esri.core.Clonable")],l)},66705:(e,t,r)=>{r.d(t,{Z:()=>h});var n=r(29768),s=r(66122),o=r(12047),i=r(34250),a=(r(91306),r(48578),r(59465)),c=r(17533),u=r(66106),l=r(91597);r(21972),r(60474),r(66396),r(76506),r(86656),r(92143),r(31450),r(71552),r(40642),r(379),r(62062),r(6540),r(19657),r(91055),r(6906),r(79456),r(50406),r(60991),r(57251),r(86787),r(97714),r(2906),r(73796),r(60947),r(53785),r(35132);let f=class extends((0,s.J)(o.wq)){constructor(e){super(e),this.type="georeferenced-relative",this.isRelative=!0,this.isGeoreferenced=!0,this.origin=(0,u.c)()}getOriginPoint(e){const[t,r,n]=this.origin;return new l.Z({x:t,y:r,z:n,spatialReference:e})}setOriginFormPoint({x:e,y:t,z:r}){this.origin=(0,u.f)(e,t,r??0)}};(0,n._)([(0,a.e)({georeferencedRelative:"georeferenced-relative"},{readOnly:!0})],f.prototype,"type",void 0),(0,n._)([(0,i.Cb)({type:[Number],nonNullable:!0,json:{write:!0}})],f.prototype,"origin",void 0),f=(0,n._)([(0,c.j)("esri.geometry.support.MeshGeoreferencedRelativeVertexSpace")],f);const h=f},46961:(e,t,r)=>{r.d(t,{Z:()=>u});var n=r(29768),s=r(66122),o=r(12047),i=(r(92143),r(91306),r(48578),r(60991),r(59465)),a=r(17533);r(21972),r(60474),r(66396),r(76506),r(86656),r(379),r(62062),r(6540),r(34250),r(31450),r(71552),r(40642),r(19657),r(91055),r(6906),r(79456),r(50406),r(57251);let c=class extends((0,s.J)(o.wq)){constructor(){super({}),this.type="georeferenced",this.isRelative=!1,this.isGeoreferenced=!0}};(0,n._)([(0,i.e)({georeferenced:"georeferenced"},{readOnly:!0})],c.prototype,"type",void 0),c=(0,n._)([(0,a.j)("esri.geometry.support.MeshGeoreferencedVertexSpace")],c);const u=c},45274:(e,t,r)=>{r.d(t,{Z:()=>h});var n=r(29768),s=r(66122),o=r(12047),i=r(34250),a=(r(91306),r(48578),r(59465)),c=r(17533),u=r(66106),l=r(91597);r(21972),r(60474),r(66396),r(76506),r(86656),r(92143),r(31450),r(71552),r(40642),r(379),r(62062),r(6540),r(19657),r(91055),r(6906),r(79456),r(50406),r(60991),r(57251),r(86787),r(97714),r(2906),r(73796),r(60947),r(53785),r(35132);let f=class extends((0,s.J)(o.wq)){constructor(e){super(e),this.type="local",this.isRelative=!0,this.isGeoreferenced=!1,this.origin=(0,u.c)()}getOriginPoint(e){const[t,r,n]=this.origin;return new l.Z({x:t,y:r,z:n,spatialReference:e})}setOriginFormPoint({x:e,y:t,z:r}){this.origin=(0,u.f)(e,t,r??0)}};(0,n._)([(0,a.e)({local:"local"},{readOnly:!0})],f.prototype,"type",void 0),(0,n._)([(0,i.Cb)({type:[Number],nonNullable:!0,json:{write:!0}})],f.prototype,"origin",void 0),f=(0,n._)([(0,c.j)("esri.geometry.support.MeshLocalVertexSpace")],f);const h=f},82058:(e,t,r)=>{r.r(t),r.d(t,{default:()=>y,i:()=>p,l:()=>h,r:()=>B,s:()=>f});var n=r(31450),s=r(88762),o=r(60991),i=r(48578),a=r(76506),c=r(50406),u=r(32101);r(71552),r(92143),r(40642);const l=["elevation3d.arcgis.com","js.arcgis.com","jsdev.arcgis.com","jsqa.arcgis.com","static.arcgis.com"];function f(e){const t=(0,u.P$)(e,!0);return!!t&&t.endsWith(".arcgis.com")&&!l.includes(t)&&!e.endsWith("/sharing/rest/generateToken")}function h(e,t,r=!1,n){return new Promise(((s,o)=>{if((0,c.Hc)(n))return void o(d());let a=()=>{f(),o(new Error(`Unable to load ${t}`))},u=()=>{const t=e;f(),s(t)},l=()=>{if(!e)return;const t=e;f(),t.src="",o(d())};const f=()=>{(0,i.h)("esri-image-decode")||(e.removeEventListener("error",a),e.removeEventListener("load",u)),a=null,u=null,e=null,null!=n&&n.removeEventListener("abort",l),l=null,r&&URL.revokeObjectURL(t)};null!=n&&n.addEventListener("abort",l),(0,i.h)("esri-image-decode")?e.decode().then(u,a):(e.addEventListener("error",a),e.addEventListener("load",u))}))}function d(){try{return new DOMException("Aborted","AbortError")}catch{const e=new Error;return e.name="AbortError",e}}const m="Timeout exceeded";function p(e){return"object"==typeof e&&!!e&&"message"in e&&e.message===m}async function y(e,t){e instanceof URL&&(e=e.toString()),t?.query instanceof URLSearchParams&&(t.query=(0,u.u0)(t.query.toString().replaceAll("+"," ")));const a=(0,u.HK)(e),l=(0,u.jc)(e);l||a||(e=(0,u.Fv)(e));const h={url:e,requestOptions:{...t}};let d=(0,u.oh)(e);if(d){const e=await async function(e,t){if(null!=e.responseData)return e.responseData;if(e.headers&&(t.requestOptions.headers={...t.requestOptions.headers,...e.headers}),e.query&&(t.requestOptions.query={...t.requestOptions.query,...e.query}),e.before){let r,n;try{n=await e.before(t)}catch(e){r=P("request:interceptor",e,t)}if((n instanceof Error||n instanceof o.Z)&&(r=P("request:interceptor",n,t)),r)throw e.error&&e.error(r),r;return n}}(d,h);if(null!=e)return{data:e,getHeader:E,httpStatus:200,requestOptions:h.requestOptions,url:h.url};d.after||d.error||(d=null)}if(e=h.url,"image"===(t=h.requestOptions).responseType&&((0,i.h)("host-webworker")||(0,i.h)("host-node")))throw P("request:invalid-parameters",new Error("responseType 'image' is not supported in Web Workers or Node environment"),h);if("head"===t.method){if(t.body)throw P("request:invalid-parameters",new Error("body parameter cannot be set when method is 'head'"),h);if(a||l)throw P("request:invalid-parameters",new Error("data and blob URLs are not supported for method 'head'"),h)}if(await async function(){(0,i.h)("host-webworker")?b||(b=await r.e(9768).then(r.bind(r,89768))):y._abortableFetch||(y._abortableFetch=globalThis.fetch.bind(globalThis))}(),b)return b.execute(e,t);const m=new AbortController;(0,c.fu)(t,(()=>m.abort()));const p={controller:m,credential:void 0,credentialToken:void 0,fetchOptions:void 0,hasToken:!1,interceptor:d,params:h,redoRequest:!1,useIdentity:g.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1},M=await async function(e){let t,r;await async function(e){const t=e.params.url,r=e.params.requestOptions,o=e.controller.signal,i=r.body;let a=null,u=null;if(w&&"HTMLFormElement"in globalThis&&(i instanceof FormData?a=i:i instanceof HTMLFormElement&&(a=new FormData(i))),"string"==typeof i&&(u=i),e.fetchOptions={cache:r.cacheBust&&!("polyfill"in y._abortableFetch)?"no-cache":"default",credentials:"same-origin",headers:r.headers||{},method:"head"===r.method?"HEAD":"GET",mode:"cors",priority:g.priority,redirect:"follow",signal:o},(a||u)&&(e.fetchOptions.body=a||u),"anonymous"===r.authMode&&(e.useIdentity=!1),e.hasToken=!!(/token=/i.test(t)||r.query?.token||a?.get("token")),!e.hasToken&&n.default.apiKey&&f(t)&&(r.query||(r.query={}),r.query.token=n.default.apiKey,e.hasToken=!0),e.useIdentity&&!e.hasToken&&!e.credentialToken&&!x(t)&&!(0,c.Hc)(o)){let n;"immediate"===r.authMode?(await T(),n=await s.id.getCredential(t,{signal:o}),e.credential=n):"no-prompt"===r.authMode?(await T(),n=await s.id.getCredential(t,{prompt:!1,signal:o}).catch((()=>{})),e.credential=n):s.id&&(n=s.id.findCredential(t)),n&&(e.credentialToken=n.token,e.useSSL=!!n.ssl)}}(e);try{do{[t,r]=await A(e)}while(!await C(e,t,r))}catch(r){const n=P("request:server",r,e.params,t);throw n.details.ssl=e.useSSL,e.interceptor?.error&&e.interceptor.error(n),n}const o=e.params.url;if(r&&/\/sharing\/rest\/(accounts|portals)\/self/i.test(o)){if(!e.hasToken&&!e.credentialToken&&r.user?.username&&!(0,u.kl)(o)){const e=(0,u.P$)(o,!0);e&&g.trustedServers.push(e)}Array.isArray(r.authorizedCrossOriginNoCorsDomains)&&function(e){n.default.request.crossOriginNoCorsDomains||(n.default.request.crossOriginNoCorsDomains={});const t=n.default.request.crossOriginNoCorsDomains;for(let r of e)r=r.toLowerCase(),/^https?:\/\//.test(r)?t[(0,u.P$)(r)??""]=0:(t[(0,u.P$)("http://"+r)??""]=0,t[(0,u.P$)("https://"+r)??""]=0)}(r.authorizedCrossOriginNoCorsDomains)}const i=e.credential;if(i&&s.id){const e=s.id.findServerInfo(i.server);let t=e?.owningSystemUrl;if(t){t=t.replace(/\/?$/,"/sharing");const e=s.id.findCredential(t,i.userId);e&&-1===s.id._getIdenticalSvcIdx(t,e)&&e.resources.unshift(t)}}return{data:r,getHeader:t?e=>t?.headers.get(e):E,httpStatus:t?.status??200,requestOptions:e.params.requestOptions,ssl:e.useSSL,url:e.params.url}}(p);return d?.after?.(M),M}let b;const g=n.default.request,w="FormData"in globalThis,M=[499,498,403,401],_=["COM_0056","COM_0057","SB_0008"],S=[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],E=()=>null,v=Symbol();function O(e){const t=(0,u.P$)(e);return!t||t.endsWith(".arcgis.com")||y._corsServers.includes(t)||(0,u.kl)(t)}function P(e,t,r,n){let s="Error";const i={url:r.url,requestOptions:r.requestOptions,getHeader:E,ssl:!1};if(t instanceof o.Z)return t.details?(t.details=(0,a.d9)(t.details),t.details.url=r.url,t.details.requestOptions=r.requestOptions):t.details=i,t;if(t){const e=n&&(e=>n.headers.get(e)),r=n?.status,o=t.message;o&&(s=o),e&&(i.getHeader=e),i.httpStatus=(null!=t.httpCode?t.httpCode:t.code)||r||0,i.subCode=t.subcode,i.messageCode=t.messageCode,"string"==typeof t.details?i.messages=[t.details]:i.messages=t.details,i.raw=v in t?t[v]:t}return(0,c.D_)(t)?(0,c.zE)():new o.Z(e,s,i)}async function T(){s.id||await Promise.all([r.e(4078),r.e(6676),r.e(6097),r.e(7803)]).then(r.bind(r,67803))}function x(e){return S.some((t=>t.test(e)))}async function A(e){let t=e.params.url;const r=e.params.requestOptions,o=e.fetchOptions??{},a=(0,u.jc)(t)||(0,u.HK)(t),l=r.responseType||"json",f=a?0:null!=r.timeout?r.timeout:g.timeout;let h=!1;if(!a){e.useSSL&&(t=(0,u.hO)(t)),r.cacheBust&&"default"===o.cache&&(t=(0,u.ZN)(t,"request.preventCache",Date.now()));let a={...r.query};e.credentialToken&&(a.token=e.credentialToken);let c=(0,u.B7)(a);(0,i.h)("esri-url-encodes-apostrophe")&&(c=c.replaceAll("'","%27"));const l=t.length+1+c.length;let f;h="delete"===r.method||"post"===r.method||"put"===r.method||!!r.body||l>g.maxUrlLength;const d=r.useProxy||!!(0,u.ed)(t);if(d){const e=(0,u.b7)(t);f=e.path,!h&&f.length+1+l>g.maxUrlLength&&(h=!0),e.query&&(a={...e.query,...a})}if("HEAD"===o.method&&(h||d)){if(h){if(l>g.maxUrlLength)throw P("request:invalid-parameters",new Error("URL exceeds maximum length"),e.params);throw P("request:invalid-parameters",new Error("cannot use POST request when method is 'head'"),e.params)}if(d)throw P("request:invalid-parameters",new Error("cannot use proxy when method is 'head'"),e.params)}if(h?(o.method="delete"===r.method?"DELETE":"put"===r.method?"PUT":"POST",r.body?t=(0,u.fl)(t,a):(o.body=(0,u.B7)(a),o.headers||(o.headers={}),o.headers["Content-Type"]="application/x-www-form-urlencoded")):t=(0,u.fl)(t,a),d&&(e.useProxy=!0,t=`${f}?${t}`),a.token&&w&&o.body instanceof FormData&&!(0,u.i)(t)&&o.body.set("token",a.token),r.hasOwnProperty("withCredentials"))e.withCredentials=r.withCredentials;else if(!(0,u.D6)(t,(0,u.TI)()))if((0,u.kl)(t))e.withCredentials=!0;else if(s.id){const r=s.id.findServerInfo(t);r?.webTierAuth&&(e.withCredentials=!0)}e.withCredentials&&(o.credentials="include",function(e){const t=n.default.request.crossOriginNoCorsDomains;if(t){let r=(0,u.P$)(e);if(r)return r=r.toLowerCase(),!(0,u.D6)(r,(0,u.TI)())&&t[r]<Date.now()-36e5}return!1}(t)&&await async function(e){const t=n.default.request.crossOriginNoCorsDomains,r=(0,u.P$)(e);t&&r&&(t[r.toLowerCase()]=Date.now());const s=(0,u.mN)(e);e=s.path,"json"===s.query?.f&&(e+="?f=json");try{await fetch(e,{mode:"no-cors",credentials:"include"})}catch{}}(h?(0,u.fl)(t,a):t))}let d,p,b=0,M=!1;f>0&&(b=setTimeout((()=>{M=!0,e.controller.abort()}),f));try{if("native-request-init"===r.responseType)p=o,p.url=t;else if("image"!==r.responseType||"default"!==o.cache||"GET"!==o.method||h||function(e){if(e)for(const t of Object.getOwnPropertyNames(e))if(e[t])return!0;return!1}(r.headers)||!a&&!e.useProxy&&g.proxyUrl&&!O(t)){if(d=await y._abortableFetch(t,o),e.useProxy||function(e){const t=(0,u.P$)(e);t&&!y._corsServers.includes(t)&&y._corsServers.push(t)}(t),"native"===r.responseType)p=d;else if("HEAD"!==o.method)if(d.ok){switch(l){case"array-buffer":p=await d.arrayBuffer();break;case"blob":case"image":p=await d.blob();break;default:p=await d.text()}if(b&&(clearTimeout(b),b=0),"json"===l||"xml"===l||"document"===l)if(p)switch(l){case"json":p=JSON.parse(p);break;case"xml":p=L(p,"application/xml");break;case"document":p=L(p,"text/html")}else p=null;if(p){if("array-buffer"===l||"blob"===l){const e=d.headers.get("Content-Type");if(e&&/application\/json|text\/plain/i.test(e)&&p["blob"===l?"size":"byteLength"]<=750)try{const e=await new Response(p).json();e.error&&(p=e)}catch{}}"image"===l&&p instanceof Blob&&(p=await q(URL.createObjectURL(p),e,!0))}}else{p=await d.text();try{p=JSON.parse(p)}catch{}}}else p=await q(t,e)}catch(n){if("AbortError"===n.name){if(M)throw new Error(m);throw(0,c.zE)("Request canceled")}if(!(!d&&n instanceof TypeError&&g.proxyUrl)||r.body||"delete"===r.method||"head"===r.method||"post"===r.method||"put"===r.method||e.useProxy||O(t))throw n;e.redoRequest=!0,(0,u.tD)({proxyUrl:g.proxyUrl,urlPrefix:(0,u.P$)(t)??""})}finally{b&&clearTimeout(b)}return[d,p]}function L(e,t){let r;try{r=(new DOMParser).parseFromString(e,t)}catch{}if(!r||r.getElementsByTagName("parsererror").length)throw new SyntaxError("XML Parse error");return r}async function C(e,t,r){if(e.redoRequest)return e.redoRequest=!1,!1;const n=e.params.requestOptions;if(!t||"native"===n.responseType||"native-request-init"===n.responseType)return!0;let o,i;if(r&&(r.error?o=r.error:"error"===r.status&&Array.isArray(r.messages)&&(o={...r},o[v]=r,o.details=r.messages)),!o&&!t.ok)throw o=new Error(`Unable to load ${t.url} status: ${t.status}`),o[v]=r,o;let a,c=null;o&&(i=Number(o.code),c=o.hasOwnProperty("subcode")?Number(o.subcode):null,a=o.messageCode,a=a?.toUpperCase());const u=n.authMode;if(403===i&&(4===c||o.message?.toLowerCase().includes("ssl")&&!o.message.toLowerCase().includes("permission"))){if(!e.useSSL)return e.useSSL=!0,!1}else if(!e.hasToken&&e.useIdentity&&("no-prompt"!==u||498===i)&&void 0!==i&&M.includes(i)&&!x(e.params.url)&&(403!==i||a&&!_.includes(a)&&(null==c||2===c&&e.credentialToken))){await T();try{const t=await s.id.getCredential(e.params.url,{error:P("request:server",o,e.params),prompt:"no-prompt"!==u,signal:e.controller.signal,token:e.credentialToken});return e.credential=t,e.credentialToken=t.token,e.useSSL=e.useSSL||t.ssl,!1}catch(t){if("no-prompt"===u)return e.credential=void 0,e.credentialToken=void 0,!1;o=t}}if(o)throw o;return!0}function q(e,t,r=!1){const n=t.controller.signal,s=new Image;return t.withCredentials?s.crossOrigin="use-credentials":s.crossOrigin="anonymous",s.alt="",s.fetchPriority=g.priority,s.src=e,h(s,e,r,n)}y._abortableFetch=null,y._corsServers=["https://server.arcgisonline.com","https://services.arcgisonline.com"];const B=Object.freeze(Object.defineProperty({__proto__:null,default:y},Symbol.toStringTag,{value:"Module"}))}}]);
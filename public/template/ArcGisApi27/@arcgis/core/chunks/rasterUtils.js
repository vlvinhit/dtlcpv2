/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
import{Z as e}from"./vec2f64.js";import{C as t}from"./contextUtils.js";import{b as a,S as n,P as s,c as i,T as r,p as o}from"./enums3.js";import{T as u,a as f}from"./Texture.js";function c(e,o,c="nearest",m=!1){const l=!(m&&"u8"===o.pixelType),_=l?a.FLOAT:a.UNSIGNED_BYTE,g=null==o.pixels||0===o.pixels.length?null:l?o.getAsRGBAFloat():o.getAsRGBA(),p=e.capabilities.textureFloat?.textureFloatLinear,A=new u;return A.width=o.width,A.height=o.height,A.internalFormat=e.type===t.WEBGL2&&l?n.RGBA32F:s.RGBA,A.samplingMode=!p||"bilinear"!==c&&"cubic"!==c?i.NEAREST:i.LINEAR,A.dataType=_,A.wrapMode=r.CLAMP_TO_EDGE,new f(e,A,g)}function m(e,o){const{spacing:c,offsets:m,coefficients:l,size:[_,g]}=o,p=c[0]>1,A=new u;A.width=p?4*_:_,A.height=g,A.internalFormat=e.type===t.WEBGL2?n.RGBA32F:s.RGBA,A.dataType=a.FLOAT,A.samplingMode=i.NEAREST,A.wrapMode=r.CLAMP_TO_EDGE;const T=new Float32Array(p?_*g*16:2*m.length);if(p&&null!=l)for(let e=0,t=0;e<l.length;e++)T[t++]=l[e],e%3==2&&(T[t++]=1);else for(let e=0;e<g;e++)for(let t=0;t<_;t++){const a=4*(e*_+t),n=2*(t*g+e);T[a]=m[n],T[a+1]=m[n+1],T[a+3]=-1===m[n]?0:1}return new f(e,A,T)}function l(e,t){const a=new u;return a.internalFormat=s.RGBA,a.width=t.length/4,a.height=1,a.samplingMode=i.NEAREST,a.wrapMode=r.CLAMP_TO_EDGE,new f(e,a,t)}function _(t,a,n,s=1,i=!0){return{u_flipY:i,u_applyTransform:!!t,u_opacity:s,u_transformSpacing:t?t.spacing:e,u_transformGridSize:t?t.size:e,u_targetImageSize:a,u_srcImageSize:n}}function g(e,t){return{u_colormapOffset:t||0,u_colormapMaxIndex:e?e.length/4-1:0}}function p(e,t){return{u_scale:e,u_offset:t}}function A(e){return{u_bandCount:e.bandCount,u_minOutput:e.outMin,u_maxOutput:e.outMax,u_minCutOff:e.minCutOff,u_maxCutOff:e.maxCutOff,u_factor:e.factor,u_useGamma:e.useGamma,u_gamma:e.gamma,u_gammaCorrection:e.gammaCorrection}}function T(e){return{u_hillshadeType:e.hillshadeType,u_sinZcosAs:e.sinZcosAs,u_sinZsinAs:e.sinZsinAs,u_cosZs:e.cosZs,u_weights:e.weights,u_factor:e.factor,u_minValue:e.minValue,u_maxValue:e.maxValue}}function h(e,t){const a=e.gl,n=t.glName,s=new Map;if(null==n)return s;const i=a.getProgramParameter(n,a.ACTIVE_UNIFORMS);let r;for(let e=0;e<i;e++)r=a.getActiveUniform(n,e),r&&s.set(r.name,{location:a.getUniformLocation(n,r.name),info:r});return s}function E(e,t,a){Object.keys(a).forEach((n=>{const s=t.get(n)||t.get(n+"[0]");s&&function(e,t,a,n){if(null===n||null==a)return!1;const{info:s}=n;switch(s.type){case o.FLOAT:s.size>1?e.setUniform1fv(t,a):e.setUniform1f(t,a);break;case o.FLOAT_VEC2:e.setUniform2fv(t,a);break;case o.FLOAT_VEC3:e.setUniform3fv(t,a);break;case o.FLOAT_VEC4:e.setUniform4fv(t,a);break;case o.FLOAT_MAT3:e.setUniformMatrix3fv(t,a);break;case o.FLOAT_MAT4:e.setUniformMatrix4fv(t,a);break;case o.INT:s.size>1?e.setUniform1iv(t,a):e.setUniform1i(t,a);break;case o.BOOL:e.setUniform1i(t,a?1:0);break;case o.INT_VEC2:case o.BOOL_VEC2:e.setUniform2iv(t,a);break;case o.INT_VEC3:case o.BOOL_VEC3:e.setUniform3iv(t,a);break;case o.INT_VEC4:case o.BOOL_VEC4:e.setUniform4iv(t,a)}}(e,n,a[n],s)}))}function O(e,t,a,n){a.length===n.length&&(n.some((e=>null==e))||a.some((e=>null==e))||a.forEach(((a,s)=>{t.setUniform1i(a,s),e.bindTexture(n[s],s)})))}export{g as a,A as b,m as c,T as d,c as e,l as f,_ as g,E as h,h as i,p as j,O as s};

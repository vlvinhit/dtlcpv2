/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
import"./typedArrayUtil.js";import{L as t}from"./Logger.js";import{a as n,g as e}from"./utils.js";var r;!function(t){t[t.Dirty=1]="Dirty",t[t.Overriden=2]="Overriden",t[t.Computing=4]="Computing",t[t.NonNullable=8]="NonNullable",t[t.HasDefaultValue=16]="HasDefaultValue",t[t.DepTrackingInitialized=32]="DepTrackingInitialized",t[t.AutoTracked=64]="AutoTracked",t[t.ExplicitlyTracking=128]="ExplicitlyTracking"}(r||(r={}));const i={onObservableAccessed:()=>{},onTrackingEnd:()=>{}},a=[];let c=i;function o(t){c.onObservableAccessed(t)}let s=!1,l=!1;function u(t,n,e){if(s)return f(t,n,e);p(t);const r=n.call(e);return d(),r}function g(t,n){return u(i,t,n)}function f(n,e,r){const i=s;s=!0,p(n);let a=null;try{a=e.call(r)}catch(n){l&&t.getLogger("esri.core.accessorSupport.tracking").error(n)}return d(),s=i,a}function p(t){c=t,a.push(t)}function d(){const t=a.length;if(t>1){const n=a.pop();c=a[t-2],n.onTrackingEnd()}else if(1===t){const t=a.pop();c=i,t.onTrackingEnd()}else c=i}function y(t,n){const e=n.observerObject;if(e.flags&r.DepTrackingInitialized)return;const i=l;l=!1,e.flags&r.AutoTracked?f(n,n.metadata.get,t):b(t,n),l=i}const k=[];function b(t,e){const i=e.observerObject;i.flags&r.ExplicitlyTracking||(i.flags|=r.ExplicitlyTracking,f(e,(()=>{const r=e.metadata.dependsOn||k;for(const e of r)if("string"!=typeof e||e.includes(".")){const r=n(e);for(let n=0,e=t;n<r.length&&null!=e&&"object"==typeof e;++n)e=T(e,r[n],n!==r.length-1)}else T(t,e,!1)})),i.flags&=~r.ExplicitlyTracking)}function T(t,n,r){const i="?"===n[n.length-1]?n.slice(0,-1):n;if(null!=t.getItemAt||Array.isArray(t)){const n=parseInt(i,10);if(!isNaN(n))return Array.isArray(t)?t[n]:t.at(n)}const a=e(t);if(a){const n=a.propertiesByName.get(i);n&&(o(n.observerObject),y(t,n))}return r?t[i]:void 0}export{r as F,b as a,g as b,y as i,u as r,o as t};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
import{watch as n,syncAndInitial as e}from"../core/reactiveUtils.js";import{C as t}from"./vec3.js";import{m as r}from"./dehydratedFeatures.js";import{V as o}from"./InputManager.js";import{a}from"./keybindings.js";import{f as s,e as i}from"./vec3f64.js";import{c as u,f as l,a as c}from"./elevationInfoUtils.js";function f(n){return n}function p(n){return i(n)}function d(n,e,t){return s(n,e,t)}function g(n,e,t){return null==n?null:E(t.coordinateHelper.vectorToDehydratedPoint(n,v),e,t)}function E(n,e,t){if(null==n)return null;if(null==e)return s(n.x,n.y,n.z??0);if("2d"===e.type)return s(n.x,n.y,0);const{elevationInfo:r}=t,o=u(e,n,r,l)??0;return s(n.x,n.y,o)}function m(n,e,{z:t,m:o,spatialReference:a,elevationInfo:s}){if(null==t&&null==o){const e=r(n[0],n[1],void 0,a);return null!=o&&(e.m=o,e.hasM=!0),e}if(null==e||"2d"===e.type){const e=r(n[0],n[1],t,a);return null!=o&&(e.m=o,e.hasM=!0),e}const i=c(e,n,a,l,s)??0,u=r(n[0],n[1],i,a);return null!=o&&(u.m=o,u.hasM=!0),u}function y(n,e){return r(n[0],n[1],n[2],e)}const v=r(0,0,0,null);function R(n,e){const t=n.x-e.x,r=n.y-e.y;return t*t+r*r}function T(n,e){return Math.sqrt(R(n,e))}function h(n,e){e.sort(((e,r)=>t(e.targetPoint,n)-t(r.targetPoint,n)))}var x;function N({point:n,distance:e,returnEdge:t,returnVertex:o,coordinateHelper:{spatialReference:a}},s,i){return{point:r(n[0],n[1],n[2],a.toJSON()),mode:s,distance:e,returnEdge:t,returnVertex:o,query:null!=i?i.toJSON():{where:"1=1"}}}function O(n,e,t){return{left:g(n.leftVertex.pos,e,t),right:g(n.rightVertex.pos,e,t)}}function j(n){return n.createQuery()}function b(t,r=(()=>{})){const s=n((()=>({view:t.view,snappingOptions:t.snappingOptions})),(({view:n,snappingOptions:e})=>{const s="snapping-toggle",i=o.TOOL;if(t.removeHandles(s),n&&null!=e){const o=[n.on("key-down",(n=>{n.key!==a.toggle||n.repeat||(e.enabledToggled=!0,r())}),i),n.on("key-up",(n=>{n.key===a.toggle&&(e.enabledToggled=!1,r())}),i),n.on("pointer-move",(n=>{const t=n.native.ctrlKey;e.enabledToggled!==t&&(e.enabledToggled=t,r())}),i)];t.addHandles(o,s)}}),e);t.addHandles(s)}!function(n){n[n.TARGET=0]="TARGET",n[n.REFERENCE=1]="REFERENCE",n[n.REFERENCE_EXTENSION=2]="REFERENCE_EXTENSION"}(x||(x={}));export{x as L,y as a,h as b,d as c,g as d,T as e,R as f,O as g,f as h,m as i,p as j,N as k,j as m,E as p,b as s};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
import{clone as r}from"../core/lang.js";import{a as n}from"./maybe.js";function t(r){return e((()=>r.forEach((r=>null!=r&&r.remove()))))}function e(r){return{remove:()=>{r&&(r(),r=void 0)}}}function a(r){return e((()=>{const n=r();null!=n&&n.remove()}))}function u(r){return e((()=>r?.abort()))}function o(r){return e(null!=r?()=>r.destroy():void 0)}function s(r){return r.__accessor__??null}function i(r,n){return null!=r&&r.metadatas&&null!=r.metadatas[n]}function c(r,n,t){return l(r,n,t?{policy:t,path:""}:null)}function l(t,e,a){return e?Object.keys(e).reduce(((t,u)=>{const o=u;let s=null,i="merge";if(a&&(s=a.path?`${a.path}.${u}`:u,i=a.policy(s)),"replace"===i)return t[o]=e[o],t;if("replace-arrays"===i&&Array.isArray(t[o]))return t[o]=e[o],t;if(void 0===t[o])return t[o]=r(e[o]),t;let c=t[o],f=e[o];if(c===f)return t;if(Array.isArray(f)||Array.isArray(t))c=c?Array.isArray(c)?t[o]=c.concat():t[o]=[c]:t[o]=[],f&&(Array.isArray(f)||(f=[f]),f.forEach((r=>{c.includes(r)||c.push(r)})));else if(f&&"object"==typeof f)if(a){const r=a.path;a.path=n(s),t[o]=l(c,f,a),a.path=r}else t[o]=l(c,f,null);else t.hasOwnProperty(u)&&!e.hasOwnProperty(u)||(t[o]=f);return t}),t||{}):t}function f(r){return Array.isArray(r)?r:r.split(".")}function p(r){return r.includes(",")?r.split(",").map((r=>r.trim())):[r.trim()]}function y(r,n,e,a){const u=function(r){if(Array.isArray(r)){const n=[];for(const t of r)n.push(...p(t));return n}return p(r)}(n);return 1!==u.length?t(u.map((n=>a(r,n,e)))):a(r,u[0],e)}function m(r){let n=!1;return()=>{n||(n=!0,r())}}export{f as a,e as b,u as c,o as d,s as g,t as h,i,c as m,m as o,y as p,a as r};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
import t from"../geometry/Point.js";import{s as n}from"../geometry/Extent.js";function e(t,n,e){return Math.sqrt((t[0]-n[0])**2+(t[1]-n[1])**2+(void 0!==t[2]&&void 0!==n[2]?(t[2]*e-n[2]*e)**2:0))}const s=[];for(const t of[[9002,56146130,6131,6132,8050,8051,8228],[9003,5702,6358,6359,6360,8052,8053],[9095,5754]]){const n=t[0];for(let e=1;e<t.length;e++)s[t[e]]=n}const r=[];function o(t){return t.vcsWkid&&void 0!==s[t.vcsWkid]?r[s[t.vcsWkid]]:t.latestVcsWkid&&void 0!==s[t.latestVcsWkid]?r[s[t.latestVcsWkid]]:1}function a(t,n,e){const s={x:0,y:0};n&&(s.z=0),e&&(s.m=0);let r=0,o=t[0];for(let a=0;a<t.length;a++){const i=t[a];if(!1===f(i,o)){const t=h(o,i,n),a=c(o,i,n,e);a.x*=t,a.y*=t,s.x+=a.x,s.y+=a.y,n&&(a.z*=t,s.z+=a.z),e&&(a.m*=t,s.m+=a.m),r+=t,o=i}}return r>0?(s.x/=r,s.y/=r,n&&(s.z/=r),e&&(s.m/=r)):(s.x=t[0][0],s.y=t[0][1],n&&(s.z=t[0][2]),e&&n?s.m=t[0][3]:e&&(s.m=t[0][2])),s}function c(t,n,e,s){const r={x:(t[0]+n[0])/2,y:(t[1]+n[1])/2};return e&&(r.z=(t[2]+n[2])/2),e&&s?r.m=(t[3]+n[3])/2:s&&(r.m=(t[2]+n[2])/2),r}function i(t,n){if(t.length<=1)return 0;let e=0;for(let s=1;s<t.length;s++)e+=h(t[s-1],t[s],n);return e}function h(t,n,e){const s=n[0]-t[0],r=n[1]-t[1];if(e){const t=n[2]-n[2];return Math.sqrt(s*s+r*r+t*t)}return Math.sqrt(s*s+r*r)}function f(t,n){if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e]!==n[e])return!1;return!0}function l(n){const e={x:0,y:0,spatialReference:n.spatialReference.toJSON()},s={x:0,y:0,spatialReference:n.spatialReference.toJSON()};let r=0,o=0;for(let t=0;t<n.paths.length;t++){if(0===n.paths[t].length)continue;const c=i(n.paths[t],!0===n.hasZ);if(0===c){const s=a(n.paths[t],!0===n.hasZ,!0===n.hasM);e.x+=s.x,e.y+=s.y,!0===n.hasZ&&(e.z+=s.z),!0===n.hasM&&(e.m+=s.m),++r}else{const e=a(n.paths[t],!0===n.hasZ,!0===n.hasM);s.x+=e.x*c,s.y+=e.y*c,!0===n.hasZ&&(s.z+=e.z*c),!0===n.hasM&&(s.m+=e.m*c),o+=c}}return o>0?(s.x/=o,s.y/=o,!0===n.hasZ&&(s.z/=o),!0===n.hasM&&(s.m/=o),new t(s)):r>0?(e.x/=r,e.y/=r,!0===n.hasZ&&(s.z/=r),!0===n.hasM&&(e.m/=r),new t(e)):null}function u(n){if(0===n.points.length)return null;let e=0,s=0,r=0,o=0;for(let t=0;t<n.points.length;t++){const a=n.getPoint(t);!0===a.hasZ&&(r+=a.z),!0===a.hasM&&(o+=a.m),e+=a.x,s+=a.y,o+=a.m}const a={x:e/n.points.length,y:s/n.points.length,spatialReference:null};return a.spatialReference=n.spatialReference.toJSON(),!0===n.hasZ&&(a.z=r/n.points.length),!0===n.hasM&&(a.m=o/n.points.length),new t(a)}function x(t,n,e=0){for(;t<e;)t+=n;const s=e+n;for(;t>=s;)t-=n;return t}function y(t,n){return Math.atan2(n.y-t.y,n.x-t.x)}function g(t,n){return x(y(t,n),2*Math.PI)*(180/Math.PI)}function m(t,n){return x(Math.PI/2-y(t,n),2*Math.PI)*(180/Math.PI)}function p(t,n,e){const s={x:t.x-n.x,y:t.y-n.y},r={x:e.x-n.x,y:e.y-n.y};return Math.atan2((o=s).x*(a=r).y-a.x*o.y,function(t,n){return t.x*n.x+t.y*n.y}(s,r));var o,a}function M(t,n,e){return x(p(t,n,e),2*Math.PI)*(180/Math.PI)}function z(t,n,e){return x(-1*p(t,n,e),2*Math.PI)*(180/Math.PI)}r[9002]=.3048,r[9003]=.3048006096012192,r[9095]=.3048007491;const d=[0,0];function P(t){for(let e=0;e<t.length;e++){const s=t[e];for(let r=0;r<s.length-1;r++){const o=s[r],a=s[r+1];for(let s=e+1;s<t.length;s++)for(let e=0;e<t[s].length-1;e++){const r=t[s][e],c=t[s][e+1];if(n(o,a,r,c,d)&&!(d[0]===o[0]&&d[1]===o[1]||d[0]===r[0]&&d[1]===r[1]||d[0]===a[0]&&d[1]===a[1]||d[0]===c[0]&&d[1]===c[1]))return!0}}const r=s.length;if(!(r<3))for(let t=0;t<=r-2;t++){const e=s[t],o=s[t+1];for(let a=t+2;a<=r-2;a++){const t=s[a],r=s[a+1];if(n(e,o,t,r,d)&&!(d[0]===e[0]&&d[1]===e[1]||d[0]===t[0]&&d[1]===t[1]||d[0]===o[0]&&d[1]===o[1]||d[0]===r[0]&&d[1]===r[1]))return!0}}}return!1}export{g as a,M as b,m as c,z as d,l as e,u as f,o as g,P as p,e as s};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
import{c as t}from"./mathUtils.js";import{e as n,b as r,a as s,i as o,f as c,c as e,s as i,h as a,n as u}from"./vec3.js";import{c as f}from"./vec3f64.js";import"./typedArrayUtil.js";import"./Logger.js";import{p as I}from"./vector.js";import{s as N,a as M}from"./ray.js";import{t as g}from"./mathUtils2.js";function m(t=K){return[t[0],t[1],t[2],t[3]]}function p(t=K[0],n=K[1],r=K[2],s=K[3]){return h(t,n,r,s,M.get())}function E(t,n){return h(n[0],n[1],n[2],n[3],t)}function h(t,n,r,s,o=m()){return o[0]=t,o[1]=n,o[2]=r,o[3]=s,o}function A(t,n,r){return e(r,t),r[3]=n,r}function j(t,n,r){const s=n[0]*n[0]+n[1]*n[1]+n[2]*n[2],o=Math.abs(s-1)>1e-5&&s>1e-12?1/Math.sqrt(s):1;return r[0]=n[0]*o,r[1]=n[1]*o,r[2]=n[2]*o,r[3]=-(r[0]*t[0]+r[1]*t[1]+r[2]*t[2]),r}function l(t,n,r,s=m()){const o=r[0]-n[0],c=r[1]-n[1],e=r[2]-n[2],i=t[0]-n[0],a=t[1]-n[1],u=t[2]-n[2],f=c*u-e*a,I=e*i-o*u,N=o*a-c*i,M=f*f+I*I+N*N,g=Math.abs(M-1)>1e-5&&M>1e-12?1/Math.sqrt(M):1;return s[0]=f*g,s[1]=I*g,s[2]=N*g,s[3]=-(s[0]*t[0]+s[1]*t[1]+s[2]*t[2]),s}function F(t,n,s,c,e){const f=t.length/3;if(f<3)return!1;i(_,t[3*s],t[3*s+1],t[3*s+2]);let I=c,N=!1;for(;I<f-1&&!N;){const n=3*I;i(v,t[n],t[n+1],t[n+2]),I++,N=!a(_,v)}if(!N)return!1;for(I=Math.max(I,e),N=!1;I<f&&!N;){const n=3*I;i(y,t[n],t[n+1],t[n+2]),I++,r(b,_,v),u(b,b),r(d,v,y),u(d,d),N=!a(_,y)&&!a(v,y)&&Math.abs(o(b,d))<T}return N?(l(_,v,y,n),!0):(0!==s||1!==c||2!==e)&&F(t,n,0,1,2)}const T=.99619469809,_=f(),v=f(),y=f(),b=f(),d=f();function L(t,n,r){return n!==t&&E(t,n),t[3]=-o(t,r),t}function X(t,n){return n[0]=-t[0],n[1]=-t[1],n[2]=-t[2],n[3]=-t[3],n}function C(t,n,r,s){return c(y,n,t),j(r,y,s)}function P(t,n,s,o){return H(t,n,r(N.get(),s,n),R,o)}function q(t,n,r){return null!=n&&H(t,n.origin,n.direction,S,r)}function O(t,n,r){return H(t,n.origin,n.vector,Q.NONE,r)}function U(t,n,r){return H(t,n.origin,n.vector,Q.CLAMP,r)}function x(t,n){return G(t,n)>=0}function k(t,n){const r=o(t,n.ray.direction),s=-G(t,n.ray.origin);if(s<0&&r>=0)return!1;if(r>-1e-6&&r<1e-6)return s>0;if((s<0||r<0)&&!(s<0&&r<0))return!0;const c=s/r;return r>0?c<n.c1&&(n.c1=c):c>n.c0&&(n.c0=c),n.c0<=n.c1}function w(t,n){const r=o(t,n.ray.direction),s=-G(t,n.ray.origin);if(r>-1e-6&&r<1e-6)return s>0;const c=s/r;return r>0?c<n.c1&&(n.c1=c):c>n.c0&&(n.c0=c),n.c0<=n.c1}function z(t,o,c){const e=n(N.get(),t,-t[3]),i=D(t,r(N.get(),o,e),N.get());return s(c,i,e),c}function B(t,n,s,o){const c=t,e=N.get(),a=N.get();g(c,e,a);const u=r(N.get(),s,n),f=I(e,u),M=I(a,u),m=I(c,u);return i(o,f,M,m)}function D(t,s,c){const e=n(N.get(),t,o(t,s));return r(c,s,e),c}function G(t,n){return o(t,n)+t[3]}function H(r,c,e,i,a){const u=o(r,e);if(0===u)return!1;let f=-(o(r,c)+r[3])/u;return i&Q.CLAMP&&(f=t(f,0,1)),!(!(i&Q.INFINITE_MIN)&&f<0||!(i&Q.INFINITE_MAX)&&f>1||(s(a,c,n(a,e,f)),0))}function J(t){return t}const K=[0,0,1,0];var Q;!function(t){t[t.NONE=0]="NONE",t[t.CLAMP=1]="CLAMP",t[t.INFINITE_MIN=4]="INFINITE_MIN",t[t.INFINITE_MAX=8]="INFINITE_MAX"}(Q||(Q={}));const R=Q.INFINITE_MIN|Q.INFINITE_MAX,S=Q.INFINITE_MAX;export{E as a,P as b,m as c,l as d,w as e,j as f,k as g,q as h,x as i,C as j,L as k,h as l,O as m,J as n,U as o,B as p,z as q,A as r,G as s,X as t,D as u,F as v,p as w};

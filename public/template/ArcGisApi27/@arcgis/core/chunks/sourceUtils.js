/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
import{o as t}from"./unitUtils.js";import{validateFieldValue as e,validationErrorToString as n,isNumericField as i,isStringField as s,sanitizeNullFieldValue as r}from"../layers/support/fieldUtils.js";class o{constructor(){this.code=null,this.description=null}}class l{constructor(t){this.error=new o,this.globalId=null,this.objectId=null,this.success=!1,this.uniqueId=null,this.error.description=t}}function u(t){return new l(t)}class a{constructor(t){this.globalId=null,this.success=!0,this.objectId=this.uniqueId=t}}function c(t){return new a(t)}const f=new Set;function d(t,i,s,r=!1,o){f.clear();for(const l in s){const a=t.get(l);if(!a)continue;const c=s[l],d=h(a,c);if(d!==c&&o&&o.push({name:"invalid-value-type",message:"attribute value was converted to match the field type",details:{field:a,originalValue:c,sanitizedValue:d}}),f.add(a.name),a&&(r||a.editable)){const t=e(a,d);if(t)return u(n(t,a,d));i[a.name]=d}}for(const e of t?.requiredFields??[])if(!f.has(e.name))return u(`missing required field "${e.name}"`);return null}function h(t,e){let n=e;return"string"==typeof e&&i(t)?n=parseFloat(e):null!=e&&s(t)&&"string"!=typeof e&&(n=String(e)),r(n)}let m;function p(e,n){if(!e||!t(n))return e;if("rings"in e||"paths"in e){if(null==m)throw new TypeError("geometry engine not loaded");return m.simplify(n,e)}return e}async function g(e,n){!t(e)||"esriGeometryPolygon"!==n&&"esriGeometryPolyline"!==n||await async function(){return null==m&&(m=await import("./geometryEngineJSON.js").then((t=>t.g))),m}()}export{u as a,c,g as l,d as m,p as s};

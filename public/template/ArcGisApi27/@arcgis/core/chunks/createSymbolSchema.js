/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
import{a as e,b as r}from"./enums4.js";import{d as t,i as a,e as s}from"./MaterialKey.js";import"../core/Error.js";import"../core/lang.js";import"./typedArrayUtil.js";import"./Logger.js";import"../config.js";import"./object.js";import"./string.js";import"./alignmentUtils.js";function n(e){return"line-marker"===e.type?{type:"line-marker",color:e.color?.toJSON(),placement:e.placement,style:e.style}:e.constructor.fromJSON(e.toJSON()).toJSON()}function o(e){return s(e)}function l(s,l,i=!1){if(!s)return null;switch(s.type){case"simple-fill":case"picture-fill":return function(r,s,l){const i=t(e.FILL,s),m=l?o(i):i,c=r.clone(),h=c.outline,y=a(s.symbologyType);y||(c.outline=null);const u={materialKey:m,hash:c.hash(),...n(c)};if(y)return u;const p=[];if(p.push(u),h){const r=t(e.LINE,{...s,isOutline:!0}),a={materialKey:l?o(r):r,hash:h.hash(),...n(h)};p.push(a)}return{type:"composite-symbol",layers:p,hash:p.reduce(((e,r)=>r.hash+e),"")}}(s,l,i);case"simple-marker":case"picture-marker":return function(r,a,s){const l=t(e.MARKER,a),i=s?o(l):l,m=n(r);return{materialKey:i,hash:r.hash(),...m,angle:r.angle,maxVVSize:a.maxVVSize}}(s,l,i);case"simple-line":return function(s,l,i){const m=a(l.symbologyType)?r.DEFAULT:l.symbologyType,c=t(e.LINE,{...l,symbologyType:m}),h=i?o(c):c,y=s.clone(),u=y.marker;y.marker=null;const p=[];if(p.push({materialKey:h,hash:y.hash(),...n(y)}),u){const r=t(e.MARKER,l),a=i?o(r):r;u.color=u.color??y.color,p.push({materialKey:a,hash:u.hash(),lineWidth:y.width,...n(u)})}return{type:"composite-symbol",layers:p,hash:p.reduce(((e,r)=>r.hash+e),"")}}(s,l,i);case"text":return function(r,a,s){const l=t(e.TEXT,a),i=s?o(l):l,m=n(r);return{materialKey:i,hash:r.hash(),...m,angle:r.angle,maxVVSize:a.maxVVSize}}(s,l,i);case"label":return function(r,a,s){const n=r.toJSON(),l=t(e.LABEL,{...a,placement:n.labelPlacement});return{materialKey:s?o(l):l,hash:r.hash(),...n,labelPlacement:n.labelPlacement}}(s,l,i);case"cim":return{type:"cim",rendererKey:l.vvFlags,data:s.data,maxVVSize:l.maxVVSize};case"CIMSymbolReference":return{type:"cim",rendererKey:l.vvFlags,data:s,maxVVSize:l.maxVVSize};case"web-style":return{...n(s),type:"web-style",hash:s.hash(),rendererKey:l.vvFlags,maxVVSize:l.maxVVSize};default:throw new Error(`symbol not supported ${s.type}`)}}export{l as createSymbolSchema};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
import{c as t}from"./mathUtils.js";import{O as r,s as n}from"./ray.js";import{c as i,b as o,i as e,e as c,a as s,C as a,D as u}from"./vec3.js";import{e as g,c as f}from"./vec3f64.js";function v(t){return t?{origin:g(t.origin),vector:g(t.vector)}:{origin:f(),vector:f()}}function p(t,r=v()){return b(t.origin,t.vector,r)}function b(t,r,n=v()){return i(n.origin,t),i(n.vector,r),n}function h(t,r,n=v()){return i(n.origin,t),o(n.vector,r,t),n}function m(r,i){const s=o(n.get(),i,r.origin),a=e(r.vector,s),u=e(r.vector,r.vector),g=t(a/u,0,1),f=o(n.get(),c(n.get(),r.vector,g),s);return e(f,f)}function M(t,r,n){return d(t,r,0,1,n)}function A(t,r,n){return s(n,t.origin,c(n,t.vector,r))}function d(r,i,a,g,f){const{vector:v,origin:p}=r,b=o(n.get(),i,p),h=e(v,b)/u(v);return c(f,v,t(h,a,g)),s(f,f,r.origin)}function B(t,r){if(l(t,function(t,r){const n=x.get();return n.origin=t,n.vector=r,n}(r.origin,r.direction),!1,w)){const{tA:r,pB:i,distance2:o}=w;if(r>=0&&r<=1)return o;if(r<0)return a(t.origin,i);if(r>1)return a(s(n.get(),t.origin,t.vector),i)}return null}function j(t,r,n){return!!l(t,r,!0,w)&&(i(n,w.pA),!0)}function l(r,i,o,e){const c=1e-6,u=r.origin,g=s(n.get(),u,r.vector),f=i.origin,v=s(n.get(),f,i.vector),p=n.get(),b=n.get();if(p[0]=u[0]-f[0],p[1]=u[1]-f[1],p[2]=u[2]-f[2],b[0]=v[0]-f[0],b[1]=v[1]-f[1],b[2]=v[2]-f[2],Math.abs(b[0])<c&&Math.abs(b[1])<c&&Math.abs(b[2])<c)return!1;const h=n.get();if(h[0]=g[0]-u[0],h[1]=g[1]-u[1],h[2]=g[2]-u[2],Math.abs(h[0])<c&&Math.abs(h[1])<c&&Math.abs(h[2])<c)return!1;const m=p[0]*b[0]+p[1]*b[1]+p[2]*b[2],M=b[0]*h[0]+b[1]*h[1]+b[2]*h[2],A=p[0]*h[0]+p[1]*h[1]+p[2]*h[2],d=b[0]*b[0]+b[1]*b[1]+b[2]*b[2],B=(h[0]*h[0]+h[1]*h[1]+h[2]*h[2])*d-M*M;if(Math.abs(B)<c)return!1;let j=(m*M-A*d)/B,l=(m+M*j)/d;o&&(j=t(j,0,1),l=t(l,0,1));const w=n.get(),x=n.get();return w[0]=u[0]+j*h[0],w[1]=u[1]+j*h[1],w[2]=u[2]+j*h[2],x[0]=f[0]+l*b[0],x[1]=f[1]+l*b[1],x[2]=f[2]+l*b[2],e.tA=j,e.tB=l,e.pA=w,e.pB=x,e.distance2=a(w,x),!0}const w={tA:0,tB:0,pA:f(),pB:f(),distance2:0},x=new r((()=>v()));export{j as a,p as b,v as c,m as d,b as e,h as f,B as g,A as h,M as i,d as p};

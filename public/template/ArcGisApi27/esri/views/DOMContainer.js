// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/domUtils ../core/Logger ../core/maybe ../core/reactiveUtils ../core/scheduling ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./overlay/ViewOverlay".split(" "),function(q,l,f,m,x,r,k,t,g,A,B,C,y,u){function v(e){e&&(m.empty(e),e.parentNode&&e.parentNode.removeChild(e))}const p=[0,0];q.DOMContainer=e=>{e=function(w){function n(...a){var b=
w.call(this,...a)||this;b._freqInfo={freq:16,time:750};b._overlayRenderTaskHandle=null;b.height=0;b.overlay=null;b.position=null;b.resizing=!1;b.root=null;b.surface=null;b.suspended=!0;b.ui=null;b.userContent=null;b.width=0;b.widthBreakpoint=null;b.addHandles([k.watch(()=>b.cursor,c=>{const {surface:d}=l._assertThisInitialized(b);d&&d.setAttribute("data-cursor",c)}),k.watch(()=>b.navigating,c=>{const {surface:d}=l._assertThisInitialized(b);d&&d.setAttribute("data-navigating",c.toString())})]);return b}
l._inherits(n,w);var h=n.prototype;h.initialize=function(){this.addHandles([k.watch(()=>this.ui,(a,b)=>this._handleUIChange(a,b),k.initial),this.on("focus",()=>this.notifyChange("focused")),this.on("blur",()=>this.notifyChange("focused"))])};h.destroy=function(){this.destroyed||(this.ui=r.destroyMaybe(this.ui),this.container=null)};h.blur=function(){this.surface?.blur()};h.focus=function(){this.surface?.focus()};h.pageToContainer=function(a,b,c){const d=this.position;a-=d?d[0]:0;b-=d?d[1]:0;c?(c[0]=
a,c[1]=b):c=[a,b];return c};h.containerToPage=function(a,b,c){const d=this.position;a+=d?d[0]:0;b+=d?d[1]:0;c?(c[0]=a,c[1]=b):c=[a,b];return c};h._handleUIChange=function(a,b){this.removeHandles("ui");b&&b!==a&&b.destroy();a&&(a.view=this,this.addHandles(k.watch(()=>this.root,c=>{if(c){const d=document.createElement("div");c.appendChild(d);c=d}else c=null;a.container=c},k.initial),"ui"));this._set("ui",a)};h._stopMeasuring=function(){this.removeHandles("measuring");this._get("resizing")&&this._set("resizing",
!1)};h._startMeasuring=function(){const a=this._freqInfo;a.freq=16;a.time=750;this.addHandles([(()=>{const b=()=>{a.freq=16;a.time=750};window.addEventListener("resize",b);return{remove(){window.removeEventListener("resize",b)}}})(),t.addFrameTask({prepare:b=>{const c=this._measure(),d=this._freqInfo;d.time+=b.deltaTime;c&&(d.freq=16,this._get("resizing")||this._set("resizing",!0));d.time<d.freq||(d.time=0,this._position()||c?d.freq=16:d.freq=Math.min(750,2*d.freq),!c&&512<=d.freq&&this._get("resizing")&&
this._set("resizing",!1))}})],"measuring");this._measure();this._position()};h._measure=function(){var a=this.container;const b=a?a.clientWidth:0;a=a?a.clientHeight:0;if(0===b||0===a)return this.suspended||this._set("suspended",!0),!1;const c=this.width,d=this.height;if(b===c&&a===d)return this.suspended&&this._set("suspended",!1),!1;this._set("width",b);this._set("height",a);this.suspended&&this._set("suspended",!1);this.emit("resize",{oldWidth:c,oldHeight:d,width:b,height:a});return!0};h._position=
function(){var a=this.container;const b=this.position;var c;if(c=a)c=(a.ownerDocument||window.document).defaultView,a=a.getBoundingClientRect(),p[0]=a.left+(c?.pageXOffset??0),p[1]=a.top+(c?.pageYOffset??0),c=p;a=c;return a?b&&a[0]===b[0]&&a[1]===b[1]?!1:(this._set("position",[a[0],a[1]]),!0):!1};h.forceDOMReadyCycle=function(){};l._createClass(n,[{key:"container",get:function(){return this._get("container")??null},set:function(a){var b=this._get("container");const c=m.byId(a);c||"string"!==typeof a||
x.getLogger(this).error("#container",`element with id '${a}' not found`);if(b!==c)if(this._stopMeasuring(),b&&(b.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&(v(this.root),this._set("root",null)),this.userContent&&(m.reparent(this.userContent,b),v(this.userContent),this._set("userContent",null))),c){c.classList.add("esri-view");a=document.createElement("div");
a.className="esri-view-user-storage";m.reparent(c,a);c.appendChild(a);this._set("userContent",a);a=document.createElement("div");a.className="esri-view-root";c.insertBefore(a,c.firstChild);this._set("root",a);b=document.createElement("div");b.className="esri-view-surface";b.setAttribute("role","application");b.tabIndex=0;a.appendChild(b);this._set("surface",b);var d=new u;a.appendChild(d.surface);this._set("overlay",d);this.addHandles(k.watch(()=>d.needsRender,z=>{this._overlayRenderTaskHandle=z&&
!this._overlayRenderTaskHandle?t.addFrameTask({render:()=>this.overlay?.render()}):r.removeMaybe(this._overlayRenderTaskHandle)}));this.forceDOMReadyCycle();this._set("container",c);this._startMeasuring()}else this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),this._set("container",null)}},{key:"focused",get:function(){const a=document.activeElement===this.surface;return document.hasFocus()&&a}},{key:"size",get:function(){return[this.width,
this.height]}}]);return n}(e);f.__decorate([g.property()],e.prototype,"container",null);f.__decorate([g.property({readOnly:!0})],e.prototype,"focused",null);f.__decorate([g.property({readOnly:!0})],e.prototype,"height",void 0);f.__decorate([g.property({type:u})],e.prototype,"overlay",void 0);f.__decorate([g.property({readOnly:!0})],e.prototype,"position",void 0);f.__decorate([g.property({readOnly:!0})],e.prototype,"resizing",void 0);f.__decorate([g.property({readOnly:!0})],e.prototype,"root",void 0);
f.__decorate([g.property({value:null,readOnly:!0})],e.prototype,"size",null);f.__decorate([g.property({readOnly:!0})],e.prototype,"surface",void 0);f.__decorate([g.property({readOnly:!0})],e.prototype,"suspended",void 0);f.__decorate([g.property()],e.prototype,"ui",void 0);f.__decorate([g.property({readOnly:!0})],e.prototype,"userContent",void 0);f.__decorate([g.property({readOnly:!0})],e.prototype,"width",void 0);f.__decorate([g.property()],e.prototype,"widthBreakpoint",void 0);return e=f.__decorate([y.subclass("esri.views.DOMContainer")],
e)};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})});
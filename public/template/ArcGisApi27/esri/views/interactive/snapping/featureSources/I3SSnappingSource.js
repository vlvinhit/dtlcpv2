// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/HandleOwner ../../../../core/handleUtils ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/decorators/subclass ../../../3d/webgl-engine/lib/edgeRendering/EdgeWorkerHandle ./sceneLayerSource/SceneLayerSnappingSourceWorkerHandle".split(" "),
function(b,m,f,q,n,l,r,h,x,y,z,t,u,v){function p(k){return d=>k.immediate.schedule(d)}b.I3SSnappingSource=function(k){function d(a){a=k.call(this,a)||this;a.availability=1;a._abortController=new AbortController;return a}m._inherits(d,k);var g=d.prototype;g.destroy=function(){this._tracker=l.removeMaybe(this._tracker);this._abortController=l.abortMaybe(this._abortController)};g.initialize=function(){var {view:a}=this;a=a.resourceController;this._edgeWorker=new u.EdgeWorkerHandle(p(a));this._workerHandle=
new v.SceneLayerSnappingSourceWorkerHandle({renderCoordsHelper:this.view.renderCoordsHelper,schedule:p(a),fetchEdgeLocations:async(e,c)=>{if(null==this._tracker)throw Error("tracker-not-initialized");return this._tracker.fetchEdgeLocations(e,this._edgeWorker,c)}});this.updatingHandles.addPromise(this._setupLayerView());this.handles.add([n.destroyHandle(this._workerHandle),n.destroyHandle(this._edgeWorker)])};g.fetchCandidates=async function(a,e){return this._workerHandle.fetchCandidates(a,e)};g.refresh=
function(){};g._setupLayerView=async function(){if(!this.destroyed){var a=l.applySome(this._abortController,c=>c.signal),e=await this.getLayerView();null==e||r.isAborted(a)||(this._tracker=e.trackSnappingSources({add:(c,w)=>{this.updatingHandles.addPromise(this._workerHandle.add({id:c,bounds:w},a))},remove:c=>{this.updatingHandles.addPromise(this._workerHandle.remove({id:c},a))}}))}};m._createClass(d,[{key:"updating",get:function(){return this.updatingHandles.updating}}]);return d}(q.HandleOwner);
f.__decorate([h.property({constructOnly:!0})],b.I3SSnappingSource.prototype,"getLayerView",void 0);f.__decorate([h.property({constructOnly:!0})],b.I3SSnappingSource.prototype,"view",void 0);f.__decorate([h.property({readOnly:!0})],b.I3SSnappingSource.prototype,"updating",null);f.__decorate([h.property({readOnly:!0})],b.I3SSnappingSource.prototype,"availability",void 0);b.I3SSnappingSource=f.__decorate([t.subclass("esri.views.interactive.snapping.featureSources.I3SSnappingSource")],b.I3SSnappingSource);
Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})});
// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/maybe ../../../core/promiseUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../support/Scheduler".split(" "),function(d,q,h,v,m,w,k,y,z,A,x,r){d.SnappingOperation=function(t){function l(b){var a=t.call(this,b)||this;a.constrainResult=c=>
c;a._snapPoints=null;a._frameTask=null;a._abortController=null;a._stagedPoint=null;a._snap=w.debounce(async(c,e,f,n)=>{const p=a._frameTask;if(null!=p){var u=await p.schedule(()=>e.snap({...c,context:f,signal:n}),n);u.valid&&await p.schedule(()=>{a.stagedPoint=u.apply();c!==a._snapPoints&&null!=a._snapPoints&&(a.stagedPoint=e.update({...a._snapPoints,context:f}))},n)}});return a}q._inherits(l,t);var g=l.prototype;g.initialize=function(){const b="3d"===this.view.type?this.view?.resourceController?.scheduler:
null;this._frameTask=null!=b?b.registerTask(r.TaskPriority.SNAPPING):r.ImmediateTask};g.destroy=function(){this._abortController=m.abortMaybe(this._abortController);this._frameTask=m.removeMaybe(this._frameTask)};g.update=function(b,a,c){this._snapPoints=b;const {point:e,scenePoint:f}=b;return this.stagedPoint=b=a.update({point:e,scenePoint:f,context:c})};g.snap=async function(b,a,c){const {point:e,scenePoint:f}=b;this.stagedPoint=a.update({point:e,scenePoint:f,context:c});this._snapPoints=b;null==
this._abortController&&(this._abortController=new AbortController);return this._snap(b,a,c,this._abortController.signal)};g.resnap=async function(b,a){null!=this._snapPoints&&await this.snap(this._snapPoints,b,a)};g.abort=function(){this._abortController=m.abortMaybe(this._abortController);this._snapPoints=null};q._createClass(l,[{key:"stagedPoint",get:function(){return this._stagedPoint},set:function(b){this._stagedPoint=this.constrainResult(b)}}]);return l}(v);h.__decorate([k.property({constructOnly:!0})],
d.SnappingOperation.prototype,"view",void 0);h.__decorate([k.property()],d.SnappingOperation.prototype,"stagedPoint",null);h.__decorate([k.property()],d.SnappingOperation.prototype,"constrainResult",void 0);h.__decorate([k.property()],d.SnappingOperation.prototype,"_stagedPoint",void 0);d.SnappingOperation=h.__decorate([x.subclass("esri.views.interactive.snapping.SnappingOperation")],d.SnappingOperation);Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})});
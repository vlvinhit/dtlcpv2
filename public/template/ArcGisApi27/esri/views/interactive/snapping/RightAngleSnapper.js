// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../support/elevationInfoUtils ./SnappingAlgorithm ./SnappingConstraint ./SnappingPoint ./snappingUtils ./candidates/RightAngleSnappingCandidate ../support/viewUtils".split(" "),function(w,x,l,C,y,p,q,r,D,h,E,z,t){r=function(A){function u(){return A.apply(this,arguments)||this}x._inherits(u,A);var v=u.prototype;v.snapNewVertex=function(k,a){var c=
a.editGeometryOperations.data.components[0],b=c.vertices.length;const d=[];if(2>b)return d;var {view:f}=this;const e=t.vectorToScreenPoint(k,a.spatialReference,q.absoluteHeightElevationInfo,f);var g=c.vertices[b-1];this.edgeExceedsShortLineThreshold(g.leftEdge,a)&&(b=h.anyMapPointToSnappingPoint(g.pos,f,a),g=h.anyMapPointToSnappingPoint(g.leftEdge.leftVertex.pos,f,a),this._checkForSnappingCandidate(d,g,b,k,e,a));b=c.vertices[0];this.edgeExceedsShortLineThreshold(b.rightEdge,a)&&(c=h.anyMapPointToSnappingPoint(b.pos,
f,a),f=h.anyMapPointToSnappingPoint(b.rightEdge.rightVertex.pos,f,a),this._checkForSnappingCandidate(d,f,c,k,e,a));return d};v.snapExistingVertex=function(k,a){const c=[];var b=a.vertexHandle;if(3>b.component.vertices.length)return c;var {view:d}=this;const f=t.vectorToScreenPoint(k,a.spatialReference,q.absoluteHeightElevationInfo,d);var e=b.leftEdge;b=b.rightEdge;if(e&&e.leftVertex.leftEdge){var g=e.leftVertex.leftEdge;this.edgeExceedsShortLineThreshold(g,a)&&(e=h.anyMapPointToSnappingPoint(g.rightVertex.pos,
d,a),g=h.anyMapPointToSnappingPoint(g.leftVertex.pos,d,a),this._checkForSnappingCandidate(c,g,e,k,f,a))}b&&b.rightVertex.rightEdge&&(e=b.rightVertex.rightEdge,this.edgeExceedsShortLineThreshold(e,a)&&(b=h.anyMapPointToSnappingPoint(e.leftVertex.pos,d,a),d=h.anyMapPointToSnappingPoint(e.rightVertex.pos,d,a),this._checkForSnappingCandidate(c,d,b,k,f,a)));return c};v._checkForSnappingCandidate=function(k,a,c,b,d,f){const {spatialReference:e,pointer:g}=f;l.subtract(m,c,a);const n=y.set(F,m[1],-m[0],0),
B=l.dot(n,l.subtract(m,b,c))/l.squaredLength(n);b=h.asSnappingPoint(l.scaleAndAdd(p.clone(b),c,n,B));E.squaredScreenDistance(d,t.vectorToScreenPoint(b,e,q.absoluteHeightElevationInfo,this.view))<this.squaredProximityThreshold(g)&&!this.isVertical(b,c)&&!this.isVertical(c,a)&&(d=y.scaleAndAdd(p.create(),c,n,Math.sign(B)),k.push(new z.RightAngleSnappingCandidate({targetPoint:b,constraint:new D.VerticalHalfPlaneConstraint(c,h.asSnappingPoint(d)),previousVertex:a,otherVertex:c,otherVertexType:z.OtherVertexType.CENTER,
isDraped:"on-the-ground"===f.elevationInfo?.mode})))};return x._createClass(u)}(r.SnappingAlgorithm);const m=C.create(),F=p.create();w.RightAngleSnapper=r;Object.defineProperty(w,Symbol.toStringTag,{value:"Module"})});
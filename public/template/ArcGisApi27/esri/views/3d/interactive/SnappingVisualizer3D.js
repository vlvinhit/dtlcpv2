// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../Color ../../../core/analysisThemeUtils ../../../core/has ../../../core/handleUtils ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../geometry/projection ../../../support/elevationInfoUtils ./visualElements/ExtendedLineVisualElement ./visualElements/ParallelLineVisualElement ./visualElements/PointVisualElement ./visualElements/RightAngleQuadVisualElement ../layers/interfaces ../webgl-engine/lib/Material ../../interactive/snapping/Settings ../../interactive/snapping/SnappingDomain ../../interactive/snapping/SnappingPoint ../../interactive/snapping/snappingUtils ../../interactive/snapping/SnappingVisualizer ../../interactive/snapping/hints/LineSnappingHint ../../interactive/support/viewUtils".split(" "),
function(B,C,D,E,F,t,K,L,M,w,G,N,H,O,y,p,m,P,z,A,Q,I,R){function u(e){e=D.toUnitRGBA(E.getAccentColor());const f=[0,0,0,0];return{intersectionPointColor:f,intersectionPointOutlineColor:e,pointColor:f,pointOutlineColor:e,lineColor:e,lineOutlineColor:void 0,parallelSignColor:e,rightAngleColor:e,rightAngleColorDraped:D.toUnitRGBA(E.getAccentColor(.5)),rightAngleOutlineColor:e}}function q(e,f,n){f=J(f,n);return null==f?e:z.createSnappingPoint(e[0],e[1],f)}function x(e,f){return null!=J(e.domain,f)?f.selfSnappingZ.elevationInfo:
e.isDraped?w.onTheGroundElevationInfo:w.absoluteHeightElevationInfo}function J(e,{selfSnappingZ:f}){return e===P.SnappingDomain.SELF&&null!=f?f.value:null}function r(e,f,n,a,b,d=L.create()){b?M.projectVectorToVector(e,f,d,a.basemapTerrain.overlayManager.renderer.spatialReference):R.vectorToRender(e,f,n,a,d);return d}F=function(e){function f(){return e.apply(this,arguments)||this}C._inherits(f,e);var n=f.prototype;n.sortUniqueHints=function(a){return a.sort((b,d)=>(d instanceof I.LineSnappingHint?
d.length:0)-(b instanceof I.LineSnappingHint?b.length:0))};n.visualizeIntersectionPoint=function(a,b){const {spatialReference:d,view:k}=b;b=u();return t.destroyHandle(new H.PointVisualElement({view:k,primitive:"circle",geometry:z.snappingPointToDehydratedPoint(a.intersectionPoint,d),elevationInfo:a.isDraped?w.onTheGroundElevationInfo:w.absoluteHeightElevationInfo,size:20,outlineSize:2,color:b.intersectionPointColor,outlineColor:b.intersectionPointOutlineColor,pixelSnappingEnabled:!1}))};n.visualizePoint=
function(a,b){const {view:d,spatialReference:k}=b,h=u(),c=q(a.point,a.domain,b);return t.destroyHandle(new H.PointVisualElement({view:d,primitive:"circle",geometry:z.snappingPointToDehydratedPoint(c,k),elevationInfo:x(a,b),size:20,outlineSize:2,color:h.pointColor,outlineColor:h.pointOutlineColor,pixelSnappingEnabled:!1}))};n.visualizeLine=function(a,b){const {view:d,spatialReference:k}=b,h=u(),c=q(a.lineStart,a.domain,b),g=q(a.lineEnd,a.domain,b);return t.destroyHandle(this._createLineSegmentHint(a.type,
c,g,k,x(a,b),d,h,a.isDraped,a.fadeLeft,a.fadeRight))};n.visualizeParallelSign=function(a,b){const {view:d,spatialReference:k}=b;var h=u();const {isDraped:c}=a;var g=x(a,b),l=q(a.lineStart,a.domain,b);a=q(a.lineEnd,a.domain,b);l=r(l,k,g,d,c);g=r(a,k,g,d,c);g=K.lerp(g,l,g,.5);h=new N.ParallelLineVisualElement({view:d,attached:!1,offset:m.defaults.parallelLineHintOffset,length:m.defaults.parallelLineHintLength,width:m.defaults.parallelLineHintWidth,color:h.parallelSignColor,location:g,renderOccluded:c?
p.RenderOccludedFlag.OccludeAndTransparent:p.RenderOccludedFlag.Opaque,isDraped:c,renderGroup:y.DrapedRenderGroup.SnappingHint});h.setDirectionFromPoints(l,g);h.attached=!0;return t.destroyHandle(h)};n.visualizeRightAngleQuad=function(a,b){const {view:d,spatialReference:k}=b,h=u();var c=x(a,b);const {isDraped:g}=a;var l=q(a.previousVertex,a.domain,b),v=q(a.centerVertex,a.domain,b);a=q(a.nextVertex,a.domain,b);l=r(l,k,c,d,g);v=r(v,k,c,d,g);c=r(a,k,c,d,g);return t.destroyHandle(new O.RightAngleQuadVisualElement({view:d,
attached:!0,color:g?h.rightAngleColorDraped:h.rightAngleColor,renderOccluded:g?p.RenderOccludedFlag.OccludeAndTransparent:p.RenderOccludedFlag.Transparent,outlineRenderOccluded:g?p.RenderOccludedFlag.OccludeAndTransparent:p.RenderOccludedFlag.Opaque,outlineColor:h.rightAngleOutlineColor,outlineSize:m.defaults.rightAngleHintOutlineSize,size:m.defaults.rightAngleHintSize,isDraped:g,geometry:{previous:l,center:v,next:c},renderGroup:y.DrapedRenderGroup.SnappingHint}))};n._createLineSegmentHint=function(a,
b,d,k,h,c,g,l=!1,v=!0,S=!0){b=r(b,k,h,c,l);d=r(d,k,h,c,l);c=new G.ExtendedLineVisualElement({view:c,extensionType:G.ExtensionType.FADED,start:b,end:d,isDraped:l,color:g.lineColor,renderOccluded:l?p.RenderOccludedFlag.OccludeAndTransparent:p.RenderOccludedFlag.Opaque,renderGroup:y.DrapedRenderGroup.SnappingHint});switch(a){case A.LineSegmentHintType.TARGET:c.width=m.defaults.lineHintWidthTarget;c.fadedExtensions={start:0,end:m.defaults.lineHintFadedExtensions};break;case A.LineSegmentHintType.REFERENCE_EXTENSION:c.width=
m.defaults.lineHintWidthReference;c.fadedExtensions={start:0,end:0};break;case A.LineSegmentHintType.REFERENCE:c.width=m.defaults.lineHintWidthReference,c.fadedExtensions={start:v?m.defaults.lineHintFadedExtensions:0,end:S?m.defaults.lineHintFadedExtensions:0}}c.attached=!0;return c};return C._createClass(f)}(Q.SnappingVisualizer);B.SnappingVisualizer3D=F;Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})});
// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/Evented ../../../../../core/Handles ../../../../../core/maybe ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/accessorSupport/ensureType ../../../../../core/arrayUtils ../../../../../core/has ../../../../../core/accessorSupport/decorators/subclass ../isSupportedGraphicUtils ./isSupportedGraphic ./ReshapeOperation ../../../../interactive/InteractiveToolBase ../../../../interactive/sketch/SketchLabelOptions ../../../../interactive/sketch/SketchTooltipOptions".split(" "),
function(c,k,d,t,u,l,g,e,z,A,B,v,w,m,x,y,n,p){c.GraphicReshapeTool=function(q){function h(a){a=q.call(this,a)||this;a._handles=new u;a._internalGeometryUpdate=!1;a.enableZShape=!0;a.enableZVertex=!0;a.enableMoveGraphic=!0;a.enableMidpoints=!0;a.enableEdgeOffset=!1;a.type="reshape-3d";a.labelOptions=new n;a.tooltipOptions=new p;a.snappingManager=null;a.automaticManipulatorSelection=!1;return a}k._inherits(h,q);var f=h.prototype;f.initialize=function(){const a=this._reshapeOperation=new x.ReshapeOperation({tool:this});
this.addHandles([a.on("reshape",b=>{"reshape"===b.type&&this._onReshapeGeometryChanged();this.emit("reshape",b)}),a.on("move",b=>{"move"===b.type&&this._onReshapeGeometryChanged();this.emit("move",b)}),a.on("vertex-add",b=>{this._onReshapeGeometryChanged();this.emit("vertex-add",b)}),a.on("vertex-remove",b=>{this._onReshapeGeometryChanged();this.emit("vertex-remove",b)}),a.on("immediate-click",b=>this.emit("immediate-click",b)),this.view.on("pointer-down",["Shift"],b=>b.stopPropagation()),g.watch(()=>
this.graphic,()=>this._updateGraphic(),g.syncAndInitial)]);this.finishToolCreation()};f.destroy=function(){this._handles=l.destroyMaybe(this._handles);this._reshapeOperation=l.destroyMaybe(this._reshapeOperation)};f._updateGeometry=function(){const a=m.geometryOfSupportedGraphic(this.graphic);this._reshapeOperation.inputGeometry=null!=a?a.clone():null};f._updateGraphic=function(){this._handles.remove("onGraphicGeometryChange");this._updateGeometry();if(m.isSupportedGraphic(this.graphic)===w.SupportedGraphicResult.SUPPORTED){var a=
g.watch(()=>this.graphic?.geometry,()=>{!1===this._internalGeometryUpdate&&this._updateGeometry()},g.sync);this._handles.add(a,"onGraphicGeometryChange")}};f.onManipulatorSelectionChanged=function(){if(this._reshapeOperation)this._reshapeOperation.onManipulatorSelectionChanged()};f._updateGeometryInternally=function(a){this._internalGeometryUpdate=!0;const {graphic:b}=this,{geometry:r}=b;"mesh"===r?.type&&"point"===a.type?(b.geometry=r.centerAt(a),b.notifyGeometryChanged()):b.geometry=a;this._internalGeometryUpdate=
!1};f._onReshapeGeometryChanged=function(){const {outputGeometry:a}=this._reshapeOperation;null!=this.graphic&&a&&this._updateGeometryInternally(a.clone())};f.undo=function(){null!=this.snappingManager&&this.snappingManager.doneSnapping();const a=this._reshapeOperation.undo(),{outputGeometry:b}=this._reshapeOperation;a&&b&&this._updateGeometryInternally(b.clone())};f.redo=function(){null!=this.snappingManager&&this.snappingManager.doneSnapping();const a=this._reshapeOperation.redo(),{outputGeometry:b}=
this._reshapeOperation;a&&b&&this._updateGeometryInternally(b.clone())};f.onInputEvent=function(a){"key-down"!==a.type||"Delete"!==a.key&&"Backspace"!==a.key||this._reshapeOperation.removeSelectedVertices()};f.reset=function(){};k._createClass(h,[{key:"updating",get:function(){return this._reshapeOperation?.updating??!1}},{key:"canUndo",get:function(){return this._reshapeOperation.canUndo??!1}},{key:"canRedo",get:function(){return this._reshapeOperation.canRedo??!1}},{key:"test",get:function(){return{snappingManager:this.snappingManager,
reshapeOperation:this._reshapeOperation}}}]);return h}(t.EventedMixin(y.InteractiveToolBase));d.__decorate([e.property()],c.GraphicReshapeTool.prototype,"_reshapeOperation",void 0);d.__decorate([e.property({constructOnly:!0,nonNullable:!0})],c.GraphicReshapeTool.prototype,"view",void 0);d.__decorate([e.property({constructOnly:!0})],c.GraphicReshapeTool.prototype,"graphic",void 0);d.__decorate([e.property({constructOnly:!0,nonNullable:!0})],c.GraphicReshapeTool.prototype,"enableZShape",void 0);d.__decorate([e.property({constructOnly:!0,
nonNullable:!0})],c.GraphicReshapeTool.prototype,"enableZVertex",void 0);d.__decorate([e.property({constructOnly:!0,nonNullable:!0})],c.GraphicReshapeTool.prototype,"enableMoveGraphic",void 0);d.__decorate([e.property({constructOnly:!0,nonNullable:!0})],c.GraphicReshapeTool.prototype,"enableMidpoints",void 0);d.__decorate([e.property({constructOnly:!0,nonNullable:!0})],c.GraphicReshapeTool.prototype,"enableEdgeOffset",void 0);d.__decorate([e.property()],c.GraphicReshapeTool.prototype,"type",void 0);
d.__decorate([e.property({constructOnly:!0,type:n})],c.GraphicReshapeTool.prototype,"labelOptions",void 0);d.__decorate([e.property({constructOnly:!0,type:p})],c.GraphicReshapeTool.prototype,"tooltipOptions",void 0);d.__decorate([e.property({constructOnly:!0})],c.GraphicReshapeTool.prototype,"snappingManager",void 0);d.__decorate([e.property()],c.GraphicReshapeTool.prototype,"updating",null);d.__decorate([e.property()],c.GraphicReshapeTool.prototype,"automaticManipulatorSelection",void 0);c.GraphicReshapeTool=
d.__decorate([v.subclass("esri.views.3d.interactive.editingTools.graphicReshape3D.GraphicReshapeTool")],c.GraphicReshapeTool);Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})});
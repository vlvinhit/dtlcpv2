// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/Accessor ../../../../../core/HandleOwner ../../../../../core/mathUtils ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/accessorSupport/ensureType ../../../../../core/arrayUtils ../../../../../core/has ../../../../../core/accessorSupport/decorators/subclass ../../../../../chunks/vec3 ../../../../../geometry/support/axisAngleDegrees ../../../../../geometry/support/MeshTransform ../../../../ViewingMode ./undoRecords".split(" "),
function(e,p,b,x,y,t,q,d,C,D,E,u,z,l,v,w,A){e.ScaleRotateMeshAdapter=function(m){function h(a){a=m.call(this,a)||this;a._interactionState=null;return a}p._inherits(h,m);var f=h.prototype;f.initialize=function(){this.addHandles([q.when(()=>{const a=this._interactionState;return a&&a.angle!==a.previousAngle?{interactionState:a,angle:a.state.angle}:null},({interactionState:a})=>{this._updateMeshRotation(a)},q.sync),q.when(()=>{const a=this._interactionState;return a&&a.scale!==a.previousScale?{interactionState:a,
scale:a.state.scale}:null},({interactionState:a})=>{this._updateMeshSize(a)},q.sync)])};f.startInteraction=function(){const a=new k({angle:this.angle});this._interactionState=a;const g=()=>{this._interactionState=null};return{state:a,done:g,cancel:()=>{a.cancel();g()}}};f.createUndoRecord=function(){return A.createGraphicGeometryUndoRecord(this.graphic)};f._updateMeshRotation=function(a){const {angle:g,previousAngle:r}=a;a.previousAngle=g;var {geometry:c}=this;const {vertexSpace:n}=c;a=t.rad2deg(g-
r);n.isGeoreferenced?(this.geometry.rotate(0,0,a,{origin:this.geometry.anchor,geographic:!n.isRelative&&this.viewingMode===w.ViewingMode.Global}),this.graphic.notifyGeometryChanged()):(c.transform??(c.transform=new v),{transform:c}=c,a=l.composeAxes(0,0,a,B),c.rotation=l.compose(c.rotation,a,c.rotation),this.graphic.notifyMeshTransformChanged())};f._updateMeshSize=function(a){const {scale:g,previousScale:r}=a;a.previousScale=g;var {geometry:c}=this;const {vertexSpace:n}=c;a=g/r;n.isGeoreferenced?
(this.geometry.scale(a,{origin:this.geometry.anchor,geographic:!n.isRelative&&this.viewingMode===w.ViewingMode.Global}),this.graphic.notifyGeometryChanged()):(c.transform??(c.transform=new v),{transform:c}=c,c.scale=z.scale(c.scale,c.scale,a),this.graphic.notifyMeshTransformChanged())};p._createClass(h,[{key:"initialAngle",get:function(){return this._interactionState?.initialAngle??0}},{key:"angle",get:function(){const a=this.geometry.transform;if(null==a)return this._interactionState?.angle??0;const g=
l.axis(a.rotation)[2];return.999999<Math.abs(g)?t.deg2rad(l.angle(a.rotation))*Math.sign(g):0}},{key:"angleClockwise",get:function(){return-this.angle}},{key:"relativeAngle",get:function(){return this.angle-this.initialAngle}},{key:"relativeAngleClockwise",get:function(){return-this.relativeAngle}},{key:"scale",get:function(){return this._interactionState?.scale??1}}]);return h}(y.HandleOwner);b.__decorate([d.property({constructOnly:!0})],e.ScaleRotateMeshAdapter.prototype,"graphic",void 0);b.__decorate([d.property({constructOnly:!0})],
e.ScaleRotateMeshAdapter.prototype,"geometry",void 0);b.__decorate([d.property({constructOnly:!0})],e.ScaleRotateMeshAdapter.prototype,"viewingMode",void 0);b.__decorate([d.property()],e.ScaleRotateMeshAdapter.prototype,"initialAngle",null);b.__decorate([d.property()],e.ScaleRotateMeshAdapter.prototype,"angle",null);b.__decorate([d.property()],e.ScaleRotateMeshAdapter.prototype,"angleClockwise",null);b.__decorate([d.property()],e.ScaleRotateMeshAdapter.prototype,"relativeAngle",null);b.__decorate([d.property()],
e.ScaleRotateMeshAdapter.prototype,"relativeAngleClockwise",null);b.__decorate([d.property()],e.ScaleRotateMeshAdapter.prototype,"scale",null);b.__decorate([d.property()],e.ScaleRotateMeshAdapter.prototype,"_interactionState",void 0);e.ScaleRotateMeshAdapter=b.__decorate([u.subclass("esri.views.3d.interactive.editingTools.transformGraphic.ScaleRotateMeshAdapter")],e.ScaleRotateMeshAdapter);let k=function(m){function h(f){var a=m.call(this,f)||this;a.angle=0;a.initialAngle=0;a.previousAngle=0;a.previousScale=
1;a.scale=1;a.initialAngle=f.angle;a.previousAngle=f.angle;return a}p._inherits(h,m);h.prototype.cancel=function(){this.angle=this.initialAngle;this.scale=1};p._createClass(h,[{key:"state",get:function(){const {angle:f,scale:a}=this;return{angle:f,scale:a}}}]);return h}(x);b.__decorate([d.property()],k.prototype,"angle",void 0);b.__decorate([d.property()],k.prototype,"initialAngle",void 0);b.__decorate([d.property()],k.prototype,"previousAngle",void 0);b.__decorate([d.property()],k.prototype,"previousScale",
void 0);b.__decorate([d.property()],k.prototype,"scale",void 0);b.__decorate([d.property()],k.prototype,"state",null);k=b.__decorate([u.subclass("InteractionState")],k);const B=l.create();Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});
// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/mathUtils ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../chunks/vec4 ../../../../chunks/vec4f64 ../../../../geometry/projection ../../../../geometry/support/aaBoundingBox ../../../../geometry/support/vectorStacks ./VisualElementResources ../../layers/graphics/elevationAlignmentUtils ../../layers/graphics/ElevationContext ../../support/engineContent/sdfPrimitives ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/VertexAttribute ../../webgl-engine/materials/HUDMaterial".split(" "),
function(l,v,m,w,x,g,n,p,y,q,z,A,B,r,C,t,D){let G=function(){function k(a){this._geometry=this.view=null;this._size=3;this._color=n.fromValues(1,0,1,1);this._pixelSnappingEnabled=!0;this._primitive="square";this._outlineSize=1;this._outlineColor=n.fromValues(1,1,1,1);this._elevationInfo=null;this._resources=new z.VisualElementResources({view:a.view,createResources:c=>this._createResources(c),destroyResources:c=>this._destroyResources(c),recreateGeometry:(c,e)=>{c.geometry=this._recreateGeometry(e,
c.material)}});let b=!0;for(const c in a)c in this?"attached"===c?b=a[c]??!1:this[c]=a[c]:console.error("Cannot set unknown property",c);this.attached=b}var d=k.prototype;d.destroy=function(){this._resources.destroy()};d._updateMaterial=function(){const a=this._resources.resources;null!=a&&a.material.setParameters(this._materialParameters(a.texture.id))};d._updateSizeAttribute=function(){var a=this._resources.resources;const b=this._resources.object;if(null!=a&&null!=b&&(a=a.geometry,null!=a)){a=
a.getMutableAttribute(t.VertexAttribute.SIZE).data;var c=this._geometrySize;a[0]=c;a[1]=c;b.geometryVertexAttrsUpdated(b.geometries[0])}};d._materialParameters=function(a){return{color:this._color,textureIsSignedDistanceField:!0,distanceFieldBoundingBox:E,occlusionTest:!1,outlineColor:this._outlineColor,outlineSize:this._outlineSize,textureId:a,polygonOffset:!1,shaderPolygonOffset:0,drawInSecondSlot:!0,depthEnabled:!1,pixelSnappingEnabled:this.pixelSnappingEnabled}};d._recreateGeometry=function(a,
b){b=this._createRenderGeometry(b);null!=b&&a.addGeometry(b);return b};d._createResources=function(a){const b=r.createTexture(this._primitive,this._preferredTextureSize),c=new D.HUDMaterial(this._materialParameters(b.id));a=this._recreateGeometry(a,c);return{material:c,texture:b,geometry:a,forEach(e){e(b);e(c);null!=this.geometry&&e(this.geometry)}}};d._destroyResources=function(a){a.geometry=null;a.material.dispose();a.texture.dispose()};d.calculateMapBounds=function(a){if(null==this._resources.resources||
null==this._resources.resources.geometry)return!1;const b=this._resources.resources.geometry.vertexAttributes.get(t.VertexAttribute.POSITION);p.projectVectorToVector(b.data,this.view.renderCoordsHelper.spatialReference,u,this.view.spatialReference);y.expandWithBuffer(a,u);return!0};d._createRenderGeometry=function(a){var b=this.geometry;if(null==b)return null;const {renderCoordsHelper:c,elevationProvider:e}=this.view;var h=A.evaluateElevationAlignmentAtPoint(b,e,B.ElevationContext.fromElevationInfo(this.elevationInfo),
c);const F=w.set(q.sv3d.get(),b.x,b.y,h);h=q.sv3d.get();p.projectVectorToVector(F,b.spatialReference,h,c.spatialReference);b=this._geometrySize;return C.createPointGeometry(a,null,h,null,[b,b],[0,0,0,1])};v._createClass(k,[{key:"visible",get:function(){return this._resources.visible},set:function(a){this._resources.visible=a}},{key:"attached",get:function(){return this._resources.attached},set:function(a){this._resources.attached=a}},{key:"geometry",get:function(){return this._geometry},set:function(a){this._geometry=
a;this._resources.recreateGeometry()}},{key:"size",get:function(){return this._size},set:function(a){if(a!==this._size){const b=this._preferredTextureSize;this._size=a;b<this._preferredTextureSize?null!=this._resources&&this._resources.recreate():this._updateSizeAttribute()}}},{key:"color",get:function(){return this._color},set:function(a){g.exactEquals(a,this._color)||(g.copy(this._color,a),this._updateMaterial())}},{key:"pixelSnappingEnabled",get:function(){return this._pixelSnappingEnabled},set:function(a){this._pixelSnappingEnabled!==
a&&(this._pixelSnappingEnabled=a,this._updateMaterial())}},{key:"primitive",get:function(){return this._primitive},set:function(a){this._primitive!==a&&(this._primitive=a,null!=this._resources&&this._resources.recreate())}},{key:"outlineSize",get:function(){return this._outlineSize},set:function(a){a!==this._outlineSize&&(this._outlineSize=a,this._updateMaterial())}},{key:"outlineColor",get:function(){return this._outlineColor},set:function(a){g.exactEquals(a,this._outlineColor)||(g.copy(this._outlineColor,
a),this._updateMaterial())}},{key:"elevationInfo",get:function(){return this._elevationInfo},set:function(a){this._elevationInfo=a;this._resources&&this._resources.recreateGeometry()}},{key:"_geometrySize",get:function(){return this._size/f}},{key:"_preferredTextureSize",get:function(){return m.clamp(m.nextHighestPowerOfTwo(2*this._geometrySize),16,128)}}]);return k}();const f=r.DEFAULT_SYMBOL_SIZE_RATIO,E=[f/2,f/2,1-f/2,1-f/2],u=x.create();l.PointVisualElement=G;Object.defineProperty(l,Symbol.toStringTag,
{value:"Module"})});
// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/reactiveUtils ../../webgl-engine/lib/ContentObjectType ../../webgl-engine/lib/Object3D ../../webgl-engine/lib/Texture ../../webgl-engine/lib/UpdatePolicy ../../webgl-engine/lib/WebGLLayer".split(" "),function(l,q,m,e,r,t,u,v){let w=function(){function h(a){this._resourceFactory=a;this._resources=null;this._visible=!0;this._attached=!1}var c=h.prototype;c.destroy=function(){this._destroyResources()};c.recreate=function(){this.attached&&
this._createResources()};c.recreateGeometry=function(){if(this._resourceFactory.recreateGeometry){var a=this._resourceFactory.view._stage;if(null!=this._resources&&a){var d=this._resources.object;this._resources.external.forEach(b=>{b.type!==e.ContentObjectType.Mesh&&b.type!==e.ContentObjectType.Line&&b.type!==e.ContentObjectType.Point||a.remove(b)});d.removeAllGeometries();this._resourceFactory.recreateGeometry(this._resources.external,d,this._resources.layer);this._resources.external.forEach(b=>
{b.type!==e.ContentObjectType.Mesh&&b.type!==e.ContentObjectType.Line&&b.type!==e.ContentObjectType.Point||a.add(b)})}}else this.recreate()};c._createOrDestroyResources=function(){this._attached?this._resources||this._createResources():this._destroyResources()};c._createResources=function(){this._destroyResources();var a=this._resourceFactory;const d=a.view,b=d._stage;if(b){var k=new v.WebGLLayer(b,{pickable:!1,updatePolicy:u.UpdatePolicy.SYNC}),g=new r.Object3D({castShadow:!1}),n=a.createResources(g,
k);n.forEach(f=>{b.add(f);f instanceof t.Texture&&b.loadImmediate(f)});b.add(g);k.add(g);var p=a.cameraChanged;a=p?m.watch(()=>d.state.camera,f=>p(f),m.initial):null;this._resources={layer:k,object:g,external:n,cameraHandle:a};this._syncVisible()}};c._destroyResources=function(){if(null!=this._resources){var a=this._resourceFactory.view._stage;a&&(a.remove(this._resources.object),this._resources.layer.destroy(),this._resources.external.forEach(d=>a.remove(d)));this._resources.object.dispose();this._resources.cameraHandle?.remove();
this._resourceFactory.destroyResources(this._resources.external);this._resources=null}};c._syncVisible=function(){null!=this._resources&&(this._resources.object.visible=this._visible)};q._createClass(h,[{key:"object",get:function(){return null!=this._resources?this._resources.object:null}},{key:"resources",get:function(){return null!=this._resources?this._resources.external:null}},{key:"visible",get:function(){return this._visible},set:function(a){a!==this._visible&&(this._visible=a,this._syncVisible())}},
{key:"attached",get:function(){return this._attached},set:function(a){a!==this._attached&&(this._attached=a,this._createOrDestroyResources())}}]);return h}();l.VisualElementResources=w;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})});
// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/arrayUtils ../../../core/Handles ../../../core/handleUtils ../../../core/maybe ../../../core/reactiveUtils ../../../geometry/ellipsoidUtils ../layers/graphics/ObjectResourceCache ./index ./StreamTextureCollection ../webgl-engine/lib/screenSizePerspectiveUtils".split(" "),function(g,l,m,n,h,p,e,q,r,t,u,k){let x=function(){function f(a){this.streamDataRequester=null;this._graphicsOwners=[];this.cimSymbolRasterizer=this._screenSizePerspectiveHandles=
null;this._viewState=a.viewState;this._view=a.view;this._pointsOfInterest=a.pointsOfInterest;this.streamDataRequester=a.resourceController.createStreamDataRequester(t.ClientType.SYMBOLOGY);this.objectResourceCache=new r.ObjectResourceCache((v,w)=>a.resourceController.memoryController.newCache(v,w));this.textures=new u.StreamTextureCollection(this.streamDataRequester,a.view._stage,a.resourceController.scheduler);const b=q.getReferenceEllipsoid(this._view.spatialReference).radius;this.screenSizePerspectiveSettings=
k.getSettings(a.viewingMode,b);this.screenSizePerspectiveSettingsLabels=k.getLabelSettings(a.viewingMode,b)}var c=f.prototype;c.destroy=function(){this.textures.destroy();this.streamDataRequester=null};c.addGraphicsOwner=function(a){if(!a)return h.makeHandle();this._graphicsOwners.push(a);const b=e.watch(()=>a.layer?.screenSizePerspectiveEnabled,()=>this._updateScreenSizePerspectiveEnabled());this._updateScreenSizePerspectiveEnabled();return h.makeHandle(()=>{b.remove();m.removeUnordered(this._graphicsOwners,
a);this._updateScreenSizePerspectiveEnabled()})};c._updateScreenSizePerspectiveEnabled=function(){var a=this._graphicsOwners.some(b=>!0===b.layer?.screenSizePerspectiveEnabled);a&&!this._screenSizePerspectiveHandles?(this._screenSizePerspectiveHandles=new n,a=()=>this._updateScreenSizePerspectiveSettings(),this._screenSizePerspectiveHandles.add([e.watch(()=>this._pointsOfInterest.centerOnSurfaceInfrequent.distance,a,e.sync),this._viewState.events.on("camera-projection-changed",a)]),this._updateScreenSizePerspectiveSettings()):
a||(this._screenSizePerspectiveHandles=p.destroyMaybe(this._screenSizePerspectiveHandles))};c._updateScreenSizePerspectiveSettings=function(){d.distance=this._pointsOfInterest.centerOnSurfaceInfrequent.distance;d.fovY=this._viewState.camera.fovY;this.screenSizePerspectiveSettings.update(d);this.screenSizePerspectiveSettingsLabels.update(d);this._view._stage.renderView.requestRender()};l._createClass(f,[{key:"test",get:function(){return{screenSizePerspectiveHandles:this._screenSizePerspectiveHandles}}}]);
return f}();const d={distance:0,fovY:0};g.SharedSymbolResources=x;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})});
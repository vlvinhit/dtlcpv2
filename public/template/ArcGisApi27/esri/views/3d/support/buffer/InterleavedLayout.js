// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../geometry/support/buffer/BufferView","../../../../geometry/support/buffer/types","../../webgl-engine/lib/Util"],function(k,l,c,n,r){let m=function(){function e(a,b){this.layout=a;this.buffer="number"===typeof b?new ArrayBuffer(b*a.stride):b;for(const g of a.fields.keys())b=a.fields.get(g),this[g]=new b.constructor(this.buffer,b.offset,this.stride)}var d=e.prototype;d.getField=function(a,b){return(a=this[a])&&a.elementCount===
b.ElementCount&&a.elementType===b.ElementType?a:null};d.slice=function(a,b){return new e(this.layout,this.buffer.slice(a*this.stride,b*this.stride))};d.copyFrom=function(a,b=0,g=0,h=a.count){const f=this.stride;0===f%4?(a=new Uint32Array(a.buffer,b*f,h*f/4),(new Uint32Array(this.buffer,g*f,h*f/4)).set(a)):(a=new Uint8Array(a.buffer,b*f,h*f),(new Uint8Array(this.buffer,g*f,h*f)).set(a));return this};l._createClass(e,[{key:"stride",get:function(){return this.layout.stride}},{key:"count",get:function(){return this.buffer.byteLength/
this.stride}},{key:"byteLength",get:function(){return this.buffer.byteLength}}]);return e}(),q=function(){function e(a=null){this._lastAligned=this._stride=0;this._fields=new Map;a&&(this._stride=a.stride,a.fields.forEach(b=>this._fields.set(b[0],{...b[1],constructor:p.get(b[1].constructor)})))}var d=e.prototype;d.vec2f=function(a,b){this._appendField(a,c.BufferViewVec2f,b);return this};d.vec2f64=function(a,b){this._appendField(a,c.BufferViewVec2f64,b);return this};d.vec3f=function(a,b){this._appendField(a,
c.BufferViewVec3f,b);return this};d.vec3f64=function(a,b){this._appendField(a,c.BufferViewVec3f64,b);return this};d.vec4f=function(a,b){this._appendField(a,c.BufferViewVec4f,b);return this};d.vec4f64=function(a,b){this._appendField(a,c.BufferViewVec4f64,b);return this};d.mat3f=function(a,b){this._appendField(a,c.BufferViewMat3f,b);return this};d.mat3f64=function(a,b){this._appendField(a,c.BufferViewMat3f64,b);return this};d.mat4f=function(a,b){this._appendField(a,c.BufferViewMat4f,b);return this};
d.mat4f64=function(a,b){this._appendField(a,c.BufferViewMat4f64,b);return this};d.vec4u8=function(a,b){this._appendField(a,c.BufferViewVec4u8,b);return this};d.f32=function(a,b){this._appendField(a,c.BufferViewFloat,b);return this};d.f64=function(a,b){this._appendField(a,c.BufferViewFloat64,b);return this};d.u8=function(a,b){this._appendField(a,c.BufferViewUint8,b);return this};d.u16=function(a,b){this._appendField(a,c.BufferViewUint16,b);return this};d.i8=function(a,b){this._appendField(a,c.BufferViewInt8,
b);return this};d.vec2i8=function(a,b){this._appendField(a,c.BufferViewVec2i8,b);return this};d.vec2i16=function(a,b){this._appendField(a,c.BufferViewVec2i16,b);return this};d.vec2u8=function(a,b){this._appendField(a,c.BufferViewVec2u8,b);return this};d.vec4u16=function(a,b){this._appendField(a,c.BufferViewVec4u16,b);return this};d.u32=function(a,b){this._appendField(a,c.BufferViewUint32,b);return this};d._appendField=function(a,b,g){if(this._fields.has(a))r.assert(!1,`${a} already added to vertex buffer layout`);
else{var h=b.ElementCount*n.elementTypeSize(b.ElementType),f=this._stride;this._stride+=h;this._fields.set(a,{size:h,constructor:b,offset:f,optional:g})}};d.createBuffer=function(a){return new m(this,a)};d.createView=function(a){return new m(this,a)};d.clone=function(){const a=new e;a._stride=this._stride;a._fields=new Map;this._fields.forEach((b,g)=>a._fields.set(g,b));a.BufferType=this.BufferType;return a};l._createClass(e,[{key:"stride",get:function(){if(this._lastAligned!==this._fields.size){let a=
1;this._fields.forEach(b=>a=Math.max(a,n.elementTypeSize(b.constructor.ElementType)));this._stride=Math.floor((this._stride+a-1)/a)*a;this._lastAligned=this._fields.size}return this._stride}},{key:"fields",get:function(){return this._fields}}]);return e}(),t=l._createClass(function(e){this.fields=[];e.fields.forEach((d,a)=>{var b=d.constructor;this.fields.push([a,{...d,constructor:`${b.ElementType}_${b.ElementCount}`}])});this.stride=e.stride});const u=[c.BufferViewFloat,c.BufferViewVec2f,c.BufferViewVec3f,
c.BufferViewVec4f,c.BufferViewMat3f,c.BufferViewMat4f,c.BufferViewFloat64,c.BufferViewVec2f64,c.BufferViewVec3f64,c.BufferViewVec4f64,c.BufferViewMat3f64,c.BufferViewMat4f64,c.BufferViewUint8,c.BufferViewVec2u8,c.BufferViewVec3u8,c.BufferViewVec4u8,c.BufferViewUint16,c.BufferViewVec2u16,c.BufferViewVec3u16,c.BufferViewVec4u16,c.BufferViewUint32,c.BufferViewVec2u32,c.BufferViewVec3u32,c.BufferViewVec4u32,c.BufferViewInt8,c.BufferViewVec2i8,c.BufferViewVec3i8,c.BufferViewVec4i8,c.BufferViewInt16,c.BufferViewVec2i16,
c.BufferViewVec3i16,c.BufferViewVec4i16,c.BufferViewInt32,c.BufferViewVec2i32,c.BufferViewVec3i32,c.BufferViewVec4i32],p=new Map;u.forEach(e=>p.set(`${e.ElementType}_${e.ElementCount}`,e));k.InterleavedBuffer=m;k.InterleavedLayout=q;k.PackedLayout=t;k.newLayout=function(){return new q};Object.defineProperty(k,Symbol.toStringTag,{value:"Module"})});
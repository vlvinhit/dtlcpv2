// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/vec3f64 ../../../geometry/projection ../../../geometry/SpatialReference ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/spatialReferenceUtils ./ITile ./PatchGeometryFactory ./Tile ../webgl-engine/materials/internal/MaterialUtil".split(" "),function(w,h,q,x,k,D,E,F,r,t,y,G){let H=function(z){function g(a,b,c){var d=z.call(this)||this;d._horizontalScaleFactor=1;d._extentInRenderSR=
E.create();void 0!==a&&d.init(a,b,c);return d}h._inherits(g,z);var e=g.prototype;e.init=function(a,b,c){h._get(h._getPrototypeOf(g.prototype),"init",this).call(this,a,b,c);a=c.view.renderSpatialReference;c=c.spatialReference;this._horizontalScaleFactor=b=null!=a&&F.isPlateCarree(a)&&null!=c&&c.isGeographic?this.ellipsoid.radius*Math.PI/180:1;c=this._extentInRenderSR;a=this.extent;if(this.surface.isWebMercatorOnPlateeCarree)b=q.fromValues(a[0],a[1],0),x.projectVectorToVector(b,k.WebMercator,b,k.PlateCarree),
a=q.fromValues(a[2],a[3],0),x.projectVectorToVector(a,k.WebMercator,a,k.PlateCarree),c[0]=b[0],c[1]=b[1],c[2]=a[0],c[3]=a[1];else for(let d=0;4>d;++d)c[d]=a[d]*b;this.centerAtSeaLevel[0]=.5*(c[0]+c[2]);this.centerAtSeaLevel[1]=.5*(c[1]+c[3]);this.centerAtSeaLevel[2]=0;this._edgeLen=Math.max(c[2]-c[0],c[3]-c[1]);this._edgeLen2=this._edgeLen*this._edgeLen;this.updateRadiusAndCenter()};e.updateRadiusAndCenter=function(){this._updateCenter();var a=this._extentInRenderSR;const b=.5*(a[2]-a[0]);a=.5*(a[3]-
a[1]);this._center[y.CenterPosition.MIDDLE][3]=Math.max(Math.sqrt(b*b+a*a),.5*(this.elevationBounds[0]-this.elevationBounds[1]))};e._calculateFrustumVisibilityStatus=function(a){var b=this._aabb();const c=b[0],d=b[1],A=b[2],B=b[3],C=b[4];b=b[5];let u=!0;for(let v=0;6>v;v++){var f=a[v];const l=f[0],m=f[1],n=f[2];f=f[3];if(0<=l*(0<l?c:B)+m*(0<m?d:C)+n*(0<n?A:b)+f)return r.TileFrustumVisibility.OUTSIDE;u=u&&0>=l*(0>l?c:B)+m*(0>m?d:C)+n*(0>n?A:b)+f}return u?r.TileFrustumVisibility.INSIDE:r.TileFrustumVisibility.INTERSECTS};
e._aabb=function(){const a=this._extentInRenderSR;return D.wrap(a[0],a[1],this.elevationBounds[0],a[2],a[3],this.elevationBounds[1])};e.intersectsRay=function(a,b,c,d){p[0]=1/b[0];p[1]=1/b[1];p[2]=1/b[2];return G.intersectAabbInvDirBefore(this._aabb(),a,p,c,d)};e.createGeometry=function(){t.createPlanarGlobePatch(this.renderData,this._horizontalScaleFactor);this.setMemoryDirty()};e.getDefaultVerticesPerSide=function(){return 9>this.level?3:2};e.updateCornerElevations=function(){t.updateCornersPlanar(this.renderData,
this._horizontalScaleFactor)};e.updateEdgeElevations=function(){t.updateEdgesAndCornersPlanar(this.renderData,this._horizontalScaleFactor)};h._createClass(g,[{key:"horizontalScale",get:function(){return this._horizontalScaleFactor}}]);return g}(y.Tile);const p=q.create();w.PlanarPatch=H;Object.defineProperty(w,Symbol.toStringTag,{value:"Module"})});
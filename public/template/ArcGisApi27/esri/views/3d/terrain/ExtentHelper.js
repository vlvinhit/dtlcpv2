// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../geometry/projection ../../../geometry/support/aaBoundingRect ../../../layers/support/layerUtils ../../ViewingMode ./TerrainConst ./terrainUtils".split(" "),function(c,p,e,C,m,F,G,H,r,D,g,E,w,x,y){function z(b,
a){return null==b||b.spatialReference.equals(a)?b:D.projectWithoutEngine(b,b.spatialReference,a)}c.ExtentHelper=function(b){function a(d){return b.call(this,d)||this}p._inherits(a,b);var k=a.prototype;k.initialize=function(){this.addHandles([this.layerViews.on("change",()=>this.notifyChange("stencilEnabledExtents"))])};k.destroy=function(){};k._computeStencilEnabledExtents=function(){const d=[];this.layerViews.forEach(f=>{f=f.layer;"IntegratedMeshLayer"===f.operationalLayerType&&null!=this.viewSpatialReference&&
(f=z(f.fullExtent,this.viewSpatialReference),null!=f&&d.push(g.fromExtent(f)))});return d};p._createClass(a,[{key:"layerViewsExtent",get:function(){return this._computeLayerViewsExtent()}},{key:"tiledLayersExtent",get:function(){return this._computeTiledLayersExtent()}},{key:"stencilEnabledExtents",get:function(){return this._computeStencilEnabledExtents()}}]);return a}(C);e.__decorate([m.property({readOnly:!0})],c.ExtentHelper.prototype,"layerViewsExtent",null);e.__decorate([m.property({readOnly:!0})],
c.ExtentHelper.prototype,"tiledLayersExtent",null);e.__decorate([m.property({readOnly:!0})],c.ExtentHelper.prototype,"stencilEnabledExtents",null);e.__decorate([m.property()],c.ExtentHelper.prototype,"viewSpatialReference",void 0);e.__decorate([m.property()],c.ExtentHelper.prototype,"tilingScheme",void 0);e.__decorate([m.property()],c.ExtentHelper.prototype,"defaultTiledLayersExtent",void 0);e.__decorate([m.property({constructOnly:!0})],c.ExtentHelper.prototype,"layers",void 0);e.__decorate([m.property({constructOnly:!0})],
c.ExtentHelper.prototype,"layerViews",void 0);c.ExtentHelper=e.__decorate([r.subclass("esri.views.3d.terrain.ExtentHelper")],c.ExtentHelper);let t=function(b){function a(){return b.apply(this,arguments)||this}p._inherits(a,b);var k=a.prototype;k._computeLayerViewsExtent=function(){return this._globalExtent};k._computeTiledLayersExtent=function(){return this._globalExtent};p._createClass(a,[{key:"_globalExtent",get:function(){return this.viewSpatialReference.isWebMercator?x.WEBMERCATOR_WORLD_EXTENT:
x.GEOGRAPHIC_WORLD_EXTENT}}]);return a}(c.ExtentHelper);t=e.__decorate([r.subclass("esri.views.3d.terrain.ExtentHelperGlobal")],t);let v=function(b){function a(){return b.apply(this,arguments)||this}p._inherits(a,b);var k=a.prototype;k._computeLayerViewsExtent=function(){const d=g.empty(),f=this.viewSpatialReference;this.layerViews.forEach(h=>{const n=h.layer;!h.isResolved()||"graphics"===n.type&&n.internal||(h=z("fullExtentInLocalViewSpatialReference"in h&&h.fullExtentInLocalViewSpatialReference||
h.layer.fullExtent,f),g.expand(d,h,d))});const l=g.allFinite(d)?d:null,q=this._get("layerViewsExtent");return g.equals(l,q)?q:l};k._computeTiledLayersExtent=function(){const d=this.tilingScheme;if(!d)return null;const f=this.viewSpatialReference,l=g.empty();this.layers.forEach(n=>{if(n.loaded&&E.isTiledLayer(n)){const A=y.getTiledLayerInfo(n,f,w.ViewingMode.Local);if(null!=A){var {tileInfo:B,fullExtent:u}=A;null!=B&&null!=u&&(y.isProjectableRasterLayer(n)||d.compatibleWith(B)&&u.spatialReference.equals(d.spatialReference))&&
g.expand(l,u,l)}}});g.expand(l,this.defaultTiledLayersExtent,l);const q=g.allFinite(l)?l:null,h=this._get("tiledLayersExtent");return g.equals(q,h)?h:q};return p._createClass(a)}(c.ExtentHelper);v=e.__decorate([r.subclass("esri.views.3d.terrain.ExtentHelperLocal")],v);c.create=function(b,a){return b===w.ViewingMode.Global?new t(a):new v(a)};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})});
// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/mathUtils ../../../layers/support/ElevationSamplerData ../support/mathUtils ./TerrainConst".split(" "),function(t,y,w,z,r,x){let A=function(){function q(a,b,d){this.type="elevation";this.level=a[0];this.i=a[1];this.j=a[2];this.extent=b;this.samplerData=new z.ElevationSamplerData(d,b)}q.prototype.computeMinMaxValue=function(a,b,d,e){e.min=Infinity;e.max=-Infinity;e.hasNoDataValues=!1;a-=this.level;if(0>=a)return e;var c=2**a;if(Math.floor(b/
c)!==this.i||Math.floor(d/c)!==this.j)return e;var f=Infinity,g=-Infinity,h=this.samplerData.data.width,k=this.samplerData.data.values,l=.5*x.ELEVATION_NODATA_VALUE;a=(h-1)/c;d=(d-this.j*c)*a;let m=(b-this.i*c)*a;if(1>a){const u=Math.floor(d),v=Math.floor(m);var n=u+v*h;b=k[n];c=k[n+1];var p=k[n+h];n=k[n+h+1];if(b+c+p+n<l)return f=d-u,l=m-v,g=r.bilerp(b,c,p,n,f,l),h=r.bilerp(b,c,p,n,f+a,l),k=r.bilerp(b,c,p,n,f,l+a),a=r.bilerp(b,c,p,n,f+a,l+a),e.min=Math.min(g,h,k,a),e.max=Math.max(g,h,k,a),e;d=u;
m=v;a=1}else d=Math.floor(d),m=Math.floor(m),a=Math.ceil(a);for(b=d;b<=d+a;b++)for(c=m;c<=m+a;c++)p=k[b+c*h],p<l?(f=Math.min(f,p),g=Math.max(g,p)):e.hasNoDataValues=!0;e.min=f;e.max=g;return e};return y._createClass(q)}();const B=.5*x.ELEVATION_NODATA_VALUE;t.ElevationData=A;t.sampleElevation=function(q,a,b){if(null==b)return null;for(const g of b){if(!g)continue;var d=g.safeWidth;b=w.clamp(g.dy*(g.y1-a),0,d);d=w.clamp(g.dx*(q-g.x0),0,d);const h=Math.floor(b),k=Math.floor(d);var e=g.data.width,c=
h*e+k,f=g.data.values;const l=f[c],m=f[c+1];c+=e;e=f[c];f=f[c+1];if(l+e+m+f<B)return b-=h,d-=k,q=l+(m-l)*d,q+(e+(f-e)*d-q)*b}return null};Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})});
// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/mat4f64 ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../geometry/ellipsoidUtils ../../../../geometry/projection ../../../../geometry/support/DoubleArray ../../../../geometry/support/plane ../../../ViewingMode".split(" "),function(C,K,D,I,b,n,L,M,N,E,O){function F(p,g,c,a,h,d,e){b.set(p,g*h[0]+c*d[0]+a*e[0],g*h[1]+c*d[1]+a*e[1],g*h[2]+c*d[2]+a*e[2])}const G=n.create(),x=n.create(),J=E.create(),l=n.create(),
k=n.create(),y=n.create(),f=I.create(),u=I.create(),r=n.create(),v=n.create(),w=n.create(),q=K.create(),A=n.create(),B=n.create(),H=n.create(),t=n.create();C.createMapSpaceUVCoords=function(p,g,c,a,h=1){b.set(l,1,0,0);b.set(k,0,1,0);b.set(y,0,0,1);b.set(t,0,0,0);for(var d=0;d<c.length-3;d+=3)t[0]+=c[d],t[1]+=c[d+1],t[2]+=c[d+2];b.scale(G,t,1/(c.length/3-1));d=c.length/3-1;if(E.fromManyPointsSampleAt(c,J,0,Math.floor(d/3),Math.floor(2/3*d))){null!=a?(a.basisMatrixAtPosition(G,q),b.set(A,q[0],q[1],
q[2]),b.set(B,q[4],q[5],q[6]),b.set(H,q[8],q[9],q[10])):(b.set(A,1,0,0),b.set(B,0,1,0),b.set(H,0,0,1));a=E.normal(J);0>b.dot(a,H)&&b.scale(a,a,-1);b.copy(y,a);d=b.dot(a,B);var e=b.dot(a,A);Math.abs(d)<Math.abs(e)?(b.scaleAndAdd(l,A,a,-e),b.normalize(l,l),b.cross(k,l,a),b.normalize(k,k),b.scale(k,k,-1)):(b.scaleAndAdd(k,B,a,-d),b.normalize(k,k),b.cross(l,k,a),b.normalize(l,l))}D.set(f,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);D.set(u,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(a=
0;a<c.length;a+=3)b.set(x,c[a],c[a+1],c[a+2]),d=b.dot(l,x),e=b.dot(k,x),f[0]=Math.min(f[0],d),f[1]=Math.min(f[1],e),u[0]=Math.max(u[0],d),u[1]=Math.max(u[1],e);a=b.dot(y,G);F(r,f[0],f[1],a,l,k,y);F(v,u[0],f[1],a,l,k,y);F(w,f[0],u[1],a,l,k,y);b.subtract(v,v,r);b.scale(v,v,.5);b.subtract(w,w,r);b.scale(w,w,.5);b.add(r,r,v);b.add(r,r,w);a=f[0]-f[0]%h;d=f[1]-f[1]%h;for(e=0;e<c.length;e+=3){b.set(x,c[e],c[e+1],c[e+2]);var z=e/3,m=4*z;p[m]=(b.dot(l,x)-a)/h;p[m+1]=(b.dot(k,x)-d)/h;p[m+2]=a/h;p[m+3]=d/h;
z*=9;for(m=0;3>m;m++)g[z+m]=r[m],g[z+m+3]=v[m],g[z+m+6]=w[m]}};C.createMapSpaceUVCoordsDraped=function(p,g,c,a,h=1){if(c.isGeographic&&a===O.ViewingMode.Global){a=N.newDoubleArray(g.length);var d=g.length;c=L.getReferenceEllipsoid(c);for(var e=0;e<d;e+=3)M.lonLatToWebMercatorComparable(g,e,a,e,c);g=a}D.set(f,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);for(a=0;a<g.length;a+=3)f[0]=Math.min(f[0],g[a]),f[1]=Math.min(f[1],g[a+1]);a=f[0]-f[0]%h;d=f[1]-f[1]%h;for(c=0;c<g.length;c+=3)e=c/3*4,p[e]=
(g[c]-a)/h,p[e+1]=(g[c+1]-d)/h,p[e+2]=a/h,p[e+3]=d/h};Object.defineProperty(C,Symbol.toStringTag,{value:"Module"})});
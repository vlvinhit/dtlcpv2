// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Accessor ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/decorators/subclass ../../../../layers/graphics/dehydratedFeatures ../../../../rest/query/operations/query ../../support/PBFDecoder".split(" "),function(v,
g,f,q,z,w,h,C,D,E,r,x,y,A){let l=function(a){function c(b){return a.call(this,b)||this}g._inherits(c,a);var d=c.prototype;d.queryFeatureCount=function(b,e){return this.layer.queryFeatureCount(b,e)};d.destroy=function(){this._decoder=z.destroyMaybe(this._decoder)};d._createRequestOptions=function(b){return{...b,query:{...this.layer.customParameters,token:this.layer.apiKey,...b?.query}}};g._createClass(c,[{key:"queryFeaturesDehydrated",get:function(){var b=this.layer.capabilities;b=b&&b.query;const e=
this.layer.parsedUrl;if(b&&b.supportsFormatPBF){null==this._decoder&&(this._decoder=new A.PBFDecoder(this.controller));const k={sourceSpatialReference:this.layer.spatialReference?.toJSON()??null,applyTransform:!0,maxStringAttributeLength:1024};return(u,m)=>y.runQuery(e,u,"pbf",this._createRequestOptions(m)).then(B=>{w.throwIfAborted(m);return null!=this._decoder?this._decoder.invoke({buffer:B.data,options:k},m.signal):Promise.reject(w.createAbortError())})}return(k,u)=>y.executeQuery(e,k,this.layer.spatialReference,
this._createRequestOptions(u)).then(m=>x.fromFeatureSetJSON(m.data))}}]);return c}(q);f.__decorate([h.property({constructOnly:!0})],l.prototype,"layer",void 0);f.__decorate([h.property({constructOnly:!0})],l.prototype,"controller",void 0);f.__decorate([h.property({readOnly:!0})],l.prototype,"queryFeaturesDehydrated",null);l=f.__decorate([r.subclass("esri.views.3d.layers.support.featureTileQuery3D.FeatureTileServiceQuery3D")],l);let n=function(a){function c(b){return a.call(this,b)||this}g._inherits(c,
a);var d=c.prototype;d.queryFeaturesDehydrated=function(b,e){return this.layer.queryFeatures(b,e)};d.queryFeatureCount=function(b,e){return this.layer.queryFeatureCount(b,e)};return g._createClass(c)}(q);f.__decorate([h.property({constructOnly:!0})],n.prototype,"layer",void 0);f.__decorate([h.property({readOnly:!0})],n.prototype,"queryFeaturesDehydrated",null);n=f.__decorate([r.subclass("esri.views.3d.layers.support.featureTileQuery3D.FeatureTileServiceMeshQuery3D")],n);let t=function(a){function c(d){return a.call(this,
d)||this}g._inherits(c,a);c.prototype.queryFeaturesDehydrated=function(d,b){return this.layer.queryFeatures(d,b)};return g._createClass(c)}(q);f.__decorate([h.property({constructOnly:!0})],t.prototype,"layer",void 0);t=f.__decorate([r.subclass("esri.views.3d.layers.support.featureTileQuery3D.FeatureTileServiceQuery3D")],t);let p=function(a){function c(b){return a.call(this,b)||this}g._inherits(c,a);var d=c.prototype;d.queryFeaturesDehydrated=function(b,e){return this.source.queryFeaturesJSON(b,e).then(x.fromFeatureSetJSON,
k=>{if(k&&"query-features-json:unsupported"===k.name)return this.layer.queryFeatures(b,e);throw k;})};d.queryFeatureCount=function(b,e){return this.layer.queryFeatureCount(b,e)};return g._createClass(c)}(q);f.__decorate([h.property({constructOnly:!0})],p.prototype,"layer",void 0);f.__decorate([h.property({constructOnly:!0})],p.prototype,"source",void 0);p=f.__decorate([r.subclass("esri.views.3d.layers.support.featureTileQuery3D.FeatureTileClientQuery3D")],p);v.createFeatureTileQuery3D=function(a,
c){return"feature"===a.type&&"feature-layer"===a.source.type?null!=a.infoFor3D?new n({layer:a}):new l({layer:a,controller:c}):"feature"===a.type&&"memory"===a.source.type||"csv"===a.type||"geojson"===a.type||"oriented-imagery"===a.type||"wfs"===a.type?new p({layer:a,source:a.source}):"ogc-feature"===a.type?new t({layer:a}):null};Object.defineProperty(v,Symbol.toStringTag,{value:"Module"})});
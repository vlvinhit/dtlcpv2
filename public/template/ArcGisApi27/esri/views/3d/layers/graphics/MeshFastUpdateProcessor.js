// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../webgl-engine/materials/DefaultMaterial"],function(l,m,n){let p=function(){function h(){this._fastTransformOriginalMaterials=new Map;this._fastTransformClonedMaterials=new Map;this._graphicReferenceCount=0}var c=h.prototype;c.enable=function(a,b,g){a.enableFastTransformUpdates(e=>{if(1>=this._graphicReferenceCount){if(this._fastTransformOriginalMaterials.has(e))return e;var f=b.byMaterial(e);this._fastTransformOriginalMaterials.set(e,
f);b.delete(e);return e}f=new n.DefaultMaterial(e.parameters);g.stage.add(f);this._fastTransformClonedMaterials.set(f,e);return f},g.localOriginFactory)};c.disable=function(a,b,g){const e=new Set,f=new Set;a.disableFastTransformUpdates(d=>{if(!this._fastTransformClonedMaterials.has(d)){var k=this._fastTransformOriginalMaterials.get(d);if(b.has(k.uid))return e.add(d),b.byUid(k.uid).material;f.add(d);return k.material}k=this._fastTransformClonedMaterials.get(d);this._fastTransformClonedMaterials.delete(d);
g.stage.remove(d);d.dispose();return k});for(const d of e)this._fastTransformOriginalMaterials.delete(d),g.stage.remove(d),d.dispose();for(const d of f)a=this._fastTransformOriginalMaterials.get(d),this._fastTransformOriginalMaterials.delete(d),b.set(a.uid,a)};c.onAddGraphic=function(){this._graphicReferenceCount++};c.onRemoveGraphic=function(a,b,g){this._graphicReferenceCount--;this.disable(a,b,g)};c.forEachMaterialInfo=function(a){this._fastTransformOriginalMaterials.forEach(a)};c.forEachClonedMaterial=
function(a){this._fastTransformClonedMaterials.forEach(a)};c.destroy=function(a){a.removeMany(Array.from(this._fastTransformClonedMaterials.keys()));a.removeMany(Array.from(this._fastTransformOriginalMaterials.values(),({material:b})=>b));this._fastTransformClonedMaterials.clear();this._fastTransformOriginalMaterials.clear()};return m._createClass(h)}(),q=function(){function h(){this._byUid=new Map;this._byMaterial=new Map}var c=h.prototype;c.byUid=function(a){return this._byUid.get(a)};c.byMaterial=
function(a){return this._byMaterial.get(a)};c.set=function(a,b){this._byUid.set(a,b);this._byMaterial.set(b.material,b)};c.delete=function(a){const b=this._byMaterial.get(a)?.uid;b&&(this._byUid.delete(b),this._byMaterial.delete(a))};c.has=function(a){return this._byUid.has(a)};c.forEachMaterialInfo=function(a){this._byUid.forEach(a)};c.clear=function(){this._byUid.clear();this._byMaterial.clear()};m._createClass(h,[{key:"materials",get:function(){return Array.from(this._byUid.values(),a=>a.material)}}]);
return h}();l.MaterialInfoCache=q;l.MeshFastUpdateProcessor=p;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})});
// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/promiseUtils ../../glTF/DefaultLoadingContext ../../glTF/loader ./wosrLoader".split(" "),function(m,p,q,k,r,t,u){let v=function(){function n(a){this._gltfLoading=new Map;this._wosrLoading=new Map;this._gltfMemCache=a("gltf-resources",()=>{});this._wosrMemCache=a("wosr-resources",()=>{})}var g=n.prototype;g.destroy=function(){this._gltfLoading.forEach(a=>a.abortController.abort());this._wosrLoading.forEach(a=>
a.abortController.abort());this._gltfMemCache.destroy();this._wosrMemCache.destroy()};g.loadGLTF=function(a,c,b){const d=b?`gltfPBR:${a}`:`gltf:${a}`,e=this._gltfMemCache.get(d);return null!=e?Promise.resolve(e):this._loadOnce(this._gltfLoading,this._gltfMemCache,d,h=>t.loadGLTF(new r.DefaultLoadingContext(h.streamDataRequester),a,h,b),c)};g.loadWOSR=function(a,c){const b=`wosr:${a}:${c.disableTextures}`,d=this._wosrMemCache.get(b);return null!=d?Promise.resolve(d):this._loadOnce(this._wosrLoading,
this._wosrMemCache,b,e=>u.load(a,e),c)};g._loadOnce=async function(a,c,b,d,e){k.throwIfAborted(e);const h=k.onAbort(e,()=>this._abortLoad(a,b));var f=a.get(b);f?f.refCount++:(f=new AbortController,d=d({...e,signal:f.signal}),f={refCount:1,abortController:f,promise:d},a.set(b,f));try{const l=await f.promise;c.put(b,l,l.size);a.delete(b);k.throwIfAborted(e);return l}finally{q.removeMaybe(h)}};g._abortLoad=function(a,c){const b=a.get(c);null!=b&&0<--b.refCount||(a.delete(c),null!=b&&b.abortController.abort())};
return p._createClass(n)}();m.ObjectResourceCache=v;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})});
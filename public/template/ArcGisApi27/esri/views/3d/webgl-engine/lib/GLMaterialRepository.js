// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Logger ../../../../core/maybe ../../../../core/NestedMap ./Util".split(" "),function(f,g,h,k,l,m){let q=function(){function e(a,b,c,n){this._textureRepository=a;this._techniqueRepository=b;this.materialChanged=c;this.requestRender=n;this._id2glMaterialRef=new l.NestedMap}var d=e.prototype;d.dispose=function(){this._textureRepository.destroy()};d.acquire=function(a,b,c){this._ownMaterial(a);if(!a.requiresSlot(b,c))return null;
b=this._id2glMaterialRef.get(c,a.id);null==b&&(b=a.createGLMaterial({material:a,techniqueRep:this._techniqueRepository,textureRep:this._textureRepository,output:c}),b=new p(b),this._id2glMaterialRef.set(c,a.id,b));b.ref();return b.glMaterial};d.release=function(a,b){const c=this._id2glMaterialRef.get(b,a.id);null!=c&&(c.unref(),c.referenced||(k.disposeMaybe(c.glMaterial),this._id2glMaterialRef.delete(b,a.id)))};d._ownMaterial=function(a){null!=a.repository&&a.repository!==this&&h.getLogger("esri.views.3d.webgl-engine.lib.GLMaterialRepository").error("Material is already owned by a different material repository");
a.repository=this};return g._createClass(e)}(),p=function(){function e(a){this.glMaterial=a;this._refCnt=0}var d=e.prototype;d.ref=function(){++this._refCnt};d.unref=function(){--this._refCnt;m.assert(0<=this._refCnt)};g._createClass(e,[{key:"referenced",get:function(){return 0<this._refCnt}}]);return e}();f.GLMaterialRepository=q;Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})});
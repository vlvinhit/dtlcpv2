// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../chunks/vec4f64 ../../../../geometry/support/FloatArray ../../../../geometry/support/Indices ./Attribute ./Normals ./VertexAttribute ../materials/internal/MaterialUtil".split(" "),function(C,l,k,H,y,D,P,J,Q,n,R,c,S){let I=function(){function m(e){this.builder=e}m.prototype.onPathChanged=function(e){this.builder.onPathChanged()};
return l._createClass(m)}(),O=function(m){function e(a){a=m.call(this,a)||this;a.vertexAttributeColor=P.fromValues(255,255,255,255);a.size=[];a.vertexAttributePosition=J.newFloatArray(3*a.builder.numVerticesTotal);a.vertexAttributeNormal=new Int16Array(2*a.builder.numVerticesTotal);return a}l._inherits(e,m);var p=e.prototype;p.bakeVertexColors=function(a){this.vertexAttributeColor[0]=255*a[0];this.vertexAttributeColor[1]=255*a[1];this.vertexAttributeColor[2]=255*a[2];this.vertexAttributeColor[3]=
255*(3<a.length?a[3]:1)};p.bake=function(a){this.size=a;const {numVerticesTotal:v,pathVertexData:w,path:r,positions:b,profileRightAxes:z,profileUpAxes:A,profileVertexAndNormals:E}=this.builder;for(let x=0;x<v;++x){var g=w[x],d=0===g||g===r.vertices.length-1;g*=3;const q=T;let F=0,G=0;const f=4*x,t=y.set(U,z[f],z[f+1],z[f+2]),u=y.set(V,A[f],A[f+1],A[f+2]);var h=k.set(K,E[f]*a[0],E[f+1]*a[1]);if(d)y.cross(q,u,t),F=z[f+3]*a[0],G=A[f+3];else{d=W;const B=X;k.set(d,z[f+3],A[f+3]);const L=k.length(d);k.normalize(d,
d);const M=k.dot(h,d);if(Math.abs(M)>L){k.set(B,-d[1],d[0]);const Y=k.dot(h,B);k.scale(d,d,L*Math.sign(M));k.scale(B,B,Y);k.add(h,d,B)}y.set(q,0,0,0)}h=y.set(Z,t[0]*h[0]+u[0]*h[1],t[1]*h[0]+u[1]*h[1],t[2]*h[0]+u[2]*h[1]);d=3*x;this.vertexAttributePosition[d]=b[g]+h[0]+q[0]*F;this.vertexAttributePosition[d+1]=b[g+1]+h[1]+q[1]*F;this.vertexAttributePosition[d+2]=b[g+2]+h[2]+q[2]*F;g=k.set(K,E[f+2],E[f+3]);R.compressNormal(this.vertexAttributeNormal,x,t[0]*g[0]+u[0]*g[1]+q[0]*G,t[1]*g[0]+u[1]*g[1]+q[1]*
G,t[2]*g[0]+u[2]*g[1]+q[2]*G)}};p.createGeometryData=function(){const a=this.builder.vertexIndices.length;return new N([[c.VertexAttribute.POSITION,new n.Attribute(this.vertexAttributePosition,3,!0)],[c.VertexAttribute.NORMALCOMPRESSED,new n.Attribute(this.vertexAttributeNormal,2,!0)],[c.VertexAttribute.COLOR,new n.Attribute(this.vertexAttributeColor,4)]],[[c.VertexAttribute.POSITION,this.builder.vertexIndices],[c.VertexAttribute.NORMALCOMPRESSED,this.builder.normalIndices],[c.VertexAttribute.COLOR,
Q.getZeroIndexArray(a)]])};p.onPathChanged=function(a){l._get(l._getPrototypeOf(e.prototype),"onPathChanged",this).call(this,a);this.bake(this.size)};p.intersect=function(a,v,w){const r=this.builder.vertexIndices,b=new n.Attribute(this.vertexAttributePosition,3);S.intersectTriangles(a,v,0,r.length/3,r,b,void 0,void 0,w)};return l._createClass(e)}(I),aa=function(m){function e(a,v,w,r){var b=m.call(this,a)||this;b.sizeAttributeValue=v;b.colorAttributeValue=w;b.opacityAttributeValue=r;b.vvData=null;
b.baked=new O(a);b.vvData=J.newFloatArray(4*b.builder.path.vertices.length);for(a=0;a<b.builder.path.vertices.length;++a)b.vvData[4*a]=v,b.vvData[4*a+1]=w,b.vvData[4*a+2]=r,b.vvData[4*a+3]=0===a||a===b.builder.path.vertices.length-1?1:0;return b}l._inherits(e,m);var p=e.prototype;p.createGeometryData=function(){return new N([[c.VertexAttribute.POSITION,new n.Attribute(this.builder.positions,3,!0)],[c.VertexAttribute.PROFILERIGHT,new n.Attribute(this.builder.profileRightAxes,4,!0)],[c.VertexAttribute.PROFILEUP,
new n.Attribute(this.builder.profileUpAxes,4,!0)],[c.VertexAttribute.PROFILEVERTEXANDNORMAL,new n.Attribute(this.builder.profileVertexAndNormals,4,!0)],[c.VertexAttribute.FEATUREVALUE,new n.Attribute(this.vvData,4,!0)]],[[c.VertexAttribute.POSITION,this.builder.pathVertexIndices],[c.VertexAttribute.PROFILERIGHT,this.builder.vertexIndices],[c.VertexAttribute.PROFILEUP,this.builder.vertexIndices],[c.VertexAttribute.PROFILEVERTEXANDNORMAL,this.builder.vertexIndices],[c.VertexAttribute.FEATUREVALUE,this.builder.pathVertexIndices]])};
p.onPathChanged=function(a){l._get(l._getPrototypeOf(e.prototype),"onPathChanged",this).call(this,a);if(a=a.getMutableAttribute(c.VertexAttribute.POSITION))a.data=this.builder.positions};return l._createClass(e)}(I),N=l._createClass(function(m,e){this.vertexAttributes=m;this.indices=e});const K=H.create(),W=H.create(),X=H.create(),Z=D.create(),T=D.create(),U=D.create(),V=D.create();C.FastUpdatePathGeometry=aa;C.PathGeometryData=I;C.StaticPathGeometry=O;Object.defineProperty(C,Symbol.toStringTag,{value:"Module"})});
// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/mat4f64 ../../../../chunks/vec3 ../../../../geometry/support/Indices ./AttributeArray ./basicInterfaces ./BoundingInfo ./ContentObject ./ContentObjectType ./geometryDataUtils ./Object3DStateID ./Util ./VertexAttribute ../materials/renderers/utils".split(" "),function(u,v,q,y,r,z,A,B,t,n,p,C,D,f,w){t=function(x){function l(a,b,c=[],g=null,h=n.ContentObjectType.Mesh,E=null,F=-1){var d=x.call(this)||this;d.material=a;d.mapPositions=
g;d.type=h;d.objectAndLayerIdColor=E;d.edgeIndicesLength=F;d.visible=!0;d._vertexAttributes=new Map;d._indices=new Map;d._boundingInfo=null;for(const [k,m]of b)m&&d._vertexAttributes.set(k,{...m});if(null==c||0===c.length){a=d._vertexAttributes.values().next().value;a=null==a?0:a.data.length/a.size;b=r.getContinuousIndexArray(a);d.edgeIndicesLength=0>d.edgeIndicesLength?a:d.edgeIndicesLength;for(const k of d._vertexAttributes.keys())d._indices.set(k,b)}else for(const [k,m]of c)m&&(d._indices.set(k,
r.compactIndices(m)),k===f.VertexAttribute.POSITION&&(d.edgeIndicesLength=0>d.edgeIndicesLength?d._indices.get(k).length:d.edgeIndicesLength));return d}v._inherits(l,x);var e=l.prototype;e.instantiate=function(a={}){const b=new l(a.material||this.material,[],void 0,this.mapPositions,this.type,this.objectAndLayerIdColor,this.edgeIndicesLength);this._vertexAttributes.forEach((c,g)=>{c.exclusive=!1;b._vertexAttributes.set(g,c)});this._indices.forEach((c,g)=>b._indices.set(g,c));b._boundingInfo=this._boundingInfo;
b.transformation=a.transformation||this.transformation;return b};e.getMutableAttribute=function(a){let b=this._vertexAttributes.get(a);b&&!b.exclusive&&(b={...b,exclusive:!0,data:z.cloneAttributeData(b.data)},this._vertexAttributes.set(a,b));return b};e.setAttributeData=function(a,b){const c=this._vertexAttributes.get(a);c&&this._vertexAttributes.set(a,{...c,exclusive:!0,data:b})};e.computeAttachmentOrigin=function(a){return(this.type===n.ContentObjectType.Mesh?this._computeAttachmentOriginTriangles(a):
this.type===n.ContentObjectType.Line?this._computeAttachmentOriginLines(a):this._computeAttachmentOriginPoints(a))?(null!=this._transformation&&y.transformMat4(a,a,this._transformation),!0):!1};e._computeAttachmentOriginTriangles=function(a){const b=this.indices.get(f.VertexAttribute.POSITION),c=this.vertexAttributes.get(f.VertexAttribute.POSITION);return p.computeAttachmentOriginTriangles(c,b,a)};e._computeAttachmentOriginLines=function(a){const b=this.vertexAttributes.get(f.VertexAttribute.POSITION),
c=this.indices.get(f.VertexAttribute.POSITION);var g=p.computeAttachmentOriginLines,h;if(h=c)h=this.material.parameters,h="isClosed"in h&&h.isClosed?c?2<c.length:6<b.data.length:!1;return g.call(p,b,c,h,a)};e._computeAttachmentOriginPoints=function(a){const b=this.indices.get(f.VertexAttribute.POSITION),c=this.vertexAttributes.get(f.VertexAttribute.POSITION);return p.computeAttachmentOriginPoints(c,b,a)};e.invalidateBoundingInfo=function(){this._boundingInfo=null};e._calculateBoundingInfo=function(){const a=
this.indices.get(f.VertexAttribute.POSITION),b=this.vertexAttributes.get(f.VertexAttribute.POSITION);if(!a||0===a.length||!b)return null;const c=this.type===n.ContentObjectType.Mesh?3:1;D.assert(0===a.length%c,"Indexing error: "+a.length+" not divisible by "+c);const g=r.getContinuousIndexArray(a.length/c);return new B.BoundingInfo(g,c,a,b)};e.addHighlight=function(){const a=new C.Object3DStateID(A.Object3DState.Highlight);this.highlights=w.addObject3DStateID(this.highlights,a);return a};e.removeHighlight=
function(a){this.highlights=w.removeObject3DStateID(this.highlights,a)};v._createClass(l,[{key:"vertexAttributes",get:function(){return this._vertexAttributes}},{key:"indices",get:function(){return this._indices}},{key:"indexCount",get:function(){const a=this._indices.values().next().value;return a?a.length:0}},{key:"faceCount",get:function(){return this.indexCount/3}},{key:"boundingInfo",get:function(){null==this._boundingInfo&&(this._boundingInfo=this._calculateBoundingInfo());return this._boundingInfo}},
{key:"transformation",get:function(){return this._transformation??q.IDENTITY},set:function(a){this._transformation=a&&a!==q.IDENTITY?q.clone(a):null}},{key:"shaderTransformation",get:function(){return null!=this._shaderTransformer?this._shaderTransformer(this.transformation):this.transformation}},{key:"shaderTransformer",get:function(){return this._shaderTransformer},set:function(a){this._shaderTransformer=a}},{key:"hasVolatileTransformation",get:function(){return null!=this._shaderTransformer}}]);
return l}(t.ContentObject);u.Geometry=t;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})});
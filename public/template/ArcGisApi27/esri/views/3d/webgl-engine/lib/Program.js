// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../core/PooledArray","../core/shaderTechnique/BindType","../../../webgl/checkWebGLError"],function(f,h,k,g,l){let m=function(){function e(a,b,d){this._context=a;this._locations=d;this._textures=new Map;this._freeTextureUnits=new k({deallocator:null});this._glProgram=a.programCache.acquire(b.generate("vertex"),b.generate("fragment"),d);this._glProgram.stop=()=>{throw Error("Wrapped _glProgram used directly");};this.bindPass=
b.generateBind(g.BindType.Pass,this);this.bindDraw=b.generateBind(g.BindType.Draw,this);this._fragmentUniforms=l.webglDebugEnabled()?b.fragmentUniforms:null}var c=e.prototype;c.dispose=function(){this._glProgram.dispose()};c.setUniform1b=function(a,b){this._glProgram.setUniform1i(a,b?1:0)};c.setUniform1i=function(a,b){this._glProgram.setUniform1i(a,b)};c.setUniform1f=function(a,b){this._glProgram.setUniform1f(a,b)};c.setUniform2fv=function(a,b){this._glProgram.setUniform2fv(a,b)};c.setUniform3fv=
function(a,b){this._glProgram.setUniform3fv(a,b)};c.setUniform4fv=function(a,b){this._glProgram.setUniform4fv(a,b)};c.setUniformMatrix3fv=function(a,b){this._glProgram.setUniformMatrix3fv(a,b)};c.setUniformMatrix4fv=function(a,b){this._glProgram.setUniformMatrix4fv(a,b)};c.setUniform1fv=function(a,b){this._glProgram.setUniform1fv(a,b)};c.setUniform1iv=function(a,b){this._glProgram.setUniform1iv(a,b)};c.setUniform2iv=function(a,b){this._glProgram.setUniform3iv(a,b)};c.setUniform3iv=function(a,b){this._glProgram.setUniform3iv(a,
b)};c.setUniform4iv=function(a,b){this._glProgram.setUniform4iv(a,b)};c.assertCompatibleVertexAttributeLocations=function(a){a.locations!==this._locations&&console.error("VertexAttributeLocations are incompatible")};c.stop=function(){this._textures.clear();this._freeTextureUnits.clear()};c.bindTexture=function(a,b){if(null==b||null==b.glName){if(b=this._textures.get(a))this._context.bindTexture(null,b.unit),this._freeTextureUnit(b),this._textures.delete(a);return null}let d=this._textures.get(a);
null==d?(d=this._allocTextureUnit(b),this._textures.set(a,d)):d.texture=b;this._context.useProgram(this);this.setUniform1i(a,d.unit);this._context.bindTexture(b,d.unit);return d.unit};c.rebindTextures=function(){this._context.useProgram(this);this._textures.forEach((a,b)=>{this._context.bindTexture(a.texture,a.unit);this.setUniform1i(b,a.unit)});null!=this._fragmentUniforms&&this._fragmentUniforms.forEach(a=>{"sampler2D"!==a.type&&"samplerCube"!==a.type||this._textures.has(a.name)||console.error(`Texture sampler ${a.name} has no bound texture`)})};
c._allocTextureUnit=function(a){return{texture:a,unit:0===this._freeTextureUnits.length?this._textures.size:this._freeTextureUnits.pop()}};c._freeTextureUnit=function(a){this._freeTextureUnits.push(a.unit)};h._createClass(e,[{key:"glName",get:function(){return this._glProgram.glName}},{key:"compiled",get:function(){return this._glProgram.compiled}}]);return e}();f.Program=m;Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})});
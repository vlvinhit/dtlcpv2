// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/vec4f64 ../../../../geometry/support/buffer/BufferView ../../support/buffer/InterleavedLayout ../core/shaderLibrary/ShaderOutput ../lib/basicInterfaces ../lib/GLMaterial ../lib/OrderIndependentTransparency ../lib/RenderSlot ../lib/Util ../lib/VertexAttribute ./DefaultBufferWriter ./PatternStyle ./TriangleMaterial ./VisualVariablePassParameters ./internal/bufferWriterUtils ../shaders/PatternTechnique".split(" "),function(v,
m,E,A,F,q,G,H,I,t,B,r,J,K,w,L,C,x){w=function(g){function f(a){a=g.call(this,a,new D)||this;a.supportsEdges=!0;a._vertexAttributeLocations=x.vertexAttributeLocations;a._configuration=new x.PatternTechniqueConfiguration;return a}m._inherits(f,g);var b=f.prototype;b.getConfiguration=function(a,c){this._configuration.output=a;this._configuration.cullFace=this.parameters.cullFace;this._configuration.hasVertexColors=this.parameters.hasVertexColors&&!this.parameters.vvColor;this._configuration.hasSlicePlane=
this.parameters.hasSlicePlane;this._configuration.polygonOffset=this.parameters.polygonOffset;this._configuration.writeDepth=this.parameters.writeDepth;this._configuration.style=this.parameters.style;this._configuration.patternSpacing=this.parameters.patternSpacing;this._configuration.lineWidth=this.parameters.lineWidth;this._configuration.draped=this.parameters.draped;this._configuration.transparencyPassType=c.transparencyPassType;this._configuration.enableOffset=c.camera.relativeElevation<I.OITPolygonOffsetLimit;
this._configuration.hasMultipassTerrain=c.multipassTerrain.enabled;this._configuration.cullAboveGround=c.multipassTerrain.cullAboveGround;this._configuration.vvColor=!!this.parameters.vvColor;return this._configuration};b.requiresSlot=function(a,c){return c===q.ShaderOutput.Color||c===q.ShaderOutput.Alpha||c===q.ShaderOutput.Highlight||c===q.ShaderOutput.Depth&&this.parameters.writeLinearDepth?a===t.RenderSlot.DRAPED_MATERIAL?!0:c===q.ShaderOutput.Highlight?a===t.RenderSlot.OPAQUE_MATERIAL:a===(this.parameters.writeDepth?
t.RenderSlot.TRANSPARENT_MATERIAL:t.RenderSlot.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL):!1};b.createGLMaterial=function(a){return new M(a)};b.createBufferWriter=function(){const a=F.newLayout().vec3f(r.VertexAttribute.POSITION).vec4f(r.VertexAttribute.UVMAPSPACE);this.parameters.draped||a.mat3f(r.VertexAttribute.BOUNDINGRECT);this.parameters.vvColor?a.f32(r.VertexAttribute.COLORFEATUREATTRIBUTE):a.vec4u8(r.VertexAttribute.COLOR);return new N(a)};return m._createClass(f)}(w.TriangleMaterial);let M=
function(g){function f(){return g.apply(this,arguments)||this}m._inherits(f,g);var b=f.prototype;b._updateParameters=function(a){return this.ensureTechnique(x.PatternTechnique,a)};b._updateOccludeeState=function(a){a.hasOccludees!==this._material.parameters.hasOccludees&&this._material.setParameters({hasOccludees:a.hasOccludees})};b.beginSlot=function(a){this._output!==q.ShaderOutput.Color&&this._output!==q.ShaderOutput.Alpha||this._updateOccludeeState(a);return this._updateParameters(a)};return m._createClass(f)}(H),
N=function(g){function f(){return g.apply(this,arguments)||this}m._inherits(f,g);var b=f.prototype;b.write=function(a,c,d,k,h){for(const n of this.vertexBufferLayout.fields.keys()){const e=d.vertexAttributes.get(n),p=d.indices.get(n);if(e&&p)switch(n){case r.VertexAttribute.UVMAPSPACE:B.assert(4===e.size);var l=k.getField(n,A.BufferViewVec4f);l&&C.writeBufferVec4(p,e.data,l,h);break;case r.VertexAttribute.BOUNDINGRECT:B.assert(9===e.size);(l=k.getField(n,A.BufferViewMat3f))&&this.writeBoundingRect(p,
e.data,a,l,h);break;default:C.writeDefaultAttribute(n,e,p,a,c,k,h)}}};b.writeBoundingRect=function(a,c,d,k,h){const l=k.typedBuffer;k=k.typedBufferStride;const n=a.length;h*=k;for(let p=0;p<n;++p){const u=9*a[p];var e=c[u];const y=c[u+1],z=c[u+2];l[h]=d[0]*e+d[4]*y+d[8]*z+d[12];l[h+1]=d[1]*e+d[5]*y+d[9]*z+d[13];l[h+2]=d[2]*e+d[6]*y+d[10]*z+d[14];for(e=3;9>e;++e)l[h+e]=c[u+e];h+=k}};return m._createClass(f)}(J.DefaultBufferWriter),D=function(g){function f(){var b=g.apply(this,arguments)||this;b.color=
E.fromValues(1,1,1,1);b.writeDepth=!0;b.writeLinearDepth=!1;b.hasVertexColors=!1;b.polygonOffset=!1;b.hasSlicePlane=!1;b.cullFace=G.CullFaceOptions.None;b.hasOccludees=!1;b.style=K.Style.Cross;b.patternSpacing=10;b.lineWidth=1;b.draped=!0;return b}m._inherits(f,g);return m._createClass(f)}(L.VisualVariablePassParameters);v.Parameters=D;v.PatternMaterial=w;Object.defineProperty(v,Symbol.toStringTag,{value:"Module"})});
// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/PerformanceSampler ../../../../core/time ../../../../core/accessorSupport/utils ../../../webgl/TimerPool".split(" "),function(d,h,k,f,e,l,m){d.PerformanceCategory=void 0;(function(a){a.OVERLAY="overlay";a.PREPARE="prepare";a.SHADOW_MAP="shadow map";a.LINEAR_DEPTH="linear depth";a.ACCUMULATED_SHADOWS="accumulated shadows";a.NORMALS="normals";a.OBJECT_AND_LAYER_ID_COLOR="object/layer id color";a.SSAO=
"SSAO";a.OPAQUE="opaque";a.OPAQUE_EDGES="opaque edges";a.VOXEL="voxel";a.TRANSPARENT="transparent";a.TRANSPARENT_EDGES="transparent edges";a.HUD_VISIBILITY="HUD visibility";a.TRANSPARENT_TERRAIN="transparent terrain";a.ENVIRONMENT="environment";a.LASER_LINE="laser line";a.OCCLUDED="occluded";a.ANTIALIASING="antialiasing";a.HIGHLIGHTS="highlights";a.HUD="HUD";a.HUD_OCCLUDED="HUD occluded";a.FINISH="finish"})(d.PerformanceCategory||(d.PerformanceCategory={}));let p=function(){function a(b){this._rctx=
b;this._startTimeStampCPU=e.Milliseconds(0);this._lastTimeStampCPU=e.Milliseconds(0);this._totalCPUTime=new f("Total");this._cpuTimeSamplers=new Map(Object.values(d.PerformanceCategory).map(c=>[c,new f(c)]));this._enableGPUTimer=0;this._totalGPUTime=new f("GPU");this._gpuTimeSamplers=new Map(Object.values(d.PerformanceCategory).map(c=>[c,new f(c)]));this._totalTime=e.Milliseconds(0);this._totalFrameCount=0}var g=a.prototype;g.enableGPUPerformanceInfo=function(){if(null==this._gpuTimerPool){const b=
[...Object.values(d.PerformanceCategory),"Total"];this._gpuTimerPool=m.createElapsedTimerPool(this._rctx,b)}if(null==this._gpuTimerPool)return{hasGPUTimerSupport:!1,remove:()=>{}};++this._enableGPUTimer;return{hasGPUTimerSupport:!0,remove:l.once(()=>{--this._enableGPUTimer;0===this._enableGPUTimer&&(this._gpuTimerPool=k.disposeMaybe(this._gpuTimerPool))})}};g.startFrame=function(){this._startTimeStampCPU=this._lastTimeStampCPU=e.Milliseconds(performance.now());null!=this._gpuTimerPool&&this._gpuTimerPool.start()};
g.advance=function(b){var c=e.Milliseconds(performance.now());this._cpuTimeSamplers.get(b).record(c-this._lastTimeStampCPU);this._lastTimeStampCPU=c;null!=this._gpuTimerPool&&(c=this._gpuTimerPool.stop(b),this._gpuTimeSamplers.get(b).record(c),this._gpuTimerPool.start())};g.finishFrame=function(){if(null!=this._gpuTimerPool){var b=this._gpuTimerPool.stop(d.PerformanceCategory.FINISH);this._gpuTimeSamplers.get(d.PerformanceCategory.FINISH).record(b)}b=e.Milliseconds(performance.now()-this._startTimeStampCPU);
this._totalTime=e.Milliseconds(this._totalTime+b);this._totalCPUTime.record(b);null!=this._gpuTimerPool&&this._totalGPUTime.record(this.gpuTimeSamplers.reduce((c,n)=>c+(n.last||0),0));++this._totalFrameCount};h._createClass(a,[{key:"totalCPUTimeSampler",get:function(){return this._totalCPUTime}},{key:"cpuTimeSamplers",get:function(){return Array.from(this._cpuTimeSamplers.values())}},{key:"totalGPUTimeSampler",get:function(){return this._totalGPUTime}},{key:"gpuTimeSamplers",get:function(){return Array.from(this._gpuTimeSamplers.values())}},
{key:"gpuSamplingEnabled",get:function(){return null!=this._gpuTimerPool}},{key:"totalTime",get:function(){return this._totalTime}},{key:"totalFrameCount",get:function(){return this._totalFrameCount}},{key:"elapsedTime",get:function(){return e.Milliseconds(performance.now()-this._startTimeStampCPU)}}]);return a}();d.RendererPerformanceInfo=p;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})});
// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Handles ../../../../core/reactiveUtils ../../../../core/scheduling ../../viewpointUtils ../../../input/InputHandler ../../../navigation/gamepadAndKeyboardUtils".split(" "),function(l,d,q,m,r,n,h,k){h=function(p){function f(b){var a=p.call(this,!0)||this;a._view=b;a._frameTask=null;a._watchHandles=new q;a._currentDevice=null;a._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0};a._handle=a.registerIncoming("gamepad",
c=>a._handleGamePadEvent(c));a._handle.pause();return a}d._inherits(f,p);var g=f.prototype;g.onInstall=function(b){d._get(d._getPrototypeOf(f.prototype),"onInstall",this).call(this,b);this._watchHandles.add([m.watch(()=>this._view.navigation.gamepad?.enabled,a=>{a?(this._handle.resume(),this._frameTask||(this._frameTask=r.addFrameTask({update:c=>this._frameUpdate(c.deltaTime)}))):(this._handle.pause(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null))},m.initial)])};g.onUninstall=function(){this._watchHandles.removeAll();
this._frameTask&&(this._frameTask.remove(),this._frameTask=null);d._get(d._getPrototypeOf(f.prototype),"onUninstall",this).call(this)};g._handleGamePadEvent=function(b){const a=this._view.navigation.gamepad.device;a&&b.data.device!==a||this._currentDevice&&this._currentDevice!==b.data.device||("end"===b.data.action?(this._currentDevice=null,k.resetTransformation(this._transformation)):(this._currentDevice=b.data.device,k.extractTransformation(b.data,this._view.navigation.gamepad,this._transformation)))};
g._frameUpdate=function(b){const a=this._transformation;if(!k.isZeroTransformation(a)){var c=this._view.viewpoint.clone(),e=.7*this._view.navigation.gamepad.velocityFactor*b;n.translateBy(c,c,[a.translation[0]*e,-a.translation[1]*e]);e=this._view.size;n.scaleAndRotateBy(c,c,1+6E-4*a.translation[2]*b,this._view.constraints.rotationEnabled?.06*-a.heading*b:0,[e[0]/2,e[1]],e);b=this._view.constraints.constrain(c,this._view.viewpoint);this._view.viewpoint=b}};return d._createClass(f)}(h.InputHandler);
l.GamepadNavigation=h;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})});
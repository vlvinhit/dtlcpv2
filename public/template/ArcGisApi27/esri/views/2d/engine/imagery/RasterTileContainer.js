// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../geometry/support/aaBoundingRect ../../viewpointUtils ./BrushRasterBitmap ./RasterTile ../webgl/enums ../webgl/TileContainer".split(" "),function(m,d,q,r,t,u,n,k){k=function(p){function g(){var a=p.apply(this,arguments)||this;a.isCustomTilingScheme=!1;return a}d._inherits(g,p);var h=g.prototype;h.createTile=function(a){const b=this._getTileBounds(a),[c,f]=this._tileInfoView.tileInfo.size,e=this._tileInfoView.getTileResolution(a.level);
return new u.RasterTile(a,e,b[0],b[3],c,f)};h.prepareRenderPasses=function(a){const b=a.registerRenderPass({name:"imagery (tile)",brushes:[t],target:()=>this.children.map(c=>c.bitmap),drawPhase:n.WGLDrawPhase.MAP});return[...d._get(d._getPrototypeOf(g.prototype),"prepareRenderPasses",this).call(this,a),b]};h.doRender=function(a){if(this.visible&&a.drawPhase===n.WGLDrawPhase.MAP){var {rasterFunctionChain:b}=this;if(b){var [c,f]=this._tileInfoView.tileInfo.size;a.renderPass="raster";a.rasterFunction=
{name:"Reproject",parameters:{targetImageSize:[c,f],requireBilinear:b.hasSurfaceFunction},pixelType:"f32",id:0,isNoopProcess:!1};d._get(d._getPrototypeOf(g.prototype),"doRender",this).call(this,a);if(b?.functions.length){const {functions:e,hasBranches:v}=b;for(b=0;b<e.length;b++){const l=e[b];"Constant"!==l.name&&"Identity"!==l.name&&(a.renderPass="raster",a.rasterFunction=l,a.hasBranches=v,d._get(d._getPrototypeOf(g.prototype),"doRender",this).call(this,a))}}a.rasterFunction=null;a.renderPass="bitmap"}else a.renderPass=
"raster-bitmap";d._get(d._getPrototypeOf(g.prototype),"doRender",this).call(this,a)}};h._getTileBounds=function(a){const b=this._tileInfoView.getTileBounds(q.create(),a);if(this.isCustomTilingScheme&&a.world){var {tileInfo:c}=this._tileInfoView,f=r.getWorldWidth(c.spatialReference);if(f){var e=c.lodAt(a.level);if(!e)return b;({resolution:e}=e);c=(f=f/e%c.size[0])?(c.size[0]-f)*e:0;b[0]-=c*a.world;b[2]-=c*a.world}}return b};return d._createClass(g)}(k);m.RasterTileContainer=k;Object.defineProperty(m,
Symbol.toStringTag,{value:"Module"})});
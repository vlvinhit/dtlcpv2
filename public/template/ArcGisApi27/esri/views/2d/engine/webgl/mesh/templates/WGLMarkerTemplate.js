// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/screenUtils ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLMeshTemplate".split(" "),function(F,g,H,I,p,x,q,J,t,K,u,L,M){return function(G){function m(a,b,e,f,h,d,n,y,k,v,A,B,C,D,w,E,z,r,l,N,O,P,Q,R){var c=G.call(this)||this;c.angle=f;c.height=
n;c.width=d;c.xOffset=b*l;c.yOffset=e*l;c._markerPlacement=N||void 0;c._effects=O||void 0;c._anchorX=E;c._anchorY=z;c._minMaxZoom=t.i1616to32(Math.round(P*q.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(Q*q.MIN_MAX_ZOOM_PRECISION_FACTOR));b=(D===p.Alignment.MAP?q.BITSET_MARKER_ALIGNMENT_MAP:q.BITSET_MARKER_ALIGNMENT_SCREEN)|(A?q.BITSET_GENERIC_LOCK_COLOR:0)|(C?q.BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE:0)|(B?q.BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY:0);e=w&&w.sdf;a=K.MarkerMaterialKey.load(a);a.sdf=
e;a.pattern=!0;a.textureBinding=w.textureBinding;c._materialKey=a.data;c._fillColor=h;c._outlineColor=k;c._sizeOutlineWidth=t.i8888to32(Math.round(Math.min(Math.sqrt(128*d),255)),Math.round(Math.min(Math.sqrt(128*n),255)),Math.round(Math.min(Math.sqrt(128*v),255)),Math.round(Math.min(Math.sqrt(128*y),255)));a.symbologyType===J.WGLSymbologyType.PIE_CHART?(c._computedWidth=d*r*l,c._computedHeight=n*r*l,c._texUpperLeft=t.i1616to32(0,1),c._texUpperRight=t.i1616to32(1,1),c._texBottomLeft=t.i1616to32(0,
0),c._texBottomRight=t.i1616to32(1,0)):c._computeSize(d,n,r,v,l,w,a.hasSizeVV(),R);c._bitestAndDistRatio=t.i1616to32(b,Math.round(64*r));h=I.create();d=H.create();c._applyTransformation(d,h);return c}F._inherits(m,G);m.fromCIMMarker=function(a,b,e){const f=a.size,h=(b&&b.width||1)/(b&&b.height||1)*a.scaleX;var d=a.scaleSymbolsProportionally&&a.frameHeight?f/a.frameHeight:1;const n=x.premultiplyAlphaRGBA(a.color),y=x.premultiplyAlphaRGBA(a.outlineColor),k=g.pt2px(f),v=k*h,A=g.pt2px(a.offsetX||0),B=
g.pt2px(a.offsetY||0);d*=g.pt2px(a.outlineWidth||0);const C=a.alignment||p.Alignment.SCREEN,D=g.pt2px(a.referenceSize),[w,E]=u.getMinMaxZoom(a.scaleInfo,e);e=a.rotation||0;a.rotateClockwise||(e=-e);let z=0,r=0;const l=a.anchorPoint;l&&(a.isAbsoluteAnchorPoint?f&&(z=l.x/(f*h),r=l.y/f):(z=l.x,r=l.y));b=new m(a.materialKey,A,B,e,n,v,k,D,y,d,a.colorLocked,a.scaleSymbolsProportionally,!1,C,b,z,r,a.sizeRatio,a.scaleFactor??1,a.markerPlacement,a.effects,w,E,!0);b._vertexBoundsScaleX=a.maxVVSize?a.maxVVSize/
v:1;b._vertexBoundsScaleY=a.maxVVSize?a.maxVVSize/k:1;return b};m.fromPictureMarker=function(a,b){const e=Math.round(g.pt2px(a.width)),f=Math.round(g.pt2px(a.height)),h=q.PICTURE_FILL_COLOR,d=Math.round(g.pt2px(a.xoffset||0)),n=Math.round(g.pt2px(a.yoffset||0));b=new m(a.materialKey,d,n,a.angle,h,e,f,f,0,0,!1,!1,!1,p.Alignment.SCREEN,b,0,0,1,1,null,null,u.DEFAULT_MIN_ZOOM,u.DEFAULT_MAX_ZOOM,!1);b._vertexBoundsScaleX=a.maxVVSize?a.maxVVSize/a.width:1;b._vertexBoundsScaleY=a.maxVVSize?a.maxVVSize/a.height:
1;return b};m.fromSimpleMarker=function(a,b){const e=a.style,f=x.premultiplyAlphaRGBAArray(a.color),h=Math.round(g.pt2px(a.size));let d=h;"esriSMSTriangle"===e&&(d*=b.height/b.width);const n=Math.round(g.pt2px(a.xoffset||0)),y=Math.round(g.pt2px(a.yoffset||0));var k=a.outline;const v=(k?.color&&x.premultiplyAlphaRGBAArray(k.color))|0;k=(k?.width&&Math.round(g.pt2px(k.width)))|0;b=new m(a.materialKey,n,y,a.angle??0,f,h,d,d,v,k,!1,!1,"esriSMSCross"===e||"esriSMSX"===e,p.Alignment.SCREEN,b,0,0,2,1,null,
null,u.DEFAULT_MIN_ZOOM,u.DEFAULT_MAX_ZOOM,!1);b.boundsType="esriSMSCircle"===e?"circle":"square";b._vertexBoundsScaleX=a.maxVVSize?a.maxVVSize/a.size:1;b._vertexBoundsScaleY=a.maxVVSize?a.maxVVSize/a.size:1;return b};m.fromLineSymbolMarker=function(a,b){const e=x.premultiplyAlphaRGBAArray(a.color),f=Math.round(g.pt2px(6*a.lineWidth)),h="cross"===a.style||"x"===a.style;switch(a.placement){case "begin-end":var d=p.ExtremityPlacement.Both;break;case "begin":d=p.ExtremityPlacement.JustBegin;break;case "end":d=
p.ExtremityPlacement.JustEnd;break;default:d=p.ExtremityPlacement.None}d={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:d,offsetAlongLine:0};b=new m(a.materialKey,0,0,0,e,f,f,f/6,e,h?Math.round(g.pt2px(a.lineWidth)):0,!1,!1,h,p.Alignment.MAP,b,0,0,2,1,d,null,u.DEFAULT_MIN_ZOOM,u.DEFAULT_MAX_ZOOM,!1);b.boundsType="circle"===a.style?"circle":"square";return b};return F._createClass(m)}(L(M))});
// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../BitBlitRenderer ./Effect ./highlight/HighlightRenderer ./highlight/HighlightSurfaces ../../../../webgl/enums".split(" "),function(h,t,l,m,n,p,q){return function(k){function g(){var b=k.apply(this,arguments)||this;b.defines=["highlight"];b._hlRenderer=new n;b._width=void 0;b._height=void 0;b._boundFBO=null;b._hlSurfaces=new p;b._adjustedWidth=void 0;b._adjustedHeight=void 0;b._blitRenderer=new l.BitBlitRenderer;return b}
h._inherits(g,k);var f=g.prototype;f.dispose=function(){this._hlSurfaces?.dispose();this._hlRenderer?.dispose();this._boundFBO=null};f.bind=function(b){const {context:a,painter:c}=b,{width:d,height:e}=a.getViewport(),r=c.getFbos(d,e).effect0;this.setup(b,d,e);a.bindFramebuffer(r);a.setColorMask(!0,!0,!0,!0);a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT)};f.unbind=function(){};f.setup=function({context:b},a,c){this._width=a;this._height=c;const d=a%4,e=c%4;a+=2>d?-d:4-d;c+=2>e?-e:4-e;this._adjustedWidth=
a;this._adjustedHeight=c;this._boundFBO=b.getBoundFramebufferObject();a=Math.round(1*a);c=Math.round(1*c);this._hlRenderer.setup(b,a,c);this._hlSurfaces.setup(b,a,c)};f.draw=function(b){const {context:a,highlightGradient:c}=b;c&&(b=a.getBoundFramebufferObject(),a.setViewport(0,0,1*this._adjustedWidth,1*this._adjustedHeight),a.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo),a.setStencilTestEnabled(!1),a.setClearColor(0,0,0,0),a.clear(a.gl.COLOR_BUFFER_BIT),this._blitRenderer.render(a,b.colorTexture,
q.TextureSamplingMode.NEAREST,1),a.setStencilTestEnabled(!1),a.setBlendingEnabled(!1),a.setColorMask(!1,!1,!1,!0),a.bindFramebuffer(this._hlSurfaces.sharedBlur2Fbo),a.setClearColor(0,0,0,0),a.clear(a.gl.COLOR_BUFFER_BIT),this._hlRenderer.preBlur(a,this._hlSurfaces.sharedBlur1Tex),a.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo),a.setClearColor(0,0,0,0),a.clear(a.gl.COLOR_BUFFER_BIT),this._hlRenderer.finalBlur(a,this._hlSurfaces.sharedBlur2Tex),a.bindFramebuffer(this._boundFBO),a.setBlendingEnabled(!0),
a.setColorMask(!0,!0,!0,!0),a.setViewport(0,0,this._width,this._height),this._hlRenderer.renderHighlight(a,this._hlSurfaces.sharedBlur1Tex,c),this._boundFBO=null)};return h._createClass(g)}(m.Effect)});
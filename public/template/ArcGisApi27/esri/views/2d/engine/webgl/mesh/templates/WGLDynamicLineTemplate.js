// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/screenUtils ../../../../../../symbols/cim/utils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),function(t,u,g,v,h,q,x,r,y,z,A){return function(w){function p(a,d,n){var b=w.call(this,a)||this;b._minMaxZoom=q.i1616to32(Math.round(d*h.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(n*h.MIN_MAX_ZOOM_PRECISION_FACTOR));
b._cimLineLayer=a;let c=0;g.isFeatureValueFn(a.width)||(c=.5*u.pt2px(a.width));b._dynamicPropertyMap.set("_halfWidth",(k,f,l)=>g.isFeatureValueFn(a.width)?.5*u.pt2px(a.width(k,f,l)):c);g.isFeatureValueFn(a.cap)?b._dynamicPropertyMap.set("_capType",a.cap):b._capType=a.cap;g.isFeatureValueFn(a.join)?b._dynamicPropertyMap.set("_joinType",a.join):b._joinType=a.join;const e=a.color;g.isFeatureValueFn(e)?b._dynamicPropertyMap.set("_fillColor",(k,f,l)=>v.premultiplyAlphaRGBA(e(k,f,l))):b._fillColor=e&&v.premultiplyAlphaRGBA(e)||
0;const m=a.miterLimit;g.isFeatureValueFn(m)?b._dynamicPropertyMap.set("_miterLimitCosine",(k,f,l)=>r.getLimitCosine(m(k,f,l))):b._miterLimitCosine=r.getLimitCosine(m);null!=a.effects&&(d=a.effects,g.isFeatureValueFn(d)?b._dynamicPropertyMap.set("_effects",d):b._effects=d);b._scaleFactor=a.scaleFactor||1;b._isDashed=null!=a.dashTemplate;b.tessellationProperties._bitset=(a.colorLocked?h.BITSET_GENERIC_LOCK_COLOR:0)|(a.scaleDash?h.BITSET_LINE_SCALE_DASH:0)|(a.sampleAlphaOnly?h.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:
0);b._materialKey=a.materialKey;b._initializeTessellator(!0);return b}t._inherits(p,w);p.fromCIMLine=function(a,d){const [n,b]=r.getMinMaxZoom(a.scaleInfo,d);return new p(a,n,b)};p.prototype.bindFeature=function(a,d,n){const b=a.readLegacyFeature();this._dynamicPropertyMap.forEach((e,m)=>{this[m]=e(b,d,n)});this._halfWidth*=this._scaleFactor;a=this._materialCache;var c=this._cimLineLayer.materialHash;c=c(b,d,n);c=a.get(c);a=null;c&&A.ok(c.spriteMosaicItem)&&(a=c.spriteMosaicItem);if(a){this._hasPattern=
!0;const {rect:e,width:m,height:k}=a;c=e.x+h.SPRITE_PADDING;const f=e.y+h.SPRITE_PADDING,l=c+m,B=f+k;this.tessellationProperties._tl=q.i1616to32(c,f);this.tessellationProperties._br=q.i1616to32(l,B)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=this._fillColor;this.tessellationProperties._halfWidth=this._halfWidth;this.tessellationProperties.offset=0;this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;
c=x.LineMaterialKey.load(this._materialKey);a&&(c.sdf=a.sdf,c.pattern=!0,c.textureBinding=a.textureBinding);this._materialKey=c.data};return t._createClass(p)}(y(z))});
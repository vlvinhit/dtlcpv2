// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("../../../../../chunks/_rollupPluginBabelHelpers ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey ../techniques/utils ../../../../webgl/enums".split(" "),function(t,q,z,A,B,C,b){const D={shader:"materials/icon",vertexLayout:{geometry:[{location:0,name:"a_pos",count:2,type:b.DataType.SHORT},{location:1,name:"a_vertexOffset",count:2,type:b.DataType.SHORT},{location:2,name:"a_texCoords",count:2,type:b.DataType.UNSIGNED_SHORT},{location:3,name:"a_bitSetAndDistRatio",count:2,type:b.DataType.UNSIGNED_SHORT},
{location:4,name:"a_id",count:4,type:b.DataType.UNSIGNED_BYTE},{location:5,name:"a_color",count:4,type:b.DataType.UNSIGNED_BYTE,normalized:!0},{location:6,name:"a_outlineColor",count:4,type:b.DataType.UNSIGNED_BYTE,normalized:!0},{location:7,name:"a_sizeAndOutlineWidth",count:4,type:b.DataType.UNSIGNED_BYTE},{location:8,name:"a_zoomRange",count:2,type:b.DataType.UNSIGNED_SHORT}]},hittestAttributes:["a_vertexOffset","a_texCoords"]};return function(u){function r(){return u.apply(this,arguments)||this}
t._inherits(r,u);var h=r.prototype;h.dispose=function(){};h.getGeometryType=function(){return q.WGLGeometryType.MARKER};h.supportsSymbology=function(d){return d!==q.WGLSymbologyType.HEATMAP&&d!==q.WGLSymbologyType.PIE_CHART};h.drawGeometry=function(d,k,e,a){const {context:f,painter:l,rendererInfo:m,state:v,passOptions:w,requestRender:x,allowDelayedRender:E}=d;var c=B.MarkerMaterialKey.load(e.materialKey),n=C.getTechniqueFromMaterialKey(c.data);const p=null!=w&&"hittest"===w.type,{shader:F,vertexLayout:G,
hittestAttributes:H}=n.programSpec??D;n=b.PrimitiveType.TRIANGLES;var g=z.createProgramDescriptor(c.data,G);p&&(g=this._getTriangleDesc(e.materialKey,g,H),n=b.PrimitiveType.POINTS);const {attributes:y,bufferLayouts:I}=g;a=l.materialManager.getMaterialProgram(d,c,F,y,a);E&&null!=x&&!a.compiled?x():(f.useProgram(a),c.textureBinding&&l.textureManager.bindTextures(f,a,c,!0),this._setSharedUniforms(a,d,k),a.setUniformMatrix3fv("u_displayMat3",c.vvRotation?v.displayViewMat3:v.displayMat3),this._setSizeVVUniforms(c,
a,m,k),this._setColorAndOpacityVVUniforms(c,a,m),this._setRotationVVUniforms(c,a,m),c=e.target.getVAO(f,I,y,p),g=e.indexCount,e=e.indexFrom*Uint32Array.BYTES_PER_ELEMENT,p&&(g/=3,e/=3),f.bindVAO(c),this._drawMarkers(d,k,a,n,g,e,p),f.bindVAO(null))};h._drawMarkers=function(d,k,e,a,f,l,m){d.context.drawElements(a,f,b.DataType.UNSIGNED_INT,l)};return t._createClass(r)}(A)});
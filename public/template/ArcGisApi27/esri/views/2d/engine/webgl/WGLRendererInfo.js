// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/screenUtils ../../../../core/unitUtils ../../../../renderers/support/lengthUtils ./Utils ./techniques/Technique ./techniques/utils ../../../webgl/capabilities".split(" "),function(p,q,l,r,t,m,u,v,w){function n(g,d){const b=d.length;if(g<d[0].value||1===b)return d[0].size;for(let a=1;a<b;a++)if(g<d[a].value)return d[a-1].size+(g-d[a-1].value)/(d[a].value-d[a-1].value)*(d[a].size-d[a-1].size);return d[b-1].size}let x=function(){function g(){this.symbolLevels=
[];this.vvColorValues=new Float32Array(8);this.vvColors=new Float32Array(32);this.vvOpacityValues=new Float32Array(8);this.vvOpacities=new Float32Array(8);this.vvSizeMinMaxValue=new Float32Array(4);this.outsideLabelsVisible=!1;this._vvMaterialParameters={vvSizeEnabled:!1,vvColorEnabled:!1,vvRotationEnabled:!1,vvRotationType:"geographic",vvOpacityEnabled:!1};this._technique=u.Technique}var d=g.prototype;d.getSizeVVFieldStops=function(b){var a=this._vvSizeFieldStops;if(a)switch(a.type){case "static":return a;
case "level-dependent":var c;if(null!=(c=a.levels[b]))a=c;else{{let e=Infinity;c=0;for(const h in a.levels){const f=parseFloat(h),k=Math.abs(b-f);k<e&&(e=k,c=f)}Infinity===e?a={sizes:new Float32Array([0,0,0,0,0,0]),values:new Float32Array([0,0,0,0,0,0])}:(b=2**((b-c)/2),a=a.levels[c],c=new Float32Array(a.values),c[2]*=b,c[3]*=b,a={sizes:a.sizes,values:c})}}return a}};d.update=function(b){null!=this._vvInfo&&this._updateVisualVariables(this._vvInfo.vvRanges,b)};d.setInfo=function(b,a,c){this._updateEffects(c);
this._vvInfo=a;this._technique=v.getTechniqueFromRenderer(b);this.rendererSchema=this._technique.createOrUpdateRendererSchema(this.rendererSchema,b)};d.getVariation=function(){return{...this._technique.getVariation(this.rendererSchema),outsideLabelsVisible:this.outsideLabelsVisible,supportsTextureFloat:w.getWebGLCapabilities("2d").supportsTextureFloat}};d.getVariationHash=function(){return this._technique.getVariationHash(this.rendererSchema)<<1|(this.outsideLabelsVisible?1:0)};d._updateEffects=function(b){this.outsideLabelsVisible=
null!=b?b.excludedLabelsVisible:!1};d._updateVisualVariables=function(b,a){const c=this._vvMaterialParameters;c.vvOpacityEnabled=!1;c.vvSizeEnabled=!1;c.vvColorEnabled=!1;c.vvRotationEnabled=!1;if(b){var e=b.size;if(e){c.vvSizeEnabled=!0;if(e.minMaxValue){const f=e.minMaxValue;let k;if(m.isDefined(f.minSize)&&m.isDefined(f.maxSize))if(m.isNumber(f.minSize)&&m.isNumber(f.maxSize)){k=l.pt2px(f.minSize);var h=l.pt2px(f.maxSize)}else h=a.scale,k=l.pt2px(n(h,f.minSize.stops)),h=l.pt2px(n(h,f.maxSize.stops));
this.vvSizeMinMaxValue.set([f.minDataValue,f.maxDataValue,k,h])}e.scaleStops&&(this.vvSizeScaleStopsValue=l.pt2px(n(a.scale,e.scaleStops.stops)));e.unitValue&&(this.vvSizeUnitValueToPixelsRatio=r.getMetersPerUnitForSR(a.spatialReference)/t.meterIn[e.unitValue.unit]/a.resolution);e.fieldStops&&(this._vvSizeFieldStops=e.fieldStops)}if(a=b.color)c.vvColorEnabled=!0,this.vvColorValues.set(a.values),this.vvColors.set(a.colors);if(a=b.opacity)c.vvOpacityEnabled=!0,this.vvOpacityValues.set(a.values),this.vvOpacities.set(a.opacities);
if(b=b.rotation)c.vvRotationEnabled=!0,c.vvRotationType=b.type}};q._createClass(g,[{key:"vvMaterialParameters",get:function(){return this._vvMaterialParameters}}]);return g}();p.WGLRendererInfo=x;Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})});
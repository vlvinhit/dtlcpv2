// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../../core/Error ../../../../core/Logger ../../../../symbols/cim/enums ./enums ../../../webgl/enums ../../../webgl/VertexElementDescriptor".split(" "),function(b,t,u,m,d,k,G){function n(a){const c={};for(const e of a)c[e.name]=e.strideInBytes;return c}function z(a){switch(a){case d.WGLGeometryType.MARKER:return H;case d.WGLGeometryType.FILL:return I;case d.WGLGeometryType.LINE:return J;case d.WGLGeometryType.TEXT:return K;case d.WGLGeometryType.LABEL:return L}}function A(a){switch(a%
4){case 0:case 2:return 4;case 1:case 3:return 1}}function B(a){switch(a){case k.DataType.BYTE:case k.DataType.UNSIGNED_BYTE:return 1;case k.DataType.SHORT:case k.DataType.UNSIGNED_SHORT:return 2;case k.DataType.FLOAT:case k.DataType.INT:case k.DataType.UNSIGNED_INT:return 4}}function M(a){const c={};for(const e in a){let g=0;c[e]=a[e].map(f=>{const h=new G.VertexElementDescriptor(f.name,f.count,f.type,g,0,f.normalized||!1);g+=f.count*B(f.type);return h});c[e]?.forEach(f=>f.stride=g)}return c}const r=
u.getLogger("esri.views.2d.engine.webgl.Utils"),N=n([{name:"geometry",strideInBytes:36}]),O=n([{name:"geometry",strideInBytes:12}]),P=n([{name:"geometry",strideInBytes:36}]),Q=n([{name:"geometry",strideInBytes:24}]),R=n([{name:"geometry",strideInBytes:12}]),S=n([{name:"geometry",strideInBytes:40}]),T=n([{name:"geometry",strideInBytes:36}]),U=n([{name:"geometry",strideInBytes:36}]),H=["geometry"],I=["geometry"],J=["geometry"],K=["geometry"],L=["geometry"];u={geometry:k.Usage.STATIC_DRAW};const v=new Map,
w=a=>null!=a&&a.startsWith("data:image/gif"),x=a=>null!=a&&a.startsWith("data:image/png"),C=a=>{if(!a)return!1;a=a.trim();return/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(a)&&/[\dz]$/i.test(a)&&4<a.length?!0:!1},D=a=>"fill"===a.type&&"CIMMarkerPlacementInsidePolygon"===a?.cim?.markerPlacement?.type;b.C_VBO_INFO=u;b.allocateTypedArrayBuffer=function(a,c){switch(c%4){case 0:case 2:return new Uint32Array(Math.floor(a*c/4));case 1:case 3:return new Uint8Array(a*c)}};b.allocateTypedArrayBufferwithData=
function(a,c){switch(c%4){case 0:case 2:return new Uint32Array(a);case 1:case 3:return new Uint8Array(a)}};b.charCodes=function(a){const c=[];for(let e=0;e<a.length;e++)c.push(a.charCodeAt(e));return c};b.copyMeshData=function(a,c,e,g,f,h,l){for(const y in h){var q=h[y].stride,p=A(q);const E=h[y].data,F=e[y].data;if(null==E||null==F)continue;const V=q*f.vertexCount/p,W=q*a/p;q=q*f.vertexFrom/p;for(p=0;p<V;++p)F[p+W]=E[p+q]}if(null!=l&&null!=g)for(e=f.indexCount,h=0;h<e;++h)g[h+c]=l[h+f.indexFrom]-
f.vertexFrom+a};b.createGeometryData=function(a,c){const e=[];for(let g=0;5>g;++g){const f=z(g),h={};for(const l of f)h[l]={data:c(g,l)};e.push({data:a(g),buffers:h})}return e};b.createProgramDescriptor=(a,c)=>{if(!v.has(a)){const f=M(c);var e=f;var g={};for(const h in e){const l=e[h];g[h]=l?.length?l[0].stride:0}e=g;g=new Map;for(const h in c)for(const l of c[h])g.set(l.name,l.location);v.set(a,{strides:e,bufferLayouts:f,attributes:g})}return v.get(a)};b.forEachGeometryType=function(a){a(d.WGLGeometryType.FILL);
a(d.WGLGeometryType.LINE);a(d.WGLGeometryType.MARKER);a(d.WGLGeometryType.TEXT);a(d.WGLGeometryType.LABEL)};b.getBytes=B;b.getCapType=function(a){switch(a){case "butt":return m.CapType.BUTT;case "round":return m.CapType.ROUND;case "square":return m.CapType.SQUARE;default:return r.error(new t("mapview-invalid-type",`Cap type ${a} is not a valid option. Defaulting to round`)),m.CapType.ROUND}};b.getJoinType=function(a){switch(a){case "miter":return m.JoinType.MITER;case "bevel":return m.JoinType.BEVEL;
case "round":return m.JoinType.ROUND;default:return r.error(new t("mapview-invalid-type",`Join type ${a} is not a valid option. Defaulting to round`)),m.JoinType.ROUND}};b.getNamedBuffers=z;b.getPMSResourceSize=function(a){const c="width"in a&&a.width||"size"in a&&a.size||0;return"maxVVSize"in a&&a.maxVVSize||c};b.getPixelArrayCtor=function(a){switch(a){case k.PixelType.UNSIGNED_BYTE:return Uint8Array;case k.PixelType.UNSIGNED_SHORT_4_4_4_4:return Uint16Array;case k.PixelType.FLOAT:return Float32Array;
default:r.error(new t("webgl-utils",`Unable to handle type ${a}`))}};b.getPixelBytes=function(a){switch(a){case k.PixelType.UNSIGNED_BYTE:return 1;case k.PixelType.UNSIGNED_SHORT_4_4_4_4:return 2;case k.PixelType.FLOAT:return 4;default:r.error(new t("webgl-utils",`Unable to handle type ${a}`))}};b.getStrides=function(a,c){switch(a){case d.WGLGeometryType.MARKER:switch(c){case d.WGLSymbologyType.HEATMAP:return O;default:return N}case d.WGLGeometryType.FILL:switch(c){case d.WGLSymbologyType.DOT_DENSITY:return R;
case d.WGLSymbologyType.SIMPLE:case d.WGLSymbologyType.OUTLINE_FILL_SIMPLE:return Q;default:return P}case d.WGLGeometryType.LINE:return S;case d.WGLGeometryType.TEXT:return T;case d.WGLGeometryType.LABEL:return U}};b.getUrl=a=>"imageData"in a&&a.imageData&&"contentType"in a&&a.contentType?`data:${a.contentType};base64,${a.imageData}`:"url"in a?a.url:null;b.getVVType=function(a){switch(a){case "opacity":return d.VVType.OPACITY;case "color":return d.VVType.COLOR;case "rotation":return d.VVType.ROTATION;
case "size":return d.VVType.SIZE;default:return r.error(`Cannot interpret unknown vv: ${a}`),null}};b.is3D=a=>a.type&&a.type.toLowerCase().includes("3d");b.isDefined=function(a){return null!=a};b.isGIF=a=>"url"in a&&a.url&&(a.url.includes(".gif")||w(a.url))||"contentType"in a&&"image/gif"===a.contentType||"imageData"in a&&w(a.imageData);b.isGIFDataUri=w;b.isImageResource=a=>"url"in a&&a.url||"imageData"in a&&a.imageData;b.isMarkerPlacementInsidePolygon=D;b.isNumber=function(a){return"number"===typeof a};
b.isPNG=a=>"url"in a&&a.url&&(a.url.includes(".png")||x(a.url))||"contentType"in a&&"image/png"===a.contentType||"imageData"in a&&x(a.imageData);b.isPNGDataUri=x;b.isSVGImage=a=>a.includes("data:image/svg+xml");b.isSVGResource=a=>"path"in a&&C(a.path);b.isSimple=function(a){switch(a.type){case "line":return"CIMSolidStroke"===a.cim.type&&!a.dashTemplate;case "fill":return"CIMSolidFill"===a.cim.type;case "esriSFS":return"esriSFSSolid"===a.style||"esriSFSNull"===a.style;case "esriSLS":return"esriSLSSolid"===
a.style||"esriSLSNull"===a.style;default:return!1}};b.isValidSVG=C;b.shouldRepeat=function(a){switch("cim"in a?a.cim.type:a.type){case "esriSMS":case "esriPMS":case "CIMPointSymbol":return!1;case "CIMVectorMarker":case "CIMCharacterMarker":case "CIMPictureMarker":return D(a);default:return!0}};b.strideToPackingFactor=A;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})});
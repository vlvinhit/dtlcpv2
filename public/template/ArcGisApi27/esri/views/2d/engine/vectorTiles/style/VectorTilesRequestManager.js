// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../request ../../../../../core/lang ../../../../../core/MapUtils ../../../../../core/promiseUtils ../../../../../core/urlUtils".split(" "),function(k,n,p,q,r,l,m){function t(b,c){return r.getOrCreateMapValue(g,b,()=>new u(b)).getData(c).then(a=>{g.delete(b);return a}).catch(a=>{g.delete(b);throw a;})}let u=function(){function b(a){this._tileUrl=a;this._abortController=this._promise=null;this._abortOptions=[]}var c=b.prototype;
c.getData=function(a){null===this._promise&&(this._abortController=new AbortController,this._promise=this._makeRequest(this._tileUrl,this._abortController.signal));const d=this._abortOptions;d.push(a);l.onAbort(a,()=>{d.every(e=>l.isAborted(e))&&this._abortController.abort()});return this._promise.then(e=>q.clone(e))};c._makeRequest=async function(a,d){({data:a}=await p(a,{responseType:"array-buffer",signal:d}));return a};return n._createClass(b)}();const g=new Map;k.request=function(b,c,a,d,e){b=
m.urlToObject(b);const f=b.query;if(f)for(const [h,v]of Object.entries(f))switch(v){case "{x}":f[h]=d.toString();break;case "{y}":f[h]=a.toString();break;case "{z}":f[h]=c.toString()}c=m.addQueryParameters(b.path.replaceAll(/\{z\}/gi,c.toString()).replaceAll(/\{y\}/gi,a.toString()).replaceAll(/\{x\}/gi,d.toString()),{...b.query});return t(c,e)};Object.defineProperty(k,Symbol.toStringTag,{value:"Module"})});
// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../geometry ../../../../core/Accessor ../../../../core/Logger ../../../../core/mathUtils ../../../../core/promiseUtils ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/decorators/subclass ../../../../geometry/Point ./FlowDisplayData ./FlowDisplayObject ../../../../geometry/Extent".split(" "),
function(m,g,f,r,t,n,u,l,C,D,E,v,w,x,y,z){function A(b,c){const d=new w({x:(b.xmax+b.xmin)/2,y:(b.ymax+b.ymin)/2,spatialReference:b.spatialReference});var a=b.xmax-b.xmin;const e=b.ymax-b.ymin,h=Math.abs(Math.cos(n.deg2rad(c))),k=Math.abs(Math.sin(n.deg2rad(c)));c=h*a+k*e;a=k*a+h*e;b=new z({xmin:d.x-c/2,ymin:d.y-a/2,xmax:d.x+c/2,ymax:d.y+a/2,spatialReference:b.spatialReference});b.centerAt(d);return b}f=function(b){function c(a){a=b.call(this,a)||this;a._flowDisplayObject=new y.FlowDisplayObject;
a._loading=null;return a}m._inherits(c,b);var d=c.prototype;d.initialize=function(){this.flowContainer.addChild(this._flowDisplayObject)};d.destroy=function(){this._clear();this.flowContainer.removeAllChildren()};d.update=function(a){var {flowStyle:e}=this.flowContainer;if(null==e)this._clear();else{var {extent:h,rotation:k,resolution:p,pixelRatio:B}=a.state;a=A(h,k);a.expand(1.15);e=new x(e,a,[Math.round((a.xmax-a.xmin)/p),Math.round((a.ymax-a.ymin)/p)],B);if(null!=this._loading){if(this._loading.update(e))return;
this._loading.detach();this._loading=null}null!=this._flowDisplayObject.displayData&&this._flowDisplayObject.displayData.update(e)||(e.load().then(()=>{this._flowDisplayObject.clear();this._flowDisplayObject.displayData=this._loading;this._loading=null},q=>{u.isAbortError(q)||(t.getLogger(this).error("A resource failed to load.",q),this._loading=null)}),this._loading=e)}};d._clear=function(){this._flowDisplayObject.clear();null!=this._loading&&(this._loading.detach(),this._loading=null)};m._createClass(c,
[{key:"updating",get:function(){return null!=this._loading}}]);return c}(r);g.__decorate([l.property()],f.prototype,"_loading",void 0);g.__decorate([l.property()],f.prototype,"flowContainer",void 0);g.__decorate([l.property()],f.prototype,"updating",null);return f=g.__decorate([v.subclass("esri.views.2d.engine.flow.FlowStrategy")],f)});
// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Handles ../../../../../chunks/vec3 ../../../../../chunks/vec3f64 ./Manipulation ./utils ../../../../draw/support/drawUtils ../../../../interactive/dragEventPipeline ../../../../interactive/GraphicManipulator ../../../../interactive/editGeometry/interfaces ../../../../interactive/editGeometry/operations/UpdateVertices ../../../../interactive/editGeometry/support/editPlaneUtils".split(" "),function(k,l,u,v,w,m,x,y,n,
z,p,A,B){let E=function(q){function g(c){var a=q.call(this)||this;a._handles=new u;a._originCache=w.create();a._view=c.view;a._tool=c.tool;a._graphic=c.graphic;a._snapRotation=c.snapRotation;a._manipulator=a._createManipulator();a._handles.add([a._manipulator.events.on("grab-changed",d=>x.onGrabChangedHandle(d,a._manipulator))]);a.forEachManipulator(d=>a._tool.manipulators.add(d));return a}l._inherits(g,q);var f=g.prototype;f.destroy=function(){this._handles.destroy();this.forEachManipulator(c=>{this._tool.manipulators.remove(c);
c.destroy()});this._originCache=this._handles=this._graphic=this._snapRotation=this._manipulator=this._view=this._tool=null};f.forEachManipulator=function(c){c(this._manipulator,m.ManipulatorType.ROTATE)};f.createDragPipeline=function(c,a){let d=null,h=null;return n.createManipulatorDragEventPipeline(this._manipulator,(r,C)=>{C.next(b=>{if("start"===b.action){r.cursor="grabbing";const e=c();d=e.plane;h=e.editGeometryOperations}return b}).next(n.screenToMap(this._view)).next(b=>({...b,rotateAngle:y.getRotationAngle(b.mapStart,
b.mapEnd,{x:d.origin[0],y:d.origin[1]},!0)})).next(this._snapRotation.createDragEventPipelineStep(),this._snapRotation.next).next(b=>{var e=v.copy(this._originCache,d.origin);const t=[];for(const D of h.data.components)t.push(...D.vertices);e=h.rotateVertices(t,e,b.rotateAngle,"start"===b.action?p.AccumulationBehaviour.NEW_STEP:p.AccumulationBehaviour.ACCUMULATE_STEPS,A.AccumulationType.REPLACE);B.apply(e,d);a(b,e);return b}).next(b=>{"end"===b.action&&(r.cursor="grab");return b})})};f._createManipulator=
function(){return new z.GraphicManipulator({view:this._view,graphic:this._graphic,selectable:!0,cursor:"grab"})};return l._createClass(g)}(m.Manipulation);k.RotateManipulation=E;Object.defineProperty(k,Symbol.toStringTag,{value:"Module"})});
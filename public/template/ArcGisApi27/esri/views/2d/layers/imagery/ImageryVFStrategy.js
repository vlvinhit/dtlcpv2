// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Accessor ../../../../core/Logger ../../../../core/promiseUtils ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/decorators/subclass ../../../../geometry/Extent ../../engine/imagery/RasterVFDisplayObject".split(" "),function(n,h,f,t,q,l,y,z,A,u,v,w){f=function(r){function m(b){var a=
r.call(this,b)||this;a._loading=null;a.update=q.debounce((d,e)=>a._update(d,e).catch(g=>{q.isAbortError(g)||t.getLogger(n._assertThisInitialized(a)).error(g)}));return a}n._inherits(m,r);var p=m.prototype;p.redraw=function(b){if(this.container.children.length){var a=this.container.children[0];a.symbolizerParameters=b;a.invalidateVAO();this.container.symbolTypes="wind_speed"===b.style?["scalar","triangle"]:"simple_scalar"===b.style?["scalar"]:["triangle"];this.container.requestRender()}};p._update=
async function(b,a,d){if(b.stationary){var {extent:e,spatialReference:g}=b.state,c=new v({xmin:e.xmin,ymin:e.ymin,xmax:e.xmax,ymax:e.ymax,spatialReference:g}),[k,x]=b.state.size;this._loading=this.fetchPixels(c,k,x,d);d=await this._loading;this._addToDisplay(d,a,b.state);this._loading=null}};p._addToDisplay=function(b,a,d){if(null==b.pixelBlock)this.container.children.forEach(k=>k.destroy()),this.container.removeAllChildren();else{var {extent:e,pixelBlock:g}=b,c=new w.RasterVFDisplayObject(g);c.offset=
[0,0];c.symbolizerParameters=a;c.rawPixelData=b;c.invalidateVAO();c.x=e.xmin;c.y=e.ymax;c.pixelRatio=d.pixelRatio;c.rotation=d.rotation;c.resolution=d.resolution;c.width=g.width*a.symbolTileSize;c.height=g.height*a.symbolTileSize;this.container.children.forEach(k=>k.destroy());this.container.removeAllChildren();this.container.symbolTypes="wind_speed"===a.style?["scalar","triangle"]:"simple_scalar"===a.style?["scalar"]:["triangle"];this.container.addChild(c)}};n._createClass(m,[{key:"updating",get:function(){return!!this._loading}}]);
return m}(f);h.__decorate([l.property()],f.prototype,"fetchPixels",void 0);h.__decorate([l.property()],f.prototype,"container",void 0);h.__decorate([l.property()],f.prototype,"_loading",void 0);h.__decorate([l.property()],f.prototype,"updating",null);return f=h.__decorate([u.subclass("esri.views.2d.layers.imagery.ImageryVFStrategy")],f)});
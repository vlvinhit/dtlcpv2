// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../PopupTemplate ../../../core/Collection ../../../core/reactiveUtils ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/Error ../../../core/accessorSupport/decorators/subclass ../../../renderers/SimpleRenderer ../../../renderers/support/jsonUtils ../../../rest/support/FeatureSet ./LayerView2D ./graphics/GraphicContainer ./graphics/GraphicsView2D ../../layers/LayerView".split(" "),
function(n,q,r,t,e,h,C,D,E,F,u,k,v,w,x,y,z,A){h=function(p){function l(){var a=p.apply(this,arguments)||this;a._graphicsViewMap={};a._popupTemplates=new Map;a.graphicsViews=[];return a}n._inherits(l,p);var f=l.prototype;f.hitTest=async function(a,d){if(!this.graphicsViews.length)return null;const b=this.layer;return this.graphicsViews.reverse().map(c=>{const m=this._popupTemplates.get(c);c=c.hitTest(a);for(const g of c)g.layer=b,g.sourceLayer=b,g.popupTemplate=m;return c}).flat().map(c=>({type:"graphic",
graphic:c,layer:b,mapPoint:a}))};f.update=function(a){if(this.graphicsViews)for(const d of this.graphicsViews)d.processUpdate(a)};f.attach=function(){this.addAttachHandles([e.watch(()=>this.layer?.featureCollections,a=>{this._clear();for(const {popupInfo:c,featureSet:m,layerDefinition:g}of a){a=w.fromJSON(m);var d=new t(a.features),b=g.drawingInfo;const B=c?r.fromJSON(c):null;b=v.fromJSON(b.renderer);d=new z({requestUpdateCallback:()=>this.requestUpdate(),view:this.view,graphics:d,renderer:b,container:new y(this.view.featuresTilingScheme)});
this._graphicsViewMap[a.geometryType]=d;this._popupTemplates.set(d,B);"polygon"!==a.geometryType||this.layer.polygonSymbol?"polyline"!==a.geometryType||this.layer.lineSymbol?"point"!==a.geometryType||this.layer.pointSymbol||(this.layer.pointSymbol=b.symbol):this.layer.lineSymbol=b.symbol:this.layer.polygonSymbol=b.symbol;this.graphicsViews.push(d);this.container.addChild(d.container)}},e.initial),e.watch(()=>this.layer?.polygonSymbol,a=>{this._graphicsViewMap.polygon.renderer=new k({symbol:a})},e.initial),
e.watch(()=>this.layer?.lineSymbol,a=>{this._graphicsViewMap.polyline.renderer=new k({symbol:a})},e.initial),e.watch(()=>this.layer?.pointSymbol,a=>{this._graphicsViewMap.point.renderer=new k({symbol:a})},e.initial)])};f.detach=function(){this._clear()};f.moveStart=function(){};f.moveEnd=function(){};f.viewChange=function(){for(const a of this.graphicsViews)a.viewChange()};f._clear=function(){this.container.removeAllChildren();for(const a of this.graphicsViews)a.destroy();this._graphicsViewMap={};
this._popupTemplates.clear();this.graphicsViews.length=0};return n._createClass(l)}(x.LayerView2DMixin(A));return h=q.__decorate([u.subclass("esri.views.2d.layers.GeoRSSLayerView2D")],h)});
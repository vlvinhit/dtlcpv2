// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/2d/engine/vectorTiles/TileHandler":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/urlUtils ../../../../core/workers/workers ./GlyphMosaic ./GlyphSource ./SpriteMosaic ../../tiling/TileKey".split(" "),function(C,u,F,B,x,h,g,b,c,a){function d(m){return()=>m.abort()}let f=function(){function m(l,t,p){this._layer=l;this._styleRepository=t;this.devicePixelRatio=p;this._inputSignalEventListener=
this._startOptionsInputSignal=this._spriteSourceAbortController=this._connection=this._glyphMosaic=this._spriteMosaic=null}var w=m.prototype;w.destroy=function(){this._connection?.close();this._glyphMosaic=this._spriteMosaic=this._layer=this._styleRepository=this._connection=null;this._spriteSourceAbortController=F.abortMaybe(this._spriteSourceAbortController);this._spriteSourcePromise=null;this._inputSignalEventListener&&this._startOptionsInputSignal?.removeEventListener("abort",this._inputSignalEventListener);
this._inputSignalEventListener=this._startOptionsInputSignal=null};w.start=async function(l){this._requestSprite(l);var t=this._layer.currentStyleInfo.glyphsUrl;t=new b(t?x.addQueryParameters(t,{...this._layer.customParameters,token:this._layer.apiKey}):null);this._glyphMosaic=new g(1024,1024,t);this._broadcastPromise=h.open("WorkerTileHandler",{client:this,schedule:l.schedule,signal:l.signal}).then(p=>{this._layer&&(this._connection?.close(),this._connection=p,this._layer&&!this._connection.closed&&
(p=p.broadcast("setStyle",this._layer.currentStyleInfo.style,l),Promise.all(p).catch(n=>B.throwIfNotAbortError(n))))})};w._requestSprite=function(l){this._spriteSourceAbortController?.abort();const t=new AbortController;this._spriteSourceAbortController=t;const p=l?.signal;this._inputSignalEventListener&&this._startOptionsInputSignal?.removeEventListener("abort",this._inputSignalEventListener);this._startOptionsInputSignal=null;p&&(this._inputSignalEventListener=d(t),p.addEventListener("abort",this._inputSignalEventListener,
{once:!0}));const {signal:n}=t;this._spriteSourcePromise=this._layer.loadSpriteSource(this.devicePixelRatio,{...l,signal:n});this._spriteSourcePromise.then(v=>{B.throwIfAbortError(n);this._spriteMosaic=new c(1024,1024,250);this._spriteMosaic.setSpriteSource(v)})};w.updateStyle=async function(l){await this._broadcastPromise;return this._broadcastPromise=Promise.all(this._connection.broadcast("updateStyle",l))};w.setSpriteSource=function(l){const t=new c(1024,1024,250);t.setSpriteSource(l);this._spriteMosaic=
t;this._spriteSourcePromise=Promise.resolve(l);this._spriteSourceAbortController=null;return t};w.setStyle=async function(l,t){await this._broadcastPromise;this._styleRepository=l;this._requestSprite();l=new b(this._layer.currentStyleInfo.glyphsUrl?x.addQueryParameters(this._layer.currentStyleInfo.glyphsUrl,{...this._layer.customParameters,token:this._layer.apiKey}):null);this._glyphMosaic=new g(1024,1024,l);return this._broadcastPromise=Promise.all(this._connection.broadcast("setStyle",t))};w.fetchTileData=
function(l,t){return this._getRefKeys(l,t).then(p=>{const n=this._layer.sourceNameToSource,v=[];for(const E in n)v.push(E);return this._getSourcesData(v,p,t)})};w.parseTileData=function(l,t){const p=l&&l.data;if(!p)return Promise.resolve(null);const {sourceName2DataAndRefKey:n,transferList:v}=p;return 0===Object.keys(n).length?Promise.resolve(null):this._broadcastPromise.then(()=>this._connection.invoke("createTileAndParse",{key:l.key.id,sourceName2DataAndRefKey:n,styleLayerUIDs:l.styleLayerUIDs},
{...t,transferList:v}))};w.getSprites=async function(l){await this._spriteSourcePromise;return this._spriteMosaic.getSpriteItems(l)};w.getGlyphs=function(l){return this._glyphMosaic.getGlyphItems(l.font,l.codePoints)};w._getTilePayload=async function(l,t,p){l=a.pool.acquire(l.id);const n=this._layer.sourceNameToSource[t],{level:v,row:E,col:D}=l;a.pool.release(l);try{return{protobuff:await n.requestTile(v,E,D,p),sourceName:t}}catch(A){if(B.isAbortError(A))throw A;return{protobuff:null,sourceName:t}}};
w._getRefKeys=function(l,t){const p=this._layer.sourceNameToSource,n=[];for(const v in p){const E=p[v].getRefKey(l,t);n.push(E)}return B.eachAlways(n)};w._getSourcesData=function(l,t,p){const n=[];for(let v=0;v<t.length;v++)if(null==t[v].value||null==l[v])n.push(null);else{const E=this._getTilePayload(t[v].value,l[v],p);n.push(E)}return B.eachAlways(n).then(v=>{const E={},D=[];for(let A=0;A<v.length;A++){const q=v[A].value;q&&q.protobuff&&0<q.protobuff.byteLength&&(E[q.sourceName]={refKey:t[A].value.id,
protobuff:q.protobuff},D.push(q.protobuff))}return{sourceName2DataAndRefKey:E,transferList:D}})};u._createClass(m,[{key:"spriteMosaic",get:function(){return this._spriteSourcePromise.then(()=>this._spriteMosaic)}},{key:"glyphMosaic",get:function(){return this._glyphMosaic}}]);return m}();C.TileHandler=f;Object.defineProperty(C,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/GlyphMosaic":function(){define("../../../../chunks/_rollupPluginBabelHelpers ./RectangleBinPack ../webgl/Rect ../../../webgl/enums ../../../webgl/Texture ../../../webgl/TextureDescriptor".split(" "),
function(C,u,F,B,x,h){return function(){function g(c,a,d){this.height=this.width=0;this._dirties=[];this._glyphData=[];this._currentPage=0;this._glyphIndex={};this._textures=[];this._rangePromises=new Map;this.width=c;this.height=a;this._glyphSource=d;this._binPack=new u(c-4,a-4);this._glyphData.push(new Uint8Array(c*a));this._dirties.push(!0);this._textures.push(void 0)}var b=g.prototype;b.getGlyphItems=function(c,a){const d=[],f=this._glyphSource,m=new Set,w=1/256;for(const t of a)m.add(Math.floor(t*
w));const l=[];m.forEach(t=>{const p=c+t;this._rangePromises.has(p)?l.push(this._rangePromises.get(p)):(t=f.getRange(c,t).then(()=>{this._rangePromises["delete"](p)},()=>{this._rangePromises["delete"](p)}),this._rangePromises.set(p,t),l.push(t))});return Promise.all(l).then(()=>{let t=this._glyphIndex[c];t||(t={},this._glyphIndex[c]=t);for(const D of a){var p=t[D];if(p){d[D]={sdf:!0,rect:p.rect,metrics:p.metrics,page:p.page,code:D};continue}var n=f.getGlyph(c,D);if(!n||!n.metrics)continue;p=n.metrics;
let A;if(0===p.width)A=new F(0,0,0,0);else{const q=p.width+6,y=p.height+6;var v=q%4?4-q%4:4,E=y%4?4-y%4:4;1===v&&(v=5);1===E&&(E=5);A=this._binPack.allocate(q+v,y+E);A.isEmpty&&(this._dirties[this._currentPage]||(this._glyphData[this._currentPage]=null),this._currentPage=this._glyphData.length,this._glyphData.push(new Uint8Array(this.width*this.height)),this._dirties.push(!0),this._textures.push(void 0),this._binPack=new u(this.width-4,this.height-4),A=this._binPack.allocate(q+v,y+E));v=this._glyphData[this._currentPage];
n=n.bitmap;let K;if(n)for(let N=0;N<y;N++){E=q*N;K=this.width*(A.y+N+1)+A.x;for(let Q=0;Q<q;Q++)v[K+Q+1]=n[E+Q]}}t[D]={rect:A,metrics:p,tileIDs:null,page:this._currentPage};d[D]={sdf:!0,rect:A,metrics:p,page:this._currentPage,code:D};this._dirties[this._currentPage]=!0}return d})};b.removeGlyphs=function(c){for(const a in this._glyphIndex){const d=this._glyphIndex[a];if(!d)continue;let f;for(const m in d)if(f=d[m],f.tileIDs["delete"](c),0===f.tileIDs.size){const w=this._glyphData[f.page],l=f.rect;
let t,p;for(let n=0;n<l.height;n++)for(t=this.width*(l.y+n)+l.x,p=0;p<l.width;p++)w[t+p]=0;delete d[m];this._dirties[f.page]=!0}}};b.bind=function(c,a,d,f=0){if(!this._textures[d]){var m=new h.TextureDescriptor;m.pixelFormat=B.PixelFormat.ALPHA;m.wrapMode=B.TextureWrapMode.CLAMP_TO_EDGE;m.width=this.width;m.height=this.height;this._textures[d]=new x.Texture(c,m,new Uint8Array(this.width*this.height))}m=this._textures[d];m.setSamplingMode(a);this._dirties[d]&&m.setData(this._glyphData[d]);c.bindTexture(m,
f);this._dirties[d]=!1};b.dispose=function(){this._binPack=null;for(const c of this._textures)c&&c.dispose();this._textures.length=0};return C._createClass(g)}()})},"esri/views/2d/engine/vectorTiles/RectangleBinPack":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","../webgl/Rect"],function(C,u){return function(){function F(x,h){this._height=this._width=0;this._free=[];this._width=x;this._height=h;this._free.push(new u(0,0,x,h))}var B=F.prototype;B.allocate=function(x,h){if(x>this._width||
h>this._height)return new u;let g=null,b=-1;for(let c=0;c<this._free.length;++c){const a=this._free[c];x<=a.width&&h<=a.height&&(null===g||a.y<=g.y&&a.x<=g.x)&&(g=a,b=c)}if(null===g)return new u;this._free.splice(b,1);g.width<g.height?(g.width>x&&this._free.push(new u(g.x+x,g.y,g.width-x,h)),g.height>h&&this._free.push(new u(g.x,g.y+h,g.width,g.height-h))):(g.width>x&&this._free.push(new u(g.x+x,g.y,g.width-x,g.height)),g.height>h&&this._free.push(new u(g.x,g.y+h,x,g.height-h)));return new u(g.x,
g.y,x,h)};B.release=function(x){for(let h=0;h<this._free.length;++h){const g=this._free[h];if(g.y===x.y&&g.height===x.height&&g.x+g.width===x.x)g.width+=x.width;else if(g.x===x.x&&g.width===x.width&&g.y+g.height===x.y)g.height+=x.height;else if(x.y===g.y&&x.height===g.height&&x.x+x.width===g.x)g.x=x.x,g.width+=x.width;else if(x.x===g.x&&x.width===g.width&&x.y+x.height===g.y)g.y=x.y,g.height+=x.height;else continue;this._free.splice(h,1);this.release(x)}this._free.push(x)};C._createClass(F,[{key:"width",
get:function(){return this._width}},{key:"height",get:function(){return this._height}}]);return F}()})},"esri/views/2d/engine/vectorTiles/GlyphSource":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","../../../../request","../../../../core/pbf"],function(C,u,F){let B=function(){function h(b){this._metrics=[];this._bitmaps=[];if(b)for(;b.next();)switch(b.tag()){case 1:const c=b.getMessage();for(;c.next();)switch(c.tag()){case 3:const a=c.getMessage();let d,f,m,w,l,t,p;for(;a.next();)switch(a.tag()){case 1:d=
a.getUInt32();break;case 2:f=a.getBytes();break;case 3:m=a.getUInt32();break;case 4:w=a.getUInt32();break;case 5:l=a.getSInt32();break;case 6:t=a.getSInt32();break;case 7:p=a.getUInt32();break;default:a.skip()}a.release();d&&(this._metrics[d]={width:m,height:w,left:l,top:t,advance:p},this._bitmaps[d]=f);break;default:c.skip()}c.release();break;default:b.skip()}}var g=h.prototype;g.getMetrics=function(b){return this._metrics[b]};g.getBitmap=function(b){return this._bitmaps[b]};return C._createClass(h)}(),
x=function(){function h(){this._ranges=[]}var g=h.prototype;g.getRange=function(b){return this._ranges[b]};g.addRange=function(b,c){this._ranges[b]=c};return C._createClass(h)}();return function(){function h(b){this._glyphInfo={};this._baseURL=b}var g=h.prototype;g.getRange=function(b,c){const a=this._getFontStack(b);if(a.getRange(c))return Promise.resolve();const d=256*c,f=d+255;if(this._baseURL)return b=this._baseURL.replace("{fontstack}",b).replace("{range}",d+"-"+f),u(b,{responseType:"array-buffer"}).then(m=>
{a.addRange(c,new B(new F(new Uint8Array(m.data),new DataView(m.data))))}).catch(()=>{a.addRange(c,new B)});a.addRange(c,new B);return Promise.resolve()};g.getGlyph=function(b,c){if(b=this._getFontStack(b))if(b=b.getRange(Math.floor(c/256)))return{metrics:b.getMetrics(c),bitmap:b.getBitmap(c)}};g._getFontStack=function(b){let c=this._glyphInfo[b];c||(c=this._glyphInfo[b]=new x);return c};return C._createClass(h)}()})},"esri/views/2d/engine/vectorTiles/SpriteMosaic":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../symbols/cim/rasterizingUtils ./RectangleBinPack ../webgl/Rect ../../../webgl/enums ../../../webgl/Texture ../../../webgl/TextureDescriptor".split(" "),
function(C,u,F,B,x,h,g){return function(){function b(a,d,f=0){this._size=[];this._mosaicsData=[];this._textures=[];this._dirties=[];this._pageHeight=this._pageWidth=this._currentPage=this._maxItemSize=0;this._mosaicRects={};this.pixelRatio=1;(0>=a||0>=d)&&console.error("Sprites mosaic defaultWidth and defaultHeight must be greater than zero!");this._pageWidth=a;this._pageHeight=d;0<f&&(this._maxItemSize=f);this._binPack=new F(a-4,d-4)}var c=b.prototype;c.dispose=function(){this._binPack=null;this._mosaicRects=
{};for(const a of this._textures)a&&a.dispose();this._textures.length=0};c.getWidth=function(a){return a>=this._size.length?-1:this._size[a][0]};c.getHeight=function(a){return a>=this._size.length?-1:this._size[a][1]};c.getPageSize=function(a){return a>=this._size.length?null:this._size[a]};c.setSpriteSource=function(a){this.dispose();this.pixelRatio=a.devicePixelRatio;if(0===this._mosaicsData.length){this._binPack=new F(this._pageWidth-4,this._pageHeight-4);const d=new Uint32Array(Math.floor(this._pageWidth)*
Math.floor(this._pageHeight));this._mosaicsData[0]=d;this._dirties.push(!0);this._size.push([this._pageWidth,this._pageHeight]);this._textures.push(void 0)}this._sprites=a};c.getSpriteItem=function(a,d=!1){var f=this._mosaicRects[a];if(f)return f;if(!this._sprites||"loaded"!==this._sprites.loadStatus)return null;let m;a&&a.startsWith("dasharray-")?([f,m]=this._rasterizeDash(a),d=!0):f=this._sprites.getSpriteInfo(a);if(!f||!f.width||!f.height||0>f.width||0>f.height)return null;const w=f.width,l=f.height,
[t,p,n]=this._allocateImage(w,l);if(0>=t.width)return null;this._copy(t,f,p,n,d,m);f={rect:t,width:w,height:l,sdf:f.sdf,simplePattern:!1,pixelRatio:f.pixelRatio,page:p};return this._mosaicRects[a]=f};c.getSpriteItems=function(a){const d={};for(const f of a)d[f.name]=this.getSpriteItem(f.name,f.repeat);return d};c.getMosaicItemPosition=function(a,d){d=(a=this.getSpriteItem(a,d))&&a.rect;if(!d)return null;d.width=a.width;d.height=a.height;return{tl:[d.x+2,d.y+2],br:[d.x+2+a.width,d.y+2+a.height],page:a.page}};
c.bind=function(a,d,f=0,m=0){if(!(f>=this._size.length||f>=this._mosaicsData.length)){if(!this._textures[f]){var w=new g.TextureDescriptor;w.wrapMode=x.TextureWrapMode.CLAMP_TO_EDGE;w.width=this._size[f][0];w.height=this._size[f][1];this._textures[f]=new h.Texture(a,w,new Uint8Array(this._mosaicsData[f].buffer))}w=this._textures[f];w.setSamplingMode(d);this._dirties[f]&&w.setData(new Uint8Array(this._mosaicsData[f].buffer));a.bindTexture(w,m);this._dirties[f]=!1}};b._copyBits=function(a,d,f,m,w,l,
t,p,n,v,E){let D=m*d+f;t=p*l+t;if(E)for(t-=l,E=-1;E<=v;E++,D=((E+v)%v+m)*d+f,t+=l)for(p=-1;p<=n;p++)w[t+p]=a[D+(p+n)%n];else for(f=0;f<v;f++){for(m=0;m<n;m++)w[t+m]=a[D+m];D+=d;t+=l}};c._copy=function(a,d,f,m,w,l){if(this._sprites&&"loaded"===this._sprites.loadStatus&&!(f>=this._mosaicsData.length)){var t=new Uint32Array(l?l.buffer:this._sprites.image.buffer),p=this._mosaicsData[f];p&&t||console.error("Source or target images are uninitialized!");b._copyBits(t,l?d.width:this._sprites.width,d.x,d.y,
p,m[0],a.x+2,a.y+2,d.width,d.height,w);this._dirties[f]=!0}};c._allocateImage=function(a,d){a+=2;d+=2;var f=Math.max(a,d);if(this._maxItemSize&&this._maxItemSize<f)return f=new B(0,0,a,d),this._mosaicsData.push(new Uint32Array(a*d)),this._dirties.push(!0),this._size.push([a,d]),this._textures.push(void 0),[f,this._mosaicsData.length-1,[a,d]];f=a%4?4-a%4:4;let m=d%4?4-d%4:4;1===f&&(f=5);1===m&&(m=5);f=this._binPack.allocate(a+f,d+m);return 0>=f.width?(this._dirties[this._currentPage]||(this._mosaicsData[this._currentPage]=
null),this._currentPage=this._mosaicsData.length,this._mosaicsData.push(new Uint32Array(this._pageWidth*this._pageHeight)),this._dirties.push(!0),this._size.push([this._pageWidth,this._pageHeight]),this._textures.push(void 0),this._binPack=new F(this._pageWidth-4,this._pageHeight-4),this._allocateImage(a,d)):[f,this._currentPage,[this._pageWidth,this._pageHeight]]};c._rasterizeDash=function(a){var d=a.match(/\[(.*?)\]/);if(!d)return null;d=d[1].split(",").map(Number);a=a.slice(a.lastIndexOf("-")+
1);const [f,m,w]=u.rasterizeDash(d,a);a=new Uint8Array(f.buffer);return[{x:0,y:0,width:m,height:w,sdf:!0,pixelRatio:1},a]};return C._createClass(b)}()})},"esri/views/2d/engine/vectorTiles/TileManager":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../core/LRUCache","../../tiling/TileCoverage","../../tiling/TileKey"],function(C,u,F,B,x){const h=(b,c)=>b+1/(1<<2*c);let g=function(){function b(a,d){this._tiles=new Map;this._tileCache=new F.LRUCache(40,f=>f.dispose());
this._viewSize=[0,0];this._visibleTiles=new Map;this.acquireTile=a.acquireTile;this.releaseTile=a.releaseTile;this.tileInfoView=a.tileInfoView;this._container=d}var c=b.prototype;c.destroy=function(){for(const [,a]of this._tiles)a.dispose();this._tiles=null;this._tileCache.clear();this._tileCache=null};c.update=function(a){this._updateCacheSize(a);const d=this.tileInfoView;a=d.getTileCoverage(a.state,0,!0,"smallest");const {spans:f,lodInfo:m}=a,{level:w}=m,l=this._tiles,t=new Set,p=new Set;for(const {row:v,
colFrom:E,colTo:D}of f)for(let A=E;A<=D;A++){const q=x.getId(w,v,m.normalizeCol(A),m.getWorldForColumn(A)),y=this._getOrAcquireTile(q);t.add(q);y.processed()?this._addToContainer(y):p.add(new x(q))}for(const [v,E]of l)E.isCoverage=t.has(v);for(var n of p)this._findPlaceholdersForMissingTiles(n,t);n=!1;for(const [v,E]of l)E.neededForCoverage=t.has(v),E.neededForCoverage||E.isHoldingForFade&&d.intersects(a,E.key)&&t.add(v),E.isFading&&(n=!0);for(const [v]of this._tiles)t.has(v)||this._releaseTile(v);
B.pool.release(a);return!n};c.clear=function(){this._tiles.clear();this._tileCache.clear();this._visibleTiles.clear()};c.clearCache=function(){this._tileCache.clear()};c._findPlaceholdersForMissingTiles=function(a,d){var f=[];for(const [,m]of this._tiles)this._addPlaceholderChild(f,m,a,d);f=f.reduce(h,0);1E-6>Math.abs(1-f)||this._addPlaceholderParent(a.id,d)};c._addPlaceholderChild=function(a,d,f,m){if(!(d.key.level<=f.level)&&d.hasData()){var w=d.key,l=w.level-f.level;f.row===w.row>>l&&f.col===w.col>>
l&&f.world===w.world&&(this._addToContainer(d),m.add(d.id),a.push(d.key.level-f.level))}};c._addPlaceholderParent=function(a,d){const f=this._tiles;for(;;){{const [w,l,t,p]=a.split("/");a=parseInt(w,10);a=0===a?null:`${a-1}/${parseInt(l,10)>>1}/${parseInt(t,10)>>1}/${parseInt(p,10)}`}if(!a||d.has(a))break;const m=f.get(a);if(m&&m.hasData()){this._addToContainer(m);d.add(m.id);break}}};c._getOrAcquireTile=function(a){let d=this._tiles.get(a);if(d)return d;(d=this._tileCache.pop(a))||(d=this.acquireTile(new x(a)));
this._tiles.set(a,d);return d};c._releaseTile=function(a){const d=this._tiles.get(a);this.releaseTile(d);this._removeFromContainer(d);this._tiles.delete(a);d.hasData()?this._tileCache.put(a,d,1):d.dispose()};c._addToContainer=function(a){let d;const f=[],m=this._container;if(!m.contains(a)){var w=this._visibleTiles;for(const [,l]of w)this._canConnectDirectly(a,l)&&f.push(l),null==d&&this._canConnectDirectly(l,a)&&(d=l);if(null!=d){for(const l of f)d.childrenTiles.delete(l),a.childrenTiles.add(l),
l.parentTile=a;d.childrenTiles.add(a);a.parentTile=d}else for(const l of f)a.childrenTiles.add(l),l.parentTile=a;w.set(a.id,a);m.addChild(a)}};c._removeFromContainer=function(a){this._visibleTiles.delete(a.id);this._container.removeChild(a);if(null!=a.parentTile){a.parentTile.childrenTiles.delete(a);for(const d of a.childrenTiles)null!=a.parentTile&&a.parentTile.childrenTiles.add(d)}for(const d of a.childrenTiles)d.parentTile=a.parentTile;a.parentTile=null;a.childrenTiles.clear()};c._canConnectDirectly=
function(a,d){a=a.key;let {level:f,row:m,col:w,world:l}=d.key;for(d=this._visibleTiles;0<f;){f--;m>>=1;w>>=1;if(a.level===f&&a.row===m&&a.col===w&&a.world===l)return!0;if(d.has(`${f}/${m}/${w}/${l}`))break}return!1};c._updateCacheSize=function(a){a=a.state.size;if(a[0]!==this._viewSize[0]||a[1]!==this._viewSize[1]){var d=Math.ceil(a[0]/512)+1,f=Math.ceil(a[1]/512)+1;this._viewSize[0]=a[0];this._viewSize[1]=a[1];this._tileCache.maxSize=5*d*f}};return u._createClass(b)}();C.TileManager=g;Object.defineProperty(C,
Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/VectorTile":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../chunks/mat3 ../../../../chunks/mat3f32 ./enums ./RenderBucket ./decluttering/config ../webgl/TiledDisplayObject".split(" "),function(C,u,F,B,x,h,g,b,c){F=function(d){function f(w,l,t,p,n,v,E,D=null){l=d.call(this,w,l,t,p,n,v,4096,4096)||this;l.styleRepository=E;l._memCache=D;l.type="vector-tile";l._referenced=
0;l._hasSymbolBuckets=!1;l._memoryUsedByLayerData=0;l.layerData=new Map;l.layerCount=0;l.status="loading";l.allSymbolsFadingOut=!1;l.lastOpacityUpdate=0;l.symbols=new Map;l.isCoverage=!1;l.neededForCoverage=!1;l.decluttered=!1;l.invalidating=!1;l.parentTile=null;l.childrenTiles=new Set;l._processed=!1;l._referenced=1;l.id=w.id;return l}u._inherits(f,d);var m=f.prototype;m.setData=function(w){this.changeDataImpl(w);this.requestRender();this.ready();this.invalidating=!1;this._processed=!0};m.deleteLayerData=
function(w){let l=!1;for(const t of w)this.layerData.has(t)&&(w=this.layerData.get(t),this._memoryUsedByLayerData-=w.memoryUsed,w.type===h.BucketType.SYMBOL&&this.symbols.has(t)&&(this.symbols.delete(t),l=!0),w.destroy(),this.layerData.delete(t),this.layerCount--);this._memCache?.updateSize(this.key.id,this,this._memoryUsedByLayerData);l&&this.emit("symbols-changed");this.requestRender()};m.processed=function(){return this._processed};m.hasData=function(){return 0<this.layerCount};m.dispose=function(){"unloaded"!==
this.status&&(a.delete(this),f._destroyRenderBuckets(this.layerData),this.layerData=null,this._memoryUsedByLayerData=this.layerCount=0,this.destroy(),this.status="unloaded")};m.release=function(){return 0===--this._referenced?(this.dispose(),this.stage=null,!0):!1};m.retain=function(){++this._referenced};m.changeDataImpl=function(w){let l=!1;if(w){const {bucketsWithData:t,emptyBuckets:p}=w;w=this._createRenderBuckets(t);if(p&&0<p.byteLength){const n=new Uint32Array(p);for(const v of n)this._deleteLayerData(v)}for(const [n,
v]of w)this._deleteLayerData(n),v.type===h.BucketType.SYMBOL&&(this.symbols.set(n,v.symbols),l=!0),this._memoryUsedByLayerData+=v.memoryUsed,this.layerData.set(n,v),this.layerCount++;this._memCache?.updateSize(this.key.id,this,this.memoryUsed)}this._hasSymbolBuckets=!1;for(const [,t]of this.layerData)t.type===h.BucketType.SYMBOL&&(this._hasSymbolBuckets=!0);l&&this.emit("symbols-changed")};m.attachWithContext=function(w){this.stage={context:w,trashDisplayObject(l){l.processDetach()},untrashDisplayObject(){return!1}}};
m.setTransform=function(w){u._get(u._getPrototypeOf(f.prototype),"setTransform",this).call(this,w);var l=this.resolution/(w.resolution*w.pixelRatio);const t=this.width/this.rangeX*l;l*=this.height/this.rangeY;const p=[0,0];w.toScreen(p,[this.x,this.y]);const n=this.transforms.tileUnitsToPixels;B.identity(n);B.translate(n,n,p);B.rotate(n,n,Math.PI*w.rotation/180);B.scale(n,n,[t,l,1])};m._createTransforms=function(){return{dvs:x.create(),tileMat3:x.create(),tileUnitsToPixels:x.create()}};f._destroyRenderBuckets=
function(w){if(w){var l=new Set;w.forEach(t=>{l.has(t)||(t.destroy(),l.add(t))});w.clear()}};m._createRenderBuckets=function(w){const l=new Map,t=new Map;for(const p of w){w=this._deserializeBucket(p,t);for(const n of w.layerUIDs)l.set(n,w)}return l};m._deserializeBucket=function(w,l){let t=l.get(w);if(t)return t;switch((new Uint32Array(w))[0]){case h.BucketType.FILL:t=new g.FillRenderBucket(w,this.styleRepository);break;case h.BucketType.LINE:t=new g.LineRenderBucket(w,this.styleRepository);break;
case h.BucketType.SYMBOL:t=new g.SymbolRenderBucket(w,this.styleRepository,this);break;case h.BucketType.CIRCLE:t=new g.CircleRenderBucket(w,this.styleRepository)}l.set(w,t);return t};m._deleteLayerData=function(w){if(this.layerData.has(w)){var l=this.layerData.get(w);this._memoryUsedByLayerData-=l.memoryUsed;l.destroy();this.layerData.delete(w);this.layerCount--}};u._createClass(f,[{key:"hasSymbolBuckets",get:function(){return this._hasSymbolBuckets}},{key:"isFading",get:function(){return this._hasSymbolBuckets&&
performance.now()-this.lastOpacityUpdate<b.FADE_DURATION}},{key:"isHoldingForFade",get:function(){return this._hasSymbolBuckets&&(!this.allSymbolsFadingOut||performance.now()-this.lastOpacityUpdate<b.FADE_DURATION)}},{key:"wasRequested",get:function(){return"errored"===this.status||"loaded"===this.status||"reloading"===this.status}},{key:"referenced",get:function(){return this._referenced}},{key:"memoryUsed",get:function(){return this._memoryUsedByLayerData+256}}]);return f}(c.TiledDisplayObject);
const a=new Map;C.VectorTile=F;C.printAllocations=function(){a.forEach((d,f)=>{console.log(`\n${f.key}:`);d[0].forEach(m=>console.log(m));console.log("\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d");d[1].forEach(m=>console.log(m))})};Object.defineProperty(C,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/RenderBucket":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/typedArrayUtil ./enums ./decluttering/util ../../../webgl/BufferObject ../../../webgl/enums ../../../webgl/VertexArrayObject".split(" "),
function(C,u,F,B,x,h,g,b,c){let a=function(){function l(p,n){this.layerUIDs=[];this.isDestroyed=!1;this._data=p;let v=1;p=new Uint32Array(p);this.layerUIDs=[];const E=p[v++];for(let D=0;D<E;D++)this.layerUIDs[D]=p[v++];this.bufferDataOffset=v;n&&(this.layer=n.getStyleLayerByUID(this.layerUIDs[0]))}var t=l.prototype;t.destroy=function(){this.isDestroyed||(this.doDestroy(),this.isDestroyed=!0)};t.prepareForRendering=function(p){null!=this._data&&(this.doPrepareForRendering(p,this._data,this.bufferDataOffset),
this._data=null)};u._createClass(l,[{key:"isPreparedForRendering",get:function(){return null==this._data}},{key:"offset",get:function(){return this.bufferDataOffset}},{key:"data",get:function(){return this._data}}]);return l}(),d=function(l){function t(n,v){v=l.call(this,n,v)||this;v.type=x.BucketType.LINE;v.lineIndexStart=0;v.lineIndexCount=0;n=new Uint32Array(n);let E=v.bufferDataOffset;v.lineIndexStart=n[E++];v.lineIndexCount=n[E++];const D=n[E++];if(0<D){v.patternMap=new Map;for(let A=0;A<D;A++){const q=
n[E++],y=n[E++],K=n[E++];v.patternMap.set(q,[y,K])}}v.bufferDataOffset=E;return v}u._inherits(t,l);var p=t.prototype;p.hasData=function(){return 0<this.lineIndexCount};p.triangleCount=function(){return this.lineIndexCount/3};p.doDestroy=function(){this.vao=F.disposeMaybe(this.vao)};p.doPrepareForRendering=function(n,v,E){var D=new Uint32Array(v);v=new Int32Array(D.buffer);var A=D[E++];v=g.BufferObject.createVertex(n,b.Usage.STATIC_DRAW,new Int32Array(v.buffer,4*E,A));E+=A;A=D[E++];D=g.BufferObject.createIndex(n,
b.Usage.STATIC_DRAW,new Uint32Array(D.buffer,4*E,A));E+=A;E=this.layer.lineMaterial;this.vao=new c.VertexArrayObject(n,E.getAttributeLocations(),E.getLayoutInfo(),{geometry:v},D)};u._createClass(t,[{key:"memoryUsed",get:function(){return(this.data?.byteLength??0)+(this.vao?.memoryEstimate??0)}}]);return t}(a),f=function(l){function t(n,v){v=l.call(this,n,v)||this;v.type=x.BucketType.FILL;v.fillIndexStart=0;v.fillIndexCount=0;v.outlineIndexStart=0;v.outlineIndexCount=0;n=new Uint32Array(n);let E=v.bufferDataOffset;
v.fillIndexStart=n[E++];v.fillIndexCount=n[E++];v.outlineIndexStart=n[E++];v.outlineIndexCount=n[E++];const D=n[E++];if(0<D){v.patternMap=new Map;for(let A=0;A<D;A++){const q=n[E++],y=n[E++],K=n[E++];v.patternMap.set(q,[y,K])}}v.bufferDataOffset=E;return v}u._inherits(t,l);var p=t.prototype;p.hasData=function(){return 0<this.fillIndexCount||0<this.outlineIndexCount};p.triangleCount=function(){return(this.fillIndexCount+this.outlineIndexCount)/3};p.doDestroy=function(){this.fillVAO=F.disposeMaybe(this.fillVAO);
this.outlineVAO=F.disposeMaybe(this.outlineVAO)};p.doPrepareForRendering=function(n,v,E){var D=new Uint32Array(v),A=new Int32Array(D.buffer),q=D[E++];v=g.BufferObject.createVertex(n,b.Usage.STATIC_DRAW,new Int32Array(A.buffer,4*E,q));E+=q;var y=D[E++];q=g.BufferObject.createIndex(n,b.Usage.STATIC_DRAW,new Uint32Array(D.buffer,4*E,y));E+=y;y=D[E++];A=g.BufferObject.createVertex(n,b.Usage.STATIC_DRAW,new Int32Array(A.buffer,4*E,y));E+=y;y=D[E++];D=g.BufferObject.createIndex(n,b.Usage.STATIC_DRAW,new Uint32Array(D.buffer,
4*E,y));E+=y;y=this.layer;E=y.fillMaterial;y=y.outlineMaterial;this.fillVAO=new c.VertexArrayObject(n,E.getAttributeLocations(),E.getLayoutInfo(),{geometry:v},q);this.outlineVAO=new c.VertexArrayObject(n,y.getAttributeLocations(),y.getLayoutInfo(),{geometry:A},D)};u._createClass(t,[{key:"memoryUsed",get:function(){return(this.data?.byteLength??0)+(this.fillVAO?.memoryEstimate??0)+(this.outlineVAO?.memoryEstimate??0)}}]);return t}(a),m=function(l){function t(n,v,E){v=l.call(this,n,v)||this;v.type=
x.BucketType.SYMBOL;v.iconPerPageElementsMap=new Map;v.glyphPerPageElementsMap=new Map;v.symbolInstances=[];v.isIconSDF=!1;v.opacityChanged=!1;v.lastOpacityUpdate=0;v.symbols=[];const D=new Uint32Array(n),A=new Int32Array(n);n=new Float32Array(n);let q=v.bufferDataOffset;v.isIconSDF=!!D[q++];var y=D[q++];for(var K=0;K<y;K++){var N=D[q++],Q=D[q++],T=D[q++];v.iconPerPageElementsMap.set(N,[Q,T])}y=D[q++];for(K=0;K<y;K++)N=D[q++],Q=D[q++],T=D[q++],v.glyphPerPageElementsMap.set(N,[Q,T]);y=D[q++];K=D[q++];
v.iconOpacity=new Int32Array(y);v.textOpacity=new Int32Array(K);q=h.deserializeSymbols(D,A,n,q,v.symbols,E);v.bufferDataOffset=q;return v}u._inherits(t,l);var p=t.prototype;p.hasData=function(){return 0<this.iconPerPageElementsMap.size||0<this.glyphPerPageElementsMap.size};p.triangleCount=function(){let n=0;for(const [,v]of this.iconPerPageElementsMap)n+=v[1];for(const [,v]of this.glyphPerPageElementsMap)n+=v[1];return n/3};p.doDestroy=function(){this.iconVAO=F.disposeMaybe(this.iconVAO);this.textVAO=
F.disposeMaybe(this.textVAO)};p.updateOpacityInfo=function(){if(this.opacityChanged){this.opacityChanged=!1;var n=this.iconOpacity,v=this.iconVAO.vertexBuffers.opacity;0<n.length&&n.byteLength===v.byteLength&&v.setSubData(n,0,0,n.length);n=this.textOpacity;v=this.textVAO.vertexBuffers.opacity;0<n.length&&n.byteLength===v.byteLength&&v.setSubData(n,0,0,n.length)}};p.doPrepareForRendering=function(n,v,E){var D=new Uint32Array(v),A=new Int32Array(D.buffer),q=D[E++];v=g.BufferObject.createVertex(n,b.Usage.STATIC_DRAW,
new Int32Array(A.buffer,4*E,q));E+=q;var y=D[E++];q=g.BufferObject.createIndex(n,b.Usage.STATIC_DRAW,new Uint32Array(D.buffer,4*E,y));E+=y;y=D[E++];A=g.BufferObject.createVertex(n,b.Usage.STATIC_DRAW,new Int32Array(A.buffer,4*E,y));E+=y;y=D[E++];D=g.BufferObject.createIndex(n,b.Usage.STATIC_DRAW,new Uint32Array(D.buffer,4*E,y));E+=y;E=g.BufferObject.createVertex(n,b.Usage.STATIC_DRAW,this.iconOpacity.buffer);y=g.BufferObject.createVertex(n,b.Usage.STATIC_DRAW,this.textOpacity.buffer);var K=this.layer;
const N=K.iconMaterial;K=K.textMaterial;this.iconVAO=new c.VertexArrayObject(n,N.getAttributeLocations(),N.getLayoutInfo(),{geometry:v,opacity:E},q);this.textVAO=new c.VertexArrayObject(n,K.getAttributeLocations(),K.getLayoutInfo(),{geometry:A,opacity:y},D)};u._createClass(t,[{key:"memoryUsed",get:function(){return(this.data?.byteLength??0)+(this.iconVAO?.memoryEstimate??0)+(this.textVAO?.memoryEstimate??0)+B.estimateSize(this.iconOpacity)+B.estimateSize(this.textOpacity)}}]);return t}(a),w=function(l){function t(n,
v){v=l.call(this,n,v)||this;v.type=x.BucketType.CIRCLE;v.circleIndexStart=0;v.circleIndexCount=0;n=new Uint32Array(n);let E=v.bufferDataOffset;v.circleIndexStart=n[E++];v.circleIndexCount=n[E++];v.bufferDataOffset=E;return v}u._inherits(t,l);var p=t.prototype;p.hasData=function(){return 0<this.circleIndexCount};p.triangleCount=function(){return this.circleIndexCount/3};p.doDestroy=function(){this.vao=F.disposeMaybe(this.vao)};p.doPrepareForRendering=function(n,v,E){var D=new Uint32Array(v);v=new Int32Array(D.buffer);
var A=D[E++];v=g.BufferObject.createVertex(n,b.Usage.STATIC_DRAW,new Int32Array(v.buffer,4*E,A));E+=A;A=D[E++];D=g.BufferObject.createIndex(n,b.Usage.STATIC_DRAW,new Uint32Array(D.buffer,4*E,A));E+=A;E=this.layer.circleMaterial;this.vao=new c.VertexArrayObject(n,E.getAttributeLocations(),E.getLayoutInfo(),{geometry:v},D)};u._createClass(t,[{key:"memoryUsed",get:function(){return(this.data?.byteLength??0)+(this.vao?.memoryEstimate??0)}}]);return t}(a);C.CircleRenderBucket=w;C.FillRenderBucket=f;C.LineRenderBucket=
d;C.RenderBucketBase=a;C.SymbolRenderBucket=m;Object.defineProperty(C,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/decluttering/util":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../enums","./core"],function(C,u,F,B){let x=function(){function h(b,c,a){this._rows=Math.ceil(c/a);this._columns=Math.ceil(b/a);this._cellSize=a;this.cells=Array(this._rows);for(b=0;b<this._rows;b++)for(this.cells[b]=Array(this._columns),c=0;c<this._columns;c++)this.cells[b][c]=
[]}var g=h.prototype;g.getCell=function(b,c){c=Math.min(Math.max(Math.floor(c/this._cellSize),0),this._rows-1);b=Math.min(Math.max(Math.floor(b/this._cellSize),0),this._columns-1);return this.cells[c]&&this.cells[c][b]||null};g.getCellSpan=function(b,c,a,d){return[Math.min(Math.max(Math.floor(b/this._cellSize),0),this.columns-1),Math.min(Math.max(Math.floor(c/this._cellSize),0),this.rows-1),Math.min(Math.max(Math.floor(a/this._cellSize),0),this.columns-1),Math.min(Math.max(Math.floor(d/this._cellSize),
0),this.rows-1)]};u._createClass(h,[{key:"cellSize",get:function(){return this._cellSize}},{key:"columns",get:function(){return this._columns}},{key:"rows",get:function(){return this._rows}}]);return h}();C.GridIndex=x;C.deserializeSymbols=function(h,g,b,c,a,d){const f=g[c++];for(let l=0;l<f;l++){const t=new B.VTLSymbol(d);t.xTile=g[c++];t.yTile=g[c++];t.hash=g[c++];t.priority=g[c++];var m=g[c++];for(var w=0;w<m;w++){const p=g[c++],n=g[c++],v=g[c++],E=g[c++],D=!!g[c++],A=g[c++],q=b[c++],y=b[c++],
K=g[c++],N=g[c++];t.colliders.push({xTile:p,yTile:n,dxPixels:v,dyPixels:E,hard:D,partIndex:A,width:K,height:N,minLod:q,maxLod:y})}m=h[c++];for(w=0;w<m;w++)t.textVertexRanges.push([h[c++],h[c++]]);m=h[c++];for(w=0;w<m;w++)t.iconVertexRanges.push([h[c++],h[c++]]);a.push(t)}return c};C.tileCoordChange=function(h,g,b,c,a,d){b-=a;if(0<=b)return(g>>b)+(c-(d<<b))*(h>>b);b=-b;return g-(d-(c<<b))*(h>>b)<<b};C.writeOpacityToBuffers=function(h,g,b){for(const [l,t]of h.symbols){{var c=h,a=g,d=b,f=t;const p=c.layerData.get(l);
if(p.type===F.BucketType.SYMBOL){for(const n of f){f=n.unique;var m=void 0;if(n.selectedForRendering){var w=f.parts[0];m=w.startOpacity;w=w.targetOpacity;c.allSymbolsFadingOut=c.allSymbolsFadingOut&&0===w;m=d?Math.floor(127*m)|w<<7:w?255:0;m|=m<<24|m<<16|m<<8}else m=0;for(const [v,E]of n.iconVertexRanges)for(w=v;w<v+E;w+=4)p.iconOpacity[w/4]=m;n.selectedForRendering?(m=f.parts[1],f=m.startOpacity,m=m.targetOpacity,c.allSymbolsFadingOut=c.allSymbolsFadingOut&&0===m,f=d?Math.floor(127*f)|m<<7:m?255:
0,m=f<<24|f<<16|f<<8|f):m=0;for(const [v,E]of n.textVertexRanges)for(f=v;f<v+E;f+=4)p.textOpacity[f/4]=m}p.lastOpacityUpdate=a;p.opacityChanged=!0}}}};Object.defineProperty(C,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/decluttering/core":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers"],function(C,u){let F=u._createClass(function(B){this.hash=this.yTile=this.xTile=0;this.priority=1;this.colliders=[];this.textVertexRanges=[];this.iconVertexRanges=
[];this.tile=B});u=u._createClass(function(){this.tileSymbols=[];this.parts=[{startTime:0,startOpacity:0,targetOpacity:0,show:!1},{startTime:0,startOpacity:0,targetOpacity:0,show:!1}];this.show=!1});C.VTLSymbol=F;C.VTLUniqueSymbol=u;Object.defineProperty(C,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/VectorTileContainer":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/promiseUtils ../../../../geometry/support/aaBoundingRect ./decluttering/SymbolFader ./style/StyleDefinition ../webgl/enums ../webgl/RenderableTile ../webgl/TileContainer ../../tiling/TileCoverage ../../tiling/TileKey ../../../webgl/enums".split(" "),
function(C,u,F,B,x,h,g,b,c,a,d,f){function m(w,l){if(w){const t=w.getLayoutProperty("visibility");if(!t||t.getValue()!==h.Visibility.NONE&&(void 0===w.minzoom||w.minzoom<l+1E-6)&&(void 0===w.maxzoom||w.maxzoom>=l-1E-6))return!0}return!1}c=function(w){function l(p){p=w.call(this,p)||this;p._backgroundTiles=[];p._pointToCallbacks=new Map;return p}u._inherits(l,w);var t=l.prototype;t.destroy=function(){this.removeAllChildren();this._spriteMosaic?.dispose();this._spriteMosaic=null;this._glyphMosaic?.dispose();
this._glyphMosaic=null;null!=this._symbolFader&&(this._symbolFader.clear(),this._symbolFader=null);this._styleRepository=null;this._backgroundTiles=[];this._pointToCallbacks.clear()};t.setStyleResources=function(p,n,v){this._spriteMosaic=p;this._glyphMosaic=n;this._styleRepository=v;null==this._symbolFader&&(p=new x.SymbolFader(this._styleRepository,this.children),p.on("fade-start",()=>{this.emit("fade-start");this.requestRender()}),p.on("fade-complete",()=>{this.emit("fade-complete");this.requestRender()}),
this._symbolFader=p);this._symbolFader.styleRepository=v};t.setSpriteMosaic=function(p){this._spriteMosaic?.dispose();this._spriteMosaic=p};t.deleteStyleLayers=function(p){null!=this._symbolFader&&this._symbolFader.deleteStyleLayers(p)};t.hitTest=async function(p){const n=F.createResolver();this._pointToCallbacks.set(p,n);this.requestRender();return n.promise};t.enterTileInvalidation=function(){for(const p of this.children)p.invalidating=!0};t.createRenderParams=function(p){return{...u._get(u._getPrototypeOf(l.prototype),
"createRenderParams",this).call(this,p),renderPass:null,styleLayer:null,styleLayerUID:-1,glyphMosaic:this._glyphMosaic,spriteMosaic:this._spriteMosaic,hasClipping:!!this._clippingInfos}};t.doRender=function(p){!this.visible||p.drawPhase!==g.WGLDrawPhase.MAP&&p.drawPhase!==g.WGLDrawPhase.DEBUG||void 0===this._spriteMosaic||u._get(u._getPrototypeOf(l.prototype),"doRender",this).call(this,p)};t.addChild=function(p){u._get(u._getPrototypeOf(l.prototype),"addChild",this).call(this,p);null!=this._symbolFader?
this._symbolFader.addTile(p):p.decluttered=!0;this.requestRender();return p};t.removeChild=function(p){null!=this._symbolFader&&this._symbolFader.removeTile(p);this.requestRender();return u._get(u._getPrototypeOf(l.prototype),"removeChild",this).call(this,p)};t.renderChildren=function(p){const {drawPhase:n}=p;if(n===g.WGLDrawPhase.DEBUG)u._get(u._getPrototypeOf(l.prototype),"renderChildren",this).call(this,p);else if(this._doRender(p),0<this._pointToCallbacks.size){p.drawPhase=g.WGLDrawPhase.HITTEST;
const v=p.painter.effects.hittestVTL;v.bind(p);this._doRender(p);v.draw(p,this._pointToCallbacks);v.unbind(p);p.drawPhase=n}};t.removeAllChildren=function(){for(let p=0;p<this.children.length;p++){const n=this.children[p];null!=this._symbolFader&&this._symbolFader.removeTile(n);n.dispose()}u._get(u._getPrototypeOf(l.prototype),"removeAllChildren",this).call(this)};t.getStencilTarget=function(){return this.children.filter(p=>p.neededForCoverage&&p.hasData())};t.restartDeclutter=function(){null!=this._symbolFader&&
this._symbolFader.restartDeclutter()};t._doRender=function(p){const {context:n}=p;var v=this._styleRepository;if(v){var E=v.layers,D=!0;p.drawPhase===g.WGLDrawPhase.HITTEST&&(D=!1);0<v.backgroundBucketIds.length&&(p.renderPass="background",this._renderBackgroundLayers(p,v.backgroundBucketIds));u._get(u._getPrototypeOf(l.prototype),"renderChildren",this).call(this,p);p.drawPhase===g.WGLDrawPhase.MAP&&this._fade(p.displayLevel,p.state);if((v=this.children.filter(q=>q.visible&&q.hasData()))&&0!==v.length){for(var A of v)A.triangleCount=
0;n.setStencilWriteMask(0);n.setColorMask(!0,!0,!0,!0);n.setStencilOp(f.StencilOperation.KEEP,f.StencilOperation.KEEP,f.StencilOperation.REPLACE);n.setStencilTestEnabled(!0);n.setBlendingEnabled(!1);n.setDepthTestEnabled(!0);n.setDepthWriteEnabled(!0);n.setDepthFunction(f.CompareFunction.LEQUAL);n.setClearDepth(1);n.clear(n.gl.DEPTH_BUFFER_BIT);p.renderPass="opaque";for(A=E.length-1;0<=A;A--)this._renderStyleLayer(E[A],p,v);n.setDepthWriteEnabled(!1);n.setBlendingEnabled(D);n.setBlendFunctionSeparate(f.BlendFactor.ONE,
f.BlendFactor.ONE_MINUS_SRC_ALPHA,f.BlendFactor.ONE,f.BlendFactor.ONE_MINUS_SRC_ALPHA);p.renderPass="translucent";for(D=0;D<E.length;D++)this._renderStyleLayer(E[D],p,v)}n.bindVAO();n.setStencilTestEnabled(!0);n.setBlendingEnabled(!0)}};t._fade=function(p,n){null!=this._symbolFader&&(this._symbolFader.update(p,n)||this.requestRender())};t._renderStyleLayer=function(p,n,v){const {painter:E,renderPass:D}=n;if(void 0!==p){var A=p.getLayoutProperty("visibility");if(!A||A.getValue()!==h.Visibility.NONE){switch(p.type){case h.StyleLayerType.BACKGROUND:return;
case h.StyleLayerType.FILL:if("opaque"!==D&&"translucent"!==n.renderPass)return;var q="vtlFill";break;case h.StyleLayerType.LINE:if("translucent"!==D)return;q="vtlLine";break;case h.StyleLayerType.CIRCLE:if("translucent"!==D)return;q="vtlCircle";break;case h.StyleLayerType.SYMBOL:if("translucent"!==D)return;q="vtlSymbol"}v=p.type===h.StyleLayerType.SYMBOL?v.filter(y=>y.decluttered):v.filter(y=>y.neededForCoverage);if("vtlSymbol"!==q&&(A=n.displayLevel,0===v.length||void 0!==p.minzoom&&p.minzoom>=
A+1E-6||void 0!==p.maxzoom&&p.maxzoom<A-1E-6))return;A=p.uid;n.styleLayerUID=A;n.styleLayer=p;for(const y of v)if(y.layerData.has(A)){E.renderObjects(n,v,q);break}}}};t._renderBackgroundLayers=function(p,n){const {context:v,displayLevel:E,painter:D,state:A}=p,q=this._styleRepository;var y=!1;for(var K of n)if(q.getLayerById(K).type===h.StyleLayerType.BACKGROUND&&m(q.getLayerById(K),E)){y=!0;break}if(y){y=this._tileInfoView.getTileCoverage(p.state,0,!0,"smallest");var {spans:N,lodInfo:Q}=y,{level:T}=
Q,V=B.create();K=[];if(this._renderPasses){var P=this._renderPasses[0];null!=this._clippingInfos&&(P.brushes[0].prepareState(p),P.brushes[0].drawMany(p,this._clippingInfos))}P=this._backgroundTiles;var L=0;for(const {row:I,colFrom:S,colTo:M}of N)for(let R=S;R<=M;R++){if(L<P.length){var J=P[L];J.key.set(T,I,Q.normalizeCol(R),Q.getWorldForColumn(R));this._tileInfoView.getTileBounds(V,J.key,!1);J.x=V[0];J.y=V[3];J.resolution=this._tileInfoView.getTileResolution(T)}else{J=new d(T,I,Q.normalizeCol(R),
Q.getWorldForColumn(R));const X=this._tileInfoView.getTileBounds(B.create(),J),Z=this._tileInfoView.getTileResolution(T);J=new b.RenderableTile(J,Z,X[0],X[3],512,512,4096,4096);P.push(J)}J.setTransform(A);K.push(J);L++}v.setStencilWriteMask(0);v.setColorMask(!0,!0,!0,!0);v.setStencilOp(f.StencilOperation.KEEP,f.StencilOperation.KEEP,f.StencilOperation.REPLACE);v.setStencilFunction(f.CompareFunction.EQUAL,0,255);T=!0;p.drawPhase===g.WGLDrawPhase.HITTEST&&(T=!1);v.setStencilTestEnabled(T);for(const I of n)n=
q.getLayerById(I),n.type===h.StyleLayerType.BACKGROUND&&m(n,E)&&(p.styleLayerUID=n.uid,p.styleLayer=n,D.renderObjects(p,K,"vtlBackground"));a.pool.release(y)}};return u._createClass(l)}(c);C.VectorTileContainer=c;Object.defineProperty(C,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/decluttering/SymbolFader":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Evented ./config ./core ./jobs ./SymbolDeclutterer ./SymbolRepository ./util ../style/StyleDefinition".split(" "),
function(C,u,F,B,x,h,g,b,c,a){F=function(d){function f(w,l){var t=d.call(this)||this;t.styleRepository=w;t._tileToHandle=new Map;t._viewState={scale:0,rotation:0,center:[0,0],size:[0,0]};t._declutterViewState={scale:0,rotation:0,center:[0,0],size:[0,0]};t._completed=!1;t._symbolRepository=new b.SymbolRepository(4096,l,()=>new x.VTLUniqueSymbol);t._symbolDeclutterer=new g.SymbolDeclutterer(l,t._symbolRepository,(p,n,v)=>new h.CollisionJob(p,n,v,t.styleRepository,t._zoom,t._viewState.rotation),(p,n)=>
{p.allSymbolsFadingOut=!0;p.lastOpacityUpdate=n;c.writeOpacityToBuffers(p,n,!0);p.decluttered=!0;p.requestRender()},(p,n)=>t.styleRepository.getStyleLayerByUID(p.styleLayerUID).z-t.styleRepository.getStyleLayerByUID(n.styleLayerUID).z,p=>{p=t.styleRepository.getStyleLayerByUID(p);return t._zoom+1E-6<p.minzoom||t._zoom-1E-6>=p.maxzoom?!1:(p=p.getLayoutProperty("visibility"))&&p.getValue()===a.Visibility.NONE?!1:!0});return t}u._inherits(f,d);var m=f.prototype;m.addTile=function(w){w.decluttered=!1;
this._tileToHandle.set(w,w.on("symbols-changed",()=>{this._symbolRepository.add(w);this.restartDeclutter()}));this._symbolRepository.add(w);this.restartDeclutter()};m.removeTile=function(w){const l=this._tileToHandle.get(w);l&&(this._symbolRepository.removeTile(w),this.restartDeclutter(),l.remove(),this._tileToHandle.delete(w))};m.update=function(w,l){this._zoom=w;this._viewState={scale:l.scale,rotation:l.rotation,center:[l.center[0],l.center[1]],size:[l.size[0],l.size[1]]};this._continueDeclutter();
return this._completed};m.restartDeclutter=function(){this._completed=!1;this._symbolDeclutterer.restart();this._notifyUnstable()};m.clear=function(){this._completed=!1;this._symbolRepository=null;this._symbolDeclutterer.restart();this._tileToHandle.forEach(w=>w.remove());this._tileToHandle.clear()};m.deleteStyleLayers=function(w){this._symbolRepository.deleteStyleLayers(w)};m._continueDeclutter=function(){if(!this._completed||this.stale)this._symbolDeclutterer.running||(this._declutterZoom=this._zoom,
this._declutterViewState.center[0]=this._viewState.center[0],this._declutterViewState.center[1]=this._viewState.center[1],this._declutterViewState.rotation=this._viewState.rotation,this._declutterViewState.scale=this._viewState.scale,this._declutterViewState.size[0]=this._viewState.size[0],this._declutterViewState.size[1]=this._viewState.size[1],this._symbolDeclutterer.restart()),this._symbolDeclutterer.setScreenSize(this._viewState.size[0],this._viewState.size[1]),(this._completed=this._symbolDeclutterer.continue(B.DECLUTTER_BUDGET))&&
this._scheduleNotifyStable()};m._scheduleNotifyStable=function(){null!=this._stableNotificationHandle&&clearTimeout(this._stableNotificationHandle);this._stableNotificationHandle=setTimeout(()=>{this._stableNotificationHandle=null;this.emit("fade-complete")},1.5*B.FADE_DURATION)};m._notifyUnstable=function(){null!=this._stableNotificationHandle&&(clearTimeout(this._stableNotificationHandle),this._stableNotificationHandle=null);this.emit("fade-start")};u._createClass(f,[{key:"stale",get:function(){return this._zoom!==
this._declutterZoom||this._viewState.size[0]!==this._declutterViewState.size[0]||this._viewState.size[1]!==this._declutterViewState.size[1]||this._viewState.scale!==this._declutterViewState.scale||this._viewState.rotation!==this._declutterViewState.rotation}}]);return f}(F);C.SymbolFader=F;Object.defineProperty(C,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/decluttering/jobs":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/mat3f32 ./config ./util ../style/StyleDefinition".split(" "),
function(C,u,F,B,x,h){let g=function(){function b(a,d,f,m,w,l){this._symbols=a;this._styleRepository=m;this._zoom=w;this._currentSymbolCursor=this._currentLayerCursor=0;this._styleProps=new Map;this._allNeededMatrices=new Map;this._gridIndex=new x.GridIndex(d,f,B.COLLISION_GRID_CELL_SIZE);this._si=Math.sin(Math.PI*l/180);this._co=Math.cos(Math.PI*l/180);for(const t of a)for(const p of t.symbols)this._allNeededMatrices.has(p.tile)||this._allNeededMatrices.set(p.tile,F.clone(p.tile.transforms.tileUnitsToPixels))}
var c=b.prototype;c.work=function(a){const d=this._gridIndex,f=performance.now();for(;this._currentLayerCursor<this._symbols.length;this._currentLayerCursor++,this._currentSymbolCursor=0){const q=this._symbols[this._currentLayerCursor],y=this._getProperties(q.styleLayerUID);for(;this._currentSymbolCursor<q.symbols.length;this._currentSymbolCursor++){if(99===this._currentSymbolCursor%100&&performance.now()-f>a)return!1;var m=q.symbols[this._currentSymbolCursor];if(!m.unique.show)continue;var w=m,l=
this._si,t=this._co,p=this._allNeededMatrices.get(m.tile),n=this._zoom;const {iconRotationAlignment:K,textRotationAlignment:N,iconTranslate:Q,iconTranslateAnchor:T,textTranslate:V,textTranslateAnchor:P}=y;var v=0;for(const M of w.colliders){const [R,X]=0===M.partIndex?Q:V;var E=0===M.partIndex?T:P,D=M.minLod<=n&&n<=M.maxLod;v+=D?0:1;M.enabled=D;M.xScreen=M.xTile*p[0]+M.yTile*p[3]+p[6];M.yScreen=M.xTile*p[1]+M.yTile*p[4]+p[7];E===h.TranslateAnchor.MAP?(M.xScreen+=t*R-l*X,M.yScreen+=l*R+t*X):(M.xScreen+=
R,M.yScreen+=X);h.RotationAlignment.VIEWPORT===(0===M.partIndex?K:N)?(M.dxScreen=M.dxPixels,M.dyScreen=M.dyPixels):(M.dxScreen=t*(M.dxPixels+M.width/2)-l*(M.dyPixels+M.height/2)-M.width/2,M.dyScreen=l*(M.dxPixels+M.width/2)+t*(M.dyPixels+M.height/2)-M.height/2)}0<w.colliders.length&&v===w.colliders.length&&(w.unique.show=!1);w=m.unique;if(!w.show)continue;const {iconAllowOverlap:L,iconIgnorePlacement:J,textAllowOverlap:I,textIgnorePlacement:S}=y;for(const M of m.colliders)if(M.enabled&&(l=w.parts[M.partIndex],
l.show)){if(t=!(M.partIndex?I:L))a:{t=M.xScreen+M.dxScreen;p=M.yScreen+M.dyScreen;n=t+M.width;v=p+M.height;const [R,X,Z,ha]=d.getCellSpan(t,p,n,v);for(E=X;E<=ha;E++)for(D=R;D<=Z;D++){var A=d.cells[E][D];for(const da of A){A=da.xScreen+da.dxScreen;const W=da.yScreen+da.dyScreen,aa=A+da.width,ea=W+da.height;if(!(n<A||t>aa||v<W||p>ea)){t=!0;break a}}}t=!1}t&&(M.hard?w.show=!1:l.show=!1)}if(w.show)for(const M of m.colliders){if(!M.enabled)continue;if(M.partIndex?S:J)continue;if(!w.parts[M.partIndex].show)continue;
m=M.xScreen+M.dxScreen;l=M.yScreen+M.dyScreen;const [R,X,Z,ha]=this._gridIndex.getCellSpan(m,l,m+M.width,l+M.height);for(m=X;m<=ha;m++)for(l=R;l<=Z;l++)this._gridIndex.cells[m][l].push(M)}}}return!0};c._getProperties=function(a){var d=this._styleProps.get(a);if(d)return d;d=this._zoom;const f=this._styleRepository.getStyleLayerByUID(a);var m=f.getLayoutValue("symbol-placement",d)!==h.SymbolPlacement.POINT;let w=f.getLayoutValue("icon-rotation-alignment",d);w===h.RotationAlignment.AUTO&&(w=m?h.RotationAlignment.MAP:
h.RotationAlignment.VIEWPORT);let l=f.getLayoutValue("text-rotation-alignment",d);l===h.RotationAlignment.AUTO&&(l=m?h.RotationAlignment.MAP:h.RotationAlignment.VIEWPORT);m=f.getPaintValue("icon-translate",d);const t=f.getPaintValue("icon-translate-anchor",d),p=f.getPaintValue("text-translate",d),n=f.getPaintValue("text-translate-anchor",d);d={iconAllowOverlap:f.getLayoutValue("icon-allow-overlap",d),iconIgnorePlacement:f.getLayoutValue("icon-ignore-placement",d),textAllowOverlap:f.getLayoutValue("text-allow-overlap",
d),textIgnorePlacement:f.getLayoutValue("text-ignore-placement",d),iconRotationAlignment:w,textRotationAlignment:l,iconTranslateAnchor:t,iconTranslate:m,textTranslateAnchor:n,textTranslate:p};this._styleProps.set(a,d);return d};return u._createClass(b)}();C.CollisionJob=g;Object.defineProperty(C,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/decluttering/SymbolDeclutterer":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","./config"],function(C,
u,F){function B(h,g){if(h.priority-g.priority)return h.priority-g.priority;const b=h.tile.key,c=g.tile.key;return b.world-c.world?b.world-c.world:b.level-c.level?b.level-c.level:b.row-c.row?b.row-c.row:b.col-c.col?b.col-c.col:h.xTile-g.xTile?h.xTile-g.xTile:h.yTile-g.yTile}let x=function(){function h(b,c,a,d,f,m){this._visibleTiles=b;this._symbolRepository=c;this._createCollisionJob=a;this._assignTileSymbolsOpacity=d;this._symbolLayerSorter=f;this._isLayerVisible=m;this._selectionJob=null;this._selectionJobCompleted=
!1;this._collisionJob=null;this._collisionJobCompleted=!1;this._opacityJob=null;this._opacityJobCompleted=!1;this._running=!0}var g=h.prototype;g.setScreenSize=function(b,c){this._screenWidth===b&&this._screenHeight===c||this.restart();this._screenWidth=b;this._screenHeight=c};g.restart=function(){this._selectionJob=null;this._selectionJobCompleted=!1;this._collisionJob=null;this._collisionJobCompleted=!1;this._opacityJob=null;this._opacityJobCompleted=!1;this._running=!0};g.continue=function(b){this._selectionJob||
(this._selectionJob=this._createSelectionJob());if(!this._selectionJobCompleted){var c=performance.now();if(!this._selectionJob.work(b))return!1;this._selectionJobCompleted=!0;b=Math.max(0,b-(performance.now()-c));if(0===b)return!1}this._collisionJob||(this._collisionJob=this._createCollisionJob(this._selectionJob.sortedSymbols,this._screenWidth,this._screenHeight));if(!this._collisionJobCompleted){c=performance.now();if(!this._collisionJob.work(b))return!1;this._collisionJobCompleted=!0;b=Math.max(0,
b-(performance.now()-c));if(0===b)return!1}this._opacityJob||(this._opacityJob=this._createOpacityJob());if(!this._opacityJobCompleted){c=performance.now();if(!this._opacityJob.work(b))return!1;this._opacityJobCompleted=!0;b=Math.max(0,b-(performance.now()-c));if(0===b)return!1}this._running=!1;return!0};g._createSelectionJob=function(){const b=this._symbolRepository.uniqueSymbols;for(let w=0;w<b.length;w++){const l=b[w];for(let t=0;t<l.uniqueSymbols.length;t++){const p=l.uniqueSymbols[t];for(const n of p.tileSymbols)n.selectedForRendering=
!1}}const c=[];let a=0,d=0;const f=this._isLayerVisible,m=this._symbolLayerSorter;return{work:function(w){const l=performance.now();for(;d<b.length;d++,a=0){const p=b[d];var t=p.styleLayerUID;if(!f(t)){c[d]||(c[d]={styleLayerUID:t,symbols:[]});continue}c[d]=c[d]||{styleLayerUID:t,symbols:[]};const n=c[d];for(;a<p.uniqueSymbols.length;a++){t=p.uniqueSymbols[a];if(99===a%100&&performance.now()-l>w)return!1;let v=null,E=!1,D=!1;for(const A of t.tileSymbols)if(!D||!E){const q=A.tile;if(!v||q.isCoverage||
q.neededForCoverage&&!E){v=A;if(q.neededForCoverage||q.isCoverage)D=!0;q.isCoverage&&(E=!0)}}v.selectedForRendering=!0;if(D){n.symbols.push(v);t.show=!0;for(const A of t.parts)A.show=!0}else t.show=!1}}for(const p of c)p.symbols.sort(B);return!0},get sortedSymbols(){return c.sort(m)}}};g._createOpacityJob=function(){function b(f,m){var w=f.symbols;for(const [,t]of w){var l=t;w=m;for(const p of l){l=p.unique;for(const n of l.parts)n.startOpacity+=(w-n.startTime)/F.FADE_DURATION*(.5<n.targetOpacity?
1:-1),n.startOpacity=Math.min(Math.max(n.startOpacity,0),1),n.startTime=w,n.targetOpacity=l.show&&n.show?1:0}}c(f,m);for(const t of f.childrenTiles)b(t,m)}const c=this._assignTileSymbolsOpacity,a=this._visibleTiles;let d=0;return{work(f){const m=performance.now();for(;d<a.length;d++){if(performance.now()-m>f)return!1;const w=a[d];if(null!=w.parentTile)continue;const l=performance.now();b(w,l)}return!0}}};u._createClass(h,[{key:"running",get:function(){return this._running}}]);return h}();C.SymbolDeclutterer=
x;Object.defineProperty(C,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/decluttering/SymbolRepository":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","./util"],function(C,u,F){let B=function(){function x(g,b,c){this.tileCoordRange=g;this._visibleTiles=b;this._createUnique=c;this._tiles=new Map;this._uniqueSymbolsReferences=new Map}var h=x.prototype;h.add=function(g,b){this._uniqueSymbolLayerArray=null;let c=this._tiles.get(g.id);c||(c={symbols:new Map},
this._tiles.set(g.id,c));var a=new Map;if(b)for(var d of b)c.symbols.has(d)&&(a.set(d,c.symbols.get(d)),c.symbols.delete(d));else for(var [f]of g.layerData)c.symbols.has(f)&&(a.set(f,c.symbols.get(f)),c.symbols.delete(f));this._removeSymbols(a);b=g.symbols;a=new Map;for(const [m,w]of b)if(d=w.length,32<=d){f=this.tileCoordRange;do f/=2,d/=4;while(8<d&&64<f);d=new F.GridIndex(this.tileCoordRange,this.tileCoordRange,f);a.set(m,{flat:w,index:d});c.symbols.set(m,{flat:w,index:d});for(const l of w)d.getCell(l.xTile,
l.yTile).push(l)}else a.set(m,{flat:w}),c.symbols.set(m,{flat:w});this._addSymbols(g.key,b)};h.deleteStyleLayers=function(g){this._uniqueSymbolLayerArray=null;for(const [b,c]of this._tiles){const a=new Map;for(const d of g)c.symbols.has(d)&&(a.set(d,c.symbols.get(d)),c.symbols.delete(d));this._removeSymbols(a);0===c.symbols.size&&this._tiles.delete(b)}};h.removeTile=function(g){this._uniqueSymbolLayerArray=null;const b=this._tiles.get(g.id);if(b){var c=new Map;for(const [a]of g.symbols)b.symbols.has(a)&&
(c.set(a,b.symbols.get(a)),b.symbols.delete(a));this._removeSymbols(c);0===b.symbols.size&&this._tiles.delete(g.id)}};h._removeSymbols=function(g){for(const [c,{flat:a}]of g)for(const d of a){g=d.unique;var b=g.tileSymbols;const f=b.length-1;for(let m=0;m<f;m++)if(b[m]===d){b[m]=b[f];break}b.length=f;0===f&&(b=this._uniqueSymbolsReferences.get(c),b.delete(g),0===b.size&&this._uniqueSymbolsReferences.delete(c));d.unique=null}};h._addSymbols=function(g,b){if(0!==b.size){var c=this._visibleTiles;for(const a of c)a.parentTile||
a.key.world!==g.world||a.key.level===g.level&&!a.key.equals(g)||this._matchSymbols(a,g,b);for(const [a,d]of b)for(const f of d)null==f.unique&&(g=this._createUnique(),f.unique=g,g.tileSymbols.push(f),b=this._uniqueSymbolsReferences.get(a),b||(b=new Set,this._uniqueSymbolsReferences.set(a,b)),b.add(g))}};h._matchSymbols=function(g,b,c){if(g.key.level>b.level){var a=g.key.level-b.level;if(g.key.row>>a!==b.row||g.key.col>>a!==b.col)return}if(b.level>g.key.level&&(a=b.level-g.key.level,b.row>>a!==g.key.row||
b.col>>a!==g.key.col))return;if(b.equals(g.key))for(var d of g.childrenTiles)this._matchSymbols(d,b,c);else{d=new Map;for(const [w,l]of c){var f=[];for(const p of l)c=F.tileCoordChange(this.tileCoordRange,p.xTile,b.level,b.col,g.key.level,g.key.col),a=F.tileCoordChange(this.tileCoordRange,p.yTile,b.level,b.row,g.key.level,g.key.row),0<=c&&c<this.tileCoordRange&&0<=a&&a<this.tileCoordRange&&f.push({symbol:p,xTransformed:c,yTransformed:a});c=[];a=g.key.level<b.level?1:1<<g.key.level-b.level;const t=
this._tiles.get(g.id).symbols.get(w);if(t){const p=t.flat;for(const n of f){var m=!1;let v;const E=n.xTransformed,D=n.yTransformed;v=null!=t.index?t.index.getCell(E,D):p;f=n.symbol;const A=f.hash;for(const q of v)if(A===q.hash&&Math.abs(E-q.xTile)<=a&&Math.abs(D-q.yTile)<=a){m=q.unique;f.unique=m;m.tileSymbols.push(f);m=!0;break}m||c.push(f)}}0<c.length&&d.set(w,c)}for(const w of g.childrenTiles)this._matchSymbols(w,b,d)}};h._createUniqueSymbolLayerArray=function(){var g=this._uniqueSymbolsReferences;
const b=Array(g.size);let c=0;for(const [a,d]of g){const f=Array(d.size);g=0;for(const m of d)f[g++]=m;b[c]={styleLayerUID:a,uniqueSymbols:f};c++}return b};u._createClass(x,[{key:"uniqueSymbols",get:function(){null==this._uniqueSymbolLayerArray&&(this._uniqueSymbolLayerArray=this._createUniqueSymbolLayerArray());return this._uniqueSymbolLayerArray}}]);return x}();C.SymbolRepository=B;Object.defineProperty(C,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/RenderableTile":function(){define(["exports",
"../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/mat3f32","./TiledDisplayObject"],function(C,u,F,B){B=function(x){function h(){return x.apply(this,arguments)||this}u._inherits(h,x);h.prototype._createTransforms=function(){return{dvs:F.create(),tileMat3:F.create()}};return u._createClass(h)}(B.TiledDisplayObject);C.RenderableTile=B;Object.defineProperty(C,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/style/StyleRepository":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers",
"./StyleDefinition","./StyleLayer"],function(C,u,F){return function(){function B(h){this._style=h;this.backgroundBucketIds=[];this._uidToLayer=new Map;this._layerByName={};this._runningId=0;h.layers||(h.layers=[]);this.version=parseFloat(h.version);if(this.layers=h.layers.map((g,b,c)=>this._create(g,b,c)).filter(g=>!!g))for(let g=0;g<this.layers.length;g++)h=this.layers[g],this._layerByName[h.id]=h,this._uidToLayer.set(h.uid,h),h.type===u.StyleLayerType.BACKGROUND&&this.backgroundBucketIds.push(h.id);
this._identifyRefLayers()}var x=B.prototype;x.isPainterDataDriven=function(h){return(h=this._layerByName[h])?h.isPainterDataDriven():!1};x.getStyleLayerId=function(h){return h>=this.layers.length?null:this.layers[h].id};x.getStyleLayerByUID=function(h){return this._uidToLayer.get(h)??null};x.getStyleLayerIndex=function(h){return(h=this._layerByName[h])?this.layers.indexOf(h):-1};x.setStyleLayer=function(h,g){if(h&&h.id){var b=this._style;null!=g&&g>=this.layers.length&&(g=this.layers.length-1);var c=
!0,a;if(a=this._layerByName[h.id]){const d=this.layers.indexOf(a);g||(g=d);g===d?(c=!1,a=B._recreateLayer(h,a),this.layers[g]=a,b.layers[g]=h):(this.layers.splice(d,1),b.layers.splice(d,1),a=this._create(h,g,this.layers),this.layers.splice(g,0,a),b.layers.splice(g,0,h))}else a=this._create(h,g,this.layers),!g||g>=this.layers.length?(this.layers.push(a),b.layers.push(h)):(this.layers.splice(g,0,a),b.layers.splice(g,0,h));this._layerByName[h.id]=a;this._uidToLayer.set(a.uid,a);c&&this._recomputeZValues();
this._identifyRefLayers()}};x.getStyleLayer=function(h){return(h=this._layerByName[h])?{type:h.typeName,id:h.id,source:h.source,"source-layer":h.sourceLayer,minzoom:h.minzoom,maxzoom:h.maxzoom,filter:h.filter,layout:h.layout,paint:h.paint}:null};x.deleteStyleLayer=function(h){const g=this._layerByName[h];g&&(delete this._layerByName[h],this._uidToLayer.delete(g.uid),h=this.layers.indexOf(g),this.layers.splice(h,1),this._style.layers.splice(h,1),this._recomputeZValues(),this._identifyRefLayers())};
x.getLayerById=function(h){return this._layerByName[h]};x.getLayoutProperties=function(h){return(h=this._layerByName[h])?h.layout:null};x.getPaintProperties=function(h){return(h=this._layerByName[h])?h.paint:null};x.setPaintProperties=function(h,g){if(h=this._layerByName[h]){var b=B._recreateLayer({type:h.typeName,id:h.id,source:h.source,"source-layer":h.sourceLayer,minzoom:h.minzoom,maxzoom:h.maxzoom,filter:h.filter,layout:h.layout,paint:g},h),c=this.layers.indexOf(h);this.layers[c]=b;this._style.layers[c].paint=
g;this._layerByName[h.id]=b;this._uidToLayer.set(h.uid,b)}};x.setLayoutProperties=function(h,g){if(h=this._layerByName[h]){var b=B._recreateLayer({type:h.typeName,id:h.id,source:h.source,"source-layer":h.sourceLayer,minzoom:h.minzoom,maxzoom:h.maxzoom,filter:h.filter,layout:g,paint:h.paint},h),c=this.layers.indexOf(h);this.layers[c]=b;this._style.layers[c].layout=g;this._layerByName[h.id]=b;this._uidToLayer.set(h.uid,b)}};x.setStyleLayerVisibility=function(h,g){if(h=this._layerByName[h]){var b=h.layout||
{};b.visibility=g;g=B._recreateLayer({type:h.typeName,id:h.id,source:h.source,"source-layer":h.sourceLayer,minzoom:h.minzoom,maxzoom:h.maxzoom,filter:h.filter,layout:b,paint:h.paint},h);var c=this.layers.indexOf(h);this.layers[c]=g;this._style.layers[c].layout=b;this._layerByName[h.id]=g;this._uidToLayer.set(h.uid,g)}};x.getStyleLayerVisibility=function(h){return(h=this._layerByName[h])?h.layout?.visibility??"visible":"none"};x._recomputeZValues=function(){const h=this.layers,g=1/(h.length+1);for(let b=
0;b<h.length;b++)h[b].z=1-(1+b)*g};x._identifyRefLayers=function(){const h=[],g=[];let b=0;for(const d of this.layers){const f=d.layout;if(d.type===u.StyleLayerType.FILL){var c=d,a=d.source+"|"+d.sourceLayer;a+="|"+(f?.visibility??"");a+="|"+d.minzoom;a+="|"+d.maxzoom;a+="|"+JSON.stringify(d.filter);if(c.hasDataDrivenFill||c.hasDataDrivenOutline)a+="|"+b;h.push({key:a,layer:d})}else if(d.type===u.StyleLayerType.LINE){c=d;a=d.paint;a=null!=a&&(null!=a["line-pattern"]||null!=a["line-dasharray"]);let m=
d.source+"|"+d.sourceLayer;m+="|"+(f?.visibility??"");m+="|"+d.minzoom;m+="|"+d.maxzoom;m+="|"+JSON.stringify(d.filter);m+="|"+(void 0!==f?f["line-cap"]:"");m+="|"+(void 0!==f?f["line-join"]:"");if(c.hasDataDrivenLine||a)m+="|"+b;g.push({key:m,layer:d})}++b}this._assignRefLayers(h);this._assignRefLayers(g)};x._assignRefLayers=function(h){h.sort((f,m)=>f.key<m.key?-1:f.key>m.key?1:0);let g,b;const c=h.length;for(let f=0;f<c;f++){const m=h[f];if(m.key===g)m.layer.refLayerId=b;else if(g=m.key,b=m.layer.id,
m.layer.type===u.StyleLayerType.FILL){if(!m.layer.getPaintProperty("fill-outline-color"))for(var a=f+1;a<c;a++){var d=h[a];if(d.key===g){if(d.layer.getPaintProperty("fill-outline-color")){h[f]=d;h[a]=m;b=d.layer.id;break}}else break}}else if(m.layer.type===u.StyleLayerType.LINE)for(a=m.layer,d=f+1;d<c;d++){const w=h[d];if(w.key!==g)break;const l=w.layer;if(a.canUseThinTessellation&&!l.canUseThinTessellation||!a.canUseThinTessellation&&(l.getPaintProperty("line-pattern")||l.getPaintProperty("line-dasharray")))a=
l,h[f]=w,h[d]=m,b=w.layer.id}}};x._create=function(h,g,b){g=1-1/(b.length+1)*(1+g);b=this._runningId++;switch(h.type){case "background":return new F.BackgroundStyleLayer(u.StyleLayerType.BACKGROUND,h,g,b);case "fill":return new F.FillStyleLayer(u.StyleLayerType.FILL,h,g,b);case "line":return new F.LineStyleLayer(u.StyleLayerType.LINE,h,g,b);case "symbol":return new F.SymbolStyleLayer(u.StyleLayerType.SYMBOL,h,g,b);case "raster":console.warn(`Unsupported vector tile raster layer ${h.id}`);break;case "circle":return new F.CircleStyleLayer(u.StyleLayerType.CIRCLE,
h,g,b)}return null};B._recreateLayer=function(h,g){switch(h.type){case "background":return new F.BackgroundStyleLayer(u.StyleLayerType.BACKGROUND,h,g.z,g.uid);case "fill":return new F.FillStyleLayer(u.StyleLayerType.FILL,h,g.z,g.uid);case "line":return new F.LineStyleLayer(u.StyleLayerType.LINE,h,g.z,g.uid);case "symbol":return new F.SymbolStyleLayer(u.StyleLayerType.SYMBOL,h,g.z,g.uid);case "raster":console.warn(`Unsupported vector tile raster layer ${h.id}`);break;case "circle":return new F.CircleStyleLayer(u.StyleLayerType.CIRCLE,
h,g.z,g.uid)}return null};return C._createClass(B)}()})},"esri/views/2d/engine/vectorTiles/style/StyleLayer":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../enums ../shaders/VTLBackgroundMaterial ../shaders/VTLCircleMaterial ../shaders/VTLFillMaterial ../shaders/VTLLineMaterial ../shaders/VTLSymbolMaterial ./Filter ./StyleDefinition ./StyleProperty ../../webgl/definitions".split(" "),function(C,u,F,B,x,h,g,b,c,a,d,f){C.CapType=void 0;(function(D){D[D.BUTT=0]="BUTT";D[D.ROUND=
1]="ROUND";D[D.SQUARE=2]="SQUARE";D[D.UNKNOWN=4]="UNKNOWN"})(C.CapType||(C.CapType={}));let m=function(){function D(q,y,K,N){this.type=q;this.typeName=y.type;this.id=y.id;this.source=y.source;this.sourceLayer=y["source-layer"];this.minzoom=y.minzoom;this.maxzoom=y.maxzoom;this.filter=y.filter;this.layout=y.layout;this.paint=y.paint;this.z=K;this.uid=N;switch(q){case a.StyleLayerType.BACKGROUND:this._layoutDefinition=a.StyleDefinition.backgroundLayoutDefinition;this._paintDefinition=a.StyleDefinition.backgroundPaintDefinition;
break;case a.StyleLayerType.FILL:this._layoutDefinition=a.StyleDefinition.fillLayoutDefinition;this._paintDefinition=a.StyleDefinition.fillPaintDefinition;break;case a.StyleLayerType.LINE:this._layoutDefinition=a.StyleDefinition.lineLayoutDefinition;this._paintDefinition=a.StyleDefinition.linePaintDefinition;break;case a.StyleLayerType.SYMBOL:this._layoutDefinition=a.StyleDefinition.symbolLayoutDefinition;this._paintDefinition=a.StyleDefinition.symbolPaintDefinition;break;case a.StyleLayerType.CIRCLE:this._layoutDefinition=
a.StyleDefinition.circleLayoutDefinition,this._paintDefinition=a.StyleDefinition.circlePaintDefinition}this._layoutProperties=this._parseLayout(this.layout);this._paintProperties=this._parsePaint(this.paint)}var A=D.prototype;A.getFeatureFilter=function(){return void 0!==this._featureFilter?this._featureFilter:this._featureFilter=c.createFilter(this.filter)};A.getLayoutProperty=function(q){return this._layoutProperties[q]};A.getPaintProperty=function(q){return this._paintProperties[q]};A.getLayoutValue=
function(q,y,K){let N;const Q=this._layoutProperties[q];Q&&(N=Q.getValue(y,K));void 0===N&&(N=this._layoutDefinition[q]["default"]);return N};A.getPaintValue=function(q,y,K){let N;const Q=this._paintProperties[q];Q&&(N=Q.getValue(y,K));void 0===N&&(N=this._paintDefinition[q]["default"]);return N};A.isPainterDataDriven=function(){const q=this._paintProperties;if(q)for(const y in q)if(q[y].isDataDriven)return!0;return!1};A._parseLayout=function(q){const y={};for(const K in q){const N=this._layoutDefinition[K];
N&&(y[K]=new d(N,q[K]))}return y};A._parsePaint=function(q){const y={};for(const K in q){const N=this._paintDefinition[K];N&&(y[K]=new d(N,q[K]))}return y};A.computeAttributesKey=function(q,y,K,N){let Q=0,T=0;for(const V of y){y=3;if(!V||V!==N){const {isLayout:P,isOptional:L}=K[V];y=P?this.getLayoutProperty(V):this.getPaintProperty(V);y=y?.interpolator?2:y?.isDataDriven?1:L&&!y?3:0}T|=y<<Q;Q+=2}return T<<3|q};return u._createClass(D)}(),w=function(D){function A(q,y,K,N){q=D.call(this,q,y,K,N)||this;
q.backgroundMaterial=new B.VTLBackgroundMaterial(q.computeAttributesKey(F.ShaderProgramType.BACKGROUND,B.VTLBackgroundMaterial.ATTRIBUTES,B.VTLBackgroundMaterial.ATTRIBUTES_INFO));return q}u._inherits(A,D);return u._createClass(A)}(m),l=function(D){function A(q,y,K,N){q=D.call(this,q,y,K,N)||this;y=q.getPaintProperty("fill-color");K=q.getPaintProperty("fill-opacity");N=q.getPaintProperty("fill-pattern");q.hasDataDrivenColor=y?.isDataDriven;q.hasDataDrivenOpacity=K?.isDataDriven;q.hasDataDrivenFill=
q.hasDataDrivenColor||q.hasDataDrivenOpacity||N?.isDataDriven;K=q.getPaintProperty("fill-outline-color");q.outlineUsesFillColor=!K;q.hasDataDrivenOutlineColor=K?.isDataDriven;q.hasDataDrivenOutline=K?K.isDataDriven:y?y.isDataDriven:!1;q.hasDataDrivenOutline=(K?q.hasDataDrivenOutlineColor:q.hasDataDrivenColor)||q.hasDataDrivenOpacity;q.fillMaterial=new h.VTLFillMaterial(q.computeAttributesKey(F.ShaderProgramType.FILL,h.VTLFillMaterial.ATTRIBUTES,h.VTLFillMaterial.ATTRIBUTES_INFO));q.outlineMaterial=
new h.VTLOutlineMaterial(q.computeAttributesKey(F.ShaderProgramType.OUTLINE,q.outlineUsesFillColor?h.VTLOutlineMaterial.ATTRIBUTES_FILL:h.VTLOutlineMaterial.ATTRIBUTES_OUTLINE,q.outlineUsesFillColor?h.VTLOutlineMaterial.ATTRIBUTES_INFO_FILL:h.VTLOutlineMaterial.ATTRIBUTES_INFO_OUTLINE),q.outlineUsesFillColor);return q}u._inherits(A,D);return u._createClass(A)}(m),t=function(D){function A(q,y,K,N){q=D.call(this,q,y,K,N)||this;y=q.getPaintProperty("line-pattern");q.lineMaterial=new g.VTLLineMaterial(q.computeAttributesKey(F.ShaderProgramType.LINE,
g.VTLLineMaterial.ATTRIBUTES,g.VTLLineMaterial.ATTRIBUTES_INFO,y?"line-dasharray":""));q.hasDataDrivenLine=q.getPaintProperty("line-blur")?.isDataDriven||q.getPaintProperty("line-color")?.isDataDriven||q.getPaintProperty("line-gap-width")?.isDataDriven||q.getPaintProperty("line-offset")?.isDataDriven||q.getPaintProperty("line-opacity")?.isDataDriven||q.getPaintProperty("line-pattern")?.isDataDriven||q.getPaintProperty("line-dasharray")?.isDataDriven||q.getLayoutProperty("line-cap")?.isDataDriven||
q.getPaintProperty("line-width")?.isDataDriven;q.canUseThinTessellation=!1;!q.hasDataDrivenLine&&(y=q.getPaintProperty("line-width"),!y||"number"===typeof y&&.5*y<f.THIN_LINE_HALF_WIDTH_THRESHOLD)&&(y=q.getPaintProperty("line-offset"),!y||"number"===typeof y&&0===y)&&(q.canUseThinTessellation=!0);return q}u._inherits(A,D);A.prototype.getDashKey=function(q,y){switch(y){case C.CapType.BUTT:y="Butt";break;case C.CapType.ROUND:y="Round";break;case C.CapType.SQUARE:y="Square";break;default:y="Butt"}return`dasharray-[${q.toString()}]-${y}`};
return u._createClass(A)}(m),p=function(D){function A(q,y,K,N){q=D.call(this,q,y,K,N)||this;q.iconMaterial=new b.VTLIconMaterial(q.computeAttributesKey(F.ShaderProgramType.ICON,b.VTLIconMaterial.ATTRIBUTES,b.VTLIconMaterial.ATTRIBUTES_INFO));q.textMaterial=new b.VTLTextMaterial(q.computeAttributesKey(F.ShaderProgramType.TEXT,b.VTLTextMaterial.ATTRIBUTES,b.VTLTextMaterial.ATTRIBUTES_INFO));q.hasDataDrivenIcon=q.getPaintProperty("icon-color")?.isDataDriven||q.getPaintProperty("icon-halo-blur")?.isDataDriven||
q.getPaintProperty("icon-halo-color")?.isDataDriven||q.getPaintProperty("icon-halo-width")?.isDataDriven||q.getPaintProperty("icon-opacity")?.isDataDriven||q.getLayoutProperty("icon-size")?.isDataDriven;q.hasDataDrivenText=q.getPaintProperty("text-color")?.isDataDriven||q.getPaintProperty("text-halo-blur")?.isDataDriven||q.getPaintProperty("text-halo-color")?.isDataDriven||q.getPaintProperty("text-halo-width")?.isDataDriven||q.getPaintProperty("text-opacity")?.isDataDriven||q.getLayoutProperty("text-size")?.isDataDriven;
return q}u._inherits(A,D);return u._createClass(A)}(m),n=function(D){function A(q,y,K,N){q=D.call(this,q,y,K,N)||this;q.circleMaterial=new x.VTLCircleMaterial(q.computeAttributesKey(F.ShaderProgramType.CIRCLE,x.VTLCircleMaterial.ATTRIBUTES,x.VTLCircleMaterial.ATTRIBUTES_INFO));return q}u._inherits(A,D);return u._createClass(A)}(m),v=function(){function D(A,q,y){this.allowOverlap=A.getLayoutValue("icon-allow-overlap",q);this.ignorePlacement=A.getLayoutValue("icon-ignore-placement",q);this.keepUpright=
A.getLayoutValue("icon-keep-upright",q);this.optional=A.getLayoutValue("icon-optional",q);this.rotationAlignment=A.getLayoutValue("icon-rotation-alignment",q);this.rotationAlignment===a.RotationAlignment.AUTO&&(this.rotationAlignment=y?a.RotationAlignment.MAP:a.RotationAlignment.VIEWPORT);y=A.getLayoutProperty("icon-anchor");y?.isDataDriven?this._anchorProp=y:this.anchor=A.getLayoutValue("icon-anchor",q);y=A.getLayoutProperty("icon-offset");y?.isDataDriven?this._offsetProp=y:this.offset=A.getLayoutValue("icon-offset",
q);y=A.getLayoutProperty("icon-padding");y?.isDataDriven?this._paddingProp=y:this.padding=A.getLayoutValue("icon-padding",q);y=A.getLayoutProperty("icon-rotate");y?.isDataDriven?this._rotateProp=y:this.rotate=A.getLayoutValue("icon-rotate",q);y=A.getLayoutProperty("icon-size");y?.isDataDriven?this._sizeProp=y:this.size=A.getLayoutValue("icon-size",q)}D.prototype.update=function(A,q){this._anchorProp&&(this.anchor=this._anchorProp.getValue(A,q));this._offsetProp&&(this.offset=this._offsetProp.getValue(A,
q));this._paddingProp&&(this.padding=this._paddingProp.getValue(A,q));this._rotateProp&&(this.rotate=this._rotateProp.getValue(A,q));this._sizeProp&&(this.size=this._sizeProp.getValue(A,q))};return u._createClass(D)}(),E=function(){function D(A,q,y){this.allowOverlap=A.getLayoutValue("text-allow-overlap",q);this.ignorePlacement=A.getLayoutValue("text-ignore-placement",q);this.keepUpright=A.getLayoutValue("text-keep-upright",q);this.optional=A.getLayoutValue("text-optional",q);this.rotationAlignment=
A.getLayoutValue("text-rotation-alignment",q);this.rotationAlignment===a.RotationAlignment.AUTO&&(this.rotationAlignment=y?a.RotationAlignment.MAP:a.RotationAlignment.VIEWPORT);y=A.getLayoutProperty("text-anchor");y?.isDataDriven?this._anchorProp=y:this.anchor=A.getLayoutValue("text-anchor",q);y=A.getLayoutProperty("text-justify");y?.isDataDriven?this._justifyProp=y:this.justify=A.getLayoutValue("text-justify",q);y=A.getLayoutProperty("text-letter-spacing");y?.isDataDriven?this._letterSpacingProp=
y:this.letterSpacing=A.getLayoutValue("text-letter-spacing",q);y=A.getLayoutProperty("text-line-height");y?.isDataDriven?this._lineHeightProp=y:this.lineHeight=A.getLayoutValue("text-line-height",q);y=A.getLayoutProperty("text-max-angle");y?.isDataDriven?this._maxAngleProp=y:this.maxAngle=A.getLayoutValue("text-max-angle",q);y=A.getLayoutProperty("text-max-width");y?.isDataDriven?this._maxWidthProp=y:this.maxWidth=A.getLayoutValue("text-max-width",q);y=A.getLayoutProperty("text-offset");y?.isDataDriven?
this._offsetProp=y:this.offset=A.getLayoutValue("text-offset",q);y=A.getLayoutProperty("text-padding");y?.isDataDriven?this._paddingProp=y:this.padding=A.getLayoutValue("text-padding",q);y=A.getLayoutProperty("text-rotate");y?.isDataDriven?this._rotateProp=y:this.rotate=A.getLayoutValue("text-rotate",q);y=A.getLayoutProperty("text-size");y?.isDataDriven?this._sizeProp=y:this.size=A.getLayoutValue("text-size",q);y=A.getLayoutProperty("text-writing-mode");y?.isDataDriven?this._writingModeProp=y:this.writingMode=
A.getLayoutValue("text-writing-mode",q)}D.prototype.update=function(A,q){this._anchorProp&&(this.anchor=this._anchorProp.getValue(A,q));this._justifyProp&&(this.justify=this._justifyProp.getValue(A,q));this._letterSpacingProp&&(this.letterSpacing=this._letterSpacingProp.getValue(A,q));this._lineHeightProp&&(this.lineHeight=this._lineHeightProp.getValue(A,q));this._maxAngleProp&&(this.maxAngle=this._maxAngleProp.getValue(A,q));this._maxWidthProp&&(this.maxWidth=this._maxWidthProp.getValue(A,q));this._offsetProp&&
(this.offset=this._offsetProp.getValue(A,q));this._paddingProp&&(this.padding=this._paddingProp.getValue(A,q));this._rotateProp&&(this.rotate=this._rotateProp.getValue(A,q));this._sizeProp&&(this.size=this._sizeProp.getValue(A,q));this._writingModeProp&&(this.writingMode=this._writingModeProp.getValue(A,q))};return u._createClass(D)}();C.BackgroundStyleLayer=w;C.CircleStyleLayer=n;C.FillStyleLayer=l;C.IconLayout=v;C.LineStyleLayer=t;C.StyleLayer=m;C.SymbolStyleLayer=p;C.TextLayout=E;Object.defineProperty(C,
Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/shaders/VTLBackgroundMaterial":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","./VTLMaterial","../../../../webgl/enums","../../../../webgl/VertexElementDescriptor"],function(C,u,F,B,x){F=function(h){function g(c){return h.call(this,c)||this}u._inherits(g,h);var b=g.prototype;b.geometryInfo=function(){return g.GEOMETRY_LAYOUT};b.opacityInfo=function(){return null};b.attributes=function(){return g.ATTRIBUTES};
b.attributesInfo=function(){return g.ATTRIBUTES_INFO};return u._createClass(g)}(F.VTLMaterial);F.ATTRIBUTES=[];F.GEOMETRY_LAYOUT=[new x.VertexElementDescriptor("a_pos",2,B.DataType.BYTE,0,2)];F.ATTRIBUTES_INFO={};C.VTLBackgroundMaterial=F;Object.defineProperty(C,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/shaders/VTLMaterial":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../MemoryBuffer ./enums ../../../../webgl/enums ../../../../webgl/VertexElementDescriptor".split(" "),
function(C,u,F,B,x,h){let g=function(){function a(f){this._locations=new Map;this._key=f}var d=a.prototype;d.defines=function(){return[]};d.getStride=function(){this._layoutInfo||this._buildAttributesInfo();return this._stride};d.getAttributeLocations=function(){0===this._locations.size&&this._buildAttributesInfo();return this._locations};d.getLayoutInfo=function(){this._layoutInfo||this._buildAttributesInfo();return this._layoutInfo};d.getEncodingInfos=function(){this._propertyEncodingInfo||this._buildAttributesInfo();
return this._propertyEncodingInfo};d.getUniforms=function(){this._uniforms||this._buildAttributesInfo();return this._uniforms};d.getShaderHeader=function(){this._shaderHeader||this._buildAttributesInfo();return this._shaderHeader};d.getShaderMain=function(){this._shaderMain||this._buildAttributesInfo();return this._shaderMain};d.setDataUniforms=function(f,m,w,l,t){var p=this.getUniforms();for(const n of p){const {name:v,type:E,getValue:D}=n;p=D(w,m,l,t);if(null!==p)switch(E){case "float":f.setUniform1f(v,
p);break;case "vec2":f.setUniform2fv(v,p);break;case "vec4":f.setUniform4fv(v,p)}}};d.encodeAttributes=function(f,m,w,l){const t=this.attributesInfo(),p=this.getEncodingInfos(),n=[];let v=0,E=0;for(const A of Object.keys(p)){var D=p[A];const {type:q,precisionFactor:y,isLayout:K}=t[A],N=K?w.getLayoutProperty(A):w.getPaintProperty(A),Q=N.interpolator?.getInterpolationRange(m);let T=0;for(const V of D){const {offset:P,bufferElementsToAdd:L}=V;if(0<L){for(D=0;D<L;D++)n.push(0);v+=E;E=V.bufferElementsToAdd}D=
l??N.getValue(Q?Q[T]:m,f);switch(q){case B.EncodingType.R8_SIGNED:case B.EncodingType.R8_UNSIGNED:n[v]|=this._encodeByte(D*(y||1),8*P);break;case B.EncodingType.R16_SIGNED:case B.EncodingType.R16_UNSIGNED:n[v]|=this._encodeShort(D*(y||1),8*P);break;case B.EncodingType.R8G8_SIGNED:case B.EncodingType.R8G8_UNSIGNED:n[v]|=this._encodeByte(D*(y||1),8*P);n[v]|=this._encodeByte(D*(y||1),8*P+8);break;case B.EncodingType.R16G16_SIGNED:case B.EncodingType.R16G16_UNSIGNED:n[v]|=this._encodeShort(D*(y||1),8*
P);n[v]|=this._encodeShort(D*(y||1),8*P+16);break;case B.EncodingType.R8G8B8A8_SIGNED:case B.EncodingType.R8G8B8A8_UNSIGNED:n[v]|=this._encodeByte(D*(y||1),8*P);n[v]|=this._encodeByte(D*(y||1),8*P+8);n[v]|=this._encodeByte(D*(y||1),8*P+16);n[v]|=this._encodeByte(D*(y||1),8*P+24);break;case B.EncodingType.R8G8B8A8_COLOR:n[v]=this._encodeColor(D);break;case B.EncodingType.R16G16B16A16_DASHARRAY:case B.EncodingType.R16G16B16A16_PATTERN:this._encodePattern(v,n,D);break;default:throw Error("Unsupported encoding type");
}T++}}return n};d.getAtributeState=function(f){const m=3+2*f;f=0|this._bit(m);return f|=this._bit(m+1)<<1};d._buildAttributesInfo=function(){const f=[],m={};var w={},l=-1;const t=this.attributesInfo();var p=this.attributes();let n=-1;for(const A of p){n++;p=this.getAtributeState(n);if(p===B.AttributeStatus.UNIFORM||p===B.AttributeStatus.UNUSED)continue;var v=t[A];const q=[];m[A]=q;v=v.type;for(let y=0;y<p;y++){const {dataType:K,bytesPerElement:N,count:Q,normalized:T}=a._encodingInfo[v],V=N*Q;var E=
`${K}-${!0===T}`;let P=w[E],L=0;!P||4<P.count+Q?(l++,P={dataIndex:l,count:0,offset:0},4!==Q&&(w[E]=P),f.push({location:-1,name:"a_data_"+l,count:Q,type:K,normalized:T}),L=Math.ceil(Math.max(V/4,1))):(E=f[P.dataIndex],E.count+=Q,L=Math.ceil(Math.max(E.count*N/4,1))-Math.ceil(Math.max(P.offset/4,1)));q.push({dataIndex:P.dataIndex,offset:P.offset,bufferElementsToAdd:L});P.offset+=V;P.count+=Q}}for(const A of f)switch(A.type){case x.DataType.BYTE:case x.DataType.UNSIGNED_BYTE:A.count=4;break;case x.DataType.SHORT:case x.DataType.UNSIGNED_SHORT:A.count+=
A.count%2}this._buildVertexBufferLayout(f);w=0;l=this._layoutInfo.geometry;for(var D of l)this._locations.set(D.name,w++);if(D=this._layoutInfo.opacity)for(const A of D)this._locations.set(A.name,w++);this._buildShaderInfo(f,m);this._propertyEncodingInfo=m};d._buildVertexBufferLayout=function(f){const m={},w=this.geometryInfo();let l=w[0].stride;if(0===f.length)m.geometry=w;else{const t=[];let p=l;for(const n of f)l+=b(n.type)*n.count;for(const n of w)t.push(new h.VertexElementDescriptor(n.name,n.count,
n.type,n.offset,l,n.normalized));for(const n of f)t.push(new h.VertexElementDescriptor(n.name,n.count,n.type,p,l,n.normalized)),p+=b(n.type)*n.count;m.geometry=t}this.opacityInfo()&&(m.opacity=this.opacityInfo());this._layoutInfo=m;this._stride=l};d._buildShaderInfo=function(f,m){let w="\n",l="\n";const t=[];for(var p of f)w+=`attribute ${this._getType(p.count)} ${p.name};\n`;var n=this.attributes();f=this.attributesInfo();p=-1;for(const D of n){p++;const {name:A,type:q,precisionFactor:y,isLayout:K}=
f[D];n=y&&1!==y?` * ${1/y}`:"";const {bytesPerElement:N,count:Q}=a._encodingInfo[q];var v=T=>`a_data_${T.dataIndex}${c(Q,T.offset,N)}`;switch(this.getAtributeState(p)){case B.AttributeStatus.UNIFORM:n=this._getType(Q);var E=`u_${A}`;t.push({name:E,type:n,getValue:(V,P,L,J)=>{L=K?V.getLayoutValue(D,P):V.getPaintValue(D,P);if(q===B.EncodingType.R16G16B16A16_DASHARRAY){V=V.getDashKey(L,V.getLayoutValue("line-cap",P));J=J.getMosaicItemPosition(V,!1);if(null==J)return null;const {tl:I,br:S}=J;return[I[0],
S[1],S[0],I[1]]}if(q===B.EncodingType.R16G16B16A16_PATTERN){J=J.getMosaicItemPosition(L,!D.includes("line-"));if(null==J)return null;const {tl:I,br:S}=J;return[I[0],S[1],S[0],I[1]]}return q===B.EncodingType.R8G8B8A8_COLOR?(J=L[3],[J*L[0],J*L[1],J*L[2],J]):L}});w+=`uniform ${n} ${E};\n`;l+=`${n} ${A} = ${E};\n`;break;case B.AttributeStatus.DATA_DRIVEN:E=v(m[D][0]);l+=`${this._getType(Q)} ${A} = ${E}${n};\n`;break;case B.AttributeStatus.INTERPOLATED_DATA_DRIVEN:E=`u_t_${A}`;t.push({name:E,type:"float",
getValue:(V,P,L,J)=>(K?V.getLayoutProperty(D):V.getPaintProperty(D)).interpolator.interpolationUniformValue(L,P)});w+=`uniform float ${E};\n`;const T=v(m[D][0]);v=v(m[D][1]);l+=`${this._getType(Q)} ${A} = mix(${T}${n}, ${v}${n}, ${E});\n`}}this._shaderHeader=w;this._shaderMain=l;this._uniforms=t};d._bit=function(f){return(this._key&1<<f)>>f};d._getType=function(f){switch(f){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4"}throw Error("Invalid count");};d._encodeColor=
function(f){const m=255*f[3];return F.i8888to32(f[0]*m,f[1]*m,f[2]*m,m)};d._encodePattern=function(f,m,w){if(w&&w.rect){var l=w.rect,t=w.width;w=w.height;m[f]=this._encodeShort(l.x+2,0);m[f]|=this._encodeShort(l.y+2+w,16);m[f+1]=this._encodeShort(l.x+2+t,0);m[f+1]|=this._encodeShort(l.y+2,16)}};d._encodeByte=function(f,m){return(f&255)<<m};d._encodeShort=function(f,m){return(f&65535)<<m};u._createClass(a,[{key:"key",get:function(){return this._key}},{key:"type",get:function(){return this._key&7}}]);
return a}();g._encodingInfo={[B.EncodingType.R8_SIGNED]:{dataType:x.DataType.BYTE,bytesPerElement:1,count:1,normalized:!1},[B.EncodingType.R8_UNSIGNED]:{dataType:x.DataType.UNSIGNED_BYTE,bytesPerElement:1,count:1,normalized:!1},[B.EncodingType.R16_SIGNED]:{dataType:x.DataType.SHORT,bytesPerElement:2,count:1,normalized:!1},[B.EncodingType.R16_UNSIGNED]:{dataType:x.DataType.UNSIGNED_SHORT,bytesPerElement:2,count:1,normalized:!1},[B.EncodingType.R8G8_SIGNED]:{dataType:x.DataType.BYTE,bytesPerElement:1,
count:2,normalized:!1},[B.EncodingType.R8G8_UNSIGNED]:{dataType:x.DataType.UNSIGNED_BYTE,bytesPerElement:1,count:2,normalized:!1},[B.EncodingType.R16G16_SIGNED]:{dataType:x.DataType.SHORT,bytesPerElement:2,count:2,normalized:!1},[B.EncodingType.R16G16_UNSIGNED]:{dataType:x.DataType.UNSIGNED_SHORT,bytesPerElement:2,count:2,normalized:!1},[B.EncodingType.R8G8B8A8_SIGNED]:{dataType:x.DataType.BYTE,bytesPerElement:1,count:4,normalized:!1},[B.EncodingType.R8G8B8A8_UNSIGNED]:{dataType:x.DataType.UNSIGNED_BYTE,
bytesPerElement:1,count:4,normalized:!1},[B.EncodingType.R8G8B8A8_COLOR]:{dataType:x.DataType.UNSIGNED_BYTE,bytesPerElement:1,count:4,normalized:!0},[B.EncodingType.R16G16B16A16_DASHARRAY]:{dataType:x.DataType.UNSIGNED_SHORT,bytesPerElement:2,count:4,normalized:!1},[B.EncodingType.R16G16B16A16_PATTERN]:{dataType:x.DataType.UNSIGNED_SHORT,bytesPerElement:2,count:4,normalized:!1}};const b=a=>{switch(a){case x.DataType.FLOAT:return 4;case x.DataType.INT:return 4;case x.DataType.UNSIGNED_INT:return 4;
case x.DataType.SHORT:return 2;case x.DataType.UNSIGNED_SHORT:return 2;case x.DataType.BYTE:return 1;case x.DataType.UNSIGNED_BYTE:return 1}},c=(a,d,f)=>{d/=f;if(1===a)switch(d){case 0:return".x";case 1:return".y";case 2:return".z";case 3:return".w"}else if(2===a)switch(d){case 0:return".xy";case 1:return".yz";case 2:return".zw"}else if(3===a)switch(d){case 0:return".xyz";case 1:return".yzw"}return""};C.VTLMaterial=g;Object.defineProperty(C,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/MemoryBuffer":function(){define(["../../../../chunks/_rollupPluginBabelHelpers"],
function(C){return function(){function u(B){this._array=[];0>=B&&console.error("strideInBytes must be positive!");this._stride=B}var F=u.prototype;F.reset=function(){this.array.length=0};F.toBuffer=function(){return(new Uint32Array(this._array)).buffer};u.i1616to32=function(B,x){return 65535&B|x<<16};u.i8888to32=function(B,x,h,g){return B&255|(x&255)<<8|(h&255)<<16|g<<24};u.i8816to32=function(B,x,h){return B&255|(x&255)<<8|h<<16};C._createClass(u,[{key:"array",get:function(){return this._array}},
{key:"index",get:function(){return 4*this._array.length/this._stride}},{key:"itemSize",get:function(){return this._stride}},{key:"sizeInBytes",get:function(){return 4*this._array.length}}]);return u}()})},"esri/views/2d/engine/vectorTiles/shaders/enums":function(){define(["exports"],function(C){C.EncodingType=void 0;(function(u){u[u.R8_SIGNED=0]="R8_SIGNED";u[u.R8_UNSIGNED=1]="R8_UNSIGNED";u[u.R16_SIGNED=2]="R16_SIGNED";u[u.R16_UNSIGNED=3]="R16_UNSIGNED";u[u.R8G8_SIGNED=4]="R8G8_SIGNED";u[u.R8G8_UNSIGNED=
5]="R8G8_UNSIGNED";u[u.R16G16_SIGNED=6]="R16G16_SIGNED";u[u.R16G16_UNSIGNED=7]="R16G16_UNSIGNED";u[u.R8G8B8A8_SIGNED=8]="R8G8B8A8_SIGNED";u[u.R8G8B8A8_UNSIGNED=9]="R8G8B8A8_UNSIGNED";u[u.R8G8B8A8_COLOR=10]="R8G8B8A8_COLOR";u[u.R16G16B16A16_DASHARRAY=11]="R16G16B16A16_DASHARRAY";u[u.R16G16B16A16_PATTERN=12]="R16G16B16A16_PATTERN"})(C.EncodingType||(C.EncodingType={}));C.AttributeStatus=void 0;(function(u){u[u.UNIFORM=0]="UNIFORM";u[u.DATA_DRIVEN=1]="DATA_DRIVEN";u[u.INTERPOLATED_DATA_DRIVEN=2]="INTERPOLATED_DATA_DRIVEN";
u[u.UNUSED=3]="UNUSED"})(C.AttributeStatus||(C.AttributeStatus={}));Object.defineProperty(C,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/shaders/VTLCircleMaterial":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ./enums ./VTLMaterial ../../../../webgl/enums ../../../../webgl/VertexElementDescriptor".split(" "),function(C,u,F,B,x,h){B=function(g){function b(a){return g.call(this,a)||this}u._inherits(b,g);var c=b.prototype;c.geometryInfo=function(){return b.GEOMETRY_LAYOUT};
c.opacityInfo=function(){return null};c.attributes=function(){return b.ATTRIBUTES};c.attributesInfo=function(){return b.ATTRIBUTES_INFO};return u._createClass(b)}(B.VTLMaterial);B.ATTRIBUTES="circle-radius circle-color circle-opacity circle-stroke-width circle-stroke-color circle-stroke-opacity circle-blur".split(" ");B.GEOMETRY_LAYOUT=[new h.VertexElementDescriptor("a_pos",2,x.DataType.SHORT,0,4)];B.ATTRIBUTES_INFO={"circle-radius":{name:"radius",type:F.EncodingType.R8_UNSIGNED},"circle-color":{name:"color",
type:F.EncodingType.R8G8B8A8_COLOR},"circle-opacity":{name:"opacity",type:F.EncodingType.R8_UNSIGNED,precisionFactor:100},"circle-stroke-width":{name:"stroke_width",type:F.EncodingType.R8_UNSIGNED,precisionFactor:4},"circle-stroke-color":{name:"stroke_color",type:F.EncodingType.R8G8B8A8_COLOR},"circle-stroke-opacity":{name:"stroke_opacity",type:F.EncodingType.R8_UNSIGNED,precisionFactor:100},"circle-blur":{name:"blur",type:F.EncodingType.R8_UNSIGNED,precisionFactor:32}};C.VTLCircleMaterial=B;Object.defineProperty(C,
Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/shaders/VTLFillMaterial":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ./enums ./VTLMaterial ../../../../webgl/enums ../../../../webgl/VertexElementDescriptor".split(" "),function(C,u,F,B,x,h){let g=function(b){function c(d){return b.call(this,d)||this}u._inherits(c,b);var a=c.prototype;a.geometryInfo=function(){return c.GEOMETRY_LAYOUT};a.opacityInfo=function(){return null};a.attributes=function(){return c.ATTRIBUTES};
a.attributesInfo=function(){return c.ATTRIBUTES_INFO};return u._createClass(c)}(B.VTLMaterial);g.ATTRIBUTES=["fill-color","fill-opacity","fill-pattern"];g.GEOMETRY_LAYOUT=[new h.VertexElementDescriptor("a_pos",2,x.DataType.SHORT,0,4)];g.ATTRIBUTES_INFO={"fill-color":{name:"color",type:F.EncodingType.R8G8B8A8_COLOR},"fill-opacity":{name:"opacity",type:F.EncodingType.R8_UNSIGNED,precisionFactor:100},"fill-pattern":{name:"tlbr",type:F.EncodingType.R16G16B16A16_PATTERN,isOptional:!0}};B=function(b){function c(d,
f){d=b.call(this,d)||this;d._usefillColor=f;return d}u._inherits(c,b);var a=c.prototype;a.geometryInfo=function(){return c.GEOMETRY_LAYOUT};a.opacityInfo=function(){return null};a.attributes=function(){return this._usefillColor?c.ATTRIBUTES_FILL:c.ATTRIBUTES_OUTLINE};a.attributesInfo=function(){return this._usefillColor?c.ATTRIBUTES_INFO_FILL:c.ATTRIBUTES_INFO_OUTLINE};return u._createClass(c)}(B.VTLMaterial);B.ATTRIBUTES_OUTLINE=["fill-outline-color","fill-opacity"];B.ATTRIBUTES_FILL=["fill-color",
"fill-opacity"];B.GEOMETRY_LAYOUT=[new h.VertexElementDescriptor("a_pos",2,x.DataType.SHORT,0,8),new h.VertexElementDescriptor("a_offset",2,x.DataType.BYTE,4,8),new h.VertexElementDescriptor("a_xnormal",2,x.DataType.BYTE,6,8)];B.ATTRIBUTES_INFO_OUTLINE={"fill-outline-color":{name:"color",type:F.EncodingType.R8G8B8A8_COLOR},"fill-opacity":{name:"opacity",type:F.EncodingType.R8_UNSIGNED,precisionFactor:100}};B.ATTRIBUTES_INFO_FILL={"fill-color":{name:"color",type:F.EncodingType.R8G8B8A8_COLOR},"fill-opacity":{name:"opacity",
type:F.EncodingType.R8_UNSIGNED,precisionFactor:100}};C.VTLFillMaterial=g;C.VTLOutlineMaterial=B;Object.defineProperty(C,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/shaders/VTLLineMaterial":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ./enums ./VTLMaterial ../../../../webgl/enums ../../../../webgl/VertexElementDescriptor".split(" "),function(C,u,F,B,x,h){B=function(g){function b(a){return g.call(this,a)||this}u._inherits(b,g);var c=b.prototype;
c.geometryInfo=function(){return b.GEOMETRY_LAYOUT};c.opacityInfo=function(){return null};c.attributes=function(){return b.ATTRIBUTES};c.attributesInfo=function(){return b.ATTRIBUTES_INFO};return u._createClass(b)}(B.VTLMaterial);B.ATTRIBUTES="line-blur line-color line-gap-width line-offset line-opacity line-width line-pattern line-dasharray".split(" ");B.GEOMETRY_LAYOUT=[new h.VertexElementDescriptor("a_pos",2,x.DataType.SHORT,0,16),new h.VertexElementDescriptor("a_extrude_offset",4,x.DataType.BYTE,
4,16),new h.VertexElementDescriptor("a_dir_normal",4,x.DataType.BYTE,8,16),new h.VertexElementDescriptor("a_accumulatedDistance",2,x.DataType.UNSIGNED_SHORT,12,16)];B.ATTRIBUTES_INFO={"line-width":{name:"width",type:F.EncodingType.R8_UNSIGNED,precisionFactor:2},"line-gap-width":{name:"gap_width",type:F.EncodingType.R8_UNSIGNED,precisionFactor:2},"line-offset":{name:"offset",type:F.EncodingType.R8_SIGNED,precisionFactor:2},"line-color":{name:"color",type:F.EncodingType.R8G8B8A8_COLOR},"line-opacity":{name:"opacity",
type:F.EncodingType.R8_UNSIGNED,precisionFactor:100},"line-blur":{name:"blur",type:F.EncodingType.R8_UNSIGNED,precisionFactor:4},"line-pattern":{name:"tlbr",type:F.EncodingType.R16G16B16A16_PATTERN,isOptional:!0},"line-dasharray":{name:"tlbr",type:F.EncodingType.R16G16B16A16_DASHARRAY,isOptional:!0}};C.VTLLineMaterial=B;Object.defineProperty(C,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/shaders/VTLSymbolMaterial":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ./enums ./VTLMaterial ../../../../webgl/enums ../../../../webgl/VertexElementDescriptor".split(" "),
function(C,u,F,B,x,h){const g=[new h.VertexElementDescriptor("a_pos",2,x.DataType.SHORT,0,16),new h.VertexElementDescriptor("a_vertexOffset",2,x.DataType.SHORT,4,16),new h.VertexElementDescriptor("a_texAngleRange",4,x.DataType.UNSIGNED_BYTE,8,16),new h.VertexElementDescriptor("a_levelInfo",4,x.DataType.UNSIGNED_BYTE,12,16)],b=[new h.VertexElementDescriptor("a_opacityInfo",1,x.DataType.UNSIGNED_BYTE,0,1)];x=function(c){function a(f){return c.call(this,f)||this}u._inherits(a,c);var d=a.prototype;d.geometryInfo=
function(){return g};d.opacityInfo=function(){return b};d.attributes=function(){return a.ATTRIBUTES};d.attributesInfo=function(){return a.ATTRIBUTES_INFO};return u._createClass(a)}(B.VTLMaterial);x.ATTRIBUTES="icon-color icon-opacity icon-halo-blur icon-halo-color icon-halo-width icon-size".split(" ");x.ATTRIBUTES_INFO={"icon-color":{name:"color",type:F.EncodingType.R8G8B8A8_COLOR},"icon-opacity":{name:"opacity",type:F.EncodingType.R8_UNSIGNED,precisionFactor:100},"icon-halo-color":{name:"halo_color",
type:F.EncodingType.R8G8B8A8_COLOR},"icon-halo-width":{name:"halo_width",type:F.EncodingType.R8_UNSIGNED,precisionFactor:4},"icon-halo-blur":{name:"halo_blur",type:F.EncodingType.R8_UNSIGNED,precisionFactor:4},"icon-size":{name:"size",type:F.EncodingType.R8_UNSIGNED,precisionFactor:32,isLayout:!0}};B=function(c){function a(f){return c.call(this,f)||this}u._inherits(a,c);var d=a.prototype;d.geometryInfo=function(){return g};d.opacityInfo=function(){return b};d.attributes=function(){return a.ATTRIBUTES};
d.attributesInfo=function(){return a.ATTRIBUTES_INFO};return u._createClass(a)}(B.VTLMaterial);B.ATTRIBUTES="text-color text-opacity text-halo-blur text-halo-color text-halo-width text-size".split(" ");B.ATTRIBUTES_INFO={"text-color":{name:"color",type:F.EncodingType.R8G8B8A8_COLOR},"text-opacity":{name:"opacity",type:F.EncodingType.R8_UNSIGNED,precisionFactor:100},"text-halo-color":{name:"halo_color",type:F.EncodingType.R8G8B8A8_COLOR},"text-halo-width":{name:"halo_width",type:F.EncodingType.R8_UNSIGNED,
precisionFactor:4},"text-halo-blur":{name:"halo_blur",type:F.EncodingType.R8_UNSIGNED,precisionFactor:4},"text-size":{name:"size",type:F.EncodingType.R8_UNSIGNED,isLayout:!0}};C.VTLIconMaterial=x;C.VTLTextMaterial=B;Object.defineProperty(C,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/style/Filter":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../expression/expression","../expression/types"],function(C,u,F){return function(){function B(x){this._expression=
x}B.prototype.filter=function(x,h){if(!this._expression)return!0;try{return this._expression.evaluate(x,h)}catch(g){return console.log(g.message),!0}};B.createFilter=function(x){if(!x)return null;this.isLegacyFilter(x)&&(x=this.convertLegacyFilter(x));try{const h=u.createExpression(x,null,F.BooleanType);return new B(h)}catch(h){return console.log(h.message),null}};B.isLegacyFilter=function(x){if(!Array.isArray(x)||0===x.length)return!0;switch(x[0]){case "\x3d\x3d":case "!\x3d":case "\x3e":case "\x3c":case "\x3e\x3d":case "\x3c\x3d":return 3===
x.length&&"string"===typeof x[1]&&!Array.isArray(x[2]);case "in":return 3<=x.length&&"string"===typeof x[1]&&!Array.isArray(x[2]);case "!in":return!0;case "any":case "all":for(let h=1;h<x.length;h++)if(this.isLegacyFilter(x[h]))return!0;return!1;case "none":return!0;case "has":return 2===x.length&&("$id"===x[1]||"$type"===x[1]);case "!has":return!0;default:return!1}};B.convertLegacyFilter=function(x){if(!Array.isArray(x)||0===x.length)return!0;const h=x[0];if(1===x.length)return"any"!==h;switch(h){case "\x3d\x3d":return B.convertComparison("\x3d\x3d",
x[1],x[2]);case "!\x3d":return B.negate(B.convertComparison("\x3d\x3d",x[1],x[2]));case "\x3e":case "\x3c":case "\x3e\x3d":case "\x3c\x3d":return B.convertComparison(h,x[1],x[2]);case "in":return B.convertIn(x[1],x.slice(2));case "!in":return B.negate(B.convertIn(x[1],x.slice(2)));case "any":case "all":case "none":return B.convertCombining(h,x.slice(1));case "has":return B.convertHas(x[1]);case "!has":return B.negate(B.convertHas(x[1]));default:throw Error("Unexpected legacy filter.");}};B.convertComparison=
function(x,h,g){switch(h){case "$type":return[x,["geometry-type"],g];case "$id":return[x,["id"],g];default:return[x,["get",h],g]}};B.convertIn=function(x,h){switch(x){case "$type":return["in",["geometry-type"],["literal",h]];case "$id":return["in",["id"],["literal",h]];default:return["in",["get",x],["literal",h]]}};B.convertHas=function(x){switch(x){case "$type":return!0;case "$id":return["has-id"];default:return["has",x]}};B.convertCombining=function(x,h){return[x].concat(h.map(this.convertLegacyFilter))};
B.negate=function(x){return["!",x]};return C._createClass(B)}()})},"esri/views/2d/engine/vectorTiles/expression/expression":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../Color ../../../../../core/colorUtils ../../../../../geometry/support/TileClipper ../../../unitBezier ../GeometryUtils ./types".split(" "),function(C,u,F,B,x,h,g,b){function c(r,e,k){var z=typeof r;if("string"===z||"boolean"===z||"number"===z||null===r){if(k)switch(k.kind){case "string":"string"!==
z&&(r=ia.toString(r));break;case "number":"number"!==z&&(r=ia.toNumber(r));break;case "color":r=ia.toColor(r)}r=["literal",r]}if(!Array.isArray(r)||0===r.length)throw Error("Expression must be a non empty array");z=r[0];if("string"!==typeof z)throw Error("First element of expression must be a string");const G=na[z];if(void 0===G)throw Error(`Invalid expression operator "${z}"`);if(!G)throw Error(`Unimplemented expression operator "${z}"`);return G.parse(r,e,k)}let a=function(){function r(k){this._parent=
k;this._vars={}}var e=r.prototype;e.add=function(k,z){this._vars[k]=z};e.get=function(k){return this._vars[k]?this._vars[k]:this._parent?this._parent.get(k):null};return u._createClass(r)}(),d=function(){function r(){this.type=b.ValueType}r.parse=function(e){if(1<e.length)throw Error('"id" does not expect arguments');return new r};r.prototype.evaluate=function(e,k){return e?.id};return u._createClass(r)}(),f=function(){function r(){this.type=b.StringType}r.parse=function(e){if(1<e.length)throw Error('"geometry-type" does not expect arguments');
return new r};r.prototype.evaluate=function(e,k){if(!e)return null;switch(e.type){case x.GeometryType.Point:return"Point";case x.GeometryType.LineString:return"LineString";case x.GeometryType.Polygon:return"Polygon";default:return null}};return u._createClass(r)}(),m=function(){function r(){this.type=b.ObjectType}r.parse=function(e){if(1<e.length)throw Error('"properties" does not expect arguments');return new r};r.prototype.evaluate=function(e,k){return e?.values};return u._createClass(r)}(),w=function(){function r(){this.type=
b.NumberType}r.parse=function(e){if(1<e.length)throw Error('"zoom" does not expect arguments');return new r};r.prototype.evaluate=function(e,k){return k};return u._createClass(r)}(),l=function(){function r(e,k,z){this._lhs=e;this._rhs=k;this._compare=z;this.type=b.BooleanType}r.parse=function(e,k,z){if(3!==e.length&&4!==e.length)throw Error(`"${e[0]}" expects 2 or 3 arguments`);if(4===e.length)throw Error(`"${e[0]}" collator not supported`);return new r(c(e[1],k),c(e[2],k),z)};r.prototype.evaluate=
function(e,k){return this._compare(this._lhs.evaluate(e,k),this._rhs.evaluate(e,k))};return u._createClass(r)}(),t=function(r){function e(){return r.apply(this,arguments)||this}u._inherits(e,r);e.parse=function(k,z){return l.parse(k,z,(G,H)=>G===H)};return u._createClass(e)}(l),p=function(r){function e(){return r.apply(this,arguments)||this}u._inherits(e,r);e.parse=function(k,z){return l.parse(k,z,(G,H)=>G!==H)};return u._createClass(e)}(l),n=function(r){function e(){return r.apply(this,arguments)||
this}u._inherits(e,r);e.parse=function(k,z){return l.parse(k,z,(G,H)=>G<H)};return u._createClass(e)}(l),v=function(r){function e(){return r.apply(this,arguments)||this}u._inherits(e,r);e.parse=function(k,z){return l.parse(k,z,(G,H)=>G<=H)};return u._createClass(e)}(l),E=function(r){function e(){return r.apply(this,arguments)||this}u._inherits(e,r);e.parse=function(k,z){return l.parse(k,z,(G,H)=>G>H)};return u._createClass(e)}(l),D=function(r){function e(){return r.apply(this,arguments)||this}u._inherits(e,
r);e.parse=function(k,z){return l.parse(k,z,(G,H)=>G>=H)};return u._createClass(e)}(l),A=function(){function r(e){this._arg=e;this.type=b.BooleanType}r.parse=function(e,k){if(2!==e.length)throw Error('"!" expects 1 argument');return new r(c(e[1],k))};r.prototype.evaluate=function(e,k){return!this._arg.evaluate(e,k)};return u._createClass(r)}(),q=function(){function r(e){this._args=e;this.type=b.BooleanType}r.parse=function(e,k){const z=[];for(let G=1;G<e.length;G++)z.push(c(e[G],k));return new r(z)};
r.prototype.evaluate=function(e,k){for(const z of this._args)if(!z.evaluate(e,k))return!1;return!0};return u._createClass(r)}(),y=function(){function r(e){this._args=e;this.type=b.BooleanType}r.parse=function(e,k){const z=[];for(let G=1;G<e.length;G++)z.push(c(e[G],k));return new r(z)};r.prototype.evaluate=function(e,k){for(const z of this._args)if(z.evaluate(e,k))return!0;return!1};return u._createClass(r)}(),K=function(){function r(e){this._args=e;this.type=b.BooleanType}r.parse=function(e,k){const z=
[];for(let G=1;G<e.length;G++)z.push(c(e[G],k));return new r(z)};r.prototype.evaluate=function(e,k){for(const z of this._args)if(z.evaluate(e,k))return!1;return!0};return u._createClass(r)}(),N=function(){function r(e,k,z){this.type=e;this._args=k;this._fallback=z}r.parse=function(e,k,z){if(4>e.length)throw Error('"case" expects at least 3 arguments');if(1===e.length%2)throw Error('"case" expects an odd number of arguments');let G;const H=[];for(let O=1;O<e.length-1;O+=2){const Y=c(e[O],k),U=c(e[O+
1],k,z);G||(G=U.type);H.push({condition:Y,output:U})}e=c(e[e.length-1],k,z);G||(G=e.type);return new r(G,H,e)};r.prototype.evaluate=function(e,k){for(const z of this._args)if(z.condition.evaluate(e,k))return z.output.evaluate(e,k);return this._fallback.evaluate(e,k)};return u._createClass(r)}(),Q=function(){function r(e,k){this.type=e;this._args=k}r.parse=function(e,k){if(2>e.length)throw Error('"coalesce" expects at least 1 argument');let z;const G=[];for(let H=1;H<e.length;H++){const O=c(e[H],k);
z||(z=O.type);G.push(O)}return new r(z,G)};r.prototype.evaluate=function(e,k){for(const z of this._args){const G=z.evaluate(e,k);if(null!==G)return G}return null};return u._createClass(r)}(),T=function(){function r(e,k,z,G,H){this.type=e;this._input=k;this._labels=z;this._outputs=G;this._fallback=H}r.parse=function(e,k){if(3>e.length)throw Error('"match" expects at least 3 arguments');if(0===e.length%2)throw Error('"case" expects an even number of arguments');let z;const G=c(e[1],k),H=[],O={};let Y;
for(let ca=2;ca<e.length-1;ca+=2){var U=e[ca];Array.isArray(U)||(U=[U]);for(const ja of U){U=typeof ja;if("string"!==U&&"number"!==U)throw Error('"match" requires string or number literal as labels');if(!Y)Y=U;else if(U!==Y)throw Error('"match" requires labels to have the same type');O[ja]=H.length}U=c(e[ca+1],k);z||(z=U.type);H.push(U)}return new r(z,G,O,H,c(e[e.length-1],k))};r.prototype.evaluate=function(e,k){const z=this._input.evaluate(e,k);return(this._outputs[this._labels[z]]||this._fallback).evaluate(e,
k)};return u._createClass(r)}(),V=function(){function r(k,z,G,H,O){this._operator=k;this.type=z;this.interpolation=G;this.input=H;this._stops=O}r.parse=function(k,z,G){const H=k[0];if(5>k.length)throw Error(`"${H}" expects at least 4 arguments`);const O=k[1];if(!Array.isArray(O)||0===O.length)throw Error(`"${O}" is not a valid interpolation`);switch(O[0]){case "linear":if(1!==O.length)throw Error("Linear interpolation cannot have parameters");break;case "exponential":if(2!==O.length||"number"!==typeof O[1])throw Error("Exponential interpolation requires one numeric argument");
break;case "cubic-bezier":if(5!==O.length)throw Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1");for(var Y=1;5>Y;Y++){var U=O[Y];if("number"!==typeof U||0>U||1<U)throw Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1");}break;default:throw Error(`"${k[0]}" unknown interpolation type "${O[0]}"`);}if(1!==k.length%2)throw Error(`"${H}" expects an even number of arguments`);Y=c(k[2],z,b.NumberType);let ca;"interpolate-hcl"===
H||"interpolate-lab"===H?ca=b.ColorType:G&&"value"!==G.kind&&(ca=G);G=[];for(U=3;U<k.length;U+=2){const ja=k[U];if("number"!==typeof ja)throw Error(`"${H}" requires stop inputs as literal numbers`);if(G.length&&G[G.length-1][0]>=ja)throw Error(`"${H}" requires strictly ascending stop inputs`);const oa=c(k[U+1],z,ca);ca||(ca=oa.type);G.push([ja,oa])}if(ca&&ca!==b.ColorType&&ca!==b.NumberType&&("array"!==ca.kind||ca.itemType!==b.NumberType))throw Error(`"${H}" cannot interpolate type ${b.typeToString(ca)}`);
return new r(H,ca,O,Y,G)};var e=r.prototype;e.evaluate=function(k,z){var G=this._stops;if(1===G.length)return G[0][1].evaluate(k,z);var H=this.input.evaluate(k,z);if(H<=G[0][0])return G[0][1].evaluate(k,z);if(H>=G[G.length-1][0])return G[G.length-1][1].evaluate(k,z);let O=0;for(;++O<G.length&&!(H<G[O][0]););const Y=r.interpolationRatio(this.interpolation,H,G[O-1][0],G[O][0]);H=G[O-1][1].evaluate(k,z);const U=G[O][1].evaluate(k,z);if("interpolate"===this._operator){if("array"===this.type.kind&&Array.isArray(H)&&
Array.isArray(U))return H.map((ca,ja)=>g.interpolate(ca,U[ja],Y));if("color"===this.type.kind&&H instanceof F&&U instanceof F)return H=new F(H),k=new F(U),new F([g.interpolate(H.r,k.r,Y),g.interpolate(H.g,k.g,Y),g.interpolate(H.b,k.b,Y),g.interpolate(H.a,k.a,Y)]);if("number"===this.type.kind&&"number"===typeof H&&"number"===typeof U)return g.interpolate(H,U,Y);throw Error(`"${this._operator}" cannot interpolate type ${b.typeToString(this.type)}`);}if("interpolate-hcl"===this._operator)return k=B.toLCH(H),
z=B.toLCH(U),G=z.h-k.h,k=B.toRGB({h:k.h+Y*(180<G||-180>G?G-360*Math.round(G/360):G),c:g.interpolate(k.c,z.c,Y),l:g.interpolate(k.l,z.l,Y)}),new F({a:g.interpolate(H.a,U.a,Y),...k});if("interpolate-lab"===this._operator)return k=B.toLAB(H),z=B.toLAB(U),k=B.toRGB({l:g.interpolate(k.l,z.l,Y),a:g.interpolate(k.a,z.a,Y),b:g.interpolate(k.b,z.b,Y)}),new F({a:g.interpolate(H.a,U.a,Y),...k});throw Error(`Unexpected operator "${this._operator}"`);};e.interpolationUniformValue=function(k,z){const G=this._stops;
if(1===G.length||k>=G[G.length-1][0])return 0;let H=0;for(;++H<G.length&&!(k<G[H][0]););return r.interpolationRatio(this.interpolation,z,G[H-1][0],G[H][0])};e.getInterpolationRange=function(k){const z=this._stops;if(1===z.length)return k=z[0][0],[k,k];var G=z[z.length-1][0];if(k>=G)return[G,G];for(G=0;++G<z.length&&!(k<z[G][0]););return[z[G-1][0],z[G][0]]};r.interpolationRatio=function(k,z,G,H){let O=0;"linear"===k[0]?O=r._exponentialInterpolationRatio(z,1,G,H):"exponential"===k[0]?O=r._exponentialInterpolationRatio(z,
k[1],G,H):"cubic-bezier"===k[0]&&(O=h.unitBezier(k[1],k[2],k[3],k[4])(r._exponentialInterpolationRatio(z,1,G,H),1E-5));0>O?O=0:1<O&&(O=1);return O};r._exponentialInterpolationRatio=function(k,z,G,H){H-=G;if(0===H)return 0;k-=G;return 1===z?k/H:(z**k-1)/(z**H-1)};return u._createClass(r)}(),P=function(){function r(e,k,z){this.type=e;this._input=k;this._stops=z}r.parse=function(e,k){if(5>e.length)throw Error('"step" expects at least 4 arguments');if(1!==e.length%2)throw Error('"step" expects an even number of arguments');
const z=c(e[1],k,b.NumberType);let G;const H=[];H.push([-Infinity,c(e[2],k)]);for(let O=3;O<e.length;O+=2){const Y=e[O];if("number"!==typeof Y)throw Error('"step" requires stop inputs as literal numbers');if(H.length&&H[H.length-1][0]>=Y)throw Error('"step" requires strictly ascending stop inputs');const U=c(e[O+1],k);G||(G=U.type);H.push([Y,U])}return new r(G,z,H)};r.prototype.evaluate=function(e,k){const z=this._stops;if(1===z.length)return z[0][1].evaluate(e,k);const G=this._input.evaluate(e,k);
let H=0;for(;++H<z.length&&!(G<z[H][0]););return this._stops[H-1][1].evaluate(e,k)};return u._createClass(r)}(),L=function(){function r(e,k){this.type=e;this._output=k}r.parse=function(e,k,z){if(4>e.length)throw Error('"let" expects at least 3 arguments');if(1===e.length%2)throw Error('"let" expects an odd number of arguments');const G=new a(k);for(let H=1;H<e.length-1;H+=2){const O=e[H];if("string"!==typeof O)throw Error(`"let" requires a string to define variable names - found ${O}`);G.add(O,c(e[H+
1],k))}e=c(e[e.length-1],G,z);return new r(e.type,e)};r.prototype.evaluate=function(e,k){return this._output.evaluate(e,k)};return u._createClass(r)}(),J=function(){function r(e,k){this.type=e;this.output=k}r.parse=function(e,k,z){if(2!==e.length||"string"!==typeof e[1])throw Error('"var" requires just one literal string argument');k=k.get(e[1]);if(!k)throw Error(`${e[1]} must be defined before being used in a "var" expression`);return new r(z||b.ValueType,k)};r.prototype.evaluate=function(e,k){return this.output.evaluate(e,
k)};return u._createClass(r)}(),I=function(){function r(e,k,z){this.type=e;this._index=k;this._array=z}r.parse=function(e,k){if(3!==e.length)throw Error('"at" expects 2 arguments');const z=c(e[1],k,b.NumberType);e=c(e[2],k);return new r(e.type.itemType,z,e)};r.prototype.evaluate=function(e,k){const z=this._index.evaluate(e,k);e=this._array.evaluate(e,k);if(0>z||z>=e.length)throw Error('"at" index out of bounds');if(z!==Math.floor(z))throw Error('"at" index must be an integer');return e[z]};return u._createClass(r)}(),
S=function(){function r(e,k){this._key=e;this._obj=k;this.type=b.ValueType}r.parse=function(e,k){let z;switch(e.length){case 2:return z=c(e[1],k),new r(z);case 3:return z=c(e[1],k),e=c(e[2],k),new r(z,e);default:throw Error('"get" expects 1 or 2 arguments');}};r.prototype.evaluate=function(e,k){const z=this._key.evaluate(e,k);return this._obj?this._obj.evaluate(e,k)[z]:e?.values[z]};return u._createClass(r)}(),M=function(){function r(e,k){this._key=e;this._obj=k;this.type=b.BooleanType}r.parse=function(e,
k){let z;switch(e.length){case 2:return z=c(e[1],k),new r(z);case 3:return z=c(e[1],k),e=c(e[2],k),new r(z,e);default:throw Error('"has" expects 1 or 2 arguments');}};r.prototype.evaluate=function(e,k){const z=this._key.evaluate(e,k);return this._obj?(e=this._obj.evaluate(e,k),z in e):!!e?.values[z]};return u._createClass(r)}(),R=function(){function r(e,k){this._key=e;this._vals=k;this.type=b.BooleanType}r.parse=function(e,k){if(3!==e.length)throw Error('"in" expects 2 arguments');return new r(c(e[1],
k),c(e[2],k))};r.prototype.evaluate=function(e,k){const z=this._key.evaluate(e,k);return this._vals.evaluate(e,k).includes(z)};return u._createClass(r)}(),X=function(){function r(e,k,z){this._item=e;this._array=k;this._from=z;this.type=b.NumberType}r.parse=function(e,k){if(3>e.length||4<e.length)throw Error('"index-of" expects 3 or 4 arguments');const z=c(e[1],k),G=c(e[2],k);return 4===e.length?(e=c(e[3],k,b.NumberType),new r(z,G,e)):new r(z,G)};r.prototype.evaluate=function(e,k){const z=this._item.evaluate(e,
k),G=this._array.evaluate(e,k);if(this._from){e=this._from.evaluate(e,k);if(e!==Math.floor(e))throw Error('"index-of" index must be an integer');return G.indexOf(z,e)}return G.indexOf(z)};return u._createClass(r)}(),Z=function(){function r(e){this._arg=e;this.type=b.NumberType}r.parse=function(e,k){if(2!==e.length)throw Error('"length" expects 2 arguments');e=c(e[1],k);return new r(e)};r.prototype.evaluate=function(e,k){e=this._arg.evaluate(e,k);if("string"===typeof e||Array.isArray(e))return e.length;
throw Error('"length" expects string or array');};return u._createClass(r)}(),ha=function(){function r(e,k,z,G){this.type=e;this._array=k;this._from=z;this._to=G}r.parse=function(e,k){if(3>e.length||4<e.length)throw Error('"slice" expects 2 or 3 arguments');const z=c(e[1],k),G=c(e[2],k,b.NumberType);if(G.type!==b.NumberType)throw Error('"slice" index must return a number');if(4===e.length){e=c(e[3],k,b.NumberType);if(e.type!==b.NumberType)throw Error('"slice" index must return a number');return new r(z.type,
z,G,e)}return new r(z.type,z,G)};r.prototype.evaluate=function(e,k){const z=this._array.evaluate(e,k);if(!Array.isArray(z)&&"string"!==typeof z)throw Error('"slice" input must be an array or a string');const G=this._from.evaluate(e,k);if(0>G||G>=z.length)throw Error('"slice" index out of bounds');if(G!==Math.floor(G))throw Error('"slice" index must be an integer');if(this._to){e=this._to.evaluate(e,k);if(0>e||e>=z.length)throw Error('"slice" index out of bounds');if(e!==Math.floor(e))throw Error('"slice" index must be an integer');
return z.slice(G,e)}return z.slice(G)};return u._createClass(r)}(),da=function(){function r(){this.type=b.BooleanType}r.parse=function(e){if(1!==e.length)throw Error('"has-id" expects no arguments');return new r};r.prototype.evaluate=function(e,k){return e&&void 0!==e.id};return u._createClass(r)}(),W=function(){function r(e,k){this._args=e;this._calculate=k;this.type=b.NumberType}r.parse=function(e,k,z){e=e.slice(1).map(G=>c(G,k));return new r(e,z)};r.prototype.evaluate=function(e,k){let z;this._args&&
(z=this._args.map(G=>G.evaluate(e,k)));return this._calculate(z)};return u._createClass(r)}(),aa=function(r){function e(){return r.apply(this,arguments)||this}u._inherits(e,r);e.parse=function(k,z){switch(k.length){case 2:return W.parse(k,z,G=>-G[0]);case 3:return W.parse(k,z,G=>G[0]-G[1]);default:throw Error('"-" expects 1 or 2 arguments');}};return u._createClass(e)}(W),ea=function(r){function e(){return r.apply(this,arguments)||this}u._inherits(e,r);e.parse=function(k,z){return W.parse(k,z,G=>
{let H=1;for(const O of G)H*=O;return H})};return u._createClass(e)}(W),fa=function(r){function e(){return r.apply(this,arguments)||this}u._inherits(e,r);e.parse=function(k,z){if(3===k.length)return W.parse(k,z,G=>G[0]/G[1]);throw Error('"/" expects 2 arguments');};return u._createClass(e)}(W),ka=function(r){function e(){return r.apply(this,arguments)||this}u._inherits(e,r);e.parse=function(k,z){if(3===k.length)return W.parse(k,z,G=>G[0]%G[1]);throw Error('"%" expects 2 arguments');};return u._createClass(e)}(W),
pa=function(r){function e(){return r.apply(this,arguments)||this}u._inherits(e,r);e.parse=function(k,z){if(3===k.length)return W.parse(k,z,G=>G[0]**G[1]);throw Error('"^" expects 1 or 2 arguments');};return u._createClass(e)}(W),qa=function(r){function e(){return r.apply(this,arguments)||this}u._inherits(e,r);e.parse=function(k,z){return W.parse(k,z,G=>{let H=0;for(const O of G)H+=O;return H})};return u._createClass(e)}(W),ba=function(){function r(e,k){this._args=e;this._calculate=k;this.type=b.NumberType}
r.parse=function(e,k){const z=e.slice(1).map(G=>c(G,k));return new r(z,r.ops[e[0]])};r.prototype.evaluate=function(e,k){let z;this._args&&(z=this._args.map(G=>G.evaluate(e,k)));return this._calculate(z)};return u._createClass(r)}();ba.ops={abs:r=>Math.abs(r[0]),acos:r=>Math.acos(r[0]),asin:r=>Math.asin(r[0]),atan:r=>Math.atan(r[0]),ceil:r=>Math.ceil(r[0]),cos:r=>Math.cos(r[0]),e:()=>Math.E,floor:r=>Math.floor(r[0]),ln:r=>Math.log(r[0]),ln2:()=>Math.LN2,log10:r=>Math.log(r[0])/Math.LN10,log2:r=>Math.log(r[0])/
Math.LN2,max:r=>Math.max(...r),min:r=>Math.min(...r),pi:()=>Math.PI,round:r=>Math.round(r[0]),sin:r=>Math.sin(r[0]),sqrt:r=>Math.sqrt(r[0]),tan:r=>Math.tan(r[0])};let ra=function(){function r(e){this._args=e;this.type=b.StringType}r.parse=function(e,k){return new r(e.slice(1).map(z=>c(z,k)))};r.prototype.evaluate=function(e,k){return this._args.map(z=>z.evaluate(e,k)).join("")};return u._createClass(r)}(),ma=function(){function r(e,k){this._arg=e;this._calculate=k;this.type=b.StringType}r.parse=function(e,
k){if(2!==e.length)throw Error(`${e[0]} expects 1 argument`);k=c(e[1],k);return new r(k,r.ops[e[0]])};r.prototype.evaluate=function(e,k){return this._calculate(this._arg.evaluate(e,k))};return u._createClass(r)}();ma.ops={downcase:r=>r.toLowerCase(),upcase:r=>r.toUpperCase()};let sa=function(){function r(k){this._args=k;this.type=b.ColorType}r.parse=function(k,z){if(4!==k.length)throw Error('"rgb" expects 3 arguments');k=k.slice(1).map(G=>c(G,z));return new r(k)};var e=r.prototype;e.evaluate=function(k,
z){const G=this._validate(this._args[0].evaluate(k,z)),H=this._validate(this._args[1].evaluate(k,z));k=this._validate(this._args[2].evaluate(k,z));return new F({r:G,g:H,b:k})};e._validate=function(k){if("number"!==typeof k||0>k||255<k)throw Error(`${k}: invalid color component`);return Math.round(k)};return u._createClass(r)}(),ta=function(){function r(k){this._args=k;this.type=b.ColorType}r.parse=function(k,z){if(5!==k.length)throw Error('"rgba" expects 4 arguments');k=k.slice(1).map(G=>c(G,z));
return new r(k)};var e=r.prototype;e.evaluate=function(k,z){const G=this._validate(this._args[0].evaluate(k,z)),H=this._validate(this._args[1].evaluate(k,z)),O=this._validate(this._args[2].evaluate(k,z));k=this._validateAlpha(this._args[3].evaluate(k,z));return new F({r:G,g:H,b:O,a:k})};e._validate=function(k){if("number"!==typeof k||0>k||255<k)throw Error(`${k}: invalid color component`);return Math.round(k)};e._validateAlpha=function(k){if("number"!==typeof k||0>k||1<k)throw Error(`${k}: invalid alpha color component`);
return k};return u._createClass(r)}(),ua=function(){function r(e){this._color=e;this.type=b.arrayType(b.NumberType,4)}r.parse=function(e,k){if(2!==e.length)throw Error('"to-rgba" expects 1 argument');e=c(e[1],k);return new r(e)};r.prototype.evaluate=function(e,k){return(new F(this._color.evaluate(e,k))).toRgba()};return u._createClass(r)}(),la=function(){function r(e,k){this.type=e;this._args=k}r.parse=function(e,k){var z=e[0];if(2>e.length)throw Error(`${z} expects at least one argument`);let G=
1,H;if("array"===z){if(2<e.length){switch(e[1]){case "string":H=b.StringType;break;case "number":H=b.NumberType;break;case "boolean":H=b.BooleanType;break;default:throw Error('"array" type argument must be string, number or boolean');}G++}else H=b.ValueType;if(3<e.length){var O=e[2];if(null!==O&&("number"!==typeof O||0>O||O!==Math.floor(O)))throw Error('"array" length argument must be a positive integer literal');G++}H=b.arrayType(H,O)}else switch(z){case "string":H=b.StringType;break;case "number":H=
b.NumberType;break;case "boolean":H=b.BooleanType;break;case "object":H=b.ObjectType}for(z=[];G<e.length;G++)O=c(e[G],k),z.push(O);return new r(H,z)};r.prototype.evaluate=function(e,k){let z;for(const G of this._args){const H=G.evaluate(e,k);z=b.getType(H);if(b.matchType(z,this.type))return H}throw Error(`Expected ${b.typeToString(this.type)} but got ${b.typeToString(z)}`);};return u._createClass(r)}(),ia=function(){function r(e,k){this.type=e;this._args=k}r.parse=function(e,k){var z=e[0];const G=
r.types[z];if(G===b.BooleanType||G===b.StringType){if(2!==e.length)throw Error(`${z} expects one argument`);}else if(2>e.length)throw Error(`${z} expects at least one argument`);z=[];for(let H=1;H<e.length;H++){const O=c(e[H],k);z.push(O)}return new r(G,z)};r.prototype.evaluate=function(e,k){if(this.type===b.BooleanType)return!!this._args[0].evaluate(e,k);if(this.type===b.StringType)return b.valueToString(this._args[0].evaluate(e,k));if(this.type===b.NumberType){for(const G of this._args){var z=Number(G.evaluate(e,
k));if(!isNaN(z))return z}return null}if(this.type===b.ColorType){for(z of this._args)try{const G=r.toColor(z.evaluate(e,k));if(G instanceof F)return G}catch{}return null}};r.toBoolean=function(e){return!!e};r.toString=function(e){return b.valueToString(e)};r.toNumber=function(e){const k=Number(e);if(isNaN(k))throw Error(`"${e}" is not a number`);return k};r.toColor=function(e){if(e instanceof F)return e;if("string"===typeof e){const k=F.fromString(e);if(k)return k;throw Error(`"${e}" is not a color`);
}if(Array.isArray(e))return F.fromArray(e);throw Error(`"${e}" is not a color`);};return u._createClass(r)}();ia.types={"to-boolean":b.BooleanType,"to-color":b.ColorType,"to-number":b.NumberType,"to-string":b.StringType};let va=function(){function r(e){this._val=e;this.type=b.getType(e)}r.parse=function(e){if(2!==e.length)throw Error('"literal" expects 1 argument');return new r(e[1])};r.prototype.evaluate=function(e,k){return this._val};return u._createClass(r)}(),wa=function(){function r(e){this._arg=
e;this.type=b.StringType}r.parse=function(e,k){if(2!==e.length)throw Error('"typeof" expects 1 argument');return new r(c(e[1],k))};r.prototype.evaluate=function(e,k){return b.typeToString(b.getType(this._arg.evaluate(e,k)))};return u._createClass(r)}();const na={array:la,boolean:la,collator:null,format:null,image:null,literal:va,number:la,"number-format":null,object:la,string:la,"to-boolean":ia,"to-color":ia,"to-number":ia,"to-string":ia,typeof:wa,accumulated:null,"feature-state":null,"geometry-type":f,
id:d,"line-progress":null,properties:m,at:I,get:S,has:M,in:R,"index-of":X,length:Z,slice:ha,"!":A,"!\x3d":p,"\x3c":n,"\x3c\x3d":v,"\x3d\x3d":t,"\x3e":E,"\x3e\x3d":D,all:q,any:y,case:N,coalesce:Q,match:T,within:null,interpolate:V,"interpolate-hcl":V,"interpolate-lab":V,step:P,let:L,var:J,concat:ra,downcase:ma,"is-supported-script":null,"resolved-locale":null,upcase:ma,rgb:sa,rgba:ta,"to-rgba":ua,"-":aa,"*":ea,"/":fa,"%":ka,"^":pa,"+":qa,abs:ba,acos:ba,asin:ba,atan:ba,ceil:ba,cos:ba,e:ba,floor:ba,ln:ba,
ln2:ba,log10:ba,log2:ba,max:ba,min:ba,pi:ba,round:ba,sin:ba,sqrt:ba,tan:ba,zoom:w,"heatmap-density":null,"has-id":da,none:K};C.ALL=q;C.ANY=y;C.Add=qa;C.Assert=la;C.At=I;C.Calculate=ba;C.Case=N;C.Coalesce=Q;C.Coerce=ia;C.Concat=ra;C.Div=fa;C.EQ=t;C.GE=D;C.GT=E;C.GeomType=f;C.Get=S;C.Has=M;C.HasID=da;C.ID=d;C.In=R;C.IndexOf=X;C.Interpolate=V;C.LE=v;C.LT=n;C.Length=Z;C.Let=L;C.Literal=va;C.Match=T;C.Mod=ka;C.Mul=ea;C.NE=p;C.NONE=K;C.NOT=A;C.Pow=pa;C.Properties=m;C.Rgb=sa;C.Rgba=ta;C.Slice=ha;C.Step=
P;C.String=ma;C.Sub=aa;C.ToRgba=ua;C.TypeOf=wa;C.Var=J;C.Zoom=w;C.createExpression=c;C.ops=na;Object.defineProperty(C,Symbol.toStringTag,{value:"Module"})})},"esri/core/colorUtils":function(){define(["exports"],function(C){function u(a,d){const f=[];let m,w;if(a[0].length!==d.length)throw Error("dimensions do not match");const l=a.length,t=a[0].length;let p=0;for(m=0;m<l;m++){for(w=p=0;w<t;w++)p+=a[m][w]*d[w];f.push(p)}return f}function F(a){a=[a.r/255,a.g/255,a.b/255].map(d=>.04045>=d?d/12.92:((d+
.055)/1.055)**2.4);a=u(b,a);return{x:100*a[0],y:100*a[1],z:100*a[2]}}function B(a){a=u(c,[a.x/100,a.y/100,a.z/100]).map(d=>Math.min(1,Math.max(.0031308>=d?12.92*d:1.055*d**(1/2.4)-.055,0)));return{r:Math.round(255*a[0]),g:Math.round(255*a[1]),b:Math.round(255*a[2])}}function x(a){a=[a.x/95.047,a.y/100,a.z/108.883].map(d=>d>(6/29)**3?d**(1/3):1/3*(29/6)**2*d+4/29);return{l:116*a[1]-16,a:500*(a[0]-a[1]),b:200*(a[1]-a[2])}}function h(a){const d=a.l;a=[(d+16)/116+a.a/500,(d+16)/116,(d+16)/116-a.b/200].map(f=>
f>6/29?f**3:3*(6/29)**2*(f-4/29));return{x:95.047*a[0],y:100*a[1],z:108.883*a[2]}}function g(a){if("r"in a&&"g"in a&&"b"in a)return a;if("l"in a&&"c"in a&&"h"in a){var d=a.c,f=a.h;return B(h({l:a.l,a:d*Math.cos(f),b:d*Math.sin(f)}))}if("l"in a&&"a"in a&&"b"in a)return B(h(a));if("x"in a&&"y"in a&&"z"in a)return B(a);if("h"in a&&"s"in a&&"v"in a){f=(a.h+360)%360/60;d=a.v/100*255;a=a.s/100*d;const m=a*(1-Math.abs(f%2-1));switch(Math.floor(f)){case 0:f={r:a,g:m,b:0};break;case 1:f={r:m,g:a,b:0};break;
case 2:f={r:0,g:a,b:m};break;case 3:f={r:0,g:m,b:a};break;case 4:f={r:m,g:0,b:a};break;case 5:case 6:f={r:a,g:0,b:m};break;default:f={r:0,g:0,b:0}}f.r=Math.round(f.r+d-a);f.g=Math.round(f.g+d-a);f.b=Math.round(f.b+d-a);return f}return a}const b=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],c=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];C.toHSV=function(a){if("h"in a&&"s"in a&&"v"in a)return a;var d=g(a);a=d.r;const f=d.g,m=d.b;d=Math.max(a,f,m);const w=d-Math.min(a,
f,m);a=0===w?0:d===a?(f-m)/w%6:d===f?(m-a)/w+2:(a-f)/w+4;0>a&&(a+=6);return{h:60*a,s:100*(0===w?0:w/d),v:100/255*d}};C.toLAB=function(a){return"l"in a&&"a"in a&&"b"in a?a:x(F(g(a)))};C.toLCH=function(a){if(!("l"in a&&"c"in a&&"h"in a)){var d=x(F(g(a)));a=d.l;var f=d.a;const m=d.b;d=Math.sqrt(f*f+m*m);f=Math.atan2(m,f);f=0<f?f:f+2*Math.PI;a={l:a,c:d,h:f}}return a};C.toRGB=g;C.toXYZ=function(a){return"x"in a&&"y"in a&&"z"in a?a:F(g(a))};Object.defineProperty(C,Symbol.toStringTag,{value:"Module"})})},
"esri/views/2d/engine/vectorTiles/expression/types":function(){define(["exports","../../../../../Color"],function(C,u){function F(l,t){return{kind:"array",itemType:l,n:t}}function B(l){if("array"===l.kind){const t=B(l.itemType);return"number"===typeof l.n?`array<${t}, ${l.n}>`:"value"===l.itemType.kind?"array":`array<${t}>`}return l.kind}function x(l){if(null===l)return g;if("string"===typeof l)return c;if("boolean"===typeof l)return a;if("number"===typeof l)return b;if(l instanceof u)return d;if(Array.isArray(l)){let t;
for(const p of l){const n=x(p);if(!t)t=n;else if(t!==n){t=m;break}}return F(t||m,l.length)}return"object"===typeof l?f:m}function h(l,t){if("array"===t.kind)return"array"===l.kind&&(0===l.n&&"value"===l.itemType.kind||h(l.itemType,t.itemType))&&("number"!==typeof t.n||t.n===l.n);if("value"===t.kind)for(const p of w)if(h(l,p))return!0;return t.kind===l.kind}const g={kind:"null"},b={kind:"number"},c={kind:"string"},a={kind:"boolean"},d={kind:"color"},f={kind:"object"},m={kind:"value"},w=[g,b,c,a,d,
f,F(m)];C.BooleanType=a;C.ColorType=d;C.NullType=g;C.NumberType=b;C.ObjectType=f;C.StringType=c;C.ValueType=m;C.arrayType=F;C.getType=x;C.matchType=h;C.typeToString=B;C.valueToString=function(l){if(null===l)return"";const t=typeof l;return"string"===t?l:"number"===t||"boolean"===t?String(l):l instanceof u?l.toString():JSON.stringify(l)};Object.defineProperty(C,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/style/StyleProperty":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers",
"../../../../../Color","../GeometryUtils","../expression/expression","../expression/types"],function(C,u,F,B,x){return function(){function h(b,c){this.isDataDriven=!1;this.interpolator=null;switch(b.type){case "number":var a=!0;break;case "color":a=!0;break;case "array":a="number"===b.value;break;default:a=!1}null==c&&(c=b.default);if(Array.isArray(c)&&0<c.length&&B.ops[c[0]]){a={number:x.NumberType,color:x.ColorType,string:x.StringType,boolean:x.BooleanType,enum:x.StringType};try{var d="array"===
b.type?x.arrayType(a[b.value]||x.ValueType,b.length):a[b.type];const f=B.createExpression(c,null,d);this.getValue=this._buildExpression(f,b);this.isDataDriven=!0;f instanceof B.Interpolate&&f.input instanceof B.Zoom&&(this.interpolator=f)}catch(f){console.log(f.message),this.getValue=this._buildSimple(b.default)}}else{a&&"interval"===c.type&&(a=!1);if(d=c&&c.stops&&0<c.stops.length)for(const f of c.stops)f[1]=this._validate(f[1],b);if(this.isDataDriven=c?!!c.property:!1)if(void 0!==c.default&&(c.default=
this._validate(c.default,b)),d)switch(c.type){case "identity":this.getValue=this._buildIdentity(c,b);break;case "categorical":this.getValue=this._buildCategorical(c,b);break;default:this.getValue=a?this._buildInterpolate(c,b):this._buildInterval(c,b)}else this.getValue=this._buildIdentity(c,b);else d?this.getValue=a?this._buildZoomInterpolate(c):this._buildZoomInterval(c):(c=this._validate(c,b),this.getValue=this._buildSimple(c))}}var g=h.prototype;g._validate=function(b,c){if("number"===c.type){if(null!=
c.minimum&&b<c.minimum)return c.minimum;if(null!=c.maximum&&b>c.maximum)return c.maximum}else"color"===c.type?b=h._parseColor(b):"enum"===c.type?"string"===typeof b&&(b=c.values.indexOf(b)):"array"===c.type&&"enum"===c.value?b=b.map(a=>"string"===typeof a?c.values.indexOf(a):a):"string"===c.type&&(b=x.valueToString(b));return b};g._buildSimple=function(b){return()=>b};g._buildExpression=function(b,c){return(a,d)=>{try{const f=b.evaluate(d,a);return void 0===f?c.default:this._validate(f,c)}catch(f){return console.log(f.message),
c.default}}};g._buildIdentity=function(b,c){return(a,d)=>{let f;d&&(f=d.values[b.property]);void 0!==f&&(f=this._validate(f,c));return null!=f?f:void 0!==b.default?b.default:c.default}};g._buildCategorical=function(b,c){return(a,d)=>{let f;d&&(f=d.values[b.property]);f=this._categorical(f,b.stops);return void 0!==f?f:void 0!==b.default?b.default:c.default}};g._buildInterval=function(b,c){return(a,d)=>{let f;d&&(f=d.values[b.property]);return"number"===typeof f?this._interval(f,b.stops):void 0!==b.default?
b.default:c.default}};g._buildInterpolate=function(b,c){return(a,d)=>{let f;d&&(f=d.values[b.property]);return"number"===typeof f?this._interpolate(f,b.stops,b.base||1):void 0!==b.default?b.default:c.default}};g._buildZoomInterpolate=function(b){return c=>this._interpolate(c,b.stops,b.base||1)};g._buildZoomInterval=function(b){return c=>this._interval(c,b.stops)};g._categorical=function(b,c){const a=c.length;for(let d=0;d<a;d++)if(c[d][0]===b)return c[d][1]};g._interval=function(b,c){const a=c.length;
let d=0;for(let f=0;f<a;f++)if(c[f][0]<=b)d=f;else break;return c[d][1]};g._interpolate=function(b,c,a){const d=c.length;for(let w=0;w<d;w++){const l=c[w];if(l[0]<=b)var f=l;else{var m=l;break}}if(f&&m){c=m[0]-f[0];b-=f[0];a=1===a?b/c:(a**b-1)/(a**c-1);if(Array.isArray(f[1])){f=f[1];m=m[1];b=[];for(c=0;c<f.length;c++)b.push(F.interpolate(f[c],m[c],a));return b}return F.interpolate(f[1],m[1],a)}if(f)return f[1];if(m)return m[1]};h._isEmpty=function(b){for(const c in b)if(b.hasOwnProperty(c))return!1;
return!0};h._parseColor=function(b){if(Array.isArray(b))return b;"string"===typeof b&&(b=new u(b));if(b instanceof u&&!this._isEmpty(b))return u.toUnitRGBA(b)};return C._createClass(h)}()})},"esri/views/2d/layers/LayerView2D":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Collection ../../../core/collectionUtils ../../../core/Error ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../engine/Container ../support/HighlightOptions ../../layers/support/ClipRect ../../layers/support/Geometry ../../layers/support/Path".split(" "),
function(C,u,F,B,x,h,g,b,c,a,d,f,m,w,l,t,p){const n=B.ofType({key:"type",base:null,typeMap:{rect:l,path:p,geometry:t}});C.LayerView2DMixin=v=>{v=function(E){function D(){var q=E.apply(this,arguments)||this;q.attached=!1;q.clips=new n;q.lastUpdateId=-1;q.moving=!1;q.updateRequested=!1;q.visibleAtCurrentScale=!1;q.highlightOptions=null;return q}u._inherits(D,E);var A=D.prototype;A.initialize=function(){const q=this.view?.spatialReferenceLocked??!0;this.view?.spatialReference&&q&&!this.spatialReferenceSupported?
this.addResolvingPromise(Promise.reject(new h("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",{layer:this.layer}))):(this.container||(this.container=new m.Container),this.container.fadeTransitionEnabled=!0,this.container.visible=!1,this.container.endTransitions(),this.addHandles([g.watch(()=>this.suspended,y=>{this.container&&(this.container.visible=!y);this.view&&!y&&this.updateRequested&&this.view.requestUpdate()},g.syncAndInitial),
g.watch(()=>this.layer?.opacity??1,y=>{this.container&&(this.container.opacity=y)},g.syncAndInitial),g.watch(()=>this.layer&&"blendMode"in this.layer?this.layer.blendMode:"normal",y=>{this.container&&(this.container.blendMode=y)},g.syncAndInitial),g.watch(()=>this.layer&&"effect"in this.layer?this.layer.effect:null,y=>{this.container&&(this.container.effect=y)},g.syncAndInitial),g.watch(()=>this.highlightOptions,y=>this.container.highlightOptions=y,g.syncAndInitial),g.on(()=>this.clips,"change",()=>
{this.container&&(this.container.clips=this.clips)},g.syncAndInitial),g.watch(()=>({scale:this.view?.scale,scaleRange:this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null}),({scale:y})=>{y=null!=y?this.isVisibleAtScale(y):!1;y!==this.visibleAtCurrentScale&&this._set("visibleAtCurrentScale",y)},g.syncAndInitial)],"constructor"),this.view?.whenLayerView?this.view.whenLayerView(this.layer).then(y=>{y===this&&this.processAttach()},()=>{}):this.when().then(()=>{this.processAttach()},
()=>{}))};A.destroy=function(){this.processDetach();this.updateRequested=!1};A.processAttach=function(){this.isResolved()&&!this.attached&&!this.destroyed&&this.spatialReferenceSupported&&(this.attach(),this.attached=!0,this.requestUpdate())};A.processDetach=function(){this.attached&&(this.attached=!1,this.removeHandles("attach"),this.detach(),this.updateRequested=!1)};A.isVisibleAtScale=function(q){const y=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;if(!y)return!0;
const {minScale:K,maxScale:N}=y;return(0===K||q<=K)&&(0===N||q>=N)};A.requestUpdate=function(){this.destroyed||this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestUpdate())};A.processUpdate=function(q){this.isFulfilled()&&!this.isResolved()?this.updateRequested=!1:(this._set("updateParameters",q),this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(q)))};A.hitTest=function(q,y){return Promise.resolve(null)};A.supportsSpatialReference=function(q){return!0};
A.canResume=function(){return this.spatialReferenceSupported?u._get(u._getPrototypeOf(D.prototype),"canResume",this).call(this)?this.visibleAtCurrentScale:!1:!1};A.getSuspendInfo=function(){const q=u._get(u._getPrototypeOf(D.prototype),"getSuspendInfo",this).call(this),y=!this.spatialReferenceSupported,K=this.visibleAtCurrentScale;y&&(q.spatialReferenceNotSupported=y);K&&(q.outsideScaleRange=K);return q};A.addAttachHandles=function(q){this.addHandles(q,"attach")};u._createClass(D,[{key:"spatialReferenceSupported",
get:function(){const q=this.view?.spatialReference;return null==q||this.supportsSpatialReference(q)}},{key:"updating",get:function(){return this.spatialReferenceSupported&&(!this.attached||!this.suspended&&(this.updateRequested||this.isUpdating())||!!this.updatingHandles?.updating)}}]);return D}(v);F.__decorate([b.property()],v.prototype,"attached",void 0);F.__decorate([b.property({type:n,set(E){E=x.referenceSetter(E,this._get("clips"),n);this._set("clips",E)}})],v.prototype,"clips",void 0);F.__decorate([b.property()],
v.prototype,"container",void 0);F.__decorate([b.property()],v.prototype,"moving",void 0);F.__decorate([b.property({readOnly:!0})],v.prototype,"spatialReferenceSupported",null);F.__decorate([b.property({readOnly:!0})],v.prototype,"updateParameters",void 0);F.__decorate([b.property()],v.prototype,"updateRequested",void 0);F.__decorate([b.property()],v.prototype,"updating",null);F.__decorate([b.property()],v.prototype,"view",void 0);F.__decorate([b.property({readOnly:!0})],v.prototype,"visibleAtCurrentScale",
void 0);F.__decorate([b.property({type:w})],v.prototype,"highlightOptions",void 0);return v=F.__decorate([f.subclass("esri.views.2d.layers.LayerView2D")],v)};Object.defineProperty(C,Symbol.toStringTag,{value:"Module"})})},"esri/views/layers/support/ClipRect":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./ClipArea".split(" "),
function(C,u,F,B,x,h,g,b){var c;B=c=function(a){function d(m){m=a.call(this,m)||this;m.type="rect";m.left=null;m.right=null;m.top=null;m.bottom=null;return m}C._inherits(d,a);var f=d.prototype;f.clone=function(){return new c({left:this.left,right:this.right,top:this.top,bottom:this.bottom})};f.commitVersionProperties=function(){this.commitProperty("left");this.commitProperty("right");this.commitProperty("top");this.commitProperty("bottom")};return C._createClass(d)}(b);u.__decorate([F.property({type:[Number,
String],json:{write:!0}})],B.prototype,"left",void 0);u.__decorate([F.property({type:[Number,String],json:{write:!0}})],B.prototype,"right",void 0);u.__decorate([F.property({type:[Number,String],json:{write:!0}})],B.prototype,"top",void 0);u.__decorate([F.property({type:[Number,String],json:{write:!0}})],B.prototype,"bottom",void 0);return B=c=u.__decorate([g.subclass("esri.views.layers.support.ClipRect")],B)})},"esri/views/layers/support/ClipArea":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),
function(C,u,F,B,x,h,g,b){F=function(c){function a(){return c.apply(this,arguments)||this}C._inherits(a,c);C._createClass(a,[{key:"version",get:function(){this.commitVersionProperties();return(this._get("version")||0)+1}}]);return a}(F.JSONSupport);u.__decorate([B.property({readOnly:!0})],F.prototype,"version",null);return F=u.__decorate([b.subclass("esri.views.layers.support.ClipArea")],F)})},"esri/views/layers/support/Geometry":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../geometry/Geometry ../../../geometry/support/jsonUtils ./ClipArea ../../../geometry/Extent ../../../geometry/Polygon".split(" "),
function(C,u,F,B,x,h,g,b,c,a,d,f,m){var w;F={base:c,key:"type",typeMap:{extent:f,polygon:m}};d=w=function(l){function t(n){n=l.call(this,n)||this;n.type="geometry";n.geometry=null;return n}C._inherits(t,l);var p=t.prototype;p.clone=function(){return new w({geometry:this.geometry?.clone()??null})};p.commitVersionProperties=function(){this.commitProperty("geometry")};return C._createClass(t)}(d);u.__decorate([B.property({types:F,json:{read:a.fromJSON,write:!0}})],d.prototype,"geometry",void 0);return d=
w=u.__decorate([b.subclass("esri.views.layers.support.Geometry")],d)})},"esri/views/layers/support/Path":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./ClipArea".split(" "),function(C,u,F,B,x,h,g,b){B=function(c){function a(d){d=c.call(this,d)||this;d.type="path";d.path=[];return d}
C._inherits(a,c);a.prototype.commitVersionProperties=function(){this.commitProperty("path")};return C._createClass(a)}(b);u.__decorate([F.property({type:[[[Number]]],json:{write:!0}})],B.prototype,"path",void 0);return B=u.__decorate([g.subclass("esri.views.layers.support.Path")],B)})},"esri/views/2d/layers/support/DebugOverlay":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../chunks/mat3 ../../../../chunks/mat3f32 ../../../webgl/BufferObject ../../../webgl/FramebufferObject ../../../../core/arrayUtils ../../../../core/has ../../../webgl/checkWebGLError ../../../webgl/contextUtils ../../../webgl/enums ../../../../chunks/builtins ../../../webgl/GLObjectType ../../../webgl/Texture ../../../webgl/VertexArrayObject ../../engine/DisplayObject ../../../webgl/VertexElementDescriptor".split(" "),
function(C,u,F,B,x,h,g,b,c,a,d,f,m,w,l,t,p){const n={geometry:[new p.VertexElementDescriptor("a_PositionAndFlags",3,d.DataType.SHORT,0,6)]},v=new Map;v.set("a_PositionAndFlags",0);const E={vsPath:"debug/overlay",fsPath:"debug/overlay",attributes:v};return function(D){function A(y){var K=D.call(this)||this;K._conf=y;return K}C._inherits(A,D);A.makeFlags=function(y,K){return y|K<<2};var q=A.prototype;q._createTransforms=function(){return{dvs:B.create()}};q.doRender=function(y){this._updateTransforms(y);
this._ensureResources(y);const {context:K}=y;K.useProgram(this._program);this._program.setUniformMatrix3fv("u_dvsMat3",this.transforms.dvs);this._program.setUniform4fv("u_colors",this._conf.getColors(y));this._program.setUniform1fv("u_opacities",this._conf.getOpacities(y));const {vertexData:N,indexData:Q}=this._conf.getMesh(y);this._vertexBuffer.setData(N);this._indexBuffer.setData(Q);K.bindVAO(this._vertexArray);K.setBlendingEnabled(!0);K.setBlendFunction(d.BlendFactor.ONE,d.BlendFactor.ONE_MINUS_SRC_ALPHA);
K.setDepthTestEnabled(!1);K.setStencilTestEnabled(!1);K.setColorMask(!0,!0,!0,!0);K.drawElements(d.PrimitiveType.TRIANGLES,Q.length,d.DataType.UNSIGNED_INT,0)};q.onDetach=function(){this._vertexArray=u.disposeMaybe(this._vertexArray)};q._updateTransforms=function(y){F.identity(this.transforms.dvs);F.translate(this.transforms.dvs,this.transforms.dvs,[-1,1]);F.scale(this.transforms.dvs,this.transforms.dvs,[2/y.state.size[0],-2/y.state.size[1],1])};q._ensureResources=function(y){const {context:K}=y;
this._program||(this._program=y.painter.materialManager.getProgram(E));this._vertexBuffer||(this._vertexBuffer=x.BufferObject.createVertex(K,d.Usage.STREAM_DRAW));this._indexBuffer||(this._indexBuffer=x.BufferObject.createIndex(K,d.Usage.STREAM_DRAW));this._vertexArray||(this._vertexArray=new l.VertexArrayObject(K,v,n,{geometry:this._vertexBuffer},this._indexBuffer))};return C._createClass(A)}(t.DisplayObject)})},"esri/views/2d/tiling/TileInfoViewPOT":function(){define(["../../../chunks/_rollupPluginBabelHelpers",
"../../../layers/support/TileInfo","./TileInfoView","./TileKey"],function(C,u,F,B){return function(x){function h(){var b=x.apply(this,arguments)||this;b._fullCacheLodInfos=null;b._levelByScale={};return b}C._inherits(h,x);var g=h.prototype;g.getTileParentId=function(b){b=B.pool.acquire(b);const c=0===b.level?null:B.getId(b.level-1,b.row>>1,b.col>>1,b.world);B.pool.release(b);return c};g.getTileCoverage=function(b,c,a=!0,d){b=C._get(C._getPrototypeOf(h.prototype),"getTileCoverage",this).call(this,
b,c,a,d);if(!b)return b;const f=1<<b.lodInfo.level;b.spans=b.spans.filter(m=>0<=m.row&&m.row<f);return b};g.scaleToLevel=function(b){this._fullCacheLodInfos||this._initializeFullCacheLODs(this._lodInfos);if(this._levelByScale[b])return this._levelByScale[b];var c=this._fullCacheLodInfos;if(b>c[0].scale)return c[0].level;let a;for(let d=0;d<c.length-1;d++)if(a=c[d+1],b>a.scale)return c=c[d],c.level+(c.scale-b)/(c.scale-a.scale);return c[c.length-1].level};g._initializeFullCacheLODs=function(b){b=0===
b[0].level?b.map(c=>({level:c.level,resolution:c.resolution,scale:c.scale})):u.create({size:this.tileInfo.size[0],spatialReference:this.tileInfo.spatialReference}).lods.map(c=>({level:c.level,resolution:c.resolution,scale:c.scale}));for(let c=0;c<b.length;c++)this._levelByScale[b[c].scale]=b[c].level;this._fullCacheLodInfos=b};return C._createClass(h)}(F)})},"*noref":1}});
define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Graphic ../../../core/lang ../../../core/Logger ../../../core/maybe ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/diffUtils ../../../geometry/support/aaBoundingRect ../../../geometry/support/spatialReferenceUtils ../engine/vectorTiles/enums ../engine/vectorTiles/TileHandler ../engine/vectorTiles/TileManager ../engine/vectorTiles/VectorTile ../engine/vectorTiles/VectorTileContainer ../engine/vectorTiles/style/StyleDefinition ../engine/vectorTiles/style/StyleRepository ./LayerView2D ./support/DebugOverlay ../tiling/TileInfoViewPOT ../tiling/TileQueue ../../layers/LayerView".split(" "),function(C,
u,F,B,x,h,g,b,c,a,d,f,m,w,l,t,p,n,v,E,D,A,q,y,K,N){function Q(T){if(null==T)return 0;switch(T.type){case "partial":return Object.keys(T.diff).length;case "complete":return Math.max(Object.keys(T.oldValue).length,Object.keys(T.newValue).length);case "collection":return Object.keys(T.added).length+Object.keys(T.changed).length+Object.keys(T.removed).length}}a=function(T){function V(){var L=T.apply(this,arguments)||this;L._styleChanges=[];L._fetchQueue=null;L._parseQueue=null;L._tileHandlerPromise=null;
L._isTileHandlerReady=!1;L._collisionOverlay=null;L.fading=!1;L._getCollidersMesh=J=>{({pixelRatio:J}=J.state);let I=0;const S=[],M=[];for(const X of L._vectorTileContainer.children)if(X.symbols)for(const [,Z]of X.symbols)for(const ha of Z)for(const da of ha.colliders){const W=(da.xScreen+da.dxScreen)*J,aa=(da.yScreen+da.dyScreen)*J,ea=da.width*J,fa=da.height*J;var R=.5<ha.unique.parts[da.partIndex].targetOpacity;if(!R&&"all"!==L.layer.showCollisionBoxes)continue;const ka=q.makeFlags(R?2:0,R?3:0);
S.push(W,aa,ka,W+ea,aa,ka,W,aa+fa,ka,W+ea,aa+fa,ka);M.push(I,I+1,I+2,I+1,I+3,I+2);I+=4;R=q.makeFlags(R?3:1,R?3:0);S.push(W,aa,R,W+ea,aa,R,W,aa+1,R,W+ea,aa+1,R);M.push(I,I+1,I+2,I+1,I+3,I+2);I+=4;S.push(W,aa+fa-1,R,W+ea,aa+fa-1,R,W,aa+fa,R,W+ea,aa+fa,R);M.push(I,I+1,I+2,I+1,I+3,I+2);I+=4;S.push(W,aa,R,W+1,aa,R,W,aa+fa,R,W+1,aa+fa,R);M.push(I,I+1,I+2,I+1,I+3,I+2);I+=4;S.push(W+ea-1,aa,R,W+ea,aa,R,W+ea-1,aa+fa,R,W+ea,aa+fa,R);M.push(I,I+1,I+2,I+1,I+3,I+2);I+=4}return{vertexData:new Int16Array(S),indexData:new Uint32Array(M)}};
L._getCollidersColors=()=>[1,.5,0,1,1,0,0,1,0,1,.5,1,0,.5,0,1];L._getCollidersOpacities=()=>[.05,.01,.15,.2];return L}C._inherits(V,T);var P=V.prototype;P.hitTest=async function(L,J){if(!this._tileHandlerPromise)return null;await this._tileHandlerPromise;J=await this._vectorTileContainer.hitTest(J);if(!J||0===J.length)return null;J=J[0]-1;var I=this._styleRepository;const S=I.getStyleLayerByUID(J);if(!S)return null;I=I.getStyleLayerIndex(S.id);return[{type:"graphic",mapPoint:L,layer:this.layer,graphic:new F({attributes:{layerId:I,
layerName:S.id,layerUID:J},layer:this.layer,sourceLayer:this.layer})}]};P.update=function(L){this._tileHandlerPromise&&this._isTileHandlerReady&&(L.pixelRatio!==this._tileHandler.devicePixelRatio?(this._start(),this._tileHandler.devicePixelRatio=L.pixelRatio):0<this._styleChanges.length?this._tileHandlerPromise=this._applyStyleChanges():(this._fetchQueue.pause(),this._parseQueue.pause(),this._fetchQueue.state=L.state,this._parseQueue.state=L.state,this._tileManager.update(L)||this.requestUpdate(),
this._parseQueue.resume(),this._fetchQueue.resume()))};P.attach=function(){const {style:L}=this.layer.currentStyleInfo;this._styleRepository=new D(L);this._tileInfoView=new y(this.layer.tileInfo,this.layer.fullExtent);this._vectorTileContainer=new v.VectorTileContainer(this._tileInfoView);this._tileHandler=new t.TileHandler(this.layer,this._styleRepository,window.devicePixelRatio||1);this.container.addChild(this._vectorTileContainer);this._start();this.addAttachHandles([this._vectorTileContainer.on("fade-start",
()=>{this.fading=!0;this.notifyChange("updating");this.requestUpdate()}),this._vectorTileContainer.on("fade-complete",()=>{this._collisionOverlay?.requestRender();this.fading=!1;this.notifyChange("updating");this.requestUpdate()}),b.watch(()=>this.layer.showCollisionBoxes,J=>{"none"!==J?this._collisionOverlay||(this._collisionOverlay=new q({getMesh:this._getCollidersMesh,getColors:this._getCollidersColors,getOpacities:this._getCollidersOpacities}),this.container.addChild(this._collisionOverlay)):
this._collisionOverlay&&(this.container.removeChild(this._collisionOverlay),this._collisionOverlay=null);this.container.requestRender()},b.initial),this.layer.on("paint-change",J=>{if(J.isDataDriven)this._styleChanges.push({type:l.StyleUpdateType.PAINTER_CHANGED,data:J}),this.notifyChange("updating"),this.requestUpdate();else{const S=this._styleRepository;var I=S.getLayerById(J.layer);I&&(I=I.type===E.StyleLayerType.SYMBOL,S.setPaintProperties(J.layer,J.paint),I&&this._vectorTileContainer.restartDeclutter(),
this._vectorTileContainer.requestRender())}}),this.layer.on("layout-change",J=>{const I=this._styleRepository,S=I.getLayerById(J.layer);if(S){var M=f.diff(S.layout,J.layout);null!=M&&(f.hasDiff(M,"visibility")&&1===Q(M)?(I.setLayoutProperties(J.layer,J.layout),S.type===E.StyleLayerType.SYMBOL&&this._vectorTileContainer.restartDeclutter(),this._vectorTileContainer.requestRender()):(this._styleChanges.push({type:l.StyleUpdateType.LAYOUT_CHANGED,data:J}),this.notifyChange("updating"),this.requestUpdate()))}}),
this.layer.on("style-layer-visibility-change",J=>{const I=this._styleRepository,S=I.getLayerById(J.layer);S&&(I.setStyleLayerVisibility(J.layer,J.visibility),S.type===E.StyleLayerType.SYMBOL&&this._vectorTileContainer.restartDeclutter(),this._vectorTileContainer.requestRender())}),this.layer.on("style-layer-change",J=>{this._styleChanges.push({type:l.StyleUpdateType.LAYER_CHANGED,data:J});this.notifyChange("updating");this.requestUpdate()}),this.layer.on("delete-style-layer",J=>{this._styleChanges.push({type:l.StyleUpdateType.LAYER_REMOVED,
data:J});this.notifyChange("updating");this.requestUpdate()}),this.layer.on("load-style",()=>this._loadStyle()),this.layer.on("spriteSource-change",J=>{this._newSpriteSource=J.spriteSource;this._styleChanges.push({type:l.StyleUpdateType.SPRITES_CHANGED,data:null});J=this._styleRepository.layers;for(const I of J)switch(I.type){case E.StyleLayerType.SYMBOL:I.getLayoutProperty("icon-image")&&this._styleChanges.push({type:l.StyleUpdateType.LAYOUT_CHANGED,data:{layer:I.id,layout:I.layout}});break;case E.StyleLayerType.LINE:I.getPaintProperty("line-pattern")&&
this._styleChanges.push({type:l.StyleUpdateType.PAINTER_CHANGED,data:{layer:I.id,paint:I.paint,isDataDriven:I.isPainterDataDriven()}});break;case E.StyleLayerType.FILL:I.getLayoutProperty("fill-pattern")&&this._styleChanges.push({type:l.StyleUpdateType.PAINTER_CHANGED,data:{layer:I.id,paint:I.paint,isDataDriven:I.isPainterDataDriven()}})}this.notifyChange("updating");this.requestUpdate()})])};P.detach=function(){this._stop();this.container.removeAllChildren();this._vectorTileContainer=h.destroyMaybe(this._vectorTileContainer);
this._tileHandler=h.destroyMaybe(this._tileHandler)};P.moveStart=function(){this.requestUpdate()};P.viewChange=function(){this.requestUpdate()};P.moveEnd=function(){this._collisionOverlay&&this._vectorTileContainer.restartDeclutter();this.requestUpdate()};P.supportsSpatialReference=function(L){return w.equals(this.layer.tileInfo?.spatialReference,L)};P.canResume=function(){let L=C._get(C._getPrototypeOf(V.prototype),"canResume",this).call(this);const {currentStyleInfo:J}=this.layer;if(L&&J?.layerDefinition){const I=
this.view.scale,{minScale:S,maxScale:M}=J.layerDefinition;J&&J.layerDefinition&&(S&&S<I&&(L=!1),M&&M>I&&(L=!1))}return L};P.isUpdating=function(){const L=this._vectorTileContainer.children;return!this._isTileHandlerReady||!this._fetchQueue||!this._parseQueue||this._fetchQueue.updating||this._parseQueue.updating||0<L.length&&L.some(J=>J.invalidating)||this.fading};P.acquireTile=function(L){const J=this._createVectorTile(L);this._tileHandlerPromise?.then(()=>{this._fetchQueue.push(J.key).then(I=>this._parseQueue.push({key:J.key,
data:I})).then(I=>{J.once("attach",()=>this.requestUpdate());J.setData(I);this.requestUpdate();this.notifyChange("updating")}).catch(I=>{this.notifyChange("updating");g.isAbortError(I)||x.getLogger(this).error(I)})});return J};P.releaseTile=function(L){L=L.key.id;this._fetchQueue.abort(L);this._parseQueue.abort(L);this.requestUpdate()};P._start=function(){this._stop();this._tileManager=new p.TileManager({acquireTile:I=>this.acquireTile(I),releaseTile:I=>this.releaseTile(I),tileInfoView:this._tileInfoView},
this._vectorTileContainer);if(this.layer.currentStyleInfo){var L=new AbortController,J=this._tileHandler.start({signal:L.signal}).then(()=>{this._fetchQueue=new K({tileInfoView:this._tileInfoView,process:(I,S)=>this._getTileData(I,S),concurrency:15});this._parseQueue=new K({tileInfoView:this._tileInfoView,process:(I,S)=>this._parseTileData(I,S),concurrency:8});this.requestUpdate();this._isTileHandlerReady=!0});this._tileHandler.spriteMosaic.then(I=>{this._vectorTileContainer.setStyleResources(I,this._tileHandler.glyphMosaic,
this._styleRepository);this.requestUpdate()});this._tileHandlerAbortController=L;this._tileHandlerPromise=J}};P._stop=function(){if(this._tileHandlerAbortController&&this._vectorTileContainer){var L=this._tileHandlerAbortController;L&&L.abort();this._tileHandlerPromise=null;this._isTileHandlerReady=!1;this._fetchQueue=h.destroyMaybe(this._fetchQueue);this._parseQueue=h.destroyMaybe(this._parseQueue);this._tileManager=h.destroyMaybe(this._tileManager);this._vectorTileContainer.removeAllChildren()}};
P._getTileData=async function(L,J){L=await this._tileHandler.fetchTileData(L,J);this.notifyChange("updating");return L};P._parseTileData=async function(L,J){return this._tileHandler.parseTileData(L,J)};P._applyStyleChanges=async function(){this._isTileHandlerReady=!1;this._fetchQueue.pause();this._parseQueue.pause();this._fetchQueue.clear();this._parseQueue.clear();this._tileManager.clearCache();var L=this._styleChanges;try{await this._tileHandler.updateStyle(L)}catch(X){x.getLogger(this).error("error applying vector-tiles style update",
X.message),this._fetchQueue.resume(),this._parseQueue.resume(),this._isTileHandlerReady=!0}const J=this._styleRepository,I=[];L.forEach(X=>{X.type===l.StyleUpdateType.LAYER_REMOVED&&(X=J.getLayerById(X.data.layer))&&I.push(X.uid)});const S=[];let M;L.forEach(X=>{const Z=X.data;switch(X.type){case l.StyleUpdateType.PAINTER_CHANGED:J.setPaintProperties(Z.layer,Z.paint);M=Z.layer;break;case l.StyleUpdateType.LAYOUT_CHANGED:J.setLayoutProperties(Z.layer,Z.layout);M=Z.layer;break;case l.StyleUpdateType.LAYER_REMOVED:J.deleteStyleLayer(Z.layer);
return;case l.StyleUpdateType.LAYER_CHANGED:J.setStyleLayer(Z.layer,Z.index);M=Z.layer.id;break;case l.StyleUpdateType.SPRITES_CHANGED:this._vectorTileContainer.setSpriteMosaic(this._tileHandler.setSpriteSource(this._newSpriteSource)),M=this._newSpriteSource=null}(X=J.getLayerById(M))&&S.push(X.uid)});L=this._vectorTileContainer.children;if(0<I.length){this._vectorTileContainer.deleteStyleLayers(I);for(var R of L)R.deleteLayerData(I)}this._fetchQueue.resume();this._parseQueue.resume();if(0<S.length){R=
[];for(const X of L)L=this._fetchQueue.push(X.key).then(Z=>this._parseQueue.push({key:X.key,data:Z,styleLayerUIDs:S})).then(Z=>X.setData(Z)),R.push(L);await Promise.all(R)}this._styleChanges=[];this._isTileHandlerReady=!0;this.notifyChange("updating");this.requestUpdate()};P._loadStyle=async function(){var {style:L}=this.layer.currentStyleInfo;L=B.clone(L);this._isTileHandlerReady=!1;this._fetchQueue.pause();this._parseQueue.pause();this._fetchQueue.clear();this._parseQueue.clear();this.notifyChange("updating");
this._styleRepository=new D(L);this._vectorTileContainer.destroy();this._tileManager.clear();this._tileHandlerAbortController.abort();this._tileHandlerAbortController=new AbortController;const {signal:J}=this._tileHandlerAbortController;try{this._tileHandlerPromise=this._tileHandler.setStyle(this._styleRepository,L),await this._tileHandlerPromise}catch(I){if(!g.isAbortError(I))throw I;}J.aborted||(L=await this._tileHandler.spriteMosaic,this._vectorTileContainer.setStyleResources(L,this._tileHandler.glyphMosaic,
this._styleRepository));this._fetchQueue.resume();this._parseQueue.resume();this._isTileHandlerReady=!0;this.notifyChange("updating");this.requestUpdate()};P._createVectorTile=function(L){const J=this._tileInfoView.getTileBounds(m.create(),L),I=this._tileInfoView.getTileResolution(L.level);return new n.VectorTile(L,I,J[0],J[3],512,512,this._styleRepository)};return C._createClass(V)}(A.LayerView2DMixin(N));u.__decorate([c.property()],a.prototype,"_fetchQueue",void 0);u.__decorate([c.property()],a.prototype,
"_parseQueue",void 0);u.__decorate([c.property()],a.prototype,"_isTileHandlerReady",void 0);u.__decorate([c.property()],a.prototype,"fading",void 0);return a=u.__decorate([d.subclass("esri.views.2d.layers.VectorTileLayerView2D")],a)});
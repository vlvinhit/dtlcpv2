// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/Logger ../../../../../core/accessorSupport/ensureType ../../../../../core/arrayUtils ../../../../../core/has ../../../../../core/Error ../../../../../core/accessorSupport/decorators/subclass ../../../../../renderers/support/heatmapUtils ../../../engine/BitmapTileContainer ./BaseTileRenderer ./support/HeatmapSource".split(" "),function(e,l,n,v,w,x,y,z,p,q,r,t,u){e.HeatmapTileRenderer=
function(m){function h(a){var b=m.call(this,a)||this;b._intensityInfo={minDensity:0,maxDensity:0};b.type="heatmap";b.featuresView={attributeView:{initialize:()=>{},requestUpdate:()=>{}},requestRender:()=>{}};b._container=new r.BitmapTileContainer(a.tileInfoView);return b}l._inherits(h,m);var c=h.prototype;c.createTile=function(a){const b=this._container.createTile(a);this.tileInfoView.getTileCoords(b.bitmap,a);b.bitmap.resolution=this.tileInfoView.getTileResolution(a);return b};c.onConfigUpdate=function(){const a=
this.layer.renderer;if("heatmap"===a.type){const {minDensity:b,maxDensity:f,colorStops:k}=a;this._intensityInfo.minDensity=b;this._intensityInfo.maxDensity=f;this._gradient=q.generateGradient(k);this.tiles.forEach(d=>{const g=d.bitmap.source;g&&(g.minDensity=b,g.maxDensity=f,g.gradient=this._gradient,d.bitmap.invalidateTexture(),d.bitmap.requestRender())})}};c.hitTest=function(){return Promise.resolve([])};c.install=function(a){a.addChild(this._container)};c.uninstall=function(a){this._container.removeAllChildren();
a.removeChild(this._container)};c.disposeTile=function(a){this._container.removeChild(a);a.destroy()};c.supportsRenderer=function(a){return a&&"heatmap"===a.type};c.onTileData=function(a){const b=this.tiles.get(a.tileKey);if(b){a=a.intensityInfo;var {minDensity:f,maxDensity:k}=this._intensityInfo,d=b.bitmap.source||new u.HeatmapSource;d.intensities=a&&a.matrix||null;d.minDensity=f;d.maxDensity=k;d.gradient=this._gradient;b.bitmap.source=d;this._container.addChild(b);this._container.requestRender();
this.requestUpdate()}};c.onTileError=function(a){console.error(a)};c.lockGPUUploads=function(){};c.unlockGPUUploads=function(){};c.fetchResource=function(a,b){console.error(a);return Promise.reject()};return l._createClass(h)}(t);e.HeatmapTileRenderer=n.__decorate([p.subclass("esri.views.2d.layers.features.tileRenderers.HeatmapTileRenderer")],e.HeatmapTileRenderer);Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});
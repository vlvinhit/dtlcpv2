// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/Logger ../../core/maybe ../../core/typedArrayUtil ./enums ./Util".split(" "),function(l,t,h,m,u,n,p){const f=h.getLogger("esri.views.webgl.VertexArrayObject");h=function(){function k(a,b,c,d,g=null){this._context=a;this._locations=b;this._layout=c;this._buffers=d;this._indexBuffer=g;this._glName=null;this._initialized=!1;a.instanceCounter.increment(n.ResourceType.VertexArrayObject,this)}var e=k.prototype;e.dispose=function(){if(this._context){this._context.getBoundVAO()===
this&&this._context.bindVAO(null);for(const a in this._buffers)this._buffers[a]?.dispose(),delete this._buffers[a];this._indexBuffer=m.disposeMaybe(this._indexBuffer);this.disposeVAOOnly()}else(this._glName||0<Object.getOwnPropertyNames(this._buffers).length)&&f.warn("Leaked WebGL VAO")};e.disposeVAOOnly=function(){this._glName&&((this._context?.capabilities?.vao).deleteVertexArray(this._glName),this._glName=null);this._context.instanceCounter.decrement(n.ResourceType.VertexArrayObject,this);this._context=
m.nullifyNonNullableForDispose(this._context)};e.initialize=function(){if(!this._initialized){var a=this._context.capabilities.vao;if(a){const b=a.createVertexArray();a.bindVertexArray(b);this._bindLayout();a.bindVertexArray(null);this._glName=b}this._initialized=!0}};e.bind=function(){this.initialize();const a=this._context.capabilities.vao;a?a.bindVertexArray(this.glName):(this._context.bindVAO(null),this._bindLayout())};e._bindLayout=function(){const {_buffers:a,_layout:b,_indexBuffer:c}=this;
a||f.error("Vertex buffer dictionary is empty!");const d=this._context.gl;for(const g in a){const q=a[g];q||f.error("Vertex buffer is uninitialized!");const r=b[g];r||f.error("Vertex element descriptor is empty!");p.bindVertexBufferLayout(this._context,this._locations,q,r)}null!=c&&(this._context.capabilities.vao?d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,c.glName):this._context.bindBuffer(c))};e.unbind=function(){this.initialize();const a=this._context.capabilities.vao;a?a.bindVertexArray(null):this._unbindLayout()};
e._unbindLayout=function(){const {_buffers:a,_layout:b}=this;a||f.error("Vertex buffer dictionary is empty!");for(const c in a){const d=a[c];d||f.error("Vertex buffer is uninitialized!");p.unbindVertexBufferLayout(this._context,this._locations,d,b[c])}null!=this._indexBuffer&&this._context.unbindBuffer(this._indexBuffer.bufferType)};t._createClass(k,[{key:"glName",get:function(){return this._glName}},{key:"context",get:function(){return this._context}},{key:"vertexBuffers",get:function(){return this._buffers}},
{key:"indexBuffer",get:function(){return this._indexBuffer}},{key:"byteSize",get:function(){return Object.keys(this._buffers).reduce((a,b)=>a+this._buffers[b].byteLength,null!=this._indexBuffer?this._indexBuffer.byteLength:0)}},{key:"layout",get:function(){return this._layout}},{key:"locations",get:function(){return this._locations}},{key:"memoryEstimate",get:function(){return this.byteSize+(Object.keys(this._buffers).length+(this._indexBuffer?1:0))*u.typedArrayStaticSize}}]);return k}();l.VertexArrayObject=
h;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})});
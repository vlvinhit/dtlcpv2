// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/vec2f64 ../../chunks/vec3 ../../chunks/vec3f64 ../3d/state/utils/navigationUtils ./FilteredFiniteDifference ./FilteredValue ./Momentum".split(" "),function(n,h,w,k,l,t,p,u,q){let v=function(m){function d(a,e,c,f,g,r=0,x){a=m.call(this,a,e,c)||this;a._angularVelocity1=f;a.axis1=g;a.angularVelocity2=r;a.axis2=x;return a}h._inherits(d,m);var b=d.prototype;b.value1=function(a){return h._get(h._getPrototypeOf(d.prototype),"valueFromInitialVelocity",
this).call(this,this._angularVelocity1,a)};b.value2=function(a){return h._get(h._getPrototypeOf(d.prototype),"valueFromInitialVelocity",this).call(this,this.angularVelocity2,a)};return h._createClass(d)}(q.Momentum);q=function(){function m(b=300,a=12,e=.84){this._minimumInitialVelocity=b;this._stopVelocity=a;this._friction=e;this.enabled=!0;this._tmpAxis1=l.create();this._tmpAxis2=l.create();this._tmpAngles=w.create();this._time=new p.FilteredFiniteDifference(.3);this._screen=[new p.FilteredFiniteDifference(.4),
new p.FilteredFiniteDifference(.4)];this._angle1=new u.FilteredValue(.6);this._angle2=new u.FilteredValue(.6);this._axis1=l.create();this._axis2=l.create();this._lastScene=l.create()}var d=m.prototype;d.addMomentumDirectRotation=function(b,a,e,c,f,g){if(this.enabled){if(this._time.hasLastValue()){if(.01>this._time.computeDelta(e))return;c=t.rotationAngleAndAxisDirectRotation(this._lastScene,a,this._tmpAxis2,c,f,g);this._angle2.update(0);1E-5>k.squaredLength(this._tmpAxis2)?c=0:k.normalize(this._axis1,
this._tmpAxis2);this._angle1.update(c);k.copy(this._lastScene,a)}this._screen[0].update(b[0]);this._screen[1].update(b[1]);this._time.update(e)}};d.addMomentumPreserveHeading=function(b,a,e,c,f,g,r){if(this.enabled){if(this._time.hasLastValue()){if(.01>this._time.computeDelta(e))return;t.rotationAnglesAndAxesHeadingPreserving(this._lastScene,a,this._tmpAxis2,this._tmpAxis1,this._tmpAngles,c,f,g,r,!1);1E-5>k.squaredLength(this._tmpAxis2)?(this._angle1.update(0),this._angle2.update(0)):(this._angle1.update(this._tmpAngles[1]),
this._angle2.update(this._tmpAngles[0]),k.normalize(this._axis1,this._tmpAxis1),k.normalize(this._axis2,this._tmpAxis2));k.copy(this._lastScene,a)}this._screen[0].update(b[0]);this._screen[1].update(b[1]);this._time.update(e)}};d.reset=function(){this._screen[0].reset();this._screen[1].reset();this._angle1.reset();this._angle2.reset();this._time.reset()};d.evaluateMomentum=function(){if(!this.enabled||!this._screen[0].hasFilteredDelta())return null;var b=this._screen[0].filteredDelta,a=this._screen[1].filteredDelta;
b=null==b||null==a?null:Math.sqrt(b*b+a*a);a=this._time.filteredDelta;b=null==b||null==a?0:b/a;return Math.abs(b)<this._minimumInitialVelocity?null:this.createMomentum(b,this._stopVelocity,this._friction)};d.createMomentum=function(b,a,e){const c=this._time.filteredDelta,f=this._angle1.filteredValue,g=this._angle2.filteredValue;return new v(b,a,e,null==c||null==f?0:f/c,this._axis1,null==c||null==g?0:g/c,this._axis2)};return h._createClass(m)}();n.PanSphericalMomentum=v;n.PanSphericalMomentumEstimator=
q;Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})});
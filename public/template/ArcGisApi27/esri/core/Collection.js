// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./ArrayPool ./Evented ./lang ./maybe ./ObjectPool ./ObservableChangesType ./scheduling ./accessorSupport/ensureType ./accessorSupport/tracking ./accessorSupport/decorators/property ./accessorSupport/decorators/shared ./accessorSupport/decorators/subclass ./accessorSupport/tracking/SimpleObservable".split(" "),function(z,C,A,M,N,G,O,h,P,H,f,I,Q,J,R){function D(g){return g?g instanceof B?g.toArray():g.length?Array.prototype.slice.apply(g):
[]:[]}function E(g){if(g&&g.length)return g[0]}function K(g,t,p,c){t&&t.forEach((a,b,d)=>{g.push(a);K(g,p.call(c,a,b,d),p,c)})}var v;let S=function(){function g(){this.target=null;this.defaultPrevented=this.cancellable=!1;this.type=this.item=void 0}var t=g.prototype;t.preventDefault=function(){this.cancellable&&(this.defaultPrevented=!0)};t.reset=function(p){this.defaultPrevented=!1;this.item=p};return z._createClass(g)}();const u=new O(S,void 0,g=>{g.item=null;g.target=null;g.defaultPrevented=!1;
g.cancellable=!1}),T=()=>{},w=new Set,x=new Set,y=new Set,F=new Map;let U=0,B=v=function(g,t){function p(a){a=g.call(this,a)||this;a._chgListeners=[];a._notifications=null;a._timer=null;a._observable=new R.SimpleObservable;a.length=0;a._items=[];Object.defineProperty(z._assertThisInitialized(a),"uid",{value:U++});return a}z._inherits(p,g);p.isCollection=function(a){return null!=a&&a instanceof v};var c=p.prototype;c.normalizeCtorArgs=function(a){return a?Array.isArray(a)||a instanceof v?{items:a}:
a:{}};c.destroy=function(){this._removeAllRaw()};c[t]=function*(){yield*this.items};c.hasEventListener=function(a){return"change"===a?0<this._chgListeners.length:this._emitter.hasEventListener(a)};c.on=function(a,b){if("change"===a){const d=this._chgListeners,k={removed:!1,callback:b};d.push(k);this._notifications&&this._notifications.push({listeners:d.slice(),items:this._items.slice(),changes:[]});return{remove(){this.remove=T;k.removed=!0;d.splice(d.indexOf(k),1)}}}return this._emitter.on(a,b)};
c.once=function(a,b){const d=this.on(a,b);return{remove(){d.remove()}}};c.add=function(a,b){f.trackAccess(this._observable);if(this._emitBeforeChanges(h.ObservableChangesType.ADD))return this;b=this.getNextIndex(b??null);this._splice(b,0,[a]);this._emitAfterChanges(h.ObservableChangesType.ADD);return this};c.addMany=function(a,b=this._items.length){f.trackAccess(this._observable);if(!a||!a.length||this._emitBeforeChanges(h.ObservableChangesType.ADD))return this;b=this.getNextIndex(b);this._splice(b,
0,D(a));this._emitAfterChanges(h.ObservableChangesType.ADD);return this};c.at=function(a){f.trackAccess(this._observable);a=Math.trunc(a)||0;0>a&&(a+=this.length);if(!(0>a||a>=this.length))return this._items[a]};c.removeAll=function(){f.trackAccess(this._observable);if(!this.length||this._emitBeforeChanges(h.ObservableChangesType.REMOVE))return[];const a=this._removeAllRaw();this._emitAfterChanges(h.ObservableChangesType.REMOVE);return a};c._removeAllRaw=function(){return 0===this.length?[]:this._splice(0,
this.length)||[]};c.clone=function(){f.trackAccess(this._observable);return this._createNewInstance({items:this._items.map(N.clone)})};c.concat=function(...a){f.trackAccess(this._observable);a=a.map(D);return this._createNewInstance({items:this._items.concat(...a)})};c.drain=function(a,b){f.trackAccess(this._observable);if(this.length&&!this._emitBeforeChanges(h.ObservableChangesType.REMOVE)){var d=G.assumeNonNull(this._splice(0,this.length)),k=d.length;for(let n=0;n<k;n++)a.call(b,d[n],n,d);this._emitAfterChanges(h.ObservableChangesType.REMOVE)}};
c.every=function(a,b){f.trackAccess(this._observable);return this._items.every(a,b)};c.filter=function(a,b){f.trackAccess(this._observable);let d;d=2===arguments.length?this._items.filter(a,b):this._items.filter(a);return this._createNewInstance({items:d})};c.find=function(a,b){f.trackAccess(this._observable);return this._items.find(a,b)};c.findIndex=function(a,b){f.trackAccess(this._observable);return this._items.findIndex(a,b)};c.flatten=function(a,b){f.trackAccess(this._observable);const d=[];
K(d,this,a,b);return new v(d)};c.forEach=function(a,b){f.trackAccess(this._observable);return this._items.forEach(a,b)};c.getItemAt=function(a){f.trackAccess(this._observable);return this._items[a]};c.getNextIndex=function(a){f.trackAccess(this._observable);const b=this.length;a=null==a?b:a;0>a?a=0:a>b&&(a=b);return a};c.includes=function(a,b=0){f.trackAccess(this._observable);return this._items.includes(a,b)};c.indexOf=function(a,b=0){f.trackAccess(this._observable);return this._items.indexOf(a,
b)};c.join=function(a=","){f.trackAccess(this._observable);return this._items.join(a)};c.lastIndexOf=function(a,b=this.length-1){f.trackAccess(this._observable);return this._items.lastIndexOf(a,b)};c.map=function(a,b){f.trackAccess(this._observable);a=this._items.map(a,b);return new v({items:a})};c.reorder=function(a,b=this.length-1){f.trackAccess(this._observable);const d=this.indexOf(a);if(-1!==d){0>b?b=0:b>=this.length&&(b=this.length-1);if(d!==b){if(this._emitBeforeChanges(h.ObservableChangesType.MOVE))return a;
this._splice(d,1);this._splice(b,0,[a]);this._emitAfterChanges(h.ObservableChangesType.MOVE)}return a}};c.pop=function(){f.trackAccess(this._observable);if(this.length&&!this._emitBeforeChanges(h.ObservableChangesType.REMOVE)){var a=E(this._splice(this.length-1,1));this._emitAfterChanges(h.ObservableChangesType.REMOVE);return a}};c.push=function(...a){f.trackAccess(this._observable);if(this._emitBeforeChanges(h.ObservableChangesType.ADD))return this.length;this._splice(this.length,0,a);this._emitAfterChanges(h.ObservableChangesType.ADD);
return this.length};c.reduce=function(a,b){f.trackAccess(this._observable);const d=this._items;return 2===arguments.length?d.reduce(a,b):d.reduce(a)};c.reduceRight=function(a,b){f.trackAccess(this._observable);const d=this._items;return 2===arguments.length?d.reduceRight(a,b):d.reduceRight(a)};c.remove=function(a){f.trackAccess(this._observable);return this.removeAt(this.indexOf(a))};c.removeAt=function(a){f.trackAccess(this._observable);if(!(0>a||a>=this.length||this._emitBeforeChanges(h.ObservableChangesType.REMOVE)))return a=
E(this._splice(a,1)),this._emitAfterChanges(h.ObservableChangesType.REMOVE),a};c.removeMany=function(a){f.trackAccess(this._observable);if(!a||!a.length||this._emitBeforeChanges(h.ObservableChangesType.REMOVE))return[];a=a instanceof v?a.toArray():a;const b=this._items,d=[],k=a.length;for(let l=0;l<k;l++){var n=b.indexOf(a[l]);if(-1<n){var q=l+1,m=n+1;const r=Math.min(a.length-q,b.length-m);let e=0;for(;e<r&&a[q+e]===b[m+e];)e++;q=1+e;(n=this._splice(n,q))&&0<n.length&&d.push.apply(d,n);l+=q-1}}this._emitAfterChanges(h.ObservableChangesType.REMOVE);
return d};c.reverse=function(){f.trackAccess(this._observable);if(this._emitBeforeChanges(h.ObservableChangesType.MOVE))return this;const a=this._splice(0,this.length);a&&(a.reverse(),this._splice(0,0,a));this._emitAfterChanges(h.ObservableChangesType.MOVE);return this};c.shift=function(){f.trackAccess(this._observable);if(this.length&&!this._emitBeforeChanges(h.ObservableChangesType.REMOVE)){var a=E(this._splice(0,1));this._emitAfterChanges(h.ObservableChangesType.REMOVE);return a}};c.slice=function(a=
0,b=this.length){f.trackAccess(this._observable);return this._createNewInstance({items:this._items.slice(a,b)})};c.some=function(a,b){f.trackAccess(this._observable);return this._items.some(a,b)};c.sort=function(a){f.trackAccess(this._observable);if(!this.length||this._emitBeforeChanges(h.ObservableChangesType.MOVE))return this;const b=G.assumeNonNull(this._splice(0,this.length));arguments.length?b.sort(a):b.sort();this._splice(0,0,b);this._emitAfterChanges(h.ObservableChangesType.MOVE);return this};
c.splice=function(a,b,...d){f.trackAccess(this._observable);const k=(b?h.ObservableChangesType.REMOVE:0)|(d.length?h.ObservableChangesType.ADD:0);if(this._emitBeforeChanges(k))return[];a=this._splice(a,b,d)||[];this._emitAfterChanges(k);return a};c.toArray=function(){f.trackAccess(this._observable);return this._items.slice()};c.toJSON=function(){f.trackAccess(this._observable);return this.toArray()};c.toLocaleString=function(){f.trackAccess(this._observable);return this._items.toLocaleString()};c.toString=
function(){f.trackAccess(this._observable);return this._items.toString()};c.unshift=function(...a){f.trackAccess(this._observable);if(!a.length||this._emitBeforeChanges(h.ObservableChangesType.ADD))return this.length;this._splice(0,0,a);this._emitAfterChanges(h.ObservableChangesType.ADD);return this.length};c._createNewInstance=function(a){return new this.constructor(a)};c._splice=function(a,b,d){const k=this._items;var n=this.itemType;let q=void 0;!this._notifications&&this.hasEventListener("change")&&
(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._timer=P.schedule(()=>this._dispatchChange()));if(b){q=k.splice(a,b);if(this.hasEventListener("before-remove")){var m=u.acquire();m.target=this;m.cancellable=!0;for(let e=0,L=q.length;e<L;e++)b=q[e],m.reset(b),this.emit("before-remove",m),m.defaultPrevented&&(q.splice(e,1),k.splice(a,0,b),a+=1,--e,--L);u.release(m)}this.length=this._items.length;if(this.hasEventListener("after-remove")){b=
u.acquire();b.target=this;b.cancellable=!1;m=q.length;for(let e=0;e<m;e++)b.reset(q[e]),this.emit("after-remove",b);u.release(b)}}if(d&&d.length){if(n){b=[];for(var l of d)d=n.ensureType(l),null==d&&null!=l||b.push(d);d=b}n=this.hasEventListener("before-add");l=this.hasEventListener("after-add");b=a===this.length;if(n||l){var r=u.acquire();r.target=this;r.cancellable=!0;m=u.acquire();m.target=this;m.cancellable=!1;for(const e of d)n?(r.reset(e),this.emit("before-add",r),r.defaultPrevented||(b?k.push(e):
k.splice(a++,0,e),this._set("length",k.length),l&&(m.reset(e),this.emit("after-add",m)))):(b?k.push(e):k.splice(a++,0,e),this._set("length",k.length),m.reset(e),this.emit("after-add",m));u.release(m);u.release(r)}else{if(b)for(r of d)k.push(r);else k.splice(a,0,...d);this._set("length",k.length)}}(d&&d.length||q&&q.length)&&this._notifyChangeEvent(d,q);return q};c._emitBeforeChanges=function(a){let b=!1;if(this.hasEventListener("before-changes")){const d=u.acquire();d.target=this;d.cancellable=!0;
d.type=a;this.emit("before-changes",d);b=d.defaultPrevented;u.release(d)}return b};c._emitAfterChanges=function(a){if(this.hasEventListener("after-changes")){const b=u.acquire();b.target=this;b.cancellable=!1;b.type=a;this.emit("after-changes",b);u.release(b)}this._observable.notify()};c._notifyChangeEvent=function(a,b){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-1].changes.push({added:a,removed:b})};c._dispatchChange=function(){this._timer&&
(this._timer.remove(),this._timer=null);if(this._notifications){var a=this._notifications;this._notifications=null;for(const b of a){a=b.changes;w.clear();x.clear();y.clear();for(const {added:l,removed:r}of a){if(l)if(0===y.size&&0===x.size)for(const e of l)w.add(e);else for(const e of l)x.has(e)?(y.add(e),x.delete(e)):y.has(e)||w.add(e);if(r)if(0===y.size&&0===w.size)for(const e of r)x.add(e);else for(const e of r)w.has(e)?w.delete(e):(y.delete(e),x.add(e))}const d=A.acquire();w.forEach(l=>{d.push(l)});
const k=A.acquire();x.forEach(l=>{k.push(l)});const n=this._items,q=b.items,m=A.acquire();y.forEach(l=>{q.indexOf(l)!==n.indexOf(l)&&m.push(l)});if(b.listeners&&(d.length||k.length||m.length)){a={target:this,added:d,removed:k,moved:m};const l=b.listeners.length;for(let r=0;r<l;r++){const e=b.listeners[r];e.removed||e.callback.call(this,a)}}A.release(d);A.release(k);A.release(m)}w.clear();x.clear();y.clear()}};z._createClass(p,[{key:"items",get:function(){f.trackAccess(this._observable);return this._items},
set:function(a){this._emitBeforeChanges(h.ObservableChangesType.ADD)||(this._splice(0,this.length,D(a)),this._emitAfterChanges(h.ObservableChangesType.ADD))}}]);return p}(M.EventedAccessor,Symbol.iterator);B.ofType=g=>{if(!g)return v;if(F.has(g))return F.get(g);let t=null;if("function"===typeof g)t=g.prototype.declaredClass;else if(g.base)t=g.base.prototype.declaredClass;else for(var p in g.typeMap){const c=g.typeMap[p].prototype.declaredClass;t=t?t+` | ${c}`:c}p=function(c){function a(){return c.apply(this,
arguments)||this}z._inherits(a,c);return z._createClass(a)}(v);C.__decorate([Q.shared({Type:g,ensureType:"function"===typeof g?H.ensureType(g):H.ensureOneOfType(g)})],p.prototype,"itemType",void 0);p=C.__decorate([J.subclass(`esri.core.Collection<${t}>`)],p);F.set(g,p);return p};C.__decorate([I.property()],B.prototype,"length",void 0);C.__decorate([I.property()],B.prototype,"items",null);return B=v=C.__decorate([J.subclass("esri.core.Collection")],B)});
// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ./clock ./Error ./events ./Logger ./maybe".split(" "),function(g,F,u,C,G,v){function l(a="Aborted"){return new u("AbortError",a)}function w(a,b="Aborted"){if(D(a))throw l(b);}function q(a){return null!=a?"aborted"in a?a:a.signal:a}function D(a){a=q(a);return null!=a&&a.aborted}function r(a,b){a=q(a);if(null!=a)if(a.aborted)b();else return C.once(a,"abort",()=>b())}function p(a){return"AbortError"===a?.name}async function x(a){if(a){if("function"!==typeof a.forEach){const b=Object.keys(a),
d=b.map(c=>a[c]),e=await x(d),f={};b.map((c,h)=>f[c]=e[h]);return f}return Promise.allSettled(a).then(b=>Array.from(a,(d,e)=>{e=b[e];return"fulfilled"===e.status?{promise:d,value:e.value}:{promise:d,error:e.reason}}))}}function y(a,b,d){const e=new AbortController;r(d,()=>e.abort());return new Promise((f,c)=>{let h=setTimeout(()=>{h=0;f(b)},a);r(e,()=>{h&&(clearTimeout(h),c(l()))})})}function E(a){return a&&"function"===typeof a.then}function z(a){return E(a)?a:Promise.resolve(a)}function A(){let a,
b;const d=new Promise((f,c)=>{a=f;b=c}),e=f=>{a(f)};e.resolve=f=>a(f);e.reject=f=>b(f);e.timeout=(f,c)=>F.clock.setTimeout(()=>e.reject(c),f);e.promise=d;return e}g.after=y;g.always=function(a,b){return a.then(b,b)};g.createAbortError=l;g.createResolver=A;g.debounce=function(a,b=-1){let d,e,f,c,h=null;const n=(...k)=>{if(d){e=k;c&&c.reject(l());c=A();k=v.assumeNonNull(c.promise);if(h){var t=h;h=null;t.abort()}return k}f=c||A();c=null;if(0<b){const m=new AbortController,H=d=z(a(...k,m.signal));y(b).then(()=>
{d===H&&(c?m.abort():h=m)})}else d=1,d=z(a(...k));k=()=>{const m=e;e=f=d=h=null;null!=m&&n(...m)};t=d;const B=f;t.then(k,k);t.then(B.resolve,B.reject);return v.assumeNonNull(B.promise)};return n};g.eachAlways=x;g.eachAlwaysValues=async function(a){return(await x(a)).filter(b=>!!b.value).map(b=>b.value)};g.filter=async function(a,b){const d=a.slice(),e=await Promise.all(a.map((f,c)=>b(f,c)));return d.filter((f,c)=>e[c])};g.ignoreAbortErrors=async function(a){try{return await a}catch(b){if(!p(b))throw b;
}};g.isAbortError=p;g.isAborted=D;g.isPromiseLike=E;g.logOnError=async function(a,b=G.getLogger("esri")){try{return await a}catch(d){p(d)||b.error(d)}};g.onAbort=r;g.onAbortOrThrow=function(a,b){a=q(a);if(null!=a)return w(a),C.once(a,"abort",()=>b(l()))};g.throwIfAbortError=function(a){if(p(a))throw a;};g.throwIfAborted=w;g.throwIfNotAbortError=function(a){if(!p(a))throw a;};g.timeout=function(a,b,d,e){const f=d&&"abort"in d?d:null;null!=e||f||(e=d);let c=setTimeout(()=>{c=0;f&&f.abort()},b);const h=
()=>e||new u("promiseUtils:timeout","The wrapped promise did not resolve within "+b+" ms");return a.then(n=>{if(0===c)throw h();clearTimeout(c);return n},n=>{clearTimeout(c);throw 0===c?h():n;})};g.waitTick=async function(a){await Promise.resolve();w(a)};g.when=z;g.whenOrAbort=function(a,b){return null==q(b)?a:new Promise((d,e)=>{let f=r(b,()=>e(l()));const c=()=>f=v.removeMaybe(f);a.then(c,c);a.then(d,e)})};g.whenOrTimeout=function(a,b,d){return Promise.race([a,y(b).then(()=>{throw new u("timeout",
`Did not resolve within ${b} milliseconds (${d??"timeout"})`);})])};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})});
// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../chunks/_rollupPluginBabelHelpers ./maybe ./nextTick ./PerformanceSampler ./PooledArray ./promiseUtils ./time".split(" "),function(c,r,J,x,y,z,m,e){function A(a){a=new K(a);t.push(a);h.willDispatch||(h.willDispatch=!0,x.nextTick(B));return a}function C(a){a=new L(a);f.push(a);null==n&&(u=performance.now(),n=requestAnimationFrame(D));return new E(a)}function D(){const a=performance.now();n=null;n=0<f.length?requestAnimationFrame(D):null;h.executeFrameTasks(a)}function F(){f.forAll(a=>
{a.removed&&p.push(a)});f.removeUnorderedMany(p.data,p.length);p.clear()}function B(){for(;t.length;){const a=J.assumeNonNull(t.shift());a.isActive&&a.callback()}h.willDispatch=!1}let L=r._createClass(function(a){this.phases=a;this.paused=!1;this.ticks=-1;this.removed=!1}),K=function(){function a(b){this.callback=b;this.isActive=!0}a.prototype.remove=function(){this.isActive=!1};return r._createClass(a)}(),u=0,v=0;const k={time:e.Milliseconds(0),deltaTime:e.Milliseconds(0),elapsedFrameTime:e.Milliseconds(0),
frameDuration:e.Milliseconds(0)},w="prepare preRender render postRender update finish".split(" "),t=[],f=new z;let E=function(){function a(d){this._task=d}var b=a.prototype;b.remove=function(){this._task.removed=!0};b.pause=function(){this._task.paused=!0};b.resume=function(){this._task.paused=!1};return r._createClass(a)}();const h={frameTasks:f,willDispatch:!1,clearFrameTasks:function(a=!1){f.forAll(b=>{b.removed=!0});a&&F()},dispatch:B,executeFrameTasks:function(a){const b=e.Milliseconds(a-u);
u=a;var d=0<v?v:1E3/60;const q=Math.max(0,b-d);k.time=a;k.frameDuration=e.Milliseconds(d-q);for(let l=0;l<w.length;l++){d=performance.now();const G=w[l];f.forAll(g=>{g.paused||g.removed||(0===l&&g.ticks++,g.phases[G]&&(k.elapsedFrameTime=e.Milliseconds(performance.now()-a),k.deltaTime=0===g.ticks?e.Milliseconds(0):b,g.phases[G]?.call(g,k)))});H[l].record(performance.now()-d)}F();I.record(performance.now()-a)}};let n=null;const p=new z,H=w.map(a=>new y(a)),I=new y("total");c.FrameTaskHandle=E;c.addFrameTask=
C;c.debug=h;c.performanceInfo=H;c.performanceTotal=I;c.schedule=A;c.setFrameDuration=function(a){v=Math.max(0,a)};c.waitAnimationFrame=function(){const a=m.createResolver(),b=C({postRender:()=>{b.remove();A(a)}});return a.promise};c.waitTicks=function(a=1,b){const d=m.createResolver(),q=()=>{m.isAborted(b)?d.reject(m.createAbortError()):0===a?d():(--a,x.nextTick(()=>q()))};q();return d.promise};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})});
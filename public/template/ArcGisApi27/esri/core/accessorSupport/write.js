// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../arrayUtils ../Error ../Logger ./PropertyOrigin ./utils ./extensions/serializableProperty".split(" "),function(l,r,t,u,m,k,p){function v(a,e,b,f,d){const c={};e.write?.writer?.call(a,f,c,b,d);return c}function q(a,e,b,f,d,c){if(!f||!f.write)return!1;const h=a.get(b);if(!d&&f.write.overridePolicy){var g=f.write.overridePolicy.call(a,h,b,c??void 0);void 0!==g&&(d=g)}d||(d=f.write);if(!d||!1===d.enabled)return!1;if((null===h&&!d.allowNull&&!d.writerEnsuresNonNull||void 0===h)&&d.isRequired)return(e=
new t("web-document-write:property-required",`Missing value for required property '${b}' on '${a.declaredClass}'`,{propertyName:b,target:a}),c)&&c.messages?c.messages.push(e):e&&!c&&u.getLogger("esri.core.accessorSupport.write").error(e.name,e.message),!1;if(void 0===h||null===h&&!d.allowNull&&!d.writerEnsuresNonNull)return!1;if(g=!d.alwaysWriteDefaults&&(!e.store.multipleOriginsSupported||e.store.originOf(b)===m.OriginId.DEFAULTS))g=f.default,void 0===g?g=!1:null!=f.defaultEquals?g=f.defaultEquals(h):
"function"===typeof g?Array.isArray(h)?(a=g.call(a,b,c??void 0),g=r.equals(a,h)):g=!1:g=g===h;return g||!d.ignoreOrigin&&c&&c.origin&&e.store.multipleOriginsSupported&&e.store.originOf(b)<m.nameToId(c.origin)?!1:!0}l.willPropertyWrite=function(a,e,b,f){const d=k.getProperties(a),c=p.originSpecificWritePropertyDefinition(d.metadatas[e],f);return c?q(a,d,e,c,b,f):!1};l.write=function(a,e,b){if(a&&"function"===typeof a.toJSON&&(!a.toJSON.isDefaultToJSON||!a.write))return k.merge(e,a.toJSON(b));const f=
k.getProperties(a),d=f.metadatas;for(const c in d){const h=p.originSpecificWritePropertyDefinition(d[c],b);if(!q(a,f,c,h,void 0,b))continue;const g=a.get(c),n=v(a,h,h.write&&"string"===typeof h.write.target?h.write.target:c,g,b);0<Object.keys(n).length&&(e=k.merge(e,n),b?.resources?.pendingOperations?.length&&b.resources.pendingOperations.push(Promise.all(b.resources.pendingOperations).then(()=>k.merge(e,n,()=>"replace-arrays"))),b&&b.writtenProperties&&b.writtenProperties.push({target:a,propName:c,
oldOrigin:m.idToReadableName(f.store.originOf(c)),newOrigin:b.origin}))}return e};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})});
// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../request ../../core/has ../../core/jsonMap ../../core/promiseUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ../../rest/networks/support/TraceResult".split(" "),function(k,f,p,l,q,r,h,x,y,t,u,b){l=q.strict()({Pending:"job-waiting",InProgress:"job-executing",Completed:"job-succeeded"});
b=function(c){function d(a){a=c.call(this,a)||this;a.statusUrl=null;a.status=null;a.submissionTime=null;a.lastUpdatedTime=null;a._timer=void 0;return a}k._inherits(d,c);var g=d.prototype;g.destroy=function(){clearInterval(this._timer)};g.checkJobStatus=async function(a){({data:a}=await p(this.statusUrl,{...a,query:{f:"json"}}));this.read(a.traceResults?{...a.traceResults,...a}:a);return this};g.waitForJobCompletion=async function(a={}){const {interval:v=1E3,statusCallback:m}=a;return new Promise((w,
n)=>{this._clearTimer();this._timer=setInterval(()=>{this._timer||n(r.createAbortError());this.checkJobStatus().then(e=>{({status:e}=e);this.status=e;switch(e){case "job-succeeded":this._clearTimer();w(this);break;case "job-waiting":case "job-executing":m&&m(this)}},e=>{this._clearTimer();n(e)})},v)})};g._clearTimer=function(){clearInterval(this._timer);this._timer=void 0};return k._createClass(d)}(b);f.__decorate([h.property({type:String,json:{write:!0}})],b.prototype,"statusUrl",void 0);f.__decorate([t.enumeration(l)],
b.prototype,"status",void 0);f.__decorate([h.property({type:Date,json:{type:Number,write:{writer:(c,d)=>{d.submissionTime=c?c.getTime():null}}}})],b.prototype,"submissionTime",void 0);f.__decorate([h.property({type:Date,json:{type:Number,write:{writer:(c,d)=>{d.lastUpdatedTime=c?c.getTime():null}}}})],b.prototype,"lastUpdatedTime",void 0);return b=f.__decorate([u.subclass("esri.networks.support.TraceJobInfo")],b)});
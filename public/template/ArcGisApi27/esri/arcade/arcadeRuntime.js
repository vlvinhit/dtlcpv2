// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../chunks/_rollupPluginBabelHelpers ./ArcadeModule ./ArcadeModuleLoader ./Dictionary ./executionError ./Feature ./FunctionWrapper ../chunks/languageUtils ./treeAnalysis ../chunks/array ./functions/date ./functions/geometry ./functions/geomsync ./functions/maths ./functions/stats ./functions/string ../geometry/Geometry ../geometry/SpatialReference".split(" "),function(H,I,L,R,x,e,fa,u,f,ha,ia,ja,M,ka,la,ma,na,S,T){function U(b,a){const c=[];for(let d=0;d<a.arguments.length;d++)c.push(l(b,
a.arguments[d]));return c}function r(b,a,c){try{return!0===a.preparsed?c(b,null,a.arguments):c(b,a,U(b,a))}catch(d){throw d;}}function l(b,a){try{switch(a?.type){case "EmptyStatement":return f.voidOperation;case "VariableDeclarator":let A=null===a.init?null:l(b,a.init);A===f.voidOperation&&(A=null);if("Identifier"!==a.id.type)throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.InvalidIdentifier,a);const V=a.id.name.toLowerCase();null!=b.localScope?b.localScope[V]={value:A,valueset:!0,node:a.init}:
b.globalScope[V]={value:A,valueset:!0,node:a.init};return f.voidOperation;case "VariableDeclaration":for(var c=0;c<a.declarations.length;c++)l(b,a.declarations[c]);return f.voidOperation;case "ImportDeclaration":const W=a.specifiers[0].local.name.toLowerCase(),J=b.libraryResolver.loadLibrary(W);c=null;b.libraryResolver._moduleSingletons?.has(J.uri)?c=b.libraryResolver._moduleSingletons.get(J.uri):(c=new B(J),c.loadModule(b),b.libraryResolver._moduleSingletons?.set(J.uri,c));b.globalScope[W]={value:c,
valueset:!0,node:a};return f.voidOperation;case "ExportNamedDeclaration":l(b,a.declaration);if("FunctionDeclaration"===a.declaration.type)b.exports[a.declaration.id.name.toLowerCase()]="function";else if("VariableDeclaration"===a.declaration.type)for(const h of a.declaration.declarations)b.exports[h.id.name.toLowerCase()]="variable";return f.voidOperation;case "BlockStatement":case "Program":a:{let h=f.voidOperation;for(c=0;c<a.body.length;c++)if(h=l(b,a.body[c]),h instanceof f.ReturnResult||h===
f.breakResult||h===f.continueResult){var d=h;break a}d=h}return d;case "FunctionDeclaration":const oa=a.id.name.toLowerCase();b.globalScope[oa]={valueset:!0,node:null,value:new pa(a,b)};return f.voidOperation;case "ReturnStatement":if(null===a.argument)var g=new f.ReturnResult(f.voidOperation);else{var m=l(b,a.argument);g=new f.ReturnResult(m)}return g;case "IfStatement":{const h=l(b,a.test);if(!0===h)var n=l(b,a.consequent);else if(!1===h)n=null!==a.alternate?l(b,a.alternate):f.voidOperation;else throw new e.ArcadeExecutionError(b,
e.ExecutionErrorCodes.BooleanConditionRequired,a);}return n;case "ExpressionStatement":if("AssignmentExpression"===a.expression.type||"UpdateExpression"===a.expression.type)var v=l(b,a.expression);else if("CallExpression"===a.expression.type){const h=l(b,a.expression);v=h===f.voidOperation?f.voidOperation:new f.ImplicitResult(h)}else{var N=l(b,a.expression);v=N===f.voidOperation?f.voidOperation:new f.ImplicitResult(N)}return v;case "AssignmentExpression":c=null;var k="";if("MemberExpression"===a.left.type){c=
l(b,a.left.object);if(!0===a.left.computed)k=l(b,a.left.property);else if("Identifier"===a.left.property.type)k=a.left.property.name;else throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.InvalidIdentifier,a);const h=l(b,a.right);if(f.isArray(c))if(f.isNumber(k)){0>k&&(k=c.length+k);if(0>k||k>c.length)throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.OutOfBounds,a);if(k===c.length&&"\x3d"!==a.operator)throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.OutOfBounds,a);c[k]=w(h,a.operator,
c[k],a,b)}else throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.ArrayAccessorMustBeNumber,a);else if(c instanceof x){if(!1===f.isString(k))throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.KeyAccessorMustBeString,a);if(!0===c.hasField(k))c.setField(k,w(h,a.operator,c.field(k),a,b));else{if("\x3d"!==a.operator)throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.FieldNotFound,a,{key:k});c.setField(k,w(h,a.operator,null,a,b))}}else if(f.isFeature(c)){if(!1===f.isString(k))throw new e.ArcadeExecutionError(b,
e.ExecutionErrorCodes.KeyAccessorMustBeString,a);if(!0===c.hasField(k))c.setField(k,w(h,a.operator,c.field(k),a,b));else{if("\x3d"!==a.operator)throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.FieldNotFound,a,{key:k});c.setField(k,w(h,a.operator,null,a,b))}}else{if(f.isImmutableArray(c))throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.Immutable,a);if(c instanceof B){if(!1===f.isString(k))throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.ModuleAccessorMustBeString,a);if(!0===
c.hasGlobal(k))c.setGlobal(k,w(h,a.operator,c.global(k),a,b));else throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.ModuleExportNotFound,a);}else throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.InvalidIdentifier,a);}var t=f.voidOperation}else{c=a.left.name.toLowerCase();var C=l(b,a.right);if(null!=b.localScope&&void 0!==b.localScope[c])b.localScope[c]={value:w(C,a.operator,b.localScope[c].value,a,b),valueset:!0,node:a.right},t=f.voidOperation;else if(void 0!==b.globalScope[c])b.globalScope[c]=
{value:w(C,a.operator,b.globalScope[c].value,a,b),valueset:!0,node:a.right},t=f.voidOperation;else throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.InvalidIdentifier,a);}return t;case "UpdateExpression":{let h;c=null;k="";if("MemberExpression"===a.argument.type){c=l(b,a.argument.object);!0===a.argument.computed?k=l(b,a.argument.property):"Identifier"===a.argument.property.type&&(k=a.argument.property.name);if(f.isArray(c))if(f.isNumber(k)){0>k&&(k=c.length+k);if(0>k||k>=c.length)throw new e.ArcadeExecutionError(b,
e.ExecutionErrorCodes.OutOfBounds,a);h=f.toNumber(c[k]);c[k]="++"===a.operator?h+1:h-1}else throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.ArrayAccessorMustBeNumber,a);else if(c instanceof x){if(!1===f.isString(k))throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.KeyAccessorMustBeString,a);if(!0===c.hasField(k))h=f.toNumber(c.field(k)),c.setField(k,"++"===a.operator?h+1:h-1);else throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.FieldNotFound,a);}else if(f.isFeature(c)){if(!1===
f.isString(k))throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.KeyAccessorMustBeString,a);if(!0===c.hasField(k))h=f.toNumber(c.field(k)),c.setField(k,"++"===a.operator?h+1:h-1);else throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.FieldNotFound,a);}else{if(f.isImmutableArray(c))throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.Immutable,a);if(c instanceof B){if(!1===f.isString(k))throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.ModuleAccessorMustBeString,a);if(!0===
c.hasGlobal(k))h=f.toNumber(c.global(k)),c.setGlobal(k,"++"===a.operator?h+1:h-1);else throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.ModuleExportNotFound,a);}else throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.InvalidParameter,a);}var y=!1===a.prefix?h:"++"===a.operator?h+1:h-1}else{c="Identifier"===a.argument.type?a.argument.name.toLowerCase():"";if(!c)throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.InvalidIdentifier,a);if(null!=b.localScope&&void 0!==b.localScope[c])h=
f.toNumber(b.localScope[c].value),b.localScope[c]={value:"++"===a.operator?h+1:h-1,valueset:!0,node:a},y=!1===a.prefix?h:"++"===a.operator?h+1:h-1;else if(void 0!==b.globalScope[c])h=f.toNumber(b.globalScope[c].value),b.globalScope[c]={value:"++"===a.operator?h+1:h-1,valueset:!0,node:a},y=!1===a.prefix?h:"++"===a.operator?h+1:h-1;else throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.InvalidIdentifier,a);}}return y;case "BreakStatement":return f.breakResult;case "ContinueStatement":return f.continueResult;
case "TemplateElement":return a.value?a.value.cooked:"";case "TemplateLiteral":C="";y=0;for(const h of a.quasis)if(C+=h.value?h.value.cooked:"",!1===h.tail){if(a.expressions[y]){var K=f;k=K.toString;var q=l(b,a.expressions[y]),D=b;t=a;if(f.isFunctionParameter(q))throw new e.ArcadeExecutionError(D,e.ExecutionErrorCodes.NoFunctionInTemplateLiteral,t);c=k.call(K,q)}else c="";C+=c;y++}return C;case "ForStatement":null!==a.init&&l(b,a.init);D={testResult:!0,lastAction:f.voidOperation};do b:{c=b;k=a;q=
D;if(null!==k.test){q.testResult=l(c,k.test);if(!1===q.testResult)break b;if(!0!==q.testResult)throw new e.ArcadeExecutionError(c,e.ExecutionErrorCodes.BooleanConditionRequired,k);}q.lastAction=l(c,k.body);q.lastAction===f.breakResult?q.testResult=!1:q.lastAction instanceof f.ReturnResult?q.testResult=!1:null!==k.update&&l(c,k.update)}while(!0===D.testResult);K=D.lastAction instanceof f.ReturnResult?D.lastAction:f.voidOperation;return K;case "ForInStatement":return qa(b,a);case "WhileStatement":c=
!0;var F=f.voidOperation;c=l(b,a.test);if(!1===c)var X=f.voidOperation;else{if(!0!==c)throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.BooleanConditionRequired,a);for(;!0===c;){F=l(b,a.body);if(F===f.breakResult)break;if(F instanceof f.ReturnResult)break;c=l(b,a.test);if(!0!==c&&!1!==c)throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.BooleanConditionRequired,a);}X=F instanceof f.ReturnResult?F:f.voidOperation}return X;case "Identifier":return Y(b,a);case "MemberExpression":return ra(b,
a);case "Literal":return a.value;case "CallExpression":a:try{if("MemberExpression"===a.callee.type){const h=l(b,a.callee.object);if(!(h instanceof B))throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.FunctionNotFound,a);const z=!1===a.callee.computed?a.callee.property.name:l(b,a.callee.property);if(!h.hasGlobal(z))throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.FunctionNotFound,a);const E=h.global(z);if(!f.isFunctionParameter(E))throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.CallNonFunction,
a);var O=E.call(b,a)}else{if("Identifier"!==a.callee.type)throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.FunctionNotFound,a);if(null!=b.localScope&&void 0!==b.localScope[a.callee.name.toLowerCase()]){const h=b.localScope[a.callee.name.toLowerCase()];if(f.isFunctionParameter(h.value)){O=h.value.call(b,a);break a}throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.CallNonFunction,a);}if(void 0!==b.globalScope[a.callee.name.toLowerCase()]){const h=b.globalScope[a.callee.name.toLowerCase()];
if(f.isFunctionParameter(h.value)){O=h.value.call(b,a);break a}throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.CallNonFunction,a);}throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.FunctionNotFound,a);}}catch(h){throw h;}return O;case "UnaryExpression":return sa(b,a);case "BinaryExpression":return ta(b,a);case "LogicalExpression":return ua(b,a);case "ArrayExpression":try{c=[];for(k=0;k<a.elements.length;k++){const h=l(b,a.elements[k]);if(f.isFunctionParameter(h))throw new e.ArcadeExecutionError(b,
e.ExecutionErrorCodes.NoFunctionInArray,a);h===f.voidOperation?c.push(null):c.push(h)}var va=c}catch(h){throw h;}return va;case "ObjectExpression":c={};const P=new Map;for(k=0;k<a.properties.length;k++){const h=l(b,a.properties[k]);if(f.isFunctionParameter(h.value))throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.NoFunctionInDictionary,a);if(!1===f.isString(h.key))throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.KeyMustBeString,a);let z=h.key.toString();const E=z.toLowerCase();P.has(E)?
z=P.get(E):P.set(E,z);c[z]=h.value===f.voidOperation?null:h.value}const Z=new x(c);Z.immutable=!1;return Z;case "Property":return{key:"Identifier"===a.key.type?a.key.name:l(b,a.key),value:l(b,a.value)};default:throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.Unrecognised,a);}}catch(A){throw e.ensureArcadeExecutionError(b,a,A);}}function qa(b,a){var c=l(b,a.right);"VariableDeclaration"===a.left.type&&l(b,a.left);let d=null;var g="";if("VariableDeclaration"===a.left.type){var m=a.left.declarations[0].id;
"Identifier"===m.type&&(g=m.name)}else"Identifier"===a.left.type&&(g=a.left.name);if(!g)throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.InvalidIdentifier,a);g=g.toLowerCase();null!=b.localScope&&void 0!==b.localScope[g]&&(d=b.localScope[g]);null===d&&void 0!==b.globalScope[g]&&(d=b.globalScope[g]);if(null===d)throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.InvalidIdentifier,a);if(f.isArray(c)||f.isString(c)){c=c.length;for(g=0;g<c;g++){d.value=g;m=l(b,a.body);if(m===f.breakResult)break;
if(m instanceof f.ReturnResult)return m}return f.voidOperation}if(f.isImmutableArray(c)){for(g=0;g<c.length();g++){d.value=g;m=l(b,a.body);if(m===f.breakResult)break;if(m instanceof f.ReturnResult)return m}return f.voidOperation}if(c instanceof x||f.isFeature(c))for(c=c.keys(),g=0;g<c.length;g++){d.value=c[g];m=l(b,a.body);if(m===f.breakResult)break;if(m instanceof f.ReturnResult)return m}else return f.voidOperation}function w(b,a,c,d,g){switch(a){case "\x3d":return b===f.voidOperation?null:b;case "/\x3d":return f.toNumber(c)/
f.toNumber(b);case "*\x3d":return f.toNumber(c)*f.toNumber(b);case "-\x3d":return f.toNumber(c)-f.toNumber(b);case "+\x3d":return f.isString(c)||f.isString(b)?f.toString(c)+f.toString(b):f.toNumber(c)+f.toNumber(b);case "%\x3d":return f.toNumber(c)%f.toNumber(b);default:throw new e.ArcadeExecutionError(g,e.ExecutionErrorCodes.UnsupportedOperator,d);}}function ra(b,a){try{const c=l(b,a.object);if(null===c)throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.MemberOfNull,a);if(!1===a.computed){if("Identifier"===
a.property.type){if(c instanceof x||f.isFeature(c))return c.field(a.property.name);if(c instanceof S)return M.geometryMember(c,a.property.name,a,b);if(c instanceof B){if(!c.hasGlobal(a.property.name))throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.InvalidIdentifier,a);return c.global(a.property.name)}}throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.InvalidMemberAccessKey,a);}let d=l(b,a.property);if(c instanceof x||f.isFeature(c)){if(f.isString(d))return c.field(d);throw new e.ArcadeExecutionError(b,
e.ExecutionErrorCodes.InvalidMemberAccessKey,a);}if(c instanceof B){if(f.isString(d))return c.global(d);throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.InvalidMemberAccessKey,a);}if(c instanceof S){if(f.isString(d))return M.geometryMember(c,d,a,b);throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.InvalidMemberAccessKey,a);}if(f.isArray(c)){if(f.isNumber(d)&&isFinite(d)&&Math.floor(d)===d){0>d&&(d=c.length+d);if(d>=c.length||0>d)throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.OutOfBounds,
a);return c[d]}throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.InvalidMemberAccessKey,a);}if(f.isString(c)){if(f.isNumber(d)&&isFinite(d)&&Math.floor(d)===d){0>d&&(d=c.length+d);if(d>=c.length||0>d)throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.OutOfBounds,a);return c[d]}throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.InvalidMemberAccessKey,a);}if(f.isImmutableArray(c)&&f.isNumber(d)&&isFinite(d)&&Math.floor(d)===d){0>d&&(d=c.length()+d);if(d>=c.length()||0>d)throw new e.ArcadeExecutionError(b,
e.ExecutionErrorCodes.OutOfBounds,a);return c.get(d)}throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.InvalidMemberAccessKey,a);}catch(c){throw c;}}function sa(b,a){try{const c=l(b,a.argument);if(f.isBoolean(c)){if("!"===a.operator)return!c;if("-"===a.operator)return-1*f.toNumber(c);if("+"===a.operator)return 1*f.toNumber(c);if("~"===a.operator)return~f.toNumber(c);throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.UnsupportedUnaryOperator,a);}if("~"===a.operator)return~f.toNumber(c);
if("-"===a.operator)return-1*f.toNumber(c);if("+"===a.operator)return 1*f.toNumber(c);throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.UnsupportedUnaryOperator,a);}catch(c){throw c;}}function ta(b,a){try{const c=[l(b,a.left),l(b,a.right)],d=c[0],g=c[1];switch(a.operator){case "|":case "\x3c\x3c":case "\x3e\x3e":case "\x3e\x3e\x3e":case "^":case "\x26":return f.binaryOperator(f.toNumber(d),f.toNumber(g),a.operator);case "\x3d\x3d":return f.equalityTest(d,g);case "!\x3d":return!f.equalityTest(d,
g);case "\x3c":return f.greaterThanLessThan(d,g,a.operator);case "\x3e":return f.greaterThanLessThan(d,g,a.operator);case "\x3c\x3d":return f.greaterThanLessThan(d,g,a.operator);case "\x3e\x3d":return f.greaterThanLessThan(d,g,a.operator);case "+":return f.isString(d)||f.isString(g)?f.toString(d)+f.toString(g):f.toNumber(d)+f.toNumber(g);case "-":return f.toNumber(d)-f.toNumber(g);case "*":return f.toNumber(d)*f.toNumber(g);case "/":return f.toNumber(d)/f.toNumber(g);case "%":return f.toNumber(d)%
f.toNumber(g);default:throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.UnsupportedOperator,a);}}catch(c){throw c;}}function ua(b,a){try{const c=l(b,a.left);if(f.isBoolean(c))switch(a.operator){case "||":if(!0===c)return c;const d=l(b,a.right);if(f.isBoolean(d))return d;throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.LogicExpressionOrAnd,a);case "\x26\x26":if(!1===c)return c;const g=l(b,a.right);if(f.isBoolean(g))return g;throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.LogicExpressionOrAnd,
a);default:throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.LogicExpressionOrAnd,a);}throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.LogicalExpressionOnlyBoolean,a);}catch(c){throw c;}}function Y(b,a){let c;try{const d=a.name.toLowerCase();if(null!=b.localScope&&void 0!==b.localScope[d]){c=b.localScope[d];if(!0===c.valueset)return c.value;c.value=l(b,c.node);c.valueset=!0;return c.value}if(void 0!==b.globalScope[d]){c=b.globalScope[d];if(!0===c.valueset)return c.value;c.value=l(b,
c.node);c.valueset=!0;return c.value}throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.InvalidIdentifier,a);}catch(d){throw d;}}function aa(b,a,c,d){try{const g=a.arguments,m=l(b,g[c]);if(f.equalityTest(m,d))return l(b,g[c+1]);const n=g.length-c;return 1===n?l(b,g[c]):2===n?null:3===n?l(b,g[c+2]):aa(b,a,c+2,d)}catch(g){throw g;}}function ba(b,a,c,d){try{const g=a.arguments;if(!0===d)return l(b,g[c+1]);if(3===g.length-c)return l(b,g[c+2]);const m=l(b,g[c+2]);if(!1===f.isBoolean(m))throw new e.ArcadeExecutionError(b,
e.ExecutionErrorCodes.BooleanConditionRequired,g[c+2]);return ba(b,a,c+2,m)}catch(g){throw g;}}function Q(b,a,c,d){try{const g=b.body;if(c.length!==b.params.length)throw new e.ArcadeExecutionError(a,e.ExecutionErrorCodes.WrongNumberOfParameters,d);if(null!=a.localScope)for(let n=0;n<c.length;n++)a.localScope[b.params[n].name.toLowerCase()]={value:c[n],valueset:!0,node:null};const m=l(a,g);if(m instanceof f.ReturnResult)return m.value;if(m===f.breakResult)throw new e.ArcadeExecutionError(a,e.ExecutionErrorCodes.UnexpectedToken,
d);if(m===f.continueResult)throw new e.ArcadeExecutionError(a,e.ExecutionErrorCodes.UnexpectedToken,d);return m instanceof f.ImplicitResult?m.value:m}catch(g){throw g;}}function ca(b,a,c){const d=new G;b||(b={});a||(a={});const g=new x({newline:"\n",tab:"\t",singlequote:"'",doublequote:'"',forwardslash:"/",backwardslash:"\\"});g.immutable=!1;d.textformatting={value:g,valueset:!0,node:null};for(const m in a)d[m]={value:new u.NativeFunction(a[m]),native:!0,valueset:!0,node:null};for(const m in b)d[m]=
b[m]&&"esri.Graphic"===b[m].declaredClass?{value:fa.createFromGraphic(b[m],c),valueset:!0,node:null}:{value:b[m],valueset:!0,node:null};return d}function da(b){console.log(b)}function ea(b){const a={mode:"sync",compiled:!1,functions:{},signatures:[],standardFunction:r,evaluateIdentifier:Y};for(let c=0;c<b.length;c++)b[c].registerFunctions(a);for(const c in a.functions)p[c]={value:new u.NativeFunction(a.functions[c]),valueset:!0,node:null},G.prototype[c]=p[c];for(b=0;b<a.signatures.length;b++)ha.addFunctionDeclaration(a.signatures[b],
"sync")}let pa=function(b){function a(d,g){var m=b.call(this)||this;m.definition=null;m.context=null;m.definition=d;m.context=g;return m}I._inherits(a,b);var c=a.prototype;c.createFunction=function(d){return(...g)=>{const m={spatialReference:this.context.spatialReference,console:this.context.console,services:this.context.services,timeReference:this.context.timeReference??null,lrucache:this.context.lrucache,exports:this.context.exports,libraryResolver:this.context.libraryResolver,interceptor:this.context.interceptor,
localScope:{},depthCounter:{depth:d.depthCounter.depth+1},globalScope:this.context.globalScope};if(64<m.depthCounter.depth)throw new e.ArcadeExecutionError(d,e.ExecutionErrorCodes.MaximumCallDepth,null);return Q(this.definition,m,g,null)}};c.call=function(d,g){return r(d,g,(m,n,v)=>{m={spatialReference:d.spatialReference,services:d.services,globalScope:d.globalScope,depthCounter:{depth:d.depthCounter.depth+1},libraryResolver:d.libraryResolver,exports:d.exports,timeReference:d.timeReference??null,
console:d.console,lrucache:d.lrucache,interceptor:d.interceptor,localScope:{}};if(64<m.depthCounter.depth)throw new e.ArcadeExecutionError(d,e.ExecutionErrorCodes.MaximumCallDepth,g);return Q(this.definition,m,v,g)})};c.marshalledCall=function(d,g,m,n){return n(d,g,(v,N,k)=>{v={spatialReference:d.spatialReference,globalScope:m.globalScope,services:d.services,depthCounter:{depth:d.depthCounter.depth+1},libraryResolver:d.libraryResolver,exports:d.exports,console:d.console,timeReference:d.timeReference??
null,lrucache:d.lrucache,interceptor:d.interceptor,localScope:{}};k=k.map(t=>!f.isFunctionParameter(t)||t instanceof u.ScopeMarshalledFunction?t:u.wrapModuleScopedResponse(t,d,n));return u.wrapModuleScopedResponse(Q(this.definition,v,k,g),m,n)})};return I._createClass(a)}(u.ArcadeFunction),B=function(b){function a(d){return b.call(this,d)||this}I._inherits(a,b);var c=a.prototype;c.global=function(d){d=this.executingContext.globalScope[d.toLowerCase()];d.valueset||(d.value=l(this.executingContext,
d.node),d.valueset=!0);if(f.isFunctionParameter(d.value)&&!(d.value instanceof u.ScopeMarshalledFunction)){const g=new u.ScopeMarshalledFunction;g.fn=d.value;g.parameterEvaluator=r;g.context=this.executingContext;d.value=g}return d.value};c.setGlobal=function(d,g){if(f.isFunctionParameter(g))throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.AssignModuleFunction,null);this.executingContext.globalScope[d.toLowerCase()]={value:g,valueset:!0,node:null}};c.hasGlobal=function(d){void 0===this.executingContext.exports[d]&&
(d=d.toLowerCase());return void 0!==this.executingContext.exports[d]?!0:!1};c.loadModule=function(d){let g=d.spatialReference;if(null===g||void 0===g)g=new T({wkid:102100});this.moduleScope=ca({},d.customfunctions,d.timeReference);this.executingContext={spatialReference:g,globalScope:this.moduleScope,localScope:null,libraryResolver:new R.ArcadeModuleLoader(d.libraryResolver._moduleSingletons,this.source.syntax.loadedModules),exports:{},services:d.services,console:d.console??da,timeReference:d.timeReference??
null,lrucache:d.lrucache,interceptor:d.interceptor,depthCounter:{depth:1}};l(this.executingContext,this.source.syntax)};return I._createClass(a)}(L.ArcadeModule);const p={};ja.registerFunctions(p,r);na.registerFunctions(p,r);la.registerFunctions(p,r);M.registerFunctions(p,r);ma.registerFunctions(p,r);ka.registerFunctions(p,r);p.iif=function(b,a){try{const c=a.arguments;f.pcCheck(null===c?[]:c,3,3,b,a);const d=l(b,c[0]);if(!1===f.isBoolean(d))throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.BooleanConditionRequired,
a);return!0===d?l(b,c[1]):l(b,c[2])}catch(c){throw c;}};p.decode=function(b,a){try{const c=a.arguments;if(2>c.length)throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.WrongNumberOfParameters,a);if(2===c.length)return l(b,c[1]);if(0===(c.length-1)%2)throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.WrongNumberOfParameters,a);const d=l(b,c[0]);return aa(b,a,1,d)}catch(c){throw c;}};p.when=function(b,a){try{const c=a.arguments;if(3>c.length)throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.WrongNumberOfParameters,
a);if(0===c.length%2)throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.WrongNumberOfParameters,a);const d=l(b,c[0]);if(!1===f.isBoolean(d))throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.BooleanConditionRequired,c[0]);return ba(b,a,0,d)}catch(c){throw c;}};for(const b in p)p[b]={value:new u.NativeFunction(p[b]),valueset:!0,node:null};const G=function(){};G.prototype=p;G.prototype.infinity={value:Number.POSITIVE_INFINITY,valueset:!0,node:null};G.prototype.pi={value:Math.PI,valueset:!0,
node:null};L={fixSpatialReference:f.fixSpatialReference,parseArguments:U,standardFunction:r};ea([ia.ArrayFunctions]);H.executeScript=function(b,a){let c=a.spatialReference;if(null===c||void 0===c)c=new T({wkid:102100});let d=null;b.usesModules&&(d=new R.ArcadeModuleLoader(new Map,b.loadedModules));const g=ca(a.vars,a.customfunctions,a.timeReference);a={spatialReference:c,globalScope:g,localScope:null,services:a.services??null,exports:{},libraryResolver:d,console:a.console??da,timeReference:a.timeReference??
null,lrucache:a.lrucache,interceptor:a.interceptor,depthCounter:{depth:1}};b=l(a,b);b instanceof f.ReturnResult&&(b=b.value);b instanceof f.ImplicitResult&&(b=b.value);b===f.voidOperation&&(b=null);if(b===f.breakResult)throw new e.ArcadeExecutionError(a,e.ExecutionErrorCodes.IllegalResult,null);if(b===f.continueResult)throw new e.ArcadeExecutionError(a,e.ExecutionErrorCodes.IllegalResult,null);if(f.isFunctionParameter(b))throw new e.ArcadeExecutionError(a,e.ExecutionErrorCodes.IllegalResult,null);
return b};H.extend=ea;H.functionHelper=L;Object.defineProperty(H,Symbol.toStringTag,{value:"Module"})});
// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../ArcadeDate ../../chunks/languageUtils ../executionError ../../intl/locale ../../chunks/datetime".split(" "),function(p,l,b,q,t,n){function m(g){return null===g?g:!1===g.isValid?null:g}function r(g,h){return""===g||"default"===g.toLowerCase().trim()?b.defaultTimeZone(h):g}const u=[0,31,59,90,120,151,181,212,243,273,304,334],v=[0,31,60,91,121,152,182,213,244,274,305,335];p.registerFunctions=function(g,h){g.today=function(d,e){return h(d,e,(c,f,a)=>{b.pcCheck(a,0,0,d,e);c=new Date;
c.setHours(0,0,0,0);return l.ArcadeDate.dateJSAndZoneToArcadeDate(c,b.defaultTimeZone(d))})};g.changetimezone=function(d,e){return h(d,e,(c,f,a)=>{b.pcCheck(a,2,2,d,e);c=b.toDate(a[0],b.defaultTimeZone(d));if(null===c)return null;a=l.ArcadeDate.arcadeDateAndZoneToArcadeDate(c,r(b.toString(a[1]),d));return!1===a.isValid?null:a})};g.timezone=function(d,e){return h(d,e,(c,f,a)=>{b.pcCheck(a,1,2,d,e);c=b.toDate(a[0],b.defaultTimeZone(d));if(null===c)return null;c=c.timeZone;return"system"===c?l.ArcadeDate.systemTimeZoneCanonicalName:
c})};g.timezoneoffset=function(d,e){return h(d,e,(c,f,a)=>{b.pcCheck(a,1,1,d,e);c=b.toDate(a[0],b.defaultTimeZone(d));return null===c?null:c.timeZoneOffset})};g.now=function(d,e){return h(d,e,(c,f,a)=>{b.pcCheck(a,0,0,d,e);c=l.ArcadeDate.nowToArcadeDate(b.defaultTimeZone(d));return!1===c.isValid?null:c})};g.timestamp=function(d,e){return h(d,e,(c,f,a)=>{b.pcCheck(a,0,0,d,e);c=l.ArcadeDate.nowUTCToArcadeDate();return!1===c.isValid?null:c})};g.toutc=function(d,e){return h(d,e,(c,f,a)=>{b.pcCheck(a,
1,1,d,e);c=b.toDate(a[0],b.defaultTimeZone(d));return null===c?null:c.toUTC()})};g.tolocal=function(d,e){return h(d,e,(c,f,a)=>{b.pcCheck(a,1,1,d,e);c=b.toDate(a[0],b.defaultTimeZone(d));return null===c?null:c.toLocal()})};g.day=function(d,e){return h(d,e,(c,f,a)=>{b.pcCheck(a,1,1,d,e);c=b.toDate(a[0],b.defaultTimeZone(d));return null===c?NaN:c.day})};g.month=function(d,e){return h(d,e,(c,f,a)=>{b.pcCheck(a,1,1,d,e);c=b.toDate(a[0],b.defaultTimeZone(d));return null===c?NaN:c.monthJS})};g.year=function(d,
e){return h(d,e,(c,f,a)=>{b.pcCheck(a,1,1,d,e);c=b.toDate(a[0],b.defaultTimeZone(d));return null===c?NaN:c.year})};g.hour=function(d,e){return h(d,e,(c,f,a)=>{b.pcCheck(a,1,1,d,e);c=b.toDate(a[0],b.defaultTimeZone(d));return null===c?NaN:c.hour})};g.second=function(d,e){return h(d,e,(c,f,a)=>{b.pcCheck(a,1,1,d,e);c=b.toDate(a[0],b.defaultTimeZone(d));return null===c?NaN:c.second})};g.millisecond=function(d,e){return h(d,e,(c,f,a)=>{b.pcCheck(a,1,1,d,e);c=b.toDate(a[0],b.defaultTimeZone(d));return null===
c?NaN:c.millisecond})};g.minute=function(d,e){return h(d,e,(c,f,a)=>{b.pcCheck(a,1,1,d,e);c=b.toDate(a[0],b.defaultTimeZone(d));return null===c?NaN:c.minute})};g.week=function(d,e){return h(d,e,(c,f,a)=>{b.pcCheck(a,1,2,d,e);f=b.toDate(a[0],b.defaultTimeZone(d));if(null===f)return NaN;a=b.toNumber(b.defaultUndefined(a[1],0));if(0>a||6<a)throw new q.ArcadeExecutionError(d,q.ExecutionErrorCodes.InvalidParameter,e);c=f.dayOfWeekJS;var k=f.year;f=f.day+(0!==k%4||0===k%100&&0!==k%400?u:v)[f.monthJS]-1;
k=Math.floor(f/7);return c-a+(0>c-a?7:0)<f-7*k?k+1:k})};g.weekday=function(d,e){return h(d,e,(c,f,a)=>{b.pcCheck(a,1,1,d,e);c=b.toDate(a[0],b.defaultTimeZone(d));return null===c?NaN:c.dayOfWeekJS})};g.isoweekday=function(d,e){return h(d,e,(c,f,a)=>{b.pcCheck(a,1,1,d,e);c=b.toDate(a[0],b.defaultTimeZone(d));return null===c?NaN:c.dayOfWeekISO})};g.isomonth=function(d,e){return h(d,e,(c,f,a)=>{b.pcCheck(a,1,1,d,e);c=b.toDate(a[0],b.defaultTimeZone(d));return null===c?NaN:c.monthISO})};g.isoweek=function(d,
e){return h(d,e,(c,f,a)=>{b.pcCheck(a,1,1,d,e);c=b.toDate(a[0],b.defaultTimeZone(d));return null===c?NaN:c.weekISO})};g.isoyear=function(d,e){return h(d,e,(c,f,a)=>{b.pcCheck(a,1,1,d,e);c=b.toDate(a[0],b.defaultTimeZone(d));return null===c?NaN:c.yearISO})};g.date=function(d,e){return h(d,e,(c,f,a)=>{b.pcCheck(a,0,8,d,e);if(3===a.length)return m(l.ArcadeDate.fromParts(b.toNumber(a[0]),b.toNumber(a[1])+1,b.toNumber(a[2]),0,0,0,0,b.defaultTimeZone(d)));if(4===a.length)return m(l.ArcadeDate.fromParts(b.toNumber(a[0]),
b.toNumber(a[1])+1,b.toNumber(a[2]),b.toNumber(a[3]),0,0,0,b.defaultTimeZone(d)));if(5===a.length)return m(l.ArcadeDate.fromParts(b.toNumber(a[0]),b.toNumber(a[1])+1,b.toNumber(a[2]),b.toNumber(a[3]),b.toNumber(a[4]),0,0,b.defaultTimeZone(d)));if(6===a.length)return m(l.ArcadeDate.fromParts(b.toNumber(a[0]),b.toNumber(a[1])+1,b.toNumber(a[2]),b.toNumber(a[3]),b.toNumber(a[4]),b.toNumber(a[5]),0,b.defaultTimeZone(d)));if(7===a.length)return m(l.ArcadeDate.fromParts(b.toNumber(a[0]),b.toNumber(a[1])+
1,b.toNumber(a[2]),b.toNumber(a[3]),b.toNumber(a[4]),b.toNumber(a[5]),b.toNumber(a[6]),b.defaultTimeZone(d)));if(8===a.length)return m(l.ArcadeDate.fromParts(b.toNumber(a[0]),b.toNumber(a[1])+1,b.toNumber(a[2]),b.toNumber(a[3]),b.toNumber(a[4]),b.toNumber(a[5]),b.toNumber(a[6]),r(b.toString(a[7]),d)));if(2===a.length){c=b.toString(a[1]);if(""===c)return null;c=b.standardiseDateFormat(c);a="X"===c?n.DateTime.fromSeconds(b.toNumber(a[0])):"x"===c?n.DateTime.fromMillis(b.toNumber(a[0])):n.DateTime.fromFormat(b.toString(a[0]),
c,{locale:t.getLocale(),numberingSystem:"latn"});return a.isValid?l.ArcadeDate.dateTimeToArcadeDate(a):null}if(1===a.length){if(b.isString(a[0])){if(""===a[0].replaceAll(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""))return null;if(!0===/^[0-9][0-9][0-9][0-9]$/.test(a[0]))return b.toDate(a[0]+"-01-01",b.defaultTimeZone(d))}c=b.toNumber(a[0]);return!1===isNaN(c)?(a=n.DateTime.fromMillis(c),a.isValid?l.ArcadeDate.dateTimeAndZoneToArcadeDate(a,b.defaultTimeZone(d)):null):b.toDate(a[0],b.defaultTimeZone(d))}return 0===
a.length?l.ArcadeDate.nowToArcadeDate(b.defaultTimeZone(d)):null})};g.datediff=function(d,e){return h(d,e,(c,f,a)=>{b.pcCheck(a,2,4,d,e);c=b.toDate(a[0],b.defaultTimeZone(d));f=b.toDate(a[1],b.defaultTimeZone(d));if(null===c||null===f)return NaN;let k=b.defaultUndefined(a[3],"");""!==k&&null!==k?(k=b.toString(k),c=l.ArcadeDate.arcadeDateAndZoneToArcadeDate(c,k),f=l.ArcadeDate.arcadeDateAndZoneToArcadeDate(f,k)):c.timeZone!==f.timeZone&&(c.isUnknownTimeZone?c=l.ArcadeDate.arcadeDateAndZoneToArcadeDate(c,
f.timeZone):f=l.ArcadeDate.arcadeDateAndZoneToArcadeDate(f,c.timeZone));switch(b.toString(a[2]).toLowerCase()){case "days":case "day":case "d":return c.diff(f,"days");case "months":case "month":return c.diff(f,"months");case "minutes":case "minute":case "m":return"M"===a[2]?c.diff(f,"months"):c.diff(f,"minutes");case "seconds":case "second":case "s":return c.diff(f,"seconds");case "milliseconds":case "millisecond":case "ms":return c.diff(f);case "hours":case "hour":case "h":return c.diff(f,"hours");
case "years":case "year":case "y":return c.diff(f,"years");default:return c.diff(f)}})};g.dateadd=function(d,e){return h(d,e,(c,f,a)=>{b.pcCheck(a,2,3,d,e);c=b.toDate(a[0],b.defaultTimeZone(d));if(null===c)return null;f=b.toNumber(a[1]);if(isNaN(f))return c;let k="milliseconds";switch(b.toString(a[2]).toLowerCase()){case "days":case "day":case "d":k="days";f=b.absRound(f);break;case "months":case "month":k="months";f=b.absRound(f);break;case "minutes":case "minute":case "m":k="M"===a[2]?"months":
"minutes";break;case "seconds":case "second":case "s":k="seconds";break;case "milliseconds":case "millisecond":case "ms":k="milliseconds";break;case "hours":case "hour":case "h":k="hours";break;case "years":case "year":case "y":k="years"}return c.plus({[k]:f})})}};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})});
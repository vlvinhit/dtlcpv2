// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ./index ./dom ./guid ./key ./loadable ./action ./icon ./loader ./popover".split(" "),function(k,f,g,q,r,l,t,u,v,w){function n(){"undefined"!==typeof customElements&&["calcite-action-menu","calcite-action","calcite-icon","calcite-loader","calcite-popover"].forEach(a=>{switch(a){case "calcite-action-menu":customElements.get(a)||customElements.define(a,p);break;case "calcite-action":customElements.get(a)||t.defineCustomElement();break;case "calcite-icon":customElements.get(a)||u.defineCustomElement();
break;case "calcite-loader":customElements.get(a)||v.defineCustomElement();break;case "calcite-popover":customElements.get(a)||w.defineCustomElement()}})}const m={tooltip:"tooltip",trigger:"trigger"},x=["ArrowUp","ArrowDown","End","Home"],p=f.proxyCustomElement(class extends f.H{constructor(){super();this.__registerHost();this.__attachShadow();this.calciteActionMenuOpen=f.createEvent(this,"calciteActionMenuOpen",6);this.actionElements=[];this.guid=`calcite-action-menu-${q.guid()}`;this.menuId=`${this.guid}-menu`;
this.menuButtonId=`${this.guid}-menu-button`;this.connectMenuButtonEl=()=>{const {menuButtonId:a,menuId:b,open:d,label:e}=this,c=this.slottedMenuButtonEl||this.defaultMenuButtonEl;this.menuButtonEl!==c&&(this.disconnectMenuButtonEl(),this.menuButtonEl=c,this.setTooltipReferenceElement(),c&&(c.active=d,c.setAttribute("aria-controls",b),c.setAttribute("aria-expanded",g.toAriaBoolean(d)),c.setAttribute("aria-haspopup","true"),c.id||(c.id=a),c.label||(c.label=e),c.text||(c.text=e),c.addEventListener("pointerdown",
this.menuButtonClick),c.addEventListener("keydown",this.menuButtonKeyDown)))};this.disconnectMenuButtonEl=()=>{const {menuButtonEl:a}=this;a&&(a.removeEventListener("pointerdown",this.menuButtonClick),a.removeEventListener("keydown",this.menuButtonKeyDown))};this.setMenuButtonEl=a=>{this.slottedMenuButtonEl=a.target.assignedElements({flatten:!0}).filter(b=>b?.matches("calcite-action"))[0];this.connectMenuButtonEl()};this.setDefaultMenuButtonEl=a=>{this.defaultMenuButtonEl=a;this.connectMenuButtonEl()};
this.handleCalciteActionClick=()=>{this.open=!1;this.setFocus()};this.menuButtonClick=a=>{g.isPrimaryPointerButton(a)&&this.toggleOpen()};this.updateTooltip=a=>{this.tooltipEl=a.target.assignedElements({flatten:!0}).filter(b=>b?.matches("calcite-tooltip"))[0];this.setTooltipReferenceElement()};this.setTooltipReferenceElement=()=>{const {tooltipEl:a,expanded:b,menuButtonEl:d,open:e}=this;a&&(a.referenceElement=b||e?null:d)};this.updateAction=(a,b)=>{const {guid:d,activeMenuItemIndex:e}=this,c=`${d}-action-${b}`;
a.tabIndex=-1;a.setAttribute("role","menuitem");a.id||(a.id=c);a.active=b===e};this.updateActions=a=>{a?.forEach(this.updateAction)};this.handleDefaultSlotChange=a=>{this.actionElements=a.target.assignedElements({flatten:!0}).filter(b=>b?.matches("calcite-action"))};this.menuButtonKeyDown=a=>{const {key:b}=a,{actionElements:d,activeMenuItemIndex:e,open:c}=this;if(d.length){if(r.isActivationKey(b)){a.preventDefault();if(!c){this.toggleOpen();return}const h=d[e];h?h.click():this.toggleOpen(!1)}"Tab"===
b?this.open=!1:"Escape"===b?(this.toggleOpen(!1),a.preventDefault()):this.handleActionNavigation(a,b,d)}};this.handleActionNavigation=(a,b,d)=>{if(this.isValidKey(b,x))if(a.preventDefault(),this.open){"Home"===b&&(this.activeMenuItemIndex=0);"End"===b&&(this.activeMenuItemIndex=d.length-1);a=this.activeMenuItemIndex;if("ArrowUp"===b){var e=d.length;this.activeMenuItemIndex=(Math.max(a-1,-1)+e)%e}"ArrowDown"===b&&(b=d.length,this.activeMenuItemIndex=(a+1+b)%b)}else{this.toggleOpen();if("Home"===b||
"ArrowDown"===b)this.activeMenuItemIndex=0;if("End"===b||"ArrowUp"===b)this.activeMenuItemIndex=d.length-1}};this.toggleOpenEnd=()=>{this.setFocus();this.el.removeEventListener("calcitePopoverOpen",this.toggleOpenEnd)};this.toggleOpen=(a=!this.open)=>{this.el.addEventListener("calcitePopoverOpen",this.toggleOpenEnd);this.open=a};this.expanded=!1;this.label=this.flipPlacements=void 0;this.open=!1;this.overlayPositioning="absolute";this.placement="auto";this.menuButtonEl=this.scale=void 0;this.activeMenuItemIndex=
-1}componentWillLoad(){l.setUpLoadableComponent(this)}componentDidLoad(){l.setComponentLoaded(this)}disconnectedCallback(){this.disconnectMenuButtonEl()}expandedHandler(){this.open=!1;this.setTooltipReferenceElement()}openHandler(a){this.activeMenuItemIndex=this.open?0:-1;this.menuButtonEl&&(this.menuButtonEl.active=a);this.calciteActionMenuOpen.emit();this.setTooltipReferenceElement()}closeCalciteActionMenuOnClick(a){g.isPrimaryPointerButton(a)&&!a.composedPath().includes(this.el)&&(this.open=!1)}activeMenuItemIndexHandler(){this.updateActions(this.actionElements)}async setFocus(){await l.componentLoaded(this);
g.focusElement(this.menuButtonEl)}renderMenuButton(){const {label:a,scale:b,expanded:d}=this;return f.h("slot",{name:m.trigger,onSlotchange:this.setMenuButtonEl},f.h("calcite-action",{class:"default-trigger",icon:"ellipsis",scale:b,text:a,textEnabled:d,ref:this.setDefaultMenuButtonEl}))}renderMenuItems(){const {actionElements:a,activeMenuItemIndex:b,open:d,menuId:e,menuButtonEl:c,label:h,placement:y,overlayPositioning:z,flipPlacements:A}=this;return f.h("calcite-popover",{flipPlacements:A,focusTrapDisabled:!0,
label:h,offsetDistance:0,open:d,overlayPositioning:z,placement:y,pointerDisabled:!0,referenceElement:c},f.h("div",{"aria-activedescendant":a[b]?.id||null,"aria-labelledby":c?.id,class:"menu",id:e,onClick:this.handleCalciteActionClick,role:"menu",tabIndex:-1},f.h("slot",{onSlotchange:this.handleDefaultSlotChange})))}render(){return f.h(f.Fragment,null,this.renderMenuButton(),this.renderMenuItems(),f.h("slot",{name:m.tooltip,onSlotchange:this.updateTooltip}))}isValidKey(a,b){return!!b.find(d=>d===a)}get el(){return this}static get watchers(){return{expanded:["expandedHandler"],
open:["openHandler"],activeMenuItemIndex:["activeMenuItemIndexHandler"]}}static get style(){return"@keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in-down{0%{opacity:0;transform:translate3D(0, -5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;transform:translate3D(0, 5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-right{0%{opacity:0;transform:translate3D(-5px, 0, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-left{0%{opacity:0;transform:translate3D(5px, 0, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-scale{0%{opacity:0;transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;transform:scale3D(1, 1, 1)}}:root{--calcite-animation-timing:calc(150ms * var(--calcite-internal-duration-factor));--calcite-internal-duration-factor:var(--calcite-duration-factor, 1);--calcite-internal-animation-timing-fast:calc(100ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-medium:calc(200ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-slow:calc(300ms * var(--calcite-internal-duration-factor))}.calcite-animate{opacity:0;animation-fill-mode:both;animation-duration:var(--calcite-animation-timing)}.calcite-animate__in{animation-name:in}.calcite-animate__in-down{animation-name:in-down}.calcite-animate__in-up{animation-name:in-up}.calcite-animate__in-right{animation-name:in-right}.calcite-animate__in-left{animation-name:in-left}.calcite-animate__in-scale{animation-name:in-scale}@media (prefers-reduced-motion: reduce){:root{--calcite-internal-duration-factor:0.01}}:root{--calcite-floating-ui-transition:var(--calcite-animation-timing);--calcite-floating-ui-z-index:var(--calcite-app-z-index-dropdown)}:host([hidden]){display:none}:host{box-sizing:border-box;display:flex;flex-direction:column;background-color:var(--calcite-ui-foreground-1);font-size:var(--calcite-font-size-1);color:var(--calcite-ui-text-2)}.menu ::slotted(calcite-action){margin:0.125rem;display:flex;outline-color:transparent}.menu ::slotted(calcite-action[active]){outline:2px solid var(--calcite-ui-focus-color, var(--calcite-ui-brand));outline-offset:calc(\n            2px *\n            calc(\n              1 -\n              2 * clamp(\n                0,\n                var(--calcite-ui-focus-offset-invert),\n                1\n              )\n            )\n          );outline-offset:0px}.default-trigger{position:relative;block-size:100%;flex:0 1 auto;align-self:stretch}slot[name\x3dtrigger]::slotted(calcite-action),calcite-action::slotted([slot\x3dtrigger]){position:relative;block-size:100%;flex:0 1 auto;align-self:stretch}.menu{flex-direction:column;flex-wrap:nowrap;outline:2px solid transparent;outline-offset:2px}"}},
[1,"calcite-action-menu",{expanded:[516],flipPlacements:[16],label:[1],open:[1540],overlayPositioning:[513,"overlay-positioning"],placement:[513],scale:[513],menuButtonEl:[32],activeMenuItemIndex:[32],setFocus:[64]},[[9,"pointerdown","closeCalciteActionMenuOnClick"]]]);n();k.ActionMenu=p;k.SLOTS=m;k.defineCustomElement=n});
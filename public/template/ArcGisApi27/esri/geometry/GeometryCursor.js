// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../chunks/_rollupPluginBabelHelpers ../core/lang ./geometryCursorCollectUtils ./support/jsonUtils ../layers/graphics/OptimizedGeometry".split(" "),function(u,k,v,z,m,p){function w(c){if(m.isPolygon(c))c=[c.rings,"esriGeometryPolygon"];else if(m.isPolyline(c))c=[c.paths,"esriGeometryPolyline"];else if(m.isMultipoint(c))c=[[c.points],"esriGeometryMultipoint"];else if(m.isExtent(c))c=[[[[c.xmin,c.ymin],[c.xmin,c.ymax],[c.xmax,c.ymax],[c.xmax,c.ymin],[c.xmin,c.ymin]]],"esriGeometryEnvelope"];
else if(m.isPoint(c)){const f=[c.x,c.y];c.z&&f.push(c.z);c.m&&f.push(c.m);c=[[[f]],"esriGeometryPoint"]}else c=[[],"esriGeometryPolyline"];return c}let t=function(){function c(){}c.fromOptimized=function(b,a,d=!1,e=!1){return(new q).initialize(b,a,d,e,1)};c.fromJSON=function(b,a=!1,d=!1){const [e,g]=w(b);return(new r).initialize(e,g,a,d,1)};c.fromOptimizedCIM=function(b,a,d=!1,e=!1){return(new x).initialize(b,a,d,e,1)};c.fromJSONCIM=function(b,a=!1,d=!1){const [e,g]=w(b);return(new y).initialize(e,
g,a,d,1)};c.fromFeatureSetReader=function(b){const a=b.readGeometryForDisplay();b=b.geometryType;return a&&b?this.fromOptimized(a,b):null};c.fromFeatureSetReaderCIM=function(b){const a=b.readGeometryForDisplay();b=b.geometryType;return a&&b?this.fromOptimizedCIM(a,b):null};c.createEmptyOptimized=function(b,a=!1,d=!1){return(new q).initialize(new p,b,a,d,1)};c.createEmptyJSON=function(b,a=!1,d=!1){return(new r).initialize([],b,a,d,1)};c.createEmptyOptimizedCIM=function(b,a=!1,d=!1){return(new x).initialize(new p,
b,a,d,1)};c.createEmptyJSONCIM=function(b,a=!1,d=!1){return(new y).initialize([],b,a,d,1)};var f=c.prototype;f.asJSON=function(){const b=z.collectMultipath(this);return"esriGeometryEnvelope"===this.geometryType?{xmin:b[0][0][0],ymin:b[0][0][1],xmax:b[0][2][0],ymax:b[0][2][1]}:"esriGeometryMultipoint"===this.geometryType?{points:b.flat()}:"esriGeometryPoint"===this.geometryType?{x:b[0][0][0],y:b[0][0][1]}:"esriGeometryPolygon"===this.geometryType?{rings:b}:{paths:b}};f.invertY=function(){this.yFactor*=
-1};return k._createClass(c)}(),q=function(c){function f(){var a=c.apply(this,arguments)||this;a._end=-1;return a}k._inherits(f,c);var b=f.prototype;b.initialize=function(a,d,e,g,h){this.hasZ=e;this.hasM=g;this.geometryType=d;this._stride=2+Number(e)+Number(g);this._geometry=a;this._pathIndex=-1;this._pathOffset=0;this._pointOffset=-this._stride;this._end=-1;this.yFactor=h;return this};b.reset=function(){this.initialize(this._geometry,this.geometryType,this.hasZ,this.hasM,this.yFactor)};b.seekPathStart=
function(){this._pointOffset=this._pathOffset-this._stride};b.seekPathEnd=function(){this._pointOffset=this._end};b.seekInPath=function(a){a=this._pathOffset+a*this._stride;return 0<=a&&a<this._end?(this._pointOffset=a,!0):!1};b.nextPoint=function(){return(this._pointOffset+=this._stride)<this._end};b.prevPoint=function(){return(this._pointOffset-=this._stride)>=this._pathOffset};b.nextPath=function(){0<=this._pathIndex&&(this._pathOffset+=this._stride*(this._geometry.isPoint?1:this._geometry.lengths[this._pathIndex]));
this._pointOffset=this._pathOffset-this._stride;this._end=this._pointOffset+this._stride+this._stride*(this._geometry.isPoint?1:this._geometry.lengths[this._pathIndex+1]);return++this._pathIndex<this.numPaths};b.pathLength=function(){const a=this._end,d=this._stride,e=this._geometry.coords;let g=0;for(let h=this._pathOffset+d;h<a;h+=d){const l=e[h]-e[h-d],n=e[h+1]-e[h-d+1];g+=Math.sqrt(l*l+n*n)}return g};b.startPath=function(){this._geometry.lengths.push(0)};b.pushPath=function(a){this.startPath();
this.pushPoints(a)};b.pushPoint=function(a){for(let d=0;d<this._stride;++d)this._geometry.coords.push(a[d]);this._geometry.lengths[this.numPaths-1]++};b.pushXY=function(a,d){this._geometry.coords.push(a,d);this._geometry.lengths[this.numPaths-1]++};b.pushPoints=function(a){for(const d of a)for(let e=0;e<this._stride;++e)this._geometry.coords.push(d[e]);this._geometry.lengths[this.numPaths-1]+=a.length};b.asOptimized=function(){const a=this._geometry.clone();if(1!==this.yFactor)for(let d=1;d<a.coords.length;d+=
this._stride)a.coords[d]*=this.yFactor;"esriGeometryPoint"===this.geometryType&&(a.lengths.length=0);return a};b.isClosed=function(){const a=this._geometry.coords,d=this._pathOffset,e=this._end-this._stride;for(let g=0;g<this._stride;g++)if(a[d+g]!==a[e+g])return!1;return!0};b.clone=function(){return(new f).initialize(this._geometry.clone(),this.geometryType,this.hasZ,this.hasM,this.yFactor)};k._createClass(f,[{key:"numPoints",get:function(){const {lengths:a}=this._geometry;return 0>this._pathIndex||
this._pathIndex>a.length-1?0:a[this._pathIndex]}},{key:"numPaths",get:function(){return this._geometry.lengths.length}},{key:"x",get:function(){return this._geometry.coords[this._pointOffset]},set:function(a){this._geometry.coords[this._pointOffset]=a}},{key:"y",get:function(){return this.yFactor*this._geometry.coords[this._pointOffset+1]},set:function(a){this._geometry.coords[this._pointOffset+1]=this.yFactor*a}},{key:"z",get:function(){return this._geometry.coords[this._pointOffset+2]},set:function(a){this._geometry.coords[this._pointOffset+
2]=a}},{key:"m",get:function(){return this._geometry.coords[this._pointOffset+(this.hasZ?3:2)]},set:function(a){this._geometry.coords[this._pointOffset+3]=a}},{key:"pathIndex",get:function(){return this._pathIndex}},{key:"pointIndex",get:function(){return this._pointOffset/this._stride}}]);return f}(t),r=function(c){function f(){return c.apply(this,arguments)||this}k._inherits(f,c);var b=f.prototype;b.initialize=function(a,d,e,g,h){this._paths=a;this.geometryType=d;this.hasZ=e;this.hasM=g;this._pathIndex=
this._pointIndex=-1;this.yFactor=h;this._mIdx=this.hasZ?3:2;return this};b.reset=function(){this._pathIndex=this._pointIndex=-1};b.seekPathStart=function(){this._pointIndex=-1};b.seekPathEnd=function(){this._pointIndex=this._currentPath.length};b.seekInPath=function(a){return 0<=a&&a<this._currentPath.length?(this._pointIndex=a,this._currentPoint=this._currentPath[this._pointIndex],!0):!1};b.nextPoint=function(){this._currentPoint=this._currentPath[++this._pointIndex];return this._pointIndex<this._currentPath.length};
b.prevPoint=function(){this._currentPoint=this._currentPath[--this._pointIndex];return 0<=this._pointIndex};b.nextPath=function(){this._pointIndex=-1;this._currentPath=this._paths[++this._pathIndex];return this._pathIndex<this.numPaths};b.pathLength=function(){const a=this._currentPath.length,d=this._currentPath;let e=0;for(let h=1;h<a;h++){var g=d[h-1];const l=d[h],n=l[0]-g[0];g=l[1]-g[1];e+=Math.sqrt(n*n+g*g)}return e};b.startPath=function(){this._paths.push([])};b.pushPath=function(a){this._paths.push(a)};
b.pushPoint=function(a){this._paths[this.pathIndex].push(a)};b.pushXY=function(a,d){this._paths[this.pathIndex].push([a,d])};b.pushPoints=function(a){this._paths[this.pathIndex].push(...a)};b.asOptimized=function(){const a=new p;if("esriGeometryPoint"===this.geometryType)a.coords.push(...this._paths[0][0]),a.lengths.length=0;else for(const d of this._paths){for(const e of d)a.coords.push(e[0]),a.coords.push(e[1]*this.yFactor),this.hasZ&&a.coords.push(e[2]),this.hasM&&a.coords.push(e[this._mIdx]);
a.lengths.push(d.length)}return a};b.isClosed=function(){const a=this._currentPath[0],d=this._currentPath[this._currentPath.length-1];for(let e=0;e<a.length;e++)if(a[e]!==d[e])return!1;return!0};b.clone=function(){return(new f).initialize(v.clone(this._paths),this.geometryType,this.hasZ,this.hasM,this.yFactor)};k._createClass(f,[{key:"numPoints",get:function(){return 0>this._pathIndex||this._pathIndex>this.numPaths-1?-1:this._paths[this._pathIndex].length}},{key:"numPaths",get:function(){return this._paths.length}},
{key:"x",get:function(){return this._currentPoint[0]},set:function(a){this._currentPoint[0]=a}},{key:"y",get:function(){return this.yFactor*this._currentPoint[1]},set:function(a){this._currentPoint[1]=this.yFactor*a}},{key:"z",get:function(){return this._currentPoint[2]},set:function(a){this._currentPoint[2]=a}},{key:"m",get:function(){return this._currentPoint[this._mIdx]},set:function(a){this._currentPoint[this._mIdx]=a}},{key:"pathIndex",get:function(){return this._pathIndex}},{key:"pointIndex",
get:function(){return this._pointIndex}}]);return f}(t),x=function(c){function f(){return c.apply(this,arguments)||this}k._inherits(f,c);var b=f.prototype;b.initialize=function(a,d,e,g,h){k._get(k._getPrototypeOf(f.prototype),"initialize",this).call(this,a,d,e,g,h);this._controlPoints||(this._controlPoints=this._controlPoints=Array(this.numPaths).fill(void 0).map(l=>new Set));return this};b.startPath=function(){k._get(k._getPrototypeOf(f.prototype),"startPath",this).call(this);this._controlPoints.push(new Set)};
b.clone=function(){const a=(new f).initialize(this._geometry.clone(),this.geometryType,this.hasZ,this.hasM,this.yFactor);a._controlPoints=this._controlPoints;return a};b.setControlPoint=function(){this._controlPoints[this.pathIndex].add(this.pointIndex)};b.getControlPoint=function(){return this._controlPoints[this.pathIndex].has(this.pointIndex)};b.setControlPointAt=function(a){this._controlPoints[this.pathIndex].add(a)};b.getControlPointAt=function(a){return this._controlPoints[this.pathIndex].has(a)};
return k._createClass(f)}(q),y=function(c){function f(){return c.apply(this,arguments)||this}k._inherits(f,c);var b=f.prototype;b.initialize=function(a,d,e,g,h){return k._get(k._getPrototypeOf(f.prototype),"initialize",this).call(this,a,d,e,g,h)};b.clone=function(){return(new f).initialize(v.clone(this._paths),this.geometryType,this.hasZ,this.hasM,1)};b.setControlPoint=function(){this._paths[this.pathIndex][this.pointIndex][4]=1};b.getControlPoint=function(){return 1===this._paths[this.pathIndex][this.pointIndex][4]};
b.setControlPointAt=function(a){this._paths[this.pathIndex][a][4]=1};b.getControlPointAt=function(a){return 1===this._paths[this.pathIndex][a][4]};return k._createClass(f)}(r);u.GeometryCursor=t;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})});
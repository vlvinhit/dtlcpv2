// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../core/Logger ../../../chunks/mat3 ../../../chunks/mat3f64 ../../../chunks/mat4 ../../../chunks/mat4f64 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../projection ../../spatialReferenceEllipsoidUtils ../axisAngleDegrees ../MeshTransform ./geographicUtils ./projection".split(" "),function(A,E,F,G,H,I,l,t,x,J,h,K,B,m){function n(a,c,b,y=t.ZEROS){if(null!=a)for(H.fromRotation(z,h.angleRad(c),h.axis(c)),c=0;c<a.length;c+=b){for(var d=0;3>d;d++)p[d]=a[c+d]-y[d];l.transformMat4(p,
p,z);for(d=0;3>d;d++)a[c+d]=p[d]+y[d]}}const p=t.create(),C=t.create(),u=h.create(),z=I.create(),D=G.create(),f=t.create();A.rotate=function(a,c,b){if(a.vertexAttributes&&a.vertexAttributes.position&&0!==c[3]){var {spatialReference:y,vertexSpace:d}=a;if(d.isRelative){B.validateGeographicFlag(d,"esri.geometry.support.meshUtils.rotate",b);b=b?.origin??a.origin;a.transform??(a.transform=new K);a=a.transform;var e=d.origin;b=l.set(p,b.x,b.y,b.z??0);b=l.subtract(p,b,e);a.applyLocalInverse(b,C);a.rotation=
h.compose(a.rotation,c,h.create());a.applyLocalInverse(b,b);l.subtract(b,b,C);a.translation=l.add(t.create(),a.translation,b)}else{e=b?.origin??a.origin;if(B.isGeographicMesh(y,b)){var g=e;b=a.spatialReference;e=J.getSphericalPCPF(b);x.projectPointToVector(g,f,e)||x.projectPointToVector(a.origin,f,e);g=a.vertexAttributes.position;const q=a.vertexAttributes.normal,r=a.vertexAttributes.tangent,k=new Float64Array(g.length),v=null!=q?new Float32Array(q.length):null,w=null!=r?new Float32Array(r.length):
null;x.computeTranslationToOriginAndRotation(e,f,z,e);F.fromMat4(D,z);l.transformMat3(h.axis(u),h.axis(c),D);u[3]=c[3];m.projectToPCPF(g,b,k);null!=q&&null!=v&&m.projectNormalToPCPF(q,g,k,b,v);null!=r&&null!=w&&m.projectTangentToPCPF(r,g,k,b,w);n(k,u,3,f);m.projectFromPCPF(k,g,b);null!=q&&null!=v&&(n(v,u,3),m.projectNormalFromPCPF(v,g,k,b,q));null!=r&&null!=w&&(n(w,u,4),m.projectTangentFromPCPF(w,g,k,b,r))}else b=e,x.projectPointToVector(b,f,a.spatialReference)||(e=a.origin,f[0]=e.x,f[1]=e.y,f[2]=
e.z,E.getLogger("esri.geometry.support.meshUtils.rotate").error(`Failed to project specified origin (wkid:${b.spatialReference.wkid}) to mesh spatial reference (wkid:${a.spatialReference.wkid}). `+"Projection may be possible after calling projection.load().")),n(a.vertexAttributes.position,c,3,f),n(a.vertexAttributes.normal,c,3),n(a.vertexAttributes.tangent,c,4);a.vertexAttributesChanged()}}};Object.defineProperty(A,Symbol.toStringTag,{value:"Module"})});
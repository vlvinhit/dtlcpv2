// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/promiseUtils ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./Measurement/MeasurementViewModel ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory".split(" "),function(p,v,c,x,u,e,b,C,D,y,z,w,E,A,B){const r=q=>Object.freeze(Object.defineProperty({__proto__:null,
default:q},Symbol.toStringTag,{value:"Module"}));b=function(q){function t(a,f){a=q.call(this,a,f)||this;a._widgets=new Map;a.activeWidget=null;a.iconClass="esri-icon-measure";a.icon=null;a.messages=null;a.viewModel=new w;return a}v._inherits(t,q);var g=t.prototype;g.initialize=function(){this.activeWidget&&this.viewModel.set("activeViewModel",this.activeWidget.viewModel);this.view&&this.activeTool&&this._getActiveWidget().then(a=>{this._set("activeWidget",a)});this.addHandles([u.watch(()=>[this.view,
this.activeTool],async()=>{this._set("activeWidget",await this._getActiveWidget())}),u.watch(()=>this.activeWidget,(a,f)=>{this.viewModel.set("activeViewModel",a?a.viewModel:null);f&&(f.visible=!1)}),u.watch(()=>[this.areaUnit,this.linearUnit,this.uiStrings],()=>this._updateSubWidgetProperties())])};g.destroy=function(){this._destroyWidgets()};g.render=function(){var {activeWidget:a}=this;a=a&&!a.destroyed?a.render():null;return B.tsx("div",{class:"esri-measurement"},a)};g.clear=function(){this.activeTool=
null;this._destroyWidgets()};g.startMeasurement=function(){const {activeViewModel:a}=this.viewModel;a&&x.ignoreAbortErrors(a.start())};g._createWidget=async function(a){const {areaUnit:f,linearUnit:d,view:h}=this;if(!h)return null;switch(a){case "area":var {type:n}=h;switch(n){case "2d":return new (await new Promise((k,l)=>p(["./AreaMeasurement2D"],m=>k(r(m)),l))).default({view:h,unit:f,uiStrings:this._createUIStringsForWidget(a)});case "3d":return new (await new Promise((k,l)=>p(["./AreaMeasurement3D"],
m=>k(r(m)),l))).default({view:h,unit:f,uiStrings:this._createUIStringsForWidget(a)});default:return null}case "distance":switch({type:n}=h,n){case "2d":return new (await new Promise((k,l)=>p(["./DistanceMeasurement2D"],m=>k(r(m)),l))).default({view:h,unit:d,uiStrings:this._createUIStringsForWidget(a)});default:return null}case "direct-line":switch({type:n}=h,n){case "3d":return new (await new Promise((k,l)=>p(["./DirectLineMeasurement3D"],m=>k(r(m)),l))).default({view:h,unit:d,uiStrings:this._createUIStringsForWidget(a)});
default:return null}default:return null}};g._destroyWidgets=function(){this._widgets.forEach(a=>a.destroy());this._widgets.clear()};g._getActiveWidget=async function(){const {activeTool:a,view:f}=this;if(!f||!a)return null;let d=null;if(this._widgets.has(a))d=this._widgets.get(a),d.visible=!0;else{d=await this._createWidget(a);if(!d)return null;await d.viewModel.start();this._widgets.set(a,d)}return d};g._createUIStringsForWidget=function(a){if(this.uiStrings)return this.uiStrings[a+"-"+this.view?.type]};
g._updateSubWidgetProperties=function(){this._widgets.forEach((a,f)=>{const {areaUnit:d,linearUnit:h}=this;a.unit="esri.widgets.AreaMeasurement2D"===a?.declaredClass||"esri.widgets.AreaMeasurement3D"===a?.declaredClass?d:h;a.uiStrings=this._createUIStringsForWidget(f)})};v._createClass(t,[{key:"activeTool",get:function(){return this.viewModel.activeTool},set:function(a){this.viewModel.activeTool=a}},{key:"areaUnit",get:function(){return this.viewModel.areaUnit},set:function(a){this.viewModel.areaUnit=
a}},{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(a){this._overrideIfSome("label",a)}},{key:"linearUnit",get:function(){return this.viewModel.linearUnit},set:function(a){this.viewModel.linearUnit=a}},{key:"view",get:function(){return this.viewModel.view},set:function(a){this.viewModel.view=a}}]);return t}(z);c.__decorate([e.property()],b.prototype,"activeTool",null);c.__decorate([e.property({readOnly:!0})],b.prototype,"activeWidget",void 0);c.__decorate([e.property()],
b.prototype,"areaUnit",null);c.__decorate([e.property()],b.prototype,"iconClass",void 0);c.__decorate([e.property()],b.prototype,"icon",void 0);c.__decorate([e.property()],b.prototype,"label",null);c.__decorate([e.property()],b.prototype,"linearUnit",null);c.__decorate([e.property(),A.messageBundle("esri/widgets/Measurement/t9n/Measurement")],b.prototype,"messages",void 0);c.__decorate([e.property()],b.prototype,"uiStrings",void 0);c.__decorate([e.property()],b.prototype,"view",null);c.__decorate([e.property({type:w})],
b.prototype,"viewModel",void 0);return b=c.__decorate([y.subclass("esri.widgets.Measurement")],b)});
// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/asyncUtils ../../core/Handles ../../core/handleUtils ../../core/maybe ../../core/reactiveUtils ../../core/screenUtils ../../core/throttle ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),function(d,q,e,v,w,x,y,p,r,t,u,f,C,D,E,z){var g;(function(k){k.PointerMove=
"pointer-move";k.Main="main"})(g||(g={}));d.ShadowTooltipViewModel=function(k){function m(b){var a=k.call(this,b)||this;a._handles=new x;a._screenPoint=null;a._accumulatedShadowTime=null;a._shadowTimeTask=null;a._updateAccumulatedShadowTime=(l,h)=>{a._shadowTimeTask=p.abortMaybe(a._shadowTimeTask);a._shadowTimeTask=w.createTask(async c=>{const {results:A,ground:B}=await l.hitTest(h);0!==A.length||B.mapPoint?(c=await a.getDuration(h,c),a._accumulatedShadowTime=c):a._accumulatedShadowTime=null})};a._throttledUpdateAccumulatedShadowTime=
u.throttle(a._updateAccumulatedShadowTime,300);return a}q._inherits(m,k);var n=m.prototype;n.initialize=function(){this._handles.add(r.watch(()=>({enabled:this.enabled,view:this.view}),({enabled:b,view:a})=>{b&&null!=a?this._startTracking(a):this._stopTracking()},r.syncAndInitial))};n.destroy=function(){this._handles=p.destroyMaybe(this._handles)};n._startTracking=function(b){const a=this._handles;if(!a.has(g.Main)){var l=()=>{a.has(g.PointerMove)||a.add(b.on("pointer-move",c=>{this._screenPoint=
c=t.createScreenPoint(c.x,c.y);this._throttledUpdateAccumulatedShadowTime(b,c)}),g.PointerMove)},h=()=>{a.remove(g.PointerMove);this._accumulatedShadowTime=this._screenPoint=null};a.add([this._throttledUpdateAccumulatedShadowTime,b.on("pointer-enter",l),b.on("pointer-leave",h),b.on("pointer-down",h),b.on("pointer-drag",h),b.on("pointer-up",l),b.on("click",c=>{this._screenPoint=c=t.createScreenPoint(c.x,c.y);this._updateAccumulatedShadowTime(b,c)}),y.makeHandle(()=>{this._shadowTimeTask=p.abortMaybe(this._shadowTimeTask)})],
g.Main);l()}};n._stopTracking=function(){this._handles.remove(g.Main)};q._createClass(m,[{key:"screenPoint",get:function(){return this.enabled?this._screenPoint:null}},{key:"accumulatedShadowTime",get:function(){return this.enabled?this._accumulatedShadowTime:null}},{key:"testData",get:function(){return{setThrottleDelay:b=>{this._throttledUpdateAccumulatedShadowTime.remove();this._throttledUpdateAccumulatedShadowTime=u.throttle(this._updateAccumulatedShadowTime,b)}}}}]);return m}(v);e.__decorate([f.property()],
d.ShadowTooltipViewModel.prototype,"getDuration",void 0);e.__decorate([f.property()],d.ShadowTooltipViewModel.prototype,"view",void 0);e.__decorate([f.property()],d.ShadowTooltipViewModel.prototype,"enabled",void 0);e.__decorate([f.property()],d.ShadowTooltipViewModel.prototype,"screenPoint",null);e.__decorate([f.property()],d.ShadowTooltipViewModel.prototype,"accumulatedShadowTime",null);e.__decorate([f.property()],d.ShadowTooltipViewModel.prototype,"_screenPoint",void 0);e.__decorate([f.property()],
d.ShadowTooltipViewModel.prototype,"_accumulatedShadowTime",void 0);e.__decorate([f.property()],d.ShadowTooltipViewModel.prototype,"_shadowTimeTask",void 0);d.ShadowTooltipViewModel=e.__decorate([z.subclass("esri.widgets.ShadowCast.ShadowTooltipViewModel")],d.ShadowTooltipViewModel);Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})});
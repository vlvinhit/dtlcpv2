// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Collection ../../core/Evented ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../LayerList/support/layerListUtils ./ListItem".split(" "),function(m,g,e,t,h,k,x,y,z,u,v,n){const p=e.ofType(n);e=function(q){function l(a){a=q.call(this,a)||this;a.checkPublishStatusEnabled=!1;a.listItemCreatedFunction=
null;a.tableItems=new p;a.map=null;return a}m._inherits(l,q);var c=l.prototype;c.initialize=function(){this.addHandles([h.watch(()=>[this.map,this.map?.loaded],()=>this._mapHandles(),h.initial),h.watch(()=>[this.listItemCreatedFunction,this.checkPublishStatusEnabled],()=>this._recompileList())],"map")};c.destroy=function(){this.removeAllHandles();this.map=null;this.tableItems.removeAll()};c.triggerAction=function(a,b){a&&!a.disabled&&this.emit("trigger-action",{action:a,item:b})};c._mapHandles=function(){const {map:a}=
this;this.removeHandles("tables");this._compileList();a&&this.addHandles(h.watch(()=>this.map?.allTables?.toArray(),()=>this._compileList(),h.initial),"tables")};c._removeAllItems=function(){this.tableItems.removeAll()};c._getViewableTables=function(a){if(a)return a.filter(b=>"hide"!==v.findLayerListMode(b))};c._watchTablesListMode=function(a){this.removeHandles("layer-list-mode");a&&a.forEach(b=>{this.addHandles(h.watch(()=>b.listMode,()=>this._compileList()),"layer-list-mode")})};c._compileList=
function(){var a=this.map?.tables;this._watchTablesListMode(a);(a=this._getViewableTables(a))&&a.length?(this._createNewItems(a),this._removeItems(a),this._sortItems(a)):this._removeAllItems()};c._createNewItems=function(a){const {tableItems:b,listItemCreatedFunction:d,checkPublishStatusEnabled:f}=this;a.forEach(r=>{b.find(w=>w.layer===r)||b.add(new n({checkPublishStatusEnabled:f,layer:r,listItemCreatedFunction:d}))})};c._removeItems=function(a){const {tableItems:b}=this;b.forEach(d=>{d&&(a&&a.find(f=>
d.layer===f)||b.remove(d))})};c._sortItems=function(a){const {tableItems:b}=this;b.sort((d,f)=>{d=a.indexOf(d.layer);f=a.indexOf(f.layer);return d>f?-1:d<f?1:0})};c._recompileList=function(){this._removeAllItems();this._compileList()};m._createClass(l,[{key:"state",get:function(){const a=this.map?.loadStatus;return"string"===typeof a?"loaded"===a?"ready":"loading"===a?"loading":"disabled":"disabled"}}]);return l}(t.EventedAccessor);g.__decorate([k.property()],e.prototype,"checkPublishStatusEnabled",
void 0);g.__decorate([k.property()],e.prototype,"listItemCreatedFunction",void 0);g.__decorate([k.property({type:p,readOnly:!0})],e.prototype,"tableItems",void 0);g.__decorate([k.property()],e.prototype,"map",void 0);g.__decorate([k.property({readOnly:!0})],e.prototype,"state",null);return e=g.__decorate([u.subclass("esri.widgets.TableList.TableListViewModel")],e)});
// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../intl ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../Widget ./ClassicCSS ./support/relationshipUtils ./support/univariateUtils ../support/styleUtils ../../support/Heading ../../support/widgetUtils ../../support/decorators/messageBundle ../../support/jsxFactory ../../../intl/number".split(" "),
function(D,x,v,z,P,Q,R,G,H,b,I,q,p,J,S,K,c,L){const M=`${b.LEGEND}__`,E={display:"flex",alignItems:"flex-start"},A={marginLeft:"3px"},w={display:"table-cell",verticalAlign:"middle"};v=function(F){function B(a,d){a=F.call(this,a,d)||this;a.activeLayerInfos=null;a.headingLevel=3;a.messages=null;a.type="classic";return a}D._inherits(B,F);var r=B.prototype;r.render=function(){var a=this.activeLayerInfos;a=a&&a.toArray().map(d=>this._renderLegendForLayer(d)).filter(d=>!!d);return c.tsx("div",null,a&&a.length?
a:c.tsx("div",{class:b.CSS.message},this.messages.noLegend))};r._renderLegendForLayer=function(a){if(!a.ready)return null;var d=!!a.children.length;const e=`${M}${a.layer.uid}-version-${a.version}`,g=a.title?J.Heading({level:this.headingLevel,class:this.classes(b.CSS.header,b.CSS.label)},a.title):null;if(d)return d=a.children.map(f=>this._renderLegendForLayer(f)).toArray(),c.tsx("div",{key:e,class:this.classes(b.CSS.service,b.CSS.groupLayer)},g,d);if((d=a.legendElements)&&!d.length)return null;d=
d.map(f=>this._renderLegendForElement(f,a.layer,a.effectList)).filter(f=>!!f);return d.length?c.tsx("div",{key:e,class:this.classes(b.CSS.service,{[b.CSS.groupLayerChild]:!!a.parent}),tabIndex:0},g,c.tsx("div",{class:b.CSS.layer},d)):null};r._renderLegendForElement=function(a,d,e,g){var f="color-ramp"===a.type,h="opacity-ramp"===a.type;const m="size-ramp"===a.type;let n=null;if("symbol-table"===a.type||m){var k=a.infos.map(y=>this._renderLegendForElementInfo(y,d,e,m,a.legendType)).filter(y=>!!y);
k.length&&(n=c.tsx("div",{class:b.CSS.layerBody},k))}else"color-ramp"===a.type||"opacity-ramp"===a.type||"heatmap-ramp"===a.type||"stretch-ramp"===a.type?n=this._renderLegendForRamp(a,d.opacity):"relationship-ramp"===a.type?n=I.renderRelationshipRamp(a,this.id,{opacity:d.opacity,effectList:e,ariaLabel:this.messages.previewRelationshipRampAriaLabel}):"pie-chart-ramp"===a.type?n=this._renderPieChartRamp(a):"univariate-above-and-below-ramp"===a.type?n=this._renderUnivariateAboveAndBelowRamp(a,d.opacity,
e):"univariate-color-size-ramp"===a.type&&(n=this._renderUnivariateColorSizeRamp(a,d.opacity,e));if(!n)return null;k=a.title;var l=null;"string"===typeof k?l=k:k&&(l=p.getTitle(this.messages,k,f||h),l=p.isRendererTitle(k,f||h)&&k.title?`${k.title} (${l})`:l);f=g?b.CSS.layerChildTable:b.CSS.layerTable;h=l?c.tsx("div",{class:b.CSS.layerCaption},l):null;return c.tsx("div",{class:this.classes(f,{[b.CSS.layerTableSizeRamp]:m||!g})},h,n)};r._renderPieChartRamp=function(a){return c.tsx("div",{bind:a.preview,
afterCreate:p.attachToNode})};r._renderUnivariateAboveAndBelowRamp=function(a,d,e){const {sizeRampElement:g,colorRampElement:f}=q.getUnivariateAboveAndBelowRampElements(a,d);if(!g)return null;var h=this.messages?.previewColorRampAriaLabel,m=q.getUnivariateColorRampSize(g,"above",!0);a=q.getUnivariateColorRampSize(g,"below",!0);const n=q.getUnivariateColorRampPreview(f,{width:12,height:m,rampAlignment:"vertical",opacity:d,type:"above",effectList:e,ariaLabel:h});d=q.getUnivariateColorRampPreview(f,
{width:12,height:a,rampAlignment:"vertical",opacity:d,type:"below",effectList:e,ariaLabel:h});var k=q.getUnivariateColorRampMargin(g);const l=g.infos.map(u=>u.label);e=l.map((u,t)=>{const C=2===t;return 0===t?c.tsx("div",{key:t,class:u?n?b.CSS.univariateAboveAndBelowLabel:b.CSS.rampLabel:void 0},u):C?c.tsx("div",null):null});const y=l.length-1,N=Math.floor(l.length/2);h=l.map((u,t)=>{const C=t===y;return t===N||C?c.tsx("div",{key:t,class:u?n?b.CSS.univariateAboveAndBelowLabel:b.CSS.rampLabel:void 0},
u):null});const O={display:"table-cell",verticalAlign:"middle"};k={marginTop:`${k}px`};m={height:`${m}px`};a={height:`${a}px`};return c.tsx("div",{key:"univariate-above-and-below-ramp-preview",styles:E},c.tsx("div",{class:b.CSS.layerBody},g.infos.map((u,t)=>c.tsx("div",{class:this.classes(b.CSS.layerRow,b.CSS.sizeRamp)},c.tsx("div",{class:b.CSS.symbol,styles:O,bind:u.preview,afterCreate:p.attachToNode}),n||0!==t%2?null:c.tsx("div",{class:b.CSS.layerInfo},l[t])))),n?c.tsx("div",{styles:k,key:"color-ramp-preview"},
c.tsx("div",{styles:A},c.tsx("div",{styles:w},c.tsx("div",{class:b.CSS.rampContainer,bind:n,afterCreate:p.attachToNode})),c.tsx("div",{styles:w},c.tsx("div",{class:b.CSS.rampLabelsContainer,styles:m},e))),c.tsx("div",{styles:A},c.tsx("div",{styles:w},c.tsx("div",{class:b.CSS.rampContainer,bind:d,afterCreate:p.attachToNode})),c.tsx("div",{styles:w},c.tsx("div",{class:b.CSS.rampLabelsContainer,styles:a},h)))):null)};r._renderUnivariateColorSizeRamp=function(a,d,e){const {sizeRampElement:g,colorRampElement:f}=
q.getUnivariateColorSizeRampElements(a);if(!g)return null;var h=q.getUnivariateColorRampMargin(g);a=q.getUnivariateColorRampSize(g,"full",!1);d=q.getUnivariateColorRampPreview(f,{width:12,height:a,rampAlignment:"vertical",opacity:d,type:"full",effectList:e,ariaLabel:this.messages?.previewColorRampAriaLabel});const m=g.infos.length-1;e=g.infos.map((k,l)=>0===l||l===m?c.tsx("div",{key:l,class:k.label?f?b.CSS.univariateAboveAndBelowLabel:b.CSS.rampLabel:void 0},k.label):null);const n={display:"table-cell",
verticalAlign:"middle"};h={marginTop:`${h}px`};a={height:`${a}px`};return c.tsx("div",{key:"univariate-above-and-below-ramp-preview",styles:E},c.tsx("div",{class:b.CSS.layerBody},g.infos.map(k=>c.tsx("div",{class:this.classes(b.CSS.layerRow,b.CSS.sizeRamp)},c.tsx("div",{class:b.CSS.symbol,styles:n,bind:k.preview,afterCreate:p.attachToNode})))),c.tsx("div",{styles:h,key:"color-ramp-preview"},c.tsx("div",{styles:A},c.tsx("div",{styles:w},c.tsx("div",{class:b.CSS.rampContainer,bind:d,afterCreate:p.attachToNode})),
c.tsx("div",{styles:w},c.tsx("div",{class:b.CSS.rampLabelsContainer,styles:a},e)))))};r._renderLegendForRamp=function(a,d){const e=a.infos,g="heatmap-ramp"===a.type,f="stretch-ramp"===a.type,h=a.preview;h.className=`${b.CSS.colorRamp} ${"opacity-ramp"===a.type?b.CSS.opacityRamp:""}`;null!=d&&(h.style.opacity=d.toString());a=e.map(m=>c.tsx("div",{class:m.label?b.CSS.rampLabel:void 0},g?this.messages[m.label]||m.label:f?this._getStretchStopLabel(m):m.label));d={height:h.style.height};return c.tsx("div",
{class:b.CSS.layerRow},c.tsx("div",{class:b.CSS.symbolContainer,styles:{width:"24px"}},c.tsx("div",{class:b.CSS.rampContainer,bind:h,afterCreate:p.attachToNode})),c.tsx("div",{class:b.CSS.layerInfo},c.tsx("div",{class:b.CSS.rampLabelsContainer,styles:d},a)))};r._getStretchStopLabel=function(a){return a.label?this.messages[a.label]+": "+("string"===typeof a.value?a.value:L.formatNumber(a.value,{style:"decimal",notation:a.value.toString().includes("e")?"scientific":"standard"})):""};r._renderLegendForElementInfo=
function(a,d,e,g,f){if(a.type)return this._renderLegendForElement(a,d,e,!0);e=null;f=p.isImageryStretchedLegend(d,f);a.preview?e=c.tsx("div",{class:b.CSS.symbol,bind:a.preview,afterCreate:p.attachToNode}):a.src&&(e=this._renderImage(a,d,f));if(!e)return null;d={[b.CSS.imageryLayerInfoStretched]:f};return c.tsx("div",{class:b.CSS.layerRow},c.tsx("div",{class:this.classes(b.CSS.symbolContainer,{[b.CSS.imageryLayerInfoStretched]:f,[b.CSS.sizeRamp]:!f&&g})},e),c.tsx("div",{class:this.classes(b.CSS.layerInfo,
d)},p.getTitle(this.messages,a.label,!1)||""))};r._renderImage=function(a,d,e){const {label:g,src:f,opacity:h}=a;e={[b.CSS.imageryLayerStretchedImage]:e,[b.CSS.symbol]:!e};d={opacity:`${null!=h?h:d.opacity}`};return c.tsx("img",{alt:p.getTitle(this.messages,g,!1),"aria-label":p.getTitle(this.messages,g,!1),src:f,border:0,width:a.width,height:a.height,class:this.classes(e),styles:d})};return D._createClass(B)}(H);x.__decorate([z.property()],v.prototype,"activeLayerInfos",void 0);x.__decorate([z.property()],
v.prototype,"headingLevel",void 0);x.__decorate([z.property(),K.messageBundle("esri/widgets/Legend/t9n/Legend")],v.prototype,"messages",void 0);x.__decorate([z.property({readOnly:!0})],v.prototype,"type",void 0);return v=x.__decorate([G.subclass("esri.widgets.Legend.styles.Classic")],v)});
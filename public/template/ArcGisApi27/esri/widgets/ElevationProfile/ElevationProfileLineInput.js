// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Color ../../core/handleUtils ../../core/maybe ../../core/memoize ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../layers/support/ElevationQuery ../../support/elevationInfoUtils ./ElevationProfileLine".split(" "),function(k,d,r,w,n,x,t,f,c,D,E,y,z,A,B){c=function(u){function g(a){a=
u.call(this,a)||this;a.type="input";a.color=new r("#00c8c8");a.viewVisualizationEnabled=!1;a.numSamplesForPreview=50;a.numSamplesPerChunk=500;a.chartFillEnabled=!1;a.chartStrokeOffsetY=-1;a._getQueryElevationDependencies=x.memoize((b,e,l,m,p)=>n.applySome(b,h=>({elevationInfo:h,visibleLayers:e,view:l,stationary:m,spatialReference:p})));return a}k._inherits(g,u);var v=g.prototype;v.queryElevation=async function(a,{noDataValue:b,signal:e}){const l=this.queryElevationDependencies;if(null==l)throw Error("ElevationProfileLineInput: no dependencies");
const {view:m,elevationInfo:p,spatialReference:h}=l;if("on-the-ground"===p.mode&&"3d"===m.type&&h){e=await z.GeometryDescriptor.fromGeometry(a).project(h,e);if(!e)return{geometry:a,noDataValue:b};const C=m.elevationProvider;e.coordinates.forEach(q=>{q.z=C.getElevation(q.x,q.y,0,h,"ground")??0});return{geometry:e.export(),noDataValue:b}}return{geometry:a,noDataValue:b}};v.attach=function(a){const b=()=>this._onChange();return w.handlesGroup([k._get(k._getPrototypeOf(g.prototype),"attach",this).call(this,
a),t.watch(()=>this.queryElevationDependencies,b),t.on(()=>a.elevationProvider,"elevation-change",b,{onListenerAdd:b,onListenerRemove:b})])};k._createClass(g,[{key:"queryElevationDependencies",get:function(){const a=this._viewModel?.view;return null==a?null:this._getQueryElevationDependencies(this._elevationInfo,this._visibleLayers,a,a.stationary,a.spatialReference)}},{key:"available",get:function(){return!this._viewModel?.inputIsSketched}},{key:"_elevationInfo",get:function(){return n.applySome(this._viewModel?.input,
A.getGraphicEffectiveElevationInfo)}},{key:"_visibleLayers",get:function(){return n.applySome(this._viewModel?.view,a=>a.map?.allLayers?.filter(b=>b.visible).toArray())??[]}}]);return g}(B);d.__decorate([f.property({type:r,nonNullable:!0})],c.prototype,"color",void 0);d.__decorate([f.property()],c.prototype,"viewVisualizationEnabled",void 0);d.__decorate([f.property()],c.prototype,"queryElevationDependencies",null);d.__decorate([f.property()],c.prototype,"available",null);d.__decorate([f.property()],
c.prototype,"_elevationInfo",null);d.__decorate([f.property()],c.prototype,"_visibleLayers",null);return c=d.__decorate([y.subclass("esri.widgets.ElevationProfile.ElevationProfileLineInput")],c)});
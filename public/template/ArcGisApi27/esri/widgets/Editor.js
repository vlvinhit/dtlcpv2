// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Attachments":function(){define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Error ../core/reactiveUtils ../core/unitFormatUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./Attachments/AttachmentsViewModel ./Attachments/support/attachmentUtils ./support/componentsUtils ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a,g,u,v,k,n,p){const y={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},O=window.CSS;z=function(C){function f(d,l){d=C.call(this,d,l)||this;d.displayType="auto";d.messages=null;d.messagesUnits=null;d.selectedFile=null;d.submitting=!1;d.viewModel=null;d.visibleElements={...y};d._supportsImageOrientation=O&&O.supports&&O.supports("image-orientation","from-image");d._addAttachmentForm=
null;d._updateAttachmentForm=null;return d}e._inherits(f,C);var h=f.prototype;h.initialize=function(){this.viewModel||(this.viewModel=new g);this.addHandles([w.on(()=>this.viewModel?.attachmentInfos,"change",()=>this.scheduleRender()),w.on(()=>this.viewModel?.fileInfos,"change",()=>this.scheduleRender()),w.watch(()=>this.viewModel?.mode,()=>this._modeChanged(),w.initial)])};h.loadDependencies=function(){return v.loadCalciteComponents({icon:()=>new Promise((d,l)=>b(["../chunks/calcite-icon"],d,l))})};
h.castVisibleElements=function(d){return{...y,...d}};h.addAttachment=function(){const {_addAttachmentForm:d,viewModel:l}=this;this._set("submitting",!0);this._set("error",null);return l.addAttachment(d).then(q=>{this._set("submitting",!1);this._set("error",null);l.mode="view";return q}).catch(q=>{this._set("submitting",!1);this._set("error",new m("attachments:add-attachment",this.messages.addErrorMessage,q));throw q;})};h.deleteAttachment=function(d){const {viewModel:l}=this;this._set("submitting",
!0);this._set("error",null);return l.deleteAttachment(d).then(q=>{this._set("submitting",!1);this._set("error",null);l.mode="view";return q}).catch(q=>{this._set("submitting",!1);this._set("error",new m("attachments:delete-attachment",this.messages.deleteErrorMessage,q));throw q;})};h.updateAttachment=function(){const {viewModel:d}=this,{_updateAttachmentForm:l}=this;this._set("submitting",!0);this._set("error",null);return d.updateAttachment(l).then(q=>{this._set("submitting",!1);this._set("error",
null);d.mode="view";return q}).catch(q=>{this._set("submitting",!1);this._set("error",new m("attachments:update-attachment",this.messages.updateErrorMessage,q));throw q;})};h.addFile=function(){const d=this.viewModel.addFile(this.selectedFile,this._addAttachmentForm);this.viewModel.mode="view";return d};h.updateFile=function(){const {viewModel:d}=this,l=d.updateFile(this.selectedFile,this._updateAttachmentForm,d.activeFileInfo);d.mode="view";return l};h.deleteFile=function(d){d=this.viewModel.deleteFile(d||
this.viewModel.activeFileInfo?.file);this.viewModel.mode="view";return d};h.render=function(){const {submitting:d,viewModel:l}=this,{state:q}=l;return p.tsx("div",{class:this.classes("esri-attachments","esri-widget")},d?this.renderProgressBar():null,"loading"===q?this.renderLoading():this.renderAttachments(),this.renderErrorMessage())};h.renderErrorMessage=function(){const {error:d,visibleElements:l}=this;return d&&l.errorMessage?p.tsx("div",{key:"error-message",class:"esri-attachments__error-message"},
d.message):null};h.renderAttachments=function(){const {activeFileInfo:d,mode:l,activeAttachmentInfo:q}=this.viewModel;return"add"===l?this.renderAddForm():"edit"===l?this.renderDetailsForm(q||d):this.renderAttachmentContainer()};h.renderLoading=function(){return p.tsx("div",{class:"esri-attachments__loader-container",key:"loader"},p.tsx("div",{class:"esri-attachments__loader"}))};h.renderProgressBar=function(){return this.visibleElements.progressBar?p.tsx("div",{class:"esri-attachments__progress-bar",
key:"progress-bar"}):null};h.renderAddForm=function(){const {submitting:d,selectedFile:l}=this;var q=d||!l,H=this.visibleElements.cancelAddButton?p.tsx("button",{type:"button",bind:this,disabled:d,onclick:this._cancelForm,class:this.classes("esri-button","esri-button--tertiary","esri-button--small","esri-button--half",d&&"esri-button--disabled")},this.messages.cancel):null;q=this.visibleElements.addSubmitButton?p.tsx("button",{type:"submit",disabled:q,class:this.classes("esri-button","esri-button--secondary",
"esri-button--small","esri-button--half",{["esri-button--disabled"]:q})},this.messages.add):null;const N=l?p.tsx("span",{key:"file-name",class:"esri-attachments__file-name"},l.name):null;H=p.tsx("form",{bind:this,afterCreate:k.storeNode,afterRemoved:k.discardNode,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},p.tsx("fieldset",{class:"esri-attachments__file-fieldset"},N,p.tsx("label",{class:this.classes("esri-attachments__file-label","esri-button","esri-button--secondary")},
l?this.messages.changeFile:this.messages.selectFile,p.tsx("input",{class:"esri-attachments__file-input",type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))),q,H);return p.tsx("div",{key:"add-form-container",class:"esri-attachments__form-node"},H)};h.renderDetailsForm=function(d){const {visibleElements:l,viewModel:q,selectedFile:H,submitting:N}=this;var {capabilities:E}=q,r=N||!H;let I;if(H){var M=H.type;I=H.name;var S=H.size}else if(d&&"file"in d)M=d.file.type,I=d.file.name,
S=d.file.size;else if(d&&"contentType"in d){M=d.contentType;I=d.name;S=d.size;var U=d.url}var G=E.editing&&E.operations?.delete&&l.deleteButton?p.tsx("button",{key:"delete-button",type:"button",disabled:N,bind:this,onclick:L=>this._submitDeleteAttachment(L,d),class:this.classes("esri-button","esri-button--small","esri-button--tertiary","esri-attachments__delete-button",{["esri-button--disabled"]:N})},this.messages.delete):void 0;r=E.editing&&E.operations?.update&&l.updateButton?p.tsx("button",{disabled:r,
key:"update-button",type:"submit",class:this.classes("esri-button","esri-button--small","esri-button--third",{["esri-button--disabled"]:r})},this.messages.update):void 0;const J=this.visibleElements.cancelUpdateButton?p.tsx("button",{disabled:N,key:"cancel-button",type:"button",bind:this,onclick:this._cancelForm,class:this.classes("esri-button","esri-button--small","esri-button--tertiary","esri-button--third",{["esri-button--disabled"]:N})},this.messages.cancel):void 0;E=E.editing&&E.operations?.update?
p.tsx("fieldset",{key:"file",class:"esri-attachments__file-fieldset"},p.tsx("span",{key:"file-name",class:"esri-attachments__file-name"},I),p.tsx("label",{class:this.classes("esri-attachments__file-label","esri-button","esri-button--secondary")},this.messages.changeFile,p.tsx("input",{class:"esri-attachments__file-input",type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))):void 0;S=p.tsx("fieldset",{key:"size",class:"esri-attachments__metadata-fieldset"},p.tsx("label",
null,F.formatFileSize(this.messagesUnits,S??0)));M=p.tsx("fieldset",{key:"content-type",class:"esri-attachments__metadata-fieldset"},p.tsx("label",null,M));U=null!=U?p.tsx("a",{class:"esri-attachments__item-link",href:U,rel:"noreferrer",target:"_blank"},this.renderImageMask(d,400),p.tsx("div",{class:"esri-attachments__item-link-overlay"},p.tsx("span",{class:"esri-attachments__item-link-overlay-icon"},p.tsx("calcite-icon",{icon:"launch"})))):this.renderImageMask(d,400);G=p.tsx("form",{bind:this,afterCreate:k.storeNode,
afterRemoved:k.discardNode,"data-node-ref":"_updateAttachmentForm",onsubmit:L=>this._submitUpdateAttachment(L,d)},p.tsx("div",{class:"esri-attachments__metadata"},S,M),E,p.tsx("div",{class:"esri-attachments__actions"},G,J,r));return p.tsx("div",{key:"edit-form-container",class:"esri-attachments__form-node"},U,G)};h.renderImageMask=function(d,l){return d?"file"in d?this.renderGenericImageMask(d.file.name,d.file.type):this.renderImageMaskForAttachment(d,l):null};h.renderGenericImageMask=function(d,
l){var {supportsResizeAttachments:q}=this.viewModel;l=u.getIconPath(l);q={["esri-attachments__image--resizable"]:q};return p.tsx("div",{key:l,class:this.classes("esri-attachments__item-mask--icon","esri-attachments__item-mask")},p.tsx("img",{title:d,alt:d,src:l,class:this.classes(q,"esri-attachments__image")}))};h.renderImageMaskForAttachment=function(d,l){var {supportsResizeAttachments:q}=this.viewModel;if(!d)return null;const {contentType:H,name:N,url:E}=d;if(!q||!u.isSupportedImage(H))return this.renderGenericImageMask(N,
H);d=(d=this._getCSSTransform(d))?{transform:d,"image-orientation":"none"}:{};l=`${E}${E?.includes("?")?"\x26":"?"}w=${l}`;q={["esri-attachments__image--resizable"]:q};return p.tsx("div",{key:l,class:this.classes("esri-attachments__item-mask")},p.tsx("img",{styles:d,alt:N,title:N,src:l,class:this.classes(q,"esri-attachments__image")}))};h.renderFile=function(d){const {file:l}=d;return p.tsx("li",{class:"esri-attachments__item",key:l},p.tsx("button",{key:"details-button",bind:this,class:"esri-attachments__item-button",
title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,onclick:()=>this._startEditFile(d),type:"button"},this.renderImageMask(d),p.tsx("label",{class:"esri-attachments__label"},p.tsx("span",{class:"esri-attachments__filename"},l.name||this.messages.noTitle),p.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-chevron-icon",k.isRTL(this.container)?"esri-icon-left":"esri-icon-right")}))))};h.renderAttachmentInfo=function({attachmentInfo:d,displayType:l}){const {viewModel:q,
effectiveDisplayType:H}=this,{capabilities:N,supportsResizeAttachments:E}=q,{contentType:r,name:I,url:M}=d;l=this.renderImageMask(d,"list"===l?48:400);var S=N.editing?p.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-chevron-icon",k.isRTL(this.container)?"esri-icon-left":"esri-icon-right")}):null;S="preview"===H&&E&&u.isSupportedImage(r)?null:p.tsx("label",{class:"esri-attachments__label"},p.tsx("span",{class:"esri-attachments__filename"},I||this.messages.noTitle),S);l=
[l,S];l=N.editing?p.tsx("button",{key:"details-button",bind:this,class:"esri-attachments__item-button",title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,"data-attachment-info-id":d.id,onclick:()=>this._startEditAttachment(d),type:"button"},l):p.tsx("a",{key:"details-link",class:"esri-attachments__item-button",href:M??void 0,target:"_blank"},l);return p.tsx("li",{class:"esri-attachments__item",key:d},l)};h.renderAttachmentContainer=function(){const {effectiveDisplayType:d,
viewModel:l,visibleElements:q}=this,{attachmentInfos:H,capabilities:N,fileInfos:E}=l;var r=!!H?.length;const I=!!E?.length,M={["esri-attachments__container--list"]:"preview"!==d,["esri-attachments__container--preview"]:"preview"===d},S=N.editing&&N.operations?.add&&q.addButton?p.tsx("button",{bind:this,onclick:()=>this._startAddAttachment(),class:this.classes("esri-button","esri-button--tertiary","esri-attachments__add-attachment-button"),type:"button"},p.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-add-icon",
"esri-icon-plus")}),this.messages.add):void 0,U=r?p.tsx("ul",{key:"attachments-list",class:"esri-attachments__items"},H.toArray().map(J=>this.renderAttachmentInfo({attachmentInfo:J,displayType:d}))):void 0,G=I?p.tsx("ul",{key:"file-list",class:"esri-attachments__items"},E.toArray().map(J=>this.renderFile(J))):void 0;r=I||r?void 0:p.tsx("div",{class:"esri-widget__content--empty"},this.messages.noAttachments);return p.tsx("div",{key:"attachments-container",class:this.classes("esri-attachments__container",
M)},U,G,r,S)};h._modeChanged=function(){this._set("error",null);this._set("selectedFile",null)};h._handleFileInputChange=function(d){d=(d=d.target)&&d.files&&d.files.item(0);this._set("selectedFile",d)};h._submitDeleteAttachment=function(d,l){d.preventDefault();l&&("file"in l?this.deleteFile(l.file):l&&this.deleteAttachment(l))};h._submitAddAttachment=function(d){d.preventDefault();this.viewModel.filesEnabled?this.addFile():this.addAttachment()};h._submitUpdateAttachment=function(d,l){d.preventDefault();
l&&"file"in l?this.updateFile():this.updateAttachment()};h._startEditAttachment=function(d){const {viewModel:l}=this;l.activeFileInfo=null;l.activeAttachmentInfo=d;l.mode="edit"};h._startEditFile=function(d){const {viewModel:l}=this;l.activeAttachmentInfo=null;l.activeFileInfo=d;l.mode="edit"};h._startAddAttachment=function(){this.viewModel.mode="add"};h._cancelForm=function(d){d.preventDefault();this.viewModel.mode="view"};h._getCSSTransform=function(d){({orientationInfo:d}=d);return!this._supportsImageOrientation&&
d?[d.rotation?`rotate(${d.rotation}deg)`:"",d.mirrored?"scaleX(-1)":""].join(" "):""};e._createClass(f,[{key:"capabilities",get:function(){return this.viewModel.capabilities},set:function(d){this.viewModel.capabilities=d}},{key:"effectiveDisplayType",get:function(){const {displayType:d}=this;return d&&"auto"!==d?d:this.viewModel.supportsResizeAttachments?"preview":"list"}},{key:"graphic",get:function(){return this.viewModel.graphic},set:function(d){this.viewModel.graphic=d}},{key:"label",get:function(){return this.messages?.widgetLabel??
""},set:function(d){this._overrideIfSome("label",d)}}]);return f}(a);c.__decorate([K.property()],z.prototype,"capabilities",null);c.__decorate([K.property()],z.prototype,"displayType",void 0);c.__decorate([K.property({readOnly:!0})],z.prototype,"effectiveDisplayType",null);c.__decorate([K.property()],z.prototype,"graphic",null);c.__decorate([K.property()],z.prototype,"label",null);c.__decorate([K.property(),n.messageBundle("esri/widgets/Attachments/t9n/Attachments")],z.prototype,"messages",void 0);
c.__decorate([K.property(),n.messageBundle("esri/core/t9n/Units")],z.prototype,"messagesUnits",void 0);c.__decorate([K.property({readOnly:!0})],z.prototype,"selectedFile",void 0);c.__decorate([K.property({readOnly:!0})],z.prototype,"submitting",void 0);c.__decorate([K.property({readOnly:!0})],z.prototype,"error",void 0);c.__decorate([K.property({type:g})],z.prototype,"viewModel",void 0);c.__decorate([K.property()],z.prototype,"visibleElements",void 0);c.__decorate([P.cast("visibleElements")],z.prototype,
"castVisibleElements",null);return z=c.__decorate([D.subclass("esri.widgets.Attachments")],z)})},"esri/core/unitFormatUtils":function(){define("exports ./ByteSizeUnit ./Cyclical ./mathUtils ./string ./unitUtils ../intl/number".split(" "),function(b,e,c,m,w,F,K){function P(u,v,k){return u.units[v][k]}function z(u,v,k,n=2,p="abbr"){return`${K.formatNumber(v,{minimumFractionDigits:n,maximumFractionDigits:n,signDisplay:0<v?"never":"exceptZero"})} ${P(u,k,p)}`}function t(u,v,k,n=2,p="abbr"){return`${K.formatNumber(v,
{minimumFractionDigits:n,maximumFractionDigits:n,signDisplay:"exceptZero"})} ${P(u,k,p)}`}function D(u,v){const k=JSON.stringify(v);let n=a.get(k);n||(n=new Intl.NumberFormat("en-US",v),a.set(k,n));return/\-?\+?360/.test(n.format(u))?0:u}const a=new Map,g=["B","kB","MB","GB","TB"];b.formatAngleDegrees=function(u,v,k,n,p){p=p??2;var y=c.cyclicalDegrees,O=y.normalize;a:if(u=F.convertUnit(u,v,"degrees"),k===n)k=u;else{switch(n){case "arithmetic":k=-u+90;break a;case "geographic":k=-u-90;break a}k=void 0}y=
O.call(y,k,0,!0);p={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:p,minimumFractionDigits:p,signDisplay:0<y?"never":"exceptZero"};y=D(y,p);return K.formatNumber(y,p)};b.formatDMS=function(u,v,k=2){u=F.convertUnit(u,v,"degrees");v=u-Math.floor(u);u-=v;v*=60;let n=v-Math.floor(v);v-=n;n*=60;return`${u.toFixed()}\u00b0 ${v.toFixed()}' ${n.toFixed(k)}"`};b.formatDecimal=z;b.formatFileSize=function(u,v){let k=0===v?0:Math.floor(Math.log(v)/Math.log(e.ByteSizeUnit.KILOBYTES));k=
m.clamp(k,0,g.length-1);v=K.formatNumber(v/e.ByteSizeUnit.KILOBYTES**k,{maximumFractionDigits:2});return w.replace(u.units.bytes[g[k]],{fileSize:v})};b.formatImperialArea=function(u,v,k,n=2,p="abbr"){const y=F.preferredImperialAreaUnit(v,k);return z(u,F.convertUnit(v,k,y),y,n,p)};b.formatImperialLength=function(u,v,k,n=2,p="abbr"){const y=F.preferredImperialLengthUnit(v,k);return z(u,F.convertUnit(v,k,y),y,n,p)};b.formatImperialRelativeLength=function(u,v,k,n=2,p="abbr"){const y=F.preferredImperialLengthUnit(v,
k);return t(u,F.convertUnit(v,k,y),y,n,p)};b.formatImperialRelativeVerticalLength=function(u,v,k,n=2,p="abbr"){const y=F.preferredImperialVerticalLengthUnit(v,k);return t(u,F.convertUnit(v,k,y),y,n,p)};b.formatImperialVerticalLength=function(u,v,k,n=2,p="abbr"){const y=F.preferredImperialVerticalLengthUnit(v,k);return z(u,F.convertUnit(v,k,y),y,n,p)};b.formatMetricArea=function(u,v,k,n=2,p="abbr"){const y=F.preferredMetricAreaUnit(v,k);return z(u,F.convertUnit(v,k,y),y,n,p)};b.formatMetricLength=
function(u,v,k,n=2,p="abbr"){const y=F.preferredMetricLengthUnit(v,k);return z(u,F.convertUnit(v,k,y),y,n,p)};b.formatMetricRelativeLength=function(u,v,k,n=2,p="abbr"){const y=F.preferredMetricLengthUnit(v,k);return t(u,F.convertUnit(v,k,y),y,n,p)};b.formatMetricRelativeVerticalLength=function(u,v,k,n=2,p="abbr"){const y=F.preferredMetricVerticalLengthUnit(v,k);return t(u,F.convertUnit(v,k,y),y,n,p)};b.formatMetricVerticalLength=function(u,v,k,n=2,p="abbr"){const y=F.preferredMetricVerticalLengthUnit(v,
k);return z(u,F.convertUnit(v,k,y),y,n,p)};b.formatRelativeAngleDegrees=function(u,v,k,n,p){k!==n&&(u=-u);p=p??2;k={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:p,minimumFractionDigits:p,signDisplay:"exceptZero"};u=F.convertUnit(u,v,"degrees")%360;u=D(u,k);return K.formatNumber(u,k)};b.formatRelativeDecimal=t;b.unitName=P;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/ByteSizeUnit":function(){define(["exports"],function(b){b.ByteSizeUnit=void 0;
var e=b.ByteSizeUnit||(b.ByteSizeUnit={});e[e.KILOBYTES=1024]="KILOBYTES";e[e.MEGABYTES=1048576]="MEGABYTES";e[e.GIGABYTES=1073741824]="GIGABYTES";Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Attachments/AttachmentsViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Graphic ../../core/Accessor ../../core/Collection ../../core/Error ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../rest/query/support/AttachmentInfo ../../rest/support/AttachmentQuery ../Feature/support/featureUtils".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a,g,u,v){const k={editing:!1,operations:{add:!0,update:!0,delete:!0}},n=w.ofType(g);m=function(p){function y(C){var f=p.call(this,C)||this;f._getAttachmentsPromise=null;f._attachmentLayer=null;f.capabilities={...k};f.activeAttachmentInfo=null;f.activeFileInfo=null;f.attachmentInfos=new n;f.fileInfos=new w;f.graphic=null;f.mode="view";f.filesEnabled=!1;f.addHandles(K.watch(()=>f.graphic,()=>f._graphicChanged(),K.initial));return f}b._inherits(y,p);var O=y.prototype;O.destroy=
function(){this.graphic=this._attachmentLayer=null};O.castCapabilities=function(C){return{...k,...C}};O.getAttachments=async function(){const {_attachmentLayer:C,attachmentInfos:f}=this;if(!C||"function"!==typeof C.queryAttachments)throw new F("invalid-layer","getAttachments(): A valid layer is required.");const h=this._getObjectId();var d=new u({objectIds:[h],returnMetadata:!0});const l=[];this._getAttachmentsPromise=d=C.queryAttachments(d).then(q=>q[h]||l).catch(()=>l);this.notifyChange("state");
d=await d;f.removeAll();d.length&&f.addMany(d);this._getAttachmentsPromise=null;this.notifyChange("state");return d};O.addAttachment=async function(C,f=this.graphic){const {_attachmentLayer:h,attachmentInfos:d,capabilities:l}=this;if(!f)throw new F("invalid-graphic","addAttachment(): A valid graphic is required.",{graphic:f});if(!C)throw new F("invalid-attachment","addAttachment(): An attachment is required.",{attachment:C});if(!l.operations?.add)throw new F("invalid-capabilities","addAttachment(): add capabilities are required.");
if(!h||"function"!==typeof h.addAttachment)throw new F("invalid-layer","addAttachment(): A valid layer is required.");C=await h.addAttachment(f,C).then(q=>this._queryAttachment(q.objectId,f));d.add(C);return C};O.deleteAttachment=async function(C){const {_attachmentLayer:f,attachmentInfos:h,graphic:d,capabilities:l}=this;if(!C)throw new F("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:C});if(!l.operations?.delete)throw new F("invalid-capabilities","deleteAttachment(): delete capabilities are required.");
if(!f||"function"!==typeof f.deleteAttachments)throw new F("invalid-layer","deleteAttachment(): A valid layer is required.");if(!d)throw new F("invalid-graphic","deleteAttachment(): A graphic is required.");const q=await f.deleteAttachments(d,[C.id]).then(()=>C);h.remove(q);return q};O.updateAttachment=async function(C,f=this.activeAttachmentInfo){const {_attachmentLayer:h,attachmentInfos:d,graphic:l,capabilities:q}=this;if(!C)throw new F("invalid-attachment","updateAttachment(): An attachment is required.",
{attachment:C});if(!f)throw new F("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:f});if(!q.operations?.update)throw new F("invalid-capabilities","updateAttachment(): Update capabilities are required.");const H=d.findIndex(N=>N===f);if(!h||"function"!==typeof h.updateAttachment)throw new F("invalid-layer","updateAttachment(): A valid layer is required.");if(!l)throw new F("invalid-graphic","updateAttachment(): A graphic is required.");C=await h.updateAttachment(l,
f.id,C).then(N=>this._queryAttachment(N.objectId));d.splice(H,1,C);return C};O.commitFiles=async function(){await Promise.all(this.fileInfos.items.map(C=>this.addAttachment(C.form)));this.fileInfos.removeAll();return this.getAttachments()};O.addFile=function(C,f){if(!C||!f)return null;C={file:C,form:f};this.fileInfos.add(C);return C};O.updateFile=function(C,f,h=this.activeFileInfo){if(!C||!f||!h)return null;const d=this.fileInfos.findIndex(l=>h===l);-1<d&&this.fileInfos.splice(d,1,{file:C,form:f});
return this.fileInfos.items[d]};O.deleteFile=function(C){const f=this.fileInfos.find(h=>h.file===C);return f?(this.fileInfos.remove(f),f):null};O._queryAttachment=async function(C,f){const {_attachmentLayer:h}=this;if(!C||!h?.queryAttachments)throw new F("invalid-attachment-id","Could not query attachment.");const d=this._getObjectId(f);C=new u({objectIds:[d],attachmentsWhere:`AttachmentId=${C}`,returnMetadata:!0});return h.queryAttachments(C).then(l=>l[d][0])};O._getObjectId=function(C=this.graphic){return C?.getObjectId()??
null};O._graphicChanged=function(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch(()=>{}))};O._setAttachmentLayer=function(){var {graphic:C}=this;this._attachmentLayer=(C=v.getSourceLayer(C))?"scene"===C.type&&null!=C.associatedLayer?C.associatedLayer:C:null};b._createClass(y,[{key:"state",get:function(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}},{key:"supportsResizeAttachments",get:function(){var {graphic:C}=this;if(!C)return!1;C=C.layer||
C.sourceLayer;return C?.loaded&&"capabilities"in C&&C.capabilities&&"operations"in C.capabilities&&"supportsResizeAttachments"in C.capabilities.operations&&C.capabilities.operations.supportsResizeAttachments||!1}}]);return y}(m);e.__decorate([P.property()],m.prototype,"capabilities",void 0);e.__decorate([z.cast("capabilities")],m.prototype,"castCapabilities",null);e.__decorate([P.property()],m.prototype,"activeAttachmentInfo",void 0);e.__decorate([P.property()],m.prototype,"activeFileInfo",void 0);
e.__decorate([P.property({readOnly:!0,type:n})],m.prototype,"attachmentInfos",void 0);e.__decorate([P.property()],m.prototype,"fileInfos",void 0);e.__decorate([P.property({type:c})],m.prototype,"graphic",void 0);e.__decorate([P.property()],m.prototype,"mode",void 0);e.__decorate([P.property({readOnly:!0})],m.prototype,"state",null);e.__decorate([P.property()],m.prototype,"filesEnabled",void 0);e.__decorate([P.property({readOnly:!0})],m.prototype,"supportsResizeAttachments",null);return m=e.__decorate([a.subclass("esri.widgets.Attachments.AttachmentsViewModel")],
m)})},"esri/rest/query/support/AttachmentInfo":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../layers/support/exifUtils".split(" "),function(b,e,c,m,w,F,K,P,z){var t;const D={1:{id:1,rotation:0,mirrored:!1},2:{id:2,rotation:0,mirrored:!0},3:{id:3,
rotation:180,mirrored:!1},4:{id:4,rotation:180,mirrored:!0},5:{id:5,rotation:-90,mirrored:!0},6:{id:6,rotation:90,mirrored:!1},7:{id:7,rotation:90,mirrored:!0},8:{id:8,rotation:-90,mirrored:!1}};c=t=function(a){function g(u){u=a.call(this,u)||this;u.contentType=null;u.exifInfo=null;u.id=null;u.globalId=null;u.keywords=null;u.name=null;u.parentGlobalId=null;u.parentObjectId=null;u.size=null;u.url=null;return u}b._inherits(g,a);g.prototype.clone=function(){return new t({contentType:this.contentType,
exifInfo:this.exifInfo,id:this.id,globalId:this.globalId,keywords:this.keywords,name:this.name,parentGlobalId:this.parentGlobalId,parentObjectId:this.parentObjectId,size:this.size,url:this.url})};b._createClass(g,[{key:"orientationInfo",get:function(){var {exifInfo:u}=this;u=z.getExifValue({exifName:"Exif IFD0",tagName:"Orientation",exifInfo:u});return D[u]||null}}]);return g}(c.JSONSupport);e.__decorate([m.property({type:String})],c.prototype,"contentType",void 0);e.__decorate([m.property()],c.prototype,
"exifInfo",void 0);e.__decorate([m.property({readOnly:!0})],c.prototype,"orientationInfo",null);e.__decorate([m.property({type:w.Integer})],c.prototype,"id",void 0);e.__decorate([m.property({type:String})],c.prototype,"globalId",void 0);e.__decorate([m.property({type:String})],c.prototype,"keywords",void 0);e.__decorate([m.property({type:String})],c.prototype,"name",void 0);e.__decorate([m.property({json:{read:!1}})],c.prototype,"parentGlobalId",void 0);e.__decorate([m.property({json:{read:!1}})],
c.prototype,"parentObjectId",void 0);e.__decorate([m.property({type:w.Integer})],c.prototype,"size",void 0);e.__decorate([m.property({json:{read:!1}})],c.prototype,"url",void 0);return c=t=e.__decorate([P.subclass("esri.layers.support.AttachmentInfo")],c)})},"esri/layers/support/exifUtils":function(){define(["exports"],function(b){function e(c){const {tagName:m,tags:w}=c;return w&&m?(c=w.find(F=>F.name===m))&&c.value||null:null}b.getExifValue=function(c){const {exifInfo:m,exifName:w,tagName:F}=c;
return m&&w&&F?(c=m.find(K=>K.name===w))?e({tagName:F,tags:c.tags}):null:null};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/support/featureUtils":function(){define("exports ../../../core/Logger ../../../core/string ../../../intl/date ../../../intl/number ../../../layers/support/fieldUtils ../../../layers/support/layerUtils ../../../popup/support/FieldInfoFormat ../../../support/arcadeOnDemand".split(" "),function(b,e,c,m,w,F,K,P,z){function t(R){return R?A.test(R):
!1}function D(R,V){if(!t(V)||!R)return null;const ba=V.replace(A,"").toLowerCase();let ea=null;R.some(ha=>ha.name.toLowerCase()===ba?(ea=ha,!0):!1);return ea}function a(R,V){return(V=g(V,R))?V.name:R}function g(R,V){return R&&"function"===typeof R.getField&&V?R.getField(V)??null:null}function u({formattedAttributes:R,template:V,fieldInfoMap:ba}){return`${c.replace(c.replace(V,ea=>{const ha=ba.get(ea.toLowerCase());return`{${ha&&ha.fieldName||ea}}`}),R).replaceAll(J,"")}`.trim()}function v(R,V,ba=
!1){const ea=V[R];"string"===typeof ea&&(ba=(ba?encodeURIComponent(ea):ea).replaceAll(B,"%27"),V[R]=ba)}function k(R,V=!1){const ba={...R};Object.keys(ba).forEach(ea=>v(ea,ba,V));return ba}function n(R,V){return R.replaceAll(L,(ba,ea,ha)=>(ba=g(V,ha))?`{${ba.name}}`:ea)}function p(R,V,ba){return(R=n(R,ba))?R.replaceAll(T,(ea,ha,la)=>{ha=`${ha||la}`.trim();return c.replace(ea,k(V,ha&&"{"!==ha[0]||!1))}):R}function y(R){return null!=R&&"object"===typeof R&&"layer"in R&&!!R.layer}function O(R){return null!=
R&&"object"===typeof R&&"fieldsIndex"in R&&"geometryType"in R&&"getField"in R&&"load"in R&&"loaded"in R&&"objectIdField"in R&&"spatialReference"in R&&"type"in R&&"feature"===R.type&&"when"in R}function C(R){return null!=R&&"object"===typeof R&&"createQuery"in R&&"queryFeatureCount"in R&&"queryObjectIds"in R&&"queryRelatedFeatures"in R&&"queryRelatedFeaturesCount"in R&&"relationships"in R}function f(R){return O(R)&&C(R)}function h(R,V){const {fieldInfos:ba,fieldName:ea,preventPlacesFormatting:ha,layer:la}=
V;var ia=d(ba,ea)?.clone();V=g(la,ea);if(ia&&!F.isRasterPixelValueField(ea)){const na=V?.type;if("date"===na||"date-only"===na||"time-only"===na||"timestamp-offset"===na||ia.format?.dateFormat){V=ia.format??new P;V.dateFormat??(V.dateFormat="date-only"===na?"short-date":"short-date-short-time");if("number"===typeof R){if(!(ia=!y(la)&&K.isFeatureLayer(la)&&la.datesInUnknownTimezone)){if(ia=y(la))ia=la.layer,ia=null!=ia&&"object"===typeof ia&&"type"in ia&&"map-image"===ia.type;ia=ia&&la.layer.datesInUnknownTimezone}return V.formatDate(R,
ia)}switch(na){case "date-only":return V.formatDateOnly(R);case "time-only":return V.formatTimeOnly(R);case "timestamp-offset":return V.formatTimestamp(R)}}}V=ia?.format;if("string"===typeof R&&F.isRasterPixelValueField(ea)&&V)return V.formatRasterPixelValue(R);"string"!==typeof R||!V||null!=V.dateFormat||null==V.places&&null==V.digitSeparator||(ia=Number(R),isNaN(ia)||(R=ia));return"string"===typeof R||null==R||null==V?H(R):ha?w.formatNumber(R,{...w.convertNumberFormatToIntlOptions(V),minimumFractionDigits:0,
maximumFractionDigits:20}):V.formatNumber(R)}function d(R,V){if(R&&R.length&&V)return R.find(ba=>ba.fieldName?.toLowerCase()===V.toLowerCase())}function l({fieldName:R,graphic:V,layer:ba}){if(I(R)||!ba||"function"!==typeof ba.getFeatureType)return null;const {typeIdField:ea}=ba;return ea&&R===ea?(R=ba.getFeatureType(V))?R.name:null:null}function q({fieldName:R,value:V,graphic:ba,layer:ea}){return I(R)||!ea||"function"!==typeof ea.getFieldDomain?null:(R=ba&&ea.getFieldDomain(R,{feature:ba}))&&"coded-value"===
R.type?R.getName(V):null}function H(R){return"string"===typeof R?R.replaceAll(x,'\x3cbr class\x3d"esri-text-new-line" /\x3e'):R}function N(R){const {value:V,fieldName:ba,fieldInfos:ea,fieldInfoMap:ha,layer:la,graphic:ia}=R;if(null==V)return"";if((R=q({fieldName:ba,value:V,graphic:ia,layer:la}))||(R=l({fieldName:ba,graphic:ia,layer:la})))return R;if(ha.get(ba.toLowerCase()))return h(V,{fieldInfos:ea||Array.from(ha.values()),fieldName:ba,layer:la});switch(la?.fieldsIndex?.get(ba)?.type){case "date":return m.formatDate(V);
case "date-only":return m.formatDateOnly(V);case "time-only":return m.formatTimeOnly(V);case "timestamp-offset":return m.formatTimestamp(V)}return H(V)}async function E(R,V){const {layer:ba,graphic:ea,outFields:ha,objectIds:la,returnGeometry:ia,spatialReference:na}=R;R=la[0];if("number"!==typeof R&&"string"!==typeof R)return G.warn("Could not query required fields for the specified feature. The feature's ID is invalid.",{layer:ba,graphic:ea,objectId:R,requiredFields:ha}),null;if(!K.getEffectiveLayerCapabilities(ba)?.operations?.supportsQuery)return G.warn("The specified layer cannot be queried. The following fields will not be available.",
{layer:ba,graphic:ea,requiredFields:ha,returnGeometry:ia}),null;R=ba.createQuery();R.objectIds=la;R.outFields=ha?.length?ha:[ba.objectIdField];R.returnGeometry=!!ia;R.returnZ=!!ia;R.returnM=!!ia;R.outSpatialReference=na;return(await ba.queryFeatures(R,V)).features[0]}async function r(R){if(!R.expressionInfos?.length)return!1;var V=await z.loadArcade();({arcadeUtils:{hasGeometryFunctions:V}}=V);return V(R)}function I(R=""){return R?R.includes("relationships/"):!1}function M({attributes:R,graphic:V,
relatedInfo:ba,fieldInfos:ea,fieldInfoMap:ha,layer:la}){R&&V&&ba&&Object.keys(V.attributes).forEach(ia=>{var na=(na={layerId:ba.relation.id.toString(),fieldName:ia},`${"relationships/"}${na.layerId}/${na.fieldName}`);R[na]=N({fieldName:na,fieldInfos:ea,fieldInfoMap:ha,layer:la,value:V.attributes[ia],graphic:V})})}function S({attributes:R,relatedInfo:V,fieldInfoMap:ba,fieldInfos:ea,layer:ha}){R&&V&&(V.relatedFeatures&&V.relatedFeatures&&V.relatedFeatures.forEach(la=>M({attributes:R,graphic:la,relatedInfo:V,
fieldInfoMap:ba,fieldInfos:ea,layer:ha})),V.relatedStatsFeatures&&V.relatedStatsFeatures&&V.relatedStatsFeatures.forEach(la=>M({attributes:R,graphic:la,relatedInfo:V,fieldInfoMap:ba,fieldInfos:ea,layer:ha})))}function U(R,V,ba){return R.filter(f).find(ea=>ea!==V&&ea.url===V.url&&ea.layerId===ba.relatedTableId)}const G=e.getLogger("esri.widgets.Feature.support.featureUtils"),J=/href=(""|'')/gi,L=/(\{([^\{\r\n]+)\})/g,B=/'/g,A=/^\s*expression\//i,x=/(\n)/gi,Q=/[\u00A0-\u9999<>&]/gim,T=/href\s*=\s*(?:"([^"]+)"|'([^']+)')/gi,
W=/^(?:mailto:|tel:)/,aa=m.convertDateFormatToIntlOptions("short-date-short-time"),Y=R=>{if(!R)return!1;R=R.toUpperCase();return R.includes("CURRENT_TIMESTAMP")||R.includes("CURRENT_DATE")||R.includes("CURRENT_TIME")},Z=({layer:R,method:V,query:ba,definitionExpression:ea})=>{R.capabilities?.query?.supportsCacheHint&&"attachments"!==V&&(R=null!=ba.where?ba.where:null,V=null!=ba.geometry?ba.geometry:null,Y(ea)||Y(R)||"extent"===V?.type||"tile"===ba.resultType||(ba.cacheHint=!0))};b.applyTextFormattingHTML=
H;b.createfieldInfoMap=function(R,V){const ba=new Map;if(!R)return ba;R.forEach(ea=>{const ha=a(ea.fieldName,V);ea.fieldName=ha;ba.set(ha.toLowerCase(),ea)});return ba};b.findRelatedLayer=function(R,V,ba){return R&&V&&ba?U(R.allLayers,V,ba)||U(R.allTables,V,ba):null};b.fixTokens=n;b.formatAttributes=function({fieldInfos:R,attributes:V,layer:ba,graphic:ea,fieldInfoMap:ha,relatedInfos:la}){const ia={};la?.forEach(na=>S({attributes:ia,relatedInfo:na,fieldInfoMap:ha,fieldInfos:R,layer:ba}));V&&Object.keys(V).forEach(na=>
{ia[na]=N({fieldName:na,fieldInfos:R,fieldInfoMap:ha,layer:ba,value:V[na],graphic:ea})});return ia};b.formatEditInfo=function(R,V){const {creatorField:ba,creationDateField:ea,editorField:ha,editDateField:la}=R;if(V){R=V[la];if("number"===typeof R)return V=V[ha],{type:"edit",date:m.formatDate(R,aa),user:V};R=V[ea];return"number"===typeof R?(V=V[ba],{type:"create",date:m.formatDate(R,aa),user:V}):null}};b.formatValueToFieldInfo=h;b.getAllFieldInfos=function(R){const V=[];if(!R)return V;const {fieldInfos:ba,
content:ea}=R;ba&&V.push(...ba);if(!ea||!Array.isArray(ea))return V;ea.forEach(ha=>{"fields"===ha.type&&(ha=ha&&ha.fieldInfos)&&V.push(...ha)});return V};b.getFieldInfo=d;b.getFieldInfoLabel=function(R,V){return(V=D(V,R?.fieldName))?V.title||null:R?R.label||R.fieldName:null};b.getFixedFieldName=a;b.getFixedFieldNames=function(R,V){return R&&R.map(ba=>a(ba,V))};b.getSourceLayer=function(R){if(null!=R)return R.get("sourceLayer")||R.get("layer")};b.graphicCallback=async function(R,V){return"function"===
typeof R?R(V):R};b.htmlEntities=function(R){return R.replaceAll(Q,V=>`&#${V.charCodeAt(0)};`)};b.isExpressionField=t;b.isFeatureSupportedLayer=O;b.isGraphicForRelatableFeatureSupportedLayer=function(R){return!!R&&"object"===typeof R&&"sourceLayer"in R&&f(R.sourceLayer)};b.isRelatableFeatureSupportedLayer=f;b.isRelatableLayer=C;b.isRelatedField=I;b.preLayerQueryCallback=({query:R,layer:V,method:ba})=>{Z({layer:V,method:ba,query:R,definitionExpression:`${V.definitionExpression} ${V.serviceDefinitionExpression}`})};
b.preRequestCallback=({queryPayload:R,layer:V,method:ba})=>{Z({layer:V,method:ba,query:R,definitionExpression:`${V.definitionExpression} ${V.serviceDefinitionExpression}`})};b.querySourceLayer=E;b.queryUpdatedFeature=async function({graphic:R,popupTemplate:V,layer:ba,spatialReference:ea},ha){if(ba&&V&&("function"===typeof ba.load&&await ba.load(ha),R.attributes)){var la=R.attributes[ba.objectIdField];if(null!=la){la=[la];var ia=await V.getRequiredFields(ba.fieldsIndex),na=F.featureHasFields(ia,R);
ia=na?[]:ia;V=V.returnGeometry||await r(V);if(!na||V)if(ba=await E({layer:ba,graphic:R,outFields:ia,objectIds:la,returnGeometry:V,spatialReference:ea},ha))ba.geometry&&(R.geometry=ba.geometry),ba.attributes&&(R.attributes={...R.attributes,...ba.attributes})}}};b.shouldOpenInNewTab=function(R=""){if(R)return!W.test(R.trim().toLowerCase())};b.substituteAttributes=u;b.substituteFieldsInLinksAndAttributes=function({attributes:R,globalAttributes:V,layer:ba,text:ea,expressionAttributes:ha,fieldInfoMap:la}){return ea?
u({formattedAttributes:V,template:p(ea,{...V,...ha,...R},ba),fieldInfoMap:la}):""};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Attachments/support/attachmentUtils":function(){define(["exports","../../../assets"],function(b,e){b.getIconPath=function(c){const m=e.getAssetUrl("esri/themes/base/images/files/");return c?"text/plain"===c?`${m}text-32.svg`:"application/pdf"===c?`${m}pdf-32.svg`:"text/csv"===c?`${m}csv-32.svg`:"application/gpx+xml"===c?`${m}gpx-32.svg`:"application/x-dwf"===
c?`${m}cad-32.svg`:"application/postscript"===c||"application/json"===c||"text/xml"===c||"model/vrml"===c?`${m}code-32.svg`:"application/x-zip-compressed"===c||"application/x-7z-compressed"===c||"application/x-gzip"===c||"application/x-tar"===c||"application/x-gtar"===c||"application/x-bzip2"===c||"application/gzip"===c||"application/x-compress"===c||"application/x-apple-diskimage"===c||"application/x-rar-compressed"===c||"application/zip"===c?`${m}zip-32.svg`:c.includes("image/")?`${m}image-32.svg`:
c.includes("audio/")?`${m}sound-32.svg`:c.includes("video/")?`${m}video-32.svg`:c.includes("msexcel")||c.includes("ms-excel")||c.includes("spreadsheetml")?`${m}excel-32.svg`:c.includes("msword")||c.includes("ms-word")||c.includes("wordprocessingml")?`${m}word-32.svg`:c.includes("powerpoint")||c.includes("presentationml")?`${m}report-32.svg`:`${m}generic-32.svg`:`${m}generic-32.svg`};b.isSupportedImage=function(c){c=c.toLowerCase();return"image/bmp"===c||"image/emf"===c||"image/exif"===c||"image/gif"===
c||"image/x-icon"===c||"image/jpeg"===c||"image/png"===c||"image/tiff"===c||"image/x-wmf"===c};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/FeatureForm":function(){define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../intl ../core/arrayUtils ../core/compilerUtils ../core/deprecate ../core/Logger ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ./Widget ./FeatureForm/css ./FeatureForm/featureFormUtils ./FeatureForm/FeatureFormViewModel ./support/componentsUtils ./support/Heading ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory ../chunks/datetime ../intl/substitute ../intl/locale".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a,g,u,v,k,n,p,y,O,C,f,h,d,l){const q=P.getLogger("esri.widgets.FeatureForm");m=function(H){function N(r,I){var M=H.call(this,r,I)||this;M._dateFieldInputMap=new Map;M._activeInputName="";M._activeNumberFieldEdit=null;M._fieldFocusNeeded=!1;M._fieldToInitialIncompatibleDomainValue=new Map;M._switchFieldsWithInitialIncompatibleValue=new Set;M._userUpdatedFieldInputNames=new Set;M._listObserverNode=null;M._listObserver=new IntersectionObserver(S=>{S.length&&S[0].isIntersecting&&
M._incrementRelatedRecordPage()},{root:window.document});M.groupDisplay="all";M.headingLevel=2;M.messages=null;M.messagesCommon=null;M.messagesFeature=null;M.messagesTemplates=null;M.viewModel=new k;M._onShowAllRelatedRecordsClick=S=>{const {feature:U,relatedRecordCallbacks:G}=e._assertThisInitialized(M);U&&G?.showAllRelatedRecords&&G.showAllRelatedRecords({parentFeature:U,relationshipId:S})};M._onAddRelatedRecordsClick=(S,U)=>{const {feature:G,relatedRecordCallbacks:J}=e._assertThisInitialized(M);
G&&J?.addRelatedRecord&&J.addRelatedRecord({parentFeature:G,relatedLayer:U,relationshipId:S})};M._handleInputInput=S=>{M._commitInputValue(S.currentTarget)};M._handleFormKeyDown=M._handleFormKeyDown.bind(e._assertThisInitialized(M));M._handleInputBlur=M._handleInputBlur.bind(e._assertThisInitialized(M));M._handleInputFocus=M._handleInputFocus.bind(e._assertThisInitialized(M));M._handleNumberInputMouseDown=M._handleNumberInputMouseDown.bind(e._assertThisInitialized(M));M._handleInputKeyDown=M._handleInputKeyDown.bind(e._assertThisInitialized(M));
M._handleOptionChange=M._handleOptionChange.bind(e._assertThisInitialized(M));M._handleGroupClick=M._handleGroupClick.bind(e._assertThisInitialized(M));M._handleSubmit=M._handleSubmit.bind(e._assertThisInitialized(M));M._afterInputCreateOrUpdate=M._afterInputCreateOrUpdate.bind(e._assertThisInitialized(M));M._afterDateInputCreateOrUpdate=M._afterDateInputCreateOrUpdate.bind(e._assertThisInitialized(M));return M}e._inherits(N,H);var E=N.prototype;E.initialize=function(){this.addHandles([z.watch(()=>
this.feature,()=>{this._activeInputName=this._getFocusableInput("forward")?.name||"";this._userUpdatedFieldInputNames.clear();this._fieldToInitialIncompatibleDomainValue.clear();this._switchFieldsWithInitialIncompatibleValue.clear();this._dateFieldInputMap.clear();this._fieldFocusNeeded=!0}),this.on("submit",r=>{if(0<r.invalid.length){const [I]=r.invalid;r.invalid.forEach(M=>this._userUpdatedFieldInputNames.add(M));this._activeInputName=I;this._fieldFocusNeeded=!0;this.scheduleRender()}}),z.watch(()=>
[this.viewModel.activeRelationshipInput,this._listObserverNode],()=>this._onObserverChange())])};E.loadDependencies=function(){return n.loadCalciteComponents({button:()=>new Promise((r,I)=>b(["../chunks/calcite-button"],r,I)),combobox:()=>new Promise((r,I)=>b(["../chunks/calcite-combobox"],r,I)),"combobox-item":()=>new Promise((r,I)=>b(["../chunks/calcite-combobox-item"],r,I)),"combobox-item-group":()=>new Promise((r,I)=>b(["../chunks/calcite-combobox-item-group"],r,I)),icon:()=>new Promise((r,I)=>
b(["../chunks/calcite-icon"],r,I)),"input-date-picker":()=>new Promise((r,I)=>b(["../chunks/calcite-input-date-picker"],r,I)),"input-message":()=>new Promise((r,I)=>b(["../chunks/calcite-input-message"],r,I)),"input-time-picker":()=>new Promise((r,I)=>b(["../chunks/calcite-input-time-picker"],r,I)),list:()=>new Promise((r,I)=>b(["../chunks/calcite-list"],r,I)),"list-item":()=>new Promise((r,I)=>b(["../chunks/calcite-list-item"],r,I)),loader:()=>new Promise((r,I)=>b(["../chunks/calcite-loader"],r,
I)),notice:()=>new Promise((r,I)=>b(["../chunks/calcite-notice"],r,I)),progress:()=>new Promise((r,I)=>b(["../chunks/calcite-progress"],r,I)),switch:()=>new Promise((r,I)=>b(["../chunks/calcite-switch"],r,I))})};E.destroy=function(){this._listObserverNode&&this._listObserver.unobserve(this._listObserverNode)};E.getValues=function(){return this.viewModel.getValues()};E.submit=function(){return this.viewModel.submit()};E.render=function(){const {state:r}=this.viewModel;return f.tsx("div",{class:this.classes(u.CSS.base,
u.CSS.widget,u.CSS.panel)},"ready"===r?this._renderForm():null)};E._renderForm=function(){return f.tsx("form",{class:u.CSS.form,novalidate:!0,onsubmit:this._handleSubmit,onkeydown:this._handleFormKeyDown},this._renderHeader(),this._renderInputs())};E._renderHeader=function(){var r=this.viewModel;if(r.formHeaderVisible){var I=null!=r.formTitle&&f.tsx(p.Heading,{key:"title",level:this.headingLevel},r.formTitle);r=null!=r.formDescription&&f.tsx("p",{class:u.CSS.description,key:"description"},r.formDescription);
return f.tsx("div",{class:u.CSS.formHeader},I,r)}};E._renderInputs=function(){const {viewModel:r}=this;return r.activeRelationshipInput?this._renderActiveRelationshipInput(r.activeRelationshipInput):r.inputs.filter(w.isSome).filter(I=>I.visible).map((I,M)=>{if(v.isGroupInput(I))return this._renderGroup(I,M);if(v.isFieldInput(I))return this._renderLabeledField(I);if(v.isRelationshipInput(I))return this._renderRelationshipInput(I)})};E._renderActiveRelationshipInput=function(r){return this._renderRelationshipInput(r)};
E._renderDescriptionOrEmpty=function(r,I){return null==r?null:f.tsx("div",{class:this.classes(u.CSS.description),id:I},r)};E._renderGroup=function(r,I){const {formTemplate:M,disabled:S}=this,{description:U,inputs:G,label:J,state:L}=r,B=G.filter(R=>R.visible);var A=this.viewModel.findField(this._activeInputName);A=!(!A||A.group!==r);const x=`${this.id}_group_${I}`,Q=`${this.id}_group-label_${I}`,T=`${this.id}_group-description_${I}`,W=this._renderDescriptionOrEmpty(U,T),aa="sequential"===this.groupDisplay,
Y=aa?A:"expanded"===L,Z=Y?u.CSS.collapseIcon:u.CSS.expandIcon;return f.tsx("fieldset",{"aria-expanded":Y.toString(),"aria-labelledby":Q,"aria-describedby":U?T:"",class:this.classes(u.CSS.group,aa?u.CSS.groupSequential:null,Y?null:u.CSS.groupCollapsed,A?u.CSS.groupActive:null,S?u.CSS.inputDisabled:null),disabled:S,"data-group":r,id:x,key:I,onclick:this._handleGroupClick},f.tsx("button",{role:aa?"presentation":void 0,class:u.CSS.groupHeader,type:"button",tabIndex:aa?-1:0},f.tsx("div",{class:u.CSS.groupTitle},
f.tsx(p.Heading,{class:u.CSS.groupLabel,id:Q,level:null!=M&&M.title?p.incrementHeadingLevel(this.headingLevel):this.headingLevel},J),W),aa?null:f.tsx("span",{class:this.classes(Z,u.CSS.groupToggleIcon)})),B.map(R=>{if(v.isFieldInput(R))return this._renderLabeledField(R);if(v.isRelationshipInput(R))return this._renderRelationshipInput(R)}))};E._getFocusableInput=function(r,I){var M=this.viewModel.allFieldInputs;M="forward"===r?M:M.slice().reverse();!I||v.isRelationshipInput(I)?r=0:v.isGroupInput(I)?
r=(r=I.inputs.find(v.isFieldInput))?M.indexOf(r):0:(v.isInputInGroupInput(I)&&"collapsed"===I.group.state?(I=I.group.inputs.filter(v.isFieldInput),r="forward"===r?I[I.length-1]:I[0]):r=I,r=M.indexOf(r)+1);for(;r<M.length;r++)if(I=M[r],I.visible&&v.isFieldInput(I))return I;return null};E._renderLabeledField=function(r){const {dataType:I,feature:M,label:S,layer:U}=r;return f.tsx("label",{key:`${U.id}-${M.uid}-${r.name}`,class:u.CSS.label},[S,"unsupported"!==I?this._renderFieldInput(r):this._renderUnsupportedField(r),
this._renderAuxiliaryText(r)])};E._renderFieldInput=function(r){const {dataType:I,domain:M,name:S,updating:U,value:G}=r,J=this.getCommonInputProps(r);if("coded-value"===M?.type){if(v.isFieldElementWithInputType(r.element,"switch")){const {element:L}=r;if(this._switchFieldsWithInitialIncompatibleValue.has(S)||null==G||L.input.onValue!==G&&L.input.offValue!==G)this._switchFieldsWithInitialIncompatibleValue.add(S);else return this._renderSwitchFieldInput(r,J)}return"radio-buttons"===r.inputType?this._renderRadioButtonsFieldInput(r,
M.codedValues.map(({code:L,name:B})=>({value:L,name:B})),J):this._renderSelectFieldInput(r,this._getFieldValueOptions(S,M),J)}if("datetime-picker"===r.inputType||"date"===I)return this._renderDateFieldInput(r,J);r="number"===I?f.tsx("input",{type:"number",...J,value:null!=this._activeNumberFieldEdit&&this._activeNumberFieldEdit.fieldName===r.name?this._activeNumberFieldEdit.value:`${J.value}`}):"text-area"===r.inputType?f.tsx("textarea",{...J}):f.tsx("input",{type:"text",...J});return U?f.tsx("div",
{key:`${J.key}-input-updating-wrapper`,class:u.CSS.fieldInputWrapper},r,f.tsx("div",{class:u.CSS.fieldInputLoader},f.tsx("calcite-progress",{type:"indeterminate"}))):r};E._renderDateFieldInput=function(r,I){const {dateDataType:M,includeTime:S,label:U,name:G,valid:J,value:L}=r,{readOnly:B,required:A}=I;if("string"===M)return this._renderUnsupportedField(r,v.formatDateFieldValue(r.field,I.value));const {date:x,time:Q}=this._formatValueForDateInputs(L);r=null!=I.max?this._formatValueForDateInputs(I.max):
void 0;var T=null!=I.min?this._formatValueForDateInputs(I.min):void 0;r=r?.date??void 0;T=T?.date??void 0;const W={afterCreate:this._afterDateInputCreate,afterUpdate:this._afterDateInputCreateOrUpdate,"aria-invalid":!J,label:U,numberingSystem:"latn",overlayPositioning:"fixed",readOnly:B,required:A,tabIndex:0,["data-field-name"]:G};return f.tsx("div",{key:`${I.key}-date-time-container`,class:u.CSS.dateInputContainer},f.tsx("calcite-input-date-picker",{bind:this,...W,class:this.classes(I.class,u.CSS.inputDate),
"data-date-part":"date",key:`${I.key}-date-input`,valueAsDate:x??void 0,maxAsDate:r,minAsDate:T,onCalciteInputDatePickerChange:aa=>this._commitDateChanges(aa.target),onblur:aa=>this._commitDateChanges(aa.target,!0)}),S?f.tsx("calcite-input-time-picker",{bind:this,...W,class:this.classes(I.class,u.CSS.inputTime),"data-date-part":"time",key:`${I.key}-time-input`,value:Q??void 0,step:1,onCalciteInputTimePickerChange:aa=>this._commitDateChanges(aa.target),onfocus:aa=>{aa.target.calciteTimePickerEl&&(aa.target.calciteTimePickerEl.showSecond=
!0)},onblur:aa=>this._commitDateChanges(aa.target,!0)}):null)};E._renderUnsupportedField=function(r,I){r=this.getCommonInputProps(r);return f.tsx("input",{afterCreate:r.afterCreate,afterUpdate:r.afterUpdate,class:this.classes(u.CSS.input,u.CSS.fieldInput,u.CSS.inputDisabled),onfocus:r.onfocus,readOnly:!0,tabIndex:r.tabIndex,type:"text",value:null!=I?`${I}`:r.value,["data-field-name"]:r["data-field-name"]})};E._renderSelectFieldInput=function(r,I,M){const {element:S,required:U,value:G}=r,{messages:J,
messagesTemplates:L}=this;var B=I.map(Q=>Q.map(T=>f.tsx("calcite-combobox-item",{value:`${T.value}`,textLabel:T.name,key:`#${T.value}`,selected:G===T.value})));const [A,x]=B;this._registerIncompatibleValue(G,I.flat(),r,Q=>{x.unshift(f.tsx("calcite-combobox-item",{value:`${Q}`,textLabel:`${Q}`,key:"incompatible-option",readOnly:!0}))});r=0<x.length?[f.tsx("calcite-combobox-item-group",{key:"recommended",label:J.recommended},A),f.tsx("calcite-combobox-item-group",{key:"other",label:L.other},x)]:A;B=
null==S;I=v.isFieldElementWithInputType(S,"combo-box");B=B||I&&S.input?.showNoValueOption;!U&&B&&r.unshift(f.tsx("calcite-combobox-item",{value:"",textLabel:J.empty,key:"empty-option"},I&&S.input.noValueOptionLabel||J.empty));return f.tsx("calcite-combobox",{...M,selectionMode:"single",disabled:M.readOnly,allowCustomValues:!1,clearDisabled:!0,onCalciteComboboxChange:Q=>this._handleOptionChange(Q.target)},r)};E._registerIncompatibleValue=function(r,I,M,S){const U=this._fieldToInitialIncompatibleDomainValue,
G=U.has(M.name);if(G||null!=r&&""!==r&&!I.some(J=>J.value===r))G||U.set(M.name,r),S?.(r)};E._renderRadioButtonsFieldInput=function(r,I,M){const {element:S,name:U,required:G,value:J}=r,L=I.map(B=>this._renderRadioButton({key:B.name,label:B.name,name:U,value:B.value,selected:B.value===J,props:M}));this._registerIncompatibleValue(J,I,r);I=null==S;r=v.isFieldElementWithInputType(S,"radio-buttons");I=I||r&&S.input?.showNoValueOption;!G&&I&&L.unshift(this._renderRadioButton({key:"empty-option",label:r&&
S.input.noValueOptionLabel||this.messages.empty,name:U,value:"",selected:""===J||null===J,props:M}));return f.tsx("div",{key:`${M.key}-radio`,class:u.CSS.inputRadioGroup},L)};E._renderSwitchFieldInput=function(r,I){const {value:M}=r;r=v.isFieldElementWithInputType(r.element,"switch")?M===r.element.input.onValue:!1;return f.tsx("calcite-switch",{...I,class:u.CSS.inputSwitch,onCalciteSwitchChange:S=>this._commitInputValue(S.target),checked:r,disabled:I.readOnly})};E._renderRadioButton=function({key:r,
name:I,value:M,selected:S,label:U,props:G}){return f.tsx("label",{key:r,class:u.CSS.inputRadioLabel},f.tsx("input",{...G,class:u.CSS.inputRadio,name:I,type:"radio",value:M,checked:S,disabled:G.readOnly,onchange:J=>this._commitInputValue(J.target)}),U)};E._renderAuxiliaryText=function(r){const I=this._userUpdatedFieldInputNames.has(r.name)&&!r.valid?v.getErrorMessageForFieldInput(r,this.messages):null!=this.viewModel.contingencyConstraintViolations.get(r.name)?this.messages.validationErrors.valuesIncompatible:
null!=r.valueExpressionExecutor&&r.valueExpressionExecutor.stale?this.messages.valueExpressionError:null;return null!=I?f.tsx("calcite-input-message",{status:"invalid",icon:!0},I):this._renderDescriptionOrEmpty(r.description)};E._renderShowAllRelatedRecordsListItem=function(r){const {featureCount:I,relationshipId:M,showAllActionVisible:S}=r;({relatedRecordCallbacks:r}=this);if(S&&r?.showAllRelatedRecords)return r=this.messages,f.tsx("calcite-list-item",{description:d.substitute(r.totalCount,{count:I}),
label:r.showAll,value:!0,onCalciteListItemSelect:()=>this._onShowAllRelatedRecordsClick(M)},f.tsx("calcite-icon",{slot:"content-end",scale:"s",icon:"list"}))};E._renderAddRelatedRecordButton=function(r){const {canAddRelatedFeature:I,relationshipId:M,relatedLayer:S}=r,{relatedRecordCallbacks:U}=this;if(I&&U?.addRelatedRecord&&S)return f.tsx("calcite-button",{alignment:"center",appearance:"outline-fill",class:u.CSS.centeredButton,disabled:r.updating,iconStart:"plus",key:`${M}-add-button`,round:!0,scale:"s",
width:"half",onclick:()=>this._onAddRelatedRecordsClick(M,S)},this.messages.addRecord)};E._renderRelatedRecordListItem=function(r,I){const {feature:M,description:S,title:U}=r,{feature:G,relatedRecordCallbacks:J}=this;return f.tsx("calcite-list-item",{bind:this,description:S,label:U,key:`${I}-${M.uid}`,value:U,onclick:()=>{J?.editRelatedRecord&&G&&J.editRelatedRecord({parentFeature:G,relationshipId:I,relatedFeature:M})}},f.tsx("calcite-icon",{slot:"content-start",scale:"m",icon:v.getIconForFeature(M)}),
f.tsx("calcite-icon",{slot:"content-end",scale:"s",icon:"chevron-right"}))};E._renderRelationshipInput=function(r){if(this._relatedRecordsEnabled&&r.editable){var {featureCount:I,relationshipId:M,showAllEnabled:S}=r,U=S?null:this._renderDescriptionOrEmpty(r.description),G=0<I?this._renderRelatedRecordsList(r):r.loaded?this._renderNoRelatedRecordsNotice():void 0;return f.tsx("label",{class:this.classes(u.CSS.label,u.CSS.relationshipLabel),key:`relationship-${M}-container`},f.tsx("div",null,this._renderRelatedRecordsHeaderContainer(r),
U,G),this._renderAddRelatedRecordButton(r))}};E._renderRelatedRecordsHeaderContainer=function(r){const I=r.updating||!r.loaded;return f.tsx("div",{class:u.CSS.relatedRecordsHeader,key:`relationship-${r.relationshipId}-header`},f.tsx("span",null,r.label),I?f.tsx("calcite-loader",{label:this.messagesCommon?.loading,inline:!0,key:"loader",scale:"s",type:"indeterminate"}):void 0)};E._renderRelatedRecordsList=function(r){const {relationshipId:I}=r;return f.tsx("calcite-list",{class:u.CSS.relatedRecordsList},
r.relatedFeatureInfos.map(M=>this._renderRelatedRecordListItem(M,I)),this._renderShowAllRelatedRecordsListItem(r),this._renderObserverNode())};E._renderNoRelatedRecordsNotice=function(){return f.tsx("calcite-notice",{open:!0,scale:"s",kind:"brand",icon:"information",width:"full"},f.tsx("div",{slot:"message"},this.messagesFeature.noRelatedFeatures))};E._renderObserverNode=function(){if(this.viewModel.activeRelationshipInput?.showAllEnabled)return f.tsx("div",{key:"feature-observer",class:u.CSS.listObserver,
bind:this,afterCreate:this._afterListObserverCreated,afterRemoved:this._afterListObserverRemoved})};E.getCommonInputProps=function(r){const {disabled:I,groupDisplay:M}=this,{dataType:S,editable:U,group:G,hint:J,label:L,maxLength:B,minLength:A,name:x,required:Q,valid:T,value:W}=r,aa=this._userUpdatedFieldInputNames.has(x),Y=!U||I,Z="all"===M&&null!=G&&"collapsed"===G.state;return{afterCreate:this._afterInputCreateOrUpdate,afterUpdate:this._afterInputCreateOrUpdate,"aria-invalid":T?"false":"true",class:this.classes(u.CSS.input,
u.CSS.fieldInput,Y?u.CSS.inputDisabled:null,aa&&!T?u.CSS.inputInvalid:null),key:x,label:L,minlength:-1<A?`${A}`:"",maxlength:-1<B?`${B}`:"",...r.range,readOnly:Y,value:null==W?"":`${W}`,["data-field-name"]:x,onfocus:this._handleInputFocus,oninput:this._handleInputInput,onblur:this._handleInputBlur,onkeydown:this._handleInputKeyDown,onmousedown:"number"===S?this._handleNumberInputMouseDown:void 0,placeholder:"number"===S||"text"===S?J??void 0:"",required:Q,tabIndex:Z?-1:0}};E._handleNumberInputMouseDown=
function({target:r}){r.focus();this.scheduleRender()};E._getFieldValueOptions=function(r,I){I=I.codedValues.map(({code:M,name:S})=>({value:M,name:S}));r=this.viewModel.fieldsWithContingentValues.has(r)?this._getContingentValueOptions(r):[];if(0<r.length){const M=new Set(r.map(S=>S.value));I=I.filter(S=>!M.has(S.value));return[r,I]}return[I,[]]};E._getContingentValueOptions=function(r){const I={};for(var M of this.viewModel.allFieldInputs){const {name:U,value:G}=M;null!=G&&U!==r&&this.viewModel.fieldsWithContingentValues.has(U)&&
(I[U]=G)}var S=this.viewModel.joinedContingentValues.slice();M=new Map;for(const U of S){S=U.values[r];if(null==S||"code"!==S.objectType&&"null"!==S.objectType)continue;const {code:G,name:J}=S.codedValue&&"null"!==S.objectType?S.codedValue:{code:"",name:this.messages.empty};M.has(G)||Object.entries(I).every(([L,B])=>!U.values.hasOwnProperty(L)||this._valueIsValidContingentValue(B,U.values[L]))&&M.set(G,{name:J,value:G})}return[...M.values()]};E._getFieldInputFromHTMLElement=function(r){return this.viewModel.findField(r.getAttribute("data-field-name"))};
E._afterDateInputCreate=async function(r){this._afterDateInputCreateOrUpdate(r)};E._afterDateInputCreateOrUpdate=function(r){const {name:I}=this._getFieldInputFromHTMLElement(r),M=this._dateFieldInputMap.get(I),S="valueAsDate"in r;null!=M?S?M.date=r:M.time=r:this._dateFieldInputMap.set(I,{[S?"date":"time"]:r});this._afterInputCreateOrUpdate(r)};E._afterInputCreateOrUpdate=function(r){var {viewModel:I}=this;const M=this._getFieldInputFromHTMLElement(r);I=I.findField(this._activeInputName);const S=
this._fieldToInitialIncompatibleDomainValue.get(M.name)===M.value;this._fieldFocusNeeded&&I===M&&("radio-buttons"!==M.inputType||S||r.checked)&&(this._fieldFocusNeeded=!1,v.isInputInGroupInput(M)&&(M.group.state="expanded"),r.focus())};E._handleInputFocus=function(r){r=r.target;const I=this._getFieldInputFromHTMLElement(r);this._activeInputName=I.name;v.isNumberFieldInput(I)&&(this._activeNumberFieldEdit={fieldName:I.name,input:r,value:r.value})};E._handleInputBlur=function(r){r=r.target;const I=
this._getFieldInputFromHTMLElement(r);"number"===I.dataType&&null!=this._activeNumberFieldEdit&&(this._activeNumberFieldEdit.input.value=`${I.value}`,this._activeNumberFieldEdit=null);this._commitInputValue(r);this.scheduleRender()};E._commitDateChanges=function(r,I=!1){const {name:M}=this._getFieldInputFromHTMLElement(r);if(this._dateFieldInputMap.has(M)){var S=this._dateFieldInputMap.get(M);S&&S.date&&(r=this._getFieldValueFromDateInput(r),S=this._getFieldValueFromDateInputs(S.date,S.time),this.viewModel.getValue(M)!==
S&&(null===r||null===S?I&&this._updateFieldValue(M,null):this._updateFieldValue(M,S)))}};E._commitInputValue=function(r){const I=this._getFieldInputFromHTMLElement(r);null!=this._activeNumberFieldEdit&&v.isNumberFieldInput(I)&&(this._activeNumberFieldEdit.value=r.value);this._updateFieldValue(I.name,this._parseValue(r))};E._handleInputKeyDown=function(r){const {key:I,altKey:M,ctrlKey:S,metaKey:U}=r;var G=this._getFieldInputFromHTMLElement(r.target);if("Enter"!==I){var {type:J}=G.field;G="single"===
J||"double"===J;if(!("integer"!==J&&"small-integer"!==J&&!G||M||S||U)&&1===I.length){J=Number(I);const L=["-","+"],B=["e","."];G=G?[...L,...B]:L;isNaN(J)&&!G.includes(I)&&r.preventDefault()}}else v.isInputInGroupInput(G)&&"collapsed"===G.group.state&&(G.group.state="expanded")};E._updateFieldValue=function(r,I){this.viewModel.setValue(r,I);this._userUpdatedFieldInputNames.add(r);this.viewModel.fieldsWithContingentValues.has(r)&&(r=Object.fromEntries(Object.entries(this.getValues()).filter(([,M])=>
null!=M)),this.viewModel.validateContingencyConstraints(r))};E._parseValue=function(r){const I=this._getFieldInputFromHTMLElement(r),M=r.value;if(v.isFieldElementWithInputType(I.element,"switch")&&"CALCITE-COMBOBOX"!==r.tagName)return r.checked?I.element.input.onValue:I.element.input.offValue;if("radio-buttons"===I.inputType&&"radio"===r.type&&!r.checked)return I.value;({dataType:r}=I);return"number"===r?M?parseFloat(M):null:M};E._handleOptionChange=function(r){this._commitInputValue(r);this.scheduleRender()};
E._handleGroupClick=function(r){const I=r.currentTarget["data-group"],M="expanded"===I.state,S="sequential"===this.groupDisplay,U=`.${u.CSS.groupHeader}`;if(!M||r.target.closest(U)){this._activeInputName=this._getFocusableInput("forward",I)?.name||"";if(S){r=r.target.closest(U);if(M&&!r)return;this.viewModel.inputs.forEach(G=>{v.isGroupInput(G)&&G!==I&&(G.state="collapsed")})}I.state=M?"collapsed":"expanded";this._fieldFocusNeeded=S;this.scheduleRender()}};E._handleSubmit=function(r){r.preventDefault()};
E._handleFormKeyDown=function(r){"Enter"===r.key&&this.viewModel.submit()};E._getDefaultLocaleOptions=function(){return{locale:l.getLocale(),numberingSystem:"latn"}};E._getFieldValueFromDateInputs=function(r,I){var M=this._getDateTimeFromInput(r);I=this._getDateTimeFromInput(I);if(!M&&!I)return null;r=this._getFieldInputFromHTMLElement(r).range;const S=Date.now();r=h.DateTime.fromMillis(null!=r.max&&r.max<S?r.max:S,this._getDefaultLocaleOptions());M=M||r;const {year:U,month:G,day:J}=M,{hour:L,minute:B,
second:A}=I||r;M=M.set({year:U,month:G,day:J,hour:L,minute:B,second:A});return M.isValid?M.toMillis():null};E._getDateTimeFromInput=function(r){if(!r)return null;let I=null;if("valueAsDate"in r){r=r.valueAsDate;if(!r||Array.isArray(r))return null;I=h.DateTime.fromJSDate(r)}else{if(!r.value)return null;I=h.DateTime.fromFormat(r.value,"TT",this._getDefaultLocaleOptions())}return I??null};E._getFieldValueFromDateInput=function(r){return this._dateTimeToFieldValue(this._getDateTimeFromInput(r))};E._dateTimeToFieldValue=
function(r){return r?.isValid?r.toMillis():null};E._dateTimeFromFieldValue=function(r){return null===r?null:h.DateTime.fromMillis(r,this._getDefaultLocaleOptions())};E._formatValueForDateInputs=function(r){return null==r||isNaN(r)?{date:null,time:null}:(r=this._dateTimeFromFieldValue(r))?{date:r.toJSDate(),time:r.toFormat("TT",this._getDefaultLocaleOptions())}:{date:null,time:null}};E._valueIsValidContingentValue=function(r,I){switch(I.objectType){case "any":return!0;case "null":return null==r;case "code":return r===
I.codedValue?.code;case "range":return null!=r&&null!=I.minValue&&null!=I.maxValue&&+r>=I.minValue&&+r<=I.maxValue;default:return F.neverReached(I.objectType),!1}};E._afterListObserverCreated=function(r){this.viewModel.activeRelationshipInput&&(this._listObserverNode=r)};E._afterListObserverRemoved=function(){this._listObserverNode=null};E._onObserverChange=async function(){this._listObserverNode&&this._listObserver.unobserve(this._listObserverNode);const r=this.viewModel.activeRelationshipInput;
if(r){var {showAllEnabled:I,updating:M}=r;this._listObserverNode&&!M&&I&&this._listObserver.observe(this._listObserverNode)}};E._incrementRelatedRecordPage=function(){this.viewModel.activeRelationshipInput?.incrementPage()};e._createClass(N,[{key:"_relatedRecordsEnabled",get:function(){const r=this.relatedRecordCallbacks;return!(!r||!(r.addRelatedRecord||r.editRelatedRecord||r.showAllRelatedRecords))}},{key:"disabled",get:function(){return this.viewModel.disabled},set:function(r){this.viewModel.disabled=
r}},{key:"feature",get:function(){return this.viewModel.feature},set:function(r){this.viewModel.feature=r}},{key:"formTemplate",get:function(){return this.viewModel.formTemplate},set:function(r){this.viewModel.formTemplate=r}},{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(r){this._overrideIfSome("label",r)}},{key:"layer",get:function(){return this.viewModel.layer},set:function(r){this.viewModel.layer=r}},{key:"map",get:function(){return this.viewModel.map},set:function(r){this.viewModel.map=
r}},{key:"relatedRecordCallbacks",get:function(){return this.viewModel.relatedRecordCallbacks},set:function(r){this.viewModel.relatedRecordCallbacks=r}},{key:"relationshipId",get:function(){return this.viewModel.relationshipId},set:function(r){this.viewModel.relationshipId=r}},{key:"spatialReference",get:function(){return this.viewModel.spatialReference},set:function(r){this.viewModel.spatialReference=r}},{key:"strict",get:function(){return this.viewModel.strict},set:function(r){this.viewModel.strict=
r}},{key:"view",get:function(){K.deprecatedProperty(q,"view",{replacement:"Use FeatureForm.map instead.",version:"4.27"});return this.viewModel.view},set:function(r){K.deprecatedProperty(q,"view",{replacement:"Use FeatureForm.map instead.",version:"4.27"});this.viewModel.view=r}}]);return N}(g);c.__decorate([t.property()],m.prototype,"_listObserverNode",void 0);c.__decorate([t.property()],m.prototype,"_relatedRecordsEnabled",null);c.__decorate([t.property()],m.prototype,"disabled",null);c.__decorate([t.property()],
m.prototype,"feature",null);c.__decorate([t.property()],m.prototype,"formTemplate",null);c.__decorate([t.property()],m.prototype,"groupDisplay",void 0);c.__decorate([t.property()],m.prototype,"headingLevel",void 0);c.__decorate([t.property()],m.prototype,"label",null);c.__decorate([t.property()],m.prototype,"layer",null);c.__decorate([t.property()],m.prototype,"map",null);c.__decorate([t.property(),O.messageBundle("esri/widgets/FeatureForm/t9n/FeatureForm")],m.prototype,"messages",void 0);c.__decorate([t.property(),
O.messageBundle("esri/t9n/common")],m.prototype,"messagesCommon",void 0);c.__decorate([t.property(),O.messageBundle("esri/widgets/Feature/t9n/Feature")],m.prototype,"messagesFeature",void 0);c.__decorate([t.property(),O.messageBundle("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],m.prototype,"messagesTemplates",void 0);c.__decorate([t.property()],m.prototype,"relatedRecordCallbacks",null);c.__decorate([t.property()],m.prototype,"relationshipId",null);c.__decorate([t.property()],m.prototype,
"spatialReference",null);c.__decorate([t.property()],m.prototype,"strict",null);c.__decorate([t.property()],m.prototype,"view",null);c.__decorate([t.property(),C.vmEvent(["value-change","submit"])],m.prototype,"viewModel",void 0);return m=c.__decorate([a.subclass("esri.widgets.FeatureForm")],m)})},"esri/widgets/FeatureForm/css":function(){define(["exports"],function(b){b.CSS={base:"esri-feature-form",form:"esri-feature-form__form",formHeader:"esri-feature-form__form-header",label:"esri-feature-form__label",
relationshipLabel:"esri-feature-form__relationship-label",fieldInputWrapper:"esri-feature-form__input-wrapper",fieldInputLoader:"esri-feature-form__input-loader",fieldInput:"esri-feature-form__input",inputDate:"esri-feature-form__input--date",inputTime:"esri-feature-form__input--time",inputRadioGroup:"esri-feature-form__input--radio-group",inputRadio:"esri-feature-form__input--radio",inputRadioLabel:"esri-feature-form__input--radio-label",inputDisabled:"esri-feature-form__input--disabled",inputSwitch:"esri-feature-form__input--switch",
inputInvalid:"esri-feature-form__input--invalid",centeredButton:"esri-feature-form__centered-button",description:"esri-feature-form__description-text",listObserver:"esri-feature-form__list-observer",relatedRecordsHeader:"esri-feature-form__related-records_header",relatedRecordsList:"esri-feature-form__related-records_list",dateInputContainer:"esri-feature-form__date-input-container",group:"esri-feature-form__group",groupLabel:"esri-feature-form__group-label",groupHeader:"esri-feature-form__group-header",
groupTitle:"esri-feature-form__group-title",groupToggleIcon:"esri-feature-form__group-toggle-icon",groupCollapsed:"esri-feature-form__group--collapsed",groupSequential:"esri-feature-form__group--sequential",groupActive:"esri-feature-form__group--active",collapseIcon:"esri-icon-up",expandIcon:"esri-icon-down",widget:"esri-widget",panel:"esri-widget--panel",input:"esri-input"};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/FeatureForm/featureFormUtils":function(){define("exports ../../intl ../../core/arrayUtils ../../core/string ../../intl/date ../../layers/support/domainUtils ../../layers/support/fieldUtils ../../intl/substitute".split(" "),
function(b,e,c,m,w,F,K,P){function z(f,h){h=h.map((d,l)=>{let q=f[l];d.domain&&"coded-value"===d.domain.type&&(l=d.domain.codedValues.find(H=>H.code===q),l?.name&&(q=l.name));K.isDateField(d)&&(q=t(d,q));return[d.name,q]});return Object.fromEntries(h)}function t(f,h){if(!f||null==h)return null;switch(f.type){case "date":return w.formatDate(h);case "date-only":return w.formatDateOnly(h);case "time-only":return w.formatTimeOnly(h);case "timestamp-offset":return w.formatTimestamp(h);default:return null}}
function D(f,h){return m.replace(m.replace(f,d=>`{${d.toLowerCase()}}`),Object.fromEntries(Object.entries(h).map(([d,l])=>[d.toLowerCase(),l])))}function a(f){return 1E7<=f||-1E7>=f}const g=f=>"field"===f?.type,u=f=>"relationship"===f?.type,v=f=>"field"===f.type,k=f=>f.reduce((h,d)=>"group"===d?.type?[...h,...d.inputs]:[...h,d],[]),n=(f,h)=>null!=f&&f.input?.type===h,p={typeFieldName:null,types:[]};e=new Set(["date-only","time-only","timestamp-offset"]);b.LengthValidationError=void 0;(b.LengthValidationError||
(b.LengthValidationError={})).TOO_SHORT="length-validation-error::too-short";const y={type:"number"},O={type:"number",intlOptions:{notation:"scientific"}},C={type:"date",intlOptions:{day:"2-digit",month:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}};b.capabilitiesAllowEditType=(f,h)=>{if(!f)return!0;({operations:f}=f);switch(h){case "INSERT":return f.supportsAdd;case "UPDATE":case "DELETE":return f.supportsUpdate;default:return!0}};b.flattenFieldInputs=f=>k(f).filter(g);
b.flattenInputs=k;b.flattenRelationshipInputs=f=>k(f).filter(u);b.formTemplateHasInvalidFields=function(f){return"formTemplate"in f&&f.formTemplate?(f.formTemplate.elements?.filter(v)??[]).some(({fieldName:h})=>!f.fieldsIndex.get(h)):!1};b.formatDateFieldValue=t;b.getComputedAttributes=z;b.getErrorMessageForFieldInput=(f,h)=>{const {dataType:d,domain:l,error:q,field:H,minLength:N,value:E,required:r}=f;return h&&q?r&&null===E?h.validationErrors.cannotBeNull:q===F.DomainValidationError.VALUE_OUT_OF_RANGE||
q===K.NumericRangeValidationError.OUT_OF_RANGE?(f=F.getDomainRange(l)||K.getFieldRange(H),P.substitute(h.validationErrors.outsideRange,f,{format:{max:"date"===d?C:a(f.max)?O:y,min:"date"===d?C:a(f.min)?O:y}})):q===F.DomainValidationError.INVALID_CODED_VALUE?h.validationErrors.invalidCodedValue:q===K.TypeValidationError.INVALID_TYPE?h.validationErrors.invalidType:q===b.LengthValidationError.TOO_SHORT?P.substitute(h.validationErrors.tooShort,{min:N}):null:null};b.getFieldsInTitleAndDesc=f=>{const h=
[];if(f.formTemplate){const {description:d,title:l}=f.formTemplate;f.fields?.forEach(q=>{const H=l&&m.templateHasKey(l,q.name),N=d&&m.templateHasKey(d,q.name);(H||N)&&h.push(q.name)})}return h};b.getIconForFeature=f=>{if(f){var h=f.layer;h=h&&"geometryType"in h?h.geometryType:void 0;f=f.geometry?.type;return"polyline"===f||"polyline"===h?"line":f||h||"table"}};b.getNormalizedFeatureTypeInfo=f=>f?"subtype-sublayer"===f.type?{typeFieldName:f.parent?.subtypeField,types:f.parent?.subtypes??[]}:"types"in
f&&f.types?{typeFieldName:f.typeIdField,types:f.types.map(({id:h,name:d,domains:l})=>({code:h,name:d,domains:l}))}:p:p;b.isFieldElement=v;b.isFieldElementWithInputType=n;b.isFieldElementWithTextInput=f=>null!=f&&(n(f,"text-box")||n(f,"text-area"));b.isFieldInput=g;b.isGroupElement=f=>"group"===f.type;b.isGroupInput=f=>"group"===f?.type;b.isInputInGroupInput=f=>"group"!==f?.type&&null!=f.group;b.isNumberFieldInput=({domain:f,inputType:h="text-box",dataType:d})=>"number"===d&&"text-box"===h&&(!f||"coded-value"!==
f.type);b.isRelationshipElement=f=>"relationship"===f.type;b.isRelationshipInput=u;b.isTemplateItemGroup=f=>"items"in f;b.parseFormTemplateString=function(f,h,d){var l=Object.keys(h).filter(H=>m.templateHasKey(f,H));const q=l.map(H=>h[H]);l=l.map(H=>d.get(H)).filter(c.isSome);return D(f,z(q,l))};b.substituteFieldTemplatesInString=D;b.unsupportedDateFieldTypes=e;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/FeatureForm/FeatureFormViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Graphic ../../core/deprecate ../../core/Evented ../../core/HandleOwner ../../core/Logger ../../core/maybe ../../core/Promise ../../core/reactiveUtils ../../core/string ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../form/FormTemplate ../../layers/support/ContingentValue ../../layers/support/editableLayers ../../layers/support/LayerContingentValuesCache ./featureFormUtils ./FieldInput ./FormExpressionArcadeExecutor ./FormExpressionsManager ./GroupInput ./RelationshipInput".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a,g,u,v,k,n,p,y,O,C,f,h,d,l,q){function H(S){if("field"===S.type||"group"===S.type||"relationship"===S.type)return!0;K.getLogger("esri.widgets.FeatureForm.FeatureFormViewModel").warn("form-info::unsupported-element-type","Only element types 'field', 'group' and 'relationship' are supported",`Element ${S.label} has unsupported type '${S.type}'`);return!1}const N=new c({attributes:{}}),E=["editableExpression","requiredExpression","valueExpression","visibilityExpression"],
r=["visibilityExpression"],I=["editableExpression","visibilityExpression"],M=K.getLogger("esri.widgets.FeatureForm.FeatureFormViewModel");c=function(S){function U(J){J=S.call(this,J)||this;J._expressionExecutorLookup=new Map;J._expressionsManager=null;J._contingentValuesCache=null;J._featureClone=N.clone();J._initialFeature=N.clone();J.arcadeEditType="NA";J.contingencyConstraintViolations=new Map;J.disabled=!1;J.inputs=[];J.map=null;J.relatedRecordCallbacks=null;J.strict=!1;return J}b._inherits(U,
S);var G=U.prototype;G.initialize=function(){const J=t.watch(()=>[this.layer,!!this.layer?.loaded,this.formTemplate,this.feature,this.arcadeEditType],([A,x])=>{null!=A&&(x?this._updateInputs():A.load().catch(()=>K.getLogger(this).error("Failed to load layer",A.loadError)))},{equals:([A,x,Q,T,W],[aa,Y,Z,R,V])=>A===aa&&x===Y&&Q===Z&&T===R&&W===V,initial:!0}),L=t.watch(()=>this._arcadeContextInfo,A=>{null!=this._expressionsManager&&(this._expressionsManager.arcadeContextInfo=A)}),B=t.watch(()=>this.layer,
A=>{(A="subtype-sublayer"===A?.type?A.parent:"feature"===A?.type?A:null)&&this.addResolvingPromise(O.createLoadedLayerContingentValuesCache(A).then(x=>{this._contingentValuesCache=x;this.notifyChange("fieldsWithContingentValues")}))},{initial:!0});this.handles.add([J,L,B])};G.destroy=function(){this.layer=this.feature=null;this._contingentValuesCache=P.destroyMaybe(this._contingentValuesCache)};G.formHeaderVisible=function(){const {activeRelationshipInput:J,formDescription:L,formTitle:B}=this;return!(J||
!L&&!B)};G.findField=function(J){return this.allFieldInputs.find(L=>L.name===J)};G.getValue=function(J){const {_featureClone:L,layer:B}=this,A=!!B?.getField(J);return L.getAttribute(J)??(A?null:void 0)};G.setValue=function(J,L){const {_featureClone:B,strict:A}=this,x=this.findField(J);L=""===L?null:L;x&&B.getAttribute(J)!==L&&(x.value=L,!A||x.valid)&&(this._afterValueChange(x),null!=this._expressionsManager&&this.updatingHandles.addPromise(this._expressionsManager.evaluateInvalidated([x.name]).finally(()=>
this._afterExpressionsEvaluated())))};G.getValues=function(){return{...this._featureClone.attributes}};G.submit=function(){var J=this.allFieldInputs;const L=new Set(J.filter(A=>A.valid).map(({name:A})=>A));J=J.filter(A=>!A.valid).map(({name:A})=>A);const B=this.getValues();if(0<this.validateContingencyConstraints(B,{includeIncompleteViolations:!0}).length)for(const [A,x]of this.contingencyConstraintViolations.entries())"error"===x.type&&(L.delete(A),J.push(A));this.emit("submit",{valid:[...L],invalid:J,
values:B})};G.validateContingencyConstraints=function(J,L){const {_contingentValuesCache:B}=this,A=new Map;this.contingencyConstraintViolations=A;if(null==B)return[];const {invalid:x,incomplete:Q}=B.validateContingencyConstraints(J);J=[...x,...(L?.includeIncompleteViolations?Q:[])];for(const T of J)for(const W of T.fieldGroup.fields)A.set(W,T);return J};G.notifyFeatureGeometryChanged=function(){const {_expressionsManager:J,feature:L,_featureClone:B}=this;B.geometry=L.geometry;null!=J&&this.updatingHandles.addPromise(J.evaluateInvalidatedByGeometry().finally(()=>
this._afterExpressionsEvaluated()))};G._emitChangeEvent=function({name:J,valid:L,value:B}){this.emit("value-change",{layer:this.layer,feature:this.feature,fieldName:J,value:B,valid:L})};G._updateInputs=function(){const {_featureClone:J,_initialFeature:L,arcadeEditType:B,formTemplate:A,inputs:x,layer:Q}=this;if(Q){var T={arcadeEditType:B,feature:J,initialFeature:L,layer:Q},W=x.slice();this.inputs=null!=A&&A.elements&&0<A.elements.length?this._updateInputsUsingFormElements(W,A.elements,T):this._updateInputsUsingLayerFields(W,
Q?.fields,T)}};G._updateInputsUsingFormElements=function(J,L,B){const A=new Map;for(const Q of J)if(C.isGroupInput(Q)){A.set(Q.element,Q);for(const T of Q.inputs)T.element&&A.set(T.element,T)}else Q.element&&A.set(Q.element,Q);J=new Map;const x=this._updateInputsUsingFormElementsRecursive({existingInputsByElement:A,updatedElements:L.filter(H),sharedInitializationProperties:B,group:null,newExpressionExecutorPromises:J});this.updatingHandles.addPromise(Promise.all(Array.from(J.values())).then(()=>{const Q=
Array.from(this._expressionExecutorLookup.values()),T=C.flattenFieldInputs(x);this._createExpressionsManager(Q,T);return this._expressionsManager.evaluateAll().finally(()=>this._afterExpressionsEvaluated())}));for(const [Q,T]of A.entries())A.delete(Q),T.destroy();return x};G._updateInputsUsingFormElementsRecursive=function(J){const {existingInputsByElement:L,updatedElements:B,sharedInitializationProperties:A,group:x,newExpressionExecutorPromises:Q}=J;J=[];for(const W of B){var T=L.has(W);const aa=
T?L.get(W):C.isGroupElement(W)?this._makeGroupInputFromElement(W,A):C.isFieldElement(W)?this._makeFieldInputFromElement(W,A,x):C.isRelationshipElement(W)?this._makeRelationshipInputFromElement(W,A,x):null;aa&&(J.push(aa),T?(L.delete(W),C.isGroupInput(aa)?({feature:T}=A,aa.set({feature:T})):C.isRelationshipInput(aa)?(T=this.relationshipId===W.relationshipId,aa.set(A),aa.set({map:this.map,showAllEnabled:T})):aa.set(A)):this._assignExpressionExecutors(aa,W,Q),C.isGroupElement(W)&&(T=W.elements.filter(Y=>
H(Y)),aa.inputs=this._updateInputsUsingFormElementsRecursive({existingInputsByElement:L,updatedElements:T,sharedInitializationProperties:A,group:aa,newExpressionExecutorPromises:Q})))}return J};G._updateInputsUsingLayerFields=function(J,L,B){if(!Array.isArray(L))return K.getLogger(this).warn(this.declaredClass,"No attribute fields found."),[];const A=new Map;for(const aa of J)if(C.isGroupInput(aa)){for(const Y of aa.inputs)Y.destroy();aa.inputs.length=0;aa.destroy()}else C.isRelationshipInput(aa)?
aa.destroy():C.isFieldInput(aa)&&(null!==aa.element?aa.destroy():A.set(aa.field,aa));J=[];const {arcadeEditType:x,feature:Q,initialFeature:T,layer:W}=B;for(const aa of L)L=A.get(aa)??new f({arcadeEditType:x,field:aa,feature:Q,initialFeature:T,layer:W,value:Q?.getAttribute(aa.name)??null}),J.push(L),A.delete(aa);for(const [aa,Y]of A.entries())A.delete(aa),Y.destroy();return J};G._resetFieldInputValues=function(J){for(const L of this.allFieldInputs)L.value=J.getAttribute(L.name)};G._makeFieldInputFromElement=
function(J,L,B){const {arcadeEditType:A,feature:x,initialFeature:Q,layer:T}=L;({fieldName:L}=J);return(L=L&&this._layerFieldsByName.get(L))?new f({arcadeEditType:A,element:J,field:L,value:x?.getAttribute(J.fieldName)??null,feature:x,initialFeature:Q,layer:T,group:B}):null};G._makeGroupInputFromElement=function(J,L){const {feature:B,layer:A}=L;return new l({element:J,inputs:[],feature:B,layer:A})};G._makeRelationshipInputFromElement=function(J,L,B=null){const {map:A}=this,{feature:x,layer:Q}=L;return new q({element:J,
feature:x,group:B,layer:Q,map:A})};G._assignExpressionExecutors=function(J,L,B){var A=C.isGroupElement(L)?r:C.isRelationshipElement(L)?I:E;for(const x of A){A=L[x];const {_expressionExecutorLookup:Q}=this;if(null!=A&&""!==A){const T=`${x}Executor`,W=this._expressionInfosLookup.get(A)?.expression??A;Q.has(W)?J[T]=Q.get(W):B.has(W)?(A=B.get(W).then(aa=>J[T]=aa),B.set(W,A)):(A=h.createFormExpressionArcadeExecutor(W,this.layer).then(aa=>{J[T]=aa;Q.set(W,aa);return aa}),B.set(W,A))}}return[]};G._createExpressionsManager=
function(J,L){const {_arcadeContextInfo:B,_featureClone:A}=this;this._expressionsManager=new d.FormExpressionsManager({executors:J,feature:A,arcadeContextInfo:B,fieldInputs:L})};G._afterValueChange=function(J){const {name:L,value:B}=J,{_featureClone:A,formTemplate:x,layer:Q}=this;if(Q){var T=A.getAttribute(L);A.setAttribute(L,B);var {typeFieldName:W,types:aa}=C.getNormalizedFeatureTypeInfo(Q);if(L===W&&B!==T){"subtype-sublayer"===Q.type&&(T=Q.parent?.findSublayerForFeature(A),A.sourceLayer=this.feature.sourceLayer=
T);T=new Set;for(var Y of aa)if(Y.domains&&"object"===typeof Y.domains)for(const Z of Object.keys(Y.domains))T.add(Z);for(const Z of T)(Y=this.findField(Z))&&Y.notifyChange("domain")}if(null!=x){const {description:Z,title:R}=x;R&&D.templateHasKey(R,L)&&this.notifyChange("formTitle");Z&&D.templateHasKey(Z,L)&&this.notifyChange("formDescription")}this._emitChangeEvent(J)}};G._afterExpressionsEvaluated=function(){const {_featureClone:J}=this;for(const L of this.allFieldInputs)L.value!==J.getAttribute(L.name)&&
this._afterValueChange(L)};G._joinContingentValues=function(){var J=this._contingentValuesCache;if(null==J)return[];var {typeFieldName:L}=C.getNormalizedFeatureTypeInfo(this.layer);L=L?this.getValue(L):null;const B=[];for(var A of J.fieldGroups){const {contingencies:W,fields:aa,name:Y}=A;J=[];for(var x of W)x.isRetired||(null==x.subtype||x.subtype.code===L)&&J.push({values:x.values});0<J.length&&B.push({name:Y,fields:aa,contingencies:J})}const [Q,T]=this._generateJoinPlan(B);A=Q.flatMap(W=>this._joinFieldGroupContingencies(W));
x=T.flatMap(W=>W.contingencies);return[...A,...x]};G._generateJoinPlan=function(J){var L=new Map,B=[],A=new Set;for(var x of J)for(const aa of x.fields)if(L.has(aa)){const Y=L.get(aa),Z=x,R=[Y.name,Z.name].sort().join("|");A.has(R)||(B.push([Y,Z]),A.add(R),L.set(aa,Z))}else L.set(aa,x);L=new Set(B.flat());J=new Set(J);for(var Q of L)J.delete(Q);Q=new Map;L=new Map;for(var T of new Set(B.flat()))A=Symbol(T.name),Q.set(A,new Set([T])),L.set(T,A);for(const [aa,Y]of B)if(B=L.get(aa),T=L.get(Y),B!==T){A=
Q.get(B);x=Q.get(T);for(var W of x)A.add(W),L.set(W,B);Q.delete(T)}W=[...Q.values()].map(aa=>[...aa]);B=[...J];return[W,B]};G._joinFieldGroupContingencies=function(J){const L=J.slice();var B=L.shift(),A=L.shift();J=this._generateJoinKey(B.fields,A.fields);let x=new Set([...B.fields,...A.fields]),Q=new Map;for(var T of B.contingencies)[B]=this._hashContingency(T,J.codedValueFields,!0),Q.has(B)?Q.get(B)?.push(T):Q.set(B,[T]);for(;0<L.length;){T=new Map;B=L.shift();const Y=this._generateJoinKey(x,B.fields);
for(var W of A.contingencies){const [Z,R]=this._hashContingency(W,J.codedValueFields);A=R?this._findMatchingContingenciesWithAnyHashMask(Q,Z):Q.get(Z);Q.has("#JSAPI_CONTINGENT_VALUE_ANY_HASH")&&A?.push(...this._findMatchingContingenciesContainingAny(W,Q.get("#JSAPI_CONTINGENT_VALUE_ANY_HASH"),J.codedValueFields));if(null!=A)for(var aa of A){A=0<J.rangeFields.length?this._joinContingenciesWithRangeDomains(aa,W,J.rangeFields):this._joinContingencies(aa,W);if(null==A)break;const [V]=this._hashContingency(A,
Y.codedValueFields,!0);T.has(V)?T.get(V)?.push(A):T.set(V,[A])}}Q=T;A=B;J=Y;x=new Set([...x,...A.fields])}W=[];for(const Y of A.contingencies){const [Z,R]=this._hashContingency(Y,J.codedValueFields);aa=R?this._findMatchingContingenciesWithAnyHashMask(Q,Z):Q.get(Z);Q.has("#JSAPI_CONTINGENT_VALUE_ANY_HASH")&&aa.push(...this._findMatchingContingenciesContainingAny(Y,Q.get("#JSAPI_CONTINGENT_VALUE_ANY_HASH"),J.codedValueFields));if(null!=aa)for(const V of aa)aa=0<J.rangeFields.length?this._joinContingenciesWithRangeDomains(V,
Y,J.rangeFields):this._joinContingencies(V,Y),null!=aa&&W.push(aa)}return W};G._joinContingencies=function(J,L){L={values:{...J.values,...L.values}};for(const [B,A]of Object.entries(L.values))"any"===A.objectType&&null!=J.values[B]&&(L.values[B]=J.values[B]);return L};G._joinContingenciesWithRangeDomains=function(J,L,B){const A=this._joinContingencies(J,L);for(const Q of B){var x=J.values[Q];const T=L.values[Q],{leftIsNull:W,rightIsNull:aa,bothAreNull:Y,leftIsAny:Z,rightIsAny:R,bothAreAny:V,leftIsRange:ba,
rightIsRange:ea}=this._compareObjectTypes(x.objectType,T.objectType);if(!Y&&!V)if(W&&R||aa&&Z)A.values[Q]=new p({objectType:"null"});else{if(W&&ea||aa&&ba)return null;Z?(x.minValue=-Infinity,x.maxValue=Infinity):R&&(T.minValue=-Infinity,T.maxValue=Infinity);B=Math.max(x.minValue,T.minValue);x=Math.min(x.maxValue,T.maxValue);if(B>x)return null;A.values[Q]=new p({objectType:"range",minValue:B,maxValue:x})}}return A};G._findMatchingContingenciesContainingAny=function(J,L,B){return L.filter(A=>B.every(x=>
{const Q=A.values[x];x=J.values[x];return"any"===Q.objectType||"any"===x.objectType||Q.codedValue?.code===x.codedValue?.code}))};G._findMatchingContingenciesWithAnyHashMask=function(J,L){L=RegExp(`${L}$`);const B=[];for(const [A,x]of J){if("#JSAPI_CONTINGENT_VALUE_ANY_HASH"===A)break;L.test(A)&&B.push(...x)}return B};G._generateJoinKey=function(J,L){J=Array.isArray(J)?new Set(J):J;var B=Array.isArray(L)?new Set(L):L;L=J.size<B.size?J:B;J=L===J?B:J;B=new Set;const A=new Set;for(const x of L)if(J.has(x)&&
(L=this.layer?.getFieldDomain(x,{feature:this.feature}),null!=L))switch(L.type){case "coded-value":B.add(x);break;case "range":A.add(x)}return{codedValueFields:[...B],rangeFields:[...A]}};G._hashContingency=function(J,L,B=!1){if(1>L.length)return["#JSAPI_CONTINGENT_VALUE_EMPTY_HASH",!1];const A=[];let x=!1;for(const Q of L)if(L=J.values[Q],"any"===L.objectType){if(B)return["#JSAPI_CONTINGENT_VALUE_ANY_HASH",!0];x=!0;A.push(`${Q}:.*`)}else"null"===L.objectType?A.push(`${Q}:${"#JSAPI_CONTINGENT_VALUE_NULL_HASH"}`):
A.push(`${Q}:${L.codedValue?.code}`);return[A.sort().join("\x26"),x]};G._compareObjectTypes=function(J,L){return{leftIsNull:"null"===J,rightIsNull:"null"===L,bothAreNull:"null"===J&&"null"===L,leftIsAny:"any"===J,rightIsAny:"any"===L,bothAreAny:"any"===J&&"any"===L,leftIsRange:"range"===J,rightIsRange:"range"===L}};b._createClass(U,[{key:"_expressionInfosLookup",get:function(){return new Map(this.formTemplate?.expressionInfos?.map(J=>[J.name,J]))}},{key:"activeRelationshipInput",get:function(){return this.allRelationshipInputs.find(J=>
J.relationshipId===this.relationshipId)}},{key:"_arcadeContextInfo",get:function(){const {_initialFeature:J,arcadeEditType:L,layer:B,map:A,spatialReference:x}=this;return{layer:y.isEditableLayer(B)?B:null,originalFeature:J,editType:L,map:A,spatialReference:x}}},{key:"allFieldInputs",get:function(){return C.flattenFieldInputs(this.inputs)}},{key:"allRelationshipInputs",get:function(){return C.flattenRelationshipInputs(this.inputs)}},{key:"_layerFieldsByName",get:function(){return new Map(this.layer?.fields.map(J=>
[J.name,J]))}},{key:"feature",get:function(){return this._get("feature")},set:function(J){this._featureClone=J?J.clone():N.clone();this._initialFeature=this._featureClone.clone();J?(this._resetFieldInputValues(this._featureClone),this.allRelationshipInputs.forEach(L=>L.feature=J)):(this.inputs.forEach(L=>L.destroy()),this.inputs.length=0);this.contingencyConstraintViolations.clear();null!=this._expressionsManager&&(this._expressionsManager.resetExecutors(),this._expressionsManager.feature=this._featureClone,
this.updatingHandles.addPromise(this._expressionsManager.evaluateAll().finally(()=>this._afterExpressionsEvaluated())));this._set("feature",J)}},{key:"fieldsWithContingentValues",get:function(){if(null==this._contingentValuesCache)return new Set;const J=this._contingentValuesCache.fieldGroups.flatMap(L=>L.fields);return new Set(J)}},{key:"formTemplate",get:function(){return this.layer&&"formTemplate"in this.layer?this.layer.formTemplate:null},set:function(J){void 0===J?this._clearOverride("formTemplate"):
this._override("formTemplate",J)}},{key:"formDescription",get:function(){const {formTemplate:J,layer:L}=this;return null!=J&&J.description&&L?C.parseFormTemplateString(J.description,this.getValues(),L.fieldsIndex):null}},{key:"formTitle",get:function(){const {formTemplate:J,layer:L}=this;return null!=J&&J.title&&L?C.parseFormTemplateString(J.title,this.getValues(),L.fieldsIndex):null}},{key:"inputFields",get:function(){m.deprecatedProperty(M,"inputFields",{replacement:"FeatureFormViewModel.inputs",
version:"4.27"});return this.inputs},set:function(J){m.deprecatedProperty(M,"inputFields",{replacement:"FeatureFormViewModel.inputs",version:"4.27"});this.inputs=J}},{key:"joinedContingentValues",get:function(){return this._joinContingentValues()}},{key:"layer",get:function(){return this.feature?.sourceLayer&&"applyEdits"in this.feature.sourceLayer?this.feature.sourceLayer:null},set:function(J){this._override("layer",J)}},{key:"relationshipId",get:function(){return this._get("relationshipId")},set:function(J){var L=
this.allRelationshipInputs;null!=J&&J===this.relationshipId||L.forEach(B=>B.showAllEnabled=!1);null!=J&&(L=L.find(B=>B.relationshipId===J))&&(L.showAllEnabled=!0);this._set("relationshipId",J)}},{key:"spatialReference",get:function(){return this.layer?.spatialReference??null},set:function(J){this._override("spatialReference",J)}},{key:"state",get:function(){return this.get("layer.loaded")?"ready":"disabled"}},{key:"submittable",get:function(){return this.valid?!0:this.allFieldInputs.filter(J=>!J.valid).every(({submittable:J})=>
J)}},{key:"updating",get:function(){return this.updatingHandles.updating}},{key:"valid",get:function(){const J=this.allFieldInputs;return 0<J.length&&J.every(({valid:L})=>L)}},{key:"view",get:function(){m.deprecatedProperty(M,"view",{replacement:"FeatureForm.map",version:"4.27"});return this._get("view")},set:function(J){m.deprecatedProperty(M,"view",{replacement:"FeatureForm.map",version:"4.27"});this._set("view",J);J?.map&&(this.map=J.map)}}]);return U}(F.HandleOwnerMixin(z.EsriPromiseMixin(w.EventedAccessor)));
e.__decorate([a.property()],c.prototype,"_expressionInfosLookup",null);e.__decorate([a.property()],c.prototype,"_featureClone",void 0);e.__decorate([a.property()],c.prototype,"activeRelationshipInput",null);e.__decorate([a.property()],c.prototype,"_arcadeContextInfo",null);e.__decorate([a.property({readOnly:!0})],c.prototype,"allFieldInputs",null);e.__decorate([a.property()],c.prototype,"allRelationshipInputs",null);e.__decorate([a.property()],c.prototype,"_layerFieldsByName",null);e.__decorate([a.property()],
c.prototype,"arcadeEditType",void 0);e.__decorate([a.property()],c.prototype,"contingencyConstraintViolations",void 0);e.__decorate([a.property()],c.prototype,"disabled",void 0);e.__decorate([a.property()],c.prototype,"feature",null);e.__decorate([a.property()],c.prototype,"fieldsWithContingentValues",null);e.__decorate([a.property({type:n})],c.prototype,"formTemplate",null);e.__decorate([a.property()],c.prototype,"formDescription",null);e.__decorate([a.property()],c.prototype,"formTitle",null);e.__decorate([a.property()],
c.prototype,"formHeaderVisible",null);e.__decorate([a.property()],c.prototype,"inputs",void 0);e.__decorate([a.property()],c.prototype,"inputFields",null);e.__decorate([a.property()],c.prototype,"joinedContingentValues",null);e.__decorate([a.property()],c.prototype,"layer",null);e.__decorate([a.property()],c.prototype,"map",void 0);e.__decorate([a.property()],c.prototype,"relatedRecordCallbacks",void 0);e.__decorate([a.property()],c.prototype,"relationshipId",null);e.__decorate([a.property()],c.prototype,
"spatialReference",null);e.__decorate([a.property()],c.prototype,"state",null);e.__decorate([a.property()],c.prototype,"strict",void 0);e.__decorate([a.property()],c.prototype,"submittable",null);e.__decorate([a.property()],c.prototype,"updating",null);e.__decorate([a.property()],c.prototype,"valid",null);e.__decorate([a.property()],c.prototype,"view",null);e.__decorate([a.property()],c.prototype,"getValues",null);e.__decorate([a.property()],c.prototype,"submit",null);return c=e.__decorate([k.subclass("esri.widgets.FeatureForm.FeatureFormViewModel")],
c)})},"esri/layers/support/ContingentValue":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),function(b,e,c,m,w,F,K,P){c=function(z){function t(D){D=z.call(this,D)||this;D.maxValue=null;D.minValue=null;D.codedValue=null;return D}b._inherits(t,z);return b._createClass(t)}(c);
e.__decorate([m.property()],c.prototype,"objectType",void 0);e.__decorate([m.property()],c.prototype,"maxValue",void 0);e.__decorate([m.property()],c.prototype,"minValue",void 0);e.__decorate([m.property()],c.prototype,"codedValue",void 0);return c=e.__decorate([P.subclass("esri.layers.support.ContingentValue")],c)})},"esri/layers/support/LayerContingentValuesCache":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../request ../../core/arrayUtils ../../core/JSONSupport ../../core/Loadable ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/has ../../core/accessorSupport/decorators/subclass ./arcgisLayerUrl ./Contingency ./ContingencyConstraintViolation ./ContingentValue ./ContingentValuesResult ./FieldGroup ./Subtype".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a,g,u,v,k,n){var p;w=p=function(y){function O(f){f=y.call(this,f)||this;f.request=c;f.fieldGroups=null;f.fieldGroupDefinitions=null;return f}b._inherits(O,y);var C=O.prototype;C.initialize=function(){};O.createLoadedLayerContingentValuesCache=async function(f){await f.load();if(void 0===f.layerId)return null;var h=f.sourceJSON.hasContingentValuesDefinition;if(h)return(new p({layer:f})).load();if(void 0===h){h=D.parse(f.url);if(null==h)return null;h=h.url.path;if((await p._staticFetchEnterpriseFeatureRoot(h)).supportsQueryDataElements&&
(h=await p._staticFetchEnterpriseFieldGroup(h,f.layerId.toString())))return h=h.map(d=>({name:d.name,isEditingRestrictive:d.isEditingRestrictive,fields:d.fieldNames.names})),(new p({layer:f,fieldGroupDefinitions:h})).load()}return null};C.load=async function(f){const h=this.layer.load(f).then(()=>this._initializeContingentValues(this.fieldGroupDefinitions,f));this.addResolvingPromise(h);return this};C.validateContingencyConstraints=function(f,h){const d=Object.keys(f),l=[],q=[];for(const N of this.fieldGroups){const E=
N.isEditingRestrictive?"error":"warning";if(h&&!N.fields.some(M=>h.includes(M)))continue;if(!N.fields.every(M=>d.includes(M))){q.push(new g({fieldGroup:N,type:E}));continue}let r=!1;const I=f[this.subtypeFieldName];var H=N.contingencies.filter(M=>!M.isRetired&&M.subtype?M.subtype.code===I:!0);for(const M of H){H=!0;for(const S in M.values){const U=M.values[S];if("any"!==U.objectType)if("null"===U.objectType){if(null!=f[S]){H=!1;break}}else if("code"===U.objectType){if(f[S]!==U.codedValue.code){H=
!1;break}}else if("range"===U.objectType){const G=f[S];if(G<U.minValue||G>U.maxValue){H=!1;break}}}if(H){r=!0;break}}r||l.push(new g({fieldGroup:N,type:E}))}return{invalid:l,incomplete:q}};C.getContingentValues=function(f,h,d=!1){const l=f[this.subtypeFieldName],q=void 0!==l&&null!==l,H={};let N=[];const E=this.fieldGroups.filter(I=>I.fields.includes(h));N.push(new u({objectType:"any"}));for(const I of E){let M=[];var r=I.contingencies.filter(G=>!G.isRetired&&(G.subtype&&q?G.subtype.code===l:!0));
let S=!1;const U={};for(const G of r){let J;r=!0;for(const L in G.values){const B=G.values[L];if(h===L)J=B,S=S||"range"===B.objectType;else if(void 0!==f[L]&&"any"!==B.objectType)if("null"===B.objectType)null!==f[L]&&(r=!1);else if("code"===B.objectType)f[L]!==B.codedValue.code&&(r=!1);else if("range"===B.objectType){const A=f[L];if(A<B.minValue||A>B.maxValue)r=!1}}if(J&&r){if("any"===J.objectType){M.length=0;M.push(J);break}r=this._generateKey(J);U[r]||M.push(J);U[r]=!0}}S&&(M=this._joinRange(M));
H[I.name]=M;N=d?this._filterIntersection(N,M):[]}1===E.length&&d&&(N=[]);return new v({contingentValuesAllGroups:N,contingentValuesByFieldGroup:H})};C._generateKey=function(f){switch(f.objectType){case "any":return"@any@";case "null":return"@null@";case "code":return f.codedValue.name+f.codedValue.code.toString();case "range":return f.minValue.toString()+"-"+f.maxValue.toString()}};C._joinRange=function(f){f.sort((q,H)=>"null"===q.objectType?-1:"null"===H.objectType?1:q.minValue-H.minValue);let h,
d;const l=[];for(const q of f)"null"===q.objectType?l.push(q):null==h||null==d?(h=q.minValue,d=q.maxValue):d<q.minValue?(l.push(new u({objectType:"range",minValue:h,maxValue:d})),h=q.minValue,d=q.maxValue):d<q.maxValue&&(d=q.maxValue);l.push(new u({objectType:"range",minValue:h,maxValue:d}));return l};C._filterIntersection=function(f,h){if(0===f.length||0===h.length)return[];if("any"===f[0].objectType)return h;if("any"===h[0].objectType)return f;const d="range"===h[0].objectType||"range"===h[1]?.objectType;
return"range"===f[0].objectType||"range"===f[1]?.objectType||d?this._intersectRanges(f,h):this._intersectValues(f,h)};C._intersectRanges=function(f,h){const d=[];let l=0;for(const q of f)for(;l<h.length;l++){const H=h[l];if("null"===q.objectType&&"null"===H.objectType)d.push(new u({objectType:"null"}));else if("null"===q.objectType)break;else if("null"===H.objectType)continue;if(q.maxValue<H.minValue)break;if(q.maxValue===H.minValue){d.push(new u({objectType:"range",minValue:q.maxValue,maxValue:H.minValue}));
break}if(!(q.minValue>H.maxValue))if(q.minValue===H.maxValue)d.push(new u({objectType:"range",minValue:q.minValue,maxValue:H.maxValue}));else{f=q.minValue>H.minValue?q.minValue:H.minValue;if(q.maxValue<H.maxValue){d.push(new u({objectType:"range",minValue:f,maxValue:q.maxValue}));break}d.push(new u({objectType:"range",minValue:f,maxValue:H.maxValue}))}}return d};C._intersectValues=function(f,h){const d=[];for(const l of f)h.some(q=>{if(l.objectType===q.objectType)switch(l.objectType){case "any":case "null":return!0;
case "code":return l.codedValue.code===q.codedValue.code&&l.codedValue.name===q.codedValue.name}return!1})&&d.push(l);return d};O._staticFetchEnterpriseFeatureRoot=async function(f,h){return c(f,{responseType:"json",query:{f:"json"},...h}).then(d=>d.data)};O._staticFetchEnterpriseFieldGroup=async function(f,h,d){return c(`${f}/queryDataElements`,{responseType:"json",query:{layers:JSON.stringify([h]),f:"json"},...d}).then(l=>l.data.layerDataElements?.[0].dataElement.fieldGroups)};C._initializeContingentValues=
async function(f,h){f=f??await this._fetchFieldGroupDefs(h);this.fieldGroups=0===f.length?[]:await this._fetchContingentValues(f,h)};C._fetchFieldGroupDefs=async function(f){if(void 0===this.layer.layerId)return[];const h=this.layer.sourceJSON,d=this.layer.layerId.toString(),l=D.parse(this.layer.url).url.path;return h.hasContingentValuesDefinition?(await this._fetchAGOLFieldGroup(l,d,f)).map(q=>({name:q.name,isEditingRestrictive:q.restrictive,fields:q.fields.map(H=>this.layer.fieldsIndex.normalizeFieldName(H))})):
void 0!==h.hasContingentValuesDefinition?[]:this._fetchEnterpriseFeatureRoot(l,f).then(async q=>q.supportsQueryDataElements?(await this._fetchEnterpriseFieldGroup(l,d,f)).map(H=>({name:H.name,isEditingRestrictive:H.isEditingRestrictive,fields:H.fieldNames.names.map(N=>this.layer.fieldsIndex.normalizeFieldName(N))})):[])};C._fetchAGOLFieldGroup=async function(f,h,d){return c(`${f}/${h}/fieldgroups`,{responseType:"json",query:{f:"json"},...d}).then(l=>l.data.fieldGroups)};C._fetchEnterpriseFieldGroup=
async function(f,h,d){return p._staticFetchEnterpriseFieldGroup(f,h,d)};C._fetchEnterpriseFeatureRoot=async function(f,h){return p._staticFetchEnterpriseFeatureRoot(f,h)};C._fetchContingentValues=async function(f,h){if(void 0===this.layer.layerId)return[];const d=this.layer.sourceJSON,l=this.layer.layerId.toString(),q=D.parse(this.layer.url).url.path;if(d.hasContingentValuesDefinition)return h=await this._fetchAGOLContingentValues(q,l,h),this._constructFieldGroupsAGOL(f,h);h=await this._fetchEnterpriseContingentValues(q,
l,h);return this._constructFieldGroupsEnterprise(f,h)};C._constructFieldGroupsAGOL=function(f,h){return f.map(d=>{const l=h.contingentValuesDefinition.fieldGroups.find(q=>q.name===d.name);if(l){let q=[];q=h.contingentValuesDefinition.hasSubType?this._parseAGOLFieldGroupSubtype(d,h,l.subTypes):this._parseAGOLFieldGroup(d,h,l.contingentValues);return new k({name:d.name,isEditingRestrictive:d.isEditingRestrictive,fields:d.fields,contingencies:q})}return null}).filter(m.isSome)};C._parseAGOLFieldGroupSubtype=
function(f,h,d){let l=[];d?.forEach(q=>{const H=this._getSubtypeAGOL(q.name);l=l.concat(this._parseAGOLFieldGroup(f,h,q.contingentValues,H))});return l};C._parseAGOLFieldGroup=function(f,h,d,l=null){const q=[];for(const H of d??[])d=this._parseAGOLContingency(H,f,h,l),q.push(d);return q};C._parseAGOLContingency=function(f,h,d,l){const q=f.id,H=f.retired?1===f.retired:!1,N={};for(let r=0,I=0;r<h.fields.length;r++){const M=h.fields[r];var E=d.typeCodes[f.types[r]];if("Code"===E){let S=f.values[I];I++;
const U=this._getDomain(l,M);"string"===this.layer.getField(M)?.type&&(E=d.stringDicts.find(G=>G.domain===U.name))&&(S=E.entries[S]);E=U.codedValues.find(G=>G.code===S);E=new u({codedValue:E,objectType:"code"});N[M]=E}else"Range"===E?(E=f.values[I],I++,E=new u({minValue:E.range[0],maxValue:E.range[1],objectType:"range"}),N[M]=E):"Any"===E?(E=new u({objectType:"any"}),N[M]=E):(E=new u({objectType:"null"}),N[M]=E)}return new a({id:q,isRetired:H,subtype:l,values:N})};C._constructFieldGroupsEnterprise=
function(f,h){const d=h.fieldGroups;return f.map(l=>{var q=d.find(H=>H.name===l.name);return q?(q=q.contingencies.map(H=>{const N=H.id,E=H.isRetired||!1,r=this._getSubtypeEnterprise(H.subtypeCode),I={};for(let S=0;S<l.fields.length;S++){const U=l.fields[S];let G=H.values[S];if("number"===typeof G||"string"===typeof G){var M=this._getDomain(r,U);const J=this.layer.getField(U);"string"===J?.type?G=h.stringDictionary[G]:"date"===J?.type&&(G=(new Date(`${G}+00:00`)).getTime());M=M.codedValues.find(L=>
L.code===G);M=new u({codedValue:M,objectType:"code"});I[U]=M}else"object"===typeof G?(M=new u({minValue:G.minValue,maxValue:G.maxValue,objectType:"range"}),I[U]=M):G?(M=new u({objectType:"any"}),I[U]=M):(M=new u({objectType:"null"}),I[U]=M)}return new a({id:N,isRetired:E,subtype:r,values:I})}),new k({name:l.name,isEditingRestrictive:l.isEditingRestrictive,fields:l.fields,contingencies:q})):null}).filter(m.isSome)};C._fetchEnterpriseContingentValues=async function(f,h,d){return c(`${f}/queryContingentValues`,
{responseType:"json",query:{layers:JSON.stringify([h]),f:"json"},...d}).then(l=>l.data.contingentValueSets?.[0])};C._fetchAGOLContingentValues=async function(f,h,d){return c(`${f}/${h}/contingentValues`,{responseType:"json",query:{f:"json"},...d}).then(l=>l.data)};C._getSubtypeEnterprise=function(f){var h=this.layer.sourceJSON;let d;h.subtypes&&(h=h.subtypes.find(l=>l.code===f),d=n.fromJSON(h));return d||null};C._getSubtypeAGOL=function(f){var h=this.layer.sourceJSON;let d;h.subtypes&&(h=h.subtypes.find(l=>
l.name===f),d=n.fromJSON(h));return d||null};C._getDomain=function(f,h){f=f?f.domains?.[h]:this.layer.getFieldDomain(h);return"inherited"===f?.type?this.layer.getFieldDomain(h):f};b._createClass(O,[{key:"subtypeFieldName",get:function(){const {layer:f}=this;return"subtype-group"===f.type?f.subtypeField:f.typeIdField}}]);return O}(w.JSONSupportMixin(F));e.__decorate([K.property({constructOnly:!0})],w.prototype,"layer",void 0);e.__decorate([K.property({constructOnly:!0})],w.prototype,"request",void 0);
e.__decorate([K.property({type:[k]})],w.prototype,"fieldGroups",void 0);e.__decorate([K.property({constructOnly:!0})],w.prototype,"fieldGroupDefinitions",void 0);e.__decorate([K.property()],w.prototype,"subtypeFieldName",null);return w=p=e.__decorate([t.subclass("esri.layers.support.LayerContingentValuesCache")],w)})},"esri/layers/support/Contingency":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,e,c,m,w,F,K,P){c=function(z){function t(D){D=z.call(this,D)||this;D.isRetired=!1;return D}b._inherits(t,z);return b._createClass(t)}(c);e.__decorate([m.property()],c.prototype,"id",void 0);e.__decorate([m.property()],c.prototype,"isRetired",void 0);e.__decorate([m.property()],c.prototype,"subtype",void 0);e.__decorate([m.property()],c.prototype,"values",void 0);return c=e.__decorate([P.subclass("esri.layers.support.Contingency")],c)})},"esri/layers/support/ContingencyConstraintViolation":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,e,c,m,w,F,K,P){c=function(z){function t(D){return z.call(this,D)||this}b._inherits(t,z);return b._createClass(t)}(c);e.__decorate([m.property()],c.prototype,"fieldGroup",void 0);e.__decorate([m.property()],c.prototype,"type",void 0);return c=e.__decorate([P.subclass("esri.layers.support.ContingencyConstraintViolation")],c)})},"esri/layers/support/ContingentValuesResult":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,e,c,m,w,F,K,P){c=function(z){function t(D){return z.call(this,D)||this}b._inherits(t,z);return b._createClass(t)}(c);e.__decorate([m.property()],c.prototype,"contingentValuesAllGroups",void 0);e.__decorate([m.property()],c.prototype,"contingentValuesByFieldGroup",void 0);return c=e.__decorate([P.subclass("esri.layers.support.ContingentValuesResult")],c)})},"esri/layers/support/FieldGroup":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,e,c,m,w,F,K,P){c=function(z){function t(D){D=z.call(this,D)||this;D.fields=null;D.isEditingRestrictive=!1;return D}b._inherits(t,z);return b._createClass(t)}(c);e.__decorate([m.property()],c.prototype,"name",void 0);e.__decorate([m.property()],c.prototype,"fields",void 0);e.__decorate([m.property()],c.prototype,"isEditingRestrictive",void 0);e.__decorate([m.property()],c.prototype,"contingencies",void 0);return c=e.__decorate([P.subclass("esri.layers.support.FieldGroup")],c)})},"esri/layers/support/Subtype":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ./domains".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D){c=function(a){function g(){var v=a.apply(this,arguments)||this;v.code=null;v.defaultValues={};v.domains=null;v.name=null;return v}b._inherits(g,a);var u=g.prototype;u.readDomains=function(v){if(!v)return null;const k={};for(const n of Object.keys(v))k[n]=D.fromJSON(v[n]);return k};u.writeDomains=function(v,k){if(v){var n={};for(const p of Object.keys(v))v[p]&&(n[p]=v[p]?.toJSON());k.domains=n}};return b._createClass(g)}(c.JSONSupport);e.__decorate([m.property({type:Number,
json:{write:!0}})],c.prototype,"code",void 0);e.__decorate([m.property({type:Object,json:{write:!0}})],c.prototype,"defaultValues",void 0);e.__decorate([m.property({json:{write:!0}})],c.prototype,"domains",void 0);e.__decorate([P.reader("domains")],c.prototype,"readDomains",null);e.__decorate([t.writer("domains")],c.prototype,"writeDomains",null);e.__decorate([m.property({type:String,json:{write:!0}})],c.prototype,"name",void 0);return c=e.__decorate([z.subclass("esri.layers.support.Subtype")],c)})},
"esri/widgets/FeatureForm/FieldInput":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../layers/support/CodedValue ../../layers/support/CodedValueDomain ../../layers/support/Domain ../../layers/support/InheritedDomain ../../layers/support/RangeDomain ../../layers/support/domainUtils ../../layers/support/fieldUtils ../Feature/support/featureUtils ./EditableInput ./featureFormUtils".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a,g,u,v,k,n){var p;(function(y){y.Text="text";y.Number="number";y.Date="date";y.Unsupported="unsupported"})(p||(p={}));m=function(y){function O(f){f=y.call(this,f)||this;f._storedValue=null;f.error=null;f.field=null;f.group=null;f.requiredExpressionExecutor=null;f.type="field";f.valueExpressionExecutor=null;return f}b._inherits(O,y);var C=O.prototype;C._isDomainCompatible=function(f){const {field:h}=this;if("coded-value"===f?.type){const d=typeof f.codedValues[0].code;
if("string"===d&&u.isStringField(h)||"number"===d&&u.isNumericField(h))return!0}return"range"===f?.type&&u.isNumericField(h)||u.isDateField(h)?!0:!1};C._validate=function(){const {dataType:f,domain:h,field:d,initialFeature:l,minLength:q,required:H,valid:N,value:E}=this,r=H&&null==E,I=void 0!==N;return!r&&l.getAttribute(d.name)===E&&I?null:r?u.TypeValidationError.INVALID_TYPE:"text"===f&&-1<q&&"string"===typeof E&&E.length<q?n.LengthValidationError.TOO_SHORT:h?null!==E||H?g.validateDomainValue(h,E):
null:u.validateFieldValue(d,E)};b._createClass(O,[{key:"_dateRange",get:function(){const {element:f}=this;if("datetime-picker"===f?.input?.type){const {max:h,min:d}=f.input;return{max:h,min:d}}return{min:null,max:null}}},{key:"_configAllowsEdits",get:function(){const {element:f,layer:h,name:d}=this;return null!=f?f.editableExpression?!!this.evaluatedEditableExpression:!1!==f.editable:h?.userHasUpdateItemPrivileges?!0:(h&&"popupTemplate"in h?h?.popupTemplate?.fieldInfos?.find(({fieldName:l})=>l===
d):null)?.isEditable??!0}},{key:"_layerAndFieldAllowEdits",get:function(){return this.layerAllowsEdits&&this.field?.editable}},{key:"_isVisibleByDefault",get:function(){const {field:f,layer:h}=this;return!!f?.visible&&u.isFieldVisibleByDefault(f,h)}},{key:"_isEditTrackingField",get:function(){return u.getLowerCaseEditTrackingFields(this.layer).includes(this.name?.toLowerCase())}},{key:"_shouldUseValueExpression",get:function(){return this._layerAndFieldAllowEdits&&!this._configAllowsEdits&&null!=
this.valueExpressionExecutor}},{key:"dataType",get:function(){const {field:f}=this;return u.isNumericField(f)?p.Number:u.isStringField(f)?p.Text:u.isDateField(f)?p.Date:p.Unsupported}},{key:"dateDataType",get:function(){if(this.dataType===p.Date)return"date"!==this.field.type?"string":"number"}},{key:"domain",get:function(){var {layer:f}=this;const {typeFieldName:h,types:d}=n.getNormalizedFeatureTypeInfo(f);if(h===this.name&&null==this.field.domain)return new z({name:"__internal-type-based-coded-value-domain__",
codedValues:d.map(({code:q,name:H})=>new P.CodedValue({code:q,name:H}))});var {feature:l}=this;f=f?.getFieldDomain(this.name,{feature:l});l=this.element?.domain;return null!=l&&this._isDomainCompatible(l)?l:f}},{key:"editable",get:function(){return this._layerAndFieldAllowEdits?this.evaluatedEditableExpression??this._configAllowsEdits:!1}},{key:"evaluatedRequiredExpression",get:function(){const {requiredExpressionExecutor:f}=this;return null!=f?!!f.lastEvaluatedValue:null}},{key:"evaluatedValueExpression",
get:function(){const {valueExpressionExecutor:f}=this;return null!=f?f.lastEvaluatedValue:null}},{key:"hint",get:function(){return this.element?.hint}},{key:"includeDate",get:function(){return!(this.dataType!==p.Date||"time-only"===this.field.type)}},{key:"includeTime",get:function(){const {element:f,field:h}=this;if(this.dataType!==p.Date)return!1;if("time-only"===h.type)return!0;if("date-only"===h.type)return!1;const d="datetime-picker"===f?.input?.type?f.input.includeTime:void 0;return void 0===
d||d}},{key:"includeTimestamp",get:function(){return"timestamp-offset"===this.field.type}},{key:"initialFeature",set:function(f){this._set("initialFeature",f);this.notifyChange("valid")}},{key:"inputType",get:function(){return this.element?.input?.type}},{key:"isRelationshipKeyField",get:function(){const {field:f,layer:h}=this;return v.isRelatableFeatureSupportedLayer(h)&&!!h.relationships?.some(d=>d.keyField===f.name)}},{key:"label",get:function(){return this.element?.label||this.field.alias||this.field.name}},
{key:"maxLength",get:function(){if(this.dataType===p.Date)return-1;const {field:f,element:h}=this,d=f?.length,l=n.isFieldElementWithTextInput(h)?h.input.maxLength:NaN;return null!=l&&!isNaN(l)&&-1<=l&&(-1===d||l<=d)?l:d}},{key:"minLength",get:function(){if(this.dataType===p.Date)return-1;const {field:f,element:h}=this,d=f?.length,l=n.isFieldElementWithTextInput(h)?h.input.minLength:NaN;return null!=l&&!isNaN(l)&&-1<=l&&(-1===d||l<=d)?l:-1}},{key:"name",get:function(){return this.field?.name}},{key:"range",
get:function(){const {_dateRange:f,domain:h,field:d}=this,{max:l,min:q}=f,H=null!=l&&l&&!Number.isNaN(l.valueOf())?l.getTime():null,N=null!=q&&q&&!Number.isNaN(q.valueOf())?q.getTime():null;var E=g.getDomainRange(h)||u.getFieldRange(d);if(!E)return{max:H,min:N};const r=E.max===Number.MAX_VALUE?null:E.max;E=E.min===Number.MIN_VALUE?null:E.min;return{max:null!=H&&(null===r||null!=r&&H<r)?H:r,min:null!=N&&(null===E||null!=E&&N>E)?N:E}}},{key:"required",get:function(){const {editable:f,evaluatedRequiredExpression:h,
field:d,visible:l}=this;return f?!1===d?.nullable?!0:l&&null!=h?h:!1:!1},set:function(f){this._overrideIfSome("required",f)}},{key:"submittable",get:function(){const {field:f,required:h,valid:d,value:l}=this;return h&&null==l?!1:d?!0:this.initialFeature.getAttribute(f.name)===l}},{key:"updating",get:function(){const {editableExpressionExecutor:f,valueExpressionExecutor:h}=this;return null!=h&&h.updating||null!=f&&f.updating}},{key:"valid",get:function(){const f=this.editable?this._validate():null;
this._set("error",f);return null===f}},{key:"value",get:function(){if(this._shouldUseValueExpression){const f=this.evaluatedValueExpression;if(this.dataType===p.Date){if(f instanceof Date)return f.getTime();if("number"!==typeof f)return parseInt(f,10)}return null!=f&&"object"===typeof f?f.toString():f}return this.get("_storedValue")},set:function(f){this.notifyChange("evaluatedVisibilityExpression");this.set("_storedValue",f)}},{key:"visible",get:function(){return this._isEditTrackingField?!1:null!=
this.evaluatedVisibilityExpression?this.evaluatedVisibilityExpression:null!=this.element?!0:this._isVisibleByDefault}}]);return O}(k);e.__decorate([c.property()],m.prototype,"_storedValue",void 0);e.__decorate([c.property()],m.prototype,"_configAllowsEdits",null);e.__decorate([c.property()],m.prototype,"_layerAndFieldAllowEdits",null);e.__decorate([c.property()],m.prototype,"_isVisibleByDefault",null);e.__decorate([c.property()],m.prototype,"_isEditTrackingField",null);e.__decorate([c.property()],
m.prototype,"_shouldUseValueExpression",null);e.__decorate([c.property()],m.prototype,"dataType",null);e.__decorate([c.property()],m.prototype,"dateDataType",null);e.__decorate([c.property()],m.prototype,"domain",null);e.__decorate([c.property()],m.prototype,"editable",null);e.__decorate([c.property({readOnly:!0})],m.prototype,"error",void 0);e.__decorate([c.property()],m.prototype,"evaluatedRequiredExpression",null);e.__decorate([c.property()],m.prototype,"evaluatedValueExpression",null);e.__decorate([c.property()],
m.prototype,"field",void 0);e.__decorate([c.property()],m.prototype,"group",void 0);e.__decorate([c.property({readOnly:!0})],m.prototype,"hint",null);e.__decorate([c.property()],m.prototype,"includeDate",null);e.__decorate([c.property()],m.prototype,"includeTime",null);e.__decorate([c.property()],m.prototype,"includeTimestamp",null);e.__decorate([c.property()],m.prototype,"initialFeature",null);e.__decorate([c.property({readOnly:!0})],m.prototype,"inputType",null);e.__decorate([c.property()],m.prototype,
"label",null);e.__decorate([c.property()],m.prototype,"maxLength",null);e.__decorate([c.property()],m.prototype,"minLength",null);e.__decorate([c.property({readOnly:!0})],m.prototype,"name",null);e.__decorate([c.property()],m.prototype,"range",null);e.__decorate([c.property()],m.prototype,"required",null);e.__decorate([c.property()],m.prototype,"requiredExpressionExecutor",void 0);e.__decorate([c.property()],m.prototype,"submittable",null);e.__decorate([c.property({readOnly:!0})],m.prototype,"type",
void 0);e.__decorate([c.property()],m.prototype,"updating",null);e.__decorate([c.property()],m.prototype,"valid",null);e.__decorate([c.property({value:null})],m.prototype,"value",null);e.__decorate([c.property()],m.prototype,"valueExpressionExecutor",void 0);e.__decorate([c.property()],m.prototype,"visible",null);return m=e.__decorate([K.subclass("esri.widgets.FeatureForm.FieldInput")],m)})},"esri/widgets/FeatureForm/EditableInput":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../layers/support/layerUtils ./featureFormUtils ./InputBase".split(" "),
function(b,e,c,m,w,F,K,P,z,t){m=function(D){function a(g){g=D.call(this,g)||this;g.arcadeEditType="NA";g.editableExpressionExecutor=null;return g}b._inherits(a,D);b._createClass(a,[{key:"editable",get:function(){return this.layerAllowsEdits?this.evaluatedEditableExpression??!1:!1}},{key:"evaluatedEditableExpression",get:function(){const {editableExpressionExecutor:g}=this;return null!=g?!!g.lastEvaluatedValue:null}},{key:"layerAllowsEdits",get:function(){var {layer:g}=this;if(!g)return!1;var u=P.getEffectiveLayerCapabilities(g);
g=u?.operations.supportsEditing;u=z.capabilitiesAllowEditType(u,this.arcadeEditType);return!(!g||!u)}}]);return a}(t);e.__decorate([c.property()],m.prototype,"arcadeEditType",void 0);e.__decorate([c.property()],m.prototype,"editable",null);e.__decorate([c.property()],m.prototype,"editableExpressionExecutor",void 0);e.__decorate([c.property()],m.prototype,"evaluatedEditableExpression",null);e.__decorate([c.property()],m.prototype,"layerAllowsEdits",null);return m=e.__decorate([K.subclass("esri.widgets.FeatureForm.EditableInput")],
m)})},"esri/widgets/FeatureForm/InputBase":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/HandleOwner ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),function(b,e,c,m,w,F,K,P,z){c=function(t){function D(a){a=t.call(this,a)||this;a.element=null;a.feature=null;a.layer=null;a.type=null;a.visibilityExpressionExecutor=
null;return a}b._inherits(D,t);b._createClass(D,[{key:"description",get:function(){return this.element?.description}},{key:"evaluatedVisibilityExpression",get:function(){const {visibilityExpressionExecutor:a}=this;return null!=a?!!a.lastEvaluatedValue:null}},{key:"label",get:function(){return this.element?.label}},{key:"visible",get:function(){return null!=this.evaluatedVisibilityExpression?this.evaluatedVisibilityExpression:null!=this.element}}]);return D}(m.HandleOwnerMixin(c));e.__decorate([w.property({readOnly:!0})],
c.prototype,"description",null);e.__decorate([w.property({constructOnly:!0})],c.prototype,"element",void 0);e.__decorate([w.property()],c.prototype,"evaluatedVisibilityExpression",null);e.__decorate([w.property()],c.prototype,"feature",void 0);e.__decorate([w.property()],c.prototype,"label",null);e.__decorate([w.property()],c.prototype,"layer",void 0);e.__decorate([w.property()],c.prototype,"type",void 0);e.__decorate([w.property()],c.prototype,"visible",null);e.__decorate([w.property()],c.prototype,
"visibilityExpressionExecutor",void 0);return c=e.__decorate([z.subclass("esri.widgets.FeatureForm.InputBase")],c)})},"esri/widgets/FeatureForm/FormExpressionArcadeExecutor":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../arcade ../../core/Accessor ../../core/promiseUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../core/support/WatchUpdatingTracking ../../layers/support/fieldUtils".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a,g){P=Symbol("FormExpressionArcadeExecutor");b.FormExpressionArcadeExecutor=function(v){function k(p){var y=v.call(this,p)||this;y[u]=!0;y._lastEvaluatedValue=null;y._abortController=new AbortController;y._stale=!1;y._updatingTracking=new a.WatchUpdatingTracking;y._executeAsyncDebounced=F.debounce(async(O,C,f)=>{O=await y.executor.executeAsync(O,{...C,abortSignal:f});if(f.aborted)return y._lastEvaluatedValue;y._lastEvaluatedValue=O;y._stale=!1;return O});return y}e._inherits(k,
v);var n=k.prototype;n.abort=function(){this._abortController.abort()};n.execute=function(p,y){this._abortController=new AbortController;return this._lastEvaluatedValue=p=this.executor.execute(p,{...y,abortSignal:this._abortController.signal})};n.executeAsync=async function(p,y){this._abortController=new AbortController;return this._updatingTracking.addPromise(this._executeAsyncDebounced(p,y??{},this._abortController.signal))};n.markStale=function(){this._stale=!0};n.reset=function(){this.abort();
this._lastEvaluatedValue=null;this._stale=!1};e._createClass(k,[{key:"isAsync",get:function(){return this.executor.isAsync}},{key:"fieldsUsed",get:function(){return this.executor.fieldsUsed}},{key:"syntaxTree",get:function(){return this.executor.syntaxTree}},{key:"updating",get:function(){return this._updatingTracking.updating}},{key:"stale",get:function(){return this._stale}},{key:"geometryUsed",get:function(){return this.executor.geometryUsed}},{key:"variablesUsed",get:function(){return this.executor.variablesUsed}},
{key:"lastEvaluatedValue",get:function(){return this._lastEvaluatedValue}}]);return k}(w);var u=P;c.__decorate([K.property()],b.FormExpressionArcadeExecutor.prototype,"_lastEvaluatedValue",void 0);c.__decorate([K.property()],b.FormExpressionArcadeExecutor.prototype,"_stale",void 0);c.__decorate([K.property()],b.FormExpressionArcadeExecutor.prototype,"_updatingTracking",void 0);c.__decorate([K.property({constructOnly:!0})],b.FormExpressionArcadeExecutor.prototype,"executor",void 0);c.__decorate([K.property()],
b.FormExpressionArcadeExecutor.prototype,"isAsync",null);c.__decorate([K.property()],b.FormExpressionArcadeExecutor.prototype,"fieldsUsed",null);c.__decorate([K.property()],b.FormExpressionArcadeExecutor.prototype,"syntaxTree",null);c.__decorate([K.property()],b.FormExpressionArcadeExecutor.prototype,"updating",null);c.__decorate([K.property()],b.FormExpressionArcadeExecutor.prototype,"stale",null);c.__decorate([K.property()],b.FormExpressionArcadeExecutor.prototype,"geometryUsed",null);c.__decorate([K.property()],
b.FormExpressionArcadeExecutor.prototype,"variablesUsed",null);c.__decorate([K.property()],b.FormExpressionArcadeExecutor.prototype,"lastEvaluatedValue",null);b.FormExpressionArcadeExecutor=c.__decorate([D.subclass("esri.widgets.FeatureForm.FormExpressionArcadeExecutor")],b.FormExpressionArcadeExecutor);b.createFormExpressionArcadeExecutor=async(v,k)=>{const n=m.createArcadeProfile("form-calculation");v=await m.createArcadeExecutor(v,n,{});k?.fieldsIndex&&(v.fieldsUsed=g.fixFields(k.fieldsIndex,v.fieldsUsed));
return new b.FormExpressionArcadeExecutor({executor:v})};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/arcade":function(){define("exports ./Graphic ./arcade/ArcadeDate ./arcade/ImmutableArray ./core/Error ./core/lang ./layers/FeatureLayer ./portal/Portal ./rest/support/FeatureSet ./support/arcadeOnDemand".split(" "),function(b,e,c,m,w,F,K,P,z,t){function D(h,d,l,q={}){d=d.elementType;const H="array"===d.type?[{name:"value",type:d.type,elementType:d.elementType}]:"dictionary"===
d.type?[{name:"value",type:d.type,properties:d.properties}]:[{name:"value",type:d.type}];return new m(h.map(N=>{const E={};v(E,H,{value:N},l,q);return E.value}))}function a(h,d,l={}){h=h instanceof z?new K({source:h.features,geometryType:h.geometryType,fields:h.fields,spatialReference:h.spatialReference}):h;return d.constructFeatureSet(h,l.spatialReference,null,!0,l.lruCache,l.interceptor)}function g(h,d,l={}){const {spatialReference:q,interceptor:H,lruCache:N}=l;return"string"===typeof h?d.createFeatureSetCollectionFromService(h,
q,N,H):d.createFeatureSetCollectionFromMap(h,q,N,H)}function u(h,d,l,q={}){const H={};v(H,d.properties,h,l,q);return new y.Dictionary(H)}function v(h,d,l,q,H={}){const N={};for(const E of Object.keys(l))N[E.toLowerCase()]=l[E];for(const E of d)if(d=E.name.toLowerCase(),H.variablesPreProcessed)h[d]=N[d];else switch(E.type){case "array":l=N[d];h[d]=null==l?null:D(l,E,q,H);break;case "feature":l=N[d];h[d]=null==l?null:y.Feature.createFromGraphic(l,H?.timeReference);break;case "featureSet":l=N[d];h[d]=
null==l?null:q?a(l,q,H):null;break;case "featureSetCollection":l=N[d];h[d]=null==l?null:q?g(l,q,H):null;break;case "dictionary":l=N[d];h[d]=null==l?null:u(l,E,q,H);break;case "date":l=N[d];h[d]=l?l instanceof c.ArcadeDate?l:H?.timeReference?.timeZone?c.ArcadeDate.dateJSAndZoneToArcadeDate(l,H?.timeReference?.timeZone):c.ArcadeDate.dateJSToArcadeDate(l):null;break;case "geometry":case "boolean":case "text":case "number":h[d]=N[d]}}function k(h,d){for(const l of h)d.push(l),"dictionary"===l.type&&k(l.properties,
d);return d}function n(h,d,l,q,H){const {spatialReference:N,interceptor:E,lruCache:r,console:I,abortSignal:M,timeReference:S,services:U={portal:P.getDefault()}}=l;H={vars:{},spatialReference:N,interceptor:E,timeReference:S,lrucache:r,useAsync:H,services:U,console:I,abortSignal:M};if(!d)return H;v(H.vars,h.variables,d,q,l);return H}function p(h,d){switch(d.getArcadeType(h)){case "date":return h.toJSDate();case "feature":var l="geometry"in h?h.geometry():null;h="readAttributes"in h?h.readAttributes():
h.attributes;return new e({geometry:l,attributes:h});case "dictionary":l=h.attributes;const q={};for(const H of Object.keys(l))q[H]=p(h.field(H),d);return q;case "array":return("toArray"in h?h.toArray():h).map(H=>p(H,d))}return h}let y=null;const O={variables:[{name:"$feature",type:"feature"},{name:"$layer",type:"featureSet"},{name:"$datastore",type:"featureSetCollection"},{name:"$map",type:"featureSetCollection"}]},C={variables:[{name:"$feature",type:"feature"},{name:"$aggregatedFeatures",type:"featureSet"}]},
f=new Map([["form-constraint",{variables:[{name:"$feature",type:"feature"}]}],["feature-z",{variables:[{name:"$feature",type:"feature"}]}],["field-calculation",{variables:[{name:"$feature",type:"feature"},{name:"$datastore",type:"featureSetCollection"}]}],["form-calculation",{variables:[{name:"$feature",type:"feature"},{name:"$originalFeature",type:"feature"},{name:"$layer",type:"featureSet"},{name:"$featureSet",type:"featureSet"},{name:"$datastore",type:"featureSetCollection"},{name:"$map",type:"featureSetCollection"},
{name:"$editContext",type:"dictionary",properties:[{name:"editType",type:"text"}]}]}],["labeling",{variables:[{name:"$feature",type:"feature"}]}],["popup",O],["popup-element",O],["feature-reduction-popup",C],["feature-reduction-popup-element",C],["visualization",{variables:[{name:"$feature",type:"feature"},{name:"$view",type:"dictionary",properties:[{name:"scale",type:"number"}]}]}]]);b.createArcadeExecutor=async function(h,d,l={}){y||(y=await t.loadArcade());const {arcade:q,arcadeUtils:H}=y,{loadScriptDependencies:N,
referencesMember:E,scriptIsAsync:r}=q;var I=k(d.variables,[]),M=I.filter(x=>"featureSet"===x.type||"featureSetCollection"===x.type).map(x=>x.name.toLowerCase());const S=q.parseScript(h,M);if(!S)throw new w("arcade:invalid-script","Unable to create SyntaxTree");h=H.extractFieldNames(S);const U=q.scriptTouchesGeometry(S);I=I.map(x=>x.name.toLowerCase()).filter(x=>E(S,x));const G=r(S,M);await N(S,G,M);M={vars:{},spatialReference:null,useAsync:G};for(const x of I)M.vars[x]="any";const {lruCache:J}=l,
L=q.compileScript(S,M),B=q.featureSetUtils(),{services:A}=l;return{execute:(x,Q={})=>{if(G)throw new w("arcade:invalid-execution-mode","Cannot execute the script in synchronous mode");x=L(n(d,x,{lruCache:J,...Q},B,G));return Q.rawOutput?x:p(x,H)},executeAsync:async(x,Q={})=>{x=await L(n(d,x,{lruCache:J,services:A,...Q},B,G));return Q.rawOutput?x:p(x,H)},isAsync:G,variablesUsed:I,fieldsUsed:h,geometryUsed:U,syntaxTree:S}};b.createArcadeProfile=function(h){var d=f.get(h);if(!d)throw d=Array.from(f.keys()).map(l=>
`'${l}'`).join(", "),new w("createArcadeProfile:invalid-profile-name",`Invalid profile name '${h}'. You must specify one of the following values: ${d}`);return F.clone(d)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/ArcadeDate":function(){define(["exports","../chunks/_rollupPluginBabelHelpers","./executionError","../chunks/datetime"],function(b,e,c,m){function w(t){if(t instanceof m.Zone)return t;if("system"===t.toLowerCase())return"system";if("utc"===t.toLowerCase())return"utc";
if("unknown"===t.toLowerCase())return F.instance;if(/^[\+\-]?[0-9]{1,2}([:][0-9]{2})?$/.test(t)){const D=m.FixedOffsetZone.parseSpecifier("UTC"+(t.startsWith("+")||t.startsWith("-")?"":"+")+t);if(D)return D}t=m.IANAZone.create(t);if(!t.isValid)throw new P(b.ArcadeDateErrorCodes.TimeZoneNotRecognised);return t}let F=e._createClass(function(){});F.instance=new m.IANAZone("Etc/UTC");b.ArcadeDateErrorCodes=void 0;(b.ArcadeDateErrorCodes||(b.ArcadeDateErrorCodes={})).TimeZoneNotRecognised="TimeZoneNotRecognised";
const K={[b.ArcadeDateErrorCodes.TimeZoneNotRecognised]:"Timezone identifier has not been recognised."};let P=function(t){function D(a,g){a=t.call(this,c.doSubstitutions(K[a],g))||this;a.declaredRootClass="esri.arcade.arcadedate.dateerror";Error.captureStackTrace&&Error.captureStackTrace(e._assertThisInitialized(a),D);return a}e._inherits(D,t);return e._createClass(D)}(e._wrapNativeSuper(Error)),z=function(){function t(a){this._date=a;this.declaredRootClass="esri.arcade.arcadedate"}t.fromParts=function(a=
0,g=1,u=1,v=0,k=0,n=0,p=0,y){if(isNaN(a)||isNaN(g)||isNaN(u)||isNaN(v)||isNaN(k)||isNaN(n)||isNaN(p))return null;let O=0;var C=m.DateTime.local(a,g).daysInMonth;1>u&&(O=u-1,u=1);u>C&&(O=u-C,u=C);C=0;12<g?(C=g-12,g=12):1>g&&(C=g-1,g=1);let f=0;59<k?(f=k-59,k=59):0>k&&(f=k,k=0);let h=0;59<n?(h=n-59,n=59):0>n&&(h=n,n=0);let d=0;999<p?(d=p-999,p=999):0>p&&(d=p,p=0);a=m.DateTime.fromObject({day:u,year:a,month:g,hour:v,minute:k,second:n,millisecond:p},{zone:w(y)});0!==C&&(a=a.plus({months:C}));0!==O&&(a=
a.plus({days:O}));0!==f&&(a=a.plus({minutes:f}));0!==h&&(a=a.plus({seconds:h}));0!==d&&(a=a.plus({milliseconds:d}));return new t(a)};t.arcadeDateAndZoneToArcadeDate=function(a,g){const u=w(g);return a.isUnknownTimeZone||u===F.instance?t.fromParts(a.year,a.monthJS+1,a.day,a.hour,a.minute,a.second,a.millisecond,u):new t(a._date.setZone(g))};t.dateJSToArcadeDate=function(a){return new t(m.DateTime.fromJSDate(a,{zone:"system"}))};t.dateJSAndZoneToArcadeDate=function(a,g="system"){return new t(m.DateTime.fromJSDate(a,
{zone:g}))};t.unknownEpochToArcadeDate=function(a){return new t(m.DateTime.fromMillis(a,{zone:F.instance}))};t.unknownDateJSToArcadeDate=function(a){return new t(m.DateTime.fromMillis(a.getTime(),{zone:F.instance}))};t.epochToArcadeDate=function(a,g="system"){return new t(m.DateTime.fromMillis(a,{zone:g}))};t.dateTimeToArcadeDate=function(a){return new t(a)};var D=t.prototype;D.clone=function(){return new t(this._date)};D.changeTimeZone=function(a){a=w(a);return t.dateTimeToArcadeDate(this._date.setZone(a))};
t.dateTimeAndZoneToArcadeDate=function(a,g){g=w(g);return a.zone===F.instance||g===F.instance?t.fromParts(a.year,a.month,a.day,a.hour,a.minute,a.second,a.millisecond,g):new t(a.setZone(g))};t.nowToArcadeDate=function(a){return new t(m.DateTime.fromJSDate(new Date,{zone:a}))};t.nowUTCToArcadeDate=function(){return new t(m.DateTime.utc())};D.equals=function(a){return this.isSystem&&a.isSystem?this.toNumber()===a.toNumber():this.isUnknownTimeZone!==a.isUnknownTimeZone?!1:this._date.equals(a._date)};
D.stringify=function(){return JSON.stringify(this.toJSDate())};D.plus=function(a){return new t(this._date.plus(a))};D.diff=function(a,g="milliseconds"){return this._date.diff(a._date,g)[g]};D.toISOString=function(a){return a?this._date.toISO({suppressMilliseconds:!0,includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})};D.toFormat=function(a,g){return this._date.toFormat(a,g)};D.toJSDate=function(){return this._date.toJSDate()};D.toSQLString=function(){return"timestamp '"+
this._date.toFormat("yyyy-LL-dd HH:mm:ss")+"'"};D.toDateTime=function(){return this._date};D.toNumber=function(){return this._date.toMillis()};D.getTime=function(){return this._date.toMillis()};D.toUTC=function(){return new t(this._date.toUTC())};D.toLocal=function(){return new t(this._date.toLocal())};D.toString=function(){return this.toISOString(!0)};e._createClass(t,[{key:"isSystem",get:function(){return"system"===this.timeZone||this.timeZone===t.systemTimeZoneCanonicalName}},{key:"isUnknownTimeZone",
get:function(){return this._date.zone===F.instance}},{key:"isValid",get:function(){return this._date.isValid}},{key:"hour",get:function(){return this._date.hour}},{key:"second",get:function(){return this._date.second}},{key:"day",get:function(){return this._date.day}},{key:"dayOfWeekISO",get:function(){return this._date.weekday}},{key:"dayOfWeekJS",get:function(){let a=this._date.weekday;6<a&&(a=0);return a}},{key:"millisecond",get:function(){return this._date.millisecond}},{key:"monthISO",get:function(){return this._date.month}},
{key:"weekISO",get:function(){return this._date.weekNumber}},{key:"yearISO",get:function(){return this._date.weekYear}},{key:"monthJS",get:function(){return this._date.month-1}},{key:"year",get:function(){return this._date.year}},{key:"minute",get:function(){return this._date.minute}},{key:"zone",get:function(){return this._date.zone}},{key:"timeZoneOffset",get:function(){return this.isUnknownTimeZone?0:this._date.offset}},{key:"timeZone",get:function(){if(this.isUnknownTimeZone)return"unknown";if("system"===
this._date.zone.type)return"system";const a=this.zone;return"fixed"===a.type?0===a.fixed?"utc":a.formatOffset(0,"short"):a.name}}],[{key:"systemTimeZoneCanonicalName",get:function(){return Intl.DateTimeFormat().resolvedOptions().timeZone??"system"}}]);return t}();b.ArcadeDate=z;b.ArcadeDateError=P;b.ArcadeDateErrorMessages=K;b.UnknownTimeZone=F;b.createDateTimeZone=w;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/executionError":function(){define(["exports","../chunks/_rollupPluginBabelHelpers"],
function(b,e){function c(g){return g&&g.loc?`Line : ${g.loc.start?.line}, ${g.loc.start?.column}: `:""}function m(g,u){try{if(!u)return g;for(const v in u){let k=u[v];k||(k="");g=g.replace("{"+v+"}",u[v])}}catch(v){}return g}b.ExecutionErrorCodes=void 0;(function(g){g.AsyncNotEnabled="AsyncNotEnabled";g.ModulesNotSupported="ModulesNotSupported";g.CircularModules="CircularModules";g.NeverReach="NeverReach";g.UnsupportedHashType="UnsupportedHashType";g.InvalidParameter="InvalidParameter";g.UnexpectedToken=
"UnexpectedToken";g.Unrecognised="Unrecognised";g.UnrecognisedType="UnrecognisedType";g.MaximumCallDepth="MaximumCallDepth";g.BooleanConditionRequired="BooleanConditionRequired";g.TypeNotAllowedInFeature="TypeNotAllowedInFeature";g.KeyMustBeString="KeyMustBeString";g.WrongNumberOfParameters="WrongNumberOfParameters";g.CallNonFunction="CallNonFunction";g.NoFunctionInTemplateLiteral="NoFunctionInTemplateLiteral";g.NoFunctionInDictionary="NoFunctionInDictionary";g.NoFunctionInArray="NoFunctionInArray";
g.AssignModuleFunction="AssignModuleFunction";g.LogicExpressionOrAnd="LogicExpressionOrAnd";g.LogicalExpressionOnlyBoolean="LogicalExpressionOnlyBoolean";g.FunctionNotFound="FunctionNotFound";g.InvalidMemberAccessKey="InvalidMemberAccessKey";g.UnsupportedUnaryOperator="UnsupportUnaryOperator";g.InvalidIdentifier="InvalidIdentifier";g.MemberOfNull="MemberOfNull";g.UnsupportedOperator="UnsupportedOperator";g.Cancelled="Cancelled";g.ModuleAccessorMustBeString="ModuleAccessorMustBeString";g.ModuleExportNotFound=
"ModuleExportNotFound";g.Immutable="Immutable";g.OutOfBounds="OutOfBounds";g.IllegalResult="IllegalResult";g.FieldNotFound="FieldNotFound";g.PortalRequired="PortalRequired";g.LogicError="LogicError";g.ArrayAccessorMustBeNumber="ArrayAccessMustBeNumber";g.KeyAccessorMustBeString="KeyAccessorMustBeString";g.WrongSpatialReference="WrongSpatialReference"})(b.ExecutionErrorCodes||(b.ExecutionErrorCodes={}));const w={[b.ExecutionErrorCodes.TypeNotAllowedInFeature]:"Feature attributes only support dates, numbers, strings, guids.",
[b.ExecutionErrorCodes.LogicError]:"Logic error - {reason}",[b.ExecutionErrorCodes.NeverReach]:"Encountered unreachable logic",[b.ExecutionErrorCodes.AsyncNotEnabled]:"Async Arcade must be enabled for this script",[b.ExecutionErrorCodes.ModuleAccessorMustBeString]:"Module accessor must be a string",[b.ExecutionErrorCodes.ModuleExportNotFound]:"Module has no export with provided identifier",[b.ExecutionErrorCodes.ModulesNotSupported]:"Current profile does not support modules",[b.ExecutionErrorCodes.ArrayAccessorMustBeNumber]:"Array accessor must be a number",
[b.ExecutionErrorCodes.FunctionNotFound]:"Function not found",[b.ExecutionErrorCodes.FieldNotFound]:"Key not found - {key}",[b.ExecutionErrorCodes.CircularModules]:"Circular module dependencies are not allowed",[b.ExecutionErrorCodes.Cancelled]:"Execution cancelled",[b.ExecutionErrorCodes.UnsupportedHashType]:"Type not supported in hash function",[b.ExecutionErrorCodes.IllegalResult]:"Value is not a supported return type",[b.ExecutionErrorCodes.PortalRequired]:"Portal is required",[b.ExecutionErrorCodes.InvalidParameter]:"Invalid parameter",
[b.ExecutionErrorCodes.WrongNumberOfParameters]:"Call with wrong number of parameters",[b.ExecutionErrorCodes.Unrecognised]:"Unrecognised code structure",[b.ExecutionErrorCodes.UnrecognisedType]:"Unrecognised type",[b.ExecutionErrorCodes.WrongSpatialReference]:"Cannot work with geometry in this spatial reference. It is different to the execution spatial reference",[b.ExecutionErrorCodes.BooleanConditionRequired]:"Conditions must use booleans",[b.ExecutionErrorCodes.NoFunctionInDictionary]:"Dictionaries cannot contain functions.",
[b.ExecutionErrorCodes.NoFunctionInArray]:"Arrays cannot contain functions.",[b.ExecutionErrorCodes.NoFunctionInTemplateLiteral]:"Template Literals do not expect functions by value.",[b.ExecutionErrorCodes.KeyAccessorMustBeString]:"Accessor must be a string",[b.ExecutionErrorCodes.KeyMustBeString]:"Object keys must be a string",[b.ExecutionErrorCodes.Immutable]:"Object is immutable",[b.ExecutionErrorCodes.UnexpectedToken]:"Unexpected token",[b.ExecutionErrorCodes.MemberOfNull]:"Cannot access property of null object",
[b.ExecutionErrorCodes.MaximumCallDepth]:"Exceeded maximum function depth",[b.ExecutionErrorCodes.OutOfBounds]:"Out of bounds",[b.ExecutionErrorCodes.InvalidIdentifier]:"Identifier not recognised",[b.ExecutionErrorCodes.CallNonFunction]:"Expression is not a function",[b.ExecutionErrorCodes.InvalidMemberAccessKey]:"Cannot access value using a key of this type",[b.ExecutionErrorCodes.AssignModuleFunction]:"Cannot assign function to module variable",[b.ExecutionErrorCodes.UnsupportedUnaryOperator]:"Unsupported unary operator",
[b.ExecutionErrorCodes.UnsupportedOperator]:"Unsupported operator",[b.ExecutionErrorCodes.LogicalExpressionOnlyBoolean]:"Logical expressions must be boolean",[b.ExecutionErrorCodes.LogicExpressionOrAnd]:"Logical expression can only be combined with || or \x26\x26"};let F=function(g){function u(...v){return g.call(this,...v)||this}e._inherits(u,g);return e._createClass(u)}(e._wrapNativeSuper(Error)),K=function(g){function u(v,k){v=g.call(this,c(k)+v.message,{cause:v})||this;v.loc=null;Error.captureStackTrace&&
Error.captureStackTrace(e._assertThisInitialized(v),u);k&&k.loc&&(v.loc=k.loc);return v}e._inherits(u,g);return e._createClass(u)}(F),P=function(g){function u(v,k,n,p){v=g.call(this,"Execution error - "+c(n)+m(w[k],p))||this;v.loc=null;v.declaredRootClass="esri.arcade.arcadeexecutionerror";Error.captureStackTrace&&Error.captureStackTrace(e._assertThisInitialized(v),u);n&&n.loc&&(v.loc=n.loc);return v}e._inherits(u,g);return e._createClass(u)}(e._wrapNativeSuper(Error)),z=function(g){function u(v,
k,n,p){v=g.call(this,"Compilation error - "+c(n)+m(w[k],p))||this;v.loc=null;v.declaredRootClass="esri.arcade.arcadecompilationerror";Error.captureStackTrace&&Error.captureStackTrace(e._assertThisInitialized(v),u);n&&n.loc&&(v.loc=n.loc);return v}e._inherits(u,g);return e._createClass(u)}(e._wrapNativeSuper(Error)),t=function(g){function u(){var v=g.call(this,"Uncompilable code structures")||this;v.declaredRootClass="esri.arcade.arcadeuncompilableerror";Error.captureStackTrace&&Error.captureStackTrace(e._assertThisInitialized(v),
u);return v}e._inherits(u,g);return e._createClass(u)}(e._wrapNativeSuper(Error));b.ModuleErrorCodes=void 0;(function(g){g.UnrecognisedUri="UnrecognisedUri";g.UnsupportedUriProtocol="UnsupportedUriProtocol"})(b.ModuleErrorCodes||(b.ModuleErrorCodes={}));const D={[b.ModuleErrorCodes.UnrecognisedUri]:"Unrecognised uri - {uri}",[b.ModuleErrorCodes.UnsupportedUriProtocol]:"Unrecognised uri protocol"};let a=function(g){function u(v,k){v=g.call(this,m(D[v],k))||this;v.declaredRootClass="esri.arcade.arcademoduleerror";
Error.captureStackTrace&&Error.captureStackTrace(e._assertThisInitialized(v),u);return v}e._inherits(u,g);return e._createClass(u)}(e._wrapNativeSuper(Error));b.ArcadeCompilationError=z;b.ArcadeExecutionError=P;b.ArcadeUncompilableError=t;b.ErrorWithCause=F;b.ExecutionErrorMessages=w;b.LocatableArcadeExecutionError=K;b.ModuleError=a;b.ModuleErrorMessages=D;b.doSubstitutions=m;b.ensureArcadeExecutionError=function(g,u,v){return"esri.arcade.arcadeexecutionerror"===v.declaredRootClass||"esri.arcade.arcadecompilationerror"===
v.declaredRootClass?null===v.loc&&u&&u.loc?new K(v,{cause:v}):v:u&&u.loc?new K(v,{cause:v}):v};b.parsingValidationMessage=function(g,u,v){return"Parsing error - "+c(g)+m(w[u],v)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/ImmutableArray":function(){define(["../chunks/_rollupPluginBabelHelpers"],function(b){return function(){function e(m=[]){this._elements=m}var c=e.prototype;c.length=function(){return this._elements.length};c.get=function(m){return this._elements[m]};
c.toArray=function(){const m=[];for(let w=0;w<this.length();w++)m.push(this.get(w));return m};return b._createClass(e)}()})},"esri/widgets/FeatureForm/FormExpressionsManager":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/MapUtils ../../core/promiseUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D){b.FormExpressionsManager=function(u){function v(n){var p=u.call(this,n)||this;p._fieldReferencesLookup=new Map;p._fieldsAffectedLookup=new Map;p._latestFieldValues={...n.feature.attributes};return p}e._inherits(v,u);var k=v.prototype;k.initialize=function(){this._dependencyGraph=this._buildDependencyGraph()};k.evaluateAll=function(){return this._evaluate(this.executors)};k.evaluateExpressions=function(n){return this._evaluate(n)};k.evaluateInvalidated=function(n){const {_fieldReferencesLookup:p,
_latestFieldValues:y,feature:O}=this,C=new Set;for(const f of n)if(y[f]=O.getAttribute(f),p.has(f))for(const h of p.get(f))C.add(h);return this._evaluate([...C])};k.evaluateInvalidatedByGeometry=async function(){if(this._fieldReferencesLookup.has("#JSAPI_FORM_EXPRESSIONS_MANAGER_GEOMETRY"))return this._evaluate([...this._fieldReferencesLookup.get("#JSAPI_FORM_EXPRESSIONS_MANAGER_GEOMETRY")])};k.resetExecutors=function(){for(const n of this.executors)n.reset()};k._buildDependencyGraph=function(){const {_fieldReferencesLookup:n,
_fieldsAffectedLookup:p,executors:y}=this,O=new Map(this.fieldInputs.map(f=>[f.name,f])),C=new Map(y.map(f=>[f,[]]));for(const f of y){for(const h of f.fieldsUsed){w.getOrCreateMapValue(n,h,()=>new Set).add(f);const d=O.get(h),l=d?.valueExpressionExecutor,q=d?.editableExpressionExecutor;null!=l&&l!==f&&(C.get(l).push(f),w.getOrCreateMapValue(p,l,()=>new Set).add(d));null!=q&&q!==f&&(C.get(q).push(f),w.getOrCreateMapValue(p,q,()=>new Set).add(d))}f.geometryUsed&&w.getOrCreateMapValue(n,"#JSAPI_FORM_EXPRESSIONS_MANAGER_GEOMETRY",
()=>new Set).add(f)}return C};k._evaluate=async function(n){const p=new Map,{_dependencyGraph:y,_fieldsAffectedLookup:O,_latestFieldValues:C}=this;for(const f of n)a(f,p,y);for(const [f,{resolver:h,dependencyPromises:d}]of p)Promise.all(d).then(async()=>{const [l,q]=this._makeContext(C);return f.executeAsync(l,q)}).then(()=>{if(O.has(f))for(const l of O.get(f))this._latestFieldValues[l.name]=l.value;h.resolve()},l=>{!l||F.isAbortError(l)||g(l)||f.markStale();h.reject(l)});n=(await Promise.allSettled(Array.from(p.values(),
({resolver:f})=>f.promise))).filter(f=>"rejected"===f.status&&!(F.isAbortError(f.reason)||g(f.reason)));if(0<n.length)throw new AggregateError(n,"One or more expression executions failed");};k._makeContext=function(n){const [p,y]=this._baseContext,O=this.feature.clone();O.attributes=n;return[{...p,$feature:O},y]};e._createClass(v,[{key:"_baseContext",get:function(){const {editType:n,layer:p,map:y,originalFeature:O,spatialReference:C}=this.arcadeContextInfo,f="feature"===p?.type?p:"scene"===p?.type&&
null!=p.associatedLayer?p.associatedLayer:void 0;return[{$originalfeature:O,$editcontext:{editType:n},$layer:f,$featureset:f,$datastore:p?.url,$map:y},{spatialReference:C??void 0}]}},{key:"feature",set:function(n){this._latestFieldValues={...n?.attributes};this._set("feature",n)}}]);return v}(m);c.__decorate([K.property()],b.FormExpressionsManager.prototype,"_baseContext",null);c.__decorate([K.property()],b.FormExpressionsManager.prototype,"feature",null);c.__decorate([K.property()],b.FormExpressionsManager.prototype,
"executors",void 0);c.__decorate([K.property()],b.FormExpressionsManager.prototype,"fieldInputs",void 0);c.__decorate([K.property()],b.FormExpressionsManager.prototype,"arcadeContextInfo",void 0);b.FormExpressionsManager=c.__decorate([D.subclass("esri.widgets.FeatureForm.FormExpressionsManager")],b.FormExpressionsManager);const a=(u,v,k)=>{if(!v.has(u)){var n=F.createResolver();v.set(u,{resolver:n,dependencyPromises:[]});u.abort();u=k.get(u);for(const p of u)a(p,v,k),v.get(p).dependencyPromises.push(n.promise)}},
g=u=>u&&"object"===typeof u&&"message"in u&&"Cancelled"===u.message;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/FeatureForm/GroupInput":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/deprecate ../../core/Logger ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./featureFormUtils ./InputBase".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a,g){const u=m.getLogger("esri.widgets.FeatureForm.GroupInput");m=function(v){function k(p){p=v.call(this,p)||this;p._expressionTrackingHandles=new Map;p.type="group";return p}b._inherits(k,v);var n=k.prototype;n.initialize=function(){this.addHandles([F.watch(()=>[this.visible,this.inputs],([p])=>{const {inputs:y}=this;p=p?void 0:!1;for(const O of y)a.isFieldInput(O)&&(O.required=p)},{initial:!0,equals:(p,y)=>y[0]===p[0]&&y[1]===p[1]})])};n.destroy=function(){for(const p of this._expressionTrackingHandles.values())p.remove()};
n._dirtyEvaluatedVisibilityExpression=function(){const {element:p}=this;p.visibilityExpression&&this.notifyChange("evaluatedVisibilityExpression")};b._createClass(k,[{key:"inputFields",get:function(){c.deprecated(u,"Property: GroupInput.inputFields",{replacement:"GroupInput.inputs",version:"4.27"});return this.inputs},set:function(p){c.deprecated(u,"Property: GroupInput.inputFields",{replacement:"GroupInput.inputs",version:"4.27"});this.inputs=p}},{key:"inputs",get:function(){return this._get("inputs")},
set:function(p){this.handles.removeAll();p&&this.handles.add(p.map(y=>F.watch(()=>y.visible,()=>this._dirtyEvaluatedVisibilityExpression())));this._set("inputs",p)}},{key:"label",get:function(){return this.element.label},set:function(p){w.applySome(this.element,y=>{y.label=p})}},{key:"state",get:function(){return this.element.initialState||"expanded"},set:function(p){this._overrideIfSome("state",p)}},{key:"visible",get:function(){return!1!==this.evaluatedVisibilityExpression&&this.inputs&&this.inputs.some(p=>
p.visible)}}]);return k}(g);e.__decorate([K.property()],m.prototype,"inputs",null);e.__decorate([K.property()],m.prototype,"label",null);e.__decorate([K.property()],m.prototype,"state",null);e.__decorate([K.property({readOnly:!0})],m.prototype,"type",void 0);e.__decorate([K.property()],m.prototype,"visible",null);return m=e.__decorate([D.subclass("esri.widgets.FeatureForm.GroupInput")],m)})},"esri/widgets/FeatureForm/RelationshipInput":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../layers/support/layerUtils ../Feature/FeatureRelationship/FeatureRelationshipViewModel ../Feature/support/featureUtils ./EditableInput".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a){w=function(g){function u(k){var n=g.call(this,k)||this;n._relationshipVM=null;n.group=null;n.type="relationship";n.handles.add([c.watch(()=>({feature:n.feature,element:n.element,layer:n.layer}),p=>n._createRelationshipVM(p),c.initial)]);return n}b._inherits(u,g);var v=u.prototype;v.destroy=function(){this._relationshipVM?.destroy()};v.incrementPage=function(){this._relationshipVM&&this._relationshipVM.featurePage++};v.getRelatedFeatureByObjectId=function(k){return this._relationshipVM?.getRelatedFeatureByObjectId(k)};
v._createRelationshipVM=function(k){const {feature:n,element:p,layer:y}=k;this._relationshipVM?.destroy();if(n&&p&&y){var {displayCount:O,map:C,orderByFields:f,relationshipId:h,showAllEnabled:d}=this;D.isRelatableFeatureSupportedLayer(y)&&(this._relationshipVM=new t({graphic:n,displayCount:O,layer:y,map:C,orderByFields:f,relationshipId:h,showAllEnabled:d}))}};b._createClass(u,[{key:"canAddRelatedFeature",get:function(){const {editable:k,featureCount:n,_relationshipVM:p}=this;if(!p?.relationship||
!this.loaded||!this.relatedLayerAllowsAdds)return!1;const {cardinality:y,role:O}=p.relationship;return"one-to-one"===y&&0<n||"many-to-many"===y||"one-to-many"===y&&"destination"===O&&0<n?!1:k}},{key:"displayCount",get:function(){return this.element.displayCount??3}},{key:"displayType",get:function(){return this.element.displayType}},{key:"editable",get:function(){return this.relatedLayerAllowsEdits?this.evaluatedEditableExpression??!1:!1}},{key:"featureCount",get:function(){return this._relationshipVM?.featureCount??
0}},{key:"map",get:function(){return this._get("map")},set:function(k){k&&this._relationshipVM?.set("map",k);this._set("map",k)}},{key:"orderByFields",get:function(){return this.element.orderByFields}},{key:"relationshipId",get:function(){return this.element.relationshipId}},{key:"relatedFeatureInfos",get:function(){return this._relationshipVM?.relatedFeatureInfos??[]}},{key:"relatedLayer",get:function(){return this._relationshipVM?.relatedLayer}},{key:"relatedLayerAllowsAdds",get:function(){const {relatedLayer:k}=
this;return k&&this.relatedLayerAllowsEdits?!!z.getEffectiveLayerCapabilities(k)?.operations?.supportsAdd:!1}},{key:"relatedLayerAllowsEdits",get:function(){const {relatedLayer:k}=this;return k?!!z.getEffectiveLayerCapabilities(k)?.operations?.supportsEditing:!1}},{key:"showAllEnabled",get:function(){return this._get("showAllEnabled")},set:function(k){this._relationshipVM?.set("showAllEnabled",k);this._set("showAllEnabled",k)}},{key:"showAllActionVisible",get:function(){return!this.showAllEnabled&&
0<this.featureCount&&this.featureCount>this.displayCount}},{key:"visible",get:function(){const {_relationshipVM:k,relatedLayer:n}=this;if(!k?.relationship)return!1;const {cardinality:p}=k.relationship;return"many-to-many"===p||n&&!z.isTable(n)?!1:null!=this.evaluatedVisibilityExpression?this.evaluatedVisibilityExpression:null!=this.element}},{key:"updating",get:function(){return"loading"===this._relationshipVM?.state||"querying"===this._relationshipVM?.state}},{key:"loaded",get:function(){return"ready"===
this._relationshipVM?.state}}]);return u}(a);e.__decorate([m.property()],w.prototype,"canAddRelatedFeature",null);e.__decorate([m.property()],w.prototype,"displayCount",null);e.__decorate([m.property()],w.prototype,"displayType",null);e.__decorate([m.property()],w.prototype,"editable",null);e.__decorate([m.property()],w.prototype,"group",void 0);e.__decorate([m.property()],w.prototype,"map",null);e.__decorate([m.property()],w.prototype,"orderByFields",null);e.__decorate([m.property()],w.prototype,
"relationshipId",null);e.__decorate([m.property()],w.prototype,"relatedFeatureInfos",null);e.__decorate([m.property()],w.prototype,"relatedLayer",null);e.__decorate([m.property()],w.prototype,"relatedLayerAllowsAdds",null);e.__decorate([m.property()],w.prototype,"relatedLayerAllowsEdits",null);e.__decorate([m.property()],w.prototype,"showAllEnabled",null);e.__decorate([m.property()],w.prototype,"showAllActionVisible",null);e.__decorate([m.property({readOnly:!0})],w.prototype,"type",void 0);e.__decorate([m.property()],
w.prototype,"visible",null);e.__decorate([m.property()],w.prototype,"updating",null);e.__decorate([m.property()],w.prototype,"incrementPage",null);e.__decorate([m.property()],w.prototype,"getRelatedFeatureByObjectId",null);return w=e.__decorate([P.subclass("esri.widgets.FeatureForm.RelationshipInput")],w)})},"esri/widgets/Feature/FeatureRelationship/FeatureRelationshipViewModel":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Graphic ../../../core/Accessor ../../../core/arrayUtils ../../../core/Clonable ../../../core/Collection ../../../core/HandleOwner ../../../core/Identifiable ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../rest/support/RelationshipQuery ../support/featureUtils ../../FeatureForm/featureFormUtils".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a,g,u,v,k,n,p){m=function(y){function O(f){var h=y.call(this,f)||this;h._loaded=!1;h._queryAbortController=null;h._queryPageAbortController=null;h._queryFeatureCountAbortController=null;h.featuresPerPage=10;h.description=null;h.graphic=null;h.layer=null;h.map=null;h.orderByFields=null;h.featureCount=0;h.relationshipId=null;h.showAllEnabled=!1;h.title=null;h._cancelQuery=()=>{const {_queryAbortController:d}=b._assertThisInitialized(h);d&&d.abort();h._queryAbortController=
null};h._cancelQueryFeatureCount=()=>{const {_queryFeatureCountAbortController:d}=b._assertThisInitialized(h);d&&d.abort();h._queryFeatureCountAbortController=null};h._cancelQueryPage=()=>{const {_queryPageAbortController:d}=b._assertThisInitialized(h);d&&d.abort();h._queryPageAbortController=null};h._queryController=async()=>{h._cancelQuery();const d=new AbortController;h._queryAbortController=d;await t.ignoreAbortErrors(h._query());h._queryAbortController===d&&(h._queryAbortController=null)};h._queryFeatureCountController=
async()=>{h._loaded=!1;h._cancelQueryFeatureCount();const d=new AbortController;h._queryFeatureCountAbortController=d;await t.ignoreAbortErrors(h._queryFeatureCount());h._queryFeatureCountAbortController===d&&(h._queryFeatureCountAbortController=null);h._loaded=!0};h._queryPageController=async()=>{const d=new AbortController;h._queryPageAbortController=d;await t.ignoreAbortErrors(h._queryPage());h._queryPageAbortController===d&&(h._queryPageAbortController=null)};h._queryDebounced=t.debounce(h._queryController,
100);h._queryFeatureCountDebounced=t.debounce(h._queryFeatureCountController,100);h._queryPageDebounced=t.debounce(h._queryPageController,100);h._query=async()=>{const {_queryAbortController:d,relatedFeatures:l}=b._assertThisInitialized(h);h.featureCount&&(h._destroyRelatedFeatureViewModels(),h.featurePage=1,l.removeAll(),h.destroyed||l.addMany(h._sliceFeatures(await h._queryRelatedFeatures({signal:d?.signal}))))};h.handles.add([D.watch(()=>[h.displayCount,h.graphic,h.layer,h.layer?.loaded,h.map,
h.orderByFields,h.relationshipId,h.featuresPerPage,h.showAllEnabled,h.canQuery,h.featureCount],()=>h._queryDebounced(),D.initial),D.watch(()=>[h.featurePage,h.showAllEnabled],()=>h._queryPageDebounced()),D.watch(()=>[h.layer,h.relationshipId,h.objectId,h.canQuery],()=>h._queryFeatureCountDebounced())]);return h}b._inherits(O,y);var C=O.prototype;C.destroy=function(){this._destroyRelatedFeatureViewModels();this.relatedFeatures.removeAll();this._cancelQuery();this._cancelQueryFeatureCount();this._cancelQueryPage()};
C.getRelatedFeatureByObjectId=function(f){return this.relatedFeatures.find(h=>h.getObjectId()===f)};C._destroyRelatedFeatureViewModels=function(){this.relatedFeatureViewModels?.forEach(f=>!f.destroyed&&f.destroy());this.relatedFeatureViewModels.removeAll()};C._queryFeatureCount=async function(){const {layer:f,relatedLayer:h,relationshipId:d,objectId:l,_queryFeatureCountAbortController:q,canQuery:H,supportsCacheHint:N}=this;await f?.load();await h?.load();if(H&&f&&h){var E=h.createQuery();E=new k({cacheHint:N,
relationshipId:d,returnGeometry:!1,objectIds:[l],where:E.where??void 0});E=await f.queryRelatedFeaturesCount(E,{signal:q?.signal});this._set("featureCount",E[l]||0)}else this._set("featureCount",0)};C._sliceFeatures=function(f){const {showAllEnabled:h,displayCount:d}=this;return h?f:d?f.slice(0,d):[]};C._queryPage=async function(){const {relatedFeatures:f,featurePage:h,showAllEnabled:d,_queryPageAbortController:l,featureCount:q}=this;!d||2>h||!q||f.addMany(await this._queryRelatedFeatures({signal:l?.signal}))};
C._queryRelatedFeatures=async function(f){const {orderByFieldsFixedCasing:h,showAllEnabled:d,featuresPerPage:l,displayCount:q,layer:H,relationshipId:N,featurePage:E,featureCount:r,relatedLayer:I,supportsCacheHint:M}=this,{canQuery:S,objectId:U}=this;if(!S||!H||!I)return[];var G=d?((E-1)*l+r)%r:0;const J=d?l:q;var L=I.objectIdField;L=[...h.map(x=>x.field),...p.getFieldsInTitleAndDesc(I),L].filter(w.isSome);const B=h.map(x=>`${x.field} ${x.order}`),A=I.createQuery();G=new k({orderByFields:B,start:G,
num:J,outFields:L,cacheHint:M,relationshipId:N,returnGeometry:!1,objectIds:[U],where:A.where??void 0});f=(await H.queryRelatedFeatures(G,{signal:f?.signal}))[U]?.features||[];f.forEach(x=>{x.sourceLayer=I;x.layer=I});return f};b._createClass(O,[{key:"featurePage",get:function(){return this._get("featurePage")},set:function(f){const {featuresPerPage:h,featureCount:d}=this;this._set("featurePage",Math.min(Math.max(f,1),Math.ceil(d/h)||1))}},{key:"orderByFieldsFixedCasing",get:function(){const {orderByFields:f,
relatedLayer:h}=this;return f&&h?.loaded?f.map(d=>{const l=d.clone();l.field=n.getFixedFieldName(d.field,h);return l}):f??[]}},{key:"supportsCacheHint",get:function(){return!!this.layer?.capabilities?.queryRelated?.supportsCacheHint}},{key:"canLoad",get:function(){return!!this.map&&"number"===typeof this.relationshipId&&"number"===typeof this.objectId}},{key:"canQuery",get:function(){const f=this.layer?.capabilities?.queryRelated;return!!this.relatedLayer&&!!this.relationship&&"number"===typeof this.relationshipId&&
"number"===typeof this.objectId&&!!f?.supportsCount&&!!f?.supportsPagination}},{key:"itemDescriptionFieldName",get:function(){return this.orderByFieldsFixedCasing[0]?.field||null}},{key:"displayCount",get:function(){return this._get("displayCount")},set:function(f){this._set("displayCount",Math.min(Math.max(f,0),10))}},{key:"objectId",get:function(){return(this.objectIdField&&this.graphic?.attributes?.[this.objectIdField])??null}},{key:"objectIdField",get:function(){return this.layer?.objectIdField||
null}},{key:"relatedFeatures",get:function(){return this._get("relatedFeatures")||new K}},{key:"relatedFeatureInfos",get:function(){const {itemDescriptionFieldName:f,relatedFeatures:h,relatedLayer:d}=this;if(!h.length||!d)return[];const l=d&&"formTemplate"in d&&d.formTemplate,q=l&&l?.title||void 0;return h.map(H=>{let N=void 0;if(f){var E=H.getAttribute(f);const r=d.fieldsIndex.get(f);r&&(E=p.getComputedAttributes([E],[r])[f],null!=E&&(N=E.toString()))}E=q?p.parseFormTemplateString(q,H.attributes,
d.fieldsIndex):void 0;return{feature:H,description:N,title:E}}).toArray()}},{key:"relatedLayer",get:function(){const {layer:f,map:h,relationship:d}=this;return f?.loaded&&h&&d?n.findRelatedLayer(h,f,d)??null:null}},{key:"relationship",get:function(){const {relationshipId:f,layer:h}=this;return"number"===typeof f?h?.relationships?.find(({id:d})=>d===f)??null:null}},{key:"relatedFeatureViewModels",get:function(){return this._get("relatedFeatureViewModels")||new K}},{key:"state",get:function(){const {_queryAbortController:f,
_queryFeatureCountAbortController:h,_queryPageAbortController:d,canQuery:l,_loaded:q,canLoad:H}=this;return h||H&&!q?"loading":f||d?"querying":l?"ready":"disabled"}}]);return O}(F.ClonableMixin(z.IdentifiableMixin(P.HandleOwnerMixin(m))));e.__decorate([a.property()],m.prototype,"_loaded",void 0);e.__decorate([a.property()],m.prototype,"_queryAbortController",void 0);e.__decorate([a.property()],m.prototype,"_queryPageAbortController",void 0);e.__decorate([a.property()],m.prototype,"_queryFeatureCountAbortController",
void 0);e.__decorate([a.property({value:1})],m.prototype,"featurePage",null);e.__decorate([a.property()],m.prototype,"featuresPerPage",void 0);e.__decorate([a.property({readOnly:!0})],m.prototype,"orderByFieldsFixedCasing",null);e.__decorate([a.property({readOnly:!0})],m.prototype,"supportsCacheHint",null);e.__decorate([a.property({readOnly:!0})],m.prototype,"canLoad",null);e.__decorate([a.property({readOnly:!0})],m.prototype,"canQuery",null);e.__decorate([a.property()],m.prototype,"description",
void 0);e.__decorate([a.property({readOnly:!0})],m.prototype,"itemDescriptionFieldName",null);e.__decorate([a.property({value:3})],m.prototype,"displayCount",null);e.__decorate([a.property({type:c})],m.prototype,"graphic",void 0);e.__decorate([a.property()],m.prototype,"layer",void 0);e.__decorate([a.property()],m.prototype,"map",void 0);e.__decorate([a.property({readOnly:!0})],m.prototype,"objectId",null);e.__decorate([a.property({readOnly:!0})],m.prototype,"objectIdField",null);e.__decorate([a.property()],
m.prototype,"orderByFields",void 0);e.__decorate([a.property({readOnly:!0})],m.prototype,"relatedFeatures",null);e.__decorate([a.property({readOnly:!0})],m.prototype,"relatedFeatureInfos",null);e.__decorate([a.property({readOnly:!0})],m.prototype,"relatedLayer",null);e.__decorate([a.property({readOnly:!0})],m.prototype,"relationship",null);e.__decorate([a.property()],m.prototype,"featureCount",void 0);e.__decorate([a.property({readOnly:!0})],m.prototype,"relatedFeatureViewModels",null);e.__decorate([a.property()],
m.prototype,"relationshipId",void 0);e.__decorate([a.property()],m.prototype,"showAllEnabled",void 0);e.__decorate([a.property()],m.prototype,"state",null);e.__decorate([a.property()],m.prototype,"title",void 0);e.__decorate([a.property()],m.prototype,"getRelatedFeatureByObjectId",null);return m=e.__decorate([v.subclass("esri.widgets.Feature.FeatureRelationship.FeatureRelationshipViewModel")],m)})},"esri/widgets/support/Heading":function(){define(["exports","../../core/mathUtils","./widgetUtils",
"./jsxFactory"],function(b,e,c,m){const w={heading:"esri-widget__heading"};b.CSS=w;b.Heading=function({level:F,class:K,...P},z){F=e.clamp(Math.ceil(F),1,6);return m.tsx(`h${F}`,{...P,class:c.classes(w.heading,K),role:"heading","aria-level":String(F)},z)};b.incrementHeadingLevel=function(F,K=1){return e.clamp(Math.ceil(F+K),1,6)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/FeatureTemplates":function(){define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/HandleOwner ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./FeatureForm/featureFormUtils ./FeatureTemplates/FeatureTemplatesViewModel ./FeatureTemplates/ItemList ./FeatureTemplates/TemplateItem ./support/componentsUtils ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a,g,u,v,k,n,p,y,O){function C(h){return h.id}const f={filter:!0};m=function(h){function d(q,H){var N=h.call(this,q,H)||this;N.enableListScroll=!0;N.filterText="";N.headingLevel=4;N.messages=null;N.viewModel=new g;N.visibleElements={...f};N.renderCustomItem=E=>null;N.renderCustomGroupContent=E=>null;N.renderItemLabel=()=>null;N.renderItemDescription=()=>null;N.renderItemContent=E=>null;N.renderItemContentEnd=E=>null;N._iconIntersectionObserver=new IntersectionObserver((E,
r)=>{E.forEach(async I=>{if(I.isIntersecting){const U=I.target;if(U?.["data-has-icon"])r.unobserve(U);else{var {layer:M,template:S}=U?.["data-item"];U&&(U["data-has-icon"]=!0);I=await v.fetchThumbnail(M,S).catch(()=>{U&&(U["data-has-icon"]=!1);return null});null!=I&&U.appendChild(I)}}})});N.renderItemIcon=E=>O.tsx("span",{key:"icon",afterCreate:N._afterItemCreateOrUpdate,afterUpdate:N._afterItemCreateOrUpdate,afterRemoved:N._afterItemRemoved,"data-item":E,"data-has-icon":!1});N._afterItemCreateOrUpdate=
E=>{N._iconIntersectionObserver?.observe(E)};N._afterItemRemoved=E=>{N._iconIntersectionObserver?.unobserve(E)};return N}e._inherits(d,h);var l=d.prototype;l.initialize=function(){const q=({label:H})=>!this.filterText||!!H?.toLowerCase().includes(this.filterText.toLowerCase());this.addHandles(w.watch(()=>this.viewModel,(H,N)=>{H&&!H.filterFunction&&(this.filterFunction=q);N&&N!==H&&N.filterFunction===q&&(N.filterFunction=null)},w.initial))};l.destroy=function(){this._iconIntersectionObserver?.disconnect();
this._iconIntersectionObserver=null};l.loadDependencies=function(){return k.loadCalciteComponents({input:()=>new Promise((q,H)=>b(["../chunks/calcite-input"],q,H)),"list-item":()=>new Promise((q,H)=>b(["../chunks/calcite-list-item"],q,H)),notice:()=>new Promise((q,H)=>b(["../chunks/calcite-notice"],q,H))})};l.castVisibleElements=function(q){return{...f,...q}};l.select=function(q,H){return this.viewModel.select(q,H)};l.render=function(){const {enableListScroll:q,filterText:H,headingLevel:N,messages:E,
viewModel:{items:r,numberOfFeatureTemplates:I,selectedItem:M,state:S}}=this,U=this.visibleElements.filter&&1<I;if(0<r.length&&a.isTemplateItemGroup(r[0])){const G=r.find(J=>J.label===g.nullGroupBy.label);G&&(G.label=E.other)}return O.tsx("div",{class:this.classes("esri-feature-templates","esri-widget"),"aria-label":E.widgetLabel},"loading"===S?this.renderLoader():"ready"===S?O.tsx(u.ItemList,{enableListScroll:q,filterEnabled:U,filterText:H,headingLevel:N,id:this.id,identify:C,items:r,messages:{filterPlaceholder:E.filterPlaceholder,
noItems:E.noItems,noMatches:E.noMatches},renderIcon:this.renderItemIcon,renderCustomItem:this.renderCustomItem,renderCustomGroupContent:this.renderCustomGroupContent,renderItemContent:this.renderItemContent,renderItemContentEnd:this.renderItemContentEnd,renderItemDescription:this.renderItemDescription,renderItemLabel:this.renderItemLabel,selectedItem:M??void 0,selectionMode:"single",onItemSelect:G=>!a.isTemplateItemGroup(G)&&this.viewModel.select(G),onFilterChange:G=>{this.filterText=G;this.viewModel.refresh()}}):
null)};l.renderLoader=function(){return O.tsx("div",{class:"esri-feature-templates__loader",key:"loader"})};e._createClass(d,[{key:"filterFunction",get:function(){return this.viewModel.filterFunction},set:function(q){this.viewModel.filterFunction=q}},{key:"groupBy",get:function(){return this.viewModel.groupBy},set:function(q){this.viewModel.groupBy=q}},{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(q){this._overrideIfSome("label",q)}},{key:"layers",get:function(){return this.viewModel.layers},
set:function(q){this.viewModel.layers=q}},{key:"selectedItem",get:function(){return this.viewModel.selectedItem}}]);return d}(m.HandleOwnerMixin(D));c.__decorate([F.property()],m.prototype,"enableListScroll",void 0);c.__decorate([F.property()],m.prototype,"filterFunction",null);c.__decorate([F.property()],m.prototype,"filterText",void 0);c.__decorate([F.property()],m.prototype,"groupBy",null);c.__decorate([F.property()],m.prototype,"headingLevel",void 0);c.__decorate([F.property()],m.prototype,"label",
null);c.__decorate([F.property()],m.prototype,"layers",null);c.__decorate([F.property(),p.messageBundle("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],m.prototype,"messages",void 0);c.__decorate([F.property({readOnly:!0})],m.prototype,"selectedItem",null);c.__decorate([F.property(),y.vmEvent("select")],m.prototype,"viewModel",void 0);c.__decorate([F.property()],m.prototype,"visibleElements",void 0);c.__decorate([K.cast("visibleElements")],m.prototype,"castVisibleElements",null);c.__decorate([F.property()],
m.prototype,"renderCustomItem",void 0);c.__decorate([F.property()],m.prototype,"renderCustomGroupContent",void 0);c.__decorate([F.property()],m.prototype,"renderItemLabel",void 0);c.__decorate([F.property()],m.prototype,"renderItemDescription",void 0);c.__decorate([F.property()],m.prototype,"renderItemContent",void 0);c.__decorate([F.property()],m.prototype,"renderItemContentEnd",void 0);return m=c.__decorate([t.subclass("esri.widgets.FeatureTemplates")],m)})},"esri/widgets/FeatureTemplates/FeatureTemplatesViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Evented ../../core/HandleOwner ../../core/ObjectPool ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../layers/support/layerUtils ./TemplateItem ./TemplateItemGroup".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a,g,u){var v;const k=({layer:y})=>({key:y,label:y.title??""}),n=({layer:y})=>({key:y.geometryType,label:y.geometryType??""});c=v=function(y){function O(f){f=y.call(this,f)||this;f._itemPool=new w(g);f._groupPool=new w(u);f.filterFunction=null;f.selectedItem=null;return f}b._inherits(O,y);var C=O.prototype;C.initialize=function(){this._get("groupBy")||(this.groupBy="layer")};C.refresh=function(){this.notifyChange("items")};C.select=function(f,{emit:h=!0}={}){const d=
this.selectedItem;f=f?.clone()||null;this._set("selectedItem",f);h&&this.emit("select",{item:f,oldItem:d,template:f?.template??null})};C._createItem=function(f,h){const d=this._itemPool.acquire();d.set({template:f,layer:h});return d};C._createGroup=function(f,h){const d=this._groupPool.acquire();d.set("label",f);d.items=h;return d};C._releasePreviousItems=function(){this._destroyItems(this._get("items"))};C._destroyItems=function(f){f&&(f[0]instanceof g?f.forEach(h=>this._destroyItem(h)):f.forEach(h=>
this._destroyGroup(h)))};C._destroyGroup=function(f){f.items.forEach(h=>this._destroyItem(h));f.items.length=0;this._groupPool.release(f)};C._destroyItem=function(f){f.layer=null;f.template=null;this._itemPool.release(f)};C._ensureGroupByObject=function(f){return"string"===typeof f?{key:f,label:f}:f};b._createClass(O,[{key:"groupBy",set:function(f){this._set("groupBy",f);if("function"===typeof f)this._groupByFunction=h=>this._ensureGroupByObject(f(h));else switch(f){case "layer":this._groupByFunction=
k;break;case "geometry":this._groupByFunction=n;break;default:this._groupByFunction=null}}},{key:"layers",get:function(){return this._get("layers")},set:function(f){this.handles.remove("layers");if(f){const h=()=>this.notifyChange("state");this.handles.add(f.map(d=>F.when(()=>d.loadStatus,h)),"layers")}this._set("layers",f)}},{key:"state",get:function(){const {layers:f}=this;return f&&0!==f.length?f.some(h=>"loading"===h.loadStatus||"not-loaded"===h.loadStatus)?"loading":"ready":"disabled"}},{key:"_featureTemplatesByLayer",
get:function(){if(!this.layers)return new Map;const f=[];for(const h of this.layers)if("subtype-group"===h.type)for(const d of h.sublayers){const l=p(d);f.push([d,l])}else a.isTable(h)||f.push([h,p(h)]);return new Map(f)}},{key:"numberOfFeatureTemplates",get:function(){return Array.from(this._featureTemplatesByLayer.values()).reduce((f,h)=>f+h.length,0)}},{key:"items",get:function(){if(0===this.numberOfFeatureTemplates)return this._releasePreviousItems(),[];var f=this._featureTemplatesByLayer,h=[],
d=null!=this.filterFunction?this.filterFunction:v._nullFilterFunction;for(const [H,N]of f)if(H.loaded||"subtype-sublayer"===H.type&&H.parent?.loaded)if(f=a.getEffectiveLayerCapabilities(H)?.operations,f?.supportsEditing&&f?.supportsAdd)for(var l of N)h.push({layer:H,template:l,matchesFilter:d({label:l.name})});if(null==this._groupByFunction)return d=h.filter(({matchesFilter:H})=>H).map(({template:H,layer:N})=>this._createItem(H,N)),this._releasePreviousItems(),d;l=new Map;for(var q of h){const {template:H,
layer:N}=q;h=this._groupByFunction({template:H,layer:N});const {key:E,label:r}=null!=h.key?h:v.nullGroupBy;l.has(E)||l.set(E,{label:r,templateItemInfos:[]});l.get(E)?.templateItemInfos.push(q)}q=[];for(const H of l.values()){const {label:N,templateItemInfos:E}=H;h=E.filter(({matchesFilter:r})=>r);h=d({label:N})?E:0<E.length?h:[];0<h.length&&(h=h.map(({template:r,layer:I})=>this._createItem(r,I)),q.push(this._createGroup(N,h)))}if(1===q.length&&q[0].label===v.nullGroupBy.label)return this._releasePreviousItems(),
q[0].items;this._releasePreviousItems();return q}}]);return O}(m.HandleOwnerMixin(c.EventedAccessor));c.nullGroupBy={key:Symbol(),label:"Other\u200b"};c._nullFilterFunction=y=>!0;e.__decorate([K.property()],c.prototype,"_groupByFunction",void 0);e.__decorate([K.property()],c.prototype,"filterFunction",void 0);e.__decorate([K.property()],c.prototype,"groupBy",null);e.__decorate([K.property()],c.prototype,"layers",null);e.__decorate([K.property()],c.prototype,"state",null);e.__decorate([K.property({readOnly:!0})],
c.prototype,"_featureTemplatesByLayer",null);e.__decorate([K.property({readOnly:!0})],c.prototype,"numberOfFeatureTemplates",null);e.__decorate([K.property({readOnly:!0})],c.prototype,"items",null);e.__decorate([K.property({readOnly:!0})],c.prototype,"selectedItem",void 0);c=v=e.__decorate([D.subclass("esri.widgets.FeatureTemplates.FeatureTemplatesViewModel")],c);const p=y=>{const O="templates"in y&&Array.isArray(y.templates)?y.templates:[];y="types"in y&&Array.isArray(y.types)?y.types.flatMap(C=>
C.templates):[];return[...O,...y]};return c})},"esri/widgets/FeatureTemplates/TemplateItem":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Graphic ../../core/Accessor ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../symbols/support/symbolUtils".split(" "),function(b,e,c,m,w,F,K,P,z,t,D,a){async function g(n,
p){var {renderer:y}=n;return y&&(p=new m({attributes:p.prototype.attributes}),y=await y.getSymbolAsync(p))?y:u(n)}async function u(n){({geometryType:n}=n);return(n="point"===n||"multipoint"===n?await new Promise((p,y)=>b(["../../symbols/SimpleMarkerSymbol"],O=>p(v(O)),y)):"polyline"===n?await new Promise((p,y)=>b(["../../symbols/SimpleLineSymbol"],O=>p(v(O)),y)):"polygon"===n||"mesh"===n||"multipatch"===n?await new Promise((p,y)=>b(["../../symbols/SimpleFillSymbol"],O=>p(v(O)),y)):null)?new n.default:
null}const v=n=>Object.freeze(Object.defineProperty({__proto__:null,default:n},Symbol.toStringTag,{value:"Module"}));var k;w=k=function(n){function p(O){O=n.call(this,O)||this;O._activeFetchInfo={id:null,request:null};O.layer=null;O.template=null;O.thumbnail=null;return O}e._inherits(p,n);var y=p.prototype;y.initialize=function(){this.addHandles(F.watch(()=>{const {layer:O}=this;return[O&&"renderer"in O?O.renderer:null,this.template]},()=>{this._activeFetchInfo.id=null;this._activeFetchInfo.request=
null;this._set("thumbnail",null)},F.initial))};y.clone=function(){const O=null!=this.thumbnail?this.thumbnail.cloneNode(!0):null,C=new k({layer:this.layer,template:this.template});C._set("thumbnail",O);return C};p.fetchThumbnail=async function(O,C){const f=await g(O,C);if(null==f)return null;const h={maxSize:36};"dictionary"===O.renderer?.type&&(h.fieldMap=O.renderer.fieldMap??void 0,h.feature={attributes:C.prototype.attributes??{}});return await a.renderPreviewHTML(f,h)};e._createClass(p,[{key:"description",
get:function(){return this.template?.description},set:function(O){this.template&&(this.template.description=O)}},{key:"label",get:function(){return this.template?.name},set:function(O){this.template&&(this.template.name=O)}},{key:"id",get:function(){return`${this.label??""}\u2013${this.layer?.id}`}},{key:"supportsUpload",get:function(){return"scene"===this.layer.type}}]);return p}(w);c.__decorate([K.property()],w.prototype,"description",null);c.__decorate([K.property()],w.prototype,"label",null);
c.__decorate([K.property()],w.prototype,"layer",void 0);c.__decorate([K.property()],w.prototype,"template",void 0);c.__decorate([K.property({readOnly:!0})],w.prototype,"thumbnail",void 0);c.__decorate([K.property()],w.prototype,"id",null);c.__decorate([K.property()],w.prototype,"supportsUpload",null);return w=k=c.__decorate([D.subclass("esri.widgets.FeatureTemplates.TemplateItem")],w)})},"esri/symbols/support/symbolUtils":function(){define("require exports ../../core/has ../../support/arcadeOnDemand ./gfxUtils ./previewUtils ./renderUtils ./utils ../../widgets/Legend/styles/support/relationshipUtils ../../widgets/Legend/support/relationshipRampUtils".split(" "),
function(b,e,c,m,w,F,K,P,z,t){function D(k,n){if(n&&(k.style.filter=P.getCSSFilterFromEffectList(n),n=n.effects))for(const p of n)if("drop-shadow"===p?.type){0>p.offsetX?k.style.marginLeft=`${Math.abs(p.offsetX)}px`:k.style.marginRight=`${p.offsetX}px`;break}}async function a(k,n){switch(k.type){case "web-style":var {previewWebStyleSymbol:p}=await new Promise((y,O)=>b(["./previewWebStyleSymbol"],y,O));return p(k,a,n);case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return{previewSymbol3D:p}=
await new Promise((y,O)=>b(["./previewSymbol3D"],y,O)),p(k,n);case "simple-marker":case "simple-line":case "simple-fill":case "picture-marker":case "picture-fill":case "text":return{previewSymbol2D:p}=await new Promise((y,O)=>b(["./previewSymbol2D"],y,O)),p(k,n);case "cim":return{previewCIMSymbol:p}=await new Promise((y,O)=>b(["./previewCIMSymbol"],y,O)),p(k,n)}}function g(k){return k&&"opacity"in k?k.opacity*g(k.parent):1}let u=null;const v=[255,255,255];e.getDisplayedColor=async function(k,n){if(k){var p=
g(k.layer||k.sourceLayer);if(null!=k.symbol&&(null==n||!0!==n.ignoreGraphicSymbol))return k="web-style"===k.symbol.type?await P.fetchWebStyleSymbol(k.symbol,n):k.symbol.clone(),P.getColorFromSymbol(k,p);var y=null!=n&&n.renderer||k.get("layer.renderer")||k.get("sourceLayer.renderer"),O=await y.getSymbolAsync(k,n);if(O){O="web-style"===O.type?await P.fetchWebStyleSymbol(O,n):O.clone();O=P.getColorFromSymbol(O,p);if(!("visualVariables"in y)||"visualVariables"in y&&!y.visualVariables||"visualVariables"in
y&&!y.visualVariables?.length)return O;!y.arcadeRequiredForVisualVariables||null!=n&&null!=n.arcade||(n={...n},n.arcade=await m.loadArcade());var {getColor:C,getOpacity:f}=await new Promise((l,q)=>b(["../../renderers/visualVariables/support/visualVariableUtils"],l,q)),h=[],d=[];for(const l of y.visualVariables)switch(l.type){case "color":h.push(l);break;case "opacity":d.push(l)}y=(y=0<h.length?h[h.length-1]:null)?C(y,k,n):O;k=(O=0<d.length?d[d.length-1]:null)?f(O,k,n):null;null!=p&&(k=null!=k?k*p:
p);return y?P.applyOpacityToColor(y,k):null}}};e.getDisplayedSymbol=async function(k,n){if(k){var p=k.sourceLayer,y=(null!=n&&(n.useSourceLayer??!1)?p:k.layer)??p;p=g(y);if(null!=k.symbol&&(null==n||!0!==n.ignoreGraphicSymbol))return k="web-style"===k.symbol.type?await P.fetchWebStyleSymbol(k.symbol,{...n,cache:null!=n?n.webStyleCache:null}):k.symbol.clone(),P.applyColorToSymbol(k,null,p),k;var O=(null!=n?n.renderer:null)??(y&&"renderer"in y?y.renderer:null);if(y=O&&"getSymbolAsync"in O?await O.getSymbolAsync(k,
n):null){y="web-style"===y.type?await y.fetchSymbol({...n,cache:null!=n?n.webStyleCache:null}):y.clone();if(!(O&&"visualVariables"in O&&O.visualVariables&&O.visualVariables.length))return P.applyColorToSymbol(y,null,p),y;"arcadeRequiredForVisualVariables"in O&&O.arcadeRequiredForVisualVariables&&(null==n||null==n.arcade)&&(n={...n},n.arcade=await m.loadArcade());var {getColor:C,getOpacity:f,getAllSizes:h,getRotationAngle:d}=await new Promise((r,I)=>b(["../../renderers/visualVariables/support/visualVariableUtils"],
r,I)),l=[],q=[],H=[],N=[];for(var E of O.visualVariables)switch(E.type){case "color":l.push(E);break;case "opacity":q.push(E);break;case "rotation":N.push(E);break;case "size":E.target||H.push(E)}E=(E=!!l.length&&l[l.length-1])?C(E,k,n):null;q=(q=!!q.length&&q[q.length-1])?f(q,k,n):null;null!=p&&(q=null!=q?q*p:p);P.applyColorToSymbol(y,E,q);H.length&&(p=h(H,k,n),await P.applySizesToSymbol(y,p));for(const r of N)P.applyRotationToSymbol(y,d(r,k,n),r.axis);return y}}};e.renderColorRampPreviewHTML=function(k,
n={}){var p="horizontal"===n.align;const y=n.width??(p?75:24),O=n.height??(p?24:75);var C=n.gradient??!0,f=window.devicePixelRatio,h=y*f,d=O*f;f=document.createElement("canvas");f.width=h;f.height=d;f.ariaLabel=n.ariaLabel??null;f.style.width=`${y}px`;f.style.height=`${O}px`;const l=f.getContext("2d");var q=p?h:0;const H=p?0:d;if(C){const N=l.createLinearGradient(0,0,q,H);p=k.length;const E=1===p?0:1/(p-1);k.forEach((r,I)=>N.addColorStop(I*E,r.toString()));l.fillStyle=N;l.fillRect(0,0,h,d)}else{h=
p?h/k.length:h;d=p?d:d/k.length;q=C=0;for(const N of k)l.fillStyle=N.toString(),l.fillRect(C,q,h,d),C=p?C+h:0,q=p?0:q+d}k=document.createElement("div");k.style.width=`${y}px`;k.style.height=`${O}px`;D(k,n?.effectList);k.appendChild(f);return k};e.renderDotDensityPreviewHTML=function(k,n,p){const {backgroundColor:y,outline:O,dotSize:C}=k;var f=p&&p.swatchSize||F.SymbolSizeDefaults.size;const h=Math.round(f*f/C**2*.8),d=window.devicePixelRatio;k=document.createElement("canvas");const l=f*d;k.width=
l;k.height=l;k.style.width=`${k.width/d}px`;k.style.height=`${k.height/d}px`;const q=k.getContext("2d");y&&(q.fillStyle=y.toCss(!0),q.fillRect(0,0,l,l),q.fill());q.fillStyle=n?.toCss(!0)??"";if(u&&u.length/2===h)for(n=0;n<2*h;n+=2)q.fillRect(u[n],u[n+1],C*d,C*d),q.fill();else for(u=[],n=0;n<2*h;n+=2){const H=Math.floor(Math.random()*(l-0+1)),N=Math.floor(Math.random()*(l-0+1));u.push(H,N);q.fillRect(H,N,C*d,C*d);q.fill()}O&&(O.color&&(q.strokeStyle=O.color.toCss(!0)),q.lineWidth=O.width,q.strokeRect(0,
0,l,l));f=new Image(f,f);f.src=k.toDataURL();f.ariaLabel=p?.ariaLabel??null;f.alt=p?.ariaLabel??"";return f};e.renderPieChartPreviewHTML=function(k,n={}){const p=n.radius||40;var y=2*Math.PI*p,O=k.length;const C=y/O,f=[],h=w.getStroke(n.outline);null!=h?.width&&(h.width*=2);(h||n.backgroundColor)&&f.push({shape:{type:"circle",cx:p,cy:p,r:p},fill:n.backgroundColor,stroke:h,offset:[0,0]});const d=n.values,l=d&&d.length===O&&100===d.reduce((H,N)=>H+N,0),q=[0];for(let H=0;H<O;H++){let N=null;l&&(N=d[H]*
y/100,q.push(N+q[H]));f.push({shape:{type:"circle",cx:p,cy:p,r:p/2},fill:[0,0,0,0],stroke:{width:p,dashArray:`${(N??C)/2} ${y}`,dashoffset:`-${l?q[H]/2:C/2*H}`,color:k[H]},offset:[0,0]})}O=null;k=2*p+(h?.width||0);if(y=n.holePercentage)h&&f.push({shape:{type:"circle",cx:p,cy:p,r:p*y},fill:null,stroke:h,offset:[0,0]}),O=k/2,O=[[{shape:{type:"circle",cx:O,cy:O,r:O},fill:v,stroke:h?{...h,color:v}:null,offset:[0,0]},{shape:{type:"circle",cx:O,cy:O,r:p*y},fill:[0,0,0],stroke:null,offset:[0,0]}]];return K.renderSymbol([f],
[k,k],{effectView:n.effectList,ignoreStrokeWidth:!0,masking:O,rotation:-90,ariaLabel:n.ariaLabel})};e.renderPreviewHTML=a;e.renderRelationshipRampPreviewHTML=function(k,n={}){const p=k?.authoringInfo;if("relationship"!==p?.type||!p?.numClasses||!k.uniqueValueInfos)return null;const {focus:y,numClasses:O}=p,C=t.getRelationshipRampElement({focus:y,numClasses:O,infos:k.uniqueValueInfos});k=n&&n.node||document.createElement("div");K.renderOnce(k,()=>z.renderRelationshipRamp(C,n.id||"relationship",{opacity:n.opacity||
1,effectList:n.effectList,ariaLabel:n.ariaLabel}));return k};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/gfxUtils":function(){define("exports ../../assets ../../Color ../../request ../../core/LRUCache ../../core/screenUtils ./cimSymbolUtils".split(" "),function(b,e,c,m,w,F,K){function P(D){if(!D)return null;let a=null;switch(D.type){case "simple-fill":case "picture-fill":case "simple-marker":a=P(D.outline);break;case "simple-line":const g=F.pt2px(D.width);
null!=D.style&&"none"!==D.style&&0!==g&&(a={color:D.color,style:t(D.style),width:g,cap:D.cap,join:"miter"===D.join?F.pt2px(D.miterLimit):D.join});break;default:a=null}return a}const z=new w.LRUCache(1E3),t=(()=>{const D={};return a=>{if(D[a])return D[a];const g=a.replaceAll("-","");return D[a]=g}})();c=new c([128,128,128]);b.defaultThematicColor=c;b.dekebabifyLineStyle=t;b.getFill=function(D){const a=D.style;let g=null;if(D)switch(D.type){case "simple-marker":"cross"!==a&&"x"!==a&&(g=D.color);break;
case "simple-fill":"solid"===a?g=D.color:"none"!==a&&(g={type:"pattern",x:0,y:0,src:e.getAssetUrl(`esri/symbols/patterns/${a}.png`),width:5,height:5});break;case "picture-fill":g={type:"pattern",src:D.url,width:F.pt2px(D.width)*D.xscale,height:F.pt2px(D.height)*D.yscale,x:F.pt2px(D.xoffset),y:F.pt2px(D.yoffset)};break;case "text":g=D.color;break;case "cim":g=K.getCIMSymbolColor(D)}return g};b.getPatternUrlWithColor=function(D,a){const g=D+"-"+a;return void 0!==z.get(g)?Promise.resolve(z.get(g)):m(D,
{responseType:"image"}).then(u=>{u=u.data;const v=u.naturalWidth,k=u.naturalHeight,n=document.createElement("canvas");n.width=v;n.height=k;const p=n.getContext("2d");p.fillStyle=a;p.fillRect(0,0,v,k);p.globalCompositeOperation="destination-in";p.drawImage(u,0,0);u=n.toDataURL();z.put(g,u);return u})};b.getStroke=P;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/cimSymbolUtils":function(){define(["exports","../../Color","../cim/utils"],function(b,e,c){function m(a){a=
c.toCIMSymbolJSON(a);if("CIMTextSymbol"===a?.type)return a.height??0;let g=0;if(a?.symbolLayers)for(const u of a.symbolLayers)c.isCIMMarker(u)&&null!=u.size&&u.size>g?g=u.size:c.isCIMStroke(u)&&null!=u.width&&u.width>g?g=u.width:c.isCIMFill(u);return g}function w(a,g,u,v){if(a)if("CIMTextSymbol"===a.type)null!=a.height&&(a.height*=g);else{if(u&&a.effects)for(const k of a.effects)P(k,g);if(a.symbolLayers)for(const k of a.symbolLayers)switch(k.type){case "CIMPictureMarker":case "CIMVectorMarker":F(k,
g,v);break;case "CIMPictureStroke":case "CIMSolidStroke":!v?.preserveOutlineWidth&&k.width&&(k.width*=g);break;case "CIMPictureFill":k.height&&(k.height*=g);k.offsetX&&(k.offsetX*=g);k.offsetY&&(k.offsetY*=g);break;case "CIMHatchFill":w(k.lineSymbol,g,!0,{...v,preserveOutlineWidth:!1}),k.offsetX&&(k.offsetX*=g),k.offsetY&&(k.offsetY*=g),k.separation&&(k.separation*=g)}}}function F(a,g,u){if(a&&(a.markerPlacement&&K(a.markerPlacement,g),a.offsetX&&(a.offsetX*=g),a.offsetY&&(a.offsetY*=g),a.anchorPoint&&
"Absolute"===a.anchorPointUnits&&(a.anchorPoint={x:a.anchorPoint.x*g,y:a.anchorPoint.y*g}),a.size=null!=a.size?a.size*g:0,"CIMVectorMarker"===a.type&&a.markerGraphics))for(const v of a.markerGraphics)a.scaleSymbolsProportionally||w(v.symbol,g,!0,u)}function K(a,g){c.isCIMMarkerStrokePlacement(a)&&a.offset&&(a.offset*=g);switch(a.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":a.customEndingOffset&&(a.customEndingOffset*=g);a.offsetAlongLine&&(a.offsetAlongLine*=
g);if(a.placementTemplate&&a.placementTemplate.length){var u=a.placementTemplate.map(v=>v*g);a.placementTemplate=u}break;case "CIMMarkerPlacementAlongLineVariableSize":a.maxRandomOffset&&(a.maxRandomOffset*=g);a.placementTemplate&&a.placementTemplate.length&&(u=a.placementTemplate.map(v=>v*g),a.placementTemplate=u);break;case "CIMMarkerPlacementOnLine":a.startPointOffset&&(a.startPointOffset*=g);break;case "CIMMarkerPlacementAtExtremities":a.offsetAlongLine&&(a.offsetAlongLine*=g);break;case "CIMMarkerPlacementAtRatioPositions":a.beginPosition&&
(a.beginPosition*=g);a.endPosition&&(a.endPosition*=g);break;case "CIMMarkerPlacementPolygonCenter":a.offsetX&&(a.offsetX*=g);a.offsetY&&(a.offsetY*=g);break;case "CIMMarkerPlacementInsidePolygon":a.offsetX&&(a.offsetX*=g),a.offsetY&&(a.offsetY*=g),a.stepX&&(a.stepX*=g),a.stepY&&(a.stepY*=g)}}function P(a,g){switch(a.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":a.width&&(a.width*=g);break;case "CIMGeometricEffectBuffer":a.size&&(a.size*=g);break;case "CIMGeometricEffectCut":a.beginCut&&
(a.beginCut*=g);a.endCut&&(a.endCut*=g);a.middleCut&&(a.middleCut*=g);break;case "CIMGeometricEffectDashes":a.customEndingOffset&&(a.customEndingOffset*=g);a.offsetAlongLine&&(a.offsetAlongLine*=g);if(a.dashTemplate&&a.dashTemplate.length){const u=a.dashTemplate.map(v=>v*g);a.dashTemplate=u}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":a.length&&(a.length*=g);break;case "CIMGeometricEffectMove":a.offsetX&&(a.offsetX*=g);a.offsetY&&(a.offsetY*=
g);break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":a.offset&&(a.offset*=g);break;case "CIMGeometricEffectRegularPolygon":a.radius&&(a.radius*=g);break;case "CIMGeometricEffectTaperedPolygon":a.fromWidth&&(a.fromWidth*=g);a.length&&(a.length*=g);a.toWidth&&(a.toWidth*=g);break;case "CIMGeometricEffectWave":a.amplitude&&(a.amplitude*=g),a.period&&(a.period*=g)}}function z(a,g){if(a){var u="CIMTextSymbol"===a.type?a.symbol:a;a="CIMPolygonSymbol"===a.type;if(u?.symbolLayers)for(const v of u.symbolLayers)if(!(v.colorLocked||
a&&(c.isCIMStroke(v)||c.isCIMMarker(v)&&v.markerPlacement&&c.isCIMMarkerStrokePlacement(v.markerPlacement))))switch(v.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":v.tintColor&&t(g,v.tintColor);break;case "CIMVectorMarker":v.markerGraphics?.forEach(k=>{z(k.symbol,g)});break;case "CIMSolidStroke":case "CIMSolidFill":t(g,v.color);break;case "CIMHatchFill":z(v.lineSymbol,g)}}}function t(a,g){for(const u of a)if(u.join(".")===g.join("."))return;a.push(g)}function D(a,g,u){if(a){var v=
"CIMTextSymbol"===a.type?a.symbol:a;a="CIMPolygonSymbol"===v?.type;if(v?.symbolLayers)for(const k of v.symbolLayers)if(!k.colorLocked){if(a)if(u){if({layersToColor:v}=u,(c.isCIMStroke(k)||c.isCIMMarker(k)&&k.markerPlacement&&c.isCIMMarkerStrokePlacement(k.markerPlacement))&&"fill"===v||c.isCIMFill(k)&&"outline"===v)continue}else if(c.isCIMStroke(k)||c.isCIMMarker(k)&&k.markerPlacement&&c.isCIMMarkerStrokePlacement(k.markerPlacement))continue;v=g.toArray();switch(k.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":k.tintColor=
v;break;case "CIMVectorMarker":k.markerGraphics?.forEach(n=>{D(n.symbol,g,u)});break;case "CIMSolidStroke":case "CIMSolidFill":k.color=v;break;case "CIMHatchFill":D(k.lineSymbol,g,u)}}}}b.applyCIMSymbolColor=function(a,g,u){g instanceof e||(g=new e(g));(a=c.toCIMSymbolJSON(a))&&D(a,g,u)};b.applyCIMSymbolRotation=function(a,g,u=!1){a=c.toCIMSymbolJSON(a);u&&0!==g&&(g=360-g);if("CIMTextSymbol"===a?.type)a.angle=g;else if("CIMPointSymbol"===a?.type&&a.symbolLayers){u=g-(a.angle||0);for(const v of a.symbolLayers)if(c.isCIMMarker(v)){let k=
v.rotation||0;k=v.rotateClockwise?k-u:k+u;v.rotation=k}a.angle=g}};b.getCIMSymbolColor=function(a){a=c.toCIMSymbolJSON(a);const g=[];z(a,g);return g.length?new e(c.fromCIMColor(g[0])):null};b.getCIMSymbolRotation=function(a,g=!1){a=c.toCIMSymbolJSON(a);return"CIMTextSymbol"===a?.type||"CIMPointSymbol"===a?.type?(a=a.angle,null!=a&&0!==a&&g?360-a:a??0):0};b.getCIMSymbolSize=m;b.getCIMSymbolType=function(a){a=c.toCIMSymbolJSON(a);if(!a)return null;switch(a.type){case "CIMPointSymbol":return"CIMPointSymbol";
case "CIMLineSymbol":return"CIMLineSymbol";case "CIMPolygonSymbol":return"CIMPolygonSymbol";case "CIMTextSymbol":return"CIMTextSymbol";case "CIMMeshSymbol":return"CIMMeshSymbol";default:return null}};b.scaleCIMMarker=F;b.scaleCIMSymbol=w;b.scaleCIMSymbolTo=function(a,g,u){if(a){var v=c.toCIMSymbolJSON(a);a=m(a);if(0===a){if(v)if("CIMTextSymbol"===v.type)v.height=g;else if(v.symbolLayers)for(const k of v.symbolLayers)switch(k.type){case "CIMPictureMarker":case "CIMVectorMarker":k.size=g;break;case "CIMPictureStroke":case "CIMSolidStroke":k.width=
g}}else w(v,g/a,!1,u)}};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/utils":function(){define(["require","exports"],function(b,e){function c(a){return"function"===typeof a}function m(a){let g=a.length;for(;g--;)if(!" /-,\n".includes(a.charAt(g)))return!1;return!0}function w(a,g){const u=[];var v=0;let k=-1;do k=a.indexOf("[",v),k>=v&&(k>v&&(v=a.substr(v,k-v),u.push([v,null,m(v)])),v=k+1,k=a.indexOf("]",v),k>=v&&(k>v&&(v=a.substr(v,k-v),(v=g[v])&&u.push([null,v,
!1])),v=k+1));while(-1!==k);v<a.length-1&&(a=a.substr(v),u.push([a,null,m(a)]));return u}function F(a,g,u){let v="",k=null;for(const n of g){const [p,y,O]=n;if(p)O?k=p:(k&&(v+=k,k=null),v+=p);else if(g=a.attributes[y])k&&(v+=k,k=null),v+=g}return K(v,u)}function K(a,g){"string"!==typeof a&&(a=String(a));switch(g){case "LowerCase":return a.toLowerCase();case "Allcaps":return a.toUpperCase();default:return a}}function P(a){return a?{r:a[0],g:a[1],b:a[2],a:a[3]/255}:{r:0,g:0,b:0,a:0}}function z(a){if(!a)return null;
switch(a.type){case "CIMPolygonSymbol":if(a.symbolLayers)for(const g of a.symbolLayers)if(a=z(g),null!=a)return a;break;case "CIMTextSymbol":return z(a.symbol);case "CIMSolidFill":return a.color}}function t(a){if(a)switch(a.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(a=a.symbolLayers)for(const g of a)if(a=t(g),null!=a)return a;break;case "CIMTextSymbol":return t(a.symbol);case "CIMSolidStroke":return a.color}}function D(a){if(a)switch(a.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(a.symbolLayers)for(const g of a.symbolLayers)if(a=
D(g),void 0!==a)return a;break;case "CIMTextSymbol":return D(a.symbol);case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return a.width}}e.adjustTextCase=K;e.analyzeTextParts=w;e.assignTextValuesFromFeature=F;e.attributesToFields=function(a){return(a?Object.keys(a):[]).map(g=>({name:g,alias:g,type:"string"===typeof a[g]?"esriFieldTypeString":"esriFieldTypeDouble"}))};e.colorToArray=function(a){return[a.r,a.g,a.b,a.a]};e.createLabelOverrideFunction=function(a,g,u){const v=w(g,
a);return k=>F(k,v,u)};e.evaluateValueOrFunction=function(a,g,u,v){return c(a)?a(g,u,v):a};e.fromCIMColor=P;e.fromCIMFontDecoration=function(a){return a.underline?"underline":a.strikethrough?"line-through":"none"};e.fromCIMFontStyle=function(a){let g="normal",u="normal";a&&(a=a.toLowerCase(),a.includes("italic")?g="italic":a.includes("oblique")&&(g="oblique"),a.includes("bold")?u="bold":a.includes("light")&&(u="lighter"));return{style:g,weight:u}};e.fromCIMHorizontalAlignment=function(a){switch(a){default:return"left";
case "Right":return"right";case "Center":return"center";case "Justify":return"center"}};e.fromCIMVerticalAlignment=function(a){switch(a){default:return"top";case "Center":return"middle";case "Baseline":return"baseline";case "Bottom":return"bottom"}};e.getFillColor=z;e.getFontStyle=function(a){if(!a)return"normal";switch(a.toLowerCase()){case "italic":return"italic";case "oblique":return"oblique";default:return"normal"}};e.getFontWeight=function(a){if(!a)return"normal";switch(a.toLowerCase()){case "bold":return"bold";
case "bolder":return"bolder";case "lighter":return"lighter";default:return"normal"}};e.getStrokeColor=t;e.getStrokeWidth=D;e.getTintColor=a=>a.tintColor?P(a.tintColor):{r:255,g:255,b:255,a:1};e.getValue=(a,g=0)=>null==a||isNaN(a)?g:a;e.importGeometryEngine=function(){return new Promise((a,g)=>b(["../../geometry/geometryEngineJSON"],a,g))};e.isCIMFill=function(a){return null!=a&&("CIMGradientFill"===a.type||"CIMHatchFill"===a.type||"CIMPictureFill"===a.type||"CIMSolidFill"===a.type||"CIMWaterFill"===
a.type)};e.isCIMMarker=function(a){return"CIMVectorMarker"===a.type||"CIMPictureMarker"===a.type||"CIMBarChartMarker"===a.type||"CIMCharacterMarker"===a.type||"CIMPieChartMarker"===a.type||"CIMStackedBarChartMarker"===a.type};e.isCIMMarkerStrokePlacement=function(a){return null!=a&&("CIMMarkerPlacementAlongLineRandomSize"===a.type||"CIMMarkerPlacementAlongLineSameSize"===a.type||"CIMMarkerPlacementAlongLineVariableSize"===a.type||"CIMMarkerPlacementAtExtremities"===a.type||"CIMMarkerPlacementAtMeasuredUnits"===
a.type||"CIMMarkerPlacementAtRatioPositions"===a.type||"CIMMarkerPlacementOnLine"===a.type||"CIMMarkerPlacementOnVertices"===a.type)};e.isCIMStroke=function(a){return"CIMGradientStroke"===a.type||"CIMPictureStroke"===a.type||"CIMSolidStroke"===a.type};e.isFeatureValueFn=c;e.isGeometryEngineRequired=a=>{if(!a)return!1;for(const g of a)switch(g.type){case "CIMGeometricEffectBuffer":case "CIMGeometricEffectOffset":case "CIMGeometricEffectDonut":return!0}return!1};e.isSVGImage=a=>a.includes("data:image/svg+xml");
e.mapCIMSymbolToGeometryType=function(a){if(!a)return null;switch(a.type){case "CIMPointSymbol":case "CIMTextSymbol":return"esriGeometryPoint";case "CIMLineSymbol":return"esriGeometryPolyline";case "CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}};e.resampleHermite=function(a,g,u,v,k,n,p=!0){const y=g/k;u/=n;const O=Math.ceil(y/2),C=Math.ceil(u/2);for(let d=0;d<n;d++)for(let l=0;l<k;l++){const q=4*(l+(p?n-d-1:d)*k);var f=0;let H=0,N=0,E=0,r=0,I=0,M=0;const S=(d+.5)*u;for(let U=
Math.floor(d*u);U<(d+1)*u;U++){var h=Math.abs(S-(U+.5))/C;const G=(l+.5)*y;h*=h;for(let J=Math.floor(l*y);J<(l+1)*y;J++){let L=Math.abs(G-(J+.5))/O;f=Math.sqrt(h+L*L);-1<=f&&1>=f&&(f=2*f*f*f-3*f*f+1,0<f&&(L=4*(J+U*g),M+=f*a[L+3],N+=f,255>a[L+3]&&(f=f*a[L+3]/250),E+=f*a[L],r+=f*a[L+1],I+=f*a[L+2],H+=f))}}v[q]=E/H;v[q+1]=r/H;v[q+2]=I/H;v[q+3]=M/N}};e.toCIMSymbolJSON=function(a){return a.data?.symbol??null};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/previewUtils":function(){define(["exports",
"../../Color"],function(b,e){function c(m,w){return Math.round(Math.min(Math.max(m+191.25*w,0),255))}b.SymbolSizeDefaults=void 0;(function(m){m[m.size=22]="size";m[m.lineWidth=50]="lineWidth";m[m.maxSize=120]="maxSize";m[m.maxOutlineSize=80]="maxOutlineSize";m[m.tallSymbolWidth=20]="tallSymbolWidth"})(b.SymbolSizeDefaults||(b.SymbolSizeDefaults={}));b.adjustColorBrightness=function(m,w){if(null==m)return new e;if("type"in m&&("linear"===m.type||"pattern"===m.type))return m;m=new e(m);return new e([c(m.r,
w),c(m.g,w),c(m.b,w),m.a])};b.adjustColorComponentBrightness=c;b.getConeShapes=function(m,w){let F=w?b.SymbolSizeDefaults.tallSymbolWidth:m;w=w?4:6;F=F<=b.SymbolSizeDefaults.size?F-.5*w:F-w;w=.15*F;const K=F;m-=w;return[{type:"ellipse",cx:.5*F,cy:m,rx:.5*F,ry:w},{type:"path",path:[{command:"M",values:[.5*K,0]},{command:"L",values:[K,m]},{command:"L",values:[0,m]},{command:"Z",values:[]}]}]};b.getCubeShapes=function(m,w){let F=w?b.SymbolSizeDefaults.tallSymbolWidth:m;var K=w?4:6;K=F=F<=b.SymbolSizeDefaults.size?
F-.5*K:F-K;w=w?.35*F:.5*F;return[{type:"path",path:[{command:"M",values:[.5*K,0]},{command:"L",values:[K,.5*w]},{command:"L",values:[.5*K,w]},{command:"L",values:[0,.5*w]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*w]},{command:"L",values:[.5*K,w]},{command:"L",values:[.5*K,m]},{command:"L",values:[0,m-.5*w]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*K,w]},{command:"L",values:[.5*K,m]},{command:"L",values:[K,m-.5*w]},{command:"L",values:[K,.5*
w]},{command:"Z",values:[]}]}]};b.getCylinderShapes=function(m,w){var F=w?b.SymbolSizeDefaults.tallSymbolWidth:m;w=w?4:6;F=F<=b.SymbolSizeDefaults.size?F-.5*w:F-w;w=.5*F;const K=.15*F;m-=K;return[{type:"ellipse",cx:.5*F,cy:m,rx:w,ry:K},{type:"path",path:[{command:"M",values:[0,K]},{command:"L",values:[0,m]},{command:"L",values:[F,m]},{command:"L",values:[F,K]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*F,cy:K,rx:w,ry:K}]};b.getDiamondShapes=function(m){var w=m;w=w<b.SymbolSizeDefaults.size?w-
2:w-4;const F=Math.floor(m/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*w,0]},{command:"L",values:[w,.5*m-F]},{command:"L",values:[.45*w-F,.5*m+F]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*w,0]},{command:"L",values:[.45*w-F,.5*m+F]},{command:"L",values:[0,.5*m-F]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*m-F]},{command:"L",values:[.45*w-F,.5*m+F]},{command:"L",values:[.45*w,m]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",
values:[.45*w,m]},{command:"L",values:[w,.5*m-F]},{command:"L",values:[.45*w-F,.5*m+F]},{command:"Z",values:[]}]}]};b.getExtrudeSymbolShapes=function(m){const w=b.SymbolSizeDefaults.size;m*=.5;return[{type:"path",path:[{command:"M",values:[0,.35*w]},{command:"L",values:[.3*w,.7*w]},{command:"L",values:[.3*w,.7*w+m]},{command:"L",values:[0,.7*w+m-.35*w]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*w,.7*w]},{command:"L",values:[.3*w,.7*w+m]},{command:"L",values:[w,m]},{command:"L",
values:[w,0]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*w,0]},{command:"L",values:[w,0]},{command:"L",values:[.3*w,.7*w]},{command:"L",values:[0,.35*w]},{command:"Z",values:[]}]}]};b.getInvertedConeShapes=function(m){let w=m;w=w<b.SymbolSizeDefaults.size?w-3:w-6;const F=.15*w,K=w;return[{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[K,0]},{command:"L",values:[.5*K,m-F]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*w,cy:0,rx:.5*w,ry:F}]};b.getPathSymbolShapes=
function(m,w,F){var K=b.SymbolSizeDefaults.size;let P=K,z=K;1>m?P*=.75:1<m&&(z*=1.25);m=K;w&&F&&(P=z=m=K=0);return[{type:"path",path:[{command:"M",values:[m,0]},{command:"L",values:[F?m:.875*m,0]},{command:"L",values:[F?P-.5*m:0,z-.5*K]},{command:"L",values:[P-.5*m,z-.5*K]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[m,0]},{command:"L",values:[m,w?0:.125*K]},{command:"L",values:[P-.5*m,w?z-.5*K:K]},{command:"L",values:[P-.5*m,z-.5*K]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",
values:[P-.5*m,z-.5*K]},{command:"L",values:[F?P-.5*m:0,z-.5*K]},{command:"L",values:[F?P-.5*m:0,w?z-.5*K:K]},{command:"L",values:[P-.5*m,w?z-.5*K:K]},{command:"Z",values:[]}]}]};b.getTetrahedronShapes=function(m){var w=m;w=w<b.SymbolSizeDefaults.size?w-1:w-2;return[{type:"path",path:[{command:"M",values:[.45*m,0]},{command:"L",values:[m,w]},{command:"L",values:[.45*m,.6*w]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*m,0]},{command:"L",values:[.45*m,.6*w]},{command:"L",
values:[0,w]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,w]},{command:"L",values:[.45*m,.6*w]},{command:"L",values:[m,w]},{command:"Z",values:[]}]}]};b.getWaterSymbolShapes=function(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},
{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},
{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]};
b.shapes={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],squareFill:[{type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],
cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],
tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",
path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/renderUtils":function(){define("exports ../../kernel ../../request ../../core/colorUtils ../../core/Error ../../core/has ../../libs/maquette/projection ../../libs/maquette/projector ./svgUtils ./utils".split(" "),
function(b,e,c,m,w,F,K,P,z,t){function D(u,v){g.append(u,v);g.detach(v)}function a(u,v,k){return u?c(u,{responseType:"image"}).then(n=>{n=n.data;const p=n.width,y=n.height,O=p/y;let C=v;k&&(C=Math.min(C,Math.max(p,y)));return{image:n,width:1>=O?Math.ceil(C*O):C,height:1>=O?C:Math.ceil(C/O)}}):Promise.reject(new w("renderUtils: imageDataSize","href not provided."))}const g=P.createProjector();b.renderOnce=D;b.renderSymbol=function(u,v,k){const n=Math.ceil(v[0]),p=Math.ceil(v[1]);if(!u.some(y=>!!y.length))return null;
v=k&&k.node||document.createElement("div");null!=k.opacity&&(v.style.opacity=k.opacity.toString());null!=k.effectView&&(v.style.filter=t.getCSSFilterFromEffectList(k.effectView));D(v,()=>z.renderSVG(u,n,p,k));return v};b.tintImageWithColor=function(u,v,k,n,p){return a(u,v,p).then(y=>{const O=y.width??v,C=y.height??v;var f;if(f=y.image)f=k&&"ignore"!==n?"multiply"===n&&255===k.r&&255===k.g&&255===k.b&&1===k.a?!1:!0:!1;if(f){var h=y.image.width,d=y.image.height;F("edge")&&/\.svg$/i.test(u)&&(--h,--d);
f=Math.ceil(O);var l=Math.ceil(C);var q=document.createElement("canvas");q.width=f;q.height=l;q.style.width=f+"px";q.style.height=l+"px";q=q.getContext("2d");q.clearRect(0,0,f,l);f=q;f.drawImage(y.image,0,0,h,d,0,0,O,C);l=f.getImageData(0,0,O,C);q=[k.r/255,k.g/255,k.b/255,k.a];const N=m.toHSV(k);for(let E=0;E<l.data.length;E+=4){y=l.data;h=E;d=q;var H=N;switch(n){case "multiply":y[h]*=d[0];y[h+1]*=d[1];y[h+2]*=d[2];y[h+3]*=d[3];break;default:const r=m.toHSV({r:y[h],g:y[h+1],b:y[h+2]});r.h=H.h;r.s=
H.s;r.v=r.v/100*H.v;H=m.toRGB(r);y[h]=H.r;y[h+1]=H.g;y[h+2]=H.b;y[h+3]*=d[3]}}f.putImageData(l,0,0);u=f.canvas.toDataURL("image/png")}else(f=e.id&&e.id.findCredential(u))&&f.token&&(y=u.includes("?")?"\x26":"?",u=`${u}${y}token=${f.token}`);return{url:u,width:O,height:C}}).catch(()=>({url:u,width:v,height:v}))};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/colorUtils":function(){define(["exports"],function(b){function e(t,D){const a=[];let g,u;if(t[0].length!==D.length)throw Error("dimensions do not match");
const v=t.length,k=t[0].length;let n=0;for(g=0;g<v;g++){for(u=n=0;u<k;u++)n+=t[g][u]*D[u];a.push(n)}return a}function c(t){t=[t.r/255,t.g/255,t.b/255].map(D=>.04045>=D?D/12.92:((D+.055)/1.055)**2.4);t=e(P,t);return{x:100*t[0],y:100*t[1],z:100*t[2]}}function m(t){t=e(z,[t.x/100,t.y/100,t.z/100]).map(D=>Math.min(1,Math.max(.0031308>=D?12.92*D:1.055*D**(1/2.4)-.055,0)));return{r:Math.round(255*t[0]),g:Math.round(255*t[1]),b:Math.round(255*t[2])}}function w(t){t=[t.x/95.047,t.y/100,t.z/108.883].map(D=>
D>(6/29)**3?D**(1/3):1/3*(29/6)**2*D+4/29);return{l:116*t[1]-16,a:500*(t[0]-t[1]),b:200*(t[1]-t[2])}}function F(t){const D=t.l;t=[(D+16)/116+t.a/500,(D+16)/116,(D+16)/116-t.b/200].map(a=>a>6/29?a**3:3*(6/29)**2*(a-4/29));return{x:95.047*t[0],y:100*t[1],z:108.883*t[2]}}function K(t){if("r"in t&&"g"in t&&"b"in t)return t;if("l"in t&&"c"in t&&"h"in t){var D=t.c,a=t.h;return m(F({l:t.l,a:D*Math.cos(a),b:D*Math.sin(a)}))}if("l"in t&&"a"in t&&"b"in t)return m(F(t));if("x"in t&&"y"in t&&"z"in t)return m(t);
if("h"in t&&"s"in t&&"v"in t){a=(t.h+360)%360/60;D=t.v/100*255;t=t.s/100*D;const g=t*(1-Math.abs(a%2-1));switch(Math.floor(a)){case 0:a={r:t,g,b:0};break;case 1:a={r:g,g:t,b:0};break;case 2:a={r:0,g:t,b:g};break;case 3:a={r:0,g,b:t};break;case 4:a={r:g,g:0,b:t};break;case 5:case 6:a={r:t,g:0,b:g};break;default:a={r:0,g:0,b:0}}a.r=Math.round(a.r+D-t);a.g=Math.round(a.g+D-t);a.b=Math.round(a.b+D-t);return a}return t}const P=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],z=[[3.2406,-1.5372,
-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];b.toHSV=function(t){if("h"in t&&"s"in t&&"v"in t)return t;var D=K(t);t=D.r;const a=D.g,g=D.b;D=Math.max(t,a,g);const u=D-Math.min(t,a,g);t=0===u?0:D===t?(a-g)/u%6:D===a?(g-t)/u+2:(t-a)/u+4;0>t&&(t+=6);return{h:60*t,s:100*(0===u?0:u/D),v:100/255*D}};b.toLAB=function(t){return"l"in t&&"a"in t&&"b"in t?t:w(c(K(t)))};b.toLCH=function(t){if(!("l"in t&&"c"in t&&"h"in t)){var D=w(c(K(t)));t=D.l;var a=D.a;const g=D.b;D=Math.sqrt(a*a+g*g);a=Math.atan2(g,a);
a=0<a?a:a+2*Math.PI;t={l:t,c:D,h:a}}return t};b.toRGB=K;b.toXYZ=function(t){return"x"in t&&"y"in t&&"z"in t?t:c(K(t))};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/svgUtils":function(){define("exports ../../Color ../../core/has ../../core/maybe ../../chunks/mat2df32 ../../chunks/mat2d ../../widgets/support/widgetUtils ../../widgets/support/jsxFactory".split(" "),function(b,e,c,m,w,F,K,P){function z(G,J){G*=S/180;return Math.abs(J*Math.sin(G))+Math.abs(J*Math.cos(G))}
function t(G){return G.map(J=>`${J.command} ${J.values.join(" ")}`).join(" ").trim()}function D(G,J,L,B){if(G){if("circle"===G.type)return P.tsx("circle",{fill:J,"fill-rule":"evenodd",stroke:L.color,"stroke-width":L.width,"stroke-linecap":L.cap,"stroke-linejoin":L.join,"stroke-dasharray":L.dashArray,"stroke-dashoffset":L.dashOffset,"stroke-miterlimit":"4",cx:G.cx,cy:G.cy,r:G.r});if("ellipse"===G.type)return P.tsx("ellipse",{fill:J,"fill-rule":"evenodd",stroke:L.color,"stroke-width":L.width,"stroke-linecap":L.cap,
"stroke-linejoin":L.join,"stroke-dasharray":L.dashArray,"stroke-miterlimit":"4",cx:G.cx,cy:G.cy,rx:G.rx,ry:G.ry});if("rect"===G.type)return P.tsx("rect",{fill:J,"fill-rule":"evenodd",stroke:L.color,"stroke-width":L.width,"stroke-linecap":L.cap,"stroke-linejoin":L.join,"stroke-dasharray":L.dashArray,"stroke-miterlimit":"4",x:G.x,y:G.y,width:G.width,height:G.height});if("image"===G.type)return P.tsx("image",{href:G.src,x:G.x,y:G.y,width:G.width,height:G.height,preserveAspectRatio:"none"});if("path"===
G.type)return G="string"!==typeof G.path?t(G.path):G.path,P.tsx("path",{fill:J,"fill-rule":"evenodd",stroke:L.color,"stroke-width":L.width,"stroke-linecap":L.cap,"stroke-linejoin":L.join,"stroke-dasharray":L.dashArray,"stroke-miterlimit":"4",d:G});if("text"===G.type)return m.assertIsSome(B),P.tsx("text",{"dominant-baseline":B.dominantBaseline,fill:J,"fill-rule":"evenodd",stroke:L.color,"stroke-width":L.width,"stroke-linecap":L.cap,"stroke-linejoin":L.join,"stroke-dasharray":L.dashArray,"stroke-miterlimit":"4",
"text-anchor":B.align,"text-decoration":B.decoration,kerning:B.kerning,rotate:B.rotate,"text-rendering":H,"font-style":B.font.style,"font-variant":B.font.variant,"font-weight":B.font.weight,"font-size":B.font.size,"font-family":B.font.family,x:G.x,y:G.y},G.text)}return null}function a(G){const J={fill:"none",pattern:null,linearGradient:null};if(G)if("type"in G&&"pattern"===G.type){var L=`patternId-${++l}`;J.fill=`url(#${L})`;J.pattern={id:L,x:G.x,y:G.y,width:G.width,height:G.height,image:{x:0,y:0,
width:G.width,height:G.height,href:G.src}}}else"type"in G&&"linear"===G.type?(L=`linearGradientId-${++q}`,J.fill=`url(#${L})`,J.linearGradient={id:L,x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,stops:G.colors.map(B=>({offset:B.offset,color:B.color&&(new e(B.color)).toString()}))}):G&&(G=new e(G),J.fill=G.toString());return J}function g(G){const J={color:"none",width:1,cap:"butt",join:"4",dashArray:"none",dashOffset:"0"};if(G&&(null!=G.width&&(J.width=G.width),G.cap&&(J.cap=G.cap),G.join&&(J.join=G.join.toString()),
G.color&&(J.color=(new e(G.color)).toString()),G.dashArray&&(J.dashArray=G.dashArray),G.dashArray&&(J.dashOffset=G.dashoffset),G.style)){let L=null;G.style in M&&(L=M[G.style]);if(Array.isArray(L)){L=L.slice(0);const B=G.width??0;for(let A=0;A<L.length;++A)L[A]*=B;if("butt"!==G.cap){for(G=0;G<L.length;G+=2)L[G]-=B,1>L[G]&&(L[G]=1);for(G=1;G<L.length;G+=2)L[G]+=B}L=L.join(",")}J.dashArray=L}return J}function u(G,J){const L={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,
weight:null,size:null,family:null}};if(G){const B=G.alignBaseline;L.align=G.align;L.dominantBaseline="baseline"===B?"auto":"top"===B?"text-top":"bottom"===B?"hanging":B;L.decoration=G.decoration;L.kerning=G.kerning?"auto":"0";L.rotate=G.rotated?"90":"0";m.assertIsSome(J);L.font.style=J.style||"normal";L.font.variant=J.variant||"normal";L.font.weight=J.weight||"normal";L.font.size=J.size&&J.size.toString()||"10pt";L.font.family=J.family||"serif"}return L}function v(G){const {pattern:J,linearGradient:L}=
G;return J?P.tsx("pattern",{id:J.id,patternUnits:"userSpaceOnUse",x:J.x,y:J.y,width:J.width,height:J.height},P.tsx("image",{x:J.image.x,y:J.image.y,width:J.image.width,height:J.image.height,href:J.image.href})):L?(G=L.stops.map((B,A)=>P.tsx("stop",{key:`${A}-stop`,offset:B.offset,"stop-color":B.color})),P.tsx("linearGradient",{id:L.id,gradientUnits:"userSpaceOnUse",x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2},G)):null}function k(G,J){if(!G||0===G.length)return null;const L=[];for(const B of G){const {shape:A,
fill:x,stroke:Q,font:T}=B;G=a(x);const W=g(Q),aa="text"===A.type?u(A,T):null;(G=D(A,G.fill,W,aa))&&L.push(G)}return P.tsx("mask",{id:J,maskUnits:"userSpaceOnUse"},P.tsx("g",null,L))}function n(G,J,L,B,A){F.scale(G,F.identity(G),[J,L]);G[4]=G[4]*J-B*J+B;G[5]=G[5]*L-A*L+A;return G}function p(G,J){if(r&&"left"in r){null!=r.left&&r.left>G&&(r.left=G);if(null==r.right||r.right<G)r.right=G;if(null==r.top||r.top>J)r.top=J;if(null==r.bottom||r.bottom<J)r.bottom=J}else r={left:G,bottom:J,right:G,top:J}}function y(G){const J=
G.args,L=J.length;switch(G.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(G=0;G<L;G+=2)p(J[G],J[G+1]);I.x=J[L-2];I.y=J[L-1];break;case "H":for(G=0;G<L;++G)p(J[G],I.y);I.x=J[L-1];break;case "V":for(G=0;G<L;++G)p(I.x,J[G]);I.y=J[L-1];break;case "m":G=0;"x"in I||(p(I.x=J[0],I.y=J[1]),G=2);for(;G<L;G+=2)p(I.x+=J[G],I.y+=J[G+1]);break;case "l":case "t":for(G=0;G<L;G+=2)p(I.x+=J[G],I.y+=J[G+1]);break;case "h":for(G=0;G<L;++G)p(I.x+=J[G],I.y);break;case "v":for(G=0;G<L;++G)p(I.x,I.y+=
J[G]);break;case "c":for(G=0;G<L;G+=6)p(I.x+J[G],I.y+J[G+1]),p(I.x+J[G+2],I.y+J[G+3]),p(I.x+=J[G+4],I.y+=J[G+5]);break;case "s":case "q":for(G=0;G<L;G+=4)p(I.x+J[G],I.y+J[G+1]),p(I.x+=J[G+2],I.y+=J[G+3]);break;case "A":for(G=0;G<L;G+=7)p(J[G+5],J[G+6]);I.x=J[L-2];I.y=J[L-1];break;case "a":for(G=0;G<L;G+=7)p(I.x+=J[G+5],I.y+=J[G+6])}}function O(G,J,L){const B=N[G.toLowerCase()];"number"===typeof B&&(B?J.length>=B&&(G={action:G,args:J.slice(0,J.length-J.length%B)},L.push(G),y(G)):(G={action:G,args:[]},
L.push(G),y(G)))}function C(G){const J={x:0,y:0,width:0,height:0};if("circle"===G.type)J.x=G.cx-G.r,J.y=G.cy-G.r,J.width=2*G.r,J.height=2*G.r;else if("ellipse"===G.type)J.x=G.cx-G.rx,J.y=G.cy-G.ry,J.width=2*G.rx,J.height=2*G.ry;else if("image"===G.type||"rect"===G.type)J.x=G.x,J.y=G.y,J.width=G.width,J.height=G.height;else if("path"===G.type){var L=m.unwrapOrThrow;{const x=("string"!==typeof G.path?t(G.path):G.path).match(E),Q=[];r={};I={};if(x){G="";var B=[],A=x.length;for(let T=0;T<A;++T){const W=
x[T],aa=parseFloat(W);isNaN(aa)?(G&&O(G,B,Q),B=[],G=W):B.push(aa)}O(G,B,Q);G={x:0,y:0,width:0,height:0};r&&"left"in r&&(G.x=r.left,G.y=r.top,G.width=r.right-r.left,G.height=r.bottom-r.top)}else G=null}L=L.call(m,G);J.x=L.x;J.y=L.y;J.width=L.width;J.height=L.height}return J}function f(G){const J={x:0,y:0,width:0,height:0};let L=null,B=Number.NEGATIVE_INFINITY,A=Number.NEGATIVE_INFINITY;for(const x of G)L?(L.x=Math.min(L.x,x.x),L.y=Math.min(L.y,x.y),B=Math.max(B,x.x+x.width),A=Math.max(A,x.y+x.height)):
(L=J,L.x=x.x,L.y=x.y,B=x.x+x.width,A=x.y+x.height);L&&(L.width=B-L.x,L.height=A-L.y);return L}function h(G,J,L,B,A,x,Q,T,W){var aa=(Q&&x?z(x,J):J)/2,Y=(Q&&x?z(x,L):L)/2;if(W){var Z=W[0];W=W[1];aa=(Q&&x?z(x,Z):Z)/2;Y=(Q&&x?z(x,W):W)/2}Z=G.width+B;var R=G.height+B;W=w.create();Q=w.create();var V=!1;if(A&&0!==Z&&0!==R){A=J!==L?J/L:Z/R;V=J>L?J:L;let ba=1,ea=1;isNaN(V)||(1<A?(ba=V/Z,ea=V/A/R):(ea=V/R,ba=V*A/Z));F.multiply(Q,Q,n(W,ba,ea,aa,Y));V=!0}A=G.x+(Z-B)/2;G=G.y+(R-B)/2;B=F.multiply;aa-=A;Y-=G;aa=
F.translate(W,F.identity(W),[aa,Y]);B.call(F,Q,Q,aa);!V&&(Z>J||R>L)&&(aa=Z/J>R/L,J=(aa?J:L)/(aa?Z:R),F.multiply(Q,Q,n(W,J,J,A,G)));x&&(J=F.multiply,L=x%360*Math.PI/180,F.rotate(W,F.identity(W),L),x=Math.cos(L),L=Math.sin(L),Z=W[4],R=W[5],W[4]=Z*x-R*L+G*L-A*x+A,W[5]=R*x+Z*L-A*L-G*x+G,J.call(F,Q,Q,W));T&&(x=F.multiply,J=T[0],T=T[1],T=F.translate(W,F.identity(W),[J,T]),x.call(F,Q,Q,T));return`matrix(${Q[0]},${Q[1]},${Q[2]},${Q[3]},${Q[4]},${Q[5]})`}function d(G,J,L){G=G?.effects.find(T=>"bloom"===T.type);
if(!G)return null;const {strength:B,radius:A}=G;G=0<B?A:0;const x=(B+G)*J,Q=4*B+1;return P.tsx("filter",{id:`bloom${L}`,x:"-100%",y:"-100%",width:"300%",height:"300%",filterUnits:"userSpaceOnUse"},P.tsx("feMorphology",{operator:"dilate",radius:(B+.5*G)*5**(J/100)*(.4+J/100),in:"SourceGraphic",result:"dilate"}),P.tsx("feGaussianBlur",{in:"dilate",stdDeviation:x/25,result:"blur"}),P.tsx("feGaussianBlur",{in:"blur",stdDeviation:x/50,result:"intensityBlur"}),P.tsx("feComponentTransfer",{in:"SourceGraphic",
result:"intensityBrightness"},P.tsx("feFuncR",{type:"linear",slope:Q}),P.tsx("feFuncG",{type:"linear",slope:Q}),P.tsx("feFuncB",{type:"linear",slope:Q})),P.tsx("feMerge",null,P.tsx("feMergeNode",{in:"intensityBlur"}),P.tsx("feMergeNode",{in:"intensityBrightness"}),P.tsx("feGaussianBlur",{stdDeviation:B/10})))}let l=0,q=0;K=c("android");const H=c("chrome")||K&&4<=K?"auto":"optimizeLegibility",N={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},E=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;let r=
{},I={};const M={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]},S=Math.PI;let U=1;b.computeBBox=f;b.generateFillAttributes=a;b.generateStrokeAttributes=g;b.generateTextAttributes=u;b.getBoundingBox=C;b.getTransformMatrix=h;b.renderDef=v;b.renderSVG=function(G,J,L,B={}){const A=[],x=[],Q=++U,T=d(B.effectView,J,Q);var W=null;T&&(W=B.effectView?.effects.find(V=>
"bloom"===V.type),W=(W.strength?W.strength+W.radius/2:0)/3,W=[Math.max(J+J*W,10),Math.max(L+L*W,10)]);for(let V=0;V<G.length;V++){var aa=G[V];const ba=[];var Y=[],Z=0,R=0;let ea=0;for(const ha of aa){const {shape:la,fill:ia,stroke:na,font:ma,offset:X}=ha;B.ignoreStrokeWidth||"text"===la.type||(Z+=na&&na.width||0);aa=a(ia);const da=g(na),fa="text"===la.type?u(la,ma):null;A.push(v(aa));ba.push(D(la,aa.fill,da,fa));Y.push(C(la));X&&(R+=X[0],ea+=X[1])}Y=m.unwrapOrThrow(f(Y));Z=h(Y,J,L,Z,B.scale??!1,B.rotation,
B.useRotationSize??!1,[R,ea],W);R=null;B.masking&&(R=`mask-${V}`,A.push(k(B.masking[V],R)),R=`url(#${R})`);x.push(R?P.tsx("g",{mask:R},P.tsx("g",{transform:Z},ba)):P.tsx("g",{transform:Z},ba))}B.useRotationSize&&B.rotation&&(J=z(B.rotation,J),L=z(B.rotation,L));T&&(m.assertIsSome(W),J=W[0],L=W[1]);return P.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:J,height:L,style:"display: block;","aria-labelledby":B.ariaLabel,role:"img",focusable:!1},T,P.tsx("defs",null,A),T?P.tsx("g",{filter:`url(#bloom${Q})`},
x):x)};b.renderShape=D;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/mat2df32":function(){define(["exports"],function(b){function e(){const z=new Float32Array(6);z[0]=1;z[3]=1;return z}function c(z){const t=new Float32Array(6);t[0]=z[0];t[1]=z[1];t[2]=z[2];t[3]=z[3];t[4]=z[4];t[5]=z[5];return t}function m(z,t,D,a,g,u){const v=new Float32Array(6);v[0]=z;v[1]=t;v[2]=D;v[3]=a;v[4]=g;v[5]=u;return v}function w(z,t){return new Float32Array(z,t,6)}function F(z,t,D,a){const g=
t[a];t=t[a+1];z[a]=D[0]*g+D[2]*t+D[4];z[a+1]=D[1]*g+D[3]*t+D[5]}function K(z,t,D,a=0,g=0,u=2){for(g=g||t.length/u;a<g;a++)F(z,t,D,a*u)}const P=Object.freeze(Object.defineProperty({__proto__:null,clone:c,create:e,createView:w,fromValues:m,transform:F,transformMany:K},Symbol.toStringTag,{value:"Module"}));b.clone=c;b.create=e;b.createView=w;b.fromValues=m;b.mat2df32=P;b.transform=F;b.transformMany=K})},"esri/chunks/mat2d":function(){define(["exports","./common"],function(b,e){function c(d,l){d[0]=l[0];
d[1]=l[1];d[2]=l[2];d[3]=l[3];d[4]=l[4];d[5]=l[5];return d}function m(d){d[0]=1;d[1]=0;d[2]=0;d[3]=1;d[4]=0;d[5]=0;return d}function w(d,l,q,H,N,E,r){d[0]=l;d[1]=q;d[2]=H;d[3]=N;d[4]=E;d[5]=r;return d}function F(d,l){const q=l[0],H=l[1],N=l[2],E=l[3],r=l[4];l=l[5];let I=q*E-H*N;if(!I)return null;I=1/I;d[0]=E*I;d[1]=-H*I;d[2]=-N*I;d[3]=q*I;d[4]=(N*l-E*r)*I;d[5]=(H*r-q*l)*I;return d}function K(d){return d[0]*d[3]-d[1]*d[2]}function P(d,l,q){const H=l[0],N=l[1],E=l[2],r=l[3],I=l[4];l=l[5];const M=q[0],
S=q[1],U=q[2],G=q[3],J=q[4];q=q[5];d[0]=H*M+E*S;d[1]=N*M+r*S;d[2]=H*U+E*G;d[3]=N*U+r*G;d[4]=H*J+E*q+I;d[5]=N*J+r*q+l;return d}function z(d,l,q){const H=l[0],N=l[1],E=l[2],r=l[3],I=l[4];l=l[5];const M=Math.sin(q);q=Math.cos(q);d[0]=H*q+E*M;d[1]=N*q+r*M;d[2]=H*-M+E*q;d[3]=N*-M+r*q;d[4]=I;d[5]=l;return d}function t(d,l,q){const H=l[1],N=l[2],E=l[3],r=l[4],I=l[5],M=q[0];q=q[1];d[0]=l[0]*M;d[1]=H*M;d[2]=N*q;d[3]=E*q;d[4]=r;d[5]=I;return d}function D(d,l,q){const H=l[0],N=l[1],E=l[2],r=l[3],I=l[4];l=l[5];
const M=q[0];q=q[1];d[0]=H;d[1]=N;d[2]=E;d[3]=r;d[4]=H*M+E*q+I;d[5]=N*M+r*q+l;return d}function a(d,l){const q=Math.sin(l);l=Math.cos(l);d[0]=l;d[1]=q;d[2]=-q;d[3]=l;d[4]=0;d[5]=0;return d}function g(d,l){d[0]=l[0];d[1]=0;d[2]=0;d[3]=l[1];d[4]=0;d[5]=0;return d}function u(d,l){d[0]=1;d[1]=0;d[2]=0;d[3]=1;d[4]=l[0];d[5]=l[1];return d}function v(d){return"mat2d("+d[0]+", "+d[1]+", "+d[2]+", "+d[3]+", "+d[4]+", "+d[5]+")"}function k(d){return Math.sqrt(d[0]**2+d[1]**2+d[2]**2+d[3]**2+d[4]**2+d[5]**2+
1)}function n(d,l,q){d[0]=l[0]+q[0];d[1]=l[1]+q[1];d[2]=l[2]+q[2];d[3]=l[3]+q[3];d[4]=l[4]+q[4];d[5]=l[5]+q[5];return d}function p(d,l,q){d[0]=l[0]-q[0];d[1]=l[1]-q[1];d[2]=l[2]-q[2];d[3]=l[3]-q[3];d[4]=l[4]-q[4];d[5]=l[5]-q[5];return d}function y(d,l,q){d[0]=l[0]*q;d[1]=l[1]*q;d[2]=l[2]*q;d[3]=l[3]*q;d[4]=l[4]*q;d[5]=l[5]*q;return d}function O(d,l,q,H){d[0]=l[0]+q[0]*H;d[1]=l[1]+q[1]*H;d[2]=l[2]+q[2]*H;d[3]=l[3]+q[3]*H;d[4]=l[4]+q[4]*H;d[5]=l[5]+q[5]*H;return d}function C(d,l){return d[0]===l[0]&&
d[1]===l[1]&&d[2]===l[2]&&d[3]===l[3]&&d[4]===l[4]&&d[5]===l[5]}function f(d,l){const q=d[0],H=d[1],N=d[2],E=d[3],r=d[4];d=d[5];const I=l[0],M=l[1],S=l[2],U=l[3],G=l[4];l=l[5];const J=e.getEpsilon();return Math.abs(q-I)<=J*Math.max(1,Math.abs(q),Math.abs(I))&&Math.abs(H-M)<=J*Math.max(1,Math.abs(H),Math.abs(M))&&Math.abs(N-S)<=J*Math.max(1,Math.abs(N),Math.abs(S))&&Math.abs(E-U)<=J*Math.max(1,Math.abs(E),Math.abs(U))&&Math.abs(r-G)<=J*Math.max(1,Math.abs(r),Math.abs(G))&&Math.abs(d-l)<=J*Math.max(1,
Math.abs(d),Math.abs(l))}const h=Object.freeze(Object.defineProperty({__proto__:null,add:n,copy:c,determinant:K,equals:f,exactEquals:C,frob:k,fromRotation:a,fromScaling:g,fromTranslation:u,identity:m,invert:F,mul:P,multiply:P,multiplyScalar:y,multiplyScalarAndAdd:O,rotate:z,scale:t,set:w,str:v,sub:p,subtract:p,translate:D},Symbol.toStringTag,{value:"Module"}));b.add=n;b.copy=c;b.determinant=K;b.equals=f;b.exactEquals=C;b.frob=k;b.fromRotation=a;b.fromScaling=g;b.fromTranslation=u;b.identity=m;b.invert=
F;b.mat2d=h;b.mul=P;b.multiply=P;b.multiplyScalar=y;b.multiplyScalarAndAdd=O;b.rotate=z;b.scale=t;b.set=w;b.str=v;b.sub=p;b.subtract=p;b.translate=D})},"esri/symbols/support/utils":function(){define("require exports ../../Color ../../symbols ../../core/asyncUtils ../../core/has ../../core/maybe ../../core/screenUtils ../../chunks/vec3f64 ../../layers/effects/jsonUtils ./cimSymbolUtils ./gfxUtils ./Symbol3DMaterial".split(" "),function(b,e,c,m,w,F,K,P,z,t,D,a,g){function u(l){l=l.symbolLayers;if(!l)return null;
let q=null;l.forEach(H=>{"object"===H.type&&H.resource?.href||(q="water"===H.type?H.color:H.material?H.material.color:null)});return q?new c(q):null}function v(l,q){if(null==q||null==l)return l;l=l.toRgba();l[3]*=q;return new c(l)}function k(l,q,H){if(l=l.symbolLayers){var N=E=>{q=q??E??(null!=H?d:null);return v(q,H)};l.forEach(E=>{if("object"!==E.type||!E.resource?.href||q)if("water"===E.type)E.color=N(E.color);else{const r=N(null!=E.material?E.material.color:null);null==E.material?E.material=new g.Symbol3DMaterial({color:r}):
E.material.color=r;null!=H&&"outline"in E&&null!=E.outline&&null!=E.outline.color&&(E.outline.color=v(E.outline.color,H))}})}}async function n(l,q){(l=l.symbolLayers)&&await w.forEach(l,async H=>p(H,q))}async function p(l,q){switch(l.type){case "extrude":l.size="number"===typeof q[2]?q[2]:0;break;case "icon":case "line":case "text":q=y(q);null!=q&&(l.size=q);break;case "path":const H=C(q,z.ONES,[l.width,void 0,l.height]);l.width=h(q[0],l.width,1,H);l.height=h(q[2],l.height,1,H);break;case "object":await O(l,
q)}}function y(l){for(const q of l)if("number"===typeof q)return q;return null}async function O(l,q){const {resourceSize:H,symbolSize:N}=await f(l),E=C(q,H,N);l.width=h(q[0],N[0],H[0],E);l.depth=h(q[1],N[1],H[1],E);l.height=h(q[2],N[2],H[2],E)}function C(l,q,H){for(let N=0;3>N;N++){const E=l[N];switch(E){case "symbol-value":return l=H[N],null!=l?l/q[N]:1;case "proportional":break;default:if(E&&q[N])return E/q[N]}}return 1}async function f(l){var {computeObjectLayerResourceSize:q}=await new Promise((M,
S)=>b(["./symbolLayerUtils"],M,S));q=await q(l,10);const {width:H,height:N,depth:E}=l;l=[H,E,N];let r=1;for(var I=0;3>I;I++){const M=l[I];if(null!=M){r=M/q[I];break}}for(I=0;3>I;I++)null==l[I]&&(l[I]=q[I]*r);return{resourceSize:q,symbolSize:l}}function h(l,q,H,N){switch(l){case "proportional":return H*N;case "symbol-value":return null!=q?q:H;default:return l}}const d=new c("white");e.applyColorToSymbol=function(l,q,H){if(l&&(q||null!=H))if(q&&(q=new c(q)),m.isSymbol3D(l))k(l,q,H);else if(m.isSymbol2D(l)){if(q=
q??l.color)l.color=v(q,H);null!=H&&"outline"in l&&l.outline&&l.outline.color&&(l.outline.color=v(l.outline.color,H))}};e.applyOpacityToColor=v;e.applyRotationToSymbol=function(l,q,H){l&&null!=q&&(m.isSymbol3D(l)?(l=l.symbolLayers)&&l.forEach(N=>{if(N&&"object"===N.type)switch(H){case "tilt":N.tilt=q;break;case "roll":N.roll=q;break;default:N.heading=q}}):!m.isSymbol2D(l)||"simple-marker"!==l.type&&"picture-marker"!==l.type&&"text"!==l.type||(l.angle=q))};e.applySizesToSymbol=async function(l,q){if(l&&
q){if(m.isSymbol3D(l))return n(l,q);if(m.isSymbol2D(l)&&(q=y(q),null!=q))switch(l.type){case "simple-marker":l.size=q;break;case "picture-marker":const H=l.width/l.height;1<H?(l.width=q,l.height=q*H):(l.width=q*H,l.height=q);break;case "simple-line":l.width=q;break;case "text":l.font.size=q}}};e.fetchWebStyleSymbol=async function(l,q){const H=await l.fetchSymbol(q);return H?H:l.fetchCIMSymbol(q)};e.getCSSFilterFromEffectList=function(l){if(!l)return null;l=l.effects.filter(q=>"bloom"!==q.type).map(q=>
q.toJSON());return t.effectFunctionsFromJSON(l)};e.getColorFromSymbol=function(l,q){if(!l)return null;let H=null;m.isSymbol3D(l)?H=u(l):m.isSymbol2D(l)&&(H="cim"===l.type?D.getCIMSymbolColor(l):l.color?new c(l.color):null);return H?v(H,q):null};e.getIconHref=function(l){return K.unwrapOrThrow(l.resource).href};e.getSymbolOutlineSize=function(l){return l?m.isSymbol3D(l)?(l=(l=l.symbolLayers?.at(-1))&&"outline"in l?l?.outline?.size:void 0,null!=l?l:0):P.px2pt(a.getStroke(l)?.width):0};e.isVolumetricSymbol=
function(l){if(null==l||!("symbolLayers"in l)||null==l.symbolLayers)return!1;switch(l.type){case "point-3d":return l.symbolLayers.some(q=>"object"===q.type);case "line-3d":return l.symbolLayers.some(q=>"path"===q.type);case "polygon-3d":return l.symbolLayers.some(q=>"object"===q.type||"extrude"===q.type);default:return!1}};e.symbolHasExtrudeSymbolLayer=function(l){return null!=l&&"polygon-3d"===l.type&&l.symbolLayers.some(q=>"extrude"===q.type)};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},
"esri/widgets/Legend/styles/support/relationshipUtils":function(){define(["exports","../../../../symbols/support/svgUtils","../../../../symbols/support/utils","../../../support/widgetUtils","../../../support/jsxFactory"],function(b,e,c,m,w){function F(z,t,D){const a=`${D}_arrowStart`;D=`${D}_arrowEnd`;z="left"===z;const g={markerStart:null,markerEnd:null};switch(t){case "HL":z?g.markerStart=`url(#${D})`:g.markerEnd=`url(#${a})`;break;case "LL":g.markerStart=`url(#${D})`;break;case "LH":z?g.markerEnd=
`url(#${a})`:g.markerStart=`url(#${D})`;break;default:g.markerEnd=`url(#${a})`}return g}function K(z,t,D={}){const {focus:a,numClasses:g,colors:u,rotation:v}=z,{opacity:k,effectList:n,ariaLabel:p}=D;z=D.size??60;D=!!a;const y=Math.sqrt(z**2+z**2)+(D?0:5),O=[],C=[];var f=[],h=(z||75)/g;for(var d=0;d<g;d++){var l=d*h;for(var q=0;q<g;q++){var H=q*h,N=e.generateFillAttributes(u[d][q]);const E=e.generateStrokeAttributes(null);H={type:"rect",x:H,y:l,width:h,height:h};const r=e.renderDef(N);r&&O.push(r);
(N=e.renderShape(H,N.fill,E,null))&&C.push(N);f.push(e.getBoundingBox(H))}}h=null;D||(h="margin: -15px -15px -18px -15px");d=F("left",a,t);l=F("right",a,t);q=e.computeBBox(f);f=e.getTransformMatrix(q,y,y,0,!1,v,!1);q=e.getTransformMatrix(q,y,y,0,!1,D?-45:null,!1);N={filter:c.getCSSFilterFromEffectList(n)??void 0,opacity:null==k?"":`${k}`};return w.tsx("div",{styles:N,class:D?P.diamondMidColRamp:P.squareTableCell},w.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:y,height:y,style:h,"aria-labelledBy":p,
role:"image",focusable:!1},w.tsx("defs",null,w.tsx("marker",{id:`${t}_arrowStart`,markerWidth:"10",markerHeight:"10",refX:"5",refY:"5",markerUnits:"strokeWidth",orient:"auto"},w.tsx("polyline",{points:"0,0 5,5 0,10",fill:"none",stroke:"#555555","stroke-width":"1"})),w.tsx("marker",{id:`${t}_arrowEnd`,markerWidth:"10",markerHeight:"10",refX:"0",refY:"5",markerUnits:"strokeWidth",orient:"auto"},w.tsx("polyline",{points:"5,0 0,5 5,10",fill:"none",stroke:"#555555","stroke-width":"1"})),O),w.tsx("g",{transform:f},
C),w.tsx("g",{transform:q},w.tsx("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":d.markerStart,"marker-end":d.markerEnd,x1:-10,y1:z-15,x2:-10,y2:15}),w.tsx("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":l.markerStart,"marker-end":l.markerEnd,x1:15,y1:z+10,x2:z-15,y2:z+10}))))}const P={diamondContainer:"esri-relationship-ramp--diamond__container",diamondLeftCol:"esri-relationship-ramp--diamond__left-column",diamondRightCol:"esri-relationship-ramp--diamond__right-column",
diamondMidCol:"esri-relationship-ramp--diamond__middle-column",diamondMidColLabel:"esri-relationship-ramp--diamond__middle-column--label",diamondMidColRamp:"esri-relationship-ramp--diamond__middle-column--ramp",squareTable:"esri-relationship-ramp--square__table",squareTableRow:"esri-relationship-ramp--square__table-row",squareTableCell:"esri-relationship-ramp--square__table-cell",squareTableLabel:"esri-relationship-ramp--square__table-label",squareTableLabelLeftBottom:"esri-relationship-ramp--square__table-label--left-bottom",
squareTableLabelRightBottom:"esri-relationship-ramp--square__table-label--right-bottom",squareTableLabelLeftTop:"esri-relationship-ramp--square__table-label--left-top",squareTableLabelRightTop:"esri-relationship-ramp--square__table-label--right-top"};b.renderRelationshipRamp=function(z,t,D={}){const {focus:a,labels:g}=z,u=!!a;z=K(z,t,D);t={justifyContent:"center"};D=m.isRTL();return u?w.tsx("div",{class:P.diamondContainer,styles:t},w.tsx("div",{class:P.diamondLeftCol},D?g.right:g.left),w.tsx("div",
{class:P.diamondMidCol},w.tsx("div",{class:P.diamondMidColLabel},g.top),z,w.tsx("div",{class:P.diamondMidColLabel},g.bottom)),w.tsx("div",{class:P.diamondRightCol},D?g.left:g.right)):w.tsx("div",{class:P.squareTable},w.tsx("div",{class:P.squareTableRow},w.tsx("div",{class:m.classes(P.squareTableCell,P.squareTableLabel,P.squareTableLabelRightBottom)},D?g.top:g.left),w.tsx("div",{class:P.squareTableCell}),w.tsx("div",{class:m.classes(P.squareTableCell,P.squareTableLabel,P.squareTableLabelLeftBottom)},
D?g.left:g.top)),w.tsx("div",{class:P.squareTableRow},w.tsx("div",{class:P.squareTableCell}),z,w.tsx("div",{class:P.squareTableCell})),w.tsx("div",{class:P.squareTableRow},w.tsx("div",{class:m.classes(P.squareTableCell,P.squareTableLabel,P.squareTableLabelRightTop)},D?g.right:g.bottom),w.tsx("div",{class:P.squareTableCell}),w.tsx("div",{class:m.classes(P.squareTableCell,P.squareTableLabel,P.squareTableLabelLeftTop)},D?g.bottom:g.right)))};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},
"esri/widgets/Legend/support/relationshipRampUtils":function(){define(["exports","../../../core/lang","../../../symbols/support/gfxUtils","../../../symbols/support/previewSymbol3D"],function(b,e,c,m){function w(t){if(t){var {type:D}=t;return D.includes("3d")?m.getSymbolLayerFill(t.symbolLayers.at(0)):"simple-line"===D||"simple-marker"===t.type&&("x"===t.style||"cross"===t.style)?(t=c.getStroke(t))&&t.color:c.getFill(t)}}function F(t,D){const a=D.HH.label,g=D.LL.label,u=D.HL.label;D=D.LH.label;switch(t){case "HH":return{top:a,
bottom:g,left:u,right:D};case "HL":return{top:u,bottom:D,left:g,right:a};case "LL":return{top:g,bottom:a,left:D,right:u};case "LH":return{top:D,bottom:u,left:a,right:g};default:return{top:a,bottom:g,left:u,right:D}}}function K(t){let D=P[t];t&&null==D&&(D=P.HH);return D||0}const P={HH:315,HL:45,LL:135,LH:225},z={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};
b.getRelationshipRampColors2D=function(t,D){const a=[],g=t.length**.5;t=e.clone(t);var u=(D||"HH").split("");D=u[0];for(u="H"===u[1];t.length;){const v=[];for(;v.length<g;)v.push(t.shift());u&&v.reverse();a.push(v)}"L"===D&&a.reverse();return a};b.getRelationshipRampElement=function(t){const {focus:D,infos:a,numClasses:g}=t;var u=z[g];const v={};a.forEach(k=>{v[k.value]={label:k.label,fill:w(k.symbol)}});t=[];for(let k=0;k<g;k++){const n=[];for(let p=0;p<g;p++)n.push(v[u[k][p]].fill);t.push(n)}u=
F(D,v);return{type:"relationship-ramp",numClasses:g,focus:D,colors:t,labels:u,rotation:K(D)}};b.getRotationAngleForFocus=K;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/previewSymbol3D":function(){define("exports ../../assets ../../core/colorUtils ../../core/has ../../core/Error ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/screenUtils ./gfxUtils ./IconSymbol3DLayerResource ./ObjectSymbol3DLayerResource ./previewUtils ./renderUtils ./utils ./webStyleSymbolUtils".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a,g,u,v,k){function n(B){const A=B.outline;var x=null!=B.material?B.material.color:null;x=null!=x?x.toHex():null;if(null==A||"pattern"in A&&null!=A.pattern&&"style"===A.pattern.type&&"none"===A.pattern.style)return"fill"===B.type&&"#ffffff"===x?{color:"#bdc3c7",width:.75}:null;B=z.pt2px(A.size)||0;return{color:"rgba("+(null!=A.color?A.color.toRgba():"255,255,255,1")+")",width:Math.min(B,G),style:"pattern"in A&&null!=A.pattern&&"style"===A.pattern.type?t.dekebabifyLineStyle(A.pattern.style):
null,join:"butt",cap:"patternCap"in A?A.patternCap:"butt"}}async function p(B,A){if(B.thumbnail?.url)return B.thumbnail.url;if("icon"===A.type&&A?.resource?.href)return v.getIconHref(A);A=e.getAssetUrl("esri/images/Legend/legend3dsymboldefault.png");return B.styleOrigin&&(B.styleOrigin.styleName||B.styleOrigin.styleUrl)&&(B=await k.resolveWebStyleSymbol(B.styleOrigin,{portal:B.styleOrigin.portal},"webRef").catch(()=>null))&&"thumbnail"in B&&B.thumbnail?.url?B.thumbnail.url:A}function y(B,A=1){const x=
B.a;B=c.toHSV(B);const {r:Q,g:T,b:W}=c.toRGB({h:B.h,s:B.s/A,v:100-(100-B.v)/A});return[Q,T,W,x]}function O(B){return"water"===B.type?null==B.color?null:B.color:null==B.material||null==B.material.color?null:B.material.color}function C(B,A=0){var x=O(B);if(!x){if("fill"===B.type)return null;A=g.adjustColorComponentBrightness(t.defaultThematicColor.r,A);return[A,A,A,100]}B=x.toRgba();for(x=0;3>x;x++)B[x]=g.adjustColorComponentBrightness(B[x],A);return B}async function f(B,A){B=B.style;return"none"===
B?null:{type:"pattern",x:0,y:0,src:await t.getPatternUrlWithColor(e.getAssetUrl(`esri/symbols/patterns/${B}.png`),A.toCss(!0)),width:5,height:5}}function h(B){return B.outline?n(B):{color:"rgba(0, 0, 0, 1)",width:1.5}}function d(B,A){B=O(B);if(!B)return null;let x;x="rgba("+(g.adjustColorComponentBrightness(B.r,A)+",");x+=g.adjustColorComponentBrightness(B.g,A)+",";x+=g.adjustColorComponentBrightness(B.b,A)+",";return x+B.a+");"}function l(B,A){A=d(B,A);if(!A)return{};if("pattern"in B&&null!=B.pattern&&
"style"===B.pattern.type&&"none"===B.pattern.style)return null;const x=Math.min(B.size?z.pt2px(B.size):.75,G);return{color:A,width:x,style:"pattern"in B&&null!=B.pattern&&"style"===B.pattern.type?t.dekebabifyLineStyle(B.pattern.style):null,cap:"cap"in B?B.cap:null,join:"join"in B?"miter"===B.join?z.pt2px(2):B.join:null}}function q(B,A,x){x=null!=x?.75*x:0;return{type:"linear",x1:x?.25*x:0,y1:x?.5*x:0,x2:x||4,y2:x?.5*x:4,colors:[{color:B,offset:0},{color:A,offset:1}]}}function H(B){const A=B.depth,
x=B.height;B=B.width;return 0!==B&&0!==A&&0!==x&&B===A&&null!=B&&null!=x&&B<x}function N(B,A,x){const Q=[];if(!B)return Q;switch(B.type){case "icon":switch(B.resource&&B.resource.primitive||D.defaultPrimitive){case "circle":Q.push({shape:{type:"circle",cx:0,cy:0,r:.5*A},fill:C(B,0),stroke:n(B)});break;case "square":Q.push({shape:{type:"path",path:[{command:"M",values:[0,A]},{command:"L",values:[0,0]},{command:"L",values:[A,0]},{command:"L",values:[A,A]},{command:"Z",values:[]}]},fill:C(B,0),stroke:n(B)});
break;case "triangle":Q.push({shape:{type:"path",path:[{command:"M",values:[0,A]},{command:"L",values:[.5*A,0]},{command:"L",values:[A,A]},{command:"Z",values:[]}]},fill:C(B,0),stroke:n(B)});break;case "cross":Q.push({shape:{type:"path",path:[{command:"M",values:[.5*A,0]},{command:"L",values:[.5*A,A]},{command:"M",values:[0,.5*A]},{command:"L",values:[A,.5*A]}]},stroke:h(B)});break;case "x":Q.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[A,A]},{command:"M",values:[A,
0]},{command:"L",values:[0,A]}]},stroke:h(B)});break;case "kite":Q.push({shape:{type:"path",path:[{command:"M",values:[0,.5*A]},{command:"L",values:[.5*A,0]},{command:"L",values:[A,.5*A]},{command:"L",values:[.5*A,A]},{command:"Z",values:[]}]},fill:C(B,0),stroke:n(B)})}break;case "object":switch(B.resource&&B.resource.primitive||a.defaultPrimitive){case "cone":var T=C(B,0);B=C(B,-.6);B=q(T,B,x?L:A);A=g.getConeShapes(A,x);Q.push({shape:A[0],fill:B});Q.push({shape:A[1],fill:B});break;case "inverted-cone":x=
C(B,0);B=C(B,-.6);B=q(x,B,A);A=g.getInvertedConeShapes(A);Q.push({shape:A[0],fill:B});Q.push({shape:A[1],fill:x});break;case "cube":A=g.getCubeShapes(A,x);Q.push({shape:A[0],fill:C(B,0)});Q.push({shape:A[1],fill:C(B,-.3)});Q.push({shape:A[2],fill:C(B,-.5)});break;case "cylinder":T=C(B,0);const W=C(B,-.6);T=q(T,W,x?L:A);A=g.getCylinderShapes(A,x);Q.push({shape:A[0],fill:T});Q.push({shape:A[1],fill:T});Q.push({shape:A[2],fill:C(B,0)});break;case "diamond":A=g.getDiamondShapes(A);Q.push({shape:A[0],
fill:C(B,-.3)});Q.push({shape:A[1],fill:C(B,0)});Q.push({shape:A[2],fill:C(B,-.3)});Q.push({shape:A[3],fill:C(B,-.7)});break;case "sphere":x=C(B,0);B=C(B,-.6);B=q(x,B);B.x1=0;B.y1=0;B.x2=.25*A;B.y2=.25*A;Q.push({shape:{type:"circle",cx:0,cy:0,r:.5*A},fill:B});break;case "tetrahedron":A=g.getTetrahedronShapes(A),Q.push({shape:A[0],fill:C(B,-.3)}),Q.push({shape:A[1],fill:C(B,0)}),Q.push({shape:A[2],fill:C(B,-.6)})}}return Q}function E(B){return(B="number"===typeof B?.size?B?.size:null)?z.pt2px(B):null}
function r(B,A){const x=E(A),Q=A?.maxSize?z.pt2px(A.maxSize):null,T=A?.disableUpsampling??!1,W=B.symbolLayers,aa=[];let Y=0,Z=0;const R=W.at(-1);let V;R&&"icon"===R.type&&(V=R.size&&z.pt2px(R.size));W.forEach(ba=>{if("icon"===ba.type||"object"===ba.type){var ea="icon"===ba.type?ba.size&&z.pt2px(ba.size):0,ha=x||ea?Math.ceil(Math.min(x||ea,Q||U)):S;if(ba&&ba.resource&&ba.resource.href){var la=p(B,ba).then(ia=>{const na=ba.get("material.color");var ma="icon"===ba.type?"multiply":"tint";return u.tintImageWithColor(ia,
ha,na,ma,T)}).then(ia=>{const na=ia.width,ma=ia.height;Y=Math.max(Y,na);Z=Math.max(Z,ma);return[{shape:{type:"image",x:0,y:0,width:na,height:ma,src:ia.url},fill:null,stroke:null}]});aa.push(la)}else la=ha,"icon"===ba.type&&V&&x&&(la=ea/V*ha),ea="tall"===A?.symbolConfig||A?.symbolConfig?.isTall||("object"===ba.type?H(ba):!1),Y=Math.max(Y,ea?L:la),Z=Math.max(Z,la),aa.push(Promise.resolve(N(ba,la,ea)))}});return P.eachAlways(aa).then(ba=>{const ea=[];ba.forEach(ha=>{ha.value?ea.push(ha.value):ha.error&&
F.getLogger("esri.symbols.support.previewSymbol3D").warn("error while building swatchInfo!",ha.error)});return u.renderSymbol(ea,[Y,Z],{node:A&&A.node,scale:!1,opacity:A&&A.opacity,ariaLabel:A?.ariaLabel})})}function I(B,A){const x=B.symbolLayers,Q=[];B=v.isVolumetricSymbol(B);const T=E(A),W=(A&&A.maxSize?z.pt2px(A.maxSize):null)||G;let aa=0,Y=0,Z;x.forEach((R,V)=>{if(R&&("line"===R.type||"path"===R.type)){var ba=[];switch(R.type){case "line":var ea=l(R,0);if(null==ea)break;var ha=ea&&ea.width||0;
0===V&&(Z=ha);R=Math.min(T||ha,W);V=0===V?R:T?ha/Z*R:R;ha=V>J/2?2*V:J;Y=Math.max(Y,V);aa=Math.max(aa,ha);ea.width=V;ba.push({shape:{type:"path",path:[{command:"M",values:[0,.5*Y]},{command:"L",values:[aa,.5*Y]}]},stroke:ea});break;case "path":ea=Math.min(T||S,W);V=C(R,0);ha=C(R,-.2);var la=d(R,-.4);la=la?{color:la,width:1}:{};if("quad"===R.profile){const ia=R.width;R=R.height;R=g.getPathSymbolShapes(ia&&R?ia/R:1,0===R,0===ia);la={...la,join:"bevel"};ba.push({shape:R[0],fill:ha,stroke:la});ba.push({shape:R[1],
fill:ha,stroke:la});ba.push({shape:R[2],fill:V,stroke:la})}else ba.push({shape:g.shapes.pathSymbol3DLayer[0],fill:ha,stroke:la}),ba.push({shape:g.shapes.pathSymbol3DLayer[1],fill:V,stroke:la});aa=Y=Math.max(Y,ea)}Q.push(ba)}});return Promise.resolve(u.renderSymbol(Q,[aa,Y],{node:A&&A.node,scale:B,opacity:A&&A.opacity,ariaLabel:A?.ariaLabel}))}async function M(B,A){const x="mesh-3d"===B.type;B=B.symbolLayers;var Q=E(A);const T=A&&A.maxSize?z.pt2px(A.maxSize):null;Q=Q||S;const W=[];let aa=0,Y=0;var Z=
!1;for(let la=0;la<B.length;la++){var R=B.at(la);const ia=[];if(!x||"fill"===R.type){var V=g.shapes.fill[0];switch(R.type){case "fill":var ba=n(R);Z=Math.min(Q,T||U);aa=Math.max(aa,Z);Y=Math.max(Y,Z);Z=!0;var ea=C(R,0),ha="pattern"in R?R.pattern:null;R=O(R);!x&&null!=ha&&"style"===ha.type&&"solid"!==ha.style&&R&&(ea=await f(ha,R));ia.push({shape:V,fill:ea,stroke:ba});break;case "line":R=l(R,0);if(null==R)break;R={stroke:R,shape:V};aa=Math.max(aa,S);Y=Math.max(Y,S);ia.push(R);break;case "extrude":V=
{join:"round",width:1,...l(R,-.4)};ba=C(R,0);R=C(R,-.2);ea=Math.min(Q,T||U);ha=g.getExtrudeSymbolShapes(ea);V.width=1;ia.push({shape:ha[0],fill:R,stroke:V});ia.push({shape:ha[1],fill:R,stroke:V});ia.push({shape:ha[2],fill:ba,stroke:V});R=.7*S+.5*ea;aa=Math.max(aa,S);Y=Math.max(Y,R);break;case "water":Z=K.unwrapOrThrow(O(R)),R=y(Z),V=y(Z,2),ba=y(Z,3),ea=g.getWaterSymbolShapes(),Z=!0,ia.push({shape:ea[0],fill:R}),ia.push({shape:ea[1],fill:V}),ia.push({shape:ea[2],fill:ba}),R=Math.min(Q,T||U),aa=Math.max(aa,
R),Y=Math.max(Y,R)}W.push(ia)}}return u.renderSymbol(W,[aa,Y],{node:A&&A.node,scale:Z,opacity:A&&A.opacity,ariaLabel:A?.ariaLabel})}const S=g.SymbolSizeDefaults.size,U=g.SymbolSizeDefaults.maxSize,G=g.SymbolSizeDefaults.maxOutlineSize,J=g.SymbolSizeDefaults.lineWidth,L=g.SymbolSizeDefaults.tallSymbolWidth;b.getPatternDescriptor=f;b.getSizeFromOptions=E;b.getSymbolLayerFill=C;b.previewSymbol3D=function(B,A){if(0===B.symbolLayers.length)return Promise.reject(new w("symbolPreview: renderPreviewHTML3D",
"No symbolLayers in the symbol."));switch(B.type){case "point-3d":return r(B,A);case "line-3d":return I(B,A);case "polygon-3d":case "mesh-3d":return M(B,A)}return Promise.reject(new w("symbolPreview: swatchInfo3D","symbol not supported."))};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/webStyleSymbolUtils":function(){define("exports ../../symbols ../../core/devEnvironmentUtils ../../core/Error ../../core/maybe ../../core/urlUtils ../../portal/Portal ../../chunks/persistableUrlUtils ./jsonUtils ./StyleOrigin ./styleUtils ./Thumbnail".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a){function g(k,n){return n.items.find(p=>p.name===k)}function u(k,n,p,y,O,C){const f=p&&null!=p.portal?p.portal:K.getDefault(),h={portal:f,url:F.urlToObject(k.baseUrl),origin:"portal-item"},d=g(n,k.data);if(!d)return Promise.reject(new m("symbolstyleutils:symbol-name-not-found",`The symbol name '${n}' could not be found`,{symbolName:n}));O=P.fromJSON(O(d,y),h);let l=d.thumbnail?.href??null;const q=d.thumbnail&&d.thumbnail.imageData;c.isDevEnvironment()&&(O=c.adjustStaticAGOUrl(O)??
"",l=c.adjustStaticAGOUrl(l));const H={portal:f,url:F.urlToObject(F.removeFile(O)),origin:"portal-item"};return D.requestJSON(O,C).then(N=>{N="cimRef"===y?D.makeCIMSymbolRef(N.data):N.data;if((N=z.fromJSON(N,H))&&e.isSymbol3D(N)){if(l){const E=P.fromJSON(l,h);N.thumbnail=new a.Thumbnail({url:E})}else q&&(N.thumbnail=new a.Thumbnail({url:`data:image/png;base64,${q}`}));k.styleUrl?N.styleOrigin=new t({portal:p.portal,styleUrl:k.styleUrl,name:n}):k.styleName&&(N.styleOrigin=new t({portal:p.portal,styleName:k.styleName,
name:n}))}return N})}function v(k,n,p){const y=D.Style2DUrlTemplate.replaceAll(/\{SymbolName\}/gi,k),O=null!=n.portal?n.portal:K.getDefault();return D.requestJSON(y,p).then(C=>{C=D.makeCIMSymbolRef(C.data);return z.fromJSON(C,{portal:O,url:F.urlToObject(F.removeFile(y)),origin:"portal-item"})})}b.fetchSymbolFromStyle=u;b.getStyleItemFromStyle=g;b.resolveWebStyleSymbol=function(k,n,p,y){const O=k.name;return null==O?Promise.reject(new m("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):
k.styleName&&"Esri2DPointSymbolsStyle"===k.styleName?v(O,n,y):D.fetchStyle(k,n,y).then(C=>u(w.unwrapOrThrow(C),O,n,p,D.symbolUrlFromStyleItem,y))};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/devEnvironmentUtils":function(){define(["exports"],function(b){const e=/^devext.arcgis.com$/,c=/^qaext.arcgis.com$/,m=/^[\w-]*\.mapsdevext.arcgis.com$/,w=/^[\w-]*\.mapsqa.arcgis.com$/,F=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,e,c,/^jsapps.esri.com$/,m,w];b.adjustStaticAGOUrl=
function(K,P){return K?(P=P||globalThis.location.hostname)?null!=P.match(e)||null!=P.match(m)?K.replace("static.arcgis.com","staticdev.arcgis.com"):null!=P.match(c)||null!=P.match(w)?K.replace("static.arcgis.com","staticqa.arcgis.com"):K:K:K};b.isDevEnvironment=function(K){K=K||globalThis.location.hostname;return F.some(P=>null!=K?.match(P))};b.isTelemetryDevEnvironment=function(K){K=K||globalThis.location.hostname;return[/^zrh-.+?\.esri\.com$/].concat(F).some(P=>null!=K?.match(P))};Object.defineProperty(b,
Symbol.toStringTag,{value:"Module"})})},"esri/widgets/FeatureTemplates/TemplateItemGroup":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Identifiable ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),function(b,e,c,m,w,F,K,P,z){c=function(t){function D(a){a=t.call(this,a)||this;a.items=null;a.label=null;
return a}b._inherits(D,t);D.prototype.findByTemplate=function(a){return this.items.find(g=>g.template===a)};b._createClass(D,[{key:"id",get:function(){return this.label}}]);return D}(m.IdentifiableMixin(c));e.__decorate([w.property()],c.prototype,"items",void 0);e.__decorate([w.property()],c.prototype,"label",void 0);e.__decorate([w.property()],c.prototype,"id",null);return c=e.__decorate([z.subclass("esri.widgets.FeatureTemplates.TemplateItemGroup")],c)})},"esri/widgets/FeatureTemplates/ItemList":function(){define(["exports",
"../support/Heading","../support/widgetUtils","../support/jsxFactory"],function(b,e,c,m){function w(t){const {headingLevel:D,items:a,...g}=t;return 0===a.length?m.tsx("div",{class:z.noMatchesMessage,key:"no-matches"},t.messages.noMatches):m.tsx("div",{class:c.classes({[z.scroller]:!0,[z.scrollerEnabled]:!!t.enableListScroll}),key:"item-container"},a.map(u=>u.items?P({...g,group:u,headingLevel:D}):K({...g,grouped:!0,item:u})))}function F(t){const {messages:D,filterText:a,enableListScroll:g}=t;return m.tsx("div",
{key:"filter",class:g?void 0:z.filterContainerSticky},m.tsx("calcite-input",{onCalciteInputInput:u=>{u=u.currentTarget;t.onFilterChange&&t.onFilterChange(u.value)},placeholder:D.filterPlaceholder,value:a,type:"search"}))}function K(t){const {grouped:D,identify:a,item:g,onItemMouseEnter:u,onItemMouseLeave:v,onItemSelect:k,renderIcon:n,renderCustomItem:p,renderItemContent:y,renderItemContentEnd:O,renderItemLabel:C,renderItemDescription:f,selectedItem:h}=t,d=g?`${a?.(g)||g.id}__${g.label}`:"";var l=
h?`${a?.(h)||h.id}__${h.label}`:"";const q=d===l;if(t=p?.(t))return t;t=y?.(g);l=O?.(g);return m.tsx("calcite-list-item",{"aria-level":D?"2":"",class:z.item,"data-item":g,key:d,label:t?void 0:C?.(g)??g.label??void 0,description:t?void 0:f?.(g)??void 0,selected:q,tabIndex:0,afterUpdate:H=>{H.selected=q},onCalciteListItemSelect:H=>{H.preventDefault();k?.(H.currentTarget["data-item"])},onmouseenter:H=>u?.(H.currentTarget["data-item"]),onmouseleave:H=>v?.(H.currentTarget["data-item"])},m.tsx("div",{key:"content-start",
class:z.itemIcon,slot:"content-start"},n?.(g)),t?m.tsx("div",{key:"content",slot:"content"},t):null,l?m.tsx("div",{key:"content-end",class:z.itemContentEnd,slot:"content-end"},l):null)}function P(t){const {group:D,headingLevel:a=4,selectionMode:g="none",renderCustomGroupContent:u,...v}=t;t=u?.(t);return m.tsx("div",{class:z.group,key:D.label??void 0},m.tsx(e.Heading,{level:a,class:z.groupHeader},D.label),t||m.tsx("calcite-list",{selectionMode:g,selectionAppearance:"border"},D.items.map(k=>K({...v,
item:k,grouped:!0}))))}const z={base:"esri-item-list",group:"esri-item-list__group",scroller:"esri-item-list__scroller",scrollerEnabled:"esri-item-list__scroller--enabled",groupHeader:"esri-item-list__group__header",item:"esri-item-list__list-item",itemIcon:"esri-item-list__list-item-icon",itemContentEnd:"esri-item-list__list-item-content-end",noMatchesMessage:"esri-item-list__no-matches-message",filterContainerSticky:"esri-item-list__filter-container--sticky"};b.ItemList=function(t){const {filterText:D=
"",id:a,messages:g,onFilterChange:u,...v}=t;return m.tsx("div",{key:a},t.filterEnabled??!0?F({filterText:D,id:a,messages:g,onFilterChange:u}):null,w({...v,enableListScroll:t.enableListScroll??!0,filterText:D,messages:g}))};b.renderGroup=P;b.renderItem=K;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Spinner":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/promiseUtils ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./Spinner/SpinnerViewModel ./support/widgetUtils ./support/jsxFactory".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a,g){F=function(u){function v(n,p){n=u.call(this,n,p)||this;n._animationDelay=500;n._animationPromise=null;n.viewModel=new D;return n}b._inherits(v,u);var k=v.prototype;k.initialize=function(){this.addHandles(m.watch(()=>this.visible,n=>this._visibleChange(n)))};k.destroy=function(){this._animationPromise=null};k.show=function(n){const {location:p,promise:y}=n??{};p&&(this.viewModel.location=p);this.visible=!0;n=()=>this.hide();y&&y.catch(()=>{}).then(n)};k.hide=function(){this.visible=
!1};k.render=function(){var {visible:n}=this,{screenLocation:p}=this.viewModel;p=!!p;n={["esri-spinner--start"]:n&&p,["esri-spinner--finish"]:!n&&p};p=this._getPositionStyles();return g.tsx("div",{class:this.classes("esri-spinner",n),styles:p})};k._visibleChange=function(n){if(n)this.viewModel.screenLocationEnabled=!0;else{var p=c.after(this._animationDelay);this._animationPromise=p;p.catch(()=>{}).then(()=>{this._animationPromise===p&&(this.viewModel.screenLocationEnabled=!1,this._animationPromise=
null)})}};k._getPositionStyles=function(){const {screenLocation:n,view:p}=this.viewModel;if(null==p||null==n)return{};const {padding:y}=p;return{left:`${n.x-y.left}px`,top:`${n.y-y.top}px`}};b._createClass(v,[{key:"location",get:function(){return this.viewModel.location},set:function(n){this.viewModel.location=n}},{key:"view",get:function(){return this.viewModel.view},set:function(n){this.viewModel.view=n}},{key:"visible",get:function(){return this.viewModel.visible},set:function(n){this.viewModel.visible=
n}}]);return v}(t);e.__decorate([w.property()],F.prototype,"location",null);e.__decorate([w.property()],F.prototype,"view",null);e.__decorate([w.property({type:D})],F.prototype,"viewModel",void 0);e.__decorate([w.property()],F.prototype,"visible",null);return F=e.__decorate([z.subclass("esri.widgets.Spinner")],F)})},"esri/widgets/Spinner/SpinnerViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../support/AnchorElementViewModel".split(" "),
function(b,e,c,m,w,F,K,P){m=function(z){function t(D){D=z.call(this,D)||this;D.visible=!1;return D}b._inherits(t,z);return b._createClass(t)}(P);e.__decorate([c.property()],m.prototype,"visible",void 0);return m=e.__decorate([K.subclass("esri.widgets.CompassViewModel")],m)})},"esri/widgets/support/AnchorElementViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Evented ../../core/Handles ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D){const a=Symbol("anchorHandles");c=function(u){function v(k){var n=u.call(this,k)||this;n[g]=new m;n.location=null;n.screenLocationEnabled=!1;n.view=null;n[a].add([F.when(()=>w.applySome(n.screenLocationEnabled?n.view:null,p=>[p.size,"3d"===p.type?p.camera:p.viewpoint]),()=>n.notifyChange("screenLocation")),F.watch(()=>n.screenLocation,(p,y)=>{null!=p&&null!=y&&n.emit("view-change")})]);return n}b._inherits(v,u);v.prototype.destroy=function(){this.view=null;this[a]=
w.destroyMaybe(this[a])};b._createClass(v,[{key:"screenLocation",get:function(){const {location:k,view:n,screenLocationEnabled:p}=this;return p&&null!=k&&null!=n&&n.ready?n.toScreen?.(k):null}}]);return v}(c.EventedAccessor);var g=a;e.__decorate([K.property()],c.prototype,"location",void 0);e.__decorate([K.property()],c.prototype,"screenLocation",null);e.__decorate([K.property()],c.prototype,"screenLocationEnabled",void 0);e.__decorate([K.property()],c.prototype,"view",void 0);return c=e.__decorate([D.subclass("esri.widgets.support.AnchorElementViewModel")],
c)})},"esri/widgets/Editor/deprecationUtils":function(){define(["exports","../../core/deprecate"],function(b,e){b.workflowDeprecation=function(c,m,w){e.deprecated(c,"`"+m+"` is deprecated, because it instantiates the deprecated class 'esri.widgets.Editor.CreateWorkflow'",{replacement:w,version:"4.23",see:"https://developers.arcgis.com/javascript/latest/api-reference/esri-widgets-Editor-CreateFeaturesWorkflow.html"})};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/EditorViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/asyncUtils ../../core/Collection ../../core/deprecate ../../core/Error ../../core/Evented ../../core/HandleOwner ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../layers/GraphicsLayer ../../layers/support/editableLayers ../../layers/support/layerUtils ../../portal/support/urlUtils ../Attachments/AttachmentsViewModel ./CreateFeaturesWorkflow ./CreateWorkflow ./deprecationUtils ./UpdateWorkflow ./workflowUtils ../FeatureForm/featureFormUtils ../FeatureForm/FeatureFormViewModel ../FeatureTemplates/FeatureTemplatesViewModel ../Sketch/SketchViewModel ../Spinner/SpinnerViewModel".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a,g,u,v,k,n,p,y,O,C,f,h,d,l,q,H,N,E,r,I,M){function S(L,B,A){G.error(new F(L,B,A))}function U(L,B){return L?L.find(A=>A.layer===B):void 0}const G=z.getLogger("esri.widgets.Editor.EditorViewModel"),J=["create","create-features","update"];K=function(L){function B(x){var Q=L.call(this,x)||this;Q._editableItems=new m;Q._sketchGraphicsLayer=new p({listMode:"hide",internal:!0});Q._updateEditableItemsTask=null;Q.activeWorkflow=null;Q._activityQueue=[];Q.failures=[];Q.attachmentsViewModel=
new f({capabilities:{editing:!0}});Q.featureFormViewModel=new E;Q.featureTemplatesViewModel=new r;Q.sketchViewModel=new I({layer:Q._sketchGraphicsLayer});Q.spinnerViewModel=new M;Q.pageStack=[];Q.showDiscardEditsPrompt=()=>Promise.resolve(!0);Q._candidateCommitted=!1;Q.useDeprecatedCreateWorkflow=!1;Q.back=async()=>{Q.canGoBack&&(Q.activeWorkflow?.hasPreviousStep?await Q.activeWorkflow.back(Q.showDiscardEditsPrompt):await Q._cancelWorkflow({force:!Q.hasPendingEdits}))};Q.saveWorkflow=async()=>{const {featureFormViewModel:T}=
b._assertThisInitialized(Q);T.submit();if(T.submittable){var W=T.getValues();0<T.validateContingencyConstraints(W,{includeIncompleteViolations:!0}).length||await Q.activeWorkflow?.save()}};Q.selectFeature=(T,W=!1)=>{const aa=Q.activeWorkflow;Q._candidateCommitted||"update"!==aa?.type||(aa.data.rootFeature=T,W&&(aa.next(),Q._candidateCommitted=!0))};return Q}b._inherits(B,L);var A=B.prototype;A.initialize=function(){this.addHandles([a.watch(()=>{const x=this.view?.map?.editableLayers.filter(({parent:T,
visible:W})=>T&&"visible"in T?W&&T.visible:W),Q=this.view?.allLayerViews?.filter(T=>!!x?.includes(T.layer)&&!T.suspended);return[x,Q,this.layerInfos,this.allowedWorkflows]},()=>this._updateEditableItems(),a.initial),a.on(()=>this.activeWorkflow,"cancel",()=>this.emit("workflow-cancel")),a.on(()=>this.activeWorkflow,"commit",()=>this.emit("workflow-commit")),a.on(()=>this.activeWorkflow,"complete",()=>{this.emit("workflow-commit");this._set("activeWorkflow",null)}),a.when(()=>this.view?.map,x=>x.add(this._sketchGraphicsLayer),
a.initial),a.watch(()=>this._editableItems.toArray(),()=>{const {activeWorkflow:x}=this;this.refreshCreationTemplates();if(x){var {stepId:Q}=x;"create"===x.type?"awaiting-feature-creation-info"!==Q||this.canCreate||this._cancelWorkflow():"update"===x.type&&("awaiting-feature-to-update"===Q&&!this.canUpdate||"awaiting-update-feature-candidate"===Q&&!x.data.candidates.some(T=>{const W=this._editableItems.find(aa=>aa.layer===T.layer);return W&&W.supports.includes("update")}))&&this._cancelWorkflow()}}),
a.watch(()=>this.page,(x,Q)=>{const T=this.pageStack.slice();x=T.indexOf(x);-1===x&&Q?T.push(Q):T.splice(x);this.pageStack=T}),a.when(()=>"awaiting-update-feature-candidate"===this.state,()=>this._candidateCommitted=!1),a.on(()=>this.featureTemplatesViewModel,"select",async({item:x,oldItem:Q})=>{const {activeWorkflow:T}=this,W=!!x&&x.id===Q?.id,aa="create-features"===T?.type&&T.data.upload?.error;if(T)try{await this.cancelWorkflow({force:!this.hasPendingEdits})}catch{return this.featureTemplatesViewModel.select(Q,
{emit:!1})}if(x&&(!W||aa)){Q={layer:x.layer,template:x.template};if(x.supportsUpload)return this.startCreateFeaturesWorkflow(Q);this.useDeprecatedCreateWorkflow?this.startCreateWorkflowAtFeatureCreation(Q):this.startCreateFeaturesWorkflowAtFeatureCreation(Q)}}),a.on(()=>this.view,"key-down",x=>{"Escape"===x.key&&this.activeWorkflow?.keyboardCancellationEnabled&&this.back()})])};A.destroy=function(){this._cancelWorkflow().then(()=>{this.view?.map&&this.view.map.remove(this._sketchGraphicsLayer);this.view=
null});this._updateEditableItemsTask=t.abortMaybe(this._updateEditableItemsTask)};A.startCreateWorkflowAtFeatureTypeSelection=async function(){l.workflowDeprecation(G,"startCreateWorkflowAtFeatureTypeSelection","startCreateFeaturesWorkflowAtFeatureTypeSelection");await a.whenOnce(()=>!this.updating);if(this.canCreate){await this._cancelWorkflow();var x=this._createCreateWorkflow();await x.start();this._set("activeWorkflow",x)}else S("editing:unsupported-workflow","Create workflow is unsupported or disabled.")};
A.startCreateFeaturesWorkflowAtFeatureTypeSelection=async function(){return this.startCreateFeaturesWorkflow()};A.startCreateWorkflowAtFeatureCreation=async function(x){l.workflowDeprecation(G,"startCreateWorkflowAtFeatureCreation","startCreateFeaturesWorkflowAtFeatureCreation");await a.whenOnce(()=>!this.updating);if(this.canCreate){await this._cancelWorkflow();var Q=this._createCreateWorkflow("awaiting-feature-to-create");Q.data.creationInfo=x;await Q.start();this._set("activeWorkflow",Q)}else S("editing:unsupported-workflow",
"Create workflow is unsupported or disabled.")};A.startCreateFeaturesWorkflowAtFeatureCreation=async function(x){return this.startCreateFeaturesWorkflow(x,"creating-features")};A.startCreateFeaturesWorkflow=async function(x,Q="awaiting-feature-creation-info"){await a.whenOnce(()=>!this.updating);if(!this.canCreate)throw new F("editing:unsupported-workflow","Creating features is unsupported or disabled.");await this._cancelWorkflow();x=this._createCreateFeaturesWorkflow(x,Q);await x.start();this._set("activeWorkflow",
x)};A.startCreateWorkflowAtFeatureEdit=async function(x){l.workflowDeprecation(G,"startCreateWorkflowAtFeatureEdit");await a.whenOnce(()=>!this.updating);if(this.canCreate){await this._cancelWorkflow();var Q=this._createCreateWorkflow("editing-new-feature");Q.data.edits.feature=x;await Q.start();this._set("activeWorkflow",Q)}else S("editing:unsupported-workflow","Create workflow is unsupported or disabled.")};A.startUpdateWorkflowAtFeatureSelection=async function(){await a.whenOnce(()=>!this.updating);
if(this.canUpdate){await this._cancelWorkflow();var x=this._createUpdateWorkflow();await x.start();this._set("activeWorkflow",x)}else S("editing:unsupported-workflow","Update workflow is unsupported or disabled.")};A.startUpdateWorkflowAtMultipleFeatureSelection=async function(x){await a.whenOnce(()=>!this.updating);if(this.canUpdate){await this._cancelWorkflow();var Q=this._createUpdateWorkflow("awaiting-update-feature-candidate");Q.data.candidates=x;await Q.start();this._set("activeWorkflow",Q)}else S("editing:unsupported-workflow",
"Update workflow is unsupported or disabled.")};A.startUpdateWorkflowAtFeatureEdit=async function(x){await a.whenOnce(()=>!this.updating);if(this.canUpdate){await this._cancelWorkflow();var Q=this._createUpdateWorkflow("editing-existing-feature");Q.data.rootFeature=x;await Q.start();this._set("activeWorkflow",Q)}else S("editing:unsupported-workflow","Update workflow is unsupported or disabled.")};A.deleteFeatureFromWorkflow=async function(){const {activeWorkflow:x}=this;x&&"update"===x.type?await x.deleteActiveFeature():
S("editing:unsupported-workflow","Deleting requires an active update workflow.")};A.cancelWorkflow=async function(x){return this._cancelWorkflow({warn:!0,...x})};A.findEditableItemForLayer=function(x){const Q="subtype-sublayer"===x.type?x.parent:x;return this._editableItems.find(T=>T.layer===Q)};A.itemHasInvalidFormTemplate=function(x){return x?this.findEditableItemForLayer(x.layer)?.hasInvalidFormTemplate??!1:!1};A.itemHasUnsupportedFields=function(x){return x?this.findEditableItemForLayer(x.layer)?.hasUnsupportedFields??
!1:!1};A.refreshCreationTemplates=function(){const x=[];for(const {layer:Q,supports:T}of this._editableItems)Q.loaded&&T.includes("create")&&x.push(Q);this.featureTemplatesViewModel.layers=x};A.toggleUpdateWorkflow=async function(){!this.canUpdate||this.hasPendingEdits&&!await this.showDiscardEditsPrompt()||(this.activeWorkflow&&"awaiting-feature-to-update"===this.state?await this.cancelWorkflow({force:!0}):await this.startUpdateWorkflowAtFeatureSelection())};A._updateEditableItems=async function(){t.abortMaybe(this._updateEditableItemsTask);
const x=c.createTask(async Q=>{const T=this.view?.allLayerViews;var W=this.view?.map,aa=W?.editableLayers.toArray()??[];W=W?.allTables.toArray().filter(O.isFeatureLayer)??[];await Promise.all(W.map(Z=>Z.load()));W=W.filter(Z=>y.isEditableLayer(Z));var Y=[...aa.reverse(),...W.reverse()].filter(Z=>"mesh"===Z.geometryType?"3d"===this.view?.type:!0);if(T&&aa){aa=[];W=[];for(const Z of Y){const R=(Y=T.find(V=>V.layer===Z))?aa:W;if("subtype-group"===Z.type){await Z.loadAll();D.throwIfAborted(Q);for(let V=
Z.sublayers.length-1;0<=V;--V)R.push(this._makeEditableItemForLayer(Z.sublayers.at(V),!!Y?.suspended))}else R.push(this._makeEditableItemForLayer(Z,!!Y?.suspended))}Q.aborted||(Q=this._editableItems,this._editableItems=new m(aa.concat(W)),Q.destroy())}});this.updatingHandles.addPromise(x.promise);this._updateEditableItemsTask=x};A._cancelWorkflow=async function(x){const Q=this.activeWorkflow;Q?x&&!1===x.force?(await Q.cancel(x),this._set("activeWorkflow",null)):(this.emit("workflow-cancel"),this._set("activeWorkflow",
null),await Q.cancel(x)):x&&x.warn&&S("editing:no-active-workflow","There is no active workflow to cancel.")};A._createCreateFeaturesWorkflow=function(x,Q){return h.create({viewModel:this,creationInfo:x,startAt:Q,applyEditsCallback:(T,W,aa)=>this._applyEdits(T,W,aa),addAttachmentsCallback:(T,W)=>this._addAttachments(T,W)})};A._createCreateWorkflow=function(x){return d.create(this,x,(Q,T,W)=>this._applyEdits(Q,T,W))};A._createUpdateWorkflow=function(x){return q.create(this,x,(Q,T)=>this._applyEdits(Q,
T))};A._addAttachments=function(x,Q){Q=Q.map(T=>this._addAttachment(x,T.feature,T.attachment))??[];return Promise.all(Q)};A._addAttachment=async function(x,Q,T){let W=null;if("geojson"===x.type||"scene"===x.type||"oriented-imagery"===x.type)throw new F("editor:attachments-not-supported","Adding attachments is not supported for this layer type");await this._queueOperation(async()=>W=await x.addAttachment?.(Q,T).catch(aa=>{throw aa?.error||aa;})??null);return W};A._applyEdits=async function(x,Q,T){let W=
null;const aa=x.url?await O.getOwningPortalUrl(x.url):null,Y={returnServiceEditsOption:aa&&C.parseKnownArcGISOnlineDomain(aa)||RegExp("/hosted/","i").test(x.url)?void 0:"original-and-current-features",...T};await this._queueOperation(async()=>{const Z=await H.whenEditorLayerView(this.view,x).catch(()=>null);W=await x.applyEdits(Q,Y);Z&&await a.whenOnce(()=>!Z.updating);return W});return W};A._queueOperation=function(x){this._activityQueue.push(x);this.notifyChange("syncing");const Q=(T,W)=>{T=W.indexOf(T);
-1<T&&W.splice(T,1)};return x().then(T=>{if("error"in T&&T.error)throw T.error;if("addFeatureResults"in T){const {addFeatureResults:W,deleteFeatureResults:aa,updateFeatureResults:Y}=T,Z=W.find(R=>!!R.error)||Y.find(R=>!!R.error)||aa.find(R=>!!R.error);if(Z)throw Z.error;}return T}).catch(T=>{S("editing:operation-error","An error occurred.",{error:T});const W={error:T,retry:()=>{Q(W,this.failures);return this._queueOperation(x)},cancel:()=>{Q(W,this.failures)}};this._set("failures",[...this.failures,
W])}).then(()=>{Q(x,this._activityQueue);this.notifyChange("syncing")})};A._makeEditableItemForLayer=function(x,Q=!0){const T=O.getEffectiveLayerCapabilities(x);var W=T?.operations;const aa=U(this.layerInfos,x),Y=N.formTemplateHasInvalidFields(x),Z=x.fields.some(({type:la})=>N.unsupportedDateFieldTypes.has(la)),R=Y||Z;var {allowedWorkflows:V}=this;const ba=V.includes("create")||V.includes("create-features");var ea=V.includes("update");const ha=ba&&!!W?.supportsAdd&&(!aa||!1!==aa.enabled&&!1!==aa.addEnabled);
V=ea&&!!W?.supportsUpdate&&(!aa||!1!==aa.enabled&&!1!==aa.updateEnabled);ea=!R&&ea&&!!W?.supportsDelete&&(!aa||!1!==aa.enabled&&!1!==aa.deleteEnabled);W=[];Q||(ha&&W.push("create"),V&&W.push("update"),ea&&W.push("delete"));Q=!!T?.data?.supportsAttachment&&(!aa||!1!==aa.allowAttachments);return{layer:x,supports:W,attributeUpdatesEnabled:V&&!R&&(!aa||!1!==aa.attributeUpdatesEnabled),geometryUpdatesEnabled:V&&!R&&!!T?.editing?.supportsGeometryUpdate&&(!aa||!1!==aa.geometryUpdatesEnabled),hasAttachments:Q,
attachmentsOnCreateEnabled:Q&&ba&&(!aa||!1!==aa.attachmentsOnCreateEnabled),attachmentsOnUpdateEnabled:!R&&Q&&(!aa||!1!==aa.attachmentsOnUpdateEnabled),hasInvalidFormTemplate:Y,hasUnsupportedFields:Z}};b._createClass(B,[{key:"allowedWorkflows",get:function(){return this._get("allowedWorkflows")},set:function(x){x&&0!==x.length||(x=[...J]);this._set("allowedWorkflows",x)}},{key:"canCreate",get:function(){return this._editableItems.some(x=>x.supports.includes("create"))}},{key:"canUpdate",get:function(){return this._editableItems.some(({attachmentsOnUpdateEnabled:x,
layer:Q,supports:T})=>{x=T.includes("update")||T.includes("delete")||x;T=Q.parent;T=!(T&&"visible"in T)||!!T.visible;return Q.visible&&T&&x})}},{key:"editableItems",get:function(){return this._editableItems}},{key:"labelOptions",get:function(){return this.sketchViewModel.labelOptions},set:function(x){this.sketchViewModel.labelOptions=x}},{key:"layerInfos",set:function(x){x?.some(Q=>{"allowAttachments"in Q&&w.deprecated(G,"Property: layerInfo.allowAttachments",{replacement:"layerInfo.attachmentsOnCreateEnabled or layerInfo.attachmentsOnUpdateEnabled",
version:"4.26"});return!0});this._set("layerInfos",x)}},{key:"snappingOptions",get:function(){return this.sketchViewModel.snappingOptions},set:function(x){this.sketchViewModel.snappingOptions=x}},{key:"state",get:function(){if(!this.get("view.ready")||0===this._editableItems.length)return"disabled";var x=this.attachmentsViewModel.mode;if("add"===x)return"adding-attachment";if("edit"===x)return"editing-attachment";({activeWorkflow:x}=this);return x?x.stepId:"ready"}},{key:"syncing",get:function(){return 0<
this._activityQueue.length}},{key:"updating",get:function(){return this.updatingHandles.updating}},{key:"tooltipOptions",get:function(){return this.sketchViewModel.tooltipOptions},set:function(x){this.sketchViewModel.tooltipOptions=x}},{key:"view",set:function(x){this.sketchViewModel.view=x;this.spinnerViewModel.view=x;this._set("view",x)}},{key:"page",get:function(){const {activeWorkflow:x,state:Q}=this;return"awaiting-feature-to-update"===Q||"awaiting-feature-to-create"===Q||"create-features"===
x?.type&&0===x.numPendingFeatures?"ready":Q??"disabled"}},{key:"selectedTemplateItem",get:function(){var {activeWorkflow:x}=this;if("create-features"===x?.type&&0===x.numPendingFeatures&&(x=x.data.creationInfo?.template))for(const Q of this.featureTemplatesViewModel.items)if("findByTemplate"in Q){const T=Q.findByTemplate(x);if(T)return T}else if(Q.template===x)return Q}},{key:"featureFormDisabled",get:function(){const {activeWorkflow:x}=this;return"update"===x?.type&&!1===x.activeEditableItem?.attributeUpdatesEnabled}},
{key:"canGoBack",get:function(){return null!=this.activeWorkflow&&!this.syncing}},{key:"shouldShowDeleteButton",get:function(){const {activeWorkflow:x}=this;return!!x&&"update"===x.type&&!!x.activeEditableItem?.supports.includes("delete")}},{key:"hasPendingEdits",get:function(){return this.activeWorkflow?.hasPendingEdits??!1}}]);return B}(P.HandleOwnerMixin(K.EventedAccessor));e.__decorate([g.property()],K.prototype,"_editableItems",void 0);e.__decorate([g.property({readOnly:!0})],K.prototype,"activeWorkflow",
void 0);e.__decorate([g.property({readOnly:!0})],K.prototype,"_activityQueue",void 0);e.__decorate([g.property({value:[...J]})],K.prototype,"allowedWorkflows",null);e.__decorate([g.property({readOnly:!0})],K.prototype,"canCreate",null);e.__decorate([g.property({readOnly:!0})],K.prototype,"canUpdate",null);e.__decorate([g.property()],K.prototype,"editableItems",null);e.__decorate([g.property({readOnly:!0})],K.prototype,"failures",void 0);e.__decorate([g.property()],K.prototype,"attachmentsViewModel",
void 0);e.__decorate([g.property()],K.prototype,"featureFormViewModel",void 0);e.__decorate([g.property()],K.prototype,"featureTemplatesViewModel",void 0);e.__decorate([g.property()],K.prototype,"labelOptions",null);e.__decorate([g.property()],K.prototype,"layerInfos",null);e.__decorate([g.property()],K.prototype,"sketchViewModel",void 0);e.__decorate([g.property()],K.prototype,"snappingOptions",null);e.__decorate([g.property()],K.prototype,"spinnerViewModel",void 0);e.__decorate([g.property()],K.prototype,
"state",null);e.__decorate([g.property({readOnly:!0})],K.prototype,"syncing",null);e.__decorate([g.property()],K.prototype,"updating",null);e.__decorate([g.property()],K.prototype,"tooltipOptions",null);e.__decorate([g.property()],K.prototype,"view",null);e.__decorate([g.property()],K.prototype,"pageStack",void 0);e.__decorate([g.property()],K.prototype,"showDiscardEditsPrompt",void 0);e.__decorate([g.property()],K.prototype,"_candidateCommitted",void 0);e.__decorate([g.property()],K.prototype,"page",
null);e.__decorate([g.property()],K.prototype,"selectedTemplateItem",null);e.__decorate([g.property()],K.prototype,"featureFormDisabled",null);e.__decorate([g.property()],K.prototype,"canGoBack",null);e.__decorate([g.property()],K.prototype,"shouldShowDeleteButton",null);e.__decorate([g.property()],K.prototype,"hasPendingEdits",null);e.__decorate([g.property()],K.prototype,"useDeprecatedCreateWorkflow",void 0);return K=e.__decorate([n.subclass("esri.widgets.Editor.EditorViewModel")],K)})},"esri/layers/GraphicsLayer":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ../core/support/OwningCollection ./Layer ./mixins/BlendLayer ./mixins/ScaleRangeLayer ../support/GraphicsCollection ../symbols/support/ElevationInfo".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a,g){m=function(u){function v(n){n=u.call(this,n)||this;n.elevationInfo=null;n.graphics=new a.GraphicsCollection;n.screenSizePerspectiveEnabled=!0;n.type="graphics";n.internal=!1;return n}b._inherits(v,u);var k=v.prototype;k.destroy=function(){this.removeAll();this.graphics.destroy()};k.add=function(n){this.graphics.add(n);return this};k.addMany=function(n){this.graphics.addMany(n);return this};k.removeAll=function(){this.graphics.removeAll();return this};k.remove=function(n){this.graphics.remove(n)};
k.removeMany=function(n){this.graphics.removeMany(n)};k.on=function(n,p){return b._get(b._getPrototypeOf(v.prototype),"on",this).call(this,n,p)};k.graphicChanged=function(n){this.emit("graphic-update",n)};return b._createClass(v)}(t.BlendLayer(D.ScaleRangeLayer(z)));e.__decorate([c.property({type:g})],m.prototype,"elevationInfo",void 0);e.__decorate([c.property(P.owningCollectionProperty(a.GraphicsCollection,"graphics"))],m.prototype,"graphics",void 0);e.__decorate([c.property({type:["show","hide"]})],
m.prototype,"listMode",void 0);e.__decorate([c.property()],m.prototype,"screenSizePerspectiveEnabled",void 0);e.__decorate([c.property({readOnly:!0})],m.prototype,"type",void 0);e.__decorate([c.property({constructOnly:!0})],m.prototype,"internal",void 0);return m=e.__decorate([K.subclass("esri.layers.GraphicsLayer")],m)})},"esri/widgets/Editor/CreateFeaturesWorkflow":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/arrayUtils ../../core/handleUtils ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/uuid ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/has ../../core/accessorSupport/decorators/subclass ../../layers/support/layerUtils ../../views/draw/support/helpMessageUtils ../../views/interactive/snapping/FeatureSnappingLayerSource ./CreateFeaturesWorkflowData ./modelUploadUtils ./Workflow ./workflowUtils".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a,g,u,v,k,n,p,y){function O(q,H){let N=null;const E=()=>{null!=N&&(q.snappingOptions.featureSources.remove(N),N=w.destroyMaybe(N))};return m.handlesGroup([K.watch(()=>{const r=H.creationInfo?.layer,I=q.snappingOptions.featureSources.find(M=>M.layer===r);return{hasFeatureLayerSource:!!I,enabled:I?.enabled??!1}},({hasFeatureLayerSource:r,enabled:I})=>{if(r)null==N&&(N=new v({layer:q.layer}),q.snappingOptions.featureSources.add(N)),N.enabled=I;else return E()},K.syncAndInitial),
m.makeHandle(E)])}function C(q,H,N,E){const r=[];H.forEach((I,M)=>{if(!I.error){const S=q[M];M=E.get(S)||[];S.attributes[N.objectIdField]=I.objectId;M.forEach(({form:U})=>r.push({feature:S,attachment:U}))}});return r}function f(q,H,N){const E=[],r=H.globalIdField;q.forEach((I,M)=>{var S;(S=q[M].attributes)[r]??(S[r]=P.generateBracedUUID());(N?.get(I)||[]).forEach(({file:U})=>E.push({feature:I,attachment:{globalId:P.generateBracedUUID(),data:U}}))});return E.length?{addFeatures:q,addAttachments:E}:
{addFeatures:q}}var h;const d=Symbol(),l=Symbol();t=h=function(q){function H(E){E=q.call(this,E)||this;E.type="create-features";E.createFeatureState="create-new";E._featureFormHandle=null;E._visualVariableAttributes={rotation:null,size:null};E._attachmentFileInfos=new Map;E._highlightHandles=new Map;E._preventDefaultActionOnCancel=!1;E._lastActiveGraphics=[];return E}b._inherits(H,q);var N=H.prototype;N.enter=async function(){const {featureFormViewModel:E}=this.data.viewModel,r=E.relatedRecordCallbacks;
E.relatedRecordCallbacks=null;this.addHandles(m.makeHandle(()=>{E.relatedRecordCallbacks=r}),l)};N.exit=function(){this.removeHandles(l)};N.updatePendingFeature=async function(E,r){this._preventDefaultActionOnCancel=!0;this.data.viewModel.sketchViewModel.cancel();c.remove(this._lastActiveGraphics,E);return this._startUpdating(E,r)};H.create=function(E){const {addAttachmentsCallback:r,applyEditsCallback:I,creationInfo:M,startAt:S,viewModel:U}=E,G=new h({data:new k.CreateFeaturesWorkflowData({creationInfo:M,
viewModel:U}),onCommit:async J=>{var {creationInfo:L}=J;if(L){L.geometryToPlace&&(J.creationInfo=null);J=J.pendingFeatures.toArray();({layer:L}=L);var B=G._attachmentFileInfos;if(L.capabilities?.editing.supportsGlobalId&&"globalIdField"in L)J=f(J,L,B),await I(L,J,{globalIdUsed:!0});else{var A=await I(L,{addFeatures:J});0<B.size&&await r(L,C(J,A?.addFeatureResults??[],L,B))}}}});G._set("steps",this._createWorkflowSteps(G,S));return G};N._fadeExistingFeatures=function(E){if("effect"in E){const I=E.effect;
E.effect="saturate(0.6) opacity(0.8)";return m.makeHandle(()=>E.effect=I)}const r=E.opacity;E.opacity=.7;return m.makeHandle(()=>E.opacity=r)};N._highlight=function(E){const r=this.data.viewModel.view;"3d"===r?.type&&this._highlightHandles.set(E,r.highlight(E))};N._removeHighlight=function(E){w.removeMaybe(this._highlightHandles.get(E));this._highlightHandles.delete(E)};N._startCreating=async function(E){const {data:r}=this,{creationInfo:I}=r;if(I)return this.createFeatureState="create-new",y.startCreatingNewFeature(r.viewModel.sketchViewModel,
I,E)};N._startUpdating=async function(E,r){var {pendingFeatures:I}=this;I.includes(E)||I.add(E);const {creationInfo:M,viewModel:S}=this.data,{featureFormViewModel:U,layerInfos:G,sketchViewModel:J,view:L}=S;if(L&&M){I=M.layer;var B=y.findLayerInfo(G,I);U.set({arcadeEditType:"INSERT",feature:E,formTemplate:B?.formTemplate,spatialReference:L.spatialReference,map:L.map});this._removeHighlight(E);await y.updateGraphicSymbolWhenRequired(E,r);w.removeMaybe(this._featureFormHandle);this._featureFormHandle=
m.handlesGroup([U.on("value-change",async()=>{E.attributes=U.getValues();await y.updateGraphicSymbolWhenRequired(E,r)}),J.on(["update","undo","redo"],A=>{("undo"===A.type||"redo"===A.type||"update"===A.type&&null!=A.toolEventInfo&&y.isTerminalUpdateEventType(A.toolEventInfo.type))&&U.notifyFeatureGeometryChanged()})]);this.createFeatureState="update-pending";this._visualVariableAttributes=y.getVisualVariableAttributes(E);if(!g.isTable(I))return y.startUpdatingFeature({graphic:E,sketchViewModel:J,
sourceLayer:I,visualVariables:this._visualVariableAttributes,webStyleCache:r})}};H._createWorkflowSteps=function(E,r="awaiting-feature-creation-info"){const {data:I,handles:M}=E;r=y.createWorkflowSteps(["awaiting-feature-creation-info","creating-features","adding-attachment","editing-attachment"],r,{"awaiting-feature-creation-info":()=>({id:"awaiting-feature-creation-info",async setUp(S){const {creationInfo:U,viewModel:G}=I;var {view:J}=G;J&&(n.isModelUpload(U)?(J=await n.waitForModelUpload({view:J,
data:I,signal:S,next:()=>E.next(),cancel:()=>G.cancelWorkflow()}),F.throwIfAborted(S),M.add(J,this.id)):(I.creationInfo=null,M.add(G.featureTemplatesViewModel.on("select",({item:L})=>{L&&(I.creationInfo=L,G.activeWorkflow?.next())}),this.id)))},async tearDown(){M.remove(this.id)}}),"creating-features":()=>({id:"creating-features",async setUp(){if(!M.has(this.id)){var {viewModel:S}=I,{view:U}=S;if(U){var G=new Map,J=[],L=[];E._lastActiveGraphics=[];E._featureFormHandle=w.removeMaybe(E._featureFormHandle);
E._visualVariableAttributes={rotation:null,size:null};y.prepareAttachmentsForCreateWorkflow(S.attachmentsViewModel);J.push(K.watch(()=>S.attachmentsViewModel.mode,A=>{switch(A){case "add":E.go("adding-attachment");break;case "edit":E.go("editing-attachment")}}));U=y.showProgressCursor(U);J.push(U);var B=g.isTable(E.data.creationInfo?.layer);try{if(!B){const x=h._configureSketchViewModel(E,G);J.push(x.beforeCommit);L.push(x.afterCommit)}const A=I.creationInfo?.initialFeature;A?(B||S.sketchViewModel.layer.add(A),
await E._startUpdating(A,G)):await E._startCreating(G)}finally{U.remove()}J.push(E._featureFormHandle);M.add(J,E._handleKeys.beforeCommit);M.add([...J,...L],this.id)}}},async tearDown(S){const {viewModel:U}=I;S.canceled&&({pendingFeatures:S}=E,S.drain(G=>U.sketchViewModel.layer.remove(G)),M.remove([this.id,d]),U.attachmentsViewModel.fileInfos.removeAll(),E._attachmentFileInfos.clear())}}),"adding-attachment":()=>({id:"adding-attachment",parent:"creating-features",async setUp(){},async tearDown(){const {attachmentsViewModel:S}=
I.viewModel,{graphic:U,fileInfos:G}=S;E._attachmentFileInfos.set(U,G.toArray());S.mode="view"}}),"editing-attachment":()=>({id:"editing-attachment",parent:"creating-features",async setUp(){},async tearDown(){const {attachmentsViewModel:S}=I.viewModel,{graphic:U,fileInfos:G}=S;E._attachmentFileInfos.set(U,G.toArray());S.mode="view"}})});return y.avoidFeatureTemplateSelectionWithOnlyOneItem(I,r)};H._configureSketchViewModel=function(E,r){const {data:I,handles:M}=E;var {viewModel:S}=I;const {view:U}=
S,G=S.sketchViewModel;let J=null;S=[];if(!U)return{beforeCommit:m.makeHandle(),afterCommit:m.makeHandle()};const L=G.updateOnGraphicClick;G.updateOnGraphicClick=!1;"2d"===U.type&&I.creationInfo&&S.push(E._fadeExistingFeatures(I.creationInfo.layer));S.push(G.on("create",async B=>{if("cancel"===B.state){if(E._preventDefaultActionOnCancel){E._preventDefaultActionOnCancel=!1;return}if(1>E._lastActiveGraphics.length)return E._startCreating(r);B=E._lastActiveGraphics.pop();return E._startUpdating(B,r)}if("complete"===
B.state&&B.graphic)return E._startUpdating(B.graphic,r)}),G.on("update",async B=>{var {viewModel:A}=I;const {attachmentsViewModel:x,featureFormViewModel:Q}=A;var T=B.graphics[0];if("complete"===B.state){T!==J&&(E._lastActiveGraphics.push(T),E._highlight(T));J=null;if(E.numPendingFeatures===I.creationInfo?.maxFeatures)return B=E._lastActiveGraphics.pop(),E._startUpdating(B,r);"add"!==x.mode&&"edit"!==x.mode||A.activeWorkflow?.previous();if(B.aborted&&E._preventDefaultActionOnCancel){E._preventDefaultActionOnCancel=
!1;return}M.add([y.showProgressCursor(U),U.on("click",Y=>Y.preventDefault())],d);await K.whenOnce(()=>!Q.updating);M.remove(d);E._startCreating(r)}"start"===B.state&&(E._removeHighlight(T),"add"!==x.mode&&"edit"!==x.mode||A.activeWorkflow?.previous(),x.fileInfos.removeAll(),x.graphic=T,x.mode="view",(E._attachmentFileInfos.get(T)||[]).forEach(({file:Y,form:Z})=>x.addFile(Y,Z)));A=E._visualVariableAttributes;await y.visualVariableInteractiveUpdate(U,T,B,A,r);B=T.attributes;const {rotation:W,size:aa}=
A;null!=W&&({field:T}=W,Q.setValue(T,B[T]));null!=aa&&({field:T}=aa,Q.setValue(T,B[T]))}),G.on("delete",async B=>{B=B.graphics[0];E.pendingFeatures.remove(B);c.remove(E._lastActiveGraphics,B);J=B}),U.on("immediate-click",async B=>{!n.isModelUpload(I.creationInfo)&&({results:B}=await U.hitTest(B,{include:G.layer}),B=B.find(A=>"graphic"===A.type))&&(B=B.graphic,"transform"!==G.activeTool&&"reshape"!==G.activeTool||G.updateGraphics.at(0)===B||await E.updatePendingFeature(B,r))}),m.makeHandle(()=>G.cancel()),
O(G,I));return{beforeCommit:m.handlesGroup(S),afterCommit:m.makeHandle(()=>{G.updateOnGraphicClick=L})}};b._createClass(H,[{key:"hasPendingEdits",get:function(){if(this.numPendingFeatures)return!0;const {data:E}=this,{upload:r}=E;return r&&!r.error||E.creationInfo?.geometryToPlace?!0:!1}},{key:"helpMessage",get:function(){const {creationInfo:E,viewModel:r}=this.data;if("creating-features"===this.stepId&&E)return u.getDrawHelpMessage(E.layer.geometryType,r.sketchViewModel.createGraphic?.geometry,r.view)}},
{key:"numPendingFeatures",get:function(){return this.pendingFeatures.length}},{key:"pendingFeatures",get:function(){return this.data.pendingFeatures}},{key:"keyboardCancellationEnabled",get:function(){return 0===this.numPendingFeatures}},{key:"reliesOnOwnerAdminPrivileges",get:function(){var {creationInfo:E}=this.data;if(!E)return!1;({layer:E}=E);const r=E.capabilities?.operations.supportsAdd,I=g.getEffectiveLayerCapabilities(E)?.operations.supportsAdd;return g.getEffectiveEditingEnabled(E)&&!E.editingEnabled||
!!I&&!r}},{key:"shouldShowAttachments",get:function(){return this.data&&this.data.creationInfo&&this.data.viewModel?y.shouldShowAttachmentsForCreateWorkflow(this.data):!1}},{key:"shouldAllowAttachmentEditing",get:function(){return this.shouldShowAttachments}},{key:"updating",get:function(){return this.updatingHandles.updating}},{key:"test",get:function(){return{addAttachment:(E,r)=>{this._attachmentFileInfos.set(E,r)}}}}]);return H}(p);e.__decorate([z.property()],t.prototype,"hasPendingEdits",null);
e.__decorate([z.property()],t.prototype,"helpMessage",null);e.__decorate([z.property()],t.prototype,"keyboardCancellationEnabled",null);e.__decorate([z.property()],t.prototype,"reliesOnOwnerAdminPrivileges",null);e.__decorate([z.property()],t.prototype,"shouldShowAttachments",null);e.__decorate([z.property()],t.prototype,"shouldAllowAttachmentEditing",null);e.__decorate([z.property()],t.prototype,"updating",null);return t=h=e.__decorate([a.subclass("esri.widgets.Editor.CreateFeaturesWorkflow")],t)})},
"esri/views/draw/support/helpMessageUtils":function(){define(["exports","../../../arcade/functions/centroid","../../../core/unitUtils","../../../chunks/vec3","../../../chunks/vec3f64"],function(b,e,c,m,w){const F=w.create();b.getDrawHelpMessage=function(K,P,z){switch(K){case "point":case "multipoint":return"point";case "polyline":return 2>(null!=P&&"polyline"===P.type&&P.paths.length?P.paths[0].length:0)?"polylineZeroVertices":"polylineOneVertex";case "polygon":return K=null!=P&&"polygon"===P.type&&
P.rings.length?P.rings[0].length:0,3>K?"polylineZeroVertices":4>K?"polygonOneVertex":"polygonTwoVertices";case "mesh":if("mesh"===P?.type&&"3d"===z?.type){({renderCoordsHelper:K}=z);({camera:z}=z.state);var {width:t,height:D,zmin:a,zmax:g,center:u,spatialReference:v}=P.extent;P=(g??0)-(a??0);var k=c.getMetersPerUnitForSR(v),n=e.getMetersPerVerticalUnitForSR(v),p=c.getMetersPerUnitForSR(K.spatialReference);P=Math.max(t*k,D*k,P*n)/p;m.set(F,u.x,u.y,u.z??0);K.toRenderCoords(F,v,F);K=P/z.computeScreenPixelSizeAt(F);
K=K>1*z.width?"meshTooClose":20>K?"meshTooFar":"mesh"}else K=void 0;return K}};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/functions/centroid":function(){define(["exports","../../geometry/Point","../../geometry/support/intersectsBase"],function(b,e,c){function m(a,g,u){const v={x:0,y:0};g&&(v.z=0);u&&(v.m=0);let k=0;var n=a[0];for(let f=0;f<a.length;f++){const h=a[f];a:if(h.length!==n.length)var p=!1;else{for(p=0;p<h.length;p++)if(h[p]!==n[p]){p=!1;break a}p=!0}if(!1===
p){p=w(n,h,g);var y=h,O=g,C=u;const d={x:(n[0]+y[0])/2,y:(n[1]+y[1])/2};O&&(d.z=(n[2]+y[2])/2);O&&C?d.m=(n[3]+y[3])/2:C&&(d.m=(n[2]+y[2])/2);n=d;n.x*=p;n.y*=p;v.x+=n.x;v.y+=n.y;g&&(n.z*=p,v.z+=n.z);u&&(n.m*=p,v.m+=n.m);k+=p;n=h}}0<k?(v.x/=k,v.y/=k,g&&(v.z/=k),u&&(v.m/=k)):(v.x=a[0][0],v.y=a[0][1],g&&(v.z=a[0][2]),u&&g?v.m=a[0][3]:u&&(v.m=a[0][2]));return v}function w(a,g,u){const v=g[0]-a[0];a=g[1]-a[1];return u?(g=g[2]-g[2],Math.sqrt(v*v+a*a+g*g)):Math.sqrt(v*v+a*a)}function F(a,g,u=0){for(;a<u;)a+=
g;for(u+=g;a>=u;)a-=g;return a}function K(a,g){return Math.atan2(g.y-a.y,g.x-a.x)}function P(a,g,u){var v=a.x-g.x;a=a.y-g.y;var k=u.x-g.x;g=u.y-g.y;return Math.atan2(v*g-k*a,v*k+a*g)}const z=[];for(const a of[[9002,56146130,6131,6132,8050,8051,8228],[9003,5702,6358,6359,6360,8052,8053],[9095,5754]]){const g=a[0];for(let u=1;u<a.length;u++)z[a[u]]=g}const t=[];t[9002]=.3048;t[9003]=.3048006096012192;t[9095]=.3048007491;const D=[0,0];b.angle2D=function(a,g){return F(K(a,g),2*Math.PI)*(180/Math.PI)};
b.angleBetween2D=function(a,g,u){return F(P(a,g,u),2*Math.PI)*(180/Math.PI)};b.angleBetweenRad=P;b.angleRad=K;b.bearing2D=function(a,g){return F(Math.PI/2-K(a,g),2*Math.PI)*(180/Math.PI)};b.bearingBetween2D=function(a,g,u){return F(-1*P(a,g,u),2*Math.PI)*(180/Math.PI)};b.centroidMultiPoint=function(a){if(0===a.points.length)return null;var g=0;let u=0,v=0,k=0;for(let n=0;n<a.points.length;n++){const p=a.getPoint(n);!0===p.hasZ&&(v+=p.z);!0===p.hasM&&(k+=p.m);g+=p.x;u+=p.y;k+=p.m}g={x:g/a.points.length,
y:u/a.points.length,spatialReference:null};g.spatialReference=a.spatialReference.toJSON();!0===a.hasZ&&(g.z=v/a.points.length);!0===a.hasM&&(g.m=k/a.points.length);return new e(g)};b.centroidPolyline=function(a){const g={x:0,y:0,spatialReference:a.spatialReference.toJSON()},u={x:0,y:0,spatialReference:a.spatialReference.toJSON()};let v=0,k=0;for(let y=0;y<a.paths.length;y++)if(0!==a.paths[y].length){a:{var n=a.paths[y];var p=!0===a.hasZ;if(1>=n.length){n=0;break a}let O=0;for(let C=1;C<n.length;C++)O+=
w(n[C-1],n[C],p);n=O}0===n?(n=m(a.paths[y],!0===a.hasZ,!0===a.hasM),g.x+=n.x,g.y+=n.y,!0===a.hasZ&&(g.z+=n.z),!0===a.hasM&&(g.m+=n.m),++v):(p=m(a.paths[y],!0===a.hasZ,!0===a.hasM),u.x+=p.x*n,u.y+=p.y*n,!0===a.hasZ&&(u.z+=p.z*n),!0===a.hasM&&(u.m+=p.m*n),k+=n)}return 0<k?(u.x/=k,u.y/=k,!0===a.hasZ&&(u.z/=k),!0===a.hasM&&(u.m/=k),new e(u)):0<v?(g.x/=v,g.y/=v,!0===a.hasZ&&(u.z/=v),!0===a.hasM&&(g.m/=v),new e(g)):null};b.getMetersPerVerticalUnitForSR=function(a){return a.vcsWkid&&void 0!==z[a.vcsWkid]?
t[z[a.vcsWkid]]:a.latestVcsWkid&&void 0!==z[a.latestVcsWkid]?t[z[a.latestVcsWkid]]:1};b.pathsSelfIntersecting=function(a){for(let O=0;O<a.length;O++){const C=a[O];for(var g=0;g<C.length-1;g++){var u=C[g],v=C[g+1];for(var k=O+1;k<a.length;k++)for(var n=0;n<a[k].length-1;n++){var p=a[k][n],y=a[k][n+1];if(c.segmentIntersects(u,v,p,y,D)&&!(D[0]===u[0]&&D[1]===u[1]||D[0]===p[0]&&D[1]===p[1]||D[0]===v[0]&&D[1]===v[1]||D[0]===y[0]&&D[1]===y[1]))return!0}}g=C.length;if(!(3>g))for(u=0;u<=g-2;u++)for(v=C[u],
k=C[u+1],n=u+2;n<=g-2;n++)if(p=C[n],y=C[n+1],c.segmentIntersects(v,k,p,y,D)&&!(D[0]===v[0]&&D[1]===v[1]||D[0]===p[0]&&D[1]===p[1]||D[0]===k[0]&&D[1]===k[1]||D[0]===y[0]&&D[1]===y[1]))return!0}return!1};b.segmentLength3d=function(a,g,u){return Math.sqrt((a[0]-g[0])**2+(a[1]-g[1])**2+(void 0!==a[2]&&void 0!==g[2]?(a[2]*u-g[2]*u)**2:0))};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/FeatureSnappingLayerSource":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),
function(b,e,c,m,w,F,K,P){c=function(z){function t(D){D=z.call(this,D)||this;D.layer=null;D.enabled=!0;D.updating=!1;D.availability=1;return D}b._inherits(t,z);return b._createClass(t)}(c);e.__decorate([m.property({constructOnly:!0})],c.prototype,"layer",void 0);e.__decorate([m.property()],c.prototype,"enabled",void 0);e.__decorate([m.property()],c.prototype,"updating",void 0);e.__decorate([m.property()],c.prototype,"availability",void 0);return c=e.__decorate([P.subclass("esri.views.interactive.snapping.FeatureSnappingLayerSource")],
c)})},"esri/widgets/Editor/CreateFeaturesWorkflowData":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Collection ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),function(b,e,c,m,w,F,K,P,z,t){b.CreateFeaturesWorkflowData=function(D){function a(g){g=D.call(this,g)||this;g.creationInfo=null;g.pendingFeatures=
new w;g.viewModel=null;g.upload=null;return g}e._inherits(a,D);return e._createClass(a)}(m);c.__decorate([F.property()],b.CreateFeaturesWorkflowData.prototype,"creationInfo",void 0);c.__decorate([F.property()],b.CreateFeaturesWorkflowData.prototype,"viewModel",void 0);c.__decorate([F.property()],b.CreateFeaturesWorkflowData.prototype,"upload",void 0);b.CreateFeaturesWorkflowData=c.__decorate([t.subclass("esri.widgets.Editor.CreateFeaturesWorkflowData")],b.CreateFeaturesWorkflowData);Object.defineProperty(b,
Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/modelUploadUtils":function(){define("require exports ../../core/handleUtils ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ./workflowUtils".split(" "),function(b,e,c,m,w,F,K){function P(z){return"scene"===z?.layer?.type}e.isModelUpload=P;e.waitForModelUpload=async function({view:z,data:t,signal:D,next:a,cancel:g}){const {creationInfo:u}=t;if(u&&P(u)){var {layer:v}=u,k=null!=u.geometryToPlace;u.geometryToPlace=null;if(k)g();
else{k=(await new Promise((y,O)=>b(["./Upload"],y,O))).Upload;w.throwIfAborted(D);var n=new k;t.upload=n;var p=K.showProgressCursor(z);z=c.handlesGroup([p,F.watch(()=>n.state,y=>{switch(y){case "success":u.maxFeatures=1;u.geometryToPlace=n.result;a();break;case "error":p.remove();break;case "canceled":g()}}),c.makeHandle(()=>{t.upload=m.destroyMaybe(t.upload)})]);n.uploadTo(v);return z}}};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/workflowUtils":function(){define("require exports ../../Graphic ../../core/asyncUtils ../../core/has ../../core/handleUtils ../../core/lang ../../core/promiseUtils ../../core/reactiveUtils ../../core/screenUtils ../../core/accessorSupport/diffUtils ../../layers/support/fieldUtils ../../renderers/support/clickToleranceUtils ../../renderers/support/lengthUtils ../../renderers/visualVariables/support/sizeVariableUtils ../../renderers/visualVariables/support/visualVariableUtils ../../support/featureFlags ../../symbols/support/symbolConversion ../../symbols/support/symbolUtils ../../views/3d/layers/graphics/GraphicState ../../views/support/drapedUtils ../../views/support/hitTestSelectUtils".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a,g,u,v,k,n,p,y,O,C,f){function h(Y){const Z=Y.sourceLayer;var R;if(!(R=!Z||"feature"!==Z.type)){a:switch(Z.renderer?.type){case "class-breaks":case "simple":case "unique-value":case "dot-density":case "dictionary":case "pie-chart":R=!0;break a;default:R=!1}R=!R}if(R)return{rotation:null,size:null};let V=R=null;var ba=Z.renderer.getVisualVariablesForType("rotation").filter(ea=>(!ea.axis||"heading"===ea.axis)&&ea.field&&!ea.valueExpression&&null!=k.getRotationAngle(ea,
Y));1===ba.length&&(R=d(ba[0],Z));ba=Z.renderer.getVisualVariablesForType("size").filter(ea=>ea.field&&!ea.useSymbolValue&&!ea.valueExpression&&v.getTransformationType(ea)===v.TransformationType.RealWorldSize&&null!=k.getSize(ea,Y));1===ba.length&&(V=H(ba[0],Z));return{rotation:R,size:V}}function d(Y,Z){const R="heading"===(Y.axis||"heading")&&"arithmetic"===Y.rotationType?-1:1,V=Y.field,ba=(Z=Z.fields&&Z.fields.filter(la=>la.name===V))&&1===Z.length?Z[0].type:"double";var ea=0,ha=0;return{field:V,
fieldType:ba,getDefault:()=>Promise.resolve(0),getValue:la=>{ha=ea-R*la;return N((ha+360)%360,ba)},initValue:la=>{ea=null!=la?la:ha;ha=0},isUpdatingInteractively:!1,rotationType:Y.rotationType??"geographic"}}function l(Y,Z){switch(Z){case "width":return Y[0];case "depth":return Y[1];case "height":return Y[2];default:return Y[2]||Y[1]||Y[0]}}async function q(Y,Z,R){if(null==Z)return 0;({symbol:Z}=p.to3D(Z));if(null==Z||"web-style"===Z.type||"cim"===Z.type)return 0;Z=Z.symbolLayers.at(0);if(!Z)return 0;
switch(Z.type){case "icon":return{computeIconLayerResourceSize:R}=await new Promise((ba,ea)=>b(["../../symbols/support/symbolLayerUtils"],ba,ea)),Z.size||Math.min(T.icon,(await R(Z,T.icon))[0])||T.icon;case "text":return Z.size||T.text;case "line":return Z.size||T.line;case "object":const {computeObjectLayerResourceSize:V}=await new Promise((ba,ea)=>b(["../../symbols/support/symbolLayerUtils"],ba,ea));Y=await V(Z,Y.scale/T.viewScaleSizeFactor);return l(Y,R);case "path":return(null!=Z.width?Z.width:
Z.height)||Y.scale/T.viewScaleSizeFactor;case "extrude":return Z.size||Y.scale/T.viewScaleSizeFactor;case "fill":case "water":return 0;default:return 0}}function H(Y,Z){const R=Y.field,V=Y.axis,ba=(Z=Z.fields&&Z.fields.filter(na=>na.name===R))&&1===Z.length?Z[0].type:"double";var ea=0,ha=0;const la=u.meterIn[Y.valueUnit]??1;let ia;ia="area"===Y.valueRepresentation?na=>(na*la/2)**2*Math.PI:"radius"===Y.valueRepresentation||"distance"===Y.valueRepresentation?na=>na*la/2:na=>na*la;return{field:R,fieldType:ba,
getDefault:async(na,ma)=>N(ia(await q(ma,na,V)),ba),getValue:(na,ma)=>{ea||(ea=ma.pixelSizeAt(ma.center));ha=ea*na;return N(ha,ba)},initValue:na=>{ea=null!=na?na:ha;ha=0},isUpdatingInteractively:!1,displayUnit:x(Y.valueUnit),axis:Y.axis}}function N(Y,Z){switch(Z){case "small-integer":case "integer":case "long":return Math.round(Y);case "double":case "single":return Y;default:return 0}}async function E(Y,Z){Z=await y.getDisplayedSymbol(Y,{useSourceLayer:!0,ignoreGraphicSymbol:!0,webStyleCache:Z});
null!=D.diff(Y.symbol,Z)&&(Y.symbol=Z)}async function r(Y,Z,R){const V=Z.layer,ba={...Z.template?.prototype.attributes};await I(Y,V,ba,R);Y.layer.elevationInfo=V.elevationInfo;R=Y.create;var ea=V.geometryType;if(!ea)throw Error("no geometry type");await R.call(Y,"multipatch"===ea?"mesh":ea,{graphicProperties:{attributes:ba,sourceLayer:V},hasZ:V.capabilities.data.supportsZ,geometryToPlace:Z.geometryToPlace??void 0})}async function I(Y,Z,R,V){Z=new c({sourceLayer:Z,attributes:R});const {rotation:ba,
size:ea}=h(Z);let ha=await y.getDisplayedSymbol(Z,{useSourceLayer:!0,webStyleCache:V}),la=!1;for(const ia of[ea,ba])null!=ia&&null==R[ia.field]&&(R[ia.field]=await ia.getDefault(ha,Y.view),la=!0);la&&(ha=await y.getDisplayedSymbol(Z,{useSourceLayer:!0,webStyleCache:V}));switch(ha?.type){case "simple-fill":case "polygon-3d":Y.polygonSymbol=ha;break;case "simple-line":case "line-3d":Y.polylineSymbol=ha;break;case "simple-marker":case "picture-marker":case "point-3d":case "cim":Y.pointSymbol=ha}M(Y.tooltipOptions,
ea,ba)}function M(Y,Z,R){Y.visualVariables=null!=Z||null!=R?{size:null!=Z?{unit:Z.displayUnit,axis:Z.axis,valueType:Z.fieldType}:null,rotation:null!=R?{valueType:R.fieldType,rotationType:R.rotationType??"geographic"}:null}:null}async function S(Y,Z,R,V){if(0===Y.length)return[];const {updatable:ba,graphicsByLayer:ea}=await R.async(async()=>{var {results:ha}=await P.whenOrAbort(f.hitTestSelectSimilarDistance(Z,R),V);const la=new Map;f.filterGraphicHits(ha).forEach(({graphic:ia})=>{var na=ia.layer;
var ma=la.get(na);ma?na=ma:(ma=[],la.set(na,ma),na=ma);return na.push(ia)});ha=Y.filter(({supports:ia,layer:na})=>ia.includes("update")&&la.has(na));0!==ha.length&&R.stopPropagation();return{updatable:ha,graphicsByLayer:la}});return P.whenOrAbort(P.eachAlways(ba.map(async({layer:ha})=>{var {objectIdField:la}=ha,ia="displayField"in ha?ha.displayField:null;const na=[la];null!=ia&&ha.fieldsIndex.has(ia)&&na.push(ia);la=ea.get(ha);return la.some(ma=>na.some(X=>!(X in ma.attributes)))?(ia=ha.createQuery(),
ia.outFields=na,ia.returnGeometry=!1,ia.objectIds=la.map(ma=>ma.getObjectId()),ha.queryFeatures(ia,{signal:V}).then(({features:ma})=>ma)):la})),V)}async function U(Y,Z,R,V){if(0===Y.length)return[];let ba=null;const ea=await R.async(async()=>{var {results:ha}=await P.whenOrAbort(Z.hitTest(R),V);if(0===ha.length)return[];const la=new Set;ba=f.filterGraphicHits(ha);ba.forEach(({graphic:ia})=>ia&&la.add(ia.layer));ha=Y.items.filter(({layer:ia,supports:na,attachmentsOnUpdateEnabled:ma})=>la.has(ia)&&
(na.includes("update")||na.includes("delete")||ma));0<ha.length&&R.stopPropagation();return ha});return P.whenOrAbort(P.eachAlways(ea.map(({layer:ha})=>{var la=ha.objectIdField,ia=a.getDisplayFieldName({displayField:"displayField"in ha?ha.displayField:null,fields:ha.fields});la=[la];null!=ia&&ha.fieldsIndex.has(ia)&&la.push(ia);ia=ha.createQuery();ia.outFields=la;ia.returnGeometry=!1;la="renderer"in ha?g.calculateTolerance({renderer:ha.renderer,event:R}):0;ia.geometry=C.createQueryGeometry(R.mapPoint,
la,Z);ia.outSpatialReference=Z.spatialReference;return ha.queryFeatures(ia,{signal:V}).then(({features:na})=>{ba?.forEach(({graphic:ma})=>{ma.layer!==ha||na.some(X=>X.getObjectId()===ma.getObjectId())||na.push(ma)});return na})})),V)}async function G(Y){const {graphic:Z,sketchViewModel:R,sourceLayer:V,visualVariables:ba,webStyleCache:ea}=Y;let ha=!1;const {rotation:la,size:ia}=ba;[la,ia].forEach(async na=>{if(null!=na){var ma=Z.getAttribute(na.field);null!=ma?na.initValue(ma):(ma=await na.getDefault(Z.symbol,
R.view),na.initValue(ma),Z.setAttribute(na.field,ma),ha=!0)}});ha&&await E(Z,ea);Y={multipleSelectionEnabled:!1};"point"===V.geometryType&&(Y.enableRotation=null!=la,Y.enableScaling=null!=ia);M(R.tooltipOptions,ia,la);R.layer.elevationInfo=V.elevationInfo;return R.update(Z,Y)}async function J(Y,Z,R,V,ba){if(null!=Z.geometry&&"point"===Z.geometry?.type){var ea=V.rotation;var ha=R.toolEventInfo;ha=null==ha||"rotate-start"!==ha.type&&"rotate"!==ha.type&&"rotate-stop"!==ha.type?null:ha;if(null!=ea&&null!=
ha)if("rotate-stop"===ha.type)ea.isUpdatingInteractively=!1,ea.initValue();else{ea.isUpdatingInteractively=!0;const {field:la,getValue:ia}=ea;Z.setAttribute(la,ia(ha.angle,Y))}V=V.size;R=R.toolEventInfo;R=null==R||"scale-start"!==R.type&&"scale"!==R.type&&"scale-stop"!==R.type?null:R;if(null!=V&&null!=R)if("scale-stop"===R.type)V.isUpdatingInteractively=!1,V.initValue();else{V.isUpdatingInteractively=!0;const {field:la,getValue:ia}=V;Z.setAttribute(la,ia(R.xScale,Y))}await E(Z,ba)}}function L(Y,Z,
R){function V(ia){la?.abort();la=m.createTask(async na=>{const ma=await W(ba,ea);P.throwIfAborted(na);ma.setVisibility?.(ha,ia)})}const ba=Y.view,ea=Z.sourceLayer,ha=Z.getAttribute(Z.layer.objectIdField);let la=null;V(!1);return F.handlesGroup([B(ba,R,ia=>V(!ia)),F.makeHandle(async()=>{V(!0);const ia=await W(ba,ea);await z.whenOnce(()=>!ia.updating);Y.layer.remove(R)})])}function B(Y,Z,R){if("3d"===Y.type){const V=new O.GraphicState({graphic:Z});return F.handlesGroup([Y.trackGraphicState(V),z.watch(()=>
V.displaying,R)])}return z.watch(()=>Z.visible,R)}async function A(Y,Z){if("3d"===Y.type){const R=new O.GraphicState({graphic:Z});Y=Y.trackGraphicState(R);await z.whenOnce(()=>R.displaying);Y.remove()}else await z.whenOnce(()=>Z.visible)}function x(Y){switch(Y){case "unknown":case "decimal-degrees":return null;default:return Y}}function Q(Y){const Z=Y.geometry;if("mesh"===Z?.type){const R=Y.cloneShallow();R.attributes=K.clone(Y.attributes);R.geometry=Z.cloneShallow();R.geometry.transform=Z.transform?.clone()??
null;return R}return Y.clone()}const T={icon:t.px2pt(24),text:t.px2pt(12),line:t.px2pt(1),viewScaleSizeFactor:100},W=(Y,Z)=>Y.whenLayerView("subtype-sublayer"===Z.type?Z.parent:Z),aa=Symbol();e.UsesSketchViewModelSymbol=aa;e.avoidFeatureTemplateSelectionWithOnlyOneItem=function(Y,Z){Y.viewModel.refreshCreationTemplates();if("awaiting-feature-creation-info"===Z[0].id){var R=Y.viewModel.featureTemplatesViewModel.items;1!==R.length?R=null:(R=R[0],R="items"in R?1===R.items.length?R.items[0]:null:R);null==
R||R.supportsUpload||(Y.creationInfo=R,Z.shift())}return Z};e.canCreateInteractiveEditSession=function(Y){return"createInteractiveEditSession"in Y};e.cloneGraphicExceptMesh=Q;e.createWorkflowSteps=function(Y,Z,R){let V=!1;return Y.filter(ba=>V?!0:V=ba===Z).map(ba=>R[ba]())};e.fetchCandidates=async function(Y,Z,R,V){switch(Z.type){case "3d":return S(Y,Z,R,V);case "2d":return U(Y,Z,R,V)}};e.fetchFullFeature=async function(Y,Z,R){const {sourceLayer:V}=Y,ba=V.createQuery();ba.objectIds=[Y.getAttribute(V.objectIdField)];
ba.outFields=["*"];ba.outSpatialReference=Z;ba.returnM=V.capabilities.data.supportsM;ba.returnZ=V.capabilities.data.supportsZ;n.sceneLayerEditingEnabled()&&n.i3sPatchingEnabled()&&"scene"===V.type&&null!=V.infoFor3D&&(ba.returnGeometry=!0,ba.formatOf3DObjects="3D_glb");Y=await V.queryFeatures(ba,{signal:R});P.throwIfAborted(R);return Y.features[0]};e.findLayerInfo=function(Y,Z){return Y?Y.find(R=>R.layer===Z):void 0};e.getVisualVariableAttributes=h;e.isTerminalUpdateEventType=Y=>/-stop/.test(Y)||
/vertex-/.test(Y);e.prepareAttachmentsForCreateWorkflow=function(Y){Y.filesEnabled=!0;Y.mode="view";Y.capabilities={editing:!0,operations:{add:!0,update:!0,delete:!0}}};e.setUpFeatureAdd=async function(Y,Z,R,V){await r(Y,Z,V);const ba=Y.on("create",async ea=>{if("cancel"===ea.state)return r(Y,Z,V);"complete"===ea.state&&(ea=ea.graphic,ea.sourceLayer||(ea.sourceLayer=Z.layer),ea.attributes||(ea.attributes={...Z.template?.prototype.attributes}),await E(ea,V),R(ea))});return F.handlesGroup([ba,F.makeHandle(()=>
Y.cancel())])};e.setUpGeometryUpdate=async function(Y,Z,R,V,ba,ea){const ha=Q(Y);await E(ha,ea);V.map.add(R.layer);R.layer.add(ha);const la=Y.sourceLayer;var ia=W(V,la);await A(V,ha);await G({graphic:ha,sketchViewModel:R,sourceLayer:la,visualVariables:Z,webStyleCache:ea});const na=L(R,Y,ha);let ma=null;ia.then(ra=>ma=ra).catch(()=>{});const X=Z.size,da=Z.rotation;ia=z.watch(()=>Y.attributes,async ra=>{let qa=!1;for(const ja in ra){const oa=ra[ja];oa!==ha.getAttribute(ja)&&(ha.setAttribute(ja,oa),
null==X||X.isUpdatingInteractively||X.field!==ja||X.initValue(oa),null==da||da.isUpdatingInteractively||da.field!==ja||da.initValue(oa),null==ma||ma.requiredFields.includes(ja))&&(qa=!0)}qa&&await E(ha,ea)});const fa=R.on("update",async ra=>{const qa=ra.graphics[0];if("complete"===ra.state)return G({graphic:qa,sketchViewModel:R,sourceLayer:la,visualVariables:Z,webStyleCache:ea});await J(V,qa,ra,Z,ea);ba(Q(qa),ra)}),ca=R.on(["undo","redo"],async ra=>{ba(Q(ra.graphics[0]),ra)}),ka=R.updateOnGraphicClick;
return{visual:F.handlesGroup([na,F.makeHandle(()=>{R.updateOnGraphicClick=ka})]),interactive:F.handlesGroup([ca,fa,F.makeHandle(()=>R.cancel()),ia,F.makeHandle(()=>{R.updateOnGraphicClick=!1})])}};e.shouldShowAttachmentsForCreateWorkflow=function(Y){const {creationInfo:Z,viewModel:R}=Y;if(!Z)return!1;const {layer:V}=Z;if(Y=R.editableItems.find(ea=>ea.layer===V))return Y.attachmentsOnCreateEnabled;Y=V.capabilities?.data;const ba=R.layerInfos?.find(ea=>ea.layer===V);return!(!(Y&&"supportsAttachment"in
Y&&Y.supportsAttachment)||ba&&(!1===ba.allowAttachments||!1===ba.attachmentsOnUpdateEnabled))};e.showProgressCursor=function(Y){const Z=Y.cursor;Y.cursor="progress";return F.makeHandle(()=>Y.cursor=Z)};e.sizeDefaults=T;e.sizeVariableUnitToLengthUnit=x;e.startCreatingNewFeature=r;e.startUpdatingFeature=G;e.updateGraphicSymbolWhenRequired=E;e.visualVariableInteractiveUpdate=J;e.whenEditorLayerView=W;e.whenGraphicDisplayed=A;e.workflowUsesSketchViewModel=function(Y){return Y&&"object"===typeof Y&&aa in
Y};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/clickToleranceUtils":function(){define(["exports"],function(b){function e(w,F){return F?"xoffset"in F&&F.xoffset?Math.max(w,Math.abs(F.xoffset)):"yoffset"in F&&F.yoffset?Math.max(w,Math.abs(F.yoffset||0)):w:w}function c(w,F){if("number"===typeof w)return w;if(w&&w.stops&&w.stops.length){w=w.stops;let K=F=0;for(let P=0;P<w.length;P++){const z=w[P].size;"number"===typeof z&&(F+=z,K++)}return F/K}return F}function m(w,
F){if(!F)return w;F=F.filter(z=>"size"===z.type).map(z=>{const {maxSize:t,minSize:D}=z;return(c(t,w)+c(D,w))/2});let K=0;const P=F.length;if(0===P)return w;for(let z=0;z<P;z++)K+=F[z];return Math.max(Math.floor(K/P),w)}b.calculateTolerance=function(w){const F=w&&w.renderer;w="touch"===(w&&w.event&&w.event.pointerType)?9:6;if(!F)return w;w="visualVariables"in F?m(w,F.visualVariables):w;if("simple"===F.type)return e(w,F.symbol);if("unique-value"===F.type){let K=w;F.uniqueValueInfos?.forEach(P=>{K=e(K,
P.symbol)});return K}if("class-breaks"===F.type){let K=w;F.classBreakInfos.forEach(P=>{K=e(K,P.symbol)});return K}return w};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/layers/graphics/GraphicState":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Evented ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/decorators/subclass".split(" "),
function(b,e,c,m,w,F,K,P,z){b.GraphicState=function(t){function D(a){a=t.call(this,a)||this;a.tracking=!1;a.displaying=!1;a.isDraped=!1;return a}e._inherits(D,t);return e._createClass(D)}(m.EventedAccessor);c.__decorate([w.property({constructOnly:!0})],b.GraphicState.prototype,"graphic",void 0);c.__decorate([w.property()],b.GraphicState.prototype,"tracking",void 0);c.__decorate([w.property()],b.GraphicState.prototype,"displaying",void 0);c.__decorate([w.property()],b.GraphicState.prototype,"isDraped",
void 0);b.GraphicState=c.__decorate([z.subclass("esri.views.3d.layers.graphics.GraphicState")],b.GraphicState);Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/drapedUtils":function(){define(["exports","../../geometry","../../core/unitUtils","../../renderers/support/clickToleranceUtils","../../geometry/Extent"],function(b,e,c,m,w){function F(P,z,t,D=new w){let a=0;if("2d"===t.type)a=z*(t.resolution??0);else if("3d"===t.type){var g=t.overlayPixelSizeInMapUnits(P),
u=t.basemapSpatialReference;a=null==u||u.equals(t.spatialReference)?z*g:c.getMetersPerUnitForSR(u)/c.getMetersPerUnitForSR(t.spatialReference)}z=P.x-a;g=P.y-a;u=P.x+a;P=P.y+a;({spatialReference:t}=t);D.xmin=Math.min(z,u);D.ymin=Math.min(g,P);D.xmax=Math.max(z,u);D.ymax=Math.max(g,P);D.spatialReference=t;return D}const K=new w;b.createQueryGeometry=F;b.intersectsDrapedGeometry=function(P,z,t){P=t.toMap(P);if(null==P)return!1;const D=m.calculateTolerance();return F(P,D,t,K).intersects(z)};Object.defineProperty(b,
Symbol.toStringTag,{value:"Module"})})},"esri/views/support/hitTestSelectUtils":function(){define(["exports"],function(b){function e(c){return"graphic"===c?.type}b.filterGraphicHits=function(c){return c.filter(e)};b.findFirstGraphicHit=function(c){return c.find(e)??null};b.hitTestSelectSimilarDistance=async function(c,m){if("2d"===c.type)return c.hitTest(m);c=await c.hitTest(m);if(0===c.results.length)return c;const w=1.05*(c.results[0].distance??0);m=c.results.findIndex(F=>(F.distance??0)>w);-1!==
m&&(c.results=c.results.slice(0,m));return c};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/Workflow":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Error ../../core/Evented ../../core/HandleOwner ../../core/maybe ../../core/promiseUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a){m=function(g){function u(k){k=g.call(this,k)||this;k._indexHistory=[];k._lastStepIndex=-1;k._stepIndex=-1;k._setupAbortController=null;k._handleKeys={afterCommit:"after-commit",beforeCommit:"before-commit"};k.data=void 0;k.started=!1;k.steps=[];k.type=null;return k}b._inherits(u,g);var v=u.prototype;v.back=async function(k=()=>Promise.resolve(!0)){if(!this.hasPendingEdits||await k())this.hasPreviousStep?await this.previous({cancelCurrentStep:!0}):await this.cancel({force:!0})};
v.cancel=async function(k={force:!0}){return!1!==k.force?this._cancel(k):new Promise((n,p)=>{this.emit("cancel-request",{controller:{allow:()=>{this._cancel({...k,force:!0}).then(n)},deny:()=>p(new c("workflow:cancel-denied","Request to cancel workflow was denied."))}})})};v.commit=async function(){this.handles.remove(this._handleKeys.beforeCommit);await this.onCommit?.(this.data);this.handles.remove(this._handleKeys.afterCommit);this.emit("commit")};v.go=async function(k){var {steps:n}=this;n=n.findIndex(p=>
p.id===k);this._indexHistory.push(this._stepIndex);await this._go(n)};v.next=async function(){this._indexHistory.push(this._stepIndex);await this._go(this._stepIndex+1)};v.previous=async function(k={cancelCurrentStep:!1}){await this._go(this._indexHistory.pop(),k.cancelCurrentStep)};v.reset=async function(){await this._cancel({notify:!1});await this.start()};v.save=async function(){await this.commit();await this.reset()};v.start=async function(){this._set("started",!0);await this._go(-1===this._stepIndex?
0:this._stepIndex)};v._cancel=async function({notify:k=!0,error:n}={}){this.started&&(this._set("started",!1),await this.steps[this._stepIndex].tearDown({canceled:!0}));this.handles.remove([this._handleKeys.afterCommit,this._handleKeys.beforeCommit]);this._resetIndexing(k);k&&this.emit("cancel",{error:n})};v._go=async function(k=-1,n=!1){const {steps:p}=this;if(!(-1>=k||k>=p.length))if(this.started){-1<this._lastStepIndex&&(this._setupAbortController=F.abortMaybe(this._setupAbortController),await p[this._lastStepIndex].tearDown({canceled:n}));
this._setupAbortController=new AbortController;n=this._setupAbortController.signal;try{await p[k].setUp(n)}catch(y){K.throwIfNotAbortError(y)}this._setupAbortController.signal===n&&(this._setupAbortController=null);n.aborted||(this._stepIndex=this._lastStepIndex=k,this._notifyStepProps())}else this._stepIndex=k,this._notifyStepProps()};v._resetIndexing=function(k=!0){this._lastStepIndex=this._stepIndex=-1;this._indexHistory.length=0;k&&this._notifyStepProps()};v._notifyStepProps=function(){this.notifyChange("stepId");
this.notifyChange("hasPreviousStep");this.notifyChange("hasNextStep")};b._createClass(u,[{key:"hasNextStep",get:function(){const {steps:k}=this;return!!(k&&this._stepIndex<k.filter(n=>!n.parent).length-1)}},{key:"hasPreviousStep",get:function(){return 0<this._stepIndex}},{key:"reliesOnOwnerAdminPrivileges",get:function(){return!1}},{key:"hasInvalidFormTemplate",get:function(){return!1}},{key:"hasUnsupportedFields",get:function(){return!1}},{key:"shouldShowAttachments",get:function(){return!1}},{key:"shouldAllowAttachmentEditing",
get:function(){return!1}},{key:"stepId",get:function(){var {steps:k}=this;return(k=k&&k[this._stepIndex])&&k.id}},{key:"helpMessage",get:function(){}},{key:"hasPendingEdits",get:function(){return!1}},{key:"keyboardCancellationEnabled",get:function(){return!0}}]);return u}(w.HandleOwnerMixin(m.EventedAccessor));e.__decorate([P.property()],m.prototype,"data",void 0);e.__decorate([P.property()],m.prototype,"hasNextStep",null);e.__decorate([P.property()],m.prototype,"hasPreviousStep",null);e.__decorate([P.property()],
m.prototype,"onCommit",void 0);e.__decorate([P.property()],m.prototype,"reliesOnOwnerAdminPrivileges",null);e.__decorate([P.property()],m.prototype,"hasInvalidFormTemplate",null);e.__decorate([P.property()],m.prototype,"hasUnsupportedFields",null);e.__decorate([P.property()],m.prototype,"shouldShowAttachments",null);e.__decorate([P.property()],m.prototype,"shouldAllowAttachmentEditing",null);e.__decorate([P.property()],m.prototype,"started",void 0);e.__decorate([P.property({readOnly:!0})],m.prototype,
"stepId",null);e.__decorate([P.property()],m.prototype,"steps",void 0);e.__decorate([P.property({readOnly:!0})],m.prototype,"type",void 0);e.__decorate([P.property()],m.prototype,"helpMessage",null);e.__decorate([P.property()],m.prototype,"hasPendingEdits",null);e.__decorate([P.property()],m.prototype,"keyboardCancellationEnabled",null);return m=e.__decorate([a.subclass("esri.widgets.Editor.Workflow")],m)})},"esri/widgets/Editor/CreateWorkflow":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../layers/support/layerUtils ../../views/draw/support/helpMessageUtils ./CreateWorkflowData ./Edits ./Workflow ./workflowUtils".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a,g,u){var v;w=v=function(k){function n(p){p=k.call(this,p)||this;p.type="create";return p}b._inherits(n,k);n.create=function(p,y,O){p=new v({data:new D({edits:new a.Edits,viewModel:p}),onCommit:async C=>{await O(C.creationInfo.layer,{addFeatures:[C.edits.feature]})}});p._set("steps",this._createWorkflowSteps(p,y));return p};n._createWorkflowSteps=function(p,y="awaiting-feature-creation-info"){const {data:O,handles:C}=p,f=new Map;p=u.createWorkflowSteps(["awaiting-feature-creation-info",
"awaiting-feature-to-create","editing-new-feature","adding-attachment","editing-attachment"],y,{"awaiting-feature-creation-info":()=>({id:"awaiting-feature-creation-info",async setUp(){O.creationInfo=null;O.edits.feature=null;O.viewModel.featureTemplatesViewModel.select(null);C.add(O.viewModel.featureTemplatesViewModel.on("select",({item:h})=>{h&&(O.creationInfo=h,O.viewModel.activeWorkflow?.next())}),this.id)},async tearDown(){C.remove(this.id)}}),"awaiting-feature-to-create":()=>({id:"awaiting-feature-to-create",
async setUp(){C.add(await u.setUpFeatureAdd(O.viewModel.sketchViewModel,O.creationInfo,h=>{O.edits.feature=h;O.viewModel.activeWorkflow?.next()},f),this.id)},async tearDown(){C.remove(this.id)}}),"editing-new-feature":()=>({id:"editing-new-feature",async setUp(){const h=O.edits.feature,d=h.sourceLayer,l=O.viewModel,q=l.sketchViewModel;var H=u.findLayerInfo(l.layerInfos,d);const {spatialReference:N}=l.view;l.featureFormViewModel.set({arcadeEditType:"INSERT",feature:h,formTemplate:H?.formTemplate,spatialReference:N});
q.allowDeleteKey=!1;u.prepareAttachmentsForCreateWorkflow(l.attachmentsViewModel);const E=u.getVisualVariableAttributes(h);await u.startUpdatingFeature({graphic:h,sketchViewModel:q,sourceLayer:d,visualVariables:E,webStyleCache:f});H=q.on("update",async r=>{var I=r.graphics[0];if("complete"===r.state)return u.startUpdatingFeature({graphic:I,sketchViewModel:q,sourceLayer:d,visualVariables:E,webStyleCache:f});await u.visualVariableInteractiveUpdate(q.view,I,r,E,f);r=I.attributes;null!=E.rotation&&({field:I}=
E.rotation,l.featureFormViewModel.setValue(I,r[I]));null!=E.size&&({field:I}=E.size,l.featureFormViewModel.setValue(I,r[I]))});C.add([O.viewModel.featureFormViewModel.on("value-change",async()=>{O.edits.updateAttributes(O.viewModel.featureFormViewModel.getValues());h.attributes=O.edits.feature.attributes;"3d"===q.view.type&&await u.updateGraphicSymbolWhenRequired(h,f)}),H,c.watch(()=>O.viewModel.attachmentsViewModel.mode,r=>{"add"===r&&O.viewModel.activeWorkflow.go("adding-attachment");"edit"===r&&
O.viewModel.activeWorkflow.go("editing-attachment")})],this.id)},async tearDown(h){h.canceled&&O.viewModel.sketchViewModel.layer.removeAll();C.remove(this.id)}}),"adding-attachment":()=>({id:"adding-attachment",parent:"editing-new-feature",async setUp(){},async tearDown(){O.viewModel.attachmentsViewModel.mode="view"}}),"editing-attachment":()=>({id:"editing-attachment",parent:"editing-new-feature",async setUp(){},async tearDown(){O.viewModel.attachmentsViewModel.mode="view"}})});return u.avoidFeatureTemplateSelectionWithOnlyOneItem(O,
p)};b._createClass(n,[{key:"shouldShowAttachments",get:function(){return this.data&&this.data.creationInfo&&this.data.viewModel?u.shouldShowAttachmentsForCreateWorkflow(this.data):!1}},{key:"shouldAllowAttachmentEditing",get:function(){return this.shouldShowAttachments}},{key:"hasPendingEdits",get:function(){return!0}},{key:"helpMessage",get:function(){if("editing-new-feature"===this.stepId){var {creationInfo:p,viewModel:y}=this.data;return t.getDrawHelpMessage(p.layer.geometryType,y.sketchViewModel.createGraphic?.geometry,
y.view)}}},{key:"reliesOnOwnerAdminPrivileges",get:function(){const {layer:p}=this.data.creationInfo,y=p.capabilities?.operations.supportsAdd,O=z.getEffectiveLayerCapabilities(p)?.operations.supportsAdd;return z.getEffectiveEditingEnabled(p)&&!p.editingEnabled||!!O&&!y}}]);return n}(g);e.__decorate([m.property()],w.prototype,"shouldShowAttachments",null);e.__decorate([m.property()],w.prototype,"shouldAllowAttachmentEditing",null);e.__decorate([m.property()],w.prototype,"hasPendingEdits",null);e.__decorate([m.property()],
w.prototype,"helpMessage",null);e.__decorate([m.property()],w.prototype,"reliesOnOwnerAdminPrivileges",null);return w=v=e.__decorate([P.subclass("esri.widgets.Editor.CreateWorkflow")],w)})},"esri/widgets/Editor/CreateWorkflowData":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,e,c,m,w,F,K,P){c=function(z){function t(D){D=z.call(this,D)||this;D.creationInfo=null;D.edits=null;D.viewModel=null;return D}b._inherits(t,z);return b._createClass(t)}(c);e.__decorate([m.property()],c.prototype,"creationInfo",void 0);e.__decorate([m.property()],c.prototype,"edits",void 0);e.__decorate([m.property()],c.prototype,"viewModel",void 0);return c=e.__decorate([P.subclass("esri.widgets.Editor.CreateWorkflowData")],c)})},"esri/widgets/Editor/Edits":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/HandleOwner ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,e,c,m,w,F,K,P,z,t){function D(a){return null==a?null:JSON.stringify(a)}b.Edits=function(a){function g(v){v=a.call(this,v)||this;v._baselineAttributesJSON=null;v._baselineGeometryJSON=null;v._stagedForDelete=!1;v.feature=null;return v}e._inherits(g,a);var u=g.prototype;u.stageDelete=function(){this._stagedForDelete=!0};u.unstageDelete=function(){this._stagedForDelete=!1};u.trackChanges=function(){const {feature:v}=this;if(v){var {attributes:k,geometry:n}=v;this._baselineAttributesJSON=this._stringifyAttributes(k);
this._baselineGeometryJSON=this._stringifyGeometry(n);this.notifyChange("attributesModified");this.notifyChange("geometryModified")}};u.updateAttributes=function(v){const {feature:k}=this;k&&(k.attributes=v,this.notifyChange("attributesModified"))};u.updateGeometry=function(v){const {feature:k}=this;k&&(k.geometry=v,this.notifyChange("geometryModified"))};u._stringifyAttributes=function(v){return D(v)};u._stringifyGeometry=function(v){return"mesh"===v?.type?D({transform:v.transform,vertexSpace:v.vertexSpace}):
D(v)};e._createClass(g,[{key:"attributesModified",get:function(){const v=this.feature?.attributes;return null!=v&&this._baselineAttributesJSON!==this._stringifyAttributes(v)}},{key:"geometryModified",get:function(){const v=this.feature?.geometry;return null!=v&&this._baselineGeometryJSON!==this._stringifyGeometry(v)}},{key:"stagedForDelete",get:function(){return this._stagedForDelete}},{key:"modified",get:function(){return this.attributesModified||this.geometryModified||this._stagedForDelete}}]);
return g}(w.HandleOwnerMixin(m));c.__decorate([F.property()],b.Edits.prototype,"_stagedForDelete",void 0);c.__decorate([F.property()],b.Edits.prototype,"attributesModified",null);c.__decorate([F.property()],b.Edits.prototype,"feature",void 0);c.__decorate([F.property()],b.Edits.prototype,"geometryModified",null);c.__decorate([F.property()],b.Edits.prototype,"modified",null);b.Edits=c.__decorate([t.subclass("esri.widgets.Editor.Edits")],b.Edits);Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},
"esri/widgets/Editor/UpdateWorkflow":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Graphic ../../core/Error ../../core/handleUtils ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/Queue ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../layers/support/editableLayers ../../layers/support/layerUtils ../../views/support/layerViewUtils ./CreateFeaturesWorkflow ./UpdateFeatureWorkflow ./UpdateRecordWorkflow ./UpdateWorkflowData ./Workflow ./workflowUtils ../Feature/support/featureUtils".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a,g,u,v,k,n,p,y,O,C,f,h,d,l){var q;const H=F.getLogger("esri.widgets.Editor.UpdateWorkflow");F=q=function(E){function r(M){M=E.call(this,M)||this;M._workflowStack=new z(S=>{let U;for(U of S);return U});M.type="update";return M}b._inherits(r,E);var I=r.prototype;I.back=async function(M=()=>Promise.resolve(!0)){const {featureFormViewModel:S}=this.data.viewModel;if(null!=S.relationshipId)S.relationshipId=null;else if(this.activeWorkflow){if(!this.activeWorkflow.hasPendingEdits||
await M())this.activeWorkflow.hasPreviousStep?await this.activeWorkflow.previous({cancelCurrentStep:!0}):await this.cancelActiveWorkflow({force:!0})}else this.hasPreviousStep?await this.previous({cancelCurrentStep:!0}):await this.cancel({force:!0})};I.cancelActiveWorkflow=async function(M){await this.activeWorkflow?.cancel(M);await this._popWorkflow()};I.commit=async function(){await this._drainWorkflowStack(M=>M.commit());await b._get(b._getPrototypeOf(r.prototype),"commit",this).call(this)};r.create=
function(M,S,U){M=new q({data:new f({applyEditsCallback:U,viewModel:M}),onCommit:async()=>{}});M._set("steps",this._createWorkflowSteps(M,S));return M};I.save=async function(){1<this.nestedWorkflowCount?(await this.activeWorkflow?.commit(),await this._popWorkflow()):await this.commit()};I.startCreatingRelatedRecord=async function(M){try{const S=await this._createNestedCreateFeaturesWorkflow(M);await this._pushWorkflow(S)}catch(S){throw new m("editor:unable-to-start-creating","Could not begin updating the provided feature or table record.",
{error:S});}};I.startUpdating=async function(M){try{const S=await this._createNestedUpdateWorkflow(M);await this._pushWorkflow(S)}catch(S){throw new m("editor:unable-to-start-updating","Could not begin updating the provided feature or table record.",{error:S});}};I.deleteActiveFeature=async function(){const {activeWorkflow:M}=this;if(!M)throw new m("editor:nothing-to-delete","There is no feature to delete");M&&/update-/.test(M.type)?await M.deleteAndCommit():await M.cancel();1===this.nestedWorkflowCount?
await this.reset():await this._popWorkflow()};I.cancelAll=async function(){await this._drainWorkflowStack(M=>M.cancel({force:!0}))};I._createNestedCreateFeaturesWorkflow=async function(M){const {relatedLayer:S}=M,{addAttachmentsCallback:U,applyEditsCallback:G,viewModel:J}=this.data;if(!k.isEditableLayer(S))throw new m("editor:unsupported-layer","Editing is not supported on the provided layer");M=new c({sourceLayer:S,attributes:this._makeRelatedRecordAttributes(M)});return y.create({addAttachmentsCallback:U,
applyEditsCallback:G,creationInfo:{layer:S,initialFeature:M,maxFeatures:1},startAt:"creating-features",viewModel:J})};I._createNestedUpdateWorkflow=async function(M){const S=n.isTable(M.sourceLayer)?C.UpdateRecordWorkflow:O.UpdateFeatureWorkflow,{applyEditsCallback:U,viewModel:G}=this.data,J=await S.create({feature:M,viewModel:G,applyEdits:U});await t.whenOnce(()=>!J.updating);return J};I._drainWorkflowStack=async function(M){const S=this._workflowStack,U=[];for(;0<S.length;){const G=S.pop(),J=M(G).then(()=>
G.destroy());this.updatingHandles.addPromise(J);U.push(J)}await Promise.all(U)};I._highlight=function(M){this._removeHighlight();var S=this.data.viewModel.view;S&&M&&(S=M&&S.allLayerViews.items.find(({layer:U})=>U===M.layer||"subtype-sublayer"===M.layer?.type&&M.layer?.parent===U),p.highlightsSupported(S)&&this.handles.add(S.highlight(M),"candidate-highlight"))};I._makeRelatedRecordAttributes=function(M){const {parentFeature:S,relatedLayer:U,relationshipId:G}=M;if(l.isGraphicForRelatableFeatureSupportedLayer(S))if(M=
U.relationships?.find(L=>L.id===G))if("origin"===M.role)N("unsupported-role","Creating new related records in the 'origin' table of a relationship is not yet supported");else{var J=S.sourceLayer;M.relatedTableId!==J.layerId&&N("invalid-argument-combination","The given parent feature does not belong to the relationship designated by the given relationship ID.");if(J=J.relationships?.find(L=>L.id===G))return(J=S.getAttribute(J.keyField))||N("no-key-on-origin-feature","The given parent feature does not have a value for the relationship's origin primary key field."),
{[M.keyField]:J};N("relationship-not-found","Could not begin creating a related record because the relationship specified could not be found on the origin layer.")}else N("relationship-not-found","Could not begin creating a related record because the relationship specified could not be found on the destination layer.")};I._popWorkflow=async function(){this._workflowStack.pop()?.destroy();const M=await this._reconcileWorkflowStack();if(0<M.failureCount)throw new m("editor:next-workflow-failed","Popped the top workflow, but the next workflow in the stack failed to activate",
M);};I._pushWorkflow=async function(M){const S=this._workflowRequiresSketchViewModel(M);this.activeWorkflow?.exit({removeSketchHandles:S});await M.start();this._workflowStack.push(M);M=await this._reconcileWorkflowStack();if(0<M.failureCount)throw new m("editor:failed-to-start-updating-feature","Failed to enter the provided workflow.",M);};I._reconcileWorkflowStack=async function(){const M=this._workflowStack;try{const S=M.peek();await S?.enter();return{activeWorkflow:S,failureCount:0}}catch(S){M.pop().destroy();
const {activeWorkflow:U,failureCount:G}=await this._reconcileWorkflowStack();return{activeWorkflow:U,failureCount:G+1}}};I._removeHighlight=function(){this.handles.remove("candidate-highlight")};I._workflowRequiresSketchViewModel=function(M){const {type:S}=M;return"update-features"===S||"create-features"===S&&!n.isTable(M.data.creationInfo?.layer)};r._createWorkflowSteps=function(M,S="awaiting-feature-to-update"){const {data:U,handles:G}=M;return d.createWorkflowSteps(["awaiting-feature-to-update",
"awaiting-update-feature-candidate","editing-existing-feature","adding-attachment","editing-attachment"],S,{"awaiting-feature-to-update":()=>({id:"awaiting-feature-to-update",async setUp(){const {spinnerViewModel:J}=U.viewModel,L=U.viewModel.view;let B=null;G.add(w.makeHandle(()=>{B=K.abortMaybe(B)}),this.id);U.rootFeature=null;U.candidates=[];const A=L.on("immediate-click",async x=>{J.location=x.mapPoint;J.visible=!0;B?.abort();const {editableItems:Q}=U.viewModel;B=new AbortController;const T=await new Promise((W,
aa)=>{P.onAbort(B?.signal,()=>aa(P.createAbortError()));W(d.fetchCandidates(Q,L,x,B?.signal))});P.throwIfAborted(B);U.candidates=T.reduce((W,aa)=>aa.error?W:[...W,...aa.value],[]);J.visible=1===U.candidates.length;0!==U.candidates.length&&(1===U.candidates.length?(U.rootFeature=U.candidates[0],M.go("editing-existing-feature").catch(()=>{}).then(()=>J.visible=!1)):M.next())});L.focus();G.add(A,this.id)},async tearDown(){G.remove(this.id)}}),"awaiting-update-feature-candidate":()=>({id:"awaiting-update-feature-candidate",
async setUp(){U.rootFeature=null;G.add([t.watch(()=>U.rootFeature,J=>M._highlight(J),t.sync),w.makeHandle(()=>M._removeHighlight())],this.id)},async tearDown(){G.remove(this.id)}}),"editing-existing-feature":()=>({id:"editing-existing-feature",async setUp(){const {rootFeature:J,viewModel:L}=M.data;if(!J)throw new m("editor:no-feature-specified","Cannot setup the 'updating-existing-feature' step until the root feature is defined");await M.startUpdating(J);L.spinnerViewModel.visible=!1;const B=P.debounce(async()=>
{await t.whenOnce(()=>!M.updating);M.previous()}),{featureFormViewModel:A}=U.viewModel,x=A.relatedRecordCallbacks;A.relatedRecordCallbacks={addRelatedRecord:async Q=>{await M.startCreatingRelatedRecord(Q);A.relationshipId=null},editRelatedRecord:async({relatedFeature:Q})=>{await M.startUpdating(Q);A.relationshipId=null},showAllRelatedRecords:Q=>A.relationshipId=Q.relationshipId};G.add([w.makeHandle(()=>A.relatedRecordCallbacks=x),t.watch(()=>M.nestedWorkflowCount,(Q,T)=>{0===Q&&0!==T&&B()},t.sync)],
this.id)},async tearDown(){await M.cancelAll();G.remove(this.id)}}),"adding-attachment":()=>({id:"adding-attachment",parent:"editing-existing-feature",async setUp(){},async tearDown(){U.viewModel.attachmentsViewModel.mode="view"}}),"editing-attachment":()=>({id:"editing-attachment",parent:"editing-existing-feature",async setUp(){},async tearDown(){U.viewModel.attachmentsViewModel.mode="view"}})})};b._createClass(r,[{key:"activeEditableItem",get:function(){const {activeWorkflow:M}=this;return M&&/update-/.test(M.type)?
M.data.editableItem:void 0}},{key:"activeWorkflow",get:function(){return this._workflowStack.last()}},{key:"nestedWorkflowCount",get:function(){return this._workflowStack.length}},{key:"shouldShowAttachments",get:function(){return!!this.activeEditableItem?.attachmentsOnUpdateEnabled}},{key:"shouldAllowAttachmentEditing",get:function(){return!!this.activeEditableItem?.supports.includes("update")}},{key:"hasPendingEdits",get:function(){return Array.from(this._workflowStack).some(M=>M.hasPendingEdits)}},
{key:"helpMessage",get:function(){return"awaiting-feature-to-update"===this.stepId?"select":void 0}},{key:"reliesOnOwnerAdminPrivileges",get:function(){return this.activeWorkflow?.reliesOnOwnerAdminPrivileges??!1}},{key:"hasInvalidFormTemplate",get:function(){return!!this.activeEditableItem?.hasInvalidFormTemplate}},{key:"hasUnsupportedFields",get:function(){return!!this.activeEditableItem?.hasUnsupportedFields}},{key:"updating",get:function(){return this.updatingHandles.updating}}]);return r}(h);
e.__decorate([D.property()],F.prototype,"activeEditableItem",null);e.__decorate([D.property()],F.prototype,"activeWorkflow",null);e.__decorate([D.property()],F.prototype,"nestedWorkflowCount",null);e.__decorate([D.property()],F.prototype,"shouldShowAttachments",null);e.__decorate([D.property()],F.prototype,"shouldAllowAttachmentEditing",null);e.__decorate([D.property()],F.prototype,"hasPendingEdits",null);e.__decorate([D.property()],F.prototype,"helpMessage",null);e.__decorate([D.property()],F.prototype,
"reliesOnOwnerAdminPrivileges",null);e.__decorate([D.property()],F.prototype,"hasInvalidFormTemplate",null);e.__decorate([D.property()],F.prototype,"hasUnsupportedFields",null);e.__decorate([D.property()],F.prototype,"updating",null);F=q=e.__decorate([v.subclass("esri.widgets.Editor.UpdateWorkflow")],F);const N=(E,r)=>H.warn(`editor:${E}`,r,"The create operation will be allowed to proceed, but the resulting feature may not be related to the given parent feature.");return F})},"esri/views/support/layerViewUtils":function(){define(["exports"],
function(b){b.extractSafeScaleBounds=function(e){e=e.effectiveScaleRange;return{minScale:e?.minScale??0,maxScale:e?.maxScale??0}};b.highlightsSupported=function(e){return e&&"function"===typeof e.highlight};b.isScaleRangeActive=function(e,c){return null!=e&&0<e||null!=c&&0<c};b.occludeesSupported=function(e){return e&&"function"===typeof e.maskOccludee};b.scaleBoundsPredicate=function(e,c,m){return null==e||e>m&&(0===c||e<c)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/UpdateFeatureWorkflow":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Error ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../support/featureFlags ../../views/support/layerViewUtils ./UpdateFeatureWorkflowData ./UpdateRecordWorkflow ./workflowUtils".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a,g,u){var v;const k={...g.HANDLE_KEYS,highlights:Symbol(),interactiveGraphics:Symbol(),geometryGraphics:Symbol()};b.UpdateFeatureWorkflow=v=function(n){function p(O){O=n.call(this,O)||this;O.type="update-feature";O._layerViewEditSession=null;O._webStyleCache=new Map;return O}e._inherits(p,n);var y=p.prototype;y.initialize=async function(){const {edits:{feature:O},layerView:C}=this.data;u.canCreateInteractiveEditSession(C)&&(this._layerViewEditSession=C.createInteractiveEditSession(O))};
y.destroy=function(){this._layerViewEditSession?.rollback()};y.commit=async function(){this.removeHandles(k.interactiveGraphics);try{const O=this.data.edits.stagedForDelete;await e._get(e._getPrototypeOf(p.prototype),"commit",this).call(this);this.removeHandles(k.geometryGraphics);const C=this._layerViewEditSession;O?C?.rollback():C?.commit()}catch(O){throw this.removeHandles(k.geometryGraphics),await this._configureSketchViewModel(),new m("editor-workflow:failed-to-commit","An error occurred when sending the updates to the service",
{error:O});}};y.enter=async function(){await e._get(e._getPrototypeOf(p.prototype),"enter",this).call(this);this.data.editableItem.geometryUpdatesEnabled?this.hasHandles(k.interactiveGraphics)||await this._configureSketchViewModel():this._configureHighlight()};y.exit=function(O={removeSketchHandles:!0}){e._get(e._getPrototypeOf(p.prototype),"exit",this).call(this,O);O.removeSketchHandles&&this.removeHandles([k.geometryGraphics,k.interactiveGraphics])};y._configureFeatureFormViewModel=function(){e._get(e._getPrototypeOf(p.prototype),
"_configureFeatureFormViewModel",this).call(this);const {_layerViewEditSession:O}=this,{viewModel:C}=this.data;this.addHandles(C.featureFormViewModel.on("value-change",f=>{O?.setAttribute(f.fieldName,f.value)}),k.exit)};y._configureHighlight=function(){const {edits:O,layerView:C}=this.data;D.highlightsSupported(C)&&this.addHandles(C.highlight(O.feature),k.highlights)};y._configureSketchViewModel=async function(){const {data:O,_layerViewEditSession:C}=this,{edits:f,viewModel:h}=O,d=f.feature,{featureFormViewModel:l,
sketchViewModel:q,view:H}=h;q.allowDeleteKey=!1;const N=u.getVisualVariableAttributes(d),{interactive:E,visual:r}=await u.setUpGeometryUpdate(d,N,q,H,({geometry:I,attributes:M},S)=>{f.updateAttributes(M);f.updateGeometry(I);l.feature.geometry=I;if(null!=N.rotation){var {field:U}=N.rotation;l.setValue(U,M[U])}null!=N.size&&({field:U}=N.size,l.setValue(U,M[U]));({sourceLayer:M}=d);null!=M&&"scene"===M.type&&null!=M.infoFor3D&&t.sceneLayerEditingEnabled()&&t.i3sPatchingEnabled()&&C&&null!=I&&"mesh"===
I.type&&C.setGeometry(I);("undo"===S.type||"redo"===S.type||"update"===S.type&&null!=S.toolEventInfo&&u.isTerminalUpdateEventType(S.toolEventInfo.type))&&l.notifyFeatureGeometryChanged()},this._webStyleCache);this.addHandles(E,k.interactiveGraphics);this.addHandles(r,k.geometryGraphics)};y._onFullFeatureLoaded=function(O){e._get(e._getPrototypeOf(p.prototype),"_onFullFeatureLoaded",this).call(this,O);const {edits:C}=this.data;C.updateGeometry(O.geometry);C.trackChanges()};p.create=async function(O){O=
new v({data:await a.create(O),onCommit:this._onCommitFactory(O.applyEdits)});O._set("steps",this._createWorkflowSteps(O));return O};return e._createClass(p)}(g.UpdateRecordWorkflow);c.__decorate([w.property()],b.UpdateFeatureWorkflow.prototype,"_layerViewEditSession",void 0);b.UpdateFeatureWorkflow=v=c.__decorate([z.subclass("esri.widgets.Editor.UpdateFeatureWorkflow")],b.UpdateFeatureWorkflow);b.HANDLE_KEYS=k;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/UpdateFeatureWorkflowData":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Error ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./UpdateRecordWorkflowData ./workflowUtils".split(" "),
function(b,e,c,m,w,F,K,P,z,t){var D;w=D=function(a){function g(u){return a.call(this,u)||this}b._inherits(g,a);g.create=async function(u){const {feature:v,viewModel:k}=u;var {view:n}=k;if(!n)throw new c("editor:cannot-create-workflow-data","The provided EditorViewModel does not have an associated view");n=await t.whenEditorLayerView(n,v.layer);return new D({...D._makeConstructorProps(u),layerView:n})};return b._createClass(g)}(z);e.__decorate([m.property()],w.prototype,"layerView",void 0);return w=
D=e.__decorate([P.subclass("esri.widgets.Editor.UpdateFeatureWorkflowData")],w)})},"esri/widgets/Editor/UpdateRecordWorkflowData":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Error ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./Edits ./workflowUtils".split(" "),function(b,e,c,m,w,F,K,P,z,t,D){var a;c=a=function(g){function u(v){v=
g.call(this,v)||this;v.attachmentsCapabilities=null;v.editableItem=null;v.edits=null;v.formTemplate=null;v.viewModel=null;return v}b._inherits(u,g);u.create=async function(v){v=a._makeConstructorProps(v);return new a(v)};u._makeConstructorProps=function(v){const {feature:k,viewModel:n}=v;v=n.editableItems.find(C=>C.layer===k.layer);if(!v)throw new m("no-editableItem-found","The EditorViewModel provided did not have an EditableItem associated with the specified Graphic's layer");const p=D.findLayerInfo(n.layerInfos,
k.sourceLayer);var y=v.supports;const O=y.includes("create");y=y.includes("update");return{attachmentsCapabilities:{editing:!0,operations:{add:O||y,update:y,delete:y}},editableItem:v,edits:new t.Edits({feature:k}),formTemplate:p?.formTemplate,viewModel:n}};return b._createClass(u)}(c);e.__decorate([w.property()],c.prototype,"attachmentsCapabilities",void 0);e.__decorate([w.property()],c.prototype,"editableItem",void 0);e.__decorate([w.property()],c.prototype,"edits",void 0);e.__decorate([w.property()],
c.prototype,"formTemplate",void 0);e.__decorate([w.property()],c.prototype,"viewModel",void 0);return c=a=e.__decorate([z.subclass("esri.widgets.Editor.UpdateRecordWorkflowData")],c)})},"esri/widgets/Editor/UpdateRecordWorkflow":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Error ../../core/handleUtils ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../layers/support/layerUtils ../../support/featureFlags ./UpdateRecordWorkflowData ./Workflow ./workflowUtils".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a,g,u,v,k,n){var p;const y={exit:Symbol()};b.UpdateRecordWorkflow=p=function(O){function C(h){h=O.call(this,h)||this;h.fullFeature=null;h.type="update-table-record";return h}e._inherits(C,O);var f=C.prototype;f.initialize=async function(){const {data:h}=this;var {edits:d}=h;d=d.feature;const l=new AbortController;this.addHandles(w.abortHandle(l));this.updatingHandles.addPromise(n.fetchFullFeature(d,h.viewModel.view.spatialReference,l.signal).then(q=>{F.isAborted(l)||
this._onFullFeatureLoaded(q)},q=>this.cancel({force:!0,error:new m("editor:failed-to-fetch-full-feature","Failed to retrieve all information for this feature. The update cannot proceed.",{detail:{error:q}})})))};f.deleteAndCommit=async function(){this.data.edits.stageDelete();return this.commit()};f.enter=async function(){this._configureAttachmentsViewModel();this._configureFeatureFormViewModel()};f.exit=function(h){this.removeHandles(y.exit)};f._configureAttachmentsViewModel=function(){const {data:h,
fullFeature:d}=this,{attachmentsCapabilities:l,viewModel:q}=h,{attachmentsViewModel:H}=q;H.set({capabilities:l,graphic:d,filesEnabled:!1,mode:"view"});this.addHandles(K.watch(()=>H.mode,N=>{switch(N){case "add":this.go("adding-attachment");break;case "edit":this.go("editing-attachment")}}),y.exit)};f._configureFeatureFormViewModel=function(){const {edits:h,formTemplate:d,viewModel:{featureFormViewModel:l,view:q}}=this.data;l.set({arcadeEditType:"UPDATE",feature:this.fullFeature,formTemplate:d,map:q?.map,
spatialReference:q.spatialReference});this.addHandles(l.on("value-change",()=>{h.updateAttributes(l.getValues());this.fullFeature.attributes=h.feature.attributes}),y.exit)};f._onFullFeatureLoaded=function(h){this.fullFeature=h;const {edits:d}=this.data;d.updateAttributes(h.attributes);d.trackChanges()};C.create=async function(h){h=new p({data:await v.create(h),onCommit:this._onCommitFactory(h.applyEdits)});h._set("steps",this._createWorkflowSteps(h));return h};C._createWorkflowSteps=function(h){const {attachmentsViewModel:d}=
h.data.viewModel;return[{id:"editing-attributes",async setUp(){},async tearDown(){}},{id:"adding-attachment",async setUp(){},async tearDown(){d.mode="view"}},{id:"editing-attachment",async setUp(){},async tearDown(){d.mode="view"}}]};e._createClass(C,[{key:"editableItem",get:function(){return this.data.editableItem}},{key:"hasPendingEdits",get:function(){return this.data.edits.modified}},{key:"shouldShowAttachments",get:function(){return this.editableItem.attachmentsOnUpdateEnabled}},{key:"shouldAllowAttachmentEditing",
get:function(){return this.editableItem.supports.includes("update")}},{key:"updating",get:function(){return this.updatingHandles.updating}},{key:"reliesOnOwnerAdminPrivileges",get:function(){const {layer:h}=this.editableItem,d=h.capabilities?.operations.supportsUpdate,l=g.getEffectiveLayerCapabilities(h)?.operations.supportsUpdate;return g.getEffectiveEditingEnabled(h)&&!h.editingEnabled||!!l&&!d}}]);return C}(k);b.UpdateRecordWorkflow._onCommitFactory=O=>async C=>{({edits:C}=C);const {feature:f}=
C;if(f){var h=f.sourceLayer,d=f.clone();if(!C.attributesModified||C.stagedForDelete){var l=h.objectIdField;d.attributes={[l]:f.getAttribute(l)};u.sceneLayerEditingEnabled()&&u.i3sPatchingEnabled()&&"scene"===h.type&&null!=h.infoFor3D&&(l=h.associatedLayer?.globalIdField,null!=l&&d.setAttribute(l,f.getAttribute(l)))}if(!C.geometryModified||C.stagedForDelete)d.geometry=null;await O(h,{[C.stagedForDelete?"deleteFeatures":"updateFeatures"]:[d]})}};c.__decorate([P.property()],b.UpdateRecordWorkflow.prototype,
"editableItem",null);c.__decorate([P.property()],b.UpdateRecordWorkflow.prototype,"fullFeature",void 0);c.__decorate([P.property()],b.UpdateRecordWorkflow.prototype,"hasPendingEdits",null);c.__decorate([P.property()],b.UpdateRecordWorkflow.prototype,"shouldShowAttachments",null);c.__decorate([P.property()],b.UpdateRecordWorkflow.prototype,"shouldAllowAttachmentEditing",null);c.__decorate([P.property()],b.UpdateRecordWorkflow.prototype,"updating",null);c.__decorate([P.property()],b.UpdateRecordWorkflow.prototype,
"reliesOnOwnerAdminPrivileges",null);b.UpdateRecordWorkflow=p=c.__decorate([a.subclass("esri.widgets.Editor.UpdateRecordWorkflow")],b.UpdateRecordWorkflow);b.HANDLE_KEYS=y;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/UpdateWorkflowData":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,e,c,m,w,F,K,P){c=function(z){function t(D){D=z.call(this,D)||this;D.addAttachmentsCallback=null;D.applyEditsCallback=null;D.candidates=null;D.rootFeature=null;D.viewModel=null;return D}b._inherits(t,z);return b._createClass(t)}(c);e.__decorate([m.property()],c.prototype,"addAttachmentsCallback",void 0);e.__decorate([m.property()],c.prototype,"applyEditsCallback",void 0);e.__decorate([m.property()],c.prototype,"candidates",void 0);e.__decorate([m.property()],c.prototype,"rootFeature",void 0);
e.__decorate([m.property()],c.prototype,"viewModel",void 0);return c=e.__decorate([P.subclass("esri.widgets.Editor.UpdateWorkflowData")],c)})},"esri/widgets/Sketch/SketchViewModel":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../symbols ../../core/Collection ../../core/Error ../../core/Evented ../../core/Handles ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../geometry/ellipsoidUtils ../../geometry/projection ../../geometry/support/coordsUtils ../../geometry/support/spatialReferenceUtils ../../layers/GraphicsLayer ../../views/3d/interactive/editingTools/isSupportedGraphicUtils ../../views/3d/interactive/editingTools/moveGraphic/isSupportedGraphic ../../views/3d/interactive/editingTools/reshapeGraphic/isSupportedGraphic ../../views/3d/interactive/editingTools/transformGraphic/isSupportedGraphic ../../views/draw/support/layerUtils ../../views/input/InputManager ../../views/interactive/keybindings ../../views/interactive/sketch/SketchLabelOptions ../../views/interactive/sketch/SketchTooltipOptions ../../views/interactive/snapping/SnappingManager ../../views/interactive/snapping/SnappingOptions ../../views/interactive/snapping/snappingUtils ../../views/support/hitTestSelectUtils ../../views/support/screenUtils ./support/OperationHandle ../../symbols/SimpleMarkerSymbol ../../symbols/SimpleFillSymbol ../../symbols/SimpleLineSymbol ../../symbols/MeshSymbol3D ../../symbols/FillSymbol3DLayer".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a,g,u,v,k,n,p,y,O,C,f,h,d,l,q,H,N,E,r,I,M,S,U,G,J,L,B,A,x,Q,T){function W(ia){return"polygon"===ia||"rectangle"===ia||"circle"===ia}function aa(ia,na){Z("undo",ia.history.undo,ia.history.redo,na)}function Y(ia,na){Z("redo",ia.history.redo,ia.history.undo,na)}function Z(ia,na,ma,X){if(na=na.pop()){var da=na.updates,fa=[];X.forEach((ca,ka)=>{ka=da[ka];null!=ka&&("geometry"in ka&&null!=ka.geometry&&(fa.push({geometry:ca.geometry}),ca.geometry=ka.geometry),"symbol"in ka&&
null!=ka.symbol&&(fa.push({symbol:ca.symbol}),ca.symbol=ka.symbol),"undo"in ka&&(fa.push(ka),ka[ia](ca)))});ma.push({updates:fa})}}function R(ia){return{updates:ia.map(na=>({geometry:na.geometry}))}}function V(ia){return"requireError"in ia&&"aborted"===ia.requireError}const ba=ia=>Object.freeze(Object.defineProperty({__proto__:null,default:ia},Symbol.toStringTag,{value:"Module"})),ea={defaultZ:0},ha={reshapeOptions:{edgeOperation:"split",shapeOperation:"move",vertexOperation:"move"},enableMoveAllGraphics:!0,
enableRotation:!0,enableScaling:!0,multipleSelectionEnabled:!0,preserveAspectRatio:!1,toggleToolOnClick:!0,enableZ:!0,highlightOptions:{enabled:!0},tool:"transform"};K=function(ia){function na(X){X=ia.call(this,X)||this;X._numUpdating=0;X._handles=new P;X._internalGraphicsLayer=new f({listMode:"hide",internal:!0,title:"SVM Internal"});X._operationHandle=null;X._viewHandles=new P;X.activeFillSymbol=null;X.activeLineSymbol=null;X.activeVertexSymbol=null;X.allowDeleteKey=!0;X.labelOptions=new r;X.layer=
null;X.pointSymbol=new B({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}});X.polygonSymbol=new A({color:[150,150,150,.2],outline:{color:[50,50,50],width:2}});X.polylineSymbol=new x({color:[130,130,130,1],width:2});X.meshSymbol=new Q({symbolLayers:[new T]});X._snappingManager=null;X.tooltipOptions=new I;X.updateGraphics=new w;X.updateOnGraphicClick=!0;X.vertexSymbol=new B({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}});X._moduleLoaderAbortController=
null;X._viewReadyAbortController=null;X._originalPopupEnabled=null;X.defaultCreateOptions=ea;X.defaultUpdateOptions=ha;X.snappingOptions=new S;return X}e._inherits(na,ia);var ma=na.prototype;ma.initialize=function(){this._handles.add([a.on(()=>this.view?.map?.layers,"change",X=>{X.removed.includes(this.layer)&&this.cancel()}),a.on(()=>this.layer?.graphics,"change",X=>{if(null!=this._operationHandle)for(const da of X.removed)this.updateGraphics.includes(da)&&(1<this.updateGraphics.length?this._operationHandle.removeFromSelection(da):
this._operationHandle.cancel())}),a.watch(()=>this.layer?.elevationInfo??null,X=>{X!==this._internalGraphicsLayer.elevationInfo&&(this.cancel(),this._internalGraphicsLayer.elevationInfo=X)},a.syncAndInitial),a.watch(()=>this.view,X=>{t.destroyMaybe(this._snappingManager);X&&(this._snappingManager=new M.SnappingManager({view:X,options:this.snappingOptions}),"2d"===X.type?new Promise((da,fa)=>b(["../../views/2d/interactive/editingTools"],da,fa)):"3d"===X.type&&(new Promise((da,fa)=>b(["../../views/3d/interactive/editingTools"],
da,fa)),new Promise((da,fa)=>b(["../../views/3d/layers/GraphicsLayerView3D"],ca=>da(ba(ca)),fa))))},a.syncAndInitial),a.watch(()=>this.view?.spatialReference,(X,da)=>{X&&da&&!X.equals(da)&&this.cancel()})]);U.setupSnappingToggleHandles(this)};ma.destroy=function(){this.cancel();this._handles=t.destroyMaybe(this._handles);this._viewHandles=t.destroyMaybe(this._viewHandles);this._removeDefaultLayer();this._snappingManager=t.destroyMaybe(this._snappingManager);this._set("view",null);this.emit("destroy")};
ma.cancel=function(){this._moduleLoaderAbortController=t.abortMaybe(this._moduleLoaderAbortController);this._viewReadyAbortController=t.abortMaybe(this._viewReadyAbortController);this._operationHandle&&this._operationHandle.cancel()};ma.complete=function(){this._operationHandle&&this._operationHandle.complete()};ma.delete=function(){const {state:X,updateGraphics:da}=this;if("active"===X&&da.length){const {activeTool:fa,layer:ca}=this,ka=da.toArray();ca.removeMany(ka);this.cancel();this._emitDeleteEvent({graphics:ka,
tool:fa})}};ma.duplicate=function(){if("active"===this.state&&this.updateGraphics.length){const X=this.updateGraphics.map(da=>da.clone()).toArray();this.layer.addMany(X);this.emit("duplicate",{graphics:X,type:"duplicate"});return X}return[]};ma.create=async function(X,da){this.cancel();await this._waitViewReady();const {view:fa,layer:ca}=this;if(!fa||"disabled"===this.state)throw ca||this._logMissingLayer(),D.createAbortError();null!=fa.activeTool&&(fa.activeTool=null);if(X){H.addUniqueLayer(fa,this._internalGraphicsLayer);
var ka=await this._setupCreateOperation(X,da);null==ka||this.destroyed?fa.map.remove(this._internalGraphicsLayer):(ka.on("complete",()=>{if(ka===this._operationHandle){const ra=this.createGraphic,qa=this._operationHandle.cancelled;this._operationHandle.destroy();this._operationHandle=null;this._set("createGraphic",null);this.view&&this.view.map&&this.view.map.remove(this._internalGraphicsLayer);ka.cancelled||null==ra||ca.add(ra);this.emit("create",{graphic:ra,state:qa?"cancel":"complete",tool:X,toolEventInfo:null,
type:"create"})}}),this._operationHandle=ka,fa.ready&&fa.focus())}else this._logError("sketch:missing-parameter","Missing parameter 'tool'.")};ma.update=async function(X,da){this.cancel();await this._waitViewReady();const {layer:fa,view:ca,state:ka}=this;if(!ca||"disabled"===ka)throw fa||this._logMissingLayer(),D.createAbortError();null!=ca.activeTool&&(ca.activeTool=null);const ra=Array.isArray(X)?X:[X];null!=X&&ra&&ra.length?ra.some(qa=>qa.layer!==fa?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."),
!0):null==qa.geometry?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with an unsupported geometry."),!0):!1)||(X=await this._setupUpdateOperation(ra,da),this.destroyed||null==X||V(X)||(H.addUniqueLayer(ca,this._internalGraphicsLayer),this._setUpdateOperationHandle(X,da),this.emit("update",{graphics:ra,state:"start",aborted:!1,tool:X.tool,toolEventInfo:null,type:"update"}))):this._logError("sketch:missing-parameter","Missing parameter 'graphics'.")};
ma._updateSpatialReference=async function(X){const da=this.view;if(da){this._beginAsyncOperation();X=Array.isArray(X)?X:[X];for(const fa of X)null==fa.geometry||"mesh"===fa.geometry.type||C.equals(fa.geometry.spatialReference,da.spatialReference)||(y.canProjectWithoutEngine(fa.geometry.spatialReference,da.spatialReference)||y.isLoaded()||await y.load(),fa.geometry=y.project(fa.geometry,da.spatialReference));this._endAsyncOperation()}else this._logMissingView()};ma.undo=function(){this.canUndo()&&
this._operationHandle?.undo()};ma.redo=function(){this.canRedo()&&this._operationHandle?.redo()};ma.canUndo=function(){return!(!this._operationHandle||!this._operationHandle.canUndo())};ma.canRedo=function(){return!(!this._operationHandle||!this._operationHandle.canRedo())};ma.toggleUpdateTool=function(){this._operationHandle&&this._operationHandle.toggleTool&&this._operationHandle.toggleTool()};ma._getFirstHit=async function(X){var da=this.view;if(!da)return this._logMissingView(),null;if("2d"===
da.type){const ca=[];da.map.allLayers.forEach(ka=>{"vector-tile"!==ka.type&&"imagery"!==ka.type||ca.push(ka)});da=await da.hitTest(X,{exclude:ca});return G.findFirstGraphicHit(da.results)}const fa=[da.map.ground];da.map.allLayers.forEach(ca=>{"integrated-mesh"===ca.type&&fa.push(ca)});X=await da.hitTest(X,{exclude:fa});if(0<X.results.length){const ca=X.results[0];if(null!=ca&&"graphic"===ca.type&&ca.graphic&&(!X.ground.mapPoint||1>da.map.ground.opacity||X.ground.distance-(ca.distance??0)>-Math.min(3*
X.ground.distance,"global"===da.viewingMode?p.getReferenceEllipsoid(da.renderCoordsHelper.spatialReference).radius/da.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY)))return ca}return null};ma._generateViewHandles=function(X){return[X.on("immediate-click",async da=>{var fa="active"===this.state&&"create"===this._operationHandle?.type;if("disabled"!==this.state&&!fa&&this.updateOnGraphicClick){this._beginAsyncOperation();var ca=await da.async(()=>this._getFirstHit(J.createScreenPointFromEvent(da)));
fa=null;null!=ca?(ca=ca.graphic,this.updateGraphics.includes(ca)||ca.layer===this.layer?(da.stopPropagation(),fa=ca):"2d"!==X.type||this._isComponentGraphic(ca)||"active"!==this.state||this.cancel()):"active"===this.state&&this.cancel();null==fa||this.updateGraphics.includes(fa)||await this.update([fa],{...this.defaultUpdateOptions,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions}});this._endAsyncOperation()}},N.ViewEventPriorities.WIDGET)]};ma._setupCreateOperation=async function(X,da){const fa=
this.view;if(!fa)return this._logMissingView(),null;X=await this._setupDrawGraphicTool(X,fa,{hasZ:"3d"===fa.type,...this.defaultCreateOptions,...da});if(null==X)return null;fa.tools.add(X);fa.activeTool=X;return this._setupCreateOperationHandle(X)};ma._setupDrawGraphicTool=async function(X,da,fa){if("multipoint"===X&&"3d"===da.type)return this._logError("sketch:create","Multipoint geometries are not supported in SceneView."),null;if(!da)return this._logMissingView(),null;const ca="rectangle"!==X,
ka="rectangle"!==X;X={view:da,mode:"rectangle"===X||"circle"===X?"hybrid":"click",...fa,snapToScene:!1,geometryType:X,graphicSymbol:this._getGraphicSymbolFromTool(X),snappingManager:this._snappingManager,forceUniformSize:ka,centered:ca};return"2d"===da.type?this._makeDrawGraphicTool2D(X):this._makeDrawGraphicTool3D(X)};ma._makeDrawGraphicTool2D=async function(X){const da=await this._requireModule(new Promise((fa,ca)=>b(["../../views/2d/interactive/editingTools"],fa,ca)));return V(da)||this.destroyed?
null:new da.module.DrawGraphicTool2D({...X,activeVertexSymbol:this.activeVertexSymbol,regularVerticesSymbol:this.vertexSymbol,activeLineSymbol:this.activeLineSymbol,activeFillSymbol:W(X.geometryType)?this.activeFillSymbol:null,tooltipOptions:this.tooltipOptions})};ma._makeDrawGraphicTool3D=async function(X){const da=await this._requireModule(new Promise((ca,ka)=>b(["../../views/3d/interactive/editingTools"],ca,ka)));if(V(da)||this.destroyed)return null;const {elevationInfo:fa}=this.layer;return new da.module.DrawGraphicTool3D({...X,
elevationInfo:fa,snapToScene:null!=fa?"absolute-height"===fa.mode:!0,labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions})};ma._setupCreateOperationHandle=function(X){const da=this.view;if(!da)return this._logMissingView(),null;let fa=null;const ca=X.forceUniformSize,ka=X.centered,ra=[da.on("key-down",ja=>{if(ja.key===E.SKETCH_KEYS.pan)ja.stopPropagation(),ja.repeat||(X.enabled=!1);else if(ja.key===E.SKETCH_KEYS.complete)ja.stopPropagation(),X.completeCreateOperation();else if(ja.key!==
E.SKETCH_KEYS.vertexAdd||ja.repeat)ja.key===E.SKETCH_KEYS.undo?(ja.stopPropagation(),qa.undo()):ja.key===E.SKETCH_KEYS.redo?(ja.stopPropagation(),qa.redo()):ja.key!==E.SKETCH_KEYS.constraint||"rectangle"!==X.geometryType&&"circle"!==X.geometryType||ja.repeat?ja.key!==E.SKETCH_KEYS.center||ja.repeat||(X.centered=!ka,ja.stopPropagation()):(X.forceUniformSize=!ca,ja.stopPropagation());else{const oa=X.drawOperation.geometryType;if("polyline"===oa||"polygon"===oa||"multipoint"===oa)ja.stopPropagation(),
X.drawOperation.commitStagedVertex()}},N.ViewEventPriorities.WIDGET),da.on("key-up",ja=>{ja.key===E.SKETCH_KEYS.pan?X.enabled=!0:ja.key!==E.SKETCH_KEYS.constraint||"rectangle"!==X.geometryType&&"circle"!==X.geometryType?ja.key===E.SKETCH_KEYS.center&&(X.centered=ka,ja.stopPropagation()):(X.forceUniformSize=ca,ja.stopPropagation())},N.ViewEventPriorities.WIDGET),X.on("vertex-add",ja=>{fa=null==fa?"start":"active";switch(ja.operation){case "apply":this.emit("create",{graphic:X.graphic,state:fa,tool:this.activeTool,
toolEventInfo:ja,type:"create"});break;case "undo":this._emitUndoEvent({graphics:[X.graphic],tool:X.geometryType});break;case "redo":this._emitRedoEvent({graphics:[X.graphic],tool:X.geometryType})}}),X.on("cursor-update",ja=>{0<X.drawOperation.numCommittedVertices&&this.emit("create",{graphic:X.graphic,state:"active",tool:this.activeTool,toolEventInfo:{coordinates:ja.vertices[0].coordinates,type:"cursor-update"},type:"create"})}),X.on("vertex-remove",ja=>{switch(ja.operation){case "apply":this.emit("create",
{graphic:X.graphic,state:"active",tool:this.activeTool,toolEventInfo:ja,type:"create"});break;case "undo":this._emitUndoEvent({graphics:[X.graphic],tool:X.geometryType});break;case "redo":this._emitRedoEvent({graphics:[X.graphic],tool:X.geometryType})}}),X.on("complete",ja=>{this._set("createGraphic",ja.graphic);fa="complete";ja.aborted?qa&&qa.cancel():qa&&qa.complete()}),a.watch(()=>this._getGraphicSymbolFromTool(X.geometryType),ja=>{X.graphicSymbol=ja})],qa=new L.CreateOperationHandle({activeComponent:X,
tool:X.geometryType,type:"create",onEnd:()=>{ra.forEach(ja=>ja.remove());ra.length=0;da.tools?.remove(X)},undo:()=>{X.canUndo&&X.undo()},redo:()=>{X.canRedo&&X.redo()},canUndo:()=>X.canUndo,canRedo:()=>X.canRedo});return qa};ma._getGraphicSymbolFromTool=function(X){switch(X){case "point":case "multipoint":return this.pointSymbol;case "polyline":return this.polylineSymbol;case "circle":case "rectangle":case "polygon":return this.polygonSymbol;case "mesh":return this.meshSymbol}};ma._setupUpdateOperation=
async function(X,da){const {layer:fa,view:ca}=this;if(!ca)return this._logMissingView(),null;da={tool:this._defaultUpdateTool,...this.defaultUpdateOptions,...da,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions,...da?.reshapeOptions},highlightOptions:{...this.defaultUpdateOptions.highlightOptions,...da?.highlightOptions}};var ka=da.tool;for(var ra of X)fa.remove(ra),fa.add(ra);if("3d"===ca.type){if(0===X.length)return null;switch(ka){case "move":return this._setupMove3DOperation(X,da,ca,
ka);case "reshape":if(1<X.length)return this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null;ka=l.isSupportedGraphic(X[0]);if(ka===h.SupportedGraphicResult.SUPPORTED)return this._setupReshape3DOperation(X[0],da,ca);this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${h.isSupportedGraphicResultMessage(ka)}).`);return null;case "transform":return this._setupGraphicTransform3DOperation(X,da,ca)}}switch(ka){case "move":return this._setupMove2DOperation(X,
da,ca);case "reshape":if(1<X.length)return this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null;ra=l.isSupportedGraphic(X[0]);if(ra===h.SupportedGraphicResult.SUPPORTED)return this._setupTransformOrReshape2DOperation(X,ka,da,ca);this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${h.isSupportedGraphicResultMessage(ra)}).`);return null;case "transform":return 1===X.length&&(ra=X[0].geometry?.type,"point"===ra||
"multipoint"===ra)&&(ka="reshape"),this._setupTransformOrReshape2DOperation(X,ka,da,ca)}};ma._setupMove3DOperation=async function(X,da,fa,ca,ka=!1){for(var ra of X){const pa=d.isSupportedGraphic(ra);if(pa!==h.SupportedGraphicResult.SUPPORTED)return this._logError("sketch:move",`Move operation not supported for provided graphic(s) (${h.isSupportedGraphicResultMessage(pa)}).`),null}ra=await this._requireModule(new Promise((pa,sa)=>b(["../../views/3d/interactive/editingTools"],pa,sa)));if(V(ra))return ra;
const qa=new ra.module.GraphicMoveTool({view:fa,enableZ:da.enableZ,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions});fa.tools.add(qa);qa.graphics.addMany(X);ka||this.updateGraphics.addMany(X);const ja=[],oa=new L.UpdateOperationHandle({activeComponent:qa,tool:ca,type:"update",onEnd:()=>{ja.forEach(pa=>pa.remove());ja.length=0;fa.tools?.remove(qa);qa.destroyed||qa.destroy()},undo:()=>{aa(oa,this.updateGraphics.toArray());this._emitUndoEvent({graphics:this.updateGraphics.toArray(),
tool:ca})},redo:()=>{Y(oa,this.updateGraphics.toArray());this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:ca})},addToSelection:pa=>{this.updateGraphics.push(pa);qa.graphics.push(pa);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[pa],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:pa=>{const sa=this.updateGraphics.indexOf(pa);oa.history.undo.forEach(ua=>ua.updates.splice(sa,1));
oa.history.redo.forEach(ua=>ua.updates.splice(sa,1));this.updateGraphics.remove(pa);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[pa],type:"selection-change"},type:"update"});0===this.updateGraphics.length?oa.complete():qa.graphics.remove(pa)},toggleTool:async()=>{if(1===this.updateGraphics.length&&!1!==da.toggleToolOnClick&&"transform"===ca){var pa=this.updateGraphics.at(0);l.isSupportedGraphic(pa)===h.SupportedGraphicResult.SUPPORTED&&
(oa.onEnd(),oa.destroy(),pa=await this._setupReshape3DOperation(pa,da,fa,!0),V(pa)||this._setUpdateOperationHandle(pa,da))}}});ja.push(...this._getHandlesForComponent(oa,da),fa.on("immediate-click",pa=>this._getCommonUpdateOperationClickHandlers(oa,pa,da),N.ViewEventPriorities.WIDGET),fa.on("key-down",pa=>{this._getCommonUpdateOperationKeyDownHandlers(oa,pa)},N.ViewEventPriorities.WIDGET));return oa};ma._setupGraphicTransform3DOperation=function(X,da,fa,ca=!1){if(1===X.length&&q.isSupportedGraphic(X[0])===
h.SupportedGraphicResult.SUPPORTED){const ka=X[0],ra=ka.geometry;if(null!=ra&&("point"===ra.type||"mesh"===ra.type))return this._setupPointTransform3DOperation(ka,da,fa);if(null!=ra&&("polygon"===ra.type||"polyline"===ra.type))return this._setupPolyTransform3DOperation(ka,da,fa,ca)}return this._setupMove3DOperation(X,da,fa,"transform",ca)};ma._setupPointTransform3DOperation=async function(X,da,fa){const {enableRotation:ca,enableScaling:ka,enableZ:ra}=da,qa=await this._requireModule(new Promise((sa,
ua)=>b(["../../views/3d/interactive/editingTools"],sa,ua)));if(V(qa))return qa;const ja=new qa.module.GraphicTransformTool({graphic:X,view:fa,enableRotation:ca,enableScaling:ka,enableZ:ra,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions});fa.tools.add(ja);this.updateGraphics.add(X);const oa=[],pa=new L.UpdateOperationHandle({activeComponent:ja,tool:"transform",type:"update",onEnd:()=>{oa.forEach(sa=>sa.remove());oa.length=0;fa.tools?.remove(ja);ja.destroyed||ja.destroy()},
undo:()=>{aa(pa,this.updateGraphics.toArray());this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},redo:()=>{Y(pa,this.updateGraphics.toArray());this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},addToSelection:async sa=>{this.updateGraphics.add(sa);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[sa],removed:[],type:"selection-change"},type:"update"});pa.onEnd();
pa.destroy();sa=await this._setupMove3DOperation(this.updateGraphics.toArray(),da,fa,"transform",!0);V(sa)||this._setUpdateOperationHandle(sa,da)},removeFromSelection:sa=>{this.updateGraphics.remove(sa);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[sa],type:"selection-change"},type:"update"});pa.complete()},toggleTool:()=>{}});oa.push(...this._getHandlesForComponent(pa,da),fa.on("immediate-click",sa=>this._getCommonUpdateOperationClickHandlers(pa,
sa,da),N.ViewEventPriorities.WIDGET),fa.on("key-down",sa=>{this._getCommonUpdateOperationKeyDownHandlers(pa,sa)},N.ViewEventPriorities.WIDGET));return pa};ma._setupPolyTransform3DOperation=async function(X,da,fa,ca=!1){const {enableRotation:ka,enableScaling:ra,enableZ:qa,preserveAspectRatio:ja}=da,oa=await this._requireModule(new Promise((ta,va)=>b(["../../views/3d/interactive/editingTools"],ta,va)));if(V(oa))return oa;const pa=new oa.module.ExtentTransformTool({graphic:X,view:fa,enableRotation:ka,
enableScaling:ra,enableZ:qa,preserveAspectRatio:ja,tooltipOptions:this.tooltipOptions});fa.tools.add(pa);ca||this.updateGraphics.add(X);const sa=[],ua=new L.UpdateOperationHandle({activeComponent:pa,tool:"transform",type:"update",onEnd:()=>{sa.forEach(ta=>ta.remove());sa.length=0;fa.tools?.remove(pa);pa.destroyed||pa.destroy()},canUndo:()=>pa.canUndo,undo:()=>{pa.undo();this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},canRedo:()=>pa.canRedo,redo:()=>{pa.redo();this._emitRedoEvent({graphics:this.updateGraphics.toArray(),
tool:"transform"})},addToSelection:async ta=>{this.updateGraphics.add(ta);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[ta],removed:[],type:"selection-change"},type:"update"});ua.onEnd();ua.destroy();ta=await this._setupMove3DOperation(this.updateGraphics.toArray(),da,fa,"transform",!0);V(ta)||this._setUpdateOperationHandle(ta,da)},removeFromSelection:ta=>{this.updateGraphics.remove(ta);this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[ta],type:"selection-change"},type:"update"});ua.complete()},toggleTool:async()=>{if(1===this.updateGraphics.length&&!1!==da.toggleToolOnClick){var ta=this.updateGraphics.at(0);l.isSupportedGraphic(ta)===h.SupportedGraphicResult.SUPPORTED&&(ua.onEnd(),ua.destroy(),ta=await this._setupReshape3DOperation(ta,da,fa,!0),V(ta)||this._setUpdateOperationHandle(ta,da))}}});sa.push(...this._getHandlesForComponent(ua,da),fa.on("immediate-click",
ta=>this._getCommonUpdateOperationClickHandlers(ua,ta,da),N.ViewEventPriorities.WIDGET),fa.on("key-down",ta=>this._getCommonUpdateOperationKeyDownHandlers(ua,ta),N.ViewEventPriorities.WIDGET),fa.on("key-down",ta=>{ta.key!==E.SKETCH_KEYS.constraint||ta.repeat||(pa.preserveAspectRatio=!pa.preserveAspectRatio,ta.stopPropagation())},N.ViewEventPriorities.WIDGET),fa.on("key-up",ta=>{ta.key===E.SKETCH_KEYS.constraint&&(pa.preserveAspectRatio=!pa.preserveAspectRatio,ta.stopPropagation())},N.ViewEventPriorities.WIDGET));
return ua};ma._setupMove2DOperation=async function(X,da,fa){this.updateGraphics.addMany(X);await this._updateSpatialReference(X);const ca=await this._getGraphicMover(X,da,fa);if(V(ca))return ca;const ka=new L.UpdateOperationHandle({activeComponent:ca,tool:"move",type:"update",onEnd:()=>{this._displayDefaultCursor();ja.forEach(oa=>oa.remove());qa.forEach(oa=>oa.remove());ja=[];qa=[];ca.destroy();this._internalGraphicsLayer?.removeMany([...this.updateGraphics.toArray()])},undo:()=>{const oa=this.updateGraphics.toArray();
aa(ka,oa);ka.refreshComponent();this._emitUndoEvent({graphics:oa,tool:"move"})},redo:()=>{const oa=this.updateGraphics.toArray();Y(ka,oa);ka.refreshComponent();this._emitRedoEvent({graphics:oa,tool:"move"})},addToSelection:async oa=>{await this._updateSpatialReference(oa);this.updateGraphics.push(oa);ca.graphics=this.updateGraphics.toArray();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[oa],removed:[],type:"selection-change"},
type:"update"})},removeFromSelection:oa=>{const pa=this.updateGraphics.indexOf(oa);ka.history.undo.forEach(ua=>ua.updates.splice(pa,1));ka.history.redo.forEach(ua=>ua.updates.splice(pa,1));this.updateGraphics.remove(oa);const sa=this.updateGraphics.toArray();this.emit("update",{graphics:sa,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[oa],type:"selection-change"},type:"update"});0===this.updateGraphics.length?ka.complete():ca.graphics=sa}});let ra=!1,qa=[fa.on("immediate-click",
oa=>this._getCommonUpdateOperationClickHandlers(ka,oa,da),N.ViewEventPriorities.WIDGET),fa.on("key-down",oa=>{this._getCommonUpdateOperationKeyDownHandlers(ka,oa);oa.key!==E.SKETCH_KEYS.constraint||oa.repeat||(ra=!0,ca.enableMoveAllGraphics=!ca.enableMoveAllGraphics)},N.ViewEventPriorities.WIDGET),fa.on("key-up",oa=>{oa.key===E.SKETCH_KEYS.constraint&&ra&&(ra=!1,ca.enableMoveAllGraphics=!ca.enableMoveAllGraphics)},N.ViewEventPriorities.WIDGET)],ja=this._getHandlesForComponent(ka,da);return ka};ma._setupReshape3DOperation=
async function(X,da,fa,ca=!1){const ka=await this._requireModule(new Promise((pa,sa)=>b(["../../views/3d/interactive/editingTools"],pa,sa)));if(V(ka))return ka;const ra=da.reshapeOptions,qa=new ka.module.GraphicReshapeTool({view:fa,graphic:X,enableZVertex:da.enableZ&&"move"===ra?.vertexOperation,enableZShape:da.enableZ&&"move"===ra?.shapeOperation,enableMoveGraphic:"move"===ra?.shapeOperation||"move-xy"===ra?.shapeOperation,enableMidpoints:"split"===ra?.edgeOperation,enableEdgeOffset:"offset"===ra?.edgeOperation,
snappingManager:this._snappingManager,labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions});fa.tools.add(qa);ca||this.updateGraphics.add(X);const ja=[],oa=new L.UpdateOperationHandle({activeComponent:qa,tool:"reshape",type:"update",onEnd:()=>{ja.forEach(pa=>pa.remove());ja.length=0;fa.tools?.remove(qa);qa.destroyed||qa.destroy()},canUndo:()=>qa.canUndo,undo:()=>{qa.undo();this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"reshape"})},canRedo:()=>qa.canRedo,redo:()=>{qa.redo();
this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"reshape"})},addToSelection:async pa=>{this.updateGraphics.add(pa);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[pa],removed:[],type:"selection-change"},type:"update"});oa.onEnd();oa.destroy();pa=await this._setupMove3DOperation(this.updateGraphics.toArray(),da,fa,"transform",!0);V(pa)||this._setUpdateOperationHandle(pa,da)},removeFromSelection:pa=>{this.updateGraphics.remove(pa);
this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[pa],type:"selection-change"},type:"update"});oa.complete()},toggleTool:async()=>{if(!1!==da.toggleToolOnClick){oa.onEnd();oa.destroy();var pa=await this._setupGraphicTransform3DOperation(this.updateGraphics.toArray(),da,fa,!0);V(pa)||this._setUpdateOperationHandle(pa,da)}}});ja.push(...this._getHandlesForComponent(oa,da),fa.on("immediate-click",pa=>this._getCommonUpdateOperationClickHandlers(oa,
pa,da),N.ViewEventPriorities.WIDGET),fa.on("key-down",pa=>{this._getCommonUpdateOperationKeyDownHandlers(oa,pa)},N.ViewEventPriorities.WIDGET));return oa};ma._setupTransformOrReshape2DOperation=async function(X,da,fa,ca){this.updateGraphics.addMany(X);await this._updateSpatialReference(X);X="transform"===da?await this._getBox(X,fa,ca):await this._getReshape(X,fa,ca);if(V(X))return X;const ka=new L.UpdateOperationHandle({activeComponent:X,type:"update",onEnd:()=>{qa.forEach(ja=>ja.remove());ra.forEach(ja=>
ja.remove());qa=[];ra=[];ka.activeComponent&&!ka.activeComponent.destroyed&&ka.activeComponent.destroy();this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray())},undo:()=>{aa(ka,this.updateGraphics.toArray());ka.refreshComponent();this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:ka.tool})},redo:()=>{Y(ka,this.updateGraphics.toArray());ka.refreshComponent();this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:ka.tool})},addToSelection:async ja=>{var oa=ka.activeComponent;
if("reshape"===oa?.type){oa=[...this.updateGraphics,ja];this.updateGraphics.removeAll();ka.onEnd();ka.destroy();oa=await this._setupMove2DOperation(oa,fa,ca);if(V(oa))return;this._setUpdateOperationHandle(oa,fa)}else this.updateGraphics.add(ja),oa.graphics=this.updateGraphics.toArray(),oa.refresh(),ka.resetHistory();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[ja],removed:[],type:"selection-change"},type:"update"})},
removeFromSelection:async ja=>{const oa=this.updateGraphics.indexOf(ja);ka.history.undo.forEach(sa=>sa.updates.splice(oa,1));ka.history.redo.forEach(sa=>sa.updates.splice(oa,1));this.updateGraphics.remove(ja);const pa=this.updateGraphics.toArray();if(0===pa.length)ka.complete();else{const sa=pa[0].geometry;1!==pa.length||null==sa||"point"!==sa.type&&"multipoint"!==sa.type?ka.activeComponent.graphics=pa:ka.toggleTool()}this.emit("update",{graphics:pa,state:"active",aborted:!1,tool:this.activeTool,
toolEventInfo:{added:[],removed:[ja],type:"selection-change"},type:"update"})},toggleTool:async()=>{if(!(1<this.updateGraphics.length)){var ja=this.updateGraphics.at(0),oa=ja.geometry;if(null==oa||("reshape"!==ka.tool||"point"!==oa.type&&"multipoint"!==oa.type)&&("transform"!==ka.tool||"extent"!==oa.type))oa=null,"transform"===ka.tool?oa=await this._getReshape([ja],fa,ca):"reshape"===ka.tool&&(oa=await this._getBox([ja],fa,ca)),V(oa)||(ka.activeComponent?.destroy(),ka.activeComponent=oa,ka.activeComponent&&
(qa.forEach(pa=>pa.remove()),qa=this._getHandlesForComponent(ka,fa)))}}});let ra=[ca.on("immediate-click",ja=>this._getCommonUpdateOperationClickHandlers(ka,ja,fa),N.ViewEventPriorities.WIDGET),ca.on("key-down",ja=>{this._getCommonUpdateOperationKeyDownHandlers(ka,ja);ja.key===E.SKETCH_KEYS.constraint&&!ja.repeat&&ka&&(ja=ka.activeComponent)&&"box"===ja.type&&(ja.preserveAspectRatio=!ja.preserveAspectRatio)},N.ViewEventPriorities.WIDGET),ca.on("key-up",ja=>{ja.key===E.SKETCH_KEYS.constraint&&ka&&
(ja=ka.activeComponent)&&"box"===ja.type&&(ja.preserveAspectRatio=!ja.preserveAspectRatio)},N.ViewEventPriorities.WIDGET)],qa=this._getHandlesForComponent(ka,fa);return ka};ma._getGraphicMover=async function(X,da,fa){const {enableMoveAllGraphics:ca,highlightOptions:ka}=da;da=await this._requireModule(new Promise((ra,qa)=>b(["../../views/draw/support/GraphicMover"],ja=>ra(ba(ja)),qa)));return V(da)?da:new da.module.default({enableMoveAllGraphics:ca,highlightsEnabled:!!ka?.enabled,indicatorsEnabled:!1,
graphics:X,view:fa,callbacks:{onGraphicMoveStart:({dx:ra,dy:qa,graphic:ja})=>{this._displayGrabbingCursor();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ra,dy:qa,mover:ja,type:"move-start"},type:"update"})},onGraphicMove:({dx:ra,dy:qa,graphic:ja})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ra,dy:qa,mover:ja,type:"move"},type:"update"}),onGraphicMoveStop:({dx:ra,
dy:qa,graphic:ja})=>{this._displayPointerCursor();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ra,dy:qa,mover:ja,type:"move-stop"},type:"update"})},onGraphicPointerOver:()=>this._displayPointerCursor(),onGraphicPointerOut:()=>this._displayDefaultCursor()}})};ma._getBox=async function(X,da,fa){const {enableRotation:ca,enableScaling:ka,highlightOptions:ra,preserveAspectRatio:qa}=da;da=await this._requireModule(new Promise((ja,
oa)=>b(["../../views/draw/support/Box"],pa=>ja(ba(pa)),oa)));return V(da)?da:new da.module.default({graphics:X,enableRotation:ca,enableScaling:ka,highlightsEnabled:!!ra?.enabled,preserveAspectRatio:qa,layer:this._internalGraphicsLayer,view:fa,tooltipOptions:this.tooltipOptions,callbacks:{onMoveStart:ja=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ja},type:"update"}),onMove:ja=>this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ja},type:"update"}),onMoveStop:ja=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ja},type:"update"}),onScaleStart:ja=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ja},type:"update"}),onScale:ja=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,
tool:this.activeTool,toolEventInfo:{...ja},type:"update"}),onScaleStop:ja=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ja},type:"update"}),onRotateStart:ja=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ja},type:"update"}),onRotate:ja=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ja},
type:"update"}),onRotateStop:ja=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ja},type:"update"})}})};ma._getReshape=async function(X,da,fa){const ca="split"===da.reshapeOptions?.edgeOperation,ka="move"===da.reshapeOptions?.shapeOperation;da=!!da.highlightOptions?.enabled;const ra=await this._requireModule(new Promise((qa,ja)=>b(["../../views/draw/support/Reshape"],oa=>qa(ba(oa)),ja)));return V(ra)?ra:new ra.module.default({enableMidpoints:ca,
enableMovement:ka,graphic:X[0],highlightsEnabled:da,layer:this._internalGraphicsLayer,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions,view:fa,callbacks:{onReshapeStart:qa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...qa},type:"update"}),onReshape:qa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...qa},type:"update"}),onReshapeStop:({mover:qa,
type:ja})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:qa,type:ja},type:"update"}),onMoveStart:({dx:qa,dy:ja,mover:oa,type:pa})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:qa,dy:ja,mover:oa,type:pa},type:"update"}),onMove:({dx:qa,dy:ja,mover:oa,type:pa})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,
tool:this.activeTool,toolEventInfo:{dx:qa,dy:ja,mover:oa,type:pa},type:"update"}),onMoveStop:({dx:qa,dy:ja,mover:oa,type:pa})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:qa,dy:ja,mover:oa,type:pa},type:"update"}),onVertexAdd:({added:qa,type:ja,vertices:oa})=>{qa=qa.map(pa=>O.geometryToCoordinates(pa.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:qa,
vertices:oa,type:ja},type:"update"})},onVertexRemove:({removed:qa,type:ja,vertices:oa})=>{qa=qa.map(pa=>O.geometryToCoordinates(pa.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{removed:qa,vertices:oa,type:ja},type:"update"})}}})};ma._getHandlesForComponent=function(X,da){const fa=X.activeComponent;if(!fa)return[];switch(fa.type){case "graphic-mover":return[fa.on("graphic-click",({graphic:ca,viewEvent:ka})=>{ka.native?.shiftKey&&
(ka.stopPropagation(),X.removeFromSelection(ca))}),fa.on("graphic-move-start",ca=>X.addToHistory(R(ca.allGraphics)))];case "box":return[fa.on("graphic-click",ca=>this._onTransformOrReshape2DGraphicClick(X,da,ca)),fa.on("move-start",ca=>X.addToHistory(R(ca.graphics))),fa.on("rotate-start",ca=>X.addToHistory(R(ca.graphics))),fa.on("scale-start",ca=>X.addToHistory(R(ca.graphics)))];case "reshape":return[fa.on("graphic-click",ca=>this._onTransformOrReshape2DGraphicClick(X,da,ca)),fa.on("move-start",ca=>
X.addToHistory(R([ca.mover]))),fa.on("reshape-start",ca=>X.addToHistory(R([ca.graphic]))),fa.on("vertex-add",ca=>X.addToHistory(R([ca.oldGraphic]))),fa.on("vertex-remove",ca=>X.addToHistory(R([ca.oldGraphic])))];case "move-3d":return[fa.on("graphic-move-start",ca=>{X.addToHistory(R(ca.allGraphics));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:0<ca.allGraphics.length?ca.allGraphics[0]:null,type:"move-start"},
type:"update"})}),fa.on("graphic-move",ca=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ca.dx,dy:ca.dy,mover:0<ca.allGraphics.length?ca.allGraphics[0]:null,type:"move"},type:"update"})}),fa.on("graphic-move-stop",ca=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:0<ca.allGraphics.length?ca.allGraphics[0]:null,type:"move-stop"},type:"update"})}),
fa.on("immediate-click",ca=>{ca.shiftKey?this._toggleSelection([ca.graphic],X,da):X.toggleTool()})];case "transform-3d":return[fa.on("record-undo",({record:ca})=>{X.addToHistory({updates:[ca]})}),fa.on("graphic-translate-start",ca=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ca.graphic,dx:ca.dxScreen,dy:ca.dyScreen,type:"move-start"},type:"update"})}),fa.on("graphic-translate-stop",ca=>{this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ca.graphic,dx:ca.dxScreen,dy:ca.dyScreen,type:"move-stop"},type:"update"})}),fa.on("graphic-rotate-start",ca=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ca.graphic,angle:ca.angle,type:"rotate-start"},type:"update"})}),fa.on("graphic-rotate-stop",ca=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,
toolEventInfo:{mover:ca.graphic,angle:ca.angle,type:"rotate-stop"},type:"update"})}),fa.on("graphic-scale-start",ca=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ca.graphic,xScale:ca.xScale,yScale:ca.yScale,type:"scale-start"},type:"update"})}),fa.on("graphic-scale-stop",ca=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ca.graphic,xScale:ca.xScale,
yScale:ca.yScale,type:"scale-stop"},type:"update"})}),fa.on("graphic-translate",ca=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ca.graphic,dx:ca.dxScreen,dy:ca.dyScreen,type:"move"},type:"update"})}),fa.on("graphic-rotate",ca=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ca.graphic,angle:ca.angle,type:"rotate"},type:"update"})}),fa.on("graphic-scale",
ca=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ca.graphic,xScale:ca.xScale,yScale:ca.yScale,type:"scale"},type:"update"})}),fa.on("immediate-click",ca=>{ca.shiftKey?this._toggleSelection([ca.graphic],X,da):X.toggleTool()})];case "reshape-3d":return[fa.on("reshape",ca=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:ca,type:"update"})}),fa.on("move",
ca=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:ca,type:"update"})}),fa.on("vertex-add",ca=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:ca,type:"update"})}),fa.on("vertex-remove",ca=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:ca,type:"update"})}),fa.on("immediate-click",
ca=>{ca.shiftKey?this._toggleSelection([ca.graphic],X,da):X.toggleTool()})]}};ma._onTransformOrReshape2DGraphicClick=function(X,da,fa){const {graphic:ca,viewEvent:ka}=fa;if(ka.native?.shiftKey&&ca.layer===this.layer)return ka.stopPropagation(),X.removeFromSelection(ca);if(da.toggleToolOnClick)return ka.stopPropagation(),X.toggleTool()};ma._setUpdateOperationHandle=function(X,da){this._operationHandle=X;const fa=this.view?.map;this._disablePopup(da);X.on("complete",()=>{if(X===this._operationHandle){const ca=
this.updateGraphics.toArray(),ka=this._operationHandle.tool;this._operationHandle.destroy();this._operationHandle=null;this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray());this.updateGraphics.removeAll();fa&&fa.remove(this._internalGraphicsLayer);this._restorePopup(da);this.emit("update",{graphics:ca,state:"complete",aborted:X.cancelled,tool:ka,toolEventInfo:null,type:"update"})}})};ma._getCommonUpdateOperationClickHandlers=async function(X,da,fa){const ca=J.createScreenPointFromEvent(da),
ka=await da.async(()=>this._getFirstHit(ca));null==ka?X.complete():da.native.shiftKey&&this._toggleSelection([ka.graphic],X,fa)?da.stopPropagation():this.updateGraphics.includes(ka.graphic)?da.stopPropagation():X.complete()};ma._toggleSelection=function(X,da,fa){const ca=!!fa.multipleSelectionEnabled;return X.some(ka=>null==ka?!1:ca&&ka.layer===this.layer?(this.updateGraphics.includes(ka)?da.removeFromSelection(ka):da.addToSelection(ka),!0):!1)};ma._getCommonUpdateOperationKeyDownHandlers=function(X,
da){if(X){var fa=da.key;fa===E.SKETCH_KEYS.undo&&X.canUndo()?(da.stopPropagation(),X.undo()):fa===E.SKETCH_KEYS.redo&&X.canRedo()?(da.stopPropagation(),X.redo()):fa===E.SKETCH_KEYS.cancel?(da.stopPropagation(),X.cancel()):this.allowDeleteKey&&E.SKETCH_KEYS.delete.includes(fa)&&this._onDeleteKey(da)}};ma._onDeleteKey=function(X){if(this._operationHandle&&"update"===this._operationHandle.type){var da=this.activeComponent,fa=this.updateGraphics.toArray();null!=da&&"reshape-3d"!==da.type&&("reshape"!==
da.type||1===fa.length&&"point"===fa[0].geometry?.type)&&(X.stopPropagation(),this.delete())}};ma._removeDefaultLayer=function(){this._internalGraphicsLayer&&(this.view?.map?.remove(this._internalGraphicsLayer),this._internalGraphicsLayer=t.destroyMaybe(this._internalGraphicsLayer))};ma._isComponentGraphic=function(X){const {activeComponent:da}=this;return X&&null!=da?X.attributes&&X.attributes.esriSketchTool||"draw-2d"===da.type&&da.graphic===X||("box"===da.type||"reshape"===da.type)&&da.isUIGraphic(X):
!1};ma._displayPointerCursor=function(){this.view&&this.view.container&&"pointer"!==this.view.cursor&&(this.view.cursor="pointer")};ma._displayGrabbingCursor=function(){this.view&&this.view.container&&"grabbing"!==this.view.cursor&&(this.view.cursor="grabbing")};ma._displayDefaultCursor=function(){this.view&&this.view.container&&null!==this.view.cursor&&(this.view.cursor=null)};ma._logError=function(X,da,fa){z.getLogger(this).error(new F(X,da,fa))};ma._requireModule=async function(X){const da=new AbortController;
this._moduleLoaderAbortController=da;X=await X;return this._moduleLoaderAbortController!==da||da.signal.aborted?{requireError:"aborted"}:{module:X}};ma._emitUndoEvent=function(X){this.emit("undo",{...X,type:"undo"})};ma._emitRedoEvent=function(X){this.emit("redo",{...X,type:"redo"})};ma._emitDeleteEvent=function(X){this.emit("delete",{...X,type:"delete"})};ma.wait=function(){return a.whenOnce(()=>!this.updating)};ma._beginAsyncOperation=function(){this._numUpdating+=1;this.notifyChange("updating")};
ma._endAsyncOperation=function(){--this._numUpdating;this.notifyChange("updating")};ma._disablePopupEnabled=function(X){return"3d"!==this.view?.type||this.updateOnGraphicClick||(X?.toggleToolOnClick??!1)};ma._disablePopup=function(X){this._disablePopupEnabled(X)&&this.view&&null==this._originalPopupEnabled&&(this._originalPopupEnabled=this.view.popupEnabled,this.view.popupEnabled=!1)};ma._restorePopup=function(X){this._disablePopupEnabled(X)&&this.view&&null!=this._originalPopupEnabled&&(this.view.popupEnabled=
this._originalPopupEnabled,this._originalPopupEnabled=null)};ma._waitViewReady=async function(){const X=this.view;X?(t.abortMaybe(this._viewReadyAbortController),this._viewReadyAbortController=new AbortController,await D.whenOrAbort(a.whenOnce(()=>X?.ready),this._viewReadyAbortController.signal)):this._logMissingView()};ma._logMissingView=function(){this._logError("sketch:missing-property",la("view"))};ma._logMissingLayer=function(){this._logError("sketch:missing-property",la("layer"))};e._createClass(na,
[{key:"_defaultUpdateTool",get:function(){return"3d"===this.view?.type?"move":"transform"}},{key:"updating",get:function(){return 0<this._numUpdating||null!=this._snappingManager&&this._snappingManager.updating}},{key:"activeTool",get:function(){return this._operationHandle?.tool??null}},{key:"activeComponent",get:function(){return this._operationHandle?.activeComponent??null}},{key:"createGraphic",get:function(){return null==this.activeComponent||"draw-3d"!==this.activeComponent.type&&"draw-2d"!==
this.activeComponent.type?this._get("createGraphic"):this.activeComponent.graphic}},{key:"defaultCreateOptions",get:function(){return this._get("defaultCreateOptions")},set:function(X){this._set("defaultCreateOptions",{...ea,...X})}},{key:"defaultUpdateOptions",get:function(){return this._get("defaultUpdateOptions")},set:function(X){this._set("defaultUpdateOptions",{...ha,...X,reshapeOptions:{...ha.reshapeOptions,...X?.reshapeOptions},highlightOptions:{...ha.highlightOptions,...X?.highlightOptions}})}},
{key:"snappingOptions",set:function(X){null!=this._snappingManager&&(this._snappingManager.options=X);this._set("snappingOptions",X)}},{key:"state",get:function(){const X=!(!this.view?.ready||!this.layer),da=this._operationHandle;return X&&da?"active":X?"ready":"disabled"}},{key:"view",get:function(){return this._get("view")},set:function(X){const da=this._get("view");if(da){const {container:fa,map:ca}=da;fa&&(da.cursor=null);ca&&ca.remove(this._internalGraphicsLayer);this._viewHandles.removeAll();
this.cancel()}this._handles.remove("view-ready");X&&this._handles.add(a.when(()=>X.ready,fa=>{this._viewHandles.removeAll();fa&&this._viewHandles.add(this._generateViewHandles(X))},a.syncAndInitial),"view-ready");this._set("view",X)}},{key:"test",get:function(){return{operationHandle:this._operationHandle,defaultUpdateOptions:ha}}}]);return na}(K.EventedAccessor);c.__decorate([g.property()],K.prototype,"updating",null);c.__decorate([g.property()],K.prototype,"_operationHandle",void 0);c.__decorate([g.property({readOnly:!0})],
K.prototype,"activeTool",null);c.__decorate([g.property()],K.prototype,"activeFillSymbol",void 0);c.__decorate([g.property()],K.prototype,"activeLineSymbol",void 0);c.__decorate([g.property()],K.prototype,"activeVertexSymbol",void 0);c.__decorate([g.property()],K.prototype,"allowDeleteKey",void 0);c.__decorate([g.property({readOnly:!0})],K.prototype,"createGraphic",null);c.__decorate([g.property()],K.prototype,"defaultCreateOptions",null);c.__decorate([g.property()],K.prototype,"defaultUpdateOptions",
null);c.__decorate([g.property({type:r,nonNullable:!0})],K.prototype,"labelOptions",void 0);c.__decorate([g.property()],K.prototype,"layer",void 0);c.__decorate([g.property({types:m.symbolTypes})],K.prototype,"pointSymbol",void 0);c.__decorate([g.property({types:m.symbolTypes})],K.prototype,"polygonSymbol",void 0);c.__decorate([g.property({types:m.symbolTypes})],K.prototype,"polylineSymbol",void 0);c.__decorate([g.property()],K.prototype,"meshSymbol",void 0);c.__decorate([g.property({type:S,nonNullable:!0})],
K.prototype,"snappingOptions",null);c.__decorate([g.property()],K.prototype,"_snappingManager",void 0);c.__decorate([g.property({readOnly:!0})],K.prototype,"state",null);c.__decorate([g.property({type:I,nonNullable:!0})],K.prototype,"tooltipOptions",void 0);c.__decorate([g.property({readOnly:!0})],K.prototype,"updateGraphics",void 0);c.__decorate([g.property()],K.prototype,"updateOnGraphicClick",void 0);c.__decorate([g.property({types:m.symbolTypes})],K.prototype,"vertexSymbol",void 0);c.__decorate([g.property({value:null})],
K.prototype,"view",null);K=c.__decorate([n.subclass("esri.widgets.Sketch.SketchViewModel")],K);const la=ia=>`Property '${ia}' is missing on SketchViewModel.`;return K})},"esri/views/3d/interactive/editingTools/isSupportedGraphicUtils":function(){define(["exports","../../../../core/has"],function(b,e){b.SupportedGraphicResult=void 0;(function(c){c[c.SUPPORTED=0]="SUPPORTED";c[c.GRAPHICS_LAYER_MISSING=1]="GRAPHICS_LAYER_MISSING";c[c.GEOMETRY_MISSING=2]="GEOMETRY_MISSING";c[c.GEOMETRY_TYPE_UNSUPPORTED=
3]="GEOMETRY_TYPE_UNSUPPORTED";c[c.ELEVATION_MODE_UNSUPPORTED=4]="ELEVATION_MODE_UNSUPPORTED";c[c.SYMBOL_TYPE_UNSUPPORTED=5]="SYMBOL_TYPE_UNSUPPORTED"})(b.SupportedGraphicResult||(b.SupportedGraphicResult={}));b.isSupportedGraphicResultMessage=function(c){switch(c){case b.SupportedGraphicResult.GRAPHICS_LAYER_MISSING:return"not owned by a graphics layer";case b.SupportedGraphicResult.GEOMETRY_MISSING:return"no geometry";case b.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED:return"the geometry type is not supported";
case b.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED:return"the elevation mode is not supported";case b.SupportedGraphicResult.SYMBOL_TYPE_UNSUPPORTED:return"the symbol type is not supported"}return""};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/moveGraphic/isSupportedGraphic":function(){define(["exports","../../../../../core/has","../../../../../support/elevationInfoUtils","../isSupportedGraphicUtils"],function(b,e,c,m){b.isSupportedGraphic=
function(w){if("graphics"!==w.layer?.type)return m.SupportedGraphicResult.GRAPHICS_LAYER_MISSING;if(null==w.geometry)return m.SupportedGraphicResult.GEOMETRY_MISSING;switch(w.geometry.type){case "polygon":case "point":case "polyline":case "mesh":break;case "multipoint":case "extent":return m.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED;default:return m.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED}return"on-the-ground"!==c.getGraphicEffectiveElevationMode(w)&&c.hasGraphicFeatureExpressionInfo(w)?
m.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED:m.SupportedGraphicResult.SUPPORTED};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/support/elevationInfoUtils":function(){define(["exports","../symbols/support/unitConversionUtils"],function(b,e){function c(a,g){return null!=g&&g.mode?g.mode:(a?t:D).mode}function m(a,g){return null!=g?g:a?t:D}function w(a,g){return c(null!=a?a.hasZ:!1,g)}function F(a){const g=K(a);return w(a.geometry,g)}function K(a){return a.layer&&"elevationInfo"in
a.layer?a.layer.elevationInfo:null}function P(a,g,u,v,k,n,p=null){if(null!=n){var y=null!=p?p.mode:"absolute-height";if("on-the-ground"===y)return 0;({absoluteZ:n}=z(g,u,v,k,a,n));a:{p=null!=p&&null!=p.offset?p.offset:0;switch(y){case "absolute-height":a=n-p;break a;case "relative-to-ground":a=n-((a.elevationProvider.getElevation(g,u,v,k,"ground")??0)+p);break a;case "relative-to-scene":a=n-((a.elevationProvider.getElevation(g,u,v,k,"scene")??0)+p);break a}a=void 0}return a}}function z(a,g,u,v,k,
n){const p=null!=n.offset?n.offset:0;switch(n.mode){case "absolute-height":return{absoluteZ:u+p,elevation:0};case "on-the-ground":return u=k.elevationProvider.getElevation(a,g,0,v,"ground")??0,{absoluteZ:u,elevation:u};case "relative-to-ground":return a=k.elevationProvider.getElevation(a,g,u,v,"ground")??0,{absoluteZ:u+a+p,elevation:a};case "relative-to-scene":return a=k.elevationProvider.getElevation(a,g,u,v,"scene")??0,{absoluteZ:u+a+p,elevation:a}}}const t={mode:"absolute-height",offset:0},D={mode:"on-the-ground",
offset:null};b.absoluteHeightElevationInfo=t;b.elevationContextAffectsAlignment=function(a,g){if(null==g)return!1;({mode:g}=g);return null!=g&&("scene"===a&&"relative-to-scene"===g||"ground"===a&&"absolute-height"!==g)};b.elevationInfoLikeEquals=function(a,g){return a===g||null!=a&&null!=g&&a.mode===g.mode&&a.offset===g.offset};b.getConvertedElevation=function(a,g,u,v=null){return P(a,g.x,g.y,g.hasZ?g.z:0,g.spatialReference,u,v)};b.getConvertedElevationFromVector=function(a,g,u,v,k=null){return P(a,
g[0],g[1],2<g.length?g[2]:0,u,v,k)};b.getEffectiveElevationInfo=m;b.getEffectiveElevationMode=c;b.getGeometryEffectiveElevationInfo=function(a,g){return m(null!=a?!!a.hasZ:!1,g)};b.getGeometryEffectiveElevationMode=w;b.getGraphicEffectiveElevationInfo=function(a){var g=K(a);a=w(a.geometry,g);g=null!=g&&"on-the-ground"!==a?(g.offset??0)*e.getMetersPerUnit(g.unit??"meters"):0;return{mode:a,offset:g}};b.getGraphicEffectiveElevationMode=F;b.getZForElevationMode=function(a,g,u){if(null!=u&&u.mode){var v=
a.hasZ?a.z:0,k=null!=u.offset?u.offset:0;switch(u.mode){case "absolute-height":return v-k;case "on-the-ground":return 0;case "relative-to-ground":return a=(g.elevationProvider.getElevation(a.x,a.y,v,a.spatialReference,"ground")??0)+k,v-a;case "relative-to-scene":return a=(g.elevationProvider.getElevation(a.x,a.y,v,a.spatialReference,"scene")??0)+k,v-a}}};b.hasGraphicFeatureExpressionInfo=function(a){if("on-the-ground"===F(a))return!1;a=K(a);a=null!=a&&a.featureExpressionInfo?a.featureExpressionInfo.expression:
null;return!(!a||"0"===a)};b.onTheGroundElevationInfo=D;b.zValueInAbsoluteHeightMode=z;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/reshapeGraphic/isSupportedGraphic":function(){define(["exports","../../../../../geometry/Circle","../../../../../support/elevationInfoUtils","../isSupportedGraphicUtils"],function(b,e,c,m){function w(F){if("graphics"!==F.layer?.type)return{result:m.SupportedGraphicResult.GRAPHICS_LAYER_MISSING,geometry:null};
const {geometry:K}=F;if(null==K)return{result:m.SupportedGraphicResult.GEOMETRY_MISSING,geometry:null};if("on-the-ground"!==c.getGraphicEffectiveElevationMode(F)&&c.hasGraphicFeatureExpressionInfo(F))return{result:m.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED,geometry:null};const P=K.type;return"point"!==P&&"mesh"!==P&&"polyline"!==P&&("polygon"!==P||F.geometry instanceof e)?{result:m.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED,geometry:null}:{result:m.SupportedGraphicResult.SUPPORTED,
geometry:K}}b.geometryOfSupportedGraphic=function(F){return w(F).geometry};b.isSupportedGraphic=function(F){return w(F).result};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/Circle":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/unitUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./ellipsoidUtils ./Point ./Polygon ./support/geodesicUtils ./support/webMercatorUtils ./support/WKIDUnitConversion".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a,g,u){var v;w=v=function(k){function n(...y){y=k.call(this,...y)||this;y.center=null;y.geodesic=!1;y.numberOfPoints=60;y.radius=1E3;y.radiusUnit="meters";return y}b._inherits(n,k);var p=n.prototype;p.normalizeCtorArgs=function(y,O){if(!y||!y.center){if(y&&y.rings)return b._get(b._getPrototypeOf(n.prototype),"normalizeCtorArgs",this).call(this,y,O);y={center:y}}return{...b._get(b._getPrototypeOf(n.prototype),"normalizeCtorArgs",this).call(this),...y,...O}};p.initialize=
function(){var y=this.center;const O=this.numberOfPoints;this.hasZ=y?.hasZ??!1;if(0===this.rings.length&&y){var C=c.convertUnit(this.radius,this.radiusUnit,"meters"),f=y.spatialReference,h="geographic";if(f.isWebMercator)h="webMercator";else if(null!=(f.wkid&&u[f.wkid])||f.wkt&&0===f.wkt.indexOf("PROJCS"))h="projected";if(this.geodesic){let d;switch(h){case "webMercator":d=g.webMercatorToGeographic(y);break;case "projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");
break;case "geographic":d=y}y=this._createGeodesicCircle(d,C,O);"webMercator"===h&&(y=g.geographicToWebMercator(y))}else{let d;"webMercator"===h||"projected"===h?d=C/this._convert2Meters(1,y.spatialReference):"geographic"===h&&(d=c.lengthToDegrees(C,"meters",z.getReferenceEllipsoid(y.spatialReference).radius));y=this._createPlanarCircle(y,d,O)}this.spatialReference=y.spatialReference;this.addRing(y.rings[0])}};p.clone=function(){const {center:y,numberOfPoints:O,radius:C,radiusUnit:f,geodesic:h}=this;
return new v({center:y?.clone(),numberOfPoints:O,radius:C,radiusUnit:f,geodesic:h})};p._createGeodesicCircle=function(y,O,C){let f=0;const h=[];for(;360>f;){const d=[0,0];a.directGeodeticSolver(d,[y.x,y.y],f,O);this.hasZ&&d.push(y.z);h.push(d);f+=360/C}h.push(h[0]);return new D(h)};p._createPlanarCircle=function(y,O,C){const f=[],h=2*Math.PI/C;for(let l=0;l<C;++l){var d=h*l;d=[y.x+Math.cos(-d)*O,y.y+Math.sin(-d)*O];this.hasZ&&d.push(y.z);f.push(d)}f.push(f[0]);return new D({spatialReference:y.spatialReference,
rings:[f]})};p._convert2Meters=function(y,O){if(O.wkid&&null!=u[O.wkid])O=u.values[u[O.wkid]];else{O=O.wkt;const C=O.lastIndexOf(",")+1,f=O.lastIndexOf("]]");O=parseFloat(O.substring(C,f))}return y*O};return b._createClass(n)}(D);e.__decorate([m.property({type:t})],w.prototype,"center",void 0);e.__decorate([m.property()],w.prototype,"geodesic",void 0);e.__decorate([m.property()],w.prototype,"numberOfPoints",void 0);e.__decorate([m.property()],w.prototype,"radius",void 0);e.__decorate([m.property()],
w.prototype,"radiusUnit",void 0);return w=v=e.__decorate([P.subclass("esri.geometry.Circle")],w)})},"esri/geometry/support/geodesicUtils":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../geometry ../../core/Error ../../core/unitUtils ./geodesicConstants ./spatialReferenceUtils ../Polyline ../Polygon ../Point ../SpatialReference".split(" "),function(b,e,c,m,w,F,K,P,z,t,D){function a(C){if(!C)return null;if(K.isGeographic(C)&&C.wkid){var f=F.spheroids[C.wkid];if(f)return f}return C.wkt&&
((C=F.WKT_SPHEROID_REGEX.exec(C.wkt))&&2===C.length?(f=C[1].split(","),!f||3>f.length?C=null:(C=parseFloat(f[1]),f=parseFloat(f[2]),C=isNaN(C)||isNaN(f)?null:{a:C,f:0===f?0:1/f})):C=null,C)?C:null}function g(C){C=a(C??D.WGS84);if(null!=C&&"b"in C&&"eSq"in C&&"radius"in C)return C;const f=C.a*(1-C.f);return Object.assign(C,{b:f,eSq:1-(f/C.a)**2,radius:(2*C.a+f)/3,densificationRatio:1E4/((2*C.a+f)/3)})}function u(C){return null!=C&&0>C?C+360:C}function v(C,f,h){const {a:d,eSq:l}=g(h);h=Math.sqrt(l);
const q=Math.sin(f[1]*F.toRadians);f=d*f[0]*F.toRadians;h=0<l?d*(1-l)*(q/(1-l*q*q)-1/(2*h)*Math.log((1-h*q)/(1+h*q)))*.5:d*q;C[0]=f;C[1]=h;return C}function k(C){return null!==a(C)}function n(C,f){if("polyline"!==C.type&&"polygon"!==C.type)throw new m("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");const {spatialReference:h}=C;if(!k(h))throw new m("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");var d="polyline"===
C.type?C.paths:C.rings;const l=[],q=[0,0],H=new O;for(const r of d){d=[];l.push(d);d.push([r[0][0],r[0][1]]);var N=r[0][0],E=r[0][1];let I,M;for(let S=0;S<r.length-1;S++){I=r[S+1][0];M=r[S+1][1];if(N===I&&E===M)continue;const U=[N,E];y(H,[N,E],[I,M],h);const {azimuth:G,distance:J}=H;N=J/f;if(1<N){for(E=1;E<=N-1;E++)p(q,U,G,E*f,h),d.push(q.slice(0));p(q,U,G,(J+Math.floor(N-1)*f)/2,h);d.push(q.slice(0))}p(q,U,G,J,h);d.push(q.slice(0));N=q[0];E=q[1]}}return"polyline"===C.type?new P({paths:l,spatialReference:h}):
new z({rings:l,spatialReference:h})}function p(C,f,h,d,l){const q=f[0]*F.toRadians;f=f[1]*F.toRadians;h=(h??0)*F.toRadians;const {a:H,b:N,f:E}=g(l);l=Math.sin(h);h=Math.cos(h);var r=(1-E)*Math.tan(f);f=1/Math.sqrt(1+r*r);const I=r*f,M=Math.atan2(r,h);r=f*l;const S=r*r;var U=1-S,G=U*(H*H-N*N)/(N*N);const J=1+G/16384*(4096+G*(-768+G*(320-175*G))),L=G/1024*(256+G*(-128+G*(74-47*G)));G=d/(N*J);let B=2*Math.PI,A,x,Q,T;for(;1E-12<Math.abs(G-B);)Q=Math.cos(2*M+G),A=Math.sin(G),x=Math.cos(G),T=L*A*(Q+L/4*
(x*(-1+2*Q*Q)-L/6*Q*(-3+4*A*A)*(-3+4*Q*Q))),B=G,G=d/(N*J)+T;d=I*A-f*x*h;U=E/16*U*(4+E*(4-3*U));d=Math.atan2(I*x+f*A*h,(1-E)*Math.sqrt(S+d*d))/F.toRadians;C[0]=(q+(Math.atan2(A*l,f*x-I*A*h)-(1-U)*E*r*(G+U*A*(Q+U*x*(-1+2*Q*Q)))))/F.toRadians;C[1]=d;return C}function y(C,f,h,d){var l=f[0]*F.toRadians;f=f[1]*F.toRadians;var q=h[0]*F.toRadians;h=h[1]*F.toRadians;const {a:H,b:N,f:E,radius:r}=g(d),I=q-l;var M=Math.atan((1-E)*Math.tan(f)),S=Math.atan((1-E)*Math.tan(h));d=Math.sin(M);M=Math.cos(M);const U=
Math.sin(S);S=Math.cos(S);let G=1E3,J=I,L,B,A;let x,Q,T;do{var W=Math.sin(J);var aa=Math.cos(J);A=Math.sqrt(S*W*S*W+(M*U-d*S*aa)*(M*U-d*S*aa));if(0===A)return C.distance=0,C.azimuth=void 0,C.reverseAzimuth=void 0,C;aa=d*U+M*S*aa;x=Math.atan2(A,aa);Q=M*S*W/A;B=1-Q*Q;W=aa-2*d*U/B;isNaN(W)&&(W=0);T=E/16*B*(4+E*(4-3*B));L=J;J=I+(1-T)*E*Q*(x+T*A*(W+T*aa*(-1+2*W*W)))}while(1E-12<Math.abs(J-L)&&0<--G);if(0===G)return d=Math.acos(Math.sin(f)*Math.sin(h)+Math.cos(f)*Math.cos(h)*Math.cos(q-l))*r,l=q-l,C.azimuth=
Math.atan2(Math.sin(l)*Math.cos(h),Math.cos(f)*Math.sin(h)-Math.sin(f)*Math.cos(h)*Math.cos(l))/F.toRadians,C.distance=d,C.reverseAzimuth=void 0,C;l=B*(H*H-N*N)/(N*N);f=l/1024*(256+l*(-128+l*(74-47*l)));q=Math.atan2(M*Math.sin(J),M*U*Math.cos(J)-d*S);C.azimuth=Math.atan2(S*Math.sin(J),M*U-d*S*Math.cos(J))/F.toRadians;C.distance=N*(1+l/16384*(4096+l*(-768+l*(320-175*l))))*(x-f*A*(W+f/4*(aa*(-1+2*W*W)-f/6*W*(-3+4*A*A)*(-3+4*W*W))));C.reverseAzimuth=q/F.toRadians;return C}let O=e._createClass(function(C=
0,f,h){this.distance=C;this.azimuth=f;this.reverseAzimuth=h});b.InverseGeodeticSolverResult=O;b.directGeodeticSolver=p;b.geodesicAreas=function(C,f="square-meters"){if(C.some(q=>!k(q.spatialReference)))throw new m("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");const h=[];for(var d=0;d<C.length;d++){var l=C[d];const {radius:q,densificationRatio:H}=g(l.spatialReference);h.push(n(l,q*H))}C=[];d=[0,0];l=[0,0];for(let q=0;q<h.length;q++){const {rings:H,
spatialReference:N}=h[q];let E=0;for(let r=0;r<H.length;r++){const I=H[r];v(d,I[0],N);v(l,I[I.length-1],N);let M=l[0]*d[1]-d[0]*l[1];for(let S=0;S<I.length-1;S++)v(d,I[S+1],N),v(l,I[S],N),M+=l[0]*d[1]-d[0]*l[1];E+=M}E=w.convertUnit(E,"square-meters",f);C.push(E/-2)}return C};b.geodesicDensify=n;b.geodesicDistance=function(C,f,h="meters"){if(!C||!f)throw new m("geodesic-distance:missing-parameters","one or both input parameters are missing");if(!C.spatialReference||!f.spatialReference)throw new m("geodesic-distance:invalid-parameters",
"one or both input points do not have a spatial reference");if(!K.equals(C.spatialReference,f.spatialReference))throw new m("geodesic-distance:invalid-parameters","spatial references of input parameters do not match");const {spatialReference:d}=C;if(!k(d))throw new m("geodesic-distance:not-supported","input geometry spatial reference is not supported");if(C.x===f.x&&C.y===f.y)return new O(0,0,0);const l=new O;y(l,[C.x,C.y],[f.x,f.y],d);l.distance=w.convertUnit(l.distance,"meters",h);l.azimuth=u(l.azimuth);
l.reverseAzimuth=u(l.reverseAzimuth);return l};b.geodesicLengths=function(C,f="meters"){if(!C)throw new m("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(C.some(l=>!k(l.spatialReference)))throw new m("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");const h=[];for(let l=0;l<C.length;l++){var d=C[l];const {spatialReference:q}=d;d="polyline"===d.type?d.paths:d.rings;let H=0;for(let N=0;N<d.length;N++){const E=
d[N];let r=0;for(let I=1;I<E.length;I++){const M=E[I-1][0],S=E[I][0],U=E[I-1][1],G=E[I][1];if(U!==G||M!==S){const J=new O;y(J,[M,U],[S,G],q);r+=J.distance}}H+=r}H=w.convertUnit(H,"meters",f);h.push(H)}return h};b.inverseGeodeticSolver=y;b.isSupported=k;b.pointFromDistance=function(C,f,h){if(!C||null==f||null==h)throw new m("point-from-distance:missing-parameters","one or more input parameters are missing or undefined");if(0>h||360<h)throw new m("point-from-distance:-of-bounds","azimuth is restricted to angles between, and including, 0\u00b0 to 360\u00b0 degrees");
if(!C.spatialReference)throw new m("point-from-distance:missing-spatial-reference","the input point must have a spatial reference");const {spatialReference:d}=C;if(!k(d))throw new m("geodesic-distance:not-supported","input geometry spatial reference is not supported");const l=[0,0];p(l,[C.x,C.y],h,f,d);return new t({x:l[0],y:l[1],spatialReference:d})};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/transformGraphic/isSupportedGraphic":function(){define(["exports",
"../../../../../core/has","../../../../../support/elevationInfoUtils","../isSupportedGraphicUtils"],function(b,e,c,m){b.isSupportedGraphic=function(w){if("graphics"!==w.layer?.type)return m.SupportedGraphicResult.GRAPHICS_LAYER_MISSING;if(null==w.geometry)return m.SupportedGraphicResult.GEOMETRY_MISSING;switch(w.geometry.type){case "point":break;case "polygon":case "polyline":case "multipoint":case "extent":case "mesh":return m.SupportedGraphicResult.SUPPORTED;default:return m.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED}const F=
null!=w.symbol&&"point-3d"===w.symbol.type&&w.symbol.symbolLayers;return F&&0<F.length&&F.some(K=>"object"===K.type)?"on-the-ground"!==c.getGraphicEffectiveElevationMode(w)&&c.hasGraphicFeatureExpressionInfo(w)?m.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED:m.SupportedGraphicResult.SUPPORTED:m.SupportedGraphicResult.SYMBOL_TYPE_UNSUPPORTED};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/draw/support/layerUtils":function(){define(["exports"],function(b){b.addUniqueLayer=
function(e,c,m){if(c&&e&&e.map){({map:e}=e);var w=e.layers.find(F=>F===c);w||e.add(c,m);w&&void 0!==m&&null!==m&&e.layers.reorder(w,m)}};b.findLayerView=function(e,c){return e.allLayerViews.find(m=>{m=m.layer;return m===c||"sublayers"in m&&null!=m.sublayers&&m.sublayers.includes(c)})};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/keybindings":function(){define(["exports"],function(b){b.SKETCH_KEYS={redo:"r",undo:"z",center:"Alt",constraint:"Shift",cancel:"Escape",
delete:["Backspace","Delete"],complete:"Enter",vertexAdd:"f",pan:" "};b.SNAPPING_KEYS={toggle:"Control"};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/sketch/SketchLabelOptions":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),
function(b,e,c,m,w,F,K,P){c=function(z){function t(D){D=z.call(this,D)||this;D.enabled=!1;return D}b._inherits(t,z);return b._createClass(t)}(c);e.__decorate([m.property({type:Boolean,nonNullable:!0})],c.prototype,"enabled",void 0);return c=e.__decorate([P.subclass("esri.views.interactive.sketch.SketchLabelOptions")],c)})},"esri/views/interactive/sketch/SketchTooltipOptions":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./SketchTooltipElevationOptions ./SketchTooltipVisibleElements".split(" "),
function(b,e,c,m,w,F,K,P,z,t){c=function(D){function a(g){g=D.call(this,g)||this;g.enabled=!1;g.elevation=new z.SketchTooltipElevationOptions;g.visibleElements=new t.SketchTooltipVisibleElements;g.visualVariables=null;return g}b._inherits(a,D);a.prototype.toJSON=function(){return{enabled:this.enabled,elevation:this.elevation,visibleElements:this.visibleElements}};return b._createClass(a)}(c);e.__decorate([m.property({type:Boolean,nonNullable:!0})],c.prototype,"enabled",void 0);e.__decorate([m.property({type:z.SketchTooltipElevationOptions,
nonNullable:!0})],c.prototype,"elevation",void 0);e.__decorate([m.property({type:t.SketchTooltipVisibleElements,nonNullable:!0})],c.prototype,"visibleElements",void 0);e.__decorate([m.property()],c.prototype,"visualVariables",void 0);return c=e.__decorate([P.subclass("esri.widgets.Sketch.SketchTooltipOptions")],c)})},"esri/views/interactive/sketch/SketchTooltipElevationOptions":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),
function(b,e,c,m,w,F,K,P,z){b.SketchTooltipElevationOptions=function(t){function D(a){a=t.call(this,a)||this;a.mode="absolute-height";return a}e._inherits(D,t);D.prototype.toJSON=function(){return{mode:this.mode}};return e._createClass(D)}(m);c.__decorate([w.property({type:String,nonNullable:!0})],b.SketchTooltipElevationOptions.prototype,"mode",void 0);b.SketchTooltipElevationOptions=c.__decorate([z.subclass("esri.widgets.Sketch.SketchTooltipOptions.ElevationOptions")],b.SketchTooltipElevationOptions);
Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/sketch/SketchTooltipVisibleElements":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),function(b,e,c,m,w,F,K,P,z){b.SketchTooltipVisibleElements=function(t){function D(){var a=
t.apply(this,arguments)||this;a.distance=!0;a.elevation=!0;a.size=!0;a.scale=!0;a.rotation=!0;a.orientation=!0;a.totalLength=!0;a.area=!0;a.radius=!0;a.helpMessage=!1;return a}e._inherits(D,t);D.prototype.toJSON=function(){return{distance:this.distance,size:this.size,scale:this.scale,rotation:this.rotation,orientation:this.orientation,totalLength:this.totalLength,area:this.area,radius:this.radius}};return e._createClass(D)}(m);c.__decorate([w.property({type:Boolean,nonNullable:!0})],b.SketchTooltipVisibleElements.prototype,
"distance",void 0);c.__decorate([w.property({type:Boolean,nonNullable:!0})],b.SketchTooltipVisibleElements.prototype,"elevation",void 0);c.__decorate([w.property({type:Boolean,nonNullable:!0})],b.SketchTooltipVisibleElements.prototype,"size",void 0);c.__decorate([w.property({type:Boolean,nonNullable:!0})],b.SketchTooltipVisibleElements.prototype,"scale",void 0);c.__decorate([w.property({type:Boolean,nonNullable:!0})],b.SketchTooltipVisibleElements.prototype,"rotation",void 0);c.__decorate([w.property({type:Boolean,
nonNullable:!0})],b.SketchTooltipVisibleElements.prototype,"orientation",void 0);c.__decorate([w.property({type:Boolean,nonNullable:!0})],b.SketchTooltipVisibleElements.prototype,"totalLength",void 0);c.__decorate([w.property({type:Boolean,nonNullable:!0})],b.SketchTooltipVisibleElements.prototype,"area",void 0);c.__decorate([w.property({type:Boolean,nonNullable:!0})],b.SketchTooltipVisibleElements.prototype,"radius",void 0);c.__decorate([w.property({type:Boolean,nonNullable:!0})],b.SketchTooltipVisibleElements.prototype,
"helpMessage",void 0);b.SketchTooltipVisibleElements=c.__decorate([z.subclass("esri.widgets.Sketch.SketchTooltipOptions.VisibleElements")],b.SketchTooltipVisibleElements);Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingManager":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Evented ../../../core/HandleOwner ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../geometry/projection ../../../support/elevationInfoUtils ./Settings ./SnappingDomain ./snappingFactory ./SnappingOptions ./SnappingPoint ./snappingUtils ./candidates/IntersectionSnappingCandidate ../support/viewUtils".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a,g,u,v,k,n,p,y,O,C,f){function h({coordinateHelper:l,elevationInfo:q}){return l.hasZ()?u.absoluteHeightElevationInfo:q}b.SnappingManager=function(l){function q(N){N=l.call(this,N)||this;N.options=new p;N.snappingEnginesFactory=n.defaultSnappingEnginesFactory;N._engines=[];N._currentMainCandidate=null;N._currentOtherActiveCandidates=[];N._currentSnappedType=d.MAIN;return N}e._inherits(q,l);var H=q.prototype;H.initialize=function(){this.handles.add([K.watch(()=>{const {effectiveFeatureEnabled:N,
effectiveSelfEnabled:E,touchSensitivityMultiplier:r,distance:I}=this.options;return{effectiveFeatureEnabled:N,effectiveSelfEnabled:E,touchSensitivityMultiplier:r,distance:I}},()=>{this.doneSnapping();this.emit("changed")},K.sync),K.watch(()=>this.options,N=>{for(const E of this._engines)E.options=N},K.sync),K.watch(()=>({viewReady:this.view.ready,viewSpatialReference:this.view.spatialReference,snappingEnginesFactory:this.snappingEnginesFactory}),({viewReady:N,snappingEnginesFactory:E})=>this._recreateEngines(N,
E),K.syncAndInitial)])};H.destroy=function(){this._destroyEngines()};H._recreateEngines=function(N,E){this._destroyEngines();if(N){var {view:r,options:I}=this;this._engines=E(r,I)}};H._destroyEngines=function(){for(const N of this._engines)N.destroy();this._engines=[]};H.snap=async function(N){return null!=N.scenePoint?this._snapMultiPoint(N):this._snapSinglePoint(N)};H.update=function(N){const {point:E,context:r}=N;this._removeVisualization();const I=this._currentMainCandidate;if(null==I)return E;
var M=this._selectUpdateInput(N);if(null==M)return E;({spatialReference:N}=r);var S=g.project(M,N);if(null==S)return E;({view:M}=this);const {elevationInfo:U,visualizer:G}=r,J=[];S=y.pointToSnappingPoint(S,M,r);const L=I.constraint.closestTo(S);if(!this._arePointsWithinScreenThreshold(S,L,r))return this._resetSnappingState(),E;I.targetPoint=L;J.push(...I.hints);for(const B of this._currentOtherActiveCandidates)B.targetPoint=L,J.push(...B.hints);null!=G&&this.handles.add(G.draw(J,{spatialReference:N,
elevationInfo:h(r),view:M,selfSnappingZ:r.selfSnappingZ}),"visualization-handle");return y.snappingPointToSnappingOutput(L,M,{z:E.z,m:E.m,spatialReference:E.spatialReference,elevationInfo:U})};H.doneSnapping=function(){this._removeVisualization();this._resetSnappingState()};H._selectUpdateInput=function({point:N,scenePoint:E}){switch(this._currentSnappedType){case d.MAIN:return N;case d.SCENE:return E}};H._resetSnappingState=function(){this._currentMainCandidate=null;this._currentOtherActiveCandidates=
[];this._currentSnappedType=d.MAIN};H._removeVisualization=function(){this.handles.remove("visualization-handle")};H._snapSinglePoint=async function({point:N,context:E,signal:r}){const {view:I}=this,M=y.pointToSnappingPoint(N,I,E),S=await this._fetchCandidates(M,k.SnappingDomain.ALL,E,r);return this._createSnapResult(M,d.MAIN,S,I,E,{z:N.z,m:N.m,spatialReference:N.spatialReference,elevationInfo:E.elevationInfo},r)};H._snapMultiPoint=async function({point:N,scenePoint:E,context:r,signal:I}){const {view:M}=
this,{coordinateHelper:S,spatialReference:U}=r;await g.initializeProjection(E.spatialReference,U);E=g.project(E,U);var G=y.pointToSnappingPoint(E,M,r);const J=await this._fetchCandidates(G,k.SnappingDomain.FEATURE,r,I);if(0<J.length)return N=await this._fetchCandidates(G,k.SnappingDomain.SELF,r,I),this._createSnapResult(G,d.SCENE,[...J,...N],M,r,{z:E.z,m:E.m,spatialReference:E.spatialReference,elevationInfo:r.elevationInfo},I);E=y.pointToSnappingPoint(N,M,r);G=await this._fetchCandidates(E,k.SnappingDomain.SELF,
r,I);return this._createSnapResult(E,d.MAIN,G,M,r,{z:S.hasZ()&&N.hasZ?N.z??0:void 0,m:S.hasM()&&N.hasM?N.m??0:void 0,spatialReference:N.spatialReference,elevationInfo:r.elevationInfo},I)};H._fetchCandidates=async function(N,E,r,I){return(await Promise.all(this._engines.map(M=>M.fetchCandidates(N,E,r,I)))).flat()};H._createSnapResult=function(N,E,r,I,M,S,U){return{get valid(){return!F.isAborted(U)},apply:()=>{const {spatialReference:G}=M,{snappedPoint:J,hints:L}=this._processCandidates(N,E,r,M);this._removeVisualization();
null!=M.visualizer&&this.handles.add(M.visualizer.draw(L,{spatialReference:G,elevationInfo:u.absoluteHeightElevationInfo,view:I,selfSnappingZ:M.selfSnappingZ}),"visualization-handle");return y.snappingPointToSnappingOutput(J,I,S)}}};H._processCandidates=function(N,E,r,I){if(1>r.length)return this.doneSnapping(),{snappedPoint:N,hints:[]};this._currentSnappedType!==E&&this._resetSnappingState();O.sortCandidatesInPlace(N,r);const M=this._currentMainCandidate;if(null!=M){const S=this._findOldConstraintInNewCandidates(M,
r);if(0<=S)if(r[S]instanceof C.IntersectionSnappingCandidate){if(this._arePointsWithinScreenThreshold(N,M.targetPoint,I))return this._updateSnappingCandidate(M,E,r,I)}else return this._intersectWithOtherCandidates(S,r,N,E,I)}return this._intersectWithOtherCandidates(0,r,N,E,I)};H._findOldConstraintInNewCandidates=function(N,E){return N instanceof C.IntersectionSnappingCandidate?0<=this._findOldCandidateIndex(E,N.first)&&0<=this._findOldCandidateIndex(E,N.second)?0:-1:this._findOldCandidateIndex(E,
N)};H._intersectWithOtherCandidates=function(N,E,r,I,M){const {coordinateHelper:S}=M,U=E[N],G=[];for(let J=0;J<E.length;++J){if(J===N)continue;const L=E[J];for(const B of U.constraint.intersect(L.constraint)){const A=B.closestTo(U.targetPoint);G.push([new C.IntersectionSnappingCandidate(A,U,L,L.isDraped),this._squaredScreenDistance(r,A,S)])}}return 0<G.length&&(G.sort((J,L)=>J[1]-L[1]),G[0][1]<this._squaredPointProximityThreshold(M.pointer))?this._updateSnappingCandidate(G[0][0],I,E,M):this._updateSnappingCandidate(U,
I,E,M)};H._updateSnappingCandidate=function(N,E,r,I){this.doneSnapping();this._currentMainCandidate=N;this._currentSnappedType=E;E=this._currentMainCandidate.targetPoint;const M=[];M.push(...N.hints);for(const S of r){if(N instanceof C.IntersectionSnappingCandidate){if(S.constraint.equals(N.first.constraint)||S.constraint.equals(N.second.constraint))continue}else if(S.constraint.equals(N.constraint))continue;r=S.constraint.closestTo(E);this._squaredScreenDistance(r,E,I.coordinateHelper)<this._squaredSatisfiesConstraintThreshold&&
(S.targetPoint=E,this._currentOtherActiveCandidates.push(S),M.push(...S.hints))}return{snappedPoint:E,hints:M}};H._squaredPointProximityThreshold=function(N){return"touch"===N?this._squaredTouchProximityThreshold:this._squaredMouseProximityTreshold};H._arePointsWithinScreenThreshold=function(N,E,r){return this._squaredScreenDistance(N,E,r.coordinateHelper)<this._squaredPointProximityThreshold(r.pointer)};H._squaredScreenDistance=function(N,E,r){return O.squaredScreenDistance(this._toScreen(N,r),this._toScreen(E,
r))};H._toScreen=function(N,E){return f.vectorToScreenPoint(N,E.spatialReference,u.absoluteHeightElevationInfo,this.view)};H._findOldCandidateIndex=function(N,E){let r=-1;for(let I=0;I<N.length;++I)if(E.constraint.equals(N[I].constraint)){r=I;break}return r};e._createClass(q,[{key:"updating",get:function(){return this._engines.some(N=>N.updating)}},{key:"_squaredMouseProximityTreshold",get:function(){return this.options.distance*this.options.distance}},{key:"_squaredTouchProximityThreshold",get:function(){const {distance:N,
touchSensitivityMultiplier:E}=this.options,r=N*E;return r*r}},{key:"_squaredSatisfiesConstraintThreshold",get:function(){return v.defaults.satisfiesConstraintScreenThreshold*v.defaults.satisfiesConstraintScreenThreshold}},{key:"test",get:function(){return{visualizationsActive:this.handles.has("visualization-handle"),engines:this._engines}}}]);return q}(m.EventedMixin(w.HandleOwner));c.__decorate([P.property({constructOnly:!0})],b.SnappingManager.prototype,"view",void 0);c.__decorate([P.property()],
b.SnappingManager.prototype,"options",void 0);c.__decorate([P.property({readOnly:!0})],b.SnappingManager.prototype,"updating",null);c.__decorate([P.property()],b.SnappingManager.prototype,"snappingEnginesFactory",void 0);c.__decorate([P.property()],b.SnappingManager.prototype,"_engines",void 0);c.__decorate([P.property()],b.SnappingManager.prototype,"_squaredMouseProximityTreshold",null);c.__decorate([P.property()],b.SnappingManager.prototype,"_squaredTouchProximityThreshold",null);c.__decorate([P.property()],
b.SnappingManager.prototype,"_squaredSatisfiesConstraintThreshold",null);b.SnappingManager=c.__decorate([a.subclass("esri.views.interactive.snapping.SnappingManager")],b.SnappingManager);var d;(function(l){l[l.MAIN=0]="MAIN";l[l.SCENE=1]="SCENE"})(d||(d={}));Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/Settings":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Color ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/subclass".split(" "),
function(b,e,c,m,w,F,K){let P=function(z){function t(){var D=z.apply(this,arguments)||this;D.enabled=!0;return D}e._inherits(t,z);return e._createClass(t)}(w.JSONSupport);c.__decorate([F.property({type:Boolean})],P.prototype,"enabled",void 0);P=c.__decorate([K.subclass("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],P);w=function(z){function t(D){D=z.call(this,D)||this;D.lineSnapper=new P;D.parallelLineSnapper=new P;D.rightAngleSnapper=new P;D.rightAngleTriangleSnapper=new P;
D.shortLineThreshold=15;D.distance=5;D.pointThreshold=1E-6;D.intersectionParallelLineThreshold=1E-6;D.parallelLineThreshold=1E-6;D.verticalLineThreshold=.1;D.touchSensitivityMultiplier=1.5;D.pointOnLineThreshold=1E-6;D.orange=new m([255,127,0]);D.orangeTransparent=new m([255,127,0,.5]);D.lineHintWidthReference=3;D.lineHintWidthTarget=3;D.lineHintFadedExtensions=.3;D.parallelLineHintWidth=2;D.parallelLineHintLength=24;D.parallelLineHintOffset=1.5;D.rightAngleHintSize=24;D.rightAngleHintOutlineSize=
1.5;D.satisfiesConstraintScreenThreshold=1;return D}e._inherits(t,z);return e._createClass(t)}(w.JSONSupport);c.__decorate([F.property({type:P,constructOnly:!0,nonNullable:!0,json:{write:!0}})],w.prototype,"lineSnapper",void 0);c.__decorate([F.property({type:P,constructOnly:!0,nonNullable:!0,json:{write:!0}})],w.prototype,"parallelLineSnapper",void 0);c.__decorate([F.property({type:P,constructOnly:!0,nonNullable:!0,json:{write:!0}})],w.prototype,"rightAngleSnapper",void 0);c.__decorate([F.property({type:P,
constructOnly:!0,nonNullable:!0,json:{write:!0}})],w.prototype,"rightAngleTriangleSnapper",void 0);c.__decorate([F.property({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],w.prototype,"shortLineThreshold",void 0);c.__decorate([F.property({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],w.prototype,"distance",void 0);c.__decorate([F.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],w.prototype,"pointThreshold",void 0);
c.__decorate([F.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],w.prototype,"intersectionParallelLineThreshold",void 0);c.__decorate([F.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],w.prototype,"parallelLineThreshold",void 0);c.__decorate([F.property({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],w.prototype,"verticalLineThreshold",void 0);c.__decorate([F.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],
w.prototype,"touchSensitivityMultiplier",void 0);c.__decorate([F.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],w.prototype,"pointOnLineThreshold",void 0);c.__decorate([F.property({type:m,nonNullable:!0})],w.prototype,"orange",void 0);c.__decorate([F.property({type:m,nonNullable:!0})],w.prototype,"orangeTransparent",void 0);c.__decorate([F.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],w.prototype,"lineHintWidthReference",void 0);c.__decorate([F.property({type:Number,
nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],w.prototype,"lineHintWidthTarget",void 0);c.__decorate([F.property({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],w.prototype,"lineHintFadedExtensions",void 0);c.__decorate([F.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],w.prototype,"parallelLineHintWidth",void 0);c.__decorate([F.property({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],w.prototype,"parallelLineHintLength",
void 0);c.__decorate([F.property({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],w.prototype,"parallelLineHintOffset",void 0);c.__decorate([F.property({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],w.prototype,"rightAngleHintSize",void 0);c.__decorate([F.property({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],w.prototype,"rightAngleHintOutlineSize",void 0);c.__decorate([F.property({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],
w.prototype,"satisfiesConstraintScreenThreshold",void 0);w=c.__decorate([K.subclass("esri.views.interactive.snapping.Settings.Defaults")],w);c=new w;b.defaults=c;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingDomain":function(){define(["exports"],function(b){b.SnappingDomain=void 0;var e=b.SnappingDomain||(b.SnappingDomain={});e[e.FEATURE=1]="FEATURE";e[e.SELF=2]="SELF";e[e.ALL=3]="ALL";Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},
"esri/views/interactive/snapping/snappingFactory":function(){define(["exports","./FeatureSnappingEngine","./SelfSnappingEngine"],function(b,e,c){b.defaultSnappingEnginesFactory=function(m,w){return[new c.SelfSnappingEngine({view:m,options:w}),new e.FeatureSnappingEngine({view:m,options:w,spatialReference:m.spatialReference})]};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/FeatureSnappingEngine":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/HandleOwner ../../../core/Handles ../../../core/MapUtils ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../chunks/vec2 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../chunks/common ../../../support/elevationInfoUtils ./SnappingConstraint ./SnappingDomain ./SnappingPoint ./snappingUtils ./candidates/DrapedEdgeSnappingCandidate ./candidates/EdgeSnappingCandidate ./candidates/FeatureSnappingCandidate ./candidates/RightAngleSnappingCandidate ../support/viewUtils".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a,g,u,v,k,n,p,y,O,C,f,h,d,l,q,H,N){function E({constraint:{start:U,end:G}}){const J=k.squaredDistance(U,G);U=v.squaredDistance(U,G);return J<p.getEpsilon()||1E-4>U/J}function r(U,G,J,L,B,A,{spatialReference:x}){G=k.copy(S,G);G[0]+=J;G[1]+=L;G[2]+=B;return(J=N.vectorToScreenPoint(G,x,y.absoluteHeightElevationInfo,A))?h.screenDistance(J,U):Infinity}e.FeatureSnappingEngine=function(U){function G(L){L=U.call(this,L)||this;L.options=null;L._domain=C.SnappingDomain.FEATURE;
L._sourceModules={featureService:{module:null,loader:null},featureCollection:{module:null,loader:null},graphics:{module:null,loader:null},notes:{module:null,loader:null},scene:{module:null,loader:null}};return L}c._inherits(G,U);var J=G.prototype;J.initialize=function(){this.updatingHandles.add(()=>this.snappingSources,()=>this.notifyChange("updating"),z.sync);null!=this.view&&this.handles.add([this.view.on("layerview-create",L=>this._updateLayerView(L.layer,L.layerView)),this.view.on("layerview-destroy",
L=>this._updateLayerView(L.layer,null))])};J._updateLayerView=function(L,B){for(const [,A]of this.snappingSources)A.snappingSource.layerSource.layer===L&&(A.layerView=B)};J.destroy=function(){this._set("options",null);for(const [,L]of this.snappingSources)L.destroy()};J.fetchCandidates=async function(L,B,A,x){if(!(B&this._domain&&null!=this.options&&this.options.effectiveFeatureEnabled))return[];var Q=[];B=this._computeScreenSizeDistanceParameters(L,A);const T={distance:B,mode:this.view?.type??"2d",
point:L,coordinateHelper:A.coordinateHelper,...this._types};for(const [,{snappingSource:W,layerView:aa}]of this.snappingSources)!W.layerSource.enabled||null!=aa&&aa.suspended||Q.push(W.fetchCandidates(T,x).then(Y=>Y.filter(Z=>!this._candidateIsExcluded(W,Z,A.excludeFeature))));Q=(await P.eachAlwaysValues(Q)).flat();this._addRightAngleCandidates(Q,L,B,A);P.throwIfAborted(x);h.sortCandidatesInPlace(L,Q);return Q};J._addRightAngleCandidates=function(L,B,A,x){var Q=null!=x.vertexHandle?x.vertexHandle.rightEdge?.rightVertex?.pos:
null!=x.editGeometryOperations&&"polygon"===x.editGeometryOperations.data.type?x.editGeometryOperations.data.components[0]?.getFirstVertex()?.pos:null,T=null!=x.vertexHandle?x.vertexHandle.leftEdge?.leftVertex?.pos:null!=x.editGeometryOperations?x.editGeometryOperations.data.components[0]?.getLastVertex()?.pos:null,{view:W}=this;Q=f.anyMapPointToSnappingPoint(Q,W,x);x=f.anyMapPointToSnappingPoint(T,W,x);T=L.length;for(W=0;W<T;W++)this._addRightAngleCandidate(L[W],x,B,A,L),this._addRightAngleCandidate(L[W],
Q,B,A,L)};J._addRightAngleCandidate=function(L,B,A,x,Q){var T;(T=null==B)||(T=!((L instanceof l.EdgeSnappingCandidate||L instanceof d.DrapedEdgeSnappingCandidate)&&!E(L)));if(!T){T=L.constraint.closestTo(B);var W=(T[0]-A[0])/x.x;A=(T[1]-A[1])/x.y;var {start:aa,end:Y}=L.constraint;1>=W*W+A*A&&(L=new H.RightAngleSnappingCandidate({targetPoint:T,otherVertex:B,otherVertexType:H.OtherVertexType.NEXT,previousVertex:v.squaredDistance(T,aa)>v.squaredDistance(T,Y)?aa:Y,constraint:new O.VerticalHalfPlaneConstraint(B,
T),objectId:L.objectId,isDraped:L.isDraped}),Q.push(L))}};J._computeScreenSizeDistanceParameters=function(L,B){let A=null!=this.options?this.options.distance*("touch"===B.pointer?this.options.touchSensitivityMultiplier:1):0;return null==this.view?{x:A,y:A,z:A,distance:A}:"2d"===this.view.type?(A*=this.view.resolution,{x:A,y:A,z:A,distance:A}):this._computeScreenSizeDistanceParameters3D(L,A,this.view,B)};J._computeScreenSizeDistanceParameters3D=function(L,B,A,x){var {spatialReference:Q}=x;A.renderCoordsHelper.toRenderCoords(L,
Q,M);const T=A.state.camera.computeScreenPixelSizeAt(M),W=T*A.renderCoordsHelper.unitInMeters/A.mapCoordsHelper.unitInMeters,aa=B*W,Y=N.vectorToScreenPoint(L,Q,y.absoluteHeightElevationInfo,A);Q=Y?r(Y,L,W,0,0,A,x):0;const Z=Y?r(Y,L,0,W,0,A,x):0;L=Y?r(Y,L,0,0,W,A,x):0;return{x:0===Q?0:aa/Q,y:0===Z?0:aa/Z,z:0===L?0:aa/L,distance:T*B}};J._candidateIsExcluded=function(L,B,A){if(null==A)return!1;B=this._getCandidateObjectId(B);if(null==B)return!1;L=L.layerSource.layer;return"graphics"===L.type?A.uid===
B:A.sourceLayer===L&&A.attributes&&"objectIdField"in L?A.attributes[L.objectIdField]===B:!1};J._getCandidateObjectId=function(L){return L instanceof q.FeatureSnappingCandidate?L.objectId:null};J._createSourceInfo=function(L){const B=this._createFeatureSnappingSourceType(L);if(null==B)return null;if("loading"in B)return this.updatingHandles.addPromise(B.loading.then(()=>{this.destroyed||this.notifyChange("snappingSources")})),null;const A=null!=this.view?this.view.allLayerViews.find(x=>x.layer===L.layer):
null;return new I(B.source,A)};J._createFeatureSnappingSourceType=function(L){switch(L.layer.type){case "feature":case "geojson":case "csv":case "oriented-imagery":case "subtype-group":case "wfs":return this._createFeatureSnappingSourceFeatureLayer(L);case "graphics":return this._createFeatureSnappingSourceGraphicsLayer(L);case "map-notes":return this._createFeatureSnappingSourceMapNotesLayer(L);case "scene":case "building-scene":return this._createFeatureSnappingSourceSceneLayer(L)}return null};
J._createFeatureSnappingSourceSceneLayer=function(L){const {view:B}=this;if(null==B||"3d"!==B.type)return null;const A=this._getSourceModule("scene");return null!=A.module?{source:new A.module.SceneLayerSnappingSource({layerSource:L,view:B})}:{loading:A.loader}};J._createFeatureSnappingSourceFeatureLayer=function(L){switch(L.layer.source?.type){case "feature-layer":case "oriented-imagery":var B=this._getSourceModule("featureService");return null!=B.module?{source:new B.module.FeatureServiceSnappingSource({spatialReference:this.spatialReference,
view:this.view,layerSource:L})}:{loading:B.loader};case "memory":case "csv":case "geojson":case "wfs":if("mesh"!==L.layer.geometryType)return B=this._getSourceModule("featureCollection"),null!=B.module?{source:new B.module.FeatureCollectionSnappingSource({layerSource:L,view:this.view})}:{loading:B.loader}}return null};J._createFeatureSnappingSourceGraphicsLayer=function(L){const B=this._getSourceModule("graphics");return null!=B.module?{source:new B.module.GraphicsSnappingSource({getGraphicsLayers:()=>
[L.layer],spatialReference:this.spatialReference,view:this.view,layerSource:L})}:{loading:B.loader}};J._createFeatureSnappingSourceMapNotesLayer=function(L){const B=this._getSourceModule("notes");return null!=B.module?{source:new B.module.GraphicsSnappingSource({getGraphicsLayers:()=>null!=L.layer.sublayers?L.layer.sublayers.toArray():[],spatialReference:this.spatialReference,view:this.view,layerSource:L})}:{loading:B.loader}};J._getSourceModule=function(L){const B=this._sourceModules[L];return null==
B.loader?(L=this._loadSourceModule(L).then(A=>{B.module=A}),B.loader=L,{module:B.module,loader:L}):{module:B.module,loader:B.loader}};J._loadSourceModule=function(L){const B=this.updatingHandles;switch(L){case "featureService":return B.addPromise(new Promise((A,x)=>b(["./featureSources/FeatureServiceSnappingSource"],A,x)));case "featureCollection":return B.addPromise(new Promise((A,x)=>b(["./featureSources/FeatureCollectionSnappingSource"],A,x)));case "graphics":return B.addPromise(new Promise((A,
x)=>b(["./featureSources/GraphicsSnappingSource"],A,x)));case "notes":return B.addPromise(new Promise((A,x)=>b(["./featureSources/GraphicsSnappingSource"],A,x)));case "scene":return B.addPromise(new Promise((A,x)=>b(["./featureSources/SceneLayerSnappingSource"],A,x)))}};c._createClass(G,[{key:"updating",get:function(){return K.someMap(this.snappingSources,({snappingSource:L})=>L.updating)||this.updatingHandles.updating}},{key:"snappingSources",get:function(){const L=this._get("snappingSources")||
new Map,B=new Map;if(null!=this.options&&null!=this.options.featureSources)for(const x of this.options.featureSources.items){const Q=x.layer.uid;var A=L.get(Q);A?(L.delete(Q),B.set(Q,A)):x.layer.loaded?(A=this._createSourceInfo(x),null!=A&&B.set(Q,A)):this.updatingHandles.addPromise(x.layer.load())}for(const [,x]of L)x.destroy();return B}},{key:"_types",get:function(){return{returnEdge:!0,returnVertex:!0}}}]);return G}(w.HandleOwner);m.__decorate([t.property({constructOnly:!0})],e.FeatureSnappingEngine.prototype,
"spatialReference",void 0);m.__decorate([t.property({constructOnly:!0})],e.FeatureSnappingEngine.prototype,"view",void 0);m.__decorate([t.property()],e.FeatureSnappingEngine.prototype,"options",void 0);m.__decorate([t.property({readOnly:!0})],e.FeatureSnappingEngine.prototype,"updating",null);m.__decorate([t.property({readOnly:!0})],e.FeatureSnappingEngine.prototype,"snappingSources",null);e.FeatureSnappingEngine=m.__decorate([u.subclass("esri.views.interactive.snapping.FeatureSnappingEngine")],e.FeatureSnappingEngine);
let I=function(){function U(G,J){this.snappingSource=G;this.layerView=J;this.handles=new F;J=this.snappingSource.layerSource.layer;"refresh"in J&&this.handles.add(J.on("refresh",()=>G.refresh()));this.handles.add([z.watch(()=>G.updating,L=>G.layerSource.updating=L,z.syncAndInitial),z.watch(()=>G.availability,L=>G.layerSource.availability=L,z.syncAndInitial)])}U.prototype.destroy=function(){this.snappingSource.destroy();this.handles.destroy()};return c._createClass(U)}();const M=n.create(),S=n.create();
Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/vec2":function(){define(["exports","./common"],function(b,e){function c(B,A){B[0]=A[0];B[1]=A[1];return B}function m(B,A,x){B[0]=A;B[1]=x;return B}function w(B,A,x){B[0]=A[0]+x[0];B[1]=A[1]+x[1];return B}function F(B,A,x){B[0]=A[0]-x[0];B[1]=A[1]-x[1];return B}function K(B,A,x){B[0]=A[0]*x[0];B[1]=A[1]*x[1];return B}function P(B,A,x){B[0]=A[0]/x[0];B[1]=A[1]/x[1];return B}function z(B,A){B[0]=Math.ceil(A[0]);B[1]=Math.ceil(A[1]);
return B}function t(B,A){B[0]=Math.floor(A[0]);B[1]=Math.floor(A[1]);return B}function D(B,A,x){B[0]=Math.min(A[0],x[0]);B[1]=Math.min(A[1],x[1]);return B}function a(B,A,x){B[0]=Math.max(A[0],x[0]);B[1]=Math.max(A[1],x[1]);return B}function g(B,A){B[0]=Math.round(A[0]);B[1]=Math.round(A[1]);return B}function u(B,A,x){B[0]=A[0]*x;B[1]=A[1]*x;return B}function v(B,A,x,Q){B[0]=A[0]+x[0]*Q;B[1]=A[1]+x[1]*Q;return B}function k(B,A){const x=A[0]-B[0];B=A[1]-B[1];return Math.sqrt(x*x+B*B)}function n(B,A){const x=
A[0]-B[0];B=A[1]-B[1];return x*x+B*B}function p(B){const A=B[0];B=B[1];return Math.sqrt(A*A+B*B)}function y(B){const A=B[0];B=B[1];return A*A+B*B}function O(B,A){B[0]=-A[0];B[1]=-A[1];return B}function C(B,A){B[0]=1/A[0];B[1]=1/A[1];return B}function f(B,A){var x=A[0];const Q=A[1];x=x*x+Q*Q;0<x&&(x=1/Math.sqrt(x),B[0]=A[0]*x,B[1]=A[1]*x);return B}function h(B,A){return B[0]*A[0]+B[1]*A[1]}function d(B,A,x){A=A[0]*x[1]-A[1]*x[0];B[0]=B[1]=0;B[2]=A;return B}function l(B,A,x,Q){const T=A[0];A=A[1];B[0]=
T+Q*(x[0]-T);B[1]=A+Q*(x[1]-A);return B}function q(B,A){A=A||1;const x=2*e.RANDOM()*Math.PI;B[0]=Math.cos(x)*A;B[1]=Math.sin(x)*A;return B}function H(B,A,x){const Q=A[0];A=A[1];B[0]=x[0]*Q+x[2]*A;B[1]=x[1]*Q+x[3]*A;return B}function N(B,A,x){const Q=A[0];A=A[1];B[0]=x[0]*Q+x[2]*A+x[4];B[1]=x[1]*Q+x[3]*A+x[5];return B}function E(B,A,x){const Q=A[0];A=A[1];B[0]=x[0]*Q+x[3]*A+x[6];B[1]=x[1]*Q+x[4]*A+x[7];return B}function r(B,A,x){const Q=A[0];A=A[1];B[0]=x[0]*Q+x[4]*A+x[12];B[1]=x[1]*Q+x[5]*A+x[13];
return B}function I(B,A,x,Q){const T=A[0]-x[0];A=A[1]-x[1];const W=Math.sin(Q);Q=Math.cos(Q);B[0]=T*Q-A*W+x[0];B[1]=T*W+A*Q+x[1];return B}function M(B,A){var x=B[0];B=B[1];const Q=A[0];A=A[1];let T=x*x+B*B;0<T&&(T=1/Math.sqrt(T));let W=Q*Q+A*A;0<W&&(W=1/Math.sqrt(W));x=(x*Q+B*A)*T*W;return 1<x?0:-1>x?Math.PI:Math.acos(x)}function S(B){return"vec2("+B[0]+", "+B[1]+")"}function U(B,A){return B[0]===A[0]&&B[1]===A[1]}function G(B,A){const x=B[0];B=B[1];const Q=A[0];A=A[1];const T=e.getEpsilon();return Math.abs(x-
Q)<=T*Math.max(1,Math.abs(x),Math.abs(Q))&&Math.abs(B-A)<=T*Math.max(1,Math.abs(B),Math.abs(A))}function J(B,A,x,Q,T){let W=A[0]-x[0];x=A[1]-x[1];T=(Q[0]*W+Q[1]*x)*(T-1);W=Q[0]*T;x=Q[1]*T;B[0]=A[0]+W;B[1]=A[1]+x;return B}const L=Object.freeze(Object.defineProperty({__proto__:null,add:w,angle:M,ceil:z,copy:c,cross:d,dist:k,distance:k,div:P,divide:P,dot:h,equals:G,exactEquals:U,floor:t,inverse:C,len:p,length:p,lerp:l,max:a,min:D,mul:K,multiply:K,negate:O,normalize:f,projectAndScale:J,random:q,rotate:I,
round:g,scale:u,scaleAndAdd:v,set:m,sqrDist:n,sqrLen:y,squaredDistance:n,squaredLength:y,str:S,sub:F,subtract:F,transformMat2:H,transformMat2d:N,transformMat3:E,transformMat4:r},Symbol.toStringTag,{value:"Module"}));b.add=w;b.angle=M;b.ceil=z;b.copy=c;b.cross=d;b.dist=k;b.distance=k;b.div=P;b.divide=P;b.dot=h;b.equals=G;b.exactEquals=U;b.floor=t;b.inverse=C;b.len=p;b.length=p;b.lerp=l;b.max=a;b.min=D;b.mul=K;b.multiply=K;b.negate=O;b.normalize=f;b.projectAndScale=J;b.random=q;b.rotate=I;b.round=g;
b.scale=u;b.scaleAndAdd=v;b.set=m;b.sqrDist=n;b.sqrLen=y;b.squaredDistance=n;b.squaredLength=y;b.str=S;b.sub=F;b.subtract=F;b.transformMat2=H;b.transformMat2d=N;b.transformMat3=E;b.transformMat4=r;b.vec2=L})},"esri/views/interactive/snapping/SnappingConstraint":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../chunks/vec3 ../../../chunks/vec3f64 ./SnappingPoint ../../support/geometry3dUtils ../../support/geometry2dUtils".split(" "),
function(b,e,c,m,w,F,K,P,z){function t(I,M){let S=[];if(g(I)){var {point:U}=I;u(M)?S=P.intersectLineAndPoint(M.lineLike,U):v(M)?S=P.intersectVerticalCylinderAndPoint(M.center,M.radius,U):k(M)?S=P.intersectVerticalPlaneAndPoint(M.planeLike,U):n(M)&&(S=D(M,I))}else if(u(I))({lineLike:U}=I),g(M)?S=P.intersectLineAndPoint(U,M.point):u(M)?S=P.intersectLineLike(U,M.lineLike):v(M)?S=P.intersectLineLikeAndVerticalCylinder(U,M.center,M.radius):k(M)?S=P.intersectVerticalPlaneAndLineLike(M.planeLike,U):n(M)&&
(S=D(M,I));else if(v(I)){const {center:G,radius:J}=I;if(u(M))S=P.intersectLineLikeAndVerticalCylinder(M.lineLike,G,J);else if(g(M))S=P.intersectVerticalCylinderAndPoint(G,J,M.point);else{if(k(M))return P.intersectVerticalPlaneAndVerticalCylinder(M.planeLike,G,J).map(L=>new h(L,I,M));n(M)&&(S=D(M,I))}}else if(k(I)){({planeLike:U}=I);if(k(M))return P.intersectVerticalPlane(U,M.planeLike).map(G=>new h(G,I,M));if(g(M))S=P.intersectVerticalPlaneAndPoint(U,M.point);else if(u(M))S=P.intersectVerticalPlaneAndLineLike(U,
M.lineLike);else{if(v(M))return P.intersectVerticalPlaneAndVerticalCylinder(U,M.center,M.radius).map(G=>new h(G,I,M));n(M)&&(S=D(M,I))}}else n(I)&&(S=D(I,M));return a(S,I,M)}function D(I,M){const {planeLike:S,getZ:U}=I,G=[];if(g(M))I.addIfOnTheGround(G,P.intersectVerticalPlaneAndPoint(S,M.point));else if(u(M))I.addIfOnTheGround(G,P.intersectVerticalPlaneAndLineLike(S,M.lineLike));else if(v(M))for(const [J,L]of P.intersectVerticalPlaneAndVerticalCylinder(S,M.center,M.radius))I=U(J,L,0),null!=I&&G.push(F.fromValues(J,
L,I));else if(k(M)||n(M))for(const [J,L]of P.intersectVerticalPlane(S,M.planeLike))I=U(J,L,0)??0,G.push(F.fromValues(J,L,I));return G}function a(I,M,S){return I.map(U=>new f(K.asSnappingPoint(U),M,S))}function g(I){return I instanceof y}function u(I){return I instanceof O}function v(I){return I instanceof d}function k(I){return I instanceof l}function n(I){return I instanceof N}let p=function(){function I(){}I.prototype.intersect=function(M){return t(this,M)};return e._createClass(I)}(),y=function(I){function M(U){var G=
I.call(this)||this;G.point=U;return G}e._inherits(M,I);var S=M.prototype;S.equals=function(U){return g(U)&&w.exactEquals(this.point,U.point)};S.closestTo=function(){return K.cloneSnappingPoint(this.point)};return e._createClass(M)}(p),O=function(I){function M(U,G,J){var L=I.call(this)||this;L.start=U;L.end=G;L.type=J;L.lineLike={start:L.start,end:L.end,type:L.type};return L}e._inherits(M,I);var S=M.prototype;S.equals=function(U){return u(U)&&this.type===U.type&&w.exactEquals(this.start,U.start)&&
w.exactEquals(this.end,U.end)};S.closestTo=function(U){U=P.projectPointToLineLike(U,this.lineLike);return K.asSnappingPoint(U)};return e._createClass(M)}(p),C=function(I){function M(S,U){return I.call(this,S,U,z.LineType.LINE)||this}e._inherits(M,I);return e._createClass(M)}(O),f=function(I){function M(U,G,J){var L=I.call(this)||this;L.intersection=U;L.first=G;L.second=J;return L}e._inherits(M,I);var S=M.prototype;S.equals=function(U){return U instanceof M&&this.first.equals(U.first)&&this.second.equals(U.second)};
S.closestTo=function(){return K.cloneSnappingPoint(this.intersection)};return e._createClass(M)}(p),h=function(I){function M(U,G,J){var L=I.call(this)||this;L.basePoint=U;L.first=G;L.second=J;return L}e._inherits(M,I);var S=M.prototype;S.equals=function(U){return U instanceof M&&this.first.equals(U.first)&&this.second.equals(U.second)};S.closestTo=function(U){const G=this.basePoint;return K.asSnappingPoint(F.fromValues(G[0],G[1],U[2]))};return e._createClass(M)}(p),d=function(I){function M(U,G){var J=
I.call(this)||this;J.center=U;J.radius=G;return J}e._inherits(M,I);var S=M.prototype;S.equals=function(U){return v(U)&&this.center[0]===U.center[0]&&this.center[1]===U.center[1]&&this.radius===U.radius};S.closestTo=function(U){U=P.projectPointToVerticalCylinder(U,this.center,this.radius);return K.asSnappingPoint(U)};return e._createClass(M)}(p),l=function(I){function M(U,G,J){var L=I.call(this)||this;L.start=U;L.end=G;L.type=J;L.planeLike={start:U,end:G,type:J};return L}e._inherits(M,I);var S=M.prototype;
S.equals=function(U){return k(U)&&this.type===U.type&&w.exactEquals(this.start,U.start)&&w.exactEquals(this.end,U.end)};S.closestTo=function(U){return K.asSnappingPoint(P.projectPointToVerticalPlane(U,this.planeLike))};S.closestEndTo=function(U){const {start:G,end:J}=this;return 0<Math.sign(c.dot(c.subtract(E,J,G),c.subtract(r,U,G)))?J:G};return e._createClass(M)}(p),q=function(I){function M(S,U){return I.call(this,S,U,P.VerticalPlaneType.HALF_PLANE)||this}e._inherits(M,I);return e._createClass(M)}(l),
H=function(I){function M(S,U){return I.call(this,S,U,P.VerticalPlaneType.PLANE)||this}e._inherits(M,I);return e._createClass(M)}(l),N=function(I){function M(U,G,J){var L=I.call(this)||this;L.start=U;L.end=G;L.getZ=J;L.planeLike={start:U,end:G,type:P.VerticalPlaneType.PLANE};return L}e._inherits(M,I);var S=M.prototype;S.equals=function(U){return n(U)&&w.exactEquals(this.start,U.start)&&w.exactEquals(this.end,U.end)&&this.getZ===U.getZ};S.closestTo=function(U){const G=P.projectPointToVerticalPlane(U,
this.planeLike);G[2]=this.getZ(U[0],U[1],U[2])??0;return K.asSnappingPoint(G)};S.addIfOnTheGround=function(U,G){for(const J of G)G=this.getZ(J[0],J[1],J[2])??0,Math.abs(J[2]-G)<P.epsilon&&(J[2]=G,U.push(J))};return e._createClass(M)}(p);const E=m.create(),r=m.create();b.DrapedLineConstraint=N;b.IntersectionConstraint=f;b.LineConstraint=C;b.LineLikeConstraint=O;b.PointConstraint=y;b.SnappingConstraint=p;b.VerticalCylinderConstraint=d;b.VerticalHalfPlaneConstraint=q;b.VerticalLineIntersectionConstraint=
h;b.VerticalPlaneConstraint=H;b.VerticalPlaneLikeConstraint=l;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/vec2f64":function(){define(["exports"],function(b){function e(){return[0,0]}function c(k){return[k[0],k[1]]}function m(k,n){return[k,n]}function w(k){const n=[0,0],p=Math.min(2,k.length);for(let y=0;y<p;++y)n[y]=k[y];return n}function F(k,n){return new Float64Array(k,n,2)}function K(){return[0,0]}function P(){return[1,1]}function z(){return[1,0]}function t(){return[0,
1]}const D=[0,0],a=[1,1],g=[1,0],u=[0,1],v=Object.freeze(Object.defineProperty({__proto__:null,ONES:a,UNIT_X:g,UNIT_Y:u,ZEROS:D,clone:c,create:e,createView:F,fromArray:w,fromValues:m,ones:P,unitX:z,unitY:t,zeros:K},Symbol.toStringTag,{value:"Module"}));b.ONES=a;b.UNIT_X=g;b.UNIT_Y=u;b.ZEROS=D;b.clone=c;b.create=e;b.createView=F;b.fromArray=w;b.fromValues=m;b.ones=P;b.unitX=z;b.unitY=t;b.vec2f64=v;b.zeros=K})},"esri/views/interactive/snapping/SnappingPoint":function(){define(["exports","../../../chunks/vec3f64",
"../../../layers/graphics/dehydratedFeatures","../../../support/elevationInfoUtils"],function(b,e,c,m){function w(K,P,z){if(null==K)return null;if(null==P)return e.fromValues(K.x,K.y,K.z??0);if("2d"===P.type)return e.fromValues(K.x,K.y,0);({elevationInfo:z}=z);P=m.getConvertedElevation(P,K,z,m.absoluteHeightElevationInfo)??0;return e.fromValues(K.x,K.y,P)}const F=c.makeDehydratedPoint(0,0,0,null);b.anyMapPointToSnappingPoint=function(K,P,z){return null==K?null:w(z.coordinateHelper.vectorToDehydratedPoint(K,
F),P,z)};b.asSnappingPoint=function(K){return K};b.cloneSnappingPoint=function(K){return e.clone(K)};b.createSnappingPoint=function(K,P,z){return e.fromValues(K,P,z)};b.pointToSnappingPoint=w;b.snappingPointToDehydratedPoint=function(K,P){return c.makeDehydratedPoint(K[0],K[1],K[2],P)};b.snappingPointToSnappingOutput=function(K,P,{z,m:t,spatialReference:D,elevationInfo:a}){if(null==z&&null==t)return K=c.makeDehydratedPoint(K[0],K[1],void 0,D),null!=t&&(K.m=t,K.hasM=!0),K;if(null==P||"2d"===P.type)return K=
c.makeDehydratedPoint(K[0],K[1],z,D),null!=t&&(K.m=t,K.hasM=!0),K;P=m.getConvertedElevationFromVector(P,K,D,m.absoluteHeightElevationInfo,a)??0;K=c.makeDehydratedPoint(K[0],K[1],P,D);null!=t&&(K.m=t,K.hasM=!0);return K};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/dehydratedFeatures":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/byteSizeEstimations ../../core/has ../../core/typedArrayUtil ../../core/uid ../../geometry/SpatialReference ../../geometry/support/aaBoundingBox ../../geometry/support/aaBoundingRect ../../geometry/support/quantizationUtils ../../geometry/support/typeUtils ../support/Field ./dehydratedFeatureComparison".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a,g){function u(k,n,p){if(null==k)return null;switch(n){case "point":return{x:k.x,y:k.y,z:k.z,m:k.m,hasZ:null!=k.z,hasM:null!=k.m,type:"point",spatialReference:p};case "polyline":return{paths:k.paths,hasZ:!!k.hasZ,hasM:!!k.hasM,type:"polyline",spatialReference:p};case "polygon":return{rings:k.rings,hasZ:!!k.hasZ,hasM:!!k.hasM,type:"polygon",spatialReference:p};case "multipoint":return{points:k.points,hasZ:!!k.hasZ,hasM:!!k.hasM,type:"multipoint",spatialReference:p}}}
function v(k){if(null==k)return 0;let n=32;switch(k.type){case "point":n+=42;break;case "polyline":case "polygon":var p=0;const y=2+(k.hasZ?1:0)+(k.hasM?1:0);k="polyline"===k.type?k.paths:k.rings;for(const O of k)p+=O.length;n+=8*p*y+64;n+=128*p;n=n+34+32*(k.length+1);break;case "multipoint":p=k.points.length;n+=8*p*(2+(k.hasZ?1:0)+(k.hasM?1:0))+64;n+=128*p;n=n+34+32;break;case "extent":n+=98;k.hasM&&(n+=32);k.hasZ&&(n+=32);break;case "mesh":n+=w.estimateSize(k.vertexAttributes.position),n+=w.estimateSize(k.vertexAttributes.normal),
n+=w.estimateSize(k.vertexAttributes.uv),n+=w.estimateSize(k.vertexAttributes.tangent)}return n}m=e._createClass(function(k,n,p){this.uid=k;this.geometry=n;this.attributes=p;this.visible=!0;this.centroid=this.objectId=null});e=e._createClass(function(){this.exceededTransferLimit=!1;this.features=[];this.fields=[];this.hasZ=this.hasM=!1;this.transform=this.spatialReference=this.geohashFieldName=this.geometryProperties=this.globalIdFieldName=this.objectIdFieldName=this.geometryType=null});b.equals=
g.equals;b.DehydratedFeatureClass=m;b.DehydratedFeatureSetClass=e;b.computeAABB=function(k,n){P.empty(n);"mesh"===k.type&&(k=k.extent);switch(k.type){case "point":n[0]=n[3]=k.x;n[1]=n[4]=k.y;k.hasZ&&(n[2]=n[5]=k.z);break;case "polyline":for(var p=0;p<k.paths.length;p++)P.expandWithNestedArray(n,k.paths[p],!!k.hasZ);break;case "polygon":for(p=0;p<k.rings.length;p++)P.expandWithNestedArray(n,k.rings[p],!!k.hasZ);break;case "multipoint":P.expandWithNestedArray(n,k.points,!!k.hasZ);break;case "extent":n[0]=
k.xmin,n[1]=k.ymin,n[3]=k.xmax,n[4]=k.ymax,null!=k.zmin&&(n[2]=k.zmin),null!=k.zmax&&(n[5]=k.zmax)}};b.computeAABR=function(k,n){z.empty(n);"mesh"===k.type&&(k=k.extent);switch(k.type){case "point":n[0]=n[2]=k.x;n[1]=n[3]=k.y;break;case "polyline":for(var p=0;p<k.paths.length;p++)z.expandWithNestedArray(n,k.paths[p]);break;case "polygon":for(p=0;p<k.rings.length;p++)z.expandWithNestedArray(n,k.rings[p]);break;case "multipoint":z.expandWithNestedArray(n,k.points);break;case "extent":n[0]=k.xmin,n[1]=
k.ymin,n[2]=k.xmax,n[3]=k.ymax}};b.estimateGeometryObjectSize=v;b.estimateSize=function(k){let n;n=32+c.estimateAttributesObjectSize(k.attributes);return n=n+3+(8+v(k.geometry))};b.fromFeatureSetJSON=function(k){const n=D.featureGeometryTypeKebabDictionary.fromJSON(k.geometryType),p=K.fromJSON(k.spatialReference),y=k.transform,O=k.features.map(C=>{var f=k.objectIdFieldName;C={uid:F.generateUID(),objectId:f&&C.attributes?C.attributes[f]:null,attributes:C.attributes,geometry:u(C.geometry,n,p),visible:!0};
f=C.geometry;if(null!=f&&y)switch(f.type){case "point":C.geometry=t.unquantizePoint(y,f,f,f.hasZ,f.hasM);break;case "multipoint":C.geometry=t.unquantizeMultipoint(y,f,f,!!f.hasZ,!!f.hasM);break;case "polygon":C.geometry=t.unquantizePolygon(y,f,f,!!f.hasZ,!!f.hasM);break;case "polyline":C.geometry=t.unquantizePolyline(y,f,f,!!f.hasZ,!!f.hasM);break;case "extent":C.geometry=f;break;case "mesh":C.geometry=f}return C});return{geometryType:n,features:O,spatialReference:p,fields:k.fields?.map(C=>a.fromJSON(C))??
[],objectIdFieldName:k.objectIdFieldName,globalIdFieldName:k.globalIdFieldName,geohashFieldName:k.geohashFieldName,geometryProperties:k.geometryProperties,hasZ:k.hasZ,hasM:k.hasM,exceededTransferLimit:k.exceededTransferLimit,transform:null}};b.fromJSONGeometry=u;b.getObjectId=function(k,n){return null!=k.objectId?k.objectId:k.attributes&&n?k.attributes[n]:null};b.hasGeometry=function(k){return null!=k.geometry};b.hasVertices=function(k){if(null==k)return!1;switch(k.type){case "extent":case "point":return!0;
case "polyline":for(const n of k.paths)if(0<n.length)return!0;return!1;case "polygon":for(const n of k.rings)if(0<n.length)return!0;return!1;case "multipoint":return 0<k.points.length;case "mesh":return!k.loaded||0<k.vertexAttributes.position.length}};b.makeDehydratedPoint=function(k,n,p,y){return{x:k,y:n,z:p,hasZ:null!=p,hasM:!1,spatialReference:y,type:"point"}};b.numVertices=function(k){if(null==k)return 0;switch(k.type){case "point":return 1;case "polyline":var n=0;for(var p of k.paths)n+=p.length;
return n;case "polygon":p=0;for(n of k.rings)p+=n.length;return p;case "multipoint":return k.points.length;case "extent":return 2;case "mesh":return(k=k.vertexAttributes&&k.vertexAttributes.position)?k.length/3:0}};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/byteSizeEstimations":function(){define(["exports"],function(b){function e(w){return 32+w.length}function c(w){if(!w)return 0;if(Array.isArray(w)){var F=w.length;if(0===F||"number"===typeof w[0])w=32+8*F;else{var K=
32;for(let P=0;P<F;P++)K+=m(w[P]);w=K}return w}K=32;for(F in w)w.hasOwnProperty(F)&&(K+=m(w[F]));return K}function m(w){switch(typeof w){case "object":return c(w);case "string":return e(w);case "number":return 16;case "boolean":return 4;default:return 8}}b.estimateAttributesObjectSize=function(w){if(!w)return 0;let F=32;for(const K in w)if(w.hasOwnProperty(K)){const P=w[K];switch(typeof P){case "string":F+=e(P);break;case "number":F+=16;break;case "boolean":F+=4}}return F};b.estimateFixedArraySize=
function(w,F){return 32+w.length*F};b.estimateNestedObjectSize=c;b.estimateNumberByteSize=function(w){return 16};b.estimateStringByteSize=e;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/quantizationUtils":function(){define(["exports","./jsonUtils"],function(b,e){function c({scale:q,translate:H},N){return Math.round((N-H[0])/q[0])}function m({scale:q,translate:H},N){return Math.round((H[1]-N)/q[1])}function w(q,H,N){const E=[];let r,I,M,S;for(let U=0;U<N.length;U++){const G=
N[U];if(0<U){if(M=c(q,G[0]),S=m(q,G[1]),M!==r||S!==I)E.push(H(G,M-r,S-I)),r=M,I=S}else r=c(q,G[0]),I=m(q,G[1]),E.push(H(G,r,I))}return 0<E.length?E:null}function F(q,H,N,E){return w(q,N?E?l:d:E?d:h,H)}function K(q,H,N,E){const r=[];N=N?E?l:d:E?d:h;for(E=0;E<H.length;E++){const I=w(q,N,H[E]);I&&3<=I.length&&r.push(I)}return r.length?r:null}function P(q,H,N,E){const r=[];N=N?E?l:d:E?d:h;for(E=0;E<H.length;E++){const I=w(q,N,H[E]);I&&2<=I.length&&r.push(I)}return r.length?r:null}function z({scale:q,
translate:H},N){return N*q[0]+H[0]}function t({scale:q,translate:H},N){return H[1]-N*q[1]}function D(q,H,N){const E=Array(N.length);if(!N.length)return E;const [r,I]=q.scale;let M=z(q,N[0][0]);q=t(q,N[0][1]);E[0]=H(N[0],M,q);for(let S=1;S<N.length;S++){const U=N[S];M+=U[0]*r;q-=U[1]*I;E[S]=H(U,M,q)}return E}function a(q,H,N){const E=Array(N.length);for(let r=0;r<N.length;r++)E[r]=D(q,H,N[r]);return E}function g(q,H,N,E){return D(q,N?E?l:d:E?d:h,H)}function u(q,H,N,E){return a(q,N?E?l:d:E?d:h,H)}function v(q,
H,N,E){return a(q,N?E?l:d:E?d:h,H)}function k(q,H,N){let [E,r]=N[0],I=Math.min(E,H[0]),M=Math.min(r,H[1]),S=Math.max(E,H[2]);H=Math.max(r,H[3]);for(let U=1;U<N.length;U++){const [G,J]=N[U];E+=G;r+=J;0>G&&(I=Math.min(I,E));0<G&&(S=Math.max(S,E));0>J?M=Math.min(M,r):0<J&&(H=Math.max(H,r))}q[0]=I;q[1]=M;q[2]=S;q[3]=H;return q}function n(q,H){if(!H.length)return null;q[0]=q[1]=Number.POSITIVE_INFINITY;q[2]=q[3]=Number.NEGATIVE_INFINITY;for(let N=0;N<H.length;N++)k(q,q,H[N]);return q}function p(q,H,N,
E,r){H.xmin=c(q,N.xmin);H.ymin=m(q,N.ymin);H.xmax=c(q,N.xmax);H.ymax=m(q,N.ymax);H!==N&&(E&&(H.zmin=N.zmin,H.zmax=N.zmax),r&&(H.mmin=N.mmin,H.mmax=N.mmax));return H}function y(q,H,N,E,r){H.points=F(q,N.points,E,r)??[];return H}function O(q,H,N,E,r){H.x=c(q,N.x);H.y=m(q,N.y);H!==N&&(E&&(H.z=N.z),r&&(H.m=N.m));return H}function C(q,H,N,E,r){q=K(q,N.rings,E,r);if(!q)return null;H.rings=q;return H}function f(q,H,N,E,r){q=P(q,N.paths,E,r);if(!q)return null;H.paths=q;return H}const h=(q,H,N)=>[H,N],d=(q,
H,N)=>[H,N,q[2]],l=(q,H,N)=>[H,N,q[2],q[3]];b.equals=function(q,H){if(q===H||null==q&&null==H)return!0;if(null==q||null==H)return!1;let N,E,r,I;q&&"upperLeft"===q.originPosition?(N=q.translate[0],E=q.translate[1],q=q.scale[0]):(N=null!=q.extent?q.extent.xmin:0,E=null!=q.extent?q.extent.ymax:0,q=q.tolerance);H&&"upperLeft"===H.originPosition?(r=H.translate[0],I=H.translate[1],H=H.scale[0]):(r=null!=H.extent?H.extent.xmin:0,I=null!=H.extent?H.extent.ymax:0,H=H.tolerance);return N===r&&E===I&&q===H};
b.getQuantizedBoundsCoordsArray=k;b.getQuantizedBoundsCoordsArrayArray=n;b.getQuantizedBoundsPaths=function(q){return n([0,0,0,0],q)};b.getQuantizedBoundsPoints=function(q){const H=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return k(H,H,q)};b.getQuantizedBoundsRings=function(q){return n([0,0,0,0],q)};b.quantizeBounds=function(q,H,N){H[0]=c(q,N[0]);H[3]=m(q,N[1]);H[2]=c(q,N[2]);H[1]=m(q,N[3]);return H};b.quantizeExtent=p;b.quantizeGeometry=
function(q,H){return q&&H?e.isPoint(H)?O(q,{},H,!1,!1):e.isPolyline(H)?f(q,{},H,!1,!1):e.isPolygon(H)?C(q,{},H,!1,!1):e.isMultipoint(H)?y(q,{},H,!1,!1):e.isExtent(H)?p(q,{},H,!1,!1):null:null};b.quantizeMultipoint=y;b.quantizePaths=P;b.quantizePoint=O;b.quantizePoints=F;b.quantizePolygon=C;b.quantizePolyline=f;b.quantizeRings=K;b.quantizeX=c;b.quantizeY=m;b.toQuantizationTransform=function(q){return q?{originPosition:"upper-left"===q.originPosition?"upperLeft":"lower-left"===q.originPosition?"lowerLeft":
q.originPosition,scale:q.tolerance?[q.tolerance,q.tolerance]:[1,1],translate:null!=q.extent?[q.extent.xmin,q.extent.ymax]:[0,0]}:null};b.unquantizeBounds=function(q,H,N){return N?(H[0]=z(q,N[0]),H[1]=t(q,N[3]),H[2]=z(q,N[2]),H[3]=t(q,N[1]),H):[z(q,H[0]),t(q,H[3]),z(q,H[2]),t(q,H[1])]};b.unquantizeCoordsArray=D;b.unquantizeCoordsArrayArray=a;b.unquantizeExtent=function(q,H,N,E,r){H.xmin=z(q,N.xmin);H.ymin=t(q,N.ymin);H.xmax=z(q,N.xmax);H.ymax=t(q,N.ymax);H!==N&&(E&&(H.zmin=N.zmin,H.zmax=N.zmax),r&&
(H.mmin=N.mmin,H.mmax=N.mmax));return H};b.unquantizeMultipoint=function(q,H,N,E,r){null!=N&&(H.points=g(q,N.points,E,r));return H};b.unquantizePaths=u;b.unquantizePoint=function(q,H,N,E,r){if(null==N)return H;H.x=z(q,N.x);H.y=t(q,N.y);H!==N&&(E&&(H.z=N.z),r&&(H.m=N.m));return H};b.unquantizePoints=g;b.unquantizePolygon=function(q,H,N,E,r){null!=N&&(H.rings=v(q,N.rings,E,r));return H};b.unquantizePolyline=function(q,H,N,E,r){null!=N&&(H.paths=u(q,N.paths,E,r));return H};b.unquantizeRings=v;b.unquantizeX=
z;b.unquantizeY=t;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/dehydratedFeatureComparison":function(){define(["exports","../../core/has","../../geometry/support/spatialReferenceUtils"],function(b,e,c){function m(z,t){if(z===t)return!0;if(null==z||null==t||z.length!==t.length)return!1;for(let D=0;D<z.length;D++){const a=z[D],g=t[D];if(a.length!==g.length)return!1;for(let u=0;u<a.length;u++)if(a[u]!==g[u])return!1}return!0}function w(z,t){if(z===t)return!0;
if(null==z||null==t||z.length!==t.length)return!1;for(let D=0;D<z.length;D++)if(!m(z[D],t[D]))return!1;return!0}function F(z,t){return z===t||null!=z&&null!=t&&c.equals(z.spatialReference,t.spatialReference)&&z.x===t.x&&z.y===t.y&&z.z===t.z&&z.m===t.m}function K(z,t){if(z===t)return!0;if(null==z||null==t||z.type!==t.type)return!1;switch(z.type){case "point":return F(z,t);case "extent":return z=z.hasZ!==t.hasZ||z.hasM!==t.hasM?!1:c.equals(z.spatialReference,t.spatialReference)?z.xmin===t.xmin&&z.ymin===
t.ymin&&z.zmin===t.zmin&&z.xmax===t.xmax&&z.ymax===t.ymax&&z.zmax===t.zmax:!1,z;case "polyline":return z=z.hasZ!==t.hasZ||z.hasM!==t.hasM?!1:c.equals(z.spatialReference,t.spatialReference)?w(z.paths,t.paths):!1,z;case "polygon":return z=z.hasZ!==t.hasZ||z.hasM!==t.hasM?!1:c.equals(z.spatialReference,t.spatialReference)?w(z.rings,t.rings):!1,z;case "multipoint":return z=z.hasZ!==t.hasZ||z.hasM!==t.hasM?!1:c.equals(z.spatialReference,t.spatialReference)?m(z.points,t.points):!1,z;case "mesh":return!1}}
function P(z,t){if(z===t)return!0;if(!z||!t)return!1;const D=Object.keys(z),a=Object.keys(t);if(D.length!==a.length)return!1;for(const g of D)if(z[g]!==t[g])return!1;return!0}b.equals=function(z,t){return z===t?!0:null!=z&&null!=t&&z.objectId===t.objectId&&K(z.geometry,t.geometry)&&P(z.attributes,t.attributes)?!0:!1};b.pointEquals=F;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/geometry3dUtils":function(){define("exports ../../core/mathUtils ../../chunks/vec2 ../../chunks/vec2f64 ../../chunks/vec3 ../../chunks/vec3f64 ./geometry2dUtils".split(" "),
function(b,e,c,m,w,F,K){function P(h,{start:d,end:l,type:q}){h=w.sub(u,h,d);l=w.sub(v,l,d);h=w.dot(h,l)/w.dot(l,l);return w.scaleAndAdd(F.create(),d,l,q===K.LineType.RAY?Math.max(h,0):h)}function z({start:h,end:d,type:l},q){const H=w.sub(u,q,h);d=w.sub(v,d,h);if(l===K.LineType.RAY&&-1E-6>w.dot(d,H))return w.distance(h,q);h=w.cross(k,d,H);return w.len(h)/w.len(d)}function t(h,d){const l=h.start,q=d.start;var H=d.end;const N=w.sub(u,h.end,l);H=w.sub(v,H,q);var E=w.sub(k,q,l),r=w.cross(n,N,H),I=w.dot(E,
r);if(!e.floatEqualAbsolute(I,0,1E-6))return[];I=w.sqrLen(r);if(e.floatEqualAbsolute(I,0,1E-6))return[];E=w.cross(p,E,H);r=w.dot(E,r)/I;r=w.scaleAndAdd(y,l,N,r);return h.type===K.LineType.RAY&&(h=w.sub(O,r,l),-1E-6>w.dot(N,h))||d.type===K.LineType.RAY&&(d=w.sub(O,r,q),-1E-6>w.dot(H,d))?[]:[F.clone(r)]}function D({start:h,end:d,type:l},q){const H=w.sub(u,q,h);h=w.sub(v,d,h);d=w.cross(k,h,H);if(1E-6>w.sqrLen(d)/w.sqrLen(h))switch(l){case K.LineType.LINE:return[F.clone(q)];case K.LineType.RAY:return-1E-6>
w.dot(h,H)?[]:[F.clone(q)]}return[]}function a(h,d,{start:l,end:q,type:H}){w.set(h.start,l[0],l[1],d);w.set(h.end,q[0],q[1],d);h.type=g[H];return h}b.VerticalPlaneType=void 0;(function(h){h[h.PLANE=0]="PLANE";h[h.HALF_PLANE=1]="HALF_PLANE"})(b.VerticalPlaneType||(b.VerticalPlaneType={}));const g={[b.VerticalPlaneType.PLANE]:K.LineType.LINE,[b.VerticalPlaneType.HALF_PLANE]:K.LineType.RAY},u=F.create(),v=F.create(),k=F.create(),n=F.create(),p=F.create(),y=F.create(),O=F.create(),C={start:F.create(),
end:F.create(),type:K.LineType.LINE},f={start:F.create(),end:F.create(),type:K.LineType.LINE};Object.defineProperty(b,"LineType",{enumerable:!0,get:()=>K.LineType});b.epsilon=1E-6;b.intersectLineAndPoint=D;b.intersectLineLike=t;b.intersectLineLikeAndVerticalCylinder=function({start:h,end:d,type:l},q,H){const N=[];d=w.subtract(u,d,h);var E=c.subtract(v,h,q);q=c.squaredLength(d);const r=2*c.dot(d,E);H=c.squaredLength(E)-H*H;H=r*r-4*q*H;0===H?(q=-r/(2*q),(l===K.LineType.LINE||0<=q)&&N.push(w.scaleAndAdd(F.create(),
h,d,q))):0<H&&(H=Math.sqrt(H),E=(-r+H)/(2*q),(l===K.LineType.LINE||0<=E)&&N.push(w.scaleAndAdd(F.create(),h,d,E)),q=(-r-H)/(2*q),(l===K.LineType.LINE||0<=q)&&N.push(w.scaleAndAdd(F.create(),h,d,q)));return N};b.intersectVerticalCylinderAndPoint=function(h,d,l){return e.floatEqualAbsolute(c.squaredDistance(l,h),d*d,1E-6)?[F.clone(l)]:[]};b.intersectVerticalPlane=function(h,d){h=a(C,0,h);d=a(f,0,d);d=t(h,d);h=[];for(const l of d)h.push(m.clone(l));return h};b.intersectVerticalPlaneAndLineLike=function(h,
d){const l=h.start,q=c.subtract(u,h.end,l);var H=w.set(v,-q[1],q[0],0);const N=d.start,E=w.sub(k,d.end,N);var r=w.dot(E,H),I=w.set(n,l[0],l[1],0);I=w.sub(p,I,N);H=w.dot(I,H);if(1E-6>Math.abs(r))return[];r=w.scaleAndAdd(y,N,E,H/r);return d.type===K.LineType.RAY&&(d=w.sub(O,r,N),-1E-6>w.dot(d,E))||h.type===b.VerticalPlaneType.HALF_PLANE&&(h=c.sub(O,r,l),-1E-6>c.dot(h,q))?[]:[F.clone(r)]};b.intersectVerticalPlaneAndPoint=function(h,d){return D(a(C,d[2],h),d)};b.intersectVerticalPlaneAndVerticalCylinder=
function({start:h,end:d,type:l},q,H){const N=[];d=c.subtract(u,d,h);var E=c.subtract(v,h,q);q=c.squaredLength(d);const r=2*c.dot(d,E);H=c.squaredLength(E)-H*H;H=r*r-4*q*H;0===H?(q=-r/(2*q),(l===b.VerticalPlaneType.PLANE||0<=q)&&N.push(c.scaleAndAdd(m.create(),h,d,q))):0<H&&(H=Math.sqrt(H),E=(-r+H)/(2*q),(l===b.VerticalPlaneType.PLANE||0<=E)&&N.push(c.scaleAndAdd(m.create(),h,d,E)),q=(-r-H)/(2*q),(l===b.VerticalPlaneType.PLANE||0<=q)&&N.push(c.scaleAndAdd(m.create(),h,d,q)));return N};b.pointToLineLikeDistance=
z;b.pointToVerticalCylinderDistance=function(h,d,l){return c.distance(h,d)-l};b.pointToVerticalPlaneDistance=function(h,d){return z(a(C,h[2],d),h)};b.projectPointToLineLike=P;b.projectPointToVerticalCylinder=function(h,d,l){const q=c.subtract(u,h,d);l/=c.length(q);d=c.scaleAndAdd(F.create(),d,q,l);d[2]=h[2];return d};b.projectPointToVerticalPlane=function(h,d){return P(h,a(C,h[2],d))};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/geometry2dUtils":function(){define(["exports",
"../../core/mathUtils","../../chunks/vec2","../../chunks/vec2f64"],function(b,e,c,m){function w(g,u){return g[0]*u[1]-g[1]*u[0]}function F(g,u,v){u=c.dot(v,u)/c.squaredLength(v);return c.scale(g,v,u)}function K(g,u,v,k,n=v){c.subtract(z,k,v);c.subtract(D,u,n);F(a,D,z);return c.add(g,n,a)}function P(g,u,v,k){c.subtract(z,u,v);u=k/c.length(z);return c.scaleAndAdd(g,v,z,u)}b.LineType=void 0;(function(g){g[g.RAY=0]="RAY";g[g.LINE=1]="LINE"})(b.LineType||(b.LineType={}));const z=m.create(),t=m.create(),
D=m.create(),a=m.create();b.cross=w;b.intersectCircleAndPoint=function(g,u,v){P(D,v,g,u);return e.floatEqualAbsolute(D[0],v[0])&&e.floatEqualAbsolute(D[1],v[1])?[m.clone(v)]:[]};b.intersectLineAndPoint=function(g,u){K(D,u,g.start,g.end);return e.floatEqualAbsolute(D[0],u[0])&&e.floatEqualAbsolute(D[1],u[1])?[m.clone(u)]:[]};b.intersectLineAndRay=function(g,u){const v=g.start;var k=u.start,n=u.end;const p=c.subtract(z,g.end,v);var y=c.subtract(t,n,k);n=w(p,y);if(1E-6>=Math.abs(n))return[];k=c.subtract(D,
v,k);y=w(y,k)/n;n=w(p,k)/n;if(0<=y){if(0<=n||u.type===b.LineType.LINE)return[c.scaleAndAdd(a,v,p,y)]}else if(g.type===b.LineType.LINE&&(0<=n||u.type===b.LineType.LINE))return[c.scaleAndAdd(a,v,p,y)];return[]};b.intersectLineLikeAndCircle=function(g,u,v){const k=[],n=c.subtract(z,g.end,g.start);var p=c.subtract(t,g.start,u);u=c.squaredLength(n);const y=2*c.dot(n,p);v=c.squaredLength(p)-v*v;v=y*y-4*u*v;0===v?(u=-y/(2*u),(g.type===b.LineType.LINE||0<=u)&&k.push(c.scaleAndAdd(a,g.start,n,u))):0<v&&(v=
Math.sqrt(v),p=(-y+v)/(2*u),(g.type===b.LineType.LINE||0<=p)&&k.push(c.scaleAndAdd(a,g.start,n,p)),u=(-y-v)/(2*u),(g.type===b.LineType.LINE||0<=u)&&k.push(c.scaleAndAdd(D,g.start,n,u)));return k};b.pointToLineDistance=function(g,u,v){return Math.abs((u[0]-g[0])*(v[1]-g[1])-(u[1]-g[1])*(v[0]-g[0]))/c.distance(u,v)};b.projectPoint=F;b.projectPointToCircle=P;b.projectPointToLine=K;b.projectPointToRay=function(g,u,v,k){c.subtract(z,k,v);c.subtract(D,u,v);u=c.dot(z,D)/c.squaredLength(z);return 0<u?c.scaleAndAdd(g,
v,z,u):c.copy(g,v)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/snappingUtils":function(){define("exports ../../../core/reactiveUtils ../../../chunks/vec3 ../../../layers/graphics/dehydratedFeatures ../../input/InputManager ../keybindings ./SnappingPoint".split(" "),function(b,e,c,m,w,F,K){function P(z,t){const D=z.x-t.x;z=z.y-t.y;return D*D+z*z}b.LineSegmentHintType=void 0;(function(z){z[z.TARGET=0]="TARGET";z[z.REFERENCE=1]="REFERENCE";z[z.REFERENCE_EXTENSION=
2]="REFERENCE_EXTENSION"})(b.LineSegmentHintType||(b.LineSegmentHintType={}));b.editEdgeToSnappingEdge=function(z,t,D){return{left:K.anyMapPointToSnappingPoint(z.leftVertex.pos,t,D),right:K.anyMapPointToSnappingPoint(z.rightVertex.pos,t,D)}};b.makeFilter=function(z){return z.createQuery()};b.makeSnappingQuery=function({point:z,distance:t,returnEdge:D,returnVertex:a,coordinateHelper:{spatialReference:g}},u,v){return{point:m.makeDehydratedPoint(z[0],z[1],z[2],g.toJSON()),mode:u,distance:t,returnEdge:D,
returnVertex:a,query:null!=v?v.toJSON():{where:"1\x3d1"}}};b.objectEqual=function(z,t){const D=z.length===t.length&&z[0]===t[0]&&z[1]===t[1];switch(z.length){case 2:return D;case 3:return D&&z[2]===t[2];case 4:return D&&z[2]===t[2]&&z[3]===t[3]}return!1};b.screenDistance=function(z,t){return Math.sqrt(P(z,t))};b.setupSnappingToggleHandles=function(z,t=()=>{}){const D=e.watch(()=>({view:z.view,snappingOptions:z.snappingOptions}),({view:a,snappingOptions:g})=>{const u=w.ViewEventPriorities.TOOL;z.removeHandles("snapping-toggle");
a&&null!=g&&(a=[a.on("key-down",v=>{v.key!==F.SNAPPING_KEYS.toggle||v.repeat||(g.enabledToggled=!0,t())},u),a.on("key-up",v=>{v.key===F.SNAPPING_KEYS.toggle&&(g.enabledToggled=!1,t())},u),a.on("pointer-move",v=>{v=v.native.ctrlKey;g.enabledToggled!==v&&(g.enabledToggled=v,t())},u)],z.addHandles(a,"snapping-toggle"))},e.syncAndInitial);z.addHandles(D)};b.sortCandidatesInPlace=function(z,t){t.sort((D,a)=>{D=c.squaredDistance(D.targetPoint,z);a=c.squaredDistance(a.targetPoint,z);return D-a})};b.squaredScreenDistance=
P;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/DrapedEdgeSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../SnappingConstraint ../snappingUtils ./FeatureSnappingCandidate ../hints/LineSnappingHint".split(" "),function(b,e,c,m,w,F){w=function(K){function P(z){return K.call(this,{...z,isDraped:!0,constraint:new c.DrapedLineConstraint(z.edgeStart,z.edgeEnd,z.getGroundElevation)})||this}e._inherits(P,
K);e._createClass(P,[{key:"hints",get:function(){return[new F.LineSnappingHint(m.LineSegmentHintType.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}}]);return P}(w.FeatureSnappingCandidate);b.DrapedEdgeSnappingCandidate=w;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/FeatureSnappingCandidate":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../SnappingDomain","./SnappingCandidate"],
function(b,e,c,m){m=function(w){function F({targetPoint:K,objectId:P,constraint:z,isDraped:t}){K=w.call(this,K,z,t,c.SnappingDomain.FEATURE)||this;K.objectId=P;return K}e._inherits(F,w);return e._createClass(F)}(m.SnappingCandidate);b.FeatureSnappingCandidate=m;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/SnappingCandidate":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers"],function(b,e){e=e._createClass(function(c,
m,w,F){this.targetPoint=c;this.constraint=m;this.isDraped=w;this.domain=F});b.SnappingCandidate=e;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/LineSnappingHint":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/Logger ../../../../chunks/vec3 ../SnappingDomain ./SnappingHint".split(" "),function(b,e,c,m,w,F,K){c=function(P){function z(t,D,a,g,u=F.SnappingDomain.ALL,v=!0,k=!0){g=P.call(this,
g,u)||this;g.type=t;g.lineStart=D;g.lineEnd=a;g.fadeLeft=v;g.fadeRight=k;return g}e._inherits(z,P);z.prototype.equals=function(t){return t instanceof z?this.type===t.type&&w.exactEquals(this.lineStart,t.lineStart)&&w.exactEquals(this.lineEnd,t.lineEnd)&&this.fadeLeft===t.fadeLeft&&this.fadeRight===t.fadeRight:!1};e._createClass(z,[{key:"length",get:function(){return w.distance(this.lineStart,this.lineEnd)}}]);return z}(K.SnappingHint);b.LineSnappingHint=c;Object.defineProperty(b,Symbol.toStringTag,
{value:"Module"})})},"esri/views/interactive/snapping/hints/SnappingHint":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers"],function(b,e){e=e._createClass(function(c,m){this.isDraped=c;this.domain=m});b.SnappingHint=e;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/EdgeSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../SnappingConstraint ../snappingUtils ./FeatureSnappingCandidate ../hints/LineSnappingHint".split(" "),
function(b,e,c,m,w,F){w=function(K){function P(z){return K.call(this,{...z,constraint:new c.LineConstraint(z.edgeStart,z.edgeEnd)})||this}e._inherits(P,K);e._createClass(P,[{key:"hints",get:function(){return[new F.LineSnappingHint(m.LineSegmentHintType.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}}]);return P}(w.FeatureSnappingCandidate);b.EdgeSnappingCandidate=w;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/RightAngleSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../SnappingDomain ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint ../hints/RightAngleSnappingHint".split(" "),
function(b,e,c,m,w,F,K){w=function(P){function z({targetPoint:t,constraint:D,previousVertex:a,otherVertex:g,otherVertexType:u,objectId:v,isDraped:k}){t=P.call(this,t,D,k,c.SnappingDomain.SELF)||this;t.previousVertex=a;t.otherVertex=g;t.otherVertexType=u;t.objectId=v;return t}e._inherits(z,P);e._createClass(z,[{key:"hints",get:function(){const t=this.previousVertex,D=this.otherVertexType===b.OtherVertexType.CENTER?this.otherVertex:this.targetPoint,a=this.otherVertexType===b.OtherVertexType.CENTER?
this.targetPoint:this.otherVertex;return[new F.LineSnappingHint(m.LineSegmentHintType.TARGET,D,a,this.isDraped,this.domain),new F.LineSnappingHint(m.LineSegmentHintType.REFERENCE,t,D,this.isDraped,this.domain),new K.RightAngleSnappingHint(this.previousVertex,D,a,this.isDraped,this.domain)]}}]);return z}(w.SnappingCandidate);b.OtherVertexType=void 0;(function(P){P[P.NEXT=0]="NEXT";P[P.CENTER=1]="CENTER"})(b.OtherVertexType||(b.OtherVertexType={}));b.RightAngleSnappingCandidate=w;Object.defineProperty(b,
Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/RightAngleSnappingHint":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/Logger ../../../../chunks/vec3 ../SnappingDomain ./SnappingHint".split(" "),function(b,e,c,m,w,F,K){c=function(P){function z(t,D,a,g,u=F.SnappingDomain.ALL){g=P.call(this,g,u)||this;g.previousVertex=t;g.centerVertex=D;g.nextVertex=a;return g}e._inherits(z,P);z.prototype.equals=function(t){return t instanceof
z?w.exactEquals(this.previousVertex,t.previousVertex)&&w.exactEquals(this.centerVertex,t.centerVertex)&&w.exactEquals(this.nextVertex,t.nextVertex):!1};return e._createClass(z)}(K.SnappingHint);b.RightAngleSnappingHint=c;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/support/viewUtils":function(){define("exports ../../../core/screenUtils ../../../chunks/vec2 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../layers/graphics/dehydratedFeatures ../../../support/elevationInfoUtils".split(" "),
function(b,e,c,m,w,F,K){function P(k,n,p,y,O=w.create()){k=n.toXYZ(k);k[2]=K.getConvertedElevationFromVector(y,k,n.spatialReference,p)||0;y.renderCoordsHelper.toRenderCoords(k,n.spatialReference,O);return O}function z(k,n,p,y,O=w.create()){k=m.copy(a,k);k[2]=K.getConvertedElevationFromVector(y,k,n,p)||0;y.renderCoordsHelper.toRenderCoords(k,n,O);return O}function t(k,n,p,y){if("2d"===y.type)return D.x=k[0],D.y=k[1],D.spatialReference=n,y.toScreen(D);z(k,n,p,y,a);y.state.camera.projectToScreen(a,v);
return e.createScreenPoint(v[0],v[1])}const D=F.makeDehydratedPoint(0,0,0,null),a=w.create(),g=e.createRenderScreenPointArray3(),u=e.createRenderScreenPointArray3(),v=e.createScreenPointArray();b.anyMapPointToRender=P;b.anyMapPointToScreenPoint=function(k,n,p,y){return t(n.toXYZ(k),n.spatialReference,p,y)};b.anyMapPointsToRenderWithEqualRelativeZ=function(k,n,p,y,O,C,f){if("absolute-height"===y.mode)P(k,p,y,O,C),P(n,p,y,O,f);else{k=p.toXYZ(k);n=p.toXYZ(n);var h=K.getConvertedElevationFromVector(O,
k,p.spatialReference,y);y=K.getConvertedElevationFromVector(O,n,p.spatialReference,y);y=(null==h?y:null==y?h:Math.min(h,y))||0;k[2]=y;n[2]=y;O.renderCoordsHelper.toRenderCoords(k,p.spatialReference,C);O.renderCoordsHelper.toRenderCoords(n,p.spatialReference,f)}};b.renderScreenSpaceTangent=function(k,n,p,y){p.projectToRenderScreen(k,g);p.projectToRenderScreen(n,u);c.subtract(y,u,g);c.normalize(y,y)};b.vectorToRender=z;b.vectorToScreenPoint=t;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},
"esri/views/interactive/snapping/SelfSnappingEngine":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./LineSnapper ./ParallelLineSnapper ./RightAngleSnapper ./RightAngleTriangleSnapper ./SnappingDomain ./snappingUtils".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a,g,u,v,k){b.SelfSnappingEngine=function(n){function p(O){O=n.call(this,O)||this;O.updating=!1;O._snappers=new w;O._domain=v.SnappingDomain.SELF;return O}e._inherits(p,n);var y=p.prototype;y.initialize=function(){this._snappers.push(new a.ParallelLineSnapper(this.view,this.options),new D.LineSnapper(this.view,this.options),new g.RightAngleSnapper(this.view,this.options),new u.RightAngleTriangleSnapper(this.view,this.options))};y.fetchCandidates=async function(O,C,f){if(!(C&
this._domain&&this.options.effectiveSelfEnabled))return[];C=[];for(const h of this._snappers.items)for(const d of h.snap(O,f))C.push(d);k.sortCandidatesInPlace(O,C);return C};e._createClass(p,[{key:"options",set:function(O){this._set("options",O);for(const C of this._snappers)C.options=O}}]);return p}(m);c.__decorate([F.property({readOnly:!0})],b.SelfSnappingEngine.prototype,"updating",void 0);c.__decorate([F.property({constructOnly:!0})],b.SelfSnappingEngine.prototype,"view",void 0);c.__decorate([F.property()],
b.SelfSnappingEngine.prototype,"options",null);b.SelfSnappingEngine=c.__decorate([t.subclass("esri.views.interactive.snapping.SelfSnappingEngine")],b.SelfSnappingEngine);Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/LineSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../support/elevationInfoUtils ./SnappingAlgorithm ./SnappingPoint ./snappingUtils ./candidates/LineSnappingCandidate ../support/viewUtils ../../support/geometry3dUtils ../../support/geometry2dUtils".split(" "),
function(b,e,c,m,w,F,K,P,z,t){m=function(D){function a(){return D.apply(this,arguments)||this}e._inherits(a,D);var g=a.prototype;g.snapNewVertex=function(u,v){var k=v.editGeometryOperations.data.components[0],n=k.edges.length;const p=[];if(1>n)return p;var {spatialReference:y}=v;y=P.vectorToScreenPoint(u,y,c.absoluteHeightElevationInfo,this.view);const {view:O}=this;n=k=k.edges[n-1];do{if(this.edgeExceedsShortLineThreshold(n,v)){const C=F.editEdgeToSnappingEdge(n,O,v);this._processCandidateProposal(C.left,
C.right,u,y,v,p)}n=n.leftVertex.leftEdge}while(n&&n!==k);return p};g.snapExistingVertex=function(u,v){const k=[],n=v.vertexHandle;var p=n.component;if(2>p.edges.length)return k;const {view:y}=this;var {spatialReference:O}=v;O=P.vectorToScreenPoint(u,O,c.absoluteHeightElevationInfo,y);var C=n.leftEdge,f=n.rightEdge;C&&f&&this.edgeExceedsShortLineThreshold(C,v)&&this.edgeExceedsShortLineThreshold(f,v)&&this._processCandidateProposal(w.anyMapPointToSnappingPoint(C.leftVertex.pos,y,v),w.anyMapPointToSnappingPoint(f.rightVertex.pos,
y,v),u,O,v,k);C=p=p.edges[0];do C!==n.leftEdge&&C!==n.rightEdge&&this.edgeExceedsShortLineThreshold(C,v)&&(f=F.editEdgeToSnappingEdge(C,y,v),this._processCandidateProposal(f.left,f.right,u,O,v,k)),C=C.rightVertex.rightEdge;while(C&&C!==p);return k};g._processCandidateProposal=function(u,v,k,n,p,y){const {spatialReference:O,pointer:C}=p;k=w.asSnappingPoint(z.projectPointToLineLike(k,{start:u,end:v,type:t.LineType.LINE}));F.squaredScreenDistance(n,P.vectorToScreenPoint(k,O,c.absoluteHeightElevationInfo,
this.view))<this.squaredProximityThreshold(C)&&y.push(new K.LineSnappingCandidate({lineStart:u,lineEnd:v,targetPoint:k,isDraped:"on-the-ground"===p.elevationInfo?.mode}))};return e._createClass(a)}(m.SnappingAlgorithm);b.LineSnapper=m;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingAlgorithm":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/vec2 ../../../support/elevationInfoUtils ./Settings ./SnappingPoint ./snappingUtils ../support/viewUtils".split(" "),
function(b,e,c,m,w,F,K,P){let z=function(){function t(a,g){this.view=a;this.options=g;this.squaredShortLineThreshold=w.defaults.shortLineThreshold*w.defaults.shortLineThreshold}var D=t.prototype;D.snap=function(a,g){return null!=g.vertexHandle?"vertex"!==g.vertexHandle.type?[]:this.snapExistingVertex(a,g):this.snapNewVertex(a,g)};D.edgeExceedsShortLineThreshold=function(a,g){return this.exceedsShortLineThreshold(F.anyMapPointToSnappingPoint(a.leftVertex.pos,this.view,g),F.anyMapPointToSnappingPoint(a.rightVertex.pos,
this.view,g),g)};D.exceedsShortLineThreshold=function(a,g,{spatialReference:u}){return 0===this.squaredShortLineThreshold||K.squaredScreenDistance(P.vectorToScreenPoint(g,u,m.absoluteHeightElevationInfo,this.view),P.vectorToScreenPoint(a,u,m.absoluteHeightElevationInfo,this.view))>this.squaredShortLineThreshold};D.isVertical=function(a,g){return c.squaredDistance(a,g)<w.defaults.verticalLineThreshold};D.squaredProximityThreshold=function(a){return"touch"===a?this._squaredTouchProximityThreshold:this._squaredMouseProximityThreshold};
e._createClass(t,[{key:"_squaredMouseProximityThreshold",get:function(){return this.options.distance*this.options.distance}},{key:"_squaredTouchProximityThreshold",get:function(){const {distance:a,touchSensitivityMultiplier:g}=this.options,u=a*g;return u*u}}]);return t}();b.SnappingAlgorithm=z;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/LineSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../SnappingConstraint ../SnappingDomain ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint".split(" "),
function(b,e,c,m,w,F,K){F=function(P){function z({lineStart:t,lineEnd:D,targetPoint:a,isDraped:g}){a=P.call(this,a,new c.VerticalPlaneConstraint(t,D),g,m.SnappingDomain.SELF)||this;a._referenceLineHint=new K.LineSnappingHint(w.LineSegmentHintType.REFERENCE_EXTENSION,t,D,g,a.domain);return a}e._inherits(z,P);z.prototype._lineEndClosestToTarget=function(){return this.constraint.closestEndTo(this.targetPoint)};e._createClass(z,[{key:"hints",get:function(){return[this._referenceLineHint,new K.LineSnappingHint(w.LineSegmentHintType.TARGET,
this._lineEndClosestToTarget(),this.targetPoint,this.isDraped,this.domain)]}}]);return z}(F.SnappingCandidate);b.LineSnappingCandidate=F;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/ParallelLineSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../chunks/vec3f64 ../../../support/elevationInfoUtils ./Settings ./SnappingAlgorithm ./SnappingPoint ./snappingUtils ./candidates/ParallelLineSnappingCandidate ../support/viewUtils ../../support/geometry2dUtils".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a,g){P=function(v){function k(){return v.apply(this,arguments)||this}e._inherits(k,v);var n=k.prototype;n.snapNewVertex=function(p,y){var O=y.editGeometryOperations.data.components[0],C=O.edges.length,f=O.vertices.length;const h=[];if(2>C)return h;const {view:d}=this,l=a.vectorToScreenPoint(p,y.spatialReference,F.absoluteHeightElevationInfo,d);f=z.anyMapPointToSnappingPoint(O.vertices[f-1].pos,d,y);const q=z.anyMapPointToSnappingPoint(O.vertices[0].pos,d,y);C=O=O.edges[C-
1];do{if(this.edgeExceedsShortLineThreshold(C,y)){const H=t.editEdgeToSnappingEdge(C,d,y);this._checkEdgeForParallelLines(H,f,p,l,y,h);this._checkEdgeForParallelLines(H,q,p,l,y,h)}C=C.leftVertex.leftEdge}while(C&&C!==O);return h};n.snapExistingVertex=function(p,y){const O=[],C=y.vertexHandle;var f=C.component;if(3>f.edges.length)return O;const {view:h}=this,d=a.vectorToScreenPoint(p,y.spatialReference,F.absoluteHeightElevationInfo,h),l=C.leftEdge,q=C.rightEdge,H=f.vertices[0],N=z.anyMapPointToSnappingPoint(H.pos,
h,y),E=f.vertices[f.vertices.length-1],r=z.anyMapPointToSnappingPoint(E.pos,h,y);let I=f=f.edges[0];do{if(I!==l&&I!==q&&this.edgeExceedsShortLineThreshold(I,y)){const M=t.editEdgeToSnappingEdge(I,h,y);l&&this._checkEdgeForParallelLines(M,z.anyMapPointToSnappingPoint(l.leftVertex.pos,h,y),p,d,y,O);q&&this._checkEdgeForParallelLines(M,z.anyMapPointToSnappingPoint(q.rightVertex.pos,h,y),p,d,y,O);C===H?this._checkEdgeForParallelLines(M,r,p,d,y,O):C===E&&this._checkEdgeForParallelLines(M,N,p,d,y,O)}I=
I.rightVertex.rightEdge}while(I&&I!==f);return O};n._checkEdgeForParallelLines=function(p,y,O,C,f,h){const d=p.left,l=p.right;g.projectPointToLine(u,y,d,l);if(!(c.squaredDistance(u,y)<K.defaults.parallelLineThreshold)){g.projectPointToLine(u,O,d,l,y);var {spatialReference:q,pointer:H}=f;O=z.asSnappingPoint(w.fromValues(u[0],u[1],O[2]));t.squaredScreenDistance(C,a.vectorToScreenPoint(O,q,F.absoluteHeightElevationInfo,this.view))<this.squaredProximityThreshold(H)&&!(this.isVertical(O,y)||this.isVertical(d,
l)||this._parallelToPreviousCandidate(p,h))&&h.push(new D.ParallelLineSnappingCandidate({referenceLine:p,lineStart:y,targetPoint:O,isDraped:"on-the-ground"===f.elevationInfo?.mode}))}};n._parallelToPreviousCandidate=function(p,y){const O=p.left,C=p.right;for(const f of y)if(g.projectPointToLine(u,C,f.constraint.start,f.constraint.end,O),c.squaredDistance(u,C)<K.defaults.parallelLineThreshold)return f.addReferenceLine(p),!0;return!1};return e._createClass(k)}(P.SnappingAlgorithm);const u=m.create();
b.ParallelLineSnapper=P;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/ParallelLineSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../SnappingConstraint ../SnappingDomain ../SnappingPoint ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint ../hints/ParallelSnappingHint".split(" "),function(b,e,c,m,w,F,K,P,z,t,D){z=function(a){function g({referenceLine:u,
lineStart:v,targetPoint:k,isDraped:n}){const p=m.clone(v),{left:y,right:O}=u;c.subtract(p,c.add(p,p,O),y);v=a.call(this,k,new w.VerticalPlaneConstraint(v,K.asSnappingPoint(p)),n,F.SnappingDomain.SELF)||this;v._referenceLines=[{edge:u,fadeLeft:!0,fadeRight:!0}];return v}e._inherits(g,a);g.prototype.addReferenceLine=function(u){const v={edge:u,fadeLeft:!0,fadeRight:!0};this._referenceLines.forEach(k=>{c.exactEquals(u.right,k.edge.left)&&(k.fadeLeft=!1,v.fadeRight=!1);c.exactEquals(u.right,k.edge.right)&&
(k.fadeRight=!1,v.fadeRight=!1);c.exactEquals(u.left,k.edge.right)&&(k.fadeRight=!1,v.fadeLeft=!1);c.exactEquals(u.left,k.edge.left)&&(k.fadeLeft=!1,v.fadeLeft=!1)});this._referenceLines.push(v)};e._createClass(g,[{key:"hints",get:function(){return[new t.LineSnappingHint(P.LineSegmentHintType.TARGET,this.constraint.start,this.targetPoint,this.isDraped,this.domain),new D.ParallelSnappingHint(this.constraint.start,this.targetPoint,this.isDraped,this.domain),...this._referenceLines.map(u=>new t.LineSnappingHint(P.LineSegmentHintType.REFERENCE,
u.edge.left,u.edge.right,this.isDraped,this.domain,u.fadeLeft,u.fadeRight))]}}]);return g}(z.SnappingCandidate);b.ParallelLineSnappingCandidate=z;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/ParallelSnappingHint":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/Logger ../../../../chunks/vec3 ../SnappingDomain ./SnappingHint".split(" "),function(b,e,c,m,w,F,K){c=function(P){function z(t,
D,a,g=F.SnappingDomain.ALL){a=P.call(this,a,g)||this;a.lineStart=t;a.lineEnd=D;return a}e._inherits(z,P);z.prototype.equals=function(t){return t instanceof z?w.exactEquals(this.lineStart,t.lineStart)&&w.exactEquals(this.lineEnd,t.lineEnd):!1};return e._createClass(z)}(K.SnappingHint);b.ParallelSnappingHint=c;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/RightAngleSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../support/elevationInfoUtils ./SnappingAlgorithm ./SnappingConstraint ./SnappingPoint ./snappingUtils ./candidates/RightAngleSnappingCandidate ../support/viewUtils".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a,g){P=function(k){function n(){return k.apply(this,arguments)||this}e._inherits(n,k);var p=n.prototype;p.snapNewVertex=function(y,O){var C=O.editGeometryOperations.data.components[0],f=C.vertices.length;const h=[];if(2>f)return h;var {view:d}=this;const l=g.vectorToScreenPoint(y,O.spatialReference,K.absoluteHeightElevationInfo,d);var q=C.vertices[f-1];this.edgeExceedsShortLineThreshold(q.leftEdge,O)&&(f=t.anyMapPointToSnappingPoint(q.pos,d,O),q=t.anyMapPointToSnappingPoint(q.leftEdge.leftVertex.pos,
d,O),this._checkForSnappingCandidate(h,q,f,y,l,O));f=C.vertices[0];this.edgeExceedsShortLineThreshold(f.rightEdge,O)&&(C=t.anyMapPointToSnappingPoint(f.pos,d,O),d=t.anyMapPointToSnappingPoint(f.rightEdge.rightVertex.pos,d,O),this._checkForSnappingCandidate(h,d,C,y,l,O));return h};p.snapExistingVertex=function(y,O){const C=[];var f=O.vertexHandle;if(3>f.component.vertices.length)return C;var {view:h}=this;const d=g.vectorToScreenPoint(y,O.spatialReference,K.absoluteHeightElevationInfo,h);var l=f.leftEdge;
f=f.rightEdge;if(l&&l.leftVertex.leftEdge){var q=l.leftVertex.leftEdge;this.edgeExceedsShortLineThreshold(q,O)&&(l=t.anyMapPointToSnappingPoint(q.rightVertex.pos,h,O),q=t.anyMapPointToSnappingPoint(q.leftVertex.pos,h,O),this._checkForSnappingCandidate(C,q,l,y,d,O))}f&&f.rightVertex.rightEdge&&(l=f.rightVertex.rightEdge,this.edgeExceedsShortLineThreshold(l,O)&&(f=t.anyMapPointToSnappingPoint(l.leftVertex.pos,h,O),h=t.anyMapPointToSnappingPoint(l.rightVertex.pos,h,O),this._checkForSnappingCandidate(C,
h,f,y,d,O)));return C};p._checkForSnappingCandidate=function(y,O,C,f,h,d){const {spatialReference:l,pointer:q}=d;c.subtract(u,C,O);const H=w.set(v,u[1],-u[0],0),N=c.dot(H,c.subtract(u,f,C))/c.squaredLength(H);f=t.asSnappingPoint(c.scaleAndAdd(F.clone(f),C,H,N));D.squaredScreenDistance(h,g.vectorToScreenPoint(f,l,K.absoluteHeightElevationInfo,this.view))<this.squaredProximityThreshold(q)&&!this.isVertical(f,C)&&!this.isVertical(C,O)&&(h=w.scaleAndAdd(F.create(),C,H,Math.sign(N)),y.push(new a.RightAngleSnappingCandidate({targetPoint:f,
constraint:new z.VerticalHalfPlaneConstraint(C,t.asSnappingPoint(h)),previousVertex:O,otherVertex:C,otherVertexType:a.OtherVertexType.CENTER,isDraped:"on-the-ground"===d.elevationInfo?.mode})))};return e._createClass(n)}(P.SnappingAlgorithm);const u=m.create(),v=F.create();b.RightAngleSnapper=P;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/RightAngleTriangleSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../chunks/vec3f64 ../../../support/elevationInfoUtils ./SnappingAlgorithm ./SnappingPoint ./snappingUtils ./candidates/RightAngleTriangleSnappingCandidate ../support/viewUtils ../../support/geometry2dUtils".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a){K=function(u){function v(){return u.apply(this,arguments)||this}e._inherits(v,u);var k=v.prototype;k.snapNewVertex=function(n,p){var y=p.editGeometryOperations.data.components[0];const O=[];var C=y.vertices.length;if("polygon"!==p.editGeometryOperations.data.type||2>C)return O;var {view:f}=this;C=y.vertices[C-1];y=P.anyMapPointToSnappingPoint(y.vertices[0].pos,f,p);f=P.anyMapPointToSnappingPoint(C.pos,f,p);this._processCandidateProposal(y,f,n,p,O);return O};k.snapExistingVertex=
function(n,p){const y=[];var O=p.vertexHandle,C=O.component;if(2>C.edges.length||"polyline"===p.editGeometryOperations.data.type&&(0===O.index||O.index===C.vertices.length-1))return y;const {view:f}=this;C=P.anyMapPointToSnappingPoint(O.leftEdge.leftVertex.pos,f,p);O=P.anyMapPointToSnappingPoint(O.rightEdge.rightVertex.pos,f,p);this._processCandidateProposal(C,O,n,p,y);return y};k._processCandidateProposal=function(n,p,y,O,C){if(this.exceedsShortLineThreshold(n,p,O)){var f=c.lerp(g,n,p,.5),h=.5*c.distance(n,
p),d=w.create();a.projectPointToCircle(d,y,f,h);d[2]=y[2];f=P.asSnappingPoint(d);var {spatialReference:l,pointer:q}=O;y=D.vectorToScreenPoint(y,l,F.absoluteHeightElevationInfo,this.view);z.squaredScreenDistance(y,D.vectorToScreenPoint(f,l,F.absoluteHeightElevationInfo,this.view))<this.squaredProximityThreshold(q)&&!this.isVertical(n,f)&&!this.isVertical(f,p)&&C.push(new t.RightAngleTriangleSnappingCandidate({targetPoint:f,point1:n,point2:p,isDraped:"on-the-ground"===O.elevationInfo?.mode}))}};return e._createClass(v)}(K.SnappingAlgorithm);
const g=m.create();b.RightAngleTriangleSnapper=K;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/RightAngleTriangleSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/vec2 ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../SnappingConstraint ../SnappingDomain ../SnappingPoint ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint ../hints/RightAngleSnappingHint".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a){t=function(g){function u({targetPoint:v,point1:k,point2:n,isDraped:p}){v=g.call(this,v,new F.VerticalCylinderConstraint(P.asSnappingPoint(m.lerp(w.create(),k,n,.5)),.5*c.distance(k,n)),p,K.SnappingDomain.SELF)||this;v._p1=k;v._p2=n;return v}e._inherits(u,g);e._createClass(u,[{key:"hints",get:function(){return[new D.LineSnappingHint(z.LineSegmentHintType.REFERENCE,this.targetPoint,this._p1,this.isDraped,this.domain),new D.LineSnappingHint(z.LineSegmentHintType.REFERENCE,
this.targetPoint,this._p2,this.isDraped,this.domain),new a.RightAngleSnappingHint(this._p1,this.targetPoint,this._p2,this.isDraped,this.domain)]}}]);return u}(t.SnappingCandidate);b.RightAngleTriangleSnappingCandidate=t;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingOptions":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./FeatureSnappingLayerSource ./Settings".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D){c=function(a){function g(u){u=a.call(this,u)||this;u.enabled=!1;u.enabledToggled=!1;u.selfEnabled=!0;u.featureEnabled=!0;u.featureSources=new m;u.distance=D.defaults.distance;u.touchSensitivityMultiplier=D.defaults.touchSensitivityMultiplier;return u}b._inherits(g,a);b._createClass(g,[{key:"effectiveEnabled",get:function(){return this.enabledToggled?!this.enabled:this.enabled}},{key:"effectiveSelfEnabled",get:function(){return this.effectiveEnabled&&this.selfEnabled}},
{key:"effectiveFeatureEnabled",get:function(){return this.effectiveEnabled&&this.featureEnabled}}]);return g}(c);e.__decorate([w.property()],c.prototype,"enabled",void 0);e.__decorate([w.property()],c.prototype,"enabledToggled",void 0);e.__decorate([w.property()],c.prototype,"selfEnabled",void 0);e.__decorate([w.property()],c.prototype,"featureEnabled",void 0);e.__decorate([w.property({type:m.ofType(t)})],c.prototype,"featureSources",void 0);e.__decorate([w.property()],c.prototype,"distance",void 0);
e.__decorate([w.property()],c.prototype,"touchSensitivityMultiplier",void 0);e.__decorate([w.property({readOnly:!0})],c.prototype,"effectiveEnabled",null);e.__decorate([w.property({readOnly:!0})],c.prototype,"effectiveSelfEnabled",null);e.__decorate([w.property({readOnly:!0})],c.prototype,"effectiveFeatureEnabled",null);return c=e.__decorate([z.subclass("esri.views.interactive.snapping.SnappingOptions")],c)})},"esri/views/interactive/snapping/candidates/IntersectionSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../SnappingConstraint ../SnappingDomain ./SnappingCandidate ../hints/IntersectionSnappingHint".split(" "),
function(b,e,c,m,w,F){w=function(K){function P(z,t,D,a){z=K.call(this,z,new c.IntersectionConstraint(z,t.constraint,D.constraint),a,m.SnappingDomain.ALL)||this;z.first=t;z.second=D;return z}e._inherits(P,K);e._createClass(P,[{key:"hints",get:function(){this.first.targetPoint=this.targetPoint;this.second.targetPoint=this.targetPoint;return[...this.first.hints,...this.second.hints,new F.IntersectionSnappingHint(this.targetPoint,this.isDraped,this.domain)]}}]);return P}(w.SnappingCandidate);b.IntersectionSnappingCandidate=
w;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/IntersectionSnappingHint":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/vec3","../SnappingDomain","./SnappingHint"],function(b,e,c,m,w){w=function(F){function K(P,z,t=m.SnappingDomain.ALL){z=F.call(this,z,t)||this;z.intersectionPoint=P;return z}e._inherits(K,F);K.prototype.equals=function(P){return P instanceof K?c.exactEquals(this.intersectionPoint,
P.intersectionPoint):!1};return e._createClass(K)}(w.SnappingHint);b.IntersectionSnappingHint=w;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Sketch/support/OperationHandle":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/compilerUtils ../../../core/Evented ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass".split(" "),
function(b,e,c,m,w,F,K,P,z){b.OperationHandle=function(t){function D(g){g=t.call(this,g)||this;g.cancelled=!1;g.history={undo:[],redo:[]};g.type=null;return g}e._inherits(D,t);var a=D.prototype;a.addToHistory=function(g){this.history.redo=[];this.history.undo.push(g)};a.resetHistory=function(){this.history.redo=[];this.history.undo=[]};a.canUndo=function(){return 0<this.history.undo.length};a.canRedo=function(){return 0<this.history.redo.length};a.complete=function(){this._reset();this.onEnd();this.emit("complete")};
a.cancel=function(){this.cancelled=!0;this.complete()};a._reset=function(){this.activeComponent?.reset()};a.refreshComponent=function(){const g=this.activeComponent;g&&("box"!==g.type&&"reshape"!==g.type&&"graphic-mover"!==g.type||g.refresh())};e._createClass(D,[{key:"tool",get:function(){if(!this.activeComponent)return null;switch(this.activeComponent.type){case "graphic-mover":case "move-3d":return"move";case "box":case "transform-3d":return"transform";case "reshape":case "reshape-3d":return"reshape";
case "draw-2d":case "draw-3d":return this.activeComponent.geometryType;default:m.neverReached(this.activeComponent)}return null}},{key:"undo",set:function(g){this._set("undo",()=>{this.canUndo()&&g()})}},{key:"redo",set:function(g){this._set("redo",()=>{this.canRedo()&&g()})}}]);return D}(w.EventedAccessor);c.__decorate([F.property()],b.OperationHandle.prototype,"activeComponent",void 0);c.__decorate([F.property()],b.OperationHandle.prototype,"cancelled",void 0);c.__decorate([F.property()],b.OperationHandle.prototype,
"history",void 0);c.__decorate([F.property()],b.OperationHandle.prototype,"tool",null);c.__decorate([F.property()],b.OperationHandle.prototype,"type",void 0);c.__decorate([F.property()],b.OperationHandle.prototype,"canUndo",null);c.__decorate([F.property()],b.OperationHandle.prototype,"canRedo",null);c.__decorate([F.property()],b.OperationHandle.prototype,"onEnd",void 0);c.__decorate([F.property()],b.OperationHandle.prototype,"undo",null);c.__decorate([F.property()],b.OperationHandle.prototype,"redo",
null);c.__decorate([F.property()],b.OperationHandle.prototype,"toggleTool",void 0);c.__decorate([F.property()],b.OperationHandle.prototype,"addToSelection",void 0);c.__decorate([F.property()],b.OperationHandle.prototype,"removeFromSelection",void 0);b.OperationHandle=c.__decorate([z.subclass("esri.widgets.Sketch.support.OperationHandle")],b.OperationHandle);b.CreateOperationHandle=function(t){function D(){return t.apply(this,arguments)||this}e._inherits(D,t);return e._createClass(D)}(b.OperationHandle);
c.__decorate([F.property()],b.CreateOperationHandle.prototype,"activeComponent",void 0);b.CreateOperationHandle=c.__decorate([z.subclass("esri.widgets.Sketch.support.CreateOperationHandle")],b.CreateOperationHandle);b.UpdateOperationHandle=function(t){function D(){return t.apply(this,arguments)||this}e._inherits(D,t);return e._createClass(D)}(b.OperationHandle);c.__decorate([F.property()],b.UpdateOperationHandle.prototype,"activeComponent",void 0);b.UpdateOperationHandle=c.__decorate([z.subclass("esri.widgets.Sketch.support.UpdateOperationHandle")],
b.UpdateOperationHandle);Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/SnappingControls":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/arrayUtils ../../core/maybe ../../core/uid ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/has ../../core/accessorSupport/decorators/subclass ../Widget ./componentsUtils ./widgetUtils ./decorators/messageBundle ./jsxFactory ./SnappingControls/SnappingControlsViewModel".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a,g,u,v,k){const n={header:!0,enabledToggle:!0,selfEnabledToggle:!0,featureEnabledToggle:!0,layerList:!0,layerListToggleLayersButton:!0};z=function(p){function y(C,f){var h=p.call(this,(()=>{const {view:d,viewModel:l,snappingOptions:q,...H}=C;return H})(),f)||this;h._defaultViewModel=null;h._layerListFilter=null;h.iconClass="esri-icon-vertex-gps";h.icon=null;h.layerListOpen=!0;h.messages=null;h.visibleElements={...n};h._onToggleLayersButtonClick=d=>{h.viewModel.toggleSnappingForAllLayers(!h.viewModel.allLayersEnabled);
requestAnimationFrame(()=>d.target.setFocus())};C?.viewModel?h.viewModel=C.viewModel:(h._defaultViewModel=new k({snappingOptions:C.snappingOptions,view:C.view}),h.viewModel=h._defaultViewModel);return h}e._inherits(y,p);var O=y.prototype;O.destroy=function(){this._defaultViewModel=w.destroyMaybe(this._defaultViewModel)};O.loadDependencies=function(){return a.loadCalciteComponents({accordion:()=>new Promise((C,f)=>b(["../../chunks/calcite-accordion"],C,f)),"accordion-item":()=>new Promise((C,f)=>b(["../../chunks/calcite-accordion-item"],
C,f)),action:()=>new Promise((C,f)=>b(["../../chunks/calcite-action"],C,f)),block:()=>new Promise((C,f)=>b(["../../chunks/calcite-block"],C,f)),button:()=>new Promise((C,f)=>b(["../../chunks/calcite-button"],C,f)),icon:()=>new Promise((C,f)=>b(["../../chunks/calcite-icon"],C,f)),input:()=>new Promise((C,f)=>b(["../../chunks/calcite-input"],C,f)),label:()=>new Promise((C,f)=>b(["../../chunks/calcite-label"],C,f)),list:()=>new Promise((C,f)=>b(["../../chunks/calcite-list"],C,f)),"list-item":()=>new Promise((C,
f)=>b(["../../chunks/calcite-list-item"],C,f)),panel:()=>new Promise((C,f)=>b(["../../chunks/calcite-panel"],C,f)),switch:()=>new Promise((C,f)=>b(["../../chunks/calcite-switch"],C,f))})};O.castVisibleElements=function(C){return{...n,...C}};O.render=function(){const {label:C,visibleElements:{header:f}}=this;return v.tsx("div",{"aria-label":C,class:this.classes("esri-snapping-controls","esri-widget")},v.tsx("div",{class:"esri-snapping-controls__container"},f?this._renderHeaderView():this._renderContent()))};
O._renderHeaderView=function(){return v.tsx("calcite-panel",{heading:this.label,class:"esri-snapping-controls__panel"},this._renderContent())};O._renderContent=function(){return[this._renderToggles(),this._renderLayerList()]};O._renderToggles=function(){const {visibleElements:{enabledToggle:C,selfEnabledToggle:f,featureEnabledToggle:h}}=this;return C||f||h?v.tsx("calcite-block",{class:"esri-snapping-controls__toggle-block",key:"toggle-block",heading:"",open:!0},this._renderEnabledToggle(),v.tsx("div",
{class:"esri-snapping-controls__nested-container"},this._renderSelfEnabledToggle(),this._renderFeatureEnabledToggle())):null};O._renderEnabledToggle=function(){if(!this.visibleElements.enabledToggle)return null;const {messages:{enableSnapping:C},viewModel:{snappingOptions:{enabled:f,enabledToggled:h}}}=this;return v.tsx("calcite-label",{layout:"inline-space-between"},C,v.tsx("calcite-switch",{checked:f,disabled:h,bind:this,onCalciteSwitchChange:this._enableSnappingSwitchChange}))};O._renderSelfEnabledToggle=
function(){if(!this.visibleElements.selfEnabledToggle)return null;const {messages:{geometryGuides:C},viewModel:{snappingOptions:{enabled:f,selfEnabled:h,enabledToggled:d}}}=this;return v.tsx("calcite-label",{layout:"inline-space-between",key:"self-enabled-toggle"},C,v.tsx("calcite-switch",{checked:h,disabled:d||!f,bind:this,onCalciteSwitchChange:this._selfEnabledSwitchChange}))};O._renderFeatureEnabledToggle=function(){if(!this.visibleElements.featureEnabledToggle)return null;const {messages:{featureToFeature:C},
viewModel:{snappingOptions:{enabled:f,featureEnabled:h,enabledToggled:d}}}=this;return v.tsx("calcite-label",{layout:"inline-space-between",key:"feature-enabled-toggle"},C,v.tsx("calcite-switch",{checked:h,disabled:d||!f,bind:this,onCalciteSwitchChange:this._featureEnabledSwitchChange}))};O._renderLayerList=function(){if(!this.visibleElements.layerList)return null;const {messages:C,viewModel:f}=this,{snappingOptions:{enabled:h,enabledToggled:d}}=f;var l=({target:{value:H}})=>this._layerListFilter=
""===H?null:new RegExp(H,"i");l=9<f.layerListViewModel.operationalItems.length?v.tsx("calcite-input",{class:"esri-snapping-controls__layer-list__filter",clearable:!0,placeholder:C?.searchLayers,onCalciteInputInput:l}):null;const q=d||!h;return v.tsx("calcite-block",{key:"list-block",heading:C.snappingLayers,disabled:q,class:"esri-snapping-controls__layer-list-block",collapsible:!0,open:this.layerListOpen&&!q,onCalciteBlockToggle:H=>this.layerListOpen=H.target.open},l,this._renderToggleLayersButton(),
v.tsx("calcite-list",{class:"esri-snapping-controls__layer-list"},this._renderLayerListItemCollection(f.layerListViewModel.operationalItems,this._layerListFilter)))};O._renderLayerListItemCollection=function(C,f){return C.map(h=>{if(f?this._itemTitleMatchesFilter(h,f):1)return 0<h.children.length?this._renderLayerListItemGroup(h):this._renderLayerListItem(h);const d=h.children.filter(l=>this._itemTitleMatchesFilter(l,f));return 0<d.length?this._renderLayerListItemGroup(h,d):null}).toArray().filter(m.isSome)};
O._renderToggleLayersButton=function(){if(!this.visibleElements.layerListToggleLayersButton)return null;const {viewModel:{allLayersEnabled:C},messages:f}=this,h=C?f.disableAllLayers:f.enableAllLayers;return v.tsx("calcite-button",{appearance:"transparent",class:"esri-snapping-controls__layer-list__button",label:h,name:"layer-toggle",scale:"m",onclick:this._onToggleLayersButtonClick},h)};O._renderLayerListItem=function(C){const {messages:{untitledLayer:f}}=this,h=C.enabled;return v.tsx("calcite-list-item",
{class:"esri-snapping-controls__layer-list__item",label:C.title||f,key:`${this.id}-list-item-${C.uid}`,onCalciteListItemSelect:()=>{this._handleLayerListItemChange({checked:!h,value:C.layer.id})}},v.tsx("calcite-icon",{icon:h?"check-square-f":"square",slot:"content-start",scale:"s"}))};O._renderLayerListItemGroup=function(C,f){const {allChildrenEnabled:h,children:d,hasChildrenEnabled:l,title:q}=C,H=this.messages,N=q||H.untitledLayer,E=q&&""!==q?q:F.generateUID(),r=f??d;return v.tsx("calcite-list-item",
{class:"esri-snapping-controls__layer-list__item",key:E},v.tsx("calcite-accordion",{class:"esri-snapping-controls__layer-list__group",appearance:"transparent"},v.tsx("calcite-accordion-item",{expanded:!!f,heading:N,key:C.uid},v.tsx("calcite-action",{scale:"m",slot:"actions-start",text:h?H.disableAllLayers:H.enableAllLayers,textEnabled:!1,onclick:()=>{this.viewModel.toggleSnappingForLayers(C.childLayerIds,!h)}},v.tsx("calcite-icon",{icon:h?"check-square-f":l?"minus-square":"square",scale:"s"})),v.tsx("calcite-list",
null,[...this._renderLayerListItemCollection(r)]))))};O._enableSnappingSwitchChange=function(C){this.snappingOptions.enabled=C.target.checked};O._featureEnabledSwitchChange=function(C){this.snappingOptions.featureEnabled=C.target.checked};O._itemTitleMatchesFilter=function(C,f){return null!=f&&f.test(C.title)};O._selfEnabledSwitchChange=function(C){this.snappingOptions.selfEnabled=C.target.checked};O._handleLayerListItemChange=async function(C){C.checked?this.viewModel.enableSnappingForLayer(C.value):
this.viewModel.disableSnappingForLayer(C.value)};e._createClass(y,[{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(C){this._overrideIfSome("label",C)}},{key:"snappingOptions",get:function(){return this.viewModel.snappingOptions},set:function(C){this.viewModel.snappingOptions=C}},{key:"view",get:function(){return this.viewModel.view},set:function(C){this.viewModel.view=C}},{key:"viewModel",set:function(C){if(C!==this._get("viewModel")){if(null==this._defaultViewModel||
this._defaultViewModel!==C)this._defaultViewModel=w.destroyMaybe(this._defaultViewModel);this._set("viewModel",C)}}}]);return y}(D);c.__decorate([K.property()],z.prototype,"_defaultViewModel",void 0);c.__decorate([K.property()],z.prototype,"_layerListFilter",void 0);c.__decorate([K.property()],z.prototype,"iconClass",void 0);c.__decorate([K.property()],z.prototype,"icon",void 0);c.__decorate([K.property()],z.prototype,"label",null);c.__decorate([K.property()],z.prototype,"layerListOpen",void 0);c.__decorate([K.property(),
u.messageBundle("esri/widgets/support/SnappingControls/t9n/SnappingControls")],z.prototype,"messages",void 0);c.__decorate([K.property()],z.prototype,"snappingOptions",null);c.__decorate([K.property()],z.prototype,"view",null);c.__decorate([K.property()],z.prototype,"viewModel",null);c.__decorate([K.property()],z.prototype,"visibleElements",void 0);c.__decorate([P.cast("visibleElements")],z.prototype,"castVisibleElements",null);return z=c.__decorate([t.subclass("esri.widgets.support.SnappingControls")],
z)})},"esri/widgets/support/SnappingControls/SnappingControlsViewModel":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Error ../../../core/HandleOwner ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../views/interactive/snapping/FeatureSnappingLayerSource ../../LayerList/support/layerListUtils ./SnappingLayerListViewModel".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a,g,u){c=function(v){function k(p){p=v.call(this,p)||this;p.layerListViewModel=new u.SnappingLayerListViewModel;p.snappingOptions=null;p.view=null;return p}b._inherits(k,v);var n=k.prototype;n.initialize=function(){this.handles.add([F.watch(()=>({viewModel:this.layerListViewModel,view:this.view}),({viewModel:p,view:y})=>{p.view=y},F.initial),F.watch(()=>({viewModel:this.layerListViewModel,sources:this.snappingOptions?.featureSources}),({viewModel:p,sources:y})=>{p.featureSnappingSources=
y},F.initial)])};n.toggleSnappingForLayers=function(p,y){p?.forEach(O=>y?this.enableSnappingForLayer(O):this.disableSnappingForLayer(O))};n.toggleSnappingForAllLayers=function(p){this.layerListViewModel.selectableItems.forEach(({layer:{id:y}})=>{p?this.enableSnappingForLayer(y):this.disableSnappingForLayer(y)})};n.enableSnappingForLayer=function(p){(this._findSnappingSourceForLayer(p)??this._makeSnappingSourceForLayer(p)).enabled=!0};n.disableSnappingForLayer=function(p){if(p=this._findSnappingSourceForLayer(p))p.enabled=
!1};n.updateEnabledFeatureSources=function(p){for(const y of this.snappingOptions.featureSources)g.canDisplayLayer(y.layer)&&(y.enabled=p.includes(y.layer.id))};n._findSnappingSourceForLayer=function(p){return this.snappingOptions.featureSources.find(y=>y.layer.id===p)};n._makeSnappingSourceForLayer=function(p){var y=this.layerListViewModel.operationalItemsFlat.find(O=>O.layer.id===p)?.layer;if(!y)throw new m("snapping-controls:layer-not-found",`cannot enable snapping for layer with id ${p} because no such layer was found in the view`);
y=new a({layer:y});this.snappingOptions.featureSources.add(y);return y};b._createClass(k,[{key:"allLayersEnabled",get:function(){return(this.layerListViewModel?.selectableItems??[]).every(p=>p.enabled)}},{key:"allLayersDisabled",get:function(){return(this.layerListViewModel?.selectableItems??[]).every(p=>!p.enabled)}},{key:"layersEnabledCount",get:function(){return this.layerListViewModel?.selectableItems?.filter(p=>p.enabled).length??0}},{key:"state",get:function(){return this.get("snappingOptions")?
"ready":"disabled"}}]);return k}(w.HandleOwnerMixin(c));e.__decorate([K.property()],c.prototype,"allLayersEnabled",null);e.__decorate([K.property()],c.prototype,"allLayersDisabled",null);e.__decorate([K.property({constructOnly:!0})],c.prototype,"layerListViewModel",void 0);e.__decorate([K.property()],c.prototype,"layersEnabledCount",null);e.__decorate([K.property()],c.prototype,"snappingOptions",void 0);e.__decorate([K.property()],c.prototype,"state",null);e.__decorate([K.property()],c.prototype,
"view",void 0);return c=e.__decorate([D.subclass("esri.widgets.support.SnappingControls.SnappingControlsViewModel")],c)})},"esri/widgets/LayerList/support/layerListUtils":function(){define(["exports"],function(b){function e(z){if(z)return null!=z.listMode?z.listMode:void 0}function c(z){if(z)return null!=z.minScale?z.minScale:void 0}function m(z){if(z)return null!=z.maxScale?z.maxScale:void 0}function w(z){if(z&&!("type"in z&&"wmts"===z.type)&&z.listMode!==P.hideChildren)return"sublayers"in z?"sublayers":
"layers"in z?"layers":void 0}function F(z,t){z&&z.sort((D,a)=>{D=t.indexOf(D.uid);a=t.indexOf(a.uid);return D>a?-1:D<a?1:0})}function K(z){return!!z?.layer}const P={hide:"hide",hideChildren:"hide-children"};b.canDisplayLayer=function(z){return e(z)!==P.hide};b.canSortSublayers=function(z){z=z&&(z.get("layer.layer")||z.layer);if(!z)return!1;z=z.get("capabilities.exportMap.supportsDynamicLayers");return"boolean"===typeof z?z:!0};b.findLayerListMode=e;b.findLayerMaxScale=m;b.findLayerMinScale=c;b.findLayerVisibilityMode=
function(z){if(!z)return"inherited";var t=z.get("layer.capabilities.exportMap.supportsSublayerVisibility");if("boolean"===typeof t)return t?"independent":"inherited";t=z.get("capabilities.exportMap.supportsSublayerVisibility");return"boolean"===typeof t?t?"independent":"inherited":null!=z.visibilityMode?z.visibilityMode:"independent"};b.findSelectedItem=function(z,t){const D=z.layer?.uid;return null!=D?t.find(a=>a.layer?.uid===D):null};b.getItemLayers=function(z){return(z=z?.layer)&&"layers"in z?
z.layers:null};b.getLegendLayerInfo=function(z){var t=K(z)?z:null;const D=z?.parent;return(t="map-image"===D?.type?t?.source:null)&&D?{layer:D,title:"",sublayerIds:[t.mapLayerId]}:{layer:z,title:""}};b.getNormalizedChildLayerProperty=w;b.isLayerOutsideScaleRange=function(z,t){if(!z||isNaN(t))return!1;var D=c(z);z=m(z);D=null!=D&&!isNaN(D)&&0<D&&t>D;t=null!=z&&!isNaN(z)&&0<z&&t<z;return D||t};b.isSublayer=K;b.sortChildLayersToIds=function(z,t){if(z=z?.layer){var D=w(z);D&&(z=z.get(D),F(z,t))}};b.sortLayersToIds=
F;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/SnappingControls/SnappingLayerListViewModel":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../LayerList/LayerListViewModel ./snappingLayerListUtils ./SnappingListItem".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a){b.SnappingLayerListViewModel=function(g){function u(){var k=g.apply(this,arguments)||this;k.featureSnappingSources=new m;return k}e._inherits(u,g);var v=u.prototype;v._compileList=function(){var k=this.get("view.map.layers");k&&(k=k.filter(D.isValidSnappingLayer),this._watchLayersListMode(k),(k=this._getViewableLayers(k))&&k.length?(this._createNewItems(k),this._removeItems(k),this._sortItems(k)):this._removeAllItems())};v._createListItem=function(k){return new a.SnappingListItem({layer:k,
view:this.view,getFeatureSnappingSources:()=>this.featureSnappingSources})};e._createClass(u,[{key:"operationalItemsFlat",get:function(){return this.operationalItems.flatten(k=>k.children)}},{key:"selectableItems",get:function(){return this.operationalItemsFlat.filter(k=>!k.children?.length)}}]);return u}(t);c.__decorate([w.property()],b.SnappingLayerListViewModel.prototype,"featureSnappingSources",void 0);c.__decorate([w.property()],b.SnappingLayerListViewModel.prototype,"operationalItems",void 0);
c.__decorate([w.property()],b.SnappingLayerListViewModel.prototype,"operationalItemsFlat",null);c.__decorate([w.property()],b.SnappingLayerListViewModel.prototype,"selectableItems",null);b.SnappingLayerListViewModel=c.__decorate([z.subclass("esri.widgets.support.SnappingControls.SnappingLayerListViewModel")],b.SnappingLayerListViewModel);Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/LayerList/LayerListViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Collection ../../core/Evented ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./ListItem ./support/layerListUtils".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a){const g=c.ofType(D);c=function(u){function v(n){n=u.call(this,n)||this;n.checkPublishStatusEnabled=!1;n.listItemCreatedFunction=null;n.operationalItems=new g;n.view=null;return n}b._inherits(v,u);var k=v.prototype;k.initialize=function(){this.addHandles([w.watch(()=>[this.view,this.view?.ready],()=>this._viewHandles(),w.initial),w.watch(()=>[this.listItemCreatedFunction,this.checkPublishStatusEnabled],()=>this._recompileList())],"view")};k.destroy=function(){this.removeAllHandles();
this.view=null;this.operationalItems.removeAll()};k.triggerAction=function(n,p){n&&!n.disabled&&this.emit("trigger-action",{action:n,item:p})};k.moveListItem=function(n,p,y,O){const C=n?.layer;if(C){var f=this.view?.map?.layers,h=p?a.getItemLayers(p):f;f=y?a.getItemLayers(y):f;if(h&&f){var {operationalItems:d}=this;p=p?.children||d;d=y?.children||d;O=f.length-O;n.parent=y||null;p.includes(n)&&p.remove(n);h.includes(C)&&h.remove(C);d.includes(n)||d.add(n,O);f.includes(C)||f.add(C,O)}}};k._createLayerViewHandles=
function(n){this.removeHandles("layer-views");this._compileList();n&&this.addHandles(n.on("change",()=>this._compileList()),"layer-views")};k._createMapLayerHandles=function(n){this.removeHandles("map-layers");this._compileList();n&&this.addHandles(n.on("change",()=>this._compileList()),"map-layers")};k._createListItem=function(n){const {view:p,listItemCreatedFunction:y,checkPublishStatusEnabled:O}=this;return new D({checkPublishStatusEnabled:O,layer:n,listItemCreatedFunction:y,view:p})};k._removeAllItems=
function(){this.operationalItems.removeAll()};k._getViewableLayers=function(n){if(n)return n.filter(p=>"hide"!==a.findLayerListMode(p))};k._watchLayersListMode=function(n){this.removeHandles("layer-list-mode");n&&n.forEach(p=>{"listMode"in p&&this.addHandles(w.watch(()=>p.listMode,()=>this._compileList()),"layer-list-mode")})};k._compileList=function(){var n=this.get("view.map.layers");this._watchLayersListMode(n);(n=this._getViewableLayers(n))&&n.length?(this._createNewItems(n),this._removeItems(n),
this._sortItems(n)):this._removeAllItems()};k._createNewItems=function(n){const {operationalItems:p}=this;n.forEach(y=>{p.find(O=>O.layer===y)||p.add(this._createListItem(y))})};k._removeItems=function(n){const {operationalItems:p}=this,y=[];p.forEach(O=>{O&&n&&n.includes(O.layer)||y.push(O)});p.removeMany(y)};k._sortItems=function(n){const {operationalItems:p}=this;p.sort((y,O)=>{y=n.indexOf(y.layer);O=n.indexOf(O.layer);return y>O?-1:y<O?1:0})};k._recompileList=function(){this._removeAllItems();
this._compileList()};k._viewHandles=function(){const {view:n}=this;this.removeHandles(["map-layers","layer-views","view-layers"]);this._recompileList();n&&n.ready&&this.addHandles([w.watch(()=>this.view?.map?.allLayers,p=>this._createMapLayerHandles(p),w.initial),w.watch(()=>this.view?.allLayerViews,p=>this._createLayerViewHandles(p),w.initial)],"view-layers")};b._createClass(v,[{key:"state",get:function(){const n=this.get("view");return this.get("view.ready")?"ready":n?"loading":"disabled"}}]);return v}(m.EventedAccessor);
e.__decorate([F.property()],c.prototype,"checkPublishStatusEnabled",void 0);e.__decorate([F.property()],c.prototype,"listItemCreatedFunction",void 0);e.__decorate([F.property({type:g})],c.prototype,"operationalItems",void 0);e.__decorate([F.property({readOnly:!0})],c.prototype,"state",null);e.__decorate([F.property()],c.prototype,"view",void 0);return c=e.__decorate([t.subclass("esri.widgets.LayerList.LayerListViewModel")],c)})},"esri/widgets/LayerList/ListItem":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/arrayUtils ../../core/Collection ../../core/HandleOwner ../../core/Identifiable ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/has ../../core/accessorSupport/decorators/subclass ../../support/actions/ActionBase ../../support/actions/ActionButton ../../support/actions/ActionSlider ../../support/actions/ActionToggle ./ListItemPanel ./support/layerListUtils".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a,g,u,v,k,n,p){var y;D=w.ofType({key:"type",defaultKeyValue:"button",base:g,typeMap:{button:u,toggle:k,slider:v}});const O=w.ofType(D);c=y=function(C){function f(d){d=C.call(this,d)||this;d.actionsSections=new O;d.actionsOpen=!1;d.checkPublishStatusEnabled=!1;d.children=new (w.ofType(y));d.childrenSortable=!0;d.hidden=!1;d.layer=null;d.layerView=null;d.listItemCreatedFunction=null;d.open=!1;d.panel=null;d.parent=null;d.sortable=!0;d.view=null;return d}b._inherits(f,
C);var h=f.prototype;h.initialize=function(){this.handles.add([P.watch(()=>this.layer,d=>this._watchLayerProperties(d),P.initial),P.watch(()=>this.checkPublishStatusEnabled,d=>this._updateChildrenPublishing(d),P.initial),P.watch(()=>this.view,d=>this._updateChildrenView(d),P.initial),P.watch(()=>this.panel,d=>this._setListItemOnPanel(d),P.initial),P.watch(()=>[this.layer,this.view],()=>this._getLayerView(),P.initial)]);"function"===typeof this.listItemCreatedFunction&&this.listItemCreatedFunction.call(null,
{item:this})};h.destroy=function(){this.view=null};h.castPanel=function(d){this.get("panel.open")&&!d.hasOwnProperty("open")&&(d.open=!0);return d?new n(d):null};h.clone=function(){return new y({actionsSections:this.actionsSections.clone(),actionsOpen:this.actionsOpen,checkPublishStatusEnabled:this.checkPublishStatusEnabled,children:this.children.clone(),layer:this.layer,listItemCreatedFunction:this.listItemCreatedFunction,open:this.open,panel:this.panel,title:this.title,view:this.view,visible:this.visible})};
h._setListItemOnPanel=function(d){d&&(d.listItem=this)};h._updateChildrenPublishing=function(d){const l=this.children;l&&l.forEach(q=>q.checkPublishStatusEnabled=d)};h._updateChildrenView=function(d){const l=this.children;l&&l.forEach(q=>q.view=d)};h._addChildren=function(d){this.handles.remove("child-list-mode");this.children.removeAll();if(d){d.forEach(q=>{this.handles.add(P.watch(()=>q.listMode,()=>this._addChildren(d)),"child-list-mode")});var l=d.filter(q=>"hide"!==p.findLayerListMode(q));this.children.addMany(this._makeChildren(l))}};
h._watchSublayerChanges=function(d){d&&this.handles.add(d.on("change",()=>{this._addChildren(d)}),"layer")};h._initializeChildLayers=function(d){this._addChildren(d);this._watchSublayerChanges(d)};h._makeChildren=function(d){return d.map(l=>p.canDisplayLayer(l)?new y({layer:l,checkPublishStatusEnabled:this.checkPublishStatusEnabled,listItemCreatedFunction:this.listItemCreatedFunction,parent:this,view:this.view}):null).filter(m.isSome).reverse()};h._watchLayerProperties=function(d){if(this.handles&&
(this.handles.remove("layer"),this.handles.remove("child-list-mode"),d))if(this.handles.add(P.watch(()=>d.listMode,()=>this._watchLayerProperties(d)),"layer"),"hide-children"===p.findLayerListMode(d))this.children.removeAll();else{var l=p.getNormalizedChildLayerProperty(d);l&&this.handles.add(P.watch(()=>d[l],q=>{d.hasOwnProperty(l)&&this._initializeChildLayers(q)},P.initial),"layer")}};h._getLayerView=async function(){const {layer:d,view:l}=this;if(d&&l)try{const q=await l.whenLayerView(d);q.layer===
this.layer&&this._set("layerView",q)}catch{}};b._createClass(f,[{key:"connectionStatus",get:function(){const {layerView:d,publishing:l}=this;if(!l&&d&&"connectionStatus"in d)return d.connectionStatus}},{key:"error",get:function(){return this.layer?.loadError}},{key:"incompatible",get:function(){const {layerView:d}=this;return d&&"spatialReferenceSupported"in d?!d.spatialReferenceSupported:!1}},{key:"title",get:function(){const d=this.get("layer.layer");return(!d||d&&this.get("layer.layer.loaded"))&&
this.get("layer.title")||this.get("layer.attributes.title")||""},set:function(d){this._override("title",d)}},{key:"publishing",get:function(){const {layer:d,checkPublishStatusEnabled:l}=this;return l&&d&&"publishingInfo"in d&&"publishing"===d.publishingInfo?.status}},{key:"updating",get:function(){const {layerView:d,connectionStatus:l,layer:q,publishing:H}=this;return H||l?!1:d?d.updating:"loading"===q?.loadStatus||!1}},{key:"visible",get:function(){return this.layer?.visible},set:function(d){const l=
this.layer;l&&(l.visible=d)}},{key:"visibleAtCurrentScale",get:function(){return!p.isLayerOutsideScaleRange(this.layer,this.get("view.scale"))}},{key:"visibilityMode",get:function(){return p.findLayerVisibilityMode(this.layer)}}]);return f}(K.IdentifiableMixin(F.HandleOwnerMixin(c)));e.__decorate([z.property({type:O})],c.prototype,"actionsSections",void 0);e.__decorate([z.property()],c.prototype,"actionsOpen",void 0);e.__decorate([z.property()],c.prototype,"checkPublishStatusEnabled",void 0);e.__decorate([z.property({type:w})],
c.prototype,"children",void 0);e.__decorate([z.property()],c.prototype,"childrenSortable",void 0);e.__decorate([z.property({readOnly:!0})],c.prototype,"connectionStatus",null);e.__decorate([z.property({readOnly:!0})],c.prototype,"error",null);e.__decorate([z.property()],c.prototype,"hidden",void 0);e.__decorate([z.property({readOnly:!0})],c.prototype,"incompatible",null);e.__decorate([z.property()],c.prototype,"layer",void 0);e.__decorate([z.property({readOnly:!0})],c.prototype,"layerView",void 0);
e.__decorate([z.property()],c.prototype,"listItemCreatedFunction",void 0);e.__decorate([z.property()],c.prototype,"open",void 0);e.__decorate([z.property({type:n})],c.prototype,"panel",void 0);e.__decorate([t.cast("panel")],c.prototype,"castPanel",null);e.__decorate([z.property()],c.prototype,"parent",void 0);e.__decorate([z.property()],c.prototype,"sortable",void 0);e.__decorate([z.property()],c.prototype,"title",null);e.__decorate([z.property({readOnly:!0})],c.prototype,"publishing",null);e.__decorate([z.property({readOnly:!0})],
c.prototype,"updating",null);e.__decorate([z.property()],c.prototype,"view",void 0);e.__decorate([z.property()],c.prototype,"visible",null);e.__decorate([z.property({readOnly:!0})],c.prototype,"visibleAtCurrentScale",null);e.__decorate([z.property({readOnly:!0})],c.prototype,"visibilityMode",null);return c=y=e.__decorate([a.subclass("esri.widgets.LayerList.ListItem")],c)})},"esri/support/actions/ActionSlider":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./ActionBase".split(" "),
function(b,e,c,m,w,F,K,P){var z;m=z=function(t){function D(a){a=t.call(this,a)||this;a.displayValueEnabled=!1;a.max=1;a.min=0;a.step=.1;a.type="slider";a.value=null;return a}b._inherits(D,t);D.prototype.clone=function(){return new z({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,displayValueEnabled:this.displayValueEnabled,max:this.max,min:this.min,step:this.step,value:this.value})};return b._createClass(D)}(P);
e.__decorate([c.property()],m.prototype,"displayValueEnabled",void 0);e.__decorate([c.property()],m.prototype,"max",void 0);e.__decorate([c.property()],m.prototype,"min",void 0);e.__decorate([c.property()],m.prototype,"step",void 0);e.__decorate([c.property()],m.prototype,"value",void 0);return m=z=e.__decorate([K.subclass("esri.support.Action.ActionSlider")],m)})},"esri/widgets/LayerList/ListItemPanel":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Identifiable ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../Widget ./support/layerListUtils ../support/widget ../support/jsxFactory".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a,g,u,v){m=function(k){function n(y,O){y=k.call(this,y,O)||this;y._legend=null;y.content=null;y.image=null;y.listItem=null;y.open=!1;y.visible=!0;return y}e._inherits(n,k);var p=n.prototype;p.initialize=function(){this.addHandles(F.watch(()=>this.content,y=>this._createLegend(y),F.initial))};p.destroy=function(){this._legend=w.destroyMaybe(this._legend)};p.render=function(){return v.tsx("div",{class:"esri-layer-list-panel"},this._renderContents())};p._renderContent=
function(y){const {_legend:O,disabled:C}=this;return!y||C?null:"legend"===y&&O?v.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--legend"),key:O},O.render()):"string"===typeof y?v.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--string"),key:y,innerHTML:y}):u.isWidget(y)?v.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--widget"),key:y},y.render()):y instanceof
HTMLElement?v.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--html-element"),key:y,bind:y,afterCreate:this._attachToNode}):null};p._renderContents=function(){const {content:y}=this;return Array.isArray(y)?y.map(O=>this._renderContent(O)):this._renderContent(y)};p._getLegendOptions=function(){const {listItem:y}=this;if(!y)return{};const {layer:O,view:C}=y;return O&&C?{view:C,layerInfos:[g.getLegendLayerInfo(O)]}:{}};p._createLegend=async function(y){if(this._hasLegend(y)&&
!this._legend){({default:y}=await new Promise((f,h)=>b(["../Legend"],d=>f(Object.freeze(Object.defineProperty({__proto__:null,default:d},Symbol.toStringTag,{value:"Module"}))),h)));var {listItem:O}=this,C=new y(this._getLegendOptions());this._legend=C;this.notifyChange("className");this.notifyChange("title");y=F.watch(()=>[O?.view,O?.layer,O?.layer?.source,O?.layer?.parent],()=>this._updateLegend(C),F.initial);this.addHandles(y,"legends");this.scheduleRender()}};p._hasLegend=function(y){return"legend"===
y?!0:null!=y&&(Array.isArray(y)?y.includes("legend"):!1)};p._attachToNode=function(y){y.appendChild(this)};p._updateLegend=function(y){y.set(this._getLegendOptions());this.scheduleRender()};p._getWidget=function(y){return"legend"===y?this._legend:u.isWidget(y)?y:null};p._getFirstWidget=function(){const {content:y}=this;if(Array.isArray(y)){let O=null;y.some(C=>{(C=this._getWidget(C))&&(O=C);return!!C});return O}return this._getWidget(y)};e._createClass(n,[{key:"className",get:function(){const {image:y}=
this,O=this._getFirstWidget();return this._get("className")||(!y&&O?O.iconClass??"":"")},set:function(y){this._override("className",y)}},{key:"disabled",get:function(){const {listItem:y,_legend:O,content:C}=this;return y?Array.isArray(C)&&1<C.length?!1:O?!O.activeLayerInfos?.length||!y.visibleAtCurrentScale||!y.visible:!1:!0},set:function(y){this._overrideIfSome("disabled",y)}},{key:"title",get:function(){const y=this._getFirstWidget();return this._get("title")||(y?.label??"")},set:function(y){this._override("title",
y)}}]);return n}(m.IdentifiableMixin(a));c.__decorate([K.property()],m.prototype,"_legend",void 0);c.__decorate([K.property()],m.prototype,"className",null);c.__decorate([K.property()],m.prototype,"content",void 0);c.__decorate([K.property()],m.prototype,"disabled",null);c.__decorate([K.property()],m.prototype,"image",void 0);c.__decorate([K.property()],m.prototype,"listItem",void 0);c.__decorate([K.property()],m.prototype,"title",null);c.__decorate([K.property()],m.prototype,"open",void 0);c.__decorate([K.property()],
m.prototype,"visible",void 0);return m=c.__decorate([D.subclass("esri.widgets.LayerList.ListItemPanel")],m)})},"esri/widgets/support/SnappingControls/snappingLayerListUtils":function(){define(["exports","../../LayerList/support/layerListUtils"],function(b,e){const c=F=>m(F)||w(F),m=F=>{if(!("type"in F))return!1;switch(F.type){case "feature":case "geojson":case "csv":case "graphics":case "wfs":case "map-notes":case "oriented-imagery":case "scene":case "building-scene":return!0;default:return!1}},w=
F=>{const K=e.getNormalizedChildLayerProperty(F);if(null!=K&&F.hasOwnProperty(K)&&null!=F[K])for(const P of F[K])if(c(P))return!0;return!1};b.isValidSnappingLayer=c;b.isValidSnappingLayerGroup=w;b.isValidSnappingLayerSource=m;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/SnappingControls/SnappingListItem":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/arrayUtils ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../LayerList/ListItem ../../LayerList/support/layerListUtils ./snappingLayerListUtils".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a){var g;b.SnappingListItem=g=function(u){function v(n){n=u.call(this,n)||this;n.children=new w;n.parent=null;return n}e._inherits(v,u);var k=v.prototype;k._initializeChildLayers=function(n){n&&(n=n.filter(a.isValidSnappingLayer),e._get(e._getPrototypeOf(v.prototype),"_initializeChildLayers",this).call(this,n))};k._makeChildren=function(n){return n.map(p=>D.canDisplayLayer(p)?new g({layer:p,parent:this,view:this.view,getFeatureSnappingSources:this.getFeatureSnappingSources}):
null).filter(m.isSome).reverse()};e._createClass(v,[{key:"allChildrenEnabled",get:function(){return this.children.every(n=>n.enabled)??!1}},{key:"childLayerIds",get:function(){return this.children.map(n=>n.layer.id).toArray()}},{key:"enabled",get:function(){return null!=this.featureSource?this.featureSource.enabled:!1}},{key:"featureSource",get:function(){const {layer:n,getFeatureSnappingSources:p}=this;return p().find(y=>y.layer===n)}},{key:"hasChildrenEnabled",get:function(){return this.children.some(n=>
n.enabled)}}]);return v}(t);c.__decorate([F.property()],b.SnappingListItem.prototype,"allChildrenEnabled",null);c.__decorate([F.property()],b.SnappingListItem.prototype,"children",void 0);c.__decorate([F.property()],b.SnappingListItem.prototype,"childLayerIds",null);c.__decorate([F.property()],b.SnappingListItem.prototype,"enabled",null);c.__decorate([F.property()],b.SnappingListItem.prototype,"featureSource",null);c.__decorate([F.property({constructOnly:!0})],b.SnappingListItem.prototype,"getFeatureSnappingSources",
void 0);c.__decorate([F.property()],b.SnappingListItem.prototype,"hasChildrenEnabled",null);c.__decorate([F.property()],b.SnappingListItem.prototype,"parent",void 0);b.SnappingListItem=g=c.__decorate([z.subclass("esri.widgets.support.SnappingControls.SnappingListItem")],b.SnappingListItem);Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/SketchTooltipControls/SketchTooltipControls":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../Widget ../componentsUtils ../widgetUtils ../decorators/messageBundle ../jsxFactory".split(" "),
function(b,e,c,m,w,F,K,P,z,t,D,a,g,u){e.SketchTooltipControls=function(v){function k(p){var y=v.call(this,p)||this;y.viewModel=null;y.iconClass="esri-icon-gear";y.icon=null;y._onEnabledChange=O=>{y.tooltipOptions.enabled=O.target.checked};return y}c._inherits(k,v);var n=k.prototype;n.loadDependencies=function(){return D.loadCalciteComponents({block:()=>new Promise((p,y)=>b(["../../../chunks/calcite-block"],p,y)),label:()=>new Promise((p,y)=>b(["../../../chunks/calcite-label"],p,y)),switch:()=>new Promise((p,
y)=>b(["../../../chunks/calcite-switch"],p,y))})};n.render=function(){return u.tsx("div",{class:"esri-sketch-tooltip-controls"},u.tsx("calcite-block",{heading:"",open:!0},u.tsx("calcite-label",{layout:"inline-space-between"},this.messages?.enabledToggle,u.tsx("calcite-switch",{checked:this.tooltipOptions.enabled,onCalciteSwitchChange:this._onEnabledChange}))))};c._createClass(k,[{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(p){this._overrideIfSome("label",p)}}]);
return k}(t);m.__decorate([w.property()],e.SketchTooltipControls.prototype,"viewModel",void 0);m.__decorate([w.property()],e.SketchTooltipControls.prototype,"iconClass",void 0);m.__decorate([w.property()],e.SketchTooltipControls.prototype,"icon",void 0);m.__decorate([w.property()],e.SketchTooltipControls.prototype,"label",null);m.__decorate([w.property(),g.messageBundle("esri/widgets/support/SketchTooltipControls/t9n/SketchTooltipControls")],e.SketchTooltipControls.prototype,"messages",void 0);m.__decorate([w.property()],
e.SketchTooltipControls.prototype,"tooltipOptions",void 0);e.SketchTooltipControls=m.__decorate([z.subclass("esri.widgets.Editor.components.SketchTooltipControls")],e.SketchTooltipControls);Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../intl ../core/arrayUtils ../core/HandleOwner ../core/Logger ../core/promiseUtils ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/has ../core/accessorSupport/decorators/subclass ../layers/support/fieldUtils ./Attachments ./FeatureForm ./FeatureTemplates ./Spinner ./Widget ./Editor/deprecationUtils ./Editor/EditorViewModel ./Editor/modelUploadUtils ./FeatureTemplates/ItemList ./support/componentsUtils ./support/Heading ./support/SnappingControls ./support/decorators/accessibleHandler ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory ./support/widgetUtils ./support/SketchTooltipControls/SketchTooltipControls ../intl/substitute".split(" "),function(b,
e,c,m,w,F,K,P,z,t,D,a,g,u,v,k,n,p,y,O,C,f,h,d,l,q,H,N,E,r,I,M,S){function U(L){requestAnimationFrame(()=>L.setFocus())}const G={undoRedoButtons:!1,snappingControls:!0,snappingControlsElements:{header:!1,enabledToggle:!0,selfEnabledToggle:!0,featureEnabledToggle:!0,layerList:!0},sketchTooltipControls:!0},J=K.getLogger("esri.widgets.Editor");m=function(L){function B(x,Q){var T=L.call(this,x,Q)||this;T._featureForm=new k;T._attachments=new v({visibleElements:{addSubmitButton:!1,cancelAddButton:!1,cancelUpdateButton:!1,
deleteButton:!1,errorMessage:!1,progressBar:!1,updateButton:!1}});T._featureTemplates=new n({enableListScroll:!1,renderItemContentEnd:W=>T._renderTemplateContentEnd(W),renderItemDescription:W=>T._renderTemplateDescription(W),renderItemLabel:W=>T._renderTemplateLabel(W),renderCustomGroupContent:W=>T._renderCustomTemplateGroupContent(W)});T._filterText="";T._prompt=null;T._spinner=new p;T.headingLevel=4;T.iconClass="esri-icon-edit";T.messages=null;T.messagesCommon=null;T.messagesTemplates=null;T.supportingWidgetDefaults=
null;T.viewModel=new C;T.visibleElements={...G};T._renderSelectIcon=()=>r.tsx("calcite-icon",{icon:"cursor",slot:"content-start"});T.EditorPanel=({handleBack:W,heading:aa,headingLevel:Y,key:Z},...R)=>{const {messagesCommon:V,viewModel:ba,visibleElements:ea}=e._assertThisInitialized(T),ha=ba.sketchViewModel;return r.tsx("calcite-flow-item",{closable:!1,heading:aa,headingLevel:Y,key:Z,loading:ba.syncing||T._attachments.submitting,onCalciteFlowItemBack:W??void 0},r.tsx("div",{key:"panel-toolbar",class:"esri-editor__panel-toolbar"},
T._renderSettings(),ea.undoRedoButtons&&[r.tsx("calcite-button",{key:"undo-button",label:V.undo,appearance:"transparent",kind:"neutral",alignment:"center",iconStart:"undo",scale:"l",disabled:!ha.canUndo(),onclick:ha.undo.bind(ha)},V.undo),r.tsx("calcite-button",{key:"redo-button",label:V.redo,appearance:"transparent",kind:"neutral",alignment:"center",iconStart:"redo",scale:"l",disabled:!ha.canRedo(),onclick:ha.redo.bind(ha)},V.redo)]),...R)};T._showDiscardEditsPrompt=()=>{const {messages:W,activeWorkflow:aa}=
e._assertThisInitialized(T);if("create-features"===aa?.type&&f.isModelUpload(aa.data.creationInfo))return T._showPrompt({title:W.cancelUploadTitle,message:W.cancelUploadWarningMessage,yesLabel:W.discardUpload,noLabel:W.continueUpload});const Y="create"===aa?.type;return T._showPrompt({title:W[Y?"cancelAddTitle":"cancelEditTitle"],message:W[Y?"cancelAddWarningMessage":"cancelEditWarningMessage"],yesLabel:W[Y?"discardFeature":"discardEdits"],noLabel:W[Y?"continueAdding":"continueEditing"]})};T._showGenericCancelPrompt=
()=>{const {messages:W,messagesCommon:aa}=e._assertThisInitialized(T);return T._showPrompt({title:W.cancelRequestTitle,message:W.cancelRequestWarningMessage,yesLabel:aa.form.yes,noLabel:aa.form.no})};T._onToggleUpdateWorkflow=()=>T.viewModel.toggleUpdateWorkflow();T._onAttachmentDeleteConfirm=async()=>{const W=T._attachments,{activeWorkflow:aa}=T.viewModel;aa&&("create-features"===aa.type?W.deleteFile():(await W.deleteAttachment(W.viewModel.activeAttachmentInfo),T._clearPrompt()),await aa.back(),
T._clearPrompt())};T._onAttachmentsError=W=>{T._prompt={title:T.messages.errorWarningTitle,message:W.message,context:"warning",actions:{primary:{label:T.messagesCommon.form.ok,action:T._clearPrompt}}}};T._clearPrompt=()=>{T._prompt=null};T._onBack=T._onBack.bind(e._assertThisInitialized(T));T._onSave=T._onSave.bind(e._assertThisInitialized(T));T._onDelete=T._onDelete.bind(e._assertThisInitialized(T));T._onToggleUpdateWorkflow=T._onToggleUpdateWorkflow.bind(e._assertThisInitialized(T));T._onAttachmentAdd=
T._onAttachmentAdd.bind(e._assertThisInitialized(T));T._onAttachmentUpdate=T._onAttachmentUpdate.bind(e._assertThisInitialized(T));T._onAttachmentDelete=T._onAttachmentDelete.bind(e._assertThisInitialized(T));return T}e._inherits(B,L);var A=B.prototype;A.initialize=function(){this.addHandles([z.watch(()=>l.incrementHeadingLevel(this.headingLevel),x=>{this._featureForm.headingLevel=x;this._featureTemplates.headingLevel=x},z.initial),z.watch(()=>this.viewModel.selectedTemplateItem,x=>this._featureTemplates.select(x,
{emit:!1})),z.on(()=>this.viewModel.activeWorkflow,"cancel-request",({controller:x})=>{(this.viewModel.hasPendingEdits?this._showDiscardEditsPrompt():this._showGenericCancelPrompt()).then(Q=>Q?x.allow():x.deny())}),z.watch(()=>this.viewModel,x=>{this._featureForm.viewModel=x?.featureFormViewModel??null;this._attachments.viewModel=x?.attachmentsViewModel??null;this._featureTemplates.viewModel=x?.featureTemplatesViewModel??null;this._spinner.viewModel=x?.spinnerViewModel??null;x.showDiscardEditsPrompt=
this._showDiscardEditsPrompt},z.initial),z.watch(()=>this.view,(x,Q)=>{const T=`editor-${this.id}-spinner`;Q?.ui.remove(this._spinner,T);x?.ui.add(this._spinner,{key:T,position:"manual"})},z.initial),z.when(()=>this.supportingWidgetDefaults,x=>{this._featureForm.set(x.featureForm);this._attachments.set(x.attachments);this._featureTemplates.set(x.featureTemplates);this.viewModel.sketchViewModel.set(x.sketch)},z.initial),z.when(()=>this._attachments?.error,x=>this._onAttachmentsError(x)),z.when(()=>
this.viewModel?.failures,x=>{const {messages:Q}=this,[{error:T,retry:W,cancel:aa}]=x;this._prompt={title:Q.errorWarningTitle,message:S.substitute(Q.errorWarningMessageTemplate,{errorMessage:T.message}),context:"warning",actions:{primary:{label:Q.retry,action:()=>{W();this._clearPrompt()}},secondary:{label:Q.ignore,action:()=>{aa();this._clearPrompt()}}}}}),z.watch(()=>this.viewModel?.state,x=>{switch(x){case "awaiting-feature-to-update":case "ready":case "disabled":this._filterText="",this._featureTemplates.filterText=
""}}),z.watch(()=>this.viewModel.featureFormDisabled,x=>this._featureForm.disabled=x)])};A.destroy=function(){this._attachments.destroy();this._featureForm.destroy();this._featureTemplates.destroy()};A.loadDependencies=function(){return d.loadCalciteComponents({accordion:()=>new Promise((x,Q)=>b(["../chunks/calcite-accordion"],x,Q)),"accordion-item":()=>new Promise((x,Q)=>b(["../chunks/calcite-accordion-item"],x,Q)),button:()=>new Promise((x,Q)=>b(["../chunks/calcite-button"],x,Q)),"flow-item":()=>
new Promise((x,Q)=>b(["../chunks/calcite-flow-item"],x,Q)),flow:()=>new Promise((x,Q)=>b(["../chunks/calcite-flow"],x,Q)),icon:()=>new Promise((x,Q)=>b(["../chunks/calcite-icon"],x,Q)),list:()=>new Promise((x,Q)=>b(["../chunks/calcite-list"],x,Q)),loader:()=>new Promise((x,Q)=>b(["../chunks/calcite-loader"],x,Q)),notice:()=>new Promise((x,Q)=>b(["../chunks/calcite-notice"],x,Q)),scrim:()=>new Promise((x,Q)=>b(["../chunks/calcite-scrim"],x,Q))})};A.castVisibleElements=function(x){return{...G,...x,
snappingControlsElements:{...G.snappingControlsElements,...x?.snappingControlsElements}}};A.startCreateWorkflowAtFeatureTypeSelection=function(){O.workflowDeprecation(J,"startCreateWorkflowAtFeatureTypeSelection","startCreateFeaturesWorkflowAtFeatureTypeSelection");return this.viewModel.startCreateWorkflowAtFeatureTypeSelection()};A.startCreateFeaturesWorkflowAtFeatureTypeSelection=function(){return this.viewModel.startCreateFeaturesWorkflowAtFeatureTypeSelection()};A.startCreateWorkflowAtFeatureCreation=
function(x){O.workflowDeprecation(J,"startCreateWorkflowAtFeatureCreation","startCreateFeaturesWorkflowAtFeatureCreation");return this.viewModel.startCreateWorkflowAtFeatureCreation(x)};A.startCreateFeaturesWorkflowAtFeatureCreation=function(x){return this.viewModel.startCreateFeaturesWorkflowAtFeatureCreation(x)};A.startCreateWorkflowAtFeatureEdit=function(x){O.workflowDeprecation(J,"startCreateWorkflowAtFeatureEdit");return this.viewModel.startCreateWorkflowAtFeatureEdit(x)};A.startUpdateWorkflowAtFeatureSelection=
function(){return this.viewModel.startUpdateWorkflowAtFeatureSelection()};A.startUpdateWorkflowAtMultipleFeatureSelection=function(x){return this.viewModel.startUpdateWorkflowAtMultipleFeatureSelection(x)};A.startUpdateWorkflowAtFeatureEdit=function(x){return this.viewModel.startUpdateWorkflowAtFeatureEdit(x)};A.deleteFeatureFromWorkflow=function(){return this.viewModel.deleteFeatureFromWorkflow()};A.cancelWorkflow=function(x){return this.viewModel.cancelWorkflow(x)};A.render=function(){const {viewModel:x}=
this;if(!x)return r.tsx("div",{key:"empty",class:"esri-editor esri-widget esri-widget--panel"});const {state:Q}=x;return r.tsx("div",{key:"base",class:"esri-editor esri-widget esri-widget--panel"},r.tsx("calcite-flow",{key:"flow"},x.pageStack.map(T=>this._renderPage(T,Q)),this._renderPage(x.page,Q)),this._renderPrompt())};A._renderPage=function(x,Q){switch(x){case "ready":return this._renderLanding(Q);case "awaiting-feature-creation-info":return this._renderTemplates(Q);case "creating-features":return this._renderAttributeEditing(Q);
case "editing-new-feature":case "editing-existing-feature":return this._renderAttributeEditing(Q);case "awaiting-update-feature-candidate":return this._renderFeatureList(Q);case "adding-attachment":return this._renderAttachmentAdding(Q);case "editing-attachment":return this._renderAttachmentEditing(Q)}return r.tsx("div",null)};A._renderTemplates=function(x){const {EditorPanel:Q,headingLevel:T,messages:W,_onBack:aa}=this;return r.tsx(Q,{active:this._isPanelActive(x),key:"templates-panel",handleBack:aa,
heading:W.selectTemplate,headingLevel:T},r.tsx("div",{key:"feature-templates",class:"esri-editor__panel-content"},this._featureTemplates.render()))};A._renderAttributeEditing=function(x){const {activeWorkflow:Q,EditorPanel:T,messages:W,messagesCommon:aa,headingLevel:Y,_onBack:Z,viewModel:R}=this;if(!Q)return null;var V=Q.type,ba="activeWorkflow"in Q&&Q.activeWorkflow,ea=ba?ba.type:null,ha=R.featureFormViewModel;ba=ba&&!ba.hasPendingEdits||"update"===V&&!Q.hasPendingEdits||R.syncing||ha.updating;const la=
"update"===V?W.editFeature:W.createFeatures,ia="update"===V&&"create-features"!==ea?aa.update:aa.create;ea="create-features"===V&&"create-new"===Q.createFeatureState;V="create-features"===V?Q.numPendingFeatures:0;V=1<V?S.substitute(W.createFeaturesTemplate,{numFeatures:V}):ia;const na=Q.shouldShowAttachments&&!R.featureFormViewModel.activeRelationshipInput;ha=ha.inputs.every(ma=>!ma.visible)&&!na?this._renderMessage(S.substitute(W.clickToFinishTemplate,{button:ia})):r.tsx("div",{key:"panel-content-section",
class:"esri-editor__panel-content__section"},this._renderNotices(Q),r.tsx("div",{class:"esri-editor__panel-content__section__group"},this._featureForm.render(),na&&r.tsx("div",{key:"attachments"},r.tsx(l.Heading,{level:l.incrementHeadingLevel(Y)},W.attachments),this._attachments.render())));return r.tsx(T,{active:this._isPanelActive(x),key:"attribute-editing-panel",heading:la,headingLevel:Y,handleBack:Z},r.tsx("div",{key:"panel-content",class:this.classes("esri-editor__panel-content",{["esri-editor__panel-content__scrim-container"]:ea})},
ha,ea&&r.tsx("calcite-scrim",null)),this._renderFooterActions([{clickHandler:this._onSave,disabled:ba,label:V,type:"primary"},R.shouldShowDeleteButton?{...this._deleteButtonCommonInfo,clickHandler:this._onDelete,disabled:R.syncing,label:aa.delete}:null]))};A._renderNotices=function(x){return[this._renderOwnerAdminNotice(x),this._renderInvalidFormTemplateNotice(x),this._renderInvalidDateFieldNotice(x)]};A._renderOwnerAdminNotice=function(x){return x?.reliesOnOwnerAdminPrivileges&&this._renderNotice(this.messages.ownerAdminNotice)};
A._renderInvalidFormTemplateNotice=function(x){return x?.hasInvalidFormTemplate&&this._renderNotice(this.messages.formFieldUpdateError,{icon:"exclamation-mark-triangle"})};A._renderInvalidDateFieldNotice=function(x){return x?.hasUnsupportedFields&&this._renderNotice(this.messages.formFieldUnsupportedUpdateError,{icon:"exclamation-mark-triangle"})};A._renderNotice=function(x,Q){return r.tsx("calcite-notice",{open:!0,scale:"s",class:"esri-editor__notice",...Q},r.tsx("div",{slot:"message"},x))};A._renderCustomTemplateGroupContent=
function(x){const {messages:Q,viewModel:T}=this;let W=null;x.group.items.some(aa=>{T.itemHasUnsupportedFields(aa)?W=Q.formFieldUnsupportedCreateError:T.itemHasInvalidFormTemplate(aa)&&(W=Q.formFieldCreateError);return W});return W?this._renderNotice(W,{icon:"exclamation-mark-triangle"}):null};A._renderAttachmentAdding=function(x){const {_attachments:Q,EditorPanel:T,_onBack:W,headingLevel:aa,messages:Y,messagesCommon:Z}=this;return r.tsx(T,{active:this._isPanelActive(x),key:"attachment-adding-panel",
heading:Y.addAttachment,headingLevel:aa,handleBack:W},r.tsx("div",{key:"attachments",class:"esri-editor__panel-content"},Q.render()),this._renderFooterActions([{label:Q.submitting?Z.cancel:Z.add,disabled:Q.submitting||!Q.selectedFile,type:"primary",clickHandler:this._onAttachmentAdd}]))};A._renderAttachmentEditing=function(x){const {_attachments:Q,EditorPanel:T,_onBack:W,activeWorkflow:aa,headingLevel:Y,messages:Z,messagesCommon:R}=this;return aa?r.tsx(T,{active:this._isPanelActive(x),key:"attachment-editing-panel",
heading:Z.editAttachment,headingLevel:Y,handleBack:W},r.tsx("div",{key:"attachments",class:"esri-editor__panel-content"},Q.render()),aa.shouldAllowAttachmentEditing?this._renderFooterActions([{label:R.update,disabled:Q.submitting||!Q.selectedFile,type:"primary",clickHandler:this._onAttachmentUpdate},{...this._deleteButtonCommonInfo,clickHandler:this._onAttachmentDelete,disabled:Q.submitting,label:R.delete}]):void 0):null};A._renderMessage=function(x){return r.tsx("div",{key:"panel-content-message",
class:"esri-editor__panel-content__message"},x)};A._renderFooterActions=function(x){return r.tsx("div",{key:"footer-actions",slot:"footer",class:"esri-editor__actions"},x.filter(w.isSome).map(({type:Q,disabled:T,class:W,clickHandler:aa,label:Y,...Z},R)=>r.tsx("calcite-button",{key:`action-${R}`,slot:"footer-actions",class:W,disabled:T??!1,onclick:aa,width:"full",...Z},Y)))};A._renderPrompt=function(){var x=this._prompt;if(!x)return null;const {title:Q,message:T,context:W,actions:aa}=x;var Y=aa.secondary;
let Z;switch(W){case "danger":Z="danger";break;case "info":Z="brand";break;default:Z="neutral"}x=r.tsx("calcite-button",{afterCreate:U,appearance:"solid",key:"prompt-primary-button",kind:Z,onclick:aa.primary.action,scale:"m",width:Y?"half":"full"},aa.primary.label);Y=Y&&r.tsx("calcite-button",{appearance:"outline",key:"prompt-secondary-button",kind:Z,onclick:Y.action,scale:"m",width:"half"},Y.label);return r.tsx("calcite-scrim",{key:"prompt"},r.tsx("div",{class:`${"esri-editor__prompt"}--${W}`},r.tsx("div",
{class:"esri-editor__prompt__header"},r.tsx("calcite-icon",{icon:"exclamation-mark-triangle"}),r.tsx(l.Heading,{class:"esri-editor__prompt__header__heading",level:this.headingLevel},Q)),r.tsx("div",{class:"esri-editor__prompt__message"},T),r.tsx("div",{class:"esri-editor__prompt__divider"}),r.tsx("div",{class:"esri-editor__prompt__actions"},Y,x)))};A._renderLanding=function(x){const {EditorPanel:Q,headingLevel:T,messages:W,viewModel:aa}=this,{canUpdate:Y}=aa,Z=this._featureTemplates.viewModel.numberOfFeatureTemplates,
R=!Y&&0===Z;return r.tsx(Q,{active:this._isPanelActive(x),key:"landing-panel",heading:W.widgetLabel,headingLevel:T},r.tsx("div",{key:"landing-content",class:"esri-editor__panel-content"},Y&&r.tsx("div",{key:"edit-actions",class:"esri-editor__panel-content__section"},this._renderUpdateActions(x)),0<Z&&r.tsx("div",{key:"create-actions",class:"esri-editor__panel-content__section"},this._renderCreateActions()),R&&r.tsx("div",{key:"no-content",class:"esri-editor__panel-content__message"},W.noEditableLayers)),
this._renderFooterHelpMessages())};A._renderFooterHelpMessages=function(){const {activeWorkflow:x,messages:Q,view:T}=this;var W=x?.helpMessage;return(W=W?Q["3d"===T?.type?"helpMessages3d":"helpMessages2d"]?.[W]:null)?r.tsx("div",{key:"footer-actions",slot:"footer",class:"esri-editor__help-message"},W):null};A._renderUpdateActions=function(x){const {messages:Q,messagesCommon:T}=this,W={id:"select",label:T.select};return r.tsx("div",{key:"update-actions"},r.tsx(l.Heading,{level:l.incrementHeadingLevel(this.headingLevel)},
Q.editFeatures),r.tsx("calcite-list",{selectionMode:"single",selectionAppearance:"border"},h.renderItem({grouped:!1,item:W,selectedItem:"awaiting-feature-to-update"===x?W:void 0,renderIcon:this._renderSelectIcon,onItemSelect:this._onToggleUpdateWorkflow})))};A._renderCreateActions=function(){const {_featureTemplates:x,headingLevel:Q,messages:T}=this;return r.tsx("div",{key:"create-actions"},r.tsx(l.Heading,{level:l.incrementHeadingLevel(Q)},T.createFeatures),r.tsx("div",{key:"templates",class:"esri-editor__feature-templates-container"},
x.render()))};A._renderTemplateLabel=function(x){return x.label};A._renderTemplateDescription=function(x){x=this._getUploadForTemplateItem(x);if(!x)return null;const {messages:Q}=this;switch(x.state){case "pending":return Q?.uploadPending;case "error":return Q?.uploadError;default:return null}};A._renderTemplateContentEnd=function(x){const Q=this._getUploadForTemplateItem(x),T=r.tsx("calcite-icon",{key:"upload-icon",class:"esri-editor__template-item-content-end",icon:"upload-to"});if(!Q)return x.supportsUpload?
T:null;switch(Q.state){case "success":return r.tsx("calcite-icon",{key:"success-icon",class:this.classes("esri-editor__template-item-content-end","esri-editor__template-item-content-end--success"),icon:"check"});case "error":return r.tsx("calcite-icon",{key:"error-icon",class:this.classes("esri-editor__template-item-content-end","esri-editor__template-item-content-end--error"),icon:"exclamation-mark-circle-f"});case "pending":return r.tsx("calcite-loader",{class:"esri-editor__template-item-loader",
inline:!0,key:"loader",label:"",scale:"s",type:"indeterminate"});case "canceled":case "default":return T}};A._getUploadForTemplateItem=function(x){var Q=this.activeWorkflow;if("create-features"!==Q?.type)return null;({data:Q}=Q);const {creationInfo:T,upload:W}=Q;return T?.template===x.template&&T?.layer===x.layer?W:null};A._renderFeatureList=function(x){const {EditorPanel:Q,_onBack:T,headingLevel:W,messages:aa,messagesTemplates:Y,viewModel:{activeWorkflow:Z,editableItems:R}}=this;if("update"!==Z?.type)return null;
var V=Z.data.candidates;const ba=S.substitute(aa.multipleFeaturesTemplate,{total:V.length}),ea=new Map;let ha=0;V.map(ia=>({label:this._getLabel(ia),id:ia.attributes[ia.layer.objectIdField],data:ia})).filter(ia=>{const {label:na,data:ma}=ia;ia=this._filterText.toLowerCase();const {title:X}=ma.layer,da=R.find(ka=>ka.layer===ma.layer);if(!da)return null;const {attachmentsOnUpdateEnabled:fa,supports:ca}=da;return(ca.includes("update")||ca.includes("delete")||fa)&&(!ia||na?.toLowerCase().includes(ia)||
X?.toLowerCase().includes(ia))}).filter(w.isSome).forEach(ia=>{ha++;const na=ia.data.layer;ea.has(na)?ea.get(na)?.items.push(ia):ea.set(na,{id:`${na.id}`,label:na.title??"",items:[ia]})});V=R.toArray().map(({layer:ia})=>ea.get(ia)).filter(w.isSome);const la=10<ha||0<this._filterText.length;return r.tsx(Q,{active:this._isPanelActive(x),key:"feature-list",heading:ba,headingLevel:W,handleBack:T},r.tsx("div",{key:"feature-list",class:"esri-editor__panel-content"},r.tsx("div",{class:"esri-editor__panel-content__section"},
h.ItemList({enableListScroll:!1,filterEnabled:la,filterText:this._filterText,id:this.id,items:V,messages:{filterPlaceholder:Y.filterPlaceholder,noItems:Y.noItems,noMatches:Y.noMatches},onFilterChange:ia=>this._filterText=ia,onItemMouseEnter:ia=>this.viewModel.selectFeature(ia.data),onItemMouseLeave:()=>this.viewModel.selectFeature(null),onItemSelect:ia=>this.viewModel.selectFeature(ia.data,!0)}))))};A._isPanelActive=function(x){return this.viewModel.state===x};A._renderSettings=function(){const x=
this.visibleElements,Q=x.snappingControls,T=x.sketchTooltipControls;return Q||T?r.tsx("calcite-accordion",{key:"settings",class:"esri-editor__settings",appearance:"transparent"},r.tsx("calcite-accordion-item",{heading:this.messagesCommon?.settings,iconStart:"gear"},T&&r.tsx(M.SketchTooltipControls,{tooltipOptions:this.tooltipOptions}),Q&&r.tsx(q,{snappingOptions:this.snappingOptions,view:this.view,visibleElements:x.snappingControlsElements,afterCreate:W=>W.layerListOpen=!1}))):null};A._getLabel=function(x){var Q=
x.layer;if(!Q)return null;const T=Q.fieldsIndex.get(Q.objectIdField),W=T.alias||T.name;({attributes:x}=x);return(Q=u.getDisplayFieldName(Q))&&x[Q]&&`${x[Q]}`||`${W}: ${x[T.name]}`};A._showPrompt=function({title:x,message:Q,yesLabel:T,noLabel:W}){const aa=P.createResolver(),{view:Y}=this,Z=Y?.focused;this._prompt={title:x,message:Q,context:"danger",actions:{primary:{label:T,action:()=>aa.resolve(!0)},secondary:{label:W,action:()=>aa.resolve(!1)}}};return aa.promise.finally(()=>{this._clearPrompt();
Z&&Y?.focus()})};A._onSave=function(){this.viewModel.saveWorkflow()};A._onDelete=function(){const {messages:x,messagesCommon:Q}=this;this._prompt={title:x.deleteWarningTitle,message:x.deleteWarningMessage,context:"danger",actions:{primary:{label:Q.delete,action:()=>{this.deleteFeatureFromWorkflow();this._clearPrompt()}},secondary:{label:x.keepFeature,action:this._clearPrompt}}}};A._onBack=async function(x){x?.stopPropagation();return this.viewModel.back()};A._onAttachmentAdd=function(){const {activeWorkflow:x}=
this.viewModel;x&&("create-features"===x.type?(this._attachments.addFile(),x.back()):this._attachments.addAttachment().then(()=>x.back()))};A._onAttachmentUpdate=function(){const {activeWorkflow:x}=this.viewModel;x&&("create-features"===x.type?(this._attachments.updateFile(),x.back()):this._attachments.updateAttachment().then(()=>x.back()))};A._onAttachmentDelete=function(){const {messages:x,messagesCommon:Q}=this;this._prompt={title:x.deleteAttachmentWarningTitle,message:x.deleteAttachmentWarningMessage,
context:"danger",actions:{primary:{label:Q.delete,action:this._onAttachmentDeleteConfirm},secondary:{label:x.keepAttachment,action:this._clearPrompt}}}};e._createClass(B,[{key:"_deleteButtonCommonInfo",get:function(){return{appearance:"outline",kind:"danger",type:"primary"}}},{key:"activeWorkflow",get:function(){return this.viewModel.activeWorkflow}},{key:"allowedWorkflows",get:function(){return this.viewModel.allowedWorkflows},set:function(x){this.viewModel.allowedWorkflows=x}},{key:"useDeprecatedCreateWorkflow",
get:function(){return this.viewModel.useDeprecatedCreateWorkflow},set:function(x){this.viewModel.useDeprecatedCreateWorkflow=x}},{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(x){this._overrideIfSome("label",x)}},{key:"labelOptions",get:function(){return this.viewModel.labelOptions},set:function(x){this.viewModel.labelOptions=x}},{key:"layerInfos",get:function(){return this.viewModel.layerInfos},set:function(x){this.viewModel.layerInfos=x}},{key:"snappingOptions",
get:function(){return this.viewModel.snappingOptions},set:function(x){this.viewModel.snappingOptions=x}},{key:"tooltipOptions",get:function(){return this.viewModel.tooltipOptions},set:function(x){this.viewModel.tooltipOptions=x}},{key:"view",get:function(){return this.viewModel.view},set:function(x){this.viewModel.view=x}}]);return B}(F.HandleOwnerMixin(y));c.__decorate([t.property()],m.prototype,"_featureForm",void 0);c.__decorate([t.property()],m.prototype,"_attachments",void 0);c.__decorate([t.property()],
m.prototype,"_featureTemplates",void 0);c.__decorate([t.property()],m.prototype,"_filterText",void 0);c.__decorate([t.property()],m.prototype,"_prompt",void 0);c.__decorate([t.property()],m.prototype,"_spinner",void 0);c.__decorate([t.property()],m.prototype,"_deleteButtonCommonInfo",null);c.__decorate([t.property({readOnly:!0})],m.prototype,"activeWorkflow",null);c.__decorate([t.property()],m.prototype,"allowedWorkflows",null);c.__decorate([t.property()],m.prototype,"useDeprecatedCreateWorkflow",
null);c.__decorate([t.property()],m.prototype,"headingLevel",void 0);c.__decorate([t.property()],m.prototype,"iconClass",void 0);c.__decorate([t.property()],m.prototype,"label",null);c.__decorate([t.property()],m.prototype,"labelOptions",null);c.__decorate([t.property()],m.prototype,"layerInfos",null);c.__decorate([t.property(),N.messageBundle("esri/widgets/Editor/t9n/Editor")],m.prototype,"messages",void 0);c.__decorate([t.property(),N.messageBundle("esri/t9n/common")],m.prototype,"messagesCommon",
void 0);c.__decorate([t.property(),N.messageBundle("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],m.prototype,"messagesTemplates",void 0);c.__decorate([t.property()],m.prototype,"snappingOptions",null);c.__decorate([t.property()],m.prototype,"tooltipOptions",null);c.__decorate([t.property()],m.prototype,"supportingWidgetDefaults",void 0);c.__decorate([t.property()],m.prototype,"view",null);c.__decorate([t.property(),E.vmEvent(["workflow-cancel","workflow-commit"])],m.prototype,"viewModel",
void 0);c.__decorate([t.property()],m.prototype,"visibleElements",void 0);c.__decorate([D.cast("visibleElements")],m.prototype,"castVisibleElements",null);c.__decorate([H.accessibleHandler()],m.prototype,"_onSave",null);c.__decorate([H.accessibleHandler()],m.prototype,"_onDelete",null);c.__decorate([H.accessibleHandler()],m.prototype,"_onBack",null);c.__decorate([H.accessibleHandler()],m.prototype,"_onAttachmentAdd",null);c.__decorate([H.accessibleHandler()],m.prototype,"_onAttachmentUpdate",null);
c.__decorate([H.accessibleHandler()],m.prototype,"_onAttachmentDelete",null);return m=c.__decorate([g.subclass("esri.widgets.Editor")],m)});
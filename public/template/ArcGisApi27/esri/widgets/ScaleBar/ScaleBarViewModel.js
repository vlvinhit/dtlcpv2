// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../core/Accessor ../../core/screenUtils ../../core/unitUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../geometry/support/geodesicUtils ../../geometry/support/normalizeUtils ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ../../geometry/support/WKIDUnitConversion ../../geometry/SpatialReference ../../geometry/Polyline ../../geometry/Point".split(" "),
function(x,p,l,D,t,m,u,K,L,M,E,y,F,z,G,v,H,I,A){function B({state:{paddedViewState:n},spatialReference:g,width:h}){return g.isWrappable&&n.worldScreenWidth<h}function C(n,g){const {x:h,y:b}=n?G.webMercatorToGeographic(g,!0):g;return[h,b]}l=function(n){function g(b){b=n.call(this,b)||this;b.scaleComputedFrom=t.createScreenPoint();b.view=null;return b}x._inherits(g,n);var h=g.prototype;h.getScaleBarProperties=function(b,a){if("disabled"===this.state||isNaN(b)||!a||!this.view)return null;const c=this._getDistanceInMeters();
return null==c?null:this._getScaleBarProps(b,c,a)};h._getDistanceInMeters=function(){const {state:b,spatialReference:a}=this.view;if(!z.isValid(a))return null;var {isGeographic:c}=a;const {isWebMercator:f,wkt:k}=a;var d=f||(k?.includes("WGS_1984_Web_Mercator")??!1);if(!c&&!d){var e=b.extent.width;{const {wkid:w,wkt:q}=a;null!=w&&null!=v[w]?d=v.values[v[w]]:null!=q?(d=q.lastIndexOf(",")+1,c=q.lastIndexOf("]]"),d=parseFloat(q.substring(d,c))):d=1}return e*d}const [r,J]=this._getScaleMeasuringPoints();
c=d||c&&!y.isSupported(a)?H.WGS84:a;d=new I({paths:[[C(d,r),C(d,J)]],spatialReference:c});d=F.straightLineDensify(d,10);try{[e]=y.geodesicLengths([d],"meters")}catch{return null}return e};h._getScaleMeasuringPoints=function(){var b=this.view;const {width:a,height:c,position:f,spatialReference:k}=b;if(B(b)){b=z.getInfo(k);var {valid:d}=b;b=new A(d[0],0,k);d=new A(d[1],0,k);return[b,d]}var e=this.scaleComputedFrom.y-f[1];e>c?e=c:0>e&&(e=0);d=t.createScreenPoint(0,e);e=t.createScreenPoint(a,e);d=b.toMap(d);
b=b.toMap(e);return[d,b]};h._getScaleBarProps=function(b,a,c){var f=this.view;f=B(f)?f.state.paddedViewState.worldScreenWidth:f.width;a=b*a/f;if(.001>a)return null;a:{switch(c){case "metric":c=1E3<a?{distance:m.convertUnit(a,"meters","kilometers"),unit:"kilometer"}:1<a?{distance:a,unit:"meter"}:.01<a?{distance:m.convertUnit(a,"meters","centimeters"),unit:"centimeter"}:{distance:m.convertUnit(a,"meters","millimeters"),unit:"millimeter"};break a;case "imperial":case "non-metric":c=1609.344<a?{distance:m.convertUnit(a,
"meters","miles"),unit:"mile"}:.3048<a?{distance:m.convertUnit(a,"meters","feet"),unit:"foot"}:{distance:m.convertUnit(a,"meters","inches"),unit:"inch"};break a}c=void 0}const {distance:k,unit:d}=c;c=k;for(a=0;1<=c;)c/=10,a++;f=.5<c?{min:.5,max:1}:.2<c?{min:.2,max:.5}:{min:.1,max:.2};const {min:e,max:r}=f;f=r/c>=c/e?e:r;return{length:f/c*b,value:10**a*f,unit:d}};x._createClass(g,[{key:"state",get:function(){return this.view?.ready&&"2d"===this.view?.type?"ready":"disabled"}}]);return g}(D);p.__decorate([u.property()],
l.prototype,"scaleComputedFrom",void 0);p.__decorate([u.property({readOnly:!0})],l.prototype,"state",null);p.__decorate([u.property()],l.prototype,"view",void 0);return l=p.__decorate([E.subclass("esri.widgets.Scalebar.ScaleBarViewModel")],l)});
// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Legend/LegendViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../intl ../../core/Accessor ../../core/Collection ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./support/ActiveLayerInfo ../../intl/locale".split(" "),function(y,L,M,x,v,I,G,N,S,g,n,a,e){const m=v.ofType(a),z="esri.layers.BuildingSceneLayer esri.layers.CSVLayer esri.layers.FeatureLayer esri.layers.GeoJSONLayer esri.layers.GeoRSSLayer esri.layers.GroupLayer esri.layers.HeatmapLayer esri.layers.ImageryLayer esri.layers.ImageryTileLayer esri.layers.MapImageLayer esri.layers.OGCFeatureLayer esri.layers.PointCloudLayer esri.layers.StreamLayer esri.layers.SceneLayer esri.layers.SubtypeGroupLayer esri.layers.TileLayer esri.layers.VoxelLayer esri.layers.WFSLayer esri.layers.WMSLayer esri.layers.WMTSLayer esri.layers.WCSLayer esri.layers.LinkChartLayer esri.layers.knowledgeGraph.KnowledgeGraphSublayer".split(" "),
k=["view.basemapView.baseLayerViews","view.groundView.layerViews","view.layerViews","view.basemapView.referenceLayerViews"];M=function(r){function H(l){l=r.call(this,l)||this;l._layerViewByLayerId={};l._layerInfosByLayerViewId={};l._activeLayerInfosByLayerViewId={};l._activeLayerInfosWithNoParent=new v;l.activeLayerInfos=new m;l.basemapLegendVisible=!1;l.groundLegendVisible=!1;l.hideLayersNotInCurrentView=!1;l.keepCacheOnDestroy=!1;l.respectLayerVisibility=!0;l.layerInfos=[];l.view=null;return l}
y._inherits(H,r);var c=H.prototype;c.initialize=function(){this.addHandles(I.watch(()=>this.view,()=>this._viewHandles(),I.initial),"view");this.addHandles(e.onLocaleChange(()=>this._refresh()))};c.destroy=function(){this._destroyViewActiveLayerInfos();this.view=null};c._viewHandles=function(){this.removeHandles("state");this.view&&this.addHandles(I.watch(()=>this.state,()=>this._stateHandles(),I.initial),"state")};c._stateHandles=function(){this._resetAll();"ready"===this.state&&this._watchPropertiesAndAllLayerViews()};
c._resetAll=function(){this.removeHandles(["all-layer-views","legend-properties"]);this._destroyViewActiveLayerInfos();this.activeLayerInfos.removeAll()};c._destroyViewActiveLayerInfos=function(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,this)};c._destroyViewActiveLayerInfo=function(l){this.removeHandles(l);const u=this._activeLayerInfosByLayerViewId[l];delete this._activeLayerInfosByLayerViewId[l];u&&u.parent&&u.parent.children.remove(u)};c._watchPropertiesAndAllLayerViews=
function(){var {view:l}=this;l&&({allLayerViews:l}=l,l.length&&this._refresh(),this.addHandles(l.on("change",u=>this._allLayerViewsChangeHandle(u)),"all-layer-views"),this.addHandles(I.watch(()=>[this.layerInfos,this.basemapLegendVisible,this.groundLegendVisible],()=>this._propertiesChangeHandle()),"legend-properties"))};c._allLayerViewsChangeHandle=function(l){l.removed.forEach(u=>this._destroyViewActiveLayerInfo(u.uid));this._refresh()};c._propertiesChangeHandle=function(){this._destroyViewActiveLayerInfos();
this._refresh()};c._refresh=function(){this._layerInfosByLayerViewId={};this.activeLayerInfos.removeAll();this._generateLayerViews().filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,this).forEach(this._generateActiveLayerInfo,this);this._sortActiveLayerInfos(this.activeLayerInfos)};c._sortActiveLayerInfos=function(l){const u=this.view;if(!(2>l.length)&&u){var J=[];l.forEach(q=>{if(!q.parent){var d=q.layer.parent;(d=(d=d&&"uid"in d&&this._layerViewByLayerId[d.uid])&&
this._activeLayerInfosByLayerViewId[d.uid])&&l.includes(d)&&(J.push(q),q.parent=d,d.children.add(q),this._sortActiveLayerInfos(d.children))}});l.removeMany(J);var O={};u.allLayerViews.forEach((q,d)=>O[q.layer.uid]=d);l.sort((q,d)=>(O[d.layer.uid]||0)-(O[q.layer.uid]||0))}};c._generateLayerViews=function(){const l=[];k.filter(this._filterLayerViews,this).map(this.get,this).filter(u=>null!=u).forEach(this._collectLayerViews("layerViews",l));return l};c._filterLayerViews=function(l){const u=!this.groundLegendVisible&&
"view.groundView.layerViews"===l;return!(!this.basemapLegendVisible&&("view.basemapView.baseLayerViews"===l||"view.basemapView.referenceLayerViews"===l))&&!u};c._collectLayerViews=function(l,u){const J=O=>{O&&O.forEach(q=>{u.push(q);J(q[l])});return u};return J};c._filterLayerViewsByLayerInfos=function(l){const u=this.layerInfos;return u&&u.length?u.some(J=>this._hasLayerInfo(J,l)):!0};c._hasLayerInfo=function(l,u){const J=this._isLayerUIDMatching(l.layer,u.layer.uid);J&&(this._layerInfosByLayerViewId[u.uid]=
l);return J};c._isLayerUIDMatching=function(l,u){return l&&(l.uid===u||this._hasLayerUID(l.layers,u))};c._hasLayerUID=function(l,u){return l&&l.some(J=>this._isLayerUIDMatching(J,u))};c._isLayerViewSupported=function(l){return z.includes(l.layer.declaredClass)?(this._layerViewByLayerId[l.layer.uid]=l,!0):!1};c._generateActiveLayerInfo=function(l){this._isLayerActive(l)?this._buildActiveLayerInfo(l):(this.removeHandles(l.uid),this.addHandles(I.watch(()=>[l.legendEnabled,l.layer?.legendEnabled],()=>
this._layerActiveHandle(l)),l.uid))};c._layerActiveHandle=function(l){this._isLayerActive(l)&&(this.removeHandles(l.uid),this._buildActiveLayerInfo(l))};c._isLayerActive=function(l){return this.respectLayerVisibility?l.legendEnabled&&l.get("layer.legendEnabled"):!0};c._buildActiveLayerInfo=function(l){const u=l.layer,J=l.uid;var O=this._layerInfosByLayerViewId[J];let q=this._activeLayerInfosByLayerViewId[J];q||(q=new a({layer:u,layerView:l,title:O&&void 0!==O.title&&O.layer.uid===u.uid?O.title:u.title,
view:this.view,respectLayerVisibility:this.respectLayerVisibility,hideLayersNotInCurrentView:this.hideLayersNotInCurrentView,keepCacheOnDestroy:this.keepCacheOnDestroy,sublayerIds:O&&O.sublayerIds||[]}),this._activeLayerInfosByLayerViewId[J]=q);q.parent=this._activeLayerInfosByLayerViewId[(u.parent&&"uid"in u.parent?this._layerViewByLayerId[u.parent?.uid]:null)?.uid];if(!this.hasHandles(J)){O=I.watch(()=>u.title,p=>this._titleHandle(p,q));var d=I.watch(()=>[u.opacity,"renderer"in u&&u.renderer,"pointSymbol"in
u&&u.pointSymbol,"lineSymbol"in u&&u.lineSymbol,"polygonSymbol"in u&&u.polygonSymbol],()=>this._constructLegendElements(q)),h=I.when(()=>!0===this.view?.stationary,()=>this._scaleHandle(q),I.initial);const P=I.watch(()=>l._effectiveRenderer,()=>this._constructLegendElements(q)),B=I.watch(()=>"effect"in u&&u.effect,()=>this._constructLegendElements(q));O=[O,d,h,P,B];this.respectLayerVisibility&&(d=I.watch(()=>l.legendEnabled,p=>this._legendEnabledHandle(p,q)),h=I.watch(()=>u.legendEnabled,p=>this._legendEnabledHandle(p,
q)),O.push(d,h));this.addHandles(O,J)}q.isScaleDriven||this._constructLegendElements(q);this._addActiveLayerInfo(q)};c._titleHandle=function(l,u){u.title=l;this._constructLegendElements(u)};c._legendEnabledHandle=function(l,u){l?this._addActiveLayerInfo(u):this._removeActiveLayerInfo(u)};c._scaleHandle=function(l){(l.isScaleDriven||l.hideLayersNotInCurrentView)&&this._constructLegendElements(l)};c._addActiveLayerInfo=function(l){const {layerView:u,layer:J}=l;if(this._isLayerActive(u)&&!this.activeLayerInfos.includes(l)){var O=
l.parent;O?(O.children.includes(l)||O.children.push(l),this._sortActiveLayerInfos(O.children)):(O=this.layerInfos?.some(q=>q.layer.uid===J.uid),J.parent&&"uid"in J.parent&&!O?this._activeLayerInfosWithNoParent.add(l):(this.activeLayerInfos.add(l),this._sortActiveLayerInfos(this.activeLayerInfos)));if(this._activeLayerInfosWithNoParent.length){const q=[];this._activeLayerInfosWithNoParent.forEach(d=>{var h=d.layer.parent;if(h=this._activeLayerInfosByLayerViewId[(h&&"uid"in h?this._layerViewByLayerId[h?.uid]:
null)?.uid])q.push(d),d.parent=h});q.length&&(this._activeLayerInfosWithNoParent.removeMany(q),q.forEach(d=>this._addActiveLayerInfo(d)))}}};c._removeActiveLayerInfo=function(l){const u=l.parent;u?u.children.remove(l):this.activeLayerInfos.remove(l)};c._constructLegendElements=function(l){const u=l.layer;"featureCollections"in u&&u.featureCollections?l.buildLegendElementsForFeatureCollections(u.featureCollections):"featureReduction"in u&&u.featureReduction&&"renderer"in u.featureReduction&&("binning"===
u.featureReduction.type||"cluster"===u.featureReduction.type)?l.buildLegendElementsForFeatureReduction(u.featureReduction):"renderer"in u&&u.renderer&&!("sublayers"in u)?l.buildLegendElementsForRenderer(u.renderer):"url"in u&&u.url?l.buildLegendElementsForTools():l.children.forEach(J=>this._constructLegendElements(J))};y._createClass(H,[{key:"state",get:function(){return this.get("view.ready")?"ready":"disabled"}}]);return H}(x);L.__decorate([G.property({type:m})],M.prototype,"activeLayerInfos",void 0);
L.__decorate([G.property()],M.prototype,"basemapLegendVisible",void 0);L.__decorate([G.property()],M.prototype,"groundLegendVisible",void 0);L.__decorate([G.property()],M.prototype,"hideLayersNotInCurrentView",void 0);L.__decorate([G.property()],M.prototype,"keepCacheOnDestroy",void 0);L.__decorate([G.property()],M.prototype,"respectLayerVisibility",void 0);L.__decorate([G.property()],M.prototype,"layerInfos",void 0);L.__decorate([G.property({readOnly:!0})],M.prototype,"state",null);L.__decorate([G.property()],
M.prototype,"view",void 0);return M=L.__decorate([n.subclass("esri.widgets.Legend.LegendViewModel")],M)})},"esri/widgets/Legend/support/ActiveLayerInfo":function(){define("require ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Color ../../../intl ../../../kernel ../../../request ../../../symbols ../../../core/Accessor ../../../core/arrayUtils ../../../core/Collection ../../../core/jsonMap ../../../core/Logger ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/screenUtils ../../../core/urlUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/PropertyOrigin ../../../layers/effects/EffectView ../../../layers/effects/jsonUtils ../../../layers/support/ExportImageParameters ../../../layers/support/fieldUtils ../../../layers/support/layerUtils ../../../layers/support/rasterFormats/pixelRangeUtils ../../../renderers/support/jsonUtils ../../../renderers/support/rendererConversion ../../../renderers/visualVariables/support/SizeVariableLegendOptions ../../../symbols/support/cimSymbolUtils ../../../symbols/support/previewUtils ../../../symbols/support/renderUtils ../../../symbols/support/symbolUtils ../../../symbols/support/utils ./clusterUtils ./colorRampUtils ./heatmapRampUtils ./relationshipRampUtils ./sizeRampUtils ./utils ../../smartMapping/support/utils ../../../symbols/SimpleMarkerSymbol ../../../symbols/SimpleFillSymbol ../../../intl/messages ../../../intl/substitute".split(" "),
function(y,L,M,x,v,I,G,N,S,g,n,a,e,m,z,k,r,H,c,l,u,J,O,q,d,h,P,B,p,E,K,R,X,W,f,D,C,w,F,U,Z,fa,ca,ka,na,ia,Y){function ha(sa){return"esri.renderers.SimpleRenderer"===sa.declaredClass}function la(sa){return"esri.renderers.ClassBreaksRenderer"===sa.declaredClass}function oa(sa){return"esri.renderers.UniqueValueRenderer"===sa.declaredClass}function ta(sa){return"esri.renderers.HeatmapRenderer"===sa.declaredClass}function ua(sa){return"esri.renderers.PointCloudClassBreaksRenderer"===sa.declaredClass}function wa(sa){return"esri.renderers.PointCloudStretchRenderer"===
sa.declaredClass}function ya(sa){return"esri.renderers.PointCloudUniqueValueRenderer"===sa.declaredClass}function Aa(sa){return"esri.renderers.DotDensityRenderer"===sa.declaredClass}function Da(sa){return"esri.renderers.PieChartRenderer"===sa.declaredClass}function Ia(sa){return"esri.layers.SubtypeGroupLayer"===sa.declaredClass}function Ja(sa){return"esri.layers.MapImageLayer"===sa.declaredClass}function $a(sa){sa="authoringInfo"in sa?sa?.authoringInfo:null;return"univariate-color-size"===sa?.type&&
"above-and-below"===sa?.univariateTheme}async function Ba(sa,Ca){const da=await ia.fetchMessageBundle("esri/widgets/Legend/t9n/Legend");"previewTemplateAriaLabel"!==sa||Ca||(sa="previewAriaLabel");return Y.substitute(da[sa],{label:Ca})}const Oa=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,ab=new a.JSONMap({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),Pa=new ka({size:6,outline:{color:[128,
128,128,.5],width:.5}}),bb=new na({style:"solid"}),cb=new ka({style:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15",size:15,outline:{width:1,color:[85,85,85,1]}});let Ea={};v=function(sa){function Ca(b){b=sa.call(this,b)||this;b._hasColorRamp=!1;b._hasOpacityRamp=!1;b._hasSizeRamp=!1;b._webStyleSymbolCache=new Map;b._dotDensityUrlCache=new Map;b._scaleDrivenSizeVariable=null;b._hasClusterSizeVariable=!1;b.children=new n;b.layerView=null;b.layer=null;b.legendElements=[];b.parent=null;b.hideLayersNotInCurrentView=
!1;b.keepCacheOnDestroy=!1;b.respectLayerVisibility=!0;b.sublayerIds=[];b.title=null;b.view=null;return b}L._inherits(Ca,sa);var da=Ca.prototype;da.initialize=function(){const b=()=>this.notifyChange("ready");this.addHandles([z.on(()=>this.children,"change",t=>{const {added:A,removed:Q}=t;A.forEach(T=>{const V=`activeLayerInfo-ready-watcher-${T.layer.uid}`;this.addHandles(z.watch(()=>T.ready,b,z.initial),V)});Q.forEach(T=>this.removeHandles(T.layer.uid));b()})]);this.keepCacheOnDestroy||(Ea={})};
da.destroy=function(){this._scaleDrivenSizeVariable=this._dotDensityUrlCache=this._webStyleSymbolCache=null;this.keepCacheOnDestroy||(Ea=null)};da.buildLegendElementsForFeatureCollections=async function(b){if(this.hideLayersNotInCurrentView&&!await this._isLayerInCurrentView())this.legendElements=[],this.notifyChange("ready");else{b=Array.from(b,t=>{if(P.isFeatureLayer(t))return this._getRendererLegendElements(t.renderer,{title:t.title});if(t.featureSet&&t.featureSet.features.length){var A=t.layerDefinition,
Q=A&&A.drawingInfo;Q=Q&&p.fromJSON(Q.renderer);A=ab.read(A.geometryType);return Q?this._getRendererLegendElements(Q,{title:t.name,geometryType:A}):(e.getLogger(this).warn("drawingInfo not available!"),null)}return null});try{const t=[];await m.eachAlways(b).then(A=>{A.forEach(({value:Q})=>Q&&t.push(...Q))});this.legendElements=t;this.notifyChange("ready")}catch(t){e.getLogger(this).warn("error while building legend for layer!",t)}}};da.buildLegendElementsForRenderer=async function(b){try{this.legendElements=
(this.hideLayersNotInCurrentView?await this._isLayerInCurrentView():1)?await this._getRendererLegendElements(b):[],this.notifyChange("ready")}catch(t){e.getLogger(this).warn("error while building legend for layer!",t)}};da.buildLegendElementsForFeatureReduction=async function(b){try{this.legendElements=(this.hideLayersNotInCurrentView?await this._isLayerInCurrentView():1)?await this._getLegendElementsForFeatureReduction(b):[],this.notifyChange("ready")}catch(t){e.getLogger(this).warn("error while building legend for layer!",
t)}};da.buildLegendElementsForTools=async function(){const b=this.layer;if("esri.layers.VoxelLayer"===b.declaredClass)this._constructLegendElementsForVoxellayer();else if("esri.layers.WMTSLayer"===b.declaredClass)this._constructLegendElementsForWMTSlayer();else if("esri.layers.WMSLayer"===b.declaredClass)await this._constructLegendElementsForWMSSublayers();else if("esri.layers.BuildingSceneLayer"===b.declaredClass)await this._constructLegendElementsForBuildingSceneLayer();else if(Ja(b)||"esri.layers.TileLayer"===
b.declaredClass||Ia(b))await this._constructLegendElementsForSublayers();else{this.removeHandles("imageryLayers-watcher");var t="default";if("esri.layers.ImageryLayer"===b.declaredClass){t=b?.rasterFunction?.functionName||"default";const A=b.bandIds?.length?b.bandIds.join(""):"###";t=t+"_"+A}await this._getLegendLayers(`${b.uid}-${t}`).then(async A=>{this.legendElements=[];this.notifyChange("ready");A=A.map(async Q=>{if("esri.layers.ImageryLayer"===b.declaredClass||"esri.layers.ImageryTileLayer"===
b.declaredClass){const T=z.watch(()=>["renderingRule"in b&&b.rasterFunction,b.bandIds],()=>m.debounce(async()=>{Ea["default"]=null;b.renderer?await this.buildLegendElementsForRenderer(b.renderer):await this.buildLegendElementsForTools()})());this.addHandles(T,"imageryLayers-watcher")}(Q=this._generateSymbolTableElementForLegendLayer(Q))&&Q.infos.length&&("esri.layers.ImageryLayer"===b.declaredClass&&(Q.title=b.title),this.legendElements.push(Q));this.notifyChange("ready")});await m.eachAlways(A)}).catch(A=>
{e.getLogger(this).warn("Request to server for legend has failed!",A)})}};da._isLayerInCurrentView=async function(){const b=this.layer,t=this.layerView,A=t&&"createQuery"in t&&"queryFeatureCount"in t;if(!(A||t&&"createQuery"in b&&"queryFeatureCount"in b))return!0;await z.whenOnce(()=>!t.updating);const Q=A?"createQuery"in t&&t.createQuery():"createQuery"in b&&b.createQuery();if(!Q)return!0;Q.geometry=this.view.extent;return 0!==(A?"queryFeatureCount"in t&&await t.queryFeatureCount(Q):"queryFeatureCount"in
b&&await b.queryFeatureCount(Q))};da._getParentLayerOpacity=function(b){let t=1;const A=b.parent;A&&"uid"in A&&(t=this._getParentLayerOpacity(A));return b.opacity*t};da._isGroupActive=function(){const b=this.children;return b.length?b.some(t=>t.ready):!1};da._isRendererScaleDriven=function(b){return"dot-density"===b.type||Oa.test("valueExpression"in b?b.valueExpression:null)?!0:(b="visualVariables"in b?b.visualVariables:null)?b.some(t=>this._isScaleDrivenSizeVariable(t)):!1};da._isScaleDrivenSizeVariable=
function(b){if(b&&"size"!==b.type)return!1;const t=b.minSize,A=b.maxSize;return"object"===typeof t&&t?this._isScaleDrivenSizeVariable(t):"object"===typeof A&&A?this._isScaleDrivenSizeVariable(A):!!b.expression||Oa.test(b.valueExpression)};da._isLayerScaleDriven=function(b){if("minScale"in b&&0<b.minScale||"maxScale"in b&&0<b.maxScale)return!0;if("sublayers"in b&&b.sublayers)return b.sublayers.some(A=>this._isLayerScaleDriven(A));const t=b.parent;if(!1===b.loaded&&t&&Ja(t)&&"source"in b&&b.source&&
"map-layer"===b.source.type)for(const A of t.sourceJSON.layers??[])if(A.id===b.source.mapLayerId&&(0<A.minScale||0<A.maxScale))return!0;return!1};da._constructLegendElementsForVoxellayer=async function(){this.legendElements=[];this.removeHandles("voxel-style-watcher");this.removeHandles("voxel-current-variable");const b=this.layer;this.addHandles(z.watch(()=>b.currentVariableId,()=>this._constructLegendElementsForVoxellayer()),"voxel-current-variable");this.addHandles(z.watch(()=>b.getVariableStyles(),
()=>this._constructLegendElementsForVoxellayer()),"voxel-style-watcher");var t=b.getVariableStyle(null);const A=[];if(t)if(t.uniqueValues?.length){const T=[];t.uniqueValues.forEach(V=>{V.enabled&&T.push({label:V.label||`${V.value}`,value:V.value,symbol:new na({color:V.color,outline:null})})});T.length&&A.push({type:"symbol-table",title:t.label,infos:T})}else if(t.transferFunction){const {colorStops:T,stretchRange:V}=t.transferFunction,aa=T.toArray().reverse(),ba=V.map((ja,ea)=>`${0===ea?fa.SPECIAL_CHARS_LESS_THAN:
fa.SPECIAL_CHARS_GREATER_THAN} ${ca.formatNumberLabel(ja)}`).reverse(),qa=aa.map(ja=>({color:ja.color,value:null,label:null}));qa[0].label=ba[0];qa[qa.length-1].label=ba[1];A.push({type:"color-ramp",title:t.label,infos:qa,preview:f.renderColorRampPreviewHTML(aa.map(ja=>ja.color),{ariaLabel:await Ba("previewColorRampAriaLabel")})})}const Q=b.opacity;t=A.reduce((T,V)=>[...T,...this._getAllInfos(V)],[]).filter(T=>!!T?.symbol).map(T=>this._getSymbolPreview(T,Q));await m.eachAlways(t);this.legendElements=
A;this.notifyChange("ready")};da._constructLegendElementsForWMTSlayer=function(){this.legendElements=[];this.removeHandles("wmts-activeLayer-watcher");const b=this.layer.activeLayer;this.addHandles(z.watch(()=>{const {layer:t}=this;return t&&"activeLayer"in t&&t.activeLayer},()=>this._constructLegendElementsForWMTSlayer()),"wmts-activeLayer-watcher");if(b.styleId&&b.styles){let t=null;b.styles.some(A=>b.styleId===A.id?(t=A.legendUrl,!0):!1);t&&(this.legendElements=[{type:"symbol-table",title:b.title,
infos:[{src:t,opacity:this.opacity}]}])}this.notifyChange("ready")};da._constructLegendElementsForWMSSublayers=async function(){this.legendElements=[];this.removeHandles("wms-sublayers-watcher");const b=this.layer;let t=null;if(b.customParameters||b.customLayerParameters)t={...b.customParameters,...b.customLayerParameters};this.addHandles(z.watch(()=>{const {layer:A}=this;return A&&"sublayers"in A&&A.sublayers},()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher");this.legendElements=
await this._generateLegendElementsForWMSSublayers(b.sublayers,t);this.notifyChange("ready")};da._generateLegendElementsForWMSSublayers=async function(b,t){const A=[];this.addHandles(b.on("change",()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher");b=b.toArray();for(const Q of b)b=z.watch(()=>[Q.title,Q.visible,Q.legendEnabled],()=>this._constructLegendElementsForWMSSublayers()),this.addHandles(b,"wms-sublayers-watcher"),(!this.respectLayerVisibility||Q.visible&&Q.legendEnabled)&&
(b=await this._generateSymbolTableElementForWMSSublayer(Q,t))&&b.infos.length&&A.unshift(b);return A};da._generateSymbolTableElementForWMSSublayer=async function(b,t){return!b.legendUrl&&b.sublayers?(t=(await this._generateLegendElementsForWMSSublayers(b.sublayers,t)).filter(A=>A),{type:"symbol-table",title:b.title,infos:t}):this._generateSymbolTableElementForLegendUrl(b,t)};da._generateSymbolTableElementForLegendUrl=async function(b,t){let A=b.legendUrl;if(A){var Q={type:"symbol-table",title:b.title||
b.name||String(b.id??""),infos:[]};t&&(A=r.addQueryParameters(A,t));t=null;b=b.layer?.opacity;try{if(t=(await G(A,{responseType:"image"})).data)t.style.opacity=b}catch{}Q.infos.push({src:A,preview:t,opacity:b});return Q}};da._getLegendLayers=function(b,t){const A=Ea&&Ea[b];return A?Promise.resolve(A):this._legendRequest(t).then(Q=>{Q=Q.layers;return Ea[b]=Q})};da._legendRequest=function(b){var t=this.layer;b={f:"json",dynamicLayers:b};if("esri.layers.ImageryLayer"===t.declaredClass){var A=t.exportImageServiceParameters.rasterFunction;
A&&(b.renderingRule=JSON.stringify(A.functionDefinition?.toJSON()||A.toJSON()));t.bandIds&&(b.bandIds=t.bandIds.join());if(t.raster||t.viewId||t.customParameters){const {raster:Q,viewId:T,customParameters:V}=t;b={raster:Q,viewId:T,...b,...V}}}A=t.url.replace(/(\/)+$/,"");"version"in t&&10.01<=+t.version?(t=A.indexOf("?"),A=-1<t?A.substring(0,t)+"/legend"+A.substring(t):A+"/legend"):(t=A.toLowerCase().indexOf("/rest/"),t=A.substring(0,t)+A.substring(t+5,A.length),A="https://utility.arcgis.com/sharing/tools/legend?soapUrl\x3d"+
encodeURI(t)+"\x26returnbytes\x3dtrue");return G(A,{query:b}).then(Q=>Q.data)};da._constructLegendElementsForBuildingSceneLayer=async function(){this.legendElements=[];this.removeHandles("sublayers-watcher");const b=this.layer;this.addHandles(z.watch(()=>b.sublayers,()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForBuildingSublayers(b.sublayers,this.opacity),this.notifyChange("ready")}catch(t){e.getLogger(this).warn("Request to server for legend has failed!",
t)}};da._generateLegendElementsForBuildingSublayers=async function(b,t){let A=[];this.addHandles(b.on("change",()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");b=b.toArray();for(const T of b)if(b=z.watch(()=>["renderer"in T&&T.renderer,T.opacity,T.title,T.visible],()=>this._constructLegendElementsForBuildingSceneLayer()),this.addHandles(b,"sublayers-watcher"),!this.respectLayerVisibility||T.visible){b=T&&null!=T.opacity?T.opacity:null;var Q=null!=b?b*t:t;"building-group"===
T.type?(b={type:"symbol-table",title:T.title,infos:[]},Q=await this._generateLegendElementsForBuildingSublayers(T.sublayers,Q),b.infos.push(...Q),A=[b,...A]):T.renderer&&(A=[...(await this._getRendererLegendElements(T.renderer,{title:T.title,opacity:Q,sublayer:T})),...A])}return A.filter(T=>!!T&&("infos"in T&&T.infos?0<T.infos.length:!0))};da._constructLegendElementsForSublayers=async function(){this.legendElements=[];this.removeHandles("sublayers-watcher");const b=this.layer;if(Ja(b)||"esri.layers.TileLayer"===
b.declaredClass||Ia(b)){this.addHandles(z.watch(()=>b.sublayers,()=>this._constructLegendElementsForSublayers),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForSublayers(b.sublayers,this.opacity),this.notifyChange("ready")}catch(t){e.getLogger(this).warn("Request to server for legend has failed!",t)}}};da._generateLegendElementsForSublayers=async function(b,t,A){const Q=this.layer;let T=[];this.addHandles(b.on("change",()=>this._constructLegendElementsForSublayers()),
"sublayers-watcher");b=b.toArray();!A&&this.sublayerIds&&this.sublayerIds.length&&(b=Ia(Q)?this.sublayerIds.map(V=>Q.findSublayerForSubtypeCode(V)).filter(g.isSome):this.sublayerIds.map(V=>Q.findSublayerById(V)).filter(g.isSome));for(const V of b)if(b=z.watch(()=>[V.renderer,V.opacity,V.title,V.visible,V.legendEnabled],()=>this._constructLegendElementsForSublayers()),this.addHandles(b,"sublayers-watcher"),!this.respectLayerVisibility||V.visible&&V.legendEnabled&&this._isSublayerInScale(V)){b=V&&null!=
V.opacity?V.opacity:null;b=null!=b?b*t:t;const aa="sublayers"in V?V.originIdOf("renderer")>J.OriginId.SERVICE&&!V.sublayers:!0;V.renderer&&aa?(await V.load(),T=[...(await this._getRendererLegendElements(V.renderer,{title:V.title,opacity:b,sublayer:V})),...T]):"sublayers"in V&&(b=await this._generateSymbolTableElementForSublayer(V,b,A))&&T.unshift(b)}return T.filter(V=>!!V&&("infos"in V&&V.infos?0<V.infos.length:!0))};da._generateSymbolTableElementForSublayer=async function(b,t,A){if(!A){A=new Map;
var Q=this.layer,T=b.source;let V=null;if(T&&("map-layer"!==T.type||T.mapLayerId!==b.id||T.gdbVersion&&T.gdbVersion!==("gdbVersion"in Q&&Q.gdbVersion))||b.originIdOf("renderer")>J.OriginId.SERVICE||b.originIdOf("labelingInfo")>J.OriginId.SERVICE||b.originIdOf("labelsVisible")>J.OriginId.SERVICE)T=new d.ExportImageParameters({layer:this.layer}),V=T.hasDynamicLayers?T.dynamicLayers:null,T.destroy();(await this._getLegendLayers(V||`${Q.uid}-default`,V)).forEach(aa=>A.set(aa.layerId,aa))}Q=A.get(b.id);
return(!Q||Q?.subLayerIds&&Q.defaultVisibility)&&b.sublayers?(t=await this._generateLegendElementsForSublayers(b.sublayers,t,A),{type:"symbol-table",title:b.title,infos:t}):this._generateSymbolTableElementForLegendLayer(Q,b,t)};da._generateSymbolTableElementForLegendLayer=function(b,t,A){if(!b||!b.legend||this.respectLayerVisibility&&!this._isLegendLayerInScale(b,t))return null;var Q=t?.renderer;let T=t?.title||b.layerName;Q&&(!t||t?.originIdOf("renderer")>J.OriginId.SERVICE)&&(Q=t?.title||this._getRendererTitle(Q,
t))&&(T&&"string"!==typeof Q&&"title"in Q&&(Q.title=T),T=Q);const V={type:"symbol-table",title:T,legendType:b.legendType||null,infos:[]},aa=t?this._sanitizeLegendForSublayer(b.legend.slice(),t):b.legend;b.legendGroups&&0<b.legendGroups.length?b.legendGroups.forEach(ba=>{const qa={type:"symbol-table",title:ba.heading,legendType:b.legendType||null,infos:this._generateSymbolTableElementInfosForLegendLayer(aa.filter(ja=>ja.groupId===ba.id),b.layerId,A)};0<qa.infos?.length&&V.infos.push(qa)}):V.infos=
this._generateSymbolTableElementInfosForLegendLayer(aa,b.layerId,A);return 0<V.infos.length?V:null};da._generateSymbolTableElementInfosForLegendLayer=function(b,t,A){return b.map(Q=>{let T=Q.url;if(Q.imageData&&0<Q.imageData.length)T=`data:image/png;base64,${Q.imageData}`;else if(0!==T.indexOf("http"))T=I.addTokenParameter(`${this.layer.url}/${t}/images/${T}`);else return null;return{label:Q.label,src:T,opacity:null==A?this.opacity:A,width:Q.width,height:Q.height}}).filter(g.isSome)};da._isSublayerInScale=
function(b){const t=b.minScale||0;b=b.maxScale||0;return 0<t&&t<this.scale||b>this.scale?!1:!0};da._isLegendLayerInScale=function(b,t){t=t||this.layer;let A=null,Q=null,T=!0;!t.minScale&&0!==t.minScale||!t.maxScale&&0!==t.maxScale?(0===b.minScale&&t.tileInfo&&(A=t.tileInfo.lods[0].scale),0===b.maxScale&&t.tileInfo&&(Q=t.tileInfo.lods[t.tileInfo.lods.length-1].scale)):(A=Math.min(t.minScale,b.minScale)||t.minScale||b.minScale,Q=Math.max(t.maxScale,b.maxScale));if(0<A&&A<this.scale||Q>this.scale)T=
!1;return T};da._sanitizeLegendForSublayer=function(b,t){if("version"in this.layer&&10.1>+this.layer.version||0===b.length)return b;t=t.renderer;let A=0,Q=null;b.some(T=>T.values)&&b.some((T,V)=>{T.values||(A=V,Q=T,Q.label||(Q.label="others"));return null!=Q});t?"unique-value"===t.type?Q&&(b.splice(A,1),b.push(Q)):"class-breaks"===t.type&&(Q&&b.splice(A,1),b.reverse(),Q&&b.push(Q)):Q&&(b.splice(A,1),b.push(Q));return b};da._getRendererLegendElements=async function(b,t={}){var A=this.view;A=ha(b)||
la(b)||oa(b)||ta(b)||Aa(b)||Da(b)?"2d"===A.type||E.isSupportedRenderer3D(b):"raster-stretch"===b.type||"raster-colormap"===b.type||"raster-shaded-relief"===b.type||ua(b)||wa(b)||ya(b)||"vector-field"===b.type||"flow"===b.type;if(!A)return e.getLogger(this).warn(`Renderer of type '${b.type}' not supported!`),[];if(ua(b)||wa(b)||ya(b)||"esri.renderers.PointCloudRGBRenderer"===b.declaredClass)return this._constructPointCloudRendererLegendElements(b,t);if(Aa(b))return this._constructDotDensityRendererLegendElements(b);
b=await this._loadRenderer(b);return Da(b)?this._constructPieChartRendererLegendElements(b):this._constructRendererLegendElements(b,t)};da._getLegendElementsForFeatureReduction=async function(b){let t=null;"binning"===b.type?t=b.renderer:"cluster"===b.type&&(t=this._getClusterRenderer(b));return t?this._getRendererLegendElements(t):[]};da._getPointCloudRendererTitle=function(b){return(b.legendOptions?.title||b.field)??""};da._constructPointCloudRendererLegendElements=async function(b,t={}){t=t.title;
const A=[];let Q=null;var T=null;if(ua(b))Q={type:"symbol-table",title:t||this._getPointCloudRendererTitle(b),infos:[]},b.colorClassBreakInfos.forEach(V=>{Q.infos.unshift({label:V.label||V.minValue+" - "+V.maxValue,value:[V.minValue,V.maxValue],symbol:this._getAppliedCloneSymbol(Pa,V.color)})});else if(wa(b)){T=b.stops;let V=null;if(T?.length&&(1===T.length&&(V=T[0].color),!V)){const aa=T[0].value,ba=T[T.length-1].value;null!=aa&&null!=ba&&(V=w.getColorFromPointCloudStops(aa+(ba-aa)/2,T))}Q={type:"symbol-table",
title:null,infos:[{label:null,value:null,symbol:this._getAppliedCloneSymbol(Pa,V||Pa.color)}]};T=w.getRampStopsForPointCloud(b.stops??[])??[];T={type:"color-ramp",title:t||this._getPointCloudRendererTitle(b),infos:T,preview:f.renderColorRampPreviewHTML(T.map(aa=>aa.color),{ariaLabel:await Ba("previewColorRampAriaLabel")})}}else ya(b)&&(Q={type:"symbol-table",title:t||this._getPointCloudRendererTitle(b),infos:[]},b.colorUniqueValueInfos?.forEach(V=>{Q.infos.push({label:V.label||V.values.join(", "),
value:V.values.join(", "),symbol:this._getAppliedCloneSymbol(Pa,V.color)})}));Q&&Q.infos.length&&A.push(Q);T&&T.infos.length&&A.push(T);t=A.reduce((V,aa)=>[...V,...(aa.infos??[])],[]).filter(V=>!!V.symbol).map(V=>this._getSymbolPreview(V,this.opacity,{symbolConfig:{applyColorModulation:!!b.colorModulation}}));return m.eachAlways(t).then(()=>A)};da._getElementInfoForDotDensity=async function(b,t){const {color:A,label:Q,valueExpressionTitle:T}=t,{backgroundColor:V,outline:aa,dotSize:ba}=b;t=this.effectList?.effects.map(ea=>
ea.toJSON());var qa=q.effectFunctionsFromJSON(t);t=await Ba("previewTemplateAriaLabel",Q||T);qa=ba+"-"+A+"-"+V+"-"+(aa&&JSON.stringify(aa.toJSON()))+"-"+qa;const ja=this._dotDensityUrlCache;b=ja.has(qa)?ja.get(qa):f.renderDotDensityPreviewHTML(b,A,{ariaLabel:t});ja.set(qa,b);t=W.renderSymbol([[{shape:{type:"image",x:0,y:0,width:b.width,height:b.height,src:b.src},fill:null,stroke:null,offset:[0,0]}]],[b.width,b.height],{effectView:this.effectList,ariaLabel:t});return{opacity:1,src:b.src,preview:t,
width:b.width,height:b.height}};da._constructDotDensityRendererLegendElements=async function(b){var t=b.calculateDotValue(this.view.scale);t={type:"symbol-table",title:{value:t&&Math.round(t),unit:b.legendOptions&&b.legendOptions.unit||""},infos:[]};for(const A of b.attributes){const Q=await this._getElementInfoForDotDensity(b,A);Q.label=A.label||A.valueExpressionTitle||A.field;t.infos.push(Q)}return[t]};da._constructPieChartRendererLegendElements=async function(b){const t=this.layer.opacity,A=[];
let Q=null;const T=b.outline;b.attributes.forEach(ba=>{const qa=new ka({color:ba.color,outline:T});A.push({label:ba.label||ba.valueExpressionTitle||ba.field,symbol:qa})});var V=A.length?[...A]:[];if(b.othersCategory?.color&&0!==b.othersCategory?.threshold){var aa=new ka({color:b.othersCategory.color,outline:T});Q=b.othersCategory.label||"Other";A.push({label:Q,symbol:aa})}b.defaultColor?.a&&(aa=new ka({color:b.defaultColor,outline:T}),A.push({label:b.defaultLabel,symbol:aa}));aa=await this._getVisualVariableLegendElements(b,
this.layer)||[];A.length&&(aa.unshift({type:"symbol-table",title:null,infos:A}),V=V.filter(ba=>ba.label!==Q).map(ba=>ba.symbol.color).filter(Boolean),V=f.renderPieChartPreviewHTML(V,{holePercentage:b.holePercentage,backgroundColor:b.backgroundFillSymbol?.color,effectList:this.effectList,outline:T,ariaLabel:await Ba("previewPieChartAriaLabel")}),aa.unshift({type:"pie-chart-ramp",title:this._getRendererTitle(b,this.layer),infos:A,preview:V}));b=aa.reduce((ba,qa)=>[...ba,...this._getAllInfos(qa)],[]).filter(ba=>
!!ba?.symbol&&!ba?.preview).map(ba=>this._getSymbolPreview(ba,t,{effectList:this.effectList}));await m.eachAlways(b);return aa};da._constructRendererLegendElements=async function(b,t={}){const {title:A,sublayer:Q}=t,T=Q||this.layer;this._hasSizeRamp=this._hasOpacityRamp=this._hasColorRamp=!1;this._scaleDrivenSizeVariable=null;const V=await this._getVisualVariableLegendElements(b,T)||[],aa={type:"symbol-table",title:A||this._getRendererTitle(b,T),infos:[]};let ba=null,qa=!1;const ja=new Set;if("flow"!==
b.type||this._hasSizeRamp)if("univariate-color-size"===("authoringInfo"in b?b?.authoringInfo:null)?.type){var ea=A,va=$a(b)?"univariate-above-and-below-ramp":"univariate-color-size-ramp",ra=V.findIndex(ma=>"color-ramp"===ma.type);ra=-1!==ra?V.splice(ra,1)[0]:null;var pa=V.findIndex(ma=>"size-ramp"===ma.type);pa=-1!==pa?V.splice(pa,1)[0]:null;var xa=[];ra&&(ea=ra.title,xa.push(ra));pa&&(ea=pa.title,xa.push(pa));0<xa.length&&V.push({type:va,title:ea,infos:xa})}else if(ta(b))ea=F.getHeatmapRampStops(b),
V.push({type:"heatmap-ramp",title:A||this._getRendererTitle(b,T),infos:ea,preview:f.renderColorRampPreviewHTML(ea.map(ma=>ma.color),{effectList:this.effectList,ariaLabel:await Ba("previewColorRampAriaLabel")})});else if(oa(b)){if((va=b&&b.authoringInfo)&&"relationship"===va.type){const {numClasses:ma,field1:za,field2:Fa}=va;va=va.focus;if(ma&&za&&Fa){pa=[za,Fa];ra=U.getRotationAngleForFocus(va)||0;for(ea of pa){const {field:Sa,normalizationField:Ka,label:Qa}=ea;pa=Qa||{field:this._getFieldAlias(Sa,
T),normField:Ka&&this._getFieldAlias(Ka,T)};xa=cb.clone();xa.angle=ra;aa.infos.push({label:pa,symbol:xa});ja.add(xa);ra+=90}ea=U.getRelationshipRampElement({focus:va,numClasses:ma,infos:b.uniqueValueInfos??[]});V.unshift(ea)}}else if("esri.layers.ImageryLayer"===this.layer.declaredClass||"esri.layers.ImageryTileLayer"===this.layer.declaredClass)b.uniqueValueInfos?.forEach(ma=>{ma.symbol&&aa.infos.push({label:ma.label||ma.value,value:ma.value,symbol:ma.symbol})});else{const {field:ma,field2:za,field3:Fa,
fieldDelimiter:Sa,valueExpression:Ka,defaultSymbol:Qa}=b,db=!(!ma&&!Ka||!za&&!Fa),Ga=[];b.uniqueValueGroups?.forEach(Va=>{const Ta={type:"symbol-table",title:Va.heading,infos:[]};Va.classes?.forEach(Ha=>{const {symbol:Wa,values:eb}=Ha;if(Wa){var La=[],Ma=[];for(const fb of eb??[]){const {value:Xa,value2:Ya,value3:Za}=fb,Na=[],Ra=[];if(ma||Ka)Na.push(Xa),Ra.push(this._getDomainName(ma,Xa,T));za&&(Na.push(Ya),Ra.push(this._getDomainName(za,Ya,T)));Fa&&(Na.push(Za),Ra.push(this._getDomainName(Fa,Za,
T)));La.push(db?Na.join(Sa||""):Na[0]);Ma.push(Ra.join(" - "))}La=La.join(", ");Ha=Ha.label;Ha||(Ma=Ma.filter(Boolean),Ha=Ma.length?Ma.join(", "):La);Ta.infos.push({label:Ha,value:La,symbol:Wa})}});Ta.infos.length&&Ga.push(Ta)});Ga.length&&(ea=Ga[0],1===Ga.length&&"title"in ea&&!ea.title?aa.infos.push(...(ea.infos??[])):(Qa&&(Ga.push({type:"symbol-table",infos:[{label:b.defaultLabel||"others",symbol:Qa}]}),qa=!0),aa.infos.push(...Ga)),A||b.legendOptions&&b.legendOptions.title||b.valueExpressionTitle||
(aa.title=null))}b.defaultSymbol&&!qa&&(aa.infos.push({label:b.defaultLabel||"others",symbol:b.defaultSymbol}),qa=!0)}else if(la(b))ba=this._isUnclassedRenderer(b),ba&&this._hasSizeRamp||(b.classBreakInfos.forEach(ma=>{ma.symbol&&aa.infos.unshift({label:ma.label||(ba?null:ma.minValue+" - "+ma.maxValue),value:[ma.minValue,ma.maxValue],symbol:ma.symbol})}),ba&&(aa.title=null),this._updateInfosforClassedSizeRenderer(b,aa.infos)),b.defaultSymbol&&!ba&&(aa.infos.push({label:b.defaultLabel||"others",symbol:b.defaultSymbol}),
qa=!0);else if("raster-stretch"===b.type)if("esri.layers.ImageryTileLayer"===this.layer.declaredClass||"esri.layers.WCSLayer"===this.layer.declaredClass)ea=await this._constructTileImageryStretchRendererElements(b),"stretch-ramp"===ea.type?V.push(ea):aa.infos=ea;else{ea=this.layer;b.statistics?.length&&(ra=b.statistics[0],fa.isRasterBandStatistics(ra)?(va=ra.min,ra=ra.max):[va,ra]=ra);pa=[];pa=ea.serviceRasterInfo;if(ea.rasterFunction)try{pa=await ea.generateRasterInfo(ea.rasterFunction)}catch{}const ma=
pa.keyProperties.BandProperties;xa=B.getPixelValueRange(pa.pixelType);1===pa.bandCount?(ea=ea.bandIds?.[0]||0,va=null!=va?va:pa.statistics?pa.statistics[ea].min:xa[0],ra=null!=ra?ra:pa.statistics?pa.statistics[ea].max:xa[1],va||ra?V.push(await this._getStretchLegendElements(b,{min:va,max:ra})):this._getServerSideLegend()):ea.bandIds&&1===ea.bandIds.length?(va=null!=va?va:pa.statistics?pa.statistics[ea.bandIds[0]].min:xa[0],ra=null!=ra?ra:pa.statistics?pa.statistics[ea.bandIds[0]].max:xa[1],va||ra?
V.push(await this._getStretchLegendElements(b,{min:va,max:ra})):this._getServerSideLegend()):3<=pa.bandCount?ma&&ma.length>=pa.bandCount?ea.bandIds&&3===ea.bandIds.length?(pa=ea.bandIds.map(za=>ma[za].BandName),aa.infos=this._createSymbolTableElementMultiBand(pa)):"lerc"===ea.format?(pa=[0,1,2].map(za=>ma[za].BandName),aa.infos=this._createSymbolTableElementMultiBand(pa)):this._getServerSideLegend():"lerc"===ea.format?(pa=["band1","band2","band3"],aa.infos=this._createSymbolTableElementMultiBand(pa)):
this._getServerSideLegend():this._getServerSideLegend()}else if("raster-colormap"===b.type)b.colormapInfos.forEach(ma=>{aa.infos.push({label:ma.label,value:ma.value,symbol:this._getAppliedCloneSymbol(bb,ma.color)})});else if(ha(b)){ea=b.symbol;switch(t.geometryType){case "point":ea="pointSymbol"in T?T.pointSymbol:null;break;case "polyline":ea="lineSymbol"in T?T.lineSymbol:null;break;case "polygon":ea="polygonSymbol"in T?T.polygonSymbol:null}va=this._hasClusterSizeVariable&&this._getClusterSymbol()||
!this._hasSizeRamp;b.symbol&&va&&aa.infos.push({label:b.label,symbol:ea})}else"vector-field"===b.type?(b.outputUnit&&(this.title="("+b.toJSON().outputUnit+")"),aa.title=b.attributeField,ea=b.getClassBreakInfos(),ea?.length?ea.forEach(ma=>{aa.infos.push({label:ma.minValue+" - "+ma.maxValue,symbol:ma.symbol})}):aa.infos.push({label:b.attributeField,symbol:b.getDefaultSymbol()})):"raster-shaded-relief"===b.type&&V.push(await this._getStretchLegendElements(b,{min:0,max:255}));else ea=await fa.getSymbolForFlowRenderer(b),
aa.infos.push({label:null,symbol:ea});const Ua=b.defaultSymbol;!Ua||qa||ha(b)||ba&&!this._hasColorRamp&&!this._hasSizeRamp&&!this._hasOpacityRamp||V.push({type:"symbol-table",infos:[{label:b.defaultLabel||"others",symbol:Ua}]});aa.infos.length&&V.unshift(aa);const gb=null==t.opacity?this.opacity:t.opacity,hb=this._isTallSymbol("visualVariables"in b?b.visualVariables:null),ib="esri.layers.ImageryLayer"===this.layer.declaredClass||"esri.layers.ImageryTileLayer"===this.layer.declaredClass;t=V.reduce((ma,
za)=>[...ma,...this._getAllInfos(za)],[]).filter(ma=>!!ma?.symbol).map(ma=>this._getSymbolPreview(ma,gb,{isDefault:ma.symbol===Ua,applyScaleDrivenSize:!ja.has(ma.symbol),symbolConfig:{isTall:hb,isSquareFill:ib},effectList:ja.has(ma.symbol)?null:this.effectList}));b=null;await m.eachAlways(t);return V};da._getServerSideLegend=function(){setTimeout(()=>this.buildLegendElementsForTools(),0)};da._getAllInfos=function(b){const t=b?.infos;return t?t.reduce((A,Q)=>A.concat(this._getAllInfos(Q)),[]):[b]};
da._constructTileImageryStretchRendererElements=async function(b){function t(qa){const ja=(A?.bandIds?.length?A.bandIds:Array.from(Array(Math.min(Q.bandCount,3)).keys())).map(ea=>qa&&qa[ea]&&qa[ea].BandName||"band"+(ea+1));3>ja.length?ja.push(ja[1]):3<ja.length&&ja.splice(3);return ja}const A=this.layer,{rasterInfo:Q}=A.raster,T=Q.bandCount||b.statistics.length;var V,aa=[];aa=Q.keyProperties&&Q.keyProperties.BandProperties;if(V=b?.statistics?.length?b.statistics:Q?.statistics){var ba=V[0];fa.isRasterBandStatistics(ba)?
(V=ba.min,ba=ba.max):[V,ba]=ba}else ba=B.getPixelValueRange(Q.pixelType),V=ba[0],ba=ba[1];A.hasStandardTime()&&(V=A.getStandardTimeValue(V),ba=A.getStandardTimeValue(ba));if(1===Q.bandCount||1===A.bandIds?.length)return this._getStretchLegendElements(b,{min:V,max:ba});aa=aa&&aa.length>=T?t(aa):t();return this._createSymbolTableElementMultiBand(aa)};da._getStretchLegendElements=async function(b,t){b=w.getStrectchRampStops(b.colorRamp,t);return{type:"stretch-ramp",title:"",infos:b,preview:f.renderColorRampPreviewHTML(b.map(A=>
A.color),{ariaLabel:await Ba("previewColorRampAriaLabel")})}};da._getClusterSymbol=function(){var b=this.layer;const t=(b="featureReduction"in b&&b.featureReduction)&&"symbol"in b&&b.renderer;return t&&!0!==t?.authoringInfo?.isAutoGenerated?null:b&&"symbol"in b?b.symbol:null};da._getSizeLegendElement=async function(b,t,A,Q){return{type:"size-ramp",title:this._hasClusterSizeVariable?this._getClusterTitle(t):b,infos:await Z.getRampStops(A,t,await fa.getMedianColor(A),this.scale,this.view.type,!!Q,this._hasClusterSizeVariable?
this._getClusterSymbol():null)}};da._createSymbolTableElementMultiBand=function(b){const t=[],A=["red","green","blue"];b.forEach((Q,T)=>{t.push({label:{colorName:A[T],bandName:Q},src:fa.RGB_IMG_SOURCE[T],opacity:this.opacity??1})});return t};da._updateInfosforClassedSizeRenderer=function(b,t){const A=b.authoringInfo&&"class-breaks-size"===b.authoringInfo.type,Q=b.classBreakInfos.some(T=>D.isVolumetricSymbol(T.symbol));if(A&&Q){const T=Z.REAL_WORLD_MAX_SIZE;b=b.classBreakInfos.length;const V=(T-Z.REAL_WORLD_MIN_SIZE)/
(1<b?b-1:b);t.forEach((aa,ba)=>{aa.size=T-V*ba})}};da._isTallSymbol=function(b){let t=!1,A=!1;if(b)for(let Q=0;Q<b.length&&(!t||!A);Q++){const T=b[Q];"size"===T.type&&("height"===T.axis&&(t=!0),"width-and-depth"===T.axis&&(A=!0))}return t&&A};da._getSymbolPreview=async function(b,t,A){var Q=!A?.isDefault&&null==b.size&&this._hasSizeRamp?k.px2pt(X.SymbolSizeDefaults.size):b.size;this._scaleDrivenSizeVariable&&A?.applyScaleDrivenSize&&({getSize:Q}=await new Promise((T,V)=>y(["../../../renderers/visualVariables/support/visualVariableUtils"],
T,V)),Q=Q(this._scaleDrivenSizeVariable,null,{view:this.view.type,scale:this.scale,shape:"simple-marker"===b.symbol.type?b.symbol.style:null}));return f.renderPreviewHTML(b.symbol,{size:Q,opacity:t,scale:!1,symbolConfig:A?.symbolConfig,effectView:A?.effectList,ariaLabel:b.label&&"string"!==typeof b.label?null:await Ba("previewTemplateAriaLabel",b.label)}).then(T=>{b.preview=T;return b}).catch(()=>{b.preview=null;return b})};da._getClusterRenderer=function(b){this._hasClusterSizeVariable=!1;var t=
"renderer"in this.layer?this.layer.renderer:null;t=b.renderer?.clone()||t?.clone();const A=C.getClusterSizeVariable(this.layerView._effectiveRenderer,this.view);if(A&&null!=t&&"visualVariables"in t&&!t.visualVariables?.some(Q=>"size"===Q.type&&"outline"!==Q.target&&!Oa.test(Q.valueExpression))){if("clusterMinSize"in b&&"clusterMaxSize"in b){const {clusterMinSize:Q,clusterMaxSize:T}=b;A.legendOptions=new K({showLegend:Q!==T})}t.visualVariables=(t.visualVariables||[]).concat([A]);this._hasClusterSizeVariable=
!0}return t};da._loadRenderer=async function(b){const t=[],A=b.clone(),Q=await fa.getMedianColor(A);if(la(A)||oa(A))b=(A.classBreakInfos||A.uniqueValueInfos).map(T=>this._fetchSymbol(T.symbol,Q).then(V=>{T.symbol=V}).catch(()=>{T.symbol=null})),Array.prototype.push.apply(t,b);t.push(this._fetchSymbol(A.symbol||A.defaultSymbol,A.defaultSymbol?null:Q).then(T=>{this._applySymbolToRenderer(A,T,ha(A))}).catch(()=>{this._applySymbolToRenderer(A,null,ha(A))}));return m.eachAlways(t).then(()=>A)};da._applySymbolToRenderer=
function(b,t,A){A?b.symbol=t:b.defaultSymbol=t};da._fetchSymbol=async function(b,t){if(!b)throw Error();if("web-style"===b.type){const A=this._webStyleSymbolCache;try{const Q=await ("2d"===this.view.type?b.fetchCIMSymbol({cache:A}):b.fetchSymbol({cache:A}));return this._getAppliedCloneSymbol(Q,t)}catch{throw e.getLogger(this).warn("Fetching web-style failed!"),Error();}}return this._getAppliedCloneSymbol(b,t)};da._getAppliedCloneSymbol=function(b,t){if(!b||!t)return b;b=b.clone();const A=t&&t.toRgba();
b.type.includes("3d")?this._applyColorTo3dSymbol(b,A):"cim"===b.type?R.applyCIMSymbolColor(b,t):b.color&&(b.color=new x(A||b.color));return b};da._applyColorTo3dSymbol=function(b,t){t&&b.symbolLayers.forEach(A=>{A&&(A.material||(A.material={}),A.material.color=new x(t))})};da._getVisualVariableLegendElements=async function(b,t){if(!("visualVariables"in b&&b.visualVariables)||"vector-field"===b.type)return null;var A=b.visualVariables,Q=[];const T=[],V=[];for(const ja of A)"color"===ja.type?Q.push(ja):
"size"===ja.type?T.push(ja):"opacity"===ja.type&&V.push(ja);A=[...Q,...T,...V];let aa;if(0===Q.length&&la(b)&&b.classBreakInfos&&1===b.classBreakInfos.length)var ba=(ba=b.classBreakInfos[0])&&ba.symbol;0===Q.length&&ha(b)&&(ba=b.symbol);ba&&(ba.type.includes("3d")?(Q=ba.symbolLayers.at(0),"water"===Q.type?null!=Q.color&&(aa=Q.color):null!=Q.material&&null!=Q.material.color&&(aa=Q.material.color)):ba.url||(aa=ba.color));const qa=this.effectList;return(await Promise.all(A.map(async ja=>{if(!ja.legendOptions||
!1!==ja.legendOptions.showLegend){const va="flow"===b.type?ja.field:this._getRampTitle(ja,t);let ra=null;var ea="getField"in t?t.getField?.(ja.field):null;ea=ea&&h.isDateField(ea);"color"===ja.type?(ja=await w.getRampStops(ja,null,ea)??[],ra={type:"color-ramp",title:va,infos:ja,preview:f.renderColorRampPreviewHTML(ja.map(pa=>pa.color),{effectList:qa,ariaLabel:await Ba("previewColorRampAriaLabel")})},this._hasColorRamp||(this._hasColorRamp=0<ja.length)):"size"===ja.type&&"outline"!==ja.target?Oa.test(ja.valueExpression)?
this._hasClusterSizeVariable||(this._scaleDrivenSizeVariable=ja):(ra=await this._getSizeLegendElement(va,ja,b,ea),this._hasSizeRamp||(this._hasSizeRamp=!(null==ra.infos||!ra.infos.length))):"opacity"===ja.type&&(ja=await w.getRampStops(ja,aa,ea)??[],ra={type:"opacity-ramp",title:va,infos:ja,preview:f.renderColorRampPreviewHTML(ja.map(pa=>pa.color),{effectList:qa,ariaLabel:await Ba("previewColorRampAriaLabel")})},this._hasOpacityRamp||(this._hasOpacityRamp=0<ja.length));return ra&&ra.infos?ra:null}}))).filter(g.isSome)};
da._getDomainName=function(b,t,A){return b&&"function"!==typeof b?(A=(b="getField"in A&&A.getField&&A.getField(b))&&"getFieldDomain"in A&&A.getFieldDomain?A.getFieldDomain(b.name):null,"coded-value"===A?.type?A.getName(t):null):null};da._getClusterTitle=function(b){var t=this.layer;b=b.field;if("featureReduction"in t&&t.featureReduction&&"cluster"===t.featureReduction.type&&(t=t.featureReduction,t=(t="popupTemplate"in t&&t.popupTemplate)&&t.fieldInfos))for(const A of t)if(A.fieldName===b)return"cluster_count"===
b?A.label||{showCount:!0}:A.label;return{showCount:!0}};da._getRampTitle=function(b,t){let A=b.field,Q=b.normalizationField,T=!1,V=!1,aa=!1;var ba=null;A="function"===typeof A?null:A;Q="function"===typeof Q?null:Q;ba=b.legendOptions&&b.legendOptions.title;if(null==ba)if(b.valueExpressionTitle)ba=b.valueExpressionTitle;else{if("renderer"in t&&t.renderer&&"authoringInfo"in t.renderer&&t.renderer.authoringInfo&&t.renderer.authoringInfo.visualVariables)for(b=t.renderer.authoringInfo.visualVariables,ba=
0;ba<b.length;ba++){const qa=b[ba];if("color"===qa.type){if("ratio"===qa.style){T=!0;break}if("percent"===qa.style){V=!0;break}if("percent-of-total"===qa.style){aa=!0;break}}}ba={field:A&&this._getFieldAlias(A,t),normField:Q&&this._getFieldAlias(Q,t),ratio:T,ratioPercent:V,ratioPercentTotal:aa}}return ba};da._getRendererTitle=function(b,t){if(b.legendOptions&&b.legendOptions.title)return b.legendOptions.title;if(b.valueExpressionTitle)return b.valueExpressionTitle;var A=b.field;let Q=null,T=null;
la(b)&&(Q=b.normalizationField,T="percent-of-total"===b.normalizationType);A="function"===typeof A?null:A;Q="function"===typeof Q?null:Q;if(oa(b)){const {field2:V,field3:aa,fieldDelimiter:ba}=b;A=A&&this._getFieldAlias(A,t);V&&(A=`<${A}>${ba}<${this._getFieldAlias(V,t)}>`,aa&&(A=`${A}${ba}<${this._getFieldAlias(aa,t)}>`));return A}b=null;if(A||Q)b={field:A&&this._getFieldAlias(A,t),normField:Q&&this._getFieldAlias(Q,t),normByPct:T};return b};da._getFieldAlias=function(b,t){var A=("popupTemplate"in
t?t.popupTemplate:null)?.fieldInfos;let Q;A&&A.some(aa=>b===aa.fieldName?(Q=aa,!0):!1);A=null;"getField"in t&&t.getField?A=t.getField(b):"fieldsIndex"in t&&t.fieldsIndex&&(A=t.fieldsIndex.get(b));let T=null;if(t="featureReduction"in t&&t.featureReduction)!Q&&"popupTemplate"in t&&t.popupTemplate&&t.popupTemplate.fieldInfos&&t.popupTemplate.fieldInfos.some(aa=>b?.toLowerCase()===aa.fieldName?.toLowerCase()?(Q=aa,!0):!1),"fields"in t&&t.fields&&(T=t.fields.find(aa=>aa.name?.toLowerCase()===b?.toLowerCase()));
t=Q||A||T;let V=null;t&&(V=Q?.label||A?.alias||T?.alias||"name"in t&&t.name||"fieldName"in t&&t.fieldName||null);return V};da._isUnclassedRenderer=function(b){const t=b.visualVariables;let A=!1;la(b)&&b.classBreakInfos&&1===b.classBreakInfos.length&&t&&(A=b.field?t.some(Q=>!(!Q||b.field!==Q.field||(b.normalizationField||Q.normalizationField)&&b.normalizationField!==Q.normalizationField)):!!t.length);return A};L._createClass(Ca,[{key:"effectList",get:function(){const b=this.layer;let t=null;"effect"in
b&&b.effect&&(t=new O.EffectView,t.effect=b.effect,t.endTransitions(),t.scale=this.scale);return t}},{key:"opacity",get:function(){const b=this.layer.opacity,t=this.parent?.opacity;var A=this.layer.parent;A=A&&"uid"in A?this._getParentLayerOpacity(A):null;return null!=t?t*b:null!=A?A*b:b}},{key:"ready",get:function(){return null===this.layer?!0:0<this.children.length?this._isGroupActive():0<this.legendElements.length}},{key:"scale",get:function(){return this.view?.scale??0}},{key:"isScaleDriven",
get:function(){const b=this.layer;if(null===b)return!1;if("effect"in b&&b.effect&&Array.isArray(b.effect))return!0;if("featureReduction"in b&&b.featureReduction){if("cluster"===b.featureReduction.type)return!0;if("binning"===b.featureReduction.type&&"renderer"in b.featureReduction&&b.featureReduction.renderer)return this._isRendererScaleDriven(b.featureReduction.renderer)}return"renderer"in b&&b.renderer?this._isRendererScaleDriven(b.renderer):this._isLayerScaleDriven(this.layer)}},{key:"version",
get:function(){return this._get("version")+1}}]);return Ca}(S);M.__decorate([H.property()],v.prototype,"children",void 0);M.__decorate([H.property({readOnly:!0})],v.prototype,"effectList",null);M.__decorate([H.property()],v.prototype,"layerView",void 0);M.__decorate([H.property()],v.prototype,"layer",void 0);M.__decorate([H.property()],v.prototype,"legendElements",void 0);M.__decorate([H.property({readOnly:!0})],v.prototype,"opacity",null);M.__decorate([H.property()],v.prototype,"parent",void 0);
M.__decorate([H.property({readOnly:!0,dependsOn:[]})],v.prototype,"ready",null);M.__decorate([H.property()],v.prototype,"hideLayersNotInCurrentView",void 0);M.__decorate([H.property()],v.prototype,"keepCacheOnDestroy",void 0);M.__decorate([H.property()],v.prototype,"respectLayerVisibility",void 0);M.__decorate([H.property({readOnly:!0})],v.prototype,"scale",null);M.__decorate([H.property()],v.prototype,"sublayerIds",void 0);M.__decorate([H.property({readOnly:!0})],v.prototype,"isScaleDriven",null);
M.__decorate([H.property()],v.prototype,"title",void 0);M.__decorate([H.property({readOnly:!0,dependsOn:["ready"],value:0})],v.prototype,"version",null);M.__decorate([H.property()],v.prototype,"view",void 0);return v=M.__decorate([u.subclass("esri.widgets.Legend.support.ActiveLayerInfo")],v)})},"esri/layers/effects/EffectView":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/has ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./parser ./utils".split(" "),
function(y,L,M,x,v,I,G,N,S,g,n,a){function e(k){k=n.parse(k)||[];var r=(r=k[0])?"type"in r:!1;return r?[{scale:-1,effects:k}]:k}function m(k,r,H){return k[0]?.effects&&r[0]?.effects?(-1===k[0]?.scale||-1===r[0]?.scale)&&(1<k.length||1<r.length)&&0>=H?!1:a.canInterpolateEffects(k[0].effects,r[0].effects):!0}function z(k,r,H){const c=k.length>r.length?k:r;k=k.length>r.length?r:k;var l=k[k.length-1];r=l?.scale??H;l=l?.effects??[];for(let u=k.length;u<c.length;u++)k.push({scale:r,effects:[...l]});for(r=
0;r<c.length;r++)k[r].scale=-1===k[r].scale?H:k[r].scale,c[r].scale=-1===c[r].scale?H:c[r].scale,a.normalizeEffects(k[r].effects,c[r].effects)}y.EffectView=function(k){function r(c){c=k.call(this,c)||this;c._from=null;c._to=null;c._final=null;c._current=[];c._time=0;c.duration=v("mapview-transitions-duration");c.effects=[];return c}L._inherits(r,k);var H=r.prototype;H.canTransitionTo=function(c){try{return 0<this.scale&&m(this._current,e(c),this.scale)}catch{return!1}};H.transitionStep=function(c,
l){this._applyTimeTransition(c);this._updateForScale(l)};H.endTransitions=function(){this._applyTimeTransition(this.duration)};H._transitionTo=function(c){0<this.scale&&m(this._current,c,this.scale)?(this._final=c,this._to=I.clone(c),z(this._current,this._to,this.scale),this._from=I.clone(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=c);this._set("effects",this._current[0]?I.clone(this._current[0].effects):[])};H._applyTimeTransition=function(c){if(this._to&&this._from&&
this._current&&this._final){this._time+=c;c=Math.min(1,this._time/this.duration);for(let u=0;u<this._current.length;u++){const J=this._current[u],O=this._from[u],q=this._to[u];var l=O.scale;J.scale=l+(q.scale-l)*c;for(l=0;l<J.effects.length;l++)J.effects[l].interpolate(O.effects[l],q.effects[l],c)}1===c&&(this._current=this._final,this._set("effects",this._current[0]?I.clone(this._current[0].effects):[]),this._from=this._to=this._final=null)}};H._updateForScale=function(c){this._set("scale",c);if(0!==
this._current.length){var l=this._current,u=this._current.length-1,J,O=1;if(1===l.length||c>=l[0].scale)var q=J=l[0].effects;else if(c<=l[u].scale)q=J=l[u].effects;else for(let d=0;d<u;d++){const h=l[d],P=l[d+1];if(h.scale>=c&&P.scale<=c){O=(c-h.scale)/(P.scale-h.scale);J=h.effects;q=P.effects;break}}for(c=0;c<this.effects.length;c++)this.effects[c].interpolate(J[c],q[c],O)}};L._createClass(r,[{key:"effect",set:function(c){const l=this._get("effect");c=c||"";if(l!==c){this._set("effect",c);try{this._transitionTo(e(c))}catch(u){this._transitionTo([]),
G.getLogger(this).warn("Invalid Effect",{effect:c,error:u})}}}},{key:"hasEffects",get:function(){return this.transitioning||!!this.effects.length}},{key:"scale",set:function(c){this._updateForScale(c)}},{key:"transitioning",get:function(){return null!==this._to}}]);return r}(x);M.__decorate([N.property()],y.EffectView.prototype,"_to",void 0);M.__decorate([N.property()],y.EffectView.prototype,"duration",void 0);M.__decorate([N.property({value:""})],y.EffectView.prototype,"effect",null);M.__decorate([N.property({readOnly:!0})],
y.EffectView.prototype,"effects",void 0);M.__decorate([N.property({readOnly:!0})],y.EffectView.prototype,"hasEffects",null);M.__decorate([N.property({value:0})],y.EffectView.prototype,"scale",null);M.__decorate([N.property({readOnly:!0})],y.EffectView.prototype,"transitioning",null);y.EffectView=M.__decorate([g.subclass("esri.layers.effects.EffectView")],y.EffectView);y.canInterpolateEffectStops=m;y.convertEffectToStops=e;y.normalizeEffectStops=z;Object.defineProperty(y,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/support/ExportImageParameters":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/HandleOwner ../../core/sql ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./commonProperties ./floorFilterUtils ./sublayerUtils".split(" "),function(y,L,M,x,v,I,G,N,S,g,n,a,e,m){const z={visible:"visibleSublayers",definitionExpression:"layerDefs",
labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};y.ExportImageParameters=function(k){function r(c){c=k.call(this,c)||this;c.floors=null;c.scale=0;return c}L._inherits(r,k);var H=r.prototype;H.destroy=function(){this.layer=null};H.toJSON=function(){var c=this.layer;c={dpi:c.dpi,format:c.imageFormat,transparent:c.imageTransparency,gdbVersion:c.gdbVersion||
null};this.hasDynamicLayers&&this.dynamicLayers?c.dynamicLayers=this.dynamicLayers:c={...c,layers:this.layers,layerDefs:this.layerDefs};return c};L._createClass(r,[{key:"dynamicLayers",get:function(){if(!this.hasDynamicLayers)return null;const c=this.visibleSublayers.map(l=>{const u=e.getLayerFloorFilterClause(this.floors,l);return l.toExportImageJSON(u)});return c.length?JSON.stringify(c):null}},{key:"hasDynamicLayers",get:function(){return this.layer&&m.isExportDynamic(this.visibleSublayers,this.layer.serviceSublayers,
this.layer.gdbVersion)}},{key:"layer",set:function(c){this._get("layer")!==c&&(this._set("layer",c),this.handles.remove("layer"),c&&this.handles.add([c.allSublayers.on("change",()=>this.notifyChange("visibleSublayers")),c.on("sublayer-update",l=>this.notifyChange(z[l.propertyName]))],"layer"))}},{key:"layers",get:function(){const c=this.visibleSublayers;return c?c.length?"show:"+c.map(l=>l.id).join(","):"show:-1":null}},{key:"layerDefs",get:function(){const c=!!this.floors?.length,l=this.visibleSublayers.filter(u=>
null!=u.definitionExpression||c&&null!=u.floorInfo);return l.length?JSON.stringify(l.reduce((u,J)=>{var O=e.getLayerFloorFilterClause(this.floors,J);O=I.sqlAnd(O,J.definitionExpression);null!=O&&(u[J.id]=O);return u},{})):null}},{key:"version",get:function(){this.commitProperty("layers");this.commitProperty("layerDefs");this.commitProperty("dynamicLayers");this.commitProperty("timeExtent");const c=this.layer;c&&(c.commitProperty("dpi"),c.commitProperty("imageFormat"),c.commitProperty("imageTransparency"),
c.commitProperty("gdbVersion"));return(this._get("version")||0)+1}},{key:"visibleSublayers",get:function(){const c=[];if(!this.layer)return c;var l=this.layer.sublayers;const u=J=>{const O=this.scale,q=0===J.minScale||O<=J.minScale,d=0===J.maxScale||O>=J.maxScale;J.visible&&(0===O||q&&d)&&(J.sublayers?J.sublayers.forEach(u):c.unshift(J))};l&&l.forEach(u);l=this._get("visibleSublayers");return!l||l.length!==c.length||l.some((J,O)=>c[O]!==J)?c:l}}]);return r}(v.HandleOwnerMixin(x));M.__decorate([G.property({readOnly:!0})],
y.ExportImageParameters.prototype,"dynamicLayers",null);M.__decorate([G.property()],y.ExportImageParameters.prototype,"floors",void 0);M.__decorate([G.property({readOnly:!0})],y.ExportImageParameters.prototype,"hasDynamicLayers",null);M.__decorate([G.property()],y.ExportImageParameters.prototype,"layer",null);M.__decorate([G.property({readOnly:!0})],y.ExportImageParameters.prototype,"layers",null);M.__decorate([G.property({readOnly:!0})],y.ExportImageParameters.prototype,"layerDefs",null);M.__decorate([G.property({type:Number})],
y.ExportImageParameters.prototype,"scale",void 0);M.__decorate([G.property(a.combinedViewLayerTimeExtentProperty)],y.ExportImageParameters.prototype,"timeExtent",void 0);M.__decorate([G.property({readOnly:!0})],y.ExportImageParameters.prototype,"version",null);M.__decorate([G.property({readOnly:!0})],y.ExportImageParameters.prototype,"visibleSublayers",null);y.ExportImageParameters=M.__decorate([n.subclass("esri.layers.mixins.ExportImageParameters")],y.ExportImageParameters);Object.defineProperty(y,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/floorFilterUtils":function(){define(["exports"],function(y){function L(M,x){if(!M?.length)return null;M=M.filter(v=>""!==v).map(v=>`'${v}'`);M.push("''");return`${x} IN (${M.join(",")}) OR ${x} IS NULL`}y.getFloorFilterClause=function(M){const x=M.layer;return"floorInfo"in x&&x.floorInfo?.floorField&&"floors"in M.view?L(M.view.floors,x.floorInfo.floorField):null};y.getLayerFloorFilterClause=function(M,x){return"floorInfo"in x&&x.floorInfo?.floorField?
L(M,x.floorInfo.floorField):null};Object.defineProperty(y,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/sublayerUtils":function(){define(["exports","../../core/accessorSupport/PropertyOrigin"],function(y,L){function M(x,v){if(!x||!x.length||null==v)return!0;v=v.slice().reverse().flatten(({sublayers:N})=>N&&N.toArray().reverse()).map(N=>N.id).toArray();if(x.length>v.length)return!1;let I=0;const G=v.length;for(const {id:N}of x){for(;I<G&&v[I]!==N;)I++;if(I>=G)return!1}return!0}y.isExportDynamic=
function(x,v,I){return x.some(G=>{const N=G.source;return!(!N||"map-layer"===N.type&&N.mapLayerId===G.id&&(null==N.gdbVersion||N.gdbVersion===I))||G.originIdOf("renderer")>L.OriginId.SERVICE||G.originIdOf("labelingInfo")>L.OriginId.SERVICE||G.originIdOf("opacity")>L.OriginId.SERVICE||G.originIdOf("labelsVisible")>L.OriginId.SERVICE})?!0:!M(x,v)};y.isSublayerOverhaul=function(x){return!!x&&x.some(v=>null!=v.minScale||v.layerDefinition&&null!=v.layerDefinition.minScale)};y.shouldWriteSublayerStructure=
function(x,v,I){return v.flatten(({sublayers:G})=>G).length!==x.length||x.some(G=>G.originIdOf("minScale")>I||G.originIdOf("maxScale")>I||G.originIdOf("renderer")>I||G.originIdOf("labelingInfo")>I||G.originIdOf("opacity")>I||G.originIdOf("labelsVisible")>I||G.originIdOf("source")>I)?!0:!M(x,v)};Object.defineProperty(y,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/pixelRangeUtils":function(){define(["exports"],function(y){function L(x){return M[x]??[-3.4028234663852886E38,
3.4028234663852886E38]}const M={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-3.4028234663852886E38,3.4028234663852886E38],f64:[-Number.MAX_VALUE,Number.MAX_VALUE],unknown:void 0,c64:void 0,c128:void 0};y.convertNoDataToMask=function(x,v,I){if(!(x.depthCount&&1<x.depthCount)){var {pixels:G,statistics:N,pixelType:S}=x,g=G[0].length,n=x.bandMasks??[],a=x.mask??(new Uint8Array(g)).fill(255),e="f32"===S||"f64"===
S,m=L(S),z=!1;for(let H=0;H<G.length;H++){const c="number"===typeof v?v:v[H];if(null==c)continue;var k=N?.[H].maxValue??m[1];if((N?.[H].minValue??m[0])>c+Number.EPSILON||k<c-Number.EPSILON)continue;k=n[H]||(new Uint8Array(g)).fill(255);const l=G[H];var r=I?.customFloatTolerance;if(e&&0!==r){r||(r=9.999999E37<=Math.abs(c)?2E-7*Math.abs(c):"f32"===S?2**-23:Number.EPSILON);for(let u=0;u<l.length;u++)k[u]&&Math.abs(l[u]-c)<r&&(l[u]=0,k[u]=0,a[u]=0,z=!0)}else for(r=0;r<l.length;r++)k[r]&&l[r]===c&&(l[r]=
0,k[r]=0,a[r]=0,z=!0);n[H]=k}z&&(x.bandMasks=n,x.mask=a);z&&"updateStatistics"in x&&x.updateStatistics()}};y.getPixelValueRange=L;Object.defineProperty(y,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/rendererConversion":function(){define(["exports","../../core/arrayUtils","../../core/has","../../core/Error","../../symbols/support/symbolConversion"],function(y,L,M,x,v){function I(g){return null==g||"simple"===g.type||"unique-value"===g.type||"class-breaks"===g.type||"dictionary"===
g.type||"heatmap"===g.type}function G(g,n){if(!n)return null;n=Array.isArray(n)?n:[n];if(0<n.length){const a=n.map(m=>m.details.symbol.type||m.details.symbol.declaredClass).filter(m=>!!m);a.sort();const e=[];a.forEach((m,z)=>{0!==z&&m===a[z-1]||e.push(m)});return new x("renderer-conversion-3d:unsupported-symbols",`Renderer contains symbols (${e.join(", ")}) which are not supported in 3D`,{renderer:g,symbolErrors:n})}return null}function N(g,n){const a={...v.defaultTo3DOptions,...n};n=g.uniqueValueInfos?.map(m=>
v.to3D(m.symbol,a).error).filter(L.isSome);const e=v.to3D(g.defaultSymbol,a);e.error&&n?.unshift(e.error);return G(g,n)}function S(g){const n=g.classBreakInfos.map(e=>v.to3D(e.symbol).error).filter(L.isSome),a=v.to3D(g.defaultSymbol);a.error&&n.unshift(a.error);return G(g,n)}y.isSupportedRenderer3D=I;y.validateTo3D=function(g,n){if(null==g)return null;if(!I(g))return new x("renderer-conversion-3d:unsupported-renderer",`Unsupported renderer of type '${g.type||g.declaredClass}'`,{renderer:g});switch(g.type){case "simple":return G(g,
v.to3D(g.symbol).error);case "unique-value":return N(g,n);case "class-breaks":return S(g)}return null};Object.defineProperty(y,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/cimSymbolUtils":function(){define(["exports","../../Color","../cim/utils"],function(y,L,M){function x(a){a=M.toCIMSymbolJSON(a);if("CIMTextSymbol"===a?.type)return a.height??0;let e=0;if(a?.symbolLayers)for(const m of a.symbolLayers)M.isCIMMarker(m)&&null!=m.size&&m.size>e?e=m.size:M.isCIMStroke(m)&&null!=m.width&&
m.width>e?e=m.width:M.isCIMFill(m);return e}function v(a,e,m,z){if(a)if("CIMTextSymbol"===a.type)null!=a.height&&(a.height*=e);else{if(m&&a.effects)for(const k of a.effects)N(k,e);if(a.symbolLayers)for(const k of a.symbolLayers)switch(k.type){case "CIMPictureMarker":case "CIMVectorMarker":I(k,e,z);break;case "CIMPictureStroke":case "CIMSolidStroke":!z?.preserveOutlineWidth&&k.width&&(k.width*=e);break;case "CIMPictureFill":k.height&&(k.height*=e);k.offsetX&&(k.offsetX*=e);k.offsetY&&(k.offsetY*=e);
break;case "CIMHatchFill":v(k.lineSymbol,e,!0,{...z,preserveOutlineWidth:!1}),k.offsetX&&(k.offsetX*=e),k.offsetY&&(k.offsetY*=e),k.separation&&(k.separation*=e)}}}function I(a,e,m){if(a&&(a.markerPlacement&&G(a.markerPlacement,e),a.offsetX&&(a.offsetX*=e),a.offsetY&&(a.offsetY*=e),a.anchorPoint&&"Absolute"===a.anchorPointUnits&&(a.anchorPoint={x:a.anchorPoint.x*e,y:a.anchorPoint.y*e}),a.size=null!=a.size?a.size*e:0,"CIMVectorMarker"===a.type&&a.markerGraphics))for(const z of a.markerGraphics)a.scaleSymbolsProportionally||
v(z.symbol,e,!0,m)}function G(a,e){M.isCIMMarkerStrokePlacement(a)&&a.offset&&(a.offset*=e);switch(a.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":a.customEndingOffset&&(a.customEndingOffset*=e);a.offsetAlongLine&&(a.offsetAlongLine*=e);if(a.placementTemplate&&a.placementTemplate.length){var m=a.placementTemplate.map(z=>z*e);a.placementTemplate=m}break;case "CIMMarkerPlacementAlongLineVariableSize":a.maxRandomOffset&&(a.maxRandomOffset*=e);a.placementTemplate&&
a.placementTemplate.length&&(m=a.placementTemplate.map(z=>z*e),a.placementTemplate=m);break;case "CIMMarkerPlacementOnLine":a.startPointOffset&&(a.startPointOffset*=e);break;case "CIMMarkerPlacementAtExtremities":a.offsetAlongLine&&(a.offsetAlongLine*=e);break;case "CIMMarkerPlacementAtRatioPositions":a.beginPosition&&(a.beginPosition*=e);a.endPosition&&(a.endPosition*=e);break;case "CIMMarkerPlacementPolygonCenter":a.offsetX&&(a.offsetX*=e);a.offsetY&&(a.offsetY*=e);break;case "CIMMarkerPlacementInsidePolygon":a.offsetX&&
(a.offsetX*=e),a.offsetY&&(a.offsetY*=e),a.stepX&&(a.stepX*=e),a.stepY&&(a.stepY*=e)}}function N(a,e){switch(a.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":a.width&&(a.width*=e);break;case "CIMGeometricEffectBuffer":a.size&&(a.size*=e);break;case "CIMGeometricEffectCut":a.beginCut&&(a.beginCut*=e);a.endCut&&(a.endCut*=e);a.middleCut&&(a.middleCut*=e);break;case "CIMGeometricEffectDashes":a.customEndingOffset&&(a.customEndingOffset*=e);a.offsetAlongLine&&(a.offsetAlongLine*=
e);if(a.dashTemplate&&a.dashTemplate.length){const m=a.dashTemplate.map(z=>z*e);a.dashTemplate=m}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":a.length&&(a.length*=e);break;case "CIMGeometricEffectMove":a.offsetX&&(a.offsetX*=e);a.offsetY&&(a.offsetY*=e);break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":a.offset&&(a.offset*=e);break;case "CIMGeometricEffectRegularPolygon":a.radius&&(a.radius*=e);break;case "CIMGeometricEffectTaperedPolygon":a.fromWidth&&
(a.fromWidth*=e);a.length&&(a.length*=e);a.toWidth&&(a.toWidth*=e);break;case "CIMGeometricEffectWave":a.amplitude&&(a.amplitude*=e),a.period&&(a.period*=e)}}function S(a,e){if(a){var m="CIMTextSymbol"===a.type?a.symbol:a;a="CIMPolygonSymbol"===a.type;if(m?.symbolLayers)for(const z of m.symbolLayers)if(!(z.colorLocked||a&&(M.isCIMStroke(z)||M.isCIMMarker(z)&&z.markerPlacement&&M.isCIMMarkerStrokePlacement(z.markerPlacement))))switch(z.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":z.tintColor&&
g(e,z.tintColor);break;case "CIMVectorMarker":z.markerGraphics?.forEach(k=>{S(k.symbol,e)});break;case "CIMSolidStroke":case "CIMSolidFill":g(e,z.color);break;case "CIMHatchFill":S(z.lineSymbol,e)}}}function g(a,e){for(const m of a)if(m.join(".")===e.join("."))return;a.push(e)}function n(a,e,m){if(a){var z="CIMTextSymbol"===a.type?a.symbol:a;a="CIMPolygonSymbol"===z?.type;if(z?.symbolLayers)for(const k of z.symbolLayers)if(!k.colorLocked){if(a)if(m){if({layersToColor:z}=m,(M.isCIMStroke(k)||M.isCIMMarker(k)&&
k.markerPlacement&&M.isCIMMarkerStrokePlacement(k.markerPlacement))&&"fill"===z||M.isCIMFill(k)&&"outline"===z)continue}else if(M.isCIMStroke(k)||M.isCIMMarker(k)&&k.markerPlacement&&M.isCIMMarkerStrokePlacement(k.markerPlacement))continue;z=e.toArray();switch(k.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":k.tintColor=z;break;case "CIMVectorMarker":k.markerGraphics?.forEach(r=>{n(r.symbol,e,m)});break;case "CIMSolidStroke":case "CIMSolidFill":k.color=z;break;case "CIMHatchFill":n(k.lineSymbol,
e,m)}}}}y.applyCIMSymbolColor=function(a,e,m){e instanceof L||(e=new L(e));(a=M.toCIMSymbolJSON(a))&&n(a,e,m)};y.applyCIMSymbolRotation=function(a,e,m=!1){a=M.toCIMSymbolJSON(a);m&&0!==e&&(e=360-e);if("CIMTextSymbol"===a?.type)a.angle=e;else if("CIMPointSymbol"===a?.type&&a.symbolLayers){m=e-(a.angle||0);for(const z of a.symbolLayers)if(M.isCIMMarker(z)){let k=z.rotation||0;k=z.rotateClockwise?k-m:k+m;z.rotation=k}a.angle=e}};y.getCIMSymbolColor=function(a){a=M.toCIMSymbolJSON(a);const e=[];S(a,e);
return e.length?new L(M.fromCIMColor(e[0])):null};y.getCIMSymbolRotation=function(a,e=!1){a=M.toCIMSymbolJSON(a);return"CIMTextSymbol"===a?.type||"CIMPointSymbol"===a?.type?(a=a.angle,null!=a&&0!==a&&e?360-a:a??0):0};y.getCIMSymbolSize=x;y.getCIMSymbolType=function(a){a=M.toCIMSymbolJSON(a);if(!a)return null;switch(a.type){case "CIMPointSymbol":return"CIMPointSymbol";case "CIMLineSymbol":return"CIMLineSymbol";case "CIMPolygonSymbol":return"CIMPolygonSymbol";case "CIMTextSymbol":return"CIMTextSymbol";
case "CIMMeshSymbol":return"CIMMeshSymbol";default:return null}};y.scaleCIMMarker=I;y.scaleCIMSymbol=v;y.scaleCIMSymbolTo=function(a,e,m){if(a){var z=M.toCIMSymbolJSON(a);a=x(a);if(0===a){if(z)if("CIMTextSymbol"===z.type)z.height=e;else if(z.symbolLayers)for(const k of z.symbolLayers)switch(k.type){case "CIMPictureMarker":case "CIMVectorMarker":k.size=e;break;case "CIMPictureStroke":case "CIMSolidStroke":k.width=e}}else v(z,e/a,!1,m)}};Object.defineProperty(y,Symbol.toStringTag,{value:"Module"})})},
"esri/symbols/cim/utils":function(){define(["require","exports"],function(y,L){function M(a){return"function"===typeof a}function x(a){let e=a.length;for(;e--;)if(!" /-,\n".includes(a.charAt(e)))return!1;return!0}function v(a,e){const m=[];var z=0;let k=-1;do k=a.indexOf("[",z),k>=z&&(k>z&&(z=a.substr(z,k-z),m.push([z,null,x(z)])),z=k+1,k=a.indexOf("]",z),k>=z&&(k>z&&(z=a.substr(z,k-z),(z=e[z])&&m.push([null,z,!1])),z=k+1));while(-1!==k);z<a.length-1&&(a=a.substr(z),m.push([a,null,x(a)]));return m}
function I(a,e,m){let z="",k=null;for(const r of e){const [H,c,l]=r;if(H)l?k=H:(k&&(z+=k,k=null),z+=H);else if(e=a.attributes[c])k&&(z+=k,k=null),z+=e}return G(z,m)}function G(a,e){"string"!==typeof a&&(a=String(a));switch(e){case "LowerCase":return a.toLowerCase();case "Allcaps":return a.toUpperCase();default:return a}}function N(a){return a?{r:a[0],g:a[1],b:a[2],a:a[3]/255}:{r:0,g:0,b:0,a:0}}function S(a){if(!a)return null;switch(a.type){case "CIMPolygonSymbol":if(a.symbolLayers)for(const e of a.symbolLayers)if(a=
S(e),null!=a)return a;break;case "CIMTextSymbol":return S(a.symbol);case "CIMSolidFill":return a.color}}function g(a){if(a)switch(a.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(a=a.symbolLayers)for(const e of a)if(a=g(e),null!=a)return a;break;case "CIMTextSymbol":return g(a.symbol);case "CIMSolidStroke":return a.color}}function n(a){if(a)switch(a.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(a.symbolLayers)for(const e of a.symbolLayers)if(a=n(e),void 0!==a)return a;break;case "CIMTextSymbol":return n(a.symbol);
case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return a.width}}L.adjustTextCase=G;L.analyzeTextParts=v;L.assignTextValuesFromFeature=I;L.attributesToFields=function(a){return(a?Object.keys(a):[]).map(e=>({name:e,alias:e,type:"string"===typeof a[e]?"esriFieldTypeString":"esriFieldTypeDouble"}))};L.colorToArray=function(a){return[a.r,a.g,a.b,a.a]};L.createLabelOverrideFunction=function(a,e,m){const z=v(e,a);return k=>I(k,z,m)};L.evaluateValueOrFunction=function(a,e,m,z){return M(a)?
a(e,m,z):a};L.fromCIMColor=N;L.fromCIMFontDecoration=function(a){return a.underline?"underline":a.strikethrough?"line-through":"none"};L.fromCIMFontStyle=function(a){let e="normal",m="normal";a&&(a=a.toLowerCase(),a.includes("italic")?e="italic":a.includes("oblique")&&(e="oblique"),a.includes("bold")?m="bold":a.includes("light")&&(m="lighter"));return{style:e,weight:m}};L.fromCIMHorizontalAlignment=function(a){switch(a){default:return"left";case "Right":return"right";case "Center":return"center";
case "Justify":return"center"}};L.fromCIMVerticalAlignment=function(a){switch(a){default:return"top";case "Center":return"middle";case "Baseline":return"baseline";case "Bottom":return"bottom"}};L.getFillColor=S;L.getFontStyle=function(a){if(!a)return"normal";switch(a.toLowerCase()){case "italic":return"italic";case "oblique":return"oblique";default:return"normal"}};L.getFontWeight=function(a){if(!a)return"normal";switch(a.toLowerCase()){case "bold":return"bold";case "bolder":return"bolder";case "lighter":return"lighter";
default:return"normal"}};L.getStrokeColor=g;L.getStrokeWidth=n;L.getTintColor=a=>a.tintColor?N(a.tintColor):{r:255,g:255,b:255,a:1};L.getValue=(a,e=0)=>null==a||isNaN(a)?e:a;L.importGeometryEngine=function(){return new Promise((a,e)=>y(["../../geometry/geometryEngineJSON"],a,e))};L.isCIMFill=function(a){return null!=a&&("CIMGradientFill"===a.type||"CIMHatchFill"===a.type||"CIMPictureFill"===a.type||"CIMSolidFill"===a.type||"CIMWaterFill"===a.type)};L.isCIMMarker=function(a){return"CIMVectorMarker"===
a.type||"CIMPictureMarker"===a.type||"CIMBarChartMarker"===a.type||"CIMCharacterMarker"===a.type||"CIMPieChartMarker"===a.type||"CIMStackedBarChartMarker"===a.type};L.isCIMMarkerStrokePlacement=function(a){return null!=a&&("CIMMarkerPlacementAlongLineRandomSize"===a.type||"CIMMarkerPlacementAlongLineSameSize"===a.type||"CIMMarkerPlacementAlongLineVariableSize"===a.type||"CIMMarkerPlacementAtExtremities"===a.type||"CIMMarkerPlacementAtMeasuredUnits"===a.type||"CIMMarkerPlacementAtRatioPositions"===
a.type||"CIMMarkerPlacementOnLine"===a.type||"CIMMarkerPlacementOnVertices"===a.type)};L.isCIMStroke=function(a){return"CIMGradientStroke"===a.type||"CIMPictureStroke"===a.type||"CIMSolidStroke"===a.type};L.isFeatureValueFn=M;L.isGeometryEngineRequired=a=>{if(!a)return!1;for(const e of a)switch(e.type){case "CIMGeometricEffectBuffer":case "CIMGeometricEffectOffset":case "CIMGeometricEffectDonut":return!0}return!1};L.isSVGImage=a=>a.includes("data:image/svg+xml");L.mapCIMSymbolToGeometryType=function(a){if(!a)return null;
switch(a.type){case "CIMPointSymbol":case "CIMTextSymbol":return"esriGeometryPoint";case "CIMLineSymbol":return"esriGeometryPolyline";case "CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}};L.resampleHermite=function(a,e,m,z,k,r,H=!0){const c=e/k;m/=r;const l=Math.ceil(c/2),u=Math.ceil(m/2);for(let q=0;q<r;q++)for(let d=0;d<k;d++){const h=4*(d+(H?r-q-1:q)*k);var J=0;let P=0,B=0,p=0,E=0,K=0,R=0;const X=(q+.5)*m;for(let W=Math.floor(q*m);W<(q+1)*m;W++){var O=Math.abs(X-(W+.5))/u;const f=
(d+.5)*c;O*=O;for(let D=Math.floor(d*c);D<(d+1)*c;D++){let C=Math.abs(f-(D+.5))/l;J=Math.sqrt(O+C*C);-1<=J&&1>=J&&(J=2*J*J*J-3*J*J+1,0<J&&(C=4*(D+W*e),R+=J*a[C+3],B+=J,255>a[C+3]&&(J=J*a[C+3]/250),p+=J*a[C],E+=J*a[C+1],K+=J*a[C+2],P+=J))}}z[h]=p/P;z[h+1]=E/P;z[h+2]=K/P;z[h+3]=R/B}};L.toCIMSymbolJSON=function(a){return a.data?.symbol??null};Object.defineProperty(L,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/previewUtils":function(){define(["exports","../../Color"],function(y,L){function M(x,
v){return Math.round(Math.min(Math.max(x+191.25*v,0),255))}y.SymbolSizeDefaults=void 0;(function(x){x[x.size=22]="size";x[x.lineWidth=50]="lineWidth";x[x.maxSize=120]="maxSize";x[x.maxOutlineSize=80]="maxOutlineSize";x[x.tallSymbolWidth=20]="tallSymbolWidth"})(y.SymbolSizeDefaults||(y.SymbolSizeDefaults={}));y.adjustColorBrightness=function(x,v){if(null==x)return new L;if("type"in x&&("linear"===x.type||"pattern"===x.type))return x;x=new L(x);return new L([M(x.r,v),M(x.g,v),M(x.b,v),x.a])};y.adjustColorComponentBrightness=
M;y.getConeShapes=function(x,v){let I=v?y.SymbolSizeDefaults.tallSymbolWidth:x;v=v?4:6;I=I<=y.SymbolSizeDefaults.size?I-.5*v:I-v;v=.15*I;const G=I;x-=v;return[{type:"ellipse",cx:.5*I,cy:x,rx:.5*I,ry:v},{type:"path",path:[{command:"M",values:[.5*G,0]},{command:"L",values:[G,x]},{command:"L",values:[0,x]},{command:"Z",values:[]}]}]};y.getCubeShapes=function(x,v){let I=v?y.SymbolSizeDefaults.tallSymbolWidth:x;var G=v?4:6;G=I=I<=y.SymbolSizeDefaults.size?I-.5*G:I-G;v=v?.35*I:.5*I;return[{type:"path",
path:[{command:"M",values:[.5*G,0]},{command:"L",values:[G,.5*v]},{command:"L",values:[.5*G,v]},{command:"L",values:[0,.5*v]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*v]},{command:"L",values:[.5*G,v]},{command:"L",values:[.5*G,x]},{command:"L",values:[0,x-.5*v]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*G,v]},{command:"L",values:[.5*G,x]},{command:"L",values:[G,x-.5*v]},{command:"L",values:[G,.5*v]},{command:"Z",values:[]}]}]};y.getCylinderShapes=
function(x,v){var I=v?y.SymbolSizeDefaults.tallSymbolWidth:x;v=v?4:6;I=I<=y.SymbolSizeDefaults.size?I-.5*v:I-v;v=.5*I;const G=.15*I;x-=G;return[{type:"ellipse",cx:.5*I,cy:x,rx:v,ry:G},{type:"path",path:[{command:"M",values:[0,G]},{command:"L",values:[0,x]},{command:"L",values:[I,x]},{command:"L",values:[I,G]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*I,cy:G,rx:v,ry:G}]};y.getDiamondShapes=function(x){var v=x;v=v<y.SymbolSizeDefaults.size?v-2:v-4;const I=Math.floor(x/10)-1||1;return[{type:"path",
path:[{command:"M",values:[.45*v,0]},{command:"L",values:[v,.5*x-I]},{command:"L",values:[.45*v-I,.5*x+I]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*v,0]},{command:"L",values:[.45*v-I,.5*x+I]},{command:"L",values:[0,.5*x-I]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*x-I]},{command:"L",values:[.45*v-I,.5*x+I]},{command:"L",values:[.45*v,x]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*v,x]},{command:"L",values:[v,.5*
x-I]},{command:"L",values:[.45*v-I,.5*x+I]},{command:"Z",values:[]}]}]};y.getExtrudeSymbolShapes=function(x){const v=y.SymbolSizeDefaults.size;x*=.5;return[{type:"path",path:[{command:"M",values:[0,.35*v]},{command:"L",values:[.3*v,.7*v]},{command:"L",values:[.3*v,.7*v+x]},{command:"L",values:[0,.7*v+x-.35*v]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*v,.7*v]},{command:"L",values:[.3*v,.7*v+x]},{command:"L",values:[v,x]},{command:"L",values:[v,0]},{command:"Z",values:[]}]},
{type:"path",path:[{command:"M",values:[.3*v,0]},{command:"L",values:[v,0]},{command:"L",values:[.3*v,.7*v]},{command:"L",values:[0,.35*v]},{command:"Z",values:[]}]}]};y.getInvertedConeShapes=function(x){let v=x;v=v<y.SymbolSizeDefaults.size?v-3:v-6;const I=.15*v,G=v;return[{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[G,0]},{command:"L",values:[.5*G,x-I]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*v,cy:0,rx:.5*v,ry:I}]};y.getPathSymbolShapes=function(x,v,I){var G=y.SymbolSizeDefaults.size;
let N=G,S=G;1>x?N*=.75:1<x&&(S*=1.25);x=G;v&&I&&(N=S=x=G=0);return[{type:"path",path:[{command:"M",values:[x,0]},{command:"L",values:[I?x:.875*x,0]},{command:"L",values:[I?N-.5*x:0,S-.5*G]},{command:"L",values:[N-.5*x,S-.5*G]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[x,0]},{command:"L",values:[x,v?0:.125*G]},{command:"L",values:[N-.5*x,v?S-.5*G:G]},{command:"L",values:[N-.5*x,S-.5*G]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[N-.5*x,S-.5*G]},{command:"L",
values:[I?N-.5*x:0,S-.5*G]},{command:"L",values:[I?N-.5*x:0,v?S-.5*G:G]},{command:"L",values:[N-.5*x,v?S-.5*G:G]},{command:"Z",values:[]}]}]};y.getTetrahedronShapes=function(x){var v=x;v=v<y.SymbolSizeDefaults.size?v-1:v-2;return[{type:"path",path:[{command:"M",values:[.45*x,0]},{command:"L",values:[x,v]},{command:"L",values:[.45*x,.6*v]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*x,0]},{command:"L",values:[.45*x,.6*v]},{command:"L",values:[0,v]},{command:"Z",values:[]}]},
{type:"path",path:[{command:"M",values:[0,v]},{command:"L",values:[.45*x,.6*v]},{command:"L",values:[x,v]},{command:"Z",values:[]}]}]};y.getWaterSymbolShapes=function(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},{type:"path",
path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},
{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]};
y.shapes={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],squareFill:[{type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],
cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],
tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",
path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};Object.defineProperty(y,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/renderUtils":function(){define("exports ../../kernel ../../request ../../core/colorUtils ../../core/Error ../../core/has ../../libs/maquette/projection ../../libs/maquette/projector ./svgUtils ./utils".split(" "),
function(y,L,M,x,v,I,G,N,S,g){function n(m,z){e.append(m,z);e.detach(z)}function a(m,z,k){return m?M(m,{responseType:"image"}).then(r=>{r=r.data;const H=r.width,c=r.height,l=H/c;let u=z;k&&(u=Math.min(u,Math.max(H,c)));return{image:r,width:1>=l?Math.ceil(u*l):u,height:1>=l?u:Math.ceil(u/l)}}):Promise.reject(new v("renderUtils: imageDataSize","href not provided."))}const e=N.createProjector();y.renderOnce=n;y.renderSymbol=function(m,z,k){const r=Math.ceil(z[0]),H=Math.ceil(z[1]);if(!m.some(c=>!!c.length))return null;
z=k&&k.node||document.createElement("div");null!=k.opacity&&(z.style.opacity=k.opacity.toString());null!=k.effectView&&(z.style.filter=g.getCSSFilterFromEffectList(k.effectView));n(z,()=>S.renderSVG(m,r,H,k));return z};y.tintImageWithColor=function(m,z,k,r,H){return a(m,z,H).then(c=>{const l=c.width??z,u=c.height??z;var J;if(J=c.image)J=k&&"ignore"!==r?"multiply"===r&&255===k.r&&255===k.g&&255===k.b&&1===k.a?!1:!0:!1;if(J){var O=c.image.width,q=c.image.height;I("edge")&&/\.svg$/i.test(m)&&(--O,--q);
J=Math.ceil(l);var d=Math.ceil(u);var h=document.createElement("canvas");h.width=J;h.height=d;h.style.width=J+"px";h.style.height=d+"px";h=h.getContext("2d");h.clearRect(0,0,J,d);J=h;J.drawImage(c.image,0,0,O,q,0,0,l,u);d=J.getImageData(0,0,l,u);h=[k.r/255,k.g/255,k.b/255,k.a];const B=x.toHSV(k);for(let p=0;p<d.data.length;p+=4){c=d.data;O=p;q=h;var P=B;switch(r){case "multiply":c[O]*=q[0];c[O+1]*=q[1];c[O+2]*=q[2];c[O+3]*=q[3];break;default:const E=x.toHSV({r:c[O],g:c[O+1],b:c[O+2]});E.h=P.h;E.s=
P.s;E.v=E.v/100*P.v;P=x.toRGB(E);c[O]=P.r;c[O+1]=P.g;c[O+2]=P.b;c[O+3]*=q[3]}}J.putImageData(d,0,0);m=J.canvas.toDataURL("image/png")}else(J=L.id&&L.id.findCredential(m))&&J.token&&(c=m.includes("?")?"\x26":"?",m=`${m}${c}token=${J.token}`);return{url:m,width:l,height:u}}).catch(()=>({url:m,width:z,height:z}))};Object.defineProperty(y,Symbol.toStringTag,{value:"Module"})})},"esri/core/colorUtils":function(){define(["exports"],function(y){function L(g,n){const a=[];let e,m;if(g[0].length!==n.length)throw Error("dimensions do not match");
const z=g.length,k=g[0].length;let r=0;for(e=0;e<z;e++){for(m=r=0;m<k;m++)r+=g[e][m]*n[m];a.push(r)}return a}function M(g){g=[g.r/255,g.g/255,g.b/255].map(n=>.04045>=n?n/12.92:((n+.055)/1.055)**2.4);g=L(N,g);return{x:100*g[0],y:100*g[1],z:100*g[2]}}function x(g){g=L(S,[g.x/100,g.y/100,g.z/100]).map(n=>Math.min(1,Math.max(.0031308>=n?12.92*n:1.055*n**(1/2.4)-.055,0)));return{r:Math.round(255*g[0]),g:Math.round(255*g[1]),b:Math.round(255*g[2])}}function v(g){g=[g.x/95.047,g.y/100,g.z/108.883].map(n=>
n>(6/29)**3?n**(1/3):1/3*(29/6)**2*n+4/29);return{l:116*g[1]-16,a:500*(g[0]-g[1]),b:200*(g[1]-g[2])}}function I(g){const n=g.l;g=[(n+16)/116+g.a/500,(n+16)/116,(n+16)/116-g.b/200].map(a=>a>6/29?a**3:3*(6/29)**2*(a-4/29));return{x:95.047*g[0],y:100*g[1],z:108.883*g[2]}}function G(g){if("r"in g&&"g"in g&&"b"in g)return g;if("l"in g&&"c"in g&&"h"in g){var n=g.c,a=g.h;return x(I({l:g.l,a:n*Math.cos(a),b:n*Math.sin(a)}))}if("l"in g&&"a"in g&&"b"in g)return x(I(g));if("x"in g&&"y"in g&&"z"in g)return x(g);
if("h"in g&&"s"in g&&"v"in g){a=(g.h+360)%360/60;n=g.v/100*255;g=g.s/100*n;const e=g*(1-Math.abs(a%2-1));switch(Math.floor(a)){case 0:a={r:g,g:e,b:0};break;case 1:a={r:e,g,b:0};break;case 2:a={r:0,g,b:e};break;case 3:a={r:0,g:e,b:g};break;case 4:a={r:e,g:0,b:g};break;case 5:case 6:a={r:g,g:0,b:e};break;default:a={r:0,g:0,b:0}}a.r=Math.round(a.r+n-g);a.g=Math.round(a.g+n-g);a.b=Math.round(a.b+n-g);return a}return g}const N=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],S=[[3.2406,-1.5372,
-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];y.toHSV=function(g){if("h"in g&&"s"in g&&"v"in g)return g;var n=G(g);g=n.r;const a=n.g,e=n.b;n=Math.max(g,a,e);const m=n-Math.min(g,a,e);g=0===m?0:n===g?(a-e)/m%6:n===a?(e-g)/m+2:(g-a)/m+4;0>g&&(g+=6);return{h:60*g,s:100*(0===m?0:m/n),v:100/255*n}};y.toLAB=function(g){return"l"in g&&"a"in g&&"b"in g?g:v(M(G(g)))};y.toLCH=function(g){if(!("l"in g&&"c"in g&&"h"in g)){var n=v(M(G(g)));g=n.l;var a=n.a;const e=n.b;n=Math.sqrt(a*a+e*e);a=Math.atan2(e,a);
a=0<a?a:a+2*Math.PI;g={l:g,c:n,h:a}}return g};y.toRGB=G;y.toXYZ=function(g){return"x"in g&&"y"in g&&"z"in g?g:M(G(g))};Object.defineProperty(y,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/svgUtils":function(){define("exports ../../Color ../../core/has ../../core/maybe ../../chunks/mat2df32 ../../chunks/mat2d ../../widgets/support/widgetUtils ../../widgets/support/jsxFactory".split(" "),function(y,L,M,x,v,I,G,N){function S(f,D){f*=X/180;return Math.abs(D*Math.sin(f))+Math.abs(D*Math.cos(f))}
function g(f){return f.map(D=>`${D.command} ${D.values.join(" ")}`).join(" ").trim()}function n(f,D,C,w){if(f){if("circle"===f.type)return N.tsx("circle",{fill:D,"fill-rule":"evenodd",stroke:C.color,"stroke-width":C.width,"stroke-linecap":C.cap,"stroke-linejoin":C.join,"stroke-dasharray":C.dashArray,"stroke-dashoffset":C.dashOffset,"stroke-miterlimit":"4",cx:f.cx,cy:f.cy,r:f.r});if("ellipse"===f.type)return N.tsx("ellipse",{fill:D,"fill-rule":"evenodd",stroke:C.color,"stroke-width":C.width,"stroke-linecap":C.cap,
"stroke-linejoin":C.join,"stroke-dasharray":C.dashArray,"stroke-miterlimit":"4",cx:f.cx,cy:f.cy,rx:f.rx,ry:f.ry});if("rect"===f.type)return N.tsx("rect",{fill:D,"fill-rule":"evenodd",stroke:C.color,"stroke-width":C.width,"stroke-linecap":C.cap,"stroke-linejoin":C.join,"stroke-dasharray":C.dashArray,"stroke-miterlimit":"4",x:f.x,y:f.y,width:f.width,height:f.height});if("image"===f.type)return N.tsx("image",{href:f.src,x:f.x,y:f.y,width:f.width,height:f.height,preserveAspectRatio:"none"});if("path"===
f.type)return f="string"!==typeof f.path?g(f.path):f.path,N.tsx("path",{fill:D,"fill-rule":"evenodd",stroke:C.color,"stroke-width":C.width,"stroke-linecap":C.cap,"stroke-linejoin":C.join,"stroke-dasharray":C.dashArray,"stroke-miterlimit":"4",d:f});if("text"===f.type)return x.assertIsSome(w),N.tsx("text",{"dominant-baseline":w.dominantBaseline,fill:D,"fill-rule":"evenodd",stroke:C.color,"stroke-width":C.width,"stroke-linecap":C.cap,"stroke-linejoin":C.join,"stroke-dasharray":C.dashArray,"stroke-miterlimit":"4",
"text-anchor":w.align,"text-decoration":w.decoration,kerning:w.kerning,rotate:w.rotate,"text-rendering":P,"font-style":w.font.style,"font-variant":w.font.variant,"font-weight":w.font.weight,"font-size":w.font.size,"font-family":w.font.family,x:f.x,y:f.y},f.text)}return null}function a(f){const D={fill:"none",pattern:null,linearGradient:null};if(f)if("type"in f&&"pattern"===f.type){var C=`patternId-${++d}`;D.fill=`url(#${C})`;D.pattern={id:C,x:f.x,y:f.y,width:f.width,height:f.height,image:{x:0,y:0,
width:f.width,height:f.height,href:f.src}}}else"type"in f&&"linear"===f.type?(C=`linearGradientId-${++h}`,D.fill=`url(#${C})`,D.linearGradient={id:C,x1:f.x1,y1:f.y1,x2:f.x2,y2:f.y2,stops:f.colors.map(w=>({offset:w.offset,color:w.color&&(new L(w.color)).toString()}))}):f&&(f=new L(f),D.fill=f.toString());return D}function e(f){const D={color:"none",width:1,cap:"butt",join:"4",dashArray:"none",dashOffset:"0"};if(f&&(null!=f.width&&(D.width=f.width),f.cap&&(D.cap=f.cap),f.join&&(D.join=f.join.toString()),
f.color&&(D.color=(new L(f.color)).toString()),f.dashArray&&(D.dashArray=f.dashArray),f.dashArray&&(D.dashOffset=f.dashoffset),f.style)){let C=null;f.style in R&&(C=R[f.style]);if(Array.isArray(C)){C=C.slice(0);const w=f.width??0;for(let F=0;F<C.length;++F)C[F]*=w;if("butt"!==f.cap){for(f=0;f<C.length;f+=2)C[f]-=w,1>C[f]&&(C[f]=1);for(f=1;f<C.length;f+=2)C[f]+=w}C=C.join(",")}D.dashArray=C}return D}function m(f,D){const C={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,
weight:null,size:null,family:null}};if(f){const w=f.alignBaseline;C.align=f.align;C.dominantBaseline="baseline"===w?"auto":"top"===w?"text-top":"bottom"===w?"hanging":w;C.decoration=f.decoration;C.kerning=f.kerning?"auto":"0";C.rotate=f.rotated?"90":"0";x.assertIsSome(D);C.font.style=D.style||"normal";C.font.variant=D.variant||"normal";C.font.weight=D.weight||"normal";C.font.size=D.size&&D.size.toString()||"10pt";C.font.family=D.family||"serif"}return C}function z(f){const {pattern:D,linearGradient:C}=
f;return D?N.tsx("pattern",{id:D.id,patternUnits:"userSpaceOnUse",x:D.x,y:D.y,width:D.width,height:D.height},N.tsx("image",{x:D.image.x,y:D.image.y,width:D.image.width,height:D.image.height,href:D.image.href})):C?(f=C.stops.map((w,F)=>N.tsx("stop",{key:`${F}-stop`,offset:w.offset,"stop-color":w.color})),N.tsx("linearGradient",{id:C.id,gradientUnits:"userSpaceOnUse",x1:C.x1,y1:C.y1,x2:C.x2,y2:C.y2},f)):null}function k(f,D){if(!f||0===f.length)return null;const C=[];for(const w of f){const {shape:F,
fill:U,stroke:Z,font:fa}=w;f=a(U);const ca=e(Z),ka="text"===F.type?m(F,fa):null;(f=n(F,f.fill,ca,ka))&&C.push(f)}return N.tsx("mask",{id:D,maskUnits:"userSpaceOnUse"},N.tsx("g",null,C))}function r(f,D,C,w,F){I.scale(f,I.identity(f),[D,C]);f[4]=f[4]*D-w*D+w;f[5]=f[5]*C-F*C+F;return f}function H(f,D){if(E&&"left"in E){null!=E.left&&E.left>f&&(E.left=f);if(null==E.right||E.right<f)E.right=f;if(null==E.top||E.top>D)E.top=D;if(null==E.bottom||E.bottom<D)E.bottom=D}else E={left:f,bottom:D,right:f,top:D}}
function c(f){const D=f.args,C=D.length;switch(f.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(f=0;f<C;f+=2)H(D[f],D[f+1]);K.x=D[C-2];K.y=D[C-1];break;case "H":for(f=0;f<C;++f)H(D[f],K.y);K.x=D[C-1];break;case "V":for(f=0;f<C;++f)H(K.x,D[f]);K.y=D[C-1];break;case "m":f=0;"x"in K||(H(K.x=D[0],K.y=D[1]),f=2);for(;f<C;f+=2)H(K.x+=D[f],K.y+=D[f+1]);break;case "l":case "t":for(f=0;f<C;f+=2)H(K.x+=D[f],K.y+=D[f+1]);break;case "h":for(f=0;f<C;++f)H(K.x+=D[f],K.y);break;case "v":for(f=
0;f<C;++f)H(K.x,K.y+=D[f]);break;case "c":for(f=0;f<C;f+=6)H(K.x+D[f],K.y+D[f+1]),H(K.x+D[f+2],K.y+D[f+3]),H(K.x+=D[f+4],K.y+=D[f+5]);break;case "s":case "q":for(f=0;f<C;f+=4)H(K.x+D[f],K.y+D[f+1]),H(K.x+=D[f+2],K.y+=D[f+3]);break;case "A":for(f=0;f<C;f+=7)H(D[f+5],D[f+6]);K.x=D[C-2];K.y=D[C-1];break;case "a":for(f=0;f<C;f+=7)H(K.x+=D[f+5],K.y+=D[f+6])}}function l(f,D,C){const w=B[f.toLowerCase()];"number"===typeof w&&(w?D.length>=w&&(f={action:f,args:D.slice(0,D.length-D.length%w)},C.push(f),c(f)):
(f={action:f,args:[]},C.push(f),c(f)))}function u(f){const D={x:0,y:0,width:0,height:0};if("circle"===f.type)D.x=f.cx-f.r,D.y=f.cy-f.r,D.width=2*f.r,D.height=2*f.r;else if("ellipse"===f.type)D.x=f.cx-f.rx,D.y=f.cy-f.ry,D.width=2*f.rx,D.height=2*f.ry;else if("image"===f.type||"rect"===f.type)D.x=f.x,D.y=f.y,D.width=f.width,D.height=f.height;else if("path"===f.type){var C=x.unwrapOrThrow;{const U=("string"!==typeof f.path?g(f.path):f.path).match(p),Z=[];E={};K={};if(U){f="";var w=[],F=U.length;for(let fa=
0;fa<F;++fa){const ca=U[fa],ka=parseFloat(ca);isNaN(ka)?(f&&l(f,w,Z),w=[],f=ca):w.push(ka)}l(f,w,Z);f={x:0,y:0,width:0,height:0};E&&"left"in E&&(f.x=E.left,f.y=E.top,f.width=E.right-E.left,f.height=E.bottom-E.top)}else f=null}C=C.call(x,f);D.x=C.x;D.y=C.y;D.width=C.width;D.height=C.height}return D}function J(f){const D={x:0,y:0,width:0,height:0};let C=null,w=Number.NEGATIVE_INFINITY,F=Number.NEGATIVE_INFINITY;for(const U of f)C?(C.x=Math.min(C.x,U.x),C.y=Math.min(C.y,U.y),w=Math.max(w,U.x+U.width),
F=Math.max(F,U.y+U.height)):(C=D,C.x=U.x,C.y=U.y,w=U.x+U.width,F=U.y+U.height);C&&(C.width=w-C.x,C.height=F-C.y);return C}function O(f,D,C,w,F,U,Z,fa,ca){var ka=(Z&&U?S(U,D):D)/2,na=(Z&&U?S(U,C):C)/2;if(ca){var ia=ca[0];ca=ca[1];ka=(Z&&U?S(U,ia):ia)/2;na=(Z&&U?S(U,ca):ca)/2}ia=f.width+w;var Y=f.height+w;ca=v.create();Z=v.create();var ha=!1;if(F&&0!==ia&&0!==Y){F=D!==C?D/C:ia/Y;ha=D>C?D:C;let la=1,oa=1;isNaN(ha)||(1<F?(la=ha/ia,oa=ha/F/Y):(oa=ha/Y,la=ha*F/ia));I.multiply(Z,Z,r(ca,la,oa,ka,na));ha=
!0}F=f.x+(ia-w)/2;f=f.y+(Y-w)/2;w=I.multiply;ka-=F;na-=f;ka=I.translate(ca,I.identity(ca),[ka,na]);w.call(I,Z,Z,ka);!ha&&(ia>D||Y>C)&&(ka=ia/D>Y/C,D=(ka?D:C)/(ka?ia:Y),I.multiply(Z,Z,r(ca,D,D,F,f)));U&&(D=I.multiply,C=U%360*Math.PI/180,I.rotate(ca,I.identity(ca),C),U=Math.cos(C),C=Math.sin(C),ia=ca[4],Y=ca[5],ca[4]=ia*U-Y*C+f*C-F*U+F,ca[5]=Y*U+ia*C-F*C-f*U+f,D.call(I,Z,Z,ca));fa&&(U=I.multiply,D=fa[0],fa=fa[1],fa=I.translate(ca,I.identity(ca),[D,fa]),U.call(I,Z,Z,fa));return`matrix(${Z[0]},${Z[1]},${Z[2]},${Z[3]},${Z[4]},${Z[5]})`}
function q(f,D,C){f=f?.effects.find(fa=>"bloom"===fa.type);if(!f)return null;const {strength:w,radius:F}=f;f=0<w?F:0;const U=(w+f)*D,Z=4*w+1;return N.tsx("filter",{id:`bloom${C}`,x:"-100%",y:"-100%",width:"300%",height:"300%",filterUnits:"userSpaceOnUse"},N.tsx("feMorphology",{operator:"dilate",radius:(w+.5*f)*5**(D/100)*(.4+D/100),in:"SourceGraphic",result:"dilate"}),N.tsx("feGaussianBlur",{in:"dilate",stdDeviation:U/25,result:"blur"}),N.tsx("feGaussianBlur",{in:"blur",stdDeviation:U/50,result:"intensityBlur"}),
N.tsx("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},N.tsx("feFuncR",{type:"linear",slope:Z}),N.tsx("feFuncG",{type:"linear",slope:Z}),N.tsx("feFuncB",{type:"linear",slope:Z})),N.tsx("feMerge",null,N.tsx("feMergeNode",{in:"intensityBlur"}),N.tsx("feMergeNode",{in:"intensityBrightness"}),N.tsx("feGaussianBlur",{stdDeviation:w/10})))}let d=0,h=0;G=M("android");const P=M("chrome")||G&&4<=G?"auto":"optimizeLegibility",B={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},p=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;
let E={},K={};const R={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]},X=Math.PI;let W=1;y.computeBBox=J;y.generateFillAttributes=a;y.generateStrokeAttributes=e;y.generateTextAttributes=m;y.getBoundingBox=u;y.getTransformMatrix=O;y.renderDef=z;y.renderSVG=function(f,D,C,w={}){const F=[],U=[],Z=++W,fa=q(w.effectView,D,Z);var ca=null;fa&&(ca=w.effectView?.effects.find(ha=>
"bloom"===ha.type),ca=(ca.strength?ca.strength+ca.radius/2:0)/3,ca=[Math.max(D+D*ca,10),Math.max(C+C*ca,10)]);for(let ha=0;ha<f.length;ha++){var ka=f[ha];const la=[];var na=[],ia=0,Y=0;let oa=0;for(const ta of ka){const {shape:ua,fill:wa,stroke:ya,font:Aa,offset:Da}=ta;w.ignoreStrokeWidth||"text"===ua.type||(ia+=ya&&ya.width||0);ka=a(wa);const Ia=e(ya),Ja="text"===ua.type?m(ua,Aa):null;F.push(z(ka));la.push(n(ua,ka.fill,Ia,Ja));na.push(u(ua));Da&&(Y+=Da[0],oa+=Da[1])}na=x.unwrapOrThrow(J(na));ia=
O(na,D,C,ia,w.scale??!1,w.rotation,w.useRotationSize??!1,[Y,oa],ca);Y=null;w.masking&&(Y=`mask-${ha}`,F.push(k(w.masking[ha],Y)),Y=`url(#${Y})`);U.push(Y?N.tsx("g",{mask:Y},N.tsx("g",{transform:ia},la)):N.tsx("g",{transform:ia},la))}w.useRotationSize&&w.rotation&&(D=S(w.rotation,D),C=S(w.rotation,C));fa&&(x.assertIsSome(ca),D=ca[0],C=ca[1]);return N.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:D,height:C,style:"display: block;","aria-labelledby":w.ariaLabel,role:"img",focusable:!1},fa,N.tsx("defs",
null,F),fa?N.tsx("g",{filter:`url(#bloom${Z})`},U):U)};y.renderShape=n;Object.defineProperty(y,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/mat2df32":function(){define(["exports"],function(y){function L(){const S=new Float32Array(6);S[0]=1;S[3]=1;return S}function M(S){const g=new Float32Array(6);g[0]=S[0];g[1]=S[1];g[2]=S[2];g[3]=S[3];g[4]=S[4];g[5]=S[5];return g}function x(S,g,n,a,e,m){const z=new Float32Array(6);z[0]=S;z[1]=g;z[2]=n;z[3]=a;z[4]=e;z[5]=m;return z}function v(S,g){return new Float32Array(S,
g,6)}function I(S,g,n,a){const e=g[a];g=g[a+1];S[a]=n[0]*e+n[2]*g+n[4];S[a+1]=n[1]*e+n[3]*g+n[5]}function G(S,g,n,a=0,e=0,m=2){for(e=e||g.length/m;a<e;a++)I(S,g,n,a*m)}const N=Object.freeze(Object.defineProperty({__proto__:null,clone:M,create:L,createView:v,fromValues:x,transform:I,transformMany:G},Symbol.toStringTag,{value:"Module"}));y.clone=M;y.create=L;y.createView=v;y.fromValues=x;y.mat2df32=N;y.transform=I;y.transformMany=G})},"esri/chunks/mat2d":function(){define(["exports","./common"],function(y,
L){function M(q,d){q[0]=d[0];q[1]=d[1];q[2]=d[2];q[3]=d[3];q[4]=d[4];q[5]=d[5];return q}function x(q){q[0]=1;q[1]=0;q[2]=0;q[3]=1;q[4]=0;q[5]=0;return q}function v(q,d,h,P,B,p,E){q[0]=d;q[1]=h;q[2]=P;q[3]=B;q[4]=p;q[5]=E;return q}function I(q,d){const h=d[0],P=d[1],B=d[2],p=d[3],E=d[4];d=d[5];let K=h*p-P*B;if(!K)return null;K=1/K;q[0]=p*K;q[1]=-P*K;q[2]=-B*K;q[3]=h*K;q[4]=(B*d-p*E)*K;q[5]=(P*E-h*d)*K;return q}function G(q){return q[0]*q[3]-q[1]*q[2]}function N(q,d,h){const P=d[0],B=d[1],p=d[2],E=
d[3],K=d[4];d=d[5];const R=h[0],X=h[1],W=h[2],f=h[3],D=h[4];h=h[5];q[0]=P*R+p*X;q[1]=B*R+E*X;q[2]=P*W+p*f;q[3]=B*W+E*f;q[4]=P*D+p*h+K;q[5]=B*D+E*h+d;return q}function S(q,d,h){const P=d[0],B=d[1],p=d[2],E=d[3],K=d[4];d=d[5];const R=Math.sin(h);h=Math.cos(h);q[0]=P*h+p*R;q[1]=B*h+E*R;q[2]=P*-R+p*h;q[3]=B*-R+E*h;q[4]=K;q[5]=d;return q}function g(q,d,h){const P=d[1],B=d[2],p=d[3],E=d[4],K=d[5],R=h[0];h=h[1];q[0]=d[0]*R;q[1]=P*R;q[2]=B*h;q[3]=p*h;q[4]=E;q[5]=K;return q}function n(q,d,h){const P=d[0],
B=d[1],p=d[2],E=d[3],K=d[4];d=d[5];const R=h[0];h=h[1];q[0]=P;q[1]=B;q[2]=p;q[3]=E;q[4]=P*R+p*h+K;q[5]=B*R+E*h+d;return q}function a(q,d){const h=Math.sin(d);d=Math.cos(d);q[0]=d;q[1]=h;q[2]=-h;q[3]=d;q[4]=0;q[5]=0;return q}function e(q,d){q[0]=d[0];q[1]=0;q[2]=0;q[3]=d[1];q[4]=0;q[5]=0;return q}function m(q,d){q[0]=1;q[1]=0;q[2]=0;q[3]=1;q[4]=d[0];q[5]=d[1];return q}function z(q){return"mat2d("+q[0]+", "+q[1]+", "+q[2]+", "+q[3]+", "+q[4]+", "+q[5]+")"}function k(q){return Math.sqrt(q[0]**2+q[1]**
2+q[2]**2+q[3]**2+q[4]**2+q[5]**2+1)}function r(q,d,h){q[0]=d[0]+h[0];q[1]=d[1]+h[1];q[2]=d[2]+h[2];q[3]=d[3]+h[3];q[4]=d[4]+h[4];q[5]=d[5]+h[5];return q}function H(q,d,h){q[0]=d[0]-h[0];q[1]=d[1]-h[1];q[2]=d[2]-h[2];q[3]=d[3]-h[3];q[4]=d[4]-h[4];q[5]=d[5]-h[5];return q}function c(q,d,h){q[0]=d[0]*h;q[1]=d[1]*h;q[2]=d[2]*h;q[3]=d[3]*h;q[4]=d[4]*h;q[5]=d[5]*h;return q}function l(q,d,h,P){q[0]=d[0]+h[0]*P;q[1]=d[1]+h[1]*P;q[2]=d[2]+h[2]*P;q[3]=d[3]+h[3]*P;q[4]=d[4]+h[4]*P;q[5]=d[5]+h[5]*P;return q}
function u(q,d){return q[0]===d[0]&&q[1]===d[1]&&q[2]===d[2]&&q[3]===d[3]&&q[4]===d[4]&&q[5]===d[5]}function J(q,d){const h=q[0],P=q[1],B=q[2],p=q[3],E=q[4];q=q[5];const K=d[0],R=d[1],X=d[2],W=d[3],f=d[4];d=d[5];const D=L.getEpsilon();return Math.abs(h-K)<=D*Math.max(1,Math.abs(h),Math.abs(K))&&Math.abs(P-R)<=D*Math.max(1,Math.abs(P),Math.abs(R))&&Math.abs(B-X)<=D*Math.max(1,Math.abs(B),Math.abs(X))&&Math.abs(p-W)<=D*Math.max(1,Math.abs(p),Math.abs(W))&&Math.abs(E-f)<=D*Math.max(1,Math.abs(E),Math.abs(f))&&
Math.abs(q-d)<=D*Math.max(1,Math.abs(q),Math.abs(d))}const O=Object.freeze(Object.defineProperty({__proto__:null,add:r,copy:M,determinant:G,equals:J,exactEquals:u,frob:k,fromRotation:a,fromScaling:e,fromTranslation:m,identity:x,invert:I,mul:N,multiply:N,multiplyScalar:c,multiplyScalarAndAdd:l,rotate:S,scale:g,set:v,str:z,sub:H,subtract:H,translate:n},Symbol.toStringTag,{value:"Module"}));y.add=r;y.copy=M;y.determinant=G;y.equals=J;y.exactEquals=u;y.frob=k;y.fromRotation=a;y.fromScaling=e;y.fromTranslation=
m;y.identity=x;y.invert=I;y.mat2d=O;y.mul=N;y.multiply=N;y.multiplyScalar=c;y.multiplyScalarAndAdd=l;y.rotate=S;y.scale=g;y.set=v;y.str=z;y.sub=H;y.subtract=H;y.translate=n})},"esri/symbols/support/utils":function(){define("require exports ../../Color ../../symbols ../../core/asyncUtils ../../core/has ../../core/maybe ../../core/screenUtils ../../chunks/vec3f64 ../../layers/effects/jsonUtils ./cimSymbolUtils ./gfxUtils ./Symbol3DMaterial".split(" "),function(y,L,M,x,v,I,G,N,S,g,n,a,e){function m(d){d=
d.symbolLayers;if(!d)return null;let h=null;d.forEach(P=>{"object"===P.type&&P.resource?.href||(h="water"===P.type?P.color:P.material?P.material.color:null)});return h?new M(h):null}function z(d,h){if(null==h||null==d)return d;d=d.toRgba();d[3]*=h;return new M(d)}function k(d,h,P){if(d=d.symbolLayers){var B=p=>{h=h??p??(null!=P?q:null);return z(h,P)};d.forEach(p=>{if("object"!==p.type||!p.resource?.href||h)if("water"===p.type)p.color=B(p.color);else{const E=B(null!=p.material?p.material.color:null);
null==p.material?p.material=new e.Symbol3DMaterial({color:E}):p.material.color=E;null!=P&&"outline"in p&&null!=p.outline&&null!=p.outline.color&&(p.outline.color=z(p.outline.color,P))}})}}async function r(d,h){(d=d.symbolLayers)&&await v.forEach(d,async P=>H(P,h))}async function H(d,h){switch(d.type){case "extrude":d.size="number"===typeof h[2]?h[2]:0;break;case "icon":case "line":case "text":h=c(h);null!=h&&(d.size=h);break;case "path":const P=u(h,S.ONES,[d.width,void 0,d.height]);d.width=O(h[0],
d.width,1,P);d.height=O(h[2],d.height,1,P);break;case "object":await l(d,h)}}function c(d){for(const h of d)if("number"===typeof h)return h;return null}async function l(d,h){const {resourceSize:P,symbolSize:B}=await J(d),p=u(h,P,B);d.width=O(h[0],B[0],P[0],p);d.depth=O(h[1],B[1],P[1],p);d.height=O(h[2],B[2],P[2],p)}function u(d,h,P){for(let B=0;3>B;B++){const p=d[B];switch(p){case "symbol-value":return d=P[B],null!=d?d/h[B]:1;case "proportional":break;default:if(p&&h[B])return p/h[B]}}return 1}async function J(d){var {computeObjectLayerResourceSize:h}=
await new Promise((R,X)=>y(["./symbolLayerUtils"],R,X));h=await h(d,10);const {width:P,height:B,depth:p}=d;d=[P,p,B];let E=1;for(var K=0;3>K;K++){const R=d[K];if(null!=R){E=R/h[K];break}}for(K=0;3>K;K++)null==d[K]&&(d[K]=h[K]*E);return{resourceSize:h,symbolSize:d}}function O(d,h,P,B){switch(d){case "proportional":return P*B;case "symbol-value":return null!=h?h:P;default:return d}}const q=new M("white");L.applyColorToSymbol=function(d,h,P){if(d&&(h||null!=P))if(h&&(h=new M(h)),x.isSymbol3D(d))k(d,
h,P);else if(x.isSymbol2D(d)){if(h=h??d.color)d.color=z(h,P);null!=P&&"outline"in d&&d.outline&&d.outline.color&&(d.outline.color=z(d.outline.color,P))}};L.applyOpacityToColor=z;L.applyRotationToSymbol=function(d,h,P){d&&null!=h&&(x.isSymbol3D(d)?(d=d.symbolLayers)&&d.forEach(B=>{if(B&&"object"===B.type)switch(P){case "tilt":B.tilt=h;break;case "roll":B.roll=h;break;default:B.heading=h}}):!x.isSymbol2D(d)||"simple-marker"!==d.type&&"picture-marker"!==d.type&&"text"!==d.type||(d.angle=h))};L.applySizesToSymbol=
async function(d,h){if(d&&h){if(x.isSymbol3D(d))return r(d,h);if(x.isSymbol2D(d)&&(h=c(h),null!=h))switch(d.type){case "simple-marker":d.size=h;break;case "picture-marker":const P=d.width/d.height;1<P?(d.width=h,d.height=h*P):(d.width=h*P,d.height=h);break;case "simple-line":d.width=h;break;case "text":d.font.size=h}}};L.fetchWebStyleSymbol=async function(d,h){const P=await d.fetchSymbol(h);return P?P:d.fetchCIMSymbol(h)};L.getCSSFilterFromEffectList=function(d){if(!d)return null;d=d.effects.filter(h=>
"bloom"!==h.type).map(h=>h.toJSON());return g.effectFunctionsFromJSON(d)};L.getColorFromSymbol=function(d,h){if(!d)return null;let P=null;x.isSymbol3D(d)?P=m(d):x.isSymbol2D(d)&&(P="cim"===d.type?n.getCIMSymbolColor(d):d.color?new M(d.color):null);return P?z(P,h):null};L.getIconHref=function(d){return G.unwrapOrThrow(d.resource).href};L.getSymbolOutlineSize=function(d){return d?x.isSymbol3D(d)?(d=(d=d.symbolLayers?.at(-1))&&"outline"in d?d?.outline?.size:void 0,null!=d?d:0):N.px2pt(a.getStroke(d)?.width):
0};L.isVolumetricSymbol=function(d){if(null==d||!("symbolLayers"in d)||null==d.symbolLayers)return!1;switch(d.type){case "point-3d":return d.symbolLayers.some(h=>"object"===h.type);case "line-3d":return d.symbolLayers.some(h=>"path"===h.type);case "polygon-3d":return d.symbolLayers.some(h=>"object"===h.type||"extrude"===h.type);default:return!1}};L.symbolHasExtrudeSymbolLayer=function(d){return null!=d&&"polygon-3d"===d.type&&d.symbolLayers.some(h=>"extrude"===h.type)};Object.defineProperty(L,Symbol.toStringTag,
{value:"Module"})})},"esri/symbols/support/gfxUtils":function(){define("exports ../../assets ../../Color ../../request ../../core/LRUCache ../../core/screenUtils ./cimSymbolUtils".split(" "),function(y,L,M,x,v,I,G){function N(n){if(!n)return null;let a=null;switch(n.type){case "simple-fill":case "picture-fill":case "simple-marker":a=N(n.outline);break;case "simple-line":const e=I.pt2px(n.width);null!=n.style&&"none"!==n.style&&0!==e&&(a={color:n.color,style:g(n.style),width:e,cap:n.cap,join:"miter"===
n.join?I.pt2px(n.miterLimit):n.join});break;default:a=null}return a}const S=new v.LRUCache(1E3),g=(()=>{const n={};return a=>{if(n[a])return n[a];const e=a.replaceAll("-","");return n[a]=e}})();M=new M([128,128,128]);y.defaultThematicColor=M;y.dekebabifyLineStyle=g;y.getFill=function(n){const a=n.style;let e=null;if(n)switch(n.type){case "simple-marker":"cross"!==a&&"x"!==a&&(e=n.color);break;case "simple-fill":"solid"===a?e=n.color:"none"!==a&&(e={type:"pattern",x:0,y:0,src:L.getAssetUrl(`esri/symbols/patterns/${a}.png`),
width:5,height:5});break;case "picture-fill":e={type:"pattern",src:n.url,width:I.pt2px(n.width)*n.xscale,height:I.pt2px(n.height)*n.yscale,x:I.pt2px(n.xoffset),y:I.pt2px(n.yoffset)};break;case "text":e=n.color;break;case "cim":e=G.getCIMSymbolColor(n)}return e};y.getPatternUrlWithColor=function(n,a){const e=n+"-"+a;return void 0!==S.get(e)?Promise.resolve(S.get(e)):x(n,{responseType:"image"}).then(m=>{m=m.data;const z=m.naturalWidth,k=m.naturalHeight,r=document.createElement("canvas");r.width=z;r.height=
k;const H=r.getContext("2d");H.fillStyle=a;H.fillRect(0,0,z,k);H.globalCompositeOperation="destination-in";H.drawImage(m,0,0);m=r.toDataURL();S.put(e,m);return m})};y.getStroke=N;Object.defineProperty(y,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/symbolUtils":function(){define("require exports ../../core/has ../../support/arcadeOnDemand ./gfxUtils ./previewUtils ./renderUtils ./utils ../../widgets/Legend/styles/support/relationshipUtils ../../widgets/Legend/support/relationshipRampUtils".split(" "),
function(y,L,M,x,v,I,G,N,S,g){function n(k,r){if(r&&(k.style.filter=N.getCSSFilterFromEffectList(r),r=r.effects))for(const H of r)if("drop-shadow"===H?.type){0>H.offsetX?k.style.marginLeft=`${Math.abs(H.offsetX)}px`:k.style.marginRight=`${H.offsetX}px`;break}}async function a(k,r){switch(k.type){case "web-style":var {previewWebStyleSymbol:H}=await new Promise((c,l)=>y(["./previewWebStyleSymbol"],c,l));return H(k,a,r);case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return{previewSymbol3D:H}=
await new Promise((c,l)=>y(["./previewSymbol3D"],c,l)),H(k,r);case "simple-marker":case "simple-line":case "simple-fill":case "picture-marker":case "picture-fill":case "text":return{previewSymbol2D:H}=await new Promise((c,l)=>y(["./previewSymbol2D"],c,l)),H(k,r);case "cim":return{previewCIMSymbol:H}=await new Promise((c,l)=>y(["./previewCIMSymbol"],c,l)),H(k,r)}}function e(k){return k&&"opacity"in k?k.opacity*e(k.parent):1}let m=null;const z=[255,255,255];L.getDisplayedColor=async function(k,r){if(k){var H=
e(k.layer||k.sourceLayer);if(null!=k.symbol&&(null==r||!0!==r.ignoreGraphicSymbol))return k="web-style"===k.symbol.type?await N.fetchWebStyleSymbol(k.symbol,r):k.symbol.clone(),N.getColorFromSymbol(k,H);var c=null!=r&&r.renderer||k.get("layer.renderer")||k.get("sourceLayer.renderer"),l=await c.getSymbolAsync(k,r);if(l){l="web-style"===l.type?await N.fetchWebStyleSymbol(l,r):l.clone();l=N.getColorFromSymbol(l,H);if(!("visualVariables"in c)||"visualVariables"in c&&!c.visualVariables||"visualVariables"in
c&&!c.visualVariables?.length)return l;!c.arcadeRequiredForVisualVariables||null!=r&&null!=r.arcade||(r={...r},r.arcade=await x.loadArcade());var {getColor:u,getOpacity:J}=await new Promise((d,h)=>y(["../../renderers/visualVariables/support/visualVariableUtils"],d,h)),O=[],q=[];for(const d of c.visualVariables)switch(d.type){case "color":O.push(d);break;case "opacity":q.push(d)}c=(c=0<O.length?O[O.length-1]:null)?u(c,k,r):l;k=(l=0<q.length?q[q.length-1]:null)?J(l,k,r):null;null!=H&&(k=null!=k?k*H:
H);return c?N.applyOpacityToColor(c,k):null}}};L.getDisplayedSymbol=async function(k,r){if(k){var H=k.sourceLayer,c=(null!=r&&(r.useSourceLayer??!1)?H:k.layer)??H;H=e(c);if(null!=k.symbol&&(null==r||!0!==r.ignoreGraphicSymbol))return k="web-style"===k.symbol.type?await N.fetchWebStyleSymbol(k.symbol,{...r,cache:null!=r?r.webStyleCache:null}):k.symbol.clone(),N.applyColorToSymbol(k,null,H),k;var l=(null!=r?r.renderer:null)??(c&&"renderer"in c?c.renderer:null);if(c=l&&"getSymbolAsync"in l?await l.getSymbolAsync(k,
r):null){c="web-style"===c.type?await c.fetchSymbol({...r,cache:null!=r?r.webStyleCache:null}):c.clone();if(!(l&&"visualVariables"in l&&l.visualVariables&&l.visualVariables.length))return N.applyColorToSymbol(c,null,H),c;"arcadeRequiredForVisualVariables"in l&&l.arcadeRequiredForVisualVariables&&(null==r||null==r.arcade)&&(r={...r},r.arcade=await x.loadArcade());var {getColor:u,getOpacity:J,getAllSizes:O,getRotationAngle:q}=await new Promise((E,K)=>y(["../../renderers/visualVariables/support/visualVariableUtils"],
E,K)),d=[],h=[],P=[],B=[];for(var p of l.visualVariables)switch(p.type){case "color":d.push(p);break;case "opacity":h.push(p);break;case "rotation":B.push(p);break;case "size":p.target||P.push(p)}p=(p=!!d.length&&d[d.length-1])?u(p,k,r):null;h=(h=!!h.length&&h[h.length-1])?J(h,k,r):null;null!=H&&(h=null!=h?h*H:H);N.applyColorToSymbol(c,p,h);P.length&&(H=O(P,k,r),await N.applySizesToSymbol(c,H));for(const E of B)N.applyRotationToSymbol(c,q(E,k,r),E.axis);return c}}};L.renderColorRampPreviewHTML=function(k,
r={}){var H="horizontal"===r.align;const c=r.width??(H?75:24),l=r.height??(H?24:75);var u=r.gradient??!0,J=window.devicePixelRatio,O=c*J,q=l*J;J=document.createElement("canvas");J.width=O;J.height=q;J.ariaLabel=r.ariaLabel??null;J.style.width=`${c}px`;J.style.height=`${l}px`;const d=J.getContext("2d");var h=H?O:0;const P=H?0:q;if(u){const B=d.createLinearGradient(0,0,h,P);H=k.length;const p=1===H?0:1/(H-1);k.forEach((E,K)=>B.addColorStop(K*p,E.toString()));d.fillStyle=B;d.fillRect(0,0,O,q)}else{O=
H?O/k.length:O;q=H?q:q/k.length;h=u=0;for(const B of k)d.fillStyle=B.toString(),d.fillRect(u,h,O,q),u=H?u+O:0,h=H?0:h+q}k=document.createElement("div");k.style.width=`${c}px`;k.style.height=`${l}px`;n(k,r?.effectList);k.appendChild(J);return k};L.renderDotDensityPreviewHTML=function(k,r,H){const {backgroundColor:c,outline:l,dotSize:u}=k;var J=H&&H.swatchSize||I.SymbolSizeDefaults.size;const O=Math.round(J*J/u**2*.8),q=window.devicePixelRatio;k=document.createElement("canvas");const d=J*q;k.width=
d;k.height=d;k.style.width=`${k.width/q}px`;k.style.height=`${k.height/q}px`;const h=k.getContext("2d");c&&(h.fillStyle=c.toCss(!0),h.fillRect(0,0,d,d),h.fill());h.fillStyle=r?.toCss(!0)??"";if(m&&m.length/2===O)for(r=0;r<2*O;r+=2)h.fillRect(m[r],m[r+1],u*q,u*q),h.fill();else for(m=[],r=0;r<2*O;r+=2){const P=Math.floor(Math.random()*(d-0+1)),B=Math.floor(Math.random()*(d-0+1));m.push(P,B);h.fillRect(P,B,u*q,u*q);h.fill()}l&&(l.color&&(h.strokeStyle=l.color.toCss(!0)),h.lineWidth=l.width,h.strokeRect(0,
0,d,d));J=new Image(J,J);J.src=k.toDataURL();J.ariaLabel=H?.ariaLabel??null;J.alt=H?.ariaLabel??"";return J};L.renderPieChartPreviewHTML=function(k,r={}){const H=r.radius||40;var c=2*Math.PI*H,l=k.length;const u=c/l,J=[],O=v.getStroke(r.outline);null!=O?.width&&(O.width*=2);(O||r.backgroundColor)&&J.push({shape:{type:"circle",cx:H,cy:H,r:H},fill:r.backgroundColor,stroke:O,offset:[0,0]});const q=r.values,d=q&&q.length===l&&100===q.reduce((P,B)=>P+B,0),h=[0];for(let P=0;P<l;P++){let B=null;d&&(B=q[P]*
c/100,h.push(B+h[P]));J.push({shape:{type:"circle",cx:H,cy:H,r:H/2},fill:[0,0,0,0],stroke:{width:H,dashArray:`${(B??u)/2} ${c}`,dashoffset:`-${d?h[P]/2:u/2*P}`,color:k[P]},offset:[0,0]})}l=null;k=2*H+(O?.width||0);if(c=r.holePercentage)O&&J.push({shape:{type:"circle",cx:H,cy:H,r:H*c},fill:null,stroke:O,offset:[0,0]}),l=k/2,l=[[{shape:{type:"circle",cx:l,cy:l,r:l},fill:z,stroke:O?{...O,color:z}:null,offset:[0,0]},{shape:{type:"circle",cx:l,cy:l,r:H*c},fill:[0,0,0],stroke:null,offset:[0,0]}]];return G.renderSymbol([J],
[k,k],{effectView:r.effectList,ignoreStrokeWidth:!0,masking:l,rotation:-90,ariaLabel:r.ariaLabel})};L.renderPreviewHTML=a;L.renderRelationshipRampPreviewHTML=function(k,r={}){const H=k?.authoringInfo;if("relationship"!==H?.type||!H?.numClasses||!k.uniqueValueInfos)return null;const {focus:c,numClasses:l}=H,u=g.getRelationshipRampElement({focus:c,numClasses:l,infos:k.uniqueValueInfos});k=r&&r.node||document.createElement("div");G.renderOnce(k,()=>S.renderRelationshipRamp(u,r.id||"relationship",{opacity:r.opacity||
1,effectList:r.effectList,ariaLabel:r.ariaLabel}));return k};Object.defineProperty(L,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/support/relationshipUtils":function(){define(["exports","../../../../symbols/support/svgUtils","../../../../symbols/support/utils","../../../support/widgetUtils","../../../support/jsxFactory"],function(y,L,M,x,v){function I(S,g,n){const a=`${n}_arrowStart`;n=`${n}_arrowEnd`;S="left"===S;const e={markerStart:null,markerEnd:null};switch(g){case "HL":S?
e.markerStart=`url(#${n})`:e.markerEnd=`url(#${a})`;break;case "LL":e.markerStart=`url(#${n})`;break;case "LH":S?e.markerEnd=`url(#${a})`:e.markerStart=`url(#${n})`;break;default:e.markerEnd=`url(#${a})`}return e}function G(S,g,n={}){const {focus:a,numClasses:e,colors:m,rotation:z}=S,{opacity:k,effectList:r,ariaLabel:H}=n;S=n.size??60;n=!!a;const c=Math.sqrt(S**2+S**2)+(n?0:5),l=[],u=[];var J=[],O=(S||75)/e;for(var q=0;q<e;q++){var d=q*O;for(var h=0;h<e;h++){var P=h*O,B=L.generateFillAttributes(m[q][h]);
const p=L.generateStrokeAttributes(null);P={type:"rect",x:P,y:d,width:O,height:O};const E=L.renderDef(B);E&&l.push(E);(B=L.renderShape(P,B.fill,p,null))&&u.push(B);J.push(L.getBoundingBox(P))}}O=null;n||(O="margin: -15px -15px -18px -15px");q=I("left",a,g);d=I("right",a,g);h=L.computeBBox(J);J=L.getTransformMatrix(h,c,c,0,!1,z,!1);h=L.getTransformMatrix(h,c,c,0,!1,n?-45:null,!1);B={filter:M.getCSSFilterFromEffectList(r)??void 0,opacity:null==k?"":`${k}`};return v.tsx("div",{styles:B,class:n?N.diamondMidColRamp:
N.squareTableCell},v.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:c,height:c,style:O,"aria-labelledBy":H,role:"image",focusable:!1},v.tsx("defs",null,v.tsx("marker",{id:`${g}_arrowStart`,markerWidth:"10",markerHeight:"10",refX:"5",refY:"5",markerUnits:"strokeWidth",orient:"auto"},v.tsx("polyline",{points:"0,0 5,5 0,10",fill:"none",stroke:"#555555","stroke-width":"1"})),v.tsx("marker",{id:`${g}_arrowEnd`,markerWidth:"10",markerHeight:"10",refX:"0",refY:"5",markerUnits:"strokeWidth",orient:"auto"},
v.tsx("polyline",{points:"5,0 0,5 5,10",fill:"none",stroke:"#555555","stroke-width":"1"})),l),v.tsx("g",{transform:J},u),v.tsx("g",{transform:h},v.tsx("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":q.markerStart,"marker-end":q.markerEnd,x1:-10,y1:S-15,x2:-10,y2:15}),v.tsx("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":d.markerStart,"marker-end":d.markerEnd,x1:15,y1:S+10,x2:S-15,y2:S+10}))))}const N={diamondContainer:"esri-relationship-ramp--diamond__container",
diamondLeftCol:"esri-relationship-ramp--diamond__left-column",diamondRightCol:"esri-relationship-ramp--diamond__right-column",diamondMidCol:"esri-relationship-ramp--diamond__middle-column",diamondMidColLabel:"esri-relationship-ramp--diamond__middle-column--label",diamondMidColRamp:"esri-relationship-ramp--diamond__middle-column--ramp",squareTable:"esri-relationship-ramp--square__table",squareTableRow:"esri-relationship-ramp--square__table-row",squareTableCell:"esri-relationship-ramp--square__table-cell",
squareTableLabel:"esri-relationship-ramp--square__table-label",squareTableLabelLeftBottom:"esri-relationship-ramp--square__table-label--left-bottom",squareTableLabelRightBottom:"esri-relationship-ramp--square__table-label--right-bottom",squareTableLabelLeftTop:"esri-relationship-ramp--square__table-label--left-top",squareTableLabelRightTop:"esri-relationship-ramp--square__table-label--right-top"};y.renderRelationshipRamp=function(S,g,n={}){const {focus:a,labels:e}=S,m=!!a;S=G(S,g,n);g={justifyContent:"center"};
n=x.isRTL();return m?v.tsx("div",{class:N.diamondContainer,styles:g},v.tsx("div",{class:N.diamondLeftCol},n?e.right:e.left),v.tsx("div",{class:N.diamondMidCol},v.tsx("div",{class:N.diamondMidColLabel},e.top),S,v.tsx("div",{class:N.diamondMidColLabel},e.bottom)),v.tsx("div",{class:N.diamondRightCol},n?e.left:e.right)):v.tsx("div",{class:N.squareTable},v.tsx("div",{class:N.squareTableRow},v.tsx("div",{class:x.classes(N.squareTableCell,N.squareTableLabel,N.squareTableLabelRightBottom)},n?e.top:e.left),
v.tsx("div",{class:N.squareTableCell}),v.tsx("div",{class:x.classes(N.squareTableCell,N.squareTableLabel,N.squareTableLabelLeftBottom)},n?e.left:e.top)),v.tsx("div",{class:N.squareTableRow},v.tsx("div",{class:N.squareTableCell}),S,v.tsx("div",{class:N.squareTableCell})),v.tsx("div",{class:N.squareTableRow},v.tsx("div",{class:x.classes(N.squareTableCell,N.squareTableLabel,N.squareTableLabelRightTop)},n?e.right:e.bottom),v.tsx("div",{class:N.squareTableCell}),v.tsx("div",{class:x.classes(N.squareTableCell,
N.squareTableLabel,N.squareTableLabelLeftTop)},n?e.bottom:e.right)))};Object.defineProperty(y,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/relationshipRampUtils":function(){define(["exports","../../../core/lang","../../../symbols/support/gfxUtils","../../../symbols/support/previewSymbol3D"],function(y,L,M,x){function v(g){if(g){var {type:n}=g;return n.includes("3d")?x.getSymbolLayerFill(g.symbolLayers.at(0)):"simple-line"===n||"simple-marker"===g.type&&("x"===g.style||"cross"===
g.style)?(g=M.getStroke(g))&&g.color:M.getFill(g)}}function I(g,n){const a=n.HH.label,e=n.LL.label,m=n.HL.label;n=n.LH.label;switch(g){case "HH":return{top:a,bottom:e,left:m,right:n};case "HL":return{top:m,bottom:n,left:e,right:a};case "LL":return{top:e,bottom:a,left:n,right:m};case "LH":return{top:n,bottom:m,left:a,right:e};default:return{top:a,bottom:e,left:m,right:n}}}function G(g){let n=N[g];g&&null==n&&(n=N.HH);return n||0}const N={HH:315,HL:45,LL:135,LH:225},S={2:[["HL","HH"],["LL","LH"]],3:[["HL",
"HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};y.getRelationshipRampColors2D=function(g,n){const a=[],e=g.length**.5;g=L.clone(g);var m=(n||"HH").split("");n=m[0];for(m="H"===m[1];g.length;){const z=[];for(;z.length<e;)z.push(g.shift());m&&z.reverse();a.push(z)}"L"===n&&a.reverse();return a};y.getRelationshipRampElement=function(g){const {focus:n,infos:a,numClasses:e}=g;var m=S[e];const z={};
a.forEach(k=>{z[k.value]={label:k.label,fill:v(k.symbol)}});g=[];for(let k=0;k<e;k++){const r=[];for(let H=0;H<e;H++)r.push(z[m[k][H]].fill);g.push(r)}m=I(n,z);return{type:"relationship-ramp",numClasses:e,focus:n,colors:g,labels:m,rotation:G(n)}};y.getRotationAngleForFocus=G;Object.defineProperty(y,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/previewSymbol3D":function(){define("exports ../../assets ../../core/colorUtils ../../core/has ../../core/Error ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/screenUtils ./gfxUtils ./IconSymbol3DLayerResource ./ObjectSymbol3DLayerResource ./previewUtils ./renderUtils ./utils ./webStyleSymbolUtils".split(" "),
function(y,L,M,x,v,I,G,N,S,g,n,a,e,m,z,k){function r(w){const F=w.outline;var U=null!=w.material?w.material.color:null;U=null!=U?U.toHex():null;if(null==F||"pattern"in F&&null!=F.pattern&&"style"===F.pattern.type&&"none"===F.pattern.style)return"fill"===w.type&&"#ffffff"===U?{color:"#bdc3c7",width:.75}:null;w=S.pt2px(F.size)||0;return{color:"rgba("+(null!=F.color?F.color.toRgba():"255,255,255,1")+")",width:Math.min(w,f),style:"pattern"in F&&null!=F.pattern&&"style"===F.pattern.type?g.dekebabifyLineStyle(F.pattern.style):
null,join:"butt",cap:"patternCap"in F?F.patternCap:"butt"}}async function H(w,F){if(w.thumbnail?.url)return w.thumbnail.url;if("icon"===F.type&&F?.resource?.href)return z.getIconHref(F);F=L.getAssetUrl("esri/images/Legend/legend3dsymboldefault.png");return w.styleOrigin&&(w.styleOrigin.styleName||w.styleOrigin.styleUrl)&&(w=await k.resolveWebStyleSymbol(w.styleOrigin,{portal:w.styleOrigin.portal},"webRef").catch(()=>null))&&"thumbnail"in w&&w.thumbnail?.url?w.thumbnail.url:F}function c(w,F=1){const U=
w.a;w=M.toHSV(w);const {r:Z,g:fa,b:ca}=M.toRGB({h:w.h,s:w.s/F,v:100-(100-w.v)/F});return[Z,fa,ca,U]}function l(w){return"water"===w.type?null==w.color?null:w.color:null==w.material||null==w.material.color?null:w.material.color}function u(w,F=0){var U=l(w);if(!U){if("fill"===w.type)return null;F=e.adjustColorComponentBrightness(g.defaultThematicColor.r,F);return[F,F,F,100]}w=U.toRgba();for(U=0;3>U;U++)w[U]=e.adjustColorComponentBrightness(w[U],F);return w}async function J(w,F){w=w.style;return"none"===
w?null:{type:"pattern",x:0,y:0,src:await g.getPatternUrlWithColor(L.getAssetUrl(`esri/symbols/patterns/${w}.png`),F.toCss(!0)),width:5,height:5}}function O(w){return w.outline?r(w):{color:"rgba(0, 0, 0, 1)",width:1.5}}function q(w,F){w=l(w);if(!w)return null;let U;U="rgba("+(e.adjustColorComponentBrightness(w.r,F)+",");U+=e.adjustColorComponentBrightness(w.g,F)+",";U+=e.adjustColorComponentBrightness(w.b,F)+",";return U+w.a+");"}function d(w,F){F=q(w,F);if(!F)return{};if("pattern"in w&&null!=w.pattern&&
"style"===w.pattern.type&&"none"===w.pattern.style)return null;const U=Math.min(w.size?S.pt2px(w.size):.75,f);return{color:F,width:U,style:"pattern"in w&&null!=w.pattern&&"style"===w.pattern.type?g.dekebabifyLineStyle(w.pattern.style):null,cap:"cap"in w?w.cap:null,join:"join"in w?"miter"===w.join?S.pt2px(2):w.join:null}}function h(w,F,U){U=null!=U?.75*U:0;return{type:"linear",x1:U?.25*U:0,y1:U?.5*U:0,x2:U||4,y2:U?.5*U:4,colors:[{color:w,offset:0},{color:F,offset:1}]}}function P(w){const F=w.depth,
U=w.height;w=w.width;return 0!==w&&0!==F&&0!==U&&w===F&&null!=w&&null!=U&&w<U}function B(w,F,U){const Z=[];if(!w)return Z;switch(w.type){case "icon":switch(w.resource&&w.resource.primitive||n.defaultPrimitive){case "circle":Z.push({shape:{type:"circle",cx:0,cy:0,r:.5*F},fill:u(w,0),stroke:r(w)});break;case "square":Z.push({shape:{type:"path",path:[{command:"M",values:[0,F]},{command:"L",values:[0,0]},{command:"L",values:[F,0]},{command:"L",values:[F,F]},{command:"Z",values:[]}]},fill:u(w,0),stroke:r(w)});
break;case "triangle":Z.push({shape:{type:"path",path:[{command:"M",values:[0,F]},{command:"L",values:[.5*F,0]},{command:"L",values:[F,F]},{command:"Z",values:[]}]},fill:u(w,0),stroke:r(w)});break;case "cross":Z.push({shape:{type:"path",path:[{command:"M",values:[.5*F,0]},{command:"L",values:[.5*F,F]},{command:"M",values:[0,.5*F]},{command:"L",values:[F,.5*F]}]},stroke:O(w)});break;case "x":Z.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[F,F]},{command:"M",values:[F,
0]},{command:"L",values:[0,F]}]},stroke:O(w)});break;case "kite":Z.push({shape:{type:"path",path:[{command:"M",values:[0,.5*F]},{command:"L",values:[.5*F,0]},{command:"L",values:[F,.5*F]},{command:"L",values:[.5*F,F]},{command:"Z",values:[]}]},fill:u(w,0),stroke:r(w)})}break;case "object":switch(w.resource&&w.resource.primitive||a.defaultPrimitive){case "cone":var fa=u(w,0);w=u(w,-.6);w=h(fa,w,U?C:F);F=e.getConeShapes(F,U);Z.push({shape:F[0],fill:w});Z.push({shape:F[1],fill:w});break;case "inverted-cone":U=
u(w,0);w=u(w,-.6);w=h(U,w,F);F=e.getInvertedConeShapes(F);Z.push({shape:F[0],fill:w});Z.push({shape:F[1],fill:U});break;case "cube":F=e.getCubeShapes(F,U);Z.push({shape:F[0],fill:u(w,0)});Z.push({shape:F[1],fill:u(w,-.3)});Z.push({shape:F[2],fill:u(w,-.5)});break;case "cylinder":fa=u(w,0);const ca=u(w,-.6);fa=h(fa,ca,U?C:F);F=e.getCylinderShapes(F,U);Z.push({shape:F[0],fill:fa});Z.push({shape:F[1],fill:fa});Z.push({shape:F[2],fill:u(w,0)});break;case "diamond":F=e.getDiamondShapes(F);Z.push({shape:F[0],
fill:u(w,-.3)});Z.push({shape:F[1],fill:u(w,0)});Z.push({shape:F[2],fill:u(w,-.3)});Z.push({shape:F[3],fill:u(w,-.7)});break;case "sphere":U=u(w,0);w=u(w,-.6);w=h(U,w);w.x1=0;w.y1=0;w.x2=.25*F;w.y2=.25*F;Z.push({shape:{type:"circle",cx:0,cy:0,r:.5*F},fill:w});break;case "tetrahedron":F=e.getTetrahedronShapes(F),Z.push({shape:F[0],fill:u(w,-.3)}),Z.push({shape:F[1],fill:u(w,0)}),Z.push({shape:F[2],fill:u(w,-.6)})}}return Z}function p(w){return(w="number"===typeof w?.size?w?.size:null)?S.pt2px(w):null}
function E(w,F){const U=p(F),Z=F?.maxSize?S.pt2px(F.maxSize):null,fa=F?.disableUpsampling??!1,ca=w.symbolLayers,ka=[];let na=0,ia=0;const Y=ca.at(-1);let ha;Y&&"icon"===Y.type&&(ha=Y.size&&S.pt2px(Y.size));ca.forEach(la=>{if("icon"===la.type||"object"===la.type){var oa="icon"===la.type?la.size&&S.pt2px(la.size):0,ta=U||oa?Math.ceil(Math.min(U||oa,Z||W)):X;if(la&&la.resource&&la.resource.href){var ua=H(w,la).then(wa=>{const ya=la.get("material.color");var Aa="icon"===la.type?"multiply":"tint";return m.tintImageWithColor(wa,
ta,ya,Aa,fa)}).then(wa=>{const ya=wa.width,Aa=wa.height;na=Math.max(na,ya);ia=Math.max(ia,Aa);return[{shape:{type:"image",x:0,y:0,width:ya,height:Aa,src:wa.url},fill:null,stroke:null}]});ka.push(ua)}else ua=ta,"icon"===la.type&&ha&&U&&(ua=oa/ha*ta),oa="tall"===F?.symbolConfig||F?.symbolConfig?.isTall||("object"===la.type?P(la):!1),na=Math.max(na,oa?C:ua),ia=Math.max(ia,ua),ka.push(Promise.resolve(B(la,ua,oa)))}});return N.eachAlways(ka).then(la=>{const oa=[];la.forEach(ta=>{ta.value?oa.push(ta.value):
ta.error&&I.getLogger("esri.symbols.support.previewSymbol3D").warn("error while building swatchInfo!",ta.error)});return m.renderSymbol(oa,[na,ia],{node:F&&F.node,scale:!1,opacity:F&&F.opacity,ariaLabel:F?.ariaLabel})})}function K(w,F){const U=w.symbolLayers,Z=[];w=z.isVolumetricSymbol(w);const fa=p(F),ca=(F&&F.maxSize?S.pt2px(F.maxSize):null)||f;let ka=0,na=0,ia;U.forEach((Y,ha)=>{if(Y&&("line"===Y.type||"path"===Y.type)){var la=[];switch(Y.type){case "line":var oa=d(Y,0);if(null==oa)break;var ta=
oa&&oa.width||0;0===ha&&(ia=ta);Y=Math.min(fa||ta,ca);ha=0===ha?Y:fa?ta/ia*Y:Y;ta=ha>D/2?2*ha:D;na=Math.max(na,ha);ka=Math.max(ka,ta);oa.width=ha;la.push({shape:{type:"path",path:[{command:"M",values:[0,.5*na]},{command:"L",values:[ka,.5*na]}]},stroke:oa});break;case "path":oa=Math.min(fa||X,ca);ha=u(Y,0);ta=u(Y,-.2);var ua=q(Y,-.4);ua=ua?{color:ua,width:1}:{};if("quad"===Y.profile){const wa=Y.width;Y=Y.height;Y=e.getPathSymbolShapes(wa&&Y?wa/Y:1,0===Y,0===wa);ua={...ua,join:"bevel"};la.push({shape:Y[0],
fill:ta,stroke:ua});la.push({shape:Y[1],fill:ta,stroke:ua});la.push({shape:Y[2],fill:ha,stroke:ua})}else la.push({shape:e.shapes.pathSymbol3DLayer[0],fill:ta,stroke:ua}),la.push({shape:e.shapes.pathSymbol3DLayer[1],fill:ha,stroke:ua});ka=na=Math.max(na,oa)}Z.push(la)}});return Promise.resolve(m.renderSymbol(Z,[ka,na],{node:F&&F.node,scale:w,opacity:F&&F.opacity,ariaLabel:F?.ariaLabel}))}async function R(w,F){const U="mesh-3d"===w.type;w=w.symbolLayers;var Z=p(F);const fa=F&&F.maxSize?S.pt2px(F.maxSize):
null;Z=Z||X;const ca=[];let ka=0,na=0;var ia=!1;for(let ua=0;ua<w.length;ua++){var Y=w.at(ua);const wa=[];if(!U||"fill"===Y.type){var ha=e.shapes.fill[0];switch(Y.type){case "fill":var la=r(Y);ia=Math.min(Z,fa||W);ka=Math.max(ka,ia);na=Math.max(na,ia);ia=!0;var oa=u(Y,0),ta="pattern"in Y?Y.pattern:null;Y=l(Y);!U&&null!=ta&&"style"===ta.type&&"solid"!==ta.style&&Y&&(oa=await J(ta,Y));wa.push({shape:ha,fill:oa,stroke:la});break;case "line":Y=d(Y,0);if(null==Y)break;Y={stroke:Y,shape:ha};ka=Math.max(ka,
X);na=Math.max(na,X);wa.push(Y);break;case "extrude":ha={join:"round",width:1,...d(Y,-.4)};la=u(Y,0);Y=u(Y,-.2);oa=Math.min(Z,fa||W);ta=e.getExtrudeSymbolShapes(oa);ha.width=1;wa.push({shape:ta[0],fill:Y,stroke:ha});wa.push({shape:ta[1],fill:Y,stroke:ha});wa.push({shape:ta[2],fill:la,stroke:ha});Y=.7*X+.5*oa;ka=Math.max(ka,X);na=Math.max(na,Y);break;case "water":ia=G.unwrapOrThrow(l(Y)),Y=c(ia),ha=c(ia,2),la=c(ia,3),oa=e.getWaterSymbolShapes(),ia=!0,wa.push({shape:oa[0],fill:Y}),wa.push({shape:oa[1],
fill:ha}),wa.push({shape:oa[2],fill:la}),Y=Math.min(Z,fa||W),ka=Math.max(ka,Y),na=Math.max(na,Y)}ca.push(wa)}}return m.renderSymbol(ca,[ka,na],{node:F&&F.node,scale:ia,opacity:F&&F.opacity,ariaLabel:F?.ariaLabel})}const X=e.SymbolSizeDefaults.size,W=e.SymbolSizeDefaults.maxSize,f=e.SymbolSizeDefaults.maxOutlineSize,D=e.SymbolSizeDefaults.lineWidth,C=e.SymbolSizeDefaults.tallSymbolWidth;y.getPatternDescriptor=J;y.getSizeFromOptions=p;y.getSymbolLayerFill=u;y.previewSymbol3D=function(w,F){if(0===w.symbolLayers.length)return Promise.reject(new v("symbolPreview: renderPreviewHTML3D",
"No symbolLayers in the symbol."));switch(w.type){case "point-3d":return E(w,F);case "line-3d":return K(w,F);case "polygon-3d":case "mesh-3d":return R(w,F)}return Promise.reject(new v("symbolPreview: swatchInfo3D","symbol not supported."))};Object.defineProperty(y,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/webStyleSymbolUtils":function(){define("exports ../../symbols ../../core/devEnvironmentUtils ../../core/Error ../../core/maybe ../../core/urlUtils ../../portal/Portal ../../chunks/persistableUrlUtils ./jsonUtils ./StyleOrigin ./styleUtils ./Thumbnail".split(" "),
function(y,L,M,x,v,I,G,N,S,g,n,a){function e(k,r){return r.items.find(H=>H.name===k)}function m(k,r,H,c,l,u){const J=H&&null!=H.portal?H.portal:G.getDefault(),O={portal:J,url:I.urlToObject(k.baseUrl),origin:"portal-item"},q=e(r,k.data);if(!q)return Promise.reject(new x("symbolstyleutils:symbol-name-not-found",`The symbol name '${r}' could not be found`,{symbolName:r}));l=N.fromJSON(l(q,c),O);let d=q.thumbnail?.href??null;const h=q.thumbnail&&q.thumbnail.imageData;M.isDevEnvironment()&&(l=M.adjustStaticAGOUrl(l)??
"",d=M.adjustStaticAGOUrl(d));const P={portal:J,url:I.urlToObject(I.removeFile(l)),origin:"portal-item"};return n.requestJSON(l,u).then(B=>{B="cimRef"===c?n.makeCIMSymbolRef(B.data):B.data;if((B=S.fromJSON(B,P))&&L.isSymbol3D(B)){if(d){const p=N.fromJSON(d,O);B.thumbnail=new a.Thumbnail({url:p})}else h&&(B.thumbnail=new a.Thumbnail({url:`data:image/png;base64,${h}`}));k.styleUrl?B.styleOrigin=new g({portal:H.portal,styleUrl:k.styleUrl,name:r}):k.styleName&&(B.styleOrigin=new g({portal:H.portal,styleName:k.styleName,
name:r}))}return B})}function z(k,r,H){const c=n.Style2DUrlTemplate.replaceAll(/\{SymbolName\}/gi,k),l=null!=r.portal?r.portal:G.getDefault();return n.requestJSON(c,H).then(u=>{u=n.makeCIMSymbolRef(u.data);return S.fromJSON(u,{portal:l,url:I.urlToObject(I.removeFile(c)),origin:"portal-item"})})}y.fetchSymbolFromStyle=m;y.getStyleItemFromStyle=e;y.resolveWebStyleSymbol=function(k,r,H,c){const l=k.name;return null==l?Promise.reject(new x("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):
k.styleName&&"Esri2DPointSymbolsStyle"===k.styleName?z(l,r,c):n.fetchStyle(k,r,c).then(u=>m(v.unwrapOrThrow(u),l,r,H,n.symbolUrlFromStyleItem,c))};Object.defineProperty(y,Symbol.toStringTag,{value:"Module"})})},"esri/core/devEnvironmentUtils":function(){define(["exports"],function(y){const L=/^devext.arcgis.com$/,M=/^qaext.arcgis.com$/,x=/^[\w-]*\.mapsdevext.arcgis.com$/,v=/^[\w-]*\.mapsqa.arcgis.com$/,I=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,L,M,/^jsapps.esri.com$/,x,v];y.adjustStaticAGOUrl=
function(G,N){return G?(N=N||globalThis.location.hostname)?null!=N.match(L)||null!=N.match(x)?G.replace("static.arcgis.com","staticdev.arcgis.com"):null!=N.match(M)||null!=N.match(v)?G.replace("static.arcgis.com","staticqa.arcgis.com"):G:G:G};y.isDevEnvironment=function(G){G=G||globalThis.location.hostname;return I.some(N=>null!=G?.match(N))};y.isTelemetryDevEnvironment=function(G){G=G||globalThis.location.hostname;return[/^zrh-.+?\.esri\.com$/].concat(I).some(N=>null!=G?.match(N))};Object.defineProperty(y,
Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/clusterUtils":function(){define(["exports","../../../renderers/visualVariables/SizeVariable"],function(y,L){const M=(x,v)=>{x=x.featuresTilingScheme.getClosestInfoForScale(x.scale).level;return v?.levels?v.levels[x]:null};y.getClusterSizeVariable=function(x,v){if(!(x&&"visualVariables"in x&&x.visualVariables))return null;x=x.visualVariables.find(I=>"size"===I.type);return(v=M(v,x))?new L({field:x.field,minSize:v[2].size,minDataValue:v[2].value,
maxSize:v[3].size,maxDataValue:v[3].value}):null};Object.defineProperty(y,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/colorRampUtils":function(){define(["require","exports","../../../Color","./utils"],function(y,L,M,x){function v(g,n){const a=[],e=g.length-1;5===g.length?a.push(0,2,4):a.push(0,e);return g.map((m,z)=>a.includes(z)?x.createStopLabel(m,z,e,n):null)}async function I(g,n,a){a=new M(a??S);g=(await new Promise((e,m)=>y(["../../../renderers/visualVariables/support/visualVariableUtils"],
e,m))).getOpacity(n,g);null!=g&&(a.a=g);return a}function G(g,n){const {startIndex:a,endIndex:e,weight:m}=N(g,n);if(a===e)return n[a].color;g=M.blendColors(n[a].color,n[e].color,m);return new M(g)}function N(g,n){let a=0,e=n.length-1;n.some((m,z)=>{if(g<m.value)return e=z,!0;a=z;return!1});return{startIndex:a,endIndex:e,weight:(g-n[a].value)/(n[e].value-n[a].value)}}const S=new M([64,64,64]);L.getColorFromPointCloudStops=G;L.getRampStops=async function(g,n,a){let e=!1,m=[],z=[];if(g.stops){var k=
g.stops;m=k.map(H=>H.value);(e=k.some(H=>!!H.label))&&(z=k.map(H=>H.label))}k=m[m.length-1];if(null==m[0]&&null==k)return null;const r=e?null:v(m,a??!1);return(await Promise.all(m.map(async(H,c)=>{const l="opacity"===g.type?await I(H,g,n):(await new Promise((u,J)=>y(["../../../renderers/visualVariables/support/visualVariableUtils"],u,J))).getColor(g,H);return{value:H,color:l,label:e?z[c]:r?.[c]??""}}))).reverse()};L.getRampStopsForPointCloud=function(g){let n=!1,a=[],e=[];a=g.map(k=>k.value);(n=g.some(k=>
!!k.label))&&(e=g.map(k=>k.label??""));const m=a[a.length-1];if(null==a[0]&&null==m)return null;const z=n?null:v(a,!1);return a.map((k,r)=>{const H=G(k,g);return{value:k,color:H,label:n?e[r]:z?.[r]??""}}).reverse()};L.getStrectchRampStops=function(g,n){let a=[];if(g&&"multipart"===g.type)g.colorRamps.reverse().forEach((e,m)=>{0===m?a.push({value:n.max,color:new M(e.toColor),label:"high"}):a.push({value:null,color:new M(e.toColor),label:""});m===g.colorRamps.length-1?a.push({value:n.min,color:new M(e.fromColor),
label:"low"}):a.push({value:null,color:new M(e.fromColor),label:""})});else{let e,m;g&&"algorithmic"===g.type?(e=g.fromColor,m=g.toColor):(e=[0,0,0,1],m=[255,255,255,1]);a=[{value:n.max,color:new M(m),label:"high"},{value:n.min,color:new M(e),label:"low"}]}return a};Object.defineProperty(L,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/utils":function(){define("require exports ../../../symbols ../../../intl/date ../../../renderers/support/numberUtils ../../../symbols/SimpleLineSymbol".split(" "),
function(y,L,M,x,v,I){async function G(S){if(!("visualVariables"in S&&S.visualVariables))return null;S=S.visualVariables.find(a=>"color"===a.type);if(!S)return null;var g=null,n=null;if(S.stops){if(1===S.stops.length)return S.stops[0].color;g=S.stops[0].value;n=S.stops[S.stops.length-1].value}g=null!=g&&null!=n?g+(n-g)/2:0;({getColor:n}=await new Promise((a,e)=>y(["../../../renderers/visualVariables/support/visualVariableUtils"],a,e)));return n(S,g)??null}const N=x.convertDateFormatToIntlOptions("short-date");
L.RGB_IMG_SOURCE=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII\x3d"];
L.SPECIAL_CHARS_GREATER_THAN="\x3e";L.SPECIAL_CHARS_LESS_THAN="\x3c";L.createStopLabel=function(S,g,n,a){let e="";0===g?e="\x3c ":g===n&&(e="\x3e ");g=null;g=a?x.formatDate(S,N):v.format(S);return e+g};L.getMedianColor=G;L.getSymbolForFlowRenderer=async function(S,g){const n=S.trailCap,a=S.trailWidth||1;S=g||await G(S)||S.color;return new I({cap:n,color:S,width:a})};L.isRasterBandStatistics=function(S){return null!=S&&"object"===typeof S&&"min"in S&&"max"in S};Object.defineProperty(L,Symbol.toStringTag,
{value:"Module"})})},"esri/renderers/support/numberUtils":function(){define(["exports","../../intl","../../intl/number"],function(y,L,M){function x(n,a){return n-a}function v(n,a){let e;e=Number(n.toFixed(a));e<n?n=e+1/10**a:(n=e,e-=1/10**a);e=Number(e.toFixed(a));n=Number(n.toFixed(a));return[e,n]}function I(n,a,e,m,z){n=N(n,a,e,m);a=null==n.next||n.next<=z;return(null==n.previous||n.previous<=z)&&a||n.previous+n.next<=2*z}function G(n){n=String(n);var a=n.match(S);if(a&&a[1])return{integer:a[1].split("").length,
fractional:a[3]?a[3].split("").length:0};if(n.toLowerCase().includes("e")&&(a=n.split("e"),n=a[0],a=a[1],n&&a)){n=Number(n);a=Number(a);const e=0<a;e||(a=Math.abs(a));n=G(n);e?(n.integer+=a,n.fractional=a>n.fractional?0:n.fractional-a):(n.fractional+=a,n.integer=a>n.integer?1:n.integer-a);return n}return{integer:0,fractional:0}}function N(n,a,e,m){const z={previous:null,next:null};if(null!=e){const k=n-e;z.previous=Math.floor(Math.abs(100*(a-e-k)/k))}null!=m&&(n=m-n,z.next=Math.floor(Math.abs(100*
(m-a-n)/n)));return z}const S=/^-?(\d+)(\.(\d+))?$/i,g={maximumFractionDigits:20};y.format=function(n){return M.formatNumber(n,g)};y.numDigits=G;y.percentChange=N;y.round=function(n,a={}){n=n.slice(0);const {tolerance:e=2,strictBounds:m=!1,indexes:z=n.map((r,H)=>H)}=a;z.sort(x);for(a=0;a<z.length;a++){const r=z[a],H=n[r],c=0===r?null:n[r-1],l=r===n.length-1?null:n[r+1],u=G(H).fractional;if(u){let J=0,O=!1;for(var k=void 0;J<=u&&!O;)k=v(H,J),k=m&&0===a?k[1]:k[0],O=I(H,k,c,l,e),J++;O&&(n[r]=k)}}return n};
Object.defineProperty(y,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/heatmapRampUtils":function(){define(["exports","../../../renderers/support/HeatmapColorStop"],function(y,L){y.getHeatmapRampStops=function(M){if(!M.colorStops)return[];const x=[...M.colorStops].filter(I=>0<I.color?.a);let v=x.length-1;if(x&&x[0]){const I=x[v];I&&1!==I.ratio&&(x.push(new L({ratio:1,color:I.color})),v++)}return x.map((I,G)=>{let N="";0===G?N=M.legendOptions?.minLabel||"low":G===v&&(N=M.legendOptions?.maxLabel||
"high");return{color:I.color,label:N,ratio:I.ratio}}).reverse()};Object.defineProperty(y,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/sizeRampUtils":function(){define("require exports ../../../Color ../../../symbols ../../../renderers/support/numberUtils ../../../symbols/support/cimSymbolUtils ../../../symbols/support/utils ./utils ../../support/widgetUtils ../../../support/themeUtils ../../../symbols/SimpleMarkerSymbol ../../../symbols/SimpleLineSymbol".split(" "),function(y,
L,M,x,v,I,G,N,S,g,n,a){function e(B,p){const E=B.length-1;return B.map((K,R)=>N.createStopLabel(K,R,E,p))}function m(B,p){B=B?.authoringInfo;const E="univariate-color-size"===B?.type;let K=[12,30];if(E){const R=p[0],X=p[p.length-1];K=p.map(W=>12+(W-R)/(X-R)*18)}E&&"below"===B?.univariateTheme&&K.reverse();return K}function z(B,p){const E=B.classBreakInfos,K=E.length;p=2>K||!(2<=p)?E[0].symbol.clone():E[K-1].symbol.clone();B.visualVariables.some(R=>"color"===R.type)&&(p.type.includes("3d")?H(p):c(p));
return p}async function k(B,p){if("flow"===B.type)return N.getSymbolForFlowRenderer(B,p);if("pie-chart"===B.type)return new n({color:null,outline:B.outline?.width?B.outline:new a});let E=null,K=null;"simple"===B.type?E=B.symbol:"class-breaks"===B.type?(E=(B=B.classBreakInfos)&&B[0]&&B[0].symbol,K=1<B.length):"unique-value"===B.type&&(B=B.uniqueValueInfos,E=B?.[0]?.symbol,K=null!=B&&1<B.length);if(!E||r(E))return null;E=E.clone();if(p||K)E.type.includes("3d")?H(E):c(E);return E}function r(B){return B?
x.isSymbol3D(B)?B.symbolLayers?B.symbolLayers.some(p=>p&&"fill"===p.type):!1:B.type.includes("fill"):!1}function H(B){"line-3d"===B.type?B.symbolLayers.forEach(p=>{p.material={color:P}}):B.symbolLayers.forEach(p=>{"icon"!==p.type||p.resource&&p.resource.href?p.material={color:h}:(p.material={color:d},p.outline={color:P,size:1.5})})}function c(B){const p=g.isDarkTheme();if("cim"===B.type)I.applyCIMSymbolColor(B,new M(h));else if(B.type.includes("line"))B.color=P;else if(B.color=p?P:d,"simple-marker"===
B.type)B.outline?"#ffffff"===B.outline?.color?.toHex()&&(B.outline.color=P):B.outline={color:P,width:1.5}}async function l(B,p,E,K){const R=(await new Promise((f,D)=>y(["../../../renderers/visualVariables/support/visualVariableUtils"],f,D))).getSizeRangeAtScale(B,E,K),X=R&&u(R);if(R&&X){var W=X.map(f=>{const D=R.minSize,C=R.maxSize,w=B.minDataValue,F=B.maxDataValue;return f<=D?w:f>=C?F:(f-D)/(C-D)*(F-w)+w});W=v.round(W);for(let f=1;f<W.length-1;f++){const D=await J(B,p,W[f],W[f-1],E,K);D&&(W[f]=D[0],
X[f]=D[1])}return W}}function u(B){const p=B.minSize;B=(B.maxSize-p)/4;const E=[];for(let K=0;5>K;K++)E.push(p+B*K);return E}async function J(B,p,E,K,R,X){const W=await O(B,p,E,R,X);K=await O(B,p,K,R,X);var f=v.numDigits(E),D=f.fractional,C=f.integer;let w=f=null;0<E&&1>E&&(f=10**D,E*=f,C=v.numDigits(E).integer);for(D=C-1;0<=D;D--){var F=10**D;C=Math.floor(E/F)*F;F*=Math.ceil(E/F);null!=f&&(C/=f,F/=f);let U=(C+F)/2;[,U]=v.round([C,U,F],{indexes:[1]});const Z=await O(B,p,C,R,X),fa=await O(B,p,F,R,
X),ca=await O(B,p,U,R,X),ka=v.percentChange(W,Z,K,null),na=v.percentChange(W,fa,K,null),ia=v.percentChange(W,ca,K,null);let Y=20>=ka.previous,ha=20>=na.previous;Y&&ha&&(ka.previous<=na.previous?(Y=!0,ha=!1):(ha=!0,Y=!1));Y?w=[C,Z]:ha?w=[F,fa]:20>=ia.previous&&(w=[U,ca]);if(w)break}return w}async function O(B,p,E,K,R){const {getSize:X}=await new Promise((W,f)=>y(["../../../renderers/visualVariables/support/visualVariableUtils"],W,f));return X(B,E,{scale:K,view:R,shape:"simple-marker"===p.type?p.style:
null})}function q(B,p){B=B.clone();if(x.isSymbol3D(B))G.isVolumetricSymbol(B)||B.symbolLayers.forEach(E=>{"fill"!==E.type&&(E.size=p)});else if("esri.symbols.SimpleMarkerSymbol"===B.declaredClass)B.size=p;else if("esri.symbols.PictureMarkerSymbol"===B.declaredClass){const E=B.width,K=B.height;B.height=p;B.width=E/K*p}else"esri.symbols.SimpleLineSymbol"===B.declaredClass?B.width=p:"esri.symbols.TextSymbol"===B.declaredClass&&B.font&&(B.font.size=p);return B}const d=[255,255,255],h=[200,200,200],P=
[128,128,128];L.REAL_WORLD_MAX_SIZE=30;L.REAL_WORLD_MIN_SIZE=12;L.getRampStops=async function(B,p,E,K,R,X,W){var f=p.legendOptions;f=f&&f.customValues;const D=W||await k(B,E);E=p.stops;var C=null!=p.minSize&&null!=p.maxSize;W=E&&1<E.length;var w=!!p.target;if(D&&(f||C||W&&!w)){var F=G.isVolumetricSymbol(D),U=!1,Z=C=null;C=F&&!W?v.round([p.minDataValue,p.maxDataValue]):f??await l(p,D,K,R);f=B?.authoringInfo;var fa=(w="univariate-color-size"===f?.type)&&"above-and-below"===f?.univariateTheme;!C&&W&&
(C=E.map(ia=>ia.value),U=E.some(ia=>!!ia.label),"flow"===B.type&&(C=v.round(C)),U&&(Z=E.map(ia=>ia.label)));F&&null!=C&&2<C?.length&&!fa&&(C=[C[0],C[C.length-1]]);if(!C)return null;w&&5!==C?.length&&(C=u({minSize:C[0],maxSize:C[C.length-1]}));var ca=F?m(B,C):null,ka=G.getSymbolOutlineSize(D),na=U?null:e(C,X);return(await Promise.all(C.map(async(ia,Y)=>{const ha=F?ca[Y]:await O(p,D,ia,K,R),la=q(fa&&"class-breaks"===B.type?z(B,Y):D,ha);return{value:ia,symbol:la,label:U?Z[Y]:na[Y],size:ha,outlineSize:ka}}))).reverse()}};
Object.defineProperty(L,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/smartMapping/support/utils":function(){define("exports ../../../Color ../../../intl/date ../../../intl/number ../../../renderers/support/utils ../../../renderers/visualVariables/SizeVariable".split(" "),function(y,L,M,x,v,I){y.formatDateLabel=function(G){return M.formatDate(new Date(G),v.timelineDateFormatOptions)};y.formatNumberLabel=function(G){const N=Math.floor(Math.log10(Math.abs(G)))+1;return x.formatNumber(G,{notation:1E6<=
Math.abs(G)?"compact":"standard",minimumSignificantDigits:2,maximumSignificantDigits:4>N||6<N?4:N})};y.getDeviationValues=function(G,N,S){if(null==N||null==G)return[];const g=[];for(let n=-1*S;n<=S;n++)0!==n&&g.push(N+n*G);return g};y.getDynamicPathForSizeStops=function(G){const {max:N,min:S,padding:g,pathHeight:n,pathWidth:a,stops:e}=G,m=N-S;let z=`M0 0 L${a} 0 `,k;G=3===e.length?[e[0],e[1],e[2]]:[e[0],e[2],e[4]];const r=Math.min.apply(Math,G.map(c=>c.size)),H=Math.max(Math.abs(G[0].size-G[1].size),
Math.abs(G[2].size-G[1].size));G.reverse();G.forEach(({size:c,value:l},u)=>{l=Math.round(n-(l-S)/m*n);k=Math.round((c-r)/H*100)/100*a;0===k&&(k=g*a);0===u&&(z+=`L${k} 0 `);z+=`L${k} ${l} `});return z+=`L${k} ${n} L0 ${n} L0 0 Z`};y.getFillFromColor=function(G){return G instanceof L?G.toCss(!0):L.fromString(G??"").toCss(!0)};y.getPathForSizeStops=function(G){const {bottomValue:N,bottomWidth:S,max:g,min:n,pathHeight:a,pathWidth:e,topValue:m,topWidth:z}=G;G=z*e;const k=S*e,r=g-n;return`M${G} 0 L${G} ${Math.round(a-
(m-n)/r*a)} L${k} ${Math.round(a-(N-n)/r*a)} L${k} ${a} L0 ${a} L0 0 Z`};y.getSizesFromVariable=function(G){let N=G.maxSize;G=G.minSize;N instanceof I&&(N=N.stops[0].size);G instanceof I&&(G=G.stops[0].size);return[N,G]};y.getStopChanges=function(G,N,S){const g=S.length-1;if(0>g)return[];const n=S[0],a=S[g]-n,e=N-G,m=[];for(let z=1;z<g;z++)m.push({index:z,value:(S[z]-n)/a*e+G});m.unshift({index:0,value:G});m.push({index:g,value:N});return m};Object.defineProperty(y,Symbol.toStringTag,{value:"Module"})})},
"esri/renderers/support/utils":function(){define("exports ../../core/arrayUtils ../../core/Logger ../../core/MapUtils ../../intl/date ./numberUtils ../visualVariables/support/ColorStop ../../symbols/support/utils ../../widgets/Legend/support/colorRampUtils ../../widgets/Legend/support/heatmapRampUtils".split(" "),function(y,L,M,x,v,I,G,N,S,g){async function n(c,l,u){x.getOrCreateMapValue(c,l,()=>[]).push(...u)}async function a(c,l,u){c=x.getOrCreateMapValue(c,l,()=>new Map);for(const J of u)c.set(J.value,
J.color)}function e(c){let l=c.minValue,u=c.maxValue;const J=c.isFirstBreak?"":k.gt+" ";c="percent-of-total"===c.normalizationType?k.pct:"";l=null==l?"":I.format(l);u=null==u?"":I.format(u);return J+l+c+" "+k.ld+" "+u+c}function m(c,l){return"normalizationField"in c&&c.normalizationField?{type:"normalized-field",field:c.field,normalizationField:c.normalizationField}:"field"in c&&c.field?{type:"field",field:c.field}:"valueExpression"in c&&c.valueExpression?{type:"expression",expression:c.valueExpression,
title:c.valueExpressionTitle,returnType:l}:null}const z=M.getLogger("esri.renderers.support.utils"),k={lte:"\x3c\x3d",gte:"\x3e\x3d",lt:"\x3c",gt:"\x3e",pct:"%",ld:"\u2013"},r={millisecond:0,second:1,minute:2,hour:3,day:4,month:5,year:6},H={millisecond:"long-month-day-year-long-time",second:"long-month-day-year-long-time",minute:"long-month-day-year-short-time",hour:"long-month-day-year-short-time",day:"long-month-day-year",month:"long-month-day-year",year:"year"};M=v.convertDateFormatToIntlOptions("short-date");
y.calculateDateFormatInterval=function(c){c=c.map(q=>new Date(q));const l=c.length;let u=Infinity,J=null;for(let q=0;q<l-1;q++){const d=c[q];let h=Infinity,P=null;for(let B=q+1;B<l;B++){var O=c[B];O=d.getFullYear()!==O.getFullYear()&&"year"||d.getMonth()!==O.getMonth()&&"month"||d.getDate()!==O.getDate()&&"day"||d.getHours()!==O.getHours()&&"hour"||d.getMinutes()!==O.getMinutes()&&"minute"||d.getSeconds()!==O.getSeconds()&&"second"||"millisecond";const p=r[O];p<h&&(h=p,P=O)}h<u&&(u=h,J=P)}return J};
y.createClassBreakLabel=e;y.createColorStops=function(c){const {values:l,colors:u,labelIndexes:J,isDate:O,dateFormatOptions:q}=c;return l.map((d,h)=>{var P=null;if(!J||J.includes(h)){let B;if(B=O?v.formatDate(d,q):I.format(d))P="",0===h?P=k.lt+" ":h===l.length-1&&(P=k.gt+" "),P+=B}return new G({value:d,color:u[h],label:P})})};y.createUniqueValueLabel=function(c){const {value:l,domain:u,fieldInfo:J,dateFormatInterval:O}=c;c=String(l);const q=u&&"codedValues"in u&&u.codedValues?u.getName(l):null;q?
c=q:"number"===typeof l&&(c=J&&"date"===J.type?v.formatDate(l,O&&v.convertDateFormatToIntlOptions(H[O])):I.format(l));return c};y.getAttribute=m;y.getAttributes=function(c,l){const u=[];if("class-breaks"===c.type||"heatmap"===c.type)u.push(m(c,"number"));else if("unique-value"===c.type){var J=c.authoringInfo;if(J&&"relationship"===J.type){if(J.field1&&J.field2){var O=J.field2.field;const q=J.field2.normalizationField;u.push(m({field:J.field1.field,normalizationField:J.field1.normalizationField}));
u.push(m({field:O,normalizationField:q}))}}else O=c.uniqueValueInfos?.[0],J=null,O&&O.value&&(O=typeof c.uniqueValueInfos[0].value,"string"===O||"number"===O)&&(J=O),u.push(m(c,J)),[c.field2,c.field3].forEach(q=>q&&u.push({type:"field",field:q}))}else"attributes"in c&&c.attributes?.forEach(q=>u.push(m(q,"number")));(c=l?l(c):"visualVariables"in c?c.visualVariables:null)&&c.forEach(q=>u.push(m(q,"number")));return L.unique(u.filter(L.isSome),(q,d)=>"field"===q.type&&"field"===d.type?q.field===d.field:
"normalized-field"===q.type&&"normalized-field"===d.type?q.field===d.field&&q.normalizationField===d.normalizationField:"expression"===q.type&&"expression"===d.type?q.expression===d.expression:!1)};y.getColorsForRendererValues=async function(c){const l=new Map;if(!c)return l;if("unique-value"!==c.type||c.authoringInfo?.type)if("class-breaks"===c.type){var u=c.classBreakInfos.map(q=>({value:q.minValue,color:N.getColorFromSymbol(q.symbol,null)})).reverse();const {field:J,valueExpression:O}=c;await a(l,
J??O,u)}else"simple"===c.type&&await a(l,"default",[{value:"default",color:N.getColorFromSymbol(c.symbol,null)}]);else{u=(c.uniqueValueInfos??[]).map(B=>({value:B.value,color:N.getColorFromSymbol(B.symbol,null)}));const {field:J,field2:O,field3:q,valueExpression:d,fieldDelimiter:h}=c,P=[J,O,q].filter(Boolean).join(h||"");(P||d)&&await a(l,P||d,u)}"defaultSymbol"in c&&c.defaultSymbol&&await a(l,"default",[{value:"default",color:N.getColorFromSymbol(c.defaultSymbol,null)}]);if("visualVariables"in c&&
c.visualVariables){c=c.visualVariables.filter(J=>"color"===J.type);for(const J of c)c=await S.getRampStops(J)??[],await a(l,J.field||J.valueExpression,c)}return l};y.getColorsFromRenderer=async function(c){const l=new Map;if(!c)return l;if("visualVariables"in c&&c.visualVariables){var u=c.visualVariables.filter(O=>"color"===O.type);for(var J of u)u=(await S.getRampStops(J)??[]).map(O=>O.color),await n(l,J.field||J.valueExpression,u)}if("heatmap"===c.type)J=g.getHeatmapRampStops(c).map(O=>O.color),
await n(l,c.field||c.valueExpression,J);else if("pie-chart"===c.type){for(const O of c.attributes)await n(l,O.field||O.valueExpression,[O.color]);await n(l,"default",[c?.othersCategory?.color,N.getColorFromSymbol(c.backgroundFillSymbol,null)])}else if("dot-density"===c.type){for(const O of c.attributes)await n(l,O.field||O.valueExpression,[O.color]);await n(l,"default",[c.backgroundColor])}else if("unique-value"===c.type)if("predominance"===c.authoringInfo?.type)for(const O of c.uniqueValueInfos??
[])await n(l,O.value.toString(),[N.getColorFromSymbol(O.symbol,null)]);else{J=(c.uniqueValueInfos??[]).map(P=>N.getColorFromSymbol(P.symbol,null));const {field:O,field2:q,field3:d,valueExpression:h}=c;(O||h)&&await n(l,O||h,J);q&&await n(l,q,J);d&&await n(l,d,J)}else if("class-breaks"===c.type){J=c.classBreakInfos.map(d=>N.getColorFromSymbol(d.symbol,null));const {field:O,valueExpression:q}=c;await n(l,O??q,J)}else"simple"===c.type&&await n(l,"default",[N.getColorFromSymbol(c.symbol,null)]);"defaultSymbol"in
c&&c.defaultSymbol&&await n(l,"default",[N.getColorFromSymbol(c.defaultSymbol,null)]);l.forEach((O,q)=>{O=L.unique(O.filter(Boolean),(d,h)=>JSON.stringify(d)===JSON.stringify(h));l.set(q,O)});return l};y.setLabelsForClassBreaks=function(c){const l=c.classBreakInfos,u=c.normalizationType;let J=[];if(l&&l.length)if("standard-deviation"===c.classificationMethod)z.warn("setLabelsForClassBreaks","cannot set labels for class breaks generated using 'standard-deviation' method.");else if(c.round){J.push(l[0].minValue);
for(const O of l)J.push(O.maxValue);J=I.round(J);l.forEach((O,q)=>{O.label=e({minValue:0===q?J[0]:J[q],maxValue:J[q+1],isFirstBreak:0===q,normalizationType:u})})}else l.forEach((O,q)=>{O.label=e({minValue:O.minValue,maxValue:O.maxValue,isFirstBreak:0===q,normalizationType:u})})};y.timelineDateFormatOptions=M;Object.defineProperty(y,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/Card":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../intl ../../../core/reactiveUtils ../../../core/screenUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../symbols/support/svgUtils ../../../symbols/support/utils ../../Widget ./CardCSS ./support/relationshipUtils ./support/univariateUtils ../support/styleUtils ../../support/Heading ../../support/decorators/accessibleHandler ../../support/decorators/messageBundle ../../support/jsxFactory ../../support/widgetUtils ../../../intl/substitute".split(" "),
function(y,L,M,x,v,I,G,N,S,g,n,a,e,m,z,k,r,H,c,l,u,J,O){var q;(function(h){h.Auto="auto";h.Stack="stack";h.SideBySide="side-by-side"})(q||(q={}));const d=window.devicePixelRatio;M=function(h){function P(p,E){p=h.call(this,p,E)||this;p._hasIndicators=!1;p._selectedSectionName=null;p._sectionNames=[];p._sectionMap=new Map;p.activeLayerInfos=null;p.headingLevel=3;p.layout=q.Stack;p.messages=null;p.messagesCommon=null;p.type="card";p.view=null;return p}y._inherits(P,h);var B=P.prototype;B.initialize=
function(){this.addHandles(x.watch(()=>this.activeLayerInfos,p=>{this.removeAllHandles();this._watchForSectionChanges(p)}))};B.render=function(){var {view:p}=this;this._hasIndicators=this.layout===q.Auto&&p&&768>=p.container.clientWidth||this.layout===q.Stack;p=(p=this.activeLayerInfos)&&p.toArray().map(R=>this._renderLegendForLayer(R)).filter(R=>!!R);this._hasIndicators?this._selectedSectionName&&this._sectionNames.includes(this._selectedSectionName)||(this._selectedSectionName=this._sectionNames&&
this._sectionNames[0]):this._selectedSectionName=null;const E=this._sectionNames.length;var K=this._sectionNames.map((R,X)=>{X=O.substitute(this.messagesCommon.pagination.pageText,{index:X+1,total:E});return u.tsx("div",{key:R,role:"tab",id:R,"aria-label":X,"aria-controls":`${R}-panel`,"aria-selected":(this._selectedSectionName===R).toString(),tabIndex:this._selectedSectionName===R?0:-1,title:X,onclick:this._selectSection,onkeydown:this._focusSection,bind:this,class:this.classes(m.CSS.indicator,{[m.CSS.activated]:this._selectedSectionName===
R}),"data-section-name":R})});K=this._hasIndicators&&1<E?u.tsx("div",{class:m.CSS.indicatorContainer,key:"carousel-navigation",role:"tablist"},K):null;p=this._hasIndicators?this._sectionMap.get(this._selectedSectionName):p&&p.length?p:null;return u.tsx("div",{class:this.classes(m.CSS.base,{[m.CSS.stacked]:this._hasIndicators})},p||u.tsx("div",{class:m.CSS.message},this.messages.noLegend),K)};B._selectSection=function(p){if(p=p.target.getAttribute("data-section-name"))this._selectedSectionName=p};
B._focusSection=function(p){switch(p.key){case "ArrowLeft":case "ArrowRight":this._switchSectionOnArrowPress(p);break;case "Enter":case " ":this._selectSection(p)}};B._switchSectionOnArrowPress=function(p){const E=p.key,K="ArrowLeft"===E?-1:1;p=p.target.getAttribute("data-section-name");p=this._sectionNames.indexOf(p);const R=this._sectionNames;let X=null;-1!==p&&(R[p+K]?X=document.getElementById(R[p+K]):"ArrowLeft"===E?X=document.getElementById(R[R.length-1]):"ArrowRight"===E&&(X=document.getElementById(R[0])),
X?.focus())};B._watchForSectionChanges=function(p){this._generateSectionNames();p&&(p.forEach(E=>{const K=`activeLayerInfo-${E.layer.uid}-version-change`;this.removeHandles(K);this._watchForSectionChanges(E.children);this.addHandles(x.watch(()=>E.version,()=>this._generateSectionNames()),K)}),this.removeHandles("activeLayerInfos-collection-change"),this.addHandles(p.on("change",()=>this._watchForSectionChanges(p)),"activeLayerInfos-collection-change"))};B._generateSectionNames=function(){this._sectionNames.length=
0;this._selectedSectionName=null;this.activeLayerInfos&&this.activeLayerInfos.forEach(this._generateSectionNamesForActiveLayerInfo,this)};B._getSectionName=function(p,E,K){return`${this.id}${p.uid}-type-${E.type}-${K}`};B._generateSectionNamesForActiveLayerInfo=function(p){p.children.forEach(this._generateSectionNamesForActiveLayerInfo,this);p.legendElements&&p.legendElements.forEach((E,K)=>{this._sectionNames.push(this._getSectionName(p.layer,E,K))})};B._renderLegendForLayer=function(p){if(!p.ready)return null;
if(p.children.length){var E=p.children.map(R=>this._renderLegendForLayer(R)).toArray();return u.tsx("div",{key:p.layer.uid,class:this.classes(m.CSS.service,m.CSS.groupLayer)},u.tsx("div",{class:m.CSS.serviceCaptionContainer},p.title),E)}if((E=p.legendElements)&&!E.length)return null;const K=E.some(R=>"relationship-ramp"===R.type);E=E.map((R,X)=>this._renderLegendForElement(R,p,X,K)).filter(R=>!!R);return E.length?u.tsx("div",{key:p.layer.uid,class:this.classes(m.CSS.service,{[m.CSS.groupLayerChild]:!!p.parent})},
u.tsx("div",{class:m.CSS.serviceCaptionContainer},u.tsx("div",{class:m.CSS.serviceCaptionText},p.title)),u.tsx("div",{class:m.CSS.serviceContent},E)):null};B._renderLegendForElement=function(p,E,K,R=!1,X=!1){var W="color-ramp"===p.type,f="opacity-ramp"===p.type,D="size-ramp"===p.type;const C=E.layer;var w=null;"string"===typeof p.title?w=p.title:p.title&&(w=p.title,W=r.getTitle(this.messages,w,W||f),w=w.title?`${w.title} (${W})`:W);K=this._getSectionName(C,p,K);W=this._hasIndicators&&!X?u.tsx("div",
null,u.tsx(H.Heading,{level:this.headingLevel,class:m.CSS.carouselTitle},E.title),u.tsx(H.Heading,{level:H.incrementHeadingLevel(this.headingLevel),class:m.CSS.layerCaption},w)):w?u.tsx(H.Heading,{level:this.headingLevel,class:m.CSS.layerCaption},w):null;w=E.effectList;f=null;"symbol-table"===p.type?(D=p.infos.map((F,U)=>this._renderLegendForElementInfo(F,E,p.legendType,U)).filter(F=>!!F),D.length&&(f=u.tsx("div",{class:this.classes({[m.CSS.labelContainer]:!(D[0].properties.classes&&D[0].properties.classes[m.CSS.symbolRow])&&
!R,[m.CSS.relationshipLabelContainer]:R})},D))):"color-ramp"===p.type||"opacity-ramp"===p.type||"heatmap-ramp"===p.type?f=this._renderLegendForRamp(p,C.opacity,w):D?f=this._renderSizeRamp(p,C.opacity):"pie-chart-ramp"===p.type?f=this._renderPieChartRamp(p):"relationship-ramp"===p.type?f=z.renderRelationshipRamp(p,this.id,{opacity:C.opacity,effectList:w,ariaLabel:this.messages.previewRelationshipRampAriaLabel}):"univariate-above-and-below-ramp"===p.type?f=this._renderUnivariateAboveAndBelowRamp(p,
C.opacity,w):"univariate-color-size-ramp"===p.type&&(f=this._renderUnivariateColorSizeRamp(p,C.opacity,w));if(!f)return null;R=u.tsx("div",{key:K,class:m.CSS.section,id:`${K}-panel`,role:"tabpanel","aria-labelledby":K,tabIndex:0},[W,f]);X||this._sectionMap.set(K,R);return R};B._renderPieChartRamp=function(p){return u.tsx("div",{class:m.CSS.pieChartRampPreview,bind:p.preview,afterCreate:r.attachToNode})};B._renderUnivariateAboveAndBelowRamp=function(p,E,K){const {sizeRampElement:R,colorRampElement:X}=
k.getUnivariateAboveAndBelowRampElements(p,E,"horizontal");if(!R)return null;p=k.getUnivariateSizeRampSize(R,"full",!0,"horizontal");var W=k.getUnivariateColorRampSize(R,"above",!0,"horizontal"),f=k.getUnivariateColorRampSize(R,"below",!0,"horizontal"),D=this.messages?.previewColorRampAriaLabel;W=k.getUnivariateColorRampPreview(X,{width:W,height:12,rampAlignment:"horizontal",opacity:E,type:"above",effectList:K,ariaLabel:D});E=k.getUnivariateColorRampPreview(X,{width:f,height:12,rampAlignment:"horizontal",
opacity:E,type:"below",effectList:K,ariaLabel:D});K=k.getUnivariateColorRampMargin(R,"card");f=R.infos.map(w=>w.label);const C=f.length-1;f=f.map((w,F)=>0===F||F===C?u.tsx("div",{key:F},w):null);D={marginTop:"3px",display:"flex"};J.isRTL(this.container)?D.marginRight=`${K}px`:D.marginLeft=`${K}px`;p={width:`${p}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return u.tsx("div",{class:m.CSS.layerRow,key:"size-ramp-preview",styles:{display:"flex",flexDirection:"column"}},u.tsx("div",
{class:this.classes(m.CSS.symbolContainer,m.CSS.sizeRampHorizontal),styles:{display:"flex",flexDirection:"row"}},R.infos.map((w,F)=>u.tsx("div",{key:F,class:m.CSS.symbol,bind:w.preview,afterCreate:r.attachToNode}))),W?u.tsx("div",{class:m.CSS.univariateAboveAndBelowColorRamp,styles:D,key:"color-ramp-preview"},u.tsx("div",{bind:W,afterCreate:r.attachToNode}),u.tsx("div",{bind:E,afterCreate:r.attachToNode})):null,u.tsx("div",{class:m.CSS.layerInfo},u.tsx("div",{class:m.CSS.rampLabelsContainer,styles:p},
f)))};B._renderUnivariateColorSizeRamp=function(p,E,K){const {sizeRampElement:R,colorRampElement:X}=k.getUnivariateColorSizeRampElements(p,"horizontal");if(!R)return null;p=k.getUnivariateSizeRampSize(R,"full",!1,"horizontal");var W=k.getUnivariateColorRampSize(R,"full",!1,"horizontal");E=k.getUnivariateColorRampPreview(X,{width:W,height:12,rampAlignment:"horizontal",opacity:E,type:"full",effectList:K,ariaLabel:this.messages?.previewColorRampAriaLabel});const f=k.getUnivariateColorRampMargin(R,"card"),
D=R.infos.length-1;K=R.infos.map((C,w)=>0===w||w===D?u.tsx("div",{key:w},C.label):null);W={marginTop:"3px",display:"flex"};J.isRTL(this.container)?W.marginRight=`${f}px`:W.marginLeft=`${f}px`;p={width:`${p}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return u.tsx("div",{class:m.CSS.layerRow,key:"size-ramp-preview",styles:{display:"flex",flexDirection:"column"}},u.tsx("div",{class:this.classes(m.CSS.symbolContainer,m.CSS.sizeRampHorizontal),styles:{display:"flex",flexDirection:"row"}},
R.infos.map((C,w)=>u.tsx("div",{key:w,class:m.CSS.symbol,bind:C.preview,afterCreate:r.attachToNode}))),u.tsx("div",{class:m.CSS.univariateAboveAndBelowColorRamp,styles:W,key:"color-ramp-preview"},u.tsx("div",{bind:E,afterCreate:r.attachToNode})),u.tsx("div",{class:m.CSS.layerInfo},u.tsx("div",{class:m.CSS.rampLabelsContainer,styles:p},K)))};B._renderLegendForElementInfo=function(p,E,K,R){var X=E.layer;if(p.type)return this._renderLegendForElement(p,E,R,!1,!0);K=r.isImageryStretchedLegend(X,K);if(p.preview){if(!p.symbol||
!p.symbol.type.includes("simple-fill")){if(!p.label)return u.tsx("div",{key:R,bind:p.preview,afterCreate:r.attachToNode});E={[m.CSS.symbolCell]:this._hasIndicators};return u.tsx("div",{key:R,class:this.classes(m.CSS.layerRow,{[m.CSS.symbolRow]:this._hasIndicators})},u.tsx("div",{class:this.classes(E),bind:p.preview,afterCreate:r.attachToNode}),u.tsx("div",{class:this.classes(m.CSS.imageLabel,{[m.CSS.labelCell]:this._hasIndicators})},r.getTitle(this.messages,p.label,!1)||""))}let W=K=255,f=255,D=0,
C=255,w=255,F=255,U=0;const Z=p.symbol.color&&p.symbol.color.a,fa=p.symbol.outline&&p.symbol.outline.color&&p.symbol.outline.color.a;Z&&(K=p.symbol.color.r,W=p.symbol.color.g,f=p.symbol.color.b,D=p.symbol.color.a*X.opacity);fa&&(C=p.symbol.outline.color.r,w=p.symbol.outline.color.g,F=p.symbol.outline.color.b,U=p.symbol.outline.color.a*X.opacity);const ca=(X=p.symbol.color?.isBright??!0)?"rgba(255, 255, 255, .6)":"rgba(0, 0, 0, .6)";E={background:Z?`rgba(${K}, ${W}, ${f}, ${D})`:"none",color:X?"black":
"white",textShadow:`-1px -1px 0 ${ca},\n                                              1px -1px 0 ${ca},\n                                              -1px 1px 0 ${ca},\n                                              1px 1px 0 ${ca}`,border:fa?`1px solid rgba(${C}, ${w}, ${F}, ${U})`:"none",filter:a.getCSSFilterFromEffectList(E.effectList)??void 0};return u.tsx("div",{key:R,class:m.CSS.layerRow},u.tsx("div",{class:m.CSS.labelElement,styles:E}," ",p.label," "))}if(p.src)return E=this._renderImage(p,
X,K),u.tsx("div",{key:R,class:m.CSS.layerRow},E,u.tsx("div",{class:m.CSS.imageLabel},p.label||""))};B._renderImage=function(p,E,K){const {label:R,src:X,opacity:W}=p;K={[m.CSS.imageryLayerStretchedImage]:K,[m.CSS.symbol]:!K};E={opacity:`${null!=W?W:E.opacity}`};return u.tsx("img",{alt:r.getTitle(this.messages,R,!1),"aria-label":r.getTitle(this.messages,R,!1),src:X,border:0,width:p.width,height:p.height,class:this.classes(K),styles:E})};B._renderSizeRampLines=function(p){p=p.infos;var E=p[0],K=p[p.length-
1],R=E.symbol;p=this._hasIndicators;E=v.pt2px(E.size+E.outlineSize)*d;K=v.pt2px(K.size+K.outlineSize)*d;const X=p?E:E+50*d,W=p?E/2+50*d:E;var f;R?R.type.includes("3d")?(f=R.symbolLayers&&R.symbolLayers.length)?(f=R.symbolLayers.at(f-1).get("resource.primitive"),f="triangle"===f||"cone"===f||"tetrahedron"===f):f=void 0:f="triangle"===R.style:f=void 0;if(R)if(R.type.includes("3d")){var D=R.symbolLayers&&R.symbolLayers.length;D?(R=R.symbolLayers.at(D-1),R=R.resource&&R.resource.primitive,R="circle"===
R||"cross"===R||"kite"===R||"sphere"===R||"cube"===R||"diamond"===R):R=void 0}else R=R.style,R="circle"===R||"diamond"===R||"cross"===R;else R=void 0;D=document.createElement("canvas");D.width=X;D.height=W;D.style.width=`${D.width/d}px`;D.style.height=`${D.height/d}px`;const C=D.getContext("2d");if(p){C.beginPath();var w=X/2-K/2;C.moveTo(0,0);C.lineTo(w,W);w=X/2+K/2;C.moveTo(X,0);C.lineTo(w,W)}else C.beginPath(),C.moveTo(0,W/2-K/2),C.lineTo(X,0),C.moveTo(0,W/2+K/2),C.lineTo(X,W);C.strokeStyle="#ddd";
C.stroke();return u.tsx("div",{bind:D,afterCreate:r.attachToNode,styles:p?{display:"flex",marginTop:`-${f?0:R?E/2:0}px`,marginBottom:`-${f?K:R?K/2:0}px`}:{display:"flex",marginRight:`-${f?0:R?E/2:0}px`,marginLeft:`-${f?0:R?K/2:0}px`}})};B._renderSizeRamp=function(p,E){var K=p.infos;const R=K[0].label,X=K[K.length-1].label;let W=K[0].preview;K=K[K.length-1].preview;const f=this._hasIndicators,D={"flex-direction":f?"column":"row-reverse"};W&&(W=W.cloneNode(!0),W.style.display="flex");K&&(K=K.cloneNode(!0),
K.style.display="flex");E={opacity:null!=E?`${E}`:""};return u.tsx("div",{class:this.classes(m.CSS.layerRow,{[m.CSS.sizeRampRow]:f})},u.tsx("div",{class:m.CSS.rampLabel},f?R:X),u.tsx("div",{class:m.CSS.sizeRampContainer,styles:D},u.tsx("div",{bind:W,afterCreate:r.attachToNode,class:m.CSS.sizeRampPreview,styles:E}),this._renderSizeRampLines(p),u.tsx("div",{bind:K,afterCreate:r.attachToNode,class:m.CSS.sizeRampContainer,styles:E})),u.tsx("div",{class:m.CSS.rampLabel},f?X:R))};B._renderLegendForRamp=
function(p,E,K){var R=p.infos;const X="heatmap-ramp"===p.type,W=R.length-1;var f=2<W&&!X?25*W:100,D=f+20;const C=R.slice(0).reverse();C.forEach((U,Z)=>{U.offset=X?U.ratio:Z/W});const w=C.length-1;p=(p=0!==C.length%2&&C[C.length/2|0])&&u.tsx("div",{class:m.CSS.intervalSeparatorsContainer},u.tsx("div",{class:m.CSS.intervalSeparator},"|"),u.tsx("div",{class:m.CSS.rampLabel},p.label));const F=R[R.length-1].label;R=R[0].label;f=n.renderSVG([[{shape:{type:"path",path:"M0 12.5 L10 0 L10 25 Z"},fill:C[0].color,
stroke:{width:0}},{shape:{type:"rect",x:10,y:0,width:f,height:25},fill:{type:"linear",x1:10,y1:0,x2:f+10,y2:0,colors:C},stroke:{width:0}},{shape:{type:"path",path:`M${f+10} 0 L${D} ${12.5} L${f+10} ${25} Z`},fill:C[w].color,stroke:{width:0}}]],D,25);({messages:D}=this);E={filter:a.getCSSFilterFromEffectList(K)??void 0,opacity:null==E?void 0:`${E}`};return u.tsx("div",{class:m.CSS.layerRow,styles:{justifyContent:"center"}},u.tsx("div",{class:m.CSS.rampLabel},X?D[F]:F),u.tsx("div",{class:m.CSS.symbolContainer},
u.tsx("div",{styles:E},f),p),u.tsx("div",{class:m.CSS.rampLabel},X?D[R]:R))};return y._createClass(P)}(e);L.__decorate([I.property()],M.prototype,"activeLayerInfos",void 0);L.__decorate([I.property()],M.prototype,"headingLevel",void 0);L.__decorate([I.property()],M.prototype,"layout",void 0);L.__decorate([I.property(),l.messageBundle("esri/widgets/Legend/t9n/Legend")],M.prototype,"messages",void 0);L.__decorate([I.property(),l.messageBundle("esri/t9n/common")],M.prototype,"messagesCommon",void 0);
L.__decorate([I.property({readOnly:!0})],M.prototype,"type",void 0);L.__decorate([I.property()],M.prototype,"view",void 0);L.__decorate([c.accessibleHandler()],M.prototype,"_selectSection",null);return M=L.__decorate([g.subclass("esri.widgets.Legend.styles.Card")],M)})},"esri/widgets/Legend/styles/CardCSS":function(){define(["exports"],function(y){y.CSS={activated:"esri-legend--card__carousel-indicator--activated",base:"esri-legend--card",stacked:"esri-legend--stacked",carouselTitle:"esri-legend--card__carousel-title",
indicator:"esri-legend--card__carousel-indicator",intervalSeparator:"esri-legend--card__interval-separator",imageryLayerStretchedImage:"esri-legend--card__imagery-layer-image--stretched",imageLabel:"esri-legend--card__image-label",layerCaption:"esri-legend--card__layer-caption",labelElement:"esri-legend--card__label-element",layerRow:"esri-legend--card__layer-row",labelCell:"esri-legend--card__label-cell",message:"esri-legend--card__message",rampLabel:"esri-legend--card__ramp-label",section:"esri-legend--card__section",
relationshipSection:"esri-legend--card__relationship-section",serviceCaptionText:"esri-legend--card__service-caption-text",serviceContent:"esri-legend--card__service-content",service:"esri-legend--card__service",groupLayer:"esri-legend--card__group-layer",groupLayerChild:"esri-legend--card__group-layer-child",symbol:"esri-legend--card__symbol",sizeRampRow:"esri-legend--card__size-ramp-row",symbolRow:"esri-legend--card__symbol-row",symbolCell:"esri-legend--card__symbol-cell",indicatorContainer:"esri-legend--card__carousel-indicator-container",
intervalSeparatorsContainer:"esri-legend--card__interval-separators-container",relationshipLabelContainer:"esri-legend--card__relationship-label-container",labelContainer:"esri-legend--card__label-container",serviceCaptionContainer:"esri-legend--card__service-caption-container",symbolContainer:"esri-legend--card__symbol-container",sizeRampContainer:"esri-legend--card__size-ramp-container",sizeRampPreview:"esri-legend--card__size-ramp-preview",pieChartRampPreview:"esri-legend--card__pie-chart-ramp-preview",
rampContainer:"esri-legend__ramps",sizeRampHorizontal:"esri-legend__size-ramp--horizontal",rampLabelsContainer:"esri-legend__ramp-labels",layerInfo:"esri-legend__layer-cell esri-legend__layer-cell--info",univariateAboveAndBelowColorRamp:"esri-univariate-above-and-below-ramp__color--card",hidden:"esri-hidden"};Object.defineProperty(y,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/support/univariateUtils":function(){define("exports ../../../../core/screenUtils ../../../../libs/maquette/projection ../../../../libs/maquette/projector ../../../../symbols/support/symbolUtils ../../../support/widgetUtils ../../../support/jsxFactory".split(" "),
function(y,L,M,x,v,I,G){function N(m="vertical"){return"vertical"===m?G.tsx("svg",{height:"4",width:"10"},G.tsx("line",{x1:"0",y1:"2",x2:"10",y2:"2",style:"stroke:rgb(200, 200, 200);stroke-width:1"})):G.tsx("svg",{height:"10",width:"10"},G.tsx("line",{x1:"5",y1:"0",x2:"5",y2:"10",style:"stroke:rgb(200, 200, 200);stroke-width:1"}))}function S(m,z="vertical"){const k=document.createElement("div");k.style.height="20px";k.className=e.univariateAboveAndBelowSymbol;null!=m&&(k.style.opacity=m.toString());
a.append(k,N.bind(null,z));return k}function g(m,z,k="vertical",r){m.infos.forEach((H,c)=>{if(r&&2===c)H.preview=S(z,k);else{c=L.pt2px(H.size)+("horizontal"===k?20:10);const l=H.preview,u="div"===l?.tagName.toLowerCase(),J=u?l:document.createElement("div");J.className=e.univariateAboveAndBelowSymbol;"horizontal"===k?J.style.width=`${c}px`:J.style.height=`${c}px`;!u&&l&&J.appendChild(l);H.preview=J}})}function n(m,z,k,r="vertical"){let H=0;m=m.infos;const c=Math.floor(m.length/2);var l="full"===z||
"above"===z?0:c;for(z="full"===z||"below"===z?m.length-1:c;l<=z;l++)if(k&&l===c)H+="horizontal"===r?10:20;else{const u=L.pt2px(m[l].size)+("horizontal"===r?20:10);H+=u}return Math.round(H)}const a=x.createProjector(),e={univariateAboveAndBelowSymbol:"esri-univariate-above-and-below-ramp__symbol",colorRamp:"esri-legend__color-ramp"};y.getUnivariateAboveAndBelowRampElements=function(m,z,k="vertical"){var r=m.infos;m=r.find(({type:H})=>"size-ramp"===H);r=r.find(({type:H})=>"color-ramp"===H);m&&(m={...m},
m.infos=[...m.infos],g(m,z,k,!0));r&&(r={...r},r.infos=[...r.infos]);"horizontal"===k&&(m?.infos.reverse(),r?.infos.reverse());return{sizeRampElement:m,colorRampElement:r}};y.getUnivariateColorRampMargin=function(m,z="classic"){m=m.infos;return"classic"===z?(L.pt2px(m[0].size)+10)/2:(L.pt2px(m[0].size)-L.pt2px(m[m.length-1].size))/2};y.getUnivariateColorRampPreview=function(m,z){if(!m)return null;m=m.infos.map(k=>k.color);m=v.renderColorRampPreviewHTML("full"===z.type?m:"above"===z.type?m.slice(0,
3):m.slice(2,5),{width:z.width,height:z.height,align:z.rampAlignment,effectList:z.effectList,ariaLabel:z.ariaLabel});m.className=e.colorRamp;null!=z.opacity&&(m.style.opacity=z.opacity.toString());return m};y.getUnivariateColorRampSize=function(m,z,k,r="vertical"){const H=n(m,z,k,r);m=m.infos;var c=Math.floor(m.length/2);const l="full"===z||"above"===z?0:c;c="full"===z||"below"===z?m.length-1:c;k=k?"vertical"===r?20:10:0;r="vertical"===r?10*("full"===z?2:1):20*("full"===z?2:1);return Math.round(H-
(L.pt2px("full"===z?m[l].size+m[c].size:"above"===z?m[l].size:m[c].size)/2+k/2+r/2))};y.getUnivariateColorSizeRampElements=function(m,z="vertical"){var k=m.infos;m=k.find(({type:r})=>"size-ramp"===r);k=k.find(({type:r})=>"color-ramp"===r);m&&(m={...m},m.infos=[...m.infos],g(m,null,z,!1));k&&(k={...k},k.infos=[...k.infos]);"horizontal"===z&&(m?.infos.reverse(),k?.infos.reverse());return{sizeRampElement:m,colorRampElement:k}};y.getUnivariateSizeRampSize=n;Object.defineProperty(y,Symbol.toStringTag,
{value:"Module"})})},"esri/widgets/Legend/support/styleUtils":function(){define(["exports","../../../intl","../../../intl/substitute"],function(y,L,M){y.attachToNode=function(x){x.appendChild(this)};y.getTitle=function(x,v,I){if(v){if("string"===typeof v||"number"===typeof v)return v;if("value"in v||"unit"in v)return M.substitute(x.dotValue,v);if("colorName"in v&&"bandName"in v)return x[v.colorName]+": "+(x[v.bandName]||v.bandName);if("showCount"in v)return v.showCount?x.clusterCountTitle:void 0;
var G=null;I?G=v.ratioPercentTotal?"showRatioPercentTotal":v.ratioPercent?"showRatioPercent":v.ratio?"showRatio":v.normField?"showNormField":v.field?"showField":null:I||(G=v.normField?"showNormField":v.normByPct?"showNormPct":v.field?"showField":null);return G?M.substitute("showField"===G?"{field}":x[G],{field:v.field,normField:v.normField}):void 0}};y.isImageryStretchedLegend=function(x,v){return!!(v&&"Stretched"===v&&10.3<=x.version&&"esri.layers.ImageryLayer"===x.declaredClass)};y.isRendererTitle=
function(x,v){return!v};Object.defineProperty(y,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/Heading":function(){define(["exports","../../core/mathUtils","./widgetUtils","./jsxFactory"],function(y,L,M,x){const v={heading:"esri-widget__heading"};y.CSS=v;y.Heading=function({level:I,class:G,...N},S){I=L.clamp(Math.ceil(I),1,6);return x.tsx(`h${I}`,{...N,class:M.classes(v.heading,G),role:"heading","aria-level":String(I)},S)};y.incrementHeadingLevel=function(I,G=1){return L.clamp(Math.ceil(I+
G),1,6)};Object.defineProperty(y,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/Classic":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../intl ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../Widget ./ClassicCSS ./support/relationshipUtils ./support/univariateUtils ../support/styleUtils ../../support/Heading ../../support/widgetUtils ../../support/decorators/messageBundle ../../support/jsxFactory ../../../intl/number".split(" "),
function(y,L,M,x,v,I,G,N,S,g,n,a,e,m,z,k,r,H){const c=`${g.LEGEND}__`,l={display:"flex",alignItems:"flex-start"},u={marginLeft:"3px"},J={display:"table-cell",verticalAlign:"middle"};M=function(O){function q(h,P){h=O.call(this,h,P)||this;h.activeLayerInfos=null;h.headingLevel=3;h.messages=null;h.type="classic";return h}y._inherits(q,O);var d=q.prototype;d.render=function(){var h=this.activeLayerInfos;h=h&&h.toArray().map(P=>this._renderLegendForLayer(P)).filter(P=>!!P);return r.tsx("div",null,h&&h.length?
h:r.tsx("div",{class:g.CSS.message},this.messages.noLegend))};d._renderLegendForLayer=function(h){if(!h.ready)return null;var P=!!h.children.length;const B=`${c}${h.layer.uid}-version-${h.version}`,p=h.title?m.Heading({level:this.headingLevel,class:this.classes(g.CSS.header,g.CSS.label)},h.title):null;if(P)return P=h.children.map(E=>this._renderLegendForLayer(E)).toArray(),r.tsx("div",{key:B,class:this.classes(g.CSS.service,g.CSS.groupLayer)},p,P);if((P=h.legendElements)&&!P.length)return null;P=
P.map(E=>this._renderLegendForElement(E,h.layer,h.effectList)).filter(E=>!!E);return P.length?r.tsx("div",{key:B,class:this.classes(g.CSS.service,{[g.CSS.groupLayerChild]:!!h.parent}),tabIndex:0},p,r.tsx("div",{class:g.CSS.layer},P)):null};d._renderLegendForElement=function(h,P,B,p){var E="color-ramp"===h.type,K="opacity-ramp"===h.type;const R="size-ramp"===h.type;let X=null;if("symbol-table"===h.type||R){var W=h.infos.map(D=>this._renderLegendForElementInfo(D,P,B,R,h.legendType)).filter(D=>!!D);
W.length&&(X=r.tsx("div",{class:g.CSS.layerBody},W))}else"color-ramp"===h.type||"opacity-ramp"===h.type||"heatmap-ramp"===h.type||"stretch-ramp"===h.type?X=this._renderLegendForRamp(h,P.opacity):"relationship-ramp"===h.type?X=n.renderRelationshipRamp(h,this.id,{opacity:P.opacity,effectList:B,ariaLabel:this.messages.previewRelationshipRampAriaLabel}):"pie-chart-ramp"===h.type?X=this._renderPieChartRamp(h):"univariate-above-and-below-ramp"===h.type?X=this._renderUnivariateAboveAndBelowRamp(h,P.opacity,
B):"univariate-color-size-ramp"===h.type&&(X=this._renderUnivariateColorSizeRamp(h,P.opacity,B));if(!X)return null;W=h.title;var f=null;"string"===typeof W?f=W:W&&(f=e.getTitle(this.messages,W,E||K),f=e.isRendererTitle(W,E||K)&&W.title?`${W.title} (${f})`:f);E=p?g.CSS.layerChildTable:g.CSS.layerTable;K=f?r.tsx("div",{class:g.CSS.layerCaption},f):null;return r.tsx("div",{class:this.classes(E,{[g.CSS.layerTableSizeRamp]:R||!p})},K,X)};d._renderPieChartRamp=function(h){return r.tsx("div",{bind:h.preview,
afterCreate:e.attachToNode})};d._renderUnivariateAboveAndBelowRamp=function(h,P,B){const {sizeRampElement:p,colorRampElement:E}=a.getUnivariateAboveAndBelowRampElements(h,P);if(!p)return null;var K=this.messages?.previewColorRampAriaLabel,R=a.getUnivariateColorRampSize(p,"above",!0);h=a.getUnivariateColorRampSize(p,"below",!0);const X=a.getUnivariateColorRampPreview(E,{width:12,height:R,rampAlignment:"vertical",opacity:P,type:"above",effectList:B,ariaLabel:K});P=a.getUnivariateColorRampPreview(E,
{width:12,height:h,rampAlignment:"vertical",opacity:P,type:"below",effectList:B,ariaLabel:K});var W=a.getUnivariateColorRampMargin(p);const f=p.infos.map(F=>F.label);B=f.map((F,U)=>{const Z=2===U;return 0===U?r.tsx("div",{key:U,class:F?X?g.CSS.univariateAboveAndBelowLabel:g.CSS.rampLabel:void 0},F):Z?r.tsx("div",null):null});const D=f.length-1,C=Math.floor(f.length/2);K=f.map((F,U)=>{const Z=U===D;return U===C||Z?r.tsx("div",{key:U,class:F?X?g.CSS.univariateAboveAndBelowLabel:g.CSS.rampLabel:void 0},
F):null});const w={display:"table-cell",verticalAlign:"middle"};W={marginTop:`${W}px`};R={height:`${R}px`};h={height:`${h}px`};return r.tsx("div",{key:"univariate-above-and-below-ramp-preview",styles:l},r.tsx("div",{class:g.CSS.layerBody},p.infos.map((F,U)=>r.tsx("div",{class:this.classes(g.CSS.layerRow,g.CSS.sizeRamp)},r.tsx("div",{class:g.CSS.symbol,styles:w,bind:F.preview,afterCreate:e.attachToNode}),X||0!==U%2?null:r.tsx("div",{class:g.CSS.layerInfo},f[U])))),X?r.tsx("div",{styles:W,key:"color-ramp-preview"},
r.tsx("div",{styles:u},r.tsx("div",{styles:J},r.tsx("div",{class:g.CSS.rampContainer,bind:X,afterCreate:e.attachToNode})),r.tsx("div",{styles:J},r.tsx("div",{class:g.CSS.rampLabelsContainer,styles:R},B))),r.tsx("div",{styles:u},r.tsx("div",{styles:J},r.tsx("div",{class:g.CSS.rampContainer,bind:P,afterCreate:e.attachToNode})),r.tsx("div",{styles:J},r.tsx("div",{class:g.CSS.rampLabelsContainer,styles:h},K)))):null)};d._renderUnivariateColorSizeRamp=function(h,P,B){const {sizeRampElement:p,colorRampElement:E}=
a.getUnivariateColorSizeRampElements(h);if(!p)return null;var K=a.getUnivariateColorRampMargin(p);h=a.getUnivariateColorRampSize(p,"full",!1);P=a.getUnivariateColorRampPreview(E,{width:12,height:h,rampAlignment:"vertical",opacity:P,type:"full",effectList:B,ariaLabel:this.messages?.previewColorRampAriaLabel});const R=p.infos.length-1;B=p.infos.map((W,f)=>0===f||f===R?r.tsx("div",{key:f,class:W.label?E?g.CSS.univariateAboveAndBelowLabel:g.CSS.rampLabel:void 0},W.label):null);const X={display:"table-cell",
verticalAlign:"middle"};K={marginTop:`${K}px`};h={height:`${h}px`};return r.tsx("div",{key:"univariate-above-and-below-ramp-preview",styles:l},r.tsx("div",{class:g.CSS.layerBody},p.infos.map(W=>r.tsx("div",{class:this.classes(g.CSS.layerRow,g.CSS.sizeRamp)},r.tsx("div",{class:g.CSS.symbol,styles:X,bind:W.preview,afterCreate:e.attachToNode})))),r.tsx("div",{styles:K,key:"color-ramp-preview"},r.tsx("div",{styles:u},r.tsx("div",{styles:J},r.tsx("div",{class:g.CSS.rampContainer,bind:P,afterCreate:e.attachToNode})),
r.tsx("div",{styles:J},r.tsx("div",{class:g.CSS.rampLabelsContainer,styles:h},B)))))};d._renderLegendForRamp=function(h,P){const B=h.infos,p="heatmap-ramp"===h.type,E="stretch-ramp"===h.type,K=h.preview;K.className=`${g.CSS.colorRamp} ${"opacity-ramp"===h.type?g.CSS.opacityRamp:""}`;null!=P&&(K.style.opacity=P.toString());h=B.map(R=>r.tsx("div",{class:R.label?g.CSS.rampLabel:void 0},p?this.messages[R.label]||R.label:E?this._getStretchStopLabel(R):R.label));P={height:K.style.height};return r.tsx("div",
{class:g.CSS.layerRow},r.tsx("div",{class:g.CSS.symbolContainer,styles:{width:"24px"}},r.tsx("div",{class:g.CSS.rampContainer,bind:K,afterCreate:e.attachToNode})),r.tsx("div",{class:g.CSS.layerInfo},r.tsx("div",{class:g.CSS.rampLabelsContainer,styles:P},h)))};d._getStretchStopLabel=function(h){return h.label?this.messages[h.label]+": "+("string"===typeof h.value?h.value:H.formatNumber(h.value,{style:"decimal",notation:h.value.toString().includes("e")?"scientific":"standard"})):""};d._renderLegendForElementInfo=
function(h,P,B,p,E){if(h.type)return this._renderLegendForElement(h,P,B,!0);B=null;E=e.isImageryStretchedLegend(P,E);h.preview?B=r.tsx("div",{class:g.CSS.symbol,bind:h.preview,afterCreate:e.attachToNode}):h.src&&(B=this._renderImage(h,P,E));if(!B)return null;P={[g.CSS.imageryLayerInfoStretched]:E};return r.tsx("div",{class:g.CSS.layerRow},r.tsx("div",{class:this.classes(g.CSS.symbolContainer,{[g.CSS.imageryLayerInfoStretched]:E,[g.CSS.sizeRamp]:!E&&p})},B),r.tsx("div",{class:this.classes(g.CSS.layerInfo,
P)},e.getTitle(this.messages,h.label,!1)||""))};d._renderImage=function(h,P,B){const {label:p,src:E,opacity:K}=h;B={[g.CSS.imageryLayerStretchedImage]:B,[g.CSS.symbol]:!B};P={opacity:`${null!=K?K:P.opacity}`};return r.tsx("img",{alt:e.getTitle(this.messages,p,!1),"aria-label":e.getTitle(this.messages,p,!1),src:E,border:0,width:h.width,height:h.height,class:this.classes(B),styles:P})};return y._createClass(q)}(S);L.__decorate([x.property()],M.prototype,"activeLayerInfos",void 0);L.__decorate([x.property()],
M.prototype,"headingLevel",void 0);L.__decorate([x.property(),k.messageBundle("esri/widgets/Legend/t9n/Legend")],M.prototype,"messages",void 0);L.__decorate([x.property({readOnly:!0})],M.prototype,"type",void 0);return M=L.__decorate([N.subclass("esri.widgets.Legend.styles.Classic")],M)})},"esri/widgets/Legend/styles/ClassicCSS":function(){define(["exports"],function(y){y.CSS={service:"esri-legend__service",label:"esri-legend__service-label",layer:"esri-legend__layer",groupLayer:"esri-legend__group-layer",
groupLayerChild:"esri-legend__group-layer-child",layerTable:"esri-legend__layer-table",layerTableSizeRamp:"esri-legend__layer-table--size-ramp",layerChildTable:"esri-legend__layer-child-table",layerCaption:"esri-legend__layer-caption",layerBody:"esri-legend__layer-body",layerRow:"esri-legend__layer-row",layerCell:"esri-legend__layer-cell",layerInfo:"esri-legend__layer-cell esri-legend__layer-cell--info",imageryLayerStretchedImage:"esri-legend__imagery-layer-image--stretched",imageryLayerCellStretched:"esri-legend__imagery-layer-cell--stretched",
imageryLayerInfoStretched:"esri-legend__imagery-layer-info--stretched",symbolContainer:"esri-legend__layer-cell esri-legend__layer-cell--symbols",symbol:"esri-legend__symbol",rampContainer:"esri-legend__ramps",sizeRamp:"esri-legend__size-ramp",colorRamp:"esri-legend__color-ramp",opacityRamp:"esri-legend__opacity-ramp",borderlessRamp:"esri-legend__borderless-ramp",rampTick:"esri-legend__ramp-tick",rampFirstTick:"esri-legend__ramp-tick-first",rampLastTick:"esri-legend__ramp-tick-last",rampLabelsContainer:"esri-legend__ramp-labels",
rampLabel:"esri-legend__ramp-label",univariateAboveAndBelowSymbol:"esri-univariate-above-and-below-ramp__symbol",univariateAboveAndBelowLabel:"esri-univariate-above-and-below-ramp__label",message:"esri-legend__message",header:"esri-widget__heading",hidden:"esri-hidden"};y.LEGEND="esri-legend";Object.defineProperty(y,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./Legend/LegendViewModel ./Legend/styles/Card ./Legend/styles/Classic ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory".split(" "),function(y,L,M,x,v,I,G,N,S,g,n,a,e,m,z){I=function(k){function r(c,l){c=k.call(this,c,l)||
this;c.headingLevel=3;c.iconClass="esri-icon-layer-list";c.icon=null;c.messages=null;c.style=new a;c.viewModel=new g;return c}y._inherits(r,k);var H=r.prototype;H.initialize=function(){this.addHandles([M.on(()=>this.view,"resize",()=>this.scheduleRender()),M.on(()=>this.activeLayerInfos,"change",()=>this._refreshActiveLayerInfos(this.activeLayerInfos)),M.watch(()=>this.headingLevel,c=>{const {style:l}=this;l&&(l.headingLevel=c)}),M.watch(()=>this.style,(c,l)=>{l&&c!==l&&l.destroy();c&&(c.activeLayerInfos=
this.activeLayerInfos,"card"===c.type&&(c.view=this.view),c.headingLevel=this.headingLevel)},M.initial)])};H.castStyle=function(c){if(c instanceof n||c instanceof a)return c;if("string"===typeof c)return"card"===c?new n:new a;if(c&&"string"===typeof c.type){const l={...c};delete l.type;return new ("card"===c.type?n:a)(l)}return new a};H.render=function(){return z.tsx("div",{class:this.classes("esri-legend","esri-widget",this.style instanceof a?"esri-widget--panel":null)},this.style.render())};H._refreshActiveLayerInfos=
function(c){c.forEach(l=>{this.removeHandles(`version_${l.layer.uid}`);this._renderOnActiveLayerInfoChange(l)});this.scheduleRender()};H._renderOnActiveLayerInfoChange=function(c){var l=M.watch(()=>c.version,()=>this.scheduleRender());this.addHandles(l,`version_${c.layer.uid}`);l=M.on(()=>c.children,"change",()=>c.children.forEach(u=>this._renderOnActiveLayerInfoChange(u)),M.initial);this.addHandles(l,`version_${c.layer.uid}`);c.children.forEach(u=>this._renderOnActiveLayerInfoChange(u))};y._createClass(r,
[{key:"activeLayerInfos",get:function(){return this.viewModel.activeLayerInfos},set:function(c){this.viewModel.activeLayerInfos=c}},{key:"basemapLegendVisible",get:function(){return this.viewModel.basemapLegendVisible},set:function(c){this.viewModel.basemapLegendVisible=c}},{key:"groundLegendVisible",get:function(){return this.viewModel.groundLegendVisible},set:function(c){this.viewModel.groundLegendVisible=c}},{key:"hideLayersNotInCurrentView",get:function(){return this.viewModel.hideLayersNotInCurrentView},
set:function(c){this.viewModel.hideLayersNotInCurrentView=c}},{key:"keepCacheOnDestroy",get:function(){return this.viewModel.keepCacheOnDestroy},set:function(c){this.viewModel.keepCacheOnDestroy=c}},{key:"respectLayerVisibility",get:function(){return this.viewModel.respectLayerVisibility},set:function(c){this.viewModel.respectLayerVisibility=c}},{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(c){this._overrideIfSome("label",c)}},{key:"layerInfos",get:function(){return this.viewModel.layerInfos},
set:function(c){this.viewModel.layerInfos=c}},{key:"view",get:function(){return this.viewModel.view},set:function(c){this.viewModel.view=c}}]);return r}(S);L.__decorate([x.property()],I.prototype,"activeLayerInfos",null);L.__decorate([x.property()],I.prototype,"basemapLegendVisible",null);L.__decorate([x.property()],I.prototype,"groundLegendVisible",null);L.__decorate([x.property()],I.prototype,"headingLevel",void 0);L.__decorate([x.property()],I.prototype,"hideLayersNotInCurrentView",null);L.__decorate([x.property()],
I.prototype,"keepCacheOnDestroy",null);L.__decorate([x.property()],I.prototype,"respectLayerVisibility",null);L.__decorate([x.property()],I.prototype,"iconClass",void 0);L.__decorate([x.property()],I.prototype,"icon",void 0);L.__decorate([x.property()],I.prototype,"label",null);L.__decorate([x.property()],I.prototype,"layerInfos",null);L.__decorate([x.property(),m.messageBundle("esri/widgets/Legend/t9n/Legend")],I.prototype,"messages",void 0);L.__decorate([x.property()],I.prototype,"style",void 0);
L.__decorate([v.cast("style")],I.prototype,"castStyle",null);L.__decorate([x.property()],I.prototype,"view",null);L.__decorate([x.property()],I.prototype,"viewModel",void 0);return I=L.__decorate([N.subclass("esri.widgets.Legend")],I)});
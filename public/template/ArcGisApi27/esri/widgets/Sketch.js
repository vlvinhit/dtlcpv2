// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Sketch/SketchViewModel":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../symbols ../../core/Collection ../../core/Error ../../core/Evented ../../core/Handles ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../geometry/ellipsoidUtils ../../geometry/projection ../../geometry/support/coordsUtils ../../geometry/support/spatialReferenceUtils ../../layers/GraphicsLayer ../../views/3d/interactive/editingTools/isSupportedGraphicUtils ../../views/3d/interactive/editingTools/moveGraphic/isSupportedGraphic ../../views/3d/interactive/editingTools/reshapeGraphic/isSupportedGraphic ../../views/3d/interactive/editingTools/transformGraphic/isSupportedGraphic ../../views/draw/support/layerUtils ../../views/input/InputManager ../../views/interactive/keybindings ../../views/interactive/sketch/SketchLabelOptions ../../views/interactive/sketch/SketchTooltipOptions ../../views/interactive/snapping/SnappingManager ../../views/interactive/snapping/SnappingOptions ../../views/interactive/snapping/snappingUtils ../../views/support/hitTestSelectUtils ../../views/support/screenUtils ./support/OperationHandle ../../symbols/SimpleMarkerSymbol ../../symbols/SimpleFillSymbol ../../symbols/SimpleLineSymbol ../../symbols/MeshSymbol3D ../../symbols/FillSymbol3DLayer".split(" "),
function(a,n,b,z,p,w,A,B,d,u,E,y,v,H,C,f,l,t,k,F,e,r,q,h,D,m,c,g,G,K,L,O,U,R,V,X,Q,I,J,S,aa,fa){function ea(ja){return"polygon"===ja||"rectangle"===ja||"circle"===ja}function ka(ja,oa){qa("undo",ja.history.undo,ja.history.redo,oa)}function na(ja,oa){qa("redo",ja.history.redo,ja.history.undo,oa)}function qa(ja,oa,da,x){if(oa=oa.pop()){var N=oa.updates,P=[];x.forEach((M,W)=>{W=N[W];null!=W&&("geometry"in W&&null!=W.geometry&&(P.push({geometry:M.geometry}),M.geometry=W.geometry),"symbol"in W&&null!=
W.symbol&&(P.push({symbol:M.symbol}),M.symbol=W.symbol),"undo"in W&&(P.push(W),W[ja](M)))});da.push({updates:P})}}function pa(ja){return{updates:ja.map(oa=>({geometry:oa.geometry}))}}function la(ja){return"requireError"in ja&&"aborted"===ja.requireError}const sa=ja=>Object.freeze(Object.defineProperty({__proto__:null,default:ja},Symbol.toStringTag,{value:"Module"})),ta={defaultZ:0},ra={reshapeOptions:{edgeOperation:"split",shapeOperation:"move",vertexOperation:"move"},enableMoveAllGraphics:!0,enableRotation:!0,
enableScaling:!0,multipleSelectionEnabled:!0,preserveAspectRatio:!1,toggleToolOnClick:!0,enableZ:!0,highlightOptions:{enabled:!0},tool:"transform"};A=function(ja){function oa(x){x=ja.call(this,x)||this;x._numUpdating=0;x._handles=new B;x._internalGraphicsLayer=new r({listMode:"hide",internal:!0,title:"SVM Internal"});x._operationHandle=null;x._viewHandles=new B;x.activeFillSymbol=null;x.activeLineSymbol=null;x.activeVertexSymbol=null;x.allowDeleteKey=!0;x.labelOptions=new K;x.layer=null;x.pointSymbol=
new I({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}});x.polygonSymbol=new J({color:[150,150,150,.2],outline:{color:[50,50,50],width:2}});x.polylineSymbol=new S({color:[130,130,130,1],width:2});x.meshSymbol=new aa({symbolLayers:[new fa]});x._snappingManager=null;x.tooltipOptions=new L;x.updateGraphics=new p;x.updateOnGraphicClick=!0;x.vertexSymbol=new I({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}});x._moduleLoaderAbortController=null;
x._viewReadyAbortController=null;x._originalPopupEnabled=null;x.defaultCreateOptions=ta;x.defaultUpdateOptions=ra;x.snappingOptions=new U;return x}n._inherits(oa,ja);var da=oa.prototype;da.initialize=function(){this._handles.add([y.on(()=>this.view?.map?.layers,"change",x=>{x.removed.includes(this.layer)&&this.cancel()}),y.on(()=>this.layer?.graphics,"change",x=>{if(null!=this._operationHandle)for(const N of x.removed)this.updateGraphics.includes(N)&&(1<this.updateGraphics.length?this._operationHandle.removeFromSelection(N):
this._operationHandle.cancel())}),y.watch(()=>this.layer?.elevationInfo??null,x=>{x!==this._internalGraphicsLayer.elevationInfo&&(this.cancel(),this._internalGraphicsLayer.elevationInfo=x)},y.syncAndInitial),y.watch(()=>this.view,x=>{u.destroyMaybe(this._snappingManager);x&&(this._snappingManager=new O.SnappingManager({view:x,options:this.snappingOptions}),"2d"===x.type?new Promise((N,P)=>a(["../../views/2d/interactive/editingTools"],N,P)):"3d"===x.type&&(new Promise((N,P)=>a(["../../views/3d/interactive/editingTools"],
N,P)),new Promise((N,P)=>a(["../../views/3d/layers/GraphicsLayerView3D"],M=>N(sa(M)),P))))},y.syncAndInitial),y.watch(()=>this.view?.spatialReference,(x,N)=>{x&&N&&!x.equals(N)&&this.cancel()})]);R.setupSnappingToggleHandles(this)};da.destroy=function(){this.cancel();this._handles=u.destroyMaybe(this._handles);this._viewHandles=u.destroyMaybe(this._viewHandles);this._removeDefaultLayer();this._snappingManager=u.destroyMaybe(this._snappingManager);this._set("view",null);this.emit("destroy")};da.cancel=
function(){this._moduleLoaderAbortController=u.abortMaybe(this._moduleLoaderAbortController);this._viewReadyAbortController=u.abortMaybe(this._viewReadyAbortController);this._operationHandle&&this._operationHandle.cancel()};da.complete=function(){this._operationHandle&&this._operationHandle.complete()};da.delete=function(){const {state:x,updateGraphics:N}=this;if("active"===x&&N.length){const {activeTool:P,layer:M}=this,W=N.toArray();M.removeMany(W);this.cancel();this._emitDeleteEvent({graphics:W,
tool:P})}};da.duplicate=function(){if("active"===this.state&&this.updateGraphics.length){const x=this.updateGraphics.map(N=>N.clone()).toArray();this.layer.addMany(x);this.emit("duplicate",{graphics:x,type:"duplicate"});return x}return[]};da.create=async function(x,N){this.cancel();await this._waitViewReady();const {view:P,layer:M}=this;if(!P||"disabled"===this.state)throw M||this._logMissingLayer(),E.createAbortError();null!=P.activeTool&&(P.activeTool=null);if(x){c.addUniqueLayer(P,this._internalGraphicsLayer);
var W=await this._setupCreateOperation(x,N);null==W||this.destroyed?P.map.remove(this._internalGraphicsLayer):(W.on("complete",()=>{if(W===this._operationHandle){const ca=this.createGraphic,ba=this._operationHandle.cancelled;this._operationHandle.destroy();this._operationHandle=null;this._set("createGraphic",null);this.view&&this.view.map&&this.view.map.remove(this._internalGraphicsLayer);W.cancelled||null==ca||M.add(ca);this.emit("create",{graphic:ca,state:ba?"cancel":"complete",tool:x,toolEventInfo:null,
type:"create"})}}),this._operationHandle=W,P.ready&&P.focus())}else this._logError("sketch:missing-parameter","Missing parameter 'tool'.")};da.update=async function(x,N){this.cancel();await this._waitViewReady();const {layer:P,view:M,state:W}=this;if(!M||"disabled"===W)throw P||this._logMissingLayer(),E.createAbortError();null!=M.activeTool&&(M.activeTool=null);const ca=Array.isArray(x)?x:[x];null!=x&&ca&&ca.length?ca.some(ba=>ba.layer!==P?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."),
!0):null==ba.geometry?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with an unsupported geometry."),!0):!1)||(x=await this._setupUpdateOperation(ca,N),this.destroyed||null==x||la(x)||(c.addUniqueLayer(M,this._internalGraphicsLayer),this._setUpdateOperationHandle(x,N),this.emit("update",{graphics:ca,state:"start",aborted:!1,tool:x.tool,toolEventInfo:null,type:"update"}))):this._logError("sketch:missing-parameter","Missing parameter 'graphics'.")};da._updateSpatialReference=
async function(x){const N=this.view;if(N){this._beginAsyncOperation();x=Array.isArray(x)?x:[x];for(const P of x)null==P.geometry||"mesh"===P.geometry.type||e.equals(P.geometry.spatialReference,N.spatialReference)||(k.canProjectWithoutEngine(P.geometry.spatialReference,N.spatialReference)||k.isLoaded()||await k.load(),P.geometry=k.project(P.geometry,N.spatialReference));this._endAsyncOperation()}else this._logMissingView()};da.undo=function(){this.canUndo()&&this._operationHandle?.undo()};da.redo=
function(){this.canRedo()&&this._operationHandle?.redo()};da.canUndo=function(){return!(!this._operationHandle||!this._operationHandle.canUndo())};da.canRedo=function(){return!(!this._operationHandle||!this._operationHandle.canRedo())};da.toggleUpdateTool=function(){this._operationHandle&&this._operationHandle.toggleTool&&this._operationHandle.toggleTool()};da._getFirstHit=async function(x){var N=this.view;if(!N)return this._logMissingView(),null;if("2d"===N.type){const M=[];N.map.allLayers.forEach(W=>
{"vector-tile"!==W.type&&"imagery"!==W.type||M.push(W)});N=await N.hitTest(x,{exclude:M});return V.findFirstGraphicHit(N.results)}const P=[N.map.ground];N.map.allLayers.forEach(M=>{"integrated-mesh"===M.type&&P.push(M)});x=await N.hitTest(x,{exclude:P});if(0<x.results.length){const M=x.results[0];if(null!=M&&"graphic"===M.type&&M.graphic&&(!x.ground.mapPoint||1>N.map.ground.opacity||x.ground.distance-(M.distance??0)>-Math.min(3*x.ground.distance,"global"===N.viewingMode?t.getReferenceEllipsoid(N.renderCoordsHelper.spatialReference).radius/
N.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY)))return M}return null};da._generateViewHandles=function(x){return[x.on("immediate-click",async N=>{var P="active"===this.state&&"create"===this._operationHandle?.type;if("disabled"!==this.state&&!P&&this.updateOnGraphicClick){this._beginAsyncOperation();var M=await N.async(()=>this._getFirstHit(X.createScreenPointFromEvent(N)));P=null;null!=M?(M=M.graphic,this.updateGraphics.includes(M)||M.layer===this.layer?(N.stopPropagation(),P=M):"2d"!==
x.type||this._isComponentGraphic(M)||"active"!==this.state||this.cancel()):"active"===this.state&&this.cancel();null==P||this.updateGraphics.includes(P)||await this.update([P],{...this.defaultUpdateOptions,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions}});this._endAsyncOperation()}},g.ViewEventPriorities.WIDGET)]};da._setupCreateOperation=async function(x,N){const P=this.view;if(!P)return this._logMissingView(),null;x=await this._setupDrawGraphicTool(x,P,{hasZ:"3d"===P.type,...this.defaultCreateOptions,
...N});if(null==x)return null;P.tools.add(x);P.activeTool=x;return this._setupCreateOperationHandle(x)};da._setupDrawGraphicTool=async function(x,N,P){if("multipoint"===x&&"3d"===N.type)return this._logError("sketch:create","Multipoint geometries are not supported in SceneView."),null;if(!N)return this._logMissingView(),null;const M="rectangle"!==x,W="rectangle"!==x;x={view:N,mode:"rectangle"===x||"circle"===x?"hybrid":"click",...P,snapToScene:!1,geometryType:x,graphicSymbol:this._getGraphicSymbolFromTool(x),
snappingManager:this._snappingManager,forceUniformSize:W,centered:M};return"2d"===N.type?this._makeDrawGraphicTool2D(x):this._makeDrawGraphicTool3D(x)};da._makeDrawGraphicTool2D=async function(x){const N=await this._requireModule(new Promise((P,M)=>a(["../../views/2d/interactive/editingTools"],P,M)));return la(N)||this.destroyed?null:new N.module.DrawGraphicTool2D({...x,activeVertexSymbol:this.activeVertexSymbol,regularVerticesSymbol:this.vertexSymbol,activeLineSymbol:this.activeLineSymbol,activeFillSymbol:ea(x.geometryType)?
this.activeFillSymbol:null,tooltipOptions:this.tooltipOptions})};da._makeDrawGraphicTool3D=async function(x){const N=await this._requireModule(new Promise((M,W)=>a(["../../views/3d/interactive/editingTools"],M,W)));if(la(N)||this.destroyed)return null;const {elevationInfo:P}=this.layer;return new N.module.DrawGraphicTool3D({...x,elevationInfo:P,snapToScene:null!=P?"absolute-height"===P.mode:!0,labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions})};da._setupCreateOperationHandle=function(x){const N=
this.view;if(!N)return this._logMissingView(),null;let P=null;const M=x.forceUniformSize,W=x.centered,ca=[N.on("key-down",T=>{if(T.key===G.SKETCH_KEYS.pan)T.stopPropagation(),T.repeat||(x.enabled=!1);else if(T.key===G.SKETCH_KEYS.complete)T.stopPropagation(),x.completeCreateOperation();else if(T.key!==G.SKETCH_KEYS.vertexAdd||T.repeat)T.key===G.SKETCH_KEYS.undo?(T.stopPropagation(),ba.undo()):T.key===G.SKETCH_KEYS.redo?(T.stopPropagation(),ba.redo()):T.key!==G.SKETCH_KEYS.constraint||"rectangle"!==
x.geometryType&&"circle"!==x.geometryType||T.repeat?T.key!==G.SKETCH_KEYS.center||T.repeat||(x.centered=!W,T.stopPropagation()):(x.forceUniformSize=!M,T.stopPropagation());else{const Y=x.drawOperation.geometryType;if("polyline"===Y||"polygon"===Y||"multipoint"===Y)T.stopPropagation(),x.drawOperation.commitStagedVertex()}},g.ViewEventPriorities.WIDGET),N.on("key-up",T=>{T.key===G.SKETCH_KEYS.pan?x.enabled=!0:T.key!==G.SKETCH_KEYS.constraint||"rectangle"!==x.geometryType&&"circle"!==x.geometryType?
T.key===G.SKETCH_KEYS.center&&(x.centered=W,T.stopPropagation()):(x.forceUniformSize=M,T.stopPropagation())},g.ViewEventPriorities.WIDGET),x.on("vertex-add",T=>{P=null==P?"start":"active";switch(T.operation){case "apply":this.emit("create",{graphic:x.graphic,state:P,tool:this.activeTool,toolEventInfo:T,type:"create"});break;case "undo":this._emitUndoEvent({graphics:[x.graphic],tool:x.geometryType});break;case "redo":this._emitRedoEvent({graphics:[x.graphic],tool:x.geometryType})}}),x.on("cursor-update",
T=>{0<x.drawOperation.numCommittedVertices&&this.emit("create",{graphic:x.graphic,state:"active",tool:this.activeTool,toolEventInfo:{coordinates:T.vertices[0].coordinates,type:"cursor-update"},type:"create"})}),x.on("vertex-remove",T=>{switch(T.operation){case "apply":this.emit("create",{graphic:x.graphic,state:"active",tool:this.activeTool,toolEventInfo:T,type:"create"});break;case "undo":this._emitUndoEvent({graphics:[x.graphic],tool:x.geometryType});break;case "redo":this._emitRedoEvent({graphics:[x.graphic],
tool:x.geometryType})}}),x.on("complete",T=>{this._set("createGraphic",T.graphic);P="complete";T.aborted?ba&&ba.cancel():ba&&ba.complete()}),y.watch(()=>this._getGraphicSymbolFromTool(x.geometryType),T=>{x.graphicSymbol=T})],ba=new Q.CreateOperationHandle({activeComponent:x,tool:x.geometryType,type:"create",onEnd:()=>{ca.forEach(T=>T.remove());ca.length=0;N.tools?.remove(x)},undo:()=>{x.canUndo&&x.undo()},redo:()=>{x.canRedo&&x.redo()},canUndo:()=>x.canUndo,canRedo:()=>x.canRedo});return ba};da._getGraphicSymbolFromTool=
function(x){switch(x){case "point":case "multipoint":return this.pointSymbol;case "polyline":return this.polylineSymbol;case "circle":case "rectangle":case "polygon":return this.polygonSymbol;case "mesh":return this.meshSymbol}};da._setupUpdateOperation=async function(x,N){const {layer:P,view:M}=this;if(!M)return this._logMissingView(),null;N={tool:this._defaultUpdateTool,...this.defaultUpdateOptions,...N,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions,...N?.reshapeOptions},highlightOptions:{...this.defaultUpdateOptions.highlightOptions,
...N?.highlightOptions}};var W=N.tool;for(var ca of x)P.remove(ca),P.add(ca);if("3d"===M.type){if(0===x.length)return null;switch(W){case "move":return this._setupMove3DOperation(x,N,M,W);case "reshape":if(1<x.length)return this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null;W=D.isSupportedGraphic(x[0]);if(W===q.SupportedGraphicResult.SUPPORTED)return this._setupReshape3DOperation(x[0],N,M);this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${q.isSupportedGraphicResultMessage(W)}).`);
return null;case "transform":return this._setupGraphicTransform3DOperation(x,N,M)}}switch(W){case "move":return this._setupMove2DOperation(x,N,M);case "reshape":if(1<x.length)return this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null;ca=D.isSupportedGraphic(x[0]);if(ca===q.SupportedGraphicResult.SUPPORTED)return this._setupTransformOrReshape2DOperation(x,W,N,M);this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${q.isSupportedGraphicResultMessage(ca)}).`);
return null;case "transform":return 1===x.length&&(ca=x[0].geometry?.type,"point"===ca||"multipoint"===ca)&&(W="reshape"),this._setupTransformOrReshape2DOperation(x,W,N,M)}};da._setupMove3DOperation=async function(x,N,P,M,W=!1){for(var ca of x){const Z=h.isSupportedGraphic(ca);if(Z!==q.SupportedGraphicResult.SUPPORTED)return this._logError("sketch:move",`Move operation not supported for provided graphic(s) (${q.isSupportedGraphicResultMessage(Z)}).`),null}ca=await this._requireModule(new Promise((Z,
ha)=>a(["../../views/3d/interactive/editingTools"],Z,ha)));if(la(ca))return ca;const ba=new ca.module.GraphicMoveTool({view:P,enableZ:N.enableZ,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions});P.tools.add(ba);ba.graphics.addMany(x);W||this.updateGraphics.addMany(x);const T=[],Y=new Q.UpdateOperationHandle({activeComponent:ba,tool:M,type:"update",onEnd:()=>{T.forEach(Z=>Z.remove());T.length=0;P.tools?.remove(ba);ba.destroyed||ba.destroy()},undo:()=>{ka(Y,this.updateGraphics.toArray());
this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:M})},redo:()=>{na(Y,this.updateGraphics.toArray());this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:M})},addToSelection:Z=>{this.updateGraphics.push(Z);ba.graphics.push(Z);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[Z],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:Z=>{const ha=this.updateGraphics.indexOf(Z);
Y.history.undo.forEach(ma=>ma.updates.splice(ha,1));Y.history.redo.forEach(ma=>ma.updates.splice(ha,1));this.updateGraphics.remove(Z);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[Z],type:"selection-change"},type:"update"});0===this.updateGraphics.length?Y.complete():ba.graphics.remove(Z)},toggleTool:async()=>{if(1===this.updateGraphics.length&&!1!==N.toggleToolOnClick&&"transform"===M){var Z=this.updateGraphics.at(0);
D.isSupportedGraphic(Z)===q.SupportedGraphicResult.SUPPORTED&&(Y.onEnd(),Y.destroy(),Z=await this._setupReshape3DOperation(Z,N,P,!0),la(Z)||this._setUpdateOperationHandle(Z,N))}}});T.push(...this._getHandlesForComponent(Y,N),P.on("immediate-click",Z=>this._getCommonUpdateOperationClickHandlers(Y,Z,N),g.ViewEventPriorities.WIDGET),P.on("key-down",Z=>{this._getCommonUpdateOperationKeyDownHandlers(Y,Z)},g.ViewEventPriorities.WIDGET));return Y};da._setupGraphicTransform3DOperation=function(x,N,P,M=!1){if(1===
x.length&&m.isSupportedGraphic(x[0])===q.SupportedGraphicResult.SUPPORTED){const W=x[0],ca=W.geometry;if(null!=ca&&("point"===ca.type||"mesh"===ca.type))return this._setupPointTransform3DOperation(W,N,P);if(null!=ca&&("polygon"===ca.type||"polyline"===ca.type))return this._setupPolyTransform3DOperation(W,N,P,M)}return this._setupMove3DOperation(x,N,P,"transform",M)};da._setupPointTransform3DOperation=async function(x,N,P){const {enableRotation:M,enableScaling:W,enableZ:ca}=N,ba=await this._requireModule(new Promise((ha,
ma)=>a(["../../views/3d/interactive/editingTools"],ha,ma)));if(la(ba))return ba;const T=new ba.module.GraphicTransformTool({graphic:x,view:P,enableRotation:M,enableScaling:W,enableZ:ca,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions});P.tools.add(T);this.updateGraphics.add(x);const Y=[],Z=new Q.UpdateOperationHandle({activeComponent:T,tool:"transform",type:"update",onEnd:()=>{Y.forEach(ha=>ha.remove());Y.length=0;P.tools?.remove(T);T.destroyed||T.destroy()},undo:()=>{ka(Z,
this.updateGraphics.toArray());this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},redo:()=>{na(Z,this.updateGraphics.toArray());this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},addToSelection:async ha=>{this.updateGraphics.add(ha);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[ha],removed:[],type:"selection-change"},type:"update"});Z.onEnd();Z.destroy();ha=await this._setupMove3DOperation(this.updateGraphics.toArray(),
N,P,"transform",!0);la(ha)||this._setUpdateOperationHandle(ha,N)},removeFromSelection:ha=>{this.updateGraphics.remove(ha);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[ha],type:"selection-change"},type:"update"});Z.complete()},toggleTool:()=>{}});Y.push(...this._getHandlesForComponent(Z,N),P.on("immediate-click",ha=>this._getCommonUpdateOperationClickHandlers(Z,ha,N),g.ViewEventPriorities.WIDGET),P.on("key-down",
ha=>{this._getCommonUpdateOperationKeyDownHandlers(Z,ha)},g.ViewEventPriorities.WIDGET));return Z};da._setupPolyTransform3DOperation=async function(x,N,P,M=!1){const {enableRotation:W,enableScaling:ca,enableZ:ba,preserveAspectRatio:T}=N,Y=await this._requireModule(new Promise((ia,va)=>a(["../../views/3d/interactive/editingTools"],ia,va)));if(la(Y))return Y;const Z=new Y.module.ExtentTransformTool({graphic:x,view:P,enableRotation:W,enableScaling:ca,enableZ:ba,preserveAspectRatio:T,tooltipOptions:this.tooltipOptions});
P.tools.add(Z);M||this.updateGraphics.add(x);const ha=[],ma=new Q.UpdateOperationHandle({activeComponent:Z,tool:"transform",type:"update",onEnd:()=>{ha.forEach(ia=>ia.remove());ha.length=0;P.tools?.remove(Z);Z.destroyed||Z.destroy()},canUndo:()=>Z.canUndo,undo:()=>{Z.undo();this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},canRedo:()=>Z.canRedo,redo:()=>{Z.redo();this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},addToSelection:async ia=>
{this.updateGraphics.add(ia);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[ia],removed:[],type:"selection-change"},type:"update"});ma.onEnd();ma.destroy();ia=await this._setupMove3DOperation(this.updateGraphics.toArray(),N,P,"transform",!0);la(ia)||this._setUpdateOperationHandle(ia,N)},removeFromSelection:ia=>{this.updateGraphics.remove(ia);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,
tool:this.activeTool,toolEventInfo:{added:[],removed:[ia],type:"selection-change"},type:"update"});ma.complete()},toggleTool:async()=>{if(1===this.updateGraphics.length&&!1!==N.toggleToolOnClick){var ia=this.updateGraphics.at(0);D.isSupportedGraphic(ia)===q.SupportedGraphicResult.SUPPORTED&&(ma.onEnd(),ma.destroy(),ia=await this._setupReshape3DOperation(ia,N,P,!0),la(ia)||this._setUpdateOperationHandle(ia,N))}}});ha.push(...this._getHandlesForComponent(ma,N),P.on("immediate-click",ia=>this._getCommonUpdateOperationClickHandlers(ma,
ia,N),g.ViewEventPriorities.WIDGET),P.on("key-down",ia=>this._getCommonUpdateOperationKeyDownHandlers(ma,ia),g.ViewEventPriorities.WIDGET),P.on("key-down",ia=>{ia.key!==G.SKETCH_KEYS.constraint||ia.repeat||(Z.preserveAspectRatio=!Z.preserveAspectRatio,ia.stopPropagation())},g.ViewEventPriorities.WIDGET),P.on("key-up",ia=>{ia.key===G.SKETCH_KEYS.constraint&&(Z.preserveAspectRatio=!Z.preserveAspectRatio,ia.stopPropagation())},g.ViewEventPriorities.WIDGET));return ma};da._setupMove2DOperation=async function(x,
N,P){this.updateGraphics.addMany(x);await this._updateSpatialReference(x);const M=await this._getGraphicMover(x,N,P);if(la(M))return M;const W=new Q.UpdateOperationHandle({activeComponent:M,tool:"move",type:"update",onEnd:()=>{this._displayDefaultCursor();T.forEach(Y=>Y.remove());ba.forEach(Y=>Y.remove());T=[];ba=[];M.destroy();this._internalGraphicsLayer?.removeMany([...this.updateGraphics.toArray()])},undo:()=>{const Y=this.updateGraphics.toArray();ka(W,Y);W.refreshComponent();this._emitUndoEvent({graphics:Y,
tool:"move"})},redo:()=>{const Y=this.updateGraphics.toArray();na(W,Y);W.refreshComponent();this._emitRedoEvent({graphics:Y,tool:"move"})},addToSelection:async Y=>{await this._updateSpatialReference(Y);this.updateGraphics.push(Y);M.graphics=this.updateGraphics.toArray();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[Y],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:Y=>{const Z=this.updateGraphics.indexOf(Y);
W.history.undo.forEach(ma=>ma.updates.splice(Z,1));W.history.redo.forEach(ma=>ma.updates.splice(Z,1));this.updateGraphics.remove(Y);const ha=this.updateGraphics.toArray();this.emit("update",{graphics:ha,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[Y],type:"selection-change"},type:"update"});0===this.updateGraphics.length?W.complete():M.graphics=ha}});let ca=!1,ba=[P.on("immediate-click",Y=>this._getCommonUpdateOperationClickHandlers(W,Y,N),g.ViewEventPriorities.WIDGET),
P.on("key-down",Y=>{this._getCommonUpdateOperationKeyDownHandlers(W,Y);Y.key!==G.SKETCH_KEYS.constraint||Y.repeat||(ca=!0,M.enableMoveAllGraphics=!M.enableMoveAllGraphics)},g.ViewEventPriorities.WIDGET),P.on("key-up",Y=>{Y.key===G.SKETCH_KEYS.constraint&&ca&&(ca=!1,M.enableMoveAllGraphics=!M.enableMoveAllGraphics)},g.ViewEventPriorities.WIDGET)],T=this._getHandlesForComponent(W,N);return W};da._setupReshape3DOperation=async function(x,N,P,M=!1){const W=await this._requireModule(new Promise((Z,ha)=>
a(["../../views/3d/interactive/editingTools"],Z,ha)));if(la(W))return W;const ca=N.reshapeOptions,ba=new W.module.GraphicReshapeTool({view:P,graphic:x,enableZVertex:N.enableZ&&"move"===ca?.vertexOperation,enableZShape:N.enableZ&&"move"===ca?.shapeOperation,enableMoveGraphic:"move"===ca?.shapeOperation||"move-xy"===ca?.shapeOperation,enableMidpoints:"split"===ca?.edgeOperation,enableEdgeOffset:"offset"===ca?.edgeOperation,snappingManager:this._snappingManager,labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions});
P.tools.add(ba);M||this.updateGraphics.add(x);const T=[],Y=new Q.UpdateOperationHandle({activeComponent:ba,tool:"reshape",type:"update",onEnd:()=>{T.forEach(Z=>Z.remove());T.length=0;P.tools?.remove(ba);ba.destroyed||ba.destroy()},canUndo:()=>ba.canUndo,undo:()=>{ba.undo();this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"reshape"})},canRedo:()=>ba.canRedo,redo:()=>{ba.redo();this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"reshape"})},addToSelection:async Z=>{this.updateGraphics.add(Z);
this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[Z],removed:[],type:"selection-change"},type:"update"});Y.onEnd();Y.destroy();Z=await this._setupMove3DOperation(this.updateGraphics.toArray(),N,P,"transform",!0);la(Z)||this._setUpdateOperationHandle(Z,N)},removeFromSelection:Z=>{this.updateGraphics.remove(Z);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],
removed:[Z],type:"selection-change"},type:"update"});Y.complete()},toggleTool:async()=>{if(!1!==N.toggleToolOnClick){Y.onEnd();Y.destroy();var Z=await this._setupGraphicTransform3DOperation(this.updateGraphics.toArray(),N,P,!0);la(Z)||this._setUpdateOperationHandle(Z,N)}}});T.push(...this._getHandlesForComponent(Y,N),P.on("immediate-click",Z=>this._getCommonUpdateOperationClickHandlers(Y,Z,N),g.ViewEventPriorities.WIDGET),P.on("key-down",Z=>{this._getCommonUpdateOperationKeyDownHandlers(Y,Z)},g.ViewEventPriorities.WIDGET));
return Y};da._setupTransformOrReshape2DOperation=async function(x,N,P,M){this.updateGraphics.addMany(x);await this._updateSpatialReference(x);x="transform"===N?await this._getBox(x,P,M):await this._getReshape(x,P,M);if(la(x))return x;const W=new Q.UpdateOperationHandle({activeComponent:x,type:"update",onEnd:()=>{ba.forEach(T=>T.remove());ca.forEach(T=>T.remove());ba=[];ca=[];W.activeComponent&&!W.activeComponent.destroyed&&W.activeComponent.destroy();this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray())},
undo:()=>{ka(W,this.updateGraphics.toArray());W.refreshComponent();this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:W.tool})},redo:()=>{na(W,this.updateGraphics.toArray());W.refreshComponent();this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:W.tool})},addToSelection:async T=>{var Y=W.activeComponent;if("reshape"===Y?.type){Y=[...this.updateGraphics,T];this.updateGraphics.removeAll();W.onEnd();W.destroy();Y=await this._setupMove2DOperation(Y,P,M);if(la(Y))return;this._setUpdateOperationHandle(Y,
P)}else this.updateGraphics.add(T),Y.graphics=this.updateGraphics.toArray(),Y.refresh(),W.resetHistory();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[T],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:async T=>{const Y=this.updateGraphics.indexOf(T);W.history.undo.forEach(ha=>ha.updates.splice(Y,1));W.history.redo.forEach(ha=>ha.updates.splice(Y,1));this.updateGraphics.remove(T);const Z=this.updateGraphics.toArray();
if(0===Z.length)W.complete();else{const ha=Z[0].geometry;1!==Z.length||null==ha||"point"!==ha.type&&"multipoint"!==ha.type?W.activeComponent.graphics=Z:W.toggleTool()}this.emit("update",{graphics:Z,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[T],type:"selection-change"},type:"update"})},toggleTool:async()=>{if(!(1<this.updateGraphics.length)){var T=this.updateGraphics.at(0),Y=T.geometry;if(null==Y||("reshape"!==W.tool||"point"!==Y.type&&"multipoint"!==Y.type)&&("transform"!==
W.tool||"extent"!==Y.type))Y=null,"transform"===W.tool?Y=await this._getReshape([T],P,M):"reshape"===W.tool&&(Y=await this._getBox([T],P,M)),la(Y)||(W.activeComponent?.destroy(),W.activeComponent=Y,W.activeComponent&&(ba.forEach(Z=>Z.remove()),ba=this._getHandlesForComponent(W,P)))}}});let ca=[M.on("immediate-click",T=>this._getCommonUpdateOperationClickHandlers(W,T,P),g.ViewEventPriorities.WIDGET),M.on("key-down",T=>{this._getCommonUpdateOperationKeyDownHandlers(W,T);T.key===G.SKETCH_KEYS.constraint&&
!T.repeat&&W&&(T=W.activeComponent)&&"box"===T.type&&(T.preserveAspectRatio=!T.preserveAspectRatio)},g.ViewEventPriorities.WIDGET),M.on("key-up",T=>{T.key===G.SKETCH_KEYS.constraint&&W&&(T=W.activeComponent)&&"box"===T.type&&(T.preserveAspectRatio=!T.preserveAspectRatio)},g.ViewEventPriorities.WIDGET)],ba=this._getHandlesForComponent(W,P);return W};da._getGraphicMover=async function(x,N,P){const {enableMoveAllGraphics:M,highlightOptions:W}=N;N=await this._requireModule(new Promise((ca,ba)=>a(["../../views/draw/support/GraphicMover"],
T=>ca(sa(T)),ba)));return la(N)?N:new N.module.default({enableMoveAllGraphics:M,highlightsEnabled:!!W?.enabled,indicatorsEnabled:!1,graphics:x,view:P,callbacks:{onGraphicMoveStart:({dx:ca,dy:ba,graphic:T})=>{this._displayGrabbingCursor();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ca,dy:ba,mover:T,type:"move-start"},type:"update"})},onGraphicMove:({dx:ca,dy:ba,graphic:T})=>this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ca,dy:ba,mover:T,type:"move"},type:"update"}),onGraphicMoveStop:({dx:ca,dy:ba,graphic:T})=>{this._displayPointerCursor();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ca,dy:ba,mover:T,type:"move-stop"},type:"update"})},onGraphicPointerOver:()=>this._displayPointerCursor(),onGraphicPointerOut:()=>this._displayDefaultCursor()}})};da._getBox=async function(x,
N,P){const {enableRotation:M,enableScaling:W,highlightOptions:ca,preserveAspectRatio:ba}=N;N=await this._requireModule(new Promise((T,Y)=>a(["../../views/draw/support/Box"],Z=>T(sa(Z)),Y)));return la(N)?N:new N.module.default({graphics:x,enableRotation:M,enableScaling:W,highlightsEnabled:!!ca?.enabled,preserveAspectRatio:ba,layer:this._internalGraphicsLayer,view:P,tooltipOptions:this.tooltipOptions,callbacks:{onMoveStart:T=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",
aborted:!1,tool:this.activeTool,toolEventInfo:{...T},type:"update"}),onMove:T=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...T},type:"update"}),onMoveStop:T=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...T},type:"update"}),onScaleStart:T=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,
toolEventInfo:{...T},type:"update"}),onScale:T=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...T},type:"update"}),onScaleStop:T=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...T},type:"update"}),onRotateStart:T=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...T},type:"update"}),
onRotate:T=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...T},type:"update"}),onRotateStop:T=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...T},type:"update"})}})};da._getReshape=async function(x,N,P){const M="split"===N.reshapeOptions?.edgeOperation,W="move"===N.reshapeOptions?.shapeOperation;N=!!N.highlightOptions?.enabled;const ca=await this._requireModule(new Promise((ba,
T)=>a(["../../views/draw/support/Reshape"],Y=>ba(sa(Y)),T)));return la(ca)?ca:new ca.module.default({enableMidpoints:M,enableMovement:W,graphic:x[0],highlightsEnabled:N,layer:this._internalGraphicsLayer,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions,view:P,callbacks:{onReshapeStart:ba=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ba},type:"update"}),onReshape:ba=>this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ba},type:"update"}),onReshapeStop:({mover:ba,type:T})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ba,type:T},type:"update"}),onMoveStart:({dx:ba,dy:T,mover:Y,type:Z})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ba,dy:T,mover:Y,type:Z},type:"update"}),onMove:({dx:ba,dy:T,
mover:Y,type:Z})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ba,dy:T,mover:Y,type:Z},type:"update"}),onMoveStop:({dx:ba,dy:T,mover:Y,type:Z})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ba,dy:T,mover:Y,type:Z},type:"update"}),onVertexAdd:({added:ba,type:T,vertices:Y})=>{ba=ba.map(Z=>F.geometryToCoordinates(Z.geometry));this.emit("update",
{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:ba,vertices:Y,type:T},type:"update"})},onVertexRemove:({removed:ba,type:T,vertices:Y})=>{ba=ba.map(Z=>F.geometryToCoordinates(Z.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{removed:ba,vertices:Y,type:T},type:"update"})}}})};da._getHandlesForComponent=function(x,N){const P=x.activeComponent;if(!P)return[];
switch(P.type){case "graphic-mover":return[P.on("graphic-click",({graphic:M,viewEvent:W})=>{W.native?.shiftKey&&(W.stopPropagation(),x.removeFromSelection(M))}),P.on("graphic-move-start",M=>x.addToHistory(pa(M.allGraphics)))];case "box":return[P.on("graphic-click",M=>this._onTransformOrReshape2DGraphicClick(x,N,M)),P.on("move-start",M=>x.addToHistory(pa(M.graphics))),P.on("rotate-start",M=>x.addToHistory(pa(M.graphics))),P.on("scale-start",M=>x.addToHistory(pa(M.graphics)))];case "reshape":return[P.on("graphic-click",
M=>this._onTransformOrReshape2DGraphicClick(x,N,M)),P.on("move-start",M=>x.addToHistory(pa([M.mover]))),P.on("reshape-start",M=>x.addToHistory(pa([M.graphic]))),P.on("vertex-add",M=>x.addToHistory(pa([M.oldGraphic]))),P.on("vertex-remove",M=>x.addToHistory(pa([M.oldGraphic])))];case "move-3d":return[P.on("graphic-move-start",M=>{x.addToHistory(pa(M.allGraphics));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:0<
M.allGraphics.length?M.allGraphics[0]:null,type:"move-start"},type:"update"})}),P.on("graphic-move",M=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:M.dx,dy:M.dy,mover:0<M.allGraphics.length?M.allGraphics[0]:null,type:"move"},type:"update"})}),P.on("graphic-move-stop",M=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:0<M.allGraphics.length?
M.allGraphics[0]:null,type:"move-stop"},type:"update"})}),P.on("immediate-click",M=>{M.shiftKey?this._toggleSelection([M.graphic],x,N):x.toggleTool()})];case "transform-3d":return[P.on("record-undo",({record:M})=>{x.addToHistory({updates:[M]})}),P.on("graphic-translate-start",M=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:M.graphic,dx:M.dxScreen,dy:M.dyScreen,type:"move-start"},type:"update"})}),P.on("graphic-translate-stop",
M=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:M.graphic,dx:M.dxScreen,dy:M.dyScreen,type:"move-stop"},type:"update"})}),P.on("graphic-rotate-start",M=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:M.graphic,angle:M.angle,type:"rotate-start"},type:"update"})}),P.on("graphic-rotate-stop",M=>{this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:M.graphic,angle:M.angle,type:"rotate-stop"},type:"update"})}),P.on("graphic-scale-start",M=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:M.graphic,xScale:M.xScale,yScale:M.yScale,type:"scale-start"},type:"update"})}),P.on("graphic-scale-stop",M=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,
toolEventInfo:{mover:M.graphic,xScale:M.xScale,yScale:M.yScale,type:"scale-stop"},type:"update"})}),P.on("graphic-translate",M=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:M.graphic,dx:M.dxScreen,dy:M.dyScreen,type:"move"},type:"update"})}),P.on("graphic-rotate",M=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:M.graphic,angle:M.angle,
type:"rotate"},type:"update"})}),P.on("graphic-scale",M=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:M.graphic,xScale:M.xScale,yScale:M.yScale,type:"scale"},type:"update"})}),P.on("immediate-click",M=>{M.shiftKey?this._toggleSelection([M.graphic],x,N):x.toggleTool()})];case "reshape-3d":return[P.on("reshape",M=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,
toolEventInfo:M,type:"update"})}),P.on("move",M=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:M,type:"update"})}),P.on("vertex-add",M=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:M,type:"update"})}),P.on("vertex-remove",M=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:M,type:"update"})}),
P.on("immediate-click",M=>{M.shiftKey?this._toggleSelection([M.graphic],x,N):x.toggleTool()})]}};da._onTransformOrReshape2DGraphicClick=function(x,N,P){const {graphic:M,viewEvent:W}=P;if(W.native?.shiftKey&&M.layer===this.layer)return W.stopPropagation(),x.removeFromSelection(M);if(N.toggleToolOnClick)return W.stopPropagation(),x.toggleTool()};da._setUpdateOperationHandle=function(x,N){this._operationHandle=x;const P=this.view?.map;this._disablePopup(N);x.on("complete",()=>{if(x===this._operationHandle){const M=
this.updateGraphics.toArray(),W=this._operationHandle.tool;this._operationHandle.destroy();this._operationHandle=null;this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray());this.updateGraphics.removeAll();P&&P.remove(this._internalGraphicsLayer);this._restorePopup(N);this.emit("update",{graphics:M,state:"complete",aborted:x.cancelled,tool:W,toolEventInfo:null,type:"update"})}})};da._getCommonUpdateOperationClickHandlers=async function(x,N,P){const M=X.createScreenPointFromEvent(N),
W=await N.async(()=>this._getFirstHit(M));null==W?x.complete():N.native.shiftKey&&this._toggleSelection([W.graphic],x,P)?N.stopPropagation():this.updateGraphics.includes(W.graphic)?N.stopPropagation():x.complete()};da._toggleSelection=function(x,N,P){const M=!!P.multipleSelectionEnabled;return x.some(W=>null==W?!1:M&&W.layer===this.layer?(this.updateGraphics.includes(W)?N.removeFromSelection(W):N.addToSelection(W),!0):!1)};da._getCommonUpdateOperationKeyDownHandlers=function(x,N){if(x){var P=N.key;
P===G.SKETCH_KEYS.undo&&x.canUndo()?(N.stopPropagation(),x.undo()):P===G.SKETCH_KEYS.redo&&x.canRedo()?(N.stopPropagation(),x.redo()):P===G.SKETCH_KEYS.cancel?(N.stopPropagation(),x.cancel()):this.allowDeleteKey&&G.SKETCH_KEYS.delete.includes(P)&&this._onDeleteKey(N)}};da._onDeleteKey=function(x){if(this._operationHandle&&"update"===this._operationHandle.type){var N=this.activeComponent,P=this.updateGraphics.toArray();null!=N&&"reshape-3d"!==N.type&&("reshape"!==N.type||1===P.length&&"point"===P[0].geometry?.type)&&
(x.stopPropagation(),this.delete())}};da._removeDefaultLayer=function(){this._internalGraphicsLayer&&(this.view?.map?.remove(this._internalGraphicsLayer),this._internalGraphicsLayer=u.destroyMaybe(this._internalGraphicsLayer))};da._isComponentGraphic=function(x){const {activeComponent:N}=this;return x&&null!=N?x.attributes&&x.attributes.esriSketchTool||"draw-2d"===N.type&&N.graphic===x||("box"===N.type||"reshape"===N.type)&&N.isUIGraphic(x):!1};da._displayPointerCursor=function(){this.view&&this.view.container&&
"pointer"!==this.view.cursor&&(this.view.cursor="pointer")};da._displayGrabbingCursor=function(){this.view&&this.view.container&&"grabbing"!==this.view.cursor&&(this.view.cursor="grabbing")};da._displayDefaultCursor=function(){this.view&&this.view.container&&null!==this.view.cursor&&(this.view.cursor=null)};da._logError=function(x,N,P){d.getLogger(this).error(new w(x,N,P))};da._requireModule=async function(x){const N=new AbortController;this._moduleLoaderAbortController=N;x=await x;return this._moduleLoaderAbortController!==
N||N.signal.aborted?{requireError:"aborted"}:{module:x}};da._emitUndoEvent=function(x){this.emit("undo",{...x,type:"undo"})};da._emitRedoEvent=function(x){this.emit("redo",{...x,type:"redo"})};da._emitDeleteEvent=function(x){this.emit("delete",{...x,type:"delete"})};da.wait=function(){return y.whenOnce(()=>!this.updating)};da._beginAsyncOperation=function(){this._numUpdating+=1;this.notifyChange("updating")};da._endAsyncOperation=function(){--this._numUpdating;this.notifyChange("updating")};da._disablePopupEnabled=
function(x){return"3d"!==this.view?.type||this.updateOnGraphicClick||(x?.toggleToolOnClick??!1)};da._disablePopup=function(x){this._disablePopupEnabled(x)&&this.view&&null==this._originalPopupEnabled&&(this._originalPopupEnabled=this.view.popupEnabled,this.view.popupEnabled=!1)};da._restorePopup=function(x){this._disablePopupEnabled(x)&&this.view&&null!=this._originalPopupEnabled&&(this.view.popupEnabled=this._originalPopupEnabled,this._originalPopupEnabled=null)};da._waitViewReady=async function(){const x=
this.view;x?(u.abortMaybe(this._viewReadyAbortController),this._viewReadyAbortController=new AbortController,await E.whenOrAbort(y.whenOnce(()=>x?.ready),this._viewReadyAbortController.signal)):this._logMissingView()};da._logMissingView=function(){this._logError("sketch:missing-property",ua("view"))};da._logMissingLayer=function(){this._logError("sketch:missing-property",ua("layer"))};n._createClass(oa,[{key:"_defaultUpdateTool",get:function(){return"3d"===this.view?.type?"move":"transform"}},{key:"updating",
get:function(){return 0<this._numUpdating||null!=this._snappingManager&&this._snappingManager.updating}},{key:"activeTool",get:function(){return this._operationHandle?.tool??null}},{key:"activeComponent",get:function(){return this._operationHandle?.activeComponent??null}},{key:"createGraphic",get:function(){return null==this.activeComponent||"draw-3d"!==this.activeComponent.type&&"draw-2d"!==this.activeComponent.type?this._get("createGraphic"):this.activeComponent.graphic}},{key:"defaultCreateOptions",
get:function(){return this._get("defaultCreateOptions")},set:function(x){this._set("defaultCreateOptions",{...ta,...x})}},{key:"defaultUpdateOptions",get:function(){return this._get("defaultUpdateOptions")},set:function(x){this._set("defaultUpdateOptions",{...ra,...x,reshapeOptions:{...ra.reshapeOptions,...x?.reshapeOptions},highlightOptions:{...ra.highlightOptions,...x?.highlightOptions}})}},{key:"snappingOptions",set:function(x){null!=this._snappingManager&&(this._snappingManager.options=x);this._set("snappingOptions",
x)}},{key:"state",get:function(){const x=!(!this.view?.ready||!this.layer),N=this._operationHandle;return x&&N?"active":x?"ready":"disabled"}},{key:"view",get:function(){return this._get("view")},set:function(x){const N=this._get("view");if(N){const {container:P,map:M}=N;P&&(N.cursor=null);M&&M.remove(this._internalGraphicsLayer);this._viewHandles.removeAll();this.cancel()}this._handles.remove("view-ready");x&&this._handles.add(y.when(()=>x.ready,P=>{this._viewHandles.removeAll();P&&this._viewHandles.add(this._generateViewHandles(x))},
y.syncAndInitial),"view-ready");this._set("view",x)}},{key:"test",get:function(){return{operationHandle:this._operationHandle,defaultUpdateOptions:ra}}}]);return oa}(A.EventedAccessor);b.__decorate([v.property()],A.prototype,"updating",null);b.__decorate([v.property()],A.prototype,"_operationHandle",void 0);b.__decorate([v.property({readOnly:!0})],A.prototype,"activeTool",null);b.__decorate([v.property()],A.prototype,"activeFillSymbol",void 0);b.__decorate([v.property()],A.prototype,"activeLineSymbol",
void 0);b.__decorate([v.property()],A.prototype,"activeVertexSymbol",void 0);b.__decorate([v.property()],A.prototype,"allowDeleteKey",void 0);b.__decorate([v.property({readOnly:!0})],A.prototype,"createGraphic",null);b.__decorate([v.property()],A.prototype,"defaultCreateOptions",null);b.__decorate([v.property()],A.prototype,"defaultUpdateOptions",null);b.__decorate([v.property({type:K,nonNullable:!0})],A.prototype,"labelOptions",void 0);b.__decorate([v.property()],A.prototype,"layer",void 0);b.__decorate([v.property({types:z.symbolTypes})],
A.prototype,"pointSymbol",void 0);b.__decorate([v.property({types:z.symbolTypes})],A.prototype,"polygonSymbol",void 0);b.__decorate([v.property({types:z.symbolTypes})],A.prototype,"polylineSymbol",void 0);b.__decorate([v.property()],A.prototype,"meshSymbol",void 0);b.__decorate([v.property({type:U,nonNullable:!0})],A.prototype,"snappingOptions",null);b.__decorate([v.property()],A.prototype,"_snappingManager",void 0);b.__decorate([v.property({readOnly:!0})],A.prototype,"state",null);b.__decorate([v.property({type:L,
nonNullable:!0})],A.prototype,"tooltipOptions",void 0);b.__decorate([v.property({readOnly:!0})],A.prototype,"updateGraphics",void 0);b.__decorate([v.property()],A.prototype,"updateOnGraphicClick",void 0);b.__decorate([v.property({types:z.symbolTypes})],A.prototype,"vertexSymbol",void 0);b.__decorate([v.property({value:null})],A.prototype,"view",null);A=b.__decorate([l.subclass("esri.widgets.Sketch.SketchViewModel")],A);const ua=ja=>`Property '${ja}' is missing on SketchViewModel.`;return A})},"esri/layers/GraphicsLayer":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ../core/support/OwningCollection ./Layer ./mixins/BlendLayer ./mixins/ScaleRangeLayer ../support/GraphicsCollection ../symbols/support/ElevationInfo".split(" "),
function(a,n,b,z,p,w,A,B,d,u,E,y,v){z=function(H){function C(l){l=H.call(this,l)||this;l.elevationInfo=null;l.graphics=new y.GraphicsCollection;l.screenSizePerspectiveEnabled=!0;l.type="graphics";l.internal=!1;return l}a._inherits(C,H);var f=C.prototype;f.destroy=function(){this.removeAll();this.graphics.destroy()};f.add=function(l){this.graphics.add(l);return this};f.addMany=function(l){this.graphics.addMany(l);return this};f.removeAll=function(){this.graphics.removeAll();return this};f.remove=function(l){this.graphics.remove(l)};
f.removeMany=function(l){this.graphics.removeMany(l)};f.on=function(l,t){return a._get(a._getPrototypeOf(C.prototype),"on",this).call(this,l,t)};f.graphicChanged=function(l){this.emit("graphic-update",l)};return a._createClass(C)}(u.BlendLayer(E.ScaleRangeLayer(d)));n.__decorate([b.property({type:v})],z.prototype,"elevationInfo",void 0);n.__decorate([b.property(B.owningCollectionProperty(y.GraphicsCollection,"graphics"))],z.prototype,"graphics",void 0);n.__decorate([b.property({type:["show","hide"]})],
z.prototype,"listMode",void 0);n.__decorate([b.property()],z.prototype,"screenSizePerspectiveEnabled",void 0);n.__decorate([b.property({readOnly:!0})],z.prototype,"type",void 0);n.__decorate([b.property({constructOnly:!0})],z.prototype,"internal",void 0);return z=n.__decorate([A.subclass("esri.layers.GraphicsLayer")],z)})},"esri/views/3d/interactive/editingTools/isSupportedGraphicUtils":function(){define(["exports","../../../../core/has"],function(a,n){a.SupportedGraphicResult=void 0;(function(b){b[b.SUPPORTED=
0]="SUPPORTED";b[b.GRAPHICS_LAYER_MISSING=1]="GRAPHICS_LAYER_MISSING";b[b.GEOMETRY_MISSING=2]="GEOMETRY_MISSING";b[b.GEOMETRY_TYPE_UNSUPPORTED=3]="GEOMETRY_TYPE_UNSUPPORTED";b[b.ELEVATION_MODE_UNSUPPORTED=4]="ELEVATION_MODE_UNSUPPORTED";b[b.SYMBOL_TYPE_UNSUPPORTED=5]="SYMBOL_TYPE_UNSUPPORTED"})(a.SupportedGraphicResult||(a.SupportedGraphicResult={}));a.isSupportedGraphicResultMessage=function(b){switch(b){case a.SupportedGraphicResult.GRAPHICS_LAYER_MISSING:return"not owned by a graphics layer";case a.SupportedGraphicResult.GEOMETRY_MISSING:return"no geometry";
case a.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED:return"the geometry type is not supported";case a.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED:return"the elevation mode is not supported";case a.SupportedGraphicResult.SYMBOL_TYPE_UNSUPPORTED:return"the symbol type is not supported"}return""};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/moveGraphic/isSupportedGraphic":function(){define(["exports","../../../../../core/has","../../../../../support/elevationInfoUtils",
"../isSupportedGraphicUtils"],function(a,n,b,z){a.isSupportedGraphic=function(p){if("graphics"!==p.layer?.type)return z.SupportedGraphicResult.GRAPHICS_LAYER_MISSING;if(null==p.geometry)return z.SupportedGraphicResult.GEOMETRY_MISSING;switch(p.geometry.type){case "polygon":case "point":case "polyline":case "mesh":break;case "multipoint":case "extent":return z.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED;default:return z.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED}return"on-the-ground"!==
b.getGraphicEffectiveElevationMode(p)&&b.hasGraphicFeatureExpressionInfo(p)?z.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED:z.SupportedGraphicResult.SUPPORTED};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/support/elevationInfoUtils":function(){define(["exports","../symbols/support/unitConversionUtils"],function(a,n){function b(y,v){return null!=v&&v.mode?v.mode:(y?u:E).mode}function z(y,v){return null!=v?v:y?u:E}function p(y,v){return b(null!=y?y.hasZ:!1,v)}function w(y){const v=
A(y);return p(y.geometry,v)}function A(y){return y.layer&&"elevationInfo"in y.layer?y.layer.elevationInfo:null}function B(y,v,H,C,f,l,t=null){if(null!=l){var k=null!=t?t.mode:"absolute-height";if("on-the-ground"===k)return 0;({absoluteZ:l}=d(v,H,C,f,y,l));a:{t=null!=t&&null!=t.offset?t.offset:0;switch(k){case "absolute-height":y=l-t;break a;case "relative-to-ground":y=l-((y.elevationProvider.getElevation(v,H,C,f,"ground")??0)+t);break a;case "relative-to-scene":y=l-((y.elevationProvider.getElevation(v,
H,C,f,"scene")??0)+t);break a}y=void 0}return y}}function d(y,v,H,C,f,l){const t=null!=l.offset?l.offset:0;switch(l.mode){case "absolute-height":return{absoluteZ:H+t,elevation:0};case "on-the-ground":return H=f.elevationProvider.getElevation(y,v,0,C,"ground")??0,{absoluteZ:H,elevation:H};case "relative-to-ground":return y=f.elevationProvider.getElevation(y,v,H,C,"ground")??0,{absoluteZ:H+y+t,elevation:y};case "relative-to-scene":return y=f.elevationProvider.getElevation(y,v,H,C,"scene")??0,{absoluteZ:H+
y+t,elevation:y}}}const u={mode:"absolute-height",offset:0},E={mode:"on-the-ground",offset:null};a.absoluteHeightElevationInfo=u;a.elevationContextAffectsAlignment=function(y,v){if(null==v)return!1;({mode:v}=v);return null!=v&&("scene"===y&&"relative-to-scene"===v||"ground"===y&&"absolute-height"!==v)};a.elevationInfoLikeEquals=function(y,v){return y===v||null!=y&&null!=v&&y.mode===v.mode&&y.offset===v.offset};a.getConvertedElevation=function(y,v,H,C=null){return B(y,v.x,v.y,v.hasZ?v.z:0,v.spatialReference,
H,C)};a.getConvertedElevationFromVector=function(y,v,H,C,f=null){return B(y,v[0],v[1],2<v.length?v[2]:0,H,C,f)};a.getEffectiveElevationInfo=z;a.getEffectiveElevationMode=b;a.getGeometryEffectiveElevationInfo=function(y,v){return z(null!=y?!!y.hasZ:!1,v)};a.getGeometryEffectiveElevationMode=p;a.getGraphicEffectiveElevationInfo=function(y){var v=A(y);y=p(y.geometry,v);v=null!=v&&"on-the-ground"!==y?(v.offset??0)*n.getMetersPerUnit(v.unit??"meters"):0;return{mode:y,offset:v}};a.getGraphicEffectiveElevationMode=
w;a.getZForElevationMode=function(y,v,H){if(null!=H&&H.mode){var C=y.hasZ?y.z:0,f=null!=H.offset?H.offset:0;switch(H.mode){case "absolute-height":return C-f;case "on-the-ground":return 0;case "relative-to-ground":return y=(v.elevationProvider.getElevation(y.x,y.y,C,y.spatialReference,"ground")??0)+f,C-y;case "relative-to-scene":return y=(v.elevationProvider.getElevation(y.x,y.y,C,y.spatialReference,"scene")??0)+f,C-y}}};a.hasGraphicFeatureExpressionInfo=function(y){if("on-the-ground"===w(y))return!1;
y=A(y);y=null!=y&&y.featureExpressionInfo?y.featureExpressionInfo.expression:null;return!(!y||"0"===y)};a.onTheGroundElevationInfo=E;a.zValueInAbsoluteHeightMode=d;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/reshapeGraphic/isSupportedGraphic":function(){define(["exports","../../../../../geometry/Circle","../../../../../support/elevationInfoUtils","../isSupportedGraphicUtils"],function(a,n,b,z){function p(w){if("graphics"!==w.layer?.type)return{result:z.SupportedGraphicResult.GRAPHICS_LAYER_MISSING,
geometry:null};const {geometry:A}=w;if(null==A)return{result:z.SupportedGraphicResult.GEOMETRY_MISSING,geometry:null};if("on-the-ground"!==b.getGraphicEffectiveElevationMode(w)&&b.hasGraphicFeatureExpressionInfo(w))return{result:z.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED,geometry:null};const B=A.type;return"point"!==B&&"mesh"!==B&&"polyline"!==B&&("polygon"!==B||w.geometry instanceof n)?{result:z.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED,geometry:null}:{result:z.SupportedGraphicResult.SUPPORTED,
geometry:A}}a.geometryOfSupportedGraphic=function(w){return p(w).geometry};a.isSupportedGraphic=function(w){return p(w).result};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/Circle":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/unitUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./ellipsoidUtils ./Point ./Polygon ./support/geodesicUtils ./support/webMercatorUtils ./support/WKIDUnitConversion".split(" "),
function(a,n,b,z,p,w,A,B,d,u,E,y,v,H){var C;p=C=function(f){function l(...k){k=f.call(this,...k)||this;k.center=null;k.geodesic=!1;k.numberOfPoints=60;k.radius=1E3;k.radiusUnit="meters";return k}a._inherits(l,f);var t=l.prototype;t.normalizeCtorArgs=function(k,F){if(!k||!k.center){if(k&&k.rings)return a._get(a._getPrototypeOf(l.prototype),"normalizeCtorArgs",this).call(this,k,F);k={center:k}}return{...a._get(a._getPrototypeOf(l.prototype),"normalizeCtorArgs",this).call(this),...k,...F}};t.initialize=
function(){var k=this.center;const F=this.numberOfPoints;this.hasZ=k?.hasZ??!1;if(0===this.rings.length&&k){var e=b.convertUnit(this.radius,this.radiusUnit,"meters"),r=k.spatialReference,q="geographic";if(r.isWebMercator)q="webMercator";else if(null!=(r.wkid&&H[r.wkid])||r.wkt&&0===r.wkt.indexOf("PROJCS"))q="projected";if(this.geodesic){let h;switch(q){case "webMercator":h=v.webMercatorToGeographic(k);break;case "projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");
break;case "geographic":h=k}k=this._createGeodesicCircle(h,e,F);"webMercator"===q&&(k=v.geographicToWebMercator(k))}else{let h;"webMercator"===q||"projected"===q?h=e/this._convert2Meters(1,k.spatialReference):"geographic"===q&&(h=b.lengthToDegrees(e,"meters",d.getReferenceEllipsoid(k.spatialReference).radius));k=this._createPlanarCircle(k,h,F)}this.spatialReference=k.spatialReference;this.addRing(k.rings[0])}};t.clone=function(){const {center:k,numberOfPoints:F,radius:e,radiusUnit:r,geodesic:q}=this;
return new C({center:k?.clone(),numberOfPoints:F,radius:e,radiusUnit:r,geodesic:q})};t._createGeodesicCircle=function(k,F,e){let r=0;const q=[];for(;360>r;){const h=[0,0];y.directGeodeticSolver(h,[k.x,k.y],r,F);this.hasZ&&h.push(k.z);q.push(h);r+=360/e}q.push(q[0]);return new E(q)};t._createPlanarCircle=function(k,F,e){const r=[],q=2*Math.PI/e;for(let D=0;D<e;++D){var h=q*D;h=[k.x+Math.cos(-h)*F,k.y+Math.sin(-h)*F];this.hasZ&&h.push(k.z);r.push(h)}r.push(r[0]);return new E({spatialReference:k.spatialReference,
rings:[r]})};t._convert2Meters=function(k,F){if(F.wkid&&null!=H[F.wkid])F=H.values[H[F.wkid]];else{F=F.wkt;const e=F.lastIndexOf(",")+1,r=F.lastIndexOf("]]");F=parseFloat(F.substring(e,r))}return k*F};return a._createClass(l)}(E);n.__decorate([z.property({type:u})],p.prototype,"center",void 0);n.__decorate([z.property()],p.prototype,"geodesic",void 0);n.__decorate([z.property()],p.prototype,"numberOfPoints",void 0);n.__decorate([z.property()],p.prototype,"radius",void 0);n.__decorate([z.property()],
p.prototype,"radiusUnit",void 0);return p=C=n.__decorate([B.subclass("esri.geometry.Circle")],p)})},"esri/geometry/support/geodesicUtils":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../geometry ../../core/Error ../../core/unitUtils ./geodesicConstants ./spatialReferenceUtils ../Polyline ../Polygon ../Point ../SpatialReference".split(" "),function(a,n,b,z,p,w,A,B,d,u,E){function y(e){if(!e)return null;if(A.isGeographic(e)&&e.wkid){var r=w.spheroids[e.wkid];if(r)return r}return e.wkt&&
((e=w.WKT_SPHEROID_REGEX.exec(e.wkt))&&2===e.length?(r=e[1].split(","),!r||3>r.length?e=null:(e=parseFloat(r[1]),r=parseFloat(r[2]),e=isNaN(e)||isNaN(r)?null:{a:e,f:0===r?0:1/r})):e=null,e)?e:null}function v(e){e=y(e??E.WGS84);if(null!=e&&"b"in e&&"eSq"in e&&"radius"in e)return e;const r=e.a*(1-e.f);return Object.assign(e,{b:r,eSq:1-(r/e.a)**2,radius:(2*e.a+r)/3,densificationRatio:1E4/((2*e.a+r)/3)})}function H(e){return null!=e&&0>e?e+360:e}function C(e,r,q){const {a:h,eSq:D}=v(q);q=Math.sqrt(D);
const m=Math.sin(r[1]*w.toRadians);r=h*r[0]*w.toRadians;q=0<D?h*(1-D)*(m/(1-D*m*m)-1/(2*q)*Math.log((1-q*m)/(1+q*m)))*.5:h*m;e[0]=r;e[1]=q;return e}function f(e){return null!==y(e)}function l(e,r){if("polyline"!==e.type&&"polygon"!==e.type)throw new z("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");const {spatialReference:q}=e;if(!f(q))throw new z("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");var h="polyline"===
e.type?e.paths:e.rings;const D=[],m=[0,0],c=new F;for(const K of h){h=[];D.push(h);h.push([K[0][0],K[0][1]]);var g=K[0][0],G=K[0][1];let L,O;for(let U=0;U<K.length-1;U++){L=K[U+1][0];O=K[U+1][1];if(g===L&&G===O)continue;const R=[g,G];k(c,[g,G],[L,O],q);const {azimuth:V,distance:X}=c;g=X/r;if(1<g){for(G=1;G<=g-1;G++)t(m,R,V,G*r,q),h.push(m.slice(0));t(m,R,V,(X+Math.floor(g-1)*r)/2,q);h.push(m.slice(0))}t(m,R,V,X,q);h.push(m.slice(0));g=m[0];G=m[1]}}return"polyline"===e.type?new B({paths:D,spatialReference:q}):
new d({rings:D,spatialReference:q})}function t(e,r,q,h,D){const m=r[0]*w.toRadians;r=r[1]*w.toRadians;q=(q??0)*w.toRadians;const {a:c,b:g,f:G}=v(D);D=Math.sin(q);q=Math.cos(q);var K=(1-G)*Math.tan(r);r=1/Math.sqrt(1+K*K);const L=K*r,O=Math.atan2(K,q);K=r*D;const U=K*K;var R=1-U,V=R*(c*c-g*g)/(g*g);const X=1+V/16384*(4096+V*(-768+V*(320-175*V))),Q=V/1024*(256+V*(-128+V*(74-47*V)));V=h/(g*X);let I=2*Math.PI,J,S,aa,fa;for(;1E-12<Math.abs(V-I);)aa=Math.cos(2*O+V),J=Math.sin(V),S=Math.cos(V),fa=Q*J*(aa+
Q/4*(S*(-1+2*aa*aa)-Q/6*aa*(-3+4*J*J)*(-3+4*aa*aa))),I=V,V=h/(g*X)+fa;h=L*J-r*S*q;R=G/16*R*(4+G*(4-3*R));h=Math.atan2(L*S+r*J*q,(1-G)*Math.sqrt(U+h*h))/w.toRadians;e[0]=(m+(Math.atan2(J*D,r*S-L*J*q)-(1-R)*G*K*(V+R*J*(aa+R*S*(-1+2*aa*aa)))))/w.toRadians;e[1]=h;return e}function k(e,r,q,h){var D=r[0]*w.toRadians;r=r[1]*w.toRadians;var m=q[0]*w.toRadians;q=q[1]*w.toRadians;const {a:c,b:g,f:G,radius:K}=v(h),L=m-D;var O=Math.atan((1-G)*Math.tan(r)),U=Math.atan((1-G)*Math.tan(q));h=Math.sin(O);O=Math.cos(O);
const R=Math.sin(U);U=Math.cos(U);let V=1E3,X=L,Q,I,J;let S,aa,fa;do{var ea=Math.sin(X);var ka=Math.cos(X);J=Math.sqrt(U*ea*U*ea+(O*R-h*U*ka)*(O*R-h*U*ka));if(0===J)return e.distance=0,e.azimuth=void 0,e.reverseAzimuth=void 0,e;ka=h*R+O*U*ka;S=Math.atan2(J,ka);aa=O*U*ea/J;I=1-aa*aa;ea=ka-2*h*R/I;isNaN(ea)&&(ea=0);fa=G/16*I*(4+G*(4-3*I));Q=X;X=L+(1-fa)*G*aa*(S+fa*J*(ea+fa*ka*(-1+2*ea*ea)))}while(1E-12<Math.abs(X-Q)&&0<--V);if(0===V)return h=Math.acos(Math.sin(r)*Math.sin(q)+Math.cos(r)*Math.cos(q)*
Math.cos(m-D))*K,D=m-D,e.azimuth=Math.atan2(Math.sin(D)*Math.cos(q),Math.cos(r)*Math.sin(q)-Math.sin(r)*Math.cos(q)*Math.cos(D))/w.toRadians,e.distance=h,e.reverseAzimuth=void 0,e;D=I*(c*c-g*g)/(g*g);r=D/1024*(256+D*(-128+D*(74-47*D)));m=Math.atan2(O*Math.sin(X),O*R*Math.cos(X)-h*U);e.azimuth=Math.atan2(U*Math.sin(X),O*R-h*U*Math.cos(X))/w.toRadians;e.distance=g*(1+D/16384*(4096+D*(-768+D*(320-175*D))))*(S-r*J*(ea+r/4*(ka*(-1+2*ea*ea)-r/6*ea*(-3+4*J*J)*(-3+4*ea*ea))));e.reverseAzimuth=m/w.toRadians;
return e}let F=n._createClass(function(e=0,r,q){this.distance=e;this.azimuth=r;this.reverseAzimuth=q});a.InverseGeodeticSolverResult=F;a.directGeodeticSolver=t;a.geodesicAreas=function(e,r="square-meters"){if(e.some(m=>!f(m.spatialReference)))throw new z("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");const q=[];for(var h=0;h<e.length;h++){var D=e[h];const {radius:m,densificationRatio:c}=v(D.spatialReference);q.push(l(D,m*c))}e=[];h=[0,0];D=[0,
0];for(let m=0;m<q.length;m++){const {rings:c,spatialReference:g}=q[m];let G=0;for(let K=0;K<c.length;K++){const L=c[K];C(h,L[0],g);C(D,L[L.length-1],g);let O=D[0]*h[1]-h[0]*D[1];for(let U=0;U<L.length-1;U++)C(h,L[U+1],g),C(D,L[U],g),O+=D[0]*h[1]-h[0]*D[1];G+=O}G=p.convertUnit(G,"square-meters",r);e.push(G/-2)}return e};a.geodesicDensify=l;a.geodesicDistance=function(e,r,q="meters"){if(!e||!r)throw new z("geodesic-distance:missing-parameters","one or both input parameters are missing");if(!e.spatialReference||
!r.spatialReference)throw new z("geodesic-distance:invalid-parameters","one or both input points do not have a spatial reference");if(!A.equals(e.spatialReference,r.spatialReference))throw new z("geodesic-distance:invalid-parameters","spatial references of input parameters do not match");const {spatialReference:h}=e;if(!f(h))throw new z("geodesic-distance:not-supported","input geometry spatial reference is not supported");if(e.x===r.x&&e.y===r.y)return new F(0,0,0);const D=new F;k(D,[e.x,e.y],[r.x,
r.y],h);D.distance=p.convertUnit(D.distance,"meters",q);D.azimuth=H(D.azimuth);D.reverseAzimuth=H(D.reverseAzimuth);return D};a.geodesicLengths=function(e,r="meters"){if(!e)throw new z("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(e.some(D=>!f(D.spatialReference)))throw new z("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");const q=[];for(let D=0;D<e.length;D++){var h=e[D];const {spatialReference:m}=h;
h="polyline"===h.type?h.paths:h.rings;let c=0;for(let g=0;g<h.length;g++){const G=h[g];let K=0;for(let L=1;L<G.length;L++){const O=G[L-1][0],U=G[L][0],R=G[L-1][1],V=G[L][1];if(R!==V||O!==U){const X=new F;k(X,[O,R],[U,V],m);K+=X.distance}}c+=K}c=p.convertUnit(c,"meters",r);q.push(c)}return q};a.inverseGeodeticSolver=k;a.isSupported=f;a.pointFromDistance=function(e,r,q){if(!e||null==r||null==q)throw new z("point-from-distance:missing-parameters","one or more input parameters are missing or undefined");
if(0>q||360<q)throw new z("point-from-distance:-of-bounds","azimuth is restricted to angles between, and including, 0\u00b0 to 360\u00b0 degrees");if(!e.spatialReference)throw new z("point-from-distance:missing-spatial-reference","the input point must have a spatial reference");const {spatialReference:h}=e;if(!f(h))throw new z("geodesic-distance:not-supported","input geometry spatial reference is not supported");const D=[0,0];t(D,[e.x,e.y],q,r,h);return new u({x:D[0],y:D[1],spatialReference:h})};
Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/transformGraphic/isSupportedGraphic":function(){define(["exports","../../../../../core/has","../../../../../support/elevationInfoUtils","../isSupportedGraphicUtils"],function(a,n,b,z){a.isSupportedGraphic=function(p){if("graphics"!==p.layer?.type)return z.SupportedGraphicResult.GRAPHICS_LAYER_MISSING;if(null==p.geometry)return z.SupportedGraphicResult.GEOMETRY_MISSING;switch(p.geometry.type){case "point":break;
case "polygon":case "polyline":case "multipoint":case "extent":case "mesh":return z.SupportedGraphicResult.SUPPORTED;default:return z.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED}const w=null!=p.symbol&&"point-3d"===p.symbol.type&&p.symbol.symbolLayers;return w&&0<w.length&&w.some(A=>"object"===A.type)?"on-the-ground"!==b.getGraphicEffectiveElevationMode(p)&&b.hasGraphicFeatureExpressionInfo(p)?z.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED:z.SupportedGraphicResult.SUPPORTED:z.SupportedGraphicResult.SYMBOL_TYPE_UNSUPPORTED};
Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/draw/support/layerUtils":function(){define(["exports"],function(a){a.addUniqueLayer=function(n,b,z){if(b&&n&&n.map){({map:n}=n);var p=n.layers.find(w=>w===b);p||n.add(b,z);p&&void 0!==z&&null!==z&&n.layers.reorder(p,z)}};a.findLayerView=function(n,b){return n.allLayerViews.find(z=>{z=z.layer;return z===b||"sublayers"in z&&null!=z.sublayers&&z.sublayers.includes(b)})};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/views/interactive/keybindings":function(){define(["exports"],function(a){a.SKETCH_KEYS={redo:"r",undo:"z",center:"Alt",constraint:"Shift",cancel:"Escape",delete:["Backspace","Delete"],complete:"Enter",vertexAdd:"f",pan:" "};a.SNAPPING_KEYS={toggle:"Control"};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/sketch/SketchLabelOptions":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,n,b,z,p,w,A,B){b=function(d){function u(E){E=d.call(this,E)||this;E.enabled=!1;return E}a._inherits(u,d);return a._createClass(u)}(b);n.__decorate([z.property({type:Boolean,nonNullable:!0})],b.prototype,"enabled",void 0);return b=n.__decorate([B.subclass("esri.views.interactive.sketch.SketchLabelOptions")],b)})},"esri/views/interactive/sketch/SketchTooltipOptions":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./SketchTooltipElevationOptions ./SketchTooltipVisibleElements".split(" "),
function(a,n,b,z,p,w,A,B,d,u){b=function(E){function y(v){v=E.call(this,v)||this;v.enabled=!1;v.elevation=new d.SketchTooltipElevationOptions;v.visibleElements=new u.SketchTooltipVisibleElements;v.visualVariables=null;return v}a._inherits(y,E);y.prototype.toJSON=function(){return{enabled:this.enabled,elevation:this.elevation,visibleElements:this.visibleElements}};return a._createClass(y)}(b);n.__decorate([z.property({type:Boolean,nonNullable:!0})],b.prototype,"enabled",void 0);n.__decorate([z.property({type:d.SketchTooltipElevationOptions,
nonNullable:!0})],b.prototype,"elevation",void 0);n.__decorate([z.property({type:u.SketchTooltipVisibleElements,nonNullable:!0})],b.prototype,"visibleElements",void 0);n.__decorate([z.property()],b.prototype,"visualVariables",void 0);return b=n.__decorate([B.subclass("esri.widgets.Sketch.SketchTooltipOptions")],b)})},"esri/views/interactive/sketch/SketchTooltipElevationOptions":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,n,b,z,p,w,A,B,d){a.SketchTooltipElevationOptions=function(u){function E(y){y=u.call(this,y)||this;y.mode="absolute-height";return y}n._inherits(E,u);E.prototype.toJSON=function(){return{mode:this.mode}};return n._createClass(E)}(z);b.__decorate([p.property({type:String,nonNullable:!0})],a.SketchTooltipElevationOptions.prototype,"mode",void 0);a.SketchTooltipElevationOptions=b.__decorate([d.subclass("esri.widgets.Sketch.SketchTooltipOptions.ElevationOptions")],a.SketchTooltipElevationOptions);
Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/sketch/SketchTooltipVisibleElements":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),function(a,n,b,z,p,w,A,B,d){a.SketchTooltipVisibleElements=function(u){function E(){var y=
u.apply(this,arguments)||this;y.distance=!0;y.elevation=!0;y.size=!0;y.scale=!0;y.rotation=!0;y.orientation=!0;y.totalLength=!0;y.area=!0;y.radius=!0;y.helpMessage=!1;return y}n._inherits(E,u);E.prototype.toJSON=function(){return{distance:this.distance,size:this.size,scale:this.scale,rotation:this.rotation,orientation:this.orientation,totalLength:this.totalLength,area:this.area,radius:this.radius}};return n._createClass(E)}(z);b.__decorate([p.property({type:Boolean,nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,
"distance",void 0);b.__decorate([p.property({type:Boolean,nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,"elevation",void 0);b.__decorate([p.property({type:Boolean,nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,"size",void 0);b.__decorate([p.property({type:Boolean,nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,"scale",void 0);b.__decorate([p.property({type:Boolean,nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,"rotation",void 0);b.__decorate([p.property({type:Boolean,
nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,"orientation",void 0);b.__decorate([p.property({type:Boolean,nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,"totalLength",void 0);b.__decorate([p.property({type:Boolean,nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,"area",void 0);b.__decorate([p.property({type:Boolean,nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,"radius",void 0);b.__decorate([p.property({type:Boolean,nonNullable:!0})],a.SketchTooltipVisibleElements.prototype,
"helpMessage",void 0);a.SketchTooltipVisibleElements=b.__decorate([d.subclass("esri.widgets.Sketch.SketchTooltipOptions.VisibleElements")],a.SketchTooltipVisibleElements);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingManager":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Evented ../../../core/HandleOwner ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../geometry/projection ../../../support/elevationInfoUtils ./Settings ./SnappingDomain ./snappingFactory ./SnappingOptions ./SnappingPoint ./snappingUtils ./candidates/IntersectionSnappingCandidate ../support/viewUtils".split(" "),
function(a,n,b,z,p,w,A,B,d,u,E,y,v,H,C,f,l,t,k,F,e,r){function q({coordinateHelper:D,elevationInfo:m}){return D.hasZ()?H.absoluteHeightElevationInfo:m}a.SnappingManager=function(D){function m(g){g=D.call(this,g)||this;g.options=new t;g.snappingEnginesFactory=l.defaultSnappingEnginesFactory;g._engines=[];g._currentMainCandidate=null;g._currentOtherActiveCandidates=[];g._currentSnappedType=h.MAIN;return g}n._inherits(m,D);var c=m.prototype;c.initialize=function(){this.handles.add([A.watch(()=>{const {effectiveFeatureEnabled:g,
effectiveSelfEnabled:G,touchSensitivityMultiplier:K,distance:L}=this.options;return{effectiveFeatureEnabled:g,effectiveSelfEnabled:G,touchSensitivityMultiplier:K,distance:L}},()=>{this.doneSnapping();this.emit("changed")},A.sync),A.watch(()=>this.options,g=>{for(const G of this._engines)G.options=g},A.sync),A.watch(()=>({viewReady:this.view.ready,viewSpatialReference:this.view.spatialReference,snappingEnginesFactory:this.snappingEnginesFactory}),({viewReady:g,snappingEnginesFactory:G})=>this._recreateEngines(g,
G),A.syncAndInitial)])};c.destroy=function(){this._destroyEngines()};c._recreateEngines=function(g,G){this._destroyEngines();if(g){var {view:K,options:L}=this;this._engines=G(K,L)}};c._destroyEngines=function(){for(const g of this._engines)g.destroy();this._engines=[]};c.snap=async function(g){return null!=g.scenePoint?this._snapMultiPoint(g):this._snapSinglePoint(g)};c.update=function(g){const {point:G,context:K}=g;this._removeVisualization();const L=this._currentMainCandidate;if(null==L)return G;
var O=this._selectUpdateInput(g);if(null==O)return G;({spatialReference:g}=K);var U=v.project(O,g);if(null==U)return G;({view:O}=this);const {elevationInfo:R,visualizer:V}=K,X=[];U=k.pointToSnappingPoint(U,O,K);const Q=L.constraint.closestTo(U);if(!this._arePointsWithinScreenThreshold(U,Q,K))return this._resetSnappingState(),G;L.targetPoint=Q;X.push(...L.hints);for(const I of this._currentOtherActiveCandidates)I.targetPoint=Q,X.push(...I.hints);null!=V&&this.handles.add(V.draw(X,{spatialReference:g,
elevationInfo:q(K),view:O,selfSnappingZ:K.selfSnappingZ}),"visualization-handle");return k.snappingPointToSnappingOutput(Q,O,{z:G.z,m:G.m,spatialReference:G.spatialReference,elevationInfo:R})};c.doneSnapping=function(){this._removeVisualization();this._resetSnappingState()};c._selectUpdateInput=function({point:g,scenePoint:G}){switch(this._currentSnappedType){case h.MAIN:return g;case h.SCENE:return G}};c._resetSnappingState=function(){this._currentMainCandidate=null;this._currentOtherActiveCandidates=
[];this._currentSnappedType=h.MAIN};c._removeVisualization=function(){this.handles.remove("visualization-handle")};c._snapSinglePoint=async function({point:g,context:G,signal:K}){const {view:L}=this,O=k.pointToSnappingPoint(g,L,G),U=await this._fetchCandidates(O,f.SnappingDomain.ALL,G,K);return this._createSnapResult(O,h.MAIN,U,L,G,{z:g.z,m:g.m,spatialReference:g.spatialReference,elevationInfo:G.elevationInfo},K)};c._snapMultiPoint=async function({point:g,scenePoint:G,context:K,signal:L}){const {view:O}=
this,{coordinateHelper:U,spatialReference:R}=K;await v.initializeProjection(G.spatialReference,R);G=v.project(G,R);var V=k.pointToSnappingPoint(G,O,K);const X=await this._fetchCandidates(V,f.SnappingDomain.FEATURE,K,L);if(0<X.length)return g=await this._fetchCandidates(V,f.SnappingDomain.SELF,K,L),this._createSnapResult(V,h.SCENE,[...X,...g],O,K,{z:G.z,m:G.m,spatialReference:G.spatialReference,elevationInfo:K.elevationInfo},L);G=k.pointToSnappingPoint(g,O,K);V=await this._fetchCandidates(G,f.SnappingDomain.SELF,
K,L);return this._createSnapResult(G,h.MAIN,V,O,K,{z:U.hasZ()&&g.hasZ?g.z??0:void 0,m:U.hasM()&&g.hasM?g.m??0:void 0,spatialReference:g.spatialReference,elevationInfo:K.elevationInfo},L)};c._fetchCandidates=async function(g,G,K,L){return(await Promise.all(this._engines.map(O=>O.fetchCandidates(g,G,K,L)))).flat()};c._createSnapResult=function(g,G,K,L,O,U,R){return{get valid(){return!w.isAborted(R)},apply:()=>{const {spatialReference:V}=O,{snappedPoint:X,hints:Q}=this._processCandidates(g,G,K,O);this._removeVisualization();
null!=O.visualizer&&this.handles.add(O.visualizer.draw(Q,{spatialReference:V,elevationInfo:H.absoluteHeightElevationInfo,view:L,selfSnappingZ:O.selfSnappingZ}),"visualization-handle");return k.snappingPointToSnappingOutput(X,L,U)}}};c._processCandidates=function(g,G,K,L){if(1>K.length)return this.doneSnapping(),{snappedPoint:g,hints:[]};this._currentSnappedType!==G&&this._resetSnappingState();F.sortCandidatesInPlace(g,K);const O=this._currentMainCandidate;if(null!=O){const U=this._findOldConstraintInNewCandidates(O,
K);if(0<=U)if(K[U]instanceof e.IntersectionSnappingCandidate){if(this._arePointsWithinScreenThreshold(g,O.targetPoint,L))return this._updateSnappingCandidate(O,G,K,L)}else return this._intersectWithOtherCandidates(U,K,g,G,L)}return this._intersectWithOtherCandidates(0,K,g,G,L)};c._findOldConstraintInNewCandidates=function(g,G){return g instanceof e.IntersectionSnappingCandidate?0<=this._findOldCandidateIndex(G,g.first)&&0<=this._findOldCandidateIndex(G,g.second)?0:-1:this._findOldCandidateIndex(G,
g)};c._intersectWithOtherCandidates=function(g,G,K,L,O){const {coordinateHelper:U}=O,R=G[g],V=[];for(let X=0;X<G.length;++X){if(X===g)continue;const Q=G[X];for(const I of R.constraint.intersect(Q.constraint)){const J=I.closestTo(R.targetPoint);V.push([new e.IntersectionSnappingCandidate(J,R,Q,Q.isDraped),this._squaredScreenDistance(K,J,U)])}}return 0<V.length&&(V.sort((X,Q)=>X[1]-Q[1]),V[0][1]<this._squaredPointProximityThreshold(O.pointer))?this._updateSnappingCandidate(V[0][0],L,G,O):this._updateSnappingCandidate(R,
L,G,O)};c._updateSnappingCandidate=function(g,G,K,L){this.doneSnapping();this._currentMainCandidate=g;this._currentSnappedType=G;G=this._currentMainCandidate.targetPoint;const O=[];O.push(...g.hints);for(const U of K){if(g instanceof e.IntersectionSnappingCandidate){if(U.constraint.equals(g.first.constraint)||U.constraint.equals(g.second.constraint))continue}else if(U.constraint.equals(g.constraint))continue;K=U.constraint.closestTo(G);this._squaredScreenDistance(K,G,L.coordinateHelper)<this._squaredSatisfiesConstraintThreshold&&
(U.targetPoint=G,this._currentOtherActiveCandidates.push(U),O.push(...U.hints))}return{snappedPoint:G,hints:O}};c._squaredPointProximityThreshold=function(g){return"touch"===g?this._squaredTouchProximityThreshold:this._squaredMouseProximityTreshold};c._arePointsWithinScreenThreshold=function(g,G,K){return this._squaredScreenDistance(g,G,K.coordinateHelper)<this._squaredPointProximityThreshold(K.pointer)};c._squaredScreenDistance=function(g,G,K){return F.squaredScreenDistance(this._toScreen(g,K),this._toScreen(G,
K))};c._toScreen=function(g,G){return r.vectorToScreenPoint(g,G.spatialReference,H.absoluteHeightElevationInfo,this.view)};c._findOldCandidateIndex=function(g,G){let K=-1;for(let L=0;L<g.length;++L)if(G.constraint.equals(g[L].constraint)){K=L;break}return K};n._createClass(m,[{key:"updating",get:function(){return this._engines.some(g=>g.updating)}},{key:"_squaredMouseProximityTreshold",get:function(){return this.options.distance*this.options.distance}},{key:"_squaredTouchProximityThreshold",get:function(){const {distance:g,
touchSensitivityMultiplier:G}=this.options,K=g*G;return K*K}},{key:"_squaredSatisfiesConstraintThreshold",get:function(){return C.defaults.satisfiesConstraintScreenThreshold*C.defaults.satisfiesConstraintScreenThreshold}},{key:"test",get:function(){return{visualizationsActive:this.handles.has("visualization-handle"),engines:this._engines}}}]);return m}(z.EventedMixin(p.HandleOwner));b.__decorate([B.property({constructOnly:!0})],a.SnappingManager.prototype,"view",void 0);b.__decorate([B.property()],
a.SnappingManager.prototype,"options",void 0);b.__decorate([B.property({readOnly:!0})],a.SnappingManager.prototype,"updating",null);b.__decorate([B.property()],a.SnappingManager.prototype,"snappingEnginesFactory",void 0);b.__decorate([B.property()],a.SnappingManager.prototype,"_engines",void 0);b.__decorate([B.property()],a.SnappingManager.prototype,"_squaredMouseProximityTreshold",null);b.__decorate([B.property()],a.SnappingManager.prototype,"_squaredTouchProximityThreshold",null);b.__decorate([B.property()],
a.SnappingManager.prototype,"_squaredSatisfiesConstraintThreshold",null);a.SnappingManager=b.__decorate([y.subclass("esri.views.interactive.snapping.SnappingManager")],a.SnappingManager);var h;(function(D){D[D.MAIN=0]="MAIN";D[D.SCENE=1]="SCENE"})(h||(h={}));Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/Settings":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Color ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,n,b,z,p,w,A){let B=function(d){function u(){var E=d.apply(this,arguments)||this;E.enabled=!0;return E}n._inherits(u,d);return n._createClass(u)}(p.JSONSupport);b.__decorate([w.property({type:Boolean})],B.prototype,"enabled",void 0);B=b.__decorate([A.subclass("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],B);p=function(d){function u(E){E=d.call(this,E)||this;E.lineSnapper=new B;E.parallelLineSnapper=new B;E.rightAngleSnapper=new B;E.rightAngleTriangleSnapper=new B;
E.shortLineThreshold=15;E.distance=5;E.pointThreshold=1E-6;E.intersectionParallelLineThreshold=1E-6;E.parallelLineThreshold=1E-6;E.verticalLineThreshold=.1;E.touchSensitivityMultiplier=1.5;E.pointOnLineThreshold=1E-6;E.orange=new z([255,127,0]);E.orangeTransparent=new z([255,127,0,.5]);E.lineHintWidthReference=3;E.lineHintWidthTarget=3;E.lineHintFadedExtensions=.3;E.parallelLineHintWidth=2;E.parallelLineHintLength=24;E.parallelLineHintOffset=1.5;E.rightAngleHintSize=24;E.rightAngleHintOutlineSize=
1.5;E.satisfiesConstraintScreenThreshold=1;return E}n._inherits(u,d);return n._createClass(u)}(p.JSONSupport);b.__decorate([w.property({type:B,constructOnly:!0,nonNullable:!0,json:{write:!0}})],p.prototype,"lineSnapper",void 0);b.__decorate([w.property({type:B,constructOnly:!0,nonNullable:!0,json:{write:!0}})],p.prototype,"parallelLineSnapper",void 0);b.__decorate([w.property({type:B,constructOnly:!0,nonNullable:!0,json:{write:!0}})],p.prototype,"rightAngleSnapper",void 0);b.__decorate([w.property({type:B,
constructOnly:!0,nonNullable:!0,json:{write:!0}})],p.prototype,"rightAngleTriangleSnapper",void 0);b.__decorate([w.property({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],p.prototype,"shortLineThreshold",void 0);b.__decorate([w.property({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],p.prototype,"distance",void 0);b.__decorate([w.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],p.prototype,"pointThreshold",void 0);
b.__decorate([w.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],p.prototype,"intersectionParallelLineThreshold",void 0);b.__decorate([w.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],p.prototype,"parallelLineThreshold",void 0);b.__decorate([w.property({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],p.prototype,"verticalLineThreshold",void 0);b.__decorate([w.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],
p.prototype,"touchSensitivityMultiplier",void 0);b.__decorate([w.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],p.prototype,"pointOnLineThreshold",void 0);b.__decorate([w.property({type:z,nonNullable:!0})],p.prototype,"orange",void 0);b.__decorate([w.property({type:z,nonNullable:!0})],p.prototype,"orangeTransparent",void 0);b.__decorate([w.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],p.prototype,"lineHintWidthReference",void 0);b.__decorate([w.property({type:Number,
nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],p.prototype,"lineHintWidthTarget",void 0);b.__decorate([w.property({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],p.prototype,"lineHintFadedExtensions",void 0);b.__decorate([w.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],p.prototype,"parallelLineHintWidth",void 0);b.__decorate([w.property({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],p.prototype,"parallelLineHintLength",
void 0);b.__decorate([w.property({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],p.prototype,"parallelLineHintOffset",void 0);b.__decorate([w.property({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],p.prototype,"rightAngleHintSize",void 0);b.__decorate([w.property({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],p.prototype,"rightAngleHintOutlineSize",void 0);b.__decorate([w.property({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],
p.prototype,"satisfiesConstraintScreenThreshold",void 0);p=b.__decorate([A.subclass("esri.views.interactive.snapping.Settings.Defaults")],p);b=new p;a.defaults=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingDomain":function(){define(["exports"],function(a){a.SnappingDomain=void 0;var n=a.SnappingDomain||(a.SnappingDomain={});n[n.FEATURE=1]="FEATURE";n[n.SELF=2]="SELF";n[n.ALL=3]="ALL";Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/views/interactive/snapping/snappingFactory":function(){define(["exports","./FeatureSnappingEngine","./SelfSnappingEngine"],function(a,n,b){a.defaultSnappingEnginesFactory=function(z,p){return[new b.SelfSnappingEngine({view:z,options:p}),new n.FeatureSnappingEngine({view:z,options:p,spatialReference:z.spatialReference})]};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/FeatureSnappingEngine":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/HandleOwner ../../../core/Handles ../../../core/MapUtils ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../chunks/vec2 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../chunks/common ../../../support/elevationInfoUtils ./SnappingConstraint ./SnappingDomain ./SnappingPoint ./snappingUtils ./candidates/DrapedEdgeSnappingCandidate ./candidates/EdgeSnappingCandidate ./candidates/FeatureSnappingCandidate ./candidates/RightAngleSnappingCandidate ../support/viewUtils".split(" "),
function(a,n,b,z,p,w,A,B,d,u,E,y,v,H,C,f,l,t,k,F,e,r,q,h,D,m,c,g){function G({constraint:{start:R,end:V}}){const X=f.squaredDistance(R,V);R=C.squaredDistance(R,V);return X<t.getEpsilon()||1E-4>R/X}function K(R,V,X,Q,I,J,{spatialReference:S}){V=f.copy(U,V);V[0]+=X;V[1]+=Q;V[2]+=I;return(X=g.vectorToScreenPoint(V,S,k.absoluteHeightElevationInfo,J))?q.screenDistance(X,R):Infinity}n.FeatureSnappingEngine=function(R){function V(Q){Q=R.call(this,Q)||this;Q.options=null;Q._domain=e.SnappingDomain.FEATURE;
Q._sourceModules={featureService:{module:null,loader:null},featureCollection:{module:null,loader:null},graphics:{module:null,loader:null},notes:{module:null,loader:null},scene:{module:null,loader:null}};return Q}b._inherits(V,R);var X=V.prototype;X.initialize=function(){this.updatingHandles.add(()=>this.snappingSources,()=>this.notifyChange("updating"),d.sync);null!=this.view&&this.handles.add([this.view.on("layerview-create",Q=>this._updateLayerView(Q.layer,Q.layerView)),this.view.on("layerview-destroy",
Q=>this._updateLayerView(Q.layer,null))])};X._updateLayerView=function(Q,I){for(const [,J]of this.snappingSources)J.snappingSource.layerSource.layer===Q&&(J.layerView=I)};X.destroy=function(){this._set("options",null);for(const [,Q]of this.snappingSources)Q.destroy()};X.fetchCandidates=async function(Q,I,J,S){if(!(I&this._domain&&null!=this.options&&this.options.effectiveFeatureEnabled))return[];var aa=[];I=this._computeScreenSizeDistanceParameters(Q,J);const fa={distance:I,mode:this.view?.type??
"2d",point:Q,coordinateHelper:J.coordinateHelper,...this._types};for(const [,{snappingSource:ea,layerView:ka}]of this.snappingSources)!ea.layerSource.enabled||null!=ka&&ka.suspended||aa.push(ea.fetchCandidates(fa,S).then(na=>na.filter(qa=>!this._candidateIsExcluded(ea,qa,J.excludeFeature))));aa=(await B.eachAlwaysValues(aa)).flat();this._addRightAngleCandidates(aa,Q,I,J);B.throwIfAborted(S);q.sortCandidatesInPlace(Q,aa);return aa};X._addRightAngleCandidates=function(Q,I,J,S){var aa=null!=S.vertexHandle?
S.vertexHandle.rightEdge?.rightVertex?.pos:null!=S.editGeometryOperations&&"polygon"===S.editGeometryOperations.data.type?S.editGeometryOperations.data.components[0]?.getFirstVertex()?.pos:null,fa=null!=S.vertexHandle?S.vertexHandle.leftEdge?.leftVertex?.pos:null!=S.editGeometryOperations?S.editGeometryOperations.data.components[0]?.getLastVertex()?.pos:null,{view:ea}=this;aa=r.anyMapPointToSnappingPoint(aa,ea,S);S=r.anyMapPointToSnappingPoint(fa,ea,S);fa=Q.length;for(ea=0;ea<fa;ea++)this._addRightAngleCandidate(Q[ea],
S,I,J,Q),this._addRightAngleCandidate(Q[ea],aa,I,J,Q)};X._addRightAngleCandidate=function(Q,I,J,S,aa){var fa;(fa=null==I)||(fa=!((Q instanceof D.EdgeSnappingCandidate||Q instanceof h.DrapedEdgeSnappingCandidate)&&!G(Q)));if(!fa){fa=Q.constraint.closestTo(I);var ea=(fa[0]-J[0])/S.x;J=(fa[1]-J[1])/S.y;var {start:ka,end:na}=Q.constraint;1>=ea*ea+J*J&&(Q=new c.RightAngleSnappingCandidate({targetPoint:fa,otherVertex:I,otherVertexType:c.OtherVertexType.NEXT,previousVertex:C.squaredDistance(fa,ka)>C.squaredDistance(fa,
na)?ka:na,constraint:new F.VerticalHalfPlaneConstraint(I,fa),objectId:Q.objectId,isDraped:Q.isDraped}),aa.push(Q))}};X._computeScreenSizeDistanceParameters=function(Q,I){let J=null!=this.options?this.options.distance*("touch"===I.pointer?this.options.touchSensitivityMultiplier:1):0;return null==this.view?{x:J,y:J,z:J,distance:J}:"2d"===this.view.type?(J*=this.view.resolution,{x:J,y:J,z:J,distance:J}):this._computeScreenSizeDistanceParameters3D(Q,J,this.view,I)};X._computeScreenSizeDistanceParameters3D=
function(Q,I,J,S){var {spatialReference:aa}=S;J.renderCoordsHelper.toRenderCoords(Q,aa,O);const fa=J.state.camera.computeScreenPixelSizeAt(O),ea=fa*J.renderCoordsHelper.unitInMeters/J.mapCoordsHelper.unitInMeters,ka=I*ea,na=g.vectorToScreenPoint(Q,aa,k.absoluteHeightElevationInfo,J);aa=na?K(na,Q,ea,0,0,J,S):0;const qa=na?K(na,Q,0,ea,0,J,S):0;Q=na?K(na,Q,0,0,ea,J,S):0;return{x:0===aa?0:ka/aa,y:0===qa?0:ka/qa,z:0===Q?0:ka/Q,distance:fa*I}};X._candidateIsExcluded=function(Q,I,J){if(null==J)return!1;
I=this._getCandidateObjectId(I);if(null==I)return!1;Q=Q.layerSource.layer;return"graphics"===Q.type?J.uid===I:J.sourceLayer===Q&&J.attributes&&"objectIdField"in Q?J.attributes[Q.objectIdField]===I:!1};X._getCandidateObjectId=function(Q){return Q instanceof m.FeatureSnappingCandidate?Q.objectId:null};X._createSourceInfo=function(Q){const I=this._createFeatureSnappingSourceType(Q);if(null==I)return null;if("loading"in I)return this.updatingHandles.addPromise(I.loading.then(()=>{this.destroyed||this.notifyChange("snappingSources")})),
null;const J=null!=this.view?this.view.allLayerViews.find(S=>S.layer===Q.layer):null;return new L(I.source,J)};X._createFeatureSnappingSourceType=function(Q){switch(Q.layer.type){case "feature":case "geojson":case "csv":case "oriented-imagery":case "subtype-group":case "wfs":return this._createFeatureSnappingSourceFeatureLayer(Q);case "graphics":return this._createFeatureSnappingSourceGraphicsLayer(Q);case "map-notes":return this._createFeatureSnappingSourceMapNotesLayer(Q);case "scene":case "building-scene":return this._createFeatureSnappingSourceSceneLayer(Q)}return null};
X._createFeatureSnappingSourceSceneLayer=function(Q){const {view:I}=this;if(null==I||"3d"!==I.type)return null;const J=this._getSourceModule("scene");return null!=J.module?{source:new J.module.SceneLayerSnappingSource({layerSource:Q,view:I})}:{loading:J.loader}};X._createFeatureSnappingSourceFeatureLayer=function(Q){switch(Q.layer.source?.type){case "feature-layer":case "oriented-imagery":var I=this._getSourceModule("featureService");return null!=I.module?{source:new I.module.FeatureServiceSnappingSource({spatialReference:this.spatialReference,
view:this.view,layerSource:Q})}:{loading:I.loader};case "memory":case "csv":case "geojson":case "wfs":if("mesh"!==Q.layer.geometryType)return I=this._getSourceModule("featureCollection"),null!=I.module?{source:new I.module.FeatureCollectionSnappingSource({layerSource:Q,view:this.view})}:{loading:I.loader}}return null};X._createFeatureSnappingSourceGraphicsLayer=function(Q){const I=this._getSourceModule("graphics");return null!=I.module?{source:new I.module.GraphicsSnappingSource({getGraphicsLayers:()=>
[Q.layer],spatialReference:this.spatialReference,view:this.view,layerSource:Q})}:{loading:I.loader}};X._createFeatureSnappingSourceMapNotesLayer=function(Q){const I=this._getSourceModule("notes");return null!=I.module?{source:new I.module.GraphicsSnappingSource({getGraphicsLayers:()=>null!=Q.layer.sublayers?Q.layer.sublayers.toArray():[],spatialReference:this.spatialReference,view:this.view,layerSource:Q})}:{loading:I.loader}};X._getSourceModule=function(Q){const I=this._sourceModules[Q];return null==
I.loader?(Q=this._loadSourceModule(Q).then(J=>{I.module=J}),I.loader=Q,{module:I.module,loader:Q}):{module:I.module,loader:I.loader}};X._loadSourceModule=function(Q){const I=this.updatingHandles;switch(Q){case "featureService":return I.addPromise(new Promise((J,S)=>a(["./featureSources/FeatureServiceSnappingSource"],J,S)));case "featureCollection":return I.addPromise(new Promise((J,S)=>a(["./featureSources/FeatureCollectionSnappingSource"],J,S)));case "graphics":return I.addPromise(new Promise((J,
S)=>a(["./featureSources/GraphicsSnappingSource"],J,S)));case "notes":return I.addPromise(new Promise((J,S)=>a(["./featureSources/GraphicsSnappingSource"],J,S)));case "scene":return I.addPromise(new Promise((J,S)=>a(["./featureSources/SceneLayerSnappingSource"],J,S)))}};b._createClass(V,[{key:"updating",get:function(){return A.someMap(this.snappingSources,({snappingSource:Q})=>Q.updating)||this.updatingHandles.updating}},{key:"snappingSources",get:function(){const Q=this._get("snappingSources")||
new Map,I=new Map;if(null!=this.options&&null!=this.options.featureSources)for(const S of this.options.featureSources.items){const aa=S.layer.uid;var J=Q.get(aa);J?(Q.delete(aa),I.set(aa,J)):S.layer.loaded?(J=this._createSourceInfo(S),null!=J&&I.set(aa,J)):this.updatingHandles.addPromise(S.layer.load())}for(const [,S]of Q)S.destroy();return I}},{key:"_types",get:function(){return{returnEdge:!0,returnVertex:!0}}}]);return V}(p.HandleOwner);z.__decorate([u.property({constructOnly:!0})],n.FeatureSnappingEngine.prototype,
"spatialReference",void 0);z.__decorate([u.property({constructOnly:!0})],n.FeatureSnappingEngine.prototype,"view",void 0);z.__decorate([u.property()],n.FeatureSnappingEngine.prototype,"options",void 0);z.__decorate([u.property({readOnly:!0})],n.FeatureSnappingEngine.prototype,"updating",null);z.__decorate([u.property({readOnly:!0})],n.FeatureSnappingEngine.prototype,"snappingSources",null);n.FeatureSnappingEngine=z.__decorate([H.subclass("esri.views.interactive.snapping.FeatureSnappingEngine")],n.FeatureSnappingEngine);
let L=function(){function R(V,X){this.snappingSource=V;this.layerView=X;this.handles=new w;X=this.snappingSource.layerSource.layer;"refresh"in X&&this.handles.add(X.on("refresh",()=>V.refresh()));this.handles.add([d.watch(()=>V.updating,Q=>V.layerSource.updating=Q,d.syncAndInitial),d.watch(()=>V.availability,Q=>V.layerSource.availability=Q,d.syncAndInitial)])}R.prototype.destroy=function(){this.snappingSource.destroy();this.handles.destroy()};return b._createClass(R)}();const O=l.create(),U=l.create();
Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/vec2":function(){define(["exports","./common"],function(a,n){function b(I,J){I[0]=J[0];I[1]=J[1];return I}function z(I,J,S){I[0]=J;I[1]=S;return I}function p(I,J,S){I[0]=J[0]+S[0];I[1]=J[1]+S[1];return I}function w(I,J,S){I[0]=J[0]-S[0];I[1]=J[1]-S[1];return I}function A(I,J,S){I[0]=J[0]*S[0];I[1]=J[1]*S[1];return I}function B(I,J,S){I[0]=J[0]/S[0];I[1]=J[1]/S[1];return I}function d(I,J){I[0]=Math.ceil(J[0]);I[1]=Math.ceil(J[1]);
return I}function u(I,J){I[0]=Math.floor(J[0]);I[1]=Math.floor(J[1]);return I}function E(I,J,S){I[0]=Math.min(J[0],S[0]);I[1]=Math.min(J[1],S[1]);return I}function y(I,J,S){I[0]=Math.max(J[0],S[0]);I[1]=Math.max(J[1],S[1]);return I}function v(I,J){I[0]=Math.round(J[0]);I[1]=Math.round(J[1]);return I}function H(I,J,S){I[0]=J[0]*S;I[1]=J[1]*S;return I}function C(I,J,S,aa){I[0]=J[0]+S[0]*aa;I[1]=J[1]+S[1]*aa;return I}function f(I,J){const S=J[0]-I[0];I=J[1]-I[1];return Math.sqrt(S*S+I*I)}function l(I,
J){const S=J[0]-I[0];I=J[1]-I[1];return S*S+I*I}function t(I){const J=I[0];I=I[1];return Math.sqrt(J*J+I*I)}function k(I){const J=I[0];I=I[1];return J*J+I*I}function F(I,J){I[0]=-J[0];I[1]=-J[1];return I}function e(I,J){I[0]=1/J[0];I[1]=1/J[1];return I}function r(I,J){var S=J[0];const aa=J[1];S=S*S+aa*aa;0<S&&(S=1/Math.sqrt(S),I[0]=J[0]*S,I[1]=J[1]*S);return I}function q(I,J){return I[0]*J[0]+I[1]*J[1]}function h(I,J,S){J=J[0]*S[1]-J[1]*S[0];I[0]=I[1]=0;I[2]=J;return I}function D(I,J,S,aa){const fa=
J[0];J=J[1];I[0]=fa+aa*(S[0]-fa);I[1]=J+aa*(S[1]-J);return I}function m(I,J){J=J||1;const S=2*n.RANDOM()*Math.PI;I[0]=Math.cos(S)*J;I[1]=Math.sin(S)*J;return I}function c(I,J,S){const aa=J[0];J=J[1];I[0]=S[0]*aa+S[2]*J;I[1]=S[1]*aa+S[3]*J;return I}function g(I,J,S){const aa=J[0];J=J[1];I[0]=S[0]*aa+S[2]*J+S[4];I[1]=S[1]*aa+S[3]*J+S[5];return I}function G(I,J,S){const aa=J[0];J=J[1];I[0]=S[0]*aa+S[3]*J+S[6];I[1]=S[1]*aa+S[4]*J+S[7];return I}function K(I,J,S){const aa=J[0];J=J[1];I[0]=S[0]*aa+S[4]*
J+S[12];I[1]=S[1]*aa+S[5]*J+S[13];return I}function L(I,J,S,aa){const fa=J[0]-S[0];J=J[1]-S[1];const ea=Math.sin(aa);aa=Math.cos(aa);I[0]=fa*aa-J*ea+S[0];I[1]=fa*ea+J*aa+S[1];return I}function O(I,J){var S=I[0];I=I[1];const aa=J[0];J=J[1];let fa=S*S+I*I;0<fa&&(fa=1/Math.sqrt(fa));let ea=aa*aa+J*J;0<ea&&(ea=1/Math.sqrt(ea));S=(S*aa+I*J)*fa*ea;return 1<S?0:-1>S?Math.PI:Math.acos(S)}function U(I){return"vec2("+I[0]+", "+I[1]+")"}function R(I,J){return I[0]===J[0]&&I[1]===J[1]}function V(I,J){const S=
I[0];I=I[1];const aa=J[0];J=J[1];const fa=n.getEpsilon();return Math.abs(S-aa)<=fa*Math.max(1,Math.abs(S),Math.abs(aa))&&Math.abs(I-J)<=fa*Math.max(1,Math.abs(I),Math.abs(J))}function X(I,J,S,aa,fa){let ea=J[0]-S[0];S=J[1]-S[1];fa=(aa[0]*ea+aa[1]*S)*(fa-1);ea=aa[0]*fa;S=aa[1]*fa;I[0]=J[0]+ea;I[1]=J[1]+S;return I}const Q=Object.freeze(Object.defineProperty({__proto__:null,add:p,angle:O,ceil:d,copy:b,cross:h,dist:f,distance:f,div:B,divide:B,dot:q,equals:V,exactEquals:R,floor:u,inverse:e,len:t,length:t,
lerp:D,max:y,min:E,mul:A,multiply:A,negate:F,normalize:r,projectAndScale:X,random:m,rotate:L,round:v,scale:H,scaleAndAdd:C,set:z,sqrDist:l,sqrLen:k,squaredDistance:l,squaredLength:k,str:U,sub:w,subtract:w,transformMat2:c,transformMat2d:g,transformMat3:G,transformMat4:K},Symbol.toStringTag,{value:"Module"}));a.add=p;a.angle=O;a.ceil=d;a.copy=b;a.cross=h;a.dist=f;a.distance=f;a.div=B;a.divide=B;a.dot=q;a.equals=V;a.exactEquals=R;a.floor=u;a.inverse=e;a.len=t;a.length=t;a.lerp=D;a.max=y;a.min=E;a.mul=
A;a.multiply=A;a.negate=F;a.normalize=r;a.projectAndScale=X;a.random=m;a.rotate=L;a.round=v;a.scale=H;a.scaleAndAdd=C;a.set=z;a.sqrDist=l;a.sqrLen=k;a.squaredDistance=l;a.squaredLength=k;a.str=U;a.sub=w;a.subtract=w;a.transformMat2=c;a.transformMat2d=g;a.transformMat3=G;a.transformMat4=K;a.vec2=Q})},"esri/views/interactive/snapping/SnappingConstraint":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../chunks/vec3 ../../../chunks/vec3f64 ./SnappingPoint ../../support/geometry3dUtils ../../support/geometry2dUtils".split(" "),
function(a,n,b,z,p,w,A,B,d){function u(L,O){let U=[];if(v(L)){var {point:R}=L;H(O)?U=B.intersectLineAndPoint(O.lineLike,R):C(O)?U=B.intersectVerticalCylinderAndPoint(O.center,O.radius,R):f(O)?U=B.intersectVerticalPlaneAndPoint(O.planeLike,R):l(O)&&(U=E(O,L))}else if(H(L))({lineLike:R}=L),v(O)?U=B.intersectLineAndPoint(R,O.point):H(O)?U=B.intersectLineLike(R,O.lineLike):C(O)?U=B.intersectLineLikeAndVerticalCylinder(R,O.center,O.radius):f(O)?U=B.intersectVerticalPlaneAndLineLike(O.planeLike,R):l(O)&&
(U=E(O,L));else if(C(L)){const {center:V,radius:X}=L;if(H(O))U=B.intersectLineLikeAndVerticalCylinder(O.lineLike,V,X);else if(v(O))U=B.intersectVerticalCylinderAndPoint(V,X,O.point);else{if(f(O))return B.intersectVerticalPlaneAndVerticalCylinder(O.planeLike,V,X).map(Q=>new q(Q,L,O));l(O)&&(U=E(O,L))}}else if(f(L)){({planeLike:R}=L);if(f(O))return B.intersectVerticalPlane(R,O.planeLike).map(V=>new q(V,L,O));if(v(O))U=B.intersectVerticalPlaneAndPoint(R,O.point);else if(H(O))U=B.intersectVerticalPlaneAndLineLike(R,
O.lineLike);else{if(C(O))return B.intersectVerticalPlaneAndVerticalCylinder(R,O.center,O.radius).map(V=>new q(V,L,O));l(O)&&(U=E(O,L))}}else l(L)&&(U=E(L,O));return y(U,L,O)}function E(L,O){const {planeLike:U,getZ:R}=L,V=[];if(v(O))L.addIfOnTheGround(V,B.intersectVerticalPlaneAndPoint(U,O.point));else if(H(O))L.addIfOnTheGround(V,B.intersectVerticalPlaneAndLineLike(U,O.lineLike));else if(C(O))for(const [X,Q]of B.intersectVerticalPlaneAndVerticalCylinder(U,O.center,O.radius))L=R(X,Q,0),null!=L&&V.push(w.fromValues(X,
Q,L));else if(f(O)||l(O))for(const [X,Q]of B.intersectVerticalPlane(U,O.planeLike))L=R(X,Q,0)??0,V.push(w.fromValues(X,Q,L));return V}function y(L,O,U){return L.map(R=>new r(A.asSnappingPoint(R),O,U))}function v(L){return L instanceof k}function H(L){return L instanceof F}function C(L){return L instanceof h}function f(L){return L instanceof D}function l(L){return L instanceof g}let t=function(){function L(){}L.prototype.intersect=function(O){return u(this,O)};return n._createClass(L)}(),k=function(L){function O(R){var V=
L.call(this)||this;V.point=R;return V}n._inherits(O,L);var U=O.prototype;U.equals=function(R){return v(R)&&p.exactEquals(this.point,R.point)};U.closestTo=function(){return A.cloneSnappingPoint(this.point)};return n._createClass(O)}(t),F=function(L){function O(R,V,X){var Q=L.call(this)||this;Q.start=R;Q.end=V;Q.type=X;Q.lineLike={start:Q.start,end:Q.end,type:Q.type};return Q}n._inherits(O,L);var U=O.prototype;U.equals=function(R){return H(R)&&this.type===R.type&&p.exactEquals(this.start,R.start)&&
p.exactEquals(this.end,R.end)};U.closestTo=function(R){R=B.projectPointToLineLike(R,this.lineLike);return A.asSnappingPoint(R)};return n._createClass(O)}(t),e=function(L){function O(U,R){return L.call(this,U,R,d.LineType.LINE)||this}n._inherits(O,L);return n._createClass(O)}(F),r=function(L){function O(R,V,X){var Q=L.call(this)||this;Q.intersection=R;Q.first=V;Q.second=X;return Q}n._inherits(O,L);var U=O.prototype;U.equals=function(R){return R instanceof O&&this.first.equals(R.first)&&this.second.equals(R.second)};
U.closestTo=function(){return A.cloneSnappingPoint(this.intersection)};return n._createClass(O)}(t),q=function(L){function O(R,V,X){var Q=L.call(this)||this;Q.basePoint=R;Q.first=V;Q.second=X;return Q}n._inherits(O,L);var U=O.prototype;U.equals=function(R){return R instanceof O&&this.first.equals(R.first)&&this.second.equals(R.second)};U.closestTo=function(R){const V=this.basePoint;return A.asSnappingPoint(w.fromValues(V[0],V[1],R[2]))};return n._createClass(O)}(t),h=function(L){function O(R,V){var X=
L.call(this)||this;X.center=R;X.radius=V;return X}n._inherits(O,L);var U=O.prototype;U.equals=function(R){return C(R)&&this.center[0]===R.center[0]&&this.center[1]===R.center[1]&&this.radius===R.radius};U.closestTo=function(R){R=B.projectPointToVerticalCylinder(R,this.center,this.radius);return A.asSnappingPoint(R)};return n._createClass(O)}(t),D=function(L){function O(R,V,X){var Q=L.call(this)||this;Q.start=R;Q.end=V;Q.type=X;Q.planeLike={start:R,end:V,type:X};return Q}n._inherits(O,L);var U=O.prototype;
U.equals=function(R){return f(R)&&this.type===R.type&&p.exactEquals(this.start,R.start)&&p.exactEquals(this.end,R.end)};U.closestTo=function(R){return A.asSnappingPoint(B.projectPointToVerticalPlane(R,this.planeLike))};U.closestEndTo=function(R){const {start:V,end:X}=this;return 0<Math.sign(b.dot(b.subtract(G,X,V),b.subtract(K,R,V)))?X:V};return n._createClass(O)}(t),m=function(L){function O(U,R){return L.call(this,U,R,B.VerticalPlaneType.HALF_PLANE)||this}n._inherits(O,L);return n._createClass(O)}(D),
c=function(L){function O(U,R){return L.call(this,U,R,B.VerticalPlaneType.PLANE)||this}n._inherits(O,L);return n._createClass(O)}(D),g=function(L){function O(R,V,X){var Q=L.call(this)||this;Q.start=R;Q.end=V;Q.getZ=X;Q.planeLike={start:R,end:V,type:B.VerticalPlaneType.PLANE};return Q}n._inherits(O,L);var U=O.prototype;U.equals=function(R){return l(R)&&p.exactEquals(this.start,R.start)&&p.exactEquals(this.end,R.end)&&this.getZ===R.getZ};U.closestTo=function(R){const V=B.projectPointToVerticalPlane(R,
this.planeLike);V[2]=this.getZ(R[0],R[1],R[2])??0;return A.asSnappingPoint(V)};U.addIfOnTheGround=function(R,V){for(const X of V)V=this.getZ(X[0],X[1],X[2])??0,Math.abs(X[2]-V)<B.epsilon&&(X[2]=V,R.push(X))};return n._createClass(O)}(t);const G=z.create(),K=z.create();a.DrapedLineConstraint=g;a.IntersectionConstraint=r;a.LineConstraint=e;a.LineLikeConstraint=F;a.PointConstraint=k;a.SnappingConstraint=t;a.VerticalCylinderConstraint=h;a.VerticalHalfPlaneConstraint=m;a.VerticalLineIntersectionConstraint=
q;a.VerticalPlaneConstraint=c;a.VerticalPlaneLikeConstraint=D;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/vec2f64":function(){define(["exports"],function(a){function n(){return[0,0]}function b(f){return[f[0],f[1]]}function z(f,l){return[f,l]}function p(f){const l=[0,0],t=Math.min(2,f.length);for(let k=0;k<t;++k)l[k]=f[k];return l}function w(f,l){return new Float64Array(f,l,2)}function A(){return[0,0]}function B(){return[1,1]}function d(){return[1,0]}function u(){return[0,
1]}const E=[0,0],y=[1,1],v=[1,0],H=[0,1],C=Object.freeze(Object.defineProperty({__proto__:null,ONES:y,UNIT_X:v,UNIT_Y:H,ZEROS:E,clone:b,create:n,createView:w,fromArray:p,fromValues:z,ones:B,unitX:d,unitY:u,zeros:A},Symbol.toStringTag,{value:"Module"}));a.ONES=y;a.UNIT_X=v;a.UNIT_Y=H;a.ZEROS=E;a.clone=b;a.create=n;a.createView=w;a.fromArray=p;a.fromValues=z;a.ones=B;a.unitX=d;a.unitY=u;a.vec2f64=C;a.zeros=A})},"esri/views/interactive/snapping/SnappingPoint":function(){define(["exports","../../../chunks/vec3f64",
"../../../layers/graphics/dehydratedFeatures","../../../support/elevationInfoUtils"],function(a,n,b,z){function p(A,B,d){if(null==A)return null;if(null==B)return n.fromValues(A.x,A.y,A.z??0);if("2d"===B.type)return n.fromValues(A.x,A.y,0);({elevationInfo:d}=d);B=z.getConvertedElevation(B,A,d,z.absoluteHeightElevationInfo)??0;return n.fromValues(A.x,A.y,B)}const w=b.makeDehydratedPoint(0,0,0,null);a.anyMapPointToSnappingPoint=function(A,B,d){return null==A?null:p(d.coordinateHelper.vectorToDehydratedPoint(A,
w),B,d)};a.asSnappingPoint=function(A){return A};a.cloneSnappingPoint=function(A){return n.clone(A)};a.createSnappingPoint=function(A,B,d){return n.fromValues(A,B,d)};a.pointToSnappingPoint=p;a.snappingPointToDehydratedPoint=function(A,B){return b.makeDehydratedPoint(A[0],A[1],A[2],B)};a.snappingPointToSnappingOutput=function(A,B,{z:d,m:u,spatialReference:E,elevationInfo:y}){if(null==d&&null==u)return A=b.makeDehydratedPoint(A[0],A[1],void 0,E),null!=u&&(A.m=u,A.hasM=!0),A;if(null==B||"2d"===B.type)return A=
b.makeDehydratedPoint(A[0],A[1],d,E),null!=u&&(A.m=u,A.hasM=!0),A;B=z.getConvertedElevationFromVector(B,A,E,z.absoluteHeightElevationInfo,y)??0;A=b.makeDehydratedPoint(A[0],A[1],B,E);null!=u&&(A.m=u,A.hasM=!0);return A};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/dehydratedFeatures":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/byteSizeEstimations ../../core/has ../../core/typedArrayUtil ../../core/uid ../../geometry/SpatialReference ../../geometry/support/aaBoundingBox ../../geometry/support/aaBoundingRect ../../geometry/support/quantizationUtils ../../geometry/support/typeUtils ../support/Field ./dehydratedFeatureComparison".split(" "),
function(a,n,b,z,p,w,A,B,d,u,E,y,v){function H(f,l,t){if(null==f)return null;switch(l){case "point":return{x:f.x,y:f.y,z:f.z,m:f.m,hasZ:null!=f.z,hasM:null!=f.m,type:"point",spatialReference:t};case "polyline":return{paths:f.paths,hasZ:!!f.hasZ,hasM:!!f.hasM,type:"polyline",spatialReference:t};case "polygon":return{rings:f.rings,hasZ:!!f.hasZ,hasM:!!f.hasM,type:"polygon",spatialReference:t};case "multipoint":return{points:f.points,hasZ:!!f.hasZ,hasM:!!f.hasM,type:"multipoint",spatialReference:t}}}
function C(f){if(null==f)return 0;let l=32;switch(f.type){case "point":l+=42;break;case "polyline":case "polygon":var t=0;const k=2+(f.hasZ?1:0)+(f.hasM?1:0);f="polyline"===f.type?f.paths:f.rings;for(const F of f)t+=F.length;l+=8*t*k+64;l+=128*t;l=l+34+32*(f.length+1);break;case "multipoint":t=f.points.length;l+=8*t*(2+(f.hasZ?1:0)+(f.hasM?1:0))+64;l+=128*t;l=l+34+32;break;case "extent":l+=98;f.hasM&&(l+=32);f.hasZ&&(l+=32);break;case "mesh":l+=p.estimateSize(f.vertexAttributes.position),l+=p.estimateSize(f.vertexAttributes.normal),
l+=p.estimateSize(f.vertexAttributes.uv),l+=p.estimateSize(f.vertexAttributes.tangent)}return l}z=n._createClass(function(f,l,t){this.uid=f;this.geometry=l;this.attributes=t;this.visible=!0;this.centroid=this.objectId=null});n=n._createClass(function(){this.exceededTransferLimit=!1;this.features=[];this.fields=[];this.hasZ=this.hasM=!1;this.transform=this.spatialReference=this.geohashFieldName=this.geometryProperties=this.globalIdFieldName=this.objectIdFieldName=this.geometryType=null});a.equals=
v.equals;a.DehydratedFeatureClass=z;a.DehydratedFeatureSetClass=n;a.computeAABB=function(f,l){B.empty(l);"mesh"===f.type&&(f=f.extent);switch(f.type){case "point":l[0]=l[3]=f.x;l[1]=l[4]=f.y;f.hasZ&&(l[2]=l[5]=f.z);break;case "polyline":for(var t=0;t<f.paths.length;t++)B.expandWithNestedArray(l,f.paths[t],!!f.hasZ);break;case "polygon":for(t=0;t<f.rings.length;t++)B.expandWithNestedArray(l,f.rings[t],!!f.hasZ);break;case "multipoint":B.expandWithNestedArray(l,f.points,!!f.hasZ);break;case "extent":l[0]=
f.xmin,l[1]=f.ymin,l[3]=f.xmax,l[4]=f.ymax,null!=f.zmin&&(l[2]=f.zmin),null!=f.zmax&&(l[5]=f.zmax)}};a.computeAABR=function(f,l){d.empty(l);"mesh"===f.type&&(f=f.extent);switch(f.type){case "point":l[0]=l[2]=f.x;l[1]=l[3]=f.y;break;case "polyline":for(var t=0;t<f.paths.length;t++)d.expandWithNestedArray(l,f.paths[t]);break;case "polygon":for(t=0;t<f.rings.length;t++)d.expandWithNestedArray(l,f.rings[t]);break;case "multipoint":d.expandWithNestedArray(l,f.points);break;case "extent":l[0]=f.xmin,l[1]=
f.ymin,l[2]=f.xmax,l[3]=f.ymax}};a.estimateGeometryObjectSize=C;a.estimateSize=function(f){let l;l=32+b.estimateAttributesObjectSize(f.attributes);return l=l+3+(8+C(f.geometry))};a.fromFeatureSetJSON=function(f){const l=E.featureGeometryTypeKebabDictionary.fromJSON(f.geometryType),t=A.fromJSON(f.spatialReference),k=f.transform,F=f.features.map(e=>{var r=f.objectIdFieldName;e={uid:w.generateUID(),objectId:r&&e.attributes?e.attributes[r]:null,attributes:e.attributes,geometry:H(e.geometry,l,t),visible:!0};
r=e.geometry;if(null!=r&&k)switch(r.type){case "point":e.geometry=u.unquantizePoint(k,r,r,r.hasZ,r.hasM);break;case "multipoint":e.geometry=u.unquantizeMultipoint(k,r,r,!!r.hasZ,!!r.hasM);break;case "polygon":e.geometry=u.unquantizePolygon(k,r,r,!!r.hasZ,!!r.hasM);break;case "polyline":e.geometry=u.unquantizePolyline(k,r,r,!!r.hasZ,!!r.hasM);break;case "extent":e.geometry=r;break;case "mesh":e.geometry=r}return e});return{geometryType:l,features:F,spatialReference:t,fields:f.fields?.map(e=>y.fromJSON(e))??
[],objectIdFieldName:f.objectIdFieldName,globalIdFieldName:f.globalIdFieldName,geohashFieldName:f.geohashFieldName,geometryProperties:f.geometryProperties,hasZ:f.hasZ,hasM:f.hasM,exceededTransferLimit:f.exceededTransferLimit,transform:null}};a.fromJSONGeometry=H;a.getObjectId=function(f,l){return null!=f.objectId?f.objectId:f.attributes&&l?f.attributes[l]:null};a.hasGeometry=function(f){return null!=f.geometry};a.hasVertices=function(f){if(null==f)return!1;switch(f.type){case "extent":case "point":return!0;
case "polyline":for(const l of f.paths)if(0<l.length)return!0;return!1;case "polygon":for(const l of f.rings)if(0<l.length)return!0;return!1;case "multipoint":return 0<f.points.length;case "mesh":return!f.loaded||0<f.vertexAttributes.position.length}};a.makeDehydratedPoint=function(f,l,t,k){return{x:f,y:l,z:t,hasZ:null!=t,hasM:!1,spatialReference:k,type:"point"}};a.numVertices=function(f){if(null==f)return 0;switch(f.type){case "point":return 1;case "polyline":var l=0;for(var t of f.paths)l+=t.length;
return l;case "polygon":t=0;for(l of f.rings)t+=l.length;return t;case "multipoint":return f.points.length;case "extent":return 2;case "mesh":return(f=f.vertexAttributes&&f.vertexAttributes.position)?f.length/3:0}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/byteSizeEstimations":function(){define(["exports"],function(a){function n(p){return 32+p.length}function b(p){if(!p)return 0;if(Array.isArray(p)){var w=p.length;if(0===w||"number"===typeof p[0])p=32+8*w;else{var A=
32;for(let B=0;B<w;B++)A+=z(p[B]);p=A}return p}A=32;for(w in p)p.hasOwnProperty(w)&&(A+=z(p[w]));return A}function z(p){switch(typeof p){case "object":return b(p);case "string":return n(p);case "number":return 16;case "boolean":return 4;default:return 8}}a.estimateAttributesObjectSize=function(p){if(!p)return 0;let w=32;for(const A in p)if(p.hasOwnProperty(A)){const B=p[A];switch(typeof B){case "string":w+=n(B);break;case "number":w+=16;break;case "boolean":w+=4}}return w};a.estimateFixedArraySize=
function(p,w){return 32+p.length*w};a.estimateNestedObjectSize=b;a.estimateNumberByteSize=function(p){return 16};a.estimateStringByteSize=n;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/quantizationUtils":function(){define(["exports","./jsonUtils"],function(a,n){function b({scale:m,translate:c},g){return Math.round((g-c[0])/m[0])}function z({scale:m,translate:c},g){return Math.round((c[1]-g)/m[1])}function p(m,c,g){const G=[];let K,L,O,U;for(let R=0;R<g.length;R++){const V=
g[R];if(0<R){if(O=b(m,V[0]),U=z(m,V[1]),O!==K||U!==L)G.push(c(V,O-K,U-L)),K=O,L=U}else K=b(m,V[0]),L=z(m,V[1]),G.push(c(V,K,L))}return 0<G.length?G:null}function w(m,c,g,G){return p(m,g?G?D:h:G?h:q,c)}function A(m,c,g,G){const K=[];g=g?G?D:h:G?h:q;for(G=0;G<c.length;G++){const L=p(m,g,c[G]);L&&3<=L.length&&K.push(L)}return K.length?K:null}function B(m,c,g,G){const K=[];g=g?G?D:h:G?h:q;for(G=0;G<c.length;G++){const L=p(m,g,c[G]);L&&2<=L.length&&K.push(L)}return K.length?K:null}function d({scale:m,
translate:c},g){return g*m[0]+c[0]}function u({scale:m,translate:c},g){return c[1]-g*m[1]}function E(m,c,g){const G=Array(g.length);if(!g.length)return G;const [K,L]=m.scale;let O=d(m,g[0][0]);m=u(m,g[0][1]);G[0]=c(g[0],O,m);for(let U=1;U<g.length;U++){const R=g[U];O+=R[0]*K;m-=R[1]*L;G[U]=c(R,O,m)}return G}function y(m,c,g){const G=Array(g.length);for(let K=0;K<g.length;K++)G[K]=E(m,c,g[K]);return G}function v(m,c,g,G){return E(m,g?G?D:h:G?h:q,c)}function H(m,c,g,G){return y(m,g?G?D:h:G?h:q,c)}function C(m,
c,g,G){return y(m,g?G?D:h:G?h:q,c)}function f(m,c,g){let [G,K]=g[0],L=Math.min(G,c[0]),O=Math.min(K,c[1]),U=Math.max(G,c[2]);c=Math.max(K,c[3]);for(let R=1;R<g.length;R++){const [V,X]=g[R];G+=V;K+=X;0>V&&(L=Math.min(L,G));0<V&&(U=Math.max(U,G));0>X?O=Math.min(O,K):0<X&&(c=Math.max(c,K))}m[0]=L;m[1]=O;m[2]=U;m[3]=c;return m}function l(m,c){if(!c.length)return null;m[0]=m[1]=Number.POSITIVE_INFINITY;m[2]=m[3]=Number.NEGATIVE_INFINITY;for(let g=0;g<c.length;g++)f(m,m,c[g]);return m}function t(m,c,g,
G,K){c.xmin=b(m,g.xmin);c.ymin=z(m,g.ymin);c.xmax=b(m,g.xmax);c.ymax=z(m,g.ymax);c!==g&&(G&&(c.zmin=g.zmin,c.zmax=g.zmax),K&&(c.mmin=g.mmin,c.mmax=g.mmax));return c}function k(m,c,g,G,K){c.points=w(m,g.points,G,K)??[];return c}function F(m,c,g,G,K){c.x=b(m,g.x);c.y=z(m,g.y);c!==g&&(G&&(c.z=g.z),K&&(c.m=g.m));return c}function e(m,c,g,G,K){m=A(m,g.rings,G,K);if(!m)return null;c.rings=m;return c}function r(m,c,g,G,K){m=B(m,g.paths,G,K);if(!m)return null;c.paths=m;return c}const q=(m,c,g)=>[c,g],h=(m,
c,g)=>[c,g,m[2]],D=(m,c,g)=>[c,g,m[2],m[3]];a.equals=function(m,c){if(m===c||null==m&&null==c)return!0;if(null==m||null==c)return!1;let g,G,K,L;m&&"upperLeft"===m.originPosition?(g=m.translate[0],G=m.translate[1],m=m.scale[0]):(g=null!=m.extent?m.extent.xmin:0,G=null!=m.extent?m.extent.ymax:0,m=m.tolerance);c&&"upperLeft"===c.originPosition?(K=c.translate[0],L=c.translate[1],c=c.scale[0]):(K=null!=c.extent?c.extent.xmin:0,L=null!=c.extent?c.extent.ymax:0,c=c.tolerance);return g===K&&G===L&&m===c};
a.getQuantizedBoundsCoordsArray=f;a.getQuantizedBoundsCoordsArrayArray=l;a.getQuantizedBoundsPaths=function(m){return l([0,0,0,0],m)};a.getQuantizedBoundsPoints=function(m){const c=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return f(c,c,m)};a.getQuantizedBoundsRings=function(m){return l([0,0,0,0],m)};a.quantizeBounds=function(m,c,g){c[0]=b(m,g[0]);c[3]=z(m,g[1]);c[2]=b(m,g[2]);c[1]=z(m,g[3]);return c};a.quantizeExtent=t;a.quantizeGeometry=
function(m,c){return m&&c?n.isPoint(c)?F(m,{},c,!1,!1):n.isPolyline(c)?r(m,{},c,!1,!1):n.isPolygon(c)?e(m,{},c,!1,!1):n.isMultipoint(c)?k(m,{},c,!1,!1):n.isExtent(c)?t(m,{},c,!1,!1):null:null};a.quantizeMultipoint=k;a.quantizePaths=B;a.quantizePoint=F;a.quantizePoints=w;a.quantizePolygon=e;a.quantizePolyline=r;a.quantizeRings=A;a.quantizeX=b;a.quantizeY=z;a.toQuantizationTransform=function(m){return m?{originPosition:"upper-left"===m.originPosition?"upperLeft":"lower-left"===m.originPosition?"lowerLeft":
m.originPosition,scale:m.tolerance?[m.tolerance,m.tolerance]:[1,1],translate:null!=m.extent?[m.extent.xmin,m.extent.ymax]:[0,0]}:null};a.unquantizeBounds=function(m,c,g){return g?(c[0]=d(m,g[0]),c[1]=u(m,g[3]),c[2]=d(m,g[2]),c[3]=u(m,g[1]),c):[d(m,c[0]),u(m,c[3]),d(m,c[2]),u(m,c[1])]};a.unquantizeCoordsArray=E;a.unquantizeCoordsArrayArray=y;a.unquantizeExtent=function(m,c,g,G,K){c.xmin=d(m,g.xmin);c.ymin=u(m,g.ymin);c.xmax=d(m,g.xmax);c.ymax=u(m,g.ymax);c!==g&&(G&&(c.zmin=g.zmin,c.zmax=g.zmax),K&&
(c.mmin=g.mmin,c.mmax=g.mmax));return c};a.unquantizeMultipoint=function(m,c,g,G,K){null!=g&&(c.points=v(m,g.points,G,K));return c};a.unquantizePaths=H;a.unquantizePoint=function(m,c,g,G,K){if(null==g)return c;c.x=d(m,g.x);c.y=u(m,g.y);c!==g&&(G&&(c.z=g.z),K&&(c.m=g.m));return c};a.unquantizePoints=v;a.unquantizePolygon=function(m,c,g,G,K){null!=g&&(c.rings=C(m,g.rings,G,K));return c};a.unquantizePolyline=function(m,c,g,G,K){null!=g&&(c.paths=H(m,g.paths,G,K));return c};a.unquantizeRings=C;a.unquantizeX=
d;a.unquantizeY=u;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/dehydratedFeatureComparison":function(){define(["exports","../../core/has","../../geometry/support/spatialReferenceUtils"],function(a,n,b){function z(d,u){if(d===u)return!0;if(null==d||null==u||d.length!==u.length)return!1;for(let E=0;E<d.length;E++){const y=d[E],v=u[E];if(y.length!==v.length)return!1;for(let H=0;H<y.length;H++)if(y[H]!==v[H])return!1}return!0}function p(d,u){if(d===u)return!0;
if(null==d||null==u||d.length!==u.length)return!1;for(let E=0;E<d.length;E++)if(!z(d[E],u[E]))return!1;return!0}function w(d,u){return d===u||null!=d&&null!=u&&b.equals(d.spatialReference,u.spatialReference)&&d.x===u.x&&d.y===u.y&&d.z===u.z&&d.m===u.m}function A(d,u){if(d===u)return!0;if(null==d||null==u||d.type!==u.type)return!1;switch(d.type){case "point":return w(d,u);case "extent":return d=d.hasZ!==u.hasZ||d.hasM!==u.hasM?!1:b.equals(d.spatialReference,u.spatialReference)?d.xmin===u.xmin&&d.ymin===
u.ymin&&d.zmin===u.zmin&&d.xmax===u.xmax&&d.ymax===u.ymax&&d.zmax===u.zmax:!1,d;case "polyline":return d=d.hasZ!==u.hasZ||d.hasM!==u.hasM?!1:b.equals(d.spatialReference,u.spatialReference)?p(d.paths,u.paths):!1,d;case "polygon":return d=d.hasZ!==u.hasZ||d.hasM!==u.hasM?!1:b.equals(d.spatialReference,u.spatialReference)?p(d.rings,u.rings):!1,d;case "multipoint":return d=d.hasZ!==u.hasZ||d.hasM!==u.hasM?!1:b.equals(d.spatialReference,u.spatialReference)?z(d.points,u.points):!1,d;case "mesh":return!1}}
function B(d,u){if(d===u)return!0;if(!d||!u)return!1;const E=Object.keys(d),y=Object.keys(u);if(E.length!==y.length)return!1;for(const v of E)if(d[v]!==u[v])return!1;return!0}a.equals=function(d,u){return d===u?!0:null!=d&&null!=u&&d.objectId===u.objectId&&A(d.geometry,u.geometry)&&B(d.attributes,u.attributes)?!0:!1};a.pointEquals=w;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/geometry3dUtils":function(){define("exports ../../core/mathUtils ../../chunks/vec2 ../../chunks/vec2f64 ../../chunks/vec3 ../../chunks/vec3f64 ./geometry2dUtils".split(" "),
function(a,n,b,z,p,w,A){function B(q,{start:h,end:D,type:m}){q=p.sub(H,q,h);D=p.sub(C,D,h);q=p.dot(q,D)/p.dot(D,D);return p.scaleAndAdd(w.create(),h,D,m===A.LineType.RAY?Math.max(q,0):q)}function d({start:q,end:h,type:D},m){const c=p.sub(H,m,q);h=p.sub(C,h,q);if(D===A.LineType.RAY&&-1E-6>p.dot(h,c))return p.distance(q,m);q=p.cross(f,h,c);return p.len(q)/p.len(h)}function u(q,h){const D=q.start,m=h.start;var c=h.end;const g=p.sub(H,q.end,D);c=p.sub(C,c,m);var G=p.sub(f,m,D),K=p.cross(l,g,c),L=p.dot(G,
K);if(!n.floatEqualAbsolute(L,0,1E-6))return[];L=p.sqrLen(K);if(n.floatEqualAbsolute(L,0,1E-6))return[];G=p.cross(t,G,c);K=p.dot(G,K)/L;K=p.scaleAndAdd(k,D,g,K);return q.type===A.LineType.RAY&&(q=p.sub(F,K,D),-1E-6>p.dot(g,q))||h.type===A.LineType.RAY&&(h=p.sub(F,K,m),-1E-6>p.dot(c,h))?[]:[w.clone(K)]}function E({start:q,end:h,type:D},m){const c=p.sub(H,m,q);q=p.sub(C,h,q);h=p.cross(f,q,c);if(1E-6>p.sqrLen(h)/p.sqrLen(q))switch(D){case A.LineType.LINE:return[w.clone(m)];case A.LineType.RAY:return-1E-6>
p.dot(q,c)?[]:[w.clone(m)]}return[]}function y(q,h,{start:D,end:m,type:c}){p.set(q.start,D[0],D[1],h);p.set(q.end,m[0],m[1],h);q.type=v[c];return q}a.VerticalPlaneType=void 0;(function(q){q[q.PLANE=0]="PLANE";q[q.HALF_PLANE=1]="HALF_PLANE"})(a.VerticalPlaneType||(a.VerticalPlaneType={}));const v={[a.VerticalPlaneType.PLANE]:A.LineType.LINE,[a.VerticalPlaneType.HALF_PLANE]:A.LineType.RAY},H=w.create(),C=w.create(),f=w.create(),l=w.create(),t=w.create(),k=w.create(),F=w.create(),e={start:w.create(),
end:w.create(),type:A.LineType.LINE},r={start:w.create(),end:w.create(),type:A.LineType.LINE};Object.defineProperty(a,"LineType",{enumerable:!0,get:()=>A.LineType});a.epsilon=1E-6;a.intersectLineAndPoint=E;a.intersectLineLike=u;a.intersectLineLikeAndVerticalCylinder=function({start:q,end:h,type:D},m,c){const g=[];h=p.subtract(H,h,q);var G=b.subtract(C,q,m);m=b.squaredLength(h);const K=2*b.dot(h,G);c=b.squaredLength(G)-c*c;c=K*K-4*m*c;0===c?(m=-K/(2*m),(D===A.LineType.LINE||0<=m)&&g.push(p.scaleAndAdd(w.create(),
q,h,m))):0<c&&(c=Math.sqrt(c),G=(-K+c)/(2*m),(D===A.LineType.LINE||0<=G)&&g.push(p.scaleAndAdd(w.create(),q,h,G)),m=(-K-c)/(2*m),(D===A.LineType.LINE||0<=m)&&g.push(p.scaleAndAdd(w.create(),q,h,m)));return g};a.intersectVerticalCylinderAndPoint=function(q,h,D){return n.floatEqualAbsolute(b.squaredDistance(D,q),h*h,1E-6)?[w.clone(D)]:[]};a.intersectVerticalPlane=function(q,h){q=y(e,0,q);h=y(r,0,h);h=u(q,h);q=[];for(const D of h)q.push(z.clone(D));return q};a.intersectVerticalPlaneAndLineLike=function(q,
h){const D=q.start,m=b.subtract(H,q.end,D);var c=p.set(C,-m[1],m[0],0);const g=h.start,G=p.sub(f,h.end,g);var K=p.dot(G,c),L=p.set(l,D[0],D[1],0);L=p.sub(t,L,g);c=p.dot(L,c);if(1E-6>Math.abs(K))return[];K=p.scaleAndAdd(k,g,G,c/K);return h.type===A.LineType.RAY&&(h=p.sub(F,K,g),-1E-6>p.dot(h,G))||q.type===a.VerticalPlaneType.HALF_PLANE&&(q=b.sub(F,K,D),-1E-6>b.dot(q,m))?[]:[w.clone(K)]};a.intersectVerticalPlaneAndPoint=function(q,h){return E(y(e,h[2],q),h)};a.intersectVerticalPlaneAndVerticalCylinder=
function({start:q,end:h,type:D},m,c){const g=[];h=b.subtract(H,h,q);var G=b.subtract(C,q,m);m=b.squaredLength(h);const K=2*b.dot(h,G);c=b.squaredLength(G)-c*c;c=K*K-4*m*c;0===c?(m=-K/(2*m),(D===a.VerticalPlaneType.PLANE||0<=m)&&g.push(b.scaleAndAdd(z.create(),q,h,m))):0<c&&(c=Math.sqrt(c),G=(-K+c)/(2*m),(D===a.VerticalPlaneType.PLANE||0<=G)&&g.push(b.scaleAndAdd(z.create(),q,h,G)),m=(-K-c)/(2*m),(D===a.VerticalPlaneType.PLANE||0<=m)&&g.push(b.scaleAndAdd(z.create(),q,h,m)));return g};a.pointToLineLikeDistance=
d;a.pointToVerticalCylinderDistance=function(q,h,D){return b.distance(q,h)-D};a.pointToVerticalPlaneDistance=function(q,h){return d(y(e,q[2],h),q)};a.projectPointToLineLike=B;a.projectPointToVerticalCylinder=function(q,h,D){const m=b.subtract(H,q,h);D/=b.length(m);h=b.scaleAndAdd(w.create(),h,m,D);h[2]=q[2];return h};a.projectPointToVerticalPlane=function(q,h){return B(q,y(e,q[2],h))};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/geometry2dUtils":function(){define(["exports",
"../../core/mathUtils","../../chunks/vec2","../../chunks/vec2f64"],function(a,n,b,z){function p(v,H){return v[0]*H[1]-v[1]*H[0]}function w(v,H,C){H=b.dot(C,H)/b.squaredLength(C);return b.scale(v,C,H)}function A(v,H,C,f,l=C){b.subtract(d,f,C);b.subtract(E,H,l);w(y,E,d);return b.add(v,l,y)}function B(v,H,C,f){b.subtract(d,H,C);H=f/b.length(d);return b.scaleAndAdd(v,C,d,H)}a.LineType=void 0;(function(v){v[v.RAY=0]="RAY";v[v.LINE=1]="LINE"})(a.LineType||(a.LineType={}));const d=z.create(),u=z.create(),
E=z.create(),y=z.create();a.cross=p;a.intersectCircleAndPoint=function(v,H,C){B(E,C,v,H);return n.floatEqualAbsolute(E[0],C[0])&&n.floatEqualAbsolute(E[1],C[1])?[z.clone(C)]:[]};a.intersectLineAndPoint=function(v,H){A(E,H,v.start,v.end);return n.floatEqualAbsolute(E[0],H[0])&&n.floatEqualAbsolute(E[1],H[1])?[z.clone(H)]:[]};a.intersectLineAndRay=function(v,H){const C=v.start;var f=H.start,l=H.end;const t=b.subtract(d,v.end,C);var k=b.subtract(u,l,f);l=p(t,k);if(1E-6>=Math.abs(l))return[];f=b.subtract(E,
C,f);k=p(k,f)/l;l=p(t,f)/l;if(0<=k){if(0<=l||H.type===a.LineType.LINE)return[b.scaleAndAdd(y,C,t,k)]}else if(v.type===a.LineType.LINE&&(0<=l||H.type===a.LineType.LINE))return[b.scaleAndAdd(y,C,t,k)];return[]};a.intersectLineLikeAndCircle=function(v,H,C){const f=[],l=b.subtract(d,v.end,v.start);var t=b.subtract(u,v.start,H);H=b.squaredLength(l);const k=2*b.dot(l,t);C=b.squaredLength(t)-C*C;C=k*k-4*H*C;0===C?(H=-k/(2*H),(v.type===a.LineType.LINE||0<=H)&&f.push(b.scaleAndAdd(y,v.start,l,H))):0<C&&(C=
Math.sqrt(C),t=(-k+C)/(2*H),(v.type===a.LineType.LINE||0<=t)&&f.push(b.scaleAndAdd(y,v.start,l,t)),H=(-k-C)/(2*H),(v.type===a.LineType.LINE||0<=H)&&f.push(b.scaleAndAdd(E,v.start,l,H)));return f};a.pointToLineDistance=function(v,H,C){return Math.abs((H[0]-v[0])*(C[1]-v[1])-(H[1]-v[1])*(C[0]-v[0]))/b.distance(H,C)};a.projectPoint=w;a.projectPointToCircle=B;a.projectPointToLine=A;a.projectPointToRay=function(v,H,C,f){b.subtract(d,f,C);b.subtract(E,H,C);H=b.dot(d,E)/b.squaredLength(d);return 0<H?b.scaleAndAdd(v,
C,d,H):b.copy(v,C)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/snappingUtils":function(){define("exports ../../../core/reactiveUtils ../../../chunks/vec3 ../../../layers/graphics/dehydratedFeatures ../../input/InputManager ../keybindings ./SnappingPoint".split(" "),function(a,n,b,z,p,w,A){function B(d,u){const E=d.x-u.x;d=d.y-u.y;return E*E+d*d}a.LineSegmentHintType=void 0;(function(d){d[d.TARGET=0]="TARGET";d[d.REFERENCE=1]="REFERENCE";d[d.REFERENCE_EXTENSION=
2]="REFERENCE_EXTENSION"})(a.LineSegmentHintType||(a.LineSegmentHintType={}));a.editEdgeToSnappingEdge=function(d,u,E){return{left:A.anyMapPointToSnappingPoint(d.leftVertex.pos,u,E),right:A.anyMapPointToSnappingPoint(d.rightVertex.pos,u,E)}};a.makeFilter=function(d){return d.createQuery()};a.makeSnappingQuery=function({point:d,distance:u,returnEdge:E,returnVertex:y,coordinateHelper:{spatialReference:v}},H,C){return{point:z.makeDehydratedPoint(d[0],d[1],d[2],v.toJSON()),mode:H,distance:u,returnEdge:E,
returnVertex:y,query:null!=C?C.toJSON():{where:"1\x3d1"}}};a.objectEqual=function(d,u){const E=d.length===u.length&&d[0]===u[0]&&d[1]===u[1];switch(d.length){case 2:return E;case 3:return E&&d[2]===u[2];case 4:return E&&d[2]===u[2]&&d[3]===u[3]}return!1};a.screenDistance=function(d,u){return Math.sqrt(B(d,u))};a.setupSnappingToggleHandles=function(d,u=()=>{}){const E=n.watch(()=>({view:d.view,snappingOptions:d.snappingOptions}),({view:y,snappingOptions:v})=>{const H=p.ViewEventPriorities.TOOL;d.removeHandles("snapping-toggle");
y&&null!=v&&(y=[y.on("key-down",C=>{C.key!==w.SNAPPING_KEYS.toggle||C.repeat||(v.enabledToggled=!0,u())},H),y.on("key-up",C=>{C.key===w.SNAPPING_KEYS.toggle&&(v.enabledToggled=!1,u())},H),y.on("pointer-move",C=>{C=C.native.ctrlKey;v.enabledToggled!==C&&(v.enabledToggled=C,u())},H)],d.addHandles(y,"snapping-toggle"))},n.syncAndInitial);d.addHandles(E)};a.sortCandidatesInPlace=function(d,u){u.sort((E,y)=>{E=b.squaredDistance(E.targetPoint,d);y=b.squaredDistance(y.targetPoint,d);return E-y})};a.squaredScreenDistance=
B;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/DrapedEdgeSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../SnappingConstraint ../snappingUtils ./FeatureSnappingCandidate ../hints/LineSnappingHint".split(" "),function(a,n,b,z,p,w){p=function(A){function B(d){return A.call(this,{...d,isDraped:!0,constraint:new b.DrapedLineConstraint(d.edgeStart,d.edgeEnd,d.getGroundElevation)})||this}n._inherits(B,
A);n._createClass(B,[{key:"hints",get:function(){return[new w.LineSnappingHint(z.LineSegmentHintType.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}}]);return B}(p.FeatureSnappingCandidate);a.DrapedEdgeSnappingCandidate=p;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/FeatureSnappingCandidate":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../SnappingDomain","./SnappingCandidate"],
function(a,n,b,z){z=function(p){function w({targetPoint:A,objectId:B,constraint:d,isDraped:u}){A=p.call(this,A,d,u,b.SnappingDomain.FEATURE)||this;A.objectId=B;return A}n._inherits(w,p);return n._createClass(w)}(z.SnappingCandidate);a.FeatureSnappingCandidate=z;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/SnappingCandidate":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers"],function(a,n){n=n._createClass(function(b,
z,p,w){this.targetPoint=b;this.constraint=z;this.isDraped=p;this.domain=w});a.SnappingCandidate=n;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/LineSnappingHint":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/Logger ../../../../chunks/vec3 ../SnappingDomain ./SnappingHint".split(" "),function(a,n,b,z,p,w,A){b=function(B){function d(u,E,y,v,H=w.SnappingDomain.ALL,C=!0,f=!0){v=B.call(this,
v,H)||this;v.type=u;v.lineStart=E;v.lineEnd=y;v.fadeLeft=C;v.fadeRight=f;return v}n._inherits(d,B);d.prototype.equals=function(u){return u instanceof d?this.type===u.type&&p.exactEquals(this.lineStart,u.lineStart)&&p.exactEquals(this.lineEnd,u.lineEnd)&&this.fadeLeft===u.fadeLeft&&this.fadeRight===u.fadeRight:!1};n._createClass(d,[{key:"length",get:function(){return p.distance(this.lineStart,this.lineEnd)}}]);return d}(A.SnappingHint);a.LineSnappingHint=b;Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/views/interactive/snapping/hints/SnappingHint":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers"],function(a,n){n=n._createClass(function(b,z){this.isDraped=b;this.domain=z});a.SnappingHint=n;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/EdgeSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../SnappingConstraint ../snappingUtils ./FeatureSnappingCandidate ../hints/LineSnappingHint".split(" "),
function(a,n,b,z,p,w){p=function(A){function B(d){return A.call(this,{...d,constraint:new b.LineConstraint(d.edgeStart,d.edgeEnd)})||this}n._inherits(B,A);n._createClass(B,[{key:"hints",get:function(){return[new w.LineSnappingHint(z.LineSegmentHintType.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}}]);return B}(p.FeatureSnappingCandidate);a.EdgeSnappingCandidate=p;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/RightAngleSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../SnappingDomain ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint ../hints/RightAngleSnappingHint".split(" "),
function(a,n,b,z,p,w,A){p=function(B){function d({targetPoint:u,constraint:E,previousVertex:y,otherVertex:v,otherVertexType:H,objectId:C,isDraped:f}){u=B.call(this,u,E,f,b.SnappingDomain.SELF)||this;u.previousVertex=y;u.otherVertex=v;u.otherVertexType=H;u.objectId=C;return u}n._inherits(d,B);n._createClass(d,[{key:"hints",get:function(){const u=this.previousVertex,E=this.otherVertexType===a.OtherVertexType.CENTER?this.otherVertex:this.targetPoint,y=this.otherVertexType===a.OtherVertexType.CENTER?
this.targetPoint:this.otherVertex;return[new w.LineSnappingHint(z.LineSegmentHintType.TARGET,E,y,this.isDraped,this.domain),new w.LineSnappingHint(z.LineSegmentHintType.REFERENCE,u,E,this.isDraped,this.domain),new A.RightAngleSnappingHint(this.previousVertex,E,y,this.isDraped,this.domain)]}}]);return d}(p.SnappingCandidate);a.OtherVertexType=void 0;(function(B){B[B.NEXT=0]="NEXT";B[B.CENTER=1]="CENTER"})(a.OtherVertexType||(a.OtherVertexType={}));a.RightAngleSnappingCandidate=p;Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/RightAngleSnappingHint":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/Logger ../../../../chunks/vec3 ../SnappingDomain ./SnappingHint".split(" "),function(a,n,b,z,p,w,A){b=function(B){function d(u,E,y,v,H=w.SnappingDomain.ALL){v=B.call(this,v,H)||this;v.previousVertex=u;v.centerVertex=E;v.nextVertex=y;return v}n._inherits(d,B);d.prototype.equals=function(u){return u instanceof
d?p.exactEquals(this.previousVertex,u.previousVertex)&&p.exactEquals(this.centerVertex,u.centerVertex)&&p.exactEquals(this.nextVertex,u.nextVertex):!1};return n._createClass(d)}(A.SnappingHint);a.RightAngleSnappingHint=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/support/viewUtils":function(){define("exports ../../../core/screenUtils ../../../chunks/vec2 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../layers/graphics/dehydratedFeatures ../../../support/elevationInfoUtils".split(" "),
function(a,n,b,z,p,w,A){function B(f,l,t,k,F=p.create()){f=l.toXYZ(f);f[2]=A.getConvertedElevationFromVector(k,f,l.spatialReference,t)||0;k.renderCoordsHelper.toRenderCoords(f,l.spatialReference,F);return F}function d(f,l,t,k,F=p.create()){f=z.copy(y,f);f[2]=A.getConvertedElevationFromVector(k,f,l,t)||0;k.renderCoordsHelper.toRenderCoords(f,l,F);return F}function u(f,l,t,k){if("2d"===k.type)return E.x=f[0],E.y=f[1],E.spatialReference=l,k.toScreen(E);d(f,l,t,k,y);k.state.camera.projectToScreen(y,C);
return n.createScreenPoint(C[0],C[1])}const E=w.makeDehydratedPoint(0,0,0,null),y=p.create(),v=n.createRenderScreenPointArray3(),H=n.createRenderScreenPointArray3(),C=n.createScreenPointArray();a.anyMapPointToRender=B;a.anyMapPointToScreenPoint=function(f,l,t,k){return u(l.toXYZ(f),l.spatialReference,t,k)};a.anyMapPointsToRenderWithEqualRelativeZ=function(f,l,t,k,F,e,r){if("absolute-height"===k.mode)B(f,t,k,F,e),B(l,t,k,F,r);else{f=t.toXYZ(f);l=t.toXYZ(l);var q=A.getConvertedElevationFromVector(F,
f,t.spatialReference,k);k=A.getConvertedElevationFromVector(F,l,t.spatialReference,k);k=(null==q?k:null==k?q:Math.min(q,k))||0;f[2]=k;l[2]=k;F.renderCoordsHelper.toRenderCoords(f,t.spatialReference,e);F.renderCoordsHelper.toRenderCoords(l,t.spatialReference,r)}};a.renderScreenSpaceTangent=function(f,l,t,k){t.projectToRenderScreen(f,v);t.projectToRenderScreen(l,H);b.subtract(k,H,v);b.normalize(k,k)};a.vectorToRender=d;a.vectorToScreenPoint=u;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/views/interactive/snapping/SelfSnappingEngine":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./LineSnapper ./ParallelLineSnapper ./RightAngleSnapper ./RightAngleTriangleSnapper ./SnappingDomain ./snappingUtils".split(" "),
function(a,n,b,z,p,w,A,B,d,u,E,y,v,H,C,f){a.SelfSnappingEngine=function(l){function t(F){F=l.call(this,F)||this;F.updating=!1;F._snappers=new p;F._domain=C.SnappingDomain.SELF;return F}n._inherits(t,l);var k=t.prototype;k.initialize=function(){this._snappers.push(new y.ParallelLineSnapper(this.view,this.options),new E.LineSnapper(this.view,this.options),new v.RightAngleSnapper(this.view,this.options),new H.RightAngleTriangleSnapper(this.view,this.options))};k.fetchCandidates=async function(F,e,r){if(!(e&
this._domain&&this.options.effectiveSelfEnabled))return[];e=[];for(const q of this._snappers.items)for(const h of q.snap(F,r))e.push(h);f.sortCandidatesInPlace(F,e);return e};n._createClass(t,[{key:"options",set:function(F){this._set("options",F);for(const e of this._snappers)e.options=F}}]);return t}(z);b.__decorate([w.property({readOnly:!0})],a.SelfSnappingEngine.prototype,"updating",void 0);b.__decorate([w.property({constructOnly:!0})],a.SelfSnappingEngine.prototype,"view",void 0);b.__decorate([w.property()],
a.SelfSnappingEngine.prototype,"options",null);a.SelfSnappingEngine=b.__decorate([u.subclass("esri.views.interactive.snapping.SelfSnappingEngine")],a.SelfSnappingEngine);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/LineSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../support/elevationInfoUtils ./SnappingAlgorithm ./SnappingPoint ./snappingUtils ./candidates/LineSnappingCandidate ../support/viewUtils ../../support/geometry3dUtils ../../support/geometry2dUtils".split(" "),
function(a,n,b,z,p,w,A,B,d,u){z=function(E){function y(){return E.apply(this,arguments)||this}n._inherits(y,E);var v=y.prototype;v.snapNewVertex=function(H,C){var f=C.editGeometryOperations.data.components[0],l=f.edges.length;const t=[];if(1>l)return t;var {spatialReference:k}=C;k=B.vectorToScreenPoint(H,k,b.absoluteHeightElevationInfo,this.view);const {view:F}=this;l=f=f.edges[l-1];do{if(this.edgeExceedsShortLineThreshold(l,C)){const e=w.editEdgeToSnappingEdge(l,F,C);this._processCandidateProposal(e.left,
e.right,H,k,C,t)}l=l.leftVertex.leftEdge}while(l&&l!==f);return t};v.snapExistingVertex=function(H,C){const f=[],l=C.vertexHandle;var t=l.component;if(2>t.edges.length)return f;const {view:k}=this;var {spatialReference:F}=C;F=B.vectorToScreenPoint(H,F,b.absoluteHeightElevationInfo,k);var e=l.leftEdge,r=l.rightEdge;e&&r&&this.edgeExceedsShortLineThreshold(e,C)&&this.edgeExceedsShortLineThreshold(r,C)&&this._processCandidateProposal(p.anyMapPointToSnappingPoint(e.leftVertex.pos,k,C),p.anyMapPointToSnappingPoint(r.rightVertex.pos,
k,C),H,F,C,f);e=t=t.edges[0];do e!==l.leftEdge&&e!==l.rightEdge&&this.edgeExceedsShortLineThreshold(e,C)&&(r=w.editEdgeToSnappingEdge(e,k,C),this._processCandidateProposal(r.left,r.right,H,F,C,f)),e=e.rightVertex.rightEdge;while(e&&e!==t);return f};v._processCandidateProposal=function(H,C,f,l,t,k){const {spatialReference:F,pointer:e}=t;f=p.asSnappingPoint(d.projectPointToLineLike(f,{start:H,end:C,type:u.LineType.LINE}));w.squaredScreenDistance(l,B.vectorToScreenPoint(f,F,b.absoluteHeightElevationInfo,
this.view))<this.squaredProximityThreshold(e)&&k.push(new A.LineSnappingCandidate({lineStart:H,lineEnd:C,targetPoint:f,isDraped:"on-the-ground"===t.elevationInfo?.mode}))};return n._createClass(y)}(z.SnappingAlgorithm);a.LineSnapper=z;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingAlgorithm":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/vec2 ../../../support/elevationInfoUtils ./Settings ./SnappingPoint ./snappingUtils ../support/viewUtils".split(" "),
function(a,n,b,z,p,w,A,B){let d=function(){function u(y,v){this.view=y;this.options=v;this.squaredShortLineThreshold=p.defaults.shortLineThreshold*p.defaults.shortLineThreshold}var E=u.prototype;E.snap=function(y,v){return null!=v.vertexHandle?"vertex"!==v.vertexHandle.type?[]:this.snapExistingVertex(y,v):this.snapNewVertex(y,v)};E.edgeExceedsShortLineThreshold=function(y,v){return this.exceedsShortLineThreshold(w.anyMapPointToSnappingPoint(y.leftVertex.pos,this.view,v),w.anyMapPointToSnappingPoint(y.rightVertex.pos,
this.view,v),v)};E.exceedsShortLineThreshold=function(y,v,{spatialReference:H}){return 0===this.squaredShortLineThreshold||A.squaredScreenDistance(B.vectorToScreenPoint(v,H,z.absoluteHeightElevationInfo,this.view),B.vectorToScreenPoint(y,H,z.absoluteHeightElevationInfo,this.view))>this.squaredShortLineThreshold};E.isVertical=function(y,v){return b.squaredDistance(y,v)<p.defaults.verticalLineThreshold};E.squaredProximityThreshold=function(y){return"touch"===y?this._squaredTouchProximityThreshold:this._squaredMouseProximityThreshold};
n._createClass(u,[{key:"_squaredMouseProximityThreshold",get:function(){return this.options.distance*this.options.distance}},{key:"_squaredTouchProximityThreshold",get:function(){const {distance:y,touchSensitivityMultiplier:v}=this.options,H=y*v;return H*H}}]);return u}();a.SnappingAlgorithm=d;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/LineSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../SnappingConstraint ../SnappingDomain ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint".split(" "),
function(a,n,b,z,p,w,A){w=function(B){function d({lineStart:u,lineEnd:E,targetPoint:y,isDraped:v}){y=B.call(this,y,new b.VerticalPlaneConstraint(u,E),v,z.SnappingDomain.SELF)||this;y._referenceLineHint=new A.LineSnappingHint(p.LineSegmentHintType.REFERENCE_EXTENSION,u,E,v,y.domain);return y}n._inherits(d,B);d.prototype._lineEndClosestToTarget=function(){return this.constraint.closestEndTo(this.targetPoint)};n._createClass(d,[{key:"hints",get:function(){return[this._referenceLineHint,new A.LineSnappingHint(p.LineSegmentHintType.TARGET,
this._lineEndClosestToTarget(),this.targetPoint,this.isDraped,this.domain)]}}]);return d}(w.SnappingCandidate);a.LineSnappingCandidate=w;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/ParallelLineSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../chunks/vec3f64 ../../../support/elevationInfoUtils ./Settings ./SnappingAlgorithm ./SnappingPoint ./snappingUtils ./candidates/ParallelLineSnappingCandidate ../support/viewUtils ../../support/geometry2dUtils".split(" "),
function(a,n,b,z,p,w,A,B,d,u,E,y,v){B=function(C){function f(){return C.apply(this,arguments)||this}n._inherits(f,C);var l=f.prototype;l.snapNewVertex=function(t,k){var F=k.editGeometryOperations.data.components[0],e=F.edges.length,r=F.vertices.length;const q=[];if(2>e)return q;const {view:h}=this,D=y.vectorToScreenPoint(t,k.spatialReference,w.absoluteHeightElevationInfo,h);r=d.anyMapPointToSnappingPoint(F.vertices[r-1].pos,h,k);const m=d.anyMapPointToSnappingPoint(F.vertices[0].pos,h,k);e=F=F.edges[e-
1];do{if(this.edgeExceedsShortLineThreshold(e,k)){const c=u.editEdgeToSnappingEdge(e,h,k);this._checkEdgeForParallelLines(c,r,t,D,k,q);this._checkEdgeForParallelLines(c,m,t,D,k,q)}e=e.leftVertex.leftEdge}while(e&&e!==F);return q};l.snapExistingVertex=function(t,k){const F=[],e=k.vertexHandle;var r=e.component;if(3>r.edges.length)return F;const {view:q}=this,h=y.vectorToScreenPoint(t,k.spatialReference,w.absoluteHeightElevationInfo,q),D=e.leftEdge,m=e.rightEdge,c=r.vertices[0],g=d.anyMapPointToSnappingPoint(c.pos,
q,k),G=r.vertices[r.vertices.length-1],K=d.anyMapPointToSnappingPoint(G.pos,q,k);let L=r=r.edges[0];do{if(L!==D&&L!==m&&this.edgeExceedsShortLineThreshold(L,k)){const O=u.editEdgeToSnappingEdge(L,q,k);D&&this._checkEdgeForParallelLines(O,d.anyMapPointToSnappingPoint(D.leftVertex.pos,q,k),t,h,k,F);m&&this._checkEdgeForParallelLines(O,d.anyMapPointToSnappingPoint(m.rightVertex.pos,q,k),t,h,k,F);e===c?this._checkEdgeForParallelLines(O,K,t,h,k,F):e===G&&this._checkEdgeForParallelLines(O,g,t,h,k,F)}L=
L.rightVertex.rightEdge}while(L&&L!==r);return F};l._checkEdgeForParallelLines=function(t,k,F,e,r,q){const h=t.left,D=t.right;v.projectPointToLine(H,k,h,D);if(!(b.squaredDistance(H,k)<A.defaults.parallelLineThreshold)){v.projectPointToLine(H,F,h,D,k);var {spatialReference:m,pointer:c}=r;F=d.asSnappingPoint(p.fromValues(H[0],H[1],F[2]));u.squaredScreenDistance(e,y.vectorToScreenPoint(F,m,w.absoluteHeightElevationInfo,this.view))<this.squaredProximityThreshold(c)&&!(this.isVertical(F,k)||this.isVertical(h,
D)||this._parallelToPreviousCandidate(t,q))&&q.push(new E.ParallelLineSnappingCandidate({referenceLine:t,lineStart:k,targetPoint:F,isDraped:"on-the-ground"===r.elevationInfo?.mode}))}};l._parallelToPreviousCandidate=function(t,k){const F=t.left,e=t.right;for(const r of k)if(v.projectPointToLine(H,e,r.constraint.start,r.constraint.end,F),b.squaredDistance(H,e)<A.defaults.parallelLineThreshold)return r.addReferenceLine(t),!0;return!1};return n._createClass(f)}(B.SnappingAlgorithm);const H=z.create();
a.ParallelLineSnapper=B;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/ParallelLineSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../SnappingConstraint ../SnappingDomain ../SnappingPoint ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint ../hints/ParallelSnappingHint".split(" "),function(a,n,b,z,p,w,A,B,d,u,E){d=function(y){function v({referenceLine:H,
lineStart:C,targetPoint:f,isDraped:l}){const t=z.clone(C),{left:k,right:F}=H;b.subtract(t,b.add(t,t,F),k);C=y.call(this,f,new p.VerticalPlaneConstraint(C,A.asSnappingPoint(t)),l,w.SnappingDomain.SELF)||this;C._referenceLines=[{edge:H,fadeLeft:!0,fadeRight:!0}];return C}n._inherits(v,y);v.prototype.addReferenceLine=function(H){const C={edge:H,fadeLeft:!0,fadeRight:!0};this._referenceLines.forEach(f=>{b.exactEquals(H.right,f.edge.left)&&(f.fadeLeft=!1,C.fadeRight=!1);b.exactEquals(H.right,f.edge.right)&&
(f.fadeRight=!1,C.fadeRight=!1);b.exactEquals(H.left,f.edge.right)&&(f.fadeRight=!1,C.fadeLeft=!1);b.exactEquals(H.left,f.edge.left)&&(f.fadeLeft=!1,C.fadeLeft=!1)});this._referenceLines.push(C)};n._createClass(v,[{key:"hints",get:function(){return[new u.LineSnappingHint(B.LineSegmentHintType.TARGET,this.constraint.start,this.targetPoint,this.isDraped,this.domain),new E.ParallelSnappingHint(this.constraint.start,this.targetPoint,this.isDraped,this.domain),...this._referenceLines.map(H=>new u.LineSnappingHint(B.LineSegmentHintType.REFERENCE,
H.edge.left,H.edge.right,this.isDraped,this.domain,H.fadeLeft,H.fadeRight))]}}]);return v}(d.SnappingCandidate);a.ParallelLineSnappingCandidate=d;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/ParallelSnappingHint":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/Logger ../../../../chunks/vec3 ../SnappingDomain ./SnappingHint".split(" "),function(a,n,b,z,p,w,A){b=function(B){function d(u,
E,y,v=w.SnappingDomain.ALL){y=B.call(this,y,v)||this;y.lineStart=u;y.lineEnd=E;return y}n._inherits(d,B);d.prototype.equals=function(u){return u instanceof d?p.exactEquals(this.lineStart,u.lineStart)&&p.exactEquals(this.lineEnd,u.lineEnd):!1};return n._createClass(d)}(A.SnappingHint);a.ParallelSnappingHint=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/RightAngleSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../support/elevationInfoUtils ./SnappingAlgorithm ./SnappingConstraint ./SnappingPoint ./snappingUtils ./candidates/RightAngleSnappingCandidate ../support/viewUtils".split(" "),
function(a,n,b,z,p,w,A,B,d,u,E,y,v){B=function(f){function l(){return f.apply(this,arguments)||this}n._inherits(l,f);var t=l.prototype;t.snapNewVertex=function(k,F){var e=F.editGeometryOperations.data.components[0],r=e.vertices.length;const q=[];if(2>r)return q;var {view:h}=this;const D=v.vectorToScreenPoint(k,F.spatialReference,A.absoluteHeightElevationInfo,h);var m=e.vertices[r-1];this.edgeExceedsShortLineThreshold(m.leftEdge,F)&&(r=u.anyMapPointToSnappingPoint(m.pos,h,F),m=u.anyMapPointToSnappingPoint(m.leftEdge.leftVertex.pos,
h,F),this._checkForSnappingCandidate(q,m,r,k,D,F));r=e.vertices[0];this.edgeExceedsShortLineThreshold(r.rightEdge,F)&&(e=u.anyMapPointToSnappingPoint(r.pos,h,F),h=u.anyMapPointToSnappingPoint(r.rightEdge.rightVertex.pos,h,F),this._checkForSnappingCandidate(q,h,e,k,D,F));return q};t.snapExistingVertex=function(k,F){const e=[];var r=F.vertexHandle;if(3>r.component.vertices.length)return e;var {view:q}=this;const h=v.vectorToScreenPoint(k,F.spatialReference,A.absoluteHeightElevationInfo,q);var D=r.leftEdge;
r=r.rightEdge;if(D&&D.leftVertex.leftEdge){var m=D.leftVertex.leftEdge;this.edgeExceedsShortLineThreshold(m,F)&&(D=u.anyMapPointToSnappingPoint(m.rightVertex.pos,q,F),m=u.anyMapPointToSnappingPoint(m.leftVertex.pos,q,F),this._checkForSnappingCandidate(e,m,D,k,h,F))}r&&r.rightVertex.rightEdge&&(D=r.rightVertex.rightEdge,this.edgeExceedsShortLineThreshold(D,F)&&(r=u.anyMapPointToSnappingPoint(D.leftVertex.pos,q,F),q=u.anyMapPointToSnappingPoint(D.rightVertex.pos,q,F),this._checkForSnappingCandidate(e,
q,r,k,h,F)));return e};t._checkForSnappingCandidate=function(k,F,e,r,q,h){const {spatialReference:D,pointer:m}=h;b.subtract(H,e,F);const c=p.set(C,H[1],-H[0],0),g=b.dot(c,b.subtract(H,r,e))/b.squaredLength(c);r=u.asSnappingPoint(b.scaleAndAdd(w.clone(r),e,c,g));E.squaredScreenDistance(q,v.vectorToScreenPoint(r,D,A.absoluteHeightElevationInfo,this.view))<this.squaredProximityThreshold(m)&&!this.isVertical(r,e)&&!this.isVertical(e,F)&&(q=p.scaleAndAdd(w.create(),e,c,Math.sign(g)),k.push(new y.RightAngleSnappingCandidate({targetPoint:r,
constraint:new d.VerticalHalfPlaneConstraint(e,u.asSnappingPoint(q)),previousVertex:F,otherVertex:e,otherVertexType:y.OtherVertexType.CENTER,isDraped:"on-the-ground"===h.elevationInfo?.mode})))};return n._createClass(l)}(B.SnappingAlgorithm);const H=z.create(),C=w.create();a.RightAngleSnapper=B;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/RightAngleTriangleSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../chunks/vec3f64 ../../../support/elevationInfoUtils ./SnappingAlgorithm ./SnappingPoint ./snappingUtils ./candidates/RightAngleTriangleSnappingCandidate ../support/viewUtils ../../support/geometry2dUtils".split(" "),
function(a,n,b,z,p,w,A,B,d,u,E,y){A=function(H){function C(){return H.apply(this,arguments)||this}n._inherits(C,H);var f=C.prototype;f.snapNewVertex=function(l,t){var k=t.editGeometryOperations.data.components[0];const F=[];var e=k.vertices.length;if("polygon"!==t.editGeometryOperations.data.type||2>e)return F;var {view:r}=this;e=k.vertices[e-1];k=B.anyMapPointToSnappingPoint(k.vertices[0].pos,r,t);r=B.anyMapPointToSnappingPoint(e.pos,r,t);this._processCandidateProposal(k,r,l,t,F);return F};f.snapExistingVertex=
function(l,t){const k=[];var F=t.vertexHandle,e=F.component;if(2>e.edges.length||"polyline"===t.editGeometryOperations.data.type&&(0===F.index||F.index===e.vertices.length-1))return k;const {view:r}=this;e=B.anyMapPointToSnappingPoint(F.leftEdge.leftVertex.pos,r,t);F=B.anyMapPointToSnappingPoint(F.rightEdge.rightVertex.pos,r,t);this._processCandidateProposal(e,F,l,t,k);return k};f._processCandidateProposal=function(l,t,k,F,e){if(this.exceedsShortLineThreshold(l,t,F)){var r=b.lerp(v,l,t,.5),q=.5*b.distance(l,
t),h=p.create();y.projectPointToCircle(h,k,r,q);h[2]=k[2];r=B.asSnappingPoint(h);var {spatialReference:D,pointer:m}=F;k=E.vectorToScreenPoint(k,D,w.absoluteHeightElevationInfo,this.view);d.squaredScreenDistance(k,E.vectorToScreenPoint(r,D,w.absoluteHeightElevationInfo,this.view))<this.squaredProximityThreshold(m)&&!this.isVertical(l,r)&&!this.isVertical(r,t)&&e.push(new u.RightAngleTriangleSnappingCandidate({targetPoint:r,point1:l,point2:t,isDraped:"on-the-ground"===F.elevationInfo?.mode}))}};return n._createClass(C)}(A.SnappingAlgorithm);
const v=z.create();a.RightAngleTriangleSnapper=A;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/RightAngleTriangleSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/vec2 ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../SnappingConstraint ../SnappingDomain ../SnappingPoint ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint ../hints/RightAngleSnappingHint".split(" "),
function(a,n,b,z,p,w,A,B,d,u,E,y){u=function(v){function H({targetPoint:C,point1:f,point2:l,isDraped:t}){C=v.call(this,C,new w.VerticalCylinderConstraint(B.asSnappingPoint(z.lerp(p.create(),f,l,.5)),.5*b.distance(f,l)),t,A.SnappingDomain.SELF)||this;C._p1=f;C._p2=l;return C}n._inherits(H,v);n._createClass(H,[{key:"hints",get:function(){return[new E.LineSnappingHint(d.LineSegmentHintType.REFERENCE,this.targetPoint,this._p1,this.isDraped,this.domain),new E.LineSnappingHint(d.LineSegmentHintType.REFERENCE,
this.targetPoint,this._p2,this.isDraped,this.domain),new y.RightAngleSnappingHint(this._p1,this.targetPoint,this._p2,this.isDraped,this.domain)]}}]);return H}(u.SnappingCandidate);a.RightAngleTriangleSnappingCandidate=u;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingOptions":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./FeatureSnappingLayerSource ./Settings".split(" "),
function(a,n,b,z,p,w,A,B,d,u,E){b=function(y){function v(H){H=y.call(this,H)||this;H.enabled=!1;H.enabledToggled=!1;H.selfEnabled=!0;H.featureEnabled=!0;H.featureSources=new z;H.distance=E.defaults.distance;H.touchSensitivityMultiplier=E.defaults.touchSensitivityMultiplier;return H}a._inherits(v,y);a._createClass(v,[{key:"effectiveEnabled",get:function(){return this.enabledToggled?!this.enabled:this.enabled}},{key:"effectiveSelfEnabled",get:function(){return this.effectiveEnabled&&this.selfEnabled}},
{key:"effectiveFeatureEnabled",get:function(){return this.effectiveEnabled&&this.featureEnabled}}]);return v}(b);n.__decorate([p.property()],b.prototype,"enabled",void 0);n.__decorate([p.property()],b.prototype,"enabledToggled",void 0);n.__decorate([p.property()],b.prototype,"selfEnabled",void 0);n.__decorate([p.property()],b.prototype,"featureEnabled",void 0);n.__decorate([p.property({type:z.ofType(u)})],b.prototype,"featureSources",void 0);n.__decorate([p.property()],b.prototype,"distance",void 0);
n.__decorate([p.property()],b.prototype,"touchSensitivityMultiplier",void 0);n.__decorate([p.property({readOnly:!0})],b.prototype,"effectiveEnabled",null);n.__decorate([p.property({readOnly:!0})],b.prototype,"effectiveSelfEnabled",null);n.__decorate([p.property({readOnly:!0})],b.prototype,"effectiveFeatureEnabled",null);return b=n.__decorate([d.subclass("esri.views.interactive.snapping.SnappingOptions")],b)})},"esri/views/interactive/snapping/FeatureSnappingLayerSource":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,n,b,z,p,w,A,B){b=function(d){function u(E){E=d.call(this,E)||this;E.layer=null;E.enabled=!0;E.updating=!1;E.availability=1;return E}a._inherits(u,d);return a._createClass(u)}(b);n.__decorate([z.property({constructOnly:!0})],b.prototype,"layer",void 0);n.__decorate([z.property()],b.prototype,"enabled",void 0);n.__decorate([z.property()],b.prototype,"updating",void 0);n.__decorate([z.property()],b.prototype,"availability",void 0);return b=n.__decorate([B.subclass("esri.views.interactive.snapping.FeatureSnappingLayerSource")],
b)})},"esri/views/interactive/snapping/candidates/IntersectionSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../SnappingConstraint ../SnappingDomain ./SnappingCandidate ../hints/IntersectionSnappingHint".split(" "),function(a,n,b,z,p,w){p=function(A){function B(d,u,E,y){d=A.call(this,d,new b.IntersectionConstraint(d,u.constraint,E.constraint),y,z.SnappingDomain.ALL)||this;d.first=u;d.second=E;return d}n._inherits(B,A);n._createClass(B,[{key:"hints",get:function(){this.first.targetPoint=
this.targetPoint;this.second.targetPoint=this.targetPoint;return[...this.first.hints,...this.second.hints,new w.IntersectionSnappingHint(this.targetPoint,this.isDraped,this.domain)]}}]);return B}(p.SnappingCandidate);a.IntersectionSnappingCandidate=p;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/IntersectionSnappingHint":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/vec3","../SnappingDomain",
"./SnappingHint"],function(a,n,b,z,p){p=function(w){function A(B,d,u=z.SnappingDomain.ALL){d=w.call(this,d,u)||this;d.intersectionPoint=B;return d}n._inherits(A,w);A.prototype.equals=function(B){return B instanceof A?b.exactEquals(this.intersectionPoint,B.intersectionPoint):!1};return n._createClass(A)}(p.SnappingHint);a.IntersectionSnappingHint=p;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/hitTestSelectUtils":function(){define(["exports"],function(a){function n(b){return"graphic"===
b?.type}a.filterGraphicHits=function(b){return b.filter(n)};a.findFirstGraphicHit=function(b){return b.find(n)??null};a.hitTestSelectSimilarDistance=async function(b,z){if("2d"===b.type)return b.hitTest(z);b=await b.hitTest(z);if(0===b.results.length)return b;const p=1.05*(b.results[0].distance??0);z=b.results.findIndex(w=>(w.distance??0)>p);-1!==z&&(b.results=b.results.slice(0,z));return b};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Sketch/support/OperationHandle":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/compilerUtils ../../../core/Evented ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,n,b,z,p,w,A,B,d){a.OperationHandle=function(u){function E(v){v=u.call(this,v)||this;v.cancelled=!1;v.history={undo:[],redo:[]};v.type=null;return v}n._inherits(E,u);var y=E.prototype;y.addToHistory=function(v){this.history.redo=[];this.history.undo.push(v)};y.resetHistory=function(){this.history.redo=[];this.history.undo=[]};y.canUndo=function(){return 0<this.history.undo.length};y.canRedo=function(){return 0<this.history.redo.length};y.complete=function(){this._reset();this.onEnd();this.emit("complete")};
y.cancel=function(){this.cancelled=!0;this.complete()};y._reset=function(){this.activeComponent?.reset()};y.refreshComponent=function(){const v=this.activeComponent;v&&("box"!==v.type&&"reshape"!==v.type&&"graphic-mover"!==v.type||v.refresh())};n._createClass(E,[{key:"tool",get:function(){if(!this.activeComponent)return null;switch(this.activeComponent.type){case "graphic-mover":case "move-3d":return"move";case "box":case "transform-3d":return"transform";case "reshape":case "reshape-3d":return"reshape";
case "draw-2d":case "draw-3d":return this.activeComponent.geometryType;default:z.neverReached(this.activeComponent)}return null}},{key:"undo",set:function(v){this._set("undo",()=>{this.canUndo()&&v()})}},{key:"redo",set:function(v){this._set("redo",()=>{this.canRedo()&&v()})}}]);return E}(p.EventedAccessor);b.__decorate([w.property()],a.OperationHandle.prototype,"activeComponent",void 0);b.__decorate([w.property()],a.OperationHandle.prototype,"cancelled",void 0);b.__decorate([w.property()],a.OperationHandle.prototype,
"history",void 0);b.__decorate([w.property()],a.OperationHandle.prototype,"tool",null);b.__decorate([w.property()],a.OperationHandle.prototype,"type",void 0);b.__decorate([w.property()],a.OperationHandle.prototype,"canUndo",null);b.__decorate([w.property()],a.OperationHandle.prototype,"canRedo",null);b.__decorate([w.property()],a.OperationHandle.prototype,"onEnd",void 0);b.__decorate([w.property()],a.OperationHandle.prototype,"undo",null);b.__decorate([w.property()],a.OperationHandle.prototype,"redo",
null);b.__decorate([w.property()],a.OperationHandle.prototype,"toggleTool",void 0);b.__decorate([w.property()],a.OperationHandle.prototype,"addToSelection",void 0);b.__decorate([w.property()],a.OperationHandle.prototype,"removeFromSelection",void 0);a.OperationHandle=b.__decorate([d.subclass("esri.widgets.Sketch.support.OperationHandle")],a.OperationHandle);a.CreateOperationHandle=function(u){function E(){return u.apply(this,arguments)||this}n._inherits(E,u);return n._createClass(E)}(a.OperationHandle);
b.__decorate([w.property()],a.CreateOperationHandle.prototype,"activeComponent",void 0);a.CreateOperationHandle=b.__decorate([d.subclass("esri.widgets.Sketch.support.CreateOperationHandle")],a.CreateOperationHandle);a.UpdateOperationHandle=function(u){function E(){return u.apply(this,arguments)||this}n._inherits(E,u);return n._createClass(E)}(a.OperationHandle);b.__decorate([w.property()],a.UpdateOperationHandle.prototype,"activeComponent",void 0);a.UpdateOperationHandle=b.__decorate([d.subclass("esri.widgets.Sketch.support.UpdateOperationHandle")],
a.UpdateOperationHandle);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/SelectionToolbar":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/handleUtils ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../Widget ./componentsUtils ./widgetUtils ./decorators/messageBundle ./jsxFactory ./SelectionToolbar/SelectionToolbarViewModel".split(" "),
function(a,n,b,z,p,w,A,B,d,u,E,y,v,H,C,f){const l={lassoTool:!0,rectangleTool:!0},t={createTool:"polygon",createOptions:{mode:"freehand"}},k={createTool:"rectangle"};B=function(F){function e(q,h){var D=F.call(this,q,h)||this;D._viewModelHandlesGroup=null;D.activeToolInfo=null;D.messages=null;D.toolConfigs=[];D.viewModel=new f;D.visibleElements={...l};D._viewModelHandlesGroup=z.handlesGroup([D.viewModel.on("selection-change",m=>D.emit("selection-change",m)),D.viewModel.on("complete",m=>{D._set("activeToolInfo",
null);D.emit("complete",m)})]);return D}n._inherits(e,F);var r=e.prototype;r.destroy=function(){this._viewModelHandlesGroup=p.removeMaybe(this._viewModelHandlesGroup)};r.loadDependencies=function(){return y.loadCalciteComponents({action:()=>new Promise((q,h)=>a(["../../chunks/calcite-action"],q,h)),icon:()=>new Promise((q,h)=>a(["../../chunks/calcite-icon"],q,h))})};r.castVisibleElements=function(q){return{...l,...q}};r.activate=function(q){this.cancel();switch(q){case "lasso":this._activateTool("lasso");
break;case "rectangle":this._activateTool("rectangle");break;default:this._activateTool(q)}};r.cancel=function(){this.viewModel.cancel();this._set("activeToolInfo",null)};r.render=function(){return C.tsx("div",{"aria-label":this.label,class:this.classes("esri-selection-toolbar","esri-widget")},C.tsx("div",{class:"esri-selection-toolbar__container"},this.renderDefaultTools(),this.renderCustomTools()))};r.renderDefaultTools=function(){if("2d"===this.view?.type)return[this.renderRectangleTool(),this.renderLassoTool()]};
r.renderCustomTools=function(){if(this.toolConfigs&&this.toolConfigs.length)return this.toolConfigs.map(q=>C.tsx("calcite-action",{active:this.activeToolInfo?.toolName===q.toolName,bind:this,class:"esri-selection-toolbar__tool-button",label:q.toolName,onclick:()=>this._onCustomToolClick(q.toolName),scale:"s",text:q.toolName,title:q.toolName},C.tsx("calcite-icon",{scale:"s",icon:q.icon||"selection"})))};r.renderLassoTool=function(){const {activeToolInfo:q,messages:h,visibleElements:D}=this;if(D.lassoTool)return C.tsx("calcite-action",
{active:"lasso"===q?.toolName,bind:this,label:h.selectByLasso,onclick:this._onLassoToolClick,scale:"s",text:h.selectByLasso,title:h.selectByLasso},C.tsx("calcite-icon",{scale:"s",icon:"lasso-select"}))};r.renderRectangleTool=function(){const {activeToolInfo:q,messages:h,visibleElements:D}=this;if(D.rectangleTool)return C.tsx("calcite-action",{active:"rectangle"===q?.toolName,bind:this,label:h.selectByRectangle,onclick:this._onRectangleToolClick,scale:"s",text:h.selectByRectangle,title:h.selectByRectangle},
C.tsx("calcite-icon",{scale:"s",icon:"cursor-marquee"}))};r._onCustomToolClick=function(q){this._toggleTool(q)};r._onLassoToolClick=function(){this._toggleTool("lasso")};r._onRectangleToolClick=function(){this._toggleTool("rectangle")};r._activateTool=function(q){var h=this._getToolOptions(q);h&&(h=this.viewModel.activate(h))&&this._set("activeToolInfo",{toolName:q,operation:h})};r._toggleTool=function(q){if(this.activeToolInfo){const h=this.activeToolInfo.toolName;this.cancel();if(h===q)return}this._activateTool(q)};
r._getToolOptions=function(q){if("lasso"===q)return t;if("rectangle"===q)return k;const h=this.toolConfigs.find(g=>g.toolName===q);if(h){var {createTool:D,createOptions:m,selectionOptions:c}=h;return{createTool:D,createOptions:m,selectionOptions:c}}};n._createClass(e,[{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(q){this._overrideIfSome("label",q)}},{key:"layers",get:function(){return this.viewModel.layers},set:function(q){this.viewModel.layers=q}},{key:"view",get:function(){return this.viewModel.view},
set:function(q){this.viewModel.view=q}}]);return e}(E);b.__decorate([w.property({readOnly:!0})],B.prototype,"activeToolInfo",void 0);b.__decorate([w.property()],B.prototype,"label",null);b.__decorate([w.property()],B.prototype,"layers",null);b.__decorate([w.property(),H.messageBundle("esri/widgets/support/SelectionToolbar/t9n/SelectionToolbar")],B.prototype,"messages",void 0);b.__decorate([w.property()],B.prototype,"toolConfigs",void 0);b.__decorate([w.property()],B.prototype,"view",null);b.__decorate([w.property()],
B.prototype,"viewModel",void 0);b.__decorate([w.property()],B.prototype,"visibleElements",void 0);b.__decorate([A.cast("visibleElements")],B.prototype,"castVisibleElements",null);return B=b.__decorate([u.subclass("esri.widgets.support.SelectionToolbar")],B)})},"esri/widgets/support/SelectionToolbar/SelectionToolbarViewModel":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Evented ../../../core/handleUtils ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../Selector2D".split(" "),
function(a,n,b,z,p,w,A,B,d,u,E){b=function(y){function v(C){C=y.call(this,C)||this;C._operationHandlesGroup=null;C.activeOperation=null;C.layers=null;C.selector=new E;return C}a._inherits(v,y);var H=v.prototype;H.destroy=function(){this._operationHandlesGroup=p.removeMaybe(this._operationHandlesGroup);this.selector.destroy()};H.cancel=function(){"active"===this.state&&(this.activeOperation?.cancel(),this.activeOperation=null);this.selector.candidates=null};H.activate=function(C){const {state:f}=this;
if("disabled"!==f)return"active"===f&&this.cancel(),this.selector.candidates=this._candidates,C=this.selector.draw(C),this._operationHandlesGroup=z.handlesGroup([C.once("complete",l=>this._onOperationComplete(l)),C.on("selection-change",l=>this._onOperationSelectionChange(l))]),this.activeOperation=C};H._onOperationSelectionChange=function(C){this.emit("selection-change",C)};H._onOperationComplete=function(C){this._operationHandlesGroup=p.removeMaybe(this._operationHandlesGroup);this.activeOperation=
null;this.emit("complete",C)};a._createClass(v,[{key:"_candidates",get:function(){return this.layers?.flatMap(C=>C.graphics.toArray())??[]}},{key:"state",get:function(){return this.activeOperation?"active":this.view?.ready&&this.layers?.length?"ready":"disabled"}},{key:"view",set:function(C){this.selector.view=C;this._set("view",C)}}]);return v}(b.EventedAccessor);n.__decorate([w.property()],b.prototype,"_candidates",null);n.__decorate([w.property()],b.prototype,"activeOperation",void 0);n.__decorate([w.property()],
b.prototype,"layers",void 0);n.__decorate([w.property({readOnly:!0})],b.prototype,"selector",void 0);n.__decorate([w.property({readOnly:!0})],b.prototype,"state",null);n.__decorate([w.property()],b.prototype,"view",null);return b=n.__decorate([u.subclass("esri.widgets.support.SelectionToolbar.SelectionToolbarViewModel")],b)})},"esri/widgets/support/Selector2D":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Collection ../../core/HandleOwner ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./Selector2D/SelectionOperation2D ./Selector2D/selectorUtils".split(" "),
function(a,n,b,z,p,w,A,B,d,u,E,y){b=function(v){function H(f){f=v.call(this,f)||this;f._defaultSelectionOptions={intersects:!0,overlaps:!0,contains:!0};f.candidates=null;f.options=null;f.view=null;return f}a._inherits(H,v);var C=H.prototype;C.draw=function(f){const {_defaultSelectionOptions:l,candidates:t,options:k,view:F}=this;return new E({candidates:t,options:{...f,selectionOptions:{...l,...k,...f?.selectionOptions}},view:F})};C.selectionFrom=async function(f,l){const {_defaultSelectionOptions:t,
candidates:k,options:F,view:e}=this,r=new z;await y.updateSelection({selector:f,candidates:k,currentSelection:r,options:{...t,...F,...l},view:e});return r.toArray()};return a._createClass(H)}(p.HandleOwnerMixin(b));n.__decorate([w.property()],b.prototype,"candidates",void 0);n.__decorate([w.property()],b.prototype,"options",void 0);n.__decorate([w.property({value:null})],b.prototype,"view",void 0);return b=n.__decorate([u.subclass("esri.widgets.support.Selector2D")],b)})},"esri/widgets/support/Selector2D/SelectionOperation2D":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../symbols ../../../core/Collection ../../../core/Evented ../../../core/Handles ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../layers/GraphicsLayer ../../Sketch/SketchViewModel ./selectorUtils ../../../symbols/SimpleFillSymbol ../../../symbols/SimpleLineSymbol ../../../symbols/SimpleMarkerSymbol".split(" "),
function(a,n,b,z,p,w,A,B,d,u,E,y,v,H,C,f,l,t){b=function(k){function F({candidates:r,options:q,view:h}){var D=k.call(this)||this;D._activeOptions=null;D._dashedFillSymbol=new f({color:[0,0,0,0],outline:{style:"dash",color:[12,207,255],width:2}});D._dashedLineSymbol=new l({style:"dash",color:[12,207,255],width:2});D._defaultOptions={createTool:"rectangle",createOptions:void 0,selectionOptions:{overlaps:!0,intersects:!0,contains:!1}};D._completed=!1;D._handles=new w;D._sketchViewModel=new H;D._sketchGraphicsLayer=
new v({listMode:"hide",internal:!0});D._transparentPointSymbol=new t({color:[0,0,0,0],outline:{style:"none",width:0}});D.candidates=null;D.geometry=null;D.options=null;D.selection=new z;D.view=null;D.candidates=r;D.options=q;D.view=h;const {_dashedFillSymbol:m,_dashedLineSymbol:c,_sketchViewModel:g,_sketchGraphicsLayer:G,_transparentPointSymbol:K}=a._assertThisInitialized(D);g.set({layer:G,view:D.view,activePointSymbol:K,activeLineSymbol:c,activeVertexSymbol:K,activeFillSymbol:m,pointSymbol:K,polygonSymbol:m,
polylineSymbol:c,vertexSymbol:K});D._handles.add([g.on("create",L=>D._onSketchEvent(L)),g.on(["undo","redo"],L=>D._onSketchEvent(L))]);return D}a._inherits(F,k);var e=F.prototype;e.initialize=function(){this._load()};e.destroy=function(){this._handles=A.destroyMaybe(this._handles)};e.cancel=function(){return this._sketchViewModel.cancel()};e._load=async function(){await this.view?.whenReady();const {options:r}=this,{createTool:q,createOptions:h}=this._activeOptions={...this._defaultOptions,...r};
this._sketchViewModel.create(q,h)};e._onSketchEvent=function(r){this._processSelectionGeometry(("create"===r.type?r.graphic:r.graphics[0])?.geometry||null,"create"===r.type&&"complete"===r.state,"create"===r.type&&"cancel"===r.state)};e._processSelectionGeometry=function(r,q,h){this._set("geometry",r);if(q||h)this._completed=!0;if(h)this._onComplete([],!0);else{var {_activeOptions:D,candidates:m,selection:c,view:g}=this;C.updateSelection({selector:r,candidates:m,currentSelection:c,options:D.selectionOptions,
view:g}).then(({added:G,removed:K})=>{q?this._onComplete(this.selection.toArray(),!1):(G.length||K.length)&&this.emit("selection-change",{added:G,removed:K,type:"selection-change"})})}};e._onComplete=function(r,q){this._handles.removeAll();this.notifyChange("state");this.emit("complete",{aborted:q,selection:r,type:"complete"})};a._createClass(F,[{key:"state",get:function(){const {_completed:r,_sketchViewModel:{state:q}}=this;return r?"complete":"active"===q?"active":"disabled"}}]);return F}(p.EventedAccessor);
n.__decorate([B.property()],b.prototype,"_completed",void 0);n.__decorate([B.property()],b.prototype,"candidates",void 0);n.__decorate([B.property({readOnly:!0})],b.prototype,"geometry",void 0);n.__decorate([B.property()],b.prototype,"options",void 0);n.__decorate([B.property({readOnly:!0})],b.prototype,"selection",void 0);n.__decorate([B.property({readOnly:!0})],b.prototype,"state",null);n.__decorate([B.property({value:null})],b.prototype,"view",void 0);return b=n.__decorate([y.subclass("esri.widgets.support.Selector2D.SelectionOperation2D")],
b)})},"esri/widgets/support/Selector2D/selectorUtils":function(){define(["require","exports"],function(a,n){async function b(){return new Promise((p,w)=>a(["../../../geometry/geometryEngineJSON"],p,w))}async function z(){return b().then(({contains:p,intersects:w,overlaps:A,simplify:B})=>({contains:p,intersects:w,overlaps:A,simplify:B}))}n.getGeometryEngineOperations=z;n.importGeometryEngine=b;n.updateSelection=async function(p){const {selector:w,candidates:A,currentSelection:B,options:d,view:u}=p;
if(!(A&&A.length&&B&&u&&d))return{added:[],removed:[]};const {overlaps:E,intersects:y,contains:v}=d,{spatialReference:H}=u;if(!w)return{added:[],removed:B.removeAll()};const C=await z(),f=[],l=[];A.forEach(t=>{var k=t.geometry;const F=E&&!!C.overlaps(H,w,k),e=y&&!!C.intersects(H,w,k);k=v&&!!C.contains(H,w,k);const r=B.includes(t);F||e||k?!r&&f.push(t):r&&l.push(t)});B.removeMany(l);B.addMany(f);return{added:f,removed:l}};Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/SnappingControls":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/arrayUtils ../../core/maybe ../../core/uid ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/has ../../core/accessorSupport/decorators/subclass ../Widget ./componentsUtils ./widgetUtils ./decorators/messageBundle ./jsxFactory ./SnappingControls/SnappingControlsViewModel".split(" "),
function(a,n,b,z,p,w,A,B,d,u,E,y,v,H,C,f){const l={header:!0,enabledToggle:!0,selfEnabledToggle:!0,featureEnabledToggle:!0,layerList:!0,layerListToggleLayersButton:!0};d=function(t){function k(e,r){var q=t.call(this,(()=>{const {view:h,viewModel:D,snappingOptions:m,...c}=e;return c})(),r)||this;q._defaultViewModel=null;q._layerListFilter=null;q.iconClass="esri-icon-vertex-gps";q.icon=null;q.layerListOpen=!0;q.messages=null;q.visibleElements={...l};q._onToggleLayersButtonClick=h=>{q.viewModel.toggleSnappingForAllLayers(!q.viewModel.allLayersEnabled);
requestAnimationFrame(()=>h.target.setFocus())};e?.viewModel?q.viewModel=e.viewModel:(q._defaultViewModel=new f({snappingOptions:e.snappingOptions,view:e.view}),q.viewModel=q._defaultViewModel);return q}n._inherits(k,t);var F=k.prototype;F.destroy=function(){this._defaultViewModel=p.destroyMaybe(this._defaultViewModel)};F.loadDependencies=function(){return y.loadCalciteComponents({accordion:()=>new Promise((e,r)=>a(["../../chunks/calcite-accordion"],e,r)),"accordion-item":()=>new Promise((e,r)=>a(["../../chunks/calcite-accordion-item"],
e,r)),action:()=>new Promise((e,r)=>a(["../../chunks/calcite-action"],e,r)),block:()=>new Promise((e,r)=>a(["../../chunks/calcite-block"],e,r)),button:()=>new Promise((e,r)=>a(["../../chunks/calcite-button"],e,r)),icon:()=>new Promise((e,r)=>a(["../../chunks/calcite-icon"],e,r)),input:()=>new Promise((e,r)=>a(["../../chunks/calcite-input"],e,r)),label:()=>new Promise((e,r)=>a(["../../chunks/calcite-label"],e,r)),list:()=>new Promise((e,r)=>a(["../../chunks/calcite-list"],e,r)),"list-item":()=>new Promise((e,
r)=>a(["../../chunks/calcite-list-item"],e,r)),panel:()=>new Promise((e,r)=>a(["../../chunks/calcite-panel"],e,r)),switch:()=>new Promise((e,r)=>a(["../../chunks/calcite-switch"],e,r))})};F.castVisibleElements=function(e){return{...l,...e}};F.render=function(){const {label:e,visibleElements:{header:r}}=this;return C.tsx("div",{"aria-label":e,class:this.classes("esri-snapping-controls","esri-widget")},C.tsx("div",{class:"esri-snapping-controls__container"},r?this._renderHeaderView():this._renderContent()))};
F._renderHeaderView=function(){return C.tsx("calcite-panel",{heading:this.label,class:"esri-snapping-controls__panel"},this._renderContent())};F._renderContent=function(){return[this._renderToggles(),this._renderLayerList()]};F._renderToggles=function(){const {visibleElements:{enabledToggle:e,selfEnabledToggle:r,featureEnabledToggle:q}}=this;return e||r||q?C.tsx("calcite-block",{class:"esri-snapping-controls__toggle-block",key:"toggle-block",heading:"",open:!0},this._renderEnabledToggle(),C.tsx("div",
{class:"esri-snapping-controls__nested-container"},this._renderSelfEnabledToggle(),this._renderFeatureEnabledToggle())):null};F._renderEnabledToggle=function(){if(!this.visibleElements.enabledToggle)return null;const {messages:{enableSnapping:e},viewModel:{snappingOptions:{enabled:r,enabledToggled:q}}}=this;return C.tsx("calcite-label",{layout:"inline-space-between"},e,C.tsx("calcite-switch",{checked:r,disabled:q,bind:this,onCalciteSwitchChange:this._enableSnappingSwitchChange}))};F._renderSelfEnabledToggle=
function(){if(!this.visibleElements.selfEnabledToggle)return null;const {messages:{geometryGuides:e},viewModel:{snappingOptions:{enabled:r,selfEnabled:q,enabledToggled:h}}}=this;return C.tsx("calcite-label",{layout:"inline-space-between",key:"self-enabled-toggle"},e,C.tsx("calcite-switch",{checked:q,disabled:h||!r,bind:this,onCalciteSwitchChange:this._selfEnabledSwitchChange}))};F._renderFeatureEnabledToggle=function(){if(!this.visibleElements.featureEnabledToggle)return null;const {messages:{featureToFeature:e},
viewModel:{snappingOptions:{enabled:r,featureEnabled:q,enabledToggled:h}}}=this;return C.tsx("calcite-label",{layout:"inline-space-between",key:"feature-enabled-toggle"},e,C.tsx("calcite-switch",{checked:q,disabled:h||!r,bind:this,onCalciteSwitchChange:this._featureEnabledSwitchChange}))};F._renderLayerList=function(){if(!this.visibleElements.layerList)return null;const {messages:e,viewModel:r}=this,{snappingOptions:{enabled:q,enabledToggled:h}}=r;var D=({target:{value:c}})=>this._layerListFilter=
""===c?null:new RegExp(c,"i");D=9<r.layerListViewModel.operationalItems.length?C.tsx("calcite-input",{class:"esri-snapping-controls__layer-list__filter",clearable:!0,placeholder:e?.searchLayers,onCalciteInputInput:D}):null;const m=h||!q;return C.tsx("calcite-block",{key:"list-block",heading:e.snappingLayers,disabled:m,class:"esri-snapping-controls__layer-list-block",collapsible:!0,open:this.layerListOpen&&!m,onCalciteBlockToggle:c=>this.layerListOpen=c.target.open},D,this._renderToggleLayersButton(),
C.tsx("calcite-list",{class:"esri-snapping-controls__layer-list"},this._renderLayerListItemCollection(r.layerListViewModel.operationalItems,this._layerListFilter)))};F._renderLayerListItemCollection=function(e,r){return e.map(q=>{if(r?this._itemTitleMatchesFilter(q,r):1)return 0<q.children.length?this._renderLayerListItemGroup(q):this._renderLayerListItem(q);const h=q.children.filter(D=>this._itemTitleMatchesFilter(D,r));return 0<h.length?this._renderLayerListItemGroup(q,h):null}).toArray().filter(z.isSome)};
F._renderToggleLayersButton=function(){if(!this.visibleElements.layerListToggleLayersButton)return null;const {viewModel:{allLayersEnabled:e},messages:r}=this,q=e?r.disableAllLayers:r.enableAllLayers;return C.tsx("calcite-button",{appearance:"transparent",class:"esri-snapping-controls__layer-list__button",label:q,name:"layer-toggle",scale:"m",onclick:this._onToggleLayersButtonClick},q)};F._renderLayerListItem=function(e){const {messages:{untitledLayer:r}}=this,q=e.enabled;return C.tsx("calcite-list-item",
{class:"esri-snapping-controls__layer-list__item",label:e.title||r,key:`${this.id}-list-item-${e.uid}`,onCalciteListItemSelect:()=>{this._handleLayerListItemChange({checked:!q,value:e.layer.id})}},C.tsx("calcite-icon",{icon:q?"check-square-f":"square",slot:"content-start",scale:"s"}))};F._renderLayerListItemGroup=function(e,r){const {allChildrenEnabled:q,children:h,hasChildrenEnabled:D,title:m}=e,c=this.messages,g=m||c.untitledLayer,G=m&&""!==m?m:w.generateUID(),K=r??h;return C.tsx("calcite-list-item",
{class:"esri-snapping-controls__layer-list__item",key:G},C.tsx("calcite-accordion",{class:"esri-snapping-controls__layer-list__group",appearance:"transparent"},C.tsx("calcite-accordion-item",{expanded:!!r,heading:g,key:e.uid},C.tsx("calcite-action",{scale:"m",slot:"actions-start",text:q?c.disableAllLayers:c.enableAllLayers,textEnabled:!1,onclick:()=>{this.viewModel.toggleSnappingForLayers(e.childLayerIds,!q)}},C.tsx("calcite-icon",{icon:q?"check-square-f":D?"minus-square":"square",scale:"s"})),C.tsx("calcite-list",
null,[...this._renderLayerListItemCollection(K)]))))};F._enableSnappingSwitchChange=function(e){this.snappingOptions.enabled=e.target.checked};F._featureEnabledSwitchChange=function(e){this.snappingOptions.featureEnabled=e.target.checked};F._itemTitleMatchesFilter=function(e,r){return null!=r&&r.test(e.title)};F._selfEnabledSwitchChange=function(e){this.snappingOptions.selfEnabled=e.target.checked};F._handleLayerListItemChange=async function(e){e.checked?this.viewModel.enableSnappingForLayer(e.value):
this.viewModel.disableSnappingForLayer(e.value)};n._createClass(k,[{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(e){this._overrideIfSome("label",e)}},{key:"snappingOptions",get:function(){return this.viewModel.snappingOptions},set:function(e){this.viewModel.snappingOptions=e}},{key:"view",get:function(){return this.viewModel.view},set:function(e){this.viewModel.view=e}},{key:"viewModel",set:function(e){if(e!==this._get("viewModel")){if(null==this._defaultViewModel||
this._defaultViewModel!==e)this._defaultViewModel=p.destroyMaybe(this._defaultViewModel);this._set("viewModel",e)}}}]);return k}(E);b.__decorate([A.property()],d.prototype,"_defaultViewModel",void 0);b.__decorate([A.property()],d.prototype,"_layerListFilter",void 0);b.__decorate([A.property()],d.prototype,"iconClass",void 0);b.__decorate([A.property()],d.prototype,"icon",void 0);b.__decorate([A.property()],d.prototype,"label",null);b.__decorate([A.property()],d.prototype,"layerListOpen",void 0);b.__decorate([A.property(),
H.messageBundle("esri/widgets/support/SnappingControls/t9n/SnappingControls")],d.prototype,"messages",void 0);b.__decorate([A.property()],d.prototype,"snappingOptions",null);b.__decorate([A.property()],d.prototype,"view",null);b.__decorate([A.property()],d.prototype,"viewModel",null);b.__decorate([A.property()],d.prototype,"visibleElements",void 0);b.__decorate([B.cast("visibleElements")],d.prototype,"castVisibleElements",null);return d=b.__decorate([u.subclass("esri.widgets.support.SnappingControls")],
d)})},"esri/widgets/support/SnappingControls/SnappingControlsViewModel":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Error ../../../core/HandleOwner ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../views/interactive/snapping/FeatureSnappingLayerSource ../../LayerList/support/layerListUtils ./SnappingLayerListViewModel".split(" "),
function(a,n,b,z,p,w,A,B,d,u,E,y,v,H){b=function(C){function f(t){t=C.call(this,t)||this;t.layerListViewModel=new H.SnappingLayerListViewModel;t.snappingOptions=null;t.view=null;return t}a._inherits(f,C);var l=f.prototype;l.initialize=function(){this.handles.add([w.watch(()=>({viewModel:this.layerListViewModel,view:this.view}),({viewModel:t,view:k})=>{t.view=k},w.initial),w.watch(()=>({viewModel:this.layerListViewModel,sources:this.snappingOptions?.featureSources}),({viewModel:t,sources:k})=>{t.featureSnappingSources=
k},w.initial)])};l.toggleSnappingForLayers=function(t,k){t?.forEach(F=>k?this.enableSnappingForLayer(F):this.disableSnappingForLayer(F))};l.toggleSnappingForAllLayers=function(t){this.layerListViewModel.selectableItems.forEach(({layer:{id:k}})=>{t?this.enableSnappingForLayer(k):this.disableSnappingForLayer(k)})};l.enableSnappingForLayer=function(t){(this._findSnappingSourceForLayer(t)??this._makeSnappingSourceForLayer(t)).enabled=!0};l.disableSnappingForLayer=function(t){if(t=this._findSnappingSourceForLayer(t))t.enabled=
!1};l.updateEnabledFeatureSources=function(t){for(const k of this.snappingOptions.featureSources)v.canDisplayLayer(k.layer)&&(k.enabled=t.includes(k.layer.id))};l._findSnappingSourceForLayer=function(t){return this.snappingOptions.featureSources.find(k=>k.layer.id===t)};l._makeSnappingSourceForLayer=function(t){var k=this.layerListViewModel.operationalItemsFlat.find(F=>F.layer.id===t)?.layer;if(!k)throw new z("snapping-controls:layer-not-found",`cannot enable snapping for layer with id ${t} because no such layer was found in the view`);
k=new y({layer:k});this.snappingOptions.featureSources.add(k);return k};a._createClass(f,[{key:"allLayersEnabled",get:function(){return(this.layerListViewModel?.selectableItems??[]).every(t=>t.enabled)}},{key:"allLayersDisabled",get:function(){return(this.layerListViewModel?.selectableItems??[]).every(t=>!t.enabled)}},{key:"layersEnabledCount",get:function(){return this.layerListViewModel?.selectableItems?.filter(t=>t.enabled).length??0}},{key:"state",get:function(){return this.get("snappingOptions")?
"ready":"disabled"}}]);return f}(p.HandleOwnerMixin(b));n.__decorate([A.property()],b.prototype,"allLayersEnabled",null);n.__decorate([A.property()],b.prototype,"allLayersDisabled",null);n.__decorate([A.property({constructOnly:!0})],b.prototype,"layerListViewModel",void 0);n.__decorate([A.property()],b.prototype,"layersEnabledCount",null);n.__decorate([A.property()],b.prototype,"snappingOptions",void 0);n.__decorate([A.property()],b.prototype,"state",null);n.__decorate([A.property()],b.prototype,
"view",void 0);return b=n.__decorate([E.subclass("esri.widgets.support.SnappingControls.SnappingControlsViewModel")],b)})},"esri/widgets/LayerList/support/layerListUtils":function(){define(["exports"],function(a){function n(d){if(d)return null!=d.listMode?d.listMode:void 0}function b(d){if(d)return null!=d.minScale?d.minScale:void 0}function z(d){if(d)return null!=d.maxScale?d.maxScale:void 0}function p(d){if(d&&!("type"in d&&"wmts"===d.type)&&d.listMode!==B.hideChildren)return"sublayers"in d?"sublayers":
"layers"in d?"layers":void 0}function w(d,u){d&&d.sort((E,y)=>{E=u.indexOf(E.uid);y=u.indexOf(y.uid);return E>y?-1:E<y?1:0})}function A(d){return!!d?.layer}const B={hide:"hide",hideChildren:"hide-children"};a.canDisplayLayer=function(d){return n(d)!==B.hide};a.canSortSublayers=function(d){d=d&&(d.get("layer.layer")||d.layer);if(!d)return!1;d=d.get("capabilities.exportMap.supportsDynamicLayers");return"boolean"===typeof d?d:!0};a.findLayerListMode=n;a.findLayerMaxScale=z;a.findLayerMinScale=b;a.findLayerVisibilityMode=
function(d){if(!d)return"inherited";var u=d.get("layer.capabilities.exportMap.supportsSublayerVisibility");if("boolean"===typeof u)return u?"independent":"inherited";u=d.get("capabilities.exportMap.supportsSublayerVisibility");return"boolean"===typeof u?u?"independent":"inherited":null!=d.visibilityMode?d.visibilityMode:"independent"};a.findSelectedItem=function(d,u){const E=d.layer?.uid;return null!=E?u.find(y=>y.layer?.uid===E):null};a.getItemLayers=function(d){return(d=d?.layer)&&"layers"in d?
d.layers:null};a.getLegendLayerInfo=function(d){var u=A(d)?d:null;const E=d?.parent;return(u="map-image"===E?.type?u?.source:null)&&E?{layer:E,title:"",sublayerIds:[u.mapLayerId]}:{layer:d,title:""}};a.getNormalizedChildLayerProperty=p;a.isLayerOutsideScaleRange=function(d,u){if(!d||isNaN(u))return!1;var E=b(d);d=z(d);E=null!=E&&!isNaN(E)&&0<E&&u>E;u=null!=d&&!isNaN(d)&&0<d&&u<d;return E||u};a.isSublayer=A;a.sortChildLayersToIds=function(d,u){if(d=d?.layer){var E=p(d);E&&(d=d.get(E),w(d,u))}};a.sortLayersToIds=
w;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/SnappingControls/SnappingLayerListViewModel":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../LayerList/LayerListViewModel ./snappingLayerListUtils ./SnappingListItem".split(" "),
function(a,n,b,z,p,w,A,B,d,u,E,y){a.SnappingLayerListViewModel=function(v){function H(){var f=v.apply(this,arguments)||this;f.featureSnappingSources=new z;return f}n._inherits(H,v);var C=H.prototype;C._compileList=function(){var f=this.get("view.map.layers");f&&(f=f.filter(E.isValidSnappingLayer),this._watchLayersListMode(f),(f=this._getViewableLayers(f))&&f.length?(this._createNewItems(f),this._removeItems(f),this._sortItems(f)):this._removeAllItems())};C._createListItem=function(f){return new y.SnappingListItem({layer:f,
view:this.view,getFeatureSnappingSources:()=>this.featureSnappingSources})};n._createClass(H,[{key:"operationalItemsFlat",get:function(){return this.operationalItems.flatten(f=>f.children)}},{key:"selectableItems",get:function(){return this.operationalItemsFlat.filter(f=>!f.children?.length)}}]);return H}(u);b.__decorate([p.property()],a.SnappingLayerListViewModel.prototype,"featureSnappingSources",void 0);b.__decorate([p.property()],a.SnappingLayerListViewModel.prototype,"operationalItems",void 0);
b.__decorate([p.property()],a.SnappingLayerListViewModel.prototype,"operationalItemsFlat",null);b.__decorate([p.property()],a.SnappingLayerListViewModel.prototype,"selectableItems",null);a.SnappingLayerListViewModel=b.__decorate([d.subclass("esri.widgets.support.SnappingControls.SnappingLayerListViewModel")],a.SnappingLayerListViewModel);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/LayerList/LayerListViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Collection ../../core/Evented ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./ListItem ./support/layerListUtils".split(" "),
function(a,n,b,z,p,w,A,B,d,u,E,y){const v=b.ofType(E);b=function(H){function C(l){l=H.call(this,l)||this;l.checkPublishStatusEnabled=!1;l.listItemCreatedFunction=null;l.operationalItems=new v;l.view=null;return l}a._inherits(C,H);var f=C.prototype;f.initialize=function(){this.addHandles([p.watch(()=>[this.view,this.view?.ready],()=>this._viewHandles(),p.initial),p.watch(()=>[this.listItemCreatedFunction,this.checkPublishStatusEnabled],()=>this._recompileList())],"view")};f.destroy=function(){this.removeAllHandles();
this.view=null;this.operationalItems.removeAll()};f.triggerAction=function(l,t){l&&!l.disabled&&this.emit("trigger-action",{action:l,item:t})};f.moveListItem=function(l,t,k,F){const e=l?.layer;if(e){var r=this.view?.map?.layers,q=t?y.getItemLayers(t):r;r=k?y.getItemLayers(k):r;if(q&&r){var {operationalItems:h}=this;t=t?.children||h;h=k?.children||h;F=r.length-F;l.parent=k||null;t.includes(l)&&t.remove(l);q.includes(e)&&q.remove(e);h.includes(l)||h.add(l,F);r.includes(e)||r.add(e,F)}}};f._createLayerViewHandles=
function(l){this.removeHandles("layer-views");this._compileList();l&&this.addHandles(l.on("change",()=>this._compileList()),"layer-views")};f._createMapLayerHandles=function(l){this.removeHandles("map-layers");this._compileList();l&&this.addHandles(l.on("change",()=>this._compileList()),"map-layers")};f._createListItem=function(l){const {view:t,listItemCreatedFunction:k,checkPublishStatusEnabled:F}=this;return new E({checkPublishStatusEnabled:F,layer:l,listItemCreatedFunction:k,view:t})};f._removeAllItems=
function(){this.operationalItems.removeAll()};f._getViewableLayers=function(l){if(l)return l.filter(t=>"hide"!==y.findLayerListMode(t))};f._watchLayersListMode=function(l){this.removeHandles("layer-list-mode");l&&l.forEach(t=>{"listMode"in t&&this.addHandles(p.watch(()=>t.listMode,()=>this._compileList()),"layer-list-mode")})};f._compileList=function(){var l=this.get("view.map.layers");this._watchLayersListMode(l);(l=this._getViewableLayers(l))&&l.length?(this._createNewItems(l),this._removeItems(l),
this._sortItems(l)):this._removeAllItems()};f._createNewItems=function(l){const {operationalItems:t}=this;l.forEach(k=>{t.find(F=>F.layer===k)||t.add(this._createListItem(k))})};f._removeItems=function(l){const {operationalItems:t}=this,k=[];t.forEach(F=>{F&&l&&l.includes(F.layer)||k.push(F)});t.removeMany(k)};f._sortItems=function(l){const {operationalItems:t}=this;t.sort((k,F)=>{k=l.indexOf(k.layer);F=l.indexOf(F.layer);return k>F?-1:k<F?1:0})};f._recompileList=function(){this._removeAllItems();
this._compileList()};f._viewHandles=function(){const {view:l}=this;this.removeHandles(["map-layers","layer-views","view-layers"]);this._recompileList();l&&l.ready&&this.addHandles([p.watch(()=>this.view?.map?.allLayers,t=>this._createMapLayerHandles(t),p.initial),p.watch(()=>this.view?.allLayerViews,t=>this._createLayerViewHandles(t),p.initial)],"view-layers")};a._createClass(C,[{key:"state",get:function(){const l=this.get("view");return this.get("view.ready")?"ready":l?"loading":"disabled"}}]);return C}(z.EventedAccessor);
n.__decorate([w.property()],b.prototype,"checkPublishStatusEnabled",void 0);n.__decorate([w.property()],b.prototype,"listItemCreatedFunction",void 0);n.__decorate([w.property({type:v})],b.prototype,"operationalItems",void 0);n.__decorate([w.property({readOnly:!0})],b.prototype,"state",null);n.__decorate([w.property()],b.prototype,"view",void 0);return b=n.__decorate([u.subclass("esri.widgets.LayerList.LayerListViewModel")],b)})},"esri/widgets/LayerList/ListItem":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/arrayUtils ../../core/Collection ../../core/HandleOwner ../../core/Identifiable ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/has ../../core/accessorSupport/decorators/subclass ../../support/actions/ActionBase ../../support/actions/ActionButton ../../support/actions/ActionSlider ../../support/actions/ActionToggle ./ListItemPanel ./support/layerListUtils".split(" "),
function(a,n,b,z,p,w,A,B,d,u,E,y,v,H,C,f,l,t){var k;E=p.ofType({key:"type",defaultKeyValue:"button",base:v,typeMap:{button:H,toggle:f,slider:C}});const F=p.ofType(E);b=k=function(e){function r(h){h=e.call(this,h)||this;h.actionsSections=new F;h.actionsOpen=!1;h.checkPublishStatusEnabled=!1;h.children=new (p.ofType(k));h.childrenSortable=!0;h.hidden=!1;h.layer=null;h.layerView=null;h.listItemCreatedFunction=null;h.open=!1;h.panel=null;h.parent=null;h.sortable=!0;h.view=null;return h}a._inherits(r,
e);var q=r.prototype;q.initialize=function(){this.handles.add([B.watch(()=>this.layer,h=>this._watchLayerProperties(h),B.initial),B.watch(()=>this.checkPublishStatusEnabled,h=>this._updateChildrenPublishing(h),B.initial),B.watch(()=>this.view,h=>this._updateChildrenView(h),B.initial),B.watch(()=>this.panel,h=>this._setListItemOnPanel(h),B.initial),B.watch(()=>[this.layer,this.view],()=>this._getLayerView(),B.initial)]);"function"===typeof this.listItemCreatedFunction&&this.listItemCreatedFunction.call(null,
{item:this})};q.destroy=function(){this.view=null};q.castPanel=function(h){this.get("panel.open")&&!h.hasOwnProperty("open")&&(h.open=!0);return h?new l(h):null};q.clone=function(){return new k({actionsSections:this.actionsSections.clone(),actionsOpen:this.actionsOpen,checkPublishStatusEnabled:this.checkPublishStatusEnabled,children:this.children.clone(),layer:this.layer,listItemCreatedFunction:this.listItemCreatedFunction,open:this.open,panel:this.panel,title:this.title,view:this.view,visible:this.visible})};
q._setListItemOnPanel=function(h){h&&(h.listItem=this)};q._updateChildrenPublishing=function(h){const D=this.children;D&&D.forEach(m=>m.checkPublishStatusEnabled=h)};q._updateChildrenView=function(h){const D=this.children;D&&D.forEach(m=>m.view=h)};q._addChildren=function(h){this.handles.remove("child-list-mode");this.children.removeAll();if(h){h.forEach(m=>{this.handles.add(B.watch(()=>m.listMode,()=>this._addChildren(h)),"child-list-mode")});var D=h.filter(m=>"hide"!==t.findLayerListMode(m));this.children.addMany(this._makeChildren(D))}};
q._watchSublayerChanges=function(h){h&&this.handles.add(h.on("change",()=>{this._addChildren(h)}),"layer")};q._initializeChildLayers=function(h){this._addChildren(h);this._watchSublayerChanges(h)};q._makeChildren=function(h){return h.map(D=>t.canDisplayLayer(D)?new k({layer:D,checkPublishStatusEnabled:this.checkPublishStatusEnabled,listItemCreatedFunction:this.listItemCreatedFunction,parent:this,view:this.view}):null).filter(z.isSome).reverse()};q._watchLayerProperties=function(h){if(this.handles&&
(this.handles.remove("layer"),this.handles.remove("child-list-mode"),h))if(this.handles.add(B.watch(()=>h.listMode,()=>this._watchLayerProperties(h)),"layer"),"hide-children"===t.findLayerListMode(h))this.children.removeAll();else{var D=t.getNormalizedChildLayerProperty(h);D&&this.handles.add(B.watch(()=>h[D],m=>{h.hasOwnProperty(D)&&this._initializeChildLayers(m)},B.initial),"layer")}};q._getLayerView=async function(){const {layer:h,view:D}=this;if(h&&D)try{const m=await D.whenLayerView(h);m.layer===
this.layer&&this._set("layerView",m)}catch{}};a._createClass(r,[{key:"connectionStatus",get:function(){const {layerView:h,publishing:D}=this;if(!D&&h&&"connectionStatus"in h)return h.connectionStatus}},{key:"error",get:function(){return this.layer?.loadError}},{key:"incompatible",get:function(){const {layerView:h}=this;return h&&"spatialReferenceSupported"in h?!h.spatialReferenceSupported:!1}},{key:"title",get:function(){const h=this.get("layer.layer");return(!h||h&&this.get("layer.layer.loaded"))&&
this.get("layer.title")||this.get("layer.attributes.title")||""},set:function(h){this._override("title",h)}},{key:"publishing",get:function(){const {layer:h,checkPublishStatusEnabled:D}=this;return D&&h&&"publishingInfo"in h&&"publishing"===h.publishingInfo?.status}},{key:"updating",get:function(){const {layerView:h,connectionStatus:D,layer:m,publishing:c}=this;return c||D?!1:h?h.updating:"loading"===m?.loadStatus||!1}},{key:"visible",get:function(){return this.layer?.visible},set:function(h){const D=
this.layer;D&&(D.visible=h)}},{key:"visibleAtCurrentScale",get:function(){return!t.isLayerOutsideScaleRange(this.layer,this.get("view.scale"))}},{key:"visibilityMode",get:function(){return t.findLayerVisibilityMode(this.layer)}}]);return r}(A.IdentifiableMixin(w.HandleOwnerMixin(b)));n.__decorate([d.property({type:F})],b.prototype,"actionsSections",void 0);n.__decorate([d.property()],b.prototype,"actionsOpen",void 0);n.__decorate([d.property()],b.prototype,"checkPublishStatusEnabled",void 0);n.__decorate([d.property({type:p})],
b.prototype,"children",void 0);n.__decorate([d.property()],b.prototype,"childrenSortable",void 0);n.__decorate([d.property({readOnly:!0})],b.prototype,"connectionStatus",null);n.__decorate([d.property({readOnly:!0})],b.prototype,"error",null);n.__decorate([d.property()],b.prototype,"hidden",void 0);n.__decorate([d.property({readOnly:!0})],b.prototype,"incompatible",null);n.__decorate([d.property()],b.prototype,"layer",void 0);n.__decorate([d.property({readOnly:!0})],b.prototype,"layerView",void 0);
n.__decorate([d.property()],b.prototype,"listItemCreatedFunction",void 0);n.__decorate([d.property()],b.prototype,"open",void 0);n.__decorate([d.property({type:l})],b.prototype,"panel",void 0);n.__decorate([u.cast("panel")],b.prototype,"castPanel",null);n.__decorate([d.property()],b.prototype,"parent",void 0);n.__decorate([d.property()],b.prototype,"sortable",void 0);n.__decorate([d.property()],b.prototype,"title",null);n.__decorate([d.property({readOnly:!0})],b.prototype,"publishing",null);n.__decorate([d.property({readOnly:!0})],
b.prototype,"updating",null);n.__decorate([d.property()],b.prototype,"view",void 0);n.__decorate([d.property()],b.prototype,"visible",null);n.__decorate([d.property({readOnly:!0})],b.prototype,"visibleAtCurrentScale",null);n.__decorate([d.property({readOnly:!0})],b.prototype,"visibilityMode",null);return b=k=n.__decorate([y.subclass("esri.widgets.LayerList.ListItem")],b)})},"esri/support/actions/ActionSlider":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./ActionBase".split(" "),
function(a,n,b,z,p,w,A,B){var d;z=d=function(u){function E(y){y=u.call(this,y)||this;y.displayValueEnabled=!1;y.max=1;y.min=0;y.step=.1;y.type="slider";y.value=null;return y}a._inherits(E,u);E.prototype.clone=function(){return new d({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,displayValueEnabled:this.displayValueEnabled,max:this.max,min:this.min,step:this.step,value:this.value})};return a._createClass(E)}(B);
n.__decorate([b.property()],z.prototype,"displayValueEnabled",void 0);n.__decorate([b.property()],z.prototype,"max",void 0);n.__decorate([b.property()],z.prototype,"min",void 0);n.__decorate([b.property()],z.prototype,"step",void 0);n.__decorate([b.property()],z.prototype,"value",void 0);return z=d=n.__decorate([A.subclass("esri.support.Action.ActionSlider")],z)})},"esri/widgets/LayerList/ListItemPanel":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Identifiable ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../Widget ./support/layerListUtils ../support/widget ../support/jsxFactory".split(" "),
function(a,n,b,z,p,w,A,B,d,u,E,y,v,H,C){z=function(f){function l(k,F){k=f.call(this,k,F)||this;k._legend=null;k.content=null;k.image=null;k.listItem=null;k.open=!1;k.visible=!0;return k}n._inherits(l,f);var t=l.prototype;t.initialize=function(){this.addHandles(w.watch(()=>this.content,k=>this._createLegend(k),w.initial))};t.destroy=function(){this._legend=p.destroyMaybe(this._legend)};t.render=function(){return C.tsx("div",{class:"esri-layer-list-panel"},this._renderContents())};t._renderContent=
function(k){const {_legend:F,disabled:e}=this;return!k||e?null:"legend"===k&&F?C.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--legend"),key:F},F.render()):"string"===typeof k?C.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--string"),key:k,innerHTML:k}):H.isWidget(k)?C.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--widget"),key:k},k.render()):k instanceof
HTMLElement?C.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--html-element"),key:k,bind:k,afterCreate:this._attachToNode}):null};t._renderContents=function(){const {content:k}=this;return Array.isArray(k)?k.map(F=>this._renderContent(F)):this._renderContent(k)};t._getLegendOptions=function(){const {listItem:k}=this;if(!k)return{};const {layer:F,view:e}=k;return F&&e?{view:e,layerInfos:[v.getLegendLayerInfo(F)]}:{}};t._createLegend=async function(k){if(this._hasLegend(k)&&
!this._legend){({default:k}=await new Promise((r,q)=>a(["../Legend"],h=>r(Object.freeze(Object.defineProperty({__proto__:null,default:h},Symbol.toStringTag,{value:"Module"}))),q)));var {listItem:F}=this,e=new k(this._getLegendOptions());this._legend=e;this.notifyChange("className");this.notifyChange("title");k=w.watch(()=>[F?.view,F?.layer,F?.layer?.source,F?.layer?.parent],()=>this._updateLegend(e),w.initial);this.addHandles(k,"legends");this.scheduleRender()}};t._hasLegend=function(k){return"legend"===
k?!0:null!=k&&(Array.isArray(k)?k.includes("legend"):!1)};t._attachToNode=function(k){k.appendChild(this)};t._updateLegend=function(k){k.set(this._getLegendOptions());this.scheduleRender()};t._getWidget=function(k){return"legend"===k?this._legend:H.isWidget(k)?k:null};t._getFirstWidget=function(){const {content:k}=this;if(Array.isArray(k)){let F=null;k.some(e=>{(e=this._getWidget(e))&&(F=e);return!!e});return F}return this._getWidget(k)};n._createClass(l,[{key:"className",get:function(){const {image:k}=
this,F=this._getFirstWidget();return this._get("className")||(!k&&F?F.iconClass??"":"")},set:function(k){this._override("className",k)}},{key:"disabled",get:function(){const {listItem:k,_legend:F,content:e}=this;return k?Array.isArray(e)&&1<e.length?!1:F?!F.activeLayerInfos?.length||!k.visibleAtCurrentScale||!k.visible:!1:!0},set:function(k){this._overrideIfSome("disabled",k)}},{key:"title",get:function(){const k=this._getFirstWidget();return this._get("title")||(k?.label??"")},set:function(k){this._override("title",
k)}}]);return l}(z.IdentifiableMixin(y));b.__decorate([A.property()],z.prototype,"_legend",void 0);b.__decorate([A.property()],z.prototype,"className",null);b.__decorate([A.property()],z.prototype,"content",void 0);b.__decorate([A.property()],z.prototype,"disabled",null);b.__decorate([A.property()],z.prototype,"image",void 0);b.__decorate([A.property()],z.prototype,"listItem",void 0);b.__decorate([A.property()],z.prototype,"title",null);b.__decorate([A.property()],z.prototype,"open",void 0);b.__decorate([A.property()],
z.prototype,"visible",void 0);return z=b.__decorate([E.subclass("esri.widgets.LayerList.ListItemPanel")],z)})},"esri/widgets/support/SnappingControls/snappingLayerListUtils":function(){define(["exports","../../LayerList/support/layerListUtils"],function(a,n){const b=w=>z(w)||p(w),z=w=>{if(!("type"in w))return!1;switch(w.type){case "feature":case "geojson":case "csv":case "graphics":case "wfs":case "map-notes":case "oriented-imagery":case "scene":case "building-scene":return!0;default:return!1}},p=
w=>{const A=n.getNormalizedChildLayerProperty(w);if(null!=A&&w.hasOwnProperty(A)&&null!=w[A])for(const B of w[A])if(b(B))return!0;return!1};a.isValidSnappingLayer=b;a.isValidSnappingLayerGroup=p;a.isValidSnappingLayerSource=z;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/SnappingControls/SnappingListItem":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/arrayUtils ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../LayerList/ListItem ../../LayerList/support/layerListUtils ./snappingLayerListUtils".split(" "),
function(a,n,b,z,p,w,A,B,d,u,E,y){var v;a.SnappingListItem=v=function(H){function C(l){l=H.call(this,l)||this;l.children=new p;l.parent=null;return l}n._inherits(C,H);var f=C.prototype;f._initializeChildLayers=function(l){l&&(l=l.filter(y.isValidSnappingLayer),n._get(n._getPrototypeOf(C.prototype),"_initializeChildLayers",this).call(this,l))};f._makeChildren=function(l){return l.map(t=>E.canDisplayLayer(t)?new v({layer:t,parent:this,view:this.view,getFeatureSnappingSources:this.getFeatureSnappingSources}):
null).filter(z.isSome).reverse()};n._createClass(C,[{key:"allChildrenEnabled",get:function(){return this.children.every(l=>l.enabled)??!1}},{key:"childLayerIds",get:function(){return this.children.map(l=>l.layer.id).toArray()}},{key:"enabled",get:function(){return null!=this.featureSource?this.featureSource.enabled:!1}},{key:"featureSource",get:function(){const {layer:l,getFeatureSnappingSources:t}=this;return t().find(k=>k.layer===l)}},{key:"hasChildrenEnabled",get:function(){return this.children.some(l=>
l.enabled)}}]);return C}(u);b.__decorate([w.property()],a.SnappingListItem.prototype,"allChildrenEnabled",null);b.__decorate([w.property()],a.SnappingListItem.prototype,"children",void 0);b.__decorate([w.property()],a.SnappingListItem.prototype,"childLayerIds",null);b.__decorate([w.property()],a.SnappingListItem.prototype,"enabled",null);b.__decorate([w.property()],a.SnappingListItem.prototype,"featureSource",null);b.__decorate([w.property({constructOnly:!0})],a.SnappingListItem.prototype,"getFeatureSnappingSources",
void 0);b.__decorate([w.property()],a.SnappingListItem.prototype,"hasChildrenEnabled",null);b.__decorate([w.property()],a.SnappingListItem.prototype,"parent",void 0);a.SnappingListItem=v=b.__decorate([d.subclass("esri.widgets.support.SnappingControls.SnappingListItem")],a.SnappingListItem);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../intl ../core/handleUtils ../core/maybe ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./Sketch/SketchViewModel ./support/componentsUtils ./support/SelectionToolbar ./support/SnappingControls ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory ../intl/substitute".split(" "),function(a,
n,b,z,p,w,A,B,d,u,E,y,v,H,C,f,l,t,k,F,e,r){const q={createTools:{point:!0,polyline:!0,polygon:!0,rectangle:!0,circle:!0},selectionTools:{"rectangle-selection":!0,"lasso-selection":!0},undoRedoMenu:!0,settingsMenu:!0,snappingControls:!0,snappingControlsElements:{header:!1,enabledToggle:!0,selfEnabledToggle:!0,featureEnabledToggle:!0,layerList:!0},duplicateButton:!0};z=function(h){function D(c,g){g=h.call(this,c,g)||this;g._activeCreateOptions=null;g._menuOpen=!1;g._selectionToolbar=null;g._snappingControls=
null;g._viewModelHandlesGroup=null;g.availableCreateTools=["point","polyline","polygon","rectangle","circle"];g.creationMode="continuous";g.iconClass="esri-icon-edit";g.icon=null;g.layout="horizontal";g.messages=null;g.visibleElements={...q};g._activateCreateTool=g._activateCreateTool.bind(n._assertThisInitialized(g));g.viewModel=c?.viewModel||new H;return g}n._inherits(D,h);var m=D.prototype;m.initialize=function(){const {layer:c,view:g}=this,G=new f({view:"2d"===g?.type?g:null,layers:c?[c]:null});
this.addHandles([A.watch(()=>this.viewModel,K=>{this._viewModelHandlesGroup=w.removeMaybe(this._viewModelHandlesGroup);K&&(this._viewModelHandlesGroup=p.handlesGroup([K.on("create",L=>{this.scheduleRender();this._onCreateOperation(L)}),K.on("update",()=>this.scheduleRender()),K.on("delete",L=>this.emit("delete",L)),K.on("undo",()=>this.scheduleRender()),K.on("redo",()=>this.scheduleRender()),A.watch(()=>K.layer,L=>{this._selectionToolbar&&(this._selectionToolbar.layers=L?[L]:null)}),A.watch(()=>K.view,
L=>{this._selectionToolbar&&(this._selectionToolbar.view="2d"===L?.type?L:null);this._setUpSnappingControls()}),A.watch(()=>K.state,()=>this.notifyChange("state"))]))},A.syncAndInitial),A.when(()=>G.activeToolInfo,()=>this.viewModel.cancel()),G.on("complete",K=>this._onSelectionOperationComplete(K))]);this._selectionToolbar=G;this._setUpSnappingControls()};m.loadDependencies=function(){return C.loadCalciteComponents({action:()=>new Promise((c,g)=>a(["../chunks/calcite-action"],c,g)),icon:()=>new Promise((c,
g)=>a(["../chunks/calcite-icon"],c,g))})};m.destroy=function(){this._selectionToolbar?.destroy();this._viewModelHandlesGroup=w.removeMaybe(this._viewModelHandlesGroup);this._snappingControls=w.destroyMaybe(this._snappingControls)};m.castVisibleElements=function(c){c={...q,...c,createTools:{...q.createTools,...c?.createTools},selectionTools:{...q.selectionTools,...c?.selectionTools},snappingControlsElements:{...q.snappingControlsElements,...c?.snappingControlsElements}};null!=this._snappingControls&&
(this._snappingControls.visibleElements=c.snappingControlsElements);return c};m.create=function(c,g){this._activeCreateOptions=g||null;this.viewModel.create(c,g)};m.update=function(c,g){return this.viewModel.update(c,g)};m.complete=function(){this.viewModel.complete()};m.cancel=function(){this._selectionToolbar?.cancel();this.viewModel.cancel()};m.undo=function(){this.viewModel.undo();this.view?.focus()};m.redo=function(){this.viewModel.redo();this.view?.focus()};m.delete=function(){this.viewModel.delete()};
m.duplicate=function(){return this.viewModel.duplicate()};m.render=function(){const {label:c,layout:g,viewModel:{state:G}}=this;return e.tsx("div",{"aria-label":c,class:this.classes("esri-sketch","esri-widget",{["esri-disabled"]:"disabled"===G,["esri-sketch--vertical"]:"vertical"===g})},e.tsx("div",{role:"toolbar",class:"esri-sketch__panel"},this.renderTopPanelContents()),e.tsx("div",{class:this.classes("esri-sketch__panel","esri-sketch__info-panel")},this.renderInfoPanelContents()))};m.renderTopPanelContents=
function(){const c=this.classes("esri-sketch__section","esri-sketch__tool-section"),{availableCreateTools:g,visibleElements:G}=this;return[e.tsx("div",{role:"menu",key:"selection-button-container",class:c},this.renderDefaultSelectionButton(),this.renderSelectionToolbar()),g&&g.length?e.tsx("div",{role:"menu",class:c},this.renderDrawButtons()):null,G.undoRedoMenu?e.tsx("div",{role:"menu",key:"undo-redo-menu-button-container",class:c},this.renderUndoRedoMenuButtons()):null,G.settingsMenu?e.tsx("div",
{key:"settings-menu-button-container",class:"esri-sketch__section"},this.renderSettingsMenuButton()):null]};m.renderInfoPanelContents=function(){if(this._menuOpen)return this.renderSettingsMenu();if(this.updateGraphics.length)return[e.tsx("div",{class:this.classes("esri-sketch__section","esri-sketch__info-section","esri-sketch__info-count-section"),key:"feature-count-container"},this.renderFeatureCount()),e.tsx("div",{class:this.classes("esri-sketch__section","esri-sketch__info-section"),key:"delete-button-container"},
this.renderDuplicateButton(),this.renderDeleteButton())]};m.renderSettingsMenu=function(){const {settings:c}=this.messages;return[e.tsx("div",{role:"menu",class:"esri-sketch__menu-container",key:"settings-menu-container"},e.tsx("header",{class:"esri-sketch__menu-header",key:"settings-menu-header"},e.tsx("span",{class:"esri-sketch__menu-title"},c)),this.renderSnappingControls())]};m.renderSnappingControls=function(){const {snappingControls:c}=this.visibleElements;if(null!=this._snappingControls&&c)return this._snappingControls.render()};
m.renderFeatureCount=function(){const {layout:c,messages:g,updateGraphics:{length:G}}=this,K=r.substitute(g.selectedCount,{count:G});return e.tsx("div",{class:"esri-sketch__feature-count-badge","aria-label":K},e.tsx("span",{class:"esri-sketch__feature-count-number"},"vertical"===c?G:K))};m.renderDuplicateButton=function(){if(this.visibleElements.duplicateButton){var c=this.messages;c=1<this.updateGraphics.length?c.duplicateFeatures:c.duplicateFeature;return e.tsx("calcite-action",{bind:this,label:c,
onclick:this._onDuplicateSelect,scale:"s",text:c,title:c},e.tsx("calcite-icon",{scale:"s",icon:"copy"}))}};m.renderDeleteButton=function(){var c=this.messages;c=1<this.updateGraphics.length?c.deleteFeatures:c.deleteFeature;return e.tsx("calcite-action",{bind:this,label:c,onclick:this.delete,scale:"s",text:c,title:c},e.tsx("calcite-icon",{scale:"s",icon:"trash"}))};m.renderDefaultSelectionButton=function(){if(this.viewModel.updateOnGraphicClick){var c=this.messages.selectFeature;return e.tsx("calcite-action",
{active:"ready"===this.state,bind:this,label:c,onclick:this._activateDefaultSelectTool,scale:"s",text:c,title:c},e.tsx("calcite-icon",{scale:"s",icon:"cursor"}))}};m.renderSelectionToolbar=function(){if("2d"===this.view?.type&&this._selectionToolbar){var c=this.visibleElements.selectionTools;this._selectionToolbar.visibleElements={lassoTool:!!c?.["lasso-selection"],rectangleTool:!!c?.["rectangle-selection"]};return this._selectionToolbar.render()}};m.renderDrawButtons=function(){const c=this.visibleElements.createTools??
{};return this.availableCreateTools?.map(g=>{if("point"===g&&c.point)return this.renderPointButton();if("polyline"===g&&c.polyline)return this.renderPolylineButton();if("polygon"===g&&c.polygon)return this.renderPolygonButton();if("rectangle"===g&&c.rectangle)return this.renderRectangleButton();if("circle"===g&&c.circle)return this.renderCircleButton()})};m.renderPointButton=function(){const c=this.messages.drawPoint;return e.tsx("calcite-action",{active:"point"===this.activeTool,bind:this,label:c,
onclick:()=>this._activateCreateTool("point"),scale:"s",text:c,title:c},e.tsx("calcite-icon",{scale:"s",icon:"pin"}))};m.renderPolygonButton=function(){const c=this.messages.drawPolygon;return e.tsx("calcite-action",{active:"polygon"===this.activeTool,bind:this,label:c,onclick:()=>this._activateCreateTool("polygon"),scale:"s",text:c,title:c},e.tsx("calcite-icon",{scale:"s",icon:"polygon"}))};m.renderPolylineButton=function(){const c=this.messages.drawPolyline;return e.tsx("calcite-action",{active:"polyline"===
this.activeTool,bind:this,label:c,onclick:()=>this._activateCreateTool("polyline"),scale:"s",text:c,title:c},e.tsx("calcite-icon",{scale:"s",icon:"line"}))};m.renderCircleButton=function(){const c=this.messages.drawCircle;return e.tsx("calcite-action",{active:"circle"===this.activeTool,bind:this,label:c,onclick:()=>this._activateCreateTool("circle"),scale:"s",text:c,title:c},e.tsx("calcite-icon",{scale:"s",icon:"circle"}))};m.renderRectangleButton=function(){const c=this.messages.drawRectangle;return e.tsx("calcite-action",
{active:"rectangle"===this.activeTool,bind:this,label:c,onclick:()=>this._activateCreateTool("rectangle"),scale:"s",text:c,title:c},e.tsx("calcite-icon",{scale:"s",icon:"rectangle"}))};m.renderUndoRedoMenuButtons=function(){return[this.renderUndoButton(),this.renderRedoButton()]};m.renderUndoButton=function(){const c=this.messages.undo;return e.tsx("calcite-action",{disabled:!this.viewModel.canUndo(),bind:this,label:c,onclick:this.undo,scale:"s",text:c,title:c},e.tsx("calcite-icon",{scale:"s",icon:t.isRTL(this.container)?
"redo":"undo"}))};m.renderRedoButton=function(){const c=this.messages.redo;return e.tsx("calcite-action",{disabled:!this.viewModel.canRedo(),bind:this,label:c,onclick:this.redo,scale:"s",text:c,title:c},e.tsx("calcite-icon",{scale:"s",icon:t.isRTL(this.container)?"undo":"redo"}))};m.renderSettingsMenuButton=function(){const c=this.messages.settings;return e.tsx("calcite-action",{active:this._menuOpen,bind:this,label:c,onclick:this._toggleMenu,scale:"s",text:c,title:c},e.tsx("calcite-icon",{scale:"s",
icon:"gear"}))};m._activateCreateTool=function(c){this.activeTool===c?this.cancel():(this._selectionToolbar?.cancel(),this.create(c))};m._onCreateOperation=function(c){if("complete"===c.state){var {creationMode:g}=this,{type:G}=c;if("create"===G){const {tool:K,graphic:L}=c;c=this._activeCreateOptions;this._activeCreateOptions=null;"continuous"===g?this.create(K,c):"update"===g&&this.update([L])}}};m._toggleMenu=function(){this._menuOpen=!this._menuOpen;this.scheduleRender()};m._onDuplicateSelect=
function(){const c=this.duplicate(),g=this.viewModel.activeTool;"transform"!==g&&"reshape"!==g||this.update(c,{tool:g})};m._onSelectionOperationComplete=function(c){const {viewModel:{defaultUpdateOptions:g}}=this,{selection:G}=c;!c.aborted&&G.length&&(c=g.tool,this.update(G,{...g,tool:1<G.length&&"reshape"===c?"transform":c}));this.notifyChange("state")};m._activateDefaultSelectTool=function(){this.cancel();this.view?.focus()};m._setUpSnappingControls=function(){const {snappingOptions:c,view:g}=this;
this._snappingControls=w.destroyMaybe(this._snappingControls);c&&g&&(this._snappingControls=new l({snappingOptions:c,view:g,visibleElements:this.visibleElements.snappingControlsElements}))};n._createClass(D,[{key:"activeTool",get:function(){const c=this._selectionToolbar?.activeToolInfo;if(c)switch(c.toolName){case "lasso":return"lasso-selection";case "rectangle":return"rectangle-selection";case "default":return"custom-selection"}return this.viewModel.activeTool}},{key:"createGraphic",get:function(){return this.viewModel.createGraphic}},
{key:"defaultCreateOptions",get:function(){return this.viewModel.defaultCreateOptions},set:function(c){this.viewModel.defaultCreateOptions=c}},{key:"defaultUpdateOptions",get:function(){return this.viewModel.defaultUpdateOptions},set:function(c){this.viewModel.defaultUpdateOptions=c}},{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(c){this._overrideIfSome("label",c)}},{key:"labelOptions",get:function(){return this.viewModel.labelOptions},set:function(c){this.viewModel.labelOptions=
c}},{key:"layer",get:function(){return this.viewModel.layer},set:function(c){this.viewModel.layer=c}},{key:"snappingOptions",get:function(){return this.viewModel.snappingOptions},set:function(c){this.viewModel.snappingOptions=c}},{key:"state",get:function(){return this._selectionToolbar?.activeToolInfo?"active":this.viewModel.state}},{key:"tooltipOptions",get:function(){return this.viewModel.tooltipOptions},set:function(c){this.viewModel.tooltipOptions=c}},{key:"updateGraphics",get:function(){return this.viewModel.updateGraphics}},
{key:"view",get:function(){return this.viewModel.view},set:function(c){this.viewModel.view=c}},{key:"viewModel",set:function(c){const g=this._get("viewModel");c!==g&&(g&&w.destroyMaybe(g),this._set("viewModel",c))}}]);return D}(v);b.__decorate([B.property()],z.prototype,"activeTool",null);b.__decorate([B.property({cast:h=>{if(!h||!h.length)return null;const D=new Set(["point","polyline","polygon","rectangle","circle"]);return h.filter(m=>D.has(m))}})],z.prototype,"availableCreateTools",void 0);b.__decorate([B.property({readOnly:!0})],
z.prototype,"createGraphic",null);b.__decorate([B.property()],z.prototype,"creationMode",void 0);b.__decorate([B.property()],z.prototype,"defaultCreateOptions",null);b.__decorate([B.property()],z.prototype,"defaultUpdateOptions",null);b.__decorate([B.property()],z.prototype,"iconClass",void 0);b.__decorate([B.property()],z.prototype,"icon",void 0);b.__decorate([B.property()],z.prototype,"label",null);b.__decorate([B.property()],z.prototype,"labelOptions",null);b.__decorate([B.property()],z.prototype,
"layer",null);b.__decorate([B.property({type:["horizontal","vertical"]})],z.prototype,"layout",void 0);b.__decorate([B.property(),k.messageBundle("esri/widgets/Sketch/t9n/Sketch")],z.prototype,"messages",void 0);b.__decorate([B.property()],z.prototype,"snappingOptions",null);b.__decorate([B.property()],z.prototype,"state",null);b.__decorate([B.property()],z.prototype,"tooltipOptions",null);b.__decorate([B.property({readOnly:!0})],z.prototype,"updateGraphics",null);b.__decorate([B.property()],z.prototype,
"view",null);b.__decorate([B.property(),F.vmEvent(["create","update","undo","redo"])],z.prototype,"viewModel",null);b.__decorate([B.property()],z.prototype,"visibleElements",void 0);b.__decorate([d.cast("visibleElements")],z.prototype,"castVisibleElements",null);return z=b.__decorate([y.subclass("esri.widgets.Sketch")],z)});
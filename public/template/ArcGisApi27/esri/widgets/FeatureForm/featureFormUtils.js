// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../intl ../../core/arrayUtils ../../core/string ../../intl/date ../../layers/support/domainUtils ../../layers/support/fieldUtils ../../intl/substitute".split(" "),function(c,r,F,h,k,m,l,t){function u(a,b){b=b.map((d,e)=>{let f=a[e];d.domain&&"coded-value"===d.domain.type&&(e=d.domain.codedValues.find(g=>g.code===f),e?.name&&(f=e.name));l.isDateField(d)&&(f=v(d,f));return[d.name,f]});return Object.fromEntries(b)}function v(a,b){if(!a||null==b)return null;switch(a.type){case "date":return k.formatDate(b);
case "date-only":return k.formatDateOnly(b);case "time-only":return k.formatTimeOnly(b);case "timestamp-offset":return k.formatTimestamp(b);default:return null}}function w(a,b){return h.replace(h.replace(a,d=>`{${d.toLowerCase()}}`),Object.fromEntries(Object.entries(b).map(([d,e])=>[d.toLowerCase(),e])))}function x(a){return 1E7<=a||-1E7>=a}const y=a=>"field"===a?.type,z=a=>"relationship"===a?.type,A=a=>"field"===a.type,n=a=>a.reduce((b,d)=>"group"===d?.type?[...b,...d.inputs]:[...b,d],[]),p=(a,b)=>
null!=a&&a.input?.type===b,B={typeFieldName:null,types:[]};r=new Set(["date-only","time-only","timestamp-offset"]);c.LengthValidationError=void 0;(c.LengthValidationError||(c.LengthValidationError={})).TOO_SHORT="length-validation-error::too-short";const C={type:"number"},D={type:"number",intlOptions:{notation:"scientific"}},E={type:"date",intlOptions:{day:"2-digit",month:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}};c.capabilitiesAllowEditType=(a,b)=>{if(!a)return!0;
({operations:a}=a);switch(b){case "INSERT":return a.supportsAdd;case "UPDATE":case "DELETE":return a.supportsUpdate;default:return!0}};c.flattenFieldInputs=a=>n(a).filter(y);c.flattenInputs=n;c.flattenRelationshipInputs=a=>n(a).filter(z);c.formTemplateHasInvalidFields=function(a){return"formTemplate"in a&&a.formTemplate?(a.formTemplate.elements?.filter(A)??[]).some(({fieldName:b})=>!a.fieldsIndex.get(b)):!1};c.formatDateFieldValue=v;c.getComputedAttributes=u;c.getErrorMessageForFieldInput=(a,b)=>
{const {dataType:d,domain:e,error:f,field:g,minLength:q,value:G,required:H}=a;return b&&f?H&&null===G?b.validationErrors.cannotBeNull:f===m.DomainValidationError.VALUE_OUT_OF_RANGE||f===l.NumericRangeValidationError.OUT_OF_RANGE?(a=m.getDomainRange(e)||l.getFieldRange(g),t.substitute(b.validationErrors.outsideRange,a,{format:{max:"date"===d?E:x(a.max)?D:C,min:"date"===d?E:x(a.min)?D:C}})):f===m.DomainValidationError.INVALID_CODED_VALUE?b.validationErrors.invalidCodedValue:f===l.TypeValidationError.INVALID_TYPE?
b.validationErrors.invalidType:f===c.LengthValidationError.TOO_SHORT?t.substitute(b.validationErrors.tooShort,{min:q}):null:null};c.getFieldsInTitleAndDesc=a=>{const b=[];if(a.formTemplate){const {description:d,title:e}=a.formTemplate;a.fields?.forEach(f=>{const g=e&&h.templateHasKey(e,f.name),q=d&&h.templateHasKey(d,f.name);(g||q)&&b.push(f.name)})}return b};c.getIconForFeature=a=>{if(a){var b=a.layer;b=b&&"geometryType"in b?b.geometryType:void 0;a=a.geometry?.type;return"polyline"===a||"polyline"===
b?"line":a||b||"table"}};c.getNormalizedFeatureTypeInfo=a=>a?"subtype-sublayer"===a.type?{typeFieldName:a.parent?.subtypeField,types:a.parent?.subtypes??[]}:"types"in a&&a.types?{typeFieldName:a.typeIdField,types:a.types.map(({id:b,name:d,domains:e})=>({code:b,name:d,domains:e}))}:B:B;c.isFieldElement=A;c.isFieldElementWithInputType=p;c.isFieldElementWithTextInput=a=>null!=a&&(p(a,"text-box")||p(a,"text-area"));c.isFieldInput=y;c.isGroupElement=a=>"group"===a.type;c.isGroupInput=a=>"group"===a?.type;
c.isInputInGroupInput=a=>"group"!==a?.type&&null!=a.group;c.isNumberFieldInput=({domain:a,inputType:b="text-box",dataType:d})=>"number"===d&&"text-box"===b&&(!a||"coded-value"!==a.type);c.isRelationshipElement=a=>"relationship"===a.type;c.isRelationshipInput=z;c.isTemplateItemGroup=a=>"items"in a;c.parseFormTemplateString=function(a,b,d){var e=Object.keys(b).filter(g=>h.templateHasKey(a,g));const f=e.map(g=>b[g]);e=e.map(g=>d.get(g)).filter(F.isSome);return w(a,u(f,e))};c.substituteFieldTemplatesInString=
w;c.unsupportedDateFieldTypes=r;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})});
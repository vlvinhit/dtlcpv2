// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/arrayUtils ../../core/maybe ../../core/uid ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/has ../../core/accessorSupport/decorators/subclass ../Widget ./componentsUtils ./widgetUtils ./decorators/messageBundle ./jsxFactory ./SnappingControls/SnappingControlsViewModel".split(" "),function(k,r,g,w,t,x,l,y,f,z,A,B,H,C,d,D){const u={header:!0,enabledToggle:!0,
selfEnabledToggle:!0,featureEnabledToggle:!0,layerList:!0,layerListToggleLayersButton:!0};f=function(v){function q(a,b){var c=v.call(this,(()=>{const {view:h,viewModel:n,snappingOptions:p,...m}=a;return m})(),b)||this;c._defaultViewModel=null;c._layerListFilter=null;c.iconClass="esri-icon-vertex-gps";c.icon=null;c.layerListOpen=!0;c.messages=null;c.visibleElements={...u};c._onToggleLayersButtonClick=h=>{c.viewModel.toggleSnappingForAllLayers(!c.viewModel.allLayersEnabled);requestAnimationFrame(()=>
h.target.setFocus())};a?.viewModel?c.viewModel=a.viewModel:(c._defaultViewModel=new D({snappingOptions:a.snappingOptions,view:a.view}),c.viewModel=c._defaultViewModel);return c}r._inherits(q,v);var e=q.prototype;e.destroy=function(){this._defaultViewModel=t.destroyMaybe(this._defaultViewModel)};e.loadDependencies=function(){return B.loadCalciteComponents({accordion:()=>new Promise((a,b)=>k(["../../chunks/calcite-accordion"],a,b)),"accordion-item":()=>new Promise((a,b)=>k(["../../chunks/calcite-accordion-item"],
a,b)),action:()=>new Promise((a,b)=>k(["../../chunks/calcite-action"],a,b)),block:()=>new Promise((a,b)=>k(["../../chunks/calcite-block"],a,b)),button:()=>new Promise((a,b)=>k(["../../chunks/calcite-button"],a,b)),icon:()=>new Promise((a,b)=>k(["../../chunks/calcite-icon"],a,b)),input:()=>new Promise((a,b)=>k(["../../chunks/calcite-input"],a,b)),label:()=>new Promise((a,b)=>k(["../../chunks/calcite-label"],a,b)),list:()=>new Promise((a,b)=>k(["../../chunks/calcite-list"],a,b)),"list-item":()=>new Promise((a,
b)=>k(["../../chunks/calcite-list-item"],a,b)),panel:()=>new Promise((a,b)=>k(["../../chunks/calcite-panel"],a,b)),switch:()=>new Promise((a,b)=>k(["../../chunks/calcite-switch"],a,b))})};e.castVisibleElements=function(a){return{...u,...a}};e.render=function(){const {label:a,visibleElements:{header:b}}=this;return d.tsx("div",{"aria-label":a,class:this.classes("esri-snapping-controls","esri-widget")},d.tsx("div",{class:"esri-snapping-controls__container"},b?this._renderHeaderView():this._renderContent()))};
e._renderHeaderView=function(){return d.tsx("calcite-panel",{heading:this.label,class:"esri-snapping-controls__panel"},this._renderContent())};e._renderContent=function(){return[this._renderToggles(),this._renderLayerList()]};e._renderToggles=function(){const {visibleElements:{enabledToggle:a,selfEnabledToggle:b,featureEnabledToggle:c}}=this;return a||b||c?d.tsx("calcite-block",{class:"esri-snapping-controls__toggle-block",key:"toggle-block",heading:"",open:!0},this._renderEnabledToggle(),d.tsx("div",
{class:"esri-snapping-controls__nested-container"},this._renderSelfEnabledToggle(),this._renderFeatureEnabledToggle())):null};e._renderEnabledToggle=function(){if(!this.visibleElements.enabledToggle)return null;const {messages:{enableSnapping:a},viewModel:{snappingOptions:{enabled:b,enabledToggled:c}}}=this;return d.tsx("calcite-label",{layout:"inline-space-between"},a,d.tsx("calcite-switch",{checked:b,disabled:c,bind:this,onCalciteSwitchChange:this._enableSnappingSwitchChange}))};e._renderSelfEnabledToggle=
function(){if(!this.visibleElements.selfEnabledToggle)return null;const {messages:{geometryGuides:a},viewModel:{snappingOptions:{enabled:b,selfEnabled:c,enabledToggled:h}}}=this;return d.tsx("calcite-label",{layout:"inline-space-between",key:"self-enabled-toggle"},a,d.tsx("calcite-switch",{checked:c,disabled:h||!b,bind:this,onCalciteSwitchChange:this._selfEnabledSwitchChange}))};e._renderFeatureEnabledToggle=function(){if(!this.visibleElements.featureEnabledToggle)return null;const {messages:{featureToFeature:a},
viewModel:{snappingOptions:{enabled:b,featureEnabled:c,enabledToggled:h}}}=this;return d.tsx("calcite-label",{layout:"inline-space-between",key:"feature-enabled-toggle"},a,d.tsx("calcite-switch",{checked:c,disabled:h||!b,bind:this,onCalciteSwitchChange:this._featureEnabledSwitchChange}))};e._renderLayerList=function(){if(!this.visibleElements.layerList)return null;const {messages:a,viewModel:b}=this,{snappingOptions:{enabled:c,enabledToggled:h}}=b;var n=({target:{value:m}})=>this._layerListFilter=
""===m?null:new RegExp(m,"i");n=9<b.layerListViewModel.operationalItems.length?d.tsx("calcite-input",{class:"esri-snapping-controls__layer-list__filter",clearable:!0,placeholder:a?.searchLayers,onCalciteInputInput:n}):null;const p=h||!c;return d.tsx("calcite-block",{key:"list-block",heading:a.snappingLayers,disabled:p,class:"esri-snapping-controls__layer-list-block",collapsible:!0,open:this.layerListOpen&&!p,onCalciteBlockToggle:m=>this.layerListOpen=m.target.open},n,this._renderToggleLayersButton(),
d.tsx("calcite-list",{class:"esri-snapping-controls__layer-list"},this._renderLayerListItemCollection(b.layerListViewModel.operationalItems,this._layerListFilter)))};e._renderLayerListItemCollection=function(a,b){return a.map(c=>{if(b?this._itemTitleMatchesFilter(c,b):1)return 0<c.children.length?this._renderLayerListItemGroup(c):this._renderLayerListItem(c);const h=c.children.filter(n=>this._itemTitleMatchesFilter(n,b));return 0<h.length?this._renderLayerListItemGroup(c,h):null}).toArray().filter(w.isSome)};
e._renderToggleLayersButton=function(){if(!this.visibleElements.layerListToggleLayersButton)return null;const {viewModel:{allLayersEnabled:a},messages:b}=this,c=a?b.disableAllLayers:b.enableAllLayers;return d.tsx("calcite-button",{appearance:"transparent",class:"esri-snapping-controls__layer-list__button",label:c,name:"layer-toggle",scale:"m",onclick:this._onToggleLayersButtonClick},c)};e._renderLayerListItem=function(a){const {messages:{untitledLayer:b}}=this,c=a.enabled;return d.tsx("calcite-list-item",
{class:"esri-snapping-controls__layer-list__item",label:a.title||b,key:`${this.id}-list-item-${a.uid}`,onCalciteListItemSelect:()=>{this._handleLayerListItemChange({checked:!c,value:a.layer.id})}},d.tsx("calcite-icon",{icon:c?"check-square-f":"square",slot:"content-start",scale:"s"}))};e._renderLayerListItemGroup=function(a,b){const {allChildrenEnabled:c,children:h,hasChildrenEnabled:n,title:p}=a,m=this.messages,E=p||m.untitledLayer,F=p&&""!==p?p:x.generateUID(),G=b??h;return d.tsx("calcite-list-item",
{class:"esri-snapping-controls__layer-list__item",key:F},d.tsx("calcite-accordion",{class:"esri-snapping-controls__layer-list__group",appearance:"transparent"},d.tsx("calcite-accordion-item",{expanded:!!b,heading:E,key:a.uid},d.tsx("calcite-action",{scale:"m",slot:"actions-start",text:c?m.disableAllLayers:m.enableAllLayers,textEnabled:!1,onclick:()=>{this.viewModel.toggleSnappingForLayers(a.childLayerIds,!c)}},d.tsx("calcite-icon",{icon:c?"check-square-f":n?"minus-square":"square",scale:"s"})),d.tsx("calcite-list",
null,[...this._renderLayerListItemCollection(G)]))))};e._enableSnappingSwitchChange=function(a){this.snappingOptions.enabled=a.target.checked};e._featureEnabledSwitchChange=function(a){this.snappingOptions.featureEnabled=a.target.checked};e._itemTitleMatchesFilter=function(a,b){return null!=b&&b.test(a.title)};e._selfEnabledSwitchChange=function(a){this.snappingOptions.selfEnabled=a.target.checked};e._handleLayerListItemChange=async function(a){a.checked?this.viewModel.enableSnappingForLayer(a.value):
this.viewModel.disableSnappingForLayer(a.value)};r._createClass(q,[{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(a){this._overrideIfSome("label",a)}},{key:"snappingOptions",get:function(){return this.viewModel.snappingOptions},set:function(a){this.viewModel.snappingOptions=a}},{key:"view",get:function(){return this.viewModel.view},set:function(a){this.viewModel.view=a}},{key:"viewModel",set:function(a){if(a!==this._get("viewModel")){if(null==this._defaultViewModel||
this._defaultViewModel!==a)this._defaultViewModel=t.destroyMaybe(this._defaultViewModel);this._set("viewModel",a)}}}]);return q}(A);g.__decorate([l.property()],f.prototype,"_defaultViewModel",void 0);g.__decorate([l.property()],f.prototype,"_layerListFilter",void 0);g.__decorate([l.property()],f.prototype,"iconClass",void 0);g.__decorate([l.property()],f.prototype,"icon",void 0);g.__decorate([l.property()],f.prototype,"label",null);g.__decorate([l.property()],f.prototype,"layerListOpen",void 0);g.__decorate([l.property(),
C.messageBundle("esri/widgets/support/SnappingControls/t9n/SnappingControls")],f.prototype,"messages",void 0);g.__decorate([l.property()],f.prototype,"snappingOptions",null);g.__decorate([l.property()],f.prototype,"view",null);g.__decorate([l.property()],f.prototype,"viewModel",null);g.__decorate([l.property()],f.prototype,"visibleElements",void 0);g.__decorate([y.cast("visibleElements")],f.prototype,"castVisibleElements",null);return f=g.__decorate([z.subclass("esri.widgets.support.SnappingControls")],
f)});
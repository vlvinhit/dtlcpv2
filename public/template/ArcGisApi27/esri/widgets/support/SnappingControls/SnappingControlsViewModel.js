// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Error ../../../core/HandleOwner ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../views/interactive/snapping/FeatureSnappingLayerSource ../../LayerList/support/layerListUtils ./SnappingLayerListViewModel".split(" "),function(l,
d,c,n,p,g,f,v,w,x,q,r,t,u){c=function(m){function h(a){a=m.call(this,a)||this;a.layerListViewModel=new u.SnappingLayerListViewModel;a.snappingOptions=null;a.view=null;return a}l._inherits(h,m);var e=h.prototype;e.initialize=function(){this.handles.add([g.watch(()=>({viewModel:this.layerListViewModel,view:this.view}),({viewModel:a,view:b})=>{a.view=b},g.initial),g.watch(()=>({viewModel:this.layerListViewModel,sources:this.snappingOptions?.featureSources}),({viewModel:a,sources:b})=>{a.featureSnappingSources=
b},g.initial)])};e.toggleSnappingForLayers=function(a,b){a?.forEach(k=>b?this.enableSnappingForLayer(k):this.disableSnappingForLayer(k))};e.toggleSnappingForAllLayers=function(a){this.layerListViewModel.selectableItems.forEach(({layer:{id:b}})=>{a?this.enableSnappingForLayer(b):this.disableSnappingForLayer(b)})};e.enableSnappingForLayer=function(a){(this._findSnappingSourceForLayer(a)??this._makeSnappingSourceForLayer(a)).enabled=!0};e.disableSnappingForLayer=function(a){if(a=this._findSnappingSourceForLayer(a))a.enabled=
!1};e.updateEnabledFeatureSources=function(a){for(const b of this.snappingOptions.featureSources)t.canDisplayLayer(b.layer)&&(b.enabled=a.includes(b.layer.id))};e._findSnappingSourceForLayer=function(a){return this.snappingOptions.featureSources.find(b=>b.layer.id===a)};e._makeSnappingSourceForLayer=function(a){var b=this.layerListViewModel.operationalItemsFlat.find(k=>k.layer.id===a)?.layer;if(!b)throw new n("snapping-controls:layer-not-found",`cannot enable snapping for layer with id ${a} because no such layer was found in the view`);
b=new r({layer:b});this.snappingOptions.featureSources.add(b);return b};l._createClass(h,[{key:"allLayersEnabled",get:function(){return(this.layerListViewModel?.selectableItems??[]).every(a=>a.enabled)}},{key:"allLayersDisabled",get:function(){return(this.layerListViewModel?.selectableItems??[]).every(a=>!a.enabled)}},{key:"layersEnabledCount",get:function(){return this.layerListViewModel?.selectableItems?.filter(a=>a.enabled).length??0}},{key:"state",get:function(){return this.get("snappingOptions")?
"ready":"disabled"}}]);return h}(p.HandleOwnerMixin(c));d.__decorate([f.property()],c.prototype,"allLayersEnabled",null);d.__decorate([f.property()],c.prototype,"allLayersDisabled",null);d.__decorate([f.property({constructOnly:!0})],c.prototype,"layerListViewModel",void 0);d.__decorate([f.property()],c.prototype,"layersEnabledCount",null);d.__decorate([f.property()],c.prototype,"snappingOptions",void 0);d.__decorate([f.property()],c.prototype,"state",null);d.__decorate([f.property()],c.prototype,
"view",void 0);return c=d.__decorate([q.subclass("esri.widgets.support.SnappingControls.SnappingControlsViewModel")],c)});
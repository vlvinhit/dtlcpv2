// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../symbols ../../../core/Collection ../../../core/Evented ../../../core/Handles ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../layers/GraphicsLayer ../../Sketch/SketchViewModel ./selectorUtils ../../../symbols/SimpleFillSymbol ../../../symbols/SimpleLineSymbol ../../../symbols/SimpleMarkerSymbol".split(" "),
function(r,e,c,v,w,x,y,f,G,H,I,z,A,B,C,D,E,F){c=function(u){function m({candidates:b,options:d,view:k}){var a=u.call(this)||this;a._activeOptions=null;a._dashedFillSymbol=new D({color:[0,0,0,0],outline:{style:"dash",color:[12,207,255],width:2}});a._dashedLineSymbol=new E({style:"dash",color:[12,207,255],width:2});a._defaultOptions={createTool:"rectangle",createOptions:void 0,selectionOptions:{overlaps:!0,intersects:!0,contains:!1}};a._completed=!1;a._handles=new x;a._sketchViewModel=new B;a._sketchGraphicsLayer=
new A({listMode:"hide",internal:!0});a._transparentPointSymbol=new F({color:[0,0,0,0],outline:{style:"none",width:0}});a.candidates=null;a.geometry=null;a.options=null;a.selection=new v;a.view=null;a.candidates=b;a.options=d;a.view=k;const {_dashedFillSymbol:n,_dashedLineSymbol:p,_sketchViewModel:l,_sketchGraphicsLayer:q,_transparentPointSymbol:g}=r._assertThisInitialized(a);l.set({layer:q,view:a.view,activePointSymbol:g,activeLineSymbol:p,activeVertexSymbol:g,activeFillSymbol:n,pointSymbol:g,polygonSymbol:n,
polylineSymbol:p,vertexSymbol:g});a._handles.add([l.on("create",t=>a._onSketchEvent(t)),l.on(["undo","redo"],t=>a._onSketchEvent(t))]);return a}r._inherits(m,u);var h=m.prototype;h.initialize=function(){this._load()};h.destroy=function(){this._handles=y.destroyMaybe(this._handles)};h.cancel=function(){return this._sketchViewModel.cancel()};h._load=async function(){await this.view?.whenReady();const {options:b}=this,{createTool:d,createOptions:k}=this._activeOptions={...this._defaultOptions,...b};
this._sketchViewModel.create(d,k)};h._onSketchEvent=function(b){this._processSelectionGeometry(("create"===b.type?b.graphic:b.graphics[0])?.geometry||null,"create"===b.type&&"complete"===b.state,"create"===b.type&&"cancel"===b.state)};h._processSelectionGeometry=function(b,d,k){this._set("geometry",b);if(d||k)this._completed=!0;if(k)this._onComplete([],!0);else{var {_activeOptions:a,candidates:n,selection:p,view:l}=this;C.updateSelection({selector:b,candidates:n,currentSelection:p,options:a.selectionOptions,
view:l}).then(({added:q,removed:g})=>{d?this._onComplete(this.selection.toArray(),!1):(q.length||g.length)&&this.emit("selection-change",{added:q,removed:g,type:"selection-change"})})}};h._onComplete=function(b,d){this._handles.removeAll();this.notifyChange("state");this.emit("complete",{aborted:d,selection:b,type:"complete"})};r._createClass(m,[{key:"state",get:function(){const {_completed:b,_sketchViewModel:{state:d}}=this;return b?"complete":"active"===d?"active":"disabled"}}]);return m}(w.EventedAccessor);
e.__decorate([f.property()],c.prototype,"_completed",void 0);e.__decorate([f.property()],c.prototype,"candidates",void 0);e.__decorate([f.property({readOnly:!0})],c.prototype,"geometry",void 0);e.__decorate([f.property()],c.prototype,"options",void 0);e.__decorate([f.property({readOnly:!0})],c.prototype,"selection",void 0);e.__decorate([f.property({readOnly:!0})],c.prototype,"state",null);e.__decorate([f.property({value:null})],c.prototype,"view",void 0);return c=e.__decorate([z.subclass("esri.widgets.support.Selector2D.SelectionOperation2D")],
c)});
// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
require({cache:{"esri/smartMapping/statistics/support/utils":function(){define("exports ../../../geometry ../../../core/Error ../../../core/screenUtils ../../../geometry/SpatialReference ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ../../../layers/support/fieldUtils ../../../renderers/support/heatmapUtils ../../../statistics/utils ../../../support/arcadeOnDemand ../../../geometry/Point".split(" "),function(p,r,H,n,x,M,P,N,K,A,C,E){function m(l,t){l=null!=
l?l:"";null!=t&&t&&(l=l?"("+l+") AND ("+t+")":t);return l}function w(l){const t=l.layer;return l.fields.filter(q=>!t.getField(q))}function D(l){const t=l.layer;return l.fields.filter(q=>{q=t.getFieldUsageInfo(q);return!q||!q.supportsStatistics})}let z=null;p.calculateHeatmapStats=function(l,t=18,q,u,B,F){const d=new Float64Array(B*F);t=Math.round(n.pt2px(t));let f=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY;var a=0;let c=0,e=0,k=0;q=K.createValueFunction(u,q);for(const {geometry:G,attributes:O}of l){const {x:J,
y:L}=G;l=Math.max(0,J-t);a=Math.max(0,L-t);u=Math.min(F,L+t);const S=Math.min(B,J+t),R=+q(O);for(let T=a;T<u;T++)for(let U=l;U<S;U++){a=T*B+U;const V=K.evaluateDensityKernel(U-J,T-L,t);var y=d[a];a=d[a]+=V*R;y=a-y;c+=y;e+=y*y;a<f&&(f=a);a>g&&(g=a);k++}}return k?{mean:c/k,stdDev:Math.sqrt((e-c*c/k)/k),min:f,max:g,mid:(g-f)/2,count:k}:{mean:0,stddev:0,min:0,max:0,mid:0,count:0}};p.getDataValues=async function(l,t){if(!t)return[];const {field:q,field2:u,field3:B,fieldDelimiter:F}=l,d=l.valueExpression,
f=l.normalizationType,g=l.normalizationField,a=l.normalizationTotal,c=[],e=l.viewInfoParams;let k=null,y=null;if(d){if(!z){const {arcadeUtils:O}=await C.loadArcade();z=O}z.hasGeometryOperations(d)&&await z.enableGeometryOperations();k=z.createFunction(d);y=e&&z.getViewInfo({viewingMode:e.viewingMode,scale:e.scale,spatialReference:new x(e.spatialReference)})}l=l.fieldInfos;const G=t[0]&&"declaredClass"in t[0]&&"esri.Graphic"===t[0].declaredClass||!l?null:{fields:l};t.forEach(O=>{var J=O.attributes;
if(d){var L=z.createExecContext(G?{...O,layer:G}:O,y);L=z.executeFunction(k,L)}else J&&(L=J[q],u&&(L=`${A.processNullValue(L)}${F}${A.processNullValue(J[u])}`,B&&(L=`${L}${F}${A.processNullValue(J[B])}`)));f&&"number"===typeof L&&isFinite(L)&&(J=J&&parseFloat(J[g]),L=A.getNormalizedValue(L,f,J,a));c.push(L)});return c};p.getRangeExpr=function(l,t,q){t=null!=t?l+" \x3e\x3d "+t:"";l=null!=q?l+" \x3c\x3d "+q:"";q="";return(q=t&&l?m(t,l):t||l)?"("+q+")":""};p.getSQLFilterForNormalization=function(l){const t=
l.field,q=l.normalizationType;l=l.normalizationField;let u;if("field"===q)u="(NOT "+l+" \x3d 0)";else if("log"===q||"natural-log"===q||"square-root"===q)u=`(${t} > 0)`;return u};p.getSumOfAttributesExpr=function(l,t,q){const u=[],B=[],F=[],d=[],f=[];l.forEach((c,e)=>{const k=c.field?"field":"expression",y=c.field||c.valueExpression;c.field?(f.push(y),B.push(`var ${k}${e} = Number($feature["${y}"]);`)):(u.push(`function getValueForExpr${e}() {\n  ${y} \n}`),B.push(`var ${k}${e} = Number(getValueForExpr${e}());`));
q||F.push(`${k}${e} = IIf(${k}${e} < 0, 0, ${k}${e});`);d.push(`${k}${e}`)});l="return sum;";const g=u.length?null:f.reduce((c,e)=>`${c} + ${e}`);let a=null;t||q?t?q||(l="return IIf(sum \x3e\x3d 0, sum, null);",g&&(a=`(( ${g} ) >= 0)`)):(l="return IIf(sum !\x3d 0, sum, null);",g&&(a=`(( ${g} ) <> 0)`)):(l="return IIf(sum \x3e 0, sum, null);",g&&(a=`(( ${g} ) > 0)`));return{valueExpression:[u.length?u.join("\n"):"",B.join("\n"),F.join("\n"),`var sum = ${d.join(" + ")};`,l].filter(Boolean).join("\n\n"),
sqlExpression:g,sqlWhere:a}};p.mergeWhereClauses=m;p.quantizeFeatures=function(l,t,q,u){const B=P.isWrappable(q)?P.getInfo(q):null,F=B?Math.round((B.valid[1]-B.valid[0])/t.scale[0]):null;return l.map(d=>{const f=new E(d.geometry);M.quantizePoint(t,f,f,f.hasZ,f.hasM);if(B){var g=F??0,a=u[0];0>f.x?f.x+=g:f.x>a&&(f.x-=g)}d.geometry=f;return d})};p.verifyBasicFieldValidity=function(l,t,q){const u=w({layer:l,fields:t});if(u.length)return new H(q,"Unknown fields: "+u.join(", ")+". You can only use fields defined in the layer schema");
l=D({layer:l,fields:t});if(l.length)return new H(q,"Unsupported fields: "+l.join(", ")+". You can only use fields that can be fetched i.e. AdapterFieldUsageInfo.supportsStatistics must be true")};p.verifyFieldType=function(l,t,q,u){let B;t?t.name!==l.objectIdField&&u.includes(t.type)||(B=new H(q,"'field' should be one of these types: "+u.join(","))):B=new H(q,"'field' is not defined in the layer schema");return B};p.verifyFilterValidty=function(l,t){if(l&&"intersects"!==l.spatialRelationship)return new H(t,
"Only 'intersects' spatialRelationship is supported for featureFilter")};p.verifyNumericField=function(l,t,q){let u;t?t.name!==l.objectIdField&&N.isNumericField(t)||(u=new H(q,"'field' should be one of these numeric types: "+N.numericTypes.join(","))):u=new H(q,"'field' is not defined in the layer schema");return u};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/core/screenUtils":function(){define(["exports"],function(p){function r(n){return n?72*n/96:0}const H=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i;
p.castRenderScreenPointArray=function(n){return n};p.castRenderScreenPointArray3=function(n){return n};p.castScreenPointArray=function(n){return n};p.createRenderScreenPoint=function(n=0,x=0){return{x:n,y:x}};p.createRenderScreenPointArray=function(n=0,x=0){return[n,x]};p.createRenderScreenPointArray3=function(n=0,x=0,M=0){return[n,x,M]};p.createScreenPoint=function(n=0,x=0){return{x:n,y:x}};p.createScreenPointArray=function(n=0,x=0){return[n,x]};p.pt2px=function(n){return n?n/72*96:0};p.px2pt=r;
p.screenPointArrayToObject=function(n,x){return x?(x.x=n[0],x.y=n[1],x):{x:n[0],y:n[1]}};p.screenPointObjectToArray=function(n,x){return x?(x[0]=n.x,x[1]=n.y,2<x.length&&(x[2]=0),x):[n.x,n.y]};p.toPt=function(n){if("string"===typeof n){var x=n.match(H);if(x){var M=Number(x[1]);x=x[3]&&x[3].toLowerCase();n="-"===n.charAt(0);M="px"===x?r(M):M;return n?-M:M}console.warn("screenUtils.toPt: input not recognized!");return null}return n};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/quantizationUtils":function(){define(["exports",
"./jsonUtils"],function(p,r){function H({scale:a,translate:c},e){return Math.round((e-c[0])/a[0])}function n({scale:a,translate:c},e){return Math.round((c[1]-e)/a[1])}function x(a,c,e){const k=[];let y,G,O,J;for(let L=0;L<e.length;L++){const S=e[L];if(0<L){if(O=H(a,S[0]),J=n(a,S[1]),O!==y||J!==G)k.push(c(S,O-y,J-G)),y=O,G=J}else y=H(a,S[0]),G=n(a,S[1]),k.push(c(S,y,G))}return 0<k.length?k:null}function M(a,c,e,k){return x(a,e?k?g:f:k?f:d,c)}function P(a,c,e,k){const y=[];e=e?k?g:f:k?f:d;for(k=0;k<
c.length;k++){const G=x(a,e,c[k]);G&&3<=G.length&&y.push(G)}return y.length?y:null}function N(a,c,e,k){const y=[];e=e?k?g:f:k?f:d;for(k=0;k<c.length;k++){const G=x(a,e,c[k]);G&&2<=G.length&&y.push(G)}return y.length?y:null}function K({scale:a,translate:c},e){return e*a[0]+c[0]}function A({scale:a,translate:c},e){return c[1]-e*a[1]}function C(a,c,e){const k=Array(e.length);if(!e.length)return k;const [y,G]=a.scale;let O=K(a,e[0][0]);a=A(a,e[0][1]);k[0]=c(e[0],O,a);for(let J=1;J<e.length;J++){const L=
e[J];O+=L[0]*y;a-=L[1]*G;k[J]=c(L,O,a)}return k}function E(a,c,e){const k=Array(e.length);for(let y=0;y<e.length;y++)k[y]=C(a,c,e[y]);return k}function m(a,c,e,k){return C(a,e?k?g:f:k?f:d,c)}function w(a,c,e,k){return E(a,e?k?g:f:k?f:d,c)}function D(a,c,e,k){return E(a,e?k?g:f:k?f:d,c)}function z(a,c,e){let [k,y]=e[0],G=Math.min(k,c[0]),O=Math.min(y,c[1]),J=Math.max(k,c[2]);c=Math.max(y,c[3]);for(let L=1;L<e.length;L++){const [S,R]=e[L];k+=S;y+=R;0>S&&(G=Math.min(G,k));0<S&&(J=Math.max(J,k));0>R?
O=Math.min(O,y):0<R&&(c=Math.max(c,y))}a[0]=G;a[1]=O;a[2]=J;a[3]=c;return a}function l(a,c){if(!c.length)return null;a[0]=a[1]=Number.POSITIVE_INFINITY;a[2]=a[3]=Number.NEGATIVE_INFINITY;for(let e=0;e<c.length;e++)z(a,a,c[e]);return a}function t(a,c,e,k,y){c.xmin=H(a,e.xmin);c.ymin=n(a,e.ymin);c.xmax=H(a,e.xmax);c.ymax=n(a,e.ymax);c!==e&&(k&&(c.zmin=e.zmin,c.zmax=e.zmax),y&&(c.mmin=e.mmin,c.mmax=e.mmax));return c}function q(a,c,e,k,y){c.points=M(a,e.points,k,y)??[];return c}function u(a,c,e,k,y){c.x=
H(a,e.x);c.y=n(a,e.y);c!==e&&(k&&(c.z=e.z),y&&(c.m=e.m));return c}function B(a,c,e,k,y){a=P(a,e.rings,k,y);if(!a)return null;c.rings=a;return c}function F(a,c,e,k,y){a=N(a,e.paths,k,y);if(!a)return null;c.paths=a;return c}const d=(a,c,e)=>[c,e],f=(a,c,e)=>[c,e,a[2]],g=(a,c,e)=>[c,e,a[2],a[3]];p.equals=function(a,c){if(a===c||null==a&&null==c)return!0;if(null==a||null==c)return!1;let e,k,y,G;a&&"upperLeft"===a.originPosition?(e=a.translate[0],k=a.translate[1],a=a.scale[0]):(e=null!=a.extent?a.extent.xmin:
0,k=null!=a.extent?a.extent.ymax:0,a=a.tolerance);c&&"upperLeft"===c.originPosition?(y=c.translate[0],G=c.translate[1],c=c.scale[0]):(y=null!=c.extent?c.extent.xmin:0,G=null!=c.extent?c.extent.ymax:0,c=c.tolerance);return e===y&&k===G&&a===c};p.getQuantizedBoundsCoordsArray=z;p.getQuantizedBoundsCoordsArrayArray=l;p.getQuantizedBoundsPaths=function(a){return l([0,0,0,0],a)};p.getQuantizedBoundsPoints=function(a){const c=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];
return z(c,c,a)};p.getQuantizedBoundsRings=function(a){return l([0,0,0,0],a)};p.quantizeBounds=function(a,c,e){c[0]=H(a,e[0]);c[3]=n(a,e[1]);c[2]=H(a,e[2]);c[1]=n(a,e[3]);return c};p.quantizeExtent=t;p.quantizeGeometry=function(a,c){return a&&c?r.isPoint(c)?u(a,{},c,!1,!1):r.isPolyline(c)?F(a,{},c,!1,!1):r.isPolygon(c)?B(a,{},c,!1,!1):r.isMultipoint(c)?q(a,{},c,!1,!1):r.isExtent(c)?t(a,{},c,!1,!1):null:null};p.quantizeMultipoint=q;p.quantizePaths=N;p.quantizePoint=u;p.quantizePoints=M;p.quantizePolygon=
B;p.quantizePolyline=F;p.quantizeRings=P;p.quantizeX=H;p.quantizeY=n;p.toQuantizationTransform=function(a){return a?{originPosition:"upper-left"===a.originPosition?"upperLeft":"lower-left"===a.originPosition?"lowerLeft":a.originPosition,scale:a.tolerance?[a.tolerance,a.tolerance]:[1,1],translate:null!=a.extent?[a.extent.xmin,a.extent.ymax]:[0,0]}:null};p.unquantizeBounds=function(a,c,e){return e?(c[0]=K(a,e[0]),c[1]=A(a,e[3]),c[2]=K(a,e[2]),c[3]=A(a,e[1]),c):[K(a,c[0]),A(a,c[3]),K(a,c[2]),A(a,c[1])]};
p.unquantizeCoordsArray=C;p.unquantizeCoordsArrayArray=E;p.unquantizeExtent=function(a,c,e,k,y){c.xmin=K(a,e.xmin);c.ymin=A(a,e.ymin);c.xmax=K(a,e.xmax);c.ymax=A(a,e.ymax);c!==e&&(k&&(c.zmin=e.zmin,c.zmax=e.zmax),y&&(c.mmin=e.mmin,c.mmax=e.mmax));return c};p.unquantizeMultipoint=function(a,c,e,k,y){null!=e&&(c.points=m(a,e.points,k,y));return c};p.unquantizePaths=w;p.unquantizePoint=function(a,c,e,k,y){if(null==e)return c;c.x=K(a,e.x);c.y=A(a,e.y);c!==e&&(k&&(c.z=e.z),y&&(c.m=e.m));return c};p.unquantizePoints=
m;p.unquantizePolygon=function(a,c,e,k,y){null!=e&&(c.rings=D(a,e.rings,k,y));return c};p.unquantizePolyline=function(a,c,e,k,y){null!=e&&(c.paths=w(a,e.paths,k,y));return c};p.unquantizeRings=D;p.unquantizeX=K;p.unquantizeY=A;Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/fieldUtils":function(){define("require exports ../../core/Error ../../core/object ./domainUtils ../../support/arcadeOnDemand".split(" "),function(p,r,H,n,x,M){function P(b,h,v){if(b)for(const I of b)(b=
(b=n.getDeepValue(I,h))&&"function"!==typeof b&&v.get(b))&&n.setDeepValue(I,b.name,h)}function N(b,h){if(!b||!h)return[];V.clear();K(V,b,h);return Array.from(V).sort()}function K(b,h,v){if(v)if(h?.fields?.length)if(v.includes("*"))for(const {name:I}of h.fields)b.add(I);else for(const I of v)A(b,h,I);else if(v.includes("*"))b.clear(),b.add("*");else for(const I of v)null!=I&&b.add(I)}function A(b,h,v){"string"===typeof v&&(h?(h=h.get(v))&&b.add(h.name):b.add(v))}async function C(b,h,v){if(v){var {arcadeUtils:I}=
await M.loadArcade();v=I.extractFieldNames(v,h?.fields?.map(Q=>Q.name));for(const Q of v)A(b,h,Q)}}async function E(b,h,v){if(v&&"1\x3d1"!==v){var {WhereClause:I}=await new Promise((Q,ea)=>p(["../../core/sql/WhereClause"],Q,ea));I=I.create(v,h);if(!I.isStandardized)throw new H("fieldUtils:collectFilterFields","Where clause is not standardized",{where:v});K(b,h,I.fieldNames)}}function m(b,h){for(const v of b)if(v&&v.valueType&&v.valueType===h)return v.name;return null}async function w(b,h){if(h){var v=
h.elevationInfo?.featureExpressionInfo;if(v)return v.collectRequiredFields(b,h.fieldsIndex)}}async function D(b,h,v){const I=[];v?.expressionInfos&&I.push(...v.expressionInfos.map(Q=>C(b,h.fieldsIndex,Q.expression)));v=v?.content;if(Array.isArray(v))for(const Q of v)"expression"===Q.type&&Q.expressionInfo&&I.push(C(b,h.fieldsIndex,Q.expressionInfo.expression));await Promise.all(I)}async function z(b,h,v){h&&v&&(v.valueExpression?await C(b,h.fieldsIndex,v.valueExpression):v.field&&A(b,h.fieldsIndex,
v.field))}function l(b){if(!b)return[];const h=b.geometryFieldsInfo;return h?N(b.fieldsIndex,[h.shapeAreaField,h.shapeLengthField]):[]}function t(b){const h=new Set;u(b).forEach(v=>h.add(v));l(b).forEach(v=>h.add(v.toLowerCase()));if(b=b&&"infoFor3D"in b?b.infoFor3D:void 0)Object.values(b.assetMapFieldRoles).forEach(v=>h.add(v.toLowerCase())),Object.values(b.transformFieldRoles).forEach(v=>h.add(v.toLowerCase()));return Array.from(h)}function q(b){if(!b)return[];b="editFieldsInfo"in b&&b.editFieldsInfo;
if(!b)return[];const {creationDateField:h,creatorField:v,editDateField:I,editorField:Q}=b;return[h,v,I,Q].filter(Boolean)}function u(b){return q(b).map(h=>h.toLowerCase())}async function B(b,h){const {labelingInfo:v,fieldsIndex:I}=h;v&&v.length&&await Promise.all(v.map(Q=>F(b,I,Q)))}async function F(b,h,v){if(v){var I=v.getLabelExpression();v=v.where;"arcade"===I.type?await C(b,h,I.expression):(I=I.expression.match(/{[^}]*}/g))&&I.forEach(Q=>{A(b,h,Q.slice(1,-1))});await E(b,h,v)}}function d(b){return"number"===
typeof b&&!isNaN(b)&&isFinite(b)}function f(b){return null===b||d(b)}function g(b){return null===b||W(b)}function a(b){return null!=b&&"string"===typeof b}function c(b){return null===b||a(b)}function e(){return!0}function k(b,h){let v;switch(b.type){case "date":case "integer":case "long":case "small-integer":case "esriFieldTypeDate":case "esriFieldTypeInteger":case "esriFieldTypeLong":case "esriFieldTypeSmallInteger":v=b.nullable?g:W;break;case "double":case "single":case "esriFieldTypeSingle":case "esriFieldTypeDouble":v=
b.nullable?f:d;break;case "string":case "esriFieldTypeString":v=b.nullable?c:a;break;default:v=e}return 1===arguments.length?v:v(h)}function y(b){return null!=b&&fa.has(b.type)}function G(b,h){return null==b||b.nullable&&null===h?null:y(b)&&!O(b.type,Number(h))?r.NumericRangeValidationError.OUT_OF_RANGE:k(b,h)?b.domain?x.validateDomainValue(b.domain,h):null:r.TypeValidationError.INVALID_TYPE}function O(b,h){b="string"===typeof b?J(b):b;if(!b)return!1;const v=b.min,I=b.max;return b.isInteger?W(h)&&
h>=v&&h<=I:h>=v&&h<=I}function J(b){switch(b){case "esriFieldTypeSmallInteger":case "small-integer":return X;case "esriFieldTypeInteger":case "integer":return Y;case "esriFieldTypeBigInteger":case "big-integer":return aa;case "esriFieldTypeSingle":case "single":return Z;case "esriFieldTypeDouble":case "double":return ba}}function L(b,h,v){if(!h||!h.attributes||!b){if(null!=v)for(var I of b??[])v.add(I);return!0}h=h.attributes;I=!1;for(const Q of b)if(!(Q in h))if(I=!0,null!=v)v.add(Q);else break;
return I}const S=/^([0-9_])/,R=/[^a-z0-9_\u0080-\uffff]+/gi,T="field field2 field3 normalizationField rotationInfo.field proportionalSymbolInfo.field proportionalSymbolInfo.normalizationField colorInfo.field colorInfo.normalizationField".split(" "),U=["field","normalizationField"],V=new Set,ha=["oid","global-id","guid"],ia=["oid","global-id"],ja=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/shape/i,/perimeter/i,/objectid/i,/_i$/i],
W=(()=>"isInteger"in Number?Number.isInteger:b=>"number"===typeof b&&isFinite(b)&&Math.floor(b)===b)(),ca=["integer","small-integer","single","double"],fa=new Set([...ca,"esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]),da=["date","date-only","time-only","timestamp-offset"],ka=new Set([...da,"esriFieldTypeDate","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]);r.NumericRangeValidationError=void 0;(r.NumericRangeValidationError||
(r.NumericRangeValidationError={})).OUT_OF_RANGE="numeric-range-validation-error::out-of-range";r.TypeValidationError=void 0;(r.TypeValidationError||(r.TypeValidationError={})).INVALID_TYPE="type-validation-error::invalid-type";const X={min:-32768,max:32767,isInteger:!0},Y={min:-2147483648,max:2147483647,isInteger:!0},aa={min:-Number.MAX_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER,isInteger:!0},Z={min:-3.4E38,max:1.2E38,isInteger:!1},ba={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1};r.bigIntegerRange=
aa;r.collectArcadeFieldNames=C;r.collectElevationFields=w;r.collectFeatureReductionFields=async function(b,h,v){if(h&&v&&"fields"in v){var I=[];I.push(D(b,h,v.popupTemplate));v.fields&&I.push(...v.fields.map(async Q=>{Q.onStatisticExpression?C(b,h.fieldsIndex,Q.onStatisticExpression.expression):b.add(Q.onStatisticField)}));await Promise.all(I)}};r.collectField=A;r.collectFields=K;r.collectFilterFields=async function(b,h,v){h&&(h.timeInfo&&null!=v&&v.timeExtent&&K(b,h.fieldsIndex,[h.timeInfo.startField,
h.timeInfo.endField]),h.floorInfo&&K(b,h.fieldsIndex,[h.floorInfo.floorField]),null!=v&&null!=v.where&&await E(b,h.fieldsIndex,v.where))};r.collectLabelingFields=B;r.collectOrderByInfos=async function(b,h,v){h&&v&&await Promise.all(v.map(I=>z(b,h,I)))};r.collectPopupTemplateFields=D;r.dateTypes=da;r.doubleRange=ba;r.featureHasFields=function(b,h){return!L(b,h,null)};r.fixFields=N;r.fixRendererFields=function(b,h){if(null!=b&&null!=h)for(const v of Array.isArray(b)?b:[b])if(P(T,v,h),"visualVariables"in
v&&v.visualVariables)for(const I of v.visualVariables)P(U,I,h)};r.fixTimeInfoFields=function(b,h){if(null!=b&&h?.fields?.length)if("startField"in b){var v=h.get(b.startField);h=h.get(b.endField);b.startField=v?.name??null;b.endField=h?.name??null}else v=h.get(b.startTimeField),h=h.get(b.endTimeField),b.startTimeField=v?.name??null,b.endTimeField=h?.name??null};r.getDisplayFieldName=function({displayField:b,fields:h}){if(b)return b;if(!h||!h.length)return null;if(!(b=m(h,"name-or-title")||m(h,"unique-identifier")||
m(h,"type-or-category")))a:{for(const v of h)if(v&&v.name&&(h=v.name.toLowerCase(),h.includes("name")||h.includes("title"))){b=v.name;break a}b=null}return b};r.getEditTrackingFields=q;r.getElevationFields=async function(b){if(!b)return[];const h=new Set;await w(h,b);return Array.from(h).sort()};r.getExpressionFields=async function(b,h){const v=new Set;for(const I of h)await C(v,b.fieldsIndex,I);return Array.from(v).sort()};r.getFeatureEditFields=function(b){return b?N(b.fieldsIndex,q(b)):[]};r.getFeatureGeometryFields=
l;r.getFieldDefaultValue=function(b){const h=b.defaultValue;if(void 0!==h&&k(b,h))return h;if(b.nullable)return null};r.getFieldRange=function(b){const h=x.getDomainRange(b.domain);if(h)return h;if(y(b))return J(b.type)};r.getLabelingFields=async function(b){if(!b)return[];const h=new Set;await B(h,b);return Array.from(h).sort()};r.getLowerCaseDefaultHiddenFields=t;r.getLowerCaseEditTrackingFields=u;r.getNumericTypeForValue=function(b){if(!d(b))return null;if(W(b)){if(b>=X.min&&b<=X.max)return"esriFieldTypeSmallInteger";
if(b>=Y.min&&b<=Y.max)return"esriFieldTypeInteger"}return b>=Z.min&&b<=Z.max?"esriFieldTypeSingle":"esriFieldTypeDouble"};r.getTimeFields=async function(b){if(!b)return[];const h="timeInfo"in b&&b.timeInfo;return h?N(b.fieldsIndex,[b.trackIdField,h.startField,h.endField]):[]};r.integerRange=Y;r.isDateField=function(b){return null!=b&&ka.has(b.type)};r.isFieldEditable=function(b,h){return b.editable&&!ha.includes(b.type)&&!u(h).includes(b.name?.toLowerCase()??"")};r.isFieldVisibleByDefault=function(b,
h){const v=b.name?.toLowerCase()??"";return!(null!=h?.objectIdField&&v===h.objectIdField.toLowerCase())&&!(null!=h?.globalIdField&&v===h.globalIdField.toLowerCase())&&!t(h).includes(v)&&!ia.includes(b.type)&&!ja.some(I=>I.test(v))};r.isNumberInRange=O;r.isNumericField=y;r.isRasterPixelValueField=function(b){return b?["raster.itempixelvalue","raster.servicepixelvalue"].some(h=>b.toLowerCase().startsWith(h)):!1};r.isStringField=function(b){return null!=b&&("string"===b.type||"esriFieldTypeString"===
b.type)};r.isValidFieldValue=function(b,h){return null===G(b,h)};r.isValueMatchingFieldType=k;r.normalizeFieldName=function(b){return null==b?null:b.trim().replaceAll(R,"_").replace(S,"F$1")||null};r.numericTypes=ca;r.packFields=function(b,h,v=1){if(!h||!b)return[];if(h.includes("*"))return["*"];h=N(b,h);return h.length/b.fields.length>=v?["*"]:h};r.populateMissingFields=L;r.rendererFields=T;r.sanitizeNullFieldValue=function(b){return null==b||"number"===typeof b&&isNaN(b)?null:b};r.singleRange=Z;
r.smallIntegerRange=X;r.unpackFieldNames=function(b,h){return null==h||null==b?[]:h.includes("*")?(b.fields??[]).map(v=>v.name):h};r.validateFieldValue=G;r.validationErrorToString=function(b,h,v){switch(b){case x.DomainValidationError.INVALID_CODED_VALUE:return`Value ${v} is not in the coded domain - field: ${h.name}, domain: ${JSON.stringify(h.domain)}`;case x.DomainValidationError.VALUE_OUT_OF_RANGE:return`Value ${v} is out of the range of valid values - field: ${h.name}, domain: ${JSON.stringify(h.domain)}`;
case r.TypeValidationError.INVALID_TYPE:return`Value ${v} is not a valid value for the field type - field: ${h.name}, type: ${h.type}, nullable: ${h.nullable}`;case r.NumericRangeValidationError.OUT_OF_RANGE:const {min:I,max:Q}=J(h.type);return`Value ${v} is out of range for the number type - field: ${h.name}, type: ${h.type}, value range is ${I} to ${Q}`}};r.visualVariableFields=U;Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/domainUtils":function(){define(["exports"],
function(p){p.DomainValidationError=void 0;(function(r){r.VALUE_OUT_OF_RANGE="domain-validation-error::value-out-of-range";r.INVALID_CODED_VALUE="domain-validation-error::invalid-coded-value"})(p.DomainValidationError||(p.DomainValidationError={}));p.getDomainRange=function(r){if(r&&"range"===r.type)return{min:"range"in r?r.range[0]:r.minValue,max:"range"in r?r.range[1]:r.maxValue}};p.validateDomainValue=function(r,H){switch(r.type){case "range":const n="range"in r?r.range[0]:r.minValue;r="range"in
r?r.range[1]:r.maxValue;if(null!=n&&+H<n||null!=r&&+H>r)return p.DomainValidationError.VALUE_OUT_OF_RANGE;break;case "coded-value":if(null==r.codedValues||r.codedValues.every(x=>null==x||x.code!==H))return p.DomainValidationError.INVALID_CODED_VALUE;break;case "codedValue":if(null==r.codedValues||r.codedValues.every(x=>null==x||x.code!==H))return p.DomainValidationError.INVALID_CODED_VALUE}return null};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/support/arcadeOnDemand":function(){define("require exports ../chunks/_rollupPluginBabelHelpers ../geometry ../core/Error ../core/Logger ../geometry/SpatialReference".split(" "),
function(p,r,H,n,x,M,P){function N(){A||(A=(async()=>{const E=await new Promise((m,w)=>p(["./arcadeUtils"],m,w));return{arcade:E.arcade,arcadeUtils:E,Dictionary:E.Dictionary,Feature:E.arcadeFeature}})());return A}const K=M.getLogger("esri.support.arcadeOnDemand");let A;n=(E,m,w)=>C.create(E,m,w,null,["$feature","$view"],[]);let C=function(){function E(w,D,z,l,t,q,u){this.services=null;this.script=w;this.evaluate=l;this.fields=Array.isArray(q)?q:q.fields;this._syntaxTree=z;this._arcade=D;this._arcadeFeature=
t;this._spatialReference=u;this._referencesGeometry=D.scriptTouchesGeometry(this._syntaxTree);this._referencesScale=this._arcade.referencesMember(this._syntaxTree,"scale")}E.create=async function(w,D,z,l,t,q){const {arcade:u,Feature:B,Dictionary:F}=await N(),d=P.fromJSON(D);let f;try{f=u.parseScript(w,q)}catch(y){return K.error(new x("arcade-bad-expression","Failed to parse arcade script",{script:w,error:y})),null}t=t.reduce((y,G)=>({...y,[G]:null}),{});let g=null;null!=l&&(g=new F(l),g.immutable=
!0,t.$config=null);q=(l=u.scriptUsesGeometryEngine(f))&&u.enableGeometrySupport();const a=u.scriptUsesFeatureSet(f)&&u.enableFeatureSetSupport(),c=(D=u.scriptIsAsync(f))&&u.enableAsyncSupport();t={vars:t,spatialReference:d,useAsync:!!c};await Promise.all([q,a,c]);q=new Set;await u.loadDependentModules(q,f,null,D,l);const e=new F;e.immutable=!1;e.setField("scale",0);const k=u.compileScript(f,t);return new E(w,u,f,(y,G)=>{"$view"in y&&y.$view&&(e.setField("scale","object"===typeof y.$view&&"scale"in
y.$view?y.$view.scale:void 0),y.$view=e);g&&(y.$config=g);return k({vars:y,spatialReference:d,services:G})},new B,z,d)};var m=E.prototype;m.repurposeFeature=function(w){w.geometry&&!w.geometry.spatialReference&&(w.geometry.spatialReference=this._spatialReference);this._arcadeFeature.repurposeFromGraphicLikeObject(w.geometry,w.attributes,{fields:this.fields});return this._arcadeFeature};m.referencesGeometry=function(){return this._referencesGeometry};m.referencesScale=function(){return this._referencesScale};
return H._createClass(E)}();r.ArcadeExpression=C;r.createDictionaryExpression=(E,m,w,D)=>C.create(E,m,w,D,["$feature","$view"],[]);r.createLabelExpression=(E,m,w)=>C.create(E,m,w,null,["$feature"],[]);r.createRendererExpression=n;r.createVVExpression=n;r.loadArcade=N;Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/heatmapUtils":function(){define(["exports","../../core/mathUtils","../../core/screenUtils","../../chunks/vec4","../../chunks/vec4f64"],function(p,
r,H,n,x){function M(A,C,E,m){let {color:w,ratio:D}=C,{color:z,ratio:l}=E;l===D&&(1===l?D-=1E-6:l+=1E-6);C=r.clamp((m-D)/(l-D),0,1);n.lerp(A,w.toArray(),z.toArray(),C)}function P(A,C,E,m,w){A=new Uint32Array(A*A);C="buffer"in C?C:new Float64Array(C);E="buffer"in E?new Uint32Array(E.buffer):new Uint32Array((new Uint8Array(E)).buffer);w=E.length/(w-m);for(let D=0;D<C.length;D++)A[D]=E[r.clamp(Math.floor((C[D]-m)*w),0,E.length-1)];return A.buffer}function N(A,C,E){A=Math.sqrt(A**2+C**2)/E;return 1<A?
0:3/(Math.PI*E**2)*(1-A**2)**2}function K(A,C){return null!=A?"string"===typeof C?E=>-1*+E.readAttribute(A):E=>+E.readAttribute(A)+C:E=>1}p.MAGIC_KERNEL_DENSITY_RADIUS_INFLATION_FACTOR=2.4;p.calculateHeatmapIntensityInfoReaders=function(A,C,E,m){const {radius:w,fieldOffset:D,field:z}=C;C=Math.round(H.pt2px(w));const l=new Float64Array(E*m);let t=Number.NEGATIVE_INFINITY;const q=K(z,D),u=new Set;for(const f of A)for(A=f.getCursor();A.next();){var B=A.getObjectId();if(u.has(B))continue;u.add(B);B=A.readLegacyPointGeometry();
if(-128>B.x||B.x>=E+128||-128>B.y||B.y>m+128)continue;const g=+q(A),a=Math.max(0,Math.round(B.x)-C);var F=Math.max(0,Math.round(B.y)-C);const c=Math.min(m,Math.round(B.y)+C),e=Math.min(E,Math.round(B.x)+C);for(;F<c;F++)for(let k=a;k<e;k++){var d=F*E+k;const y=N(B.x-k,B.y-F,C);d=l[d]+=y*g;d>t&&(t=d)}}return{matrix:l.buffer,max:t}};p.createHeatmapImageData=P;p.createValueFunction=function(A,C){return"function"===typeof A?A:A?"string"===typeof C?E=>-1*+E[A]:E=>+E[A]+C:()=>1};p.createValueFunctionCursor=
K;p.drawHeatmap=function(A,C,E,m,w,D){A.canvas.width=A.canvas.height=C;A.clearRect(0,0,C,C);const z=A.getImageData(0,0,C,C);E&&m&&z.data.set(new Uint8ClampedArray(P(C,E,m,w,D)));A.putImageData(z,0,0)};p.evaluateDensityKernel=N;p.gaussianBlurRadiusPxToKernelDensityRadiusPt=function(A){return H.px2pt(2.4*A)};p.generateGradient=function(A){const C=new Uint8ClampedArray(2048);A=A.filter(({ratio:z})=>0<=z&&1>=z).sort((z,l)=>z.ratio-l.ratio).map(({color:z,ratio:l})=>({color:z,ratio:Math.max(l,.001)}));
if(1>A.length)return C;let E=A[0],m=A[0],w=1;const D=x.create();for(let z=0;512>z;z++){const l=(z+.5)/512;for(;l>m.ratio&&w<A.length;)E=m,m=A[w++];M(D,E,m,l);C.set(D,4*z)}return C};p.kernelDensityRadiusPtToGaussianBlurRadiusPx=function(A){return H.pt2px(A)/2.4};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/vec4f64":function(){define(["exports"],function(p){function r(){return[0,0,0,0]}function H(u){return[u[0],u[1],u[2],u[3]]}function n(u,B,F,d){return[u,B,F,d]}function x(u){const B=
r(),F=Math.min(4,u.length);for(let d=0;d<F;++d)B[d]=u[d];return B}function M(u,B){return new Float64Array(u,B,4)}function P(){return r()}function N(){return[1,1,1,1]}function K(){return[1,0,0,0]}function A(){return[0,1,0,0]}function C(){return[0,0,1,0]}function E(){return[0,0,0,1]}const m=r(),w=N(),D=K(),z=A(),l=C(),t=E(),q=Object.freeze(Object.defineProperty({__proto__:null,ONES:w,UNIT_W:t,UNIT_X:D,UNIT_Y:z,UNIT_Z:l,ZEROS:m,clone:H,create:r,createView:M,fromArray:x,fromValues:n,ones:N,unitW:E,unitX:K,
unitY:A,unitZ:C,zeros:P},Symbol.toStringTag,{value:"Module"}));p.ONES=w;p.UNIT_W=t;p.UNIT_X=D;p.UNIT_Y=z;p.UNIT_Z=l;p.ZEROS=m;p.clone=H;p.create=r;p.createView=M;p.fromArray=x;p.fromValues=n;p.ones=N;p.unitW=E;p.unitX=K;p.unitY=A;p.unitZ=C;p.vec4f64=q;p.zeros=P})},"esri/statistics/utils":function(){define(["exports","../rest/support/ClassBreaksDefinition","../rest/support/generateRendererUtils"],function(p,r,H){function n(d){return null==d||"string"===typeof d&&!d?"\x3cNull\x3e":d}function x(d){const f=
null!=d.minValue||null!=d.maxValue,g=!!d.sqlExpression&&d.supportsSQLExpression;return!(null!=d.normalizationField||null!=d.normalizationType)&&!f&&!g}function M(d){const {values:f,useSampleStdDev:g,supportsNullCount:a}=d;var c=Number.POSITIVE_INFINITY;let e=Number.NEGATIVE_INFINITY,k=null,y=null;var G=null;let O=null,J=0;const L=null==d.minValue?-Infinity:d.minValue,S=null==d.maxValue?Infinity:d.maxValue;for(const R of f)Number.isFinite(R)?R>=L&&R<=S&&(k=null===k?R:k+R,c=Math.min(c,R),e=Math.max(e,
R),J++):"string"===typeof R&&J++;if(J&&null!=k){y=k/J;G=0;for(const R of f)Number.isFinite(R)&&R>=L&&R<=S&&(G+=(R-y)**2);O=g?1<J?G/(J-1):0:0<J?G/J:0;G=Math.sqrt(O)}else e=c=null;c={avg:y,count:J,max:e,min:c,stddev:G,sum:k,variance:O};a&&(c.nullcount=f.length-J);d.percentileParams&&(c.median=P(f,d.percentileParams));return c}function P(d,f){const {fieldType:g,value:a,orderBy:c,isDiscrete:e}=f,k=N(g,"desc"===c);d=[...d].filter(J=>null!=J).sort((J,L)=>k(J,L));if(0===d.length)return null;if(0>=a)return d[0];
if(1<=a)return d[d.length-1];var y=(d.length-1)*a,G=Math.floor(y);f=G+1;y%=1;G=d[G];const O=d[f];return f>=d.length||e||"string"===typeof G||"string"===typeof O?G:G*(1-y)+O*y}function N(d,f){const g=f?1:-1,a=C(f),c=A(f);if(!d||!["esriFieldTypeDate","esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID",...B].includes(d))return(e,k)=>"number"===typeof e&&"number"===typeof k?a(e,k):"string"===typeof e&&"string"===typeof k?c(e,k):g;if("esriFieldTypeDate"===d)return(e,k)=>{e=(new Date(e)).getTime();
k=(new Date(k)).getTime();return isNaN(e)||isNaN(k)?g:a(e,k)};if(B.has(d))return(e,k)=>a(e,k);if("esriFieldTypeString"===d)return(e,k)=>c(e,k);if("esriFieldTypeGUID"===d||"esriFieldTypeGlobalID"===d){const e=A(f);return(k,y)=>e(E(k),E(y))}return f?(e,k)=>1:(e,k)=>-1}function K(d,f,g){if(g){if(null==d)return null==f?0:1;if(null==f)return-1}else{if(null==d)return null==f?0:-1;if(null==f)return 1}return null}function A(d){return d?(f,g)=>{const a=K(f,g,!0);if(null!=a)return a;f=f.toUpperCase();g=g.toUpperCase();
return f>g?-1:f<g?1:0}:(f,g)=>{const a=K(f,g,!1);if(null!=a)return a;f=f.toUpperCase();g=g.toUpperCase();return f<g?-1:f>g?1:0}}function C(d){return d?(f,g)=>{const a=K(f,g,!0);return null!=a?a:g-f}:(f,g)=>{const a=K(f,g,!1);return null!=a?a:f-g}}function E(d){return d.substr(24,12)+d.substr(19,4)+d.substr(16,2)+d.substr(14,2)+d.substr(11,2)+d.substr(9,2)+d.substr(6,2)+d.substr(4,2)+d.substr(2,2)+d.substr(0,2)}function m(d){return"coded-value"!==d?.type?[]:d.codedValues.map(f=>f.code)}function w(d,
f){const g=z({field:f.field,normalizationType:f.normalizationType,normalizationField:f.normalizationField,classificationMethod:f.classificationMethod,standardDeviationInterval:f.standardDeviationInterval,breakCount:f.numClasses||5});d=D(d,f.minValue,f.maxValue);return H.createGenerateRendererClassBreaks({definition:g,values:d,normalizationTotal:f.normalizationTotal})}function D(d,f,g){const a=null==f?-Infinity:f,c=null==g?Infinity:g;return d.filter(e=>Number.isFinite(e)&&e>=a&&e<=c)}function z(d){const {breakCount:f,
field:g,normalizationField:a,normalizationType:c}=d,e=d.classificationMethod||"equal-interval";return new r({breakCount:f,classificationField:g,classificationMethod:e,normalizationField:"field"===c?a:void 0,normalizationType:c,standardDeviationInterval:"standard-deviation"===e?d.standardDeviationInterval||1:void 0})}function l(d,f){const {field:g,classificationMethod:a,standardDeviationInterval:c,normalizationType:e,normalizationField:k,normalizationTotal:y,minValue:G,maxValue:O}=f,J=f.numBins||10;
let L=f=null,S=null;a&&"equal-interval"!==a||e?({classBreaks:d}=w(d,{field:g,normalizationType:e,normalizationField:k,normalizationTotal:y,classificationMethod:a,standardDeviationInterval:c,minValue:G,maxValue:O,numClasses:J}),f=d[0].minValue,L=d[d.length-1].maxValue,S=d.map(R=>[R.minValue,R.maxValue])):(null!=G&&null!=O?(f=G,L=O):(d=M({values:d,minValue:G,maxValue:O,useSampleStdDev:!e,supportsNullCount:x({normalizationType:e,normalizationField:k,minValue:G,maxValue:O})}),f=d.min??null,L=d.max??null),
S=q(f??0,L??0,J));return{min:f,max:L,intervals:S}}function t(d,f){let g=-1;for(let a=d.length-1;0<=a;a--)if(f>=d[a][0]){g=a;break}return g}function q(d,f,g){const a=(f-d)/g,c=[];let e;for(let k=1;k<=g;k++)e=d+a,e=Number(e.toFixed(16)),c.push([d,k===g?f:e]),d=e;return c}const u=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,B=new Set(["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]),F="min max avg stddev count sum variance nullcount median".split(" ");p.calculateClassBreaks=
w;p.calculateHistogram=function(d,f){var g=l(d,f);if(null==g.min&&null==g.max)return{bins:[],minValue:g.min,maxValue:g.max,normalizationTotal:f.normalizationTotal};const a=g.intervals,c=g.min??0;g=g.max??0;const e=a.map((k,y)=>({minValue:a[y][0],maxValue:a[y][1],count:0}));for(const k of d)null!=k&&k>=c&&k<=g&&(d=t(a,k),-1<d&&e[d].count++);return{bins:e,minValue:c,maxValue:g,normalizationTotal:f.normalizationTotal}};p.calculatePercentile=P;p.calculateStatistics=M;p.calculateStringStatistics=function(d){const f=
d.returnDistinct?[...(new Set(d.values))]:d.values;var g=f.filter(c=>null!=c).sort();const a=g.length;g={count:a,min:g[0],max:g[a-1]};d.supportsNullCount&&(g.nullcount=f.length-a);d.percentileParams&&(g.median=P(f,d.percentileParams));return g};p.calculateUniqueValuesCount=function(d){const f={};for(let g of d){if(null==g||"string"===typeof g&&""===g.trim())g=null;null==f[g]?f[g]={count:1,data:g}:f[g].count++}return{count:f}};p.createClassBreaksDefinition=z;p.createUVResult=function(d,f,g,a){d=d.count;
const c=[];if(g&&f){g=[];var e=m(f[0]);for(const k of e)if(f[1]){e=m(f[1]);for(const y of e)if(f[2]){e=m(f[2]);for(const G of e)g.push(`${n(k)}${a}${n(y)}${a}${n(G)}`)}else g.push(`${n(k)}${a}${n(y)}`)}else g.push(k);for(const k of g)d.hasOwnProperty(k)||(d[k]={data:k,count:0})}for(const k in d)f=d[k],c.push({value:f.data,count:f.count,label:f.label});return{uniqueValueInfos:c}};p.getAttributeComparator=N;p.getEqualIntervalBins=q;p.getNormalizedValue=function(d,f,g,a){let c=null;switch(f){case "log":0!==
d&&(c=Math.log(d)*Math.LOG10E);break;case "percent-of-total":Number.isFinite(a)&&0!==a&&(c=d/a*100);break;case "field":Number.isFinite(g)&&0!==g&&(c=d/g);break;case "natural-log":0<d&&(c=Math.log(d));break;case "square-root":0<d&&(c=d**.5)}return c};p.isNullCountSupported=x;p.processNullValue=n;p.processSummaryStatisticsResult=function(d,f){let g;for(g in d)F.includes(g)&&(Number.isFinite(d[g])||(d[g]=null));if(!f)return d;["avg","stddev","variance"].forEach(a=>{null!=d[a]&&(d[a]=Math.ceil(d[a]??
0))});return d};p.resolveCBResult=function(d,f){let g=d.classBreaks;const a=g[0]?.minValue,c=g[g.length-1]?.maxValue,e="standard-deviation"===f;g=g.map(k=>{const y=k.label;k={minValue:k.minValue,maxValue:k.maxValue,label:y};if(e&&y){const G=y.match(u)?.map(O=>+O.trim())??[];2===G.length?(k.minStdDev=G[0],k.maxStdDev=G[1],0>G[0]&&0<G[1]&&(k.hasAvg=!0)):1===G.length&&(y.includes("\x3c")?(k.minStdDev=null,k.maxStdDev=G[0]):y.includes("\x3e")&&(k.minStdDev=G[0],k.maxStdDev=null))}return k});return{minValue:a,
maxValue:c,classBreakInfos:g,normalizationTotal:d.normalizationTotal}};p.statisticTypes=F;Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/ClassBreaksDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),
function(p,r,H,n,x,M,P,N,K,A){M=new H.JSONMap({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"});H=new H.JSONMap({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});n=function(C){function E(m){m=C.call(this,m)||this;m.type="class-breaks-definition";m.breakCount=
null;m.classificationField=null;m.classificationMethod=null;m.normalizationField=null;m.normalizationType=null;return m}p._inherits(E,C);p._createClass(E,[{key:"standardDeviationInterval",set:function(m){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",m)}},{key:"definedInterval",set:function(m){"defined-interval"===this.classificationMethod&&this._set("definedInterval",m)}}]);return E}(n.JSONSupport);r.__decorate([K.enumeration({classBreaksDef:"class-breaks-definition"})],
n.prototype,"type",void 0);r.__decorate([x.property({json:{write:!0}})],n.prototype,"breakCount",void 0);r.__decorate([x.property({json:{write:!0}})],n.prototype,"classificationField",void 0);r.__decorate([x.property({type:String,json:{read:M.read,write:M.write}})],n.prototype,"classificationMethod",void 0);r.__decorate([x.property({json:{write:!0}})],n.prototype,"normalizationField",void 0);r.__decorate([x.property({json:{read:H.read,write:H.write}})],n.prototype,"normalizationType",void 0);r.__decorate([x.property({value:null,
json:{write:!0}})],n.prototype,"standardDeviationInterval",null);r.__decorate([x.property({value:null,json:{write:!0}})],n.prototype,"definedInterval",null);return n=r.__decorate([A.subclass("esri.rest.support.ClassBreaksDefinition")],n)})},"esri/core/accessorSupport/decorators/enumeration":function(){define(["exports","../../jsonMap","./property"],function(p,r,H){p.enumeration=function(n,x={}){n=n instanceof r.JSONMap?n:new r.JSONMap(n,x);n={type:x?.ignoreUnknown??!0?n.apiValues:String,json:{type:n.jsonValues,
read:x?.readOnly?!1:{reader:n.read},write:{writer:n.write}}};void 0!==x?.readOnly&&(n.readOnly=!!x.readOnly);void 0!==x?.default&&(n.json.default=x.default);void 0!==x?.name&&(n.json.name=x.name);void 0!==x?.nonNullable&&(n.nonNullable=x.nonNullable);return H.property(n)};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/generateRendererUtils":function(){define(["exports","../../core/Logger"],function(p,r){function H(m){var w=m.definition;const {classificationMethod:D,
normalizationType:z,definedInterval:l}=w;w=w.breakCount??1;const t=[];var q=m.values;if(0===q.length)return[];q=q.sort((g,a)=>g-a);var u=q[0],B=q[q.length-1];if("equal-interval"===D)if(q.length>=w){q=(B-u)/w;m=u;for(var F=1;F<w;F++){var d=Number((u+F*q).toFixed(6));t.push({minValue:m,maxValue:d,label:n(m,d,z)});m=d}t.push({minValue:m,maxValue:B,label:n(m,B,z)})}else q.forEach(g=>{t.push({minValue:g,maxValue:g,label:n(g,g,z)})});else if("natural-breaks"===D){q=x(q);m=M(q.uniqueValues,m.valueFrequency||
q.valueFrequency,w);for(F=1;F<w;F++)q.uniqueValues.length>F&&(d=Number(q.uniqueValues[m[F]].toFixed(6)),t.push({minValue:u,maxValue:d,label:n(u,d,z)}),u=d);t.push({minValue:u,maxValue:B,label:n(u,B,z)})}else if("quantile"===D)if(q.length>=w&&u!==B){m=Math.ceil(q.length/w);F=0;for(d=1;d<w;d++){var f=m+F-1;f>q.length&&(f=q.length-1);0>f&&(f=0);t.push({minValue:u,maxValue:q[f],label:n(u,q[f],z)});u=q[f];F+=m;m=Math.ceil((q.length-F)/(w-d))}t.push({minValue:u,maxValue:B,label:n(u,B,z)})}else for(w=-1,
B=0;B<q.length;B++)u=q[B],u!==w&&(w=u,t.push({minValue:w,maxValue:u,label:n(w,u,z)}),w=u);else if("standard-deviation"===D)if(m=K(q),F=A(q,m),0===F)t.push({minValue:q[0],maxValue:q[0],label:n(q[0],q[0],z)});else{q=N(u,B,w,m,F)*F;F=0;for(d=w;1<=d;d--)f=Number((m-(d-.5)*q).toFixed(6)),t.push({minValue:u,maxValue:f,label:n(u,f,z)}),u=f,F++;d=Number((m+.5*q).toFixed(6));t.push({minValue:u,maxValue:d,label:n(u,d,z)});u=d;F++;for(f=1;f<=w;f++)d=F===2*w?B:Number((m+(f+.5)*q).toFixed(6)),t.push({minValue:u,
maxValue:d,label:n(u,d,z)}),u=d,F++}else if("defined-interval"===D){if(!l)return t;w=q[0];B=q[q.length-1];q=Math.ceil((B-w)/l);u=w;for(m=1;m<q;m++)F=Number((w+m*l).toFixed(6)),t.push({minValue:u,maxValue:F,label:n(u,F,z)}),u=F;t.push({minValue:u,maxValue:B,label:n(u,B,z)})}return t}function n(m,w,D){let z=null;return z=m===w?D&&"percent-of-total"===D?m+"%":m.toString():D&&"percent-of-total"===D?m+"% - "+w+"%":m+" - "+w}function x(m){const w=[],D=[];let z=Number.MIN_VALUE,l=1,t=-1;for(let q=0;q<m.length;q++){const u=
m[q];u===z?(l++,D[t]=l):null!==u&&(w.push(u),z=u,l=1,D.push(l),t++)}return{uniqueValues:w,valueFrequency:D}}function M(m,w,D){var z=m.length;const l=[];D>z&&(D=z);for(var t=0;t<D;t++)l.push(Math.round(t*z/D-1));l.push(z-1);t=P(l,m,w,D);z=t.mean;t=t.sdcm;var q=D,u=0,B=0;let F=0,d=0,f=!0;for(let a=0;2>a&&f;a++){0===a&&(f=!1);for(var g=0;g<q-1;g++)for(;l[g+1]+1!==l[g+2];)if(l[g+1]+=1,u=C(g,l,m,w),F=u.sbMean,u=u.sbSdcm,B=C(g+1,l,m,w),d=B.sbMean,B=B.sbSdcm,u+B<t[g]+t[g+1])t[g]=u,t[g+1]=B,z[g]=F,z[g+1]=
d,f=!0;else{--l[g+1];break}for(g=q-1;0<g;g--)for(;l[g]!==l[g-1]+1;)if(--l[g],u=C(g-1,l,m,w),F=u.sbMean,u=u.sbSdcm,B=C(g,l,m,w),d=B.sbMean,B=B.sbSdcm,u+B<t[g-1]+t[g])t[g-1]=u,t[g]=B,z[g-1]=F,z[g]=d,f=!0;else{l[g]+=1;break}}f&&(t=P(l,m,w,D));return l}function P(m,w,D,z){let l=[];var t=[],q=[];let u=0;const B=[],F=[];for(var d=0;d<z;d++){var f=C(d,m,w,D);B.push(f.sbMean);F.push(f.sbSdcm);u+=F[d]}f=u;for(d=!0;d||u<f;){d=!1;l=[];for(t=0;t<z;t++)l.push(m[t]);for(q=0;q<z;q++)for(f=m[q]+1;f<=m[q+1];f++)if(t=
w[f],0<q&&f!==m[q+1]&&Math.abs(t-B[q])>Math.abs(t-B[q-1]))m[q]=f;else if(q<z-1&&m[q]!==f-1&&Math.abs(t-B[q])>Math.abs(t-B[q+1])){m[q+1]=f-1;break}f=u;u=0;t=[];q=[];for(let g=0;g<z;g++){t.push(B[g]);q.push(F[g]);const a=C(g,m,w,D);B[g]=a.sbMean;F[g]=a.sbSdcm;u+=F[g]}}if(u>f){for(w=0;w<z;w++)m[w]=l[w],B[w]=t[w],F[w]=q[w];u=f}return{mean:B,sdcm:F}}function N(m,w,D,z,l){m=Math.max(z-m,w-z)/l/D;return 1<=m?1:.5<=m?.5:.25}function K(m){let w=0;for(let D=0;D<m.length;D++)w+=m[D];return w/=m.length}function A(m,
w){let D=0;for(let z=0;z<m.length;z++){const l=m[z];D+=(l-w)*(l-w)}D/=m.length;return Math.sqrt(D)}function C(m,w,D,z){var l=0,t=0;for(var q=w[m]+1;q<=w[m+1];q++){const u=z[q];l+=D[q]*u;t+=u}0>=t&&E.warn("Exception in Natural Breaks calculation");l/=t;t=0;for(q=w[m]+1;q<=w[m+1];q++)t+=z[q]*(D[q]-l)**2;return{sbMean:l,sbSdcm:t}}const E=r.getLogger("esri.rest.support.generateRendererUtils");p.createGenerateRendererClassBreaks=function(m){const {normalizationTotal:w}=m;return{classBreaks:H(m),normalizationTotal:w}};
p.createGenerateRendererUniqueValues=function(m){m=x(m);const w=[],D=m.uniqueValues.length;for(let z=0;z<D;z++){const l=m.uniqueValues[z];w.push({value:l,count:m.valueFrequency[z],label:l.toString()})}return{uniqueValues:w}};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define(["exports","./utils","../../../statistics/utils"],function(p,r,H){p.classBreaks=async function(n){const {attribute:x,features:M}=n,{field:P,normalizationType:N,normalizationField:K,normalizationTotal:A,classificationMethod:C}=x;n=await r.getDataValues({field:P,valueExpression:x.valueExpression,normalizationType:N,normalizationField:K,normalizationTotal:A,viewInfoParams:x.viewInfoParams,fieldInfos:x.fieldInfos},M);n=H.calculateClassBreaks(n,{field:P,normalizationType:N,normalizationField:K,
normalizationTotal:A,classificationMethod:C,standardDeviationInterval:x.standardDeviationInterval,numClasses:x.numClasses,minValue:x.minValue,maxValue:x.maxValue});return H.resolveCBResult(n,C)};p.heatmapStatistics=async function(n){const {attribute:x,features:M}=n,{field:P,radius:N,fieldOffset:K,transform:A,spatialReference:C}=x;n=x.size??[0,0];const E=r.quantizeFeatures(M??[],A,C,n),{count:m,min:w,max:D,mean:z,stdDev:l}=r.calculateHeatmapStats(E,N??void 0,K,P,n[0],n[1]);return{count:m,min:w,max:D,
avg:z,stddev:l}};p.histogram=async function(n){const {attribute:x,features:M}=n,{field:P,normalizationType:N,normalizationField:K,normalizationTotal:A,classificationMethod:C}=x;n=await r.getDataValues({field:P,valueExpression:x.valueExpression,normalizationType:N,normalizationField:K,normalizationTotal:A,viewInfoParams:x.viewInfoParams,fieldInfos:x.fieldInfos},M);return H.calculateHistogram(n,{field:P,normalizationType:N,normalizationField:K,normalizationTotal:A,classificationMethod:C,standardDeviationInterval:x.standardDeviationInterval,
numBins:x.numBins,minValue:x.minValue,maxValue:x.maxValue})};p.summaryStatistics=async function(n){const {attribute:x,features:M}=n,{normalizationType:P,normalizationField:N,minValue:K,maxValue:A,fieldType:C}=x;n=await r.getDataValues({field:x.field,valueExpression:x.valueExpression,normalizationType:P,normalizationField:N,normalizationTotal:x.normalizationTotal,viewInfoParams:x.viewInfoParams,fieldInfos:x.fieldInfos},M);const E=H.isNullCountSupported({normalizationType:P,normalizationField:N,minValue:K,
maxValue:A}),m={value:.5,fieldType:C};n="esriFieldTypeString"===C?H.calculateStringStatistics({values:n,supportsNullCount:E,percentileParams:m}):H.calculateStatistics({values:n,minValue:K,maxValue:A,useSampleStdDev:!P,supportsNullCount:E,percentileParams:m});return H.processSummaryStatisticsResult(n,"esriFieldTypeDate"===C)};p.uniqueValues=async function(n){const {attribute:x,features:M}=n;n=await r.getDataValues({field:x.field,field2:x.field2,field3:x.field3,fieldDelimiter:x.fieldDelimiter,valueExpression:x.valueExpression,
viewInfoParams:x.viewInfoParams,fieldInfos:x.fieldInfos},M);n=H.calculateUniqueValuesCount(n);return H.createUVResult(n,x.domains,x.returnAllCodedValues,x.fieldDelimiter)};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})});
// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../core/Error ../../intl/messages ../heuristics/clusterMinSize ./support/utils ../support/clusterUtils ../../views/2d/layers/support/clusterUtils".split(" "),function(m,q,r,t,n,g,u){async function v(a){const {layer:b,renderer:h,view:d}=a;await Promise.all([b.load(),d.when()]);a=h||b.renderer;if(!u.isClusterCompatibleRenderer(a))throw new q("clusters-label-schemes:invalid-parameters","'renderer' is not valid");return{layer:b,renderer:a,view:d}}async function p(a){const {renderer:b,
view:h,statInfo:d}=a,f=d?.statisticType,e=d?g.getClusterField(d.attributeInfo,f):g.clusterCountField;a="type"===f?g.getPredominantTypeExpression("unique-value"===b.type?b.uniqueValueInfos??[]:[],e,a.noneValueLabel):n.createNumericLabelExpression(e);a=n.createLabelClass(a);return{name:d?`clusters-${f}-${g.getClusterFieldHash(e,f)}`:"clusters-count",labelingInfo:[a],clusterMinSize:await t(a.symbol,h),fieldName:e}}m.getLabelSchemes=async function(a){const [{renderer:b,layer:h,view:d},f]=await Promise.all([v(a),
r.fetchMessageBundle("esri/smartMapping/t9n/smartMapping")]);if(!b)return null;a=null;const e=[];var w=g.getStatisticInfos(h,b,!1);const l=new Map;for(c of w)"size"===c.attributeInfo.vvType?l.set(c.statisticHash,c):l.has(c.statisticHash)||l.set(c.statisticHash,c);var c=[...l.values()];for(var k of c)c=await p({renderer:b,view:d,statInfo:k,noneValueLabel:f.clusters.predominantNoneValue}),"size"===k.attributeInfo.vvType?a=c:e.push(c);k=await p({renderer:b,view:d});a?e.unshift(k):a=k;return{primaryScheme:a,
secondarySchemes:e}};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})});
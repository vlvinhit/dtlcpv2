// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Logger ../../core/mathUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./VideoCameraSensorModel ./videoUtils ../../chunks/_commonjsHelpers".split(" "),function(Te,ya,El,Fl,Gl,Ad,Ea,cr,dr,er,Hl,Il,Bd,La){function Ue(){module.exports=Ue=Object.assign?
Object.assign.bind():function(d){for(var f=1;f<arguments.length;f++){var k=arguments[f],n;for(n in k)Object.prototype.hasOwnProperty.call(k,n)&&(d[n]=k[n])}return d};module.exports.__esModule=!0;module.exports["default"]=module.exports;return Ue.apply(this,arguments)}function Jl(d){void 0===d&&(d="");return d.toLowerCase().split(";").reduce(function(f,k){k=k.split("\x3d");var n=k[1];return"charset"===k[0].trim()?n.trim():f},"utf-8")}function Kl(d){for(var f in d)if(d.hasOwnProperty(f))return!1;return!0}
function dh(d,f,k){var n=d;Ll(f)?(k=f,"string"===typeof d&&(n={uri:d})):n=Ml({},f,{uri:d});n.callback=k;return n}function ob(d,f,k){f=dh(d,f,k);return eh(f)}function eh(d){function f(C){clearTimeout(x);C instanceof Error||(C=Error(""+(C||"Unknown XMLHttpRequest Error")));C.statusCode=0;var z=y;n||(n=!0,d.callback(C,z,void 0))}function k(){if(!b){clearTimeout(x);var C=d.useXDR&&void 0===u.status?200:1223===u.status?204:u.status;var z=y,E=null;if(0!==C){z=void 0;if(u.response)var K=u.response;else{if(!(z=
u.responseText))a:{try{if("document"===u.responseType){z=u.responseXML;break a}K=u.responseXML&&"parsererror"===u.responseXML.documentElement.nodeName;if(""===u.responseType&&!K){z=u.responseXML;break a}}catch(G){}z=null}K=z}z=K;if(t)try{z=JSON.parse(z)}catch(G){}z={body:z,statusCode:C,method:e,headers:{},url:c,rawRequest:u};u.getAllResponseHeaders&&(z.headers=Nl(u.getAllResponseHeaders()))}else E=Error("Internal XMLHttpRequest Error");C=z.body;n||(n=!0,d.callback(E,z,C))}}if("undefined"===typeof d.callback)throw Error("callback argument missing");
var n=!1,u=d.xhr||null;u||(u=d.cors||d.useXDR?new ob.XDomainRequest:new ob.XMLHttpRequest);var a,b,c=u.url=d.uri||d.url,e=u.method=d.method||"GET",h=d.body||d.data,m=u.headers=d.headers||{},p=!!d.sync,t=!1,x,y={body:void 0,headers:{},statusCode:0,method:e,url:c,rawRequest:u};"json"in d&&!1!==d.json&&(t=!0,m.accept||m.Accept||(m.Accept="application/json"),"GET"!==e&&"HEAD"!==e&&(m["content-type"]||m["Content-Type"]||(m["Content-Type"]="application/json"),h=JSON.stringify(!0===d.json?h:d.json)));u.onreadystatechange=
function(){4===u.readyState&&setTimeout(k,0)};u.onload=k;u.onerror=f;u.onprogress=function(){};u.onabort=function(){b=!0};u.ontimeout=f;u.open(e,c,!p,d.username,d.password);p||(u.withCredentials=!!d.withCredentials);!p&&0<d.timeout&&(x=setTimeout(function(){if(!b){b=!0;u.abort("timeout");var C=Error("XMLHttpRequest timeout");C.code="ETIMEDOUT";f(C)}},d.timeout));if(u.setRequestHeader)for(a in m)m.hasOwnProperty(a)&&u.setRequestHeader(a,m[a]);else if(d.headers&&!Kl(d.headers))throw Error("Headers cannot be set on an XDomainRequest object");
"responseType"in d&&(u.responseType=d.responseType);"beforeSend"in d&&"function"===typeof d.beforeSend&&d.beforeSend(u);u.send(h||null);return u}function Ol(){}function Za(d,f){this.name="ParsingError";this.code=d.code;this.message=f||d.message}function Ve(d){d=d.match(/^(\d+):(\d{1,2})(:\d{1,2})?\.(\d{3})/);if(!d)return null;if(d[3]){var f=d[3].replace(":","");return 3600*(d[1]|0)+60*(d[2]|0)+(f|0)+(d[4]|0)/1E3}return 59<d[1]?3600*(d[1]|0)+60*(d[2]|0)+(d[4]|0)/1E3:60*(d[1]|0)+(d[2]|0)+(d[4]|0)/1E3}
function Rc(){this.values=We(null)}function Sc(d,f,k,n){d=n?d.split(n):[d];for(var u in d)if("string"===typeof d[u]){var a=d[u].split(k);2===a.length&&(n=a[0].trim(),a=a[1].trim(),f(n,a))}}function Pl(d,f,k){function n(){var b=Ve(d);if(null===b)throw new Za(Za.Errors.BadTimeStamp,"Malformed timestamp: "+a);d=d.replace(/^[^\sa-zA-Z-]+/,"");return b}function u(){d=d.replace(/^\s+/,"")}var a=d;u();f.startTime=n();u();if("--\x3e"!==d.substr(0,3))throw new Za(Za.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+
a);d=d.substr(3);u();f.endTime=n();u();(function(b,c){var e=new Rc;Sc(b,function(h,m){switch(h){case "region":for(var p=k.length-1;0<=p;p--)if(k[p].id===m){e.set(h,k[p].region);break}break;case "vertical":e.alt(h,m,["rl","lr"]);break;case "line":m=m.split(",");p=m[0];e.integer(h,p);e.percent(h,p)?e.set("snapToLines",!1):null;e.alt(h,p,["auto"]);2===m.length&&e.alt("lineAlign",m[1],["start","center","end"]);break;case "position":m=m.split(",");e.percent(h,m[0]);2===m.length&&e.alt("positionAlign",
m[1],["start","center","end"]);break;case "size":e.percent(h,m);break;case "align":e.alt(h,m,["start","center","end","left","right"])}},/:/,/\s/);c.region=e.get("region",null);c.vertical=e.get("vertical","");try{c.line=e.get("line","auto")}catch(h){}c.lineAlign=e.get("lineAlign","start");c.snapToLines=e.get("snapToLines",!0);c.size=e.get("size",100);try{c.align=e.get("align","center")}catch(h){c.align=e.get("align","middle")}try{c.position=e.get("position","auto")}catch(h){c.position=e.get("position",
{start:0,left:0,center:50,middle:50,end:100,right:100},c.align)}c.positionAlign=e.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},c.align)})(d,f)}function fh(d,f){function k(){if(!f)return null;var p=f.match(/^([^<]*)(<[^>]*>?)?/);p=p[1]?p[1]:p[2];f=f.substr(p.length);return p}function n(p){Xe.innerHTML=p;p=Xe.textContent;Xe.textContent="";return p}function u(p,t){var x=Ql[p];if(!x)return null;x=d.document.createElement(x);(p=Rl[p])&&t&&(x[p]=
t.trim());return x}for(var a=d.document.createElement("div"),b=a,c,e=[];null!==(c=k());)if("\x3c"===c[0])if("/"===c[1])e.length&&e[e.length-1]===c.substr(2).replace("\x3e","")&&(e.pop(),b=b.parentNode);else{var h=Ve(c.substr(1,c.length-2));if(h){var m=d.document.createProcessingInstruction("timestamp",h);b.appendChild(m)}else if(c=c.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/))!(m=u(c[1],c[3]))||gh[m.localName]&&gh[m.localName]!==b.localName||(c[2]&&(h=c[2].split("."),h.forEach(function(p){var t=
/^bg_/.test(p);p=t?p.slice(3):p;hh.hasOwnProperty(p)&&(m.style[t?"background-color":"color"]=hh[p])}),m.className=h.join(" ")),e.push(c[1]),b.appendChild(m),b=m)}else b.appendChild(d.document.createTextNode(n(c)));return a}function Sl(d){for(var f=0;f<ih.length;f++){var k=ih[f];if(d>=k[0]&&d<=k[1])return!0}return!1}function Tl(d){function f(b,c){for(var e=c.childNodes.length-1;0<=e;e--)b.push(c.childNodes[e])}function k(b){if(!b||!b.length)return null;var c=b.pop(),e=c.textContent||c.innerText;if(e)return(c=
e.match(/^.*(\n|\r)/))?(b.length=0,c[0]):e;if("ruby"===c.tagName)return k(b);if(c.childNodes)return f(b,c),k(b)}var n=[],u="";if(!d||!d.childNodes)return"ltr";for(f(n,d);u=k(n);)for(var a=0;a<u.length;a++)if(d=u.charCodeAt(a),Sl(d))return"rtl";return"ltr"}function Ye(){}function Cd(d,f,k){this.cue=f;this.cueDiv=fh(d,f.text);var n={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:""===f.vertical?"horizontal-tb":
"lr"===f.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(n,this.cueDiv);this.div=d.document.createElement("div");n={direction:Tl(this.cueDiv),writingMode:""===f.vertical?"horizontal-tb":"lr"===f.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:"middle"===f.align?"center":f.align,font:k.font,whiteSpace:"pre-line",position:"absolute"};this.applyStyles(n);this.div.appendChild(this.cueDiv);d=0;switch(f.positionAlign){case "start":d=f.position;break;
case "center":d=f.position-f.size/2;break;case "end":d=f.position-f.size}""===f.vertical?this.applyStyles({left:this.formatStyle(d,"%"),width:this.formatStyle(f.size,"%")}):this.applyStyles({top:this.formatStyle(d,"%"),height:this.formatStyle(f.size,"%")});this.move=function(u){this.applyStyles({top:this.formatStyle(u.top,"px"),bottom:this.formatStyle(u.bottom,"px"),left:this.formatStyle(u.left,"px"),right:this.formatStyle(u.right,"px"),height:this.formatStyle(u.height,"px"),width:this.formatStyle(u.width,
"px")})}}function Ma(d){if(d.div){var f=d.div.offsetHeight;var k=d.div.offsetWidth;var n=d.div.offsetTop;var u=(u=d.div.childNodes)&&(u=u[0])&&u.getClientRects&&u.getClientRects();d=d.div.getBoundingClientRect();var a=u?Math.max(u[0]&&u[0].height||0,d.height/u.length):0}this.left=d.left;this.right=d.right;this.top=d.top||n;this.height=d.height||f;this.bottom=d.bottom||n+(d.height||f);this.width=d.width||k;this.lineHeight=void 0!==a?a:d.lineHeight}function kc(){}function Ze(d){return"string"!==typeof d?
!1:Ul[d.toLowerCase()]?d.toLowerCase():!1}function jh(d,f,k){this.hasBeenReset=!1;var n="",u=!1,a=d,b=f,c=k,e=null,h="",m=!0,p="auto",t="start",x="auto",y="auto",C=100,z="center";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return n},set:function(E){n=""+E}},pauseOnExit:{enumerable:!0,get:function(){return u},set:function(E){u=!!E}},startTime:{enumerable:!0,get:function(){return a},set:function(E){if("number"!==typeof E)throw new TypeError("Start time must be set to a number.");
a=E;this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return b},set:function(E){if("number"!==typeof E)throw new TypeError("End time must be set to a number.");b=E;this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return c},set:function(E){c=""+E;this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return e},set:function(E){e=E;this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return h},set:function(E){E="string"!==typeof E?!1:Vl[E.toLowerCase()]?E.toLowerCase():
!1;if(!1===E)throw new SyntaxError("Vertical: an invalid or illegal direction string was specified.");h=E;this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return m},set:function(E){m=!!E;this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return p},set:function(E){if("number"!==typeof E&&"auto"!==E)throw new SyntaxError("Line: an invalid number or illegal string was specified.");p=E;this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return t},set:function(E){(E=Ze(E))?
(t=E,this.hasBeenReset=!0):console.warn("lineAlign: an invalid or illegal string was specified.")}},position:{enumerable:!0,get:function(){return x},set:function(E){if(0>E||100<E)throw Error("Position must be between 0 and 100.");x=E;this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return y},set:function(E){(E=Ze(E))?(y=E,this.hasBeenReset=!0):console.warn("positionAlign: an invalid or illegal string was specified.")}},size:{enumerable:!0,get:function(){return C},set:function(E){if(0>
E||100<E)throw Error("Size must be between 0 and 100.");C=E;this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return z},set:function(E){E=Ze(E);if(!E)throw new SyntaxError("align: an invalid or illegal alignment string was specified.");z=E;this.hasBeenReset=!0}}});this.displayState=void 0}function Tc(d){return"number"===typeof d&&0<=d&&100>=d}function Nb(){Nb=Object.assign?Object.assign.bind():function(d){for(var f=1;f<arguments.length;f++){var k=arguments[f],n;for(n in k)Object.prototype.hasOwnProperty.call(k,
n)&&(d[n]=k[n])}return d};return Nb.apply(this,arguments)}function Dd(d,f){void 0===f&&(f=Object);return f&&"function"===typeof f.freeze?f.freeze(d):d}function Wl(d){return""!==d}function Xl(d,f){d.hasOwnProperty(f)||(d[f]=!0);return d}function kh(d){if(!d)return[];d=d?d.split(/[\t\n\f\r ]+/).filter(Wl):[];return Object.keys(d.reduce(Xl,{}))}function Yl(d){return function(f){return d&&-1!==d.indexOf(f)}}function Uc(d,f){for(var k in d)Object.prototype.hasOwnProperty.call(d,k)&&(f[k]=d[k])}function Ta(d,
f){var k=d.prototype;if(!(k instanceof f)){function n(){}n.prototype=f.prototype;n=new n;Uc(k,n);d.prototype=k=n}k.constructor!=d&&("function"!=typeof d&&console.error("unknown Class:"+d),k.constructor=d)}function va(d,f){if(f instanceof Error)var k=f;else k=this,Error.call(this,za[d]),this.message=za[d],Error.captureStackTrace&&Error.captureStackTrace(this,va);k.code=d;f&&(this.message=this.message+": "+f);return k}function Ob(){}function lc(d,f){this._node=d;this._refresh=f;$e(this)}function $e(d){var f=
d._node._inc||d._node.ownerDocument._inc;if(d._inc!=f){var k=d._refresh(d._node);lh(d,"length",k.length);Uc(k,d);d._inc=f}}function Ed(){}function mh(d,f){for(var k=d.length;k--;)if(d[k]===f)return k}function nh(d,f,k,n){n?f[mh(f,n)]=k:f[f.length++]=k;d&&(k.ownerElement=d,f=d.ownerDocument)&&(n&&(f&&f._inc++,n.namespaceURI===mc.XMLNS&&delete d._nsMap[n.prefix?n.localName:""]),f&&f._inc++,k.namespaceURI===mc.XMLNS&&(d._nsMap[k.prefix?k.localName:""]=k.value))}function oh(d,f,k){var n=mh(f,k);if(0<=
n){for(var u=f.length-1;n<u;)f[n]=f[++n];f.length=u;d&&(f=d.ownerDocument)&&(f&&f._inc++,k.namespaceURI===mc.XMLNS&&delete d._nsMap[k.prefix?k.localName:""],k.ownerElement=null)}else throw new va(ph,Error(d.tagName+"@"+k));}function qh(){}function ia(){}function rh(d){return"\x3c"==d&&"\x26lt;"||"\x3e"==d&&"\x26gt;"||"\x26"==d&&"\x26amp;"||'"'==d&&"\x26quot;"||"\x26#"+d.charCodeAt()+";"}function Vc(d,f){if(f(d))return!0;if(d=d.firstChild){do if(Vc(d,f))return!0;while(d=d.nextSibling)}}function Wc(){this.ownerDocument=
this}function af(d,f,k){if(d&&d._inc)if(d._inc++,d=f.childNodes,k)d[d.length++]=k;else{f=f.firstChild;for(k=0;f;)d[k++]=f,f=f.nextSibling;d.length=k;delete d[d.length]}}function sh(d,f){var k=f.previousSibling,n=f.nextSibling;k?k.nextSibling=n:d.firstChild=n;n?n.previousSibling=k:d.lastChild=k;f.parentNode=null;f.previousSibling=null;f.nextSibling=null;af(d.ownerDocument,d);return f}function Db(d){return d&&d.nodeType===ia.DOCUMENT_TYPE_NODE}function pb(d){return d&&d.nodeType===ia.ELEMENT_NODE}function bf(d){return d&&
d.nodeType===ia.TEXT_NODE}function th(d,f){d=d.childNodes||[];if(qb(d,pb)||Db(f))return!1;var k=qb(d,Db);return!(f&&k&&d.indexOf(k)>d.indexOf(f))}function uh(d,f){d=d.childNodes||[];if(qb(d,function(n){return pb(n)&&n!==f}))return!1;var k=qb(d,Db);return!(f&&k&&d.indexOf(k)>d.indexOf(f))}function Zl(d,f,k){var n=d.childNodes||[],u=f.childNodes||[];if(f.nodeType===ia.DOCUMENT_FRAGMENT_NODE){var a=u.filter(pb);if(1<a.length||qb(u,bf))throw new va(Ua,"More than one element or text in fragment");if(1===
a.length&&!th(d,k))throw new va(Ua,"Element in fragment can not be inserted before doctype");}if(pb(f)&&!th(d,k))throw new va(Ua,"Only one element can be added and only after doctype");if(Db(f)){if(qb(n,Db))throw new va(Ua,"Only one doctype is allowed");d=qb(n,pb);if(k&&n.indexOf(d)<n.indexOf(k))throw new va(Ua,"Doctype can only be inserted before an element");if(!k&&d)throw new va(Ua,"Doctype can not be appended since element is present");}}function vh(d,f,k){var n=d.childNodes||[],u=f.childNodes||
[];if(f.nodeType===ia.DOCUMENT_FRAGMENT_NODE){var a=u.filter(pb);if(1<a.length||qb(u,bf))throw new va(Ua,"More than one element or text in fragment");if(1===a.length&&!uh(d,k))throw new va(Ua,"Element in fragment can not be inserted before doctype");}if(pb(f)&&!uh(d,k))throw new va(Ua,"Only one element can be added and only after doctype");if(Db(f)){if(qb(n,function(b){return Db(b)&&b!==k}))throw new va(Ua,"Only one doctype is allowed");d=qb(n,pb);if(k&&n.indexOf(d)<n.indexOf(k))throw new va(Ua,"Doctype can only be inserted before an element");
}}function Fd(d,f,k,n){if(!d||d.nodeType!==ia.DOCUMENT_NODE&&d.nodeType!==ia.DOCUMENT_FRAGMENT_NODE&&d.nodeType!==ia.ELEMENT_NODE)throw new va(Ua,"Unexpected parent node type "+d.nodeType);if(k&&k.parentNode!==d)throw new va(ph,"child not in parent");if(!f||!(pb(f)||bf(f)||Db(f)||f.nodeType===ia.DOCUMENT_FRAGMENT_NODE||f.nodeType===ia.COMMENT_NODE||f.nodeType===ia.PROCESSING_INSTRUCTION_NODE)||Db(f)&&d.nodeType!==ia.DOCUMENT_NODE)throw new va(Ua,"Unexpected node type "+f.nodeType+" for parent node type "+
d.nodeType);d.nodeType===ia.DOCUMENT_NODE&&(n||Zl)(d,f,k);(n=f.parentNode)&&n.removeChild(f);if(f.nodeType===Eb){n=f.firstChild;if(null==n)return f;var u=f.lastChild}else n=u=f;var a=k?k.previousSibling:d.lastChild;n.previousSibling=a;u.nextSibling=k;a?a.nextSibling=n:d.firstChild=n;null==k?d.lastChild=u:k.previousSibling=u;do n.parentNode=d;while(n!==u&&(n=n.nextSibling));af(d.ownerDocument||d,d);f.nodeType==Eb&&(f.firstChild=f.lastChild=null);return f}function nc(){this._nsMap={}}function Gd(){}
function Xc(){}function cf(){}function df(){}function ef(){}function ff(){}function wh(){}function xh(){}function gf(){}function Hd(){}function hf(){}function yh(d,f,k){f=d.prefix||"";d=d.namespaceURI;if(!d||"xml"===f&&d===mc.XML||d===mc.XMLNS)return!1;for(var n=k.length;n--;){var u=k[n];if(u.prefix===f)return u.namespace!==d}return!0}function jf(d,f,k){d.push(" ",f,'\x3d"',k.replace(/[<>&"\t\n\r]/g,rh),'"')}function oc(d,f,k,n,u){u||(u=[]);if(n)if(d=n(d)){if("string"==typeof d){f.push(d);return}}else return;
switch(d.nodeType){case jb:var a=d.attributes,b=a.length,c=d.firstChild,e=d.tagName;k=mc.isHTML(d.namespaceURI)||k;var h=e;if(!k&&!d.prefix&&d.namespaceURI){for(var m,p=0;p<a.length;p++)if("xmlns"===a.item(p).name){m=a.item(p).value;break}if(!m)for(p=u.length-1;0<=p;p--){var t=u[p];if(""===t.prefix&&t.namespace===d.namespaceURI){m=t.namespace;break}}if(m!==d.namespaceURI)for(p=u.length-1;0<=p;p--)if(t=u[p],t.namespace===d.namespaceURI){t.prefix&&(h=t.prefix+":"+e);break}}f.push("\x3c",h);for(m=0;m<
b;m++)p=a.item(m),"xmlns"==p.prefix?u.push({prefix:p.localName,namespace:p.value}):"xmlns"==p.nodeName&&u.push({prefix:"",namespace:p.value});for(m=0;m<b;m++){p=a.item(m);if(yh(p,k,u)){t=p.prefix||"";var x=p.namespaceURI;jf(f,t?"xmlns:"+t:"xmlns",x);u.push({prefix:t,namespace:x})}oc(p,f,k,n,u)}e===h&&yh(d,k,u)&&(t=d.prefix||"",x=d.namespaceURI,jf(f,t?"xmlns:"+t:"xmlns",x),u.push({prefix:t,namespace:x}));if(c||k&&!/^(?:meta|link|img|br|hr|input)$/i.test(e)){f.push("\x3e");if(k&&/^script$/i.test(e))for(;c;)c.data?
f.push(c.data):oc(c,f,k,n,u.slice()),c=c.nextSibling;else for(;c;)oc(c,f,k,n,u.slice()),c=c.nextSibling;f.push("\x3c/",h,"\x3e")}else f.push("/\x3e");break;case zh:case Eb:for(c=d.firstChild;c;)oc(c,f,k,n,u.slice()),c=c.nextSibling;break;case pc:return jf(f,d.name,d.value);case Id:return f.push(d.data.replace(/[<&>]/g,rh));case Ah:return f.push("\x3c![CDATA[",d.data,"]]\x3e");case Bh:return f.push("\x3c!--",d.data,"--\x3e");case Ch:k=d.publicId;n=d.systemId;f.push("\x3c!DOCTYPE ",d.name);k?(f.push(" PUBLIC ",
k),n&&"."!=n&&f.push(" ",n),f.push("\x3e")):n&&"."!=n?f.push(" SYSTEM ",n,"\x3e"):((d=d.internalSubset)&&f.push(" [",d,"]"),f.push("\x3e"));break;case Dh:return f.push("\x3c?",d.target," ",d.data,"?\x3e");case Eh:return f.push("\x26",d.nodeName,";");default:f.push("??",d.nodeName)}}function Fh(d,f,k){switch(f.nodeType){case jb:var n=f.cloneNode(!1);n.ownerDocument=d;case Eb:break;case pc:k=!0}n||(n=f.cloneNode(!1));n.ownerDocument=d;n.parentNode=null;if(k)for(f=f.firstChild;f;)n.appendChild(Fh(d,
f,k)),f=f.nextSibling;return n}function kf(d,f,k){var n=new f.constructor;for(a in f)if(Object.prototype.hasOwnProperty.call(f,a)){var u=f[a];"object"!=typeof u&&u!=n[a]&&(n[a]=u)}f.childNodes&&(n.childNodes=new Ob);n.ownerDocument=d;switch(n.nodeType){case jb:var a=f.attributes;var b=n.attributes=new Ed;u=a.length;b._ownerElement=n;for(b=0;b<u;b++)n.setAttributeNode(kf(d,a.item(b),!0));break;case pc:k=!0}if(k)for(f=f.firstChild;f;)n.appendChild(kf(d,f,k)),f=f.nextSibling;return n}function lh(d,f,
k){d[f]=k}function qc(d,f){this.message=d;this.locator=f;Error.captureStackTrace&&Error.captureStackTrace(this,qc)}function Gh(){}function $l(d,f,k,n,u){function a(V){var wa=V.slice(1,-1);if(Object.hasOwnProperty.call(k,wa))return k[wa];if("#"===wa.charAt(0))return V=parseInt(wa.substr(1).replace("x","0x")),65535<V?(V-=65536,V=String.fromCharCode(55296+(V>>10),56320+(V&1023))):V=String.fromCharCode(V),V;u.error("entity not found:"+V);return V}function b(V){if(V>x){var wa=d.substring(x,V).replace(/&#?\w+;/g,
a);p&&c(x);n.characters(wa,0,V-x);x=V}}function c(V,wa){for(;V>=h&&(wa=m.exec(d));)e=wa.index,h=e+wa[0].length,p.lineNumber++;p.columnNumber=V-e+1}var e=0,h=0,m=/.*(?:\r\n?|\n)|.*$/g,p=n.locator;f=[{currentNSMap:f}];for(var t={},x=0;;){try{var y=d.indexOf("\x3c",x);if(0>y){if(!d.substr(x).match(/^\s*$/)){var C=n.doc,z=C.createTextNode(d.substr(x));C.appendChild(z);n.currentElement=z}break}y>x&&b(y);switch(d.charAt(y+1)){case "/":var E=d.indexOf("\x3e",y+3),K=d.substring(y+2,E).replace(/[ \t\n\r]+$/g,
""),G=f.pop();0>E?(K=d.substring(y+2).replace(/[\s<].*/,""),u.error("end tag name: "+K+" is not complete:"+G.tagName),E=y+1+K.length):K.match(/\s</)&&(K=K.replace(/[\s<].*/,""),u.error("end tag name: "+K+" maybe not complete"),E=y+1+K.length);var O=G.localNSMap,R=G.tagName==K;if(R||G.tagName&&G.tagName.toLowerCase()==K.toLowerCase()){n.endElement(G.uri,G.localName,K);if(O)for(var W in O)Object.prototype.hasOwnProperty.call(O,W)&&n.endPrefixMapping(W);R||u.fatalError("end tag name: "+K+" is not match the current start tagName:"+
G.tagName)}else f.push(G);E++;break;case "?":p&&c(y);E=am(d,y,n);break;case "!":p&&c(y);E=bm(d,y,n,u);break;default:p&&c(y);var U=new Hh,ba=f[f.length-1].currentNSMap;E=cm(d,y,U,ba,a,u);var J=U.length;!U.closed&&dm(d,E,U.tagName,t)&&(U.closed=!0,k.nbsp||u.warning("unclosed xml attribute"));if(p&&J){for(var ea=Ih(p,{}),ta=0;ta<J;ta++){var Aa=U[ta];c(Aa.offset);Aa.locator=Ih(p,{})}n.locator=ea;Jh(U,n,ba)&&f.push(U);n.locator=p}else Jh(U,n,ba)&&f.push(U);Yc.isHTML(U.uri)&&!U.closed?E=em(d,E,U.tagName,
a,n):E++}}catch(V){if(V instanceof qc)throw V;u.error("element parse error: "+V);E=-1}E>x?x=E:b(Math.max(y,x)+1)}}function Ih(d,f){f.lineNumber=d.lineNumber;f.columnNumber=d.columnNumber;return f}function cm(d,f,k,n,u,a){function b(t,x,y){k.attributeNames.hasOwnProperty(t)&&a.fatalError("Attribute "+t+" redefined");k.addValue(t,x.replace(/[\t\n\r]/g," ").replace(/&#?\w+;/g,u),y)}for(var c,e,h=++f,m=0;;){var p=d.charAt(h);switch(p){case "\x3d":if(1===m)c=d.slice(f,h),m=3;else if(2===m)m=3;else throw Error("attribute equal must after attrName");
break;case "'":case '"':if(3===m||1===m)if(1===m&&(a.warning('attribute value must after "\x3d"'),c=d.slice(f,h)),f=h+1,h=d.indexOf(p,f),0<h)e=d.slice(f,h),b(c,e,f-1),m=5;else throw Error("attribute value no end '"+p+"' match");else if(4==m)e=d.slice(f,h),b(c,e,f),a.warning('attribute "'+c+'" missed start quot('+p+")!!"),f=h+1,m=5;else throw Error('attribute value must after "\x3d"');break;case "/":switch(m){case 0:k.setTagName(d.slice(f,h));case 5:case 6:case 7:m=7,k.closed=!0;case 4:case 1:break;
case 2:k.closed=!0;break;default:throw Error("attribute invalid close char('/')");}break;case "":return a.error("unexpected end of input"),0==m&&k.setTagName(d.slice(f,h)),h;case "\x3e":switch(m){case 0:k.setTagName(d.slice(f,h));case 5:case 6:case 7:break;case 4:case 1:e=d.slice(f,h),"/"===e.slice(-1)&&(k.closed=!0,e=e.slice(0,-1));case 2:2===m&&(e=c);4==m?(a.warning('attribute "'+e+'" missed quot(")!'),b(c,e,f)):(Yc.isHTML(n[""])&&e.match(/^(?:disabled|checked|selected)$/i)||a.warning('attribute "'+
e+'" missed value!! "'+e+'" instead!!'),b(e,e,f));break;case 3:throw Error("attribute value missed!!");}return h;case "\u0080":p=" ";default:if(" ">=p)switch(m){case 0:k.setTagName(d.slice(f,h));m=6;break;case 1:c=d.slice(f,h);m=2;break;case 4:e=d.slice(f,h),a.warning('attribute "'+e+'" missed quot(")!!'),b(c,e,f);case 5:m=6}else switch(m){case 2:k.tagName;Yc.isHTML(n[""])&&c.match(/^(?:disabled|checked|selected)$/i)||a.warning('attribute "'+c+'" missed value!! "'+c+'" instead2!!');b(c,c,f);f=h;m=
1;break;case 5:a.warning('attribute space is required"'+c+'"!!');case 6:m=1;f=h;break;case 3:m=4;f=h;break;case 7:throw Error("elements closed character '/' and '\x3e' must be connected to");}}h++}}function Jh(d,f,k){for(var n=d.tagName,u=null,a=d.length;a--;){var b=d[a],c=b.qName,e=b.value,h=c.indexOf(":");if(0<h){var m=b.prefix=c.slice(0,h);h=c.slice(h+1);m="xmlns"===m&&h}else h=c,m=null,m="xmlns"===c&&"";b.localName=h;!1!==m&&(null==u&&(u={},Kh(k,k={})),k[m]=u[m]=e,b.uri=Yc.XMLNS,f.startPrefixMapping(m,
e))}for(a=d.length;a--;)if(b=d[a],m=b.prefix)"xml"===m&&(b.uri=Yc.XML),"xmlns"!==m&&(b.uri=k[m||""]);h=n.indexOf(":");0<h?(m=d.prefix=n.slice(0,h),h=d.localName=n.slice(h+1)):(m=null,h=d.localName=n);a=d.uri=k[m||""];f.startElement(a,h,n,d);if(d.closed){if(f.endElement(a,h,n),u)for(m in u)Object.prototype.hasOwnProperty.call(u,m)&&f.endPrefixMapping(m)}else return d.currentNSMap=k,d.localNSMap=u,!0}function em(d,f,k,n,u){if(/^(?:script|textarea)$/i.test(k)){var a=d.indexOf("\x3c/"+k+"\x3e",f);d=d.substring(f+
1,a);if(/[&<]/.test(d)){if(/^script$/i.test(k))return u.characters(d,0,d.length),a;d=d.replace(/&#?\w+;/g,n);u.characters(d,0,d.length);return a}}return f+1}function dm(d,f,k,n){var u=n[k];null==u&&(u=d.lastIndexOf("\x3c/"+k+"\x3e"),u<f&&(u=d.lastIndexOf("\x3c/"+k)),n[k]=u);return u<f}function Kh(d,f){for(var k in d)Object.prototype.hasOwnProperty.call(d,k)&&(f[k]=d[k])}function bm(d,f,k,n){switch(d.charAt(f+2)){case "-":if("-"===d.charAt(f+3)){var u=d.indexOf("--\x3e",f+4);if(u>f)return k.comment(d,
f+4,u-f-4),u+3;n.error("Unclosed comment")}break;default:if("CDATA["==d.substr(f+3,6))return u=d.indexOf("]]\x3e",f+9),k.startCDATA(),k.characters(d,f+9,u-f-9),k.endCDATA(),u+3;a:{n=[];u=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;u.lastIndex=f;for(u.exec(d);f=u.exec(d);)if(n.push(f),f[1]){u=n;break a}u=void 0}var a=u.length;if(1<a&&/!doctype/i.test(u[0][0]))return d=u[1][0],n=f=!1,3<a&&(/^public$/i.test(u[2][0])?(f=u[3][0],n=4<a&&u[4][0]):/^system$/i.test(u[2][0])&&(n=u[3][0])),u=u[a-1],k.startDTD(d,
f,n),k.endDTD(),u.index+u[0].length}return-1}function am(d,f,k){var n=d.indexOf("?\x3e",f);return n&&(d=d.substring(f,n).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/))?(d[0].length,k.processingInstruction(d[1],d[2]),n+2):-1}function Hh(){this.attributeNames={}}function fm(d){return d.replace(/\r[\n\u0085]/g,"\n").replace(/[\r\u0085\u2028]/g,"\n")}function Lh(d){this.options=d||{locator:{}}}function gm(d,f,k){function n(b){var c=d[b];!c&&a&&(c=2==d.length?function(e){d(b,e)}:d);u[b]=c&&function(e){c("[xmldom "+
b+"]\t"+e+lf(k))}||function(){}}if(!d){if(f instanceof Jd)return f;d=f}var u={},a=d instanceof Function;k=k||{};n("warning");n("error");n("fatalError");return u}function Jd(){this.cdata=!1}function rc(d,f){f.lineNumber=d.lineNumber;f.columnNumber=d.columnNumber}function lf(d){if(d)return"\n@"+(d.systemId||"")+"#[line:"+d.lineNumber+",col:"+d.columnNumber+"]"}function Mh(d,f,k){return"string"==typeof d?d.substr(f,k):d.length>=f+k||f?new java.lang.String(d,f,k)+"":d}function Kd(d,f){d.currentElement?
d.currentElement.appendChild(f):d.doc.appendChild(f)}function Nh(d){let f="info",k;const n=function(...u){k("log",f,u)};k=hm(d,n);n.createLogger=u=>Nh(d+": "+u);n.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:f};n.level=u=>{if("string"===typeof u){if(!n.levels.hasOwnProperty(u))throw Error(`"${u}" in not a valid log level`);f=u}return f};n.history=()=>Va?[].concat(Va):[];n.history.filter=u=>(Va||[]).filter(a=>(new RegExp(`.*${u}.*`)).test(a[0]));
n.history.clear=()=>{Va&&(Va.length=0)};n.history.disable=()=>{null!==Va&&(Va.length=0,Va=null)};n.history.enable=()=>{null===Va&&(Va=[])};n.error=(...u)=>k("error",f,u);n.warn=(...u)=>k("warn",f,u);n.debug=(...u)=>k("debug",f,u);return n}function sc(d,f){Oh(d).forEach(k=>f(d[k],k))}function Ph(d,f,k=0){return Oh(d).reduce((n,u)=>f(n,d[u],u),k)}function rb(d){return!!d&&"object"===typeof d}function tc(d){return rb(d)&&"[object Object]"===im.call(d)&&d.constructor===Object}function ka(...d){const f=
{};d.forEach(k=>{k&&sc(k,(n,u)=>{tc(n)?(tc(f[u])||(f[u]={}),f[u]=ka(f[u],n)):f[u]=n})});return f}function Ld(d,f,k,n=!0){const u=b=>Object.defineProperty(d,f,{value:b,enumerable:!0,writable:!0}),a={configurable:!0,enumerable:!0,get(){const b=k();u(b);return b}};n&&(a.set=u);return Object.defineProperty(d,f,a)}function uc(){return P===D.document}function vc(d){return rb(d)&&1===d.nodeType}function Qh(){try{return D.parent!==D.self}catch(d){return!0}}function Rh(d){return function(f,k){if("string"!==
typeof f||!f.trim())return P[d](null);"string"===typeof k&&k.trim()&&(k=P.querySelector(k));k=vc(k)?k:P;return k[d]&&k[d](f)}}function aa(d="div",f={},k={},n){const u=P.createElement(d);Object.getOwnPropertyNames(f).forEach(function(a){const b=f[a];if("textContent"===a)Pb(u,b);else if(u[a]!==b||"tabIndex"===a)u[a]=b});Object.getOwnPropertyNames(k).forEach(function(a){u.setAttribute(a,k[a])});n&&mf(u,n);return u}function Pb(d,f){"undefined"===typeof d.textContent?d.innerText=f:d.textContent=f;return d}
function nf(d,f){f.firstChild?f.insertBefore(d,f.firstChild):f.appendChild(d)}function Zc(d,f){if(0<=f.indexOf(" "))throw Error("class has illegal whitespace characters");return d.classList.contains(f)}function Xb(d,...f){d.classList.add(...f.reduce((k,n)=>k.concat(n.split(/\s+/)),[]));return d}function Md(d,...f){if(!d)return ca.warn("removeClass was called with an element that doesn't exist"),null;d.classList.remove(...f.reduce((k,n)=>k.concat(n.split(/\s+/)),[]));return d}function Sh(d,f,k){"function"===
typeof k&&(k=k(d,f));"boolean"!==typeof k&&(k=void 0);f.split(/\s+/).forEach(n=>d.classList.toggle(n,k));return d}function Th(d,f){Object.getOwnPropertyNames(f).forEach(function(k){const n=f[k];null===n||"undefined"===typeof n||!1===n?d.removeAttribute(k):d.setAttribute(k,!0===n?"":n)})}function Qb(d){const f={};if(d&&d.attributes&&0<d.attributes.length){const k=d.attributes;for(let n=k.length-1;0<=n;n--){const u=k[n].name;let a=k[n].value;if("boolean"===typeof d[u]||-1!==",autoplay,controls,playsinline,loop,muted,default,defaultMuted,".indexOf(","+
u+","))a=null!==a?!0:!1;f[u]=a}}return f}function Uh(){P.body.focus();P.onselectstart=function(){return!1}}function Vh(){P.onselectstart=function(){return!0}}function wc(d){if(d&&d.getBoundingClientRect&&d.parentNode){const f=d.getBoundingClientRect(),k={};"bottom height left right top width".split(" ").forEach(n=>{void 0!==f[n]&&(k[n]=f[n])});k.height||(k.height=parseFloat(xc(d,"height")));k.width||(k.width=parseFloat(xc(d,"width")));return k}}function $c(d){if(!d||d&&!d.offsetParent)return{left:0,
top:0,width:0,height:0};const f=d.offsetWidth,k=d.offsetHeight;let n=0,u=0;for(;d.offsetParent&&d!==P[Nd.fullscreenElement];)n+=d.offsetLeft,u+=d.offsetTop,d=d.offsetParent;return{left:n,top:u,width:f,height:k}}function Od(d,f){var k=0,n=0;if(Na)for(var u=d;u&&"html"!==u.nodeName.toLowerCase();){var a=xc(u,"transform");/^matrix/.test(a)?(a=a.slice(7,-1).split(/,\s/).map(Number),k+=a[4],n+=a[5]):/^matrix3d/.test(a)&&(a=a.slice(9,-1).split(/,\s/).map(Number),k+=a[12],n+=a[13]);u=u.parentNode}u={};a=
$c(f.target);d=$c(d);const b=d.width,c=d.height;let e=f.offsetY-(d.top-a.top);a=f.offsetX-(d.left-a.left);f.changedTouches&&(a=f.changedTouches[0].pageX-d.left,e=f.changedTouches[0].pageY+d.top,Na&&(a-=k,e-=n));u.y=1-Math.max(0,Math.min(1,e/c));u.x=Math.max(0,Math.min(1,a/b));return u}function Wh(d){return rb(d)&&3===d.nodeType}function Pd(d){for(;d.firstChild;)d.removeChild(d.firstChild);return d}function Xh(d){"function"===typeof d&&(d=d());return(Array.isArray(d)?d:[d]).map(f=>{"function"===typeof f&&
(f=f());if(vc(f)||Wh(f))return f;if("string"===typeof f&&/\S/.test(f))return P.createTextNode(f)}).filter(f=>f)}function mf(d,f){Xh(f).forEach(k=>d.appendChild(k));return d}function Yh(d,f){return mf(Pd(d),f)}function ad(d){return void 0===d.button&&void 0===d.buttons||0===d.button&&void 0===d.buttons||"mouseup"===d.type&&0===d.button&&0===d.buttons?!0:0!==d.button||1!==d.buttons?!1:!0}function xc(d,f){if(!d||!f)return"";if("function"===typeof D.getComputedStyle){let k;try{k=D.getComputedStyle(d)}catch(n){return""}return k?
k.getPropertyValue(f)||k[f]:""}return""}function of(d,f){uc()&&(f&&(pf=f),D.setTimeout(jm,d))}function qf(){Zh=!0;D.removeEventListener("load",qf)}function $h(d,f){if(Oa.has(d)){var k=Oa.get(d);0===k.handlers[f].length&&(delete k.handlers[f],d.removeEventListener?d.removeEventListener(f,k.dispatcher,!1):d.detachEvent&&d.detachEvent("on"+f,k.dispatcher));0>=Object.getOwnPropertyNames(k.handlers).length&&(delete k.handlers,delete k.dispatcher,delete k.disabled);0===Object.getOwnPropertyNames(k).length&&
Oa.delete(d)}}function rf(d,f,k,n){k.forEach(function(u){d(f,u,n)})}function Qd(d){function f(){return!0}function k(){return!1}if(d.fixed_)return d;if(!d||!d.isPropagationStopped||!d.isImmediatePropagationStopped){const u=d||D.event;d={};for(var n in u)"layerX"!==n&&"layerY"!==n&&"keyLocation"!==n&&"webkitMovementX"!==n&&"webkitMovementY"!==n&&"path"!==n&&("returnValue"===n&&u.preventDefault||(d[n]=u[n]));d.target||(d.target=d.srcElement||P);d.relatedTarget||(d.relatedTarget=d.fromElement===d.target?
d.toElement:d.fromElement);d.preventDefault=function(){u.preventDefault&&u.preventDefault();d.returnValue=!1;u.returnValue=!1;d.defaultPrevented=!0};d.defaultPrevented=!1;d.stopPropagation=function(){u.stopPropagation&&u.stopPropagation();d.cancelBubble=!0;u.cancelBubble=!0;d.isPropagationStopped=f};d.isPropagationStopped=k;d.stopImmediatePropagation=function(){u.stopImmediatePropagation&&u.stopImmediatePropagation();d.isImmediatePropagationStopped=f;d.stopPropagation()};d.isImmediatePropagationStopped=
k;if(null!==d.clientX&&void 0!==d.clientX){n=P.documentElement;const a=P.body;d.pageX=d.clientX+(n&&n.scrollLeft||a&&a.scrollLeft||0)-(n&&n.clientLeft||a&&a.clientLeft||0);d.pageY=d.clientY+(n&&n.scrollTop||a&&a.scrollTop||0)-(n&&n.clientTop||a&&a.clientTop||0)}d.which=d.charCode||d.keyCode;null!==d.button&&void 0!==d.button&&(d.button=d.button&1?0:d.button&4?1:d.button&2?2:0)}d.fixed_=!0;return d}function $a(d,f,k){if(Array.isArray(f))return rf($a,d,f,k);Oa.has(d)||Oa.set(d,{});const n=Oa.get(d);
n.handlers||(n.handlers={});n.handlers[f]||(n.handlers[f]=[]);k.guid||(k.guid=sb++);n.handlers[f].push(k);n.dispatcher||(n.disabled=!1,n.dispatcher=function(u,a){if(!n.disabled){u=Qd(u);var b=n.handlers[u.type];if(b){b=b.slice(0);for(let c=0,e=b.length;c<e&&!u.isImmediatePropagationStopped();c++)try{b[c].call(d,u,a)}catch(h){ca.error(h)}}}});1===n.handlers[f].length&&(d.addEventListener?(k=!1,km()&&-1<lm.indexOf(f)&&(k={passive:!0}),d.addEventListener(f,n.dispatcher,k)):d.attachEvent&&d.attachEvent("on"+
f,n.dispatcher))}function Ha(d,f,k){if(Oa.has(d)){var n=Oa.get(d);if(n.handlers){if(Array.isArray(f))return rf(Ha,d,f,k);if(void 0===f)for(var u in n.handlers)Object.prototype.hasOwnProperty.call(n.handlers||{},u)&&(f=d,k=u,n.handlers[k]=[],$h(f,k));else if(u=n.handlers[f]){if(!k)n.handlers[f]=[];else if(k.guid)for(n=0;n<u.length;n++)u[n].guid===k.guid&&u.splice(n--,1);$h(d,f)}}}}function yc(d,f,k){const n=Oa.has(d)?Oa.get(d):{},u=d.parentNode||d.ownerDocument;"string"===typeof f?f={type:f,target:d}:
f.target||(f.target=d);f=Qd(f);n.dispatcher&&n.dispatcher.call(d,f,k);if(u&&!f.isPropagationStopped()&&!0===f.bubbles)yc.call(null,u,f,k);else if(!u&&!f.defaultPrevented&&f.target&&f.target[f.type]&&(Oa.has(f.target)||Oa.set(f.target,{}),d=Oa.get(f.target),f.target[f.type])){d.disabled=!0;if("function"===typeof f.target[f.type])f.target[f.type]();d.disabled=!1}return!f.defaultPrevented}function Rd(d,f,k){if(Array.isArray(f))return rf(Rd,d,f,k);const n=function(){Ha(d,f,n);k.apply(this,arguments)};
n.guid=k.guid=k.guid||sb++;$a(d,f,n)}function sf(d,f,k){const n=function(){Ha(d,f,n);k.apply(this,arguments)};n.guid=k.guid=k.guid||sb++;$a(d,f,n)}function tf(d,f={}){({eventBusKey:f}=f);if(f){if(!d[f].nodeName)throw Error(`The eventBusKey "${f}" does not refer to an element.`);d.eventBusEl_=d[f]}else d.eventBusEl_=aa("span",{className:"vjs-event-bus"});Object.assign(d,mm);d.eventedCallbacks&&d.eventedCallbacks.forEach(k=>{k()});d.on("dispose",()=>{d.off();[d,d.el_,d.eventBusEl_].forEach(function(k){k&&
Oa.has(k)&&Oa.delete(k)});D.setTimeout(()=>{d.eventBusEl_=null},0)});return d}function ai(d,f){Object.assign(d,nm);d.state=Object.assign({},d.state,f);if("function"===typeof d.handleStateChanged&&Fb(d))d.on("statechanged",d.handleStateChanged);return d}function bi(d,f,k,n){var u=k.length-1;if("number"!==typeof n||0>n||n>u)throw Error(`Failed to execute '${d}' on 'TimeRanges': The index provided (${n}) is non-numeric or out of bounds (0-${u}).`);return k[n][f]}function uf(d){let f;f=void 0===d||0===
d.length?{length:0,start(){throw Error("This TimeRanges object is empty");},end(){throw Error("This TimeRanges object is empty");}}:{length:d.length,start:bi.bind(null,"start",0,d),end:bi.bind(null,"end",1,d)};D.Symbol&&D.Symbol.iterator&&(f[D.Symbol.iterator]=()=>(d||[]).values());return f}function tb(d,f){return Array.isArray(d)?uf(d):void 0===d||void 0===f?uf():uf([[d,f]])}function ci(d){vf=d}function di(){vf=ei}function Yb(d,f=d){return vf(d,f)}function fi(d,f){let k=0,n,u;if(!f)return 0;d&&d.length||
(d=tb(0,0));for(let a=0;a<d.length;a++)n=d.start(a),u=d.end(a),u>f&&(u=f),k+=u-n;return k/f}function Pa(d){if(d instanceof Pa)return d;"number"===typeof d?this.code=d:"string"===typeof d?this.message=d:rb(d)&&("number"===typeof d.code&&(this.code=d.code),Object.assign(this,d));this.message||(this.message=Pa.defaultMessages[this.code]||"")}function bd(d){return void 0!==d&&null!==d&&"function"===typeof d.then}function ub(d){bd(d)&&d.then(null,f=>{})}function om(d,f,k,n,u={}){const a=d.textTracks();
u.kind=f;k&&(u.label=k);n&&(u.language=n);u.tech=d;d=new Qa.text.TrackClass(u);a.addTrack(d);return d}function pm(d,f,k){d.setTimeout(()=>Zb(f,$b[f.type],k,d),1)}function qm(d,f){d.forEach(k=>k.setTech&&k.setTech(f))}function gi(d,f,k,n=null){var u="call"+sa(k);u=d.reduce(wf(u),n);f=(n=u===Sd)?null:f[k](u);for(u=d.length-1;0<=u;u--){const a=d[u];if(a[k])a[k](n,f)}return f}function wf(d){return(f,k)=>f===Sd?Sd:k[d]?k[d](f):f}function rm(d,f){const k=xf[d.id()];let n=null;if(void 0===k||null===k)return n=
f(d),xf[d.id()]=[[f,n]],n;for(let u=0;u<k.length;u++){const [a,b]=k[u];a===f&&(n=b)}null===n&&(n=f(d),k.push([f,n]));return n}function Zb(d={},f=[],k,n,u=[],a=!1){const [b,...c]=f;if("string"===typeof b)Zb(d,$b[b],k,n,u,a);else if(b){const e=rm(n,b);if(!e.setSource)return u.push(e),Zb(d,c,k,n,u,a);e.setSource(Object.assign({},d),function(h,m){if(h)return Zb(d,c,k,n,u,a);u.push(e);Zb(m,d.type===m.type?c:$b[m.type],k,n,u,a)})}else c.length?Zb(d,c,k,n,u,a):a?k(d,u):Zb(d,$b["*"],k,n,u,!0)}function hi(d){if(!d.type){const f=
Td(d.src);f&&(d.type=f)}return d}function yf(d,f){if(4===d.length)d=d[1]+d[1]+d[2]+d[2]+d[3]+d[3];else if(7===d.length)d=d.slice(1);else throw Error("Invalid color code provided, "+d+"; must be formatted as e.g. #f0e or #f604e2.");return"rgba("+parseInt(d.slice(0,2),16)+","+parseInt(d.slice(2,4),16)+","+parseInt(d.slice(4,6),16)+","+f+")"}function ac(d,f,k){d=Number(d);return Math.min(k,Math.max(f,isNaN(d)?f:d))}function ii(d,f){f&&(d=f(d));if(d&&"none"!==d)return d}function sm(d,f){let k=!1;return function(...n){k||
ca.warn(d);k=!0;return f.apply(this,n)}}function kb(d,f,k,n){return sm(`${f} is deprecated and will be removed in ${d}.0; please use ${k} instead.`,n)}function H(d,f,k){let n=H.getPlayer(d);if(n)return f&&ca.warn(`Player "${d}" is already initialised. Options will not be applied.`),k&&n.ready(k),n;const u="string"===typeof d?Rb("#"+ji(d)):d;if(!vc(u))throw new TypeError("The element or ID supplied is not valid. (videojs)");u.ownerDocument.defaultView&&u.ownerDocument.body.contains(u)||ca.warn("The element supplied is not included in the DOM");
f=f||{};!0===f.restoreEl&&(f.restoreEl=(u.parentNode&&u.parentNode.hasAttribute("data-vjs-player")?u.parentNode:u).cloneNode(!0));Sb("beforesetup").forEach(a=>{a=a(u,ka(f));!rb(a)||Array.isArray(a)?ca.error("please return an object in beforesetup hooks"):f=ka(f,a)});n=new (M.getComponent("Player"))(u,f,k);Sb("setup").forEach(a=>a(n));return n}function la(...d){const f=H.obj||H;return(f.merge||f.mergeOptions).apply(f,d)}function Ia(...d){const f=H.time||H;return(f.createTimeRanges||f.createTimeRanges).apply(f,
d)}function Gb(){}var ab="undefined"!==typeof window?window:"undefined"!==typeof La.commonjsGlobal?La.commonjsGlobal:"undefined"!==typeof self?self:{};const D=La.getDefaultExportFromCjs(ab);var tm=require("./document.js");module.exports=new tm;const um=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),vm=La.getAugmentedNamespace(um);var ki="undefined"!==typeof La.commonjsGlobal?La.commonjsGlobal:"undefined"!==typeof window?window:{};if("undefined"!==typeof document)var zf=
document;else(zf=ki["__GLOBAL_DOCUMENT_CACHE@4"])||(zf=ki["__GLOBAL_DOCUMENT_CACHE@4"]=vm);var Af=zf;const P=La.getDefaultExportFromCjs(Af);var Ud={exports:{}};Ud.exports;(function(d,f){function k(c){if(c&&"object"===typeof c){var e=c.which||c.keyCode||c.charCode;e&&(c=e)}if("number"===typeof c)return a[c];c=String(c);if((e=n[c.toLowerCase()])||(e=u[c.toLowerCase()]))return e;if(1===c.length)return c.charCodeAt(0)}k.isEventKey=function(c,e){if(c&&"object"===typeof c){c=c.which||c.keyCode||c.charCode;
if(null===c||void 0===c)return!1;if("string"===typeof e){var h=n[e.toLowerCase()];if(h||(h=u[e.toLowerCase()]))return h===c}else if("number"===typeof e)return e===c;return!1}};f=d.exports=k;var n=f.code=f.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,
"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"\x3d":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},u=f.aliases={windows:91,"\u21e7":16,"\u2325":18,"\u2303":17,"\u2318":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};for(d=97;123>d;d++)n[String.fromCharCode(d)]=d-32;for(d=48;58>d;d++)n[d-48]=d;for(d=1;13>d;d++)n["f"+d]=d+111;for(d=0;10>
d;d++)n["numpad "+d]=d+96;var a=f.names=f.title={};for(d in n)a[n[d]]=d;for(var b in u)n[b]=u[b]})(Ud,Ud.exports);const Y=La.getDefaultExportFromCjs(Ud.exports),wm=La.getDefaultExportFromCjs(function(d,f){var k=null;try{var n=JSON.parse(d,f)}catch(u){k=u}return[k,n]});var Bf={};module.exports=Ue;module.exports.__esModule=!0;module.exports["default"]=module.exports;const xm=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),ym=La.getAugmentedNamespace(xm);module.exports=
function(d){if(!d)return!1;var f=zm.call(d);return"[object Function]"===f||"function"===typeof d&&"[object RegExp]"!==f||"undefined"!==typeof window&&(d===window.setTimeout||d===window.alert||d===window.confirm||d===window.prompt)};var zm=Object.prototype.toString;const Am=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),Bm=La.getAugmentedNamespace(Am);var Ml=ym,Ll=Bm;ob.httpHandler=function(d,f){void 0===f&&(f=!1);return function(k,n,u){if(k)d(k);else if(400<=
n.statusCode&&599>=n.statusCode){k=u;if(f)if(ab.TextDecoder){n=Jl(n.headers&&n.headers["content-type"]);try{k=(new TextDecoder(n)).decode(u)}catch(a){}}else k=String.fromCharCode.apply(null,new Uint8Array(u));d({cause:k})}else d(null,u)}};var Nl=function(d){var f={};if(!d)return f;d.trim().split("\n").forEach(function(k){var n=k.indexOf(":"),u=k.slice(0,n).trim().toLowerCase();k=k.slice(n+1).trim();"undefined"===typeof f[u]?f[u]=k:Array.isArray(f[u])?f[u].push(k):f[u]=[f[u],k]});return f};Bf=ob;Bf.default=
ob;ob.XMLHttpRequest=ab.XMLHttpRequest||Ol;ob.XDomainRequest="withCredentials"in new ob.XMLHttpRequest?ob.XMLHttpRequest:ab.XDomainRequest;(function(d,f){for(var k=0;k<d.length;k++)f(d[k])})("get put post patch head delete".split(" "),function(d){ob["delete"===d?"del":d]=function(f,k,n){k=dh(f,k,n);k.method=d.toUpperCase();return eh(k)}});const li=La.getDefaultExportFromCjs(Bf);var mi={},We=Object.create||function(){function d(){}return function(f){if(1!==arguments.length)throw Error("Object.create shim only accepts one parameter.");
d.prototype=f;return new d}}();Za.prototype=We(Error.prototype);Za.prototype.constructor=Za;Za.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}};Rc.prototype={set:function(d,f){this.get(d)||""===f||(this.values[d]=f)},get:function(d,f,k){return k?this.has(d)?this.values[d]:f[k]:this.has(d)?this.values[d]:f},has:function(d){return d in this.values},alt:function(d,f,k){for(var n=0;n<k.length;++n)if(f===k[n]){this.set(d,f);break}},
integer:function(d,f){/^-?\d+$/.test(f)&&this.set(d,parseInt(f,10))},percent:function(d,f){return f.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(f=parseFloat(f),0<=f&&100>=f)?(this.set(d,f),!0):!1}};var Xe=Af.createElement&&Af.createElement("textarea"),Ql={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},hh={white:"rgba(255,255,255,1)",lime:"rgba(0,255,0,1)",cyan:"rgba(0,255,255,1)",red:"rgba(255,0,0,1)",yellow:"rgba(255,255,0,1)",magenta:"rgba(255,0,255,1)",blue:"rgba(0,0,255,1)",black:"rgba(0,0,0,1)"},
Rl={v:"title",lang:"lang"},gh={rt:"ruby"},ih=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,
64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],
[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,
1114109]];Ye.prototype.applyStyles=function(d,f){f=f||this.div;for(var k in d)d.hasOwnProperty(k)&&(f.style[k]=d[k])};Ye.prototype.formatStyle=function(d,f){return 0===d?0:d+f};Cd.prototype=We(Ye.prototype);Cd.prototype.constructor=Cd;Ma.prototype.move=function(d,f){f=void 0!==f?f:this.lineHeight;switch(d){case "+x":this.left+=f;this.right+=f;break;case "-x":this.left-=f;this.right-=f;break;case "+y":this.top+=f;this.bottom+=f;break;case "-y":this.top-=f,this.bottom-=f}};Ma.prototype.overlaps=function(d){return this.left<
d.right&&this.right>d.left&&this.top<d.bottom&&this.bottom>d.top};Ma.prototype.overlapsAny=function(d){for(var f=0;f<d.length;f++)if(this.overlaps(d[f]))return!0;return!1};Ma.prototype.within=function(d){return this.top>=d.top&&this.bottom<=d.bottom&&this.left>=d.left&&this.right<=d.right};Ma.prototype.overlapsOppositeAxis=function(d,f){switch(f){case "+x":return this.left<d.left;case "-x":return this.right>d.right;case "+y":return this.top<d.top;case "-y":return this.bottom>d.bottom}};Ma.prototype.intersectPercentage=
function(d){return Math.max(0,Math.min(this.right,d.right)-Math.max(this.left,d.left))*Math.max(0,Math.min(this.bottom,d.bottom)-Math.max(this.top,d.top))/(this.height*this.width)};Ma.prototype.toCSSCompatValues=function(d){return{top:this.top-d.top,bottom:d.bottom-this.bottom,left:this.left-d.left,right:d.right-this.right,height:this.height,width:this.width}};Ma.getSimpleBoxPosition=function(d){var f=d.div?d.div.offsetHeight:d.tagName?d.offsetHeight:0,k=d.div?d.div.offsetWidth:d.tagName?d.offsetWidth:
0,n=d.div?d.div.offsetTop:d.tagName?d.offsetTop:0;d=d.div?d.div.getBoundingClientRect():d.tagName?d.getBoundingClientRect():d;return{left:d.left,right:d.right,top:d.top||n,height:d.height||f,bottom:d.bottom||n+(d.height||f),width:d.width||k}};kc.StringDecoder=function(){return{decode:function(d){if(!d)return"";if("string"!==typeof d)throw Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(d))}}};kc.convertCueToDOMTree=function(d,f){return d&&f?fh(d,f):null};kc.processCues=
function(d,f,k){if(!d||!f||!k)return null;for(;k.firstChild;)k.removeChild(k.firstChild);var n=d.document.createElement("div");n.style.position="absolute";n.style.left="0";n.style.right="0";n.style.top="0";n.style.bottom="0";n.style.margin="1.5%";k.appendChild(n);if(function(c){for(var e=0;e<c.length;e++)if(c[e].hasBeenReset||!c[e].displayState)return!0;return!1}(f)){var u=[],a=Ma.getSimpleBoxPosition(n),b={font:Math.round(5*a.height)/100+"px sans-serif"};(function(){for(var c,e,h=0;h<f.length;h++){e=
f[h];c=new Cd(d,e,b);n.appendChild(c.div);var m=void 0,p=void 0,t=void 0,x=c,y=a;p=u;var C=new Ma(x),z=x.cue;if("number"===typeof z.line&&(z.snapToLines||0<=z.line&&100>=z.line))var E=z.line;else if(z.track&&z.track.textTrackList&&z.track.textTrackList.mediaElement){E=z.track;for(var K=E.textTrackList,G=0,O=0;O<K.length&&K[O]!==E;O++)"showing"===K[O].mode&&G++;E=-1*++G}else E=-1;K=[];if(z.snapToLines){switch(z.vertical){case "":K=["+y","-y"];t="height";break;case "rl":K=["+x","-x"];t="width";break;
case "lr":K=["-x","+x"],t="width"}G=C.lineHeight;O=G*Math.round(E);t=y[t]+G;var R=K[0];Math.abs(O)>t&&(O=(0>O?-1:1)*Math.ceil(t/G)*G);0>E&&(O+=""===z.vertical?y.height:y.width,K=K.reverse());C.move(R,O)}else{C=C.lineHeight/y.height*100;switch(z.lineAlign){case "center":E-=C/2;break;case "end":E-=C}switch(z.vertical){case "":x.applyStyles({top:x.formatStyle(E,"%")});break;case "rl":x.applyStyles({left:x.formatStyle(E,"%")});break;case "lr":x.applyStyles({right:x.formatStyle(E,"%")})}K=["+y","-x","+x",
"-y"];C=new Ma(x)}a:{z=C;C=K;t=new Ma(z);E=1;for(K=0;K<C.length;K++){for(;z.overlapsOppositeAxis(y,C[K])||z.within(y)&&z.overlapsAny(p);)z.move(C[K]);if(z.within(y)){p=z;break a}G=z.intersectPercentage(y);E>G&&(m=new Ma(z),E=G);z=new Ma(t)}p=m||t}x.move(p.toCSSCompatValues(y));e.displayState=c.div;u.push(Ma.getSimpleBoxPosition(c))}})()}else for(k=0;k<f.length;k++)n.appendChild(f[k].displayState)};kc.Parser=function(d,f,k){k||(k=f,f={});f||(f={});this.window=d;this.vttjs=f;this.state="INITIAL";this.buffer=
"";this.decoder=k||new TextDecoder("utf8");this.regionList=[]};kc.Parser.prototype={reportOrThrowError:function(d){if(d instanceof Za)this.onparsingerror&&this.onparsingerror(d);else throw d;},parse:function(d){function f(){for(var h=a.buffer,m=0;m<h.length&&"\r"!==h[m]&&"\n"!==h[m];)++m;var p=h.substr(0,m);"\r"===h[m]&&++m;"\n"===h[m]&&++m;a.buffer=h.substr(m);return p}function k(h){var m=new Rc;Sc(h,function(p,t){switch(p){case "id":m.set(p,t);break;case "width":m.percent(p,t);break;case "lines":m.integer(p,
t);break;case "regionanchor":case "viewportanchor":t=t.split(",");if(2!==t.length)break;var x=new Rc;x.percent("x",t[0]);x.percent("y",t[1]);if(!x.has("x")||!x.has("y"))break;m.set(p+"X",x.get("x"));m.set(p+"Y",x.get("y"));break;case "scroll":m.alt(p,t,["up"])}},/=/,/\s/);m.has("id")&&(h=new (a.vttjs.VTTRegion||a.window.VTTRegion),h.width=m.get("width",100),h.lines=m.get("lines",3),h.regionAnchorX=m.get("regionanchorX",0),h.regionAnchorY=m.get("regionanchorY",100),h.viewportAnchorX=m.get("viewportanchorX",
0),h.viewportAnchorY=m.get("viewportanchorY",100),h.scroll=m.get("scroll",""),a.onregion&&a.onregion(h),a.regionList.push({id:m.get("id"),region:h}))}function n(h){var m=new Rc;Sc(h,function(p,t){switch(p){case "MPEGT":m.integer(p+"S",t);break;case "LOCA":m.set(p+"L",Ve(t))}},/[^\d]:/,/,/);a.ontimestampmap&&a.ontimestampmap({MPEGTS:m.get("MPEGTS"),LOCAL:m.get("LOCAL")})}function u(h){h.match(/X-TIMESTAMP-MAP/)?Sc(h,function(m,p){switch(m){case "X-TIMESTAMP-MAP":n(p)}},/=/):Sc(h,function(m,p){switch(m){case "Region":k(p)}},
/:/)}var a=this;d&&(a.buffer+=a.decoder.decode(d,{stream:!0}));try{if("INITIAL"===a.state){if(!/\r\n|\n/.test(a.buffer))return this;var b=f();var c=b.match(/^WEBVTT([ \t].*)?$/);if(!c||!c[0])throw new Za(Za.Errors.BadSignature);a.state="HEADER"}for(d=!1;a.buffer;){if(!/\r\n|\n/.test(a.buffer))return this;d?d=!1:b=f();switch(a.state){case "HEADER":/:/.test(b)?u(b):b||(a.state="ID");continue;case "NOTE":b||(a.state="ID");continue;case "ID":if(/^NOTE($|[ \t])/.test(b)){a.state="NOTE";break}if(!b)continue;
a.cue=new (a.vttjs.VTTCue||a.window.VTTCue)(0,0,"");try{a.cue.align="center"}catch(h){a.cue.align="middle"}a.state="CUE";if(-1===b.indexOf("--\x3e")){a.cue.id=b;continue}case "CUE":try{Pl(b,a.cue,a.regionList)}catch(h){a.reportOrThrowError(h);a.cue=null;a.state="BADCUE";continue}a.state="CUETEXT";continue;case "CUETEXT":var e=-1!==b.indexOf("--\x3e");if(!b||e&&(d=!0)){a.oncue&&a.oncue(a.cue);a.cue=null;a.state="ID";continue}a.cue.text&&(a.cue.text+="\n");a.cue.text+=b.replace(/\u2028/g,"\n").replace(/u2029/g,
"\n");continue;case "BADCUE":b||(a.state="ID")}}}catch(h){a.reportOrThrowError(h);if("CUETEXT"===a.state&&a.cue&&a.oncue)a.oncue(a.cue);a.cue=null;a.state="INITIAL"===a.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){try{this.buffer+=this.decoder.decode();if(this.cue||"HEADER"===this.state)this.buffer+="\n\n",this.parse();if("INITIAL"===this.state)throw new Za(Za.Errors.BadSignature);}catch(d){this.reportOrThrowError(d)}this.onflush&&this.onflush();return this}};var Vl={"":1,lr:1,rl:1},Ul=
{start:1,center:1,end:1,left:1,right:1,auto:1,"line-left":1,"line-right":1};jh.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)};var Cm={"":!0,up:!0},bc=mi={WebVTT:kc,VTTCue:jh,VTTRegion:function(){var d=100,f=3,k=0,n=100,u=0,a=100,b="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return d},set:function(c){if(!Tc(c))throw Error("Width must be between 0 and 100.");d=c}},lines:{enumerable:!0,get:function(){return f},set:function(c){if("number"!==
typeof c)throw new TypeError("Lines must be set to a number.");f=c}},regionAnchorY:{enumerable:!0,get:function(){return n},set:function(c){if(!Tc(c))throw Error("RegionAnchorX must be between 0 and 100.");n=c}},regionAnchorX:{enumerable:!0,get:function(){return k},set:function(c){if(!Tc(c))throw Error("RegionAnchorY must be between 0 and 100.");k=c}},viewportAnchorY:{enumerable:!0,get:function(){return a},set:function(c){if(!Tc(c))throw Error("ViewportAnchorY must be between 0 and 100.");a=c}},viewportAnchorX:{enumerable:!0,
get:function(){return u},set:function(c){if(!Tc(c))throw Error("ViewportAnchorX must be between 0 and 100.");u=c}},scroll:{enumerable:!0,get:function(){return b},set:function(c){c="string"!==typeof c?!1:Cm[c.toLowerCase()]?c.toLowerCase():!1;!1===c?console.warn("Scroll: an invalid or illegal string was specified."):b=c}}})}};ab.vttjs=bc;ab.WebVTT=bc.WebVTT;var Dm=bc.VTTCue,Em=bc.VTTRegion,Fm=ab.VTTCue,Gm=ab.VTTRegion;bc.shim=function(){ab.VTTCue=Dm;ab.VTTRegion=Em};bc.restore=function(){ab.VTTCue=
Fm;ab.VTTRegion=Gm};ab.VTTCue||bc.shim();const ni=La.getDefaultExportFromCjs(mi);var Vd={exports:{}};Vd.exports;(function(d,f){(function(k){var n=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,u=/^(?=([^\/?#]*))\1([^]*)$/,a=/(?:\/|^)\.(?=\/)/g,b=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,c={buildAbsoluteURL:function(e,h,m){m=m||{};e=e.trim();h=h.trim();if(!h){if(!m.alwaysNormalize)return e;m=c.parseURL(e);if(!m)throw Error("Error trying to parse base URL.");
m.path=c.normalizePath(m.path);return c.buildURLFromParts(m)}var p=c.parseURL(h);if(!p)throw Error("Error trying to parse relative URL.");if(p.scheme){if(!m.alwaysNormalize)return h;p.path=c.normalizePath(p.path);return c.buildURLFromParts(p)}h=c.parseURL(e);if(!h)throw Error("Error trying to parse base URL.");!h.netLoc&&h.path&&"/"!==h.path[0]&&(e=u.exec(h.path),h.netLoc=e[1],h.path=e[2]);h.netLoc&&!h.path&&(h.path="/");e={scheme:h.scheme,netLoc:p.netLoc,path:null,params:p.params,query:p.query,fragment:p.fragment};
p.netLoc||(e.netLoc=h.netLoc,"/"!==p.path[0]&&(p.path?(h=h.path,h=h.substring(0,h.lastIndexOf("/")+1)+p.path,e.path=c.normalizePath(h)):(e.path=h.path,p.params||(e.params=h.params,p.query||(e.query=h.query)))));null===e.path&&(e.path=m.alwaysNormalize?c.normalizePath(p.path):p.path);return c.buildURLFromParts(e)},parseURL:function(e){return(e=n.exec(e))?{scheme:e[1]||"",netLoc:e[2]||"",path:e[3]||"",params:e[4]||"",query:e[5]||"",fragment:e[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(a,
"");e.length!==(e=e.replace(b,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}};d.exports=c})()})(Vd,Vd.exports);const Wd=La.getDefaultExportFromCjs(Vd.exports);var Cf=function(){function d(){this.listeners={}}var f=d.prototype;f.on=function(k,n){this.listeners[k]||(this.listeners[k]=[]);this.listeners[k].push(n)};f.off=function(k,n){if(!this.listeners[k])return!1;n=this.listeners[k].indexOf(n);this.listeners[k]=
this.listeners[k].slice(0);this.listeners[k].splice(n,1);return-1<n};f.trigger=function(k){var n=this.listeners[k];if(n)if(2===arguments.length)for(var u=n.length,a=0;a<u;++a)n[a].call(this,arguments[1]);else{u=Array.prototype.slice.call(arguments,1);a=n.length;for(var b=0;b<a;++b)n[b].apply(this,u)}};f.dispose=function(){this.listeners={}};f.pipe=function(k){this.on("data",function(n){k.push(n)})};return d}();class Hm extends Cf{constructor(){super();this.buffer=""}push(d){this.buffer+=d;for(d=this.buffer.indexOf("\n");-1<
d;d=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,d)),this.buffer=this.buffer.substring(d+1)}}const Im=String.fromCharCode(9),Df=function(d){d=/([0-9.]*)?@?([0-9.]*)?/.exec(d||"");const f={};d[1]&&(f.length=parseInt(d[1],10));d[2]&&(f.offset=parseInt(d[2],10));return f},gb=function(d){const f={};if(!d)return f;d=d.split.call(d,RegExp('(?:^|,)((?:[^\x3d]*)\x3d(?:"[^"]*"|[^,]*))'));let k=d.length,n;for(;k--;)""!==d[k]&&(n=/([^=]*)=(.*)/.exec(d[k]).slice(1),n[0]=n[0].replace(/^\s+|\s+$/g,
""),n[1]=n[1].replace(/^\s+|\s+$/g,""),n[1]=n[1].replace(/^['"](.*)['"]$/g,"$1"),f[n[0]]=n[1]);return f};class Jm extends Cf{constructor(){super();this.customParsers=[];this.tagMappers=[]}push(d){let f,k;d=d.trim();0!==d.length&&("#"!==d[0]?this.trigger("data",{type:"uri",uri:d}):this.tagMappers.reduce((n,u)=>{u=u(d);return u===d?n:n.concat([u])},[d]).forEach(n=>{for(var u=0;u<this.customParsers.length;u++)if(this.customParsers[u].call(this,n))return;if(0!==n.indexOf("#EXT"))this.trigger("data",{type:"comment",
text:n.slice(1)});else if(n=n.replace("\r",""),f=/^#EXTM3U/.exec(n))this.trigger("data",{type:"tag",tagType:"m3u"});else if(f=/^#EXTINF:([0-9\.]*)?,?(.*)?$/.exec(n))k={type:"tag",tagType:"inf"},f[1]&&(k.duration=parseFloat(f[1])),f[2]&&(k.title=f[2]),this.trigger("data",k);else if(f=/^#EXT-X-TARGETDURATION:([0-9.]*)?/.exec(n))k={type:"tag",tagType:"targetduration"},f[1]&&(k.duration=parseInt(f[1],10)),this.trigger("data",k);else if(f=/^#EXT-X-VERSION:([0-9.]*)?/.exec(n))k={type:"tag",tagType:"version"},
f[1]&&(k.version=parseInt(f[1],10)),this.trigger("data",k);else if(f=/^#EXT-X-MEDIA-SEQUENCE:(\-?[0-9.]*)?/.exec(n))k={type:"tag",tagType:"media-sequence"},f[1]&&(k.number=parseInt(f[1],10)),this.trigger("data",k);else if(f=/^#EXT-X-DISCONTINUITY-SEQUENCE:(\-?[0-9.]*)?/.exec(n))k={type:"tag",tagType:"discontinuity-sequence"},f[1]&&(k.number=parseInt(f[1],10)),this.trigger("data",k);else if(f=/^#EXT-X-PLAYLIST-TYPE:(.*)?$/.exec(n))k={type:"tag",tagType:"playlist-type"},f[1]&&(k.playlistType=f[1]),
this.trigger("data",k);else if(f=/^#EXT-X-BYTERANGE:(.*)?$/.exec(n))k=Nb(Df(f[1]),{type:"tag",tagType:"byterange"}),this.trigger("data",k);else if(f=/^#EXT-X-ALLOW-CACHE:(YES|NO)?/.exec(n))k={type:"tag",tagType:"allow-cache"},f[1]&&(k.allowed=!/NO/.test(f[1])),this.trigger("data",k);else if(f=/^#EXT-X-MAP:(.*)$/.exec(n)){k={type:"tag",tagType:"map"};if(f[1]){var a=gb(f[1]);a.URI&&(k.uri=a.URI);a.BYTERANGE&&(k.byterange=Df(a.BYTERANGE))}this.trigger("data",k)}else if(f=/^#EXT-X-STREAM-INF:(.*)$/.exec(n))k=
{type:"tag",tagType:"stream-inf"},f[1]&&(k.attributes=gb(f[1]),k.attributes.RESOLUTION&&(a=k.attributes.RESOLUTION.split("x"),n={},a[0]&&(n.width=parseInt(a[0],10)),a[1]&&(n.height=parseInt(a[1],10)),k.attributes.RESOLUTION=n),k.attributes.BANDWIDTH&&(k.attributes.BANDWIDTH=parseInt(k.attributes.BANDWIDTH,10)),k.attributes["FRAME-RATE"]&&(k.attributes["FRAME-RATE"]=parseFloat(k.attributes["FRAME-RATE"])),k.attributes["PROGRAM-ID"]&&(k.attributes["PROGRAM-ID"]=parseInt(k.attributes["PROGRAM-ID"],10))),
this.trigger("data",k);else if(f=/^#EXT-X-MEDIA:(.*)$/.exec(n))k={type:"tag",tagType:"media"},f[1]&&(k.attributes=gb(f[1])),this.trigger("data",k);else if(f=/^#EXT-X-ENDLIST/.exec(n))this.trigger("data",{type:"tag",tagType:"endlist"});else if(f=/^#EXT-X-DISCONTINUITY/.exec(n))this.trigger("data",{type:"tag",tagType:"discontinuity"});else if(f=/^#EXT-X-PROGRAM-DATE-TIME:(.*)$/.exec(n))k={type:"tag",tagType:"program-date-time"},f[1]&&(k.dateTimeString=f[1],k.dateTimeObject=new Date(f[1])),this.trigger("data",
k);else if(f=/^#EXT-X-KEY:(.*)$/.exec(n))k={type:"tag",tagType:"key"},f[1]&&(k.attributes=gb(f[1]),k.attributes.IV&&("0x"===k.attributes.IV.substring(0,2).toLowerCase()&&(k.attributes.IV=k.attributes.IV.substring(2)),k.attributes.IV=k.attributes.IV.match(/.{8}/g),k.attributes.IV[0]=parseInt(k.attributes.IV[0],16),k.attributes.IV[1]=parseInt(k.attributes.IV[1],16),k.attributes.IV[2]=parseInt(k.attributes.IV[2],16),k.attributes.IV[3]=parseInt(k.attributes.IV[3],16),k.attributes.IV=new Uint32Array(k.attributes.IV))),
this.trigger("data",k);else if(f=/^#EXT-X-START:(.*)$/.exec(n))k={type:"tag",tagType:"start"},f[1]&&(k.attributes=gb(f[1]),k.attributes["TIME-OFFSET"]=parseFloat(k.attributes["TIME-OFFSET"]),k.attributes.PRECISE=/YES/.test(k.attributes.PRECISE)),this.trigger("data",k);else if(f=/^#EXT-X-CUE-OUT-CONT:(.*)?$/.exec(n))k={type:"tag",tagType:"cue-out-cont"},k.data=f[1]?f[1]:"",this.trigger("data",k);else if(f=/^#EXT-X-CUE-OUT:(.*)?$/.exec(n))k={type:"tag",tagType:"cue-out"},k.data=f[1]?f[1]:"",this.trigger("data",
k);else if(f=/^#EXT-X-CUE-IN:(.*)?$/.exec(n))k={type:"tag",tagType:"cue-in"},k.data=f[1]?f[1]:"",this.trigger("data",k);else if((f=/^#EXT-X-SKIP:(.*)$/.exec(n))&&f[1])k={type:"tag",tagType:"skip"},k.attributes=gb(f[1]),k.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(k.attributes["SKIPPED-SEGMENTS"]=parseInt(k.attributes["SKIPPED-SEGMENTS"],10)),k.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(k.attributes["RECENTLY-REMOVED-DATERANGES"]=k.attributes["RECENTLY-REMOVED-DATERANGES"].split(Im)),
this.trigger("data",k);else if((f=/^#EXT-X-PART:(.*)$/.exec(n))&&f[1])k={type:"tag",tagType:"part"},k.attributes=gb(f[1]),["DURATION"].forEach(function(b){k.attributes.hasOwnProperty(b)&&(k.attributes[b]=parseFloat(k.attributes[b]))}),["INDEPENDENT","GAP"].forEach(function(b){k.attributes.hasOwnProperty(b)&&(k.attributes[b]=/YES/.test(k.attributes[b]))}),k.attributes.hasOwnProperty("BYTERANGE")&&(k.attributes.byterange=Df(k.attributes.BYTERANGE)),this.trigger("data",k);else if((f=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(n))&&
f[1])k={type:"tag",tagType:"server-control"},k.attributes=gb(f[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach(function(b){k.attributes.hasOwnProperty(b)&&(k.attributes[b]=parseFloat(k.attributes[b]))}),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach(function(b){k.attributes.hasOwnProperty(b)&&(k.attributes[b]=/YES/.test(k.attributes[b]))}),this.trigger("data",k);else if((f=/^#EXT-X-PART-INF:(.*)$/.exec(n))&&f[1])k={type:"tag",tagType:"part-inf"},k.attributes=gb(f[1]),["PART-TARGET"].forEach(function(b){k.attributes.hasOwnProperty(b)&&
(k.attributes[b]=parseFloat(k.attributes[b]))}),this.trigger("data",k);else if((f=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(n))&&f[1])k={type:"tag",tagType:"preload-hint"},k.attributes=gb(f[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach(function(b){k.attributes.hasOwnProperty(b)&&(k.attributes[b]=parseInt(k.attributes[b],10),k.attributes.byterange=k.attributes.byterange||{},k.attributes.byterange["BYTERANGE-LENGTH"===b?"length":"offset"]=k.attributes[b],delete k.attributes[b])}),this.trigger("data",k);
else if((f=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(n))&&f[1])k={type:"tag",tagType:"rendition-report"},k.attributes=gb(f[1]),["LAST-MSN","LAST-PART"].forEach(function(b){k.attributes.hasOwnProperty(b)&&(k.attributes[b]=parseInt(k.attributes[b],10))}),this.trigger("data",k);else if((f=/^#EXT-X-DATERANGE:(.*)$/.exec(n))&&f[1]){k={type:"tag",tagType:"daterange"};k.attributes=gb(f[1]);["ID","CLASS"].forEach(function(b){k.attributes.hasOwnProperty(b)&&(k.attributes[b]=String(k.attributes[b]))});["START-DATE",
"END-DATE"].forEach(function(b){k.attributes.hasOwnProperty(b)&&(k.attributes[b]=new Date(k.attributes[b]))});["DURATION","PLANNED-DURATION"].forEach(function(b){k.attributes.hasOwnProperty(b)&&(k.attributes[b]=parseFloat(k.attributes[b]))});["END-ON-NEXT"].forEach(function(b){k.attributes.hasOwnProperty(b)&&(k.attributes[b]=/YES/i.test(k.attributes[b]))});["SCTE35-CMD"," SCTE35-OUT","SCTE35-IN"].forEach(function(b){k.attributes.hasOwnProperty(b)&&(k.attributes[b]=k.attributes[b].toString(16))});
n=/^X-([A-Z]+-)+[A-Z]+$/;for(a in k.attributes){if(!n.test(a))continue;u=/[0-9A-Fa-f]{6}/g.test(k.attributes[a]);const b=/^\d+(\.\d+)?$/.test(k.attributes[a]);k.attributes[a]=u?k.attributes[a].toString(16):b?parseFloat(k.attributes[a]):String(k.attributes[a])}this.trigger("data",k)}else(f=/^#EXT-X-INDEPENDENT-SEGMENTS/.exec(n))?this.trigger("data",{type:"tag",tagType:"independent-segments"}):this.trigger("data",{type:"tag",data:n.slice(4)})}))}addParser({expression:d,customType:f,dataParser:k,segment:n}){"function"!==
typeof k&&(k=u=>u);this.customParsers.push(u=>{if(d.exec(u))return this.trigger("data",{type:"custom",data:k(u),customType:f,segment:n}),!0})}addTagMapper({expression:d,map:f}){this.tagMappers.push(k=>d.test(k)?f(k):k)}}const Km=d=>d.toLowerCase().replace(/-(\w)/g,f=>f[1].toUpperCase()),cc=function(d){const f={};Object.keys(d).forEach(function(k){f[Km(k)]=d[k]});return f},Ef=function(d){const {serverControl:f,targetDuration:k,partTargetDuration:n}=d;if(f){d=k&&3*k;var u=n&&2*n;k&&!f.hasOwnProperty("holdBack")&&
(f.holdBack=d,this.trigger("info",{message:`${"#EXT-X-SERVER-CONTROL"} defaulting HOLD-BACK to targetDuration * 3 (${d}).`}));d&&f.holdBack<d&&(this.trigger("warn",{message:`${"#EXT-X-SERVER-CONTROL"} clamping HOLD-BACK (${f.holdBack}) to targetDuration * 3 (${d})`}),f.holdBack=d);n&&!f.hasOwnProperty("partHoldBack")&&(f.partHoldBack=3*n,this.trigger("info",{message:`${"#EXT-X-SERVER-CONTROL"} defaulting PART-HOLD-BACK to partTargetDuration * 3 (${f.partHoldBack}).`}));n&&f.partHoldBack<u&&(this.trigger("warn",
{message:`${"#EXT-X-SERVER-CONTROL"} clamping PART-HOLD-BACK (${f.partHoldBack}) to partTargetDuration * 2 (${u}).`}),f.partHoldBack=u)}};class Lm extends Cf{constructor(){super();this.lineStream=new Hm;this.parseStream=new Jm;this.lineStream.pipe(this.parseStream);const d=this,f=[];let k={},n,u,a=!1;const b=function(){},c={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}};let e=0;this.manifest={allowCache:!0,discontinuityStarts:[],segments:[]};let h=0,m=0;const p={};this.on("end",()=>{k.uri||
!k.parts&&!k.preloadHints||(!k.map&&n&&(k.map=n),!k.key&&u&&(k.key=u),k.timeline||"number"!==typeof e||(k.timeline=e),this.manifest.preloadSegment=k)});this.parseStream.on("data",function(t){let x,y;({tag(){({version(){t.version&&(this.manifest.version=t.version)},["allow-cache"](){this.manifest.allowCache=t.allowed;"allowed"in t||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange(){const C={};"length"in t&&(k.byterange=C,C.length=t.length,"offset"in
t||(t.offset=h));"offset"in t&&(k.byterange=C,C.offset=t.offset);h=C.offset+C.length},endlist(){this.manifest.endList=!0},inf(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"}));"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"}));0<t.duration&&(k.duration=t.duration);0===t.duration&&(k.duration=.01,this.trigger("info",
{message:"updating zero segment duration to a small value"}));this.manifest.segments=f},key(){if(t.attributes)if("NONE"===t.attributes.METHOD)u=null;else if(t.attributes.URI)if("com.apple.streamingkeydelivery"===t.attributes.KEYFORMAT)this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:t.attributes};else if("com.microsoft.playready"===t.attributes.KEYFORMAT)this.manifest.contentProtection=this.manifest.contentProtection||
{},this.manifest.contentProtection["com.microsoft.playready"]={uri:t.attributes.URI};else if("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"===t.attributes.KEYFORMAT)if(-1===["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(t.attributes.METHOD))this.trigger("warn",{message:"invalid key method provided for Widevine"});else if("SAMPLE-AES-CENC"===t.attributes.METHOD&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),"data:text/plain;base64,"!==
t.attributes.URI.substring(0,23))this.trigger("warn",{message:"invalid key URI provided for Widevine"});else if(t.attributes.KEYID&&"0x"===t.attributes.KEYID.substring(0,2)){this.manifest.contentProtection=this.manifest.contentProtection||{};var C=this.manifest.contentProtection,z={schemeIdUri:t.attributes.KEYFORMAT,keyId:t.attributes.KEYID.substring(2)};var E=t.attributes.URI.split(",")[1];E=D.atob?D.atob(E):Buffer.from(E,"base64").toString("binary");for(var K=new Uint8Array(E.length),G=0;G<E.length;G++)K[G]=
E.charCodeAt(G);C["com.widevine.alpha"]={attributes:z,pssh:K}}else this.trigger("warn",{message:"invalid key ID provided for Widevine"});else t.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),u={method:t.attributes.METHOD||"AES-128",uri:t.attributes.URI},"undefined"!==typeof t.attributes.IV&&(u.iv=t.attributes.IV);else this.trigger("warn",{message:"ignoring key declaration without URI"});else this.trigger("warn",{message:"ignoring key declaration without attribute list"})},
["media-sequence"](){isFinite(t.number)?this.manifest.mediaSequence=t.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+t.number})},["discontinuity-sequence"](){isFinite(t.number)?e=this.manifest.discontinuitySequence=t.number:this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+t.number})},["playlist-type"](){/VOD|EVENT/.test(t.playlistType)?this.manifest.playlistType=t.playlistType:this.trigger("warn",{message:"ignoring unknown playlist type: "+t.playlist})},
map(){n={};t.uri&&(n.uri=t.uri);t.byterange&&(n.byterange=t.byterange);u&&(n.key=u)},["stream-inf"](){this.manifest.playlists=f;this.manifest.mediaGroups=this.manifest.mediaGroups||c;t.attributes?(k.attributes||(k.attributes={}),Nb(k.attributes,t.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},media(){this.manifest.mediaGroups=this.manifest.mediaGroups||c;if(t.attributes&&t.attributes.TYPE&&t.attributes["GROUP-ID"]&&t.attributes.NAME){var C=this.manifest.mediaGroups[t.attributes.TYPE];
C[t.attributes["GROUP-ID"]]=C[t.attributes["GROUP-ID"]]||{};x=C[t.attributes["GROUP-ID"]];y={default:/yes/i.test(t.attributes.DEFAULT)};y.autoselect=y.default?!0:/yes/i.test(t.attributes.AUTOSELECT);t.attributes.LANGUAGE&&(y.language=t.attributes.LANGUAGE);t.attributes.URI&&(y.uri=t.attributes.URI);t.attributes["INSTREAM-ID"]&&(y.instreamId=t.attributes["INSTREAM-ID"]);t.attributes.CHARACTERISTICS&&(y.characteristics=t.attributes.CHARACTERISTICS);t.attributes.FORCED&&(y.forced=/yes/i.test(t.attributes.FORCED));
x[t.attributes.NAME]=y}else this.trigger("warn",{message:"ignoring incomplete or missing media group"})},discontinuity(){e+=1;k.discontinuity=!0;this.manifest.discontinuityStarts.push(f.length)},["program-date-time"](){"undefined"===typeof this.manifest.dateTimeString&&(this.manifest.dateTimeString=t.dateTimeString,this.manifest.dateTimeObject=t.dateTimeObject);k.dateTimeString=t.dateTimeString;k.dateTimeObject=t.dateTimeObject},targetduration(){!isFinite(t.duration)||0>t.duration?this.trigger("warn",
{message:"ignoring invalid target duration: "+t.duration}):(this.manifest.targetDuration=t.duration,Ef.call(this,this.manifest))},start(){!t.attributes||isNaN(t.attributes["TIME-OFFSET"])?this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"}):this.manifest.start={timeOffset:t.attributes["TIME-OFFSET"],precise:t.attributes.PRECISE}},["cue-out"](){k.cueOut=t.data},["cue-out-cont"](){k.cueOutCont=t.data},["cue-in"](){k.cueIn=t.data},skip(){this.manifest.skip=cc(t.attributes);
this.warnOnMissingAttributes_("#EXT-X-SKIP",t.attributes,["SKIPPED-SEGMENTS"])},part(){a=!0;const C=this.manifest.segments.length,z=cc(t.attributes);k.parts=k.parts||[];k.parts.push(z);z.byterange&&(z.byterange.hasOwnProperty("offset")||(z.byterange.offset=m),m=z.byterange.offset+z.byterange.length);this.warnOnMissingAttributes_(`#EXT-X-PART #${k.parts.length-1} for segment #${C}`,t.attributes,["URI","DURATION"]);this.manifest.renditionReports&&this.manifest.renditionReports.forEach((E,K)=>{E.hasOwnProperty("lastPart")||
this.trigger("warn",{message:`#EXT-X-RENDITION-REPORT #${K} lacks required attribute(s): LAST-PART`})})},["server-control"](){const C=this.manifest.serverControl=cc(t.attributes);C.hasOwnProperty("canBlockReload")||(C.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"}));Ef.call(this,this.manifest);C.canSkipDateranges&&!C.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},
["preload-hint"](){const C=this.manifest.segments.length,z=cc(t.attributes);var E=z.type&&"PART"===z.type;k.preloadHints=k.preloadHints||[];k.preloadHints.push(z);z.byterange&&!z.byterange.hasOwnProperty("offset")&&(z.byterange.offset=E?m:0,E&&(m=z.byterange.offset+z.byterange.length));E=k.preloadHints.length-1;this.warnOnMissingAttributes_(`#EXT-X-PRELOAD-HINT #${E} for segment #${C}`,t.attributes,["TYPE","URI"]);if(z.type)for(let K=0;K<k.preloadHints.length-1;K++){const G=k.preloadHints[K];G.type&&
G.type===z.type&&this.trigger("warn",{message:`#EXT-X-PRELOAD-HINT #${E} for segment #${C} has the same TYPE ${z.type} as preload hint #${K}`})}},["rendition-report"](){var C=cc(t.attributes);this.manifest.renditionReports=this.manifest.renditionReports||[];this.manifest.renditionReports.push(C);C=this.manifest.renditionReports.length-1;const z=["LAST-MSN","URI"];a&&z.push("LAST-PART");this.warnOnMissingAttributes_(`#EXT-X-RENDITION-REPORT #${C}`,t.attributes,z)},["part-inf"](){this.manifest.partInf=
cc(t.attributes);this.warnOnMissingAttributes_("#EXT-X-PART-INF",t.attributes,["PART-TARGET"]);this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget);Ef.call(this,this.manifest)},daterange(){this.manifest.daterange=this.manifest.daterange||[];this.manifest.daterange.push(cc(t.attributes));const C=this.manifest.daterange.length-1;this.warnOnMissingAttributes_(`#EXT-X-DATERANGE #${C}`,t.attributes,["ID","START-DATE"]);const z=this.manifest.daterange[C];
z.endDate&&z.startDate&&new Date(z.endDate)<new Date(z.startDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE END-DATE must be equal to or later than the value of the START-DATE"});z.duration&&0>z.duration&&this.trigger("warn",{message:"EXT-X-DATERANGE DURATION must not be negative"});z.plannedDuration&&0>z.plannedDuration&&this.trigger("warn",{message:"EXT-X-DATERANGE PLANNED-DURATION must not be negative"});var E=!!z.endOnNext;E&&!z.class&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT\x3dYES attribute must have a CLASS attribute"});
E&&(z.duration||z.endDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT\x3dYES attribute must not contain DURATION or END-DATE attributes"});z.duration&&z.endDate&&(E=z.startDate,E=E.setSeconds(E.getSeconds()+z.duration),this.manifest.daterange[C].endDate=new Date(E));z&&!this.manifest.dateTimeString&&this.trigger("warn",{message:"A playlist with EXT-X-DATERANGE tag must contain atleast one EXT-X-PROGRAM-DATE-TIME tag"});if(!p[z.id])p[z.id]=z;else for(const K in p[z.id])if(p[z.id][K]!==
z[K]){this.trigger("warn",{message:"EXT-X-DATERANGE tags with the same ID in a playlist must have the same attributes and same attribute values"});break}},["independent-segments"](){this.manifest.independentSegments=!0}}[t.tagType]||b).call(d)},uri(){k.uri=t.uri;f.push(k);!this.manifest.targetDuration||"duration"in k||(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),k.duration=this.manifest.targetDuration);u&&(k.key=u);k.timeline=e;n&&(k.map=n);m=0;k={}},comment(){},
custom(){t.segment?(k.custom=k.custom||{},k.custom[t.customType]=t.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[t.customType]=t.data)}})[t.type].call(d)})}warnOnMissingAttributes_(d,f,k){const n=[];k.forEach(function(u){f.hasOwnProperty(u)||n.push(u)});n.length&&this.trigger("warn",{message:`${d} lacks required attribute(s): ${n.join(", ")}`})}push(d){this.lineStream.push(d)}end(){this.lineStream.push("\n");this.trigger("end")}addParser(d){this.parseStream.addParser(d)}addTagMapper(d){this.parseStream.addTagMapper(d)}}
var dc={mp4:/^(av0?1|avc0?[1234]|vp0?9|flac|opus|mp3|mp4a|mp4v|stpp.ttml.im1t)/,webm:/^(vp0?[89]|av0?1|opus|vorbis)/,ogg:/^(vp0?[89]|theora|flac|opus|vorbis)/,video:/^(av0?1|avc0?[1234]|vp0?[89]|hvc1|hev1|theora|mp4v)/,audio:/^(mp4a|flac|vorbis|opus|ac-[34]|ec-3|alac|mp3|speex|aac)/,text:/^(stpp.ttml.im1t)/,muxerVideo:/^(avc0?1)/,muxerAudio:/^(mp4a)/,muxerText:/a^/},Mm=["video","audio","text"],oi=["Video","Audio","Text"],pi=function(d){return d?d.replace(/avc1\.(\d+)\.(\d+)/i,function(f,k,n){f=("00"+
Number(k).toString(16)).slice(-2);n=("00"+Number(n).toString(16)).slice(-2);return"avc1."+f+"00"+n}):d},vb=function(d){void 0===d&&(d="");var f=[];d.split(",").forEach(function(k){k=k.trim();var n;Mm.forEach(function(u){var a=dc[u].exec(k.toLowerCase());if(a&&!(1>=a.length)){n=u;a=k.substring(0,a[1].length);var b=k.replace(a,"");f.push({type:a,details:b,mediaType:u})}});n||f.push({type:k,details:"",mediaType:"unknown"})});return f},Nm=function(d,f){if(!d.mediaGroups.AUDIO||!f)return null;d=d.mediaGroups.AUDIO[f];
if(!d)return null;for(var k in d)if(f=d[k],f.default&&f.playlists)return vb(f.playlists[0].attributes.CODECS);return null},qi=function(d){void 0===d&&(d="");return dc.audio.test(d.trim().toLowerCase())},Om=function(d){void 0===d&&(d="");return dc.text.test(d.trim().toLowerCase())},cd=function(d){if(d&&"string"===typeof d){var f=d.toLowerCase().split(",").map(function(u){return pi(u.trim())}),k="video";1===f.length&&qi(f[0])?k="audio":1===f.length&&Om(f[0])&&(k="application");var n="mp4";f.every(function(u){return dc.mp4.test(u)})?
n="mp4":f.every(function(u){return dc.webm.test(u)})?n="webm":f.every(function(u){return dc.ogg.test(u)})&&(n="ogg");return k+"/"+n+';codecs\x3d"'+d+'"'}},Xd=function(d){void 0===d&&(d="");return D.MediaSource&&D.MediaSource.isTypeSupported&&D.MediaSource.isTypeSupported(cd(d))||!1},Ff=function(d){void 0===d&&(d="");return d.toLowerCase().split(",").every(function(f){f=f.trim();for(var k=0;k<oi.length;k++)if(dc["muxer"+oi[k]].test(f))return!0;return!1})},Pm=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i,
Qm=/^application\/dash\+xml/i,ri=function(d){return Pm.test(d)?"hls":Qm.test(d)?"dash":"application/vnd.videojs.vhs+json"===d?"vhs-json":null},si=function(d){return"function"===ArrayBuffer.isView?ArrayBuffer.isView(d):d&&d.buffer instanceof ArrayBuffer},T=function(d){if(d instanceof Uint8Array)return d;Array.isArray(d)||si(d)||d instanceof ArrayBuffer||(d="number"!==typeof d||"number"===typeof d&&d!==d?0:[d]);return new Uint8Array(d&&d.buffer||d,d&&d.byteOffset||0,d&&d.byteLength||0)},Fa=D.BigInt||
Number,Gf=[Fa("0x1"),Fa("0x100"),Fa("0x10000"),Fa("0x1000000"),Fa("0x100000000"),Fa("0x10000000000"),Fa("0x1000000000000"),Fa("0x100000000000000"),Fa("0x10000000000000000")];(function(){var d=new Uint16Array([65484]);d=new Uint8Array(d.buffer,d.byteOffset,d.byteLength);return 255===d[0]?"big":204===d[0]?"little":"unknown"})();var Rm=function(d,f){var k=void 0===f?{}:f;f=k.signed;f=void 0===f?!1:f;k=k.le;var n=void 0===k?!1:k;d=T(d);k=n?"reduce":"reduceRight";k=(d[k]?d[k]:Array.prototype[k]).call(d,
function(u,a,b){return u+Fa(a)*Gf[n?b:Math.abs(b+1-d.length)]},Fa(0));f&&(f=Gf[d.length]/Fa(2)-Fa(1),k=Fa(k),k>f&&(k=k-f-f-Fa(2)));return Number(k)},Sm=function(d,f){f=(void 0===f?{}:f).le;f=void 0===f?!1:f;if("bigint"!==typeof d&&"number"!==typeof d||"number"===typeof d&&d!==d)d=0;d=Fa(d);for(var k=Math.ceil(d.toString(2).length/8),n=new Uint8Array(new ArrayBuffer(k)),u=0;u<k;u++){var a=f?u:Math.abs(u+1-n.length);n[a]=Number(d/Gf[u]&Fa(255));0>d&&(n[a]=Math.abs(~n[a]),n[a]-=0===u?1:2)}return n},
ti=function(d,f){"string"!==typeof d&&d&&"function"===typeof d.toString&&(d=d.toString());if("string"!==typeof d)return new Uint8Array;f||(d=unescape(encodeURIComponent(d)));f=new Uint8Array(d.length);for(var k=0;k<d.length;k++)f[k]=d.charCodeAt(k);return f},Tm=function(){for(var d=arguments.length,f=Array(d),k=0;k<d;k++)f[k]=arguments[k];f=f.filter(function(a){return a&&(a.byteLength||a.length)&&"string"!==typeof a});if(1>=f.length)return T(f[0]);d=f.reduce(function(a,b,c){return a+(b.byteLength||
b.length)},0);var n=new Uint8Array(d),u=0;f.forEach(function(a){a=T(a);n.set(a,u);u+=a.byteLength});return n},pa=function(d,f,k){k=void 0===k?{}:k;var n=k.offset,u=void 0===n?0:n;k=k.mask;var a=void 0===k?[]:k;d=T(d);f=T(f);k=f.every?f.every:Array.prototype.every;return f.length&&d.length-u>=f.length&&k.call(f,function(b,c){return b===(a[c]?a[c]&d[u+c]:d[u+c])})},Hf=function(d,f){if(/^[a-z]+:/i.test(f))return f;/^data:/.test(d)&&(d=D.location&&D.location.href||"");var k="function"===typeof D.URL,
n=/^\/\//.test(d),u=!D.location&&!/\/\//i.test(d);k?d=new D.URL(d,D.location||"http://example.com"):/\/\//i.test(d)||(d=Wd.buildAbsoluteURL(D.location&&D.location.href||"",d));return k?(d=new URL(f,d),u?d.href.slice(18):n?d.href.slice(d.protocol.length):d.href):Wd.buildAbsoluteURL(d,f)},Um=function(d,f,k){f.forEach(function(n){for(var u in d.mediaGroups[n])for(var a in d.mediaGroups[n][u])k(d.mediaGroups[n][u][a],n,u,a)})},Vm=Dd({HTML:"text/html",isHTML:function(d){return d===Vm.HTML},XML_APPLICATION:"application/xml",
XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),ui=Dd({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(d){return d===ui.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});var Yd=ui;var qb=function(d,f,k){void 0===k&&(k=Array.prototype);if(d&&"function"===typeof k.find)return k.find.call(d,f);for(k=0;k<d.length;k++)if(Object.prototype.hasOwnProperty.call(d,k)){var n=d[k];if(f.call(void 0,
n,k,d))return n}},mc=Yd,Wa={},jb=Wa.ELEMENT_NODE=1,pc=Wa.ATTRIBUTE_NODE=2,Id=Wa.TEXT_NODE=3,Ah=Wa.CDATA_SECTION_NODE=4,Eh=Wa.ENTITY_REFERENCE_NODE=5,Wm=Wa.ENTITY_NODE=6,Dh=Wa.PROCESSING_INSTRUCTION_NODE=7,Bh=Wa.COMMENT_NODE=8,zh=Wa.DOCUMENT_NODE=9,Ch=Wa.DOCUMENT_TYPE_NODE=10,Eb=Wa.DOCUMENT_FRAGMENT_NODE=11,Xm=Wa.NOTATION_NODE=12,Ja={},za={};Ja.INDEX_SIZE_ERR=(za[1]="Index size error",1);Ja.DOMSTRING_SIZE_ERR=(za[2]="DOMString size error",2);var Ua=Ja.HIERARCHY_REQUEST_ERR=(za[3]="Hierarchy request error",
3);Ja.WRONG_DOCUMENT_ERR=(za[4]="Wrong document",4);Ja.INVALID_CHARACTER_ERR=(za[5]="Invalid character",5);Ja.NO_DATA_ALLOWED_ERR=(za[6]="No data allowed",6);Ja.NO_MODIFICATION_ALLOWED_ERR=(za[7]="No modification allowed",7);var ph=Ja.NOT_FOUND_ERR=(za[8]="Not found",8);Ja.NOT_SUPPORTED_ERR=(za[9]="Not supported",9);var vi=Ja.INUSE_ATTRIBUTE_ERR=(za[10]="Attribute in use",10);Ja.INVALID_STATE_ERR=(za[11]="Invalid state",11);Ja.SYNTAX_ERR=(za[12]="Syntax error",12);Ja.INVALID_MODIFICATION_ERR=(za[13]=
"Invalid modification",13);Ja.NAMESPACE_ERR=(za[14]="Invalid namespace",14);Ja.INVALID_ACCESS_ERR=(za[15]="Invalid access",15);va.prototype=Error.prototype;Uc(Ja,va);Ob.prototype={length:0,item:function(d){return this[d]||null},toString:function(d,f){for(var k=[],n=0;n<this.length;n++)oc(this[n],k,d,f);return k.join("")},filter:function(d){return Array.prototype.filter.call(this,d)},indexOf:function(d){return Array.prototype.indexOf.call(this,d)}};lc.prototype.item=function(d){$e(this);return this[d]};
Ta(lc,Ob);Ed.prototype={length:0,item:Ob.prototype.item,getNamedItem:function(d){for(var f=this.length;f--;){var k=this[f];if(k.nodeName==d)return k}},setNamedItem:function(d){var f=d.ownerElement;if(f&&f!=this._ownerElement)throw new va(vi);f=this.getNamedItem(d.nodeName);nh(this._ownerElement,this,d,f);return f},setNamedItemNS:function(d){var f=d.ownerElement;if(f&&f!=this._ownerElement)throw new va(vi);f=this.getNamedItemNS(d.namespaceURI,d.localName);nh(this._ownerElement,this,d,f);return f},
removeNamedItem:function(d){d=this.getNamedItem(d);oh(this._ownerElement,this,d);return d},removeNamedItemNS:function(d,f){d=this.getNamedItemNS(d,f);oh(this._ownerElement,this,d);return d},getNamedItemNS:function(d,f){for(var k=this.length;k--;){var n=this[k];if(n.localName==f&&n.namespaceURI==d)return n}return null}};qh.prototype={hasFeature:function(d,f){return!0},createDocument:function(d,f,k){var n=new Wc;n.implementation=this;n.childNodes=new Ob;n.doctype=k||null;k&&n.appendChild(k);f&&(d=n.createElementNS(d,
f),n.appendChild(d));return n},createDocumentType:function(d,f,k){var n=new ff;n.name=d;n.nodeName=d;n.publicId=f||"";n.systemId=k||"";return n}};ia.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(d,f){return Fd(this,d,f)},replaceChild:function(d,f){Fd(this,d,f,vh);f&&this.removeChild(f)},removeChild:function(d){return sh(this,
d)},appendChild:function(d){return this.insertBefore(d,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(d){return kf(this.ownerDocument||this,this,d)},normalize:function(){for(var d=this.firstChild;d;){var f=d.nextSibling;f&&f.nodeType==Id&&d.nodeType==Id?(this.removeChild(f),d.appendData(f.data)):(d.normalize(),d=f)}},isSupported:function(d,f){return this.ownerDocument.implementation.hasFeature(d,f)},hasAttributes:function(){return 0<this.attributes.length},lookupPrefix:function(d){for(var f=
this;f;){var k=f._nsMap;if(k)for(var n in k)if(Object.prototype.hasOwnProperty.call(k,n)&&k[n]===d)return n;f=f.nodeType==pc?f.ownerDocument:f.parentNode}return null},lookupNamespaceURI:function(d){for(var f=this;f;){var k=f._nsMap;if(k&&Object.prototype.hasOwnProperty.call(k,d))return k[d];f=f.nodeType==pc?f.ownerDocument:f.parentNode}return null},isDefaultNamespace:function(d){return null==this.lookupPrefix(d)}};Uc(Wa,ia);Uc(Wa,ia.prototype);Wc.prototype={nodeName:"#document",nodeType:zh,doctype:null,
documentElement:null,_inc:1,insertBefore:function(d,f){if(d.nodeType==Eb){for(var k=d.firstChild;k;){var n=k.nextSibling;this.insertBefore(k,f);k=n}return d}Fd(this,d,f);d.ownerDocument=this;null===this.documentElement&&d.nodeType===jb&&(this.documentElement=d);return d},removeChild:function(d){this.documentElement==d&&(this.documentElement=null);return sh(this,d)},replaceChild:function(d,f){Fd(this,d,f,vh);d.ownerDocument=this;f&&this.removeChild(f);pb(d)&&(this.documentElement=d)},importNode:function(d,
f){return Fh(this,d,f)},getElementById:function(d){var f=null;Vc(this.documentElement,function(k){if(k.nodeType==jb&&k.getAttribute("id")==d)return f=k,!0});return f},getElementsByClassName:function(d){var f=kh(d);return new lc(this,function(k){var n=[];0<f.length&&Vc(k.documentElement,function(u){if(u!==k&&u.nodeType===jb){var a=u.getAttribute("class");if(a){var b=d===a;b||(a=kh(a),b=f.every(Yl(a)));b&&n.push(u)}}});return n})},createElement:function(d){var f=new nc;f.ownerDocument=this;f.nodeName=
d;f.tagName=d;f.localName=d;f.childNodes=new Ob;return(f.attributes=new Ed)._ownerElement=f},createDocumentFragment:function(){var d=new Hd;d.ownerDocument=this;d.childNodes=new Ob;return d},createTextNode:function(d){var f=new cf;f.ownerDocument=this;f.appendData(d);return f},createComment:function(d){var f=new df;f.ownerDocument=this;f.appendData(d);return f},createCDATASection:function(d){var f=new ef;f.ownerDocument=this;f.appendData(d);return f},createProcessingInstruction:function(d,f){var k=
new hf;k.ownerDocument=this;k.tagName=k.target=d;k.nodeValue=k.data=f;return k},createAttribute:function(d){var f=new Gd;f.ownerDocument=this;f.name=d;f.nodeName=d;f.localName=d;f.specified=!0;return f},createEntityReference:function(d){var f=new gf;f.ownerDocument=this;f.nodeName=d;return f},createElementNS:function(d,f){var k=new nc,n=f.split(":"),u=k.attributes=new Ed;k.childNodes=new Ob;k.ownerDocument=this;k.nodeName=f;k.tagName=f;k.namespaceURI=d;2==n.length?(k.prefix=n[0],k.localName=n[1]):
k.localName=f;return u._ownerElement=k},createAttributeNS:function(d,f){var k=new Gd,n=f.split(":");k.ownerDocument=this;k.nodeName=f;k.name=f;k.namespaceURI=d;k.specified=!0;2==n.length?(k.prefix=n[0],k.localName=n[1]):k.localName=f;return k}};Ta(Wc,ia);nc.prototype={nodeType:jb,hasAttribute:function(d){return null!=this.getAttributeNode(d)},getAttribute:function(d){return(d=this.getAttributeNode(d))&&d.value||""},getAttributeNode:function(d){return this.attributes.getNamedItem(d)},setAttribute:function(d,
f){d=this.ownerDocument.createAttribute(d);d.value=d.nodeValue=""+f;this.setAttributeNode(d)},removeAttribute:function(d){(d=this.getAttributeNode(d))&&this.removeAttributeNode(d)},appendChild:function(d){if(d.nodeType===Eb)return this.insertBefore(d,null);d.parentNode&&d.parentNode.removeChild(d);d.parentNode=this;d.previousSibling=this.lastChild;d.nextSibling=null;d.previousSibling?d.previousSibling.nextSibling=d:this.firstChild=d;this.lastChild=d;af(this.ownerDocument,this,d);return d},setAttributeNode:function(d){return this.attributes.setNamedItem(d)},
setAttributeNodeNS:function(d){return this.attributes.setNamedItemNS(d)},removeAttributeNode:function(d){return this.attributes.removeNamedItem(d.nodeName)},removeAttributeNS:function(d,f){(d=this.getAttributeNodeNS(d,f))&&this.removeAttributeNode(d)},hasAttributeNS:function(d,f){return null!=this.getAttributeNodeNS(d,f)},getAttributeNS:function(d,f){return(d=this.getAttributeNodeNS(d,f))&&d.value||""},setAttributeNS:function(d,f,k){d=this.ownerDocument.createAttributeNS(d,f);d.value=d.nodeValue=
""+k;this.setAttributeNode(d)},getAttributeNodeNS:function(d,f){return this.attributes.getNamedItemNS(d,f)},getElementsByTagName:function(d){return new lc(this,function(f){var k=[];Vc(f,function(n){n===f||n.nodeType!=jb||"*"!==d&&n.tagName!=d||k.push(n)});return k})},getElementsByTagNameNS:function(d,f){return new lc(this,function(k){var n=[];Vc(k,function(u){u===k||u.nodeType!==jb||"*"!==d&&u.namespaceURI!==d||"*"!==f&&u.localName!=f||n.push(u)});return n})}};Wc.prototype.getElementsByTagName=nc.prototype.getElementsByTagName;
Wc.prototype.getElementsByTagNameNS=nc.prototype.getElementsByTagNameNS;Ta(nc,ia);Gd.prototype.nodeType=pc;Ta(Gd,ia);Xc.prototype={data:"",substringData:function(d,f){return this.data.substring(d,d+f)},appendData:function(d){this.nodeValue=this.data=d=this.data+d;this.length=d.length},insertData:function(d,f){this.replaceData(d,0,f)},appendChild:function(d){throw Error(za[Ua]);},deleteData:function(d,f){this.replaceData(d,f,"")},replaceData:function(d,f,k){var n=this.data.substring(0,d);d=this.data.substring(d+
f);this.nodeValue=this.data=k=n+k+d;this.length=k.length}};Ta(Xc,ia);cf.prototype={nodeName:"#text",nodeType:Id,splitText:function(d){var f=this.data,k=f.substring(d);this.data=this.nodeValue=f=f.substring(0,d);this.length=f.length;d=this.ownerDocument.createTextNode(k);this.parentNode&&this.parentNode.insertBefore(d,this.nextSibling);return d}};Ta(cf,Xc);df.prototype={nodeName:"#comment",nodeType:Bh};Ta(df,Xc);ef.prototype={nodeName:"#cdata-section",nodeType:Ah};Ta(ef,Xc);ff.prototype.nodeType=Ch;
Ta(ff,ia);wh.prototype.nodeType=Xm;Ta(wh,ia);xh.prototype.nodeType=Wm;Ta(xh,ia);gf.prototype.nodeType=Eh;Ta(gf,ia);Hd.prototype.nodeName="#document-fragment";Hd.prototype.nodeType=Eb;Ta(Hd,ia);hf.prototype.nodeType=Dh;Ta(hf,ia);ia.prototype.toString=function(d,f){var k=[],n=9==this.nodeType&&this.documentElement||this,u=n.prefix,a=n.namespaceURI;if(a&&null==u&&(u=n.lookupPrefix(a),null==u))var b=[{namespace:a,prefix:null}];oc(this,k,d,f,b);return k.join("")};try{if(Object.defineProperty){Object.defineProperty(lc.prototype,
"length",{get:function(){$e(this);return this.$$length}});Object.defineProperty(ia.prototype,"textContent",{get:function(){return d(this)},set:function(f){switch(this.nodeType){case jb:case Eb:for(;this.firstChild;)this.removeChild(this.firstChild);(f||String(f))&&this.appendChild(this.ownerDocument.createTextNode(f));break;default:this.nodeValue=this.value=this.data=f}}});function d(f){switch(f.nodeType){case jb:case Eb:var k=[];for(f=f.firstChild;f;)7!==f.nodeType&&8!==f.nodeType&&k.push(d(f)),
f=f.nextSibling;return k.join("");default:return f.nodeValue}}lh=function(f,k,n){f["$$"+k]=n}}}catch(d){}var If={};(function(d){d.XML_ENTITIES=Dd({amp:"\x26",apos:"'",gt:"\x3e",lt:"\x3c",quot:'"'});d.HTML_ENTITIES=Dd({lt:"\x3c",gt:"\x3e",amp:"\x26",quot:'"',apos:"'",Agrave:"\u00c0",Aacute:"\u00c1",Acirc:"\u00c2",Atilde:"\u00c3",Auml:"\u00c4",Aring:"\u00c5",AElig:"\u00c6",Ccedil:"\u00c7",Egrave:"\u00c8",Eacute:"\u00c9",Ecirc:"\u00ca",Euml:"\u00cb",Igrave:"\u00cc",Iacute:"\u00cd",Icirc:"\u00ce",Iuml:"\u00cf",
ETH:"\u00d0",Ntilde:"\u00d1",Ograve:"\u00d2",Oacute:"\u00d3",Ocirc:"\u00d4",Otilde:"\u00d5",Ouml:"\u00d6",Oslash:"\u00d8",Ugrave:"\u00d9",Uacute:"\u00da",Ucirc:"\u00db",Uuml:"\u00dc",Yacute:"\u00dd",THORN:"\u00de",szlig:"\u00df",agrave:"\u00e0",aacute:"\u00e1",acirc:"\u00e2",atilde:"\u00e3",auml:"\u00e4",aring:"\u00e5",aelig:"\u00e6",ccedil:"\u00e7",egrave:"\u00e8",eacute:"\u00e9",ecirc:"\u00ea",euml:"\u00eb",igrave:"\u00ec",iacute:"\u00ed",icirc:"\u00ee",iuml:"\u00ef",eth:"\u00f0",ntilde:"\u00f1",
ograve:"\u00f2",oacute:"\u00f3",ocirc:"\u00f4",otilde:"\u00f5",ouml:"\u00f6",oslash:"\u00f8",ugrave:"\u00f9",uacute:"\u00fa",ucirc:"\u00fb",uuml:"\u00fc",yacute:"\u00fd",thorn:"\u00fe",yuml:"\u00ff",nbsp:"\u00a0",iexcl:"\u00a1",cent:"\u00a2",pound:"\u00a3",curren:"\u00a4",yen:"\u00a5",brvbar:"\u00a6",sect:"\u00a7",uml:"\u00a8",copy:"\u00a9",ordf:"\u00aa",laquo:"\u00ab",not:"\u00ac",shy:"\u00ad\u00ad",reg:"\u00ae",macr:"\u00af",deg:"\u00b0",plusmn:"\u00b1",sup2:"\u00b2",sup3:"\u00b3",acute:"\u00b4",
micro:"\u00b5",para:"\u00b6",middot:"\u00b7",cedil:"\u00b8",sup1:"\u00b9",ordm:"\u00ba",raquo:"\u00bb",frac14:"\u00bc",frac12:"\u00bd",frac34:"\u00be",iquest:"\u00bf",times:"\u00d7",divide:"\u00f7",forall:"\u2200",part:"\u2202",exist:"\u2203",empty:"\u2205",nabla:"\u2207",isin:"\u2208",notin:"\u2209",ni:"\u220b",prod:"\u220f",sum:"\u2211",minus:"\u2212",lowast:"\u2217",radic:"\u221a",prop:"\u221d",infin:"\u221e",ang:"\u2220",and:"\u2227",or:"\u2228",cap:"\u2229",cup:"\u222a",int:"\u222b",there4:"\u2234",
sim:"\u223c",cong:"\u2245",asymp:"\u2248",ne:"\u2260",equiv:"\u2261",le:"\u2264",ge:"\u2265",sub:"\u2282",sup:"\u2283",nsub:"\u2284",sube:"\u2286",supe:"\u2287",oplus:"\u2295",otimes:"\u2297",perp:"\u22a5",sdot:"\u22c5",Alpha:"\u0391",Beta:"\u0392",Gamma:"\u0393",Delta:"\u0394",Epsilon:"\u0395",Zeta:"\u0396",Eta:"\u0397",Theta:"\u0398",Iota:"\u0399",Kappa:"\u039a",Lambda:"\u039b",Mu:"\u039c",Nu:"\u039d",Xi:"\u039e",Omicron:"\u039f",Pi:"\u03a0",Rho:"\u03a1",Sigma:"\u03a3",Tau:"\u03a4",Upsilon:"\u03a5",
Phi:"\u03a6",Chi:"\u03a7",Psi:"\u03a8",Omega:"\u03a9",alpha:"\u03b1",beta:"\u03b2",gamma:"\u03b3",delta:"\u03b4",epsilon:"\u03b5",zeta:"\u03b6",eta:"\u03b7",theta:"\u03b8",iota:"\u03b9",kappa:"\u03ba",lambda:"\u03bb",mu:"\u03bc",nu:"\u03bd",xi:"\u03be",omicron:"\u03bf",pi:"\u03c0",rho:"\u03c1",sigmaf:"\u03c2",sigma:"\u03c3",tau:"\u03c4",upsilon:"\u03c5",phi:"\u03c6",chi:"\u03c7",psi:"\u03c8",omega:"\u03c9",thetasym:"\u03d1",upsih:"\u03d2",piv:"\u03d6",OElig:"\u0152",oelig:"\u0153",Scaron:"\u0160",
scaron:"\u0161",Yuml:"\u0178",fnof:"\u0192",circ:"\u02c6",tilde:"\u02dc",ensp:"\u2002",emsp:"\u2003",thinsp:"\u2009",zwnj:"\u200c",zwj:"\u200d",lrm:"\u200e",rlm:"\u200f",ndash:"\u2013",mdash:"\u2014",lsquo:"\u2018",rsquo:"\u2019",sbquo:"\u201a",ldquo:"\u201c",rdquo:"\u201d",bdquo:"\u201e",dagger:"\u2020",Dagger:"\u2021",bull:"\u2022",hellip:"\u2026",permil:"\u2030",prime:"\u2032",Prime:"\u2033",lsaquo:"\u2039",rsaquo:"\u203a",oline:"\u203e",euro:"\u20ac",trade:"\u2122",larr:"\u2190",uarr:"\u2191",
rarr:"\u2192",darr:"\u2193",harr:"\u2194",crarr:"\u21b5",lceil:"\u2308",rceil:"\u2309",lfloor:"\u230a",rfloor:"\u230b",loz:"\u25ca",spades:"\u2660",clubs:"\u2663",hearts:"\u2665",diams:"\u2666"});d.entityMap=d.HTML_ENTITIES})(If);var Yc=Yd,Jf=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,wi=new RegExp("[\\-\\.0-9"+Jf.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),xi=new RegExp("^"+Jf.source+
wi.source+"*(?::"+Jf.source+wi.source+"*)?$");qc.prototype=Error();qc.prototype.name=qc.name;Gh.prototype={parse:function(d,f,k){var n=this.domBuilder;n.startDocument();Kh(f,f={});$l(d,f,k,n,this.errorHandler);n.endDocument()}};Hh.prototype={setTagName:function(d){if(!xi.test(d))throw Error("invalid tagName:"+d);this.tagName=d},addValue:function(d,f,k){if(!xi.test(d))throw Error("invalid attribute:"+d);this.attributeNames[d]=this.length;this[this.length++]={qName:d,value:f,offset:k}},length:0,getLocalName:function(d){return this[d].localName},
getLocator:function(d){return this[d].locator},getQName:function(d){return this[d].qName},getURI:function(d){return this[d].uri},getValue:function(d){return this[d].value}};Lh.prototype.parseFromString=function(d,f){var k=this.options,n=new Gh,u=k.domBuilder||new Jd,a=k.errorHandler,b=k.locator,c=k.xmlns||{},e=/\/x?html?$/.test(f);f=e?If.HTML_ENTITIES:If.XML_ENTITIES;b&&u.setDocumentLocator(b);n.errorHandler=gm(a,u,b);n.domBuilder=k.domBuilder||u;e&&(c[""]=Yd.HTML);c.xml=c.xml||Yd.XML;k=k.normalizeLineEndings||
fm;d&&"string"===typeof d?n.parse(k(d),c,f):n.errorHandler.error("invalid doc source");return u.doc};Jd.prototype={startDocument:function(){this.doc=(new qh).createDocument(null,null,null);this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(d,f,k,n){var u=this.doc;f=u.createElementNS(d,k||f);var a=n.length;Kd(this,f);this.currentElement=f;this.locator&&rc(this.locator,f);for(var b=0;b<a;b++){d=n.getURI(b);var c=n.getValue(b);k=n.getQName(b);d=u.createAttributeNS(d,k);
this.locator&&rc(n.getLocator(b),d);d.value=d.nodeValue=c;f.setAttributeNode(d)}},endElement:function(d,f,k){d=this.currentElement;d.tagName;this.currentElement=d.parentNode},startPrefixMapping:function(d,f){},endPrefixMapping:function(d){},processingInstruction:function(d,f){d=this.doc.createProcessingInstruction(d,f);this.locator&&rc(this.locator,d);Kd(this,d)},ignorableWhitespace:function(d,f,k){},characters:function(d,f,k){if(d=Mh.apply(this,arguments)){var n=this.cdata?this.doc.createCDATASection(d):
this.doc.createTextNode(d);this.currentElement?this.currentElement.appendChild(n):/^\s*$/.test(d)&&this.doc.appendChild(n);this.locator&&rc(this.locator,n)}},skippedEntity:function(d){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(d){if(this.locator=d)d.lineNumber=0},comment:function(d,f,k){d=Mh.apply(this,arguments);var n=this.doc.createComment(d);this.locator&&rc(this.locator,n);Kd(this,n)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(d,
f,k){var n=this.doc.implementation;n&&n.createDocumentType&&(d=n.createDocumentType(d,f,k),this.locator&&rc(this.locator,d),Kd(this,d),this.doc.doctype=d)},warning:function(d){console.warn("[xmldom warning]\t"+d,lf(this.locator))},error:function(d){console.error("[xmldom error]\t"+d,lf(this.locator))},fatalError:function(d){throw new qc(d,this.locator);}};"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,
function(d){Jd.prototype[d]=function(){return null}});const yi=d=>!!d&&"object"===typeof d,Ka=(...d)=>d.reduce((f,k)=>{if("object"!==typeof k)return f;Object.keys(k).forEach(n=>{Array.isArray(f[n])&&Array.isArray(k[n])?f[n]=f[n].concat(k[n]):yi(f[n])&&yi(k[n])?f[n]=Ka(f[n],k[n]):f[n]=k[n]});return f},{}),zi=d=>Object.keys(d).map(f=>d[f]),zc=d=>d.reduce((f,k)=>f.concat(k),[]),Ai=d=>{if(!d.length)return[];const f=[];for(let k=0;k<d.length;k++)f.push(d[k]);return f},Ym=(d,f)=>d.reduce((k,n,u)=>{n[f]&&
k.push(u);return k},[]),Zm=(d,f)=>zi(d.reduce((k,n)=>{n.forEach(u=>{k[f(u)]=u});return k},{})),dd=({baseUrl:d="",source:f="",range:k="",indexRange:n=""})=>{d={uri:f,resolvedUri:Hf(d||"",f)};if(k||n)n=(k?k:n).split("-"),k=D.BigInt?D.BigInt(n[0]):parseInt(n[0],10),n=D.BigInt?D.BigInt(n[1]):parseInt(n[1],10),k<Number.MAX_SAFE_INTEGER&&"bigint"===typeof k&&(k=Number(k)),n<Number.MAX_SAFE_INTEGER&&"bigint"===typeof n&&(n=Number(n)),n="bigint"===typeof n||"bigint"===typeof k?D.BigInt(n)-D.BigInt(k)+D.BigInt(1):
n-k+1,"bigint"===typeof n&&n<Number.MAX_SAFE_INTEGER&&(n=Number(n)),d.byterange={length:n,offset:k};return d},Bi=d=>{d&&"number"!==typeof d&&(d=parseInt(d,10));return isNaN(d)?null:d},$m={static(d){const {duration:f,timescale:k=1,sourceDuration:n,periodDuration:u}=d;d=Bi(d.endNumber);const a=f/k;return"number"===typeof d?{start:0,end:d}:"number"===typeof u?{start:0,end:u/a}:{start:0,end:n/a}},dynamic(d){const {NOW:f,clientOffset:k,availabilityStartTime:n,timescale:u=1,duration:a,periodStart:b=0,minimumUpdatePeriod:c=
0,timeShiftBufferDepth:e=Infinity}=d;d=Bi(d.endNumber);const h=(f+k)/1E3,m=n+b,p=Math.ceil((h+c-m)*u/a),t=Math.floor((h-m)*u/a);return{start:Math.max(0,Math.floor((h-m-e)*u/a)),end:"number"===typeof d?d:Math.min(p,t)}}},an=d=>f=>{const {duration:k,timescale:n=1,periodStart:u,startNumber:a=1}=d;return{number:a+f,duration:k/n,timeline:u,time:f*k}},Kf=d=>{const {type:f,duration:k,timescale:n=1,periodDuration:u,sourceDuration:a}=d,{start:b,end:c}=$m[f](d);var e=[];for(let h=b;h<c;h++)e.push(h);d=e.map(an(d));
"static"===f&&(e=d.length-1,d[e].duration=("number"===typeof u?u:a)-k/n*e);return d},Ci=d=>{const {baseUrl:f,initialization:k={},sourceDuration:n,indexRange:u="",periodStart:a,presentationTime:b,number:c=0,duration:e}=d;if(!f)throw Error("NO_BASE_URL");const h=dd({baseUrl:f,source:k.sourceURL,range:k.range}),m=dd({baseUrl:f,source:f,indexRange:u});m.map=h;e?(d=Kf(d),d.length&&(m.duration=d[0].duration,m.timeline=d[0].timeline)):n&&(m.duration=n,m.timeline=a);m.presentationTime=b||a;m.number=c;return[m]},
Lf=(d,f,k)=>{const n=d.sidx.map?d.sidx.map:null,u=d.sidx.duration,a=d.timeline||0;var b=d.sidx.byterange,c=b.offset+b.length;b=f.timescale;const e=f.references.filter(z=>1!==z.referenceType),h=[],m=d.endList?"static":"dynamic",p=d.sidx.timeline;let t=p,x=d.mediaSequence||0;c="bigint"===typeof f.firstOffset?D.BigInt(c)+f.firstOffset:c+f.firstOffset;for(let z=0;z<e.length;z++){var y=f.references[z];const E=y.referencedSize;y=y.subsegmentDuration;var C=void 0;C="bigint"===typeof c?c+D.BigInt(E)-D.BigInt(1):
c+E-1;C=Ci({baseUrl:k,timescale:b,timeline:a,periodStart:p,presentationTime:t,number:x,duration:y,sourceDuration:u,indexRange:`${c}-${C}`,type:m})[0];n&&(C.map=n);h.push(C);c="bigint"===typeof c?c+D.BigInt(E):c+E;t+=y/b;x++}d.segments=h;return d},bn=["AUDIO","SUBTITLES"],cn=1/60,Di=d=>Zm(d,({timeline:f})=>f).sort((f,k)=>f.timeline>k.timeline?1:-1),dn=(d,f)=>{for(let k=0;k<d.length;k++)if(d[k].attributes.NAME===f)return d[k];return null},Ei=d=>{let f=[];Um(d,bn,(k,n,u,a)=>{f=f.concat(k.playlists||
[])});return f},Fi=({playlist:d,mediaSequence:f})=>{d.mediaSequence=f;d.segments.forEach((k,n)=>{k.number=d.mediaSequence+n})},en=({oldPlaylists:d,newPlaylists:f,timelineStarts:k})=>{f.forEach(n=>{n.discontinuitySequence=k.findIndex(function({timeline:c}){return c===n.timeline});const u=dn(d,n.attributes.NAME);if(u&&!n.sidx){var a=n.segments[0],b=u.segments.findIndex(function(c){return Math.abs(c.presentationTime-a.presentationTime)<cn});-1===b?(Fi({playlist:n,mediaSequence:u.mediaSequence+u.segments.length}),
n.segments[0].discontinuity=!0,n.discontinuityStarts.unshift(0),(!u.segments.length&&n.timeline>u.timeline||u.segments.length&&n.timeline>u.segments[u.segments.length-1].timeline)&&n.discontinuitySequence--):(u.segments[b].discontinuity&&!a.discontinuity&&(a.discontinuity=!0,n.discontinuityStarts.unshift(0),n.discontinuitySequence--),Fi({playlist:n,mediaSequence:u.segments[b].number}))}})},fn=({oldManifest:d,newManifest:f})=>{const k=d.playlists.concat(Ei(d)),n=f.playlists.concat(Ei(f));f.timelineStarts=
Di([d.timelineStarts,f.timelineStarts]);en({oldPlaylists:k,newPlaylists:n,timelineStarts:f.timelineStarts});return f},Zd=d=>{var f;if(f=d){f=d.uri+"-";d=d.byterange;let k;k="bigint"===typeof d.offset||"bigint"===typeof d.length?D.BigInt(d.offset)+D.BigInt(d.length)-D.BigInt(1):d.offset+d.length-1;f+=`${d.offset}-${k}`}return f},Mf=d=>zi(d.reduce((f,k)=>{const n=k.attributes.id+(k.attributes.lang||"");f[n]?(k.segments&&(k.segments[0]&&(k.segments[0].discontinuity=!0),f[n].segments.push(...k.segments)),
k.attributes.contentProtection&&(f[n].attributes.contentProtection=k.attributes.contentProtection)):(f[n]=k,f[n].attributes.timelineStarts=[]);f[n].attributes.timelineStarts.push({start:k.attributes.periodStart,timeline:k.attributes.periodStart});return f},{})).map(f=>{f.discontinuityStarts=Ym(f.segments||[],"discontinuity");return f}),Nf=(d,f)=>{const k=Zd(d.sidx);(f=k&&f[k]&&f[k].sidx)&&Lf(d,f,d.sidx.resolvedUri);return d},gn=(d,f={})=>{if(!Object.keys(f).length)return d;for(const k in d)d[k]=Nf(d[k],
f);return d},hn=({attributes:d,segments:f,sidx:k,mediaSequence:n,discontinuitySequence:u,discontinuityStarts:a},b)=>{f={attributes:{NAME:d.id,BANDWIDTH:d.bandwidth,CODECS:d.codecs,["PROGRAM-ID"]:1},uri:"",endList:"static"===d.type,timeline:d.periodStart,resolvedUri:"",targetDuration:d.duration,discontinuitySequence:u,discontinuityStarts:a,timelineStarts:d.timelineStarts,mediaSequence:n,segments:f};d.contentProtection&&(f.contentProtection=d.contentProtection);k&&(f.sidx=k);b&&(f.attributes.AUDIO=
"audio",f.attributes.SUBTITLES="subs");return f},jn=({attributes:d,segments:f,mediaSequence:k,discontinuityStarts:n,discontinuitySequence:u})=>{"undefined"===typeof f&&(f=[{uri:d.baseUrl,timeline:d.periodStart,resolvedUri:d.baseUrl||"",duration:d.sourceDuration,number:0}],d.duration=d.sourceDuration);const a={NAME:d.id,BANDWIDTH:d.bandwidth,["PROGRAM-ID"]:1};d.codecs&&(a.CODECS=d.codecs);return{attributes:a,uri:"",endList:"static"===d.type,timeline:d.periodStart,resolvedUri:d.baseUrl||"",targetDuration:d.duration,
timelineStarts:d.timelineStarts,discontinuityStarts:n,discontinuitySequence:u,mediaSequence:k,segments:f}},kn=(d,f={},k=!1)=>{let n;d=d.reduce((u,a)=>{const b=a.attributes.role&&a.attributes.role.value||"";var c=a.attributes.lang||"";let e=a.attributes.label||"main";c&&!a.attributes.label&&(e=`${a.attributes.lang}${b?` (${b})`:""}`);u[e]||(u[e]={language:c,autoselect:!0,default:"main"===b,playlists:[],uri:""});c=Nf(hn(a,k),f);u[e].playlists.push(c);"undefined"===typeof n&&"main"===b&&(n=a,n.default=
!0);return u},{});if(!n){const u=Object.keys(d)[0];d[u].default=!0}return d},ln=(d,f={})=>d.reduce((k,n)=>{const u=n.attributes.label||n.attributes.lang||"text";k[u]||(k[u]={language:u,default:!1,autoselect:!1,playlists:[],uri:""});k[u].playlists.push(Nf(jn(n),f));return k},{}),mn=d=>d.reduce((f,k)=>{if(!k)return f;k.forEach(n=>{const {channel:u,language:a}=n;f[a]={autoselect:!1,default:!1,instreamId:u,language:a};n.hasOwnProperty("aspectRatio")&&(f[a].aspectRatio=n.aspectRatio);n.hasOwnProperty("easyReader")&&
(f[a].easyReader=n.easyReader);n.hasOwnProperty("3D")&&(f[a]["3D"]=n["3D"])});return f},{}),nn=({attributes:d,segments:f,sidx:k,discontinuityStarts:n})=>{f={attributes:{NAME:d.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:d.width,height:d.height},CODECS:d.codecs,BANDWIDTH:d.bandwidth,["PROGRAM-ID"]:1},uri:"",endList:"static"===d.type,timeline:d.periodStart,resolvedUri:"",targetDuration:d.duration,discontinuityStarts:n,timelineStarts:d.timelineStarts,segments:f};d.frameRate&&(f.attributes["FRAME-RATE"]=
d.frameRate);d.contentProtection&&(f.contentProtection=d.contentProtection);k&&(f.sidx=k);return f},on=({attributes:d})=>"video/mp4"===d.mimeType||"video/webm"===d.mimeType||"video"===d.contentType,pn=({attributes:d})=>"audio/mp4"===d.mimeType||"audio/webm"===d.mimeType||"audio"===d.contentType,qn=({attributes:d})=>"text/vtt"===d.mimeType||"text"===d.contentType,rn=(d,f)=>{d.forEach(k=>{k.mediaSequence=0;k.discontinuitySequence=f.findIndex(function({timeline:n}){return n===k.timeline});k.segments&&
k.segments.forEach((n,u)=>{n.number=u})})},Gi=d=>d?Object.keys(d).reduce((f,k)=>f.concat(d[k].playlists),[]):[],sn=({dashPlaylists:d,locations:f,sidxMapping:k={},previousManifest:n,eventStream:u})=>{if(!d.length)return{};const {sourceDuration:a,type:b,suggestedPresentationDelay:c,minimumUpdatePeriod:e}=d[0].attributes;var h=Mf(d.filter(on)).map(nn),m=Mf(d.filter(pn)),p=Mf(d.filter(qn));d=d.map(x=>x.attributes.captionServices).filter(Boolean);const t={allowCache:!0,discontinuityStarts:[],segments:[],
endList:!0,mediaGroups:{AUDIO:{},VIDEO:{},["CLOSED-CAPTIONS"]:{},SUBTITLES:{}},uri:"",duration:a,playlists:gn(h,k)};0<=e&&(t.minimumUpdatePeriod=1E3*e);f&&(t.locations=f);"dynamic"===b&&(t.suggestedPresentationDelay=c);u&&0<u.length&&(t.eventStream=u);f=0===t.playlists.length;m=m.length?kn(m,k,f):null;k=p.length?ln(p,k):null;h=h.concat(Gi(m),Gi(k));p=h.map(({timelineStarts:x})=>x);t.timelineStarts=Di(p);rn(h,t.timelineStarts);m&&(t.mediaGroups.AUDIO.audio=m);k&&(t.mediaGroups.SUBTITLES.subs=k);d.length&&
(t.mediaGroups["CLOSED-CAPTIONS"].cc=mn(d));return n?fn({oldManifest:n,newManifest:t}):t},Hi=(d,f)=>{const {type:k,minimumUpdatePeriod:n=0,media:u="",sourceDuration:a,timescale:b=1,startNumber:c=1,periodStart:e}=d,h=[];let m=-1;for(let x=0;x<f.length;x++){var p=f[x];const y=p.d;var t=p.r||0;p=p.t||0;0>m&&(m=p);p&&p>m&&(m=p);if(0>t)if(t=x+1,t===f.length)if("dynamic"===k&&0<n&&0<u.indexOf("$Number$")){const {NOW:C,clientOffset:z,availabilityStartTime:E,timescale:K=1,periodStart:G=0,minimumUpdatePeriod:O=
0}=d;t=Math.ceil((((C+z)/1E3+O-(E+G))*K-m)/y)}else t=(a*b-m)/y;else t=(f[t].t-m)/y;else t+=1;t=c+h.length+t;for(p=c+h.length;p<t;)h.push({number:p,duration:y/b,time:m,timeline:e}),m+=y,p++}return h},Ii=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,Ji=d=>(f,k,n,u)=>{if("$$"===f)return"$";if("undefined"===typeof d[k])return f;f=""+d[k];if("RepresentationID"===k)return f;u=n?parseInt(u,10):1;return f.length>=u?f:`${Array(u-f.length+1).join("0")}${f}`},tn=(d,f)=>d.duration||f?d.duration?Kf(d):Hi(d,f):[{number:d.startNumber||
1,duration:d.sourceDuration,time:0,timeline:d.periodStart}],un=(d,f)=>{const k={RepresentationID:d.id,Bandwidth:d.bandwidth||0},{initialization:n={sourceURL:"",range:""}}=d,u=dd({baseUrl:d.baseUrl,source:n.sourceURL.replace(Ii,Ji(k)),range:n.range});return tn(d,f).map(a=>{k.Number=a.number;k.Time=a.time;const b=(d.media||"").replace(Ii,Ji(k)),c=d.periodStart+(a.time-(d.presentationTimeOffset||0))/(d.timescale||1);return{uri:b,timeline:a.timeline,duration:a.duration,resolvedUri:Hf(d.baseUrl||"",b),
map:u,number:a.number,presentationTime:c}})},vn=(d,f)=>{const {duration:k,segmentUrls:n=[],periodStart:u}=d;if(!k&&!f||k&&f)throw Error("SEGMENT_TIME_UNSPECIFIED");const a=n.map(c=>{const {baseUrl:e,initialization:h={}}=d,m=dd({baseUrl:e,source:h.sourceURL,range:h.range});c=dd({baseUrl:e,source:c.media,range:c.mediaRange});c.map=m;return c});let b;k&&(b=Kf(d));f&&(b=Hi(d,f));return b.map((c,e)=>{if(a[e]){e=a[e];const h=d.timescale||1,m=d.presentationTimeOffset||0;e.timeline=c.timeline;e.duration=
c.duration;e.number=c.number;e.presentationTime=u+(c.time-m)/h;return e}}).filter(c=>c)},wn=({attributes:d,segmentInfo:f})=>{let k;if(f.template){var n=un;k=Ka(d,f.template)}else f.base?(n=Ci,k=Ka(d,f.base)):f.list&&(n=vn,k=Ka(d,f.list));d={attributes:d};if(!n)return d;n=n(k,f.segmentTimeline);if(k.duration){const {duration:u,timescale:a=1}=k;k.duration=u/a}else k.duration=n.length?n.reduce((u,a)=>Math.max(u,Math.ceil(a.duration)),0):0;d.attributes=k;d.segments=n;f.base&&k.indexRange&&(d.sidx=n[0],
d.segments=[]);return d},ra=(d,f)=>Ai(d.childNodes).filter(({tagName:k})=>k===f),xn=d=>d.textContent.trim(),yn=d=>parseFloat(d.split("/").reduce((f,k)=>f/k)),Ac=d=>{d=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/.exec(d);if(!d)return 0;const [f,k,n,u,a,b]=d.slice(1);return 31536E3*parseFloat(f||0)+2592E3*parseFloat(k||0)+86400*parseFloat(n||0)+3600*parseFloat(u||0)+60*parseFloat(a||0)+parseFloat(b||0)},Ki={mediaPresentationDuration(d){return Ac(d)},availabilityStartTime(d){/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(d)&&
(d+="Z");return Date.parse(d)/1E3},minimumUpdatePeriod(d){return Ac(d)},suggestedPresentationDelay(d){return Ac(d)},type(d){return d},timeShiftBufferDepth(d){return Ac(d)},start(d){return Ac(d)},width(d){return parseInt(d,10)},height(d){return parseInt(d,10)},bandwidth(d){return parseInt(d,10)},frameRate(d){return yn(d)},startNumber(d){return parseInt(d,10)},timescale(d){return parseInt(d,10)},presentationTimeOffset(d){return parseInt(d,10)},duration(d){const f=parseInt(d,10);return isNaN(f)?Ac(d):
f},d(d){return parseInt(d,10)},t(d){return parseInt(d,10)},r(d){return parseInt(d,10)},presentationTime(d){return parseInt(d,10)},DEFAULT(d){return d}},Ba=d=>d&&d.attributes?Ai(d.attributes).reduce((f,k)=>{f[k.name]=(Ki[k.name]||Ki.DEFAULT)(k.value);return f},{}):{},zn={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"},
$d=(d,f)=>f.length?zc(d.map(function(k){return f.map(function(n){return Hf(k,n.textContent.trim())})})):d,Of=d=>{var f=ra(d,"SegmentTemplate")[0];const k=ra(d,"SegmentList")[0],n=k&&ra(k,"SegmentURL").map(c=>Ka({tag:"SegmentURL"},Ba(c)));d=ra(d,"SegmentBase")[0];var u=k||f;u=u&&ra(u,"SegmentTimeline")[0];var a=k||d||f;a=a&&ra(a,"Initialization")[0];(f=f&&Ba(f))&&a?f.initialization=a&&Ba(a):f&&f.initialization&&(f.initialization={sourceURL:f.initialization});const b={template:f,segmentTimeline:u&&
ra(u,"S").map(c=>Ba(c)),list:k&&Ka(Ba(k),{segmentUrls:n,initialization:Ba(a)}),base:d&&Ka(Ba(d),{initialization:Ba(a)})};Object.keys(b).forEach(c=>{b[c]||delete b[c]});return b},An=(d,f,k)=>n=>{var u=ra(n,"BaseURL");u=$d(f,u);const a=Ka(d,Ba(n)),b=Of(n);return u.map(c=>({segmentInfo:Ka(k,b),attributes:Ka(a,{baseUrl:c})}))},Bn=d=>d.reduce((f,k)=>{var n=Ba(k);n.schemeIdUri&&(n.schemeIdUri=n.schemeIdUri.toLowerCase());var u=zn[n.schemeIdUri];if(u&&(f[u]={attributes:n},k=ra(k,"cenc:pssh")[0])){k=k.textContent.trim();
u=f[u];if(n=k){k=D.atob?D.atob(k):Buffer.from(k,"base64").toString("binary");n=new Uint8Array(k.length);for(var a=0;a<k.length;a++)n[a]=k.charCodeAt(a)}u.pssh=n}return f},{}),Cn=d=>{if("urn:scte:dash:cc:cea-608:2015"===d.schemeIdUri)return("string"!==typeof d.value?[]:d.value.split(";")).map(f=>{let k,n;n=f;/^CC\d=/.test(f)?[k,n]=f.split("\x3d"):/^CC\d$/.test(f)&&(k=f);return{channel:k,language:n}});if("urn:scte:dash:cc:cea-708:2015"===d.schemeIdUri)return("string"!==typeof d.value?[]:d.value.split(";")).map(f=>
{const k={channel:void 0,language:void 0,aspectRatio:1,easyReader:0,"3D":0};if(/=/.test(f)){const [n,u=""]=f.split("\x3d");k.channel=n;k.language=f;u.split(",").forEach(a=>{const [b,c]=a.split(":");"lang"===b?k.language=c:"er"===b?k.easyReader=Number(c):"war"===b?k.aspectRatio=Number(c):"3D"===b&&(k["3D"]=Number(c))})}else k.language=f;k.channel&&(k.channel="SERVICE"+k.channel);return k})},Dn=d=>zc(ra(d.node,"EventStream").map(f=>{const k=Ba(f),n=k.schemeIdUri;return ra(f,"Event").map(u=>{const a=
Ba(u),b=k.timescale||1,c=(a.presentationTime||0)/b+d.attributes.start;return{schemeIdUri:n,value:k.value,id:a.id,start:c,end:c+(a.duration||0)/b,messageData:u.textContent.trim()||a.messageData,contentEncoding:k.contentEncoding,presentationTimeOffset:k.presentationTimeOffset||0}})})),En=(d,f,k)=>n=>{var u=Ba(n);const a=$d(f,ra(n,"BaseURL"));var b=ra(n,"Role")[0];b={role:Ba(b)};u=Ka(d,u,b);b=ra(n,"Accessibility")[0];(b=Cn(Ba(b)))&&(u=Ka(u,{captionServices:b}));(b=ra(n,"Label")[0])&&b.childNodes.length&&
(b=b.childNodes[0].nodeValue.trim(),u=Ka(u,{label:b}));b=Bn(ra(n,"ContentProtection"));Object.keys(b).length&&(u=Ka(u,{contentProtection:b}));b=Of(n);n=ra(n,"Representation");b=Ka(k,b);return zc(n.map(An(u,a,b)))},Fn=(d,f)=>(k,n)=>{n=$d(f,ra(k.node,"BaseURL"));const u=Ka(d,{periodStart:k.attributes.start});"number"===typeof k.attributes.duration&&(u.periodDuration=k.attributes.duration);const a=ra(k.node,"AdaptationSet");k=Of(k.node);return zc(a.map(En(u,n,k)))},Gn=({attributes:d,priorPeriodAttributes:f,
mpdType:k})=>"number"===typeof d.start?d.start:f&&"number"===typeof f.start&&"number"===typeof f.duration?f.start+f.duration:f||"static"!==k?null:0,Hn=(d,f={})=>{const {manifestUri:k="",NOW:n=Date.now(),clientOffset:u=0}=f;f=ra(d,"Period");if(!f.length)throw Error("INVALID_NUMBER_OF_PERIOD");const a=ra(d,"Location"),b=Ba(d);d=$d([k],ra(d,"BaseURL"));b.type=b.type||"static";b.sourceDuration=b.mediaPresentationDuration||0;b.NOW=n;b.clientOffset=u;a.length&&(b.locations=a.map(xn));const c=[];f.forEach((e,
h)=>{const m=Ba(e);h=c[h-1];m.start=Gn({attributes:m,priorPeriodAttributes:h?h.attributes:null,mpdType:b.type});c.push({node:e,attributes:m})});return{locations:b.locations,representationInfo:zc(c.map(Fn(b,d))),eventStream:zc(c.map(Dn))}},Li=d=>{if(""===d)throw Error("DASH_EMPTY_MANIFEST");const f=new Lh;let k,n;try{n=(k=f.parseFromString(d,"application/xml"))&&"MPD"===k.documentElement.tagName?k.documentElement:null}catch(u){}if(!n||n&&0<n.getElementsByTagName("parsererror").length)throw Error("DASH_INVALID_XML");
return n},In=d=>{d=ra(d,"UTCTiming")[0];if(!d)return null;d=Ba(d);switch(d.schemeIdUri){case "urn:mpeg:dash:utc:http-head:2014":case "urn:mpeg:dash:utc:http-head:2012":d.method="HEAD";break;case "urn:mpeg:dash:utc:http-xsdate:2014":case "urn:mpeg:dash:utc:http-iso:2014":case "urn:mpeg:dash:utc:http-xsdate:2012":case "urn:mpeg:dash:utc:http-iso:2012":d.method="GET";break;case "urn:mpeg:dash:utc:direct:2014":case "urn:mpeg:dash:utc:direct:2012":d.method="DIRECT";d.value=Date.parse(d.value);break;default:throw Error("UNSUPPORTED_UTC_TIMING_SCHEME");
}return d},Jn=(d,f={})=>{d=Hn(Li(d),f);const k=d.representationInfo.map(wn);return sn({dashPlaylists:k,locations:d.locations,sidxMapping:f.sidxMapping,previousManifest:f.previousManifest,eventStream:d.eventStream})};var Kn=Math.pow(2,32),Mi=function(d){d=new DataView(d.buffer,d.byteOffset,d.byteLength);return d.getBigUint64?(d=d.getBigUint64(0),d<Number.MAX_SAFE_INTEGER?Number(d):d):d.getUint32(0)*Kn+d.getUint32(4)};const Ln=La.getDefaultExportFromCjs(function(d){var f=new DataView(d.buffer,d.byteOffset,
d.byteLength),k={version:d[0],flags:new Uint8Array(d.subarray(1,4)),references:[],referenceId:f.getUint32(4),timescale:f.getUint32(8)},n=12;0===k.version?(k.earliestPresentationTime=f.getUint32(n),k.firstOffset=f.getUint32(n+4),n+=8):(k.earliestPresentationTime=Mi(d.subarray(n)),k.firstOffset=Mi(d.subarray(n+8)),n+=16);n+=2;var u=f.getUint16(n);for(n+=2;0<u;n+=12,u--)k.references.push({referenceType:(d[n]&128)>>>7,referencedSize:f.getUint32(n)&2147483647,subsegmentDuration:f.getUint32(n+4),startsWithSap:!!(d[n+
8]&128),sapType:(d[n+8]&112)>>>4,sapDeltaTime:f.getUint32(n+8)&268435455});return k});var Mn=T([73,68,51]),ed=function n(f,k){void 0===k&&(k=0);f=T(f);if(10>f.length-k||!pa(f,Mn,{offset:k}))return k;var u=k;var a=k;void 0===a&&(a=0);k=T(f);var b=k[a+6]<<21|k[a+7]<<14|k[a+8]<<7|k[a+9];k=(k[a+5]&16)>>4?b+20:b+10;k=u+k;return n(f,k)},Ni=function(f){return"string"===typeof f?ti(f):f},Nn=function(f){return Array.isArray(f)?f.map(function(k){return Ni(k)}):[Ni(f)]},On=function a(k,n,u){void 0===u&&(u=!1);
n=Nn(n);k=T(k);var b=[];if(!n.length)return b;for(var c=0;c<k.length;){var e=(k[c]<<24|k[c+1]<<16|k[c+2]<<8|k[c+3])>>>0,h=k.subarray(c+4,c+8);if(0===e)break;e=c+e;if(e>k.length){if(u)break;e=k.length}c=k.subarray(c+8,e);pa(h,n[0])&&(1===n.length?b.push(c):b.push.apply(b,a(c,n.slice(1),u)));c=e}return b},Oi=T([26,69,223,163]),Pi=T([66,130]);T([24,83,128,103]);T([21,73,169,102]);T([22,84,174,107]);T([174]);T([215]);T([35,227,131]);T([174]);T([131]);T([136]);T([134]);T([99,162]);T([224]);T([225]);T([31,
67,182,117]);T([231]);T([42,215,177]);T([160]);T([155]);T([161]);T([163]);var Pf=[128,64,32,16,8,4,2,1],ae=function(k,n,u,a){void 0===u&&(u=!0);void 0===a&&(a=!1);var b=1;for(var c=0;c<Pf.length&&!(k[n]&Pf[c]);c++)b++;c=k.subarray(n,n+b);u&&(c=Array.prototype.slice.call(k,n,n+b),c[0]^=Pf[b-1]);return{length:b,value:Rm(c,{signed:a}),bytes:c}},Qi=function u(n){return"string"===typeof n?n.match(/.{1,2}/g).map(function(a){return u(a)}):"number"===typeof n?Sm(n):n},Pn=function(n){return Array.isArray(n)?
n.map(function(u){return Qi(u)}):[Qi(n)]},Qn=function c(u,a,b){if(b>=a.length)return a.length;var e=ae(a,b,!1);if(pa(u.bytes,e.bytes))return b;var h=ae(a,b+e.length);return c(u,a,b+h.length+h.value+e.length)},Ri=function c(a,b){b=Pn(b);a=T(a);var e=[];if(!b.length)return e;for(var h=0;h<a.length;){var m=ae(a,h,!1),p=ae(a,h+m.length),t=h+m.length+p.length;127===p.value&&(p.value=Qn(m,a,t),p.value!==a.length&&(p.value-=t));t=a.subarray(t,t+p.value>a.length?a.length:t+p.value);pa(b[0],m.bytes)&&(1===
b.length?e.push(t):e=e.concat(c(t,b.slice(1))));h+=m.length+p.length+t.length}return e},Rn=T([0,0,0,1]),Sn=T([0,0,1]),Tn=T([0,0,3]),Si=function(a,b,c,e){void 0===e&&(e=Infinity);a=T(a);c=[].concat(c);for(var h=0,m,p=0;h<a.length&&(p<e||m);){var t=void 0;pa(a.subarray(h),Rn)?t=4:pa(a.subarray(h),Sn)&&(t=3);if(t){p++;if(m){a=a.subarray(m,h);b=[];for(c=1;c<a.length-2;)pa(a.subarray(c,c+3),Tn)&&(b.push(c+2),c++),c++;if(0!==b.length){e=a.length-b.length;h=new Uint8Array(e);for(c=m=0;c<e;m++,c++)m===b[0]&&
(m++,b.shift()),h[c]=a[m];a=h}return a}var x=void 0;"h264"===b?x=a[h+t]&31:"h265"===b&&(x=a[h+t]>>1&63);-1!==c.indexOf(x)&&(m=h+t);h+=t+("h264"===b?1:2)}else h++}return a.subarray(0,0)},Ra={webm:T([119,101,98,109]),matroska:T([109,97,116,114,111,115,107,97]),flac:T([102,76,97,67]),ogg:T([79,103,103,83]),ac3:T([11,119]),riff:T([82,73,70,70]),avi:T([65,86,73]),wav:T([87,65,86,69]),"3gp":T([102,116,121,112,51,103]),mp4:T([102,116,121,112]),fmp4:T([115,116,121,112]),mov:T([102,116,121,112,113,116]),moov:T([109,
111,111,118]),moof:T([109,111,111,102])},Bc={aac:function(a){var b=ed(a);return pa(a,[255,16],{offset:b,mask:[255,22]})},mp3:function(a){var b=ed(a);return pa(a,[255,2],{offset:b,mask:[255,6]})},webm:function(a){a=Ri(a,[Oi,Pi])[0];return pa(a,Ra.webm)},mkv:function(a){a=Ri(a,[Oi,Pi])[0];return pa(a,Ra.matroska)},mp4:function(a){if(Bc["3gp"](a)||Bc.mov(a))return!1;if(pa(a,Ra.mp4,{offset:4})||pa(a,Ra.fmp4,{offset:4})||pa(a,Ra.moof,{offset:4})||pa(a,Ra.moov,{offset:4}))return!0},mov:function(a){return pa(a,
Ra.mov,{offset:4})},"3gp":function(a){return pa(a,Ra["3gp"],{offset:4})},ac3:function(a){var b=ed(a);return pa(a,Ra.ac3,{offset:b})},ts:function(a){if(189>a.length&&1<=a.length)return 71===a[0];for(var b=0;b+188<a.length&&188>b;){if(71===a[b]&&71===a[b+188])return!0;b+=1}return!1},flac:function(a){var b=ed(a);return pa(a,Ra.flac,{offset:b})},ogg:function(a){return pa(a,Ra.ogg)},avi:function(a){return pa(a,Ra.riff)&&pa(a,Ra.avi,{offset:8})},wav:function(a){return pa(a,Ra.riff)&&pa(a,Ra.wav,{offset:8})},
h264:function(a){return Si(a,"h264",7,3).length},h265:function(a){return Si(a,"h265",[32,33],3).length}},Qf=Object.keys(Bc).filter(function(a){return"ts"!==a&&"h264"!==a&&"h265"!==a}).concat(["ts","h264","h265"]);Qf.forEach(function(a){var b=Bc[a];Bc[a]=function(c){return b(T(c))}});var Un=Bc,Rf=function(a){a=T(a);for(var b=0;b<Qf.length;b++){var c=Qf[b];if(Un[c](a))return c}return""};const Hb={},Sb=function(a,b){Hb[a]=Hb[a]||[];b&&(Hb[a]=Hb[a].concat(b));return Hb[a]},Ti=function(a,b){b=Sb(a).indexOf(b);
if(-1>=b)return!1;Hb[a]=Hb[a].slice();Hb[a].splice(b,1);return!0},Nd={prefixed:!0},be=["requestFullscreen exitFullscreen fullscreenElement fullscreenEnabled fullscreenchange fullscreenerror fullscreen".split(" "),"webkitRequestFullscreen webkitExitFullscreen webkitFullscreenElement webkitFullscreenEnabled webkitfullscreenchange webkitfullscreenerror -webkit-full-screen".split(" "),"mozRequestFullScreen mozCancelFullScreen mozFullScreenElement mozFullScreenEnabled mozfullscreenchange mozfullscreenerror -moz-full-screen".split(" "),
"msRequestFullscreen msExitFullscreen msFullscreenElement msFullscreenEnabled MSFullscreenChange MSFullscreenError -ms-fullscreen".split(" ")],Ui=be[0];let fd;for(let a=0;a<be.length;a++)if(be[a][1]in P){fd=be[a];break}if(fd){for(let a=0;a<fd.length;a++)Nd[Ui[a]]=fd[a];Nd.prefixed=fd[0]!==Ui[0]}let Va=[];const hm=(a,b)=>(c,e,h)=>{e=b.levels[e];const m=new RegExp(`^(${e})$`);"log"!==c&&h.unshift(c.toUpperCase()+":");h.unshift(a+":");if(Va){Va.push([].concat(h));var p=Va.length-1E3;Va.splice(0,0<p?
p:0)}if(D.console&&((p=D.console[c])||"debug"!==c||(p=D.console.info||D.console.log),p&&e&&m.test(c)))p[Array.isArray(h)?"apply":"call"](D.console,h)},ca=Nh("VIDEOJS"),Vi=ca.createLogger,im=Object.prototype.toString,Oh=function(a){return rb(a)?Object.keys(a):[]};var Vn=Object.freeze({__proto__:null,each:sc,reduce:Ph,isObject:rb,isPlain:tc,merge:ka,defineLazyProperty:Ld});let Sf=!1,Wi=null,wb=!1,Xi,Yi=!1,Cc=!1,Dc=!1,xb=!1,Tf=null,ce=null,Zi=null,de=!1,ee=!1,fe=!1,ge=!1;const gd=!(!uc()||!("ontouchstart"in
D||D.navigator.maxTouchPoints||D.DocumentTouch&&D.document instanceof D.DocumentTouch)),Ec=D.navigator&&D.navigator.userAgentData;Ec&&(wb="Android"===Ec.platform,Cc=!!Ec.brands.find(a=>"Microsoft Edge"===a.brand),Dc=!!Ec.brands.find(a=>"Chromium"===a.brand),xb=!Cc&&Dc,Tf=ce=(Ec.brands.find(a=>"Chromium"===a.brand)||{}).version||null,ee="Windows"===Ec.platform);if(!Dc){const a=D.navigator&&D.navigator.userAgent||"";Sf=/iPod/i.test(a);Wi=function(){const b=a.match(/OS (\d+)_/i);return b&&b[1]?b[1]:
null}();wb=/Android/i.test(a);Xi=function(){const b=a.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!b)return null;const c=b[1]&&parseFloat(b[1]),e=b[2]&&parseFloat(b[2]);return c&&e?parseFloat(b[1]+"."+b[2]):c?c:null}();Yi=/Firefox/i.test(a);Cc=/Edg/i.test(a);Dc=/Chrome/i.test(a)||/CriOS/i.test(a);xb=!Cc&&Dc;Tf=ce=function(){const b=a.match(/(Chrome|CriOS)\/(\d+)/);return b&&b[2]?parseFloat(b[2]):null}();Zi=function(){var b=/MSIE\s(\d+)\.\d/.exec(a);b=b&&parseFloat(b[1]);!b&&/Trident\/7.0/i.test(a)&&
/rv:11.0/.test(a)&&(b=11);return b}();de=/Safari/i.test(a)&&!xb&&!wb&&!Cc;ee=/Windows/i.test(a);fe=/iPad/i.test(a)||de&&gd&&!/iPhone/i.test(a);ge=/iPhone/i.test(a)&&!fe}const Na=ge||fe||Sf,he=(de||Na)&&!xb;var Wn=Object.freeze({__proto__:null,get IS_IPOD(){return Sf},get IOS_VERSION(){return Wi},get IS_ANDROID(){return wb},get ANDROID_VERSION(){return Xi},get IS_FIREFOX(){return Yi},get IS_EDGE(){return Cc},get IS_CHROMIUM(){return Dc},get IS_CHROME(){return xb},get CHROMIUM_VERSION(){return Tf},
get CHROME_VERSION(){return ce},get IE_VERSION(){return Zi},get IS_SAFARI(){return de},get IS_WINDOWS(){return ee},get IS_IPAD(){return fe},get IS_IPHONE(){return ge},TOUCH_ENABLED:gd,IS_IOS:Na,IS_ANY_SAFARI:he});const Rb=Rh("querySelector"),$i=Rh("querySelectorAll");var aj=Object.freeze({__proto__:null,isReal:uc,isEl:vc,isInFrame:Qh,createEl:aa,textContent:Pb,prependTo:nf,hasClass:Zc,addClass:Xb,removeClass:Md,toggleClass:Sh,setAttributes:Th,getAttributes:Qb,getAttribute:function(a,b){return a.getAttribute(b)},
setAttribute:function(a,b,c){a.setAttribute(b,c)},removeAttribute:function(a,b){a.removeAttribute(b)},blockTextSelection:Uh,unblockTextSelection:Vh,getBoundingClientRect:wc,findPosition:$c,getPointerPosition:Od,isTextNode:Wh,emptyEl:Pd,normalizeContent:Xh,appendContent:mf,insertContent:Yh,isSingleLeftClick:ad,$:Rb,$$:$i,computedStyle:xc});let Zh=!1,pf;const jm=function(){if(!1!==pf.options.autoSetup){var a=Array.prototype.slice.call(P.getElementsByTagName("video")),b=Array.prototype.slice.call(P.getElementsByTagName("audio")),
c=Array.prototype.slice.call(P.getElementsByTagName("video-js"));if((a=a.concat(b,c))&&0<a.length)for(let e=0,h=a.length;e<h;e++)if((b=a[e])&&b.getAttribute)void 0===b.player&&null!==b.getAttribute("data-setup")&&pf(b);else{of(1);break}else Zh||of(1)}};uc()&&("complete"===P.readyState?qf():D.addEventListener("load",qf));const bj=function(a){const b=P.createElement("style");b.className=a;return b},cj=function(a,b){a.styleSheet?a.styleSheet.cssText=b:a.textContent=b};var Oa=new WeakMap;let sb=3,ie;
const km=function(){if("boolean"!==typeof ie){ie=!1;try{const a=Object.defineProperty({},"passive",{get(){ie=!0}});D.addEventListener("test",null,a);D.removeEventListener("test",null,a)}catch(a){}}return ie},lm=["touchstart","touchmove"];var Xn=Object.freeze({__proto__:null,fixEvent:Qd,on:$a,off:Ha,trigger:yc,one:Rd,any:sf});const ma=function(a,b,c){b.guid||(b.guid=sb++);a=b.bind(a);a.guid=c?c+"_"+b.guid:b.guid;return a},yb=function(a,b){let c=D.performance.now();return function(...e){const h=D.performance.now();
h-c>=b&&(a(...e),c=h)}},dj=function(a,b,c,e=D){let h;const m=function(){const p=this,t=arguments;let x=function(){x=h=null;c||a.apply(p,t)};!h&&c&&a.apply(p,t);e.clearTimeout(h);h=e.setTimeout(x,b)};m.cancel=()=>{e.clearTimeout(h);h=null};return m};var Yn=Object.freeze({__proto__:null,UPDATE_REFRESH_INTERVAL:30,bind_:ma,throttle:yb,debounce:dj});let hd;class hb{on(a,b){const c=this.addEventListener;this.addEventListener=()=>{};$a(this,a,b);this.addEventListener=c}off(a,b){Ha(this,a,b)}one(a,b){const c=
this.addEventListener;this.addEventListener=()=>{};Rd(this,a,b);this.addEventListener=c}any(a,b){const c=this.addEventListener;this.addEventListener=()=>{};sf(this,a,b);this.addEventListener=c}trigger(a){const b=a.type||a;"string"===typeof a&&(a={type:b});a=Qd(a);if(this.allowedEvents_[b]&&this["on"+b])this["on"+b](a);yc(this,a)}queueTrigger(a){hd||(hd=new Map);const b=a.type||a;let c=hd.get(this);c||(c=new Map,hd.set(this,c));var e=c.get(b);c.delete(b);D.clearTimeout(e);e=D.setTimeout(()=>{c.delete(b);
0===c.size&&(c=null,hd.delete(this));this.trigger(a)},0);c.set(b,e)}}hb.prototype.allowedEvents_={};hb.prototype.addEventListener=hb.prototype.on;hb.prototype.removeEventListener=hb.prototype.off;hb.prototype.dispatchEvent=hb.prototype.trigger;const je=a=>"function"===typeof a.name?a.name():"string"===typeof a.name?a.name:a.name_?a.name_:a.constructor&&a.constructor.name?a.constructor.name:typeof a,Fb=a=>a instanceof hb||!!a.eventBusEl_&&["on","one","off","trigger"].every(b=>"function"===typeof a[b]),
Zn=(a,b)=>{Fb(a)?b():(a.eventedCallbacks||(a.eventedCallbacks=[]),a.eventedCallbacks.push(b))},Uf=a=>"string"===typeof a&&/\S/.test(a)||Array.isArray(a)&&!!a.length,ke=(a,b,c)=>{if(!a||!a.nodeName&&!Fb(a))throw Error(`Invalid target for ${je(b)}#${c}; must be a DOM node or evented object.`);},ej=(a,b,c)=>{if(!Uf(a))throw Error(`Invalid event type for ${je(b)}#${c}; must be a non-empty string or array.`);},fj=(a,b,c)=>{if("function"!==typeof a)throw Error(`Invalid listener for ${je(b)}#${c}; must be a function.`);
},Vf=(a,b,c)=>{const e=3>b.length||b[0]===a||b[0]===a.eventBusEl_;let h,m;e?(h=a.eventBusEl_,3<=b.length&&b.shift(),[b,m]=b):[h,b,m]=b;ke(h,a,c);ej(b,a,c);fj(m,a,c);m=ma(a,m);return{isTargetingSelf:e,target:h,type:b,listener:m}},ec=(a,b,c,e)=>{ke(a,a,b);if(a.nodeName)Xn[b](a,c,e);else a[b](c,e)},mm={on(...a){const {isTargetingSelf:b,target:c,type:e,listener:h}=Vf(this,a,"on");ec(c,"on",e,h);if(!b){const m=()=>this.off(c,e,h);m.guid=h.guid;a=()=>this.off("dispose",m);a.guid=h.guid;ec(this,"on","dispose",
m);ec(c,"on","dispose",a)}},one(...a){const {isTargetingSelf:b,target:c,type:e,listener:h}=Vf(this,a,"one");if(b)ec(c,"one",e,h);else{const m=(...p)=>{this.off(c,e,m);h.apply(null,p)};m.guid=h.guid;ec(c,"one",e,m)}},any(...a){const {isTargetingSelf:b,target:c,type:e,listener:h}=Vf(this,a,"any");if(b)ec(c,"any",e,h);else{const m=(...p)=>{this.off(c,e,m);h.apply(null,p)};m.guid=h.guid;ec(c,"any",e,m)}},off(a,b,c){!a||Uf(a)?Ha(this.eventBusEl_,a,b):(ke(a,this,"off"),ej(b,this,"off"),fj(c,this,"off"),
c=ma(this,c),this.off("dispose",c),a.nodeName?(Ha(a,b,c),Ha(a,"dispose",c)):Fb(a)&&(a.off(b,c),a.off("dispose",c)))},trigger(a,b){ke(this.eventBusEl_,this,"trigger");if(!Uf(a&&"string"!==typeof a?a.type:a))throw Error(`Invalid event type for ${je(this)}#trigger; `+"must be a non-empty string or object with a type key that has a non-empty value.");return yc(this.eventBusEl_,a,b)}},nm={state:{},setState(a){"function"===typeof a&&(a=a());let b;sc(a,(c,e)=>{this.state[e]!==c&&(b=b||{},b[e]={from:this.state[e],
to:c});this.state[e]=c});b&&Fb(this)&&this.trigger({changes:b,type:"statechanged"});return b}},id=function(a){return"string"!==typeof a?a:a.replace(/./,b=>b.toLowerCase())},sa=function(a){return"string"!==typeof a?a:a.replace(/./,b=>b.toUpperCase())},gj=function(a,b){return sa(a)===sa(b)};var $n=Object.freeze({__proto__:null,toLowerCase:id,toTitleCase:sa,titleCaseEquals:gj});class M{constructor(a,b,c){this.player_=!a&&this.play?a=this:a;this.isDisposed_=!1;this.parentComponent_=null;this.options_=
ka({},this.options_);b=this.options_=ka(this.options_,b);this.id_=b.id||b.el&&b.el.id;this.id_||(this.id_=`${a&&a.id&&a.id()||"no_player"}_component_${sb++}`);this.name_=b.name||null;b.el?this.el_=b.el:!1!==b.createEl&&(this.el_=this.createEl());b.className&&this.el_&&b.className.split(" ").forEach(e=>this.addClass(e));["on","off","one","any","trigger"].forEach(e=>{this[e]=void 0});!1!==b.evented&&(tf(this,{eventBusKey:this.el_?"el_":null}),this.handleLanguagechange=this.handleLanguagechange.bind(this),
this.on(this.player_,"languagechange",this.handleLanguagechange));ai(this,this.constructor.defaultState);this.children_=[];this.childIndex_={};this.childNameIndex_={};this.setTimeoutIds_=new Set;this.setIntervalIds_=new Set;this.rafIds_=new Set;this.namedRafs_=new Map;this.clearingTimersOnDispose_=!1;!1!==b.initChildren&&this.initChildren();this.ready(c);!1!==b.reportTouchActivity&&this.enableTouchActivity()}on(a,b){}off(a,b){}one(a,b){}any(a,b){}trigger(a){}dispose(a={}){if(!this.isDisposed_){this.readyQueue_&&
(this.readyQueue_.length=0);this.trigger({type:"dispose",bubbles:!1});this.isDisposed_=!0;if(this.children_)for(let b=this.children_.length-1;0<=b;b--)this.children_[b].dispose&&this.children_[b].dispose();this.parentComponent_=this.childNameIndex_=this.childIndex_=this.children_=null;this.el_&&(this.el_.parentNode&&(a.restoreEl?this.el_.parentNode.replaceChild(a.restoreEl,this.el_):this.el_.parentNode.removeChild(this.el_)),this.el_=null);this.player_=null}}isDisposed(){return!!this.isDisposed_}player(){return this.player_}options(a){return a?
this.options_=ka(this.options_,a):this.options_}el(){return this.el_}createEl(a,b,c){return aa(a,b,c)}localize(a,b,c=a){var e=this.player_.language&&this.player_.language(),h=this.player_.languages&&this.player_.languages();const m=h&&h[e];e=e&&e.split("-")[0];h=h&&h[e];m&&m[a]?c=m[a]:h&&h[a]&&(c=h[a]);b&&(c=c.replace(/\{(\d+)\}/g,function(p,t){let x=t=b[t-1];"undefined"===typeof t&&(x=p);return x}));return c}handleLanguagechange(){}contentEl(){return this.contentEl_||this.el_}id(){return this.id_}name(){return this.name_}children(){return this.children_}getChildById(a){return this.childIndex_[a]}getChild(a){if(a)return this.childNameIndex_[a]}getDescendant(...a){a=
a.reduce((c,e)=>c.concat(e),[]);let b=this;for(let c=0;c<a.length;c++)if(b=b.getChild(a[c]),!b||!b.getChild)return;return b}addChild(a,b={},c=this.children_.length){if("string"===typeof a){var e=sa(a);a=b.componentClass||e;b.name=e;const h=M.getComponent(a);if(!h)throw Error(`Component ${a} does not exist`);if("function"!==typeof h)return null;b=new h(this.player_||this,b)}else b=a;b.parentComponent_&&b.parentComponent_.removeChild(b);this.children_.splice(c,0,b);b.parentComponent_=this;"function"===
typeof b.id&&(this.childIndex_[b.id()]=b);if(e=e||b.name&&sa(b.name()))this.childNameIndex_[e]=b,this.childNameIndex_[id(e)]=b;"function"===typeof b.el&&b.el()&&(e=null,this.children_[c+1]&&(this.children_[c+1].el_?e=this.children_[c+1].el_:vc(this.children_[c+1])&&(e=this.children_[c+1])),this.contentEl().insertBefore(b.el(),e));return b}removeChild(a){"string"===typeof a&&(a=this.getChild(a));if(a&&this.children_){var b=!1;for(let c=this.children_.length-1;0<=c;c--)if(this.children_[c]===a){b=!0;
this.children_.splice(c,1);break}b&&(a.parentComponent_=null,this.childIndex_[a.id()]=null,this.childNameIndex_[sa(a.name())]=null,this.childNameIndex_[id(a.name())]=null,(b=a.el())&&b.parentNode===this.contentEl()&&this.contentEl().removeChild(a.el()))}}initChildren(){const a=this.options_.children;if(a){const b=this.options_;let c;const e=M.getComponent("Tech");c=Array.isArray(a)?a:Object.keys(a);c.concat(Object.keys(this.options_).filter(function(h){return!c.some(function(m){return"string"===typeof m?
h===m:h===m.name})})).map(h=>{let m;"string"===typeof h?(m=h,h=a[m]||this.options_[m]||{}):m=h.name;return{name:m,opts:h}}).filter(h=>(h=M.getComponent(h.opts.componentClass||sa(h.name)))&&!e.isTech(h)).forEach(h=>{const m=h.name;h=h.opts;void 0!==b[m]&&(h=b[m]);!1!==h&&(!0===h&&(h={}),h.playerOptions=this.options_.playerOptions,(h=this.addChild(m,h))&&(this[m]=h))})}}buildCSSClass(){return""}ready(a,b=!1){a&&(this.isReady_?b?a.call(this):this.setTimeout(a,1):(this.readyQueue_=this.readyQueue_||[],
this.readyQueue_.push(a)))}triggerReady(){this.isReady_=!0;this.setTimeout(function(){const a=this.readyQueue_;this.readyQueue_=[];a&&0<a.length&&a.forEach(function(b){b.call(this)},this);this.trigger("ready")},1)}$(a,b){return Rb(a,b||this.contentEl())}$$(a,b){return $i(a,b||this.contentEl())}hasClass(a){return Zc(this.el_,a)}addClass(...a){Xb(this.el_,...a)}removeClass(...a){Md(this.el_,...a)}toggleClass(a,b){Sh(this.el_,a,b)}show(){this.removeClass("vjs-hidden")}hide(){this.addClass("vjs-hidden")}lockShowing(){this.addClass("vjs-lock-showing")}unlockShowing(){this.removeClass("vjs-lock-showing")}getAttribute(a){return this.el_.getAttribute(a)}setAttribute(a,
b){this.el_.setAttribute(a,b)}removeAttribute(a){this.el_.removeAttribute(a)}width(a,b){return this.dimension("width",a,b)}height(a,b){return this.dimension("height",a,b)}dimensions(a,b){this.width(a,!0);this.height(b)}dimension(a,b,c){if(void 0!==b){if(null===b||b!==b)b=0;-1!==(""+b).indexOf("%")||-1!==(""+b).indexOf("px")?this.el_.style[a]=b:this.el_.style[a]="auto"===b?"":b+"px";c||this.trigger("componentresize")}else{if(!this.el_)return 0;b=this.el_.style[a];c=b.indexOf("px");return-1!==c?parseInt(b.slice(0,
c),10):parseInt(this.el_["offset"+sa(a)],10)}}currentDimension(a){let b=0;if("width"!==a&&"height"!==a)throw Error("currentDimension only accepts width or height value");b=xc(this.el_,a);b=parseFloat(b);if(0===b||isNaN(b))a=`offset${sa(a)}`,b=this.el_[a];return b}currentDimensions(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}}currentWidth(){return this.currentDimension("width")}currentHeight(){return this.currentDimension("height")}focus(){this.el_.focus()}blur(){this.el_.blur()}handleKeyDown(a){this.player_&&
(Y.isEventKey(a,"Tab")||a.stopPropagation(),this.player_.handleKeyDown(a))}handleKeyPress(a){this.handleKeyDown(a)}emitTapEvents(){let a=0,b=null,c;this.on("touchstart",function(h){1===h.touches.length&&(b={pageX:h.touches[0].pageX,pageY:h.touches[0].pageY},a=D.performance.now(),c=!0)});this.on("touchmove",function(h){if(1<h.touches.length)c=!1;else if(b){const m=h.touches[0].pageX-b.pageX;h=h.touches[0].pageY-b.pageY;10<Math.sqrt(m*m+h*h)&&(c=!1)}});const e=function(){c=!1};this.on("touchleave",
e);this.on("touchcancel",e);this.on("touchend",function(h){b=null;!0===c&&200>D.performance.now()-a&&(h.preventDefault(),this.trigger("tap"))})}enableTouchActivity(){if(this.player()&&this.player().reportUserActivity){var a=ma(this.player(),this.player().reportUserActivity),b;this.on("touchstart",function(){a();this.clearInterval(b);b=this.setInterval(a,250)});var c=function(e){a();this.clearInterval(b)};this.on("touchmove",a);this.on("touchend",c);this.on("touchcancel",c)}}setTimeout(a,b){a=ma(this,
a);this.clearTimersOnDispose_();var c=D.setTimeout(()=>{this.setTimeoutIds_.has(c)&&this.setTimeoutIds_.delete(c);a()},b);this.setTimeoutIds_.add(c);return c}clearTimeout(a){this.setTimeoutIds_.has(a)&&(this.setTimeoutIds_.delete(a),D.clearTimeout(a));return a}setInterval(a,b){a=ma(this,a);this.clearTimersOnDispose_();a=D.setInterval(a,b);this.setIntervalIds_.add(a);return a}clearInterval(a){this.setIntervalIds_.has(a)&&(this.setIntervalIds_.delete(a),D.clearInterval(a));return a}requestAnimationFrame(a){this.clearTimersOnDispose_();
a=ma(this,a);var b=D.requestAnimationFrame(()=>{this.rafIds_.has(b)&&this.rafIds_.delete(b);a()});this.rafIds_.add(b);return b}requestNamedAnimationFrame(a,b){if(!this.namedRafs_.has(a)){this.clearTimersOnDispose_();b=ma(this,b);var c=this.requestAnimationFrame(()=>{b();this.namedRafs_.has(a)&&this.namedRafs_.delete(a)});this.namedRafs_.set(a,c);return a}}cancelNamedAnimationFrame(a){this.namedRafs_.has(a)&&(this.cancelAnimationFrame(this.namedRafs_.get(a)),this.namedRafs_.delete(a))}cancelAnimationFrame(a){this.rafIds_.has(a)&&
(this.rafIds_.delete(a),D.cancelAnimationFrame(a));return a}clearTimersOnDispose_(){this.clearingTimersOnDispose_||(this.clearingTimersOnDispose_=!0,this.one("dispose",()=>{[["namedRafs_","cancelNamedAnimationFrame"],["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach(([a,b])=>{this[a].forEach((c,e)=>this[b](e))});this.clearingTimersOnDispose_=!1}))}static registerComponent(a,b){if("string"!==typeof a||!a)throw Error(`Illegal component name, "${a}"; must be a non-empty string.`);
var c=M.getComponent("Tech");c=c&&c.isTech(b);const e=M===b||M.prototype.isPrototypeOf(b.prototype);if(c||!e)throw Error(`Illegal component, "${a}"; ${c?"techs must be registered using Tech.registerTech()":"must be a Component subclass"}.`);a=sa(a);M.components_||(M.components_={});c=M.getComponent("Player");if("Player"===a&&c&&c.players){const h=c.players;c=Object.keys(h);if(h&&0<c.length&&c.map(m=>h[m]).every(Boolean))throw Error("Can not register Player component after player has been created.");
}M.components_[a]=b;return M.components_[id(a)]=b}static getComponent(a){if(a&&M.components_)return M.components_[a]}}M.registerComponent("Component",M);const ei=function(a,b){a=0>a?0:a;let c=Math.floor(a%60),e=Math.floor(a/60%60),h=Math.floor(a/3600);const m=Math.floor(b/60%60);b=Math.floor(b/3600);if(isNaN(a)||Infinity===a)h=e=c="-";h=0<h||0<b?h+":":"";return h+(((h||10<=m)&&10>e?"0"+e:e)+":")+(10>c?"0"+c:c)};let vf=ei;var ao=Object.freeze({__proto__:null,createTimeRanges:tb,createTimeRange:tb,
setFormatTime:ci,resetFormatTime:di,formatTime:Yb});Pa.prototype.code=0;Pa.prototype.message="";Pa.prototype.status=null;Pa.errorTypes="MEDIA_ERR_CUSTOM MEDIA_ERR_ABORTED MEDIA_ERR_NETWORK MEDIA_ERR_DECODE MEDIA_ERR_SRC_NOT_SUPPORTED MEDIA_ERR_ENCRYPTED".split(" ");Pa.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",
4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(let a=0;a<Pa.errorTypes.length;a++)Pa[Pa.errorTypes[a]]=a,Pa.prototype[Pa.errorTypes[a]]=a;const Wf=function(a){return"kind label language id inBandMetadataTrackDispatchType mode src".split(" ").reduce((b,c,e)=>{a[c]&&(b[c]=a[c]);return b},{cues:a.cues&&Array.prototype.map.call(a.cues,function(b){return{startTime:b.startTime,
endTime:b.endTime,text:b.text,id:b.id}})})};var hj={textTracksToJson:function(a){const b=a.$$("track"),c=Array.prototype.map.call(b,e=>e.track);return Array.prototype.map.call(b,function(e){const h=Wf(e.track);e.src&&(h.src=e.src);return h}).concat(Array.prototype.filter.call(a.textTracks(),function(e){return-1===c.indexOf(e)}).map(Wf))},jsonToTextTracks:function(a,b){a.forEach(function(c){const e=b.addRemoteTextTrack(c).track;!c.src&&c.cues&&c.cues.forEach(h=>e.addCue(h))});return b.textTracks()},
trackToJson_:Wf};class Fc extends M{constructor(a,b){super(a,b);this.handleKeyDown_=c=>this.handleKeyDown(c);this.close_=c=>this.close(c);this.opened_=this.hasBeenOpened_=this.hasBeenFilled_=!1;this.closeable(!this.options_.uncloseable);this.content(this.options_.content);this.contentEl_=aa("div",{className:"vjs-modal-dialog-content"},{role:"document"});this.descEl_=aa("p",{className:"vjs-modal-dialog-description vjs-control-text",id:this.el().getAttribute("aria-describedby")});Pb(this.descEl_,this.description());
this.el_.appendChild(this.descEl_);this.el_.appendChild(this.contentEl_)}createEl(){return super.createEl("div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":`${this.id()}_description`,"aria-hidden":"true","aria-label":this.label(),role:"dialog"})}dispose(){this.previouslyActiveEl_=this.descEl_=this.contentEl_=null;super.dispose()}buildCSSClass(){return`${"vjs-modal-dialog"} vjs-hidden ${super.buildCSSClass()}`}label(){return this.localize(this.options_.label||"Modal Window")}description(){let a=
this.options_.description||this.localize("This is a modal window.");this.closeable()&&(a+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button."));return a}open(){if(!this.opened_){const a=this.player();this.trigger("beforemodalopen");this.opened_=!0;(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill();this.wasPlaying_=!a.paused();this.options_.pauseOnOpen&&this.wasPlaying_&&a.pause();this.on("keydown",this.handleKeyDown_);
this.hadControls_=a.controls();a.controls(!1);this.show();this.conditionalFocus_();this.el().setAttribute("aria-hidden","false");this.trigger("modalopen");this.hasBeenOpened_=!0}}opened(a){if("boolean"===typeof a)this[a?"open":"close"]();return this.opened_}close(){if(this.opened_){var a=this.player();this.trigger("beforemodalclose");this.opened_=!1;this.wasPlaying_&&this.options_.pauseOnOpen&&a.play();this.off("keydown",this.handleKeyDown_);this.hadControls_&&a.controls(!0);this.hide();this.el().setAttribute("aria-hidden",
"true");this.trigger("modalclose");this.conditionalBlur_();this.options_.temporary&&this.dispose()}}closeable(a){if("boolean"===typeof a){a=this.closeable_=!!a;let b=this.getChild("closeButton");if(a&&!b){const c=this.contentEl_;this.contentEl_=this.el_;b=this.addChild("closeButton",{controlText:"Close Modal Dialog"});this.contentEl_=c;this.on(b,"close",this.close_)}!a&&b&&(this.off(b,"close",this.close_),this.removeChild(b),b.dispose())}return this.closeable_}fill(){this.fillWith(this.content())}fillWith(a){const b=
this.contentEl(),c=b.parentNode,e=b.nextSibling;this.trigger("beforemodalfill");this.hasBeenFilled_=!0;c.removeChild(b);this.empty();Yh(b,a);this.trigger("modalfill");e?c.insertBefore(b,e):c.appendChild(b);(a=this.getChild("closeButton"))&&c.appendChild(a.el_)}empty(){this.trigger("beforemodalempty");Pd(this.contentEl());this.trigger("modalempty")}content(a){"undefined"!==typeof a&&(this.content_=a);return this.content_}conditionalFocus_(){const a=P.activeElement,b=this.player_.el_;this.previouslyActiveEl_=
null;if(b.contains(a)||b===a)this.previouslyActiveEl_=a,this.focus()}conditionalBlur_(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)}handleKeyDown(a){a.stopPropagation();if(Y.isEventKey(a,"Escape")&&this.closeable())a.preventDefault(),this.close();else if(Y.isEventKey(a,"Tab")){var b=this.focusableEls_(),c=this.el_.querySelector(":focus");for(let h=0;h<b.length;h++)if(c===b[h]){var e=h;break}P.activeElement===this.el_&&(e=0);a.shiftKey&&0===e?(b[b.length-
1].focus(),a.preventDefault()):a.shiftKey||e!==b.length-1||(b[0].focus(),a.preventDefault())}}focusableEls_(){const a=this.el_.querySelectorAll("*");return Array.prototype.filter.call(a,b=>(b instanceof D.HTMLAnchorElement||b instanceof D.HTMLAreaElement)&&b.hasAttribute("href")||(b instanceof D.HTMLInputElement||b instanceof D.HTMLSelectElement||b instanceof D.HTMLTextAreaElement||b instanceof D.HTMLButtonElement)&&!b.hasAttribute("disabled")||b instanceof D.HTMLIFrameElement||b instanceof D.HTMLObjectElement||
b instanceof D.HTMLEmbedElement||b.hasAttribute("tabindex")&&-1!==b.getAttribute("tabindex")||b.hasAttribute("contenteditable"))}}Fc.prototype.options_={pauseOnOpen:!0,temporary:!0};M.registerComponent("ModalDialog",Fc);class Gc extends hb{constructor(a=[]){super();this.tracks_=[];Object.defineProperty(this,"length",{get(){return this.tracks_.length}});for(let b=0;b<a.length;b++)this.addTrack(a[b])}addTrack(a){const b=this.tracks_.length;""+b in this||Object.defineProperty(this,b,{get(){return this.tracks_[b]}});
-1===this.tracks_.indexOf(a)&&(this.tracks_.push(a),this.trigger({track:a,type:"addtrack",target:this}));a.labelchange_=()=>{this.trigger({track:a,type:"labelchange",target:this})};Fb(a)&&a.addEventListener("labelchange",a.labelchange_)}removeTrack(a){let b;for(let c=0,e=this.length;c<e;c++)if(this[c]===a){b=this[c];b.off&&b.off();this.tracks_.splice(c,1);break}b&&this.trigger({track:b,type:"removetrack",target:this})}getTrackById(a){let b=null;for(let c=0,e=this.length;c<e;c++){const h=this[c];if(h.id===
a){b=h;break}}return b}}Gc.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack",labelchange:"labelchange"};for(const a in Gc.prototype.allowedEvents_)Gc.prototype["on"+a]=null;const Xf=function(a,b){for(let c=0;c<a.length;c++)Object.keys(a[c]).length&&b.id!==a[c].id&&(a[c].enabled=!1)};class bo extends Gc{constructor(a=[]){for(let b=a.length-1;0<=b;b--)if(a[b].enabled){Xf(a,a[b]);break}super(a);this.changing_=!1}addTrack(a){a.enabled&&Xf(this,a);super.addTrack(a);
a.addEventListener&&(a.enabledChange_=()=>{this.changing_||(this.changing_=!0,Xf(this,a),this.changing_=!1,this.trigger("change"))},a.addEventListener("enabledchange",a.enabledChange_))}removeTrack(a){super.removeTrack(a);a.removeEventListener&&a.enabledChange_&&(a.removeEventListener("enabledchange",a.enabledChange_),a.enabledChange_=null)}}const Yf=function(a,b){for(let c=0;c<a.length;c++)Object.keys(a[c]).length&&b.id!==a[c].id&&(a[c].selected=!1)};class co extends Gc{constructor(a=[]){for(let b=
a.length-1;0<=b;b--)if(a[b].selected){Yf(a,a[b]);break}super(a);this.changing_=!1;Object.defineProperty(this,"selectedIndex",{get(){for(let b=0;b<this.length;b++)if(this[b].selected)return b;return-1},set(){}})}addTrack(a){a.selected&&Yf(this,a);super.addTrack(a);a.addEventListener&&(a.selectedChange_=()=>{this.changing_||(this.changing_=!0,Yf(this,a),this.changing_=!1,this.trigger("change"))},a.addEventListener("selectedchange",a.selectedChange_))}removeTrack(a){super.removeTrack(a);a.removeEventListener&&
a.selectedChange_&&(a.removeEventListener("selectedchange",a.selectedChange_),a.selectedChange_=null)}}class ij extends Gc{addTrack(a){super.addTrack(a);this.queueChange_||(this.queueChange_=()=>this.queueTrigger("change"));this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=()=>this.trigger("selectedlanguagechange"));a.addEventListener("modechange",this.queueChange_);-1===["metadata","chapters"].indexOf(a.kind)&&a.addEventListener("modechange",this.triggerSelectedlanguagechange_)}removeTrack(a){super.removeTrack(a);
a.removeEventListener&&(this.queueChange_&&a.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_&&a.removeEventListener("modechange",this.triggerSelectedlanguagechange_))}}class eo{constructor(a=[]){this.trackElements_=[];Object.defineProperty(this,"length",{get(){return this.trackElements_.length}});for(let b=0,c=a.length;b<c;b++)this.addTrackElement_(a[b])}addTrackElement_(a){const b=this.trackElements_.length;""+b in this||Object.defineProperty(this,b,{get(){return this.trackElements_[b]}});
-1===this.trackElements_.indexOf(a)&&this.trackElements_.push(a)}getTrackElementByTrack_(a){let b;for(let c=0,e=this.trackElements_.length;c<e;c++)if(a===this.trackElements_[c].track){b=this.trackElements_[c];break}return b}removeTrackElement_(a){for(let b=0,c=this.trackElements_.length;b<c;b++)if(a===this.trackElements_[b]){this.trackElements_[b].track&&"function"===typeof this.trackElements_[b].track.off&&this.trackElements_[b].track.off();"function"===typeof this.trackElements_[b].off&&this.trackElements_[b].off();
this.trackElements_.splice(b,1);break}}}class Zf{constructor(a){Zf.prototype.setCues_.call(this,a);Object.defineProperty(this,"length",{get(){return this.length_}})}setCues_(a){const b=this.length||0;let c=0;const e=a.length;this.cues_=a;this.length_=a.length;a=function(h){""+h in this||Object.defineProperty(this,""+h,{get(){return this.cues_[h]}})};if(b<e)for(c=b;c<e;c++)a.call(this,c)}getCueById(a){let b=null;for(let c=0,e=this.length;c<e;c++){const h=this[c];if(h.id===a){b=h;break}}return b}}const fo=
{alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},go={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},ho={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},jj={disabled:"disabled",hidden:"hidden",showing:"showing"};class $f extends hb{constructor(a={}){super();const b={id:a.id||
"vjs_track_"+sb++,kind:a.kind||"",language:a.language||""};let c=a.label||"";for(const e in b)Object.defineProperty(this,e,{get(){return b[e]},set(){}});Object.defineProperty(this,"label",{get(){return c},set(e){e!==c&&(c=e,this.trigger("labelchange"))}})}}const ag=function(a){const b="protocol hostname port pathname search hash host".split(" "),c=P.createElement("a");c.href=a;a={};for(let e=0;e<b.length;e++)a[b[e]]=c[b[e]];"http:"===a.protocol&&(a.host=a.host.replace(/:80$/,""));"https:"===a.protocol&&
(a.host=a.host.replace(/:443$/,""));a.protocol||(a.protocol=D.location.protocol);a.host||(a.host=D.location.host);return a},kj=function(a){if(!a.match(/^https?:\/\//)){const b=P.createElement("a");b.href=a;a=b.href}return a},bg=function(a){return"string"===typeof a&&(a=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/.exec(a))?a.pop().toLowerCase():""},le=function(a,b=D.location){a=ag(a);return(":"===a.protocol?b.protocol:a.protocol)+a.host!==b.protocol+b.host};var io=Object.freeze({__proto__:null,
parseUrl:ag,getAbsoluteURL:kj,getFileExtension:bg,isCrossOrigin:le});const lj=function(a,b){const c=new D.WebVTT.Parser(D,D.vttjs,D.WebVTT.StringDecoder()),e=[];c.oncue=function(h){b.addCue(h)};c.onparsingerror=function(h){e.push(h)};c.onflush=function(){b.trigger({type:"loadeddata",target:b})};c.parse(a);0<e.length&&(D.console&&D.console.groupCollapsed&&D.console.groupCollapsed(`Text Track parsing errors for ${b.src}`),e.forEach(h=>ca.error(h)),D.console&&D.console.groupEnd&&D.console.groupEnd());
c.flush()},mj=function(a,b){const c={uri:a};if(a=le(a))c.cors=a;if(a="use-credentials"===b.tech_.crossOrigin())c.withCredentials=a;li(c,ma(this,function(e,h,m){if(e)return ca.error(e,h);b.loaded_=!0;"function"!==typeof D.WebVTT?b.tech_&&b.tech_.any(["vttjsloaded","vttjserror"],p=>{if("vttjserror"===p.type)ca.error(`vttjs failed to load, stopping trying to process ${b.src}`);else return lj(m,b)}):lj(m,b)}))};class jd extends $f{constructor(a={}){if(!a.tech)throw Error("A tech was not provided.");a=
ka(a,{kind:ho[a.kind]||"subtitles",language:a.language||a.srclang||""});let b=jj[a.mode]||"disabled";const c=a.default;if("metadata"===a.kind||"chapters"===a.kind)b="hidden";super(a);this.tech_=a.tech;this.cues_=[];this.activeCues_=[];this.preload_=!1!==this.tech_.preloadTextTracks;const e=new Zf(this.cues_),h=new Zf(this.activeCues_);let m=!1;this.timeupdateHandler=ma(this,function(p={}){this.tech_.isDisposed()||(this.tech_.isReady_&&(this.activeCues=this.activeCues,m&&(this.trigger("cuechange"),
m=!1)),"timeupdate"!==p.type&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler)))});this.tech_.one("dispose",()=>{this.stopTracking()});"disabled"!==b&&this.startTracking();Object.defineProperties(this,{default:{get(){return c},set(){}},mode:{get(){return b},set(p){jj[p]&&b!==p&&(b=p,this.preload_||"disabled"===b||0!==this.cues.length||mj(this.src,this),this.stopTracking(),"disabled"!==b&&this.startTracking(),this.trigger("modechange"))}},cues:{get(){return this.loaded_?e:null},
set(){}},activeCues:{get(){if(!this.loaded_)return null;if(0===this.cues.length)return h;var p=this.tech_.currentTime();const t=[];for(let x=0,y=this.cues.length;x<y;x++){const C=this.cues[x];C.startTime<=p&&C.endTime>=p&&t.push(C)}m=!1;if(t.length!==this.activeCues_.length)m=!0;else for(p=0;p<t.length;p++)-1===this.activeCues_.indexOf(t[p])&&(m=!0);this.activeCues_=t;h.setCues_(this.activeCues_);return h},set(){}}});a.src?(this.src=a.src,this.preload_||(this.loaded_=!0),(this.preload_||"subtitles"!==
a.kind&&"captions"!==a.kind)&&mj(this.src,this)):this.loaded_=!0}startTracking(){this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler);this.tech_.on("timeupdate",this.timeupdateHandler)}stopTracking(){this.rvf_&&(this.tech_.cancelVideoFrameCallback(this.rvf_),this.rvf_=void 0);this.tech_.off("timeupdate",this.timeupdateHandler)}addCue(a){let b=a;if(D.vttjs&&!(a instanceof D.vttjs.VTTCue)){b=new D.vttjs.VTTCue(a.startTime,a.endTime,a.text);for(var c in a)c in b||(b[c]=a[c]);b.id=a.id;
b.originalCue_=a}a=this.tech_.textTracks();for(c=0;c<a.length;c++)a[c]!==this&&a[c].removeCue(b);this.cues_.push(b);this.cues.setCues_(this.cues_)}removeCue(a){let b=this.cues_.length;for(;b--;){const c=this.cues_[b];if(c===a||c.originalCue_&&c.originalCue_===a){this.cues_.splice(b,1);this.cues.setCues_(this.cues_);break}}}}jd.prototype.allowedEvents_={cuechange:"cuechange"};class nj extends $f{constructor(a={}){a=ka(a,{kind:go[a.kind]||""});super(a);let b=!1;Object.defineProperty(this,"enabled",
{get(){return b},set(c){"boolean"===typeof c&&c!==b&&(b=c,this.trigger("enabledchange"))}});a.enabled&&(this.enabled=a.enabled);this.loaded_=!0}}class oj extends $f{constructor(a={}){a=ka(a,{kind:fo[a.kind]||""});super(a);let b=!1;Object.defineProperty(this,"selected",{get(){return b},set(c){"boolean"===typeof c&&c!==b&&(b=c,this.trigger("selectedchange"))}});a.selected&&(this.selected=a.selected)}}class Tb extends hb{constructor(a={}){super();let b;const c=new jd(a);this.kind=c.kind;this.src=c.src;
this.srclang=c.language;this.label=c.label;this.default=c.default;Object.defineProperties(this,{readyState:{get(){return b}},track:{get(){return c}}});b=Tb.NONE;c.addEventListener("loadeddata",()=>{b=Tb.LOADED;this.trigger({type:"load",target:this})})}}Tb.prototype.allowedEvents_={load:"load"};Tb.NONE=0;Tb.LOADING=1;Tb.LOADED=2;Tb.ERROR=3;const ib={audio:{ListClass:bo,TrackClass:nj,capitalName:"Audio"},video:{ListClass:co,TrackClass:oj,capitalName:"Video"},text:{ListClass:ij,TrackClass:jd,capitalName:"Text"}};
Object.keys(ib).forEach(function(a){ib[a].getterName=`${a}Tracks`;ib[a].privateName=`${a}Tracks_`});const Hc={remoteText:{ListClass:ij,TrackClass:jd,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:eo,TrackClass:Tb,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},Qa=Object.assign({},ib,Hc);Hc.names=Object.keys(Hc);ib.names=Object.keys(ib);Qa.names=[].concat(Hc.names).concat(ib.names);
class Z extends M{constructor(a={},b=function(){}){a.reportTouchActivity=!1;super(null,a,b);this.onDurationChange_=c=>this.onDurationChange(c);this.trackProgress_=c=>this.trackProgress(c);this.trackCurrentTime_=c=>this.trackCurrentTime(c);this.stopTrackingCurrentTime_=c=>this.stopTrackingCurrentTime(c);this.disposeSourceHandler_=c=>this.disposeSourceHandler(c);this.queuedHanders_=new Set;this.hasStarted_=!1;this.on("playing",function(){this.hasStarted_=!0});this.on("loadstart",function(){this.hasStarted_=
!1});Qa.names.forEach(c=>{c=Qa[c];a&&a[c.getterName]&&(this[c.privateName]=a[c.getterName])});this.featuresProgressEvents||this.manualProgressOn();this.featuresTimeupdateEvents||this.manualTimeUpdatesOn();["Text","Audio","Video"].forEach(c=>{!1===a[`native${c}Tracks`]&&(this[`featuresNative${c}Tracks`]=!1)});if(!1===a.nativeCaptions||!1===a.nativeTextTracks)this.featuresNativeTextTracks=!1;else if(!0===a.nativeCaptions||!0===a.nativeTextTracks)this.featuresNativeTextTracks=!0;this.featuresNativeTextTracks||
this.emulateTextTracks();this.preloadTextTracks=!1!==a.preloadTextTracks;this.autoRemoteTextTracks_=new Qa.text.ListClass;this.initTrackListeners();a.nativeControlsForTouch||this.emitTapEvents();this.constructor&&(this.name_=this.constructor.name||"Unknown Tech")}triggerSourceset(a){if(!this.isReady_)this.one("ready",()=>this.setTimeout(()=>this.triggerSourceset(a),1));this.trigger({src:a,type:"sourceset"})}manualProgressOn(){this.on("durationchange",this.onDurationChange_);this.manualProgress=!0;
this.one("ready",this.trackProgress_)}manualProgressOff(){this.manualProgress=!1;this.stopTrackingProgress();this.off("durationchange",this.onDurationChange_)}trackProgress(a){this.stopTrackingProgress();this.progressInterval=this.setInterval(ma(this,function(){const b=this.bufferedPercent();this.bufferedPercent_!==b&&this.trigger("progress");this.bufferedPercent_=b;1===b&&this.stopTrackingProgress()}),500)}onDurationChange(a){this.duration_=this.duration()}buffered(){return tb(0,0)}bufferedPercent(){return fi(this.buffered(),
this.duration_)}stopTrackingProgress(){this.clearInterval(this.progressInterval)}manualTimeUpdatesOn(){this.manualTimeUpdates=!0;this.on("play",this.trackCurrentTime_);this.on("pause",this.stopTrackingCurrentTime_)}manualTimeUpdatesOff(){this.manualTimeUpdates=!1;this.stopTrackingCurrentTime();this.off("play",this.trackCurrentTime_);this.off("pause",this.stopTrackingCurrentTime_)}trackCurrentTime(){this.currentTimeInterval&&this.stopTrackingCurrentTime();this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",
target:this,manuallyTriggered:!0})},250)}stopTrackingCurrentTime(){this.clearInterval(this.currentTimeInterval);this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}dispose(){this.clearTracks(ib.names);this.manualProgress&&this.manualProgressOff();this.manualTimeUpdates&&this.manualTimeUpdatesOff();super.dispose()}clearTracks(a){a=[].concat(a);a.forEach(b=>{const c=this[`${b}Tracks`]()||[];let e=c.length;for(;e--;){const h=c[e];"text"===b&&this.removeRemoteTextTrack(h);c.removeTrack(h)}})}cleanupAutoTextTracks(){const a=
this.autoRemoteTextTracks_||[];let b=a.length;for(;b--;)this.removeRemoteTextTrack(a[b])}reset(){}crossOrigin(){}setCrossOrigin(){}error(a){void 0!==a&&(this.error_=new Pa(a),this.trigger("error"));return this.error_}played(){return this.hasStarted_?tb(0,0):tb()}play(){}setScrubbing(a){}scrubbing(){}setCurrentTime(a){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}initTrackListeners(){ib.names.forEach(a=>{const b=()=>{this.trigger(`${a}trackchange`)},c=this[ib[a].getterName]();
c.addEventListener("removetrack",b);c.addEventListener("addtrack",b);this.on("dispose",()=>{c.removeEventListener("removetrack",b);c.removeEventListener("addtrack",b)})})}addWebVttScript_(){if(!D.WebVTT)if(P.body.contains(this.el()))if(!this.options_["vtt.js"]&&tc(ni)&&0<Object.keys(ni).length)this.trigger("vttjsloaded");else{var a=P.createElement("script");a.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js";a.onload=()=>{this.trigger("vttjsloaded")};a.onerror=()=>{this.trigger("vttjserror")};
this.on("dispose",()=>{a.onload=null;a.onerror=null});D.WebVTT=!0;this.el().parentNode.appendChild(a)}else this.ready(this.addWebVttScript_)}emulateTextTracks(){const a=this.textTracks(),b=this.remoteTextTracks(),c=p=>a.addTrack(p.track),e=p=>a.removeTrack(p.track);b.on("addtrack",c);b.on("removetrack",e);this.addWebVttScript_();const h=()=>this.trigger("texttrackchange"),m=()=>{h();for(let p=0;p<a.length;p++){const t=a[p];t.removeEventListener("cuechange",h);"showing"===t.mode&&t.addEventListener("cuechange",
h)}};m();a.addEventListener("change",m);a.addEventListener("addtrack",m);a.addEventListener("removetrack",m);this.on("dispose",function(){b.off("addtrack",c);b.off("removetrack",e);a.removeEventListener("change",m);a.removeEventListener("addtrack",m);a.removeEventListener("removetrack",m);for(let p=0;p<a.length;p++)a[p].removeEventListener("cuechange",h)})}addTextTrack(a,b,c){if(!a)throw Error("TextTrack kind is required but was not provided");return om(this,a,b,c)}createRemoteTextTrack(a){a=ka(a,
{tech:this});return new Hc.remoteTextEl.TrackClass(a)}addRemoteTextTrack(a={},b){const c=this.createRemoteTextTrack(a);"boolean"!==typeof b&&(b=!1);this.remoteTextTrackEls().addTrackElement_(c);this.remoteTextTracks().addTrack(c.track);!1===b&&this.ready(()=>this.autoRemoteTextTracks_.addTrack(c.track));return c}removeRemoteTextTrack(a){const b=this.remoteTextTrackEls().getTrackElementByTrack_(a);this.remoteTextTrackEls().removeTrackElement_(b);this.remoteTextTracks().removeTrack(a);this.autoRemoteTextTracks_.removeTrack(a)}getVideoPlaybackQuality(){return{}}requestPictureInPicture(){return Promise.reject()}disablePictureInPicture(){return!0}setDisablePictureInPicture(){}requestVideoFrameCallback(a){const b=
sb++;!this.isReady_||this.paused()?(this.queuedHanders_.add(b),this.one("playing",()=>{this.queuedHanders_.has(b)&&(this.queuedHanders_.delete(b),a())})):this.requestNamedAnimationFrame(b,a);return b}cancelVideoFrameCallback(a){this.queuedHanders_.has(a)?this.queuedHanders_.delete(a):this.cancelNamedAnimationFrame(a)}setPoster(){}playsinline(){}setPlaysinline(){}overrideNativeAudioTracks(a){}overrideNativeVideoTracks(a){}canPlayType(a){return""}static canPlayType(a){return""}static canPlaySource(a,
b){return Z.canPlayType(a.type)}static isTech(a){return a.prototype instanceof Z||a instanceof Z||a===Z}static registerTech(a,b){Z.techs_||(Z.techs_={});if(!Z.isTech(b))throw Error(`Tech ${a} must be a Tech`);if(!Z.canPlayType)throw Error("Techs must have a static canPlayType method on them");if(!Z.canPlaySource)throw Error("Techs must have a static canPlaySource method on them");a=sa(a);Z.techs_[a]=b;Z.techs_[id(a)]=b;"Tech"!==a&&Z.defaultTechOrder_.push(a);return b}static getTech(a){if(a){if(Z.techs_&&
Z.techs_[a])return Z.techs_[a];a=sa(a);if(D&&D.videojs&&D.videojs[a])return ca.warn(`The ${a} tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)`),D.videojs[a]}}}Qa.names.forEach(function(a){const b=Qa[a];Z.prototype[b.getterName]=function(){this[b.privateName]=this[b.privateName]||new b.ListClass;return this[b.privateName]}});Z.prototype.featuresVolumeControl=!0;Z.prototype.featuresMuteControl=!0;Z.prototype.featuresFullscreenResize=!1;Z.prototype.featuresPlaybackRate=
!1;Z.prototype.featuresProgressEvents=!1;Z.prototype.featuresSourceset=!1;Z.prototype.featuresTimeupdateEvents=!1;Z.prototype.featuresNativeTextTracks=!1;Z.prototype.featuresVideoFrameCallback=!1;Z.withSourceHandlers=function(a){a.registerSourceHandler=function(b,c){let e=a.sourceHandlers;e||(e=a.sourceHandlers=[]);void 0===c&&(c=e.length);e.splice(c,0,b)};a.canPlayType=function(b){const c=a.sourceHandlers||[];let e;for(let h=0;h<c.length;h++)if(e=c[h].canPlayType(b))return e;return""};a.selectSourceHandler=
function(b,c){const e=a.sourceHandlers||[];let h;for(let m=0;m<e.length;m++)if(h=e[m].canHandleSource(b,c))return e[m];return null};a.canPlaySource=function(b,c){const e=a.selectSourceHandler(b,c);return e?e.canHandleSource(b,c):""};["seekable","seeking","duration"].forEach(function(b){const c=this[b];"function"===typeof c&&(this[b]=function(){return this.sourceHandler_&&this.sourceHandler_[b]?this.sourceHandler_[b].apply(this.sourceHandler_,arguments):c.apply(this,arguments)})},a.prototype);a.prototype.setSource=
function(b){let c=a.selectSourceHandler(b,this.options_);c||(a.nativeSourceHandler?c=a.nativeSourceHandler:ca.error("No source handler found for the current source."));this.disposeSourceHandler();this.off("dispose",this.disposeSourceHandler_);c!==a.nativeSourceHandler&&(this.currentSource_=b);this.sourceHandler_=c.handleSource(b,this,this.options_);this.one("dispose",this.disposeSourceHandler_)};a.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),
this.currentSource_=null);this.cleanupAutoTextTracks();this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}};M.registerComponent("Tech",Z);Z.registerTech("Tech",Z);Z.defaultTechOrder_=[];const $b={},xf={},Sd={},jo={buffered:1,currentTime:1,duration:1,muted:1,played:1,paused:1,seekable:1,volume:1,ended:1},ko={setCurrentTime:1,setMuted:1,setVolume:1},pj={play:1,pause:1},lo={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",
mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",caf:"audio/x-caf",flac:"audio/flac",oga:"audio/ogg",wav:"audio/wav",m3u8:"application/x-mpegURL",mpd:"application/dash+xml",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"},Td=function(a=""){a=bg(a);return lo[a.toLowerCase()]||""},mo=(a,b)=>{if(!b)return"";if(a.cache_.source.src===b&&a.cache_.source.type)return a.cache_.source.type;var c=a.cache_.sources.filter(e=>e.src===
b);if(c.length)return c[0].type;a=a.$$("source");for(c=0;c<a.length;c++){const e=a[c];if(e.type&&e.src&&e.src===b)return e.type}return Td(b)},qj=function(a){if(Array.isArray(a)){let b=[];a.forEach(function(c){c=qj(c);Array.isArray(c)?b=b.concat(c):rb(c)&&b.push(c)});a=b}else a="string"===typeof a&&a.trim()?[hi({src:a})]:rb(a)&&"string"===typeof a.src&&a.src&&a.src.trim()?[hi(a)]:[];return a};class no extends M{constructor(a,b,c){const e=ka({createEl:!1},b);super(a,e,c);if(b.playerOptions.sources&&
0!==b.playerOptions.sources.length)a.src(b.playerOptions.sources);else for(let h=0,m=b.playerOptions.techOrder;h<m.length;h++)if(b=sa(m[h]),c=Z.getTech(b),b||(c=M.getComponent(b)),c&&c.isSupported()){a.loadTech_(b);break}}}M.registerComponent("MediaLoader",no);class me extends M{constructor(a,b){super(a,b);this.options_.controlText&&this.controlText(this.options_.controlText);this.handleMouseOver_=c=>this.handleMouseOver(c);this.handleMouseOut_=c=>this.handleMouseOut(c);this.handleClick_=c=>this.handleClick(c);
this.handleKeyDown_=c=>this.handleKeyDown(c);this.emitTapEvents();this.enable()}createEl(a="div",b={},c={}){b=Object.assign({className:this.buildCSSClass(),tabIndex:0},b);"button"===a&&ca.error(`Creating a ClickableComponent with an HTML element of ${a} is not supported; use a Button instead.`);c=Object.assign({role:"button"},c);this.tabIndex_=b.tabIndex;a=aa(a,b,c);a.appendChild(aa("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0}));this.createControlTextEl(a);return a}dispose(){this.controlTextEl_=
null;super.dispose()}createControlTextEl(a){this.controlTextEl_=aa("span",{className:"vjs-control-text"},{"aria-live":"polite"});a&&a.appendChild(this.controlTextEl_);this.controlText(this.controlText_,a);return this.controlTextEl_}controlText(a,b=this.el()){if(void 0===a)return this.controlText_||"Need Text";const c=this.localize(a);this.controlText_=a;Pb(this.controlTextEl_,c);this.nonIconControl||this.player_.options_.noUITitleAttributes||b.setAttribute("title",c)}buildCSSClass(){return`vjs-control vjs-button ${super.buildCSSClass()}`}enable(){this.enabled_||
(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),"undefined"!==typeof this.tabIndex_&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick_),this.on("keydown",this.handleKeyDown_))}disable(){this.enabled_=!1;this.addClass("vjs-disabled");this.el_.setAttribute("aria-disabled","true");"undefined"!==typeof this.tabIndex_&&this.el_.removeAttribute("tabIndex");this.off("mouseover",this.handleMouseOver_);this.off("mouseout",
this.handleMouseOut_);this.off(["tap","click"],this.handleClick_);this.off("keydown",this.handleKeyDown_)}handleLanguagechange(){this.controlText(this.controlText_)}handleClick(a){this.options_.clickHandler&&this.options_.clickHandler.call(this,arguments)}handleKeyDown(a){Y.isEventKey(a,"Space")||Y.isEventKey(a,"Enter")?(a.preventDefault(),a.stopPropagation(),this.trigger("click")):super.handleKeyDown(a)}}M.registerComponent("ClickableComponent",me);class cg extends me{constructor(a,b){super(a,b);
this.update();this.update_=c=>this.update(c);a.on("posterchange",this.update_)}dispose(){this.player().off("posterchange",this.update_);super.dispose()}createEl(){return aa("div",{className:"vjs-poster"})}crossOrigin(a){if("undefined"===typeof a)return this.$("img")?this.$("img").crossOrigin:this.player_.tech_&&this.player_.tech_.isReady_?this.player_.crossOrigin():this.player_.options_.crossOrigin||this.player_.options_.crossorigin||null;null!==a&&"anonymous"!==a&&"use-credentials"!==a?this.player_.log.warn(`crossOrigin must be null,  "anonymous" or "use-credentials", given "${a}"`):
this.$("img")&&(this.$("img").crossOrigin=a)}update(a){a=this.player().poster();this.setSrc(a);a?this.show():this.hide()}setSrc(a){a?(this.$("img")||this.el_.appendChild(aa("picture",{className:"vjs-poster",tabIndex:-1},{},aa("img",{loading:"lazy",crossOrigin:this.crossOrigin()},{alt:""}))),this.$("img").src=a):this.el_.textContent=""}handleClick(a){this.player_.controls()&&(this.player_.tech(!0)&&this.player_.tech(!0).focus(),this.player_.paused()?ub(this.player_.play()):this.player_.pause())}}cg.prototype.crossorigin=
cg.prototype.crossOrigin;M.registerComponent("PosterImage",cg);const oo={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};class po extends M{constructor(a,b,c){super(a,b,c);const e=
h=>this.updateDisplay(h);a.on("loadstart",h=>this.toggleDisplay(h));a.on("texttrackchange",e);a.on("loadedmetadata",h=>this.preselectTrack(h));a.ready(ma(this,function(){if(a.tech_&&a.tech_.featuresNativeTextTracks)this.hide();else{a.on("fullscreenchange",e);a.on("playerresize",e);var h=D.screen.orientation||D,m=D.screen.orientation?"change":"orientationchange";h.addEventListener(m,e);a.on("dispose",()=>h.removeEventListener(m,e));var p=this.options_.playerOptions.tracks||[];for(let t=0;t<p.length;t++)this.player_.addRemoteTextTrack(p[t],
!0);this.preselectTrack()}}))}preselectTrack(){const a={captions:1,subtitles:1},b=this.player_.textTracks(),c=this.player_.cache_.selectedLanguage;let e,h,m;for(let p=0;p<b.length;p++){const t=b[p];c&&c.enabled&&c.language&&c.language===t.language&&t.kind in a?t.kind===c.kind?m=t:m||(m=t):c&&!c.enabled?h=e=m=null:t.default&&("descriptions"!==t.kind||e?t.kind in a&&!h&&(h=t):e=t)}m?m.mode="showing":h?h.mode="showing":e&&(e.mode="showing")}toggleDisplay(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?
this.hide():this.show()}createEl(){return super.createEl("div",{className:"vjs-text-track-display"},{translate:"yes","aria-live":"off","aria-atomic":"true"})}clearDisplay(){"function"===typeof D.WebVTT&&D.WebVTT.processCues(D,[],this.el_)}updateDisplay(){const a=this.player_.textTracks();var b=this.options_.allowMultipleShowingTracks;this.clearDisplay();if(b){b=[];for(var c=0;c<a.length;++c){var e=a[c];"showing"===e.mode&&b.push(e)}this.updateForTrack(b)}else{c=b=null;for(e=a.length;e--;){const h=
a[e];"showing"===h.mode&&("descriptions"===h.kind?b=h:c=h)}c?("off"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","off"),this.updateForTrack(c)):b&&("assertive"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","assertive"),this.updateForTrack(b))}}updateDisplayState(a){const b=this.player_.textTrackSettings.getValues();a=a.activeCues;let c=a.length;for(;c--;){var e=a[c];if(e){e=e.displayState;b.color&&(e.firstChild.style.color=b.color);if(b.textOpacity){var h=yf(b.color||
"#fff",b.textOpacity);try{e.firstChild.style.color=h}catch(m){}}b.backgroundColor&&(e.firstChild.style.backgroundColor=b.backgroundColor);if(b.backgroundOpacity){h=yf(b.backgroundColor||"#000",b.backgroundOpacity);try{e.firstChild.style.backgroundColor=h}catch(m){}}if(b.windowColor)if(b.windowOpacity){h=yf(b.windowColor,b.windowOpacity);try{e.style.backgroundColor=h}catch(m){}}else e.style.backgroundColor=b.windowColor;b.edgeStyle&&("dropshadow"===b.edgeStyle?e.firstChild.style.textShadow="2px 2px 3px #222, 2px 2px 4px #222, 2px 2px 5px #222":
"raised"===b.edgeStyle?e.firstChild.style.textShadow="1px 1px #222, 2px 2px #222, 3px 3px #222":"depressed"===b.edgeStyle?e.firstChild.style.textShadow="1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px #222":"uniform"===b.edgeStyle&&(e.firstChild.style.textShadow="0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px #222"));b.fontPercent&&1!==b.fontPercent&&(h=D.parseFloat(e.style.fontSize),e.style.fontSize=h*b.fontPercent+"px",e.style.height="auto",e.style.top="auto");b.fontFamily&&"default"!==b.fontFamily&&
("small-caps"===b.fontFamily?e.firstChild.style.fontVariant="small-caps":e.firstChild.style.fontFamily=oo[b.fontFamily])}}}updateForTrack(a){Array.isArray(a)||(a=[a]);if("function"===typeof D.WebVTT&&!a.every(m=>!m.activeCues)){var b=[];for(var c=0;c<a.length;++c){var e=a[c];for(var h=0;h<e.activeCues.length;++h)b.push(e.activeCues[h])}D.WebVTT.processCues(D,b,this.el_);for(b=0;b<a.length;++b){c=a[b];for(e=0;e<c.activeCues.length;++e)h=c.activeCues[e].displayState,Xb(h,"vjs-text-track-cue","vjs-text-track-cue-"+
(c.language?c.language:b)),c.language&&h.setAttribute("lang",c.language);this.player_.textTrackSettings&&this.updateDisplayState(c)}}}}M.registerComponent("TextTrackDisplay",po);class qo extends M{createEl(){var a=this.player_.isAudio();a=this.localize(a?"Audio Player":"Video Player");a=aa("span",{className:"vjs-control-text",textContent:this.localize("{1} is loading.",[a])});const b=super.createEl("div",{className:"vjs-loading-spinner",dir:"ltr"});b.appendChild(a);return b}handleLanguagechange(){this.$(".vjs-control-text").textContent=
this.localize("{1} is loading.",[this.player_.isAudio()?"Audio Player":"Video Player"])}}M.registerComponent("LoadingSpinner",qo);class bb extends me{createEl(a,b={},c={}){a="button";b=Object.assign({className:this.buildCSSClass()},b);c=Object.assign({type:"button"},c);a=aa(a,b,c);a.appendChild(aa("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0}));this.createControlTextEl(a);return a}addChild(a,b={}){ca.warn(`Adding an actionable (user controllable) child to a Button (${this.constructor.name}) is not supported; use a ClickableComponent instead.`);
return M.prototype.addChild.call(this,a,b)}enable(){super.enable();this.el_.removeAttribute("disabled")}disable(){super.disable();this.el_.setAttribute("disabled","disabled")}handleKeyDown(a){Y.isEventKey(a,"Space")||Y.isEventKey(a,"Enter")?a.stopPropagation():super.handleKeyDown(a)}}M.registerComponent("Button",bb);class rj extends bb{constructor(a,b){super(a,b);this.mouseused_=!1;this.on("mousedown",c=>this.handleMouseDown(c))}buildCSSClass(){return"vjs-big-play-button"}handleClick(a){const b=this.player_.play();
if(this.mouseused_&&a.clientX&&a.clientY)ub(b),this.player_.tech(!0)&&this.player_.tech(!0).focus();else{var c=(a=this.player_.getChild("controlBar"))&&a.getChild("playToggle");c?(a=()=>c.focus(),bd(b)?b.then(a,()=>{}):this.setTimeout(a,1)):this.player_.tech(!0).focus()}}handleKeyDown(a){this.mouseused_=!1;super.handleKeyDown(a)}handleMouseDown(a){this.mouseused_=!0}}rj.prototype.controlText_="Play Video";M.registerComponent("BigPlayButton",rj);class ro extends bb{constructor(a,b){super(a,b);this.controlText(b&&
b.controlText||this.localize("Close"))}buildCSSClass(){return`vjs-close-button ${super.buildCSSClass()}`}handleClick(a){this.trigger({type:"close",bubbles:!1})}handleKeyDown(a){Y.isEventKey(a,"Esc")?(a.preventDefault(),a.stopPropagation(),this.trigger("click")):super.handleKeyDown(a)}}M.registerComponent("CloseButton",ro);class sj extends bb{constructor(a,b={}){super(a,b);b.replay=void 0===b.replay||b.replay;this.on(a,"play",c=>this.handlePlay(c));this.on(a,"pause",c=>this.handlePause(c));if(b.replay)this.on(a,
"ended",c=>this.handleEnded(c))}buildCSSClass(){return`vjs-play-control ${super.buildCSSClass()}`}handleClick(a){this.player_.paused()?ub(this.player_.play()):this.player_.pause()}handleSeeked(a){this.removeClass("vjs-ended");this.player_.paused()?this.handlePause(a):this.handlePlay(a)}handlePlay(a){this.removeClass("vjs-ended","vjs-paused");this.addClass("vjs-playing");this.controlText("Pause")}handlePause(a){this.removeClass("vjs-playing");this.addClass("vjs-paused");this.controlText("Play")}handleEnded(a){this.removeClass("vjs-playing");
this.addClass("vjs-ended");this.controlText("Replay");this.one(this.player_,"seeked",b=>this.handleSeeked(b))}}sj.prototype.controlText_="Play";M.registerComponent("PlayToggle",sj);class Ic extends M{constructor(a,b){super(a,b);this.on(a,["timeupdate","ended"],c=>this.updateContent(c));this.updateTextNode_()}createEl(){const a=this.buildCSSClass(),b=super.createEl("div",{className:`${a} vjs-time-control vjs-control`}),c=aa("span",{className:"vjs-control-text",textContent:`${this.localize(this.labelText_)}\u00a0`},
{role:"presentation"});b.appendChild(c);this.contentEl_=aa("span",{className:`${a}-display`},{role:"presentation"});b.appendChild(this.contentEl_);return b}dispose(){this.textNode_=this.contentEl_=null;super.dispose()}updateTextNode_(a=0){a=Yb(a);this.formattedTime_!==a&&(this.formattedTime_=a,this.requestNamedAnimationFrame("TimeDisplay#updateTextNode_",()=>{if(this.contentEl_){var b=this.textNode_;b&&this.contentEl_.firstChild!==b&&(b=null,ca.warn("TimeDisplay#updateTextnode_: Prevented replacement of text node element since it was no longer a child of this node. Appending a new node instead."));
(this.textNode_=P.createTextNode(this.formattedTime_))&&(b?this.contentEl_.replaceChild(this.textNode_,b):this.contentEl_.appendChild(this.textNode_))}}))}updateContent(a){}}Ic.prototype.labelText_="Time";Ic.prototype.controlText_="Time";M.registerComponent("TimeDisplay",Ic);class dg extends Ic{buildCSSClass(){return"vjs-current-time"}updateContent(a){a=this.player_.ended()?this.player_.duration():this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();this.updateTextNode_(a)}}
dg.prototype.labelText_="Current Time";dg.prototype.controlText_="Current Time";M.registerComponent("CurrentTimeDisplay",dg);class eg extends Ic{constructor(a,b){super(a,b);b=c=>this.updateContent(c);this.on(a,"durationchange",b);this.on(a,"loadstart",b);this.on(a,"loadedmetadata",b)}buildCSSClass(){return"vjs-duration"}updateContent(a){a=this.player_.duration();this.updateTextNode_(a)}}eg.prototype.labelText_="Duration";eg.prototype.controlText_="Duration";M.registerComponent("DurationDisplay",eg);
class so extends M{createEl(){const a=super.createEl("div",{className:"vjs-time-control vjs-time-divider"},{"aria-hidden":!0}),b=super.createEl("div"),c=super.createEl("span",{textContent:"/"});b.appendChild(c);a.appendChild(b);return a}}M.registerComponent("TimeDivider",so);class fg extends Ic{constructor(a,b){super(a,b);this.on(a,"durationchange",c=>this.updateContent(c))}buildCSSClass(){return"vjs-remaining-time"}createEl(){const a=super.createEl();!1!==this.options_.displayNegative&&a.insertBefore(aa("span",
{},{"aria-hidden":!0},"-"),this.contentEl_);return a}updateContent(a){"number"===typeof this.player_.duration()&&(a=this.player_.ended()?0:this.player_.remainingTimeDisplay?this.player_.remainingTimeDisplay():this.player_.remainingTime(),this.updateTextNode_(a))}}fg.prototype.labelText_="Remaining Time";fg.prototype.controlText_="Remaining Time";M.registerComponent("RemainingTimeDisplay",fg);class to extends M{constructor(a,b){super(a,b);this.updateShowing();this.on(this.player(),"durationchange",
c=>this.updateShowing(c))}createEl(){const a=super.createEl("div",{className:"vjs-live-control vjs-control"});this.contentEl_=aa("div",{className:"vjs-live-display"},{"aria-live":"off"});this.contentEl_.appendChild(aa("span",{className:"vjs-control-text",textContent:`${this.localize("Stream Type")}\u00a0`}));this.contentEl_.appendChild(P.createTextNode(this.localize("LIVE")));a.appendChild(this.contentEl_);return a}dispose(){this.contentEl_=null;super.dispose()}updateShowing(a){Infinity===this.player().duration()?
this.show():this.hide()}}M.registerComponent("LiveDisplay",to);class tj extends bb{constructor(a,b){super(a,b);this.updateLiveEdgeStatus();this.player_.liveTracker&&(this.updateLiveEdgeStatusHandler_=c=>this.updateLiveEdgeStatus(c),this.on(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_))}createEl(){const a=super.createEl("button",{className:"vjs-seek-to-live-control vjs-control"});this.textEl_=aa("span",{className:"vjs-seek-to-live-text",textContent:this.localize("LIVE")},
{"aria-hidden":"true"});a.appendChild(this.textEl_);return a}updateLiveEdgeStatus(){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))}handleClick(){this.player_.liveTracker.seekToLiveEdge()}dispose(){this.player_.liveTracker&&
this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_);this.textEl_=null;super.dispose()}}tj.prototype.controlText_="Seek to live, currently playing live";M.registerComponent("SeekToLive",tj);var uo=Object.freeze({__proto__:null,clamp:ac});class gg extends M{constructor(a,b){super(a,b);this.handleMouseDown_=c=>this.handleMouseDown(c);this.handleMouseUp_=c=>this.handleMouseUp(c);this.handleKeyDown_=c=>this.handleKeyDown(c);this.handleClick_=c=>this.handleClick(c);this.handleMouseMove_=
c=>this.handleMouseMove(c);this.update_=c=>this.update(c);this.bar=this.getChild(this.options_.barName);this.vertical(!!this.options_.vertical);this.enable()}enabled(){return this.enabled_}enable(){if(!this.enabled()){this.on("mousedown",this.handleMouseDown_);this.on("touchstart",this.handleMouseDown_);this.on("keydown",this.handleKeyDown_);this.on("click",this.handleClick_);this.on(this.player_,"controlsvisible",this.update);if(this.playerEvent)this.on(this.player_,this.playerEvent,this.update);
this.removeClass("disabled");this.setAttribute("tabindex",0);this.enabled_=!0}}disable(){if(this.enabled()){var a=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown_);this.off("touchstart",this.handleMouseDown_);this.off("keydown",this.handleKeyDown_);this.off("click",this.handleClick_);this.off(this.player_,"controlsvisible",this.update_);this.off(a,"mousemove",this.handleMouseMove_);this.off(a,"mouseup",this.handleMouseUp_);this.off(a,"touchmove",this.handleMouseMove_);this.off(a,
"touchend",this.handleMouseUp_);this.removeAttribute("tabindex");this.addClass("disabled");this.playerEvent&&this.off(this.player_,this.playerEvent,this.update);this.enabled_=!1}}createEl(a,b={},c={}){b.className+=" vjs-slider";b=Object.assign({tabIndex:0},b);c=Object.assign({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100},c);return super.createEl(a,b,c)}handleMouseDown(a){const b=this.bar.el_.ownerDocument;"mousedown"===a.type&&a.preventDefault();"touchstart"!==a.type||xb||
a.preventDefault();Uh();this.addClass("vjs-sliding");this.trigger("slideractive");this.on(b,"mousemove",this.handleMouseMove_);this.on(b,"mouseup",this.handleMouseUp_);this.on(b,"touchmove",this.handleMouseMove_);this.on(b,"touchend",this.handleMouseUp_);this.handleMouseMove(a,!0)}handleMouseMove(a){}handleMouseUp(a){a=this.bar.el_.ownerDocument;Vh();this.removeClass("vjs-sliding");this.trigger("sliderinactive");this.off(a,"mousemove",this.handleMouseMove_);this.off(a,"mouseup",this.handleMouseUp_);
this.off(a,"touchmove",this.handleMouseMove_);this.off(a,"touchend",this.handleMouseUp_);this.update()}update(){if(this.el_&&this.bar){var a=this.getProgress();if(a===this.progress_)return a;this.progress_=a;this.requestNamedAnimationFrame("Slider#update",()=>{const b=this.vertical()?"height":"width";this.bar.el().style[b]=(100*a).toFixed(2)+"%"});return a}}getProgress(){return Number(ac(this.getPercent(),0,1).toFixed(4))}calculateDistance(a){a=Od(this.el_,a);return this.vertical()?a.y:a.x}handleKeyDown(a){Y.isEventKey(a,
"Left")||Y.isEventKey(a,"Down")?(a.preventDefault(),a.stopPropagation(),this.stepBack()):Y.isEventKey(a,"Right")||Y.isEventKey(a,"Up")?(a.preventDefault(),a.stopPropagation(),this.stepForward()):super.handleKeyDown(a)}handleClick(a){a.stopPropagation();a.preventDefault()}vertical(a){if(void 0===a)return this.vertical_||!1;(this.vertical_=!!a)?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")}}M.registerComponent("Slider",gg);class vo extends M{constructor(a,b){super(a,b);
this.partEls_=[];this.on(a,"progress",c=>this.update(c))}createEl(){const a=super.createEl("div",{className:"vjs-load-progress"}),b=aa("span",{className:"vjs-control-text"}),c=aa("span",{textContent:this.localize("Loaded")}),e=P.createTextNode(": ");this.percentageEl_=aa("span",{className:"vjs-control-text-loaded-percentage",textContent:"0%"});a.appendChild(b);b.appendChild(c);b.appendChild(e);b.appendChild(this.percentageEl_);return a}dispose(){this.percentageEl_=this.partEls_=null;super.dispose()}update(a){this.requestNamedAnimationFrame("LoadProgressBar#update",
()=>{var b=this.player_.liveTracker;const c=this.player_.buffered();var e=b&&b.isLive()?b.seekableEnd():this.player_.duration(),h=this.player_.bufferedEnd();b=this.partEls_;e=ac(h/e*100,0,100).toFixed(2)+"%";this.percent_!==e&&(this.el_.style.width=e,Pb(this.percentageEl_,e),this.percent_=e);for(e=0;e<c.length;e++){const m=c.start(e),p=c.end(e);let t=b[e];t||(t=this.el_.appendChild(aa()),b[e]=t);if(t.dataset.start!==m||t.dataset.end!==p)t.dataset.start=m,t.dataset.end=p,t.style.left=ac(m/h*100,0,
100).toFixed(2)+"%",t.style.width=ac((p-m)/h*100,0,100).toFixed(2)+"%"}for(h=b.length;h>c.length;h--)this.el_.removeChild(b[h-1]);b.length=c.length})}}M.registerComponent("LoadProgressBar",vo);class wo extends M{constructor(a,b){super(a,b);this.update=yb(ma(this,this.update),30)}createEl(){return super.createEl("div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})}update(a,b,c){const e=$c(this.el_);var h=wc(this.player_.el());const m=a.width*b;h&&e&&(b=a.left-h.left+m,a=a.width-m+(h.right-
a.right),h=e.width/2,b<h?h+=h-b:a<h&&(h=a),0>h?h=0:h>e.width&&(h=e.width),h=Math.round(h),this.el_.style.right=`-${h}px`,this.write(c))}write(a){Pb(this.el_,a)}updateTime(a,b,c,e){this.requestNamedAnimationFrame("TimeTooltip#updateTime",()=>{var h=this.player_.duration();if(this.player_.liveTracker&&this.player_.liveTracker.isLive()){h=this.player_.liveTracker.liveWindow();const m=h-b*h;h=(1>m?"":"-")+Yb(m,h)}else h=Yb(c,h);this.update(a,b,h);e&&e()})}}M.registerComponent("TimeTooltip",wo);class hg extends M{constructor(a,
b){super(a,b);this.update=yb(ma(this,this.update),30)}createEl(){return super.createEl("div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})}update(a,b){const c=this.getChild("timeTooltip");if(c){var e=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();c.updateTime(a,b,e)}}}hg.prototype.options_={children:[]};Na||wb||hg.prototype.options_.children.push("timeTooltip");M.registerComponent("PlayProgressBar",hg);class uj extends M{constructor(a,
b){super(a,b);this.update=yb(ma(this,this.update),30)}createEl(){return super.createEl("div",{className:"vjs-mouse-display"})}update(a,b){const c=b*this.player_.duration();this.getChild("timeTooltip").updateTime(a,b,c,()=>{this.el_.style.left=`${a.width*b}px`})}}uj.prototype.options_={children:["timeTooltip"]};M.registerComponent("MouseTimeDisplay",uj);class ig extends gg{constructor(a,b){super(a,b);this.setEventHandlers_()}setEventHandlers_(){this.update_=ma(this,this.update);this.update=yb(this.update_,
30);this.on(this.player_,["ended","durationchange","timeupdate"],this.update);if(this.player_.liveTracker)this.on(this.player_.liveTracker,"liveedgechange",this.update);this.updateInterval=null;this.enableIntervalHandler_=a=>this.enableInterval_(a);this.disableIntervalHandler_=a=>this.disableInterval_(a);this.on(this.player_,["playing"],this.enableIntervalHandler_);this.on(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_);if("hidden"in P&&"visibilityState"in P)this.on(P,"visibilitychange",
this.toggleVisibility_)}toggleVisibility_(a){"hidden"===P.visibilityState?(this.cancelNamedAnimationFrame("SeekBar#update"),this.cancelNamedAnimationFrame("Slider#update"),this.disableInterval_(a)):(this.player_.ended()||this.player_.paused()||this.enableInterval_(),this.update())}enableInterval_(){this.updateInterval||(this.updateInterval=this.setInterval(this.update,30))}disableInterval_(a){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&a&&"ended"!==a.type||!this.updateInterval||(this.clearInterval(this.updateInterval),
this.updateInterval=null)}createEl(){return super.createEl("div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})}update(a){if("hidden"!==P.visibilityState){var b=super.update();this.requestNamedAnimationFrame("SeekBar#update",()=>{const c=this.player_.ended()?this.player_.duration():this.getCurrentTime_(),e=this.player_.liveTracker;let h=this.player_.duration();e&&e.isLive()&&(h=this.player_.liveTracker.liveCurrentTime());this.percent_!==b&&(this.el_.setAttribute("aria-valuenow",
(100*b).toFixed(2)),this.percent_=b);if(this.currentTime_!==c||this.duration_!==h)this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime\x3d{1} duration\x3d{2}",[Yb(c,h),Yb(h,h)],"{1} of {2}")),this.currentTime_=c,this.duration_=h;this.bar&&this.bar.update(wc(this.el()),this.getProgress())});return b}}userSeek_(a){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&this.player_.liveTracker.nextSeekedFromUser();this.player_.currentTime(a)}getCurrentTime_(){return this.player_.scrubbing()?
this.player_.getCache().currentTime:this.player_.currentTime()}getPercent(){var a=this.getCurrentTime_();const b=this.player_.liveTracker;b&&b.isLive()?(a=(a-b.seekableStart())/b.liveWindow(),b.atLiveEdge()&&(a=1)):a/=this.player_.duration();return a}handleMouseDown(a){ad(a)&&(a.stopPropagation(),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),super.handleMouseDown(a))}handleMouseMove(a,b=!1){if(ad(a)){b||this.player_.scrubbing()||this.player_.scrubbing(!0);var c=this.calculateDistance(a);
var e=this.player_.liveTracker;if(e&&e.isLive()){if(.99<=c){e.seekToLiveEdge();return}a=e.seekableStart();b=e.liveCurrentTime();c=a+c*e.liveWindow();c>=b&&(c=b);c<=a&&(c=a+.1);if(Infinity===c)return}else c*=this.player_.duration(),c===this.player_.duration()&&(c-=.1);this.userSeek_(c)}}enable(){super.enable();const a=this.getChild("mouseTimeDisplay");a&&a.show()}disable(){super.disable();const a=this.getChild("mouseTimeDisplay");a&&a.hide()}handleMouseUp(a){super.handleMouseUp(a);a&&a.stopPropagation();
this.player_.scrubbing(!1);this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0});this.videoWasPlaying?ub(this.player_.play()):this.update_()}stepForward(){this.userSeek_(this.player_.currentTime()+5)}stepBack(){this.userSeek_(this.player_.currentTime()-5)}handleAction(a){this.player_.paused()?this.player_.play():this.player_.pause()}handleKeyDown(a){const b=this.player_.liveTracker;Y.isEventKey(a,"Space")||Y.isEventKey(a,"Enter")?(a.preventDefault(),a.stopPropagation(),this.handleAction(a)):
Y.isEventKey(a,"Home")?(a.preventDefault(),a.stopPropagation(),this.userSeek_(0)):Y.isEventKey(a,"End")?(a.preventDefault(),a.stopPropagation(),b&&b.isLive()?this.userSeek_(b.liveCurrentTime()):this.userSeek_(this.player_.duration())):/^[0-9]$/.test(Y(a))?(a.preventDefault(),a.stopPropagation(),a=10*(Y.codes[Y(a)]-Y.codes["0"])/100,b&&b.isLive()?this.userSeek_(b.seekableStart()+b.liveWindow()*a):this.userSeek_(this.player_.duration()*a)):Y.isEventKey(a,"PgDn")?(a.preventDefault(),a.stopPropagation(),
this.userSeek_(this.player_.currentTime()-60)):Y.isEventKey(a,"PgUp")?(a.preventDefault(),a.stopPropagation(),this.userSeek_(this.player_.currentTime()+60)):super.handleKeyDown(a)}dispose(){this.disableInterval_();this.off(this.player_,["ended","durationchange","timeupdate"],this.update);this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.update);this.off(this.player_,["playing"],this.enableIntervalHandler_);this.off(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_);
"hidden"in P&&"visibilityState"in P&&this.off(P,"visibilitychange",this.toggleVisibility_);super.dispose()}}ig.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"};Na||wb||ig.prototype.options_.children.splice(1,0,"mouseTimeDisplay");M.registerComponent("SeekBar",ig);class vj extends M{constructor(a,b){super(a,b);this.handleMouseMove=yb(ma(this,this.handleMouseMove),30);this.throttledHandleMouseSeek=yb(ma(this,this.handleMouseSeek),30);this.handleMouseUpHandler_=
c=>this.handleMouseUp(c);this.handleMouseDownHandler_=c=>this.handleMouseDown(c);this.enable()}createEl(){return super.createEl("div",{className:"vjs-progress-control vjs-control"})}handleMouseMove(a){const b=this.getChild("seekBar");if(b){var c=b.getChild("playProgressBar"),e=b.getChild("mouseTimeDisplay");if(c||e){var h=b.el(),m=$c(h);a=Od(h,a).x;a=ac(a,0,1);e&&e.update(m,a);c&&c.update(m,b.getProgress())}}}handleMouseSeek(a){const b=this.getChild("seekBar");b&&b.handleMouseMove(a)}enabled(){return this.enabled_}disable(){this.children().forEach(a=>
a.disable&&a.disable());if(this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDownHandler_),this.off(this.el_,"mousemove",this.handleMouseMove),this.removeListenersAddedOnMousedownAndTouchstart(),this.addClass("disabled"),this.enabled_=!1,this.player_.scrubbing())){const a=this.getChild("seekBar");this.player_.scrubbing(!1);a.videoWasPlaying&&ub(this.player_.play())}}enable(){this.children().forEach(a=>a.enable&&a.enable());this.enabled()||(this.on(["mousedown","touchstart"],this.handleMouseDownHandler_),
this.on(this.el_,"mousemove",this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)}removeListenersAddedOnMousedownAndTouchstart(){const a=this.el_.ownerDocument;this.off(a,"mousemove",this.throttledHandleMouseSeek);this.off(a,"touchmove",this.throttledHandleMouseSeek);this.off(a,"mouseup",this.handleMouseUpHandler_);this.off(a,"touchend",this.handleMouseUpHandler_)}handleMouseDown(a){const b=this.el_.ownerDocument,c=this.getChild("seekBar");c&&c.handleMouseDown(a);this.on(b,"mousemove",
this.throttledHandleMouseSeek);this.on(b,"touchmove",this.throttledHandleMouseSeek);this.on(b,"mouseup",this.handleMouseUpHandler_);this.on(b,"touchend",this.handleMouseUpHandler_)}handleMouseUp(a){const b=this.getChild("seekBar");b&&b.handleMouseUp(a);this.removeListenersAddedOnMousedownAndTouchstart()}}vj.prototype.options_={children:["seekBar"]};M.registerComponent("ProgressControl",vj);class wj extends bb{constructor(a,b){super(a,b);this.on(a,["enterpictureinpicture","leavepictureinpicture"],
c=>this.handlePictureInPictureChange(c));this.on(a,["disablepictureinpicturechanged","loadedmetadata"],c=>this.handlePictureInPictureEnabledChange(c));this.on(a,["loadedmetadata","audioonlymodechange","audiopostermodechange"],()=>{"audio"===a.currentType().substring(0,5)||a.audioPosterMode()||a.audioOnlyMode()?(a.isInPictureInPicture()&&a.exitPictureInPicture(),this.hide()):this.show()});this.disable()}buildCSSClass(){return`vjs-picture-in-picture-control ${super.buildCSSClass()}`}handlePictureInPictureEnabledChange(){P.pictureInPictureEnabled&&
!1===this.player_.disablePictureInPicture()||this.player_.options_.enableDocumentPictureInPicture&&"documentPictureInPicture"in D?this.enable():this.disable()}handlePictureInPictureChange(a){this.player_.isInPictureInPicture()?this.controlText("Exit Picture-in-Picture"):this.controlText("Picture-in-Picture");this.handlePictureInPictureEnabledChange()}handleClick(a){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()}}wj.prototype.controlText_=
"Picture-in-Picture";M.registerComponent("PictureInPictureToggle",wj);class xj extends bb{constructor(a,b){super(a,b);this.on(a,"fullscreenchange",c=>this.handleFullscreenChange(c));!1===P[a.fsApi_.fullscreenEnabled]&&this.disable()}buildCSSClass(){return`vjs-fullscreen-control ${super.buildCSSClass()}`}handleFullscreenChange(a){this.player_.isFullscreen()?this.controlText("Exit Fullscreen"):this.controlText("Fullscreen")}handleClick(a){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()}}
xj.prototype.controlText_="Fullscreen";M.registerComponent("FullscreenToggle",xj);const xo=function(a,b){b.tech_&&!b.tech_.featuresVolumeControl&&a.addClass("vjs-hidden");a.on(b,"loadstart",function(){b.tech_.featuresVolumeControl?a.removeClass("vjs-hidden"):a.addClass("vjs-hidden")})};class yo extends M{createEl(){const a=super.createEl("div",{className:"vjs-volume-level"});a.appendChild(super.createEl("span",{className:"vjs-control-text"}));return a}}M.registerComponent("VolumeLevel",yo);class zo extends M{constructor(a,
b){super(a,b);this.update=yb(ma(this,this.update),30)}createEl(){return super.createEl("div",{className:"vjs-volume-tooltip"},{"aria-hidden":"true"})}update(a,b,c,e){if(!c){c=wc(this.el_);var h=wc(this.player_.el());const m=a.width*b;if(!h||!c)return;b=a.left-h.left+m;a=a.width-m+(h.right-a.right);h=c.width/2;b<h?h+=h-b:a<h&&(h=a);0>h?h=0:h>c.width&&(h=c.width);this.el_.style.right=`-${h}px`}this.write(`${e}%`)}write(a){Pb(this.el_,a)}updateVolume(a,b,c,e,h){this.requestNamedAnimationFrame("VolumeLevelTooltip#updateVolume",
()=>{this.update(a,b,c,e.toFixed(0));h&&h()})}}M.registerComponent("VolumeLevelTooltip",zo);class yj extends M{constructor(a,b){super(a,b);this.update=yb(ma(this,this.update),30)}createEl(){return super.createEl("div",{className:"vjs-mouse-display"})}update(a,b,c){const e=100*b;this.getChild("volumeLevelTooltip").updateVolume(a,b,c,e,()=>{c?this.el_.style.bottom=`${a.height*b}px`:this.el_.style.left=`${a.width*b}px`})}}yj.prototype.options_={children:["volumeLevelTooltip"]};M.registerComponent("MouseVolumeLevelDisplay",
yj);class ne extends gg{constructor(a,b){super(a,b);this.on("slideractive",c=>this.updateLastVolume_(c));this.on(a,"volumechange",c=>this.updateARIAAttributes(c));a.ready(()=>this.updateARIAAttributes())}createEl(){return super.createEl("div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})}handleMouseDown(a){ad(a)&&super.handleMouseDown(a)}handleMouseMove(a){const b=this.getChild("mouseVolumeLevelDisplay");if(b){var c=this.el();const e=
wc(c),h=this.vertical();c=Od(c,a);c=h?c.y:c.x;c=ac(c,0,1);b.update(e,c,h)}ad(a)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(a)))}checkMuted(){this.player_.muted()&&this.player_.muted(!1)}getPercent(){return this.player_.muted()?0:this.player_.volume()}stepForward(){this.checkMuted();this.player_.volume(this.player_.volume()+.1)}stepBack(){this.checkMuted();this.player_.volume(this.player_.volume()-.1)}updateARIAAttributes(a){a=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",
a);this.el_.setAttribute("aria-valuetext",a+"%")}volumeAsPercentage_(){return Math.round(100*this.player_.volume())}updateLastVolume_(){const a=this.player_.volume();this.one("sliderinactive",()=>{0===this.player_.volume()&&this.player_.lastVolume_(a)})}}ne.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"};Na||wb||ne.prototype.options_.children.splice(0,0,"mouseVolumeLevelDisplay");ne.prototype.playerEvent="volumechange";M.registerComponent("VolumeBar",ne);class zj extends M{constructor(a,
b={}){b.vertical=b.vertical||!1;if("undefined"===typeof b.volumeBar||tc(b.volumeBar))b.volumeBar=b.volumeBar||{},b.volumeBar.vertical=b.vertical;super(a,b);xo(this,a);this.throttledHandleMouseMove=yb(ma(this,this.handleMouseMove),30);this.handleMouseUpHandler_=c=>this.handleMouseUp(c);this.on("mousedown",c=>this.handleMouseDown(c));this.on("touchstart",c=>this.handleMouseDown(c));this.on("mousemove",c=>this.handleMouseMove(c));this.on(this.volumeBar,["focus","slideractive"],()=>{this.volumeBar.addClass("vjs-slider-active");
this.addClass("vjs-slider-active");this.trigger("slideractive")});this.on(this.volumeBar,["blur","sliderinactive"],()=>{this.volumeBar.removeClass("vjs-slider-active");this.removeClass("vjs-slider-active");this.trigger("sliderinactive")})}createEl(){let a="vjs-volume-horizontal";this.options_.vertical&&(a="vjs-volume-vertical");return super.createEl("div",{className:`vjs-volume-control vjs-control ${a}`})}handleMouseDown(a){a=this.el_.ownerDocument;this.on(a,"mousemove",this.throttledHandleMouseMove);
this.on(a,"touchmove",this.throttledHandleMouseMove);this.on(a,"mouseup",this.handleMouseUpHandler_);this.on(a,"touchend",this.handleMouseUpHandler_)}handleMouseUp(a){a=this.el_.ownerDocument;this.off(a,"mousemove",this.throttledHandleMouseMove);this.off(a,"touchmove",this.throttledHandleMouseMove);this.off(a,"mouseup",this.handleMouseUpHandler_);this.off(a,"touchend",this.handleMouseUpHandler_)}handleMouseMove(a){this.volumeBar.handleMouseMove(a)}}zj.prototype.options_={children:["volumeBar"]};M.registerComponent("VolumeControl",
zj);const Ao=function(a,b){b.tech_&&!b.tech_.featuresMuteControl&&a.addClass("vjs-hidden");a.on(b,"loadstart",function(){b.tech_.featuresMuteControl?a.removeClass("vjs-hidden"):a.addClass("vjs-hidden")})};class Aj extends bb{constructor(a,b){super(a,b);Ao(this,a);this.on(a,["loadstart","volumechange"],c=>this.update(c))}buildCSSClass(){return`vjs-mute-control ${super.buildCSSClass()}`}handleClick(a){a=this.player_.volume();const b=this.player_.lastVolume_();0===a?(this.player_.volume(.1>b?.1:b),this.player_.muted(!1)):
this.player_.muted(this.player_.muted()?!1:!0)}update(a){this.updateIcon_();this.updateControlText_()}updateIcon_(){const a=this.player_.volume();let b=3;Na&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted);0===a||this.player_.muted()?b=0:.33>a?b=1:.67>a&&(b=2);Md(this.el_,[0,1,2,3].reduce((c,e)=>c+`${e?" ":""}vjs-vol-${e}`,""));Xb(this.el_,`vjs-vol-${b}`)}updateControlText_(){const a=this.player_.muted()||0===this.player_.volume()?"Unmute":"Mute";this.controlText()!==
a&&this.controlText(a)}}Aj.prototype.controlText_="Mute";M.registerComponent("MuteToggle",Aj);class Bj extends M{constructor(a,b={}){b.inline="undefined"!==typeof b.inline?b.inline:!0;if("undefined"===typeof b.volumeControl||tc(b.volumeControl))b.volumeControl=b.volumeControl||{},b.volumeControl.vertical=!b.inline;super(a,b);this.handleKeyPressHandler_=c=>this.handleKeyPress(c);this.on(a,["loadstart"],c=>this.volumePanelState_(c));this.on(this.muteToggle,"keyup",c=>this.handleKeyPress(c));this.on(this.volumeControl,
"keyup",c=>this.handleVolumeControlKeyUp(c));this.on("keydown",c=>this.handleKeyPress(c));this.on("mouseover",c=>this.handleMouseOver(c));this.on("mouseout",c=>this.handleMouseOut(c));this.on(this.volumeControl,["slideractive"],this.sliderActive_);this.on(this.volumeControl,["sliderinactive"],this.sliderInactive_)}sliderActive_(){this.addClass("vjs-slider-active")}sliderInactive_(){this.removeClass("vjs-slider-active")}volumePanelState_(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&
this.addClass("vjs-hidden");this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")}createEl(){let a="vjs-volume-panel-horizontal";this.options_.inline||(a="vjs-volume-panel-vertical");return super.createEl("div",{className:`vjs-volume-panel vjs-control ${a}`})}dispose(){this.handleMouseOut();super.dispose()}handleVolumeControlKeyUp(a){Y.isEventKey(a,"Esc")&&this.muteToggle.focus()}handleMouseOver(a){this.addClass("vjs-hover");$a(P,
"keyup",this.handleKeyPressHandler_)}handleMouseOut(a){this.removeClass("vjs-hover");Ha(P,"keyup",this.handleKeyPressHandler_)}handleKeyPress(a){Y.isEventKey(a,"Esc")&&this.handleMouseOut()}}Bj.prototype.options_={children:["muteToggle","volumeControl"]};M.registerComponent("VolumePanel",Bj);class Bo extends bb{constructor(a,b){super(a,b);this.validOptions=[5,10,30];(this.skipTime=this.getSkipForwardTime())&&this.validOptions.includes(this.skipTime)?(this.controlText(this.localize("Skip forward {1} seconds",
[this.skipTime])),this.show()):this.hide()}getSkipForwardTime(){const a=this.options_.playerOptions;return a.controlBar&&a.controlBar.skipButtons&&a.controlBar.skipButtons.forward}buildCSSClass(){return`vjs-skip-forward-${this.getSkipForwardTime()} ${super.buildCSSClass()}`}handleClick(a){a=this.player_.currentTime();var b=this.player_.liveTracker;b=b&&b.isLive()?b.seekableEnd():this.player_.duration();this.player_.currentTime(a+this.skipTime<=b?a+this.skipTime:b)}handleLanguagechange(){this.controlText(this.localize("Skip forward {1} seconds",
[this.skipTime]))}}M.registerComponent("SkipForward",Bo);class Cj extends bb{constructor(a,b){super(a,b);this.validOptions=[5,10,30];(this.skipTime=this.getSkipBackwardTime())&&this.validOptions.includes(this.skipTime)?(this.controlText(this.localize("Skip backward {1} seconds",[this.skipTime])),this.show()):this.hide()}getSkipBackwardTime(){const a=this.options_.playerOptions;return a.controlBar&&a.controlBar.skipButtons&&a.controlBar.skipButtons.backward}buildCSSClass(){return`vjs-skip-backward-${this.getSkipBackwardTime()} ${super.buildCSSClass()}`}handleClick(a){a=
this.player_.currentTime();var b=this.player_.liveTracker;b=b&&b.isLive()&&b.seekableStart();this.player_.currentTime(b&&a-this.skipTime<=b?b:a>=this.skipTime?a-this.skipTime:0)}handleLanguagechange(){this.controlText(this.localize("Skip backward {1} seconds",[this.skipTime]))}}Cj.prototype.controlText_="Skip Backward";M.registerComponent("SkipBackward",Cj);class Dj extends M{constructor(a,b){super(a,b);b&&(this.menuButton_=b.menuButton);this.focusedChild_=-1;this.on("keydown",c=>this.handleKeyDown(c));
this.boundHandleBlur_=c=>this.handleBlur(c);this.boundHandleTapClick_=c=>this.handleTapClick(c)}addEventListenerForItem(a){a instanceof M&&(this.on(a,"blur",this.boundHandleBlur_),this.on(a,["tap","click"],this.boundHandleTapClick_))}removeEventListenerForItem(a){a instanceof M&&(this.off(a,"blur",this.boundHandleBlur_),this.off(a,["tap","click"],this.boundHandleTapClick_))}removeChild(a){"string"===typeof a&&(a=this.getChild(a));this.removeEventListenerForItem(a);super.removeChild(a)}addItem(a){(a=
this.addChild(a))&&this.addEventListenerForItem(a)}createEl(){this.contentEl_=aa(this.options_.contentElType||"ul",{className:"vjs-menu-content"});this.contentEl_.setAttribute("role","menu");const a=super.createEl("div",{append:this.contentEl_,className:"vjs-menu"});a.appendChild(this.contentEl_);$a(a,"click",function(b){b.preventDefault();b.stopImmediatePropagation()});return a}dispose(){this.boundHandleTapClick_=this.boundHandleBlur_=this.contentEl_=null;super.dispose()}handleBlur(a){const b=a.relatedTarget||
P.activeElement;this.children().some(c=>c.el()===b)||(a=this.menuButton_)&&a.buttonPressed_&&b!==a.el().firstChild&&a.unpressButton()}handleTapClick(a){if(this.menuButton_){this.menuButton_.unpressButton();var b=this.children();Array.isArray(b)&&(b=b.filter(c=>c.el()===a.target)[0])&&"CaptionSettingsMenuItem"!==b.name()&&this.menuButton_.focus()}}handleKeyDown(a){if(Y.isEventKey(a,"Left")||Y.isEventKey(a,"Down"))a.preventDefault(),a.stopPropagation(),this.stepForward();else if(Y.isEventKey(a,"Right")||
Y.isEventKey(a,"Up"))a.preventDefault(),a.stopPropagation(),this.stepBack()}stepForward(){let a=0;void 0!==this.focusedChild_&&(a=this.focusedChild_+1);this.focus(a)}stepBack(){let a=0;void 0!==this.focusedChild_&&(a=this.focusedChild_-1);this.focus(a)}focus(a=0){const b=this.children().slice();b.length&&b[0].hasClass("vjs-menu-title")&&b.shift();0<b.length&&(0>a?a=0:a>=b.length&&(a=b.length-1),this.focusedChild_=a,b[a].el_.focus())}}M.registerComponent("Menu",Dj);class jg extends M{constructor(a,
b={}){super(a,b);this.menuButton_=new bb(a,b);this.menuButton_.controlText(this.controlText_);this.menuButton_.el_.setAttribute("aria-haspopup","true");a=bb.prototype.buildCSSClass();this.menuButton_.el_.className=this.buildCSSClass()+" "+a;this.menuButton_.removeClass("vjs-control");this.addChild(this.menuButton_);this.update();this.enabled_=!0;a=c=>this.handleClick(c);this.handleMenuKeyUp_=c=>this.handleMenuKeyUp(c);this.on(this.menuButton_,"tap",a);this.on(this.menuButton_,"click",a);this.on(this.menuButton_,
"keydown",c=>this.handleKeyDown(c));this.on(this.menuButton_,"mouseenter",()=>{this.addClass("vjs-hover");this.menu.show();$a(P,"keyup",this.handleMenuKeyUp_)});this.on("mouseleave",c=>this.handleMouseLeave(c));this.on("keydown",c=>this.handleSubmenuKeyDown(c))}update(){const a=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu));this.menu=a;this.addChild(a);this.buttonPressed_=!1;this.menuButton_.el_.setAttribute("aria-expanded","false");this.items&&this.items.length<=this.hideThreshold_?
(this.hide(),this.menu.contentEl_.removeAttribute("role")):(this.show(),this.menu.contentEl_.setAttribute("role","menu"))}createMenu(){const a=new Dj(this.player_,{menuButton:this});this.hideThreshold_=0;if(this.options_.title){var b=aa("li",{className:"vjs-menu-title",textContent:sa(this.options_.title),tabIndex:-1});b=new M(this.player_,{el:b});a.addItem(b)}if(this.items=this.createItems())for(b=0;b<this.items.length;b++)a.addItem(this.items[b]);return a}createItems(){}createEl(){return super.createEl("div",
{className:this.buildWrapperCSSClass()},{})}buildWrapperCSSClass(){let a="vjs-menu-button";a=!0===this.options_.inline?a+"-inline":a+"-popup";const b=bb.prototype.buildCSSClass();return`vjs-menu-button ${a} ${b} ${super.buildCSSClass()}`}buildCSSClass(){let a="vjs-menu-button";a=!0===this.options_.inline?a+"-inline":a+"-popup";return`vjs-menu-button ${a} ${super.buildCSSClass()}`}controlText(a,b=this.menuButton_.el()){return this.menuButton_.controlText(a,b)}dispose(){this.handleMouseLeave();super.dispose()}handleClick(a){this.buttonPressed_?
this.unpressButton():this.pressButton()}handleMouseLeave(a){this.removeClass("vjs-hover");Ha(P,"keyup",this.handleMenuKeyUp_)}focus(){this.menuButton_.focus()}blur(){this.menuButton_.blur()}handleKeyDown(a){Y.isEventKey(a,"Esc")||Y.isEventKey(a,"Tab")?(this.buttonPressed_&&this.unpressButton(),Y.isEventKey(a,"Tab")||(a.preventDefault(),this.menuButton_.focus())):!Y.isEventKey(a,"Up")&&!Y.isEventKey(a,"Down")||this.buttonPressed_||(a.preventDefault(),this.pressButton())}handleMenuKeyUp(a){(Y.isEventKey(a,
"Esc")||Y.isEventKey(a,"Tab"))&&this.removeClass("vjs-hover")}handleSubmenuKeyPress(a){this.handleSubmenuKeyDown(a)}handleSubmenuKeyDown(a){if(Y.isEventKey(a,"Esc")||Y.isEventKey(a,"Tab"))this.buttonPressed_&&this.unpressButton(),Y.isEventKey(a,"Tab")||(a.preventDefault(),this.menuButton_.focus())}pressButton(){this.enabled_&&(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),Na&&Qh()||this.menu.focus())}unpressButton(){this.enabled_&&
(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))}disable(){this.unpressButton();this.enabled_=!1;this.addClass("vjs-disabled");this.menuButton_.disable()}enable(){this.enabled_=!0;this.removeClass("vjs-disabled");this.menuButton_.enable()}}M.registerComponent("MenuButton",jg);class kg extends jg{constructor(a,b){const c=b.tracks;super(a,b);1>=this.items.length&&this.hide();if(c){var e=ma(this,this.update);c.addEventListener("removetrack",
e);c.addEventListener("addtrack",e);c.addEventListener("labelchange",e);this.player_.on("ready",e);this.player_.on("dispose",function(){c.removeEventListener("removetrack",e);c.removeEventListener("addtrack",e);c.removeEventListener("labelchange",e)})}}}M.registerComponent("TrackButton",kg);const Co="Tab Esc Up Down Right Left".split(" ");class kd extends me{constructor(a,b){super(a,b);this.selectable=b.selectable;this.isSelected_=b.selected||!1;this.multiSelectable=b.multiSelectable;this.selected(this.isSelected_);
this.selectable?this.multiSelectable?this.el_.setAttribute("role","menuitemcheckbox"):this.el_.setAttribute("role","menuitemradio"):this.el_.setAttribute("role","menuitem")}createEl(a,b,c){this.nonIconControl=!0;a=super.createEl("li",Object.assign({className:"vjs-menu-item",tabIndex:-1},b),c);a.replaceChild(aa("span",{className:"vjs-menu-item-text",textContent:this.localize(this.options_.label)}),a.querySelector(".vjs-icon-placeholder"));return a}handleKeyDown(a){Co.some(b=>Y.isEventKey(a,b))||super.handleKeyDown(a)}handleClick(a){this.selected(!0)}selected(a){this.selectable&&
(a?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))}}M.registerComponent("MenuItem",kd);class ld extends kd{constructor(a,b){const c=b.track,e=a.textTracks();b.label=c.label||c.language||"Unknown";b.selected="showing"===c.mode;super(a,b);this.track=c;this.kinds=(b.kinds||[b.kind||this.track.kind]).filter(Boolean);
const h=(...p)=>{this.handleTracksChange.apply(this,p)},m=(...p)=>{this.handleSelectedLanguageChange.apply(this,p)};a.on(["loadstart","texttrackchange"],h);e.addEventListener("change",h);e.addEventListener("selectedlanguagechange",m);this.on("dispose",function(){a.off(["loadstart","texttrackchange"],h);e.removeEventListener("change",h);e.removeEventListener("selectedlanguagechange",m)});if(void 0===e.onchange){let p;this.on(["tap","click"],function(){if("object"!==typeof D.Event)try{p=new D.Event("change")}catch(t){}p||
(p=P.createEvent("Event"),p.initEvent("change",!0,!0));e.dispatchEvent(p)})}this.handleTracksChange()}handleClick(a){const b=this.track,c=this.player_.textTracks();super.handleClick(a);if(c)for(a=0;a<c.length;a++){const e=c[a];-1!==this.kinds.indexOf(e.kind)&&(e===b?"showing"!==e.mode&&(e.mode="showing"):"disabled"!==e.mode&&(e.mode="disabled"))}}handleTracksChange(a){a="showing"===this.track.mode;a!==this.isSelected_&&this.selected(a)}handleSelectedLanguageChange(a){"showing"===this.track.mode&&
(a=this.player_.cache_.selectedLanguage,a&&a.enabled&&a.language===this.track.language&&a.kind!==this.track.kind||(this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}))}dispose(){this.track=null;super.dispose()}}M.registerComponent("TextTrackMenuItem",ld);class Ej extends ld{constructor(a,b){b.track={player:a,kind:b.kind,kinds:b.kinds,default:!1,mode:"disabled"};b.kinds||(b.kinds=[b.kind]);b.track.label=b.label?b.label:b.kinds.join(" and ")+" off";b.selectable=
!0;b.multiSelectable=!1;super(a,b)}handleTracksChange(a){a=this.player().textTracks();let b=!0;for(let c=0,e=a.length;c<e;c++){const h=a[c];if(-1<this.options_.kinds.indexOf(h.kind)&&"showing"===h.mode){b=!1;break}}b!==this.isSelected_&&this.selected(b)}handleSelectedLanguageChange(a){a=this.player().textTracks();let b=!0;for(let c=0,e=a.length;c<e;c++){const h=a[c];if(-1<["captions","descriptions","subtitles"].indexOf(h.kind)&&"showing"===h.mode){b=!1;break}}b&&(this.player_.cache_.selectedLanguage=
{enabled:!1})}handleLanguagechange(){this.$(".vjs-menu-item-text").textContent=this.player_.localize(this.options_.label);super.handleLanguagechange()}}M.registerComponent("OffTextTrackMenuItem",Ej);class Jc extends kg{constructor(a,b={}){b.tracks=a.textTracks();super(a,b)}createItems(a=[],b=ld){var c;this.label_&&(c=`${this.label_} off`);a.push(new Ej(this.player_,{kinds:this.kinds_,kind:this.kind_,label:c}));this.hideThreshold_+=1;c=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=
[this.kind_]);for(let e=0;e<c.length;e++){const h=c[e];if(-1<this.kinds_.indexOf(h.kind)){const m=new b(this.player_,{track:h,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1});m.addClass(`vjs-${h.kind}-menu-item`);a.push(m)}}return a}}M.registerComponent("TextTrackButton",Jc);class Fj extends kd{constructor(a,b){const c=b.track,e=b.cue,h=a.currentTime();b.selectable=!0;b.multiSelectable=!1;b.label=e.text;b.selected=e.startTime<=h&&h<e.endTime;super(a,b);this.track=c;this.cue=e}handleClick(a){super.handleClick();
this.player_.currentTime(this.cue.startTime)}}M.registerComponent("ChaptersTrackMenuItem",Fj);class lg extends Jc{constructor(a,b,c){super(a,b,c);this.selectCurrentItem_=()=>{this.items.forEach(e=>{e.selected(this.track_.activeCues[0]===e.cue)})}}buildCSSClass(){return`vjs-chapters-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-chapters-button ${super.buildWrapperCSSClass()}`}update(a){a&&a.track&&"chapters"!==a.track.kind||(a=this.findChaptersTrack(),a!==this.track_?(this.setTrack(a),
super.update()):(!this.items||a&&a.cues&&a.cues.length!==this.items.length)&&super.update())}setTrack(a){if(this.track_!==a){this.updateHandler_||(this.updateHandler_=this.update.bind(this));if(this.track_){const b=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);b&&b.removeEventListener("load",this.updateHandler_);this.track_.removeEventListener("cuechange",this.selectCurrentItem_);this.track_=null}if(this.track_=a)this.track_.mode="hidden",(a=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_))&&
a.addEventListener("load",this.updateHandler_),this.track_.addEventListener("cuechange",this.selectCurrentItem_)}}findChaptersTrack(){const a=this.player_.textTracks()||[];for(let b=a.length-1;0<=b;b--){const c=a[b];if(c.kind===this.kind_)return c}}getMenuCaption(){return this.track_&&this.track_.label?this.track_.label:this.localize(sa(this.kind_))}createMenu(){this.options_.title=this.getMenuCaption();return super.createMenu()}createItems(){const a=[];if(!this.track_)return a;const b=this.track_.cues;
if(!b)return a;for(let c=0,e=b.length;c<e;c++){const h=new Fj(this.player_,{track:this.track_,cue:b[c]});a.push(h)}return a}}lg.prototype.kind_="chapters";lg.prototype.controlText_="Chapters";M.registerComponent("ChaptersButton",lg);class mg extends Jc{constructor(a,b,c){super(a,b,c);const e=a.textTracks(),h=ma(this,this.handleTracksChange);e.addEventListener("change",h);this.on("dispose",function(){e.removeEventListener("change",h)})}handleTracksChange(a){a=this.player().textTracks();let b=!1;for(let c=
0,e=a.length;c<e;c++){const h=a[c];if(h.kind!==this.kind_&&"showing"===h.mode){b=!0;break}}b?this.disable():this.enable()}buildCSSClass(){return`vjs-descriptions-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-descriptions-button ${super.buildWrapperCSSClass()}`}}mg.prototype.kind_="descriptions";mg.prototype.controlText_="Descriptions";M.registerComponent("DescriptionsButton",mg);class ng extends Jc{constructor(a,b,c){super(a,b,c)}buildCSSClass(){return`vjs-subtitles-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-subtitles-button ${super.buildWrapperCSSClass()}`}}
ng.prototype.kind_="subtitles";ng.prototype.controlText_="Subtitles";M.registerComponent("SubtitlesButton",ng);class og extends ld{constructor(a,b){b.track={player:a,kind:b.kind,label:b.kind+" settings",selectable:!1,default:!1,mode:"disabled"};b.selectable=!1;b.name="CaptionSettingsMenuItem";super(a,b);this.addClass("vjs-texttrack-settings");this.controlText(", opens "+b.kind+" settings dialog")}handleClick(a){this.player().getChild("textTrackSettings").open()}handleLanguagechange(){this.$(".vjs-menu-item-text").textContent=
this.player_.localize(this.options_.kind+" settings");super.handleLanguagechange()}}M.registerComponent("CaptionSettingsMenuItem",og);class pg extends Jc{constructor(a,b,c){super(a,b,c)}buildCSSClass(){return`vjs-captions-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-captions-button ${super.buildWrapperCSSClass()}`}createItems(){const a=[];this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(a.push(new og(this.player_,
{kind:this.kind_})),this.hideThreshold_+=1);return super.createItems(a)}}pg.prototype.kind_="captions";pg.prototype.controlText_="Captions";M.registerComponent("CaptionsButton",pg);class Gj extends ld{createEl(a,b,c){a=super.createEl(a,b,c);b=a.querySelector(".vjs-menu-item-text");"captions"===this.options_.track.kind&&(b.appendChild(aa("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),b.appendChild(aa("span",{className:"vjs-control-text",textContent:` ${this.localize("Captions")}`})));
return a}}M.registerComponent("SubsCapsMenuItem",Gj);class qg extends Jc{constructor(a,b={}){super(a,b);this.label_="subtitles";-1<["en","en-us","en-ca","fr-ca"].indexOf(this.player_.language_)&&(this.label_="captions");this.menuButton_.controlText(sa(this.label_))}buildCSSClass(){return`vjs-subs-caps-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-subs-caps-button ${super.buildWrapperCSSClass()}`}createItems(){let a=[];this.player().tech_&&this.player().tech_.featuresNativeTextTracks||
!this.player().getChild("textTrackSettings")||(a.push(new og(this.player_,{kind:this.label_})),this.hideThreshold_+=1);return a=super.createItems(a,Gj)}}qg.prototype.kinds_=["captions","subtitles"];qg.prototype.controlText_="Subtitles";M.registerComponent("SubsCapsButton",qg);class Hj extends kd{constructor(a,b){const c=b.track,e=a.audioTracks();b.label=c.label||c.language||"Unknown";b.selected=c.enabled;super(a,b);this.track=c;this.addClass(`vjs-${c.kind}-menu-item`);const h=(...m)=>{this.handleTracksChange.apply(this,
m)};e.addEventListener("change",h);this.on("dispose",()=>{e.removeEventListener("change",h)})}createEl(a,b,c){a=super.createEl(a,b,c);b=a.querySelector(".vjs-menu-item-text");"main-desc"===this.options_.track.kind&&(b.appendChild(aa("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),b.appendChild(aa("span",{className:"vjs-control-text",textContent:" "+this.localize("Descriptions")})));return a}handleClick(a){super.handleClick(a);this.track.enabled=!0;if(this.player_.tech_.featuresNativeAudioTracks){a=
this.player_.audioTracks();for(let b=0;b<a.length;b++){const c=a[b];c!==this.track&&(c.enabled=c===this.track)}}}handleTracksChange(a){this.selected(this.track.enabled)}}M.registerComponent("AudioTrackMenuItem",Hj);class Ij extends kg{constructor(a,b={}){b.tracks=a.audioTracks();super(a,b)}buildCSSClass(){return`vjs-audio-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-audio-button ${super.buildWrapperCSSClass()}`}createItems(a=[]){this.hideThreshold_=1;const b=this.player_.audioTracks();
for(let c=0;c<b.length;c++)a.push(new Hj(this.player_,{track:b[c],selectable:!0,multiSelectable:!1}));return a}}Ij.prototype.controlText_="Audio Track";M.registerComponent("AudioTrackButton",Ij);class rg extends kd{constructor(a,b){const c=b.rate,e=parseFloat(c,10);b.label=c;b.selected=e===a.playbackRate();b.selectable=!0;b.multiSelectable=!1;super(a,b);this.label=c;this.rate=e;this.on(a,"ratechange",h=>this.update(h))}handleClick(a){super.handleClick();this.player().playbackRate(this.rate)}update(a){this.selected(this.player().playbackRate()===
this.rate)}}rg.prototype.contentElType="button";M.registerComponent("PlaybackRateMenuItem",rg);class Jj extends jg{constructor(a,b){super(a,b);this.menuButton_.el_.setAttribute("aria-describedby",this.labelElId_);this.updateVisibility();this.updateLabel();this.on(a,"loadstart",c=>this.updateVisibility(c));this.on(a,"ratechange",c=>this.updateLabel(c));this.on(a,"playbackrateschange",c=>this.handlePlaybackRateschange(c))}createEl(){const a=super.createEl();this.labelElId_="vjs-playback-rate-value-label-"+
this.id_;this.labelEl_=aa("div",{className:"vjs-playback-rate-value",id:this.labelElId_,textContent:"1x"});a.appendChild(this.labelEl_);return a}dispose(){this.labelEl_=null;super.dispose()}buildCSSClass(){return`vjs-playback-rate ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-playback-rate ${super.buildWrapperCSSClass()}`}createItems(){const a=this.playbackRates(),b=[];for(let c=a.length-1;0<=c;c--)b.push(new rg(this.player(),{rate:a[c]+"x"}));return b}handlePlaybackRateschange(a){this.update()}playbackRates(){const a=
this.player();return a.playbackRates&&a.playbackRates()||[]}playbackRateSupported(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&0<this.playbackRates().length}updateVisibility(a){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")}updateLabel(a){this.playbackRateSupported()&&(this.labelEl_.textContent=this.player().playbackRate()+"x")}}Jj.prototype.controlText_="Playback Rate";M.registerComponent("PlaybackRateMenuButton",
Jj);class Kj extends M{buildCSSClass(){return`vjs-spacer ${super.buildCSSClass()}`}createEl(a="div",b={},c={}){b.className||(b.className=this.buildCSSClass());return super.createEl(a,b,c)}}M.registerComponent("Spacer",Kj);class Do extends Kj{buildCSSClass(){return`vjs-custom-control-spacer ${super.buildCSSClass()}`}createEl(){return super.createEl("div",{className:this.buildCSSClass(),textContent:"\u00a0"})}}M.registerComponent("CustomControlSpacer",Do);class oe extends M{createEl(){return super.createEl("div",
{className:"vjs-control-bar",dir:"ltr"})}}oe.prototype.options_={children:"playToggle skipBackward skipForward volumePanel currentTimeDisplay timeDivider durationDisplay progressControl liveDisplay seekToLive remainingTimeDisplay customControlSpacer playbackRateMenuButton chaptersButton descriptionsButton subsCapsButton audioTrackButton fullscreenToggle".split(" ")};"exitPictureInPicture"in P&&oe.prototype.options_.children.splice(oe.prototype.options_.children.length-1,0,"pictureInPictureToggle");
M.registerComponent("ControlBar",oe);class Lj extends Fc{constructor(a,b){super(a,b);this.on(a,"error",c=>this.open(c))}buildCSSClass(){return`vjs-error-display ${super.buildCSSClass()}`}content(){const a=this.player().error();return a?this.localize(a.message):""}}Lj.prototype.options_=Object.assign({},Fc.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0});M.registerComponent("ErrorDisplay",Lj);const Mj=["#000","Black"],Nj=["#00F","Blue"],Oj=["#0FF","Cyan"],Pj=["#0F0","Green"],
Qj=["#F0F","Magenta"],Rj=["#F00","Red"],Sj=["#FFF","White"],Tj=["#FF0","Yellow"],sg=["1","Opaque"],tg=["0.5","Semi-Transparent"],Uj=["0","Transparent"],fc={backgroundColor:{selector:".vjs-bg-color \x3e select",id:"captions-background-color-%s",label:"Color",options:[Mj,Sj,Rj,Pj,Nj,Tj,Qj,Oj]},backgroundOpacity:{selector:".vjs-bg-opacity \x3e select",id:"captions-background-opacity-%s",label:"Opacity",options:[sg,tg,Uj]},color:{selector:".vjs-text-color \x3e select",id:"captions-foreground-color-%s",
label:"Color",options:[Sj,Mj,Rj,Pj,Nj,Tj,Qj,Oj]},edgeStyle:{selector:".vjs-edge-style \x3e select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family \x3e select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],
["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent \x3e select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:a=>"1.00"===a?null:Number(a)},textOpacity:{selector:".vjs-text-opacity \x3e select",id:"captions-foreground-opacity-%s",label:"Opacity",
options:[sg,tg]},windowColor:{selector:".vjs-window-color \x3e select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity \x3e select",id:"captions-window-opacity-%s",label:"Opacity",options:[Uj,tg,sg]}};fc.windowColor.options=fc.backgroundColor.options;class Eo extends Fc{constructor(a,b){b.temporary=!1;super(a,b);this.updateDisplay=this.updateDisplay.bind(this);this.fill();this.hasBeenOpened_=this.hasBeenFilled_=!0;this.endDialog=aa("p",{className:"vjs-control-text",
textContent:this.localize("End of dialog window.")});this.el().appendChild(this.endDialog);this.setDefaults();void 0===b.persistTextTrackSettings&&(this.options_.persistTextTrackSettings=this.options_.playerOptions.persistTextTrackSettings);this.on(this.$(".vjs-done-button"),"click",()=>{this.saveSettings();this.close()});this.on(this.$(".vjs-default-button"),"click",()=>{this.setDefaults();this.updateDisplay()});sc(fc,c=>{this.on(this.$(c.selector),"change",this.updateDisplay)});this.options_.persistTextTrackSettings&&
this.restoreSettings()}dispose(){this.endDialog=null;super.dispose()}createElSelect_(a,b="",c="label"){a=fc[a];const e=a.id.replace("%s",this.id_),h=[b,e].join(" ").trim();return[`<${c} id="${e}" class="${"label"===c?"vjs-label":""}">`,this.localize(a.label),`</${c}>`,`<select aria-labelledby="${h}">`].concat(a.options.map(m=>{const p=e+"-"+m[1].replace(/\W+/g,"");return[`<option id="${p}" value="${m[0]}" `,`aria-labelledby="${h} ${p}">`,this.localize(m[1]),"\x3c/option\x3e"].join("")})).concat("\x3c/select\x3e").join("")}createElFgColor_(){const a=
`captions-text-legend-${this.id_}`;return['\x3cfieldset class\x3d"vjs-fg vjs-track-setting"\x3e',`<legend id="${a}">`,this.localize("Text"),'\x3c/legend\x3e\x3cspan class\x3d"vjs-text-color"\x3e',this.createElSelect_("color",a),'\x3c/span\x3e\x3cspan class\x3d"vjs-text-opacity vjs-opacity"\x3e',this.createElSelect_("textOpacity",a),"\x3c/span\x3e\x3c/fieldset\x3e"].join("")}createElBgColor_(){const a=`captions-background-${this.id_}`;return['\x3cfieldset class\x3d"vjs-bg vjs-track-setting"\x3e',`<legend id="${a}">`,
this.localize("Text Background"),'\x3c/legend\x3e\x3cspan class\x3d"vjs-bg-color"\x3e',this.createElSelect_("backgroundColor",a),'\x3c/span\x3e\x3cspan class\x3d"vjs-bg-opacity vjs-opacity"\x3e',this.createElSelect_("backgroundOpacity",a),"\x3c/span\x3e\x3c/fieldset\x3e"].join("")}createElWinColor_(){const a=`captions-window-${this.id_}`;return['\x3cfieldset class\x3d"vjs-window vjs-track-setting"\x3e',`<legend id="${a}">`,this.localize("Caption Area Background"),'\x3c/legend\x3e\x3cspan class\x3d"vjs-window-color"\x3e',
this.createElSelect_("windowColor",a),'\x3c/span\x3e\x3cspan class\x3d"vjs-window-opacity vjs-opacity"\x3e',this.createElSelect_("windowOpacity",a),"\x3c/span\x3e\x3c/fieldset\x3e"].join("")}createElColors_(){return aa("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})}createElFont_(){return aa("div",{className:"vjs-track-settings-font",innerHTML:['\x3cfieldset class\x3d"vjs-font-percent vjs-track-setting"\x3e',
this.createElSelect_("fontPercent","","legend"),'\x3c/fieldset\x3e\x3cfieldset class\x3d"vjs-edge-style vjs-track-setting"\x3e',this.createElSelect_("edgeStyle","","legend"),'\x3c/fieldset\x3e\x3cfieldset class\x3d"vjs-font-family vjs-track-setting"\x3e',this.createElSelect_("fontFamily","","legend"),"\x3c/fieldset\x3e"].join("")})}createElControls_(){const a=this.localize("restore all settings to the default values");return aa("div",{className:"vjs-track-settings-controls",innerHTML:[`<button type="button" class="vjs-default-button" title="${a}">`,
this.localize("Reset"),`<span class="vjs-control-text"> ${a}</span>`,"\x3c/button\x3e",`<button type="button" class="vjs-done-button">${this.localize("Done")}</button>`].join("")})}content(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]}label(){return this.localize("Caption Settings Dialog")}description(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")}buildCSSClass(){return super.buildCSSClass()+" vjs-text-track-settings"}getValues(){return Ph(fc,
(a,b,c)=>{var e=this.$(b.selector);b=ii(e.options[e.options.selectedIndex].value,b.parser);void 0!==b&&(a[c]=b);return a},{})}setValues(a){sc(fc,(b,c)=>{var e=this.$(b.selector);c=a[c];b=b.parser;if(c)for(let h=0;h<e.options.length;h++)if(ii(e.options[h].value,b)===c){e.selectedIndex=h;break}})}setDefaults(){sc(fc,a=>{const b=a.hasOwnProperty("default")?a.default:0;this.$(a.selector).selectedIndex=b})}restoreSettings(){let a;try{a=JSON.parse(D.localStorage.getItem("vjs-text-track-settings"))}catch(b){ca.warn(b)}a&&
this.setValues(a)}saveSettings(){if(this.options_.persistTextTrackSettings){var a=this.getValues();try{Object.keys(a).length?D.localStorage.setItem("vjs-text-track-settings",JSON.stringify(a)):D.localStorage.removeItem("vjs-text-track-settings")}catch(b){ca.warn(b)}}}updateDisplay(){const a=this.player_.getChild("textTrackDisplay");a&&a.updateDisplay()}conditionalBlur_(){this.previouslyActiveEl_=null;var a=this.player_.controlBar;const b=a&&a.subsCapsButton;a=a&&a.captionsButton;b?b.focus():a&&a.focus()}handleLanguagechange(){this.fill()}}
M.registerComponent("TextTrackSettings",Eo);class Fo extends M{constructor(a,b){let c=b.ResizeObserver||D.ResizeObserver;null===b.ResizeObserver&&(c=!1);const e=ka({createEl:!c,reportTouchActivity:!1},b);super(a,e);this.ResizeObserver=b.ResizeObserver||D.ResizeObserver;this.resizeObserver_=this.loadListener_=null;this.debouncedHandler_=dj(()=>{this.resizeHandler()},100,!1,this);c?(this.resizeObserver_=new this.ResizeObserver(this.debouncedHandler_),this.resizeObserver_.observe(a.el())):(this.loadListener_=
()=>{if(this.el_&&this.el_.contentWindow){var h=this.debouncedHandler_,m=this.unloadListener_=function(){Ha(this,"resize",h);Ha(this,"unload",m);m=null};$a(this.el_.contentWindow,"unload",m);$a(this.el_.contentWindow,"resize",h)}},this.one("load",this.loadListener_))}createEl(){return super.createEl("iframe",{className:"vjs-resize-manager",tabIndex:-1,title:this.localize("No content")},{"aria-hidden":"true"})}resizeHandler(){this.player_&&this.player_.trigger&&this.player_.trigger("playerresize")}dispose(){this.debouncedHandler_&&
this.debouncedHandler_.cancel();this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect());this.loadListener_&&this.off("load",this.loadListener_);this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow);this.loadListener_=this.debouncedHandler_=this.resizeObserver=this.ResizeObserver=null;super.dispose()}}M.registerComponent("ResizeManager",Fo);const Go={trackingThreshold:20,liveTolerance:15};
class Ho extends M{constructor(a,b){b=ka(Go,b,{createEl:!1});super(a,b);this.trackLiveHandler_=()=>this.trackLive_();this.handlePlay_=c=>this.handlePlay(c);this.handleFirstTimeupdate_=c=>this.handleFirstTimeupdate(c);this.handleSeeked_=c=>this.handleSeeked(c);this.seekToLiveEdge_=c=>this.seekToLiveEdge(c);this.reset_();this.on(this.player_,"durationchange",c=>this.handleDurationchange(c));this.on(this.player_,"canplay",()=>this.toggleTracking())}trackLive_(){var a=this.player_.seekable();if(a&&a.length){a=
Number(D.performance.now().toFixed(4));var b=-1===this.lastTime_?0:(a-this.lastTime_)/1E3;this.lastTime_=a;this.pastSeekEnd_=this.pastSeekEnd()+b;a=this.liveCurrentTime();b=this.player_.currentTime();b=this.player_.paused()||this.seekedBehindLive_||Math.abs(a-b)>this.options_.liveTolerance;this.timeupdateSeen_&&Infinity!==a||(b=!1);b!==this.behindLiveEdge_&&(this.behindLiveEdge_=b,this.trigger("liveedgechange"))}}handleDurationchange(){this.toggleTracking()}toggleTracking(){Infinity===this.player_.duration()&&
this.liveWindow()>=this.options_.trackingThreshold?(this.player_.options_.liveui&&this.player_.addClass("vjs-liveui"),this.startTracking()):(this.player_.removeClass("vjs-liveui"),this.stopTracking())}startTracking(){if(!this.isTracking())if(this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted()),this.trackingInterval_=this.setInterval(this.trackLiveHandler_,30),this.trackLive_(),this.on(this.player_,["play","pause"],this.trackLiveHandler_),this.timeupdateSeen_)this.on(this.player_,
"seeked",this.handleSeeked_);else this.one(this.player_,"play",this.handlePlay_),this.one(this.player_,"timeupdate",this.handleFirstTimeupdate_)}handleFirstTimeupdate(){this.timeupdateSeen_=!0;this.on(this.player_,"seeked",this.handleSeeked_)}handleSeeked(){const a=Math.abs(this.liveCurrentTime()-this.player_.currentTime());this.seekedBehindLive_=this.nextSeekedFromUser_&&2<a;this.nextSeekedFromUser_=!1;this.trackLive_()}handlePlay(){this.one(this.player_,"timeupdate",this.seekToLiveEdge_)}reset_(){this.lastTime_=
-1;this.pastSeekEnd_=0;this.lastSeekEnd_=-1;this.behindLiveEdge_=!0;this.nextSeekedFromUser_=this.seekedBehindLive_=this.timeupdateSeen_=!1;this.clearInterval(this.trackingInterval_);this.trackingInterval_=null;this.off(this.player_,["play","pause"],this.trackLiveHandler_);this.off(this.player_,"seeked",this.handleSeeked_);this.off(this.player_,"play",this.handlePlay_);this.off(this.player_,"timeupdate",this.handleFirstTimeupdate_);this.off(this.player_,"timeupdate",this.seekToLiveEdge_)}nextSeekedFromUser(){this.nextSeekedFromUser_=
!0}stopTracking(){this.isTracking()&&(this.reset_(),this.trigger("liveedgechange"))}seekableEnd(){const a=this.player_.seekable(),b=[];let c=a?a.length:0;for(;c--;)b.push(a.end(c));return b.length?b.sort()[b.length-1]:Infinity}seekableStart(){const a=this.player_.seekable(),b=[];let c=a?a.length:0;for(;c--;)b.push(a.start(c));return b.length?b.sort()[0]:0}liveWindow(){const a=this.liveCurrentTime();return Infinity===a?0:a-this.seekableStart()}isLive(){return this.isTracking()}atLiveEdge(){return!this.behindLiveEdge()}liveCurrentTime(){return this.pastSeekEnd()+
this.seekableEnd()}pastSeekEnd(){const a=this.seekableEnd();-1!==this.lastSeekEnd_&&a!==this.lastSeekEnd_&&(this.pastSeekEnd_=0);this.lastSeekEnd_=a;return this.pastSeekEnd_}behindLiveEdge(){return this.behindLiveEdge_}isTracking(){return"number"===typeof this.trackingInterval_}seekToLiveEdge(){this.seekedBehindLive_=!1;this.atLiveEdge()||(this.nextSeekedFromUser_=!1,this.player_.currentTime(this.liveCurrentTime()))}dispose(){this.stopTracking();super.dispose()}}M.registerComponent("LiveTracker",
Ho);class Io extends M{constructor(a,b){super(a,b);this.on("statechanged",c=>this.updateDom_());this.updateDom_()}createEl(){this.els={title:aa("div",{className:"vjs-title-bar-title",id:`vjs-title-bar-title-${sb++}`}),description:aa("div",{className:"vjs-title-bar-description",id:`vjs-title-bar-description-${sb++}`})};return aa("div",{className:"vjs-title-bar"},{},Object.values(this.els))}updateDom_(){const a=this.player_.tech_,b=a&&a.el_,c={title:"aria-labelledby",description:"aria-describedby"};
["title","description"].forEach(e=>{const h=this.state[e],m=this.els[e];e=c[e];Pd(m);h&&Pb(m,h);b&&(b.removeAttribute(e),h&&b.setAttribute(e,m.id))});this.state.title||this.state.description?this.show():this.hide()}update(a){this.setState(a)}dispose(){var a=this.player_.tech_;if(a=a&&a.el_)a.removeAttribute("aria-labelledby"),a.removeAttribute("aria-describedby");super.dispose();this.els=null}}M.registerComponent("TitleBar",Io);const ug=a=>{var b=a.el();if(b.hasAttribute("src"))return a.triggerSourceset(b.src),
!0;b=a.$$("source");const c=[];let e="";if(!b.length)return!1;for(let h=0;h<b.length;h++){const m=b[h].src;m&&-1===c.indexOf(m)&&c.push(m)}if(!c.length)return!1;1===c.length&&(e=c[0]);a.triggerSourceset(e);return!0},Jo=Object.defineProperty({},"innerHTML",{get(){return this.cloneNode(!0).innerHTML},set(a){const b=P.createElement(this.nodeName.toLowerCase());b.innerHTML=a;for(a=P.createDocumentFragment();b.childNodes.length;)a.appendChild(b.childNodes[0]);this.innerText="";D.Element.prototype.appendChild.call(this,
a);return this.innerHTML}}),Vj=(a,b)=>{let c={};for(let e=0;e<a.length&&!((c=Object.getOwnPropertyDescriptor(a[e],b))&&c.set&&c.get);e++);c.enumerable=!0;c.configurable=!0;return c},Wj=function(a){const b=a.el();if(!b.resetSourceWatch_){var c={},e=Vj([a.el(),D.HTMLMediaElement.prototype,D.Element.prototype,Jo],"innerHTML"),h=m=>(...p)=>{p=m.apply(b,p);ug(a);return p};["append","appendChild","insertAdjacentHTML"].forEach(m=>{b[m]&&(c[m]=b[m],b[m]=h(c[m]))});Object.defineProperty(b,"innerHTML",ka(e,
{set:h(e.set)}));b.resetSourceWatch_=()=>{b.resetSourceWatch_=null;Object.keys(c).forEach(m=>{b[m]=c[m]});Object.defineProperty(b,"innerHTML",e)};a.one("sourceset",b.resetSourceWatch_)}},Ko=Object.defineProperty({},"src",{get(){return this.hasAttribute("src")?kj(D.Element.prototype.getAttribute.call(this,"src")):""},set(a){D.Element.prototype.setAttribute.call(this,"src",a);return a}}),Lo=function(a){if(a.featuresSourceset){var b=a.el();if(!b.resetSourceset_){var c=Vj([a.el(),D.HTMLMediaElement.prototype,
Ko],"src"),e=b.setAttribute,h=b.load;Object.defineProperty(b,"src",ka(c,{set:m=>{m=c.set.call(b,m);a.triggerSourceset(b.src);return m}}));b.setAttribute=(m,p)=>{p=e.call(b,m,p);/src/i.test(m)&&a.triggerSourceset(b.src);return p};b.load=()=>{const m=h.call(b);ug(a)||(a.triggerSourceset(""),Wj(a));return m};b.currentSrc?a.triggerSourceset(b.currentSrc):ug(a)||Wj(a);b.resetSourceset_=()=>{b.resetSourceset_=null;b.load=h;b.setAttribute=e;Object.defineProperty(b,"src",c);b.resetSourceWatch_&&b.resetSourceWatch_()}}}};
class Q extends Z{constructor(a,b){super(a,b);var c=a.source;b=!1;this.featuresVideoFrameCallback=this.featuresVideoFrameCallback&&"VIDEO"===this.el_.tagName;c&&(this.el_.currentSrc!==c.src||a.tag&&3===a.tag.initNetworkState_)?this.setSource(c):this.handleLateInit_(this.el_);a.enableSourceset&&this.setupSourcesetHandling_();this.isScrubbing_=!1;if(this.el_.hasChildNodes()){var e=this.el_.childNodes;let h=e.length;for(c=[];h--;){const m=e[h];"track"===m.nodeName.toLowerCase()&&(this.featuresNativeTextTracks?
(this.remoteTextTrackEls().addTrackElement_(m),this.remoteTextTracks().addTrack(m.track),this.textTracks().addTrack(m.track),b||this.el_.hasAttribute("crossorigin")||!le(m.src)||(b=!0)):c.push(m))}for(e=0;e<c.length;e++)this.el_.removeChild(c[e])}this.proxyNativeTracks_();this.featuresNativeTextTracks&&b&&ca.warn("Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\nThis may prevent text tracks from loading.");this.restoreMetadataTracksInIOSNativePlayer_();(gd||
ge)&&!0===a.nativeControlsForTouch&&this.setControls(!0);this.proxyWebkitFullscreen_();this.triggerReady()}dispose(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_();Q.disposeMediaElement(this.el_);this.options_=null;super.dispose()}setupSourcesetHandling_(){Lo(this)}restoreMetadataTracksInIOSNativePlayer_(){const a=this.textTracks();let b;const c=()=>{b=[];for(let h=0;h<a.length;h++){const m=a[h];"metadata"===m.kind&&b.push({track:m,storedMode:m.mode})}};c();a.addEventListener("change",
c);this.on("dispose",()=>a.removeEventListener("change",c));const e=()=>{for(let h=0;h<b.length;h++){const m=b[h];"disabled"===m.track.mode&&m.track.mode!==m.storedMode&&(m.track.mode=m.storedMode)}a.removeEventListener("change",e)};this.on("webkitbeginfullscreen",()=>{a.removeEventListener("change",c);a.removeEventListener("change",e);a.addEventListener("change",e)});this.on("webkitendfullscreen",()=>{a.removeEventListener("change",c);a.addEventListener("change",c);a.removeEventListener("change",
e)})}overrideNative_(a,b){if(b===this[`featuresNative${a}Tracks`]){var c=a.toLowerCase();this[`${c}TracksListeners_`]&&Object.keys(this[`${c}TracksListeners_`]).forEach(e=>{this.el()[`${c}Tracks`].removeEventListener(e,this[`${c}TracksListeners_`][e])});this[`featuresNative${a}Tracks`]=!b;this[`${c}TracksListeners_`]=null;this.proxyNativeTracksForType_(c)}}overrideNativeAudioTracks(a){this.overrideNative_("Audio",a)}overrideNativeVideoTracks(a){this.overrideNative_("Video",a)}proxyNativeTracksForType_(a){const b=
ib[a],c=this.el()[b.getterName],e=this[b.getterName]();if(this[`featuresNative${b.capitalName}Tracks`]&&c&&c.addEventListener){var h={change:p=>{p={type:"change",target:e,currentTarget:e,srcElement:e};e.trigger(p);"text"===a&&this[Hc.remoteText.getterName]().trigger(p)},addtrack(p){e.addTrack(p.track)},removetrack(p){e.removeTrack(p.track)}},m=function(){const p=[];for(let t=0;t<e.length;t++){let x=!1;for(let y=0;y<c.length;y++)if(c[y]===e[t]){x=!0;break}x||p.push(e[t])}for(;p.length;)e.removeTrack(p.shift())};
this[b.getterName+"Listeners_"]=h;Object.keys(h).forEach(p=>{const t=h[p];c.addEventListener(p,t);this.on("dispose",x=>c.removeEventListener(p,t))});this.on("loadstart",m);this.on("dispose",p=>this.off("loadstart",m))}}proxyNativeTracks_(){ib.names.forEach(a=>{this.proxyNativeTracksForType_(a)})}createEl(){let a=this.options_.tag;if(!a||!this.options_.playerElIngest&&!this.movingMediaElementInDOM){if(a){var b=a.cloneNode(!0);a.parentNode&&a.parentNode.insertBefore(b,a);Q.disposeMediaElement(a);a=
b}else a=P.createElement("video"),b=this.options_.tag&&Qb(this.options_.tag),b=ka({},b),gd&&!0===this.options_.nativeControlsForTouch||delete b.controls,Th(a,Object.assign(b,{id:this.options_.techId,class:"vjs-tech"}));a.playerId=this.options_.playerId}"undefined"!==typeof this.options_.preload&&a.setAttribute("preload",this.options_.preload);void 0!==this.options_.disablePictureInPicture&&(a.disablePictureInPicture=this.options_.disablePictureInPicture);b=["loop","muted","playsinline","autoplay"];
for(let c=0;c<b.length;c++){const e=b[c],h=this.options_[e];"undefined"!==typeof h&&(h?a.setAttribute(e,e):a.removeAttribute(e),a[e]=h)}return a}handleLateInit_(a){if(0!==a.networkState&&3!==a.networkState)if(0===a.readyState){let c=!1;const e=function(){c=!0};this.on("loadstart",e);const h=function(){c||this.trigger("loadstart")};this.on("loadedmetadata",h);this.ready(function(){this.off("loadstart",e);this.off("loadedmetadata",h);c||this.trigger("loadstart")})}else{var b=["loadstart"];b.push("loadedmetadata");
2<=a.readyState&&b.push("loadeddata");3<=a.readyState&&b.push("canplay");4<=a.readyState&&b.push("canplaythrough");this.ready(function(){b.forEach(function(c){this.trigger(c)},this)})}}setScrubbing(a){this.isScrubbing_=a}scrubbing(){return this.isScrubbing_}setCurrentTime(a){try{this.isScrubbing_&&this.el_.fastSeek&&he?this.el_.fastSeek(a):this.el_.currentTime=a}catch(b){ca(b,"Video is not ready. (Video.js)")}}duration(){if(Infinity===this.el_.duration&&wb&&xb&&0===this.el_.currentTime){const a=()=>
{0<this.el_.currentTime&&(Infinity===this.el_.duration&&this.trigger("durationchange"),this.off("timeupdate",a))};this.on("timeupdate",a);return NaN}return this.el_.duration||NaN}width(){return this.el_.offsetWidth}height(){return this.el_.offsetHeight}proxyWebkitFullscreen_(){if("webkitDisplayingFullscreen"in this.el_){var a=function(){this.trigger("fullscreenchange",{isFullscreen:!1});this.el_.controls&&!this.options_.nativeControlsForTouch&&this.controls()&&(this.el_.controls=!1)},b=function(){"webkitPresentationMode"in
this.el_&&"picture-in-picture"!==this.el_.webkitPresentationMode&&(this.one("webkitendfullscreen",a),this.trigger("fullscreenchange",{isFullscreen:!0,nativeIOSFullscreen:!0}))};this.on("webkitbeginfullscreen",b);this.on("dispose",()=>{this.off("webkitbeginfullscreen",b);this.off("webkitendfullscreen",a)})}}supportsFullScreen(){return"function"===typeof this.el_.webkitEnterFullScreen}enterFullScreen(){const a=this.el_;if(a.paused&&a.networkState<=a.HAVE_METADATA)ub(this.el_.play()),this.setTimeout(function(){a.pause();
try{a.webkitEnterFullScreen()}catch(b){this.trigger("fullscreenerror",b)}},0);else try{a.webkitEnterFullScreen()}catch(b){this.trigger("fullscreenerror",b)}}exitFullScreen(){this.el_.webkitDisplayingFullscreen?this.el_.webkitExitFullScreen():this.trigger("fullscreenerror",Error("The video is not fullscreen"))}requestPictureInPicture(){return this.el_.requestPictureInPicture()}requestVideoFrameCallback(a){return this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.requestVideoFrameCallback(a):
super.requestVideoFrameCallback(a)}cancelVideoFrameCallback(a){this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.cancelVideoFrameCallback(a):super.cancelVideoFrameCallback(a)}src(a){if(void 0===a)return this.el_.src;this.setSrc(a)}reset(){Q.resetMediaElement(this.el_)}currentSrc(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc}setControls(a){this.el_.controls=!!a}addTextTrack(a,b,c){return this.featuresNativeTextTracks?this.el_.addTextTrack(a,b,c):super.addTextTrack(a,
b,c)}createRemoteTextTrack(a){if(!this.featuresNativeTextTracks)return super.createRemoteTextTrack(a);const b=P.createElement("track");a.kind&&(b.kind=a.kind);a.label&&(b.label=a.label);if(a.language||a.srclang)b.srclang=a.language||a.srclang;a.default&&(b.default=a.default);a.id&&(b.id=a.id);a.src&&(b.src=a.src);return b}addRemoteTextTrack(a,b){a=super.addRemoteTextTrack(a,b);this.featuresNativeTextTracks&&this.el().appendChild(a);return a}removeRemoteTextTrack(a){super.removeRemoteTextTrack(a);
if(this.featuresNativeTextTracks){const b=this.$$("track");let c=b.length;for(;c--;)a!==b[c]&&a!==b[c].track||this.el().removeChild(b[c])}}getVideoPlaybackQuality(){if("function"===typeof this.el().getVideoPlaybackQuality)return this.el().getVideoPlaybackQuality();const a={};"undefined"!==typeof this.el().webkitDroppedFrameCount&&"undefined"!==typeof this.el().webkitDecodedFrameCount&&(a.droppedVideoFrames=this.el().webkitDroppedFrameCount,a.totalVideoFrames=this.el().webkitDecodedFrameCount);D.performance&&
(a.creationTime=D.performance.now());return a}}Ld(Q,"TEST_VID",function(){if(uc()){var a=P.createElement("video"),b=P.createElement("track");b.kind="captions";b.srclang="en";b.label="English";a.appendChild(b);return a}});Q.isSupported=function(){try{Q.TEST_VID.volume=.5}catch(a){return!1}return!(!Q.TEST_VID||!Q.TEST_VID.canPlayType)};Q.canPlayType=function(a){return Q.TEST_VID.canPlayType(a)};Q.canPlaySource=function(a,b){return Q.canPlayType(a.type)};Q.canControlVolume=function(){try{const a=Q.TEST_VID.volume;
Q.TEST_VID.volume=a/2+.1;const b=a!==Q.TEST_VID.volume;return b&&Na?(D.setTimeout(()=>{Q&&Q.prototype&&(Q.prototype.featuresVolumeControl=a!==Q.TEST_VID.volume)}),!1):b}catch(a){return!1}};Q.canMuteVolume=function(){try{const a=Q.TEST_VID.muted;Q.TEST_VID.muted=!a;Q.TEST_VID.muted?Q.TEST_VID.setAttribute("muted","muted"):Q.TEST_VID.removeAttribute("muted");return a!==Q.TEST_VID.muted}catch(a){return!1}};Q.canControlPlaybackRate=function(){if(wb&&xb&&58>ce)return!1;try{const a=Q.TEST_VID.playbackRate;
Q.TEST_VID.playbackRate=a/2+.1;return a!==Q.TEST_VID.playbackRate}catch(a){return!1}};Q.canOverrideAttributes=function(){try{const a=()=>{};Object.defineProperty(P.createElement("video"),"src",{get:a,set:a});Object.defineProperty(P.createElement("audio"),"src",{get:a,set:a});Object.defineProperty(P.createElement("video"),"innerHTML",{get:a,set:a});Object.defineProperty(P.createElement("audio"),"innerHTML",{get:a,set:a})}catch(a){return!1}return!0};Q.supportsNativeTextTracks=function(){return he||
Na&&xb};Q.supportsNativeVideoTracks=function(){return!(!Q.TEST_VID||!Q.TEST_VID.videoTracks)};Q.supportsNativeAudioTracks=function(){return!(!Q.TEST_VID||!Q.TEST_VID.audioTracks)};Q.Events="loadstart suspend abort error emptied stalled loadedmetadata loadeddata canplay canplaythrough playing waiting seeking seeked ended durationchange timeupdate progress play pause ratechange resize volumechange".split(" ");[["featuresMuteControl","canMuteVolume"],["featuresPlaybackRate","canControlPlaybackRate"],
["featuresSourceset","canOverrideAttributes"],["featuresNativeTextTracks","supportsNativeTextTracks"],["featuresNativeVideoTracks","supportsNativeVideoTracks"],["featuresNativeAudioTracks","supportsNativeAudioTracks"]].forEach(function([a,b]){Ld(Q.prototype,a,()=>Q[b](),!0)});Q.prototype.featuresVolumeControl=Q.canControlVolume();Q.prototype.movingMediaElementInDOM=!Na;Q.prototype.featuresFullscreenResize=!0;Q.prototype.featuresProgressEvents=!0;Q.prototype.featuresTimeupdateEvents=!0;Q.prototype.featuresVideoFrameCallback=
!(!Q.TEST_VID||!Q.TEST_VID.requestVideoFrameCallback);Q.disposeMediaElement=function(a){if(a){for(a.parentNode&&a.parentNode.removeChild(a);a.hasChildNodes();)a.removeChild(a.firstChild);a.removeAttribute("src");if("function"===typeof a.load)try{a.load()}catch(b){}}};Q.resetMediaElement=function(a){if(a){for(var b=a.querySelectorAll("source"),c=b.length;c--;)a.removeChild(b[c]);a.removeAttribute("src");if("function"===typeof a.load)try{a.load()}catch(e){}}};"muted defaultMuted autoplay controls loop playsinline".split(" ").forEach(function(a){Q.prototype[a]=
function(){return this.el_[a]||this.el_.hasAttribute(a)}});["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(a){Q.prototype["set"+sa(a)]=function(b){(this.el_[a]=b)?this.el_.setAttribute(a,a):this.el_.removeAttribute(a)}});"paused currentTime buffered volume poster preload error seeking seekable ended playbackRate defaultPlaybackRate disablePictureInPicture played networkState readyState videoWidth videoHeight crossOrigin".split(" ").forEach(function(a){Q.prototype[a]=function(){return this.el_[a]}});
"volume src poster preload playbackRate defaultPlaybackRate disablePictureInPicture crossOrigin".split(" ").forEach(function(a){Q.prototype["set"+sa(a)]=function(b){this.el_[a]=b}});["pause","load","play"].forEach(function(a){Q.prototype[a]=function(){return this.el_[a]()}});Z.withSourceHandlers(Q);Q.nativeSourceHandler={};Q.nativeSourceHandler.canPlayType=function(a){try{return Q.TEST_VID.canPlayType(a)}catch(b){return""}};Q.nativeSourceHandler.canHandleSource=function(a,b){return a.type?Q.nativeSourceHandler.canPlayType(a.type):
a.src?(a=bg(a.src),Q.nativeSourceHandler.canPlayType(`video/${a}`)):""};Q.nativeSourceHandler.handleSource=function(a,b,c){b.setSrc(a.src)};Q.nativeSourceHandler.dispose=function(){};Q.registerSourceHandler(Q.nativeSourceHandler);Z.registerTech("Html5",Q);const Xj="progress abort suspend emptied stalled loadedmetadata loadeddata timeupdate resize volumechange texttrackchange".split(" "),vg={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},wg="tiny xsmall small medium large xlarge huge".split(" "),
pe={};wg.forEach(a=>{const b="x"===a.charAt(0)?`x-${a.substring(1)}`:a;pe[a]=`vjs-layout-${b}`});const Mo={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:Infinity};class oa extends M{constructor(a,b,c){a.id=a.id||b.id||`vjs_video_${sb++}`;b=Object.assign(oa.getTagSettings(a),b);b.initChildren=!1;b.createEl=!1;b.evented=!1;b.reportTouchActivity=!1;if(!b.language){const e=a.closest("[lang]");e&&(b.language=e.getAttribute("lang"))}super(null,b,c);this.boundDocumentFullscreenChange_=
e=>this.documentFullscreenChange_(e);this.boundFullWindowOnEscKey_=e=>this.fullWindowOnEscKey(e);this.boundUpdateStyleEl_=e=>this.updateStyleEl_(e);this.boundApplyInitTime_=e=>this.applyInitTime_(e);this.boundUpdateCurrentBreakpoint_=e=>this.updateCurrentBreakpoint_(e);this.boundHandleTechClick_=e=>this.handleTechClick_(e);this.boundHandleTechDoubleClick_=e=>this.handleTechDoubleClick_(e);this.boundHandleTechTouchStart_=e=>this.handleTechTouchStart_(e);this.boundHandleTechTouchMove_=e=>this.handleTechTouchMove_(e);
this.boundHandleTechTouchEnd_=e=>this.handleTechTouchEnd_(e);this.boundHandleTechTap_=e=>this.handleTechTap_(e);this.isFullscreen_=!1;this.log=Vi(this.id_);this.fsApi_=Nd;this.isPosterFromTech_=!1;this.queuedCallbacks_=[];this.audioPosterMode_=this.audioOnlyMode_=this.debugEnabled_=this.userActive_=this.hasStarted_=this.isReady_=!1;this.audioOnlyCache_={playerHeight:null,hiddenChildren:[]};if(!this.options_||!this.options_.techOrder||!this.options_.techOrder.length)throw Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");
this.tagAttributes=(this.tag=a)&&Qb(a);this.language(this.options_.language);if(b.languages){const e={};Object.getOwnPropertyNames(b.languages).forEach(function(h){e[h.toLowerCase()]=b.languages[h]});this.languages_=e}else this.languages_=oa.prototype.options_.languages;this.resetCache_();this.poster_=b.poster||"";this.controls_=!!b.controls;a.controls=!1;a.removeAttribute("controls");this.changingSrc_=!1;this.playCallbacks_=[];this.playTerminatedQueue_=[];a.hasAttribute("autoplay")?this.autoplay(!0):
this.autoplay(this.options_.autoplay);b.plugins&&Object.keys(b.plugins).forEach(e=>{if("function"!==typeof this[e])throw Error(`plugin "${e}" does not exist`);});this.scrubbing_=!1;this.el_=this.createEl();tf(this,{eventBusKey:"el_"});this.fsApi_.requestFullscreen&&($a(P,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),this.on(this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_));if(this.fluid_)this.on(["playerreset","resize"],this.boundUpdateStyleEl_);c=ka(this.options_);
b.plugins&&Object.keys(b.plugins).forEach(e=>{this[e](b.plugins[e])});b.debug&&this.debug(!0);this.options_.playerOptions=c;this.middleware_=[];this.playbackRates(b.playbackRates);this.initChildren();this.isAudio("audio"===a.nodeName.toLowerCase());this.controls()?this.addClass("vjs-controls-enabled"):this.addClass("vjs-controls-disabled");this.el_.setAttribute("role","region");this.isAudio()?this.el_.setAttribute("aria-label",this.localize("Audio Player")):this.el_.setAttribute("aria-label",this.localize("Video Player"));
this.isAudio()&&this.addClass("vjs-audio");gd&&this.addClass("vjs-touch-enabled");Na||this.addClass("vjs-workinghover");oa.players[this.id_]=this;this.addClass("vjs-v8");this.userActive(!0);this.reportUserActivity();this.one("play",e=>this.listenForUserActivity_(e));this.on("keydown",e=>this.handleKeyDown(e));this.on("languagechange",e=>this.handleLanguagechange(e));this.breakpoints(this.options_.breakpoints);this.responsive(this.options_.responsive);this.on("ready",()=>{this.audioPosterMode(this.options_.audioPosterMode);
this.audioOnlyMode(this.options_.audioOnlyMode)})}dispose(){this.trigger("dispose");this.off("dispose");Ha(P,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_);Ha(P,"keydown",this.boundFullWindowOnEscKey_);this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null);oa.players[this.id_]=null;this.tag&&this.tag.player&&(this.tag.player=null);this.el_&&this.el_.player&&(this.el_.player=null);this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=
!1,this.poster_="");this.playerElIngest_&&(this.playerElIngest_=null);this.tag&&(this.tag=null);xf[this.id()]=null;Qa.names.forEach(a=>{(a=this[Qa[a].getterName]())&&a.off&&a.off()});super.dispose({restoreEl:this.options_.restoreEl})}createEl(){let a=this.tag,b,c=this.playerElIngest_=a.parentNode&&a.parentNode.hasAttribute&&a.parentNode.hasAttribute("data-vjs-player");const e="video-js"===this.tag.tagName.toLowerCase();c?b=this.el_=a.parentNode:e||(b=this.el_=super.createEl("div"));const h=Qb(a);
if(e){b=this.el_=a;for(a=this.tag=P.createElement("video");b.children.length;)a.appendChild(b.firstChild);Zc(b,"video-js")||Xb(b,"video-js");b.appendChild(a);c=this.playerElIngest_=b;Object.keys(b).forEach(t=>{try{a[t]=b[t]}catch(x){}})}a.setAttribute("tabindex","-1");h.tabindex="-1";xb&&ee&&(a.setAttribute("role","application"),h.role="application");a.removeAttribute("width");a.removeAttribute("height");"width"in h&&delete h.width;"height"in h&&delete h.height;Object.getOwnPropertyNames(h).forEach(function(t){e&&
"class"===t||b.setAttribute(t,h[t]);e&&a.setAttribute(t,h[t])});a.playerId=a.id;a.id+="_html5_api";a.className="vjs-tech";a.player=b.player=this;this.addClass("vjs-paused");if(!0!==D.VIDEOJS_NO_DYNAMIC_STYLE){this.styleEl_=bj("vjs-styles-dimensions");var m=Rb(".vjs-styles-defaults"),p=Rb("head");p.insertBefore(this.styleEl_,m?m.nextSibling:p.firstChild)}this.fluid_=this.fill_=!1;this.width(this.options_.width);this.height(this.options_.height);this.fill(this.options_.fill);this.fluid(this.options_.fluid);
this.aspectRatio(this.options_.aspectRatio);this.crossOrigin(this.options_.crossOrigin||this.options_.crossorigin);m=a.getElementsByTagName("a");for(p=0;p<m.length;p++){const t=m.item(p);Xb(t,"vjs-hidden");t.setAttribute("hidden","hidden")}a.initNetworkState_=a.networkState;a.parentNode&&!c&&a.parentNode.insertBefore(b,a);nf(a,b);this.children_.unshift(a);this.el_.setAttribute("lang",this.language_);this.el_.setAttribute("translate","no");return this.el_=b}crossOrigin(a){if("undefined"===typeof a)return this.techGet_("crossOrigin");
null!==a&&"anonymous"!==a&&"use-credentials"!==a?ca.warn(`crossOrigin must be null,  "anonymous" or "use-credentials", given "${a}"`):(this.techCall_("setCrossOrigin",a),this.posterImage&&this.posterImage.crossOrigin(a))}width(a){return this.dimension("width",a)}height(a){return this.dimension("height",a)}dimension(a,b){const c=a+"_";if(void 0===b)return this[c]||0;if(""===b||"auto"===b)this[c]=void 0,this.updateStyleEl_();else{var e=parseFloat(b);isNaN(e)?ca.error(`Improper value "${b}" supplied for for ${a}`):
(this[c]=e,this.updateStyleEl_())}}fluid(a){if(void 0===a)return!!this.fluid_;this.fluid_=!!a;Fb(this)&&this.off(["playerreset","resize"],this.boundUpdateStyleEl_);a?(this.addClass("vjs-fluid"),this.fill(!1),Zn(this,()=>{this.on(["playerreset","resize"],this.boundUpdateStyleEl_)})):this.removeClass("vjs-fluid");this.updateStyleEl_()}fill(a){if(void 0===a)return!!this.fill_;this.fill_=!!a;a?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")}aspectRatio(a){if(void 0===a)return this.aspectRatio_;
if(!/^\d+:\d+$/.test(a))throw Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=a;this.fluid(!0);this.updateStyleEl_()}updateStyleEl_(){if(!0===D.VIDEOJS_NO_DYNAMIC_STYLE){var a="number"===typeof this.width_?this.width_:this.options_.width,b="number"===typeof this.height_?this.height_:this.options_.height,c=this.tech_&&this.tech_.el();c&&(0<=a&&(c.width=a),0<=b&&(c.height=b))}else{a=(void 0!==this.aspectRatio_&&"auto"!==this.aspectRatio_?
this.aspectRatio_:0<this.videoWidth()?this.videoWidth()+":"+this.videoHeight():"16:9").split(":");var e=a[1]/a[0];a=void 0!==this.width_?this.width_:void 0!==this.height_?this.height_/e:this.videoWidth()||300;b=void 0!==this.height_?this.height_:a*e;c=/^[^a-zA-Z]/.test(this.id())?"dimensions-"+this.id():this.id()+"-dimensions";this.addClass(c);cj(this.styleEl_,`\n      .${c} {\n        width: ${a}px;\n        height: ${b}px;\n      }\n\n      .${c}.vjs-fluid:not(.vjs-audio-only-mode) {\n        padding-top: ${100*
e}%;\n      }\n    `)}}loadTech_(a,b){this.tech_&&this.unloadTech_();const c=sa(a),e=a.charAt(0).toLowerCase()+a.slice(1);"Html5"!==c&&this.tag&&(Z.getTech("Html5").disposeMediaElement(this.tag),this.tag=this.tag.player=null);this.techName_=c;this.isReady_=!1;let h=this.autoplay();if("string"===typeof this.autoplay()||!0===this.autoplay()&&this.options_.normalizeAutoplay)h=!1;const m={source:b,autoplay:h,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:`${this.id()}_${e}_api`,
playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,disablePictureInPicture:this.options_.disablePictureInPicture,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset};Qa.names.forEach(p=>{p=Qa[p];m[p.getterName]=this[p.privateName]});Object.assign(m,this.options_[c]);
Object.assign(m,this.options_[e]);Object.assign(m,this.options_[a.toLowerCase()]);this.tag&&(m.tag=this.tag);b&&b.src===this.cache_.src&&0<this.cache_.currentTime&&(m.startTime=this.cache_.currentTime);a=Z.getTech(a);if(!a)throw Error(`No Tech named '${c}' exists! '${c}' should be registered using videojs.registerTech()'`);this.tech_=new a(m);this.tech_.ready(ma(this,this.handleTechReady_),!0);hj.jsonToTextTracks(this.textTracksJson_||[],this.tech_);Xj.forEach(p=>{this.on(this.tech_,p,t=>this[`handleTech${sa(p)}_`](t))});
Object.keys(vg).forEach(p=>{this.on(this.tech_,p,t=>{if(0===this.tech_.playbackRate()&&this.tech_.seeking())this.queuedCallbacks_.push({callback:this[`handleTech${vg[p]}_`].bind(this),event:t});else this[`handleTech${vg[p]}_`](t)})});this.on(this.tech_,"loadstart",p=>this.handleTechLoadStart_(p));this.on(this.tech_,"sourceset",p=>this.handleTechSourceset_(p));this.on(this.tech_,"waiting",p=>this.handleTechWaiting_(p));this.on(this.tech_,"ended",p=>this.handleTechEnded_(p));this.on(this.tech_,"seeking",
p=>this.handleTechSeeking_(p));this.on(this.tech_,"play",p=>this.handleTechPlay_(p));this.on(this.tech_,"pause",p=>this.handleTechPause_(p));this.on(this.tech_,"durationchange",p=>this.handleTechDurationChange_(p));this.on(this.tech_,"fullscreenchange",(p,t)=>this.handleTechFullscreenChange_(p,t));this.on(this.tech_,"fullscreenerror",(p,t)=>this.handleTechFullscreenError_(p,t));this.on(this.tech_,"enterpictureinpicture",p=>this.handleTechEnterPictureInPicture_(p));this.on(this.tech_,"leavepictureinpicture",
p=>this.handleTechLeavePictureInPicture_(p));this.on(this.tech_,"error",p=>this.handleTechError_(p));this.on(this.tech_,"posterchange",p=>this.handleTechPosterChange_(p));this.on(this.tech_,"textdata",p=>this.handleTechTextData_(p));this.on(this.tech_,"ratechange",p=>this.handleTechRateChange_(p));this.on(this.tech_,"loadedmetadata",this.boundUpdateStyleEl_);this.usingNativeControls(this.techGet_("controls"));this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_();this.tech_.el().parentNode===
this.el()||"Html5"===c&&this.tag||nf(this.tech_.el(),this.el());this.tag&&(this.tag=this.tag.player=null)}unloadTech_(){Qa.names.forEach(a=>{a=Qa[a];this[a.privateName]=this[a.getterName]()});this.textTracksJson_=hj.textTracksToJson(this.tech_);this.isReady_=!1;this.tech_.dispose();this.tech_=!1;this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange"));this.isPosterFromTech_=!1}tech(a){void 0===a&&ca.warn("Using the tech directly can be dangerous. I hope you know what you're doing.\nSee https://github.com/videojs/video.js/issues/2617 for more info.\n");
return this.tech_}addTechControlsListeners_(){this.removeTechControlsListeners_();this.on(this.tech_,"click",this.boundHandleTechClick_);this.on(this.tech_,"dblclick",this.boundHandleTechDoubleClick_);this.on(this.tech_,"touchstart",this.boundHandleTechTouchStart_);this.on(this.tech_,"touchmove",this.boundHandleTechTouchMove_);this.on(this.tech_,"touchend",this.boundHandleTechTouchEnd_);this.on(this.tech_,"tap",this.boundHandleTechTap_)}removeTechControlsListeners_(){this.off(this.tech_,"tap",this.boundHandleTechTap_);
this.off(this.tech_,"touchstart",this.boundHandleTechTouchStart_);this.off(this.tech_,"touchmove",this.boundHandleTechTouchMove_);this.off(this.tech_,"touchend",this.boundHandleTechTouchEnd_);this.off(this.tech_,"click",this.boundHandleTechClick_);this.off(this.tech_,"dblclick",this.boundHandleTechDoubleClick_)}handleTechReady_(){this.triggerReady();this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume);this.handleTechPosterChange_();this.handleTechDurationChange_()}handleTechLoadStart_(){this.removeClass("vjs-ended",
"vjs-seeking");this.error(null);this.handleTechDurationChange_();this.paused()&&this.hasStarted(!1);this.trigger("loadstart");this.manualAutoplay_(!0===this.autoplay()&&this.options_.normalizeAutoplay?"play":this.autoplay())}manualAutoplay_(a){if(this.tech_&&"string"===typeof a){var b=()=>{const e=this.muted();this.muted(!0);const h=()=>{this.muted(e)};this.playTerminatedQueue_.push(h);const m=this.play();if(bd(m))return m.catch(p=>{h();throw Error(`Rejection at manualAutoplay. Restoring muted value. ${p?
p:""}`);})};if("any"!==a||this.muted())var c="muted"!==a||this.muted()?this.play():b();else c=this.play(),bd(c)&&(c=c.catch(b));if(bd(c))return c.then(()=>{this.trigger({type:"autoplay-success",autoplay:a})}).catch(()=>{this.trigger({type:"autoplay-failure",autoplay:a})})}}updateSourceCaches_(a=""){let b=a;var c="";"string"!==typeof b&&(b=a.src,c=a.type);this.cache_.source=this.cache_.source||{};this.cache_.sources=this.cache_.sources||[];b&&!c&&(c=mo(this,b));this.cache_.source=ka({},a,{src:b,type:c});
a=this.cache_.sources.filter(m=>m.src&&m.src===b);c=[];const e=this.$$("source"),h=[];for(let m=0;m<e.length;m++){const p=Qb(e[m]);c.push(p);p.src&&p.src===b&&h.push(p.src)}h.length&&!a.length?this.cache_.sources=c:a.length||(this.cache_.sources=[this.cache_.source]);this.cache_.src=b}handleTechSourceset_(a){if(!this.changingSrc_){let b=h=>this.updateSourceCaches_(h);const c=this.currentSource().src,e=a.src;c&&!/^blob:/.test(c)&&/^blob:/.test(e)&&(!this.lastSource_||this.lastSource_.tech!==e&&this.lastSource_.player!==
c)&&(b=()=>{});b(e);a.src||this.tech_.any(["sourceset","loadstart"],h=>{"sourceset"!==h.type&&(h=this.techGet("currentSrc"),this.lastSource_.tech=h,this.updateSourceCaches_(h))})}this.lastSource_={player:this.currentSource().src,tech:a.src};this.trigger({src:a.src,type:"sourceset"})}hasStarted(a){if(void 0===a)return this.hasStarted_;a!==this.hasStarted_&&((this.hasStarted_=a)?this.addClass("vjs-has-started"):this.removeClass("vjs-has-started"))}handleTechPlay_(){this.removeClass("vjs-ended","vjs-paused");
this.addClass("vjs-playing");this.hasStarted(!0);this.trigger("play")}handleTechRateChange_(){0<this.tech_.playbackRate()&&0===this.cache_.lastPlaybackRate&&(this.queuedCallbacks_.forEach(a=>a.callback(a.event)),this.queuedCallbacks_=[]);this.cache_.lastPlaybackRate=this.tech_.playbackRate();this.trigger("ratechange")}handleTechWaiting_(){this.addClass("vjs-waiting");this.trigger("waiting");const a=this.currentTime(),b=()=>{a!==this.currentTime()&&(this.removeClass("vjs-waiting"),this.off("timeupdate",
b))};this.on("timeupdate",b)}handleTechCanPlay_(){this.removeClass("vjs-waiting");this.trigger("canplay")}handleTechCanPlayThrough_(){this.removeClass("vjs-waiting");this.trigger("canplaythrough")}handleTechPlaying_(){this.removeClass("vjs-waiting");this.trigger("playing")}handleTechSeeking_(){this.addClass("vjs-seeking");this.trigger("seeking")}handleTechSeeked_(){this.removeClass("vjs-seeking","vjs-ended");this.trigger("seeked")}handleTechPause_(){this.removeClass("vjs-playing");this.addClass("vjs-paused");
this.trigger("pause")}handleTechEnded_(){this.addClass("vjs-ended");this.removeClass("vjs-waiting");this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause();this.trigger("ended")}handleTechDurationChange_(){this.duration(this.techGet_("duration"))}handleTechClick_(a){!this.controls_||void 0!==this.options_&&void 0!==this.options_.userActions&&void 0!==this.options_.userActions.click&&!1===this.options_.userActions.click||(void 0!==this.options_&&void 0!==this.options_.userActions&&
"function"===typeof this.options_.userActions.click?this.options_.userActions.click.call(this,a):this.paused()?ub(this.play()):this.pause())}handleTechDoubleClick_(a){this.controls_&&(Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),b=>b.contains(a.target))||void 0!==this.options_&&void 0!==this.options_.userActions&&void 0!==this.options_.userActions.doubleClick&&!1===this.options_.userActions.doubleClick||(void 0!==this.options_&&void 0!==this.options_.userActions&&"function"===
typeof this.options_.userActions.doubleClick?this.options_.userActions.doubleClick.call(this,a):this.isFullscreen()?this.exitFullscreen():this.requestFullscreen()))}handleTechTap_(){this.userActive(!this.userActive())}handleTechTouchStart_(){this.userWasActive=this.userActive()}handleTechTouchMove_(){this.userWasActive&&this.reportUserActivity()}handleTechTouchEnd_(a){a.cancelable&&a.preventDefault()}toggleFullscreenClass_(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")}documentFullscreenChange_(a){a=
a.target.player;if(!a||a===this){a=this.el();var b=P[this.fsApi_.fullscreenElement]===a;!b&&a.matches?b=a.matches(":"+this.fsApi_.fullscreen):!b&&a.msMatchesSelector&&(b=a.msMatchesSelector(":"+this.fsApi_.fullscreen));this.isFullscreen(b)}}handleTechFullscreenChange_(a,b){b&&(b.nativeIOSFullscreen&&(this.addClass("vjs-ios-native-fs"),this.tech_.one("webkitendfullscreen",()=>{this.removeClass("vjs-ios-native-fs")})),this.isFullscreen(b.isFullscreen))}handleTechFullscreenError_(a,b){this.trigger("fullscreenerror",
b)}togglePictureInPictureClass_(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")}handleTechEnterPictureInPicture_(a){this.isInPictureInPicture(!0)}handleTechLeavePictureInPicture_(a){this.isInPictureInPicture(!1)}handleTechError_(){const a=this.tech_.error();this.error(a)}handleTechTextData_(){let a=null;1<arguments.length&&(a=arguments[1]);this.trigger("textdata",a)}getCache(){return this.cache_}resetCache_(){this.cache_={currentTime:0,
initTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],playbackRates:[],volume:1}}techCall_(a,b){this.ready(function(){if(a in ko)return this.tech_[a](this.middleware_.reduce(wf(a),b));if(a in pj)return gi(this.middleware_,this.tech_,a,b);try{if(this.tech_)this.tech_[a](b)}catch(c){throw ca(c),c;}},!0)}techGet_(a){if(this.tech_&&this.tech_.isReady_){if(a in jo){var b=this.tech_;return this.middleware_.reduceRight(wf(a),
b[a]())}if(a in pj)return gi(this.middleware_,this.tech_,a);try{return this.tech_[a]()}catch(c){if(void 0===this.tech_[a])throw ca(`Video.js: ${a} method not defined for ${this.techName_} playback technology.`,c),c;if("TypeError"===c.name)throw ca(`Video.js: ${a} unavailable on ${this.techName_} playback technology element.`,c),this.tech_.isReady_=!1,c;ca(c);throw c;}}}play(){return new Promise(a=>{this.play_(a)})}play_(a=ub){this.playCallbacks_.push(a);var b=!(this.changingSrc_||!this.src()&&!this.currentSrc());
a=!(!he&&!Na);this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null);this.isReady_&&b?(b=this.techGet_("play"),a&&this.hasClass("vjs-ended")&&this.resetProgressBar_(),null===b?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(b)):(this.waitToPlay_=c=>{this.play_()},this.one(["ready","loadstart"],this.waitToPlay_),!b&&a&&this.load())}runPlayTerminatedQueue_(){const a=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[];a.forEach(function(b){b()})}runPlayCallbacks_(a){const b=
this.playCallbacks_.slice(0);this.playCallbacks_=[];this.playTerminatedQueue_=[];b.forEach(function(c){c(a)})}pause(){this.techCall_("pause")}paused(){return!1===this.techGet_("paused")?!1:!0}played(){return this.techGet_("played")||tb(0,0)}scrubbing(a){if("undefined"===typeof a)return this.scrubbing_;this.scrubbing_=!!a;this.techCall_("setScrubbing",this.scrubbing_);a?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")}currentTime(a){if("undefined"!==typeof a)0>a&&(a=0),this.isReady_&&
!this.changingSrc_&&this.tech_&&this.tech_.isReady_?(this.techCall_("setCurrentTime",a),this.cache_.initTime=0):(this.cache_.initTime=a,this.off("canplay",this.boundApplyInitTime_),this.one("canplay",this.boundApplyInitTime_));else return this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime}applyInitTime_(){this.currentTime(this.cache_.initTime)}duration(a){if(void 0===a)return void 0!==this.cache_.duration?this.cache_.duration:NaN;a=parseFloat(a);0>a&&(a=Infinity);a!==
this.cache_.duration&&(this.cache_.duration=a,Infinity===a?this.addClass("vjs-live"):this.removeClass("vjs-live"),isNaN(a)||this.trigger("durationchange"))}remainingTime(){return this.duration()-this.currentTime()}remainingTimeDisplay(){return Math.floor(this.duration())-Math.floor(this.currentTime())}buffered(){let a=this.techGet_("buffered");a&&a.length||(a=tb(0,0));return a}bufferedPercent(){return fi(this.buffered(),this.duration())}bufferedEnd(){var a=this.buffered();const b=this.duration();
a=a.end(a.length-1);a>b&&(a=b);return a}volume(a){if(void 0!==a)a=Math.max(0,Math.min(1,parseFloat(a))),this.cache_.volume=a,this.techCall_("setVolume",a),0<a&&this.lastVolume_(a);else return a=parseFloat(this.techGet_("volume")),isNaN(a)?1:a}muted(a){if(void 0!==a)this.techCall_("setMuted",a);else return this.techGet_("muted")||!1}defaultMuted(a){return void 0!==a?this.techCall_("setDefaultMuted",a):this.techGet_("defaultMuted")||!1}lastVolume_(a){if(void 0!==a&&0!==a)this.cache_.lastVolume=a;else return this.cache_.lastVolume}supportsFullScreen(){return this.techGet_("supportsFullScreen")||
!1}isFullscreen(a){if(void 0!==a){const b=this.isFullscreen_;this.isFullscreen_=!!a;this.isFullscreen_!==b&&this.fsApi_.prefixed&&this.trigger("fullscreenchange");this.toggleFullscreenClass_()}else return this.isFullscreen_}requestFullscreen(a){this.isInPictureInPicture()&&this.exitPictureInPicture();const b=this;return new Promise((c,e)=>{function h(){b.off("fullscreenerror",p);b.off("fullscreenchange",m)}function m(){h();c()}function p(x,y){h();e(y)}b.one("fullscreenchange",m);b.one("fullscreenerror",
p);const t=b.requestFullscreenHelper_(a);t&&(t.then(h,h),t.then(c,e))})}requestFullscreenHelper_(a){let b;this.fsApi_.prefixed||(b=this.options_.fullscreen&&this.options_.fullscreen.options||{},void 0!==a&&(b=a));if(this.fsApi_.requestFullscreen)return(a=this.el_[this.fsApi_.requestFullscreen](b))&&a.then(()=>this.isFullscreen(!0),()=>this.isFullscreen(!1)),a;this.tech_.supportsFullScreen()&&!0===!this.options_.preferFullWindow?this.techCall_("enterFullScreen"):this.enterFullWindow()}exitFullscreen(){const a=
this;return new Promise((b,c)=>{function e(){a.off("fullscreenerror",m);a.off("fullscreenchange",h)}function h(){e();b()}function m(t,x){e();c(x)}a.one("fullscreenchange",h);a.one("fullscreenerror",m);const p=a.exitFullscreenHelper_();p&&(p.then(e,e),p.then(b,c))})}exitFullscreenHelper_(){if(this.fsApi_.requestFullscreen){const a=P[this.fsApi_.exitFullscreen]();a&&ub(a.then(()=>this.isFullscreen(!1)));return a}this.tech_.supportsFullScreen()&&!0===!this.options_.preferFullWindow?this.techCall_("exitFullScreen"):
this.exitFullWindow()}enterFullWindow(){this.isFullscreen(!0);this.isFullWindow=!0;this.docOrigOverflow=P.documentElement.style.overflow;$a(P,"keydown",this.boundFullWindowOnEscKey_);P.documentElement.style.overflow="hidden";Xb(P.body,"vjs-full-window");this.trigger("enterFullWindow")}fullWindowOnEscKey(a){Y.isEventKey(a,"Esc")&&!0===this.isFullscreen()&&(this.isFullWindow?this.exitFullWindow():this.exitFullscreen())}exitFullWindow(){this.isFullscreen(!1);this.isFullWindow=!1;Ha(P,"keydown",this.boundFullWindowOnEscKey_);
P.documentElement.style.overflow=this.docOrigOverflow;Md(P.body,"vjs-full-window");this.trigger("exitFullWindow")}disablePictureInPicture(a){if(void 0===a)return this.techGet_("disablePictureInPicture");this.techCall_("setDisablePictureInPicture",a);this.options_.disablePictureInPicture=a;this.trigger("disablepictureinpicturechanged")}isInPictureInPicture(a){if(void 0!==a)this.isInPictureInPicture_=!!a,this.togglePictureInPictureClass_();else return!!this.isInPictureInPicture_}requestPictureInPicture(){if(this.options_.enableDocumentPictureInPicture&&
D.documentPictureInPicture){const a=P.createElement(this.el().tagName);a.classList=this.el().classList;a.classList.add("vjs-pip-container");this.posterImage&&a.appendChild(this.posterImage.el().cloneNode(!0));this.titleBar&&a.appendChild(this.titleBar.el().cloneNode(!0));a.appendChild(aa("p",{className:"vjs-pip-text"},{},this.localize("Playing in picture-in-picture")));return D.documentPictureInPicture.requestWindow({initialAspectRatio:this.videoWidth()/this.videoHeight(),copyStyleSheets:!0}).then(b=>
{this.el_.parentNode.insertBefore(a,this.el_);b.document.body.append(this.el_);b.document.body.classList.add("vjs-pip-window");this.player_.isInPictureInPicture(!0);this.player_.trigger("enterpictureinpicture");b.addEventListener("unload",c=>{c=c.target.querySelector(".video-js");a.replaceWith(c);this.player_.isInPictureInPicture(!1);this.player_.trigger("leavepictureinpicture")});return b})}return"pictureInPictureEnabled"in P&&!1===this.disablePictureInPicture()?this.techGet_("requestPictureInPicture"):
Promise.reject("No PiP mode is available")}exitPictureInPicture(){if(D.documentPictureInPicture&&D.documentPictureInPicture.window)return D.documentPictureInPicture.window.close(),Promise.resolve();if("pictureInPictureEnabled"in P)return P.exitPictureInPicture()}handleKeyDown(a){const {userActions:b}=this.options_;if(b&&b.hotkeys){{var c=this.el_.ownerDocument.activeElement;const h=c.tagName.toLowerCase();if(c.isContentEditable)c=!0;else{var e="button checkbox hidden radio reset submit".split(" ");
c="input"===h?-1===e.indexOf(c.type):-1!==["textarea"].indexOf(h)}}c||("function"===typeof b.hotkeys?b.hotkeys.call(this,a):this.handleHotkeys(a))}}handleHotkeys(a){const {fullscreenKey:b=h=>Y.isEventKey(h,"f"),muteKey:c=h=>Y.isEventKey(h,"m"),playPauseKey:e=h=>Y.isEventKey(h,"k")||Y.isEventKey(h,"Space")}=this.options_.userActions?this.options_.userActions.hotkeys:{};if(b.call(this,a)){a.preventDefault();a.stopPropagation();const h=M.getComponent("FullscreenToggle");!1!==P[this.fsApi_.fullscreenEnabled]&&
h.prototype.handleClick.call(this,a)}else c.call(this,a)?(a.preventDefault(),a.stopPropagation(),M.getComponent("MuteToggle").prototype.handleClick.call(this,a)):e.call(this,a)&&(a.preventDefault(),a.stopPropagation(),M.getComponent("PlayToggle").prototype.handleClick.call(this,a))}canPlayType(a){for(let c=0,e=this.options_.techOrder;c<e.length;c++){var b=e[c];let h=Z.getTech(b);h||(h=M.getComponent(b));if(!h)ca.error(`The "${b}" tech is undefined. Skipped browser support check for that tech.`);else if(h.isSupported()&&
(b=h.canPlayType(a)))return b}return""}selectSource(a){const b=this.options_.techOrder.map(m=>[m,Z.getTech(m)]).filter(([m,p])=>{if(p)return p.isSupported();ca.error(`The "${m}" tech is undefined. Skipped browser support check for that tech.`);return!1}),c=function(m,p,t){let x;m.some(y=>p.some(C=>{if(x=t(y,C))return!0}));return x},e=m=>(p,t)=>m(t,p),h=([m,p],t)=>{if(p.canPlaySource(t,this.options_[m.toLowerCase()]))return{source:t,tech:m}};return(this.options_.sourceOrder?c(a,b,e(h)):c(b,a,h))||
!1}handleSrc_(a,b){if("undefined"===typeof a)return this.cache_.src||"";this.resetRetryOnError_&&this.resetRetryOnError_();const c=qj(a);if(c.length){if(this.changingSrc_=!0,b||(this.cache_.sources=c),this.updateSourceCaches_(c[0]),pm(this,c[0],(e,h)=>{this.middleware_=h;b||(this.cache_.sources=c);this.updateSourceCaches_(e);if(this.src_(e)){if(1<c.length)return this.handleSrc_(c.slice(1));this.changingSrc_=!1;this.setTimeout(function(){this.error({code:4,message:this.options_.notSupportedMessage})},
0);this.triggerReady()}else qm(h,this.tech_)}),1<c.length){const e=()=>{this.error(null);this.handleSrc_(c.slice(1),!0)},h=()=>{this.off("error",e)};this.one("error",e);this.one("playing",h);this.resetRetryOnError_=()=>{this.off("error",e);this.off("playing",h)}}}else this.setTimeout(function(){this.error({code:4,message:this.options_.notSupportedMessage})},0)}src(a){return this.handleSrc_(a,!1)}src_(a){const b=this.selectSource([a]);if(!b)return!0;if(!gj(b.tech,this.techName_))return this.changingSrc_=
!0,this.loadTech_(b.tech,b.source),this.tech_.ready(()=>{this.changingSrc_=!1}),!1;this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",a):this.techCall_("src",a.src);this.changingSrc_=!1},!0);return!1}load(){this.techCall_("load")}reset(){if(this.paused())this.doReset_();else{const a=this.play();ub(a.then(()=>this.doReset_()))}}doReset_(){this.tech_&&this.tech_.clearTracks("text");this.resetCache_();this.poster("");this.loadTech_(this.options_.techOrder[0],
null);this.techCall_("reset");this.resetControlBarUI_();Fb(this)&&this.trigger("playerreset")}resetControlBarUI_(){this.resetProgressBar_();this.resetPlaybackRate_();this.resetVolumeBar_()}resetProgressBar_(){this.currentTime(0);const {currentTimeDisplay:a,durationDisplay:b,progressControl:c,remainingTimeDisplay:e}=this.controlBar||{},{seekBar:h}=c||{};a&&a.updateContent();b&&b.updateContent();e&&e.updateContent();h&&(h.update(),h.loadProgressBar&&h.loadProgressBar.update())}resetPlaybackRate_(){this.playbackRate(this.defaultPlaybackRate());
this.handleTechRateChange_()}resetVolumeBar_(){this.volume(1);this.trigger("volumechange")}currentSources(){const a=this.currentSource(),b=[];0!==Object.keys(a).length&&b.push(a);return this.cache_.sources||b}currentSource(){return this.cache_.source||{}}currentSrc(){return this.currentSource()&&this.currentSource().src||""}currentType(){return this.currentSource()&&this.currentSource().type||""}preload(a){if(void 0!==a)this.techCall_("setPreload",a),this.options_.preload=a;else return this.techGet_("preload")}autoplay(a){if(void 0===
a)return this.options_.autoplay||!1;let b;"string"===typeof a&&/(any|play|muted)/.test(a)||!0===a&&this.options_.normalizeAutoplay?(this.options_.autoplay=a,this.manualAutoplay_("string"===typeof a?a:"play"),b=!1):this.options_.autoplay=a?!0:!1;b="undefined"===typeof b?this.options_.autoplay:b;this.tech_&&this.techCall_("setAutoplay",b)}playsinline(a){return void 0!==a?(this.techCall_("setPlaysinline",a),this.options_.playsinline=a,this):this.techGet_("playsinline")}loop(a){if(void 0!==a)this.techCall_("setLoop",
a),this.options_.loop=a;else return this.techGet_("loop")}poster(a){if(void 0===a)return this.poster_;a||(a="");a!==this.poster_&&(this.poster_=a,this.techCall_("setPoster",a),this.isPosterFromTech_=!1,this.trigger("posterchange"))}handleTechPosterChange_(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){const a=this.tech_.poster()||"";a!==this.poster_&&(this.poster_=a,this.isPosterFromTech_=!0,this.trigger("posterchange"))}}controls(a){if(void 0===a)return!!this.controls_;
a=!!a;this.controls_!==a&&(this.controls_=a,this.usingNativeControls()&&this.techCall_("setControls",a),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))}usingNativeControls(a){if(void 0===
a)return!!this.usingNativeControls_;a=!!a;this.usingNativeControls_!==a&&((this.usingNativeControls_=a)?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))}error(a){if(void 0===a)return this.error_||null;Sb("beforeerror").forEach(b=>{b=b(this,a);rb(b)&&!Array.isArray(b)||"string"===typeof b||"number"===typeof b||null===b?a=b:this.log.error("please return a value that MediaError expects in beforeerror hooks")});
if(this.options_.suppressNotSupportedError&&a&&4===a.code){const b=function(){this.error(a)};this.options_.suppressNotSupportedError=!1;this.any(["click","touchstart"],b);this.one("loadstart",function(){this.off(["click","touchstart"],b)})}else null===a?(this.error_=a,this.removeClass("vjs-error"),this.errorDisplay&&this.errorDisplay.close()):(this.error_=new Pa(a),this.addClass("vjs-error"),ca.error(`(CODE:${this.error_.code} ${Pa.errorTypes[this.error_.code]})`,this.error_.message,this.error_),
this.trigger("error"),Sb("error").forEach(b=>b(this,this.error_)))}reportUserActivity(a){this.userActivity_=!0}userActive(a){if(void 0===a)return this.userActive_;a=!!a;if(a!==this.userActive_)if(this.userActive_=a)this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),this.trigger("useractive");else{if(this.tech_)this.tech_.one("mousemove",function(b){b.stopPropagation();b.preventDefault()});this.userActivity_=!1;this.removeClass("vjs-user-active");this.addClass("vjs-user-inactive");
this.trigger("userinactive")}}listenForUserActivity_(){let a,b,c;const e=ma(this,this.reportUserActivity);var h=function(p){e();this.clearInterval(a)};this.on("mousedown",function(){e();this.clearInterval(a);a=this.setInterval(e,250)});this.on("mousemove",function(p){if(p.screenX!==b||p.screenY!==c)b=p.screenX,c=p.screenY,e()});this.on("mouseup",h);this.on("mouseleave",h);!(h=this.getChild("controlBar"))||Na||wb||(h.on("mouseenter",function(p){0!==this.player().options_.inactivityTimeout&&(this.player().cache_.inactivityTimeout=
this.player().options_.inactivityTimeout);this.player().options_.inactivityTimeout=0}),h.on("mouseleave",function(p){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout}));this.on("keydown",e);this.on("keyup",e);let m;this.setInterval(function(){if(this.userActivity_){this.userActivity_=!1;this.userActive(!0);this.clearTimeout(m);var p=this.options_.inactivityTimeout;0>=p||(m=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},p))}},250)}playbackRate(a){if(void 0!==
a)this.techCall_("setPlaybackRate",a);else return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1}defaultPlaybackRate(a){return void 0!==a?this.techCall_("setDefaultPlaybackRate",a):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1}isAudio(a){if(void 0!==a)this.isAudio_=!!a;else return!!this.isAudio_}enableAudioOnlyUI_(){this.addClass("vjs-audio-only-mode");const a=this.children(),b=this.getChild("ControlBar"),
c=b&&b.currentHeight();a.forEach(e=>{e!==b&&e.el_&&!e.hasClass("vjs-hidden")&&(e.hide(),this.audioOnlyCache_.hiddenChildren.push(e))});this.audioOnlyCache_.playerHeight=this.currentHeight();this.height(c);this.trigger("audioonlymodechange")}disableAudioOnlyUI_(){this.removeClass("vjs-audio-only-mode");this.audioOnlyCache_.hiddenChildren.forEach(a=>a.show());this.height(this.audioOnlyCache_.playerHeight);this.trigger("audioonlymodechange")}audioOnlyMode(a){return"boolean"!==typeof a||a===this.audioOnlyMode_?
this.audioOnlyMode_:(this.audioOnlyMode_=a)?(a=[],this.isInPictureInPicture()&&a.push(this.exitPictureInPicture()),this.isFullscreen()&&a.push(this.exitFullscreen()),this.audioPosterMode()&&a.push(this.audioPosterMode(!1)),Promise.all(a).then(()=>this.enableAudioOnlyUI_())):Promise.resolve().then(()=>this.disableAudioOnlyUI_())}enablePosterModeUI_(){(this.tech_&&this.tech_).hide();this.addClass("vjs-audio-poster-mode");this.trigger("audiopostermodechange")}disablePosterModeUI_(){(this.tech_&&this.tech_).show();
this.removeClass("vjs-audio-poster-mode");this.trigger("audiopostermodechange")}audioPosterMode(a){return"boolean"!==typeof a||a===this.audioPosterMode_?this.audioPosterMode_:(this.audioPosterMode_=a)?this.audioOnlyMode()?this.audioOnlyMode(!1).then(()=>{this.enablePosterModeUI_()}):Promise.resolve().then(()=>{this.enablePosterModeUI_()}):Promise.resolve().then(()=>{this.disablePosterModeUI_()})}addTextTrack(a,b,c){if(this.tech_)return this.tech_.addTextTrack(a,b,c)}addRemoteTextTrack(a,b){if(this.tech_)return this.tech_.addRemoteTextTrack(a,
b)}removeRemoteTextTrack(a={}){let {track:b}=a;b||(b=a);if(this.tech_)return this.tech_.removeRemoteTextTrack(b)}getVideoPlaybackQuality(){return this.techGet_("getVideoPlaybackQuality")}videoWidth(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0}videoHeight(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0}language(a){if(void 0===a)return this.language_;this.language_!==String(a).toLowerCase()&&(this.language_=String(a).toLowerCase(),Fb(this)&&this.trigger("languagechange"))}languages(){return ka(oa.prototype.options_.languages,
this.languages_)}toJSON(){const a=ka(this.options_),b=a.tracks;a.tracks=[];for(let c=0;c<b.length;c++){let e=b[c];e=ka(e);e.player=void 0;a.tracks[c]=e}return a}createModal(a,b){b=b||{};b.content=a||"";const c=new Fc(this,b);this.addChild(c);c.on("dispose",()=>{this.removeChild(c)});c.open();return c}updateCurrentBreakpoint_(){if(this.responsive()){var a=this.currentBreakpoint(),b=this.currentWidth();for(let c=0;c<wg.length;c++){const e=wg[c];if(b<=this.breakpoints_[e]){if(a===e)break;a&&this.removeClass(pe[a]);
this.addClass(pe[e]);this.breakpoint_=e;break}}}}removeCurrentBreakpoint_(){const a=this.currentBreakpointClass();this.breakpoint_="";a&&this.removeClass(a)}breakpoints(a){if(void 0===a)return Object.assign(this.breakpoints_);this.breakpoint_="";this.breakpoints_=Object.assign({},Mo,a);this.updateCurrentBreakpoint_();return Object.assign(this.breakpoints_)}responsive(a){if(void 0===a)return this.responsive_;a=!!a;if(a!==this.responsive_)return(this.responsive_=a)?(this.on("playerresize",this.boundUpdateCurrentBreakpoint_),
this.updateCurrentBreakpoint_()):(this.off("playerresize",this.boundUpdateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),a}currentBreakpoint(){return this.breakpoint_}currentBreakpointClass(){return pe[this.breakpoint_]||""}loadMedia(a,b){if(a&&"object"===typeof a){this.reset();this.cache_.media=ka(a);var {artist:c,artwork:e,description:h,poster:m,src:p,textTracks:t,title:x}=this.cache_.media;!e&&m&&(this.cache_.media.artwork=[{src:m,type:Td(m)}]);p&&this.src(p);m&&this.poster(m);Array.isArray(t)&&
t.forEach(y=>this.addRemoteTextTrack(y,!1));this.titleBar&&this.titleBar.update({title:x,description:h||c||""});this.ready(b)}}getMedia(){if(!this.cache_.media){const b=this.poster();var a=this.currentSources();const c=Array.prototype.map.call(this.remoteTextTracks(),e=>({kind:e.kind,label:e.label,language:e.language,src:e.src}));a={src:a,textTracks:c};b&&(a.poster=b,a.artwork=[{src:a.poster,type:Td(a.poster)}]);return a}return ka(this.cache_.media)}static getTagSettings(a){const b={sources:[],tracks:[]};
var c=Qb(a),e=c["data-setup"];Zc(a,"vjs-fill")&&(c.fill=!0);Zc(a,"vjs-fluid")&&(c.fluid=!0);if(null!==e){const [h,m]=wm(e||"{}");h&&ca.error(h);Object.assign(c,m)}Object.assign(b,c);if(a.hasChildNodes()){a=a.childNodes;for(let h=0,m=a.length;h<m;h++)c=a[h],e=c.nodeName.toLowerCase(),"source"===e?b.sources.push(Qb(c)):"track"===e&&b.tracks.push(Qb(c))}return b}debug(a){if(void 0===a)return this.debugEnabled_;a?(this.trigger("debugon"),this.previousLogLevel_=this.log.level,this.log.level("debug"),this.debugEnabled_=
!0):(this.trigger("debugoff"),this.log.level(this.previousLogLevel_),this.previousLogLevel_=void 0,this.debugEnabled_=!1)}playbackRates(a){if(void 0===a)return this.cache_.playbackRates;Array.isArray(a)&&a.every(b=>"number"===typeof b)&&(this.cache_.playbackRates=a,this.trigger("playbackrateschange"))}}Qa.names.forEach(function(a){const b=Qa[a];oa.prototype[b.getterName]=function(){if(this.tech_)return this.tech_[b.getterName]();this[b.privateName]=this[b.privateName]||new b.ListClass;return this[b.privateName]}});
oa.prototype.crossorigin=oa.prototype.crossOrigin;oa.players={};const md=D.navigator;oa.prototype.options_={techOrder:Z.defaultTechOrder_,html5:{},enableSourceset:!0,inactivityTimeout:2E3,playbackRates:[],liveui:!1,children:"mediaLoader posterImage titleBar textTrackDisplay loadingSpinner bigPlayButton liveTracker controlBar errorDisplay textTrackSettings resizeManager".split(" "),language:md&&(md.languages&&md.languages[0]||md.userLanguage||md.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",
normalizeAutoplay:!1,fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:!1,audioOnlyMode:!1,audioPosterMode:!1};["ended","seeking","seekable","networkState","readyState"].forEach(function(a){oa.prototype[a]=function(){return this.techGet_(a)}});Xj.forEach(function(a){oa.prototype[`handleTech${sa(a)}_`]=function(){return this.trigger(a)}});M.registerComponent("Player",oa);const Ib={},qe=a=>Ib.hasOwnProperty(a)?Ib[a]:void 0,re=(a,b,c)=>{c=(c?"before":"")+"pluginsetup";a.trigger(c,
b);a.trigger(c+":"+b.name,b)},No=function(a,b){const c=function(){re(this,{name:a,plugin:b,instance:null},!0);const e=b.apply(this,arguments);this.activePlugins_=this.activePlugins_||{};this.activePlugins_[a]=!0;re(this,{name:a,plugin:b,instance:e});return e};Object.keys(b).forEach(function(e){c[e]=b[e]});return c},Yj=(a,b)=>{b.prototype.name=a;return function(...c){re(this,{name:a,plugin:b,instance:null},!0);const e=new b(...[this,...c]);this[a]=()=>e;re(this,e.getEventHash());return e}};class cb{constructor(a){if(this.constructor===
cb)throw Error("Plugin must be sub-classed; not directly instantiated.");this.player=a;this.log||(this.log=this.player.log.createLogger(this.name));tf(this);delete this.trigger;ai(this,this.constructor.defaultState);var b=this.name;a.activePlugins_=a.activePlugins_||{};a.activePlugins_[b]=!0;this.dispose=this.dispose.bind(this);a.on("dispose",this.dispose)}version(){return this.constructor.VERSION}getEventHash(a={}){a.name=this.name;a.plugin=this.constructor;a.instance=this;return a}trigger(a,b={}){return yc(this.eventBusEl_,
a,this.getEventHash(b))}handleStateChanged(a){}dispose(){const {name:a,player:b}=this;this.trigger("dispose");this.off();b.off("dispose",this.dispose);b.activePlugins_[a]=!1;this.player=this.state=null;b[a]=Yj(a,Ib[a])}static isBasic(a){a="string"===typeof a?qe(a):a;return"function"===typeof a&&!cb.prototype.isPrototypeOf(a.prototype)}static registerPlugin(a,b){if("string"!==typeof a)throw Error(`Illegal plugin name, "${a}", must be a string, was ${typeof a}.`);if(Ib.hasOwnProperty(a))ca.warn(`A plugin named "${a}" already exists. You may want to avoid re-registering plugins!`);
else if(oa.prototype.hasOwnProperty(a))throw Error(`Illegal plugin name, "${a}", cannot share a name with an existing player method!`);if("function"!==typeof b)throw Error(`Illegal plugin for "${a}", must be a function, was ${typeof b}.`);Ib[a]=b;"plugin"!==a&&(cb.isBasic(b)?oa.prototype[a]=No(a,b):oa.prototype[a]=Yj(a,b));return b}static deregisterPlugin(a){if("plugin"===a)throw Error("Cannot de-register base plugin.");Ib.hasOwnProperty(a)&&(delete Ib[a],delete oa.prototype[a])}static getPlugins(a=
Object.keys(Ib)){let b;a.forEach(c=>{const e=qe(c);e&&(b=b||{},b[c]=e)});return b}static getPluginVersion(a){return(a=qe(a))&&a.VERSION||""}}cb.getPlugin=qe;cb.BASE_PLUGIN_NAME="plugin";cb.registerPlugin("plugin",cb);oa.prototype.usingPlugin=function(a){return!!this.activePlugins_&&!0===this.activePlugins_[a]};oa.prototype.hasPlugin=function(a){return!!Ib.hasOwnProperty(a)};const ji=a=>0===a.indexOf("#")?a.slice(1):a;H.hooks_=Hb;H.hooks=Sb;H.hook=function(a,b){Sb(a,b)};H.hookOnce=function(a,b){Sb(a,
[].concat(b).map(c=>{const e=(...h)=>{Ti(a,e);return c(...h)};return e}))};H.removeHook=Ti;if(!0!==D.VIDEOJS_NO_DYNAMIC_STYLE&&uc()){let a=Rb(".vjs-styles-defaults");if(!a){a=bj("vjs-styles-defaults");const b=Rb("head");b&&b.insertBefore(a,b.firstChild);cj(a,"\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid:not(.vjs-audio-only-mode) {\n        padding-top: 56.25%\n      }\n    ")}}of(1,H);H.VERSION="8.3.0";H.options=oa.prototype.options_;H.getPlayers=
()=>oa.players;H.getPlayer=a=>{const b=oa.players;if("string"===typeof a){a=ji(a);const c=b[a];if(c)return c;a=Rb("#"+a)}if(vc(a)){const {player:c,playerId:e}=a;if(c||b[e])return c||b[e]}};H.getAllPlayers=()=>Object.keys(oa.players).map(a=>oa.players[a]).filter(Boolean);H.players=oa.players;H.getComponent=M.getComponent;H.registerComponent=(a,b)=>{Z.isTech(b)&&ca.warn(`The ${a} tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)`);M.registerComponent.call(M,
a,b)};H.getTech=Z.getTech;H.registerTech=Z.registerTech;H.use=function(a,b){$b[a]=$b[a]||[];$b[a].push(b)};Object.defineProperty(H,"middleware",{value:{},writeable:!1,enumerable:!0});Object.defineProperty(H.middleware,"TERMINATOR",{value:Sd,writeable:!1,enumerable:!0});H.browser=Wn;H.obj=Vn;H.mergeOptions=kb(9,"videojs.mergeOptions","videojs.obj.merge",ka);H.defineLazyProperty=kb(9,"videojs.defineLazyProperty","videojs.obj.defineLazyProperty",Ld);H.bind=kb(9,"videojs.bind","native Function.prototype.bind",
ma);H.registerPlugin=cb.registerPlugin;H.deregisterPlugin=cb.deregisterPlugin;H.plugin=(a,b)=>{ca.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead");return cb.registerPlugin(a,b)};H.getPlugins=cb.getPlugins;H.getPlugin=cb.getPlugin;H.getPluginVersion=cb.getPluginVersion;H.addLanguage=function(a,b){a=(""+a).toLowerCase();H.options.languages=ka(H.options.languages,{[a]:b});return H.options.languages[a]};H.log=ca;H.createLogger=Vi;H.time=ao;H.createTimeRange=kb(9,"videojs.createTimeRange",
"videojs.time.createTimeRanges",tb);H.createTimeRanges=kb(9,"videojs.createTimeRanges","videojs.time.createTimeRanges",tb);H.formatTime=kb(9,"videojs.formatTime","videojs.time.formatTime",Yb);H.setFormatTime=kb(9,"videojs.setFormatTime","videojs.time.setFormatTime",ci);H.resetFormatTime=kb(9,"videojs.resetFormatTime","videojs.time.resetFormatTime",di);H.parseUrl=kb(9,"videojs.parseUrl","videojs.url.parseUrl",ag);H.isCrossOrigin=kb(9,"videojs.isCrossOrigin","videojs.url.isCrossOrigin",le);H.EventTarget=
hb;H.any=sf;H.on=$a;H.one=Rd;H.off=Ha;H.trigger=yc;H.xhr=li;H.TextTrack=jd;H.AudioTrack=nj;H.VideoTrack=oj;"isEl isTextNode createEl hasClass addClass removeClass toggleClass setAttributes getAttributes emptyEl appendContent insertContent".split(" ").forEach(a=>{H[a]=function(){ca.warn(`videojs.${a}() is deprecated; use videojs.dom.${a}() instead`);return aj[a].apply(null,arguments)}});H.computedStyle=kb(9,"videojs.computedStyle","videojs.dom.computedStyle",xc);H.dom=aj;H.fn=Yn;H.num=uo;H.str=$n;
H.url=io;class Oo{constructor(a){let b=this;b.id=a.id;b.label=b.id;b.width=a.width;b.height=a.height;b.bitrate=a.bandwidth;b.frameRate=a.frameRate;b.enabled_=a.enabled;Object.defineProperty(b,"enabled",{get(){return b.enabled_()},set(c){b.enabled_(c)}});return b}}class se extends H.EventTarget{constructor(){super();let a=this;a.levels_=[];a.selectedIndex_=-1;Object.defineProperty(a,"selectedIndex",{get(){return a.selectedIndex_}});Object.defineProperty(a,"length",{get(){return a.levels_.length}});
return a}addQualityLevel(a){let b=this.getQualityLevelById(a.id);if(b)return b;const c=this.levels_.length;b=new Oo(a);""+c in this||Object.defineProperty(this,c,{get(){return this.levels_[c]}});this.levels_.push(b);this.trigger({qualityLevel:b,type:"addqualitylevel"});return b}removeQualityLevel(a){let b=null;for(let c=0,e=this.length;c<e;c++)if(this[c]===a){b=this.levels_.splice(c,1)[0];this.selectedIndex_===c?this.selectedIndex_=-1:this.selectedIndex_>c&&this.selectedIndex_--;break}b&&this.trigger({qualityLevel:a,
type:"removequalitylevel"});return b}getQualityLevelById(a){for(let b=0,c=this.length;b<c;b++){const e=this[b];if(e.id===a)return e}return null}dispose(){this.selectedIndex_=-1;this.levels_.length=0}}se.prototype.allowedEvents_={change:"change",addqualitylevel:"addqualitylevel",removequalitylevel:"removequalitylevel"};for(const a in se.prototype.allowedEvents_)se.prototype["on"+a]=null;const Po=function(a,b){const c=a.qualityLevels,e=new se,h=function(){e.dispose();a.qualityLevels=c;a.off("dispose",
h)};a.on("dispose",h);a.qualityLevels=()=>e;a.qualityLevels.VERSION="3.0.0";return e},Zj=function(a){return Po(this,H.mergeOptions({},a))};(H.registerPlugin||H.plugin)("qualityLevels",Zj);Zj.VERSION="3.0.0";const lb=function(a,b){if(/^[a-z]+:/i.test(b))return b;/^data:/.test(a)&&(a=D.location&&D.location.href||"");var c="function"===typeof D.URL,e=/^\/\//.test(a),h=!D.location&&!/\/\//i.test(a);c?a=new D.URL(a,D.location||"http://example.com"):/\/\//i.test(a)||(a=Wd.buildAbsoluteURL(D.location&&D.location.href||
"",a));return c?(a=new URL(b,a),h?a.href.slice(18):e?a.href.slice(a.protocol.length):a.href):Wd.buildAbsoluteURL(a,b)},te=(a,b)=>b&&b.responseURL&&a!==b.responseURL?b.responseURL:a,mb=a=>H.log.debug?H.log.debug.bind(H,"VHS:",`${a} >`):function(){},Ub=1/30,zb=3*Ub,ak=function(a,b){const c=[];let e;if(a&&a.length)for(e=0;e<a.length;e++)b(a.start(e),a.end(e))&&c.push([a.start(e),a.end(e)]);return Ia(c)},Kc=function(a,b){return ak(a,function(c,e){return c-zb<=b&&e+zb>=b})},ue=function(a,b){return ak(a,
function(c){return c-Ub>=b})},Qo=function(a,b){let c=null,e=null,h=0;const m=[],p=[];if(!(a&&a.length&&b&&b.length))return Ia();let t=a.length;for(;t--;)m.push({time:a.start(t),type:"start"}),m.push({time:a.end(t),type:"end"});for(t=b.length;t--;)m.push({time:b.start(t),type:"start"}),m.push({time:b.end(t),type:"end"});m.sort(function(x,y){return x.time-y.time});for(t=0;t<m.length;t++)"start"===m[t].type?(h++,2===h&&(c=m[t].time)):"end"===m[t].type&&(h--,1===h&&(e=m[t].time)),null!==c&&null!==e&&
(p.push([c,e]),e=c=null);return Ia(p)},bk=a=>{const b=[];if(!a||!a.length)return"";for(let c=0;c<a.length;c++)b.push(a.start(c)+" \x3d\x3e "+a.end(c));return b.join(", ")},Ro=function(a,b,c=1){return((a.length?a.end(a.length-1):0)-b)/c},gc=a=>{const b=[];for(let c=0;c<a.length;c++)b.push({start:a.start(c),end:a.end(c)});return b},So=function(a,b){if(a===b)return!1;if(!a&&b||!b&&a||a.length!==b.length)return!0;for(let c=0;c<a.length;c++)if(a.start(c)!==b.start(c)||a.end(c)!==b.end(c))return!0;return!1},
ck=function(a){if(a&&a.length&&a.end)return a.end(a.length-1)},xg=function(a,b){let c=0;if(!a||!a.length)return c;for(let e=0;e<a.length;e++){const h=a.start(e),m=a.end(e);b>m||(c=b>h&&b<=m?c+(m-b):c+(m-h))}return c},yg=(a,b)=>{if(!b.preload)return b.duration;let c=0;(b.parts||[]).forEach(function(e){c+=e.duration});(b.preloadHints||[]).forEach(function(e){"PART"===e.type&&(c+=a.partTargetDuration)});return c},zg=a=>(a.segments||[]).reduce((b,c,e)=>{c.parts?c.parts.forEach(function(h,m){b.push({duration:h.duration,
segmentIndex:e,partIndex:m,part:h,segment:c})}):b.push({duration:c.duration,segmentIndex:e,partIndex:null,segment:c,part:null});return b},[]),dk=a=>(a=a.segments&&a.segments.length&&a.segments[a.segments.length-1])&&a.parts||[],ek=({preloadSegment:a})=>{if(a){var {parts:b,preloadHints:c}=a;a=(c||[]).reduce((e,h)=>e+("PART"===h.type?1:0),0);return a+=b&&b.length?b.length:0}},fk=(a,b)=>b.endList?0:a&&a.suggestedPresentationDelay?a.suggestedPresentationDelay:(a=0<dk(b).length)&&b.serverControl&&b.serverControl.partHoldBack?
b.serverControl.partHoldBack:a&&b.partTargetDuration?3*b.partTargetDuration:b.serverControl&&b.serverControl.holdBack?b.serverControl.holdBack:b.targetDuration?3*b.targetDuration:0,To=function(a,b){let c=0;b-=a.mediaSequence;let e=a.segments[b];if(e){if("undefined"!==typeof e.start)return{result:e.start,precise:!0};if("undefined"!==typeof e.end)return{result:e.end-e.duration,precise:!0}}for(;b--;){e=a.segments[b];if("undefined"!==typeof e.end)return{result:c+e.end,precise:!0};c+=yg(a,e);if("undefined"!==
typeof e.start)return{result:c+e.start,precise:!0}}return{result:c,precise:!1}},gk=function(a,b,c){"undefined"===typeof b&&(b=a.mediaSequence+a.segments.length);if(b<a.mediaSequence)return 0;const e=To(a,b);if(e.precise)return e.result;a:{let h=0,m=b-a.mediaSequence;for(;m<a.segments.length;m++){b=a.segments[m];if("undefined"!==typeof b.start){a={result:b.start-h,precise:!0};break a}h+=yg(a,b);if("undefined"!==typeof b.end){a={result:b.end-h,precise:!0};break a}}a={result:-1,precise:!1}}return a.precise?
a.result:e.result+c},hk=function(a,b,c){if(!a)return 0;"number"!==typeof c&&(c=0);if("undefined"===typeof b){if(a.totalDuration)return a.totalDuration;if(!a.endList)return D.Infinity}return gk(a,b,c)},nd=function({defaultDuration:a,durationList:b,startIndex:c,endIndex:e}){let h=0;c>e&&([c,e]=[e,c]);if(0>c){for(;c<Math.min(0,e);c++)h+=a;c=0}for(a=c;a<e;a++)h+=b[a].duration;return h},ik=function(a,b,c,e){if(!a||!a.segments)return null;if(a.endList)return hk(a);if(null===b)return null;b=gk(a,a.mediaSequence+
a.segments.length,b||0);c&&(e="number"===typeof e?e:fk(null,a),b-=e);return Math.max(0,b)},jk=function(a){return a.excludeUntil&&a.excludeUntil>Date.now()},Ag=function(a){return a.excludeUntil&&Infinity===a.excludeUntil},ve=function(a){const b=jk(a);return!a.disabled&&!b},kk=function(a,b){return b.attributes&&b.attributes[a]},Bg=(a,b)=>{if(1===a.playlists.length)return!0;const c=b.attributes.BANDWIDTH||Number.MAX_VALUE;return 0===a.playlists.filter(e=>ve(e)?(e.attributes.BANDWIDTH||0)<c:!1).length},
Cg=(a,b)=>!a&&!b||!a&&b||a&&!b?!1:a===b||a.id&&b.id&&a.id===b.id||a.resolvedUri&&b.resolvedUri&&a.resolvedUri===b.resolvedUri||a.uri&&b.uri&&a.uri===b.uri?!0:!1,lk=function(a,b){a=a&&a.mediaGroups&&a.mediaGroups.AUDIO||{};let c=!1;for(const e in a){for(const h in a[e])if(c=b(a[e][h]))break;if(c)break}return!!c},od=a=>{if(!a||!a.playlists||!a.playlists.length)return lk(a,b=>b.playlists&&b.playlists.length||b.uri);for(let b=0;b<a.playlists.length;b++){const c=a.playlists[b],e=c.attributes&&c.attributes.CODECS;
if(!(e&&e.split(",").every(h=>qi(h))||lk(a,h=>Cg(c,h))))return!1}return!0};var Xa={liveEdgeDelay:fk,duration:hk,seekable:function(a,b,c){const e=b||0;a=ik(a,b,!0,c);return null===a?Ia():Ia(e,a)},getMediaInfoForTime:function({playlist:a,currentTime:b,startingSegmentIndex:c,startingPartIndex:e,startTime:h,exactManifestTimings:m}){let p=b-h;const t=zg(a);var x=0;for(let y=0;y<t.length;y++){const C=t[y];if(c===C.segmentIndex&&("number"!==typeof e||"number"!==typeof C.partIndex||e===C.partIndex)){x=y;
break}}if(0>p){if(0<x)for(c=x-1;0<=c;c--){e=t[c];p+=e.duration;if(m){if(0>p)continue}else if(0>=p+Ub)continue;return{partIndex:e.partIndex,segmentIndex:e.segmentIndex,startTime:h-nd({defaultDuration:a.targetDuration,durationList:t,startIndex:x,endIndex:c})}}return{partIndex:t[0]&&t[0].partIndex||null,segmentIndex:t[0]&&t[0].segmentIndex||0,startTime:b}}if(0>x){for(;0>x;x++)if(p-=a.targetDuration,0>p)return{partIndex:t[0]&&t[0].partIndex||null,segmentIndex:t[0]&&t[0].segmentIndex||0,startTime:b};x=
0}for(c=x;c<t.length;c++){e=t[c];p-=e.duration;if(m){if(0<p)continue}else if(0<=p-Ub)continue;return{partIndex:e.partIndex,segmentIndex:e.segmentIndex,startTime:h+nd({defaultDuration:a.targetDuration,durationList:t,startIndex:x,endIndex:c})}}return{segmentIndex:t[t.length-1].segmentIndex,partIndex:t[t.length-1].partIndex,startTime:b}},isEnabled:ve,isDisabled:function(a){return a.disabled},isExcluded:jk,isIncompatible:Ag,playlistEnd:ik,isAes:function(a){for(let b=0;b<a.segments.length;b++)if(a.segments[b].key)return!0;
return!1},hasAttribute:kk,estimateSegmentRequestTime:function(a,b,c,e=0){return kk("BANDWIDTH",c)?(a*c.attributes.BANDWIDTH-8*e)/b:NaN},isLowestEnabledRendition:Bg,isAudioOnly:od,playlistMatch:Cg,segmentDurationWithParts:yg};const {log:mk}=H,Uo=(a,b,c)=>`placeholder-uri-${a}-${b}-${c}`,Vo=({onwarn:a,oninfo:b,manifestString:c,customTagParsers:e=[],customTagMappers:h=[],llhls:m})=>{const p=new Lm;if(a)p.on("warn",a);if(b)p.on("info",b);e.forEach(x=>p.addParser(x));h.forEach(x=>p.addTagMapper(x));p.push(c);
p.end();const t=p.manifest;m||("preloadSegment skip serverControl renditionReports partInf partTargetDuration".split(" ").forEach(function(x){t.hasOwnProperty(x)&&delete t[x]}),t.segments&&t.segments.forEach(function(x){["parts","preloadHints"].forEach(function(y){x.hasOwnProperty(y)&&delete x[y]})}));t.targetDuration||(b=10,t.segments&&t.segments.length&&(b=t.segments.reduce((x,y)=>Math.max(x,y.duration),0)),a&&a(`manifest has no targetDuration defaulting to ${b}`),t.targetDuration=b);b=dk(t);b.length&&
!t.partTargetDuration&&(b=b.reduce((x,y)=>Math.max(x,y.duration),0),a&&(a(`manifest has no partTargetDuration defaulting to ${b}`),mk.error("LL-HLS manifest has parts but lacks required #EXT-X-PART-INF:PART-TARGET value. See https://datatracker.ietf.org/doc/html/draft-pantos-hls-rfc8216bis-09#section-4.4.3.7. Playback is not guaranteed.")),t.partTargetDuration=b);return t},Lc=(a,b)=>{a.mediaGroups&&["AUDIO","SUBTITLES"].forEach(c=>{if(a.mediaGroups[c])for(const e in a.mediaGroups[c])for(const h in a.mediaGroups[c][e])b(a.mediaGroups[c][e][h],
c,e,h)})},nk=({playlist:a,uri:b,id:c})=>{a.id=c;a.playlistErrors_=0;b&&(a.uri=b);a.attributes=a.attributes||{}},Wo=a=>{let b=a.playlists.length;for(;b--;){const c=a.playlists[b];nk({playlist:c,id:`${b}-${c.uri}`});c.resolvedUri=lb(a.uri,c.uri);a.playlists[c.id]=c;a.playlists[c.uri]=c;c.attributes.BANDWIDTH||mk.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")}},Xo=a=>{Lc(a,b=>{b.uri&&(b.resolvedUri=lb(a.uri,b.uri))})},Yo=(a,b)=>{a=`${0}-${b}`;const c={mediaGroups:{AUDIO:{},
VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:D.location.href,resolvedUri:D.location.href,playlists:[{uri:b,id:a,resolvedUri:b,attributes:{}}]};c.playlists[a]=c.playlists[0];c.playlists[b]=c.playlists[0];return c},ok=(a,b,c=Uo)=>{a.uri=b;for(b=0;b<a.playlists.length;b++)a.playlists[b].uri||(a.playlists[b].uri=`placeholder-uri-${b}`);const e=od(a);Lc(a,(h,m,p,t)=>{if(!h.playlists||!h.playlists.length){if(e&&"AUDIO"===m&&!h.uri)for(let x=0;x<a.playlists.length;x++){const y=a.playlists[x];if(y.attributes&&
y.attributes.AUDIO&&y.attributes.AUDIO===p)return}h.playlists=[Nb({},h)]}h.playlists.forEach(function(x,y){const C=c(m,p,t,x),z=`${y}-${C}`;x.uri?x.resolvedUri=x.resolvedUri||lb(a.uri,x.uri):(x.uri=0===y?C:z,x.resolvedUri=x.uri);x.id=x.id||z;x.attributes=x.attributes||{};a.playlists[x.id]=x;a.playlists[x.uri]=x})});Wo(a);Xo(a)},{EventTarget:Zo}=H,$o=(a,b)=>{if(b.endList||!b.serverControl)return a;const c={};if(b.serverControl.canBlockReload){var {preloadSegment:e}=b;let h=b.mediaSequence+b.segments.length;
if(e){e=e.parts||[];const m=ek(b)-1;-1<m&&m!==e.length-1&&(c._HLS_part=m);(-1<m||e.length)&&h--}c._HLS_msn=h}b.serverControl&&b.serverControl.canSkipUntil&&(c._HLS_skip=b.serverControl.canSkipDateranges?"v2":"YES");if(Object.keys(c).length){const h=new D.URL(a);["_HLS_skip","_HLS_msn","_HLS_part"].forEach(function(m){c.hasOwnProperty(m)&&h.searchParams.set(m,c[m])});a=h.toString()}return a},ap=(a,b,c)=>{a=a.slice();b=b.slice();c=c||0;const e=[];let h;for(let y=0;y<b.length;y++){var m=a[y+c],p=b[y];
if(m){h=m.map||h;var t=e,x=t.push;a:{if(!m){m=p;break a}const C=la(m,p);m.preloadHints&&!p.preloadHints&&delete C.preloadHints;if(m.parts&&!p.parts)delete C.parts;else if(m.parts&&p.parts)for(let z=0;z<p.parts.length;z++)m.parts&&m.parts[z]&&(C.parts[z]=la(m.parts[z],p.parts[z]));!m.skipped&&p.skipped&&(C.skipped=!1);m.preload&&!p.preload&&(C.preload=!1);m=C}x.call(t,m)}else h&&!p.map&&(p.map=h),e.push(p)}return e},pk=(a,b)=>{!a.resolvedUri&&a.uri&&(a.resolvedUri=lb(b,a.uri));a.key&&!a.key.resolvedUri&&
(a.key.resolvedUri=lb(b,a.key.uri));a.map&&!a.map.resolvedUri&&(a.map.resolvedUri=lb(b,a.map.uri));a.map&&a.map.key&&!a.map.key.resolvedUri&&(a.map.key.resolvedUri=lb(b,a.map.key.uri));a.parts&&a.parts.length&&a.parts.forEach(c=>{c.resolvedUri||(c.resolvedUri=lb(b,c.uri))});a.preloadHints&&a.preloadHints.length&&a.preloadHints.forEach(c=>{c.resolvedUri||(c.resolvedUri=lb(b,c.uri))})},qk=function(a){const b=a.segments||[],c=a.preloadSegment;if(c&&c.parts&&c.parts.length){if(c.preloadHints)for(let e=
0;e<c.preloadHints.length;e++)if("MAP"===c.preloadHints[e].type)return b;c.duration=a.targetDuration;c.preload=!0;b.push(c)}return b},rk=(a,b)=>a===b||a.segments&&b.segments&&a.segments.length===b.segments.length&&a.endList===b.endList&&a.mediaSequence===b.mediaSequence&&a.preloadSegment===b.preloadSegment,Dg=(a,b,c=rk)=>{const e=la(a,{});var h=e.playlists[b.id];if(!h||c(h,b))return null;b.segments=qk(b);const m=la(h,b);m.preloadSegment&&!b.preloadSegment&&delete m.preloadSegment;if(h.segments){if(b.skip)for(b.segments=
b.segments||[],c=0;c<b.skip.skippedSegments;c++)b.segments.unshift({skipped:!0});m.segments=ap(h.segments,b.segments,b.mediaSequence-h.mediaSequence)}m.segments.forEach(p=>{pk(p,m.resolvedUri)});for(h=0;h<e.playlists.length;h++)e.playlists[h].id===b.id&&(e.playlists[h]=m);e.playlists[b.id]=m;e.playlists[b.uri]=m;Lc(a,(p,t,x,y)=>{if(p.playlists)for(t=0;t<p.playlists.length;t++)b.id===p.playlists[t].id&&(p.playlists[t]=m)});return e},Eg=(a,b)=>{var c=a.segments||[];const e=(c=c[c.length-1])&&c.parts&&
c.parts[c.parts.length-1];c=e&&e.duration||c&&c.duration;return b&&c?1E3*c:500*(a.partTargetDuration||a.targetDuration||10)};class Mc extends Zo{constructor(a,b,c={}){super();if(!a)throw Error("A non-empty playlist URL or object is required");this.logger_=mb("PlaylistLoader");({withCredentials:c=!1}=c);this.src=a;this.vhs_=b;this.withCredentials=c;this.customTagParsers=(a=b.options_)&&a.customTagParsers||[];this.customTagMappers=a&&a.customTagMappers||[];this.llhls=a&&a.llhls;this.state="HAVE_NOTHING";
this.handleMediaupdatetimeout_=this.handleMediaupdatetimeout_.bind(this);this.on("mediaupdatetimeout",this.handleMediaupdatetimeout_)}handleMediaupdatetimeout_(){if("HAVE_METADATA"===this.state){var a=this.media(),b=lb(this.main.uri,a.uri);this.llhls&&(b=$o(b,a));this.state="HAVE_CURRENT_METADATA";this.request=this.vhs_.xhr({uri:b,withCredentials:this.withCredentials},(c,e)=>{if(this.request){if(c)return this.playlistRequestError(this.request,this.media(),"HAVE_METADATA");this.haveMetadata({playlistString:this.request.responseText,
url:this.media().uri,id:this.media().id})}})}}playlistRequestError(a,b,c){const {uri:e,id:h}=b;this.request=null;c&&(this.state=c);this.error={playlist:this.main.playlists[h],status:a.status,message:`HLS playlist request error at URL: ${e}.`,responseText:a.responseText,code:500<=a.status?4:2};this.trigger("error")}parseManifest_({url:a,manifestString:b}){return Vo({onwarn:({message:c})=>this.logger_(`m3u8-parser warn for ${a}: ${c}`),oninfo:({message:c})=>this.logger_(`m3u8-parser info for ${a}: ${c}`),
manifestString:b,customTagParsers:this.customTagParsers,customTagMappers:this.customTagMappers,llhls:this.llhls})}haveMetadata({playlistString:a,playlistObject:b,url:c,id:e}){this.request=null;this.state="HAVE_METADATA";a=b||this.parseManifest_({url:c,manifestString:a});a.lastRequest=Date.now();nk({playlist:a,uri:c,id:e});c=Dg(this.main,a);this.targetDuration=a.partTargetDuration||a.targetDuration;this.pendingMedia_=null;c?(this.main=c,this.media_=this.main.playlists[e]):this.trigger("playlistunchanged");
this.updateMediaUpdateTimeout_(Eg(this.media(),!!c));this.trigger("loadedplaylist")}dispose(){this.trigger("dispose");this.stopRequest();D.clearTimeout(this.mediaUpdateTimeout);D.clearTimeout(this.finalRenditionTimeout);this.off()}stopRequest(){if(this.request){const a=this.request;this.request=null;a.onreadystatechange=null;a.abort()}}media(a,b){if(!a)return this.media_;if("HAVE_NOTHING"===this.state)throw Error("Cannot switch media playlist from "+this.state);if("string"===typeof a){if(!this.main.playlists[a])throw Error("Unknown playlist URI: "+
a);a=this.main.playlists[a]}D.clearTimeout(this.finalRenditionTimeout);if(b)b=(a.partTargetDuration||a.targetDuration)/2*1E3||5E3,this.finalRenditionTimeout=D.setTimeout(this.media.bind(this,a,!1),b);else{var c=this.state;b=!this.media_||a.id!==this.media_.id;var e=this.main.playlists[a.id];if(e&&e.endList||a.endList&&a.segments.length)this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=a,b&&(this.trigger("mediachanging"),
"HAVE_MAIN_MANIFEST"===c?this.trigger("loadedmetadata"):this.trigger("mediachange"));else if(this.updateMediaUpdateTimeout_(Eg(a,!0)),b){this.state="SWITCHING_MEDIA";if(this.request){if(a.resolvedUri===this.request.url)return;this.request.onreadystatechange=null;this.request.abort();this.request=null}this.media_&&this.trigger("mediachanging");this.pendingMedia_=a;this.request=this.vhs_.xhr({uri:a.resolvedUri,withCredentials:this.withCredentials},(h,m)=>{if(this.request){a.lastRequest=Date.now();a.resolvedUri=
te(a.resolvedUri,m);if(h)return this.playlistRequestError(this.request,a,c);this.haveMetadata({playlistString:m.responseText,url:a.uri,id:a.id});"HAVE_MAIN_MANIFEST"===c?this.trigger("loadedmetadata"):this.trigger("mediachange")}})}}}pause(){this.mediaUpdateTimeout&&(D.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null);this.stopRequest();"HAVE_NOTHING"===this.state&&(this.started=!1);"SWITCHING_MEDIA"===this.state?this.state=this.media_?"HAVE_METADATA":"HAVE_MAIN_MANIFEST":"HAVE_CURRENT_METADATA"===
this.state&&(this.state="HAVE_METADATA")}load(a){this.mediaUpdateTimeout&&(D.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null);const b=this.media();a?this.mediaUpdateTimeout=D.setTimeout(()=>{this.mediaUpdateTimeout=null;this.load()},b?(b.partTargetDuration||b.targetDuration)/2*1E3:5E3):this.started?b&&!b.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist"):this.start()}updateMediaUpdateTimeout_(a){this.mediaUpdateTimeout&&(D.clearTimeout(this.mediaUpdateTimeout),
this.mediaUpdateTimeout=null);this.media()&&!this.media().endList&&(this.mediaUpdateTimeout=D.setTimeout(()=>{this.mediaUpdateTimeout=null;this.trigger("mediaupdatetimeout");this.updateMediaUpdateTimeout_(a)},a))}start(){this.started=!0;"object"===typeof this.src?(this.src.uri||(this.src.uri=D.location.href),this.src.resolvedUri=this.src.uri,setTimeout(()=>{this.setupInitialPlaylist(this.src)},0)):this.request=this.vhs_.xhr({uri:this.src,withCredentials:this.withCredentials},(a,b)=>{if(this.request){this.request=
null;if(a)return this.error={status:b.status,message:`HLS playlist request error at URL: ${this.src}.`,responseText:b.responseText,code:2},"HAVE_NOTHING"===this.state&&(this.started=!1),this.trigger("error");this.src=te(this.src,b);a=this.parseManifest_({manifestString:b.responseText,url:this.src});this.setupInitialPlaylist(a)}})}srcUri(){return"string"===typeof this.src?this.src:this.src.uri}setupInitialPlaylist(a){this.state="HAVE_MAIN_MANIFEST";if(a.playlists)this.main=a,ok(this.main,this.srcUri()),
a.playlists.forEach(c=>{c.segments=qk(c);c.segments.forEach(e=>{pk(e,c.resolvedUri)})}),this.trigger("loadedplaylist"),this.request||this.media(this.main.playlists[0]);else{var b=this.srcUri()||D.location.href;this.main=Yo(a,b);this.haveMetadata({playlistObject:a,url:b,id:this.main.playlists[0].id});this.trigger("loadedmetadata")}}}const {xhr:bp}=H,Fg=function(a,b,c,e){const h="arraybuffer"===a.responseType?a.response:a.responseText;!b&&h&&(a.responseTime=Date.now(),a.roundTripTime=a.responseTime-
a.requestTime,a.bytesReceived=h.byteLength||h.length,a.bandwidth||(a.bandwidth=Math.floor(a.bytesReceived/a.roundTripTime*8E3)));c.headers&&(a.responseHeaders=c.headers);b&&"ETIMEDOUT"===b.code&&(a.timedout=!0);b||a.aborted||200===c.statusCode||206===c.statusCode||0===c.statusCode||(b=Error("XHR Failed with a response of: "+(a&&(h||a.responseText))));e(b,a)},sk=function(){const a=function h(c,e){c=la({timeout:45E3},c);var m=h.beforeRequest||H.Vhs.xhr.beforeRequest;m&&"function"===typeof m&&(m=m(c))&&
(c=m);const p=(!0===H.Vhs.xhr.original?bp:H.Vhs.xhr)(c,function(x,y){return Fg(p,x,y,e)}),t=p.abort;p.abort=function(){p.aborted=!0;return t.apply(p,arguments)};p.uri=c.uri;p.requestTime=Date.now();return p};a.original=!0;return a},Gg=function(a){const b={};if(a.byterange){var c=a.byterange;a=c.offset;c="bigint"===typeof c.offset||"bigint"===typeof c.length?D.BigInt(c.offset)+D.BigInt(c.length)-D.BigInt(1):c.offset+c.length-1;b.Range="bytes\x3d"+a+"-"+c}return b},cp=function(a,b){a=a.toString(16);
return"00".substring(0,2-a.length)+a+(b%2?" ":"")},dp=function(a){return 32<=a&&126>a?String.fromCharCode(a):"."},tk=function(a){const b={};Object.keys(a).forEach(c=>{const e=a[c];si(e)?b[c]={bytes:e.buffer,byteOffset:e.byteOffset,byteLength:e.byteLength}:b[c]=e});return b},we=function(a){const b=a.byterange||{length:Infinity,offset:0};return[b.length,b.offset,a.resolvedUri].join()},uk=a=>{a=Array.prototype.slice.call(a);let b="",c,e;for(let h=0;h<a.length/16;h++)c=a.slice(16*h,16*h+16).map(cp).join(""),
e=a.slice(16*h,16*h+16).map(dp).join(""),b+=c+" "+e+"\n";return b};var ep=Object.freeze({__proto__:null,createTransferableMessage:tk,initSegmentId:we,segmentKeyId:function(a){return a.resolvedUri},hexDump:uk,tagDump:({bytes:a})=>uk(a),textRanges:a=>{var b="";let c;for(c=0;c<a.length;c++){var e=a;var h=c;e=e.start(h)+"-"+e.end(h);b+=e+" "}return b}});const fp=(a,b)=>{let c;try{c=new Date(a)}catch(p){return null}if(!b||!b.segments||0===b.segments.length)return null;a=b.segments[0];if(c<a.dateTimeObject)return null;
for(var e=0;e<b.segments.length-1&&!(a=b.segments[e],c<b.segments[e+1].dateTimeObject);e++);e=b.segments[b.segments.length-1];const h=e.dateTimeObject;if(e.videoTimingInfo){var m=e.videoTimingInfo;m=m.transmuxedPresentationEnd-m.transmuxedPresentationStart-m.transmuxerPrependedSeconds}else m=e.duration+.25*e.duration;m=new Date(h.getTime()+1E3*m);if(c>m)return null;c>h&&(a=e);return{segment:a,estimatedStart:a.videoTimingInfo?a.videoTimingInfo.transmuxedPresentationStart:Xa.duration(b,b.mediaSequence+
b.segments.indexOf(a)),type:a.videoTimingInfo?"accurate":"estimate"}},gp=(a,b)=>{if(!b||!b.segments||0===b.segments.length)return null;let c=0,e;for(let h=0;h<b.segments.length&&!(e=b.segments[h],c=e.videoTimingInfo?e.videoTimingInfo.transmuxedPresentationEnd:c+e.duration,a<=c);h++);b=b.segments[b.segments.length-1];if(b.videoTimingInfo&&b.videoTimingInfo.transmuxedPresentationEnd<a)return null;if(a>c){if(a>c+.25*b.duration)return null;e=b}return{segment:e,estimatedStart:e.videoTimingInfo?e.videoTimingInfo.transmuxedPresentationStart:
c-e.duration,type:e.videoTimingInfo?"accurate":"estimate"}},hp=(a,b)=>{let c,e;try{c=new Date(a),e=new Date(b)}catch(h){}a=c.getTime();return(e.getTime()-a)/1E3},ip=a=>{if(!a.segments||0===a.segments.length)return!1;for(let b=0;b<a.segments.length;b++)if(!a.segments[b].dateTimeObject)return!1;return!0},jp=({playlist:a,time:b,callback:c})=>{if(!c)throw Error("getProgramTime: callback must be provided");if(!a||void 0===b)return c({message:"getProgramTime: playlist and time must be provided"});var e=
gp(b,a);if(!e)return c({message:"valid programTime was not found"});if("estimate"===e.type)return c({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:e.estimatedStart});a={mediaSeconds:b};e=e.segment;e.dateTimeObject?(b-=e.videoTimingInfo.transmuxedPresentationStart+e.videoTimingInfo.transmuxerPrependedSeconds,b=new Date(e.dateTimeObject.getTime()+1E3*b)):b=null;b&&(a.programDateTime=b.toISOString());return c(null,a)},vk=({programTime:a,playlist:b,
retryCount:c=2,seekTo:e,pauseAfterSeek:h=!0,tech:m,callback:p})=>{if(!p)throw Error("seekToProgramTime: callback must be provided");if("undefined"===typeof a||!b||!e)return p({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});if(!b.endList&&!m.hasStarted_)return p({message:"player must be playing a live stream to start buffering"});if(!ip(b))return p({message:"programDateTime tags must be provided in the manifest "+b.resolvedUri});var t=fp(a,b);if(!t)return p({message:`${a} was not found in the stream`});
const x=t.segment,y=hp(x.dateTimeObject,a);if("estimate"===t.type){if(0===c)return p({message:`${a} is not buffered yet. Try again`});e(t.estimatedStart+y);m.one("seeked",()=>{vk({programTime:a,playlist:b,retryCount:c-1,seekTo:e,pauseAfterSeek:h,tech:m,callback:p})})}else t=x.start+y,m.one("seeked",()=>p(null,m.currentTime())),h&&m.pause(),e(t)},wk=(a,b)=>{if(4===a.readyState)return b()},kp=(a,b,c)=>{let e=[],h,m=!1;const p=function(y,C,z,E){C.abort();m=!0;return c(y,C,z,E)},t=function(y,C){if(!m){if(y)return p(y,
C,"",e);var z=C.responseText.substring(e&&e.byteLength||0,C.responseText.length);e=Tm(e,ti(z,!0));h=h||ed(e);if(10>e.length||h&&e.length<h+2)return wk(C,()=>p(y,C,"",e));z=Rf(e);return"ts"===z&&188>e.length||!z&&376>e.length?wk(C,()=>p(y,C,"",e)):p(null,C,z,e)}},x=b({uri:a,beforeSend(y){y.overrideMimeType("text/plain; charset\x3dx-user-defined");y.addEventListener("progress",function({}){return Fg(y,null,{statusCode:y.status},t)})}},function(y,C){return Fg(x,y,C,t)});return x},{EventTarget:lp}=H,
xk=function(a,b){if(!rk(a,b)||a.sidx&&b.sidx&&(a.sidx.offset!==b.sidx.offset||a.sidx.length!==b.sidx.length)||!a.sidx&&b.sidx||a.sidx&&!b.sidx||a.segments&&!b.segments||!a.segments&&b.segments)return!1;if(!a.segments&&!b.segments)return!0;for(let h=0;h<a.segments.length;h++){var c=a.segments[h],e=b.segments[h];if(c.uri!==e.uri)return!1;if(c.byterange||e.byterange)if(c=c.byterange,e=e.byterange,c&&!e||!c&&e||c.offset!==e.offset||c.length!==e.length)return!1}return!0},mp=(a,b,c,e)=>`placeholder-uri-${a}-${b}-${e.attributes.NAME||
c}`,np=({mainXml:a,srcUrl:b,clientOffset:c,sidxMapping:e,previousManifest:h})=>{a=Jn(a,{manifestUri:b,clientOffset:c,sidxMapping:e,previousManifest:h});ok(a,b,mp);return a},op=(a,b)=>{Lc(a,(c,e,h,m)=>{m in b.mediaGroups[e][h]||delete a.mediaGroups[e][h][m]})},pp=(a,b,c)=>{let e=!0,h=la(a,{duration:b.duration,minimumUpdatePeriod:b.minimumUpdatePeriod,timelineStarts:b.timelineStarts});for(let p=0;p<b.playlists.length;p++){var m=b.playlists[p];if(m.sidx){const t=Zd(m.sidx);c&&c[t]&&c[t].sidx&&Lf(m,c[t].sidx,
m.sidx.resolvedUri)}if(m=Dg(h,m,xk))h=m,e=!1}Lc(b,(p,t,x,y)=>{if(p.playlists&&p.playlists.length){const C=p.playlists[0].id,z=Dg(h,p.playlists[0],xk);z&&(h=z,y in h.mediaGroups[t][x]||(h.mediaGroups[t][x][y]=p),h.mediaGroups[t][x][y].playlists[0]=h.playlists[C],e=!1)}});op(h,b);b.minimumUpdatePeriod!==a.minimumUpdatePeriod&&(e=!1);return e?null:h},yk=(a,b)=>{const c={};for(const e in a){const h=a[e].sidx;if(h){const m=Zd(h);if(!b[m])break;const p=b[m].sidxInfo;(!p.map&&!h.map||p.map&&h.map&&p.map.byterange.offset===
h.map.byterange.offset&&p.map.byterange.length===h.map.byterange.length)&&p.uri===h.uri&&p.byterange.offset===h.byterange.offset&&p.byterange.length===h.byterange.length&&(c[m]=b[m])}}return c},qp=(a,b)=>{let c=yk(a.playlists,b);Lc(a,(e,h,m,p)=>{e.playlists&&e.playlists.length&&(c=la(c,yk(e.playlists,b)))});return c};class Hg extends lp{constructor(a,b,c={},e){super();this.mainPlaylistLoader_=e||this;e||(this.isMain_=!0);({withCredentials:c=!1}=c);this.vhs_=b;this.withCredentials=c;if(!a)throw Error("A non-empty playlist URL or object is required");
this.on("minimumUpdatePeriod",()=>{this.refreshXml_()});this.on("mediaupdatetimeout",()=>{this.refreshMedia_(this.media().id)});this.state="HAVE_NOTHING";this.loadedPlaylists_={};this.logger_=mb("DashPlaylistLoader");this.isMain_?(this.mainPlaylistLoader_.srcUrl=a,this.mainPlaylistLoader_.sidxMapping_={}):this.childPlaylist_=a}requestErrored_(a,b,c){if(!this.request)return!0;this.request=null;if(a)return this.error="object"!==typeof a||a instanceof Error?{status:b.status,message:"DASH request error at URL: "+
b.uri,response:b.response,code:2}:a,c&&(this.state=c),this.trigger("error"),!0}addSidxSegments_(a,b,c){const e=a.sidx&&Zd(a.sidx);if(a.sidx&&e&&!this.mainPlaylistLoader_.sidxMapping_[e]){var h=te(a.sidx.resolvedUri),m=(p,t)=>{if(!this.requestErrored_(p,t,b)){p=this.mainPlaylistLoader_.sidxMapping_;try{var x=Ln(T(t.response).subarray(8))}catch(y){this.requestErrored_(y,t,b);return}p[e]={sidxInfo:a.sidx,sidx:x};Lf(a,x,a.sidx.resolvedUri);return c(!0)}};this.request=kp(h,this.vhs_.xhr,(p,t,x,y)=>{if(p)return m(p,
t);if(!x||"mp4"!==x)return m({status:t.status,message:`Unsupported ${x||"unknown"} container type for sidx segment at URL: ${h}`,response:"",playlist:a,internal:!0,playlistExclusionDuration:Infinity,code:2},t);const {offset:C,length:z}=a.sidx.byterange;if(y.length>=z+C)return m(p,{response:y.subarray(C,C+z),status:t.status,uri:t.uri});this.request=this.vhs_.xhr({uri:h,responseType:"arraybuffer",headers:Gg({byterange:a.sidx.byterange})},m)})}else this.mediaRequest_=D.setTimeout(()=>c(!1),0)}dispose(){this.trigger("dispose");
this.stopRequest();this.loadedPlaylists_={};D.clearTimeout(this.minimumUpdatePeriodTimeout_);D.clearTimeout(this.mediaRequest_);D.clearTimeout(this.mediaUpdateTimeout);this.minimumUpdatePeriodTimeout_=this.mediaRequest_=this.mediaUpdateTimeout=null;this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null);this.off()}hasPendingRequest(){return this.request||this.mediaRequest_}stopRequest(){if(this.request){const a=
this.request;this.request=null;a.onreadystatechange=null;a.abort()}}media(a){if(!a)return this.media_;if("HAVE_NOTHING"===this.state)throw Error("Cannot switch media playlist from "+this.state);const b=this.state;if("string"===typeof a){if(!this.mainPlaylistLoader_.main.playlists[a])throw Error("Unknown playlist URI: "+a);a=this.mainPlaylistLoader_.main.playlists[a]}const c=!this.media_||a.id!==this.media_.id;c&&this.loadedPlaylists_[a.id]&&this.loadedPlaylists_[a.id].endList?(this.state="HAVE_METADATA",
this.media_=a,c&&(this.trigger("mediachanging"),this.trigger("mediachange"))):c&&(this.media_&&this.trigger("mediachanging"),this.addSidxSegments_(a,b,e=>{this.haveMetadata({startingState:b,playlist:a})}))}haveMetadata({startingState:a,playlist:b}){this.state="HAVE_METADATA";this.loadedPlaylists_[b.id]=b;this.mediaRequest_=null;this.refreshMedia_(b.id);"HAVE_MAIN_MANIFEST"===a?this.trigger("loadedmetadata"):this.trigger("mediachange")}pause(){this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",
this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null);this.stopRequest();D.clearTimeout(this.mediaUpdateTimeout);this.mediaUpdateTimeout=null;this.isMain_&&(D.clearTimeout(this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_),this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_=null);"HAVE_NOTHING"===this.state&&(this.started=!1)}load(a){D.clearTimeout(this.mediaUpdateTimeout);this.mediaUpdateTimeout=null;const b=this.media();a?this.mediaUpdateTimeout=D.setTimeout(()=>
this.load(),b?b.targetDuration/2*1E3:5E3):this.started?b&&!b.endList?(this.isMain_&&!this.minimumUpdatePeriodTimeout_&&(this.trigger("minimumUpdatePeriod"),this.updateMinimumUpdatePeriodTimeout_()),this.trigger("mediaupdatetimeout")):this.trigger("loadedplaylist"):this.start()}start(){this.started=!0;this.isMain_?this.requestMain_((a,b)=>{this.haveMain_();this.hasPendingRequest()||this.media_||this.media(this.mainPlaylistLoader_.main.playlists[0])}):this.mediaRequest_=D.setTimeout(()=>this.haveMain_(),
0)}requestMain_(a){this.request=this.vhs_.xhr({uri:this.mainPlaylistLoader_.srcUrl,withCredentials:this.withCredentials},(b,c)=>{if(this.requestErrored_(b,c))"HAVE_NOTHING"===this.state&&(this.started=!1);else{var e=c.responseText!==this.mainPlaylistLoader_.mainXml_;this.mainPlaylistLoader_.mainXml_=c.responseText;this.mainLoaded_=c.responseHeaders&&c.responseHeaders.date?Date.parse(c.responseHeaders.date):Date.now();this.mainPlaylistLoader_.srcUrl=te(this.mainPlaylistLoader_.srcUrl,c);if(e)this.handleMain_(),
this.syncClientServerClock_(()=>a(c,e));else return a(c,e)}})}syncClientServerClock_(a){const b=In(Li(this.mainPlaylistLoader_.mainXml_));if(null===b)return this.mainPlaylistLoader_.clientOffset_=this.mainLoaded_-Date.now(),a();if("DIRECT"===b.method)return this.mainPlaylistLoader_.clientOffset_=b.value-Date.now(),a();this.request=this.vhs_.xhr({uri:lb(this.mainPlaylistLoader_.srcUrl,b.value),method:b.method,withCredentials:this.withCredentials},(c,e)=>{if(this.request){if(c)return this.mainPlaylistLoader_.clientOffset_=
this.mainLoaded_-Date.now(),a();c="HEAD"===b.method?e.responseHeaders&&e.responseHeaders.date?Date.parse(e.responseHeaders.date):this.mainLoaded_:Date.parse(e.responseText);this.mainPlaylistLoader_.clientOffset_=c-Date.now();a()}})}haveMain_(){this.state="HAVE_MAIN_MANIFEST";this.isMain_?this.trigger("loadedplaylist"):this.media_||this.media(this.childPlaylist_)}handleMain_(){this.mediaRequest_=null;const a=this.mainPlaylistLoader_.main;let b=np({mainXml:this.mainPlaylistLoader_.mainXml_,srcUrl:this.mainPlaylistLoader_.srcUrl,
clientOffset:this.mainPlaylistLoader_.clientOffset_,sidxMapping:this.mainPlaylistLoader_.sidxMapping_,previousManifest:a});a&&(b=pp(a,b,this.mainPlaylistLoader_.sidxMapping_));this.mainPlaylistLoader_.main=b?b:a;const c=this.mainPlaylistLoader_.main.locations&&this.mainPlaylistLoader_.main.locations[0];c&&c!==this.mainPlaylistLoader_.srcUrl&&(this.mainPlaylistLoader_.srcUrl=c);(!a||b&&b.minimumUpdatePeriod!==a.minimumUpdatePeriod)&&this.updateMinimumUpdatePeriodTimeout_();return!!b}updateMinimumUpdatePeriodTimeout_(){const a=
this.mainPlaylistLoader_;a.createMupOnMedia_&&(a.off("loadedmetadata",a.createMupOnMedia_),a.createMupOnMedia_=null);a.minimumUpdatePeriodTimeout_&&(D.clearTimeout(a.minimumUpdatePeriodTimeout_),a.minimumUpdatePeriodTimeout_=null);let b=a.main&&a.main.minimumUpdatePeriod;0===b&&(a.media()?b=1E3*a.media().targetDuration:(a.createMupOnMedia_=a.updateMinimumUpdatePeriodTimeout_,a.one("loadedmetadata",a.createMupOnMedia_)));"number"!==typeof b||0>=b?0>b&&this.logger_(`found invalid minimumUpdatePeriod of ${b}, not setting a timeout`):
this.createMUPTimeout_(b)}createMUPTimeout_(a){const b=this.mainPlaylistLoader_;b.minimumUpdatePeriodTimeout_=D.setTimeout(()=>{b.minimumUpdatePeriodTimeout_=null;b.trigger("minimumUpdatePeriod");b.createMUPTimeout_(a)},a)}refreshXml_(){this.requestMain_((a,b)=>{b&&(this.media_&&(this.media_=this.mainPlaylistLoader_.main.playlists[this.media_.id]),this.mainPlaylistLoader_.sidxMapping_=qp(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.sidxMapping_),this.addSidxSegments_(this.media(),this.state,
c=>{this.refreshMedia_(this.media().id)}))})}refreshMedia_(a){if(!a)throw Error("refreshMedia_ must take a media id");this.media_&&this.isMain_&&this.handleMain_();const b=this.mainPlaylistLoader_.main.playlists,c=!this.media_||this.media_!==b[a];c?this.media_=b[a]:this.trigger("playlistunchanged");if(!this.mediaUpdateTimeout){const e=()=>{this.media().endList||(this.mediaUpdateTimeout=D.setTimeout(()=>{this.trigger("mediaupdatetimeout");e()},Eg(this.media(),!!c)))};e()}this.trigger("loadedplaylist")}}
var Ca={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,BACK_BUFFER_LENGTH:30,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:16,BUFFER_LOW_WATER_LINE_RATE:1,BUFFER_HIGH_WATER_LINE:30};const zk=function(a){a.on=a.addEventListener;a.off=a.removeEventListener;return a},rp=function(a){try{return URL.createObjectURL(new Blob([a],{type:"application/javascript"}))}catch(b){const c=new BlobBuilder;
c.append(a);return URL.createObjectURL(c.getBlob())}},Ak=function(a){return function(){const b=rp(a),c=zk(new Worker(b));c.objURL=b;const e=c.terminate;c.on=c.addEventListener;c.off=c.removeEventListener;c.terminate=function(){URL.revokeObjectURL(b);return e.call(this)};return c}},Bk=function(a){return`var browserWorkerPolyFill = ${zk.toString()};\n`+"browserWorkerPolyFill(self);\n"+a},Ck=function(a){return a.toString().replace(/^function.+?{/,"").slice(0,-1)},Zp=Bk(Ck(function(){var a="undefined"!==
typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},b=function(){this.init=function(){var g={};this.on=function(l,r){g[l]||(g[l]=[]);g[l]=g[l].concat(r)};this.off=function(l,r){if(!g[l])return!1;r=g[l].indexOf(r);g[l]=g[l].slice();g[l].splice(r,1);return-1<r};this.trigger=function(l){var r,q;if(r=g[l])if(2===arguments.length){var v=r.length;for(q=0;q<v;++q)r[q].call(this,arguments[1])}else{var w=[];q=arguments.length;
for(q=1;q<arguments.length;++q)w.push(arguments[q]);v=r.length;for(q=0;q<v;++q)r[q].apply(this,w)}};this.dispose=function(){g={}}}};b.prototype.pipe=function(g){this.on("data",function(l){g.push(l)});this.on("done",function(l){g.flush(l)});this.on("partialdone",function(l){g.partialFlush(l)});this.on("endedtimeline",function(l){g.endTimeline(l)});this.on("reset",function(l){g.reset(l)});return g};b.prototype.push=function(g){this.trigger("data",g)};b.prototype.flush=function(g){this.trigger("done",
g)};b.prototype.partialFlush=function(g){this.trigger("partialdone",g)};b.prototype.endTimeline=function(g){this.trigger("endedtimeline",g)};b.prototype.reset=function(g){this.trigger("reset",g)};var c=Math.pow(2,32),e=function(g){g=new DataView(g.buffer,g.byteOffset,g.byteLength);return g.getBigUint64?(g=g.getBigUint64(0),g<Number.MAX_SAFE_INTEGER?Number(g):g):g.getUint32(0)*c+g.getUint32(4)},h,m,p,t,x,y,C,z,E,K,G,O,R,W,U,ba;(function(){var g;p={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],
hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]};if("undefined"!==typeof Uint8Array){for(g in p)p.hasOwnProperty(g)&&(p[g]=[g.charCodeAt(0),g.charCodeAt(1),g.charCodeAt(2),g.charCodeAt(3)]);t=new Uint8Array([105,115,111,109]);y=new Uint8Array([97,118,99,49]);x=new Uint8Array([0,0,0,1]);C=new Uint8Array([0,0,0,0,0,0,
0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]);z=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);E={video:C,audio:z};O=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]);G=new Uint8Array([0,0,0,0,0,0,0,0]);W=R=new Uint8Array([0,0,0,0,0,0,0,0]);U=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]);ba=R;K=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}})();var J=function(g){var l=[],
r=0,q;for(q=1;q<arguments.length;q++)l.push(arguments[q]);for(q=l.length;q--;)r+=l[q].byteLength;var v=new Uint8Array(r+8);(new DataView(v.buffer,v.byteOffset,v.byteLength)).setUint32(0,v.byteLength);v.set(g,4);q=0;for(r=8;q<l.length;q++)v.set(l[q],r),r+=l[q].byteLength;return v};var ea=function(){return J(p.dinf,J(p.dref,O))};var ta=function(g){return J(p.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,g.audioobjecttype<<3|g.samplingfrequencyindex>>>1,g.samplingfrequencyindex<<
7|g.channelcount<<3,6,1,2]))};var Aa=function(){return J(p.ftyp,t,x,t,y)};var V=function(g){return J(p.hdlr,E[g])};var wa=function(g){var l=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,g.duration>>>24&255,g.duration>>>16&255,g.duration>>>8&255,g.duration&255,85,196,0,0]);g.samplerate&&(l[12]=g.samplerate>>>24&255,l[13]=g.samplerate>>>16&255,l[14]=g.samplerate>>>8&255,l[15]=g.samplerate&255);return J(p.mdhd,l)};var Ig=function(g){return J(p.mdia,wa(g),V(g.type),xe(g))};var ye=function(g){return J(p.mfhd,
new Uint8Array([0,0,0,0,(g&4278190080)>>24,(g&16711680)>>16,(g&65280)>>8,g&255]))};var xe=function(g){return J(p.minf,"video"===g.type?J(p.vmhd,K):J(p.smhd,G),ea(),sp(g))};var Dk=function(g){for(var l=g.length,r=[];l--;)r[l]=tp(g[l]);return J.apply(null,[p.moov,up(4294967295)].concat(r).concat(vp(g)))};var vp=function(g){for(var l=g.length,r=[];l--;)r[l]=wp(g[l]);return J.apply(null,[p.mvex].concat(r))};var up=function(g){g=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(g&4278190080)>>24,(g&
16711680)>>16,(g&65280)>>8,g&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return J(p.mvhd,g)};var xp=function(g){g=g.samples||[];var l=new Uint8Array(4+g.length),r;for(r=0;r<g.length;r++){var q=g[r].flags;l[r+4]=q.dependsOn<<4|q.isDependedOn<<2|q.hasRedundancy}return J(p.sdtp,l)};var sp=function(g){return J(p.stbl,h(g),J(p.stts,ba),J(p.stsc,W),J(p.stsz,U),J(p.stco,R))};
(function(){h=function(r){return J(p.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),"video"===r.type?g(r):l(r))};var g=function(r){var q=r.sps||[],v=r.pps||[],w=[],A=[],B;for(B=0;B<q.length;B++)w.push((q[B].byteLength&65280)>>>8),w.push(q[B].byteLength&255),w=w.concat(Array.prototype.slice.call(q[B]));for(B=0;B<v.length;B++)A.push((v[B].byteLength&65280)>>>8),A.push(v[B].byteLength&255),A=A.concat(Array.prototype.slice.call(v[B]));q=[p.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
(r.width&65280)>>8,r.width&255,(r.height&65280)>>8,r.height&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),J(p.avcC,new Uint8Array([1,r.profileIdc,r.profileCompatibility,r.levelIdc,255].concat([q.length],w,[v.length],A))),J(p.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))];r.sarRatio&&(v=r.sarRatio[0],r=r.sarRatio[1],q.push(J(p.pasp,new Uint8Array([(v&4278190080)>>24,(v&16711680)>>16,
(v&65280)>>8,v&255,(r&4278190080)>>24,(r&16711680)>>16,(r&65280)>>8,r&255]))));return J.apply(null,q)};var l=function(r){return J(p.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(r.channelcount&65280)>>8,r.channelcount&255,(r.samplesize&65280)>>8,r.samplesize&255,0,0,0,0,(r.samplerate&65280)>>8,r.samplerate&255,0,0]),ta(r))}})();var yp=function(g){g=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(g.id&4278190080)>>24,(g.id&16711680)>>16,(g.id&65280)>>8,g.id&255,0,0,0,0,(g.duration&4278190080)>>24,
(g.duration&16711680)>>16,(g.duration&65280)>>8,g.duration&255,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(g.width&65280)>>8,g.width&255,0,0,(g.height&65280)>>8,g.height&255,0,0]);return J(p.tkhd,g)};var zp=function(g){var l=J(p.tfhd,new Uint8Array([0,0,0,58,(g.id&4278190080)>>24,(g.id&16711680)>>16,(g.id&65280)>>8,g.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0]));var r=Math.floor(g.baseMediaDecodeTime/c);var q=Math.floor(g.baseMediaDecodeTime%
c);r=J(p.tfdt,new Uint8Array([1,0,0,0,r>>>24&255,r>>>16&255,r>>>8&255,r&255,q>>>24&255,q>>>16&255,q>>>8&255,q&255]));if("audio"===g.type)return g=m(g,92),J(p.traf,l,r,g);q=xp(g);g=m(g,q.length+92);return J(p.traf,l,r,g,q)};var tp=function(g){g.duration=g.duration||4294967295;return J(p.trak,yp(g),Ig(g))};var wp=function(g){var l=new Uint8Array([0,0,0,0,(g.id&4278190080)>>24,(g.id&16711680)>>16,(g.id&65280)>>8,g.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);"video"!==g.type&&(l[l.length-1]=0);return J(p.trex,
l)};(function(){var g=function(q,v){var w=0,A=0,B=0,F=0;q.length&&(void 0!==q[0].duration&&(w=1),void 0!==q[0].size&&(A=2),void 0!==q[0].flags&&(B=4),void 0!==q[0].compositionTimeOffset&&(F=8));return[0,0,w|A|B|F,1,(q.length&4278190080)>>>24,(q.length&16711680)>>>16,(q.length&65280)>>>8,q.length&255,(v&4278190080)>>>24,(v&16711680)>>>16,(v&65280)>>>8,v&255]};var l=function(q,v){var w;q=q.samples||[];v+=20+16*q.length;var A=g(q,v);v=new Uint8Array(A.length+16*q.length);v.set(A);A=A.length;for(w=0;w<
q.length;w++){var B=q[w];v[A++]=(B.duration&4278190080)>>>24;v[A++]=(B.duration&16711680)>>>16;v[A++]=(B.duration&65280)>>>8;v[A++]=B.duration&255;v[A++]=(B.size&4278190080)>>>24;v[A++]=(B.size&16711680)>>>16;v[A++]=(B.size&65280)>>>8;v[A++]=B.size&255;v[A++]=B.flags.isLeading<<2|B.flags.dependsOn;v[A++]=B.flags.isDependedOn<<6|B.flags.hasRedundancy<<4|B.flags.paddingValue<<1|B.flags.isNonSyncSample;v[A++]=B.flags.degradationPriority&61440;v[A++]=B.flags.degradationPriority&15;v[A++]=(B.compositionTimeOffset&
4278190080)>>>24;v[A++]=(B.compositionTimeOffset&16711680)>>>16;v[A++]=(B.compositionTimeOffset&65280)>>>8;v[A++]=B.compositionTimeOffset&255}return J(p.trun,v)};var r=function(q,v){var w;q=q.samples||[];v+=20+8*q.length;var A=g(q,v);v=new Uint8Array(A.length+8*q.length);v.set(A);A=A.length;for(w=0;w<q.length;w++){var B=q[w];v[A++]=(B.duration&4278190080)>>>24;v[A++]=(B.duration&16711680)>>>16;v[A++]=(B.duration&65280)>>>8;v[A++]=B.duration&255;v[A++]=(B.size&4278190080)>>>24;v[A++]=(B.size&16711680)>>>
16;v[A++]=(B.size&65280)>>>8;v[A++]=B.size&255}return J(p.trun,v)};m=function(q,v){return"audio"===q.type?r(q,v):l(q,v)}})();var pd={ftyp:Aa,mdat:function(g){return J(p.mdat,g)},moof:function(g,l){for(var r=[],q=l.length;q--;)r[q]=zp(l[q]);return J.apply(null,[p.moof,ye(g)].concat(r))},moov:Dk,initSegment:function(g){var l=Aa();g=Dk(g);var r=new Uint8Array(l.byteLength+g.byteLength);r.set(l);r.set(g,l.byteLength);return r}},Ek=function(g,l){var r={size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,
hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}};r.dataOffset=l;r.compositionTimeOffset=g.pts-g.dts;r.duration=g.duration;r.size=4*g.length;r.size+=g.byteLength;g.keyFrame&&(r.flags.dependsOn=2,r.flags.isNonSyncSample=0);return r},Vb=[33,16,5,32,164,27],Jg=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],ha=function(g){for(var l=[];g--;)l.push(0);return l},Ap=function(g){return Object.keys(g).reduce(function(l,r){l[r]=new Uint8Array(g[r].reduce(function(q,v){return q.concat(v)},[]));return l},
{})},Kg;var Fk=function(g){return 9E4*g};var Gk=function(g,l){return g*l};var Lg=function(g){return g/9E4};var Hk=function(g,l){return g/l};var fa={ONE_SECOND_IN_TS:9E4,secondsToVideoTs:Fk,secondsToAudioTs:Gk,videoTsToSeconds:Lg,audioTsToSeconds:Hk,audioTsToVideoTs:function(g,l){return Fk(Hk(g,l))},videoTsToAudioTs:function(g,l){return Gk(Lg(g),l)},metadataTsToSeconds:function(g,l,r){return Lg(r?g:g-l)}},Bp=fa.ONE_SECOND_IN_TS,qd={parseSei:function(g){for(var l=0,r={payloadType:-1,payloadSize:0},
q=0,v=0;l<g.byteLength&&128!==g[l];){for(;255===g[l];)q+=255,l++;for(q+=g[l++];255===g[l];)v+=255,l++;v+=g[l++];if(!r.payload&&4===q)if("GA94"===String.fromCharCode(g[l+3],g[l+4],g[l+5],g[l+6])){r.payloadType=q;r.payloadSize=v;r.payload=g.subarray(l,l+v);break}else r.payload=void 0;l+=v;v=q=0}return r},parseUserData:function(g){return 181!==g.payload[0]||49!==(g.payload[1]<<8|g.payload[2])||"GA94"!==String.fromCharCode(g.payload[3],g.payload[4],g.payload[5],g.payload[6])||3!==g.payload[7]?null:g.payload.subarray(8,
g.payload.length-1)},parseCaptionPackets:function(g,l){var r=[],q;if(!(l[0]&64))return r;var v=l[0]&31;for(q=0;q<v;q++){var w=3*q;var A={type:l[w+2]&3,pts:g};l[w+2]&4&&(A.ccData=l[w+3]<<8|l[w+4],r.push(A))}return r},discardEmulationPreventionBytes:function(g){for(var l=g.byteLength,r=[],q=1,v;q<l-2;)0===g[q]&&0===g[q+1]&&3===g[q+2]?(r.push(q+2),q+=2):q++;if(0===r.length)return g;l-=r.length;v=new Uint8Array(l);var w=0;for(q=0;q<l;w++,q++)w===r[0]&&(w++,r.shift()),v[q]=g[w];return v},USER_DATA_REGISTERED_ITU_T_T35:4},
Ya=function(g){g=g||{};Ya.prototype.init.call(this);this.parse708captions_="boolean"===typeof g.parse708captions?g.parse708captions:!0;this.captionPackets_=[];this.ccStreams_=[new qa(0,0),new qa(0,1),new qa(1,0),new qa(1,1)];this.parse708captions_&&(this.cc708Stream_=new ja({captionServices:g.captionServices}));this.reset();this.ccStreams_.forEach(function(l){l.on("data",this.trigger.bind(this,"data"));l.on("partialdone",this.trigger.bind(this,"partialdone"));l.on("done",this.trigger.bind(this,"done"))},
this);this.parse708captions_&&(this.cc708Stream_.on("data",this.trigger.bind(this,"data")),this.cc708Stream_.on("partialdone",this.trigger.bind(this,"partialdone")),this.cc708Stream_.on("done",this.trigger.bind(this,"done")))};Ya.prototype=new b;Ya.prototype.push=function(g){if("sei_rbsp"===g.nalUnitType){var l=qd.parseSei(g.escapedRBSP);l.payload&&l.payloadType===qd.USER_DATA_REGISTERED_ITU_T_T35&&(l=qd.parseUserData(l))&&(g.dts<this.latestDts_?this.ignoreNextEqualDts_=!0:g.dts===this.latestDts_&&
this.ignoreNextEqualDts_?(this.numSameDts_--,this.numSameDts_||(this.ignoreNextEqualDts_=!1)):(l=qd.parseCaptionPackets(g.pts,l),this.captionPackets_=this.captionPackets_.concat(l),this.latestDts_!==g.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=g.dts))}};Ya.prototype.flushCCStreams=function(g){this.ccStreams_.forEach(function(l){return"flush"===g?l.flush():l.partialFlush()},this)};Ya.prototype.flushStream=function(g){this.captionPackets_.length&&(this.captionPackets_.forEach(function(l,
r){l.presortIndex=r}),this.captionPackets_.sort(function(l,r){return l.pts===r.pts?l.presortIndex-r.presortIndex:l.pts-r.pts}),this.captionPackets_.forEach(function(l){2>l.type?this.dispatchCea608Packet(l):this.dispatchCea708Packet(l)},this),this.captionPackets_.length=0);this.flushCCStreams(g)};Ya.prototype.flush=function(){return this.flushStream("flush")};Ya.prototype.partialFlush=function(){return this.flushStream("partialFlush")};Ya.prototype.reset=function(){this.latestDts_=null;this.ignoreNextEqualDts_=
!1;this.numSameDts_=0;this.activeCea608Channel_=[null,null];this.ccStreams_.forEach(function(g){g.reset()})};Ya.prototype.dispatchCea608Packet=function(g){this.setsTextOrXDSActive(g)?this.activeCea608Channel_[g.type]=null:this.setsChannel1Active(g)?this.activeCea608Channel_[g.type]=0:this.setsChannel2Active(g)&&(this.activeCea608Channel_[g.type]=1);null!==this.activeCea608Channel_[g.type]&&this.ccStreams_[(g.type<<1)+this.activeCea608Channel_[g.type]].push(g)};Ya.prototype.setsChannel1Active=function(g){return 4096===
(g.ccData&30720)};Ya.prototype.setsChannel2Active=function(g){return 6144===(g.ccData&30720)};Ya.prototype.setsTextOrXDSActive=function(g){return 256===(g.ccData&28928)||4138===(g.ccData&30974)||6186===(g.ccData&30974)};Ya.prototype.dispatchCea708Packet=function(g){this.parse708captions_&&this.cc708Stream_.push(g)};var Cp={127:9834,4128:32,4129:160,4133:8230,4138:352,4140:338,4144:9608,4145:8216,4146:8217,4147:8220,4148:8221,4149:8226,4153:8482,4154:353,4156:339,4157:8480,4159:376,4214:8539,4215:8540,
4216:8541,4217:8542,4218:9168,4219:9124,4220:9123,4221:9135,4222:9126,4223:9121,4256:12600},ze=function(g){return 32<=g&&127>=g||160<=g&&255>=g},Jb=function(g){this.windowNum=g;this.reset()};Jb.prototype.reset=function(){this.clearText();this.pendingNewLine=!1;this.winAttr={};this.penAttr={};this.penLoc={};this.penColor={};this.anchorPoint=this.anchorHorizontal=this.anchorVertical=this.relativePositioning=this.priority=this.columnLock=this.rowLock=this.visible=0;this.rowCount=1;this.virtualRowCount=
this.rowCount+1;this.columnCount=41;this.penStyle=this.windowStyle=0};Jb.prototype.getText=function(){return this.rows.join("\n")};Jb.prototype.clearText=function(){this.rows=[""];this.rowIdx=0};Jb.prototype.newLine=function(g){this.rows.length>=this.virtualRowCount&&"function"===typeof this.beforeRowOverflow&&this.beforeRowOverflow(g);0<this.rows.length&&(this.rows.push(""),this.rowIdx++);for(;this.rows.length>this.virtualRowCount;)this.rows.shift(),this.rowIdx--};Jb.prototype.isEmpty=function(){return 0===
this.rows.length?!0:1===this.rows.length?""===this.rows[0]:!1};Jb.prototype.addText=function(g){this.rows[this.rowIdx]+=g};Jb.prototype.backspace=function(){if(!this.isEmpty()){var g=this.rows[this.rowIdx];this.rows[this.rowIdx]=g.substr(0,g.length-1)}};var Ae=function(g,l,r){this.serviceNum=g;this.text="";this.currentWindow=new Jb(-1);this.windows=[];this.stream=r;"string"===typeof l&&this.createTextDecoder(l)};Ae.prototype.init=function(g,l){this.startPts=g;for(g=0;8>g;g++)this.windows[g]=new Jb(g),
"function"===typeof l&&(this.windows[g].beforeRowOverflow=l)};Ae.prototype.setCurrentWindow=function(g){this.currentWindow=this.windows[g]};Ae.prototype.createTextDecoder=function(g){if("undefined"===typeof TextDecoder)this.stream.trigger("log",{level:"warn",message:"The `encoding` option is unsupported without TextDecoder support"});else try{this.textDecoder_=new TextDecoder(g)}catch(l){this.stream.trigger("log",{level:"warn",message:"TextDecoder could not be created with "+g+" encoding. "+l})}};
var ja=function(g){g=g||{};ja.prototype.init.call(this);var l=this,r=g.captionServices||{},q={},v;Object.keys(r).forEach(w=>{v=r[w];/^SERVICE/.test(w)&&(q[w]=v.encoding)});this.serviceEncodings=q;this.current708Packet=null;this.services={};this.push=function(w){3===w.type?l.new708Packet():null===l.current708Packet&&l.new708Packet();l.add708Bytes(w)}};ja.prototype=new b;ja.prototype.new708Packet=function(){null!==this.current708Packet&&this.push708Packet();this.current708Packet={data:[],ptsVals:[]}};
ja.prototype.add708Bytes=function(g){var l=g.ccData,r=l>>>8;l&=255;this.current708Packet.ptsVals.push(g.pts);this.current708Packet.data.push(r);this.current708Packet.data.push(l)};ja.prototype.push708Packet=function(){var g=this.current708Packet,l=g.data,r=null,q=null,v=0,w=l[v++];g.seq=w>>6;for(g.sizeCode=w&63;v<l.length;v++)w=l[v++],r=w>>5,q=w&31,7===r&&0<q&&(r=w=l[v++]),this.pushServiceBlock(r,v,q),0<q&&(v+=q-1)};ja.prototype.pushServiceBlock=function(g,l,r){var q=l,v=this.current708Packet.data,
w=this.services[g];for(w||(w=this.initService(g,q));q<l+r&&q<v.length;q++)g=v[q],ze(g)?q=this.handleText(q,w):24===g?q=this.multiByteCharacter(q,w):16===g?q=this.extendedCommands(q,w):128<=g&&135>=g?q=this.setCurrentWindow(q,w):152<=g&&159>=g?q=this.defineWindow(q,w):136===g?q=this.clearWindows(q,w):140===g?q=this.deleteWindows(q,w):137===g?q=this.displayWindows(q,w):138===g?q=this.hideWindows(q,w):139===g?q=this.toggleWindows(q,w):151===g?q=this.setWindowAttributes(q,w):144===g?q=this.setPenAttributes(q,
w):145===g?q=this.setPenColor(q,w):146===g?q=this.setPenLocation(q,w):143===g?w=this.reset(q,w):8===g?w.currentWindow.backspace():12===g?w.currentWindow.clearText():13===g?w.currentWindow.pendingNewLine=!0:14===g?w.currentWindow.clearText():141===g&&q++};ja.prototype.extendedCommands=function(g,l){var r=this.current708Packet.data[++g];ze(r)&&(g=this.handleText(g,l,{isExtended:!0}));return g};ja.prototype.getPts=function(g){return this.current708Packet.ptsVals[Math.floor(g/2)]};ja.prototype.initService=
function(g,l){var r="SERVICE"+g,q=this,v;r in this.serviceEncodings&&(v=this.serviceEncodings[r]);this.services[g]=new Ae(g,v,q);this.services[g].init(this.getPts(l),function(w){q.flushDisplayed(w,q.services[g])});return this.services[g]};ja.prototype.handleText=function(g,l,r){var q=r&&r.isExtended,v=r&&r.isMultiByte;r=this.current708Packet.data;var w=q?4096:0,A=r[g],B=r[g+1];r=l.currentWindow;l.textDecoder_&&!q?(v?(q=[A,B],g++):q=[A],l=l.textDecoder_.decode(new Uint8Array(q))):(l=w|A,q=Cp[l]||l,
l=l&4096&&l===q?"":String.fromCharCode(q));r.pendingNewLine&&!r.isEmpty()&&r.newLine(this.getPts(g));r.pendingNewLine=!1;r.addText(l);return g};ja.prototype.multiByteCharacter=function(g,l){var r=this.current708Packet.data,q=r[g+2];ze(r[g+1])&&ze(q)&&(g=this.handleText(++g,l,{isMultiByte:!0}));return g};ja.prototype.setCurrentWindow=function(g,l){l.setCurrentWindow(this.current708Packet.data[g]&7);return g};ja.prototype.defineWindow=function(g,l){var r=this.current708Packet.data,q=r[g];l.setCurrentWindow(q&
7);l=l.currentWindow;q=r[++g];l.visible=(q&32)>>5;l.rowLock=(q&16)>>4;l.columnLock=(q&8)>>3;l.priority=q&7;q=r[++g];l.relativePositioning=(q&128)>>7;l.anchorVertical=q&127;q=r[++g];l.anchorHorizontal=q;q=r[++g];l.anchorPoint=(q&240)>>4;l.rowCount=q&15;q=r[++g];l.columnCount=q&63;q=r[++g];l.windowStyle=(q&56)>>3;l.penStyle=q&7;l.virtualRowCount=l.rowCount+1;return g};ja.prototype.setWindowAttributes=function(g,l){var r=this.current708Packet.data,q=r[g];l=l.currentWindow.winAttr;q=r[++g];l.fillOpacity=
(q&192)>>6;l.fillRed=(q&48)>>4;l.fillGreen=(q&12)>>2;l.fillBlue=q&3;q=r[++g];l.borderType=(q&192)>>6;l.borderRed=(q&48)>>4;l.borderGreen=(q&12)>>2;l.borderBlue=q&3;q=r[++g];l.borderType+=(q&128)>>5;l.wordWrap=(q&64)>>6;l.printDirection=(q&48)>>4;l.scrollDirection=(q&12)>>2;l.justify=q&3;q=r[++g];l.effectSpeed=(q&240)>>4;l.effectDirection=(q&12)>>2;l.displayEffect=q&3;return g};ja.prototype.flushDisplayed=function(g,l){for(var r=[],q=0;8>q;q++)l.windows[q].visible&&!l.windows[q].isEmpty()&&r.push(l.windows[q].getText());
l.endPts=g;l.text=r.join("\n\n");this.pushCaption(l);l.startPts=g};ja.prototype.pushCaption=function(g){""!==g.text&&(this.trigger("data",{startPts:g.startPts,endPts:g.endPts,text:g.text,stream:"cc708_"+g.serviceNum}),g.text="",g.startPts=g.endPts)};ja.prototype.displayWindows=function(g,l){var r=this.current708Packet.data[++g],q=this.getPts(g);this.flushDisplayed(q,l);for(q=0;8>q;q++)r&1<<q&&(l.windows[q].visible=1);return g};ja.prototype.hideWindows=function(g,l){var r=this.current708Packet.data[++g],
q=this.getPts(g);this.flushDisplayed(q,l);for(q=0;8>q;q++)r&1<<q&&(l.windows[q].visible=0);return g};ja.prototype.toggleWindows=function(g,l){var r=this.current708Packet.data[++g],q=this.getPts(g);this.flushDisplayed(q,l);for(q=0;8>q;q++)r&1<<q&&(l.windows[q].visible^=1);return g};ja.prototype.clearWindows=function(g,l){var r=this.current708Packet.data[++g],q=this.getPts(g);this.flushDisplayed(q,l);for(q=0;8>q;q++)r&1<<q&&l.windows[q].clearText();return g};ja.prototype.deleteWindows=function(g,l){var r=
this.current708Packet.data[++g],q=this.getPts(g);this.flushDisplayed(q,l);for(q=0;8>q;q++)r&1<<q&&l.windows[q].reset();return g};ja.prototype.setPenAttributes=function(g,l){var r=this.current708Packet.data,q=r[g];l=l.currentWindow.penAttr;q=r[++g];l.textTag=(q&240)>>4;l.offset=(q&12)>>2;l.penSize=q&3;q=r[++g];l.italics=(q&128)>>7;l.underline=(q&64)>>6;l.edgeType=(q&56)>>3;l.fontStyle=q&7;return g};ja.prototype.setPenColor=function(g,l){var r=this.current708Packet.data,q=r[g];l=l.currentWindow.penColor;
q=r[++g];l.fgOpacity=(q&192)>>6;l.fgRed=(q&48)>>4;l.fgGreen=(q&12)>>2;l.fgBlue=q&3;q=r[++g];l.bgOpacity=(q&192)>>6;l.bgRed=(q&48)>>4;l.bgGreen=(q&12)>>2;l.bgBlue=q&3;q=r[++g];l.edgeRed=(q&48)>>4;l.edgeGreen=(q&12)>>2;l.edgeBlue=q&3;return g};ja.prototype.setPenLocation=function(g,l){var r=this.current708Packet.data,q=r[g],v=l.currentWindow.penLoc;l.currentWindow.pendingNewLine=!0;q=r[++g];v.row=q&15;q=r[++g];v.column=q&63;return g};ja.prototype.reset=function(g,l){var r=this.getPts(g);this.flushDisplayed(r,
l);return this.initService(l.serviceNum,g)};var Dp={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,
574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},Be=function(g){if(null===g)return"";g=Dp[g]||g;return String.fromCharCode(g)},Ep=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],hc=function(){for(var g=[],l=15;l--;)g.push("");return g},qa=function(g,
l){qa.prototype.init.call(this);this.field_=g||0;this.dataChannel_=l||0;this.name_="CC"+((this.field_<<1|this.dataChannel_)+1);this.setConstants();this.reset();this.push=function(r){var q=r.ccData&32639;if(q===this.lastControlCode_)this.lastControlCode_=null;else{4096===(q&61440)?this.lastControlCode_=q:q!==this.PADDING_&&(this.lastControlCode_=null);var v=q>>>8;var w=q&255;q!==this.PADDING_&&(q===this.RESUME_CAPTION_LOADING_?this.mode_="popOn":q===this.END_OF_CAPTION_?(this.mode_="popOn",this.clearFormatting(r.pts),
this.flushDisplayed(r.pts),w=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=w,this.startPts_=r.pts):q===this.ROLL_UP_2_ROWS_?(this.rollUpRows_=2,this.setRollUp(r.pts)):q===this.ROLL_UP_3_ROWS_?(this.rollUpRows_=3,this.setRollUp(r.pts)):q===this.ROLL_UP_4_ROWS_?(this.rollUpRows_=4,this.setRollUp(r.pts)):q===this.CARRIAGE_RETURN_?(this.clearFormatting(r.pts),this.flushDisplayed(r.pts),this.shiftRowsUp_(),this.startPts_=r.pts):q===this.BACKSPACE_?"popOn"===this.mode_?this.nonDisplayed_[this.row_]=
this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1):q===this.ERASE_DISPLAYED_MEMORY_?(this.flushDisplayed(r.pts),this.displayed_=hc()):q===this.ERASE_NON_DISPLAYED_MEMORY_?this.nonDisplayed_=hc():q===this.RESUME_DIRECT_CAPTIONING_?("paintOn"!==this.mode_&&(this.flushDisplayed(r.pts),this.displayed_=hc()),this.mode_="paintOn",this.startPts_=r.pts):this.isSpecialCharacter(v,w)?(q=Be((v&3)<<8|w),this[this.mode_](r.pts,q),this.column_++):this.isExtCharacter(v,
w)?("popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),q=Be((v&3)<<8|w),this[this.mode_](r.pts,q),this.column_++):this.isMidRowCode(v,w)?(this.clearFormatting(r.pts),this[this.mode_](r.pts," "),this.column_++,14===(w&14)&&this.addFormatting(r.pts,["i"]),1===(w&1)&&this.addFormatting(r.pts,["u"])):this.isOffsetControlCode(v,w)?this.column_+=w&3:this.isPAC(v,w)?(v=Ep.indexOf(q&7968),"rollUp"===
this.mode_&&(0>v-this.rollUpRows_+1&&(v=this.rollUpRows_-1),this.setRollUp(r.pts,v)),v!==this.row_&&(this.clearFormatting(r.pts),this.row_=v),w&1&&-1===this.formatting_.indexOf("u")&&this.addFormatting(r.pts,["u"]),16===(q&16)&&(this.column_=4*((q&14)>>1)),this.isColorPAC(w)&&14===(w&14)&&this.addFormatting(r.pts,["i"])):this.isNormalChar(v)&&(0===w&&(w=null),q=Be(v),q+=Be(w),this[this.mode_](r.pts,q),this.column_+=q.length))}}};qa.prototype=new b;qa.prototype.flushDisplayed=function(g){var l=this.displayed_.map(function(r,
q){try{return r.trim()}catch(v){return this.trigger("log",{level:"warn",message:"Skipping a malformed 608 caption at index "+q+"."}),""}},this).join("\n").replace(/^\n+|\n+$/g,"");l.length&&this.trigger("data",{startPts:this.startPts_,endPts:g,text:l,stream:this.name_})};qa.prototype.reset=function(){this.mode_="popOn";this.startPts_=this.topRow_=0;this.displayed_=hc();this.nonDisplayed_=hc();this.lastControlCode_=null;this.column_=0;this.row_=14;this.rollUpRows_=2;this.formatting_=[]};qa.prototype.setConstants=
function(){0===this.dataChannel_?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):1===this.dataChannel_&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31);this.PADDING_=0;this.RESUME_CAPTION_LOADING_=this.CONTROL_|32;this.END_OF_CAPTION_=this.CONTROL_|47;this.ROLL_UP_2_ROWS_=this.CONTROL_|37;this.ROLL_UP_3_ROWS_=this.CONTROL_|38;this.ROLL_UP_4_ROWS_=this.CONTROL_|39;this.CARRIAGE_RETURN_=this.CONTROL_|45;this.RESUME_DIRECT_CAPTIONING_=this.CONTROL_|
41;this.BACKSPACE_=this.CONTROL_|33;this.ERASE_DISPLAYED_MEMORY_=this.CONTROL_|44;this.ERASE_NON_DISPLAYED_MEMORY_=this.CONTROL_|46};qa.prototype.isSpecialCharacter=function(g,l){return g===this.EXT_&&48<=l&&63>=l};qa.prototype.isExtCharacter=function(g,l){return(g===this.EXT_+1||g===this.EXT_+2)&&32<=l&&63>=l};qa.prototype.isMidRowCode=function(g,l){return g===this.EXT_&&32<=l&&47>=l};qa.prototype.isOffsetControlCode=function(g,l){return g===this.OFFSET_&&33<=l&&35>=l};qa.prototype.isPAC=function(g,
l){return g>=this.BASE_&&g<this.BASE_+8&&64<=l&&127>=l};qa.prototype.isColorPAC=function(g){return 64<=g&&79>=g||96<=g&&127>=g};qa.prototype.isNormalChar=function(g){return 32<=g&&127>=g};qa.prototype.setRollUp=function(g,l){"rollUp"!==this.mode_&&(this.row_=14,this.mode_="rollUp",this.flushDisplayed(g),this.nonDisplayed_=hc(),this.displayed_=hc());if(void 0!==l&&l!==this.row_)for(g=0;g<this.rollUpRows_;g++)this.displayed_[l-g]=this.displayed_[this.row_-g],this.displayed_[this.row_-g]="";void 0===
l&&(l=this.row_);this.topRow_=l-this.rollUpRows_+1};qa.prototype.addFormatting=function(g,l){this.formatting_=this.formatting_.concat(l);l=l.reduce(function(r,q){return r+"\x3c"+q+"\x3e"},"");this[this.mode_](g,l)};qa.prototype.clearFormatting=function(g){if(this.formatting_.length){var l=this.formatting_.reverse().reduce(function(r,q){return r+"\x3c/"+q+"\x3e"},"");this.formatting_=[];this[this.mode_](g,l)}};qa.prototype.popOn=function(g,l){this.nonDisplayed_[this.row_]+=l};qa.prototype.rollUp=function(g,
l){this.displayed_[this.row_]+=l};qa.prototype.shiftRowsUp_=function(){var g;for(g=0;g<this.topRow_;g++)this.displayed_[g]="";for(g=this.row_+1;15>g;g++)this.displayed_[g]="";for(g=this.topRow_;g<this.row_;g++)this.displayed_[g]=this.displayed_[g+1];this.displayed_[this.row_]=""};qa.prototype.paintOn=function(g,l){this.displayed_[this.row_]+=l};var Ik=Ya,Fp=qa,Gp=ja,Ga={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},Wb=function(g,l){var r=1;for(g>l&&(r=-1);4294967296<Math.abs(l-
g);)g+=8589934592*r;return g},Mg=function(g){var l,r;Mg.prototype.init.call(this);this.type_=g||"shared";this.push=function(q){if("shared"===this.type_||q.type===this.type_)void 0===r&&(r=q.dts),q.dts=Wb(q.dts,r),q.pts=Wb(q.pts,r),l=q.dts,this.trigger("data",q)};this.flush=function(){r=l;this.trigger("done")};this.endTimeline=function(){this.flush();this.trigger("endedtimeline")};this.discontinuity=function(){l=r=void 0};this.reset=function(){this.discontinuity();this.trigger("reset")}};Mg.prototype=
new b;var Hp=Mg,Ce=(g,l,r)=>{if(!g)return-1;for(;r<g.length;r++)if(g[r]===l)return r;return-1},Ab=function(g,l,r){for(var q="";l<r;l++)q+="%"+("00"+g[l].toString(16)).slice(-2);return q},rd=function(g){return g[0]<<21|g[1]<<14|g[2]<<7|g[3]},sd={APIC:function(g){var l=1;if(3===g.data[0]){var r=Ce(g.data,0,l);0>r||(g.mimeType=unescape(Ab(g.data,l,r)),l=r+1,g.pictureType=g.data[l],l++,r=Ce(g.data,0,l),0>r||(g.description=decodeURIComponent(Ab(g.data,l,r)),l=r+1,"--\x3e"===g.mimeType?g.url=unescape(Ab(g.data,
l,g.data.length)):g.pictureData=g.data.subarray(l,g.data.length)))}},"T*":function(g){3===g.data[0]&&(g.value=decodeURIComponent(Ab(g.data,1,g.data.length)).replace(/\0*$/,""),g.values=g.value.split("\x00"))},TXXX:function(g){if(3===g.data[0]){var l=Ce(g.data,0,1);-1!==l&&(g.description=decodeURIComponent(Ab(g.data,1,l)),g.value=decodeURIComponent(Ab(g.data,l+1,g.data.length)).replace(/\0*$/,""),g.data=g.value)}},"W*":function(g){g.url=unescape(Ab(g.data,0,g.data.length)).replace(/\0.*$/,"")},WXXX:function(g){if(3===
g.data[0]){var l=Ce(g.data,0,1);-1!==l&&(g.description=decodeURIComponent(Ab(g.data,1,l)),g.url=unescape(Ab(g.data,l+1,g.data.length)).replace(/\0.*$/,""))}},PRIV:function(g){var l;for(l=0;l<g.data.length;l++)if(0===g.data[l]){g.owner=unescape(Ab(g.data,0,l));break}g.privateData=g.data.subarray(l+1);g.data=g.privateData}},Kb={parseId3Frames:function(g){var l=10,r=0,q=[];if(!(10>g.length||73!==g[0]||68!==g[1]||51!==g[2])){r=rd(g.subarray(6,10));r+=10;g[5]&64&&(l=l+4+rd(g.subarray(10,14)),r-=rd(g.subarray(16,
20)));do{var v=rd(g.subarray(l+4,l+8));if(1>v)break;var w=String.fromCharCode(g[l],g[l+1],g[l+2],g[l+3]);w={id:w,data:g.subarray(l+10,l+v+10)};w.key=w.id;if(sd[w.id])sd[w.id](w);else if("T"===w.id[0])sd["T*"](w);else if("W"===w.id[0])sd["W*"](w);q.push(w);l+=10;l+=v}while(l<r);return q}},parseSyncSafeInteger:rd,frameParsers:sd};var Ng=function(g){g=g&&g.descriptor;var l=0,r=[],q=0,v;Ng.prototype.init.call(this);this.dispatchType=Ga.METADATA_STREAM_TYPE.toString(16);if(g)for(v=0;v<g.length;v++)this.dispatchType+=
("00"+g[v].toString(16)).slice(-2);this.push=function(w){var A;if("timed-metadata"===w.type)if(w.dataAlignmentIndicator&&(q=0,r.length=0),0===r.length&&(10>w.data.length||73!==w.data[0]||68!==w.data[1]||51!==w.data[2]))this.trigger("log",{level:"warn",message:"Skipping unrecognized metadata packet"});else if(r.push(w),q+=w.data.byteLength,1===r.length&&(l=Kb.parseSyncSafeInteger(w.data.subarray(6,10)),l+=10),!(q<l)){w={data:new Uint8Array(l),frames:[],pts:r[0].pts,dts:r[0].dts};for(A=0;A<l;)w.data.set(r[0].data.subarray(0,
l-A),A),A+=r[0].data.byteLength,q-=r[0].data.byteLength,r.shift();A=10;w.data[5]&64&&(A=A+4+Kb.parseSyncSafeInteger(w.data.subarray(10,14)),l-=Kb.parseSyncSafeInteger(w.data.subarray(16,20)));do{var B=Kb.parseSyncSafeInteger(w.data.subarray(A+4,A+8));if(1>B){this.trigger("log",{level:"warn",message:"Malformed ID3 frame encountered. Skipping remaining metadata parsing."});break}var F=String.fromCharCode(w.data[A],w.data[A+1],w.data[A+2],w.data[A+3]);F={id:F,data:w.data.subarray(A+10,A+B+10)};F.key=
F.id;if(Kb.frameParsers[F.id])Kb.frameParsers[F.id](F);else if("T"===F.id[0])Kb.frameParsers["T*"](F);else if("W"===F.id[0])Kb.frameParsers["W*"](F);if("com.apple.streaming.transportStreamTimestamp"===F.owner){var I=F.data,N=(I[3]&1)<<30|I[4]<<22|I[5]<<14|I[6]<<6|I[7]>>>2;N*=4;N+=I[7]&3;F.timeStamp=N;void 0===w.pts&&void 0===w.dts&&(w.pts=F.timeStamp,w.dts=F.timeStamp);this.trigger("timestamp",F)}w.frames.push(F);A+=10;A+=B}while(A<l);this.trigger("data",w)}}};Ng.prototype=new b;var Og=function(){var g=
new Uint8Array(188),l=0;Og.prototype.init.call(this);this.push=function(r){var q=0,v=188;if(l){var w=new Uint8Array(r.byteLength+l);w.set(g.subarray(0,l));w.set(r,l);l=0}else w=r;for(;v<w.byteLength;)71===w[q]&&71===w[v]?(this.trigger("data",w.subarray(q,v)),q+=188,v+=188):(q++,v++);q<w.byteLength&&(g.set(w.subarray(q),0),l=w.byteLength-q)};this.flush=function(){188===l&&71===g[0]&&(this.trigger("data",g),l=0);this.trigger("done")};this.endTimeline=function(){this.flush();this.trigger("endedtimeline")};
this.reset=function(){l=0;this.trigger("reset")}};Og.prototype=new b;var De=function(){De.prototype.init.call(this);var g=this;this.packetsWaitingForPmt=[];this.programMapTable=void 0;var l=function(v,w){var A=0;w.payloadUnitStartIndicator&&(A+=v[A]+1);"pat"===w.type?r(v.subarray(A),w):q(v.subarray(A),w)};var r=function(v,w){w.section_number=v[7];w.last_section_number=v[8];g.pmtPid=(v[10]&31)<<8|v[11];w.pmtPid=g.pmtPid};var q=function(v,w){var A;if(v[5]&1){g.programMapTable={video:null,audio:null,
"timed-metadata":{}};var B=3+((v[1]&15)<<8|v[2])-4;for(A=12+((v[10]&15)<<8|v[11]);A<B;){var F=v[A],I=(v[A+1]&31)<<8|v[A+2];F===Ga.H264_STREAM_TYPE&&null===g.programMapTable.video?g.programMapTable.video=I:F===Ga.ADTS_STREAM_TYPE&&null===g.programMapTable.audio?g.programMapTable.audio=I:F===Ga.METADATA_STREAM_TYPE&&(g.programMapTable["timed-metadata"][I]=F);A+=((v[A+3]&15)<<8|v[A+4])+5}w.programMapTable=g.programMapTable}};this.push=function(v){var w={},A=4;w.payloadUnitStartIndicator=!!(v[1]&64);
w.pid=v[1]&31;w.pid<<=8;w.pid|=v[2];1<(v[3]&48)>>>4&&(A+=v[A]+1);if(0===w.pid)w.type="pat",l(v.subarray(A),w),this.trigger("data",w);else if(w.pid===this.pmtPid)for(w.type="pmt",l(v.subarray(A),w),this.trigger("data",w);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else void 0===this.programMapTable?this.packetsWaitingForPmt.push([v,A,w]):this.processPes_(v,A,w)};this.processPes_=function(v,w,A){A.streamType=A.pid===this.programMapTable.video?Ga.H264_STREAM_TYPE:
A.pid===this.programMapTable.audio?Ga.ADTS_STREAM_TYPE:this.programMapTable["timed-metadata"][A.pid];A.type="pes";A.data=v.subarray(w);this.trigger("data",A)}};De.prototype=new b;De.STREAM_TYPES={h264:27,adts:15};var Pg=function(){var g=this,l=!1,r={data:[],size:0},q={data:[],size:0},v={data:[],size:0},w,A=function(B,F,I){var N=new Uint8Array(B.size),L={type:F},X=0,S=0;X=!1;if(B.data.length&&!(9>B.size)){L.trackId=B.data[0].pid;for(X=0;X<B.data.length;X++){var da=B.data[X];N.set(da.data,S);S+=da.data.byteLength}S=
N[0]<<16|N[1]<<8|N[2];L.data=new Uint8Array;1===S&&(L.packetLength=6+(N[4]<<8|N[5]),L.dataAlignmentIndicator=0!==(N[6]&4),S=N[7],S&192&&(L.pts=(N[9]&14)<<27|(N[10]&255)<<20|(N[11]&254)<<12|(N[12]&255)<<5|(N[13]&254)>>>3,L.pts*=4,L.pts+=(N[13]&6)>>>1,L.dts=L.pts,S&64&&(L.dts=(N[14]&14)<<27|(N[15]&255)<<20|(N[16]&254)<<12|(N[17]&255)<<5|(N[18]&254)>>>3,L.dts*=4,L.dts+=(N[18]&6)>>>1)),L.data=N.subarray(9+N[8]));X="video"===F||L.packetLength<=B.size;if(I||X)B.size=0,B.data.length=0;X&&g.trigger("data",
L)}};Pg.prototype.init.call(this);this.push=function(B){({pat:function(){},pes:function(){switch(B.streamType){case Ga.H264_STREAM_TYPE:var F=r;var I="video";break;case Ga.ADTS_STREAM_TYPE:F=q;I="audio";break;case Ga.METADATA_STREAM_TYPE:F=v;I="timed-metadata";break;default:return}B.payloadUnitStartIndicator&&A(F,I,!0);F.data.push(B);F.size+=B.data.byteLength},pmt:function(){var F={type:"metadata",tracks:[]};w=B.programMapTable;null!==w.video&&F.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},
id:+w.video,codec:"avc",type:"video"});null!==w.audio&&F.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+w.audio,codec:"adts",type:"audio"});l=!0;g.trigger("data",F)}})[B.type]()};this.reset=function(){r.size=0;r.data.length=0;q.size=0;q.data.length=0;this.trigger("reset")};this.flushStreams_=function(){A(r,"video");A(q,"audio");A(v,"timed-metadata")};this.flush=function(){if(!l&&w){var B={type:"metadata",tracks:[]};null!==w.video&&B.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},
id:+w.video,codec:"avc",type:"video"});null!==w.audio&&B.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+w.audio,codec:"adts",type:"audio"});g.trigger("data",B)}l=!1;this.flushStreams_();this.trigger("done")}};Pg.prototype=new b;var Bb={PAT_PID:0,MP2T_PACKET_LENGTH:188,TransportPacketStream:Og,TransportParseStream:De,ElementaryStream:Pg,TimestampRolloverStream:Hp,CaptionStream:Ik,Cea608Stream:Fp,Cea708Stream:Gp,MetadataStream:Ng},Ee;for(Ee in Ga)Ga.hasOwnProperty(Ee)&&(Bb[Ee]=Ga[Ee]);var Ip=
fa.ONE_SECOND_IN_TS,Jk=[96E3,88200,64E3,48E3,44100,32E3,24E3,22050,16E3,12E3,11025,8E3,7350];var Fe=function(g){var l,r=0;Fe.prototype.init.call(this);this.skipWarn_=function(q,v){this.trigger("log",{level:"warn",message:`adts skiping bytes ${q} to ${v} in frame ${r} outside syncword`})};this.push=function(q){var v=0;g||(r=0);if("audio"===q.type){if(l&&l.length){var w=l;l=new Uint8Array(w.byteLength+q.data.byteLength);l.set(w);l.set(q.data,w.byteLength)}else l=q.data;for(var A;v+7<l.length;)if(255!==
l[v]||240!==(l[v+1]&246))"number"!==typeof A&&(A=v),v++;else{"number"===typeof A&&(this.skipWarn_(A,v),A=null);var B=2*(~l[v+1]&1);w=(l[v+3]&3)<<11|l[v+4]<<3|(l[v+5]&224)>>5;var F=1024*((l[v+6]&3)+1);var I=F*Ip/Jk[(l[v+2]&60)>>>2];if(l.byteLength-v<w)break;this.trigger("data",{pts:q.pts+r*I,dts:q.dts+r*I,sampleCount:F,audioobjecttype:(l[v+2]>>>6&3)+1,channelcount:(l[v+2]&1)<<2|(l[v+3]&192)>>>6,samplerate:Jk[(l[v+2]&60)>>>2],samplingfrequencyindex:(l[v+2]&60)>>>2,samplesize:16,data:l.subarray(v+7+
B,v+w)});r++;v+=w}"number"===typeof A&&(this.skipWarn_(A,v),A=null);l=l.subarray(v)}};this.flush=function(){r=0;this.trigger("done")};this.reset=function(){l=void 0;this.trigger("reset")};this.endTimeline=function(){l=void 0;this.trigger("endedtimeline")}};Fe.prototype=new b;var Jp=function(g){var l=g.byteLength,r=0,q=0;this.length=function(){return 8*l};this.bitsAvailable=function(){return 8*l+q};this.loadWord=function(){var v=g.byteLength-l,w=new Uint8Array(4),A=Math.min(4,l);if(0===A)throw Error("no bytes available");
w.set(g.subarray(v,v+A));r=(new DataView(w.buffer)).getUint32(0);q=8*A;l-=A};this.skipBits=function(v){if(!(q>v)){v-=q;var w=Math.floor(v/8);v-=8*w;l-=w;this.loadWord()}r<<=v;q-=v};this.readBits=function(v){var w=Math.min(q,v),A=r>>>32-w;q-=w;0<q?r<<=w:0<l&&this.loadWord();w=v-w;return 0<w?A<<w|this.readBits(w):A};this.skipLeadingZeros=function(){var v;for(v=0;v<q;++v)if(0!==(r&2147483648>>>v))return r<<=v,q-=v,v;this.loadWord();return v+this.skipLeadingZeros()};this.skipUnsignedExpGolomb=function(){this.skipBits(1+
this.skipLeadingZeros())};this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())};this.readUnsignedExpGolomb=function(){var v=this.skipLeadingZeros();return this.readBits(v+1)-1};this.readExpGolomb=function(){var v=this.readUnsignedExpGolomb();return 1&v?1+v>>>1:-1*(v>>>1)};this.readBoolean=function(){return 1===this.readBits(1)};this.readUnsignedByte=function(){return this.readBits(8)};this.loadWord()};var Qg=function(){var g=0,l,r;Qg.prototype.init.call(this);this.push=function(q){if(r){var v=
new Uint8Array(r.byteLength+q.data.byteLength);v.set(r);v.set(q.data,r.byteLength);r=v}else r=q.data;for(q=r.byteLength;g<q-3;g++)if(1===r[g+2]){l=g+5;break}for(;l<q;)switch(r[l]){case 0:if(0!==r[l-1]){l+=2;break}else if(0!==r[l-2]){l++;break}g+3!==l-2&&this.trigger("data",r.subarray(g+3,l-2));do l++;while(1!==r[l]&&l<q);g=l-2;l+=3;break;case 1:if(0!==r[l-1]||0!==r[l-2]){l+=3;break}this.trigger("data",r.subarray(g+3,l-2));g=l-2;l+=3;break;default:l+=3}r=r.subarray(g);l-=g;g=0};this.reset=function(){r=
null;g=0;this.trigger("reset")};this.flush=function(){r&&3<r.byteLength&&this.trigger("data",r.subarray(g+3));r=null;g=0;this.trigger("done")};this.endTimeline=function(){this.flush();this.trigger("endedtimeline")}};Qg.prototype=new b;var Kp={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0};var Rg=function(){var g=new Qg,l,r,q;Rg.prototype.init.call(this);var v=this;this.push=function(F){"video"===F.type&&(l=F.trackId,r=F.pts,q=F.dts,g.push(F))};g.on("data",function(F){var I=
{trackId:l,pts:r,dts:q,data:F,nalUnitTypeCode:F[0]&31};switch(I.nalUnitTypeCode){case 5:I.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:I.nalUnitType="sei_rbsp";I.escapedRBSP=A(F.subarray(1));break;case 7:I.nalUnitType="seq_parameter_set_rbsp";I.escapedRBSP=A(F.subarray(1));I.config=B(I.escapedRBSP);break;case 8:I.nalUnitType="pic_parameter_set_rbsp";break;case 9:I.nalUnitType="access_unit_delimiter_rbsp"}v.trigger("data",I)});g.on("done",function(){v.trigger("done")});g.on("partialdone",
function(){v.trigger("partialdone")});g.on("reset",function(){v.trigger("reset")});g.on("endedtimeline",function(){v.trigger("endedtimeline")});this.flush=function(){g.flush()};this.partialFlush=function(){g.partialFlush()};this.reset=function(){g.reset()};this.endTimeline=function(){g.endTimeline()};var w=function(F,I){var N=8,L=8,X;for(X=0;X<F;X++)0!==L&&(L=I.readExpGolomb(),L=(N+L+256)%256),N=0===L?N:L};var A=function(F){for(var I=F.byteLength,N=[],L=1,X;L<I-2;)0===F[L]&&0===F[L+1]&&3===F[L+2]?
(N.push(L+2),L+=2):L++;if(0===N.length)return F;I-=N.length;X=new Uint8Array(I);var S=0;for(L=0;L<I;S++,L++)S===N[0]&&(S++,N.shift()),X[L]=F[S];return X};var B=function(F){var I=0,N=0,L=0,X=0,S=[1,1];F=new Jp(F);var da=F.readUnsignedByte();var db=F.readUnsignedByte();var td=F.readUnsignedByte();F.skipUnsignedExpGolomb();if(Kp[da]){var Da=F.readUnsignedExpGolomb();3===Da&&F.skipBits(1);F.skipUnsignedExpGolomb();F.skipUnsignedExpGolomb();F.skipBits(1);if(F.readBoolean()){var ud=3!==Da?8:12;for(Da=0;Da<
ud;Da++)F.readBoolean()&&(6>Da?w(16,F):w(64,F))}}F.skipUnsignedExpGolomb();Da=F.readUnsignedExpGolomb();if(0===Da)F.readUnsignedExpGolomb();else if(1===Da)for(F.skipBits(1),F.skipExpGolomb(),F.skipExpGolomb(),ud=F.readUnsignedExpGolomb(),Da=0;Da<ud;Da++)F.skipExpGolomb();F.skipUnsignedExpGolomb();F.skipBits(1);Da=F.readUnsignedExpGolomb();ud=F.readUnsignedExpGolomb();var Kk=F.readBits(1);0===Kk&&F.skipBits(1);F.skipBits(1);F.readBoolean()&&(I=F.readUnsignedExpGolomb(),N=F.readUnsignedExpGolomb(),
L=F.readUnsignedExpGolomb(),X=F.readUnsignedExpGolomb());if(F.readBoolean()&&F.readBoolean()){var Lp=F.readUnsignedByte();switch(Lp){case 1:S=[1,1];break;case 2:S=[12,11];break;case 3:S=[10,11];break;case 4:S=[16,11];break;case 5:S=[40,33];break;case 6:S=[24,11];break;case 7:S=[20,11];break;case 8:S=[32,11];break;case 9:S=[80,33];break;case 10:S=[18,11];break;case 11:S=[15,11];break;case 12:S=[64,33];break;case 13:S=[160,99];break;case 14:S=[4,3];break;case 15:S=[3,2];break;case 16:S=[2,1];break;
case 255:S=[F.readUnsignedByte()<<8|F.readUnsignedByte(),F.readUnsignedByte()<<8|F.readUnsignedByte()]}S&&S[0]/S[1]}return{profileIdc:da,levelIdc:td,profileCompatibility:db,width:16*(Da+1)-2*I-2*N,height:(2-Kk)*(ud+1)*16-2*L-2*X,sarRatio:S}}};Rg.prototype=new b;var Mp=[96E3,88200,64E3,48E3,44100,32E3,24E3,22050,16E3,12E3,11025,8E3,7350],Lk=function(g,l){var r=g[l+6]<<21|g[l+7]<<14|g[l+8]<<7|g[l+9];g=g[l+5];r=0<=r?r:0;return(g&16)>>4?r+20:r+10},Mk=function(g,l){if(10>g.length-l||73!==g[l]||68!==g[l+
1]||51!==g[l+2])return l;l+=Lk(g,l);return Mk(g,l)},Nk=function(g){return g[0]<<21|g[1]<<14|g[2]<<7|g[3]},Lb={isLikelyAacData:function(g){var l=Mk(g,0);return g.length>=l+2&&255===(g[l]&255)&&240===(g[l+1]&240)&&16===(g[l+1]&22)},parseId3TagSize:Lk,parseAdtsSize:function(g,l){return g[l+3]&6144|g[l+4]<<3|(g[l+5]&224)>>5},parseType:function(g,l){return 73===g[l]&&68===g[l+1]&&51===g[l+2]?"timed-metadata":g[l]&1&&240===(g[l+1]&240)?"audio":null},parseSampleRate:function(g){for(var l=0;l+5<g.length;)if(255!==
g[l]||240!==(g[l+1]&246))l++;else return Mp[(g[l+2]&60)>>>2];return null},parseAacTimestamp:function(g){var l=10;g[5]&64&&(l=l+4+Nk(g.subarray(10,14)));do{var r=Nk(g.subarray(l+4,l+8));if(1>r)break;var q=String.fromCharCode(g[l],g[l+1],g[l+2],g[l+3]);if("PRIV"===q){q=g.subarray(l+10,l+r+10);for(var v=0;v<q.byteLength;v++)if(0===q[v]){var w=unescape,A=void 0,B=q,F=v,I="";for(A=0;A<F;A++)I+="%"+("00"+B[A].toString(16)).slice(-2);if("com.apple.streaming.transportStreamTimestamp"===w(I))return g=q.subarray(v+
1),l=(g[3]&1)<<30|g[4]<<22|g[5]<<14|g[6]<<6|g[7]>>>2,l*=4,l+=g[7]&3;break}}l+=10;l+=r}while(l<g.byteLength);return null}};var Sg=function(){var g=new Uint8Array,l=0;Sg.prototype.init.call(this);this.setTimestamp=function(r){l=r};this.push=function(r){var q=0,v=0;g.length?(q=g.length,g=new Uint8Array(r.byteLength+q),g.set(g.subarray(0,q)),g.set(r,q)):g=r;for(;3<=g.length-v;)if(73===g[v]&&68===g[v+1]&&51===g[v+2]){if(10>g.length-v)break;q=Lb.parseId3TagSize(g,v);if(v+q>g.length)break;r={type:"timed-metadata",
data:g.subarray(v,v+q)};this.trigger("data",r);v+=q}else if(255===(g[v]&255)&&240===(g[v+1]&240)){if(7>g.length-v)break;q=Lb.parseAdtsSize(g,v);if(v+q>g.length)break;r={type:"audio",data:g.subarray(v,v+q),pts:l,dts:l};this.trigger("data",r);v+=q}else v++;g=0<g.length-v?g.subarray(v):new Uint8Array};this.reset=function(){g=new Uint8Array;this.trigger("reset")};this.endTimeline=function(){g=new Uint8Array;this.trigger("endedtimeline")}};Sg.prototype=new b;var vd={groupNalsIntoFrames:function(g){var l,
r=[],q=[];q.byteLength=0;q.nalCount=0;q.duration=0;for(l=r.byteLength=0;l<g.length;l++){var v=g[l];"access_unit_delimiter_rbsp"===v.nalUnitType?(r.length&&(r.duration=v.dts-r.dts,q.byteLength+=r.byteLength,q.nalCount+=r.length,q.duration+=r.duration,q.push(r)),r=[v],r.byteLength=v.data.byteLength,r.pts=v.pts,r.dts=v.dts):("slice_layer_without_partitioning_rbsp_idr"===v.nalUnitType&&(r.keyFrame=!0),r.duration=v.dts-r.dts,r.byteLength+=v.data.byteLength,r.push(v))}q.length&&(!r.duration||0>=r.duration)&&
(r.duration=q[q.length-1].duration);q.byteLength+=r.byteLength;q.nalCount+=r.length;q.duration+=r.duration;q.push(r);return q},groupFramesIntoGops:function(g){var l,r=[],q=[];r.byteLength=0;r.nalCount=0;r.duration=0;r.pts=g[0].pts;r.dts=g[0].dts;q.byteLength=0;q.nalCount=0;q.duration=0;q.pts=g[0].pts;q.dts=g[0].dts;for(l=0;l<g.length;l++){var v=g[l];v.keyFrame?(r.length&&(q.push(r),q.byteLength+=r.byteLength,q.nalCount+=r.nalCount,q.duration+=r.duration),r=[v],r.nalCount=v.length,r.byteLength=v.byteLength,
r.pts=v.pts,r.dts=v.dts,r.duration=v.duration):(r.duration+=v.duration,r.nalCount+=v.length,r.byteLength+=v.byteLength,r.push(v))}q.length&&0>=r.duration&&(r.duration=q[q.length-1].duration);q.byteLength+=r.byteLength;q.nalCount+=r.nalCount;q.duration+=r.duration;q.push(r);return q},extendFirstKeyFrame:function(g){if(!g[0][0].keyFrame&&1<g.length){var l=g.shift();g.byteLength-=l.byteLength;g.nalCount-=l.nalCount;g[0][0].dts=l.dts;g[0][0].pts=l.pts;g[0][0].duration+=l.duration}return g},generateSampleTable:function(g,
l){var r,q=l||0,v=[];for(l=0;l<g.length;l++){var w=g[l];for(r=0;r<w.length;r++){var A=w[r];A=Ek(A,q);q+=A.size;v.push(A)}}return v},concatenateNalData:function(g){var l,r,q,v=0,w=new Uint8Array(g.byteLength+4*g.nalCount),A=new DataView(w.buffer);for(l=0;l<g.length;l++){var B=g[l];for(r=0;r<B.length;r++){var F=B[r];for(q=0;q<F.length;q++){var I=F[q];A.setUint32(v,I.data.byteLength);v+=4;w.set(I.data,v);v+=I.data.byteLength}}}return w},generateSampleTableForFrame:function(g,l){var r=[];g=Ek(g,l||0);
r.push(g);return r},concatenateNalDataForFrame:function(g){var l,r=0,q=new Uint8Array(g.byteLength+4*g.length),v=new DataView(q.buffer);for(l=0;l<g.length;l++){var w=g[l];v.setUint32(r,w.data.byteLength);r+=4;q.set(w.data,r);r+=w.data.byteLength}return q}},Ge={prefixWithSilence:function(g,l,r,q){var v=0,w=0,A=w=0;if(l.length){var B=fa.audioTsToVideoTs(g.baseMediaDecodeTime,g.samplerate);v=Math.ceil(fa.ONE_SECOND_IN_TS/(g.samplerate/1024));r&&q&&(w=B-Math.max(r,q),w=Math.floor(w/v),A=w*v);if(!(1>w||
A>fa.ONE_SECOND_IN_TS/2)){Kg||(r={96E3:[Vb,[227,64],ha(154),[56]],88200:[Vb,[231],ha(170),[56]],64E3:[Vb,[248,192],ha(240),[56]],48E3:[Vb,[255,192],ha(268),[55,148,128],ha(54),[112]],44100:[Vb,[255,192],ha(268),[55,163,128],ha(84),[112]],32E3:[Vb,[255,192],ha(268),[55,234],ha(226),[112]],24E3:[Vb,[255,192],ha(268),[55,255,128],ha(268),[111,112],ha(126),[224]],16E3:[Vb,[255,192],ha(268),[55,255,128],ha(268),[111,255],ha(269),[223,108],ha(195),[1,192]],12E3:[Jg,ha(268),[3,127,248],ha(268),[6,255,240],
ha(268),[13,255,224],ha(268),[27,253,128],ha(259),[56]],11025:[Jg,ha(268),[3,127,248],ha(268),[6,255,240],ha(268),[13,255,224],ha(268),[27,255,192],ha(268),[55,175,128],ha(108),[112]],8E3:[Jg,ha(268),[3,121,16],ha(47),[7]]},Kg=Ap(r));r=Kg[g.samplerate];r||(r=l[0].data);for(q=0;q<w;q++)B=l[0],l.splice(0,0,{data:r,dts:B.dts-v,pts:B.pts-v});g.baseMediaDecodeTime-=Math.floor(fa.videoTsToAudioTs(A,g.samplerate));return A}}},trimAdtsFramesByEarliestDts:function(g,l,r){if(l.minSegmentDts>=r)return g;l.minSegmentDts=
Infinity;return g.filter(function(q){return q.dts>=r?(l.minSegmentDts=Math.min(l.minSegmentDts,q.dts),l.minSegmentPts=l.minSegmentDts,!0):!1})},generateSampleTable:function(g){var l,r=[];for(l=0;l<g.length;l++){var q=g[l];r.push({size:q.data.byteLength,duration:1024})}return r},concatenateFrameData:function(g){var l,r=0;var q=Uint8Array;var v=0;for(l=0;l<g.length;l++){var w=g[l];v+=w.data.byteLength}w=new q(v);for(q=0;q<g.length;q++)l=g[q],w.set(l.data,r),r+=l.data.byteLength;return w}},nb={clearDtsInfo:function(g){delete g.minSegmentDts;
delete g.maxSegmentDts;delete g.minSegmentPts;delete g.maxSegmentPts},calculateTrackBaseMediaDecodeTime:function(g,l){var r=g.minSegmentDts;l||(r-=g.timelineStartInfo.dts);l=g.timelineStartInfo.baseMediaDecodeTime;l=Math.max(0,l+r);"audio"===g.type&&(g=g.samplerate/Bp,l=Math.floor(l*g));return l},collectDtsInfo:function(g,l){"number"===typeof l.pts&&(void 0===g.timelineStartInfo.pts&&(g.timelineStartInfo.pts=l.pts),g.minSegmentPts=void 0===g.minSegmentPts?l.pts:Math.min(g.minSegmentPts,l.pts),g.maxSegmentPts=
void 0===g.maxSegmentPts?l.pts:Math.max(g.maxSegmentPts,l.pts));"number"===typeof l.dts&&(void 0===g.timelineStartInfo.dts&&(g.timelineStartInfo.dts=l.dts),g.minSegmentDts=void 0===g.minSegmentDts?l.dts:Math.min(g.minSegmentDts,l.dts),g.maxSegmentDts=void 0===g.maxSegmentDts?l.dts:Math.max(g.maxSegmentDts,l.dts))}},Np=Lb.isLikelyAacData,Op=fa.ONE_SECOND_IN_TS,Ok=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],Pk="width height profileIdc levelIdc profileCompatibility sarRatio".split(" "),
Pp=function(g,l){l.stream=g;this.trigger("log",l)},Qk=function(g,l){for(var r=Object.keys(l),q=0;q<r.length;q++){var v=r[q];if("headOfPipeline"!==v&&l[v].on)l[v].on("log",Pp.bind(g,v))}},Rk=function(g,l){var r;if(g.length!==l.length)return!1;for(r=0;r<g.length;r++)if(g[r]!==l[r])return!1;return!0},Sk=function(g,l,r,q,v,w){return{start:{dts:g,pts:g+(r-l)},end:{dts:g+(q-l),pts:g+(v-r)},prependedContentDuration:w,baseMediaDecodeTime:g}};var He=function(g,l){var r=[],q=0,v=0,w=Infinity;l=l||{};var A=
l.firstSequenceNumber||0;He.prototype.init.call(this);this.push=function(B){nb.collectDtsInfo(g,B);g&&Ok.forEach(function(F){g[F]=B[F]});r.push(B)};this.setEarliestDts=function(B){q=B};this.setVideoBaseMediaDecodeTime=function(B){w=B};this.setAudioAppendStart=function(B){v=B};this.flush=function(){if(0!==r.length){var B=Ge.trimAdtsFramesByEarliestDts(r,g,q);g.baseMediaDecodeTime=nb.calculateTrackBaseMediaDecodeTime(g,l.keepOriginalTimestamps);var F=Ge.prefixWithSilence(g,B,v,w);g.samples=Ge.generateSampleTable(B);
var I=pd.mdat(Ge.concatenateFrameData(B));r=[];var N=pd.moof(A,[g]);var L=new Uint8Array(N.byteLength+I.byteLength);A++;L.set(N);L.set(I,N.byteLength);nb.clearDtsInfo(g);N=Math.ceil(1024*Op/g.samplerate);B.length&&(N*=B.length,this.trigger("segmentTimingInfo",Sk(fa.audioTsToVideoTs(g.baseMediaDecodeTime,g.samplerate),B[0].dts,B[0].pts,B[0].dts+N,B[0].pts+N,F||0)),this.trigger("timingInfo",{start:B[0].pts,end:B[0].pts+N}));this.trigger("data",{track:g,boxes:L})}this.trigger("done","AudioSegmentStream")};
this.reset=function(){nb.clearDtsInfo(g);r=[];this.trigger("reset")}};He.prototype=new b;var Tg=function(g,l){var r=[],q=[],v,w;l=l||{};var A=l.firstSequenceNumber||0;Tg.prototype.init.call(this);delete g.minPTS;this.gopCache_=[];this.push=function(B){nb.collectDtsInfo(g,B);"seq_parameter_set_rbsp"!==B.nalUnitType||v||(v=B.config,g.sps=[B.data],Pk.forEach(function(F){g[F]=v[F]},this));"pic_parameter_set_rbsp"!==B.nalUnitType||w||(w=B.data,g.pps=[B.data]);r.push(B)};this.flush=function(){var B;var F=
0;for(var I,N;r.length&&"access_unit_delimiter_rbsp"!==r[0].nalUnitType;)r.shift();if(0!==r.length){var L=vd.groupNalsIntoFrames(r);L=vd.groupFramesIntoGops(L);L[0][0].keyFrame||((B=this.getGopForFusion_(r[0],g))?(F=B.duration,L.unshift(B),L.byteLength+=B.byteLength,L.nalCount+=B.nalCount,L.pts=B.pts,L.dts=B.dts,L.duration+=B.duration):L=vd.extendFirstKeyFrame(L));if(q.length){B=l.alignGopsAtEnd?this.alignGopsAtEnd_(L):this.alignGopsAtStart_(L);if(!B){this.gopCache_.unshift({gop:L.pop(),pps:g.pps,
sps:g.sps});this.gopCache_.length=Math.min(6,this.gopCache_.length);r=[];this.resetStream_();this.trigger("done","VideoSegmentStream");return}nb.clearDtsInfo(g);L=B}nb.collectDtsInfo(g,L);g.samples=vd.generateSampleTable(L);B=pd.mdat(vd.concatenateNalData(L));g.baseMediaDecodeTime=nb.calculateTrackBaseMediaDecodeTime(g,l.keepOriginalTimestamps);this.trigger("processedGopsInfo",L.map(function(X){return{pts:X.pts,dts:X.dts,byteLength:X.byteLength}}));I=L[0];N=L[L.length-1];this.trigger("segmentTimingInfo",
Sk(g.baseMediaDecodeTime,I.dts,I.pts,N.dts+N.duration,N.pts+N.duration,F));this.trigger("timingInfo",{start:L[0].pts,end:L[L.length-1].pts+L[L.length-1].duration});this.gopCache_.unshift({gop:L.pop(),pps:g.pps,sps:g.sps});this.gopCache_.length=Math.min(6,this.gopCache_.length);r=[];this.trigger("baseMediaDecodeTime",g.baseMediaDecodeTime);this.trigger("timelineStartInfo",g.timelineStartInfo);F=pd.moof(A,[g]);L=new Uint8Array(F.byteLength+B.byteLength);A++;L.set(F);L.set(B,F.byteLength);this.trigger("data",
{track:g,boxes:L})}this.resetStream_();this.trigger("done","VideoSegmentStream")};this.reset=function(){this.resetStream_();r=[];this.gopCache_.length=0;q.length=0;this.trigger("reset")};this.resetStream_=function(){nb.clearDtsInfo(g);w=v=void 0};this.getGopForFusion_=function(B){var F=Infinity,I;for(I=0;I<this.gopCache_.length;I++){var N=this.gopCache_[I];var L=N.gop;if(g.pps&&Rk(g.pps[0],N.pps[0])&&g.sps&&Rk(g.sps[0],N.sps[0])&&!(L.dts<g.timelineStartInfo.dts)&&(L=B.dts-L.dts-L.duration,-1E4<=L&&
45E3>=L&&(!X||F>L))){var X=N;F=L}}return X?X.gop:null};this.alignGopsAtStart_=function(B){var F,I;var N=B.byteLength;var L=B.nalCount;var X=B.duration;for(F=I=0;F<q.length&&I<B.length;){var S=q[F];var da=B[I];if(S.pts===da.pts)break;da.pts>S.pts?F++:(I++,N-=da.byteLength,L-=da.nalCount,X-=da.duration)}if(0===I)return B;if(I===B.length)return null;B=B.slice(I);B.byteLength=N;B.duration=X;B.nalCount=L;B.pts=B[0].pts;B.dts=B[0].dts;return B};this.alignGopsAtEnd_=function(B){var F;var I=q.length-1;var N=
B.length-1;var L=null;for(F=!1;0<=I&&0<=N;){var X=q[I];var S=B[N];if(X.pts===S.pts){F=!0;break}X.pts>S.pts?I--:(I===q.length-1&&(L=N),N--)}if(!F&&null===L)return null;I=F?N:L;if(0===I)return B;B=B.slice(I);I=B.reduce(function(da,db){da.byteLength+=db.byteLength;da.duration+=db.duration;da.nalCount+=db.nalCount;return da},{byteLength:0,duration:0,nalCount:0});B.byteLength=I.byteLength;B.duration=I.duration;B.nalCount=I.nalCount;B.pts=B[0].pts;B.dts=B[0].dts;return B};this.alignGopsWith=function(B){q=
B}};Tg.prototype=new b;var Nc=function(g,l){this.numberOfTracks=0;this.metadataStream=l;g=g||{};this.remuxTracks="undefined"!==typeof g.remux?!!g.remux:!0;this.keepOriginalTimestamps="boolean"===typeof g.keepOriginalTimestamps?g.keepOriginalTimestamps:!1;this.pendingTracks=[];this.videoTrack=null;this.pendingBoxes=[];this.pendingCaptions=[];this.pendingMetadata=[];this.emittedTracks=this.pendingBytes=0;Nc.prototype.init.call(this);this.push=function(r){if(r.text)return this.pendingCaptions.push(r);
if(r.frames)return this.pendingMetadata.push(r);this.pendingTracks.push(r.track);this.pendingBytes+=r.boxes.byteLength;"video"===r.track.type&&(this.videoTrack=r.track,this.pendingBoxes.push(r.boxes));"audio"===r.track.type&&(this.audioTrack=r.track,this.pendingBoxes.unshift(r.boxes))}};Nc.prototype=new b;Nc.prototype.flush=function(g){var l=0,r={captions:[],captionStreams:{},metadata:[],info:{}},q=0;if(this.pendingTracks.length<this.numberOfTracks){if("VideoSegmentStream"!==g&&"AudioSegmentStream"!==
g||this.remuxTracks)return;if(0===this.pendingTracks.length){this.emittedTracks++;this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0);return}}this.videoTrack?(q=this.videoTrack.timelineStartInfo.pts,Pk.forEach(function(v){r.info[v]=this.videoTrack[v]},this)):this.audioTrack&&(q=this.audioTrack.timelineStartInfo.pts,Ok.forEach(function(v){r.info[v]=this.audioTrack[v]},this));if(this.videoTrack||this.audioTrack){r.type=1===this.pendingTracks.length?this.pendingTracks[0].type:
"combined";this.emittedTracks+=this.pendingTracks.length;g=pd.initSegment(this.pendingTracks);r.initSegment=new Uint8Array(g.byteLength);r.initSegment.set(g);r.data=new Uint8Array(this.pendingBytes);for(g=0;g<this.pendingBoxes.length;g++)r.data.set(this.pendingBoxes[g],l),l+=this.pendingBoxes[g].byteLength;for(g=0;g<this.pendingCaptions.length;g++)l=this.pendingCaptions[g],l.startTime=fa.metadataTsToSeconds(l.startPts,q,this.keepOriginalTimestamps),l.endTime=fa.metadataTsToSeconds(l.endPts,q,this.keepOriginalTimestamps),
r.captionStreams[l.stream]=!0,r.captions.push(l);for(g=0;g<this.pendingMetadata.length;g++)l=this.pendingMetadata[g],l.cueTime=fa.metadataTsToSeconds(l.pts,q,this.keepOriginalTimestamps),r.metadata.push(l);r.metadata.dispatchType=this.metadataStream.dispatchType;this.pendingTracks.length=0;this.videoTrack=null;this.pendingBoxes.length=0;this.pendingBytes=this.pendingCaptions.length=0;this.pendingMetadata.length=0;this.trigger("data",r);for(g=0;g<r.captions.length;g++)l=r.captions[g],this.trigger("caption",
l);for(g=0;g<r.metadata.length;g++)l=r.metadata[g],this.trigger("id3Frame",l)}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)};Nc.prototype.setRemux=function(g){this.remuxTracks=g};var Ug=function(g){var l=this,r=!0,q,v;Ug.prototype.init.call(this);g=g||{};this.baseMediaDecodeTime=g.baseMediaDecodeTime||0;this.transmuxPipeline_={};this.setupAacPipeline=function(){var w={};this.transmuxPipeline_=w;w.type="aac";w.metadataStream=new Bb.MetadataStream;w.aacStream=
new Sg;w.audioTimestampRolloverStream=new Bb.TimestampRolloverStream("audio");w.timedMetadataTimestampRolloverStream=new Bb.TimestampRolloverStream("timed-metadata");w.adtsStream=new Fe;w.coalesceStream=new Nc(g,w.metadataStream);w.headOfPipeline=w.aacStream;w.aacStream.pipe(w.audioTimestampRolloverStream).pipe(w.adtsStream);w.aacStream.pipe(w.timedMetadataTimestampRolloverStream).pipe(w.metadataStream).pipe(w.coalesceStream);w.metadataStream.on("timestamp",function(A){w.aacStream.setTimestamp(A.timeStamp)});
w.aacStream.on("data",function(A){"timed-metadata"!==A.type&&"audio"!==A.type||w.audioSegmentStream||(v=v||{timelineStartInfo:{baseMediaDecodeTime:l.baseMediaDecodeTime},codec:"adts",type:"audio"},w.coalesceStream.numberOfTracks++,w.audioSegmentStream=new He(v,g),w.audioSegmentStream.on("log",l.getLogTrigger_("audioSegmentStream")),w.audioSegmentStream.on("timingInfo",l.trigger.bind(l,"audioTimingInfo")),w.adtsStream.pipe(w.audioSegmentStream).pipe(w.coalesceStream),l.trigger("trackinfo",{hasAudio:!!v,
hasVideo:!!q}))});w.coalesceStream.on("data",this.trigger.bind(this,"data"));w.coalesceStream.on("done",this.trigger.bind(this,"done"));Qk(this,w)};this.setupTsPipeline=function(){var w={};this.transmuxPipeline_=w;w.type="ts";w.metadataStream=new Bb.MetadataStream;w.packetStream=new Bb.TransportPacketStream;w.parseStream=new Bb.TransportParseStream;w.elementaryStream=new Bb.ElementaryStream;w.timestampRolloverStream=new Bb.TimestampRolloverStream;w.adtsStream=new Fe;w.h264Stream=new Rg;w.captionStream=
new Bb.CaptionStream(g);w.coalesceStream=new Nc(g,w.metadataStream);w.headOfPipeline=w.packetStream;w.packetStream.pipe(w.parseStream).pipe(w.elementaryStream).pipe(w.timestampRolloverStream);w.timestampRolloverStream.pipe(w.h264Stream);w.timestampRolloverStream.pipe(w.adtsStream);w.timestampRolloverStream.pipe(w.metadataStream).pipe(w.coalesceStream);w.h264Stream.pipe(w.captionStream).pipe(w.coalesceStream);w.elementaryStream.on("data",function(A){var B;if("metadata"===A.type){for(B=A.tracks.length;B--;)q||
"video"!==A.tracks[B].type?v||"audio"!==A.tracks[B].type||(v=A.tracks[B],v.timelineStartInfo.baseMediaDecodeTime=l.baseMediaDecodeTime):(q=A.tracks[B],q.timelineStartInfo.baseMediaDecodeTime=l.baseMediaDecodeTime);q&&!w.videoSegmentStream&&(w.coalesceStream.numberOfTracks++,w.videoSegmentStream=new Tg(q,g),w.videoSegmentStream.on("log",l.getLogTrigger_("videoSegmentStream")),w.videoSegmentStream.on("timelineStartInfo",function(F){v&&!g.keepOriginalTimestamps&&(v.timelineStartInfo=F,w.audioSegmentStream.setEarliestDts(F.dts-
l.baseMediaDecodeTime))}),w.videoSegmentStream.on("processedGopsInfo",l.trigger.bind(l,"gopInfo")),w.videoSegmentStream.on("segmentTimingInfo",l.trigger.bind(l,"videoSegmentTimingInfo")),w.videoSegmentStream.on("baseMediaDecodeTime",function(F){v&&w.audioSegmentStream.setVideoBaseMediaDecodeTime(F)}),w.videoSegmentStream.on("timingInfo",l.trigger.bind(l,"videoTimingInfo")),w.h264Stream.pipe(w.videoSegmentStream).pipe(w.coalesceStream));v&&!w.audioSegmentStream&&(w.coalesceStream.numberOfTracks++,
w.audioSegmentStream=new He(v,g),w.audioSegmentStream.on("log",l.getLogTrigger_("audioSegmentStream")),w.audioSegmentStream.on("timingInfo",l.trigger.bind(l,"audioTimingInfo")),w.audioSegmentStream.on("segmentTimingInfo",l.trigger.bind(l,"audioSegmentTimingInfo")),w.adtsStream.pipe(w.audioSegmentStream).pipe(w.coalesceStream));l.trigger("trackinfo",{hasAudio:!!v,hasVideo:!!q})}});w.coalesceStream.on("data",this.trigger.bind(this,"data"));w.coalesceStream.on("id3Frame",function(A){A.dispatchType=w.metadataStream.dispatchType;
l.trigger("id3Frame",A)});w.coalesceStream.on("caption",this.trigger.bind(this,"caption"));w.coalesceStream.on("done",this.trigger.bind(this,"done"));Qk(this,w)};this.setBaseMediaDecodeTime=function(w){var A=this.transmuxPipeline_;g.keepOriginalTimestamps||(this.baseMediaDecodeTime=w);v&&(v.timelineStartInfo.dts=void 0,v.timelineStartInfo.pts=void 0,nb.clearDtsInfo(v),A.audioTimestampRolloverStream&&A.audioTimestampRolloverStream.discontinuity());q&&(A.videoSegmentStream&&(A.videoSegmentStream.gopCache_=
[]),q.timelineStartInfo.dts=void 0,q.timelineStartInfo.pts=void 0,nb.clearDtsInfo(q),A.captionStream.reset());A.timestampRolloverStream&&A.timestampRolloverStream.discontinuity()};this.setAudioAppendStart=function(w){v&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(w)};this.setRemux=function(w){var A=this.transmuxPipeline_;g.remux=w;A&&A.coalesceStream&&A.coalesceStream.setRemux(w)};this.alignGopsWith=function(w){q&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(w)};
this.getLogTrigger_=function(w){var A=this;return function(B){B.stream=w;A.trigger("log",B)}};this.push=function(w){if(r){var A=Np(w);A&&"aac"!==this.transmuxPipeline_.type?this.setupAacPipeline():A||"ts"===this.transmuxPipeline_.type||this.setupTsPipeline();r=!1}this.transmuxPipeline_.headOfPipeline.push(w)};this.flush=function(){r=!0;this.transmuxPipeline_.headOfPipeline.flush()};this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()};this.reset=function(){this.transmuxPipeline_.headOfPipeline&&
this.transmuxPipeline_.headOfPipeline.reset()};this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}};Ug.prototype=new b;var ic=function(g){var l=""+String.fromCharCode(g[0]);l+=String.fromCharCode(g[1]);l+=String.fromCharCode(g[2]);return l+=String.fromCharCode(g[3])},Tk=function(g,l){var r=[],q;if(!l.length)return null;for(q=0;q<g.byteLength;){var v=(g[q]<<24|g[q+1]<<16|g[q+2]<<8|g[q+3])>>>0;var w=ic(g.subarray(q+4,q+8));v=1<v?q+v:g.byteLength;
w===l[0]&&(1===l.length?r.push(g.subarray(q+8,v)):(q=Tk(g.subarray(q+8,v),l.slice(1)),q.length&&(r=r.concat(q))));q=v}return r},na=Tk,Uk=function(g){var l={version:g[0],flags:new Uint8Array(g.subarray(1,4))};l.baseMediaDecodeTime=1===l.version?e(g.subarray(4)):(g[4]<<24|g[5]<<16|g[6]<<8|g[7])>>>0;return l},Vk=function(g){return{isLeading:(g[0]&12)>>>2,dependsOn:g[0]&3,isDependedOn:(g[1]&192)>>>6,hasRedundancy:(g[1]&48)>>>4,paddingValue:(g[1]&14)>>>1,isNonSyncSample:g[1]&1,degradationPriority:g[2]<<
8|g[3]}},Wk=function(g){var l={version:g[0],flags:new Uint8Array(g.subarray(1,4)),samples:[]},r=new DataView(g.buffer,g.byteOffset,g.byteLength),q=l.flags[2]&1,v=l.flags[2]&4,w=l.flags[1]&1,A=l.flags[1]&2,B=l.flags[1]&4,F=l.flags[1]&8,I=r.getUint32(4),N=8;q&&(l.dataOffset=r.getInt32(N),N+=4);v&&I&&(q={flags:Vk(g.subarray(N,N+4))},N+=4,w&&(q.duration=r.getUint32(N),N+=4),A&&(q.size=r.getUint32(N),N+=4),F&&(q.compositionTimeOffset=1===l.version?r.getInt32(N):r.getUint32(N),N+=4),l.samples.push(q),I--);
for(;I--;)q={},w&&(q.duration=r.getUint32(N),N+=4),A&&(q.size=r.getUint32(N),N+=4),B&&(q.flags=Vk(g.subarray(N,N+4)),N+=4),F&&(q.compositionTimeOffset=1===l.version?r.getInt32(N):r.getUint32(N),N+=4),l.samples.push(q);return l},Xk=function(g){var l=new DataView(g.buffer,g.byteOffset,g.byteLength);g={version:g[0],flags:new Uint8Array(g.subarray(1,4)),trackId:l.getUint32(4)};var r=g.flags[2]&1,q=g.flags[2]&2,v=g.flags[2]&8,w=g.flags[2]&16,A=g.flags[2]&32,B=g.flags[0]&65536,F=g.flags[0]&131072;var I=
8;r&&(I+=4,g.baseDataOffset=l.getUint32(12),I+=4);q&&(g.sampleDescriptionIndex=l.getUint32(I),I+=4);v&&(g.defaultSampleDuration=l.getUint32(I),I+=4);w&&(g.defaultSampleSize=l.getUint32(I),I+=4);A&&(g.defaultSampleFlags=l.getUint32(I));B&&(g.durationIsEmpty=!0);!r&&F&&(g.baseDataOffsetIsMoof=!0);return g},wd="undefined"!==typeof window?window:"undefined"!==typeof a?a:"undefined"!==typeof self?self:{},Qp=qd.discardEmulationPreventionBytes,Rp=function(g,l,r){var q=l,v=r.defaultSampleDuration||0,w=r.defaultSampleSize||
0,A=r.trackId,B=[];g.forEach(function(F){F=Wk(F).samples;F.forEach(function(I){void 0===I.duration&&(I.duration=v);void 0===I.size&&(I.size=w);I.trackId=A;I.dts=q;void 0===I.compositionTimeOffset&&(I.compositionTimeOffset=0);"bigint"===typeof q?(I.pts=q+wd.BigInt(I.compositionTimeOffset),q+=wd.BigInt(I.duration)):(I.pts=q+I.compositionTimeOffset,q+=I.duration)});B=B.concat(F)});return B},Sp=function(g,l){var r=na(g,["moof","traf"]),q={},v=[];na(g,["mdat"]).forEach(function(w,A){v.push({mdat:w,traf:r[A]})});
v.forEach(function(w){var A=w.mdat,B=w.traf;w=na(B,["tfhd"]);var F=Xk(w[0]);w=F.trackId;var I=na(B,["tfdt"]);I=0<I.length?Uk(I[0]).baseMediaDecodeTime:0;B=na(B,["trun"]);if(l===w&&0<B.length){B=Rp(B,I,F);F=new DataView(A.buffer,A.byteOffset,A.byteLength);I=[];var N=[],L;for(L=0;L+4<A.length;L+=X){var X=F.getUint32(L);L+=4;if(!(0>=X))switch(A[L]&31){case 6:var S=A.subarray(L+1,L+1+X);a:{var da=L;for(var db=0;db<B.length;db++){var td=B[db];if(da<td.size){da=td;break a}da-=td.size}da=null}S={nalUnitType:"sei_rbsp",
size:X,data:S,escapedRBSP:Qp(S),trackId:w};if(da){S.pts=da.pts;S.dts=da.dts;var Da=da}else if(Da)S.pts=Da.pts,S.dts=Da.dts;else{I.push({level:"warn",message:"We've encountered a nal unit without data at "+L+" for trackId "+w+". See mux.js#223."});break}N.push(S)}}q[w]||(q[w]={seiNals:[],logs:[]});q[w].seiNals=q[w].seiNals.concat(N);q[w].logs=q[w].logs.concat(I)}});return q},Tp=function(){var g=!1,l,r,q,v,w,A;this.isInitialized=function(){return g};this.init=function(B){l=new Ik;g=!0;A=B?B.isPartial:
!1;l.on("data",function(F){F.startTime=F.startPts/v;F.endTime=F.endPts/v;w.captions.push(F);w.captionStreams[F.stream]=!0});l.on("log",function(F){w.logs.push(F)})};this.isNewInit=function(B,F){return B&&0===B.length||F&&"object"===typeof F&&0===Object.keys(F).length?!1:q!==B[0]||v!==F[q]};this.parse=function(B,F,I){if(this.isInitialized()){if(!F||!I)return null;if(this.isNewInit(F,I))q=F[0],v=I[q];else if(null===q||!v)return r.push(B),null}else return null;for(;0<r.length;){var N=r.shift();this.parse(N,
F,I)}I=q;F=v;null===I?B=null:(B=Sp(B,I)[I]||{},B={seiNals:B.seiNals,logs:B.logs,timescale:F});B&&B.logs&&(w.logs=w.logs.concat(B.logs));if(null===B||!B.seiNals)return w.logs.length?{logs:w.logs,captions:[],captionStreams:[]}:null;this.pushNals(B.seiNals);this.flushStream();return w};this.pushNals=function(B){if(!this.isInitialized()||!B||0===B.length)return null;B.forEach(function(F){l.push(F)})};this.flushStream=function(){if(!this.isInitialized())return null;A?l.partialFlush():l.flush()};this.clearParsedCaptions=
function(){w.captions=[];w.captionStreams={};w.logs=[]};this.resetCaptionStream=function(){if(!this.isInitialized())return null;l.reset()};this.clearAllCaptions=function(){this.clearParsedCaptions();this.resetCaptionStream()};this.reset=function(){r=[];v=q=null;w?this.clearParsedCaptions():w={captions:[],captionStreams:{},logs:[]};this.resetCaptionStream()};this.reset()},Ie=function(g){for(var l=0,r=String.fromCharCode(g[l]),q="";"\x00"!==r;)q+=r,l++,r=String.fromCharCode(g[l]);return q+r},Yk=function(g){return void 0!==
g||null!==g},xd=function(g){return("00"+g.toString(16)).slice(-2)},Vg={parseEmsgBox:function(g){var l=4,r=g[0];if(0===r){var q=Ie(g.subarray(l));l+=q.length;var v=Ie(g.subarray(l));l+=v.length;var w=new DataView(g.buffer);var A=w.getUint32(l);l+=4;var B=w.getUint32(l);l+=4;var F=w.getUint32(l);l+=4;w=w.getUint32(l);l+=4}else if(1===r){w=new DataView(g.buffer);A=w.getUint32(l);l+=4;var I=e(g.subarray(l));l+=8;F=w.getUint32(l);l+=4;w=w.getUint32(l);l+=4;q=Ie(g.subarray(l));l+=q.length;v=Ie(g.subarray(l));
l+=v.length}g=new Uint8Array(g.subarray(l,g.byteLength));q={scheme_id_uri:q,value:v,timescale:A?A:1,presentation_time:I,presentation_time_delta:B,event_duration:F,id:w,message_data:g};A="\x00"!==q.scheme_id_uri;v=0===r&&Yk(q.presentation_time_delta)&&A;A=1===r&&Yk(q.presentation_time)&&A;return!(1<r)&&v||A?q:void 0},scaleTime:function(g,l,r,q){return g||0===g?g/l:q+r/l}},Up=Kb.parseId3Frames;var Zk=function(g){var l=0===g[0]?12:20;return(g[l]<<24|g[l+1]<<16|g[l+2]<<8|g[l+3])>>>0};var $k={findBox:na,
parseType:ic,timescale:function(g){return na(g,["moov","trak"]).reduce(function(l,r){var q=na(r,["tkhd"])[0];if(!q)return null;var v=q[0];v=0===v?12:20;q=(q[v]<<24|q[v+1]<<16|q[v+2]<<8|q[v+3])>>>0;r=na(r,["mdia","mdhd"])[0];if(!r)return null;v=r[0];v=0===v?12:20;l[q]=(r[v]<<24|r[v+1]<<16|r[v+2]<<8|r[v+3])>>>0;return l},{})},startTime:function(g,l){l=na(l,["moof","traf"]).reduce(function(r,q){var v=na(q,["tfhd"])[0];v=g[(v[4]<<24|v[5]<<16|v[6]<<8|v[7])>>>0]||9E4;q=na(q,["tfdt"])[0];var w=new DataView(q.buffer,
q.byteOffset,q.byteLength);q=1===q[0]?e(q.subarray(4,12)):w.getUint32(4);let A;"bigint"===typeof q?A=q/wd.BigInt(v):"number"!==typeof q||isNaN(q)||(A=q/v);A<Number.MAX_SAFE_INTEGER&&(A=Number(A));A<r&&(r=A);return r},Infinity);return"bigint"===typeof l||isFinite(l)?l:0},compositionStartTime:function(g,l){var r=na(l,["moof","traf"]),q=l=0;if(r&&r.length){var v=na(r[0],["tfhd"])[0],w=na(r[0],["trun"])[0];r=na(r[0],["tfdt"])[0];if(v)var A=Xk(v).trackId;r&&(l=Uk(r).baseMediaDecodeTime);w&&(v=Wk(w),v.samples&&
v.samples.length&&(q=v.samples[0].compositionTimeOffset||0))}g=g[A]||9E4;"bigint"===typeof l&&(q=wd.BigInt(q),g=wd.BigInt(g));g=(l+q)/g;"bigint"===typeof g&&g<Number.MAX_SAFE_INTEGER&&(g=Number(g));return g},videoTrackIds:function(g){var l=[];na(g,["moov","trak"]).forEach(function(r){var q=na(r,["mdia","hdlr"]),v=na(r,["tkhd"]);q.forEach(function(w,A){w=ic(w.subarray(8,12));A=v[A];"vide"===w&&(A=new DataView(A.buffer,A.byteOffset,A.byteLength),w=A.getUint8(0),A=0===w?A.getUint32(12):A.getUint32(20),
l.push(A))})});return l},tracks:function(g){var l=[];na(g,["moov","trak"]).forEach(function(r){var q={},v=na(r,["tkhd"])[0];if(v){v=new DataView(v.buffer,v.byteOffset,v.byteLength);var w=v.getUint8(0);q.id=0===w?v.getUint32(12):v.getUint32(20)}if(v=na(r,["mdia","hdlr"])[0])v=ic(v.subarray(8,12)),q.type="vide"===v?"video":"soun"===v?"audio":v;if(v=na(r,["mdia","minf","stbl","stsd"])[0])if(v=v.subarray(8),q.codec=ic(v.subarray(4,8)),v=na(v,[q.codec])[0])/^[asm]vc[1-9]$/i.test(q.codec)?(v=v.subarray(78),
w=ic(v.subarray(4,8)),"avcC"===w&&11<v.length?(q.codec+=".",q.codec+=xd(v[9]),q.codec+=xd(v[10]),q.codec+=xd(v[11])):q.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(q.codec)?(v=v.subarray(28),w=ic(v.subarray(4,8)),"esds"===w&&20<v.length&&0!==v[19]?(q.codec+="."+xd(v[19]),q.codec+="."+xd(v[20]>>>2&63).replace(/^0/,"")):q.codec="mp4a.40.2"):q.codec=q.codec.toLowerCase();if(r=na(r,["mdia","mdhd"])[0])q.timescale=Zk(r);l.push(q)});return l},getTimescaleFromMediaHeader:Zk,getEmsgID3:function(g,l=0){return na(g,
["emsg"]).map(r=>{r=Vg.parseEmsgBox(new Uint8Array(r));var q=Up(r.message_data);return{cueTime:Vg.scaleTime(r.presentation_time,r.timescale,r.presentation_time_delta,l),duration:Vg.scaleTime(r.event_duration,r.timescale),frames:q}})}},al=function(g){var l=g[1]&31;return l=l<<8|g[2]},Je=function(g){return!!(g[1]&64)},Ke=function(g){var l=0;1<(g[3]&48)>>>4&&(l+=g[4]+1);return l},Wg=function(g){switch(g){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";
case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}};var ua={parseType:function(g,l){g=al(g);return 0===g?"pat":g===l?"pmt":l?"pes":null},parsePat:function(g){var l=Je(g),r=4+Ke(g);l&&(r+=g[r]+1);return(g[r+10]&31)<<8|g[r+11]},parsePmt:function(g){var l={},r=Je(g),q=4+Ke(g);r&&(q+=g[q]+1);if(g[q+5]&1){r=3+((g[q+1]&15)<<8|g[q+2])-4;for(var v=12+((g[q+10]&15)<<8|g[q+11]);v<r;){var w=q+v;l[(g[w+1]&31)<<8|g[w+2]]=g[w];v+=((g[w+3]&15)<<8|g[w+4])+5}return l}},
parsePayloadUnitStartIndicator:Je,parsePesType:function(g,l){g=al(g);switch(l[g]){case Ga.H264_STREAM_TYPE:return"video";case Ga.ADTS_STREAM_TYPE:return"audio";case Ga.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},parsePesTime:function(g){if(!Je(g))return null;var l=4+Ke(g);if(l>=g.byteLength)return null;var r=null;var q=g[l+7];q&192&&(r={},r.pts=(g[l+9]&14)<<27|(g[l+10]&255)<<20|(g[l+11]&254)<<12|(g[l+12]&255)<<5|(g[l+13]&254)>>>3,r.pts*=4,r.pts+=(g[l+13]&6)>>>1,r.dts=r.pts,q&
64&&(r.dts=(g[l+14]&14)<<27|(g[l+15]&255)<<20|(g[l+16]&254)<<12|(g[l+17]&255)<<5|(g[l+18]&254)>>>3,r.dts*=4,r.dts+=(g[l+18]&6)>>>1));return r},videoPacketContainsKeyFrame:function(g){var l=4+Ke(g);g=g.subarray(l);for(var r=l=0,q=!1;r<g.byteLength-3;r++)if(1===g[r+2]){l=r+5;break}for(;l<g.byteLength;)switch(g[l]){case 0:if(0!==g[l-1]){l+=2;break}else if(0!==g[l-2]){l++;break}r+3!==l-2&&(r=Wg(g[r+3]&31),"slice_layer_without_partitioning_rbsp_idr"===r&&(q=!0));do l++;while(1!==g[l]&&l<g.length);r=l-
2;l+=3;break;case 1:if(0!==g[l-1]||0!==g[l-2]){l+=3;break}r=Wg(g[r+3]&31);"slice_layer_without_partitioning_rbsp_idr"===r&&(q=!0);r=l-2;l+=3;break;default:l+=3}g=g.subarray(r);l-=r;g&&3<g.byteLength&&(r=Wg(g[3]&31),"slice_layer_without_partitioning_rbsp_idr"===r&&(q=!0));return q}};var jc=fa.ONE_SECOND_IN_TS,Vp=function(g,l){for(var r=0,q=188,v,w;q<g.byteLength;)if(71===g[r]&&71===g[q]){v=g.subarray(r,q);w=ua.parseType(v,l.pid);switch(w){case "pat":l.pid=ua.parsePat(v);break;case "pmt":var A=ua.parsePmt(v);
l.table=l.table||{};Object.keys(A).forEach(function(B){l.table[B]=A[B]})}r+=188;q+=188}else r++,q++},bl=function(g,l,r){for(var q=0,v=188,w,A,B,F=!1;v<=g.byteLength;)if(71!==g[q]||71!==g[v]&&v!==g.byteLength)q++,v++;else{w=g.subarray(q,v);A=ua.parseType(w,l.pid);switch(A){case "pes":if(A=ua.parsePesType(w,l.table),B=ua.parsePayloadUnitStartIndicator(w),"audio"===A&&B&&(w=ua.parsePesTime(w)))w.type="audio",r.audio.push(w),F=!0}if(F)break;q+=188;v+=188}v=g.byteLength;q=v-188;for(F=!1;0<=q;)if(71!==
g[q]||71!==g[v]&&v!==g.byteLength)q--,v--;else{w=g.subarray(q,v);A=ua.parseType(w,l.pid);switch(A){case "pes":if(A=ua.parsePesType(w,l.table),B=ua.parsePayloadUnitStartIndicator(w),"audio"===A&&B&&(w=ua.parsePesTime(w)))w.type="audio",r.audio.push(w),F=!0}if(F)break;q-=188;v-=188}},Wp=function(g,l){if(g.audio&&g.audio.length){var r=l;if("undefined"===typeof r||isNaN(r))r=g.audio[0].dts;g.audio.forEach(function(v){v.dts=Wb(v.dts,r);v.pts=Wb(v.pts,r);v.dtsTime=v.dts/jc;v.ptsTime=v.pts/jc})}if(g.video&&
g.video.length){var q=l;if("undefined"===typeof q||isNaN(q))q=g.video[0].dts;g.video.forEach(function(v){v.dts=Wb(v.dts,q);v.pts=Wb(v.pts,q);v.dtsTime=v.dts/jc;v.ptsTime=v.pts/jc});g.firstKeyFrame&&(g=g.firstKeyFrame,g.dts=Wb(g.dts,q),g.pts=Wb(g.pts,q),g.dtsTime=g.dts/jc,g.ptsTime=g.pts/jc)}},Xp={inspect:function(g,l){if(Lb.isLikelyAacData(g))a:{for(var r=!1,q=0,v=null,w=null,A=0,B=0,F;3<=g.length-B;){switch(Lb.parseType(g,B)){case "timed-metadata":if(10>g.length-B){r=!0;break}A=Lb.parseId3TagSize(g,
B);if(A>g.length){r=!0;break}null===w&&(F=g.subarray(B,B+A),w=Lb.parseAacTimestamp(F));B+=A;break;case "audio":if(7>g.length-B){r=!0;break}A=Lb.parseAdtsSize(g,B);if(A>g.length){r=!0;break}null===v&&(F=g.subarray(B,B+A),v=Lb.parseSampleRate(F));q++;B+=A;break;default:B++}if(r){g=null;break a}}null===v||null===w?g=null:(g=jc/v,g={audio:[{type:"audio",dts:w,pts:w},{type:"audio",dts:w+1024*q*g,pts:w+1024*q*g}]})}else{q={pid:null,table:null};w={};Vp(g,q);for(r in q.table)if(q.table.hasOwnProperty(r))switch(q.table[r]){case Ga.H264_STREAM_TYPE:w.video=
[];var I=void 0,N=void 0,L=void 0;v=N=L=N=L=void 0;A=g;B=q;F=w;var X=0,S=188,da=!1,db=[];for(I=0;S<A.byteLength;)if(71===A[X]&&71===A[S]){v=A.subarray(X,S);N=ua.parseType(v,B.pid);switch(N){case "pes":if(L=ua.parsePesType(v,B.table),N=ua.parsePayloadUnitStartIndicator(v),"video"===L)if(N&&!da&&(L=ua.parsePesTime(v))&&(L.type="video",F.video.push(L),da=!0),!F.firstKeyFrame){if(N&&0!==I){L=new Uint8Array(I);for(N=0;db.length;)I=db.shift(),L.set(I,N),N+=I.byteLength;ua.videoPacketContainsKeyFrame(L)&&
((I=ua.parsePesTime(L))?(F.firstKeyFrame=I,F.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself."));I=0}db.push(v);I+=v.byteLength}}if(da&&F.firstKeyFrame)break;X+=188;S+=188}else X++,S++;S=A.byteLength;X=S-188;for(da=!1;0<=X;)if(71===
A[X]&&71===A[S]){v=A.subarray(X,S);N=ua.parseType(v,B.pid);switch(N){case "pes":if(L=ua.parsePesType(v,B.table),N=ua.parsePayloadUnitStartIndicator(v),"video"===L&&N&&(L=ua.parsePesTime(v)))L.type="video",F.video.push(L),da=!0}if(da)break;X-=188;S-=188}else X--,S--;0===w.video.length&&delete w.video;break;case Ga.ADTS_STREAM_TYPE:w.audio=[],bl(g,q,w),0===w.audio.length&&delete w.audio}g=w}if(!g||!g.audio&&!g.video)return null;Wp(g,l);return g},parseAudioPes_:bl};const Yp=function(g,l){l.on("data",
function(r){var q=r.initSegment;r.initSegment={data:q.buffer,byteOffset:q.byteOffset,byteLength:q.byteLength};q=r.data;r.data=q.buffer;g.postMessage({action:"data",segment:r,byteOffset:q.byteOffset,byteLength:q.byteLength},[r.data])});l.on("done",function(r){g.postMessage({action:"done"})});l.on("gopInfo",function(r){g.postMessage({action:"gopInfo",gopInfo:r})});l.on("videoSegmentTimingInfo",function(r){const q={start:{decode:fa.videoTsToSeconds(r.start.dts),presentation:fa.videoTsToSeconds(r.start.pts)},
end:{decode:fa.videoTsToSeconds(r.end.dts),presentation:fa.videoTsToSeconds(r.end.pts)},baseMediaDecodeTime:fa.videoTsToSeconds(r.baseMediaDecodeTime)};r.prependedContentDuration&&(q.prependedContentDuration=fa.videoTsToSeconds(r.prependedContentDuration));g.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:q})});l.on("audioSegmentTimingInfo",function(r){const q={start:{decode:fa.videoTsToSeconds(r.start.dts),presentation:fa.videoTsToSeconds(r.start.pts)},end:{decode:fa.videoTsToSeconds(r.end.dts),
presentation:fa.videoTsToSeconds(r.end.pts)},baseMediaDecodeTime:fa.videoTsToSeconds(r.baseMediaDecodeTime)};r.prependedContentDuration&&(q.prependedContentDuration=fa.videoTsToSeconds(r.prependedContentDuration));g.postMessage({action:"audioSegmentTimingInfo",audioSegmentTimingInfo:q})});l.on("id3Frame",function(r){g.postMessage({action:"id3Frame",id3Frame:r})});l.on("caption",function(r){g.postMessage({action:"caption",caption:r})});l.on("trackinfo",function(r){g.postMessage({action:"trackinfo",
trackInfo:r})});l.on("audioTimingInfo",function(r){g.postMessage({action:"audioTimingInfo",audioTimingInfo:{start:fa.videoTsToSeconds(r.start),end:fa.videoTsToSeconds(r.end)}})});l.on("videoTimingInfo",function(r){g.postMessage({action:"videoTimingInfo",videoTimingInfo:{start:fa.videoTsToSeconds(r.start),end:fa.videoTsToSeconds(r.end)}})});l.on("log",function(r){g.postMessage({action:"log",log:r})})};class cl{constructor(g,l){this.options=l||{};this.self=g;this.init()}init(){this.transmuxer&&this.transmuxer.dispose();
this.transmuxer=new Ug(this.options);Yp(this.self,this.transmuxer)}pushMp4Captions(g){this.captionParser||(this.captionParser=new Tp,this.captionParser.init());const l=new Uint8Array(g.data,g.byteOffset,g.byteLength);g=this.captionParser.parse(l,g.trackIds,g.timescales);this.self.postMessage({action:"mp4Captions",captions:g&&g.captions||[],logs:g&&g.logs||[],data:l.buffer},[l.buffer])}probeMp4StartTime({timescales:g,data:l}){g=$k.startTime(g,l);this.self.postMessage({action:"probeMp4StartTime",startTime:g,
data:l},[l.buffer])}probeMp4Tracks({data:g}){const l=$k.tracks(g);this.self.postMessage({action:"probeMp4Tracks",tracks:l,data:g},[g.buffer])}probeTs({data:g,baseStartTime:l}){l="number"!==typeof l||isNaN(l)?void 0:l*fa.ONE_SECOND_IN_TS;l=Xp.inspect(g,l);let r=null;l&&(r={hasVideo:l.video&&2===l.video.length||!1,hasAudio:l.audio&&2===l.audio.length||!1},r.hasVideo&&(r.videoStart=l.video[0].ptsTime),r.hasAudio&&(r.audioStart=l.audio[0].ptsTime));this.self.postMessage({action:"probeTs",result:r,data:g},
[g.buffer])}clearAllMp4Captions(){this.captionParser&&this.captionParser.clearAllCaptions()}clearParsedMp4Captions(){this.captionParser&&this.captionParser.clearParsedCaptions()}push(g){g=new Uint8Array(g.data,g.byteOffset,g.byteLength);this.transmuxer.push(g)}reset(){this.transmuxer.reset()}setTimestampOffset(g){this.transmuxer.setBaseMediaDecodeTime(Math.round(fa.secondsToVideoTs(g.timestampOffset||0)))}setAudioAppendStart(g){this.transmuxer.setAudioAppendStart(Math.ceil(fa.secondsToVideoTs(g.appendStart)))}setRemux(g){this.transmuxer.setRemux(g.remux)}flush(g){this.transmuxer.flush();
self.postMessage({action:"done",type:"transmuxed"})}endTimeline(){this.transmuxer.endTimeline();self.postMessage({action:"endedtimeline",type:"transmuxed"})}alignGopsWith(g){this.transmuxer.alignGopsWith(g.gopsToAlignWith.slice())}}self.onmessage=function(g){if("init"===g.data.action&&g.data.options)this.messageHandlers=new cl(self,g.data.options);else if(this.messageHandlers||(this.messageHandlers=new cl(self)),g.data&&g.data.action&&"init"!==g.data.action&&this.messageHandlers[g.data.action])this.messageHandlers[g.data.action](g.data)}}));
var $p=Ak(Zp);const aq=({transmuxedData:a,callback:b})=>{a.buffer=[];b(a)},dl=a=>{const {transmuxer:b,bytes:c,audioAppendStart:e,gopsToAlignWith:h,remux:m,onData:p,onTrackInfo:t,onAudioTimingInfo:x,onVideoTimingInfo:y,onVideoSegmentTimingInfo:C,onAudioSegmentTimingInfo:z,onId3:E,onCaptions:K,onDone:G,onEndedTimeline:O,onTransmuxerLog:R,isEndOfTimeline:W}=a,U={buffer:[]};let ba=W;b.onmessage=J=>{if(b.currentTransmux===a){if("data"===J.data.action){const {type:ta,initSegment:Aa,captions:V,captionStreams:wa,
metadata:Ig,videoFrameDtsTime:ye,videoFramePtsTime:xe}=J.data.segment;U.buffer.push({captions:V,captionStreams:wa,metadata:Ig});var ea=J.data.segment.boxes||{data:J.data.segment.data};ea={type:ta,data:new Uint8Array(ea.data,ea.data.byteOffset,ea.data.byteLength),initSegment:new Uint8Array(Aa.data,Aa.byteOffset,Aa.byteLength)};"undefined"!==typeof ye&&(ea.videoFrameDtsTime=ye);"undefined"!==typeof xe&&(ea.videoFramePtsTime=xe);p(ea)}"trackinfo"===J.data.action&&t(J.data.trackInfo);"gopInfo"===J.data.action&&
(U.gopInfo=J.data.gopInfo);"audioTimingInfo"===J.data.action&&x(J.data.audioTimingInfo);"videoTimingInfo"===J.data.action&&y(J.data.videoTimingInfo);"videoSegmentTimingInfo"===J.data.action&&C(J.data.videoSegmentTimingInfo);"audioSegmentTimingInfo"===J.data.action&&z(J.data.audioSegmentTimingInfo);"id3Frame"===J.data.action&&E([J.data.id3Frame],J.data.id3Frame.dispatchType);"caption"===J.data.action&&K(J.data.caption);"endedtimeline"===J.data.action&&(ba=!1,O());"log"===J.data.action&&R(J.data.log);
"transmuxed"!==J.data.type||ba||(b.onmessage=null,aq({transmuxedData:U,callback:G}),Xg(b))}};e&&b.postMessage({action:"setAudioAppendStart",appendStart:e});Array.isArray(h)&&b.postMessage({action:"alignGopsWith",gopsToAlignWith:h});"undefined"!==typeof m&&b.postMessage({action:"setRemux",remux:m});if(c.byteLength){const J=c instanceof ArrayBuffer?c:c.buffer;b.postMessage({action:"push",data:J,byteOffset:c instanceof ArrayBuffer?0:c.byteOffset,byteLength:c.byteLength},[J])}W&&b.postMessage({action:"endTimeline"});
b.postMessage({action:"flush"})},Xg=a=>{a.currentTransmux=null;a.transmuxQueue.length&&(a.currentTransmux=a.transmuxQueue.shift(),"function"===typeof a.currentTransmux?a.currentTransmux():dl(a.currentTransmux))},bq=(a,b)=>{a.postMessage({action:b});Xg(a)},el=(a,b)=>{b.currentTransmux?b.transmuxQueue.push(bq.bind(null,b,a)):(b.currentTransmux=a,b.postMessage({action:a}),Xg(b))},fl=a=>{a.transmuxer.currentTransmux?a.transmuxer.transmuxQueue.push(a):(a.transmuxer.currentTransmux=a,dl(a))};var Yg={reset:a=>
{el("reset",a)},endTimeline:a=>{el("endTimeline",a)},transmux:fl,createTransmuxer:a=>{const b=new $p;b.currentTransmux=null;b.transmuxQueue=[];const c=b.terminate;b.terminate=()=>{b.currentTransmux=null;b.transmuxQueue.length=0;return c.call(b)};b.postMessage({action:"init",options:a});return b}};const Le=function(a){const b=a.transmuxer,c=a.endAction||a.action,e=a.callback,h=Nb({},a,{endAction:null,transmuxer:null,callback:null}),m=p=>{p.data.action===c&&(b.removeEventListener("message",m),p.data.data&&
(p.data.data=new Uint8Array(p.data.data,a.byteOffset||0,a.byteLength||p.data.data.byteLength),a.data&&(a.data=p.data.data)),e(p.data))};b.addEventListener("message",m);if(a.data){const p=a.data instanceof ArrayBuffer;h.byteOffset=p?0:a.data.byteOffset;h.byteLength=a.data.byteLength;b.postMessage(h,[p?a.data:a.data.buffer])}else b.postMessage(h)},Zg=a=>{a.forEach(b=>{b.abort()})},$g=(a,b)=>b.timedout?{status:b.status,message:"HLS request timed-out at URL: "+b.uri,code:-101,xhr:b}:b.aborted?{status:b.status,
message:"HLS request aborted at URL: "+b.uri,code:-102,xhr:b}:a?{status:b.status,message:"HLS request errored at URL: "+b.uri,code:2,xhr:b}:"arraybuffer"===b.responseType&&0===b.response.byteLength?{status:b.status,message:"Empty HLS response at URL: "+b.uri,code:2,xhr:b}:null,gl=(a,b,c)=>(e,h)=>{var m=h.response;if(e=$g(e,h))return c(e,a);if(16!==m.byteLength)return c({status:h.status,message:"Invalid HLS key at URL: "+h.uri,code:2,xhr:h},a);h=new DataView(m);h=new Uint32Array([h.getUint32(0),h.getUint32(4),
h.getUint32(8),h.getUint32(12)]);for(m=0;m<b.length;m++)b[m].bytes=h;return c(null,a)},hl=(a,b)=>{const c=Rf(a.map.bytes);if("mp4"!==c)return b({internal:!0,message:`Found unsupported ${c||"unknown"} container for initialization segment at URL: ${a.map.resolvedUri||a.map.uri}`,code:2});Le({action:"probeMp4Tracks",data:a.map.bytes,transmuxer:a.transmuxer,callback:({tracks:e,data:h})=>{a.map.bytes=h;e.forEach(function(m){a.map.tracks=a.map.tracks||{};a.map.tracks[m.type]||(a.map.tracks[m.type]=m,"number"===
typeof m.id&&m.timescale&&(a.map.timescales=a.map.timescales||{},a.map.timescales[m.id]=m.timescale))});return b(null)}})},cq=({segment:a,finishProcessingFn:b})=>(c,e)=>{if(c=$g(c,e))return b(c,a);c=new Uint8Array(e.response);if(a.map.key)return a.map.encryptedBytes=c,b(null,a);a.map.bytes=c;hl(a,function(h){if(h)return h.xhr=e,h.status=e.status,b(h,a);b(null,a)})},dq=({segment:a,finishProcessingFn:b,responseType:c})=>(e,h)=>{if(e=$g(e,h))return b(e,a);if("arraybuffer"!==c&&h.responseText){e=h.responseText.substring(a.lastReachedChar||
0);const m=new Uint8Array(new ArrayBuffer(e.length));for(let p=0;p<e.length;p++)m[p]=e.charCodeAt(p);e=m.buffer}else e=h.response;a.stats={bandwidth:h.bandwidth,bytesReceived:h.bytesReceived||0,roundTripTime:h.roundTripTime||0};a.key?a.encryptedBytes=new Uint8Array(e):a.bytes=new Uint8Array(e);return b(null,a)},eq=({segment:a,bytes:b,trackInfoFn:c,timingInfoFn:e,videoSegmentTimingInfoFn:h,audioSegmentTimingInfoFn:m,id3Fn:p,captionsFn:t,isEndOfTimeline:x,endedTimelineFn:y,dataFn:C,doneFn:z,onTransmuxerLog:E})=>
{const K=a.map&&a.map.tracks||{},G=!(!K.audio||!K.video);let O=e.bind(null,a,"audio","start");const R=e.bind(null,a,"audio","end");let W=e.bind(null,a,"video","start");const U=e.bind(null,a,"video","end"),ba=()=>fl({bytes:b,transmuxer:a.transmuxer,audioAppendStart:a.audioAppendStart,gopsToAlignWith:a.gopsToAlignWith,remux:G,onData:J=>{J.type="combined"===J.type?"video":J.type;C(a,J)},onTrackInfo:J=>{c&&(G&&(J.isMuxed=!0),c(a,J))},onAudioTimingInfo:J=>{O&&"undefined"!==typeof J.start&&(O(J.start),
O=null);R&&"undefined"!==typeof J.end&&R(J.end)},onVideoTimingInfo:J=>{W&&"undefined"!==typeof J.start&&(W(J.start),W=null);U&&"undefined"!==typeof J.end&&U(J.end)},onVideoSegmentTimingInfo:J=>{h(J)},onAudioSegmentTimingInfo:J=>{m(J)},onId3:(J,ea)=>{p(a,J,ea)},onCaptions:J=>{t(a,[J])},isEndOfTimeline:x,onEndedTimeline:()=>{y()},onTransmuxerLog:E,onDone:J=>{z&&(J.type="combined"===J.type?"video":J.type,z(null,a,J))}});Le({action:"probeTs",transmuxer:a.transmuxer,data:b,baseStartTime:a.baseStartTime,
callback:J=>{a.bytes=b=J.data;if(J=J.result)c(a,{hasAudio:J.hasAudio,hasVideo:J.hasVideo,isMuxed:G}),c=null,J.hasAudio&&!G&&O(J.audioStart),J.hasVideo&&W(J.videoStart),W=O=null;ba()}})},il=({segment:a,bytes:b,trackInfoFn:c,timingInfoFn:e,videoSegmentTimingInfoFn:h,audioSegmentTimingInfoFn:m,id3Fn:p,captionsFn:t,isEndOfTimeline:x,endedTimelineFn:y,dataFn:C,doneFn:z,onTransmuxerLog:E})=>{let K=new Uint8Array(b);if(0<On(K,["moof"]).length){a.isFmp4=!0;const {tracks:G}=a.map,O={isFmp4:!0,hasVideo:!!G.video,
hasAudio:!!G.audio};G.audio&&G.audio.codec&&"enca"!==G.audio.codec&&(O.audioCodec=G.audio.codec);G.video&&G.video.codec&&"encv"!==G.video.codec&&(O.videoCodec=G.video.codec);G.video&&G.audio&&(O.isMuxed=!0);c(a,O);const R=W=>{C(a,{data:K,type:O.hasAudio&&!O.isMuxed?"audio":"video"});W&&W.length&&t(a,W);z(null,a,{})};Le({action:"probeMp4StartTime",timescales:a.map.timescales,data:K,transmuxer:a.transmuxer,callback:({data:W,startTime:U})=>{b=W.buffer;a.bytes=K=W;O.hasAudio&&!O.isMuxed&&e(a,"audio",
"start",U);O.hasVideo&&e(a,"video","start",U);G.video&&W.byteLength&&a.transmuxer?Le({action:"pushMp4Captions",endAction:"mp4Captions",transmuxer:a.transmuxer,data:K,timescales:a.map.timescales,trackIds:[G.video.id],callback:ba=>{b=ba.data.buffer;a.bytes=K=ba.data;ba.logs.forEach(function(J){E(la(J,{stream:"mp4CaptionParser"}))});R(ba.captions)}}):R()}})}else a.transmuxer?("undefined"===typeof a.container&&(a.container=Rf(K)),"ts"!==a.container&&"aac"!==a.container?(c(a,{hasAudio:!1,hasVideo:!1}),
z(null,a,{})):eq({segment:a,bytes:b,trackInfoFn:c,timingInfoFn:e,videoSegmentTimingInfoFn:h,audioSegmentTimingInfoFn:m,id3Fn:p,captionsFn:t,isEndOfTimeline:x,endedTimelineFn:y,dataFn:C,doneFn:z,onTransmuxerLog:E})):z(null,a,{})},jl=function({id:a,key:b,encryptedBytes:c,decryptionWorker:e},h){const m=t=>{t.data.source===a&&(e.removeEventListener("message",m),t=t.data.decrypted,h(new Uint8Array(t.bytes,t.byteOffset,t.byteLength)))};e.addEventListener("message",m);let p;p=b.bytes.slice?b.bytes.slice():
new Uint32Array(Array.prototype.slice.call(b.bytes));e.postMessage(tk({source:a,encrypted:c,key:p,iv:b.iv}),[c.buffer,p.buffer])},fq=({decryptionWorker:a,segment:b,trackInfoFn:c,timingInfoFn:e,videoSegmentTimingInfoFn:h,audioSegmentTimingInfoFn:m,id3Fn:p,captionsFn:t,isEndOfTimeline:x,endedTimelineFn:y,dataFn:C,doneFn:z,onTransmuxerLog:E})=>{jl({id:b.requestId,key:b.key,encryptedBytes:b.encryptedBytes,decryptionWorker:a},K=>{b.bytes=K;il({segment:b,bytes:b.bytes,trackInfoFn:c,timingInfoFn:e,videoSegmentTimingInfoFn:h,
audioSegmentTimingInfoFn:m,id3Fn:p,captionsFn:t,isEndOfTimeline:x,endedTimelineFn:y,dataFn:C,doneFn:z,onTransmuxerLog:E})})},gq=({activeXhrs:a,decryptionWorker:b,trackInfoFn:c,timingInfoFn:e,videoSegmentTimingInfoFn:h,audioSegmentTimingInfoFn:m,id3Fn:p,captionsFn:t,isEndOfTimeline:x,endedTimelineFn:y,dataFn:C,doneFn:z,onTransmuxerLog:E})=>{let K=0,G=!1;return(O,R)=>{if(!G){if(O)return G=!0,Zg(a),z(O,R);K+=1;if(K===a.length){const W=function(){if(R.encryptedBytes)return fq({decryptionWorker:b,segment:R,
trackInfoFn:c,timingInfoFn:e,videoSegmentTimingInfoFn:h,audioSegmentTimingInfoFn:m,id3Fn:p,captionsFn:t,isEndOfTimeline:x,endedTimelineFn:y,dataFn:C,doneFn:z,onTransmuxerLog:E});il({segment:R,bytes:R.bytes,trackInfoFn:c,timingInfoFn:e,videoSegmentTimingInfoFn:h,audioSegmentTimingInfoFn:m,id3Fn:p,captionsFn:t,isEndOfTimeline:x,endedTimelineFn:y,dataFn:C,doneFn:z,onTransmuxerLog:E})};R.endOfAllRequests=Date.now();if(R.map&&R.map.encryptedBytes&&!R.map.bytes)return jl({decryptionWorker:b,id:R.requestId+
"-init",encryptedBytes:R.map.encryptedBytes,key:R.map.key},U=>{R.map.bytes=U;hl(R,ba=>{if(ba)return Zg(a),z(ba,R);W()})});W()}}}},hq=({loadendState:a,abortFn:b})=>c=>{c.target.aborted&&b&&!a.calledAbortFn&&(b(),a.calledAbortFn=!0)},iq=({segment:a,progressFn:b})=>c=>{if(!c.target.aborted){var e=a.stats,h=c.target;h=Date.now()-h.requestTime;h={bandwidth:Infinity,bytesReceived:0,roundTripTime:h||0};h.bytesReceived=c.loaded;h.bandwidth=Math.floor(h.bytesReceived/h.roundTripTime*8E3);a.stats=la(e,h);!a.stats.firstBytesReceivedAt&&
a.stats.bytesReceived&&(a.stats.firstBytesReceivedAt=Date.now());return b(c,a)}},jq=({xhr:a,xhrOptions:b,decryptionWorker:c,segment:e,abortFn:h,progressFn:m,trackInfoFn:p,timingInfoFn:t,videoSegmentTimingInfoFn:x,audioSegmentTimingInfoFn:y,id3Fn:C,captionsFn:z,isEndOfTimeline:E,endedTimelineFn:K,dataFn:G,doneFn:O,onTransmuxerLog:R})=>{const W=[];c=gq({activeXhrs:W,decryptionWorker:c,trackInfoFn:p,timingInfoFn:t,videoSegmentTimingInfoFn:x,audioSegmentTimingInfoFn:y,id3Fn:C,captionsFn:z,isEndOfTimeline:E,
endedTimelineFn:K,dataFn:G,doneFn:O,onTransmuxerLog:R});e.key&&!e.key.bytes&&(R=[e.key],e.map&&!e.map.bytes&&e.map.key&&e.map.key.resolvedUri===e.key.resolvedUri&&R.push(e.map.key),O=la(b,{uri:e.key.resolvedUri,responseType:"arraybuffer"}),R=gl(e,R,c),O=a(O,R),W.push(O));e.map&&!e.map.bytes&&(!e.map.key||e.key&&e.key.resolvedUri===e.map.key.resolvedUri||(O=la(b,{uri:e.map.key.resolvedUri,responseType:"arraybuffer"}),R=gl(e,[e.map.key],c),O=a(O,R),W.push(O)),O=la(b,{uri:e.map.resolvedUri,responseType:"arraybuffer",
headers:Gg(e.map)}),R=cq({segment:e,finishProcessingFn:c}),O=a(O,R),W.push(O));b=la(b,{uri:e.part&&e.part.resolvedUri||e.resolvedUri,responseType:"arraybuffer",headers:Gg(e)});c=dq({segment:e,finishProcessingFn:c,responseType:b.responseType});a=a(b,c);a.addEventListener("progress",iq({segment:e,progressFn:m,trackInfoFn:p,timingInfoFn:t,videoSegmentTimingInfoFn:x,audioSegmentTimingInfoFn:y,id3Fn:C,captionsFn:z,isEndOfTimeline:E,endedTimelineFn:K,dataFn:G}));W.push(a);const U={};W.forEach(ba=>{ba.addEventListener("loadend",
hq({loadendState:U,abortFn:h}))});return()=>Zg(W)},kq=mb("CodecUtils"),kl=(a,b)=>{b=b.attributes||{};return a&&a.mediaGroups&&a.mediaGroups.AUDIO&&b.AUDIO&&a.mediaGroups.AUDIO[b.AUDIO]},Me=function(a){const b={};a.forEach(({mediaType:c,type:e,details:h})=>{b[c]=b[c]||[];b[c].push(pi(`${e}${h}`))});Object.keys(b).forEach(function(c){1<b[c].length?(kq(`multiple ${c} codecs found as attributes: ${b[c].join(", ")}. Setting playlist codecs to null so that we wait for mux.js to probe segments for real codecs.`),
b[c]=null):b[c]=b[c][0]});return b},ll=function(a){let b=0;a.audio&&b++;a.video&&b++;return b},yd=function(a,b){const c=b.attributes||{};var e=b.attributes||{};e=e.CODECS?vb(e.CODECS):void 0;e=Me(e||[]);if(kl(a,b)&&!e.audio){a:if(kl(a,b)){b=a.mediaGroups.AUDIO[(b.attributes||{}).AUDIO];for(h in b)if(!b[h].uri&&!b[h].playlists){var h=!0;break a}h=!1}else h=!0;h||(a=Me(Nm(a,c.AUDIO)||[]),a.audio&&(e.audio=a.audio))}return e},Ne=mb("PlaylistSelector"),ml=function(a){if(a&&a.playlist){var b=a.playlist;
return JSON.stringify({id:b.id,bandwidth:a.bandwidth,width:a.width,height:a.height,codecs:b.attributes&&b.attributes.CODECS||""})}},Oe=function(a,b){return a?(a=D.getComputedStyle(a))?a[b]:"":""},Oc=function(a,b){const c=a.slice();a.sort(function(e,h){const m=b(e,h);return 0===m?c.indexOf(e)-c.indexOf(h):m})},ah=function(a,b){let c,e;a.attributes.BANDWIDTH&&(c=a.attributes.BANDWIDTH);c=c||D.Number.MAX_VALUE;b.attributes.BANDWIDTH&&(e=b.attributes.BANDWIDTH);e=e||D.Number.MAX_VALUE;return c-e};let nl=
function(a,b,c,e,h,m){if(a){var p={bandwidth:b,width:c,height:e,limitRenditionByPlayerDimensions:h},t=a.playlists;Xa.isAudioOnly(a)&&(t=m.getAudioTrackPlaylists_(),p.audioOnly=!0);var x=t.map(G=>{let O;const R=G.attributes&&G.attributes.RESOLUTION&&G.attributes.RESOLUTION.width,W=G.attributes&&G.attributes.RESOLUTION&&G.attributes.RESOLUTION.height;O=(O=G.attributes&&G.attributes.BANDWIDTH)||D.Number.MAX_VALUE;return{bandwidth:O,width:R,height:W,playlist:G}});Oc(x,(G,O)=>G.bandwidth-O.bandwidth);
x=x.filter(G=>!Xa.isIncompatible(G.playlist));a=x.filter(G=>Xa.isEnabled(G.playlist));a.length||(a=x.filter(G=>!Xa.isDisabled(G.playlist)));var y=a.filter(G=>G.bandwidth*Ca.BANDWIDTH_VARIANCE<b),C=y[y.length-1];t=y.filter(G=>G.bandwidth===C.bandwidth)[0];if(!1===h){var z=t||a[0]||x[0];if(z&&z.playlist){var E="sortedPlaylistReps";t&&(E="bandwidthBestRep");a[0]&&(E="enabledPlaylistReps");Ne(`choosing ${ml(z)} using ${E} with options`,p);return z.playlist}Ne("could not choose a playlist with options",
p);return null}y=y.filter(G=>G.width&&G.height);Oc(y,(G,O)=>G.width-O.width);h=y.filter(G=>G.width===c&&G.height===e);C=h[h.length-1];h=h.filter(G=>G.bandwidth===C.bandwidth)[0];if(!h){var K=y.filter(G=>G.width>c||G.height>e);z=K.filter(G=>G.width===K[0].width&&G.height===K[0].height);C=z[z.length-1];z=z.filter(G=>G.bandwidth===C.bandwidth)[0]}m.leastPixelDiffSelector&&(E=y.map(G=>{G.pixelDiff=Math.abs(G.width-c)+Math.abs(G.height-e);return G}),Oc(E,(G,O)=>G.pixelDiff===O.pixelDiff?O.bandwidth-G.bandwidth:
G.pixelDiff-O.pixelDiff),E=E[0]);if((m=E||z||h||t||a[0]||x[0])&&m.playlist)return x="sortedPlaylistReps",E?x="leastPixelDiffRep":z?x="resolutionPlusOneRep":h?x="resolutionBestRep":t?x="bandwidthBestRep":a[0]&&(x="enabledPlaylistReps"),Ne(`choosing ${ml(m)} using ${x} with options`,p),m.playlist;Ne("could not choose a playlist with options",p);return null}};const ol=function(){const a=this.useDevicePixelRatio?D.devicePixelRatio||1:1;return nl(this.playlists.main,this.systemBandwidth,parseInt(Oe(this.tech_.el(),
"width"),10)*a,parseInt(Oe(this.tech_.el(),"height"),10)*a,this.limitRenditionByPlayerDimensions,this.playlistController_)},lq=function(a){const {main:b,currentTime:c,bandwidth:e,duration:h,segmentDuration:m,timeUntilRebuffer:p,currentTimeline:t,syncController:x}=a;a=b.playlists.filter(C=>!Xa.isIncompatible(C));var y=a.filter(Xa.isEnabled);y.length||(y=a.filter(C=>!Xa.isDisabled(C)));a=y.filter(Xa.hasAttribute.bind(null,"BANDWIDTH")).map(C=>{var z=x.getSyncPoint(C,h,t,c)?1:2;z=Xa.estimateSegmentRequestTime(m,
e,C)*z-p;return{playlist:C,rebufferingImpact:z}});y=a.filter(C=>0>=C.rebufferingImpact);Oc(y,(C,z)=>ah(z.playlist,C.playlist));if(y.length)return y[0];Oc(a,(C,z)=>C.rebufferingImpact-z.rebufferingImpact);return a[0]||null},mq=a=>{let b=0,c;a.bytes&&(c=new Uint8Array(a.bytes),a.segments.forEach(e=>{c.set(e,b);b+=e.byteLength}));return c},nq=function({inbandTextTracks:a,captionArray:b,timestampOffset:c}){if(b){var e=D.WebKitDataCue||D.VTTCue;b.forEach(h=>{a[h.stream].addCue(new e(h.startTime+c,h.endTime+
c,h.text))})}},oq=function(a){Object.defineProperties(a.frame,{id:{get(){H.log.warn("cue.frame.id is deprecated. Use cue.value.key instead.");return a.value.key}},value:{get(){H.log.warn("cue.frame.value is deprecated. Use cue.value.data instead.");return a.value.data}},privateData:{get(){H.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead.");return a.value.data}}})},pq=({inbandTextTracks:a,metadataArray:b,timestampOffset:c,videoDuration:e})=>{if(b){var h=D.WebKitDataCue||
D.VTTCue,m=a.metadataTrack_;if(m&&(b.forEach(x=>{const y=x.cueTime+c;!("number"!==typeof y||D.isNaN(y)||0>y)&&Infinity>y&&x.frames.forEach(C=>{const z=new h(y,y,C.value||C.url||C.data||"");z.frame=C;z.value=C;oq(z);m.addCue(z)})}),m.cues&&m.cues.length)){a=m.cues;b=[];for(let x=0;x<a.length;x++)a[x]&&b.push(a[x]);var p=b.reduce((x,y)=>{const C=x[y.startTime]||[];C.push(y);x[y.startTime]=C;return x},{}),t=Object.keys(p).sort((x,y)=>Number(x)-Number(y));t.forEach((x,y)=>{const C=Number(t[y+1])||e;p[x].forEach(z=>
{z.endTime=C})})}}},zd=function(a,b,c){let e,h;if(c&&c.cues)for(e=c.cues.length;e--;)h=c.cues[e],h.startTime>=a&&h.endTime<=b&&c.removeCue(h)},qq=function(a){const b=a.cues;if(b)for(let c=0;c<b.length;c++){const e=[];let h=0;for(let m=0;m<b.length;m++)b[c].startTime===b[m].startTime&&b[c].endTime===b[m].endTime&&b[c].text===b[m].text&&(h++,1<h&&e.push(b[m]));e.length&&e.forEach(m=>a.removeCue(m))}},rq=(a,b,c,e)=>{b=Math.ceil(9E4*(b-e));var h=Math.ceil(9E4*(c-e));c=a.slice();for(e=a.length;e--&&!(a[e].pts<=
h););if(-1===e)return c;for(h=e+1;h--&&!(a[h].pts<=b););h=Math.max(h,0);c.splice(h,e-h+1);return c},sq=function(a,b){if(!a&&!b||!a&&b||a&&!b)return!1;if(a===b)return!0;const c=Object.keys(a).sort(),e=Object.keys(b).sort();if(c.length!==e.length)return!1;for(let h=0;h<c.length;h++){const m=c[h];if(m!==e[h]||a[m]!==b[m])return!1}return!0},Pe=1/60,Pc=a=>{const {startOfSegment:b,duration:c,segment:e,part:h,playlist:{mediaSequence:m,id:p,segments:t=[]},mediaIndex:x,partIndex:y,timeline:C}=a,z=t.length-
1;let E="mediaIndex/partIndex increment";a.getMediaInfoForTime?E=`getMediaInfoForTime (${a.getMediaInfoForTime})`:a.isSyncRequest&&(E="getSyncSegmentCandidate (isSyncRequest)");a.independent&&(E+=` with independent ${a.independent}`);const K="number"===typeof y;a=a.segment.uri?"segment":"pre-segment";const G=K?ek({preloadSegment:e})-1:0;return`${a} [${m+x}/${m+z}]`+(K?` part [${y}/${G}]`:"")+` segment start/end [${e.start} => ${e.end}]`+(K?` part start/end [${h.start} => ${h.end}]`:"")+` startOfSegment [${b}]`+
` duration [${c}]`+` timeline [${C}]`+` selected by [${E}]`+` playlist [${p}]`},tq=({segmentTimeline:a,currentTimeline:b,startOfSegment:c,buffered:e,overrideCheck:h})=>h||a!==b?a<b?c:e.length?e.end(e.length-1):c:null,pl=({timelineChangeController:a,currentTimeline:b,segmentTimeline:c,loaderType:e,audioDisabled:h})=>b===c?!1:"audio"===e?(a=a.lastTimelineChange({type:"main"}),!a||a.to!==c):"main"===e&&h?(a=a.pendingTimelineChange({type:"audio"}))&&a.to===c?!1:!0:!1,uq=a=>{let b=0;["video","audio"].forEach(function(c){if(c=
a[`${c}TimingInfo`]){var {start:e,end:h}=c,m;"bigint"===typeof e||"bigint"===typeof h?m=D.BigInt(h)-D.BigInt(e):"number"===typeof e&&"number"===typeof h&&(m=h-e);"undefined"!==typeof m&&m>b&&(b=m)}});"bigint"===typeof b&&b<Number.MAX_SAFE_INTEGER&&(b=Number(b));return b},ql=({segmentDuration:a,maxDuration:b})=>a?Math.round(a)>b+Ub:!1;class bh extends H.EventTarget{constructor(a,b){super();if(!a)throw new TypeError("Initialization settings are required");if("function"!==typeof a.currentTime)throw new TypeError("No currentTime getter specified");
if(!a.mediaSource)throw new TypeError("No MediaSource specified");this.bandwidth=a.bandwidth;this.throughput={rate:0,count:0};this.roundTrip=NaN;this.resetStats_();this.partIndex=this.mediaIndex=null;this.hasPlayed_=a.hasPlayed;this.currentTime_=a.currentTime;this.seekable_=a.seekable;this.seeking_=a.seeking;this.duration_=a.duration;this.mediaSource_=a.mediaSource;this.vhs_=a.vhs;this.loaderType_=a.loaderType;this.startingMediaInfo_=this.currentMediaInfo_=void 0;this.segmentMetadataTrack_=a.segmentMetadataTrack;
this.goalBufferLength_=a.goalBufferLength;this.sourceType_=a.sourceType;this.sourceUpdater_=a.sourceUpdater;this.inbandTextTracks_=a.inbandTextTracks;this.state_="INIT";this.timelineChangeController_=a.timelineChangeController;this.shouldSaveSegmentTimingInfo_=!0;this.parse708captions_=a.parse708captions;this.useDtsForTimestampOffset_=a.useDtsForTimestampOffset;this.captionServices_=a.captionServices;this.exactManifestTimings=a.exactManifestTimings;this.checkBufferTimeout_=null;this.error_=void 0;
this.currentTimeline_=-1;this.xhrOptions_=this.pendingSegment_=null;this.pendingSegments_=[];this.isPendingTimestampOffset_=this.audioDisabled_=!1;this.gopBuffer_=[];this.timeMapping_=0;this.safeAppend_=11<=H.browser.IE_VERSION;this.appendInitSegment_={audio:!0,video:!0};this.playlistOfLastInitSegment_={audio:null,video:null};this.callQueue_=[];this.loadQueue_=[];this.metadataQueue_={id3:[],caption:[]};this.waitingOnRemove_=!1;this.activeInitSegmentId_=this.quotaExceededErrorRetryTimeout_=null;this.initSegments_=
{};this.cacheEncryptionKeys_=a.cacheEncryptionKeys;this.keyCache_={};this.decrypter_=a.decrypter;this.syncController_=a.syncController;this.syncPoint_={segmentIndex:0,time:0};this.transmuxer_=this.createTransmuxer_();this.triggerSyncInfoUpdate_=()=>this.trigger("syncinfoupdate");this.syncController_.on("syncinfoupdate",this.triggerSyncInfoUpdate_);this.mediaSource_.addEventListener("sourceopen",()=>{this.isEndOfStream_()||(this.ended_=!1)});this.fetchAtBuffer_=!1;this.logger_=mb(`SegmentLoader[${this.loaderType_}]`);
Object.defineProperty(this,"state",{get(){return this.state_},set(c){c!==this.state_&&(this.logger_(`${this.state_} -> ${c}`),this.state_=c,this.trigger("statechange"))}});this.sourceUpdater_.on("ready",()=>{this.hasEnoughInfoToAppend_()&&this.processCallQueue_()});if("main"===this.loaderType_)this.timelineChangeController_.on("pendingtimelinechange",()=>{this.hasEnoughInfoToAppend_()&&this.processCallQueue_()});if("audio"===this.loaderType_)this.timelineChangeController_.on("timelinechange",()=>
{this.hasEnoughInfoToLoad_()&&this.processLoadQueue_();this.hasEnoughInfoToAppend_()&&this.processCallQueue_()})}createTransmuxer_(){return Yg.createTransmuxer({remux:!1,alignGopsAtEnd:this.safeAppend_,keepOriginalTimestamps:!0,parse708captions:this.parse708captions_,captionServices:this.captionServices_})}resetStats_(){this.mediaAppends=this.mediaSecondsLoaded=this.mediaTransferDuration=this.mediaRequestsErrored=this.mediaRequestsTimedout=this.mediaRequestsAborted=this.mediaRequests=this.mediaBytesTransferred=
0}dispose(){this.trigger("dispose");this.state="DISPOSED";this.pause();this.abort_();this.transmuxer_&&this.transmuxer_.terminate();this.resetStats_();this.checkBufferTimeout_&&D.clearTimeout(this.checkBufferTimeout_);this.syncController_&&this.triggerSyncInfoUpdate_&&this.syncController_.off("syncinfoupdate",this.triggerSyncInfoUpdate_);this.off()}setAudio(a){this.audioDisabled_=!a;a?this.appendInitSegment_.audio=!0:this.sourceUpdater_.removeAudio(0,this.duration_())}abort(){"WAITING"!==this.state?
this.pendingSegment_&&(this.pendingSegment_=null):(this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_())}abort_(){this.pendingSegment_&&this.pendingSegment_.abortRequests&&this.pendingSegment_.abortRequests();this.pendingSegment_=null;this.callQueue_=[];this.loadQueue_=[];this.metadataQueue_.id3=[];this.metadataQueue_.caption=[];this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_);this.waitingOnRemove_=!1;D.clearTimeout(this.quotaExceededErrorRetryTimeout_);
this.quotaExceededErrorRetryTimeout_=null}checkForAbort_(a){return"APPENDING"!==this.state||this.pendingSegment_?this.pendingSegment_&&this.pendingSegment_.requestId===a?!1:!0:(this.state="READY",!0)}error(a){"undefined"!==typeof a&&(this.logger_("error occurred:",a),this.error_=a);this.pendingSegment_=null;return this.error_}endOfStream(){this.ended_=!0;this.transmuxer_&&Yg.reset(this.transmuxer_);this.gopBuffer_.length=0;this.pause();this.trigger("ended")}buffered_(){const a=this.getMediaInfo_();
if(!this.sourceUpdater_||!a)return Ia();if("main"===this.loaderType_){const {hasAudio:b,hasVideo:c,isMuxed:e}=a;if(c&&b&&!this.audioDisabled_&&!e)return this.sourceUpdater_.buffered();if(c)return this.sourceUpdater_.videoBuffered()}return this.sourceUpdater_.audioBuffered()}initSegmentForMap(a,b=!1){if(!a)return null;const c=we(a);let e=this.initSegments_[c];b&&!e&&a.bytes&&(this.initSegments_[c]=e={resolvedUri:a.resolvedUri,byterange:a.byterange,bytes:a.bytes,tracks:a.tracks,timescales:a.timescales});
return e||a}segmentKey(a,b=!1){if(!a)return null;const c=a.resolvedUri;let e=this.keyCache_[c];this.cacheEncryptionKeys_&&b&&!e&&a.bytes&&(this.keyCache_[c]=e={resolvedUri:a.resolvedUri,bytes:a.bytes});a={resolvedUri:(e||a).resolvedUri};e&&(a.bytes=e.bytes);return a}couldBeginLoading_(){return this.playlist_&&!this.paused()}load(){this.monitorBuffer_();if(this.playlist_){if("INIT"===this.state&&this.couldBeginLoading_())return this.init_();!this.couldBeginLoading_()||"READY"!==this.state&&"INIT"!==
this.state||(this.state="READY")}}init_(){this.state="READY";this.resetEverything();return this.monitorBuffer_()}playlist(a,b={}){if(a){var c=this.playlist_,e=this.pendingSegment_;this.playlist_=a;this.xhrOptions_=b;"INIT"===this.state&&(a.syncInfo={mediaSequence:a.mediaSequence,time:0},"main"===this.loaderType_&&this.syncController_.setDateTimeMappingForStart(a));b=null;c&&(c.id?b=c.id:c.uri&&(b=c.uri));this.logger_(`playlist update [${b} => ${a.id||a.uri}]`);this.trigger("syncinfoupdate");if("INIT"===
this.state&&this.couldBeginLoading_())return this.init_();if(c&&c.uri===a.uri){b=a.mediaSequence-c.mediaSequence;this.logger_(`live window shift [${b}]`);if(null!==this.mediaIndex)if(this.mediaIndex-=b,0>this.mediaIndex)this.partIndex=this.mediaIndex=null;else{var h=this.playlist_.segments[this.mediaIndex];!this.partIndex||h.parts&&h.parts.length&&h.parts[this.partIndex]||(h=this.mediaIndex,this.logger_(`currently processing part (index ${this.partIndex}) no longer exists.`),this.resetLoader(),this.mediaIndex=
h)}e&&(e.mediaIndex-=b,0>e.mediaIndex?(e.mediaIndex=null,e.partIndex=null):(0<=e.mediaIndex&&(e.segment=a.segments[e.mediaIndex]),0<=e.partIndex&&e.segment.parts&&(e.part=e.segment.parts[e.partIndex])));this.syncController_.saveExpiredSegmentInfo(c,a)}else null!==this.mediaIndex&&(a.endList?this.resyncLoader():this.resetLoader()),this.currentMediaInfo_=void 0,this.trigger("playlistupdate")}}pause(){this.checkBufferTimeout_&&(D.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)}paused(){return null===
this.checkBufferTimeout_}resetEverything(a){this.ended_=!1;this.activeInitSegmentId_=null;this.appendInitSegment_={audio:!0,video:!0};this.resetLoader();this.remove(0,Infinity,a);this.transmuxer_&&(this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),this.transmuxer_.postMessage({action:"reset"}))}resetLoader(){this.fetchAtBuffer_=!1;this.resyncLoader()}resyncLoader(){this.transmuxer_&&Yg.reset(this.transmuxer_);this.syncPoint_=this.partIndex=this.mediaIndex=null;this.isPendingTimestampOffset_=
!1;this.callQueue_=[];this.loadQueue_=[];this.metadataQueue_.id3=[];this.metadataQueue_.caption=[];this.abort();this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}remove(a,b,c=()=>{},e=!1){Infinity===b&&(b=this.duration_());if(b<=a)this.logger_("skipping remove because end ${end} is \x3c\x3d start ${start}");else if(this.sourceUpdater_&&this.getMediaInfo_()){var h=1,m=()=>{h--;0===h&&c()};if(e||!this.audioDisabled_)h++,this.sourceUpdater_.removeAudio(a,b,m);if(e||"main"===
this.loaderType_)this.gopBuffer_=rq(this.gopBuffer_,a,b,this.timeMapping_),h++,this.sourceUpdater_.removeVideo(a,b,m);for(const p in this.inbandTextTracks_)zd(a,b,this.inbandTextTracks_[p]);zd(a,b,this.segmentMetadataTrack_);m()}else this.logger_("skipping remove because no source updater or starting media info")}monitorBuffer_(){this.checkBufferTimeout_&&D.clearTimeout(this.checkBufferTimeout_);this.checkBufferTimeout_=D.setTimeout(this.monitorBufferTick_.bind(this),1)}monitorBufferTick_(){"READY"===
this.state&&this.fillBuffer_();this.checkBufferTimeout_&&D.clearTimeout(this.checkBufferTimeout_);this.checkBufferTimeout_=D.setTimeout(this.monitorBufferTick_.bind(this),500)}fillBuffer_(){if(!this.sourceUpdater_.updating()){var a=this.chooseNextRequest_();a&&("number"===typeof a.timestampOffset&&(this.isPendingTimestampOffset_=!1,this.timelineChangeController_.pendingTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:a.timeline})),this.loadSegment_(a))}}isEndOfStream_(a=this.mediaIndex,
b=this.playlist_,c=this.partIndex){if(!b||!this.mediaSource_)return!1;const e="number"===typeof a&&b.segments[a];a=a+1===b.segments.length;c=!e||!e.parts||c+1===e.parts.length;return b.endList&&"open"===this.mediaSource_.readyState&&a&&c}chooseNextRequest_(){var a=this.buffered_(),b=ck(a)||0,c=xg(a,this.currentTime_()),e=!this.hasPlayed_()&&1<=c,h=c>=this.goalBufferLength_();a=this.playlist_.segments;if(!a.length||e||h)return null;this.syncPoint_=this.syncPoint_||this.syncController_.getSyncPoint(this.playlist_,
this.duration_(),this.currentTimeline_,this.currentTime_());e={partIndex:null,mediaIndex:null,startOfSegment:null,playlist:this.playlist_,isSyncRequest:!this.syncPoint_};if(e.isSyncRequest){a:{h=this.currentTimeline_;var m=a||[];const p=[];let t=0;for(let x=0;x<m.length;x++){const y=m[x];if(h===y.timeline&&(p.push(x),t+=y.duration,t>b)){b=x;break a}}b=0===p.length?0:p[p.length-1]}e.mediaIndex=b}else if(null!==this.mediaIndex)h=a[this.mediaIndex],m="number"===typeof this.partIndex?this.partIndex:-1,
e.startOfSegment=h.end?h.end:b,h.parts&&h.parts[m+1]?(e.mediaIndex=this.mediaIndex,e.partIndex=m+1):e.mediaIndex=this.mediaIndex+1;else{const {segmentIndex:p,startTime:t,partIndex:x}=Xa.getMediaInfoForTime({exactManifestTimings:this.exactManifestTimings,playlist:this.playlist_,currentTime:this.fetchAtBuffer_?b:this.currentTime_(),startingPartIndex:this.syncPoint_.partIndex,startingSegmentIndex:this.syncPoint_.segmentIndex,startTime:this.syncPoint_.time});e.getMediaInfoForTime=this.fetchAtBuffer_?
`bufferedEnd ${b}`:`currentTime ${this.currentTime_()}`;e.mediaIndex=p;e.startOfSegment=t;e.partIndex=x}h=(b=a[e.mediaIndex])&&"number"===typeof e.partIndex&&b.parts&&b.parts[e.partIndex];if(!b||"number"===typeof e.partIndex&&!h)return null;"number"!==typeof e.partIndex&&b.parts&&(e.partIndex=0,h=b.parts[0]);c||!h||h.independent||(0===e.partIndex?(c=a[e.mediaIndex-1],(b=c.parts&&c.parts.length&&c.parts[c.parts.length-1])&&b.independent&&(--e.mediaIndex,e.partIndex=c.parts.length-1,e.independent="previous segment")):
b.parts[e.partIndex-1].independent&&(--e.partIndex,e.independent="previous part"));c=this.mediaSource_&&"ended"===this.mediaSource_.readyState;return e.mediaIndex>=a.length-1&&c&&!this.seeking_()?null:this.generateSegmentInfo_(e)}generateSegmentInfo_(a){const {independent:b,playlist:c,mediaIndex:e,startOfSegment:h,isSyncRequest:m,partIndex:p,forceTimestampOffset:t,getMediaInfoForTime:x}=a;var y=c.segments[e];a="number"===typeof p&&y.parts[p];a={requestId:"segment-loader-"+Math.random(),uri:a&&a.resolvedUri||
y.resolvedUri,mediaIndex:e,partIndex:a?p:null,isSyncRequest:m,startOfSegment:h,playlist:c,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:y.timeline,duration:a&&a.duration||y.duration,segment:y,part:a,byteLength:0,transmuxer:this.transmuxer_,getMediaInfoForTime:x,independent:b};var C="undefined"!==typeof t?t:this.isPendingTimestampOffset_;a.timestampOffset=this.timestampOffsetForSegment_({segmentTimeline:y.timeline,currentTimeline:this.currentTimeline_,startOfSegment:h,buffered:this.buffered_(),
overrideCheck:C});y=ck(this.sourceUpdater_.audioBuffered());"number"===typeof y&&(a.audioAppendStart=y-this.sourceUpdater_.audioTimestampOffset());if(this.sourceUpdater_.videoBuffered().length){y=this.gopBuffer_;C=this.currentTime_()-this.sourceUpdater_.videoTimestampOffset();if("undefined"!==typeof C&&null!==C&&y.length){C=Math.ceil(9E4*(C-this.timeMapping_+3));var z;for(z=0;z<y.length&&!(y[z].pts>C);z++);y=y.slice(z)}else y=[];a.gopsToAlignWith=y}return a}timestampOffsetForSegment_(a){return tq(a)}earlyAbortWhenNeeded_(a){if(!this.vhs_.tech_.paused()&&
this.xhrOptions_.timeout&&this.playlist_.attributes.BANDWIDTH&&!(1E3>Date.now()-(a.firstBytesReceivedAt||Date.now()))){var b=this.currentTime_(),c=a.bandwidth,e=this.pendingSegment_.duration,h=Xa.estimateSegmentRequestTime(e,c,this.playlist_,a.bytesReceived);a=Ro(this.buffered_(),b,this.vhs_.tech_.playbackRate())-1;h<=a||!(b=lq({main:this.vhs_.playlists.main,currentTime:b,bandwidth:c,duration:this.duration_(),segmentDuration:e,timeUntilRebuffer:a,currentTimeline:this.currentTimeline_,syncController:this.syncController_}))||
(c=h-a-b.rebufferingImpact,e=.5,a<=Ub&&(e=1),!b.playlist||b.playlist.uri===this.playlist_.uri||c<e||(this.bandwidth=b.playlist.attributes.BANDWIDTH*Ca.BANDWIDTH_VARIANCE+1,this.trigger("earlyabort")))}}handleAbort_(a){this.logger_(`Aborting ${Pc(a)}`);this.mediaRequestsAborted+=1}handleProgress_(a,b){this.earlyAbortWhenNeeded_(b.stats);this.checkForAbort_(b.requestId)||this.trigger("progress")}handleTrackInfo_(a,b){this.earlyAbortWhenNeeded_(a.stats);this.checkForAbort_(a.requestId)||this.checkForIllegalMediaSwitch(b)||
(b=b||{},sq(this.currentMediaInfo_,b)||(this.appendInitSegment_={audio:!0,video:!0},this.currentMediaInfo_=this.startingMediaInfo_=b,this.logger_("trackinfo update",b),this.trigger("trackinfo")),this.checkForAbort_(a.requestId)||(this.pendingSegment_.trackInfo=b,this.hasEnoughInfoToAppend_()&&this.processCallQueue_()))}handleTimingInfo_(a,b,c,e){this.earlyAbortWhenNeeded_(a.stats);if(!this.checkForAbort_(a.requestId)){a=this.pendingSegment_;var h=`${b}TimingInfo`;a[h]=a[h]||{};a[h][c]=e;this.logger_(`timinginfo: ${b} - ${c} - ${e}`);
this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}}handleCaptions_(a,b){this.earlyAbortWhenNeeded_(a.stats);if(!this.checkForAbort_(a.requestId))if(0===b.length)this.logger_("SegmentLoader received no captions from a caption event");else if(this.pendingSegment_.hasAppendedData_){var c=null===this.sourceUpdater_.videoTimestampOffset()?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset(),e={};b.forEach(h=>{e[h.stream]=e[h.stream]||{startTime:Infinity,captions:[],
endTime:0};const m=e[h.stream];m.startTime=Math.min(m.startTime,h.startTime+c);m.endTime=Math.max(m.endTime,h.endTime+c);m.captions.push(h)});Object.keys(e).forEach(h=>{const {startTime:m,endTime:p,captions:t}=e[h],x=this.inbandTextTracks_;this.logger_(`adding cues from ${m} -> ${p} for ${h}`);var y=this.vhs_.tech_;if(!x[h]){y.trigger({type:"usage",name:"vhs-608"});let z=h;/^cc708_/.test(h)&&(z="SERVICE"+h.split("_")[1]);var C=y.textTracks().getTrackById(z);if(C)x[h]=C;else{let E=C=h,K=!1;const G=
(y.options_.vhs&&y.options_.vhs.captionServices||{})[z];G&&(C=G.label,E=G.language,K=G.default);x[h]=y.addRemoteTextTrack({kind:"captions",id:z,default:K,label:C,language:E},!1).track}}zd(m,p,x[h]);nq({captionArray:t,inbandTextTracks:x,timestampOffset:c})});this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}else this.metadataQueue_.caption.push(this.handleCaptions_.bind(this,a,b))}handleId3_(a,b,c){this.earlyAbortWhenNeeded_(a.stats);if(!this.checkForAbort_(a.requestId))if(this.pendingSegment_.hasAppendedData_){a=
null===this.sourceUpdater_.videoTimestampOffset()?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset();var e=this.inbandTextTracks_;e.metadataTrack_||(e.metadataTrack_=this.vhs_.tech_.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,e.metadataTrack_.inBandMetadataTrackDispatchType=c);pq({inbandTextTracks:this.inbandTextTracks_,metadataArray:b,timestampOffset:a,videoDuration:this.duration_()})}else this.metadataQueue_.id3.push(this.handleId3_.bind(this,
a,b,c))}processMetadataQueue_(){this.metadataQueue_.id3.forEach(a=>a());this.metadataQueue_.caption.forEach(a=>a());this.metadataQueue_.id3=[];this.metadataQueue_.caption=[]}processCallQueue_(){const a=this.callQueue_;this.callQueue_=[];a.forEach(b=>b())}processLoadQueue_(){const a=this.loadQueue_;this.loadQueue_=[];a.forEach(b=>b())}hasEnoughInfoToLoad_(){if("audio"!==this.loaderType_)return!0;const a=this.pendingSegment_;return a?this.getCurrentMediaInfo_()?pl({timelineChangeController:this.timelineChangeController_,
currentTimeline:this.currentTimeline_,segmentTimeline:a.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_})?!1:!0:!0:!1}getCurrentMediaInfo_(a=this.pendingSegment_){return a&&a.trackInfo||this.currentMediaInfo_}getMediaInfo_(a=this.pendingSegment_){return this.getCurrentMediaInfo_(a)||this.startingMediaInfo_}getPendingSegmentPlaylist(){return this.pendingSegment_?this.pendingSegment_.playlist:null}hasEnoughInfoToAppend_(){if(!this.sourceUpdater_.ready()||this.waitingOnRemove_||
this.quotaExceededErrorRetryTimeout_)return!1;const a=this.pendingSegment_,b=this.getCurrentMediaInfo_();if(!a||!b)return!1;const {hasAudio:c,hasVideo:e,isMuxed:h}=b;return e&&!a.videoTimingInfo||c&&!this.audioDisabled_&&!h&&!a.audioTimingInfo||pl({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:a.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_})?!1:!0}handleData_(a,b){this.earlyAbortWhenNeeded_(a.stats);if(!this.checkForAbort_(a.requestId))if(this.callQueue_.length||
!this.hasEnoughInfoToAppend_())this.callQueue_.push(this.handleData_.bind(this,a,b));else{var c=this.pendingSegment_;this.setTimeMapping_(c.timeline);this.updateMediaSecondsLoaded_(c.part||c.segment);if("closed"!==this.mediaSource_.readyState){a.map&&(a.map=this.initSegmentForMap(a.map,!0),c.segment.map=a.map);a.key&&this.segmentKey(a.key,!0);c.isFmp4=a.isFmp4;c.timingInfo=c.timingInfo||{};if(c.isFmp4)this.trigger("fmp4"),c.timingInfo.start=c[`${b.type}TimingInfo`].start;else{a=this.getCurrentMediaInfo_();
a="main"===this.loaderType_&&a&&a.hasVideo;if(a)var e=c.videoTimingInfo.start;c.timingInfo.start=this.trueSegmentStart_({currentStart:c.timingInfo.start,playlist:c.playlist,mediaIndex:c.mediaIndex,currentVideoTimestampOffset:this.sourceUpdater_.videoTimestampOffset(),useVideoTimingInfo:a,firstVideoFrameTimeForData:e,videoTimingInfo:c.videoTimingInfo,audioTimingInfo:c.audioTimingInfo})}this.updateAppendInitSegmentStatus(c,b.type);this.updateSourceBufferTimestampOffset_(c);if(c.isSyncRequest){this.updateTimingInfoEnd_(c);
this.syncController_.saveSegmentTimingInfo({segmentInfo:c,shouldSaveTimelineMapping:"main"===this.loaderType_});e=this.chooseNextRequest_();if(e.mediaIndex!==c.mediaIndex||e.partIndex!==c.partIndex){this.logger_("sync segment was incorrect, not appending");return}this.logger_("sync segment was correct, appending")}c.hasAppendedData_=!0;this.processMetadataQueue_();this.appendData_(c,b)}}}updateAppendInitSegmentStatus(a,b){"main"!==this.loaderType_||"number"!==typeof a.timestampOffset||a.changedTimestampOffset||
(this.appendInitSegment_={audio:!0,video:!0});this.playlistOfLastInitSegment_[b]!==a.playlist&&(this.appendInitSegment_[b]=!0)}getInitSegmentAndUpdateState_({type:a,initSegment:b,map:c,playlist:e}){if(c){const h=we(c);if(this.activeInitSegmentId_===h)return null;b=this.initSegmentForMap(c,!0).bytes;this.activeInitSegmentId_=h}return b&&this.appendInitSegment_[a]?(this.playlistOfLastInitSegment_[a]=e,this.appendInitSegment_[a]=!1,this.activeInitSegmentId_=null,b):null}handleQuotaExceededError_({segmentInfo:a,
type:b,bytes:c},e){e=this.sourceUpdater_.audioBuffered();const h=this.sourceUpdater_.videoBuffered();1<e.length&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the audio buffer: "+gc(e).join(", "));1<h.length&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the video buffer: "+gc(h).join(", "));const m=e.length?e.start(0):0,p=e.length?e.end(e.length-1):0,t=h.length?h.start(0):0,x=h.length?h.end(h.length-1):0;1>=p-m&&1>=x-t?(this.logger_("On QUOTA_EXCEEDED_ERR, single segment too large to append to buffer, triggering an error. "+
`Appended byte length: ${c.byteLength}, `+`audio buffer: ${gc(e).join(", ")}, `+`video buffer: ${gc(h).join(", ")}, `),this.error({message:"Quota exceeded error with append of a single segment of content",excludeUntil:Infinity}),this.trigger("error")):(this.waitingOnRemove_=!0,this.callQueue_.push(this.appendToSourceBuffer_.bind(this,{segmentInfo:a,type:b,bytes:c})),a=this.currentTime_()-1,this.logger_(`On QUOTA_EXCEEDED_ERR, removing audio/video from 0 to ${a}`),this.remove(0,a,()=>{this.logger_("On QUOTA_EXCEEDED_ERR, retrying append in 1s");
this.waitingOnRemove_=!1;this.quotaExceededErrorRetryTimeout_=D.setTimeout(()=>{this.logger_("On QUOTA_EXCEEDED_ERR, re-processing call queue");this.quotaExceededErrorRetryTimeout_=null;this.processCallQueue_()},1E3)},!0))}handleAppendError_({segmentInfo:a,type:b,bytes:c},e){e&&(22===e.code?this.handleQuotaExceededError_({segmentInfo:a,type:b,bytes:c}):(this.logger_("Received non QUOTA_EXCEEDED_ERR on append",e),this.error(`${b} append of ${c.length}b failed for segment `+`#${a.mediaIndex} in playlist ${a.playlist.id}`),
this.trigger("appenderror")))}appendToSourceBuffer_({segmentInfo:a,type:b,initSegment:c,data:e,bytes:h}){h||(h=[e],e=e.byteLength,c&&(h.unshift(c),e+=c.byteLength),h=mq({bytes:e,segments:h}));this.sourceUpdater_.appendBuffer({segmentInfo:a,type:b,bytes:h},this.handleAppendError_.bind(this,{segmentInfo:a,type:b,bytes:h}))}handleSegmentTimingInfo_(a,b,c){this.pendingSegment_&&b===this.pendingSegment_.requestId&&(b=this.pendingSegment_.segment,a=`${a}TimingInfo`,b[a]||(b[a]={}),b[a].transmuxerPrependedSeconds=
c.prependedContentDuration||0,b[a].transmuxedPresentationStart=c.start.presentation,b[a].transmuxedDecodeStart=c.start.decode,b[a].transmuxedPresentationEnd=c.end.presentation,b[a].transmuxedDecodeEnd=c.end.decode,b[a].baseMediaDecodeTime=c.baseMediaDecodeTime)}appendData_(a,b){const {type:c,data:e}=b;!e||!e.byteLength||"audio"===c&&this.audioDisabled_||(b=this.getInitSegmentAndUpdateState_({type:c,initSegment:b.initSegment,playlist:a.playlist,map:a.isFmp4?a.segment.map:null}),this.appendToSourceBuffer_({segmentInfo:a,
type:c,initSegment:b,data:e}))}loadSegment_(a){this.state="WAITING";this.pendingSegment_=a;this.trimBackBuffer_(a);"number"===typeof a.timestampOffset&&this.transmuxer_&&this.transmuxer_.postMessage({action:"clearAllMp4Captions"});this.hasEnoughInfoToLoad_()?this.updateTransmuxerAndRequestSegment_(a):this.loadQueue_.push(()=>{const b=Nb({},a,{forceTimestampOffset:!0});Nb(a,this.generateSegmentInfo_(b));this.isPendingTimestampOffset_=!1;this.updateTransmuxerAndRequestSegment_(a)})}updateTransmuxerAndRequestSegment_(a){this.shouldUpdateTransmuxerTimestampOffset_(a.timestampOffset)&&
(this.gopBuffer_.length=0,a.gopsToAlignWith=[],this.timeMapping_=0,this.transmuxer_.postMessage({action:"reset"}),this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:a.timestampOffset}));const b=this.createSimplifiedSegmentObj_(a);var c=this.isEndOfStream_(a.mediaIndex,a.playlist,a.partIndex);const e=null!==this.mediaIndex,h=a.timeline!==this.currentTimeline_&&0<a.timeline;c=c||e&&h;this.logger_(`Requesting ${Pc(a)}`);b.map&&!b.map.bytes&&(this.logger_("going to request init segment."),
this.appendInitSegment_={video:!0,audio:!0});a.abortRequests=jq({xhr:this.vhs_.xhr,xhrOptions:this.xhrOptions_,decryptionWorker:this.decrypter_,segment:b,abortFn:this.handleAbort_.bind(this,a),progressFn:this.handleProgress_.bind(this),trackInfoFn:this.handleTrackInfo_.bind(this),timingInfoFn:this.handleTimingInfo_.bind(this),videoSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"video",a.requestId),audioSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"audio",a.requestId),captionsFn:this.handleCaptions_.bind(this),
isEndOfTimeline:c,endedTimelineFn:()=>{this.logger_("received endedtimeline callback")},id3Fn:this.handleId3_.bind(this),dataFn:this.handleData_.bind(this),doneFn:this.segmentRequestFinished_.bind(this),onTransmuxerLog:({message:m,level:p,stream:t})=>{this.logger_(`${Pc(a)} logged from transmuxer stream ${t} as a ${p}: ${m}`)}})}trimBackBuffer_(a){a=this.seekable_();var b=this.currentTime_(),c=this.playlist_.targetDuration||10;let e=b-Ca.BACK_BUFFER_LENGTH;a.length&&(e=Math.max(e,a.start(0)));a=Math.min(b-
c,e);0<a&&this.remove(0,a)}createSimplifiedSegmentObj_(a){const b=a.segment;var c=a.part;c={resolvedUri:c?c.resolvedUri:b.resolvedUri,byterange:c?c.byterange:b.byterange,requestId:a.requestId,transmuxer:a.transmuxer,audioAppendStart:a.audioAppendStart,gopsToAlignWith:a.gopsToAlignWith,part:a.part};const e=a.playlist.segments[a.mediaIndex-1];e&&e.timeline===b.timeline&&(e.videoTimingInfo?c.baseStartTime=e.videoTimingInfo.transmuxedDecodeEnd:e.audioTimingInfo&&(c.baseStartTime=e.audioTimingInfo.transmuxedDecodeEnd));
b.key&&(a=b.key.iv||new Uint32Array([0,0,0,a.mediaIndex+a.playlist.mediaSequence]),c.key=this.segmentKey(b.key),c.key.iv=a);b.map&&(c.map=this.initSegmentForMap(b.map));return c}saveTransferStats_(a){this.mediaRequests+=1;a&&(this.mediaBytesTransferred+=a.bytesReceived,this.mediaTransferDuration+=a.roundTripTime)}saveBandwidthRelatedStats_(a,b){this.pendingSegment_.byteLength=b.bytesReceived;a<Pe?this.logger_(`Ignoring segment's bandwidth because its duration of ${a}`+` is less than the min to record ${Pe}`):
(this.bandwidth=b.bandwidth,this.roundTrip=b.roundTripTime)}handleTimeout_(){this.mediaRequestsTimedout+=1;this.bandwidth=1;this.roundTrip=NaN;this.trigger("bandwidthupdate");this.trigger("timeout")}segmentRequestFinished_(a,b,c){if(this.callQueue_.length)this.callQueue_.push(this.segmentRequestFinished_.bind(this,a,b,c));else if(this.saveTransferStats_(b.stats),this.pendingSegment_&&b.requestId===this.pendingSegment_.requestId)if(a)this.pendingSegment_=null,this.state="READY",-102!==a.code&&(this.pause(),
-101===a.code?this.handleTimeout_():(this.mediaRequestsErrored+=1,this.error(a),this.trigger("error")));else{a=this.pendingSegment_;this.saveBandwidthRelatedStats_(a.duration,b.stats);a.endOfAllRequests=b.endOfAllRequests;if(c.gopInfo){b=this.gopBuffer_;c=c.gopInfo;if(c.length)if(this.safeAppend_)b=c.slice();else{var e=c[0].pts,h=0;for(h;h<b.length&&!(b[h].pts>=e);h++);b=b.slice(0,h).concat(c)}this.gopBuffer_=b}this.state="APPENDING";this.trigger("appending");this.waitForAppendsToComplete_(a)}}setTimeMapping_(a){a=
this.syncController_.mappingForTimeline(a);null!==a&&(this.timeMapping_=a)}updateMediaSecondsLoaded_(a){this.mediaSecondsLoaded="number"===typeof a.start&&"number"===typeof a.end?this.mediaSecondsLoaded+(a.end-a.start):this.mediaSecondsLoaded+a.duration}shouldUpdateTransmuxerTimestampOffset_(a){return null===a?!1:"main"===this.loaderType_&&a!==this.sourceUpdater_.videoTimestampOffset()||!this.audioDisabled_&&a!==this.sourceUpdater_.audioTimestampOffset()?!0:!1}trueSegmentStart_({currentStart:a,playlist:b,
mediaIndex:c,firstVideoFrameTimeForData:e,currentVideoTimestampOffset:h,useVideoTimingInfo:m,videoTimingInfo:p,audioTimingInfo:t}){if("undefined"!==typeof a)return a;if(!m)return t.start;a=b.segments[c-1];return 0!==c&&a&&"undefined"!==typeof a.start&&a.end===e+h?p.start:e}waitForAppendsToComplete_(a){var b=this.getCurrentMediaInfo_(a);if(b){var {hasAudio:c,hasVideo:e,isMuxed:h}=b;b="main"===this.loaderType_&&e;var m=!this.audioDisabled_&&c&&!h;a.waitingOnAppends=0;a.hasAppendedData_?(b&&a.waitingOnAppends++,
m&&a.waitingOnAppends++,b&&this.sourceUpdater_.videoQueueCallback(this.checkAppendsDone_.bind(this,a)),m&&this.sourceUpdater_.audioQueueCallback(this.checkAppendsDone_.bind(this,a))):(a.timingInfo||"number"!==typeof a.timestampOffset||(this.isPendingTimestampOffset_=!0),a.timingInfo={start:0},a.waitingOnAppends++,this.isPendingTimestampOffset_||(this.updateSourceBufferTimestampOffset_(a),this.processMetadataQueue_()),this.checkAppendsDone_(a))}else this.error({message:"No starting media returned, likely due to an unsupported media format.",
playlistExclusionDuration:Infinity}),this.trigger("error")}checkAppendsDone_(a){this.checkForAbort_(a.requestId)||(a.waitingOnAppends--,0===a.waitingOnAppends&&this.handleAppendsDone_())}checkForIllegalMediaSwitch(a){var b=this.getCurrentMediaInfo_();return(a="main"===this.loaderType_&&b&&a?a.hasAudio||a.hasVideo?b.hasVideo&&!a.hasVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":
!b.hasVideo&&a.hasVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null:"Neither audio nor video found in segment.":null)?(this.error({message:a,playlistExclusionDuration:Infinity}),this.trigger("error"),!0):!1}updateSourceBufferTimestampOffset_(a){if(null!==a.timestampOffset&&"number"===typeof a.timingInfo.start&&!a.changedTimestampOffset&&"main"===
this.loaderType_){var b=!1;a.timestampOffset-=this.getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:a.segment.videoTimingInfo,audioTimingInfo:a.segment.audioTimingInfo,timingInfo:a.timingInfo});a.changedTimestampOffset=!0;a.timestampOffset!==this.sourceUpdater_.videoTimestampOffset()&&(this.sourceUpdater_.videoTimestampOffset(a.timestampOffset),b=!0);a.timestampOffset!==this.sourceUpdater_.audioTimestampOffset()&&(this.sourceUpdater_.audioTimestampOffset(a.timestampOffset),b=!0);
b&&this.trigger("timestampoffset")}}getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:a,audioTimingInfo:b,timingInfo:c}){return this.useDtsForTimestampOffset_?a&&"number"===typeof a.transmuxedDecodeStart?a.transmuxedDecodeStart:b&&"number"===typeof b.transmuxedDecodeStart?b.transmuxedDecodeStart:c.start:c.start}updateTimingInfoEnd_(a){a.timingInfo=a.timingInfo||{};var b=this.getMediaInfo_();if(b="main"===this.loaderType_&&b&&b.hasVideo&&a.videoTimingInfo?a.videoTimingInfo:a.audioTimingInfo)a.timingInfo.end=
"number"===typeof b.end?b.end:b.start+a.duration}handleAppendsDone_(){this.pendingSegment_&&this.trigger("appendsdone");if(this.pendingSegment_){var a=this.pendingSegment_;this.updateTimingInfoEnd_(a);this.shouldSaveSegmentTimingInfo_&&this.syncController_.saveSegmentTimingInfo({segmentInfo:a,shouldSaveTimelineMapping:"main"===this.loaderType_});if("hls"!==this.sourceType_)var b=null;else{var c=uq({audioTimingInfo:a.audioTimingInfo,videoTimingInfo:a.videoTimingInfo});if(c){var e=a.playlist.targetDuration;
b=ql({segmentDuration:c,maxDuration:2*e});var h=ql({segmentDuration:c,maxDuration:e});c=`Segment with index ${a.mediaIndex} `+`from playlist ${a.playlist.id} `+`has a duration of ${c} `+`when the reported duration is ${a.duration} `+`and the target duration is ${e}. `+"For HLS content, a duration in excess of the target duration may result in playback issues. See the HLS specification section on EXT-X-TARGETDURATION for more details: https://tools.ietf.org/html/draft-pantos-http-live-streaming-23#section-4.3.3.1";
b=b||h?{severity:b?"warn":"info",message:c}:null}else b=null}b&&("warn"===b.severity?H.log.warn(b.message):this.logger_(b.message));this.recordThroughput_(a);this.pendingSegment_=null;this.state="READY";if(a.isSyncRequest&&(this.trigger("syncinfoupdate"),!a.hasAppendedData_)){this.logger_(`Throwing away un-appended sync request ${Pc(a)}`);return}this.logger_(`Appended ${Pc(a)}`);this.addSegmentMetadataCue_(a);this.fetchAtBuffer_=!0;this.currentTimeline_!==a.timeline&&(this.timelineChangeController_.lastTimelineChange({type:this.loaderType_,
from:this.currentTimeline_,to:a.timeline}),"main"!==this.loaderType_||this.audioDisabled_||this.timelineChangeController_.lastTimelineChange({type:"audio",from:this.currentTimeline_,to:a.timeline}));this.currentTimeline_=a.timeline;this.trigger("syncinfoupdate");h=a.segment;b=a.part;h=h.end&&this.currentTime_()-h.end>3*a.playlist.targetDuration;b=b&&b.end&&this.currentTime_()-b.end>3*a.playlist.partTargetDuration;h||b?(this.logger_(`bad ${h?"segment":"part"} ${Pc(a)}`),this.resetEverything()):(null!==
this.mediaIndex&&this.trigger("bandwidthupdate"),this.trigger("progress"),this.mediaIndex=a.mediaIndex,this.partIndex=a.partIndex,this.isEndOfStream_(a.mediaIndex,a.playlist,a.partIndex)&&this.endOfStream(),this.trigger("appended"),a.hasAppendedData_&&this.mediaAppends++,this.paused()||this.monitorBuffer_())}else this.state="READY",this.paused()||this.monitorBuffer_()}recordThroughput_(a){if(a.duration<Pe)this.logger_(`Ignoring segment's throughput because its duration of ${a.duration}`+` is less than the min to record ${Pe}`);
else{var b=this.throughput.rate,c=Date.now()-a.endOfAllRequests+1;this.throughput.rate+=(Math.floor(a.byteLength/c*8E3)-b)/++this.throughput.count}}addSegmentMetadataCue_(a){if(this.segmentMetadataTrack_){var b=a.segment,c=b.start,e=b.end;if("number"===typeof c&&isFinite(c)&&"number"===typeof e&&isFinite(e)){zd(c,e,this.segmentMetadataTrack_);var h=D.WebKitDataCue||D.VTTCue;a={custom:b.custom,dateTimeObject:b.dateTimeObject,dateTimeString:b.dateTimeString,bandwidth:a.playlist.attributes.BANDWIDTH,
resolution:a.playlist.attributes.RESOLUTION,codecs:a.playlist.attributes.CODECS,byteLength:a.byteLength,uri:a.uri,timeline:a.timeline,playlist:a.playlist.id,start:c,end:e};b=JSON.stringify(a);c=new h(c,e,b);c.value=a;this.segmentMetadataTrack_.addCue(c)}}}}const rl=function(a){return"string"!==typeof a?a:a.replace(/./,b=>b.toUpperCase())},vq=["video","audio"],ch=(a,b)=>{const c=b[`${a}Buffer`];return c&&c.updating||b.queuePending[a]},Qc=(a,b)=>{if(0!==b.queue.length){var c=0,e=b.queue[c];if("mediaSource"===
e.type)b.updating()||"closed"===b.mediaSource.readyState||(b.queue.shift(),e.action(b),e.doneFn&&e.doneFn(),Qc("audio",b),Qc("video",b));else if("mediaSource"!==a&&b.ready()&&"closed"!==b.mediaSource.readyState&&!ch(a,b)){if(e.type!==a){a:{c=b.queue;for(e=0;e<c.length;e++){const h=c[e];if("mediaSource"===h.type){c=null;break a}if(h.type===a){c=e;break a}}c=null}if(null===c)return;e=b.queue[c]}b.queue.splice(c,1);b.queuePending[a]=e;e.action(a,b);e.doneFn||(b.queuePending[a]=null,Qc(a,b))}}},sl=(a,
b)=>{const c=b[`${a}Buffer`],e=rl(a);c&&(c.removeEventListener("updateend",b[`on${e}UpdateEnd_`]),c.removeEventListener("error",b[`on${e}Error_`]),b.codecs[a]=null,b[`${a}Buffer`]=null)},Cb=(a,b)=>a&&b&&-1!==Array.prototype.indexOf.call(a.sourceBuffers,b),eb={appendBuffer:(a,b,c)=>(e,h)=>{const m=h[`${e}Buffer`];if(Cb(h.mediaSource,m)){h.logger_(`Appending segment ${b.mediaIndex}'s ${a.length} bytes to ${e}Buffer`);try{m.appendBuffer(a)}catch(p){h.logger_(`Error with code ${p.code} `+(22===p.code?
"(QUOTA_EXCEEDED_ERR) ":"")+`when appending segment ${b.mediaIndex} to ${e}Buffer`),h.queuePending[e]=null,c(p)}}},remove:(a,b)=>(c,e)=>{const h=e[`${c}Buffer`];if(Cb(e.mediaSource,h)){e.logger_(`Removing ${a} to ${b} from ${c}Buffer`);try{h.remove(a,b)}catch(m){e.logger_(`Remove ${a} to ${b} from ${c}Buffer failed`)}}},timestampOffset:a=>(b,c)=>{const e=c[`${b}Buffer`];Cb(c.mediaSource,e)&&(c.logger_(`Setting ${b}timestampOffset to ${a}`),e.timestampOffset=a)},callback:a=>(b,c)=>{a()},endOfStream:a=>
b=>{if("open"===b.mediaSource.readyState){b.logger_(`Calling mediaSource endOfStream(${a||""})`);try{b.mediaSource.endOfStream(a)}catch(c){H.log.warn("Failed to call media source endOfStream",c)}}},duration:a=>b=>{b.logger_(`Setting mediaSource duration to ${a}`);try{b.mediaSource.duration=a}catch(c){H.log.warn("Failed to set media source duration",c)}},abort:()=>(a,b)=>{if("open"===b.mediaSource.readyState){var c=b[`${a}Buffer`];if(Cb(b.mediaSource,c)){b.logger_(`calling abort on ${a}Buffer`);try{c.abort()}catch(e){H.log.warn(`Failed to abort on ${a}Buffer`,
e)}}}},addSourceBuffer:(a,b)=>c=>{const e=rl(a);var h=cd(b);c.logger_(`Adding ${a}Buffer with codec ${b} to mediaSource`);h=c.mediaSource.addSourceBuffer(h);h.addEventListener("updateend",c[`on${e}UpdateEnd_`]);h.addEventListener("error",c[`on${e}Error_`]);c.codecs[a]=b;c[`${a}Buffer`]=h},removeSourceBuffer:a=>b=>{const c=b[`${a}Buffer`];sl(a,b);if(Cb(b.mediaSource,c)){b.logger_(`Removing ${a}Buffer with codec ${b.codecs[a]} from mediaSource`);try{b.mediaSource.removeSourceBuffer(c)}catch(e){H.log.warn(`Failed to removeSourceBuffer ${a}Buffer`,
e)}}},changeType:a=>(b,c)=>{const e=c[`${b}Buffer`],h=cd(a);Cb(c.mediaSource,e)&&c.codecs[b]!==a&&(c.logger_(`changing ${b}Buffer codec from ${c.codecs[b]} to ${a}`),e.changeType(h),c.codecs[b]=a)}},fb=({type:a,sourceUpdater:b,action:c,doneFn:e,name:h})=>{b.queue.push({type:a,action:c,doneFn:e,name:h});Qc(a,b)},tl=(a,b)=>c=>{b.queuePending[a]&&(c=b.queuePending[a].doneFn,b.queuePending[a]=null,c&&c(b[`${a}Error_`]));Qc(a,b)};class ul extends H.EventTarget{constructor(a){super();this.mediaSource=a;
this.sourceopenListener_=()=>Qc("mediaSource",this);this.mediaSource.addEventListener("sourceopen",this.sourceopenListener_);this.logger_=mb("SourceUpdater");this.videoTimestampOffset_=this.audioTimestampOffset_=0;this.queue=[];this.queuePending={audio:null,video:null};this.delayedAudioAppendQueue_=[];this.videoAppendQueued_=!1;this.codecs={};this.onVideoUpdateEnd_=tl("video",this);this.onAudioUpdateEnd_=tl("audio",this);this.onVideoError_=b=>{this.videoError_=b};this.onAudioError_=b=>{this.audioError_=
b};this.triggeredReady_=this.initializedEme_=this.createdSourceBuffers_=!1}initializedEme(){this.initializedEme_=!0;this.triggerReady()}hasCreatedSourceBuffers(){return this.createdSourceBuffers_}hasInitializedAnyEme(){return this.initializedEme_}ready(){return this.hasCreatedSourceBuffers()&&this.hasInitializedAnyEme()}createSourceBuffers(a){this.hasCreatedSourceBuffers()||(this.addOrChangeSourceBuffers(a),this.createdSourceBuffers_=!0,this.trigger("createdsourcebuffers"),this.triggerReady())}triggerReady(){this.ready()&&
!this.triggeredReady_&&(this.triggeredReady_=!0,this.trigger("ready"))}addSourceBuffer(a,b){fb({type:"mediaSource",sourceUpdater:this,action:eb.addSourceBuffer(a,b),name:"addSourceBuffer"})}abort(a){fb({type:a,sourceUpdater:this,action:eb.abort(a),name:"abort"})}removeSourceBuffer(a){this.canRemoveSourceBuffer()?fb({type:"mediaSource",sourceUpdater:this,action:eb.removeSourceBuffer(a),name:"removeSourceBuffer"}):H.log.error("removeSourceBuffer is not supported!")}canRemoveSourceBuffer(){return!H.browser.IE_VERSION&&
!H.browser.IS_FIREFOX&&D.MediaSource&&D.MediaSource.prototype&&"function"===typeof D.MediaSource.prototype.removeSourceBuffer}static canChangeType(){return D.SourceBuffer&&D.SourceBuffer.prototype&&"function"===typeof D.SourceBuffer.prototype.changeType}canChangeType(){return this.constructor.canChangeType()}changeType(a,b){this.canChangeType()?fb({type:a,sourceUpdater:this,action:eb.changeType(b),name:"changeType"}):H.log.error("changeType is not supported!")}addOrChangeSourceBuffers(a){if(!a||"object"!==
typeof a||0===Object.keys(a).length)throw Error("Cannot addOrChangeSourceBuffers to undefined codecs");Object.keys(a).forEach(b=>{const c=a[b];if(!this.hasCreatedSourceBuffers())return this.addSourceBuffer(b,c);this.canChangeType()&&this.changeType(b,c)})}appendBuffer(a,b){const {segmentInfo:c,type:e,bytes:h}=a;this.processedAppend_=!0;"audio"===e&&this.videoBuffer&&!this.videoAppendQueued_?(this.delayedAudioAppendQueue_.push([a,b]),this.logger_(`delayed audio append of ${h.length} until video append`)):
(fb({type:e,sourceUpdater:this,action:eb.appendBuffer(h,c||{mediaIndex:-1},b),doneFn:b,name:"appendBuffer"}),"video"===e&&(this.videoAppendQueued_=!0,this.delayedAudioAppendQueue_.length&&(a=this.delayedAudioAppendQueue_.slice(),this.logger_(`queuing delayed audio ${a.length} appendBuffers`),this.delayedAudioAppendQueue_.length=0,a.forEach(m=>{this.appendBuffer.apply(this,m)}))))}audioBuffered(){return Cb(this.mediaSource,this.audioBuffer)?this.audioBuffer.buffered?this.audioBuffer.buffered:Ia():
Ia()}videoBuffered(){return Cb(this.mediaSource,this.videoBuffer)?this.videoBuffer.buffered?this.videoBuffer.buffered:Ia():Ia()}buffered(){const a=Cb(this.mediaSource,this.videoBuffer)?this.videoBuffer:null,b=Cb(this.mediaSource,this.audioBuffer)?this.audioBuffer:null;return b&&!a?this.audioBuffered():a&&!b?this.videoBuffered():Qo(this.audioBuffered(),this.videoBuffered())}setDuration(a,b=Gb){fb({type:"mediaSource",sourceUpdater:this,action:eb.duration(a),name:"duration",doneFn:b})}endOfStream(a=
null,b=Gb){"string"!==typeof a&&(a=void 0);fb({type:"mediaSource",sourceUpdater:this,action:eb.endOfStream(a),name:"endOfStream",doneFn:b})}removeAudio(a,b,c=Gb){this.audioBuffered().length&&0!==this.audioBuffered().end(0)?fb({type:"audio",sourceUpdater:this,action:eb.remove(a,b),doneFn:c,name:"remove"}):c()}removeVideo(a,b,c=Gb){this.videoBuffered().length&&0!==this.videoBuffered().end(0)?fb({type:"video",sourceUpdater:this,action:eb.remove(a,b),doneFn:c,name:"remove"}):c()}updating(){return ch("audio",
this)||ch("video",this)?!0:!1}audioTimestampOffset(a){"undefined"!==typeof a&&this.audioBuffer&&this.audioTimestampOffset_!==a&&(fb({type:"audio",sourceUpdater:this,action:eb.timestampOffset(a),name:"timestampOffset"}),this.audioTimestampOffset_=a);return this.audioTimestampOffset_}videoTimestampOffset(a){"undefined"!==typeof a&&this.videoBuffer&&this.videoTimestampOffset!==a&&(fb({type:"video",sourceUpdater:this,action:eb.timestampOffset(a),name:"timestampOffset"}),this.videoTimestampOffset_=a);
return this.videoTimestampOffset_}audioQueueCallback(a){this.audioBuffer&&fb({type:"audio",sourceUpdater:this,action:eb.callback(a),name:"callback"})}videoQueueCallback(a){this.videoBuffer&&fb({type:"video",sourceUpdater:this,action:eb.callback(a),name:"callback"})}dispose(){this.trigger("dispose");vq.forEach(a=>{this.abort(a);if(this.canRemoveSourceBuffer())this.removeSourceBuffer(a);else this[`${a}QueueCallback`](()=>sl(a,this))});this.videoAppendQueued_=!1;this.delayedAudioAppendQueue_.length=
0;this.sourceopenListener_&&this.mediaSource.removeEventListener("sourceopen",this.sourceopenListener_);this.off()}}const vl=new Uint8Array(["\n","\n"].map(a=>a.charCodeAt(0)));class wq extends Error{constructor(){super("Trying to parse received VTT cues, but there is no WebVTT. Make sure vtt.js is loaded.")}}class xq extends bh{constructor(a,b={}){super(a,b);this.subtitlesTrack_=this.mediaSource_=null;this.loaderType_="subtitle";this.featuresNativeTextTracks_=a.featuresNativeTextTracks;this.loadVttJs=
a.loadVttJs;this.shouldSaveSegmentTimingInfo_=!1}createTransmuxer_(){return null}buffered_(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues||!this.subtitlesTrack_.cues.length)return Ia();const a=this.subtitlesTrack_.cues;return Ia([[a[0].startTime,a[a.length-1].startTime]])}initSegmentForMap(a,b=!1){if(!a)return null;const c=we(a);let e=this.initSegments_[c];b&&!e&&a.bytes&&(b=new Uint8Array(vl.byteLength+a.bytes.byteLength),b.set(a.bytes),b.set(vl,a.bytes.byteLength),this.initSegments_[c]=
e={resolvedUri:a.resolvedUri,byterange:a.byterange,bytes:b});return e||a}couldBeginLoading_(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()}init_(){this.state="READY";this.resetEverything();return this.monitorBuffer_()}track(a){if("undefined"===typeof a)return this.subtitlesTrack_;this.subtitlesTrack_=a;"INIT"===this.state&&this.couldBeginLoading_()&&this.init_();return this.subtitlesTrack_}remove(a,b){zd(a,b,this.subtitlesTrack_)}fillBuffer_(){const a=this.chooseNextRequest_();a&&(null===
this.syncController_.timestampOffsetForTimeline(a.timeline)?(this.syncController_.one("timestampoffset",()=>{this.state="READY";this.paused()||this.monitorBuffer_()}),this.state="WAITING_ON_TIMELINE"):this.loadSegment_(a))}timestampOffsetForSegment_(){return null}chooseNextRequest_(){return this.skipEmptySegments_(super.chooseNextRequest_())}skipEmptySegments_(a){for(;a&&a.segment.empty;){if(a.mediaIndex+1>=a.playlist.segments.length){a=null;break}a=this.generateSegmentInfo_({playlist:a.playlist,
mediaIndex:a.mediaIndex+1,startOfSegment:a.startOfSegment+a.duration,isSyncRequest:a.isSyncRequest})}return a}stopForError(a){this.error(a);this.state="READY";this.pause();this.trigger("error")}segmentRequestFinished_(a,b,c){if(this.subtitlesTrack_)if(this.saveTransferStats_(b.stats),this.pendingSegment_)if(a)-101===a.code&&this.handleTimeout_(),-102===a.code?this.mediaRequestsAborted+=1:this.mediaRequestsErrored+=1,this.stopForError(a);else{var e=this.pendingSegment_;this.saveBandwidthRelatedStats_(e.duration,
b.stats);b.key&&this.segmentKey(b.key,!0);this.state="APPENDING";this.trigger("appending");var h=e.segment;h.map&&(h.map.bytes=b.map.bytes);e.bytes=b.bytes;if("function"!==typeof D.WebVTT&&"function"===typeof this.loadVttJs)this.state="WAITING_ON_VTTJS",this.loadVttJs().then(()=>this.segmentRequestFinished_(a,b,c),()=>this.stopForError({message:"Error loading vtt.js"}));else{h.requested=!0;try{this.parseVTTCues_(e)}catch(m){this.stopForError({message:m.message});return}this.updateTimeMapping_(e,this.syncController_.timelines[e.timeline],
this.playlist_);e.timingInfo=e.cues.length?{start:e.cues[0].startTime,end:e.cues[e.cues.length-1].endTime}:{start:e.startOfSegment,end:e.startOfSegment+e.duration};e.isSyncRequest?(this.trigger("syncinfoupdate"),this.pendingSegment_=null,this.state="READY"):(e.byteLength=e.bytes.byteLength,this.mediaSecondsLoaded+=h.duration,e.cues.forEach(m=>{this.subtitlesTrack_.addCue(this.featuresNativeTextTracks_?new D.VTTCue(m.startTime,m.endTime,m.text):m)}),qq(this.subtitlesTrack_),this.handleAppendsDone_())}}else this.state=
"READY",this.mediaRequestsAborted+=1;else this.state="READY"}handleData_(){}updateTimingInfoEnd_(){}parseVTTCues_(a){let b=!1;if("function"!==typeof D.WebVTT)throw new wq;if("function"===typeof D.TextDecoder)var c=new D.TextDecoder("utf8");else c=D.WebVTT.StringDecoder(),b=!0;c=new D.WebVTT.Parser(D,D.vttjs,c);a.cues=[];a.timestampmap={MPEGTS:0,LOCAL:0};c.oncue=a.cues.push.bind(a.cues);c.ontimestampmap=h=>{a.timestampmap=h};c.onparsingerror=h=>{H.log.warn("Error encountered when parsing cues: "+h.message)};
if(a.segment.map){var e=a.segment.map.bytes;b&&(e=decodeURIComponent(escape(String.fromCharCode.apply(null,e))));c.parse(e)}e=a.bytes;b&&(e=decodeURIComponent(escape(String.fromCharCode.apply(null,e))));c.parse(e);c.flush()}updateTimeMapping_(a,b,c){const e=a.segment;if(b)if(a.cues.length){var h=a.timestampmap,m=h.MPEGTS/9E4-h.LOCAL+b.mapping;a.cues.forEach(p=>{p.startTime+=m;p.endTime+=m});c.syncInfo||(c.syncInfo={mediaSequence:c.mediaSequence+a.mediaIndex,time:Math.min(a.cues[0].startTime,a.cues[a.cues.length-
1].startTime-e.duration)})}else e.empty=!0}}const yq=function(a,b,c=0){if(a.segments)for(let h=0;h<a.segments.length;h++){const m=a.segments[h];if(!e)a:{var e=c+m.duration/2;const p=b.cues;for(let t=0;t<p.length;t++){const x=p[t];if(e>=x.adStartTime&&e<=x.adEndTime){e=x;break a}}e=null}if(e){if("cueIn"in m){e.endTime=c;e.adEndTime=c;c+=m.duration;e=null;continue}if(c<e.endTime){c+=m.duration;continue}e.endTime+=m.duration}else if("cueOut"in m&&(e=new D.VTTCue(c,c+m.duration,m.cueOut),e.adStartTime=
c,e.adEndTime=c+parseFloat(m.cueOut),b.addCue(e)),"cueOutCont"in m){const [p,t]=m.cueOutCont.split("/").map(parseFloat);e=new D.VTTCue(c,c+m.duration,"");e.adStartTime=c-p;e.adEndTime=e.adStartTime+t;b.addCue(e)}c+=m.duration}},wl=[{name:"VOD",run:(a,b,c,e,h)=>Infinity!==c?{time:0,segmentIndex:0,partIndex:null}:null},{name:"ProgramDateTime",run:(a,b,c,e,h)=>{if(!Object.keys(a.timelineToDatetimeMappings).length)return null;e=c=null;const m=zg(b);h=h||0;for(let x=0;x<m.length;x++){const y=m[b.endList||
0===h?x:m.length-(x+1)];var p=y.segment,t=a.timelineToDatetimeMappings[p.timeline];if(t&&p.dateTimeObject){t=p.dateTimeObject.getTime()/1E3+t;if(p.parts&&"number"===typeof y.partIndex)for(let C=0;C<y.partIndex;C++)t+=p.parts[C].duration;p=Math.abs(h-t);if(null!==e&&(0===p||e<p))break;e=p;c={time:t,segmentIndex:y.segmentIndex,partIndex:y.partIndex}}}return c}},{name:"Segment",run:(a,b,c,e,h)=>{c=a=null;h=h||0;const m=zg(b);for(let t=0;t<m.length;t++){const x=m[b.endList||0===h?t:m.length-(t+1)];var p=
x.segment;const y=x.part&&x.part.start||p&&p.start;if(p.timeline===e&&"undefined"!==typeof y){p=Math.abs(h-y);if(null!==c&&c<p)break;if(!a||null===c||c>=p)c=p,a={time:y,segmentIndex:x.segmentIndex,partIndex:x.partIndex}}}return a}},{name:"Discontinuity",run:(a,b,c,e,h)=>{c=null;h=h||0;if(b.discontinuityStarts&&b.discontinuityStarts.length){e=null;for(let m=0;m<b.discontinuityStarts.length;m++){const p=b.discontinuityStarts[m],t=a.discontinuities[b.discontinuitySequence+m+1];if(t){const x=Math.abs(h-
t.time);if(null!==e&&e<x)break;if(!c||null===e||e>=x)e=x,c={time:t.time,segmentIndex:p,partIndex:null}}}}return c}},{name:"Playlist",run:(a,b,c,e,h)=>b.syncInfo?{time:b.syncInfo.time,segmentIndex:b.syncInfo.mediaSequence-b.mediaSequence,partIndex:null}:null}];class zq extends H.EventTarget{constructor(a){super();this.timelines=[];this.discontinuities=[];this.timelineToDatetimeMappings={};this.logger_=mb("SyncController")}getSyncPoint(a,b,c,e){a=this.runStrategies_(a,b,c,e);return a.length?this.selectSyncPoint_(a,
{key:"time",value:e}):null}getExpiredTime(a,b){if(!a||!a.segments)return null;b=this.runStrategies_(a,b,a.discontinuitySequence,0);if(!b.length)return null;b=this.selectSyncPoint_(b,{key:"segmentIndex",value:0});0<b.segmentIndex&&(b.time*=-1);return Math.abs(b.time+nd({defaultDuration:a.targetDuration,durationList:a.segments,startIndex:b.segmentIndex,endIndex:0}))}runStrategies_(a,b,c,e){const h=[];for(let m=0;m<wl.length;m++){const p=wl[m],t=p.run(this,a,b,c,e);t&&(t.strategy=p.name,h.push({strategy:p.name,
syncPoint:t}))}return h}selectSyncPoint_(a,b){let c=a[0].syncPoint,e=Math.abs(a[0].syncPoint[b.key]-b.value),h=a[0].strategy;for(let m=1;m<a.length;m++){const p=Math.abs(a[m].syncPoint[b.key]-b.value);p<e&&(e=p,c=a[m].syncPoint,h=a[m].strategy)}this.logger_(`syncPoint for [${b.key}: ${b.value}] chosen with strategy`+` [${h}]: [time:${c.time},`+` segmentIndex:${c.segmentIndex}`+("number"===typeof c.partIndex?`,partIndex:${c.partIndex}`:"")+"]");return c}saveExpiredSegmentInfo(a,b){var c=b.mediaSequence-
a.mediaSequence;if(86400<c)H.log.warn(`Not saving expired segment info. Media sequence gap ${c} is too large.`);else for(--c;0<=c;c--){const e=a.segments[c];if(e&&"undefined"!==typeof e.start){b.syncInfo={mediaSequence:a.mediaSequence+c,time:e.start};this.logger_(`playlist refresh sync: [time:${b.syncInfo.time},`+` mediaSequence: ${b.syncInfo.mediaSequence}]`);this.trigger("syncinfoupdate");break}}}setDateTimeMappingForStart(a){this.timelineToDatetimeMappings={};if(a.segments&&a.segments.length&&
a.segments[0].dateTimeObject){a=a.segments[0];const b=a.dateTimeObject.getTime()/1E3;this.timelineToDatetimeMappings[a.timeline]=-b}}saveSegmentTimingInfo({segmentInfo:a,shouldSaveTimelineMapping:b}){const c=this.calculateSegmentTimeMapping_(a,a.timingInfo,b),e=a.segment;c&&(this.saveDiscontinuitySyncInfo_(a),a.playlist.syncInfo||(a.playlist.syncInfo={mediaSequence:a.playlist.mediaSequence+a.mediaIndex,time:e.start}));a=e.dateTimeObject;e.discontinuity&&b&&a&&(this.timelineToDatetimeMappings[e.timeline]=
-(a.getTime()/1E3))}timestampOffsetForTimeline(a){return"undefined"===typeof this.timelines[a]?null:this.timelines[a].time}mappingForTimeline(a){return"undefined"===typeof this.timelines[a]?null:this.timelines[a].mapping}calculateSegmentTimeMapping_(a,b,c){const e=a.segment,h=a.part;let m=this.timelines[a.timeline];if("number"===typeof a.timestampOffset)m={time:a.startOfSegment,mapping:a.startOfSegment-b.start},c&&(this.timelines[a.timeline]=m,this.trigger("timestampoffset"),this.logger_(`time mapping for timeline ${a.timeline}: `+
`[time: ${m.time}] [mapping: ${m.mapping}]`)),a=a.startOfSegment,b=b.end+m.mapping;else if(m)a=b.start+m.mapping,b=b.end+m.mapping;else return!1;h&&(h.start=a,h.end=b);if(!e.start||a<e.start)e.start=a;e.end=b;return!0}saveDiscontinuitySyncInfo_(a){const b=a.playlist,c=a.segment;if(c.discontinuity)this.discontinuities[c.timeline]={time:c.start,accuracy:0};else if(b.discontinuityStarts&&b.discontinuityStarts.length)for(let h=0;h<b.discontinuityStarts.length;h++){var e=b.discontinuityStarts[h];const m=
b.discontinuitySequence+h+1,p=e-a.mediaIndex,t=Math.abs(p);if(!this.discontinuities[m]||this.discontinuities[m].accuracy>t)e=0>p?c.start-nd({defaultDuration:b.targetDuration,durationList:b.segments,startIndex:a.mediaIndex,endIndex:e}):c.end+nd({defaultDuration:b.targetDuration,durationList:b.segments,startIndex:a.mediaIndex+1,endIndex:e}),this.discontinuities[m]={time:e,accuracy:t}}}dispose(){this.trigger("dispose");this.off()}}class Aq extends H.EventTarget{constructor(){super();this.pendingTimelineChanges_=
{};this.lastTimelineChanges_={}}clearPendingTimelineChange(a){this.pendingTimelineChanges_[a]=null;this.trigger("pendingtimelinechange")}pendingTimelineChange({type:a,from:b,to:c}){"number"===typeof b&&"number"===typeof c&&(this.pendingTimelineChanges_[a]={type:a,from:b,to:c},this.trigger("pendingtimelinechange"));return this.pendingTimelineChanges_[a]}lastTimelineChange({type:a,from:b,to:c}){"number"===typeof b&&"number"===typeof c&&(this.lastTimelineChanges_[a]={type:a,from:b,to:c},delete this.pendingTimelineChanges_[a],
this.trigger("timelinechange"));return this.lastTimelineChanges_[a]}dispose(){this.trigger("dispose");this.pendingTimelineChanges_={};this.lastTimelineChanges_={};this.off()}}const Bq=Bk(Ck(function(){var a=function(){function x(){this.listeners={}}var y=x.prototype;y.on=function(C,z){this.listeners[C]||(this.listeners[C]=[]);this.listeners[C].push(z)};y.off=function(C,z){if(!this.listeners[C])return!1;z=this.listeners[C].indexOf(z);this.listeners[C]=this.listeners[C].slice(0);this.listeners[C].splice(z,
1);return-1<z};y.trigger=function(C){var z=this.listeners[C];if(z)if(2===arguments.length)for(var E=z.length,K=0;K<E;++K)z[K].call(this,arguments[1]);else{E=Array.prototype.slice.call(arguments,1);K=z.length;for(var G=0;G<K;++G)z[G].apply(this,E)}};y.dispose=function(){this.listeners={}};y.pipe=function(C){this.on("data",function(z){C.push(z)})};return x}();let b=null;class c{constructor(x){if(!b){var y=[[[],[],[],[],[]],[[],[],[],[],[]]],C=y[0],z=y[1],E=C[4],K=z[4],G,O,R;const U=[],ba=[];let J;let ea,
ta;for(G=0;256>G;G++)ba[(U[G]=G<<1^283*(G>>7))^G]=G;for(O=R=0;!E[O];O^=J||1,R=ba[R]||1){ea=R^R<<1^R<<2^R<<3^R<<4;ea=ea>>8^ea&255^99;E[O]=ea;K[ea]=O;var W=U[G=U[J=U[O]]];ta=16843009*W^65537*G^257*J^16843008*O;W=257*U[ea]^16843008*ea;for(G=0;4>G;G++)C[G][O]=W=W<<24^W>>>8,z[G][ea]=ta=ta<<24^ta>>>8}for(G=0;5>G;G++)C[G]=C[G].slice(0),z[G]=z[G].slice(0);b=y}this._tables=[[b[0][0].slice(),b[0][1].slice(),b[0][2].slice(),b[0][3].slice(),b[0][4].slice()],[b[1][0].slice(),b[1][1].slice(),b[1][2].slice(),b[1][3].slice(),
b[1][4].slice()]];y=this._tables[0][4];C=this._tables[1];E=x.length;K=1;if(4!==E&&6!==E&&8!==E)throw Error("Invalid aes key size");O=x.slice(0);R=[];this._key=[O,R];for(x=E;x<4*E+28;x++){z=O[x-1];if(0===x%E||8===E&&4===x%E)z=y[z>>>24]<<24^y[z>>16&255]<<16^y[z>>8&255]<<8^y[z&255],0===x%E&&(z=z<<8^z>>>24^K<<24,K=K<<1^283*(K>>7));O[x]=O[x-E]^z}for(E=0;x;E++,x--)z=O[E&3?x:x-4],R[E]=4>=x||4>E?z:C[0][y[z>>>24]]^C[1][y[z>>16&255]]^C[2][y[z>>8&255]]^C[3][y[z&255]]}decrypt(x,y,C,z,E,K){const G=this._key[1];
x^=G[0];z^=G[1];C^=G[2];y^=G[3];let O,R;const W=G.length/4-2;let U,ba=4;var J=this._tables[1];const ea=J[0],ta=J[1],Aa=J[2],V=J[3],wa=J[4];for(U=0;U<W;U++)J=ea[x>>>24]^ta[z>>16&255]^Aa[C>>8&255]^V[y&255]^G[ba],O=ea[z>>>24]^ta[C>>16&255]^Aa[y>>8&255]^V[x&255]^G[ba+1],R=ea[C>>>24]^ta[y>>16&255]^Aa[x>>8&255]^V[z&255]^G[ba+2],y=ea[y>>>24]^ta[x>>16&255]^Aa[z>>8&255]^V[C&255]^G[ba+3],ba+=4,x=J,z=O,C=R;for(U=0;4>U;U++)E[(3&-U)+K]=wa[x>>>24]<<24^wa[z>>16&255]<<16^wa[C>>8&255]<<8^wa[y&255]^G[ba++],J=x,x=z,
z=C,C=y,y=J}}class e extends a{constructor(){super(a);this.jobs=[];this.delay=1;this.timeout_=null}processJob_(){this.jobs.shift()();this.timeout_=this.jobs.length?setTimeout(this.processJob_.bind(this),this.delay):null}push(x){this.jobs.push(x);this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))}}const h=function(x){return x<<24|(x&65280)<<8|(x&16711680)>>8|x>>>24};class m{constructor(x,y,C,z){const E=m.STEP,K=new Int32Array(x.buffer),G=new Uint8Array(x.byteLength);
x=0;this.asyncStream_=new e;this.asyncStream_.push(this.decryptChunk_(K.subarray(x,x+E),y,C,G));for(x=E;x<K.length;x+=E)C=new Uint32Array([h(K[x-4]),h(K[x-3]),h(K[x-2]),h(K[x-1])]),this.asyncStream_.push(this.decryptChunk_(K.subarray(x,x+E),y,C,G));this.asyncStream_.push(function(){z(null,G.subarray(0,G.byteLength-G[G.byteLength-1]))})}static get STEP(){return 32E3}decryptChunk_(x,y,C,z){return function(){const E=new Int32Array(x.buffer,x.byteOffset,x.byteLength>>2),K=new c(Array.prototype.slice.call(y)),
G=new Uint8Array(x.byteLength),O=new Int32Array(G.buffer);let R,W,U,ba,J,ea,ta,Aa,V;R=C[0];W=C[1];U=C[2];ba=C[3];for(V=0;V<E.length;V+=4)J=h(E[V]),ea=h(E[V+1]),ta=h(E[V+2]),Aa=h(E[V+3]),K.decrypt(J,ea,ta,Aa,O,V),O[V]=h(O[V]^R),O[V+1]=h(O[V+1]^W),O[V+2]=h(O[V+2]^U),O[V+3]=h(O[V+3]^ba),R=J,W=ea,U=ta,ba=Aa;z.set(G,x.byteOffset)}}}var p="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{};p=("undefined"!==typeof window?
window:"undefined"!==typeof p?p:"undefined"!==typeof self?self:{}).BigInt||Number;[p("0x1"),p("0x100"),p("0x10000"),p("0x1000000"),p("0x100000000"),p("0x10000000000"),p("0x1000000000000"),p("0x100000000000000"),p("0x10000000000000000")];(function(){var x=new Uint16Array([65484]);x=new Uint8Array(x.buffer,x.byteOffset,x.byteLength);return 255===x[0]?"big":204===x[0]?"little":"unknown"})();const t=function(x){const y={};Object.keys(x).forEach(C=>{const z=x[C];var E="function"===ArrayBuffer.isView?ArrayBuffer.isView(z):
z&&z.buffer instanceof ArrayBuffer;y[C]=E?{bytes:z.buffer,byteOffset:z.byteOffset,byteLength:z.byteLength}:z});return y};self.onmessage=function(x){const y=x.data;x=new Uint8Array(y.encrypted.bytes,y.encrypted.byteOffset,y.encrypted.byteLength);const C=new Uint32Array(y.key.bytes,y.key.byteOffset,y.key.byteLength/4),z=new Uint32Array(y.iv.bytes,y.iv.byteOffset,y.iv.byteLength/4);new m(x,C,z,function(E,K){self.postMessage(t({source:y.source,decrypted:K}),[K.buffer])})}}));var Cq=Ak(Bq);const Qe=(a,
b)=>{a.abort();a.pause();b&&b.activePlaylistLoader&&(b.activePlaylistLoader.pause(),b.activePlaylistLoader=null)},Dq=(a,b)=>()=>{const {segmentLoaders:{[a]:c,main:e},mediaTypes:{[a]:h}}=b;var m=h.activeTrack();const p=h.getActiveGroup(),t=h.activePlaylistLoader,x=h.lastGroup_;p&&x&&p.id===x.id||(h.lastGroup_=p,h.lastTrack_=m,Qe(c,h),p&&!p.isMainPlaylist&&(p.playlistLoader?(c.resyncLoader(),m=p.playlistLoader,h.activePlaylistLoader=m,m.load()):t&&e.resetEverything()))},Eq=(a,b)=>()=>{const {segmentLoaders:{[a]:c},
mediaTypes:{[a]:e}}=b;e.lastGroup_=null;c.abort();c.pause()},Fq=(a,b)=>()=>{const {mainPlaylistLoader:c,segmentLoaders:{[a]:e,main:h},mediaTypes:{[a]:m}}=b;var p=m.activeTrack(),t=m.getActiveGroup(),x=m.activePlaylistLoader;const y=m.lastTrack_;if(!y||!p||y.id!==p.id)if(m.lastGroup_=t,m.lastTrack_=p,Qe(e,m),t)if(t.isMainPlaylist)p&&y&&p.id!==y.id&&(t=b.vhs.playlistController_,x=t.selectPlaylist(),t.media()!==x&&(m.logger_(`track change. Switching main audio from ${y.id} to ${p.id}`),c.pause(),h.resetEverything(),
t.fastQualityChange_(x)));else{if("AUDIO"===a){if(!t.playlistLoader){h.setAudio(!0);h.resetEverything();return}e.setAudio(!0);h.setAudio(!1)}x===t.playlistLoader?(p=t.playlistLoader,m.activePlaylistLoader=p,p.load()):(e.track&&e.track(p),e.resetEverything(),p=t.playlistLoader,m.activePlaylistLoader=p,p.load())}},Re={AUDIO:(a,b)=>()=>{const {segmentLoaders:{[a]:c},mediaTypes:{[a]:e},excludePlaylist:h}=b;Qe(c,e);const m=e.activeTrack();var p=e.activeGroup();p=(p.filter(t=>t.default)[0]||p[0]).id;p=
e.tracks[p];if(m===p)h({error:{message:"Problem encountered loading the default audio track."}});else{H.log.warn("Problem encountered loading the alternate audio track.Switching back to default.");for(const t in e.tracks)e.tracks[t].enabled=e.tracks[t]===p;e.onTrackChanged()}},SUBTITLES:(a,b)=>()=>{const {segmentLoaders:{[a]:c},mediaTypes:{[a]:e}}=b;H.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track.");Qe(c,e);const h=e.activeTrack();h&&(h.mode="disabled");e.onTrackChanged()}},
xl={AUDIO:(a,b,c)=>{if(b){var {tech:e,requestOptions:h,segmentLoaders:{[a]:m}}=c;b.on("loadedmetadata",()=>{const p=b.media();m.playlist(p,h);(!e.paused()||p.endList&&"none"!==e.preload())&&m.load()});b.on("loadedplaylist",()=>{m.playlist(b.media(),h);e.paused()||m.load()});b.on("error",Re[a](a,c))}},SUBTITLES:(a,b,c)=>{const {tech:e,requestOptions:h,segmentLoaders:{[a]:m},mediaTypes:{[a]:p}}=c;b.on("loadedmetadata",()=>{const t=b.media();m.playlist(t,h);m.track(p.activeTrack());(!e.paused()||t.endList&&
"none"!==e.preload())&&m.load()});b.on("loadedplaylist",()=>{m.playlist(b.media(),h);e.paused()||m.load()});b.on("error",Re[a](a,c))}},Gq={AUDIO:(a,b)=>{const {vhs:c,sourceType:e,segmentLoaders:{[a]:h},requestOptions:m,main:{mediaGroups:p},mediaTypes:{[a]:{groups:t,tracks:x,logger_:y}},mainPlaylistLoader:C}=b,z=od(C.main);p[a]&&0!==Object.keys(p[a]).length||(p[a]={main:{default:{default:!0}}},z&&(p[a].main.default.playlists=C.main.playlists));for(const G in p[a]){t[G]||(t[G]=[]);for(const O in p[a][G]){var E=
p[a][G][O],K=void 0;z?(y(`AUDIO group '${G}' label '${O}' is a main playlist`),E.isMainPlaylist=!0,K=null):K="vhs-json"===e&&E.playlists?new Mc(E.playlists[0],c,m):E.resolvedUri?new Mc(E.resolvedUri,c,m):E.playlists&&"dash"===e?new Hg(E.playlists[0],c,m,C):null;E=la({id:O,playlistLoader:K},E);xl[a](a,E.playlistLoader,b);t[G].push(E);if("undefined"===typeof x[O]){K=H.AudioTrack;let R=E.default?"main":"alternative";E.characteristics&&0<=E.characteristics.indexOf("public.accessibility.describes-video")&&
(R="main-desc");E=new K({id:O,kind:R,enabled:!1,language:E.language,default:E.default,label:O});x[O]=E}}}h.on("error",Re[a](a,b))},SUBTITLES:(a,b)=>{const {tech:c,vhs:e,sourceType:h,segmentLoaders:{[a]:m},requestOptions:p,main:{mediaGroups:t},mediaTypes:{[a]:{groups:x,tracks:y}},mainPlaylistLoader:C}=b;for(const E in t[a]){x[E]||(x[E]=[]);for(const K in t[a][E]){if(t[a][E][K].forced)continue;var z=t[a][E][K];let G;if("hls"===h)G=new Mc(z.resolvedUri,e,p);else if("dash"===h){if(!z.playlists.filter(O=>
Infinity!==O.excludeUntil).length)return;G=new Hg(z.playlists[0],e,p,C)}else"vhs-json"===h&&(G=new Mc(z.playlists?z.playlists[0]:z.resolvedUri,e,p));z=la({id:K,playlistLoader:G},z);xl[a](a,z.playlistLoader,b);x[E].push(z);"undefined"===typeof y[K]&&(z=c.addRemoteTextTrack({id:K,kind:"subtitles",default:z.default&&z.autoselect,language:z.language,label:K},!1).track,y[K]=z)}}m.on("error",Re[a](a,b))},"CLOSED-CAPTIONS":(a,b)=>{const {tech:c,main:{mediaGroups:e},mediaTypes:{[a]:{groups:h,tracks:m}}}=
b;for(const p in e[a]){h[p]||(h[p]=[]);for(const t in e[a][p]){b=e[a][p][t];if(!/^(?:CC|SERVICE)/.test(b.instreamId))continue;const x=c.options_.vhs&&c.options_.vhs.captionServices||{};let y={label:t,language:b.language,instreamId:b.instreamId,default:b.default&&b.autoselect};x[y.instreamId]&&(y=la(y,x[y.instreamId]));void 0===y.default&&delete y.default;h[p].push(la({id:t},b));"undefined"===typeof m[t]&&(b=c.addRemoteTextTrack({id:y.instreamId,kind:"captions",default:y.default,language:y.language,
label:y.label},!1).track,m[t]=b)}}}},yl=(a,b)=>{for(let c=0;c<a.length;c++)if(Cg(b,a[c])||a[c].playlists&&yl(a[c].playlists,b))return!0;return!1},Hq=(a,b)=>c=>{const {mainPlaylistLoader:e,mediaTypes:{[a]:{groups:h}}}=b,m=e.media();if(!m)return null;let p=null;m.attributes[a]&&(p=h[m.attributes[a]]);const t=Object.keys(h);if(!p)if("AUDIO"===a&&1<t.length&&od(b.main))for(let x=0;x<t.length;x++){const y=h[t[x]];if(yl(y,m)){p=y;break}}else h.main?p=h.main:1===t.length&&(p=h[t[0]]);return"undefined"===
typeof c?p:null!==c&&p?p.filter(x=>x.id===c.id)[0]||null:null},Iq={AUDIO:(a,b)=>()=>{const {mediaTypes:{[a]:{tracks:c}}}=b;for(const e in c)if(c[e].enabled)return c[e];return null},SUBTITLES:(a,b)=>()=>{const {mediaTypes:{[a]:{tracks:c}}}=b;for(const e in c)if("showing"===c[e].mode||"hidden"===c[e].mode)return c[e];return null}},Jq=(a,{mediaTypes:b})=>()=>{const c=b[a].activeTrack();return c?b[a].activeGroup(c):null},Kq=a=>{["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(y=>{Gq[y](y,a)});const {mediaTypes:b,
mainPlaylistLoader:c,tech:e,vhs:h,segmentLoaders:{AUDIO:m,main:p}}=a;["AUDIO","SUBTITLES"].forEach(y=>{b[y].activeGroup=Hq(y,a);b[y].activeTrack=Iq[y](y,a);b[y].onGroupChanged=Dq(y,a);b[y].onGroupChanging=Eq(y,a);b[y].onTrackChanged=Fq(y,a);b[y].getActiveGroup=Jq(y,a)});var t=b.AUDIO.activeGroup();t&&(t=(t.filter(y=>y.default)[0]||t[0]).id,b.AUDIO.tracks[t].enabled=!0,b.AUDIO.onGroupChanged(),b.AUDIO.onTrackChanged(),b.AUDIO.getActiveGroup().playlistLoader?(p.setAudio(!1),m.setAudio(!0)):p.setAudio(!0));
c.on("mediachange",()=>{["AUDIO","SUBTITLES"].forEach(y=>b[y].onGroupChanged())});c.on("mediachanging",()=>{["AUDIO","SUBTITLES"].forEach(y=>b[y].onGroupChanging())});const x=()=>{b.AUDIO.onTrackChanged();e.trigger({type:"usage",name:"vhs-audio-change"})};e.audioTracks().addEventListener("change",x);e.remoteTextTracks().addEventListener("change",b.SUBTITLES.onTrackChanged);h.on("dispose",()=>{e.audioTracks().removeEventListener("change",x);e.remoteTextTracks().removeEventListener("change",b.SUBTITLES.onTrackChanged)});
e.clearTracks("audio");for(const y in b.AUDIO.tracks)e.audioTracks().addTrack(b.AUDIO.tracks[y])},Lq=()=>{const a={};["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(b=>{a[b]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:Gb,activeTrack:Gb,getActiveGroup:Gb,onGroupChanged:Gb,onTrackChanged:Gb,lastTrack_:null,logger_:mb(`MediaGroups[${b}]`)}});return a};let Mb;const Mq="mediaRequests mediaRequestsAborted mediaRequestsTimedout mediaRequestsErrored mediaTransferDuration mediaBytesTransferred mediaAppends".split(" "),
Nq=function(a){return this.audioSegmentLoader_[a]+this.mainSegmentLoader_[a]},Oq=function({currentPlaylist:a,buffered:b,currentTime:c,nextPlaylist:e,bufferLowWaterLine:h,bufferHighWaterLine:m,duration:p,bufferBasedABR:t,log:x}){if(!e)return H.log.warn("We received no playlist to switch to. Please check your stream."),!1;const y=`allowing switch ${a&&a.id||"null"} -> ${e.id}`;if(!a)return x(`${y} as current playlist is not set`),!0;if(e.id===a.id)return!1;const C=!!Kc(b,c).length;if(!a.endList){if(!C&&
"number"===typeof a.partTargetDuration)return x(`not ${y} as current playlist is live llhls, but currentTime isn't in buffered.`),!1;x(`${y} as current playlist is live`);return!0}b=xg(b,c);c=t?Ca.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:Ca.MAX_BUFFER_LOW_WATER_LINE;if(p<c)return x(`${y} as duration < max low water line (${p} < ${c})`),!0;e=e.attributes.BANDWIDTH;a=a.attributes.BANDWIDTH;if(e<a&&(!t||b<m))return h=`${y} as next bandwidth < current bandwidth (${e} < ${a})`,t&&(h+=` and forwardBuffer < bufferHighWaterLine (${b} < ${m})`),
x(h),!0;if((!t||e>a)&&b>=h)return m=`${y} as forwardBuffer >= bufferLowWaterLine (${b} >= ${h})`,t&&(m+=` and next bandwidth > current bandwidth (${e} > ${a})`),x(m),!0;x(`not ${y} as no switching criteria met`);return!1};class Pq extends H.EventTarget{constructor(a){super();const {src:b,withCredentials:c,tech:e,bandwidth:h,externVhs:m,useCueTags:p,playlistExclusionDuration:t,enableLowInitialPlaylist:x,sourceType:y,cacheEncryptionKeys:C,bufferBasedABR:z,leastPixelDiffSelector:E,captionServices:K}=
a;if(!b)throw Error("A non-empty playlist URL or JSON manifest string is required");var {maxPlaylistRetries:G}=a;if(null===G||"undefined"===typeof G)G=Infinity;Mb=m;this.bufferBasedABR=!!z;this.leastPixelDiffSelector=!!E;this.withCredentials=c;this.tech_=e;this.vhs_=e.vhs;this.sourceType_=y;this.useCueTags_=p;this.playlistExclusionDuration=t;this.maxPlaylistRetries=G;this.enableLowInitialPlaylist=x;this.useCueTags_&&(this.cueTagsTrack_=this.tech_.addTextTrack("metadata","ad-cues"),this.cueTagsTrack_.inBandMetadataTrackDispatchType=
"");this.requestOptions_={withCredentials:c,maxPlaylistRetries:G,timeout:null};this.on("error",this.pauseLoading);this.mediaTypes_=Lq();this.mediaSource=new D.MediaSource;this.handleDurationChange_=this.handleDurationChange_.bind(this);this.handleSourceOpen_=this.handleSourceOpen_.bind(this);this.handleSourceEnded_=this.handleSourceEnded_.bind(this);this.mediaSource.addEventListener("durationchange",this.handleDurationChange_);this.mediaSource.addEventListener("sourceopen",this.handleSourceOpen_);
this.mediaSource.addEventListener("sourceended",this.handleSourceEnded_);this.seekable_=Ia();this.hasPlayed_=!1;this.syncController_=new zq(a);this.segmentMetadataTrack_=e.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track;this.decrypter_=new Cq;this.sourceUpdater_=new ul(this.mediaSource);this.inbandTextTracks_={};this.timelineChangeController_=new Aq;G={vhs:this.vhs_,parse708captions:a.parse708captions,useDtsForTimestampOffset:a.useDtsForTimestampOffset,captionServices:K,mediaSource:this.mediaSource,
currentTime:this.tech_.currentTime.bind(this.tech_),seekable:()=>this.seekable(),seeking:()=>this.tech_.seeking(),duration:()=>this.duration(),hasPlayed:()=>this.hasPlayed_,goalBufferLength:()=>this.goalBufferLength(),bandwidth:h,syncController:this.syncController_,decrypter:this.decrypter_,sourceType:this.sourceType_,inbandTextTracks:this.inbandTextTracks_,cacheEncryptionKeys:C,sourceUpdater:this.sourceUpdater_,timelineChangeController:this.timelineChangeController_,exactManifestTimings:a.exactManifestTimings};
this.mainPlaylistLoader_="dash"===this.sourceType_?new Hg(b,this.vhs_,this.requestOptions_):new Mc(b,this.vhs_,this.requestOptions_);this.setupMainPlaylistLoaderListeners_();this.mainSegmentLoader_=new bh(la(G,{segmentMetadataTrack:this.segmentMetadataTrack_,loaderType:"main"}),a);this.audioSegmentLoader_=new bh(la(G,{loaderType:"audio"}),a);this.subtitleSegmentLoader_=new xq(la(G,{loaderType:"vtt",featuresNativeTextTracks:this.tech_.featuresNativeTextTracks,loadVttJs:()=>new Promise((O,R)=>{function W(){e.off("vttjserror",
U);O()}function U(){e.off("vttjsloaded",W);R()}e.one("vttjsloaded",W);e.one("vttjserror",U);e.addWebVttScript_()})}),a);this.setupSegmentLoaderListeners_();this.bufferBasedABR&&(this.mainPlaylistLoader_.one("loadedplaylist",()=>this.startABRTimer_()),this.tech_.on("pause",()=>this.stopABRTimer_()),this.tech_.on("play",()=>this.startABRTimer_()));Mq.forEach(O=>{this[O+"_"]=Nq.bind(this,O)});this.logger_=mb("pc");this.triggeredFmp4Usage=!1;"none"===this.tech_.preload()?(this.loadOnPlay_=()=>{this.loadOnPlay_=
null;this.mainPlaylistLoader_.load()},this.tech_.one("play",this.loadOnPlay_)):this.mainPlaylistLoader_.load();this.audioAppendsToLoadedData__=this.mainAppendsToLoadedData__=this.timeToLoadedData__=-1;a="none"===this.tech_.preload()?"play":"loadstart";this.tech_.one(a,()=>{const O=Date.now();this.tech_.one("loadeddata",()=>{this.timeToLoadedData__=Date.now()-O;this.mainAppendsToLoadedData__=this.mainSegmentLoader_.mediaAppends;this.audioAppendsToLoadedData__=this.audioSegmentLoader_.mediaAppends})})}mainAppendsToLoadedData_(){return this.mainAppendsToLoadedData__}audioAppendsToLoadedData_(){return this.audioAppendsToLoadedData__}appendsToLoadedData_(){const a=
this.mainAppendsToLoadedData_(),b=this.audioAppendsToLoadedData_();return-1===a||-1===b?-1:a+b}timeToLoadedData_(){return this.timeToLoadedData__}checkABR_(a="abr"){const b=this.selectPlaylist();b&&this.shouldSwitchToMedia_(b)&&this.switchMedia_(b,a)}switchMedia_(a,b,c){var e=this.media();e=e&&(e.id||e.uri);const h=a.id||a.uri;e&&e!==h&&(this.logger_(`switch media ${e} -> ${h} from ${b}`),this.tech_.trigger({type:"usage",name:`vhs-rendition-change-${b}`}));this.mainPlaylistLoader_.media(a,c)}startABRTimer_(){this.stopABRTimer_();
this.abrTimer_=D.setInterval(()=>this.checkABR_(),250)}stopABRTimer_(){this.tech_.scrubbing&&this.tech_.scrubbing()||(D.clearInterval(this.abrTimer_),this.abrTimer_=null)}getAudioTrackPlaylists_(){const a=this.main(),b=a&&a.playlists||[];if(!a||!a.mediaGroups||!a.mediaGroups.AUDIO)return b;const c=a.mediaGroups.AUDIO;var e=Object.keys(c);let h;if(Object.keys(this.mediaTypes_.AUDIO.groups).length)h=this.mediaTypes_.AUDIO.activeTrack();else{e=c.main||e.length&&c[e[0]];for(var m in e)if(e[m].default){h=
{label:m};break}}if(!h)return b;m=[];for(const p in c)if(c[p][h.label])if(e=c[p][h.label],e.playlists&&e.playlists.length)m.push.apply(m,e.playlists);else if(e.uri)m.push(e);else if(a.playlists.length)for(e=0;e<a.playlists.length;e++){const t=a.playlists[e];t.attributes&&t.attributes.AUDIO&&t.attributes.AUDIO===p&&m.push(t)}return m.length?m:b}setupMainPlaylistLoaderListeners_(){this.mainPlaylistLoader_.on("loadedmetadata",()=>{const a=this.mainPlaylistLoader_.media(),b=1500*a.targetDuration;Bg(this.mainPlaylistLoader_.main,
this.mainPlaylistLoader_.media())?this.requestOptions_.timeout=0:this.requestOptions_.timeout=b;a.endList&&"none"!==this.tech_.preload()&&(this.mainSegmentLoader_.playlist(a,this.requestOptions_),this.mainSegmentLoader_.load());Kq({sourceType:this.sourceType_,segmentLoaders:{AUDIO:this.audioSegmentLoader_,SUBTITLES:this.subtitleSegmentLoader_,main:this.mainSegmentLoader_},tech:this.tech_,requestOptions:this.requestOptions_,mainPlaylistLoader:this.mainPlaylistLoader_,vhs:this.vhs_,main:this.main(),
mediaTypes:this.mediaTypes_,excludePlaylist:this.excludePlaylist.bind(this)});this.triggerPresenceUsage_(this.main(),a);this.setupFirstPlay();if(!this.mediaTypes_.AUDIO.activePlaylistLoader||this.mediaTypes_.AUDIO.activePlaylistLoader.media())this.trigger("selectedinitialmedia");else this.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",()=>{this.trigger("selectedinitialmedia")})});this.mainPlaylistLoader_.on("loadedplaylist",()=>{this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_);
let a=this.mainPlaylistLoader_.media();if(!a){this.excludeUnsupportedVariants_();let b;this.enableLowInitialPlaylist&&(b=this.selectInitialPlaylist());b||(b=this.selectPlaylist());if(!b||!this.shouldSwitchToMedia_(b))return;this.initialMedia_=b;this.switchMedia_(this.initialMedia_,"initial");if("vhs-json"!==this.sourceType_||!this.initialMedia_.segments)return;a=this.initialMedia_}this.handleUpdatedMediaPlaylist(a)});this.mainPlaylistLoader_.on("error",()=>{const a=this.mainPlaylistLoader_.error;
this.excludePlaylist({playlistToExclude:a.playlist,error:a})});this.mainPlaylistLoader_.on("mediachanging",()=>{this.mainSegmentLoader_.abort();this.mainSegmentLoader_.pause()});this.mainPlaylistLoader_.on("mediachange",()=>{const a=this.mainPlaylistLoader_.media(),b=1500*a.targetDuration;Bg(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.media())?this.requestOptions_.timeout=0:this.requestOptions_.timeout=b;this.mainPlaylistLoader_.load();this.mainSegmentLoader_.playlist(a,this.requestOptions_);
this.mainSegmentLoader_.load();this.tech_.trigger({type:"mediachange",bubbles:!0})});this.mainPlaylistLoader_.on("playlistunchanged",()=>{const a=this.mainPlaylistLoader_.media();"playlist-unchanged"!==a.lastExcludeReason_&&this.stuckAtPlaylistEnd_(a)&&(this.excludePlaylist({error:{message:"Playlist no longer updating.",reason:"playlist-unchanged"}}),this.tech_.trigger("playliststuck"))});this.mainPlaylistLoader_.on("renditiondisabled",()=>{this.tech_.trigger({type:"usage",name:"vhs-rendition-disabled"})});
this.mainPlaylistLoader_.on("renditionenabled",()=>{this.tech_.trigger({type:"usage",name:"vhs-rendition-enabled"})})}handleUpdatedMediaPlaylist(a){this.useCueTags_&&this.updateAdCues_(a);this.mainSegmentLoader_.playlist(a,this.requestOptions_);this.updateDuration(!a.endList);this.tech_.paused()||(this.mainSegmentLoader_.load(),this.audioSegmentLoader_&&this.audioSegmentLoader_.load())}triggerPresenceUsage_(a,b){a=a.mediaGroups||{};let c=!0;const e=Object.keys(a.AUDIO);for(const h in a.AUDIO)for(const m in a.AUDIO[h])a.AUDIO[h][m].uri||
(c=!1);c&&this.tech_.trigger({type:"usage",name:"vhs-demuxed"});Object.keys(a.SUBTITLES).length&&this.tech_.trigger({type:"usage",name:"vhs-webvtt"});Mb.Playlist.isAes(b)&&this.tech_.trigger({type:"usage",name:"vhs-aes"});e.length&&1<Object.keys(a.AUDIO[e[0]]).length&&this.tech_.trigger({type:"usage",name:"vhs-alternate-audio"});this.useCueTags_&&this.tech_.trigger({type:"usage",name:"vhs-playlist-cue-tags"})}shouldSwitchToMedia_(a){const b=this.mainPlaylistLoader_.media()||this.mainPlaylistLoader_.pendingMedia_,
c=this.tech_.currentTime(),e=this.bufferLowWaterLine(),h=this.bufferHighWaterLine(),m=this.tech_.buffered();return Oq({buffered:m,currentTime:c,currentPlaylist:b,nextPlaylist:a,bufferLowWaterLine:e,bufferHighWaterLine:h,duration:this.duration(),bufferBasedABR:this.bufferBasedABR,log:this.logger_})}setupSegmentLoaderListeners_(){this.mainSegmentLoader_.on("bandwidthupdate",()=>{this.checkABR_("bandwidthupdate");this.tech_.trigger("bandwidthupdate")});this.mainSegmentLoader_.on("timeout",()=>{this.bufferBasedABR&&
this.mainSegmentLoader_.load()});if(!this.bufferBasedABR)this.mainSegmentLoader_.on("progress",()=>{this.trigger("progress")});this.mainSegmentLoader_.on("error",()=>{const b=this.mainSegmentLoader_.error();this.excludePlaylist({playlistToExclude:b.playlist,error:b})});this.mainSegmentLoader_.on("appenderror",()=>{this.error=this.mainSegmentLoader_.error_;this.trigger("error")});this.mainSegmentLoader_.on("syncinfoupdate",()=>{this.onSyncInfoUpdate_()});this.mainSegmentLoader_.on("timestampoffset",
()=>{this.tech_.trigger({type:"usage",name:"vhs-timestamp-offset"})});this.audioSegmentLoader_.on("syncinfoupdate",()=>{this.onSyncInfoUpdate_()});this.audioSegmentLoader_.on("appenderror",()=>{this.error=this.audioSegmentLoader_.error_;this.trigger("error")});this.mainSegmentLoader_.on("ended",()=>{this.logger_("main segment loader ended");this.onEndOfStream()});this.mainSegmentLoader_.on("earlyabort",b=>{this.bufferBasedABR||(this.delegateLoaders_("all",["abort"]),this.excludePlaylist({error:{message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},
playlistExclusionDuration:120}))});const a=()=>{if(!this.sourceUpdater_.hasCreatedSourceBuffers())return this.tryToCreateSourceBuffers_();const b=this.getCodecsOrExclude_();b&&this.sourceUpdater_.addOrChangeSourceBuffers(b)};this.mainSegmentLoader_.on("trackinfo",a);this.audioSegmentLoader_.on("trackinfo",a);this.mainSegmentLoader_.on("fmp4",()=>{this.triggeredFmp4Usage||(this.tech_.trigger({type:"usage",name:"vhs-fmp4"}),this.triggeredFmp4Usage=!0)});this.audioSegmentLoader_.on("fmp4",()=>{this.triggeredFmp4Usage||
(this.tech_.trigger({type:"usage",name:"vhs-fmp4"}),this.triggeredFmp4Usage=!0)});this.audioSegmentLoader_.on("ended",()=>{this.logger_("audioSegmentLoader ended");this.onEndOfStream()})}mediaSecondsLoaded_(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)}load(){this.mainSegmentLoader_.load();this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load();this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()}fastQualityChange_(a=
this.selectPlaylist()){a===this.mainPlaylistLoader_.media()?this.logger_("skipping fastQualityChange because new media is same as old"):(this.switchMedia_(a,"fast-quality"),this.mainSegmentLoader_.resetEverything(()=>{H.browser.IE_VERSION||H.browser.IS_EDGE?this.tech_.setCurrentTime(this.tech_.currentTime()+.04):this.tech_.setCurrentTime(this.tech_.currentTime())}))}play(){if(!this.setupFirstPlay()){this.tech_.ended()&&this.tech_.setCurrentTime(0);this.hasPlayed_&&this.load();var a=this.tech_.seekable();
if(Infinity===this.tech_.duration()&&this.tech_.currentTime()<a.start(0))return this.tech_.setCurrentTime(a.end(a.length-1))}}setupFirstPlay(){const a=this.mainPlaylistLoader_.media();if(!a||this.tech_.paused()||this.hasPlayed_)return!1;if(!a.endList){const b=this.seekable();if(!b.length)return!1;if(H.browser.IE_VERSION&&0===this.tech_.readyState())return this.tech_.one("loadedmetadata",()=>{this.trigger("firstplay");this.tech_.setCurrentTime(b.end(0));this.hasPlayed_=!0}),!1;this.trigger("firstplay");
this.tech_.setCurrentTime(b.end(0))}this.hasPlayed_=!0;this.load();return!0}handleSourceOpen_(){this.tryToCreateSourceBuffers_();if(this.tech_.autoplay()){const a=this.tech_.play();"undefined"!==typeof a&&"function"===typeof a.then&&a.then(null,b=>{})}this.trigger("sourceopen")}handleSourceEnded_(){if(this.inbandTextTracks_.metadataTrack_){var a=this.inbandTextTracks_.metadataTrack_.cues;if(a&&a.length){var b=this.duration();a[a.length-1].endTime=isNaN(b)||Infinity===Math.abs(b)?Number.MAX_VALUE:
b}}}handleDurationChange_(){this.tech_.trigger("durationchange")}onEndOfStream(){let a=this.mainSegmentLoader_.ended_;if(this.mediaTypes_.AUDIO.activePlaylistLoader){const b=this.mainSegmentLoader_.getCurrentMediaInfo_();a=!b||b.hasVideo?a&&this.audioSegmentLoader_.ended_:this.audioSegmentLoader_.ended_}a&&(this.stopABRTimer_(),this.sourceUpdater_.endOfStream())}stuckAtPlaylistEnd_(a){if(!this.seekable().length)return!1;var b=this.syncController_.getExpiredTime(a,this.duration());if(null===b)return!1;
a=Mb.Playlist.playlistEnd(a,b);b=this.tech_.currentTime();var c=this.tech_.buffered();if(!c.length)return a-b<=zb;c=c.end(c.length-1);return c-b<=zb&&a-c<=zb}excludePlaylist({playlistToExclude:a=this.mainPlaylistLoader_.media(),error:b={},playlistExclusionDuration:c}){a=a||this.mainPlaylistLoader_.media();c=c||b.playlistExclusionDuration||this.playlistExclusionDuration;if(a){a.playlistErrors_++;var e=this.mainPlaylistLoader_.main.playlists,h=e.filter(ve);h=1===h.length&&h[0]===a;if(1===e.length&&
Infinity!==c)return H.log.warn(`Problem encountered with playlist ${a.id}. `+"Trying again since it is the only playlist."),this.tech_.trigger("retryplaylist"),this.mainPlaylistLoader_.load(h);if(h){let m=!1;e.forEach(p=>{if(p!==a){var t=p.excludeUntil;"undefined"!==typeof t&&Infinity!==t&&(m=!0,delete p.excludeUntil)}});m&&(H.log.warn("Removing other playlists from the exclusion list because the last rendition is about to be excluded."),this.tech_.trigger("retryplaylist"))}c=a.playlistErrors_>this.maxPlaylistRetries?
Infinity:Date.now()+1E3*c;a.excludeUntil=c;b.reason&&(a.lastExcludeReason_=b.reason);this.tech_.trigger("excludeplaylist");this.tech_.trigger({type:"usage",name:"vhs-rendition-excluded"});if(c=this.selectPlaylist())return(b.internal?this.logger_:H.log.warn)(`${b.internal?"Internal problem":"Problem"} encountered with playlist ${a.id}.`+`${b.message?" "+b.message:""} Switching to playlist ${c.id}.`),c.attributes.AUDIO!==a.attributes.AUDIO&&this.delegateLoaders_("audio",["abort","pause"]),c.attributes.SUBTITLES!==
a.attributes.SUBTITLES&&this.delegateLoaders_("subtitle",["abort","pause"]),this.delegateLoaders_("main",["abort","pause"]),b=c.targetDuration/2*1E3||5E3,b="number"===typeof c.lastRequest&&Date.now()-c.lastRequest<=b,this.switchMedia_(c,"exclude",h||b);this.error="Playback cannot continue. No available working or supported playlists.";this.trigger("error")}else this.error=b,"open"!==this.mediaSource.readyState?this.trigger("error"):this.sourceUpdater_.endOfStream("network")}pauseLoading(){this.delegateLoaders_("all",
["abort","pause"]);this.stopABRTimer_()}delegateLoaders_(a,b){const c=[],e="all"===a;(e||"main"===a)&&c.push(this.mainPlaylistLoader_);const h=[];(e||"audio"===a)&&h.push("AUDIO");if(e||"subtitle"===a)h.push("CLOSED-CAPTIONS"),h.push("SUBTITLES");h.forEach(m=>{(m=this.mediaTypes_[m]&&this.mediaTypes_[m].activePlaylistLoader)&&c.push(m)});["main","audio","subtitle"].forEach(m=>{const p=this[`${m}SegmentLoader_`];!p||a!==m&&"all"!==a||c.push(p)});c.forEach(m=>b.forEach(p=>{if("function"===typeof m[p])m[p]()}))}setCurrentTime(a){const b=
Kc(this.tech_.buffered(),a);if(!this.mainPlaylistLoader_||!this.mainPlaylistLoader_.media()||!this.mainPlaylistLoader_.media().segments)return 0;if(b&&b.length)return a;this.mainSegmentLoader_.resetEverything();this.mainSegmentLoader_.abort();this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.resetEverything(),this.audioSegmentLoader_.abort());this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.resetEverything(),this.subtitleSegmentLoader_.abort());this.load()}duration(){if(!this.mainPlaylistLoader_)return 0;
const a=this.mainPlaylistLoader_.media();return a?a.endList?this.mediaSource?this.mediaSource.duration:Mb.Playlist.duration(a):Infinity:0}seekable(){return this.seekable_}onSyncInfoUpdate_(){let a;if(this.mainPlaylistLoader_){var b=this.mainPlaylistLoader_.media();if(b){var c=this.syncController_.getExpiredTime(b,this.duration());if(null!==c){var e=this.mainPlaylistLoader_.main,h=Mb.Playlist.seekable(b,c,Mb.Playlist.liveEdgeDelay(e,b));if(0!==h.length){if(this.mediaTypes_.AUDIO.activePlaylistLoader){b=
this.mediaTypes_.AUDIO.activePlaylistLoader.media();c=this.syncController_.getExpiredTime(b,this.duration());if(null===c)return;a=Mb.Playlist.seekable(b,c,Mb.Playlist.liveEdgeDelay(e,b));if(0===a.length)return}if(this.seekable_&&this.seekable_.length){var m=this.seekable_.end(0);var p=this.seekable_.start(0)}a?a.start(0)>h.end(0)||h.start(0)>a.end(0)?this.seekable_=h:this.seekable_=Ia([[a.start(0)>h.start(0)?a.start(0):h.start(0),a.end(0)<h.end(0)?a.end(0):h.end(0)]]):this.seekable_=h;this.seekable_&&
this.seekable_.length&&this.seekable_.end(0)===m&&this.seekable_.start(0)===p||(this.logger_(`seekable updated [${bk(this.seekable_)}]`),this.tech_.trigger("seekablechanged"))}}}}}updateDuration(a){this.updateDuration_&&(this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.updateDuration_=null);if("open"!==this.mediaSource.readyState)this.updateDuration_=this.updateDuration.bind(this,a),this.mediaSource.addEventListener("sourceopen",this.updateDuration_);else if(a)a=this.seekable(),
a.length&&(isNaN(this.mediaSource.duration)||this.mediaSource.duration<a.end(a.length-1))&&this.sourceUpdater_.setDuration(a.end(a.length-1));else{a=this.tech_.buffered();var b=Mb.Playlist.duration(this.mainPlaylistLoader_.media());0<a.length&&(b=Math.max(b,a.end(a.length-1)));this.mediaSource.duration!==b&&this.sourceUpdater_.setDuration(b)}}dispose(){this.trigger("dispose");this.decrypter_.terminate();this.mainPlaylistLoader_.dispose();this.mainSegmentLoader_.dispose();this.loadOnPlay_&&this.tech_.off("play",
this.loadOnPlay_);["AUDIO","SUBTITLES"].forEach(a=>{a=this.mediaTypes_[a].groups;for(const b in a)a[b].forEach(c=>{c.playlistLoader&&c.playlistLoader.dispose()})});this.audioSegmentLoader_.dispose();this.subtitleSegmentLoader_.dispose();this.sourceUpdater_.dispose();this.timelineChangeController_.dispose();this.stopABRTimer_();this.updateDuration_&&this.mediaSource.removeEventListener("sourceopen",this.updateDuration_);this.mediaSource.removeEventListener("durationchange",this.handleDurationChange_);
this.mediaSource.removeEventListener("sourceopen",this.handleSourceOpen_);this.mediaSource.removeEventListener("sourceended",this.handleSourceEnded_);this.off()}main(){return this.mainPlaylistLoader_.main}media(){return this.mainPlaylistLoader_.media()||this.initialMedia_}areMediaTypesKnown_(){var a=!!this.mediaTypes_.AUDIO.activePlaylistLoader;const b=!!this.mainSegmentLoader_.getCurrentMediaInfo_();a=a?!!this.audioSegmentLoader_.getCurrentMediaInfo_():!0;return b&&a?!0:!1}getCodecsOrExclude_(){const a=
{main:this.mainSegmentLoader_.getCurrentMediaInfo_()||{},audio:this.audioSegmentLoader_.getCurrentMediaInfo_()||{}},b=this.mainSegmentLoader_.getPendingSegmentPlaylist()||this.media();a.video=a.main;var c=yd(this.main(),b);const e={},h=!!this.mediaTypes_.AUDIO.activePlaylistLoader;a.main.hasVideo&&(e.video=c.video||a.main.videoCodec||"avc1.4d400d");a.main.isMuxed&&(e.video+=`,${c.audio||a.main.audioCodec||"mp4a.40.2"}`);if(a.main.hasAudio&&!a.main.isMuxed||a.audio.hasAudio||h)e.audio=c.audio||a.main.audioCodec||
a.audio.audioCodec||"mp4a.40.2",a.audio.isFmp4=a.main.hasAudio&&!a.main.isMuxed?a.main.isFmp4:a.audio.isFmp4;if(e.audio||e.video){var m={},p;["video","audio"].forEach(function(t){var x;if(x=e.hasOwnProperty(t))x=e[t],x=!(a[t].isFmp4?Xd(x):Ff(x));x&&(x=a[t].isFmp4?"browser":"muxer",m[x]=m[x]||[],m[x].push(e[t]),"audio"===t&&(p=x))});if(h&&p&&b.attributes.AUDIO){const t=b.attributes.AUDIO;this.main().playlists.forEach(x=>{(x.attributes&&x.attributes.AUDIO)===t&&x!==b&&(x.excludeUntil=Infinity)});this.logger_(`excluding audio group ${t} as ${p} does not support codec(s): "${e.audio}"`)}if(Object.keys(m).length)c=
Object.keys(m).reduce((t,x)=>{t&&(t+=", ");return t+=`${x} does not support codec(s): "${m[x].join(",")}"`},"")+".",this.excludePlaylist({playlistToExclude:b,error:{internal:!0,message:c},playlistExclusionDuration:Infinity});else{if(this.sourceUpdater_.hasCreatedSourceBuffers()&&!this.sourceUpdater_.canChangeType()){const t=[];["video","audio"].forEach(x=>{const y=(vb(this.sourceUpdater_.codecs[x]||"")[0]||{}).type,C=(vb(e[x]||"")[0]||{}).type;y&&C&&y.toLowerCase()!==C.toLowerCase()&&t.push(`"${this.sourceUpdater_.codecs[x]}" -> "${e[x]}"`)});
if(t.length){this.excludePlaylist({playlistToExclude:b,error:{message:`Codec switching not supported: ${t.join(", ")}.`,internal:!0},playlistExclusionDuration:Infinity});return}}return e}}else this.excludePlaylist({playlistToExclude:b,error:{message:"Could not determine codecs for playlist."},playlistExclusionDuration:Infinity})}tryToCreateSourceBuffers_(){if("open"===this.mediaSource.readyState&&!this.sourceUpdater_.hasCreatedSourceBuffers()&&this.areMediaTypesKnown_()){var a=this.getCodecsOrExclude_();
a&&(this.sourceUpdater_.createSourceBuffers(a),a=[a.video,a.audio].filter(Boolean).join(","),this.excludeIncompatibleVariants_(a))}}excludeUnsupportedVariants_(){const a=this.main().playlists,b=[];Object.keys(a).forEach(c=>{c=a[c];if(-1===b.indexOf(c.id)){b.push(c.id);var e=yd(this.main,c),h=[];!e.audio||Ff(e.audio)||Xd(e.audio)||h.push(`audio codec ${e.audio}`);!e.video||Ff(e.video)||Xd(e.video)||h.push(`video codec ${e.video}`);e.text&&"stpp.ttml.im1t"===e.text&&h.push(`text codec ${e.text}`);h.length&&
(c.excludeUntil=Infinity,this.logger_(`excluding ${c.id} for unsupported: ${h.join(", ")}`))}})}excludeIncompatibleVariants_(a){const b=[],c=this.main().playlists;a=Me(vb(a));const e=ll(a),h=a.video&&vb(a.video)[0]||null,m=a.audio&&vb(a.audio)[0]||null;Object.keys(c).forEach(p=>{p=c[p];if(-1===b.indexOf(p.id)&&Infinity!==p.excludeUntil){b.push(p.id);var t=[],x=yd(this.mainPlaylistLoader_.main,p),y=ll(x);if(x.audio||x.video)y!==e&&t.push(`codec count "${y}" !== "${e}"`),this.sourceUpdater_.canChangeType()||
(y=x.video&&vb(x.video)[0]||null,x=x.audio&&vb(x.audio)[0]||null,y&&h&&y.type.toLowerCase()!==h.type.toLowerCase()&&t.push(`video codec "${y.type}" !== "${h.type}"`),x&&m&&x.type.toLowerCase()!==m.type.toLowerCase()&&t.push(`audio codec "${x.type}" !== "${m.type}"`)),t.length&&(p.excludeUntil=Infinity,this.logger_(`excluding ${p.id}: ${t.join(" \x26\x26 ")}`))}})}updateAdCues_(a){let b=0;const c=this.seekable();c.length&&(b=c.start(0));yq(a,this.cueTagsTrack_,b)}goalBufferLength(){const a=this.tech_.currentTime(),
b=Ca.GOAL_BUFFER_LENGTH;return Math.min(b+a*Ca.GOAL_BUFFER_LENGTH_RATE,Math.max(b,Ca.MAX_GOAL_BUFFER_LENGTH))}bufferLowWaterLine(){const a=this.tech_.currentTime(),b=Ca.BUFFER_LOW_WATER_LINE,c=Math.max(b,Ca.MAX_BUFFER_LOW_WATER_LINE),e=Math.max(b,Ca.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE);return Math.min(b+a*Ca.BUFFER_LOW_WATER_LINE_RATE,this.bufferBasedABR?e:c)}bufferHighWaterLine(){return Ca.BUFFER_HIGH_WATER_LINE}}const Qq=(a,b,c)=>e=>{const h=a.main.playlists[b],m=Ag(h),p=ve(h);if("undefined"===
typeof e)return p;e?delete h.disabled:h.disabled=!0;e===p||m||(c(),e?a.trigger("renditionenabled"):a.trigger("renditiondisabled"));return e};class Rq{constructor(a,b,c){const {playlistController_:e}=a,h=e.fastQualityChange_.bind(e);if(b.attributes){const m=b.attributes.RESOLUTION;this.width=m&&m.width;this.height=m&&m.height;this.bandwidth=b.attributes.BANDWIDTH;this.frameRate=b.attributes["FRAME-RATE"]}this.codecs=yd(e.main(),b);this.playlist=b;this.id=c;this.enabled=Qq(a.playlists,b.id,h)}}const Sq=
function(a){a.representations=()=>{var b=a.playlistController_.main();return(b=od(b)?a.playlistController_.getAudioTrackPlaylists_():b.playlists)?b.filter(c=>!Ag(c)).map((c,e)=>new Rq(a,c,c.id)):[]}},zl=["seeking","seeked","pause","playing","error"];class Tq{constructor(a){this.playlistController_=a.playlistController;this.tech_=a.tech;this.seekable=a.seekable;this.allowSeeksWithinUnsafeLiveWindow=a.allowSeeksWithinUnsafeLiveWindow;this.liveRangeSafeTimeDelta=a.liveRangeSafeTimeDelta;this.media=a.media;
this.consecutiveUpdates=0;this.checkCurrentTimeTimeout_=this.lastRecordedTime=null;this.logger_=mb("PlaybackWatcher");this.logger_("initialize");const b=()=>this.monitorCurrentTime_(),c=()=>this.monitorCurrentTime_(),e=()=>this.techWaiting_(),h=()=>this.resetTimeUpdate_(),m=this.playlistController_,p=["main","subtitle","audio"],t={};p.forEach(y=>{t[y]={reset:()=>this.resetSegmentDownloads_(y),updateend:()=>this.checkSegmentDownloads_(y)};m[`${y}SegmentLoader_`].on("appendsdone",t[y].updateend);m[`${y}SegmentLoader_`].on("playlistupdate",
t[y].reset);this.tech_.on(["seeked","seeking"],t[y].reset)});const x=y=>{["main","audio"].forEach(C=>{m[`${C}SegmentLoader_`][y]("appended",this.seekingAppendCheck_)})};this.seekingAppendCheck_=()=>{this.fixesBadSeeks_()&&(this.consecutiveUpdates=0,this.lastRecordedTime=this.tech_.currentTime(),x("off"))};this.clearSeekingAppendCheck_=()=>x("off");this.watchForBadSeeking_=()=>{this.clearSeekingAppendCheck_();x("on")};this.tech_.on("seeked",this.clearSeekingAppendCheck_);this.tech_.on("seeking",this.watchForBadSeeking_);
this.tech_.on("waiting",e);this.tech_.on(zl,h);this.tech_.on("canplay",c);this.tech_.one("play",b);this.dispose=()=>{this.clearSeekingAppendCheck_();this.logger_("dispose");this.tech_.off("waiting",e);this.tech_.off(zl,h);this.tech_.off("canplay",c);this.tech_.off("play",b);this.tech_.off("seeking",this.watchForBadSeeking_);this.tech_.off("seeked",this.clearSeekingAppendCheck_);p.forEach(y=>{m[`${y}SegmentLoader_`].off("appendsdone",t[y].updateend);m[`${y}SegmentLoader_`].off("playlistupdate",t[y].reset);
this.tech_.off(["seeked","seeking"],t[y].reset)});this.checkCurrentTimeTimeout_&&D.clearTimeout(this.checkCurrentTimeTimeout_);this.resetTimeUpdate_()}}monitorCurrentTime_(){this.checkCurrentTime_();this.checkCurrentTimeTimeout_&&D.clearTimeout(this.checkCurrentTimeTimeout_);this.checkCurrentTimeTimeout_=D.setTimeout(this.monitorCurrentTime_.bind(this),250)}resetSegmentDownloads_(a){const b=this.playlistController_[`${a}SegmentLoader_`];0<this[`${a}StalledDownloads_`]&&this.logger_(`resetting possible stalled download count for ${a} loader`);
this[`${a}StalledDownloads_`]=0;this[`${a}Buffered_`]=b.buffered_()}checkSegmentDownloads_(a){const b=this.playlistController_,c=b[`${a}SegmentLoader_`],e=c.buffered_(),h=So(this[`${a}Buffered_`],e);this[`${a}Buffered_`]=e;h?this.resetSegmentDownloads_(a):(this[`${a}StalledDownloads_`]++,this.logger_(`found #${this[`${a}StalledDownloads_`]} ${a} appends that did not increase buffer (possible stalled download)`,{playlistId:c.playlist_&&c.playlist_.id,buffered:gc(e)}),10>this[`${a}StalledDownloads_`]||
(this.logger_(`${a} loader stalled download exclusion`),this.resetSegmentDownloads_(a),this.tech_.trigger({type:"usage",name:`vhs-${a}-download-exclusion`}),"subtitle"!==a&&b.excludePlaylist({error:{message:`Excessive ${a} segment downloading detected.`},playlistExclusionDuration:Infinity})))}checkCurrentTime_(){if(!this.tech_.paused()&&!this.tech_.seeking()){var a=this.tech_.currentTime(),b=this.tech_.buffered();if(this.lastRecordedTime===a&&(!b.length||a+zb>=b.end(b.length-1)))return this.techWaiting_();
5<=this.consecutiveUpdates&&a===this.lastRecordedTime?(this.consecutiveUpdates++,this.waiting_()):a===this.lastRecordedTime?this.consecutiveUpdates++:(this.consecutiveUpdates=0,this.lastRecordedTime=a)}}resetTimeUpdate_(){this.consecutiveUpdates=0}fixesBadSeeks_(){if(!this.tech_.seeking())return!1;var a=this.seekable();const b=this.tech_.currentTime();var c;this.afterSeekableWindow_(a,b,this.media(),this.allowSeeksWithinUnsafeLiveWindow)&&(c=a.end(a.length-1));this.beforeSeekableWindow_(a,b)&&(c=
a.start(0),c+=c===a.end(0)?0:zb);if("undefined"!==typeof c)return this.logger_(`Trying to seek outside of seekable at time ${b} with `+`seekable range ${bk(a)}. Seeking to `+`${c}.`),this.tech_.setCurrentTime(c),!0;var e=this.playlistController_.sourceUpdater_;a=this.tech_.buffered();c=e.audioBuffer?e.audioBuffered():null;var h=e.videoBuffer?e.videoBuffered():null;e=this.media();e=e.partTargetDuration?e.partTargetDuration:2*(e.targetDuration-Ub);c=[c,h];for(h=0;h<c.length;h++)if(c[h]&&xg(c[h],b)<
e)return!1;a=ue(a,b);if(0===a.length)return!1;c=a.start(0)+zb;this.logger_(`Buffered region starts (${a.start(0)}) `+` just beyond seek point (${b}). Seeking to ${c}.`);this.tech_.setCurrentTime(c);return!0}waiting_(){if(!this.techWaiting_()){var a=this.tech_.currentTime(),b=this.tech_.buffered();b=Kc(b,a);b.length&&a+3<=b.end(0)&&(this.resetTimeUpdate_(),this.tech_.setCurrentTime(a),this.logger_(`Stopped at ${a} while inside a buffered region `+`[${b.start(0)} -> ${b.end(0)}]. Attempting to resume `+
"playback by seeking to the current time."),this.tech_.trigger({type:"usage",name:"vhs-unknown-waiting"}))}}techWaiting_(){var a=this.seekable();const b=this.tech_.currentTime();if(this.tech_.seeking())return!0;if(this.beforeSeekableWindow_(a,b))return a=a.end(a.length-1),this.logger_(`Fell out of live window at time ${b}. Seeking to `+`live point (seekable end) ${a}`),this.resetTimeUpdate_(),this.tech_.setCurrentTime(a),this.tech_.trigger({type:"usage",name:"vhs-live-resync"}),!0;a=this.tech_.vhs.playlistController_.sourceUpdater_;
const c=this.tech_.buffered();if(this.videoUnderflow_({audioBuffered:a.audioBuffered(),videoBuffered:a.videoBuffered(),currentTime:b}))return this.resetTimeUpdate_(),this.tech_.setCurrentTime(b),this.tech_.trigger({type:"usage",name:"vhs-video-underflow"}),!0;a=ue(c,b);return 0<a.length?(this.logger_(`Stopped at ${b} and seeking to ${a.start(0)}`),this.resetTimeUpdate_(),this.skipTheGap_(b),!0):!1}afterSeekableWindow_(a,b,c,e=!1){if(!a.length)return!1;let h=a.end(a.length-1)+zb;!c.endList&&e&&(h=
a.end(a.length-1)+3*c.targetDuration);return b>h?!0:!1}beforeSeekableWindow_(a,b){return a.length&&0<a.start(0)&&b<a.start(0)-this.liveRangeSafeTimeDelta?!0:!1}videoUnderflow_({videoBuffered:a,audioBuffered:b,currentTime:c}){if(a){var e;if(a.length&&b.length){const h=Kc(a,c-3);a=Kc(a,c);b=Kc(b,c);b.length&&!a.length&&h.length&&(e={start:h.end(0),end:b.end(0)})}else ue(a,c).length||(e=this.gapFromVideoUnderflow_(a,c));return e?(this.logger_(`Encountered a gap in video from ${e.start} to ${e.end}. `+
`Seeking to current time ${c}`),!0):!1}}skipTheGap_(a){var b=this.tech_.buffered();const c=this.tech_.currentTime();b=ue(b,c);this.resetTimeUpdate_();0!==b.length&&c===a&&(this.logger_("skipTheGap_:","currentTime:",c,"scheduled currentTime:",a,"nextRange start:",b.start(0)),this.tech_.setCurrentTime(b.start(0)+Ub),this.tech_.trigger({type:"usage",name:"vhs-gap-skip"}))}gapFromVideoUnderflow_(a,b){if(2>a.length)a=Ia();else{var c=[];for(var e=1;e<a.length;e++){var h=a.end(e-1);const m=a.start(e);c.push([h,
m])}a=Ia(c)}for(c=0;c<a.length;c++)if(e=a.start(c),h=a.end(c),4>b-e&&2<b-e)return{start:e,end:h};return null}}const Uq={errorInterval:30,getSource(a){const b=this.tech({IWillNotUseThisInPlugins:!0}).currentSource_||this.currentSource();return a(b)}},Al=function(a,b){let c=0,e=0;const h=la(Uq,b);a.ready(()=>{a.trigger({type:"usage",name:"vhs-error-reload-initialized"})});const m=function(){e&&a.currentTime(e)},p=function(y){null!==y&&void 0!==y&&(e=Infinity!==a.duration()&&a.currentTime()||0,a.one("loadedmetadata",
m),a.src(y),a.trigger({type:"usage",name:"vhs-error-reload"}),a.play())},t=function(){if(Date.now()-c<1E3*h.errorInterval)a.trigger({type:"usage",name:"vhs-error-reload-canceled"});else{if(h.getSource&&"function"===typeof h.getSource)return c=Date.now(),h.getSource.call(a,p);H.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!")}},x=function(){a.off("loadedmetadata",m);a.off("error",t);a.off("dispose",x)};a.on("error",t);a.on("dispose",x);a.reloadSourceOnError=function(y){x();
Al(a,y)}},Vq=function(a){Al(this,a)},Sa={PlaylistLoader:Mc,Playlist:Xa,utils:ep,STANDARD_PLAYLIST_SELECTOR:ol,INITIAL_PLAYLIST_SELECTOR:function(){const a=this.playlists.main.playlists.filter(Xa.isEnabled);Oc(a,(b,c)=>ah(b,c));return a.filter(b=>!!yd(this.playlists.main,b).video)[0]||null},lastBandwidthSelector:ol,movingAverageBandwidthSelector:function(a){let b=-1,c=-1;if(0>a||1<a)throw Error("Moving average bandwidth decay must be between 0 and 1.");return function(){const e=this.useDevicePixelRatio?
D.devicePixelRatio||1:1;0>b&&(c=b=this.systemBandwidth);0<this.systemBandwidth&&this.systemBandwidth!==c&&(b=a*this.systemBandwidth+(1-a)*b,c=this.systemBandwidth);return nl(this.playlists.main,b,parseInt(Oe(this.tech_.el(),"width"),10)*e,parseInt(Oe(this.tech_.el(),"height"),10)*e,this.limitRenditionByPlayerDimensions,this.playlistController_)}},comparePlaylistBandwidth:ah,comparePlaylistResolution:function(a,b){let c,e;a.attributes.RESOLUTION&&a.attributes.RESOLUTION.width&&(c=a.attributes.RESOLUTION.width);
c=c||D.Number.MAX_VALUE;b.attributes.RESOLUTION&&b.attributes.RESOLUTION.width&&(e=b.attributes.RESOLUTION.width);e=e||D.Number.MAX_VALUE;return c===e&&a.attributes.BANDWIDTH&&b.attributes.BANDWIDTH?a.attributes.BANDWIDTH-b.attributes.BANDWIDTH:c-e},xhr:sk()};Object.keys(Ca).forEach(a=>{Object.defineProperty(Sa,a,{get(){H.log.warn(`using Vhs.${a} is UNSAFE be sure you know what you are doing`);return Ca[a]},set(b){H.log.warn(`using Vhs.${a} is UNSAFE be sure you know what you are doing`);"number"!==
typeof b||0>b?H.log.warn(`value of Vhs.${a} must be greater than or equal to 0`):Ca[a]=b}})});const Bl=function(a,b){b=b.media();let c=-1;for(let e=0;e<a.length;e++)if(a[e].id===b.id){c=e;break}a.selectedIndex_=c;a.trigger({selectedIndex:c,type:"change"})},Wq=function(a,b){b.representations().forEach(c=>{a.addQualityLevel(c)});Bl(a,b.playlists)};Sa.canPlaySource=function(){return H.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")};const Xq=(a,b)=>a.reduce((c,e)=>
{if(!e.contentProtection)return c;const h=b.reduce((m,p)=>{const t=e.contentProtection[p];t&&t.pssh&&(m[p]={pssh:t.pssh});return m},{});Object.keys(h).length&&c.push(h);return c},[]),Yq=({player:a,sourceKeySystems:b,audioMedia:c,mainPlaylists:e})=>{if(!a.eme.initializeMediaKeys)return Promise.resolve();c=c?e.concat([c]):e;const h=[],m=[];Xq(c,Object.keys(b)).forEach(p=>{m.push(new Promise((t,x)=>{a.tech_.one("keysessioncreated",t)}));h.push(new Promise((t,x)=>{a.eme.initializeMediaKeys({keySystems:p},
y=>{y?x(y):t()})}))});return Promise.race([Promise.all(h),Promise.race(m)])},Zq=({player:a,sourceKeySystems:b,media:c,audioMedia:e})=>{if(b){var h={};c&&c.attributes&&c.attributes.CODECS&&(h=Me(vb(c.attributes.CODECS)));e&&e.attributes&&e.attributes.CODECS&&(h.audio=e.attributes.CODECS);e=cd(h.video);h=cd(h.audio);var m={};for(const p in b)m[p]={},h&&(m[p].audioContentType=h),e&&(m[p].videoContentType=e),c.contentProtection&&c.contentProtection[p]&&c.contentProtection[p].pssh&&(m[p].pssh=c.contentProtection[p].pssh),
"string"===typeof b[p]&&(m[p].url=b[p]);b=la(b,m)}return b?(a.currentSource().keySystems=b)&&!a.eme?(H.log.warn("DRM encrypted source cannot be decrypted without a DRM plugin"),!1):!0:!1},Cl=()=>{if(!D.localStorage)return null;const a=D.localStorage.getItem("videojs-vhs");if(!a)return null;try{return JSON.parse(a)}catch(b){return null}},$q=a=>0===a.toLowerCase().indexOf("data:application/vnd.videojs.vhs+json,")?JSON.parse(a.substring(a.indexOf(",")+1)):a;Sa.supportsNativeHls=function(){if(!P||!P.createElement)return!1;
const a=P.createElement("video");return H.getTech("Html5").isSupported()?"application/vnd.apple.mpegurl audio/mpegurl audio/x-mpegurl application/x-mpegurl video/x-mpegurl video/mpegurl application/mpegurl".split(" ").some(function(b){return/maybe|probably/i.test(a.canPlayType(b))}):!1}();var ar=P&&P.createElement&&H.getTech("Html5").isSupported()?/maybe|probably/i.test(P.createElement("video").canPlayType("application/dash+xml")):!1;Sa.supportsNativeDash=ar;Sa.supportsTypeNatively=a=>"hls"===a?Sa.supportsNativeHls:
"dash"===a?Sa.supportsNativeDash:!1;Sa.isSupported=function(){return H.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")};const br=H.getComponent("Component");class Dl extends br{constructor(a,b,c){super(b,c.vhs);"number"===typeof c.initialBandwidth&&(this.options_.bandwidth=c.initialBandwidth);this.logger_=mb("VhsHandler");b.options_&&b.options_.playerId&&(this.player_=H.getPlayer(b.options_.playerId));this.tech_=b;this.source_=a;this.stats={};this.ignoreNextSeekingEvent_=
!1;this.setOptions_();if(this.options_.overrideNative&&b.overrideNativeAudioTracks&&b.overrideNativeVideoTracks)b.overrideNativeAudioTracks(!0),b.overrideNativeVideoTracks(!0);else if(this.options_.overrideNative&&(b.featuresNativeVideoTracks||b.featuresNativeAudioTracks))throw Error("Overriding native VHS requires emulated tracks. See https://git.io/vMpjB");this.on(P,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],e=>{(e=P.fullscreenElement||P.webkitFullscreenElement||
P.mozFullScreenElement||P.msFullscreenElement)&&e.contains(this.tech_.el())?this.playlistController_.fastQualityChange_():this.playlistController_.checkABR_()});this.on(this.tech_,"seeking",function(){this.ignoreNextSeekingEvent_?this.ignoreNextSeekingEvent_=!1:this.setCurrentTime(this.tech_.currentTime())});this.on(this.tech_,"error",function(){this.tech_.error()&&this.playlistController_&&this.playlistController_.pauseLoading()});this.on(this.tech_,"play",this.play)}setOptions_(){this.options_.withCredentials=
this.options_.withCredentials||!1;this.options_.limitRenditionByPlayerDimensions=!1===this.options_.limitRenditionByPlayerDimensions?!1:!0;this.options_.useDevicePixelRatio=this.options_.useDevicePixelRatio||!1;this.options_.useBandwidthFromLocalStorage="undefined"!==typeof this.source_.useBandwidthFromLocalStorage?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1;this.options_.useNetworkInformationApi=this.options_.useNetworkInformationApi||!1;this.options_.useDtsForTimestampOffset=
this.options_.useDtsForTimestampOffset||!1;this.options_.customTagParsers=this.options_.customTagParsers||[];this.options_.customTagMappers=this.options_.customTagMappers||[];this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1;this.options_.llhls=!1===this.options_.llhls?!1:!0;this.options_.bufferBasedABR=this.options_.bufferBasedABR||!1;"number"!==typeof this.options_.playlistExclusionDuration&&(this.options_.playlistExclusionDuration=300);if("number"!==typeof this.options_.bandwidth&&
this.options_.useBandwidthFromLocalStorage){const a=Cl();a&&a.bandwidth&&(this.options_.bandwidth=a.bandwidth,this.tech_.trigger({type:"usage",name:"vhs-bandwidth-from-local-storage"}));a&&a.throughput&&(this.options_.throughput=a.throughput,this.tech_.trigger({type:"usage",name:"vhs-throughput-from-local-storage"}))}"number"!==typeof this.options_.bandwidth&&(this.options_.bandwidth=Ca.INITIAL_BANDWIDTH);this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===
Ca.INITIAL_BANDWIDTH;"withCredentials useDevicePixelRatio limitRenditionByPlayerDimensions bandwidth customTagParsers customTagMappers cacheEncryptionKeys playlistSelector initialPlaylistSelector bufferBasedABR liveRangeSafeTimeDelta llhls useNetworkInformationApi useDtsForTimestampOffset exactManifestTimings leastPixelDiffSelector".split(" ").forEach(a=>{"undefined"!==typeof this.source_[a]&&(this.options_[a]=this.source_[a])});this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions;
this.useDevicePixelRatio=this.options_.useDevicePixelRatio}src(a,b){a&&(this.setOptions_(),this.options_.src=$q(this.source_.src),this.options_.tech=this.tech_,this.options_.externVhs=Sa,this.options_.sourceType=ri(b),this.options_.seekTo=c=>{this.tech_.setCurrentTime(c)},this.playlistController_=new Pq(this.options_),a=la({liveRangeSafeTimeDelta:zb},this.options_,{seekable:()=>this.seekable(),media:()=>this.playlistController_.media(),playlistController:this.playlistController_}),this.playbackWatcher_=
new Tq(a),this.playlistController_.on("error",()=>{const c=H.players[this.tech_.options_.playerId];let e=this.playlistController_.error;"object"!==typeof e||e.code?"string"===typeof e&&(e={message:e,code:3}):e.code=3;c.error(e)}),a=this.options_.bufferBasedABR?Sa.movingAverageBandwidthSelector(.55):Sa.STANDARD_PLAYLIST_SELECTOR,this.playlistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):a.bind(this),this.playlistController_.selectInitialPlaylist=Sa.INITIAL_PLAYLIST_SELECTOR.bind(this),
this.playlists=this.playlistController_.mainPlaylistLoader_,this.mediaSource=this.playlistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get(){return this.playlistController_.selectPlaylist},set(c){this.playlistController_.selectPlaylist=c.bind(this)}},throughput:{get(){return this.playlistController_.mainSegmentLoader_.throughput.rate},set(c){this.playlistController_.mainSegmentLoader_.throughput.rate=c;this.playlistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get(){let c=
this.playlistController_.mainSegmentLoader_.bandwidth;var e=D.navigator.connection||D.navigator.mozConnection||D.navigator.webkitConnection;this.options_.useNetworkInformationApi&&e&&(e=1E6*e.downlink,c=1E7<=e&&1E7<=c?Math.max(c,e):e);return c},set(c){this.playlistController_.mainSegmentLoader_.bandwidth=c;this.playlistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get(){return Math.floor(1/(1/(this.bandwidth||1)+(0<this.throughput?1/this.throughput:0)))},set(){H.log.error('The "systemBandwidth" property is read-only')}}}),
this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{bandwidth:{get:()=>this.bandwidth||0,enumerable:!0},mediaRequests:{get:()=>this.playlistController_.mediaRequests_()||0,enumerable:!0},mediaRequestsAborted:{get:()=>this.playlistController_.mediaRequestsAborted_()||0,enumerable:!0},mediaRequestsTimedout:{get:()=>this.playlistController_.mediaRequestsTimedout_()||0,enumerable:!0},
mediaRequestsErrored:{get:()=>this.playlistController_.mediaRequestsErrored_()||0,enumerable:!0},mediaTransferDuration:{get:()=>this.playlistController_.mediaTransferDuration_()||0,enumerable:!0},mediaBytesTransferred:{get:()=>this.playlistController_.mediaBytesTransferred_()||0,enumerable:!0},mediaSecondsLoaded:{get:()=>this.playlistController_.mediaSecondsLoaded_()||0,enumerable:!0},mediaAppends:{get:()=>this.playlistController_.mediaAppends_()||0,enumerable:!0},mainAppendsToLoadedData:{get:()=>
this.playlistController_.mainAppendsToLoadedData_()||0,enumerable:!0},audioAppendsToLoadedData:{get:()=>this.playlistController_.audioAppendsToLoadedData_()||0,enumerable:!0},appendsToLoadedData:{get:()=>this.playlistController_.appendsToLoadedData_()||0,enumerable:!0},timeToLoadedData:{get:()=>this.playlistController_.timeToLoadedData_()||0,enumerable:!0},buffered:{get:()=>gc(this.tech_.buffered()),enumerable:!0},currentTime:{get:()=>this.tech_.currentTime(),enumerable:!0},currentSource:{get:()=>
this.tech_.currentSource_,enumerable:!0},currentTech:{get:()=>this.tech_.name_,enumerable:!0},duration:{get:()=>this.tech_.duration(),enumerable:!0},main:{get:()=>this.playlists.main,enumerable:!0},playerDimensions:{get:()=>this.tech_.currentDimensions(),enumerable:!0},seekable:{get:()=>gc(this.tech_.seekable()),enumerable:!0},timestamp:{get:()=>Date.now(),enumerable:!0},videoPlaybackQuality:{get:()=>this.tech_.getVideoPlaybackQuality(),enumerable:!0}}),this.tech_.one("canplay",this.playlistController_.setupFirstPlay.bind(this.playlistController_)),
this.tech_.on("bandwidthupdate",()=>{if(this.options_.useBandwidthFromLocalStorage){var c={bandwidth:this.bandwidth,throughput:Math.round(this.throughput)};if(D.localStorage){var e=Cl();e=e?la(e,c):c;try{D.localStorage.setItem("videojs-vhs",JSON.stringify(e))}catch(h){}}}}),this.playlistController_.on("selectedinitialmedia",()=>{Sq(this)}),this.playlistController_.sourceUpdater_.on("createdsourcebuffers",()=>{this.setupEme_()}),this.on(this.playlistController_,"progress",function(){this.tech_.trigger("progress")}),
this.on(this.playlistController_,"firstplay",function(){this.ignoreNextSeekingEvent_=!0}),this.setupQualityLevels_(),this.tech_.el()&&(this.mediaSourceUrl_=D.URL.createObjectURL(this.playlistController_.mediaSource),this.tech_.src(this.mediaSourceUrl_)))}createKeySessions_(){const a=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader;this.logger_("waiting for EME key session creation");Yq({player:this.player_,sourceKeySystems:this.source_.keySystems,audioMedia:a&&a.media(),mainPlaylists:this.playlists.main.playlists}).then(()=>
{this.logger_("created EME key session");this.playlistController_.sourceUpdater_.initializedEme()}).catch(b=>{this.logger_("error while creating EME key session",b);this.player_.error({message:"Failed to initialize media keys for EME",code:3})})}handleWaitingForKey_(){this.logger_("waitingforkey fired, attempting to create any new key sessions");this.createKeySessions_()}setupEme_(){var a=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader;a=Zq({player:this.player_,sourceKeySystems:this.source_.keySystems,
media:this.playlists.media(),audioMedia:a&&a.media()});this.player_.tech_.on("keystatuschange",b=>{if("output-restricted"===b.status&&(b=this.playlistController_.main())&&b.playlists){var c=[];b.playlists.forEach(e=>{e&&e.attributes&&e.attributes.RESOLUTION&&720<=e.attributes.RESOLUTION.height&&(!e.excludeUntil||Infinity>e.excludeUntil)&&(e.excludeUntil=Infinity,c.push(e))});c.length&&(H.log.warn('DRM keystatus changed to "output-restricted." Removing the following HD playlists that will most likely fail to play and clearing the buffer. This may be due to HDCP restrictions on the stream and the capabilities of the current device.',
...c),this.playlistController_.fastQualityChange_())}});this.handleWaitingForKey_=this.handleWaitingForKey_.bind(this);this.player_.tech_.on("waitingforkey",this.handleWaitingForKey_);11!==H.browser.IE_VERSION&&a?this.createKeySessions_():this.playlistController_.sourceUpdater_.initializedEme()}setupQualityLevels_(){const a=H.players[this.tech_.options_.playerId];a&&a.qualityLevels&&!this.qualityLevels_&&(this.qualityLevels_=a.qualityLevels(),this.playlistController_.on("selectedinitialmedia",()=>
{Wq(this.qualityLevels_,this)}),this.playlists.on("mediachange",()=>{Bl(this.qualityLevels_,this.playlists)}))}static version(){return{"@videojs/http-streaming":"3.0.2","mux.js":"6.3.0","mpd-parser":"1.0.1","m3u8-parser":"6.0.0","aes-decrypter":"4.0.1"}}version(){return this.constructor.version()}canChangeType(){return ul.canChangeType()}play(){this.playlistController_.play()}setCurrentTime(a){this.playlistController_.setCurrentTime(a)}duration(){return this.playlistController_.duration()}seekable(){return this.playlistController_.seekable()}dispose(){this.playbackWatcher_&&
this.playbackWatcher_.dispose();this.playlistController_&&this.playlistController_.dispose();this.qualityLevels_&&this.qualityLevels_.dispose();this.tech_&&this.tech_.vhs&&delete this.tech_.vhs;this.mediaSourceUrl_&&D.URL.revokeObjectURL&&(D.URL.revokeObjectURL(this.mediaSourceUrl_),this.mediaSourceUrl_=null);this.tech_&&this.tech_.off("waitingforkey",this.handleWaitingForKey_);super.dispose()}convertToProgramTime(a,b){return jp({playlist:this.playlistController_.media(),time:a,callback:b})}seekToProgramTime(a,
b,c=!0,e=2){return vk({programTime:a,playlist:this.playlistController_.media(),retryCount:e,pauseAfterSeek:c,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:b})}}const Se={name:"videojs-http-streaming",VERSION:"3.0.2",canHandleSource(a,b={}){b=la(H.options,b);return Se.canPlayType(a.type,b)},handleSource(a,b,c={}){c=la(H.options,c);b.vhs=new Dl(a,b,c);b.vhs.xhr=sk();b.vhs.src(a.src,a.type);return b.vhs},canPlayType(a,b){a=ri(a);if(!a)return"";b=Se.getOverrideNative(b);return!Sa.supportsTypeNatively(a)||
b?"maybe":""},getOverrideNative(a={}){({vhs:a={}}=a);const b=!(H.browser.IS_ANY_SAFARI||H.browser.IS_IOS);({overrideNative:a=b}=a);return a}};Xd("avc1.4d400d,mp4a.40.2")&&H.getTech("Html5").registerSourceHandler(Se,0);H.VhsHandler=Dl;H.VhsSourceHandler=Se;H.Vhs=Sa;H.use||H.registerComponent("Vhs",Sa);H.options.vhs=H.options.vhs||{};H.getPlugin&&H.getPlugin("reloadSourceOnError")||H.registerPlugin("reloadSourceOnError",Vq);let xa=function(a){function b(){var e=a.call(this)||this;e._defaultConfigs=
{autoplay:!1,fluid:!1,fullscreen:!1,loop:!1,muted:!1,preload:"auto",responsive:!1,startTime:0};e.cameraSensorModel=null;e.currentMetadata=null;e.element=null;e.state="not-ready";e.waitingTimestamp=null;e._initController=()=>{!e._controller&&e.sourceUrl&&(e.element=document.createElement("video"),e._controller=H(e.element,e._defaultConfigs),e._controller.muted(e.muted),e._controller.loop(e.loop),e._controller.playbackRate(e.rate),e.addHandles([e._controller.ready(e._handleReady),e._controller.on("canplay",
e._handleCanPlay),e._controller.on("durationchange",e._handleDurationChange),e._controller.on("ended",e._handleEnded),e._controller.on("error",e._handleError),e._controller.on("loadeddata",e._handleDataLoaded),e._controller.on("loadedmetadata",e._handleLoadedMetadata),e._controller.on("loadstart",e._handleLoadStart),e._controller.on("play",e._handlePlay),e._controller.on("timeupdate",e._handleTimeUpdate),e._controller.on("waiting",e._handleWaiting)]))};e._handleReady=()=>{e.state="ready"};e._handleCanPlay=
()=>e.state="can-play";e._handleCueChange=()=>{if(e.subtitleTrack?.activeCues?.length){var h=e.subtitleTrack?.activeCues[0];h=(h.text?JSON.parse(h.text):null)?.Data[0]?.Value;if(h.length){var m=new Map;for(const p of h)Array.isArray(p.Value)?p.Value.forEach(t=>{m.set(t.TagUID,t)}):m.set(p.TagUID,p);m.set(Bd.VideoMetadataEntryId.EsriVideoWidth,{Name:"Video Width",TagUID:Bd.VideoMetadataEntryId.EsriVideoWidth,Value:e._controller.videoWidth()});m.set(Bd.VideoMetadataEntryId.EsriVideoHeight,{Name:"Video Height",
TagUID:Bd.VideoMetadataEntryId.EsriVideoHeight,Value:e._controller.videoHeight()});e.currentMetadata=new Map(m);e.cameraSensorModel=new Il({videoMetadata:e.currentMetadata})}}};e._handleDataLoaded=()=>{};e._handleDurationChange=()=>e.notifyChange("duration");e._handleEnded=()=>{e.loop?(e.setCurrentTime(0),e.play()):(e._set("ended",!0),e.notifyChange("buffered"),e.notifyChange("currentTime"),e.notifyChange("duration"),e.notifyChange("waiting"),e.state="can-play")};e._handleError=()=>{Fl.getLogger(Te._assertThisInitialized(e)).error("video stream error ::",
e._controller?.error())};e._handleLoadStart=()=>{e.state="can-play"};e._handleLoadedMetadata=()=>{e.notifyChange("subtitleTrack");e.notifyChange("buffered")};e._handlePlay=()=>e.notifyChange("ended");e._handleTimeUpdate=()=>{e.notifyChange("currentTime");e.notifyChange("buffered");e.notifyChange("bufferedPercent")};e._handleWaiting=()=>e.waitingTimestamp=e._controller?.currentTime();return e}Te._inherits(b,a);var c=b.prototype;c.initialize=function(){this.addHandles([Ad.watch(()=>this.sourceUrl,e=>
{e&&(this._initController(),this._controller.src({type:"application/x-mpegURL",src:this.sourceUrl}))},Ad.initial),Ad.watch(()=>this.subtitleTrack,()=>{this.subtitleTrack&&(this.subtitleTrack.mode="showing")})]);this.addHandles(Ad.on(()=>this.subtitleTrack,"cuechange",this._handleCueChange))};c.destroy=function(){this._controller&&this._controller.dispose()};c.pause=function(){this._controller?.pause();this.state="paused"};c.play=function(){this._controller?.play();this.state="playing"};c.reset=function(){this._controller&&
(this.pause(),this.setCurrentTime(0),this._set("ended",!0))};c.setCurrentTime=function(e){e=Gl.clamp(e,0,this.duration);this._controller?.currentTime(e);this.notifyChange("currentTime")};Te._createClass(b,[{key:"buffered",get:function(){return this._controller?.bufferedEnd()??0}},{key:"bufferedPercent",get:function(){return this._controller?.bufferedPercent()??0}},{key:"currentTime",get:function(){return this._controller?.currentTime()??0}},{key:"duration",get:function(){return this._controller?.duration()??
0}},{key:"ended",get:function(){return this._controller?.ended()??this._get("ended")??!0},set:function(e){this._controller?.ended(e);this._set("ended",e)}},{key:"loop",get:function(){return this._controller?.loop()??this._get("loop")??!1},set:function(e){this._controller?.loop(e);this._set("loop",e)}},{key:"muted",get:function(){return this._controller?.muted()??this._get("muted")??!1},set:function(e){this._controller?.muted(e);this._set("muted",e)}},{key:"rate",get:function(){return this._controller?.playbackRate()??
this._get("rate")??1},set:function(e){this._controller?.playbackRate(e);this._set("rate",e)}},{key:"sourceUrl",get:function(){return this._controller?.src()},set:function(e){this._set("sourceUrl",e)}},{key:"started",get:function(){return this._controller?.hasStarted()}},{key:"subtitleTrack",get:function(){const e=this._controller?.textTracks();return e?.length?Array.from(e).find(h=>"subtitles"===h.kind):null}},{key:"waiting",get:function(){return this.waitingTimestamp?!1:this.waitingTimestamp!==this.currentTime?
(this.waitingTimestamp=null,!1):!0}}]);return b}(El);ya.__decorate([Ea.property()],xa.prototype,"buffered",null);ya.__decorate([Ea.property()],xa.prototype,"bufferedPercent",null);ya.__decorate([Ea.property()],xa.prototype,"cameraSensorModel",void 0);ya.__decorate([Ea.property({readOnly:!0})],xa.prototype,"currentTime",null);ya.__decorate([Ea.property()],xa.prototype,"currentMetadata",void 0);ya.__decorate([Ea.property({readOnly:!0})],xa.prototype,"duration",null);ya.__decorate([Ea.property()],xa.prototype,
"element",void 0);ya.__decorate([Ea.property({readOnly:!0})],xa.prototype,"ended",null);ya.__decorate([Ea.property()],xa.prototype,"loop",null);ya.__decorate([Ea.property()],xa.prototype,"muted",null);ya.__decorate([Ea.property()],xa.prototype,"rate",null);ya.__decorate([Ea.property()],xa.prototype,"sourceUrl",null);ya.__decorate([Ea.property({readOnly:!0})],xa.prototype,"started",null);ya.__decorate([Ea.property()],xa.prototype,"state",void 0);ya.__decorate([Ea.property()],xa.prototype,"subtitleTrack",
null);ya.__decorate([Ea.property({readOnly:!0})],xa.prototype,"waiting",null);ya.__decorate([Ea.property()],xa.prototype,"waitingTimestamp",void 0);return xa=ya.__decorate([Hl.subclass("esri.layers.video.VideoController")],xa)});
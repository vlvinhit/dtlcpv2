// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../geometry ../../../core/arrayUtils ../../../core/Error ../../../core/unitUtils ../../../chunks/pe ../../../geometry/projection ../../../geometry/Extent ../../../geometry/Point ../../../geometry/Polygon ../../../geometry/SpatialReference".split(" "),function(y,ya,la,ma,I,x,A,M,B,Y,na){function O(a,b,c){return!A.canProjectWithoutEngine(a,b,c)}function G(a,b,c){if((a=O(a,b,c))&&!A.isLoaded())throw new ma("rasterprojectionhelper-project","projection engine is not loaded");return a}
function P(a,b,c,f=null){const k=a.spatialReference;if(k.equals(b))return a;G(k,b,f);c=c.center;c=new M({xmin:c.x-a.x/2,xmax:c.x+a.x/2,ymin:c.y-a.y/2,ymax:c.y+a.y/2,spatialReference:k});f=A.project(c,b,f);c=E(b);null==f||null!=c&&f.width>=c?(b=I.getMetersPerUnitForSR(k)/I.getMetersPerUnitForSR(b),a={x:a.x*b,y:a.y*b}):a={x:f.width,y:f.height};return a}function C(a,b=.01){return I.getMetersPerUnitForSR(a)?b/I.getMetersPerUnitForSR(a):0}function Q(a,b,c=null,f=!0){const k=a.spatialReference;if(k.equals(b))return a;
G(k,b,c);c=A.project(a,b,c);if(!f||!c)return c;Z([a],[c],k,b);return c}function Z(a,b,c,f){const k=N(c,!0),d=N(f,!0);c=C(c,500);f=C(f,500);if(c&&null!=k&&null!=d)for(let g=0;g<a.length;g++){const h=b[g];if(!h)continue;const {x:e}=a[g],{x:m}=h;m>=d[1]-f&&Math.abs(e-k[0])<c?h.x-=d[1]-d[0]:m<=d[0]+f&&Math.abs(e-k[1])<c&&(h.x+=d[1]-d[0])}}function aa(a){const {inSR:b,outSR:c,datumTransformation:f,preferPE:k}=a;if(b.equals(c))return{points:a}=R(a,null),a;if(b.isWebMercator&&c.isWGS84||b.isWGS84&&c.isWebMercator){const {cols:e,
rows:m,xres:l,yres:q,usePixelCenter:p,inSR:n,outSR:t}=a;let {xmin:u,ymax:v}=a;p&&(u+=l/2,v-=q/2);a=[];const r=[];var d=Math.max(e,m);for(var g=0;g<d;g++){var h=A.project(new B({x:u+l*Math.min(e,g),y:v-q*Math.min(m,g),spatialReference:n}),t);g<=e&&a.push(h.x);g<=m&&r.push(h.y)}d=[];for(g=0;g<e;g++)for(h=0;h<m;h++)d.push([a[g],r[h]]);return d}return G(b,c,f)&&k&&(b.isGeographic||null!=H(b))?oa(a):pa(a)}function pa(a){var {points:b}=R(a,null);const {inSR:c,outSR:f,datumTransformation:k}=a;a=b.map(d=>
new B(d[0],d[1],c));b=A.project(a,f,k);k&&Z(a,b,c,f);return b.map(d=>d?[d.x,d.y]:[NaN,NaN])}function oa(a){const {inSR:b,outSR:c,datumTransformation:f}=a;var k=H(b);const {points:d,mask:g}=R(a,k);b.isGeographic||(a=b.wkid?x.PeFactory.coordsys(b.wkid):x.PeFactory.fromString(b.isGeographic?x.PeDefs.PE_TYPE_GEOGCS:x.PeDefs.PE_TYPE_PROJCS,b.wkt),x.PeCSTransformations.projToGeog(a,d.length,d));if(null!=f&&f.steps.length){var h;c.isGeographic&&(h=d.map(([e])=>179.9955<e?1:-179.9955>e?-1:0));f.steps.forEach(e=>
{const m=e.wkid?x.PeFactory.geogtran(e.wkid):x.PeFactory.fromString(x.PeDefs.PE_TYPE_GEOGTRAN,e.wkt);x.PeGTTransformations.geogToGeog(m,d.length,d,null,e.isInverse?x.PeDefs.PE_TRANSFORM_2_TO_1:x.PeDefs.PE_TRANSFORM_1_TO_2)});if(h)for(a=0;a<d.length;a++){k=h[a];const e=d[a][0],m=179.9955<e?1:-179.9955>e?-1:0;k&&m&&k!==m&&(d[a][0]=0<k?e+360:e-360)}}c.isGeographic||(h=H(c,!0),qa(d,null!=h&&h.isEnvelope?[h.bbox[1],h.bbox[3]]:[-90,90]),h=c.wkid?x.PeFactory.coordsys(c.wkid):x.PeFactory.fromString(c.isGeographic?
x.PeDefs.PE_TYPE_GEOGCS:x.PeDefs.PE_TYPE_PROJCS,c.wkt),x.PeCSTransformations.geogToProj(h,d.length,d));h=d;if(g&&d.length!==g.length){h=[];for(let e=0,m=0;e<g.length;e++)g[e]?h.push(d[m++]):h.push([NaN,NaN])}return h}function H(a,b=!1){var c=a.wkid||a.wkt;if(!c||a.isGeographic)return null;c=String(c);if(S.has(c))return c=S.get(c),b?c?.gcs:c?.pcs;var f=a.wkid?x.PeFactory.coordsys(a.wkid):x.PeFactory.fromString(a.isGeographic?x.PeDefs.PE_TYPE_GEOGCS:x.PeDefs.PE_TYPE_PROJCS,a.wkt);a=C(a,1E-4);a=ba(f,
a);f=ba(f,0,!0);S.set(c,{pcs:a,gcs:f});return b?f:a}function ba(a,b=0,c=!1){var f=x.PePCSInfo.generate(a),k=c?a.horizonGcsGenerate():a.horizonPcsGenerate();if(!f||!k?.length)return null;a=!1;var d=k.find(l=>1===l.getInclusive()&&1===l.getKind());if(!d){d=k.find(l=>1===l.getInclusive()&&0===l.getKind());if(!d)return null;a=!0}c=c?0:(2===f.getNorthPoleLocation()?1:0)|(2===f.getSouthPoleLocation()?2:0);f=f.isPannableRectangle();d=d.getCoord();if(a)return{isEnvelope:a,isPannable:f,vertices:d,coef:null,
bbox:[d[0][0]-b,d[0][1]-b,d[1][0]+b,d[1][1]+b],poleLocation:c};b=0;a=[];let [g,h]=d[0],[e,m]=d[0];for(let l=0,q=d.length;l<q;l++){b++;b===q&&(b=0);const [p,n]=d[l],[t,u]=d[b];if(u===n)a.push([p,t,n,u,2]);else{k=(t-p)/(u-n||1E-4);const v=p-k*n;n<u?a.push([k,v,n,u,0]):a.push([k,v,u,n,1])}g=g<p?g:p;h=h<n?h:n;e=e>p?e:p;m=m>n?m:n}return{isEnvelope:!1,isPannable:f,vertices:d,coef:a,bbox:[g,h,e,m],poleLocation:c}}function R(a,b){const c=[],{cols:f,rows:k,xres:d,yres:g,usePixelCenter:h}=a;let {xmin:e,ymax:m}=
a;h&&(e+=d/2,m-=g/2);if(null==b){for(a=0;a<f;a++)for(b=0;b<k;b++)c.push([e+d*a,m-g*b]);return{points:c}}a=new Uint8Array(f*k);if(b.isEnvelope){const {bbox:[v,r,z,D]}=b;for(let F=0,J=0;F<f;F++){var l=e+d*F,q=b.isPannable||l>=v&&l<=z;for(var p=0;p<k;p++,J++){var n=m-g*p;q&&n>=r&&n<=D&&(c.push([l,n]),a[J]=1)}}return{points:c,mask:a}}l=b.coef;b=[];for(q=0;q<k;q++){var t=m-g*q;p=[];n=[];for(var u=0;u<l.length;u++){const [v,r,z,D,F]=l[u];t===z&&z===D?(p.push(v),p.push(r),n.push(2),n.push(2)):t>=z&&t<=D&&
(p.push(v*t+r),n.push(F))}t=p;if(2<p.length){u=2===n[0]?0:n[0];let v=p[0];t=[];for(let r=1;r<n.length;r++)if(2!==n[r]||r===n.length-1)n[r]!==u&&(t.push(0===u?Math.min(v,p[r-1]):Math.max(v,p[r-1])),u=n[r],v=p[r]),r===n.length-1&&t.push(0===n[r]?Math.min(v,p[r]):Math.max(v,p[r]));t.sort((r,z)=>r-z)}else p[0]>p[1]&&(t=[p[1],p[0]]);b.push(t)}for(let v=0,r=0;v<f;v++)for(l=e+d*v,q=0;q<k;q++,r++)if(p=m-g*q,n=b[q],2===n.length)l>=n[0]&&l<=n[1]&&(c.push([l,p]),a[r]=1);else if(2<n.length){t=!1;for(u=0;u<n.length;u+=
2)if(l>=n[u]&&l<=n[u+1]){t=!0;break}t&&(c.push([l,p]),a[r]=1)}return{points:c,mask:a}}function qa(a,b){const [c,f]=b;for(b=0;b<a.length;b++){const k=a[b][1];if(k<c||k>f)a[b]=[NaN,NaN]}}function ca(a){const b=E(a[0].spatialReference);if(2>a.length||null==b)return a[0];const c=C(a[0].spatialReference);a=a.filter(h=>h.width>c);if(1===a.length)return a[0];let {xmin:f,xmax:k,ymin:d,ymax:g}=a[0];for(let h=1;h<a.length;h++){const e=a[h];k=e.xmax+b*h;d=Math.min(d,e.ymin);g=Math.max(g,e.ymax)}return new M({xmin:f,
xmax:k,ymin:d,ymax:g,spatialReference:a[0].spatialReference})}function T(a,b,c=null,f=!0){var k=a.spatialReference;if(k.equals(b))return a;var d=da(a);const g=E(k,!0);var h=E(b);if(0===d||null==g||null==h)return d=ea(a,b,c,f),null==g&&null!=h&&Math.abs(d.width-h)<C(b)&&A.isLoaded()&&(k=H(k),null!=k&&k.poleLocation===U.None&&a.width<(k.bbox[2]-k.bbox[0])/2)?ra(a,b)||d:d;h=a.clone().normalize();if(1===h.length&&a.xmax<g&&a.xmax-g/2>C(k)){const {xmin:e,xmax:m}=a;for(let l=0;l<=d;l++)h[l]=new M({xmin:0===
l?e:-g/2,xmax:l===d?m-g*l:g/2,ymin:a.ymin,ymax:a.ymax,spatialReference:k})}a=h.map(e=>ea(e,b,c,f));return ca(a.filter(la.isSome))}function ra(a,b){const c=E(b);if(null==c)return null;let {xmin:f,ymin:k,xmax:d,ymax:g}=a;var h=a.spatialReference;a=new Y({spatialReference:h,rings:[[[f,k],[d,k],[d,g],[f,g],[f,k]]]});a=A.project(a,b);if(2!==a.rings.length||!a.rings[0].length||!a.rings[1].length)return null;({rings:a}=a);h=C(h);b=new M({spatialReference:b});for(let e=0;2>e;e++){f=d=a[e][0][0];k=g=a[e][0][1];
for(let m=0;m<a[e].length;m++)f=f>a[e][m][0]?a[e][m][0]:f,d=d<a[e][m][0]?a[e][m][0]:d,k=k>a[e][m][1]?a[e][m][1]:k,g=g<a[e][m][1]?a[e][m][1]:g;if(0===e)b.ymin=k,b.ymax=g,b.xmin=f,b.xmax=d;else if(b.ymin=Math.min(b.ymin,k),b.ymax=Math.max(b.ymax,g),Math.abs(d-c/2)<h)b.xmin=f,b.xmax+=c;else if(Math.abs(f+c/2)<h)b.xmax=d+c;else return null}return b}function ea(a,b,c=null,f=!0,k=!0){const d=a.spatialReference;if(d.equals(b)||!b)return a;G(d,b,c);const g=A.project(a,b,c);if(k&&b.isWebMercator&&g&&(g.ymax=
Math.min(2.0037508342787E7,g.ymax),g.ymin=Math.max(-2.0037508342787E7,g.ymin),g.ymin>=g.ymax))return null;if(!f||!g)return g;var h=N(d,!0);f=N(b,!0);if(null==h||null==f)return g;k=C(d,.001);const e=C(d,500);var m=C(b,.001);if(Math.abs(g.xmin-f[0])<m&&Math.abs(g.xmax-f[1])<m){m=Math.abs(a.xmin-h[0]);h=Math.abs(h[1]-a.xmax);if(m<k&&h>e){g.xmin=f[0];var l=[];l.push(new B(a.xmax,a.ymin,d));l.push(new B(a.xmax,(a.ymin+a.ymax)/2,d));l.push(new B(a.xmax,a.ymax,d));l=l.map(q=>Q(q,b,c)).filter(q=>!isNaN(q?.x)).map(q=>
q.x);g.xmax=Math.max.apply(null,l)}h<k&&m>e&&(g.xmax=f[1],f=[],f.push(new B(a.xmin,a.ymin,d)),f.push(new B(a.xmin,(a.ymin+a.ymax)/2,d)),f.push(new B(a.xmin,a.ymax,d)),a=f.map(q=>Q(q,b,c)).filter(q=>!isNaN(q?.x)).map(q=>q.x),g.xmin=Math.min.apply(null,a))}else a=C(b,.001),Math.abs(g.xmin-f[0])<a&&(g.xmin=f[0]),Math.abs(g.xmax-f[1])<a&&(g.xmax=f[1]);return g}function E(a,b=!1){return a?a.isWebMercator?2*(b?2.0037508342787E7:2.0037508342788905E7):a.wkid&&a.isGeographic?360:2*sa[a.wkid]||null:null}function N(a,
b=!1){if(a.isGeographic)return[-180,180];a=E(a,b);return null!=a?[-a/2,a/2]:null}function fa(a,b,c,f){a=(a-b)/c;0!==a-Math.floor(a)?a=Math.floor(a):f&&--a;return a}function da(a,b=!1){var c=E(a.spatialReference);if(null==c)return 0;const f=b?0:-(c/2),k=C(a.spatialReference),d=!b&&Math.abs(a.xmin+c/2)<k?-c/2:a.xmin;a=fa(!b&&Math.abs(a.xmax-c/2)<k?c/2:a.xmax,f,c,!0);c=fa(d,f,c,!1);return a-c}function V(a){const {projectedExtent:b,srcBufferExtent:c,pixelSize:f,datumTransformation:k,rasterTransform:d}=
a;var g=b.spatialReference;const h=c.spatialReference;var e=G(g,h);const {xmin:m,ymin:l,xmax:q,ymax:p}=b,n=E(h),t=null!=n&&(a.hasWrapAround||"gcs-shift"===d?.type);a=a.spacing||[32,32];var u=a[0]*f.x,v=a[1]*f.y;const r=1===a[0],z=Math.ceil((q-m)/u-.1/a[0])+(r?0:1),D=Math.ceil((p-l)/v-.1/a[1])+(r?0:1);u=aa({cols:z,rows:D,xmin:m,ymax:p,xres:u,yres:v,inSR:g,outSR:h,datumTransformation:k,preferPE:4>=a[0],usePixelCenter:r});v=[];let F,J=0;const ha=r?-1:NaN,{xmin:ia,xmax:W,ymax:ta,width:ua,height:va}=c,
wa=C(h,500),xa=null!=n&&0<ia&&W>n/2;var K=!1;e&&(K=H(g),K=null!=K&&0<K.poleLocation);for(g=0;g<z;g++){e=[];for(let L=0;L<D;L++){var w=u[g*D+L];t&&w[0]>W&&w[0]>n/2-wa?w[0]-=n:t&&0===g&&0>w[0]&&xa&&!d&&(w[0]+=n);!w||isNaN(w[0])||isNaN(w[1])?(v.push(ha),v.push(ha),e.push(null),J++):(d&&(w=d.inverseTransform(new B({x:w[0],y:w[1],spatialReference:h})),w=[w.x,w.y]),e.push(w),0<g&&t&&F[L]&&w[0]<F[L][0]&&(w[0]+=n,K&&w[0]>W&&w[0]>n&&(w[0]-=n)),v.push((w[0]-ia)/ua),v.push((ta-w[1])/va))}F=e}return{offsets:v,
error:null,coefficients:null,outofBoundPointCount:J,spacing:a,size:r?[z,D]:[z-1,D-1]}}function ja(a,b,c){const {cols:f,rows:k}=b;b=new Float32Array((f-1)*(k-1)*12);const d=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),g=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let p=0;p<f-1;p++){for(var h=0;h<k-1;h++){var e=p*k*2+2*h,m=a[e];const n=a[e+1];var l=a[e+2],q=a[e+3];e+=2*k;const t=a[e],u=a[e+1],v=a[e+2];e=a[e+3];let r=0,z=12*(h*(f-1)+p);for(let D=0;3>D;D++)b[z++]=d[r++]*m+d[r++]*l+d[r++]*v;r=0;for(l=0;3>
l;l++)b[z++]=d[r++]*n+d[r++]*q+d[r++]*e;r=0;for(q=0;3>q;q++)b[z++]=g[r++]*m+g[r++]*t+g[r++]*v;r=0;for(m=0;3>m;m++)b[z++]=g[r++]*n+g[r++]*u+g[r++]*e}if(c)for(h=0;h<b.length;h++)isNaN(b[h])&&(b[h]=-1)}return b}var U;(function(a){a[a.None=0]="None";a[a.North=1]="North";a[a.South=2]="South";a[a.Both=3]="Both"})(U||(U={}));const ka=(a,b,c,f=0)=>{if(1===c[0])return[0,0];var k=1,d=-1,g=1,h=-1;for(var e=0;e<a.length;e+=2)isNaN(a[e])||(k=k>a[e]?a[e]:k,d=d>a[e]?d:a[e],g=g>a[e+1]?a[e+1]:g,h=h>a[e+1]?h:a[e+1]);
const {cols:m,rows:l}=b;b=(d-k)/m/c[0];c=(h-g)/l/c[1];f*=2;g=0;h=!1;k=[0,0];for(d=0;d<m-3;d++){for(e=0;e<l-3;e++){var q=d*l*2+2*e;const p=Math.abs(((a[q]+a[q+4]+a[q+4*l]+a[q+4*l+4])/4-a[q+2*l+2])/b);q=Math.abs(((a[q+1]+a[q+5]+a[q+4*l+1]+a[q+4*l+5])/4-a[q+2*l+3])/c);p+q>g&&(g=p+q,k=[p,q]);if(f&&g>f){h=!0;break}}if(h)break}return k},sa={3395:2.0037508342789244E7,3410:1.7334193943686873E7,3857:2.0037508342788905E7,3975:1.7367530445161372E7,4087:2.0037508342789244E7,4088:2.0015108787169147E7,6933:1.7367530445161372E7,
32662:2.0037508342789244E7,53001:2.001508679602057E7,53002:1.000754339801029E7,53003:2.001508679602057E7,53004:2.001508679602057E7,53016:1.4152803599503474E7,53017:1.7333573624304302E7,53034:2.001508679602057E7,53079:2.0015114352186374E7,53080:2.0015114352186374E7,54001:2.0037508342789244E7,54002:1.0018754171394624E7,54003:2.0037508342789244E7,54004:2.0037508342789244E7,54016:1.4168658027268292E7,54017:1.736753044516137E7,54034:2.0037508342789244E7,54079:2.0037508342789244E7,54080:2.0037508342789244E7,
54100:2.0037508342789244E7,54101:2.0037508342789244E7},S=new Map,X=new Map;y.computeProjectedScales=function(a,b,c){var f=c?.tileSize??512,k=c?.alignGlobalDatasetWithAGOL??!0,d=!!c?.limitToSrcResolution;const {extent:g,spatialReference:h,pixelSize:e}=a;c=P(new B({x:e.x,y:e.y,spatialReference:h}),b,g);if(null==c)return{projectedPixelSize:null,scales:null,srcResolutions:null,isCustomTilingScheme:!1};const m=(c.x+c.y)/2,l=I.getMetersPerUnitForSR(b);var q=m*l*96*39.37,p=b.isGeographic?256/f*2.958287637958547E8:
256/f*5.91657527591555E8,n="vector-magdir"===a.dataType||"vector-uv"===a.dataType,t=T(g,b),u=Math.min(Math.ceil(Math.log(Math.min(a.width,a.height)/32)/Math.LN2),Math.ceil(Math.log(p/2/q)/Math.LN2));!n&&k&&(b.isGeographic||b.isWebMercator)&&(n=0>t.xmin*t.xmax,!n&&3>u&&(k=E(b),null!=k&&(n=2**u*m*f,f=Math.ceil(k/n),n=1===f||2===f&&k/2-t.xmax<n)));f=q;a=Math.min(2,Math.max(1.414,a.storageInfo?.pyramidScalingFactor||2));if(n)f=p,p=b.isGeographic?1.341104507446289E-6:.29858214164761665,u=96*p*l*39.37,
b=P(new B({x:p,y:p,spatialReference:{wkid:b.isGeographic?4326:3857}}),h,t),b.x*=f/u,b.y*=f/u;else{b={x:e.x,y:e.y};for(t=0;f<.5005*p&&t<u;)t++,f*=a,b.x*=a,b.y*=a;1.001>=Math.max(f,p)/Math.min(f,p)&&(f=p)}p=[f];t=[{x:b.x,y:b.y}];for(q=Math.min(70.5310735,q)/1.001;f>=q;)f/=a,b.x/=a,b.y/=a,p.push(f),t.push({x:b.x,y:b.y});if(d){const v=.001*e.x;d=t.findIndex(r=>r.x>=e.x-v&&r.x<=e.x+v);-1<d?(t.length=d+1,p.length=d+1):(d=t.findIndex(r=>r.x<=e.x+v),0<d&&(t.length=d,p.length=d))}return{projectedPixelSize:c,
scales:p,srcResolutions:t,isCustomTilingScheme:!n}};y.defaultGridSpacing=32;y.defaultProjectionToleranceInPixels=4;y.getDefaultDatumTransformationForDataset=function(a,b,c){G(a.spatialReference,b);return c?A.getTransformation(b,a.spatialReference,a):A.getTransformation(a.spatialReference,b,a)};y.getProjectedGridPoints=aa;y.getProjectionOffsetGrid=function(a){var b=a.isAdaptive&&null==a.spacing;let c=a.spacing||[32,32],f=V(a);var k={cols:f.size[0]+1,rows:f.size[1]+1};const d=0<f.outofBoundPointCount&&
f.outofBoundPointCount<f.offsets.length/2;let g=f.outofBoundPointCount===f.offsets.length/2||b&&d?[0,0]:ka(f.offsets,k,c,4);const h=(g[0]+g[1])/2;var e=a.projectedExtent.spatialReference;const m=a.srcBufferExtent.spatialReference;b&&(d||4<h)&&(O(e,m,a.datumTransformation)&&(e.isGeographic||null!=H(e)),c=[4,4],f=V({...a,spacing:c}),k={cols:f.size[0]+1,rows:f.size[1]+1},g=ka(f.offsets,k,c,4));f.error=g;1<c[0]&&(f.coefficients=ja(f.offsets,k,d));!a.includeGCSGrid||e.isGeographic||e.isWebMercator||(m.isGeographic?
f.gcsGrid={offsets:f.offsets,coefficients:f.coefficients,spacing:c}:(b=H(e),null==b||b.isEnvelope||(e&&!e.isGeographic&&(b=String(e.wkid||e.wkt),X.has(b)?e=X.get(b):(e=(e.wkid?x.PeFactory.coordsys(e.wkid):x.PeFactory.fromString(x.PeDefs.PE_TYPE_PROJCS,e.wkt)).getGeogcs().getCode(),X.set(b,e)),e=new na({wkid:e})),e=T(a.projectedExtent,e),{offsets:a}=V({...a,srcBufferExtent:e,spacing:c}),k=ja(a,k,d),f.gcsGrid={offsets:a,coefficients:k,spacing:c})));return f};y.getRasterDatasetAlignmentInfo=function(a){const b=
a.storageInfo.origin.x;var c=E(a.spatialReference,!0);if(null==c)return{originX:b,halfWorldWidth:null,pyramidsInfo:null};const f=c/2,{nativePixelSize:k,storageInfo:d,extent:g}=a,{maximumPyramidLevel:h,blockWidth:e,pyramidScalingFactor:m}=d;let l=k.x;const q=[];a=null!=a.transform&&"gcs-shift"===a.transform.type;const p=b+(a?0:f);c=a?c-b:f-b;for(let n=0;n<=h;n++){const t=(g.xmax-b)/l/e,u=c/l/e;q.push({resolutionX:l,blockWidth:e,datsetColumnCount:0===t-Math.floor(t)?t:Math.ceil(t),worldColumnCountFromOrigin:0===
u-Math.floor(u)?u:Math.ceil(u),leftMargin:Math.round(p/l)%e,rightPadding:(e-Math.round(c/l)%e)%e,originColumnOffset:Math.floor(p/l/e)});l*=m}return{originX:b,halfWorldWidth:f,pyramidsInfo:q,hasGCSSShiftTransform:a}};y.getWorldWidth=E;y.getWorldWrapCount=da;y.load=async function(){A.isLoaded()||await A.load()};y.minimumGridSpacing=4;y.projectExtent=T;y.projectPoint=Q;y.projectPolygon=function(a,b,c){if("extent"===a.type){const {xmin:f,ymin:k,xmax:d,ymax:g,spatialReference:h}=a;a=new Y({rings:[[[f,
g],[d,g],[d,k],[f,k],[f,g]]],spatialReference:h})}if(a.spatialReference.equals(b))return a;G(a.spatialReference,b,c);return A.project(a,b,c)};y.projectResolution=P;y.requirePE=O;y.snapExtent=function(a){a=a.clone().normalize();return 1===a.length?a[0]:ca(a)};y.snapPyramid=function(a,b,c){const {storageInfo:f,pixelSize:k}=b;var d=0;let g=!1;var {pyramidResolutions:h}=f,e="mixed"===f.tileInfo.format?.toLowerCase()?Math.max(1,Math.min(3,f.tileInfo.dpi/96)):1;e=(a.x+a.y)/2/e;if(null!=h&&h.length){a=h[h.length-
1];a=(a.x+a.y)/2;var m=(k.x+k.y)/2;if(e<=m)d=0;else if(e>=a)d=h.length,g=8<e/a;else{a=m;for(let l=1;l<=h.length;l++){m=(h[l-1].x+h[l-1].y)/2;if(e<=m){e===m?d=l:"down"===c?(d=l-1,g=8<e/a):d="up"===c?l:e-a>m-e||2<e/a?l:l-1;break}a=m}}c=0===d?k:h[d-1];g&&(h=Math.min(c.x,c.y),e=I.getMetersPerUnitForSR(b.spatialReference),19567<h*e&&(g=!1));return{pyramidLevel:d,pyramidResolution:new B({x:c.x,y:c.y,spatialReference:b.spatialReference}),excessiveReading:g}}d=Math.log(a.x/k.x)/Math.LN2;e=Math.log(a.y/k.y)/
Math.LN2;h=b.storageInfo.maximumPyramidLevel||0;d="down"===c?Math.floor(Math.min(d,e)):"up"===c?Math.ceil(Math.max(d,e)):Math.round((d+e)/2);0>d?d=0:d>h&&(g=d>h+3,d=h);c=2**d;b=new B({x:c*b.nativePixelSize.x,y:c*b.nativePixelSize.y,spatialReference:b.spatialReference});return{pyramidLevel:d,pyramidResolution:b,excessiveReading:g}};Object.defineProperty(y,Symbol.toStringTag,{value:"Module"})});
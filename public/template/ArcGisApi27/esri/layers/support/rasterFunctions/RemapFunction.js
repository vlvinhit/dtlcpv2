// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/mathUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./pixelUtils ./RemapFunctionArguments".split(" "),function(w,q,t,r,m,C,D,y,z,A,h,B){m=function(x){function u(){var a=x.apply(this,arguments)||this;a.functionName="Remap";
a.functionArguments=null;a.rasterArgumentNames=["raster"];a.lookup=null;return a}w._inherits(u,x);var v=u.prototype;v._bindSourceRasters=function(){const a=this.sourceRasterInfos[0].clone(),{pixelType:e}=a;this.outputPixelType=this._getOutputPixelType(e);a.pixelType=this.outputPixelType;a.colormap=null;a.histograms=null;a.bandCount=1;a.attributeTable=null;const {statistics:f}=a,{allowUnmatched:d,outputValues:b,inputRanges:k,noDataRanges:l,isLastInputRangeInclusive:c}=this.functionArguments;if(null!=
f&&f.length&&b?.length)if(d){var g=Math.min.apply(null,[...b,f[0].min]),n=Math.max.apply(null,[...b,f[0].max]);a.statistics=[{...f[0],min:g,max:n}]}else{n=g=b[0];for(let p=0;p<b.length;p++)g=g>b[p]?b[p]:g,n=n>b[p]?n:b[p];a.statistics=[{...f[0],min:g,max:n}]}this.rasterInfo=a;this.lookup=d?null:h.createRemapLUT({srcPixelType:e,inputRanges:k,outputValues:b,noDataRanges:l,allowUnmatched:d,isLastInputRangeInclusive:c,outputPixelType:this.outputPixelType});return{success:!0,supportsGPU:(!b||b.length<=
h.MAX_MAP_SIZE_GPU)&&(!l||l.length<=h.MAX_MAP_SIZE_GPU)}};v._processPixels=function(a){a=a.pixelBlocks?.[0];if(null==a)return null;const {lookup:e,outputPixelType:f}=this;if(e){const g=h.lookupPixels(a,{lut:[e.lut],offset:e.offset,outputPixelType:f});null!=g&&e.mask&&(g.mask=h.lookupBandValues(a.pixels[0],a.mask,e.mask,e.offset,"u8"));return g}const {inputRanges:d,outputValues:b,noDataRanges:k,allowUnmatched:l,isLastInputRangeInclusive:c}=this.functionArguments;return h.remap(a,{inputRanges:d,outputValues:b,
noDataRanges:k,outputPixelType:f,allowUnmatched:l,isLastInputRangeInclusive:c})};v._getWebGLParameters=function(){const {allowUnmatched:a,noDataRanges:e,isLastInputRangeInclusive:f}=this.functionArguments,d=new Float32Array(3*h.MAX_MAP_SIZE_GPU);var b=this.functionArguments.inputRanges??[],k=this.functionArguments.outputValues??[];const l=k.length;for(let c=0;c<h.MAX_MAP_SIZE_GPU;c++)if(d[3*c]=b[2*c]??t.NUMBER_MAX_FLOAT32-1,d[3*c+1]=b[2*c+1]??t.NUMBER_MAX_FLOAT32,d[3*c+2]=k[c]??0,c<l&&(0<c&&(d[3*
c]-=1E-5),c<l-1||!f))d[3*c+1]-=1E-5;b=new Float32Array(2*h.MAX_MAP_SIZE_GPU);b.fill(t.NUMBER_MAX_FLOAT32);e?.length&&b.set(e);k=z.getPixelValueRange(this.outputPixelType);return{allowUnmatched:a,rangeMaps:d,noDataRanges:b,clampRange:k}};return w._createClass(u)}(A);q.__decorate([r.property({json:{write:!0,name:"rasterFunction"}})],m.prototype,"functionName",void 0);q.__decorate([r.property({type:B,json:{write:!0,name:"rasterFunctionArguments"}})],m.prototype,"functionArguments",void 0);q.__decorate([r.property()],
m.prototype,"rasterArgumentNames",void 0);q.__decorate([r.property({json:{write:!0}})],m.prototype,"lookup",void 0);return m=q.__decorate([y.subclass("esri.layers.support.rasterFunctions.RemapFunction")],m)});
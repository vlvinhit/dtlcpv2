// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/mixins/ImageryTileMixin":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../rasterRenderers ../../request ../../core/Error ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../geometry/support/spatialReferenceUtils ../support/arcgisLayerUrl ../support/commonProperties ../support/DimensionalDefinition ../support/MultidimensionalSubset ../support/RasterFunction ../support/RasterJobHandler ../support/TileInfo ../support/rasterDatasets/FunctionRaster ../support/rasterDatasets/multidimensionalUtils ../support/rasterFunctions/clipUtils ../support/rasterFunctions/rasterFunctionHelper ../support/rasterFunctions/rasterProjectionHelper ../support/rasterFunctions/stretchUtils ../support/rasterFunctions/vectorFieldUtils ../../renderers/support/rasterRendererHelper ../../renderers/support/RasterSymbolizer ../../rest/support/ImageHistogramParameters ../../views/2d/engine/flow/dataUtils ../../geometry/SpatialReference ../../geometry/Point".split(" "),
function(P,w,E,C,B,T,R,S,K,D,G,h,m,n,g,c,t,A,r,b,f,d,e,q,l,a,k,p,z,I,N,O,H,u,y){const x=S.getLogger("esri.layers.mixins.ImageryTileMixin");P.ImageryTileMixin=L=>{function Q(W){if(!W.raster||!W.rasterInfo)throw new R("imagery-tile","no raster");}L=function(W){function v(...J){var M=W.call(this,...J)||this;M._isConstructedFromFunctionRaster=!1;M._rasterJobHandler={instance:null,refCount:0,connectionPromise:null};M.bandIds=null;M.copyright=null;M.interpolation="nearest";M.multidimensionalSubset=null;
M.raster=null;M.rasterInfo=null;M.sourceJSON=null;M.spatialReference=null;M.symbolizer=null;M._isConstructedFromFunctionRaster="Function"===J[0]?.raster?.datasetFormat;return M}w._inherits(v,W);var F=v.prototype;F.readRenderer=function(J,M,U){return B.read(M?.layerDefinition?.drawingInfo?.renderer,U)||void 0};F.convertVectorFieldData=async function(J,M){if(null==J||!this.rasterInfo)return null;const U=this._rasterJobHandler.instance,V=this.rasterInfo.dataType;return U?U.convertVectorFieldData({pixelBlock:J,
dataType:V},M):z.convertVectorFieldData(J,V)};F.computeStatisticsHistograms=async function(J,M){J=D.ensureClass(O,J).clone();var {rasterInfo:U}=this;const {geometry:V}=J;if(null==V)throw new R("imagery-tile-mixin:compute-statistics-histograms","geometry must be specified");var X=V;const {spatialReference:Z}=U;V.spatialReference.equals(Z)||(await k.load(),X="extent"===V.type?k.projectExtent(V,Z):k.projectPolygon(V,Z));J=J.pixelSize??new y({x:U.pixelSize.x,y:U.pixelSize.y,spatialReference:Z});const {extent:Y,
width:ea,height:da}=l.snapToRaster(U,X,J);U=await this.fetchPixels(Y,ea,da,{...M,interpolation:"nearest"});if(null==U.pixelBlock)throw new R("imagery-tile-mixin:compute-statistics-histograms","failed to fetch pixels");X=await l.clip(U.pixelBlock,Y,X);return(U=this._rasterJobHandler.instance)?U.computeStatisticsHistograms({pixelBlock:X},M):p.computeStatisticsHistograms(X)};F.createFlowMesh=async function(J,M){const U=this._rasterJobHandler.instance;return U?U.createFlowMesh(J,M):H.createFlowMesh(J.meshType,
J.simulationSettings,J.flowData,null!=M.signal?M.signal:(new AbortController).signal)};F.normalizeRasterFetchOptions=function(J){var {multidimensionalInfo:M}=this.rasterInfo??{};if(null==M)return J;let U=J.multidimensionalDefinition||this.multidimensionalDefinition;null!=U&&U.length||(U=q.getDefaultMultidimensionalDefinition(this.raster.rasterInfo,{multidimensionalSubset:this.multidimensionalSubset}));var V=J.timeExtent||this.timeExtent;if(null!=U&&null!=V&&(null!=V.start||null!=V.end)){U=U.map(fa=>
fa.clone());var X=M.variables.find(({name:fa})=>fa===U[0].variableName)?.dimensions?.find(({name:fa})=>"StdTime"===fa);M=U.find(({dimensionName:fa})=>"StdTime"===fa);if(!X||!M)return{...J,multidimensionalDefinition:null};const {start:Z,end:Y}=V;V=null==Z?null:Z.getTime();const ea=null==Y?null:Y.getTime(),da=V??ea,ia=ea??V;if(null!=X.values)X=X.values.filter(fa=>{if(Array.isArray(fa)){if(da===ia)return fa[0]<=da&&fa[1]>=da;const ja=fa[0]>=da&&fa[1]<=ia||fa[0]<da&&fa[1]>ia;return fa[0]<=da&&fa[1]>da||
fa[0]<ia&&fa[1]>=ia||ja}return da===ia?fa===da:fa>=da&&fa<=ia}),X.length?(X=X.sort((fa,ja)=>{const ma=Array.isArray(fa)?fa[0]:fa;fa=Array.isArray(fa)?fa[1]:fa;const na=Array.isArray(ja)?ja[0]:ja;ja=Array.isArray(ja)?ja[1]:ja;return da===ia?ma-na:Math.abs(fa-ia)-Math.abs(ja-ia)})[0],M.values=[X]):U=null;else if(X.hasRegularIntervals&&X.extent){const [fa,ja]=X.extent;da>ja||ia<fa?U=null:M.values=da===ia?[da]:[Math.max(fa,da),Math.min(ja,ia)]}}return null!=U&&q.hasExcludedVariableOrDimension(U,this.multidimensionalSubset)?
{...J,multidimensionalDefinition:null}:{...J,multidimensionalDefinition:U}};F.updateRasterFunction=async function(){if(this.loaded&&"imagery-tile"===this.type&&(this.rasterFunction||this._cachedRasterFunctionJson)&&JSON.stringify(this.rasterFunction)!==JSON.stringify(this._cachedRasterFunctionJson))if(this._isConstructedFromFunctionRaster&&"Function"===this.raster.datasetFormat){var J=this.raster.rasterFunction.toJSON();!this.rasterFunction&&J&&this._set("rasterFunction",b.fromJSON(J));this._cachedRasterFunctionJson=
this.rasterFunction?.toJSON()}else{var M=this.raster;J=!1;if("Function"===M.datasetFormat){var U=M.primaryRasters.rasters;M=U[0];J=!0}else U=[M];var {rasterFunction:V}=this;if(V){const Z={raster:M};1<U.length&&U.forEach(Y=>Z[Y.url]=Y);M=a.create(V.functionDefinition?.toJSON()??V.toJSON(),Z);M=new e({rasterFunction:M});M.rasterJobHandler=this._rasterJobHandler.instance;await M.open();this._cachedRasterFunctionJson=this.rasterFunction?.toJSON();this.raster=M}else this.raster=M,this._cachedRasterFunctionJson=
null,await M.when();this._cachedRendererJson=null;if(J||V){({bandIds:J}=this);var {bandCount:X}=this.raster.rasterInfo;V=J?.length?J.some(Z=>Z>=X):3<=X;J&&(V||this.renderer&&"raster-stretch"!==this.renderer.type)&&this._set("bandIds",null);this._configDefaultRenderer("auto")}}};F.updateRenderer=async function(){const {loaded:J,symbolizer:M}=this;if(J&&M&&this.renderer){var {rasterInfo:U}=this.raster,V=q.getDefaultVariablInfo(U,{multidimensionalDefinition:this.multidimensionalDefinition,multidimensionalSubset:this.multidimensionalSubset})?.name,
X=I.normalizeRendererJSON({...this.renderer.toJSON(),variableName:V});if(JSON.stringify(this._cachedRendererJson)!==JSON.stringify(X)){var Z=this._rasterJobHandler.instance;Z&&(M.rasterInfo=I.getVariableRasterInfo(U,V),M.rendererJSON=X,M.bind(),await Z.updateSymbolizer(M),this._cachedRendererJson=X)}}};F.applyRenderer=async function(J,M){var U=J&&J.pixelBlock;if(!(null!=U&&U.pixels&&0<U.pixels.length))return null;await this.updateRenderer();U=this._rasterJobHandler.instance;const V=this.bandIds??
[];return U?await U.symbolize({...J,simpleStretchParams:M,bandIds:V}):this.symbolizer.symbolize({...J,simpleStretchParams:M,bandIds:V})};F.getTileUrl=function(J,M,U){return"RasterTileServer"===this.raster.datasetFormat?`${this.url}/tile/${J}/${M}/${U}`:""};F.getCompatibleTileInfo=function(J,M,U=!1){if(!this.loaded||null==M)return null;if(U&&J.equals(this.spatialReference))return this.tileInfo;U=g.getInfo(J);return d.create({size:256,spatialReference:J,origin:U?{x:U.origin[0],y:U.origin[1]}:{x:M.xmin,
y:M.ymax}})};F.getCompatibleFullExtent=function(J){return this.loaded?this._compatibleFullExtent&&this._compatibleFullExtent.spatialReference.equals(J)?this._compatibleFullExtent:this._compatibleFullExtent=this.raster.computeExtent(J):null};F.fetchTile=async function(J,M,U,V={}){Q(this);if(V.requestAsImageElement)return J=this.getTileUrl(J,M,U),T(J,{responseType:"image",query:{...this.refreshParameters,...this.raster.ioConfig.customFetchParameters},signal:V.signal}).then(Z=>Z.data);const {rasterInfo:X}=
this;if(null!=X.multidimensionalInfo&&(V=this.normalizeRasterFetchOptions(V),null==V.multidimensionalDefinition))return{extent:this.raster.getTileExtentFromTileInfo(J,M,U,V.tileInfo||X.storageInfo.tileInfo),pixelBlock:null};await this._initJobHandler();await this.updateRasterFunction();"raster-shaded-relief"===this.renderer?.type&&(V={...V,buffer:{cols:1,rows:1}});return this.raster.fetchTile(J,M,U,V)};F.fetchPixels=async function(J,M,U,V={}){if(null!=this.rasterInfo.multidimensionalInfo&&(V=this.normalizeRasterFetchOptions(V),
null==V.multidimensionalDefinition))return{extent:J,pixelBlock:null};await this._initJobHandler();await this.updateRasterFunction();M=Math.round(M);U=Math.round(U);return this.raster.fetchPixels(J,M,U,V)};F.identify=async function(J,M={}){const {raster:U,rasterInfo:V}=this;if(!(null==V.multidimensionalInfo||V.hasMultidimensionalTranspose&&(q.isMultiSliceOrRangeDefinition(M.multidimensionalDefinition)||M.transposedVariableName||M.timeExtent))&&(M=this.normalizeRasterFetchOptions(M),null==M.multidimensionalDefinition))return{location:J,
value:null};const X=this.multidimensionalSubset?.areaOfInterest;if(X&&!X.contains(J))throw new R("imagery-tile-mixin:identify","the request cannot be fulfilled when falling outside of the multidimensional subset");return U.identify(J,M)};F.increaseRasterJobHandlerUsage=function(){this._rasterJobHandler.refCount++};F.decreaseRasterJobHandlerUsage=function(){this._rasterJobHandler.refCount--;0>=this._rasterJobHandler.refCount&&this._shutdownJobHandler()};F.hasStandardTime=function(){const J=this.rasterInfo?.multidimensionalInfo;
if(null==J||"standard-time"!==this.rasterInfo?.dataType)return!1;const M=this.multidimensionalDefinition,U=M?.[0]?.variableName;return J.variables.some(V=>V.name===U&&(!M?.[0].dimensionName||V.dimensions.some(X=>"StdTime"===X.name)))};F.getStandardTimeValue=function(J){return(new Date(864E5*(J-25569))).toString()};F.getMultidimensionalSubsetVariables=function(J){return q.getSubsetVariablesFromMdInfo(this.multidimensionalSubset,J??this.rasterInfo?.multidimensionalInfo)};F._configDefaultSettings=function(){this._configDefaultInterpolation();
this.multidimensionalDefinition||(this.multidimensionalDefinition=q.getDefaultMultidimensionalDefinition(this.raster.rasterInfo,{multidimensionalSubset:this.multidimensionalSubset}));this.rasterFunction&&"Function"===this.raster.datasetFormat&&(this._cachedRasterFunctionJson=this.rasterFunction.toJSON());this._configDefaultRenderer()};F._initJobHandler=function(){if(null!=this._rasterJobHandler.connectionPromise)return this._rasterJobHandler.connectionPromise;const J=new f;this._rasterJobHandler.connectionPromise=
J.initialize().then(async()=>{Q(this);this._rasterJobHandler.instance=J;this.raster.rasterJobHandler=J;"Function"===this.raster.datasetFormat&&this.raster.syncJobHandler();this.rasterFunction&&await this.updateRasterFunction().catch(()=>{});this.renderer&&this.updateRenderer()}).catch(()=>{});return this._rasterJobHandler.connectionPromise};F._shutdownJobHandler=function(){this._rasterJobHandler.instance&&this._rasterJobHandler.instance.destroy();this._rasterJobHandler.instance=null;this._rasterJobHandler.connectionPromise=
null;this._rasterJobHandler.refCount=0;this._cachedRendererJson=null;this.raster&&(this.raster.rasterJobHandler=null)};F._configDefaultInterpolation=function(){if(null==this.interpolation){Q(this);var {raster:J}=this;J=I.getDefaultInterpolation(J.rasterInfo,J.tileType,this.sourceJSON?.defaultResamplingMethod);this._set("interpolation",J)}};F._configDefaultRenderer=function(J="no"){Q(this);var {rasterInfo:M}=this.raster;!this.bandIds&&1<M.bandCount&&(this.bandIds=I.getDefaultBandCombination(M));var U=
q.getDefaultVariablInfo(M,{multidimensionalDefinition:this.multidimensionalDefinition,multidimensionalSubset:this.multidimensionalSubset})?.name;if(!this.renderer||"override"===J){var V=I.createDefaultRenderer(M,{bandIds:this.bandIds,variableName:U}),X=M.statistics;X=X&&0<X.length?X[0]:null;"WCSServer"===this.raster.datasetFormat&&"raster-stretch"===V.type&&(1E24<(X?.max??0)||-1E24>(X?.min??0))&&(V.dynamicRangeAdjustment=!0,V.statistics=null,"none"===V.stretchType&&(V.stretchType="min-max"));this.renderer=
V}V=I.normalizeRendererJSON({...this.renderer.toJSON(),variableName:U});M=I.getVariableRasterInfo(M,U);this.symbolizer?(this.symbolizer.rendererJSON=V,this.symbolizer.rasterInfo=M):this.symbolizer=new N({rendererJSON:V,rasterInfo:M});M=this.symbolizer.bind();M.success?"auto"===J&&({colormap:M}=this.raster.rasterInfo,J=this.renderer,null!=M&&"raster-colormap"===J.type?(M=I.createDefaultRenderer(this.raster.rasterInfo),JSON.stringify(M)!==JSON.stringify(J)&&this._configDefaultRenderer("override")):
"raster-stretch"===J.type&&(M=this.bandIds?.length,U=J.statistics?.length,!J.dynamicRangeAdjustment&&U&&M&&U!==M&&this._configDefaultRenderer("override"))):(x.warn("imagery-tile-mixin",M.error||"The given renderer is not supported by the layer."),"auto"===J&&this._configDefaultRenderer("override"))};w._createClass(v,[{key:"fullExtent",get:function(){return this.rasterInfo?.extent}},{key:"multidimensionalDefinition",set:function(J){this._set("multidimensionalDefinition",J);this.updateRenderer()}},
{key:"rasterFunction",set:function(J){"none"===J?.functionName?.toLowerCase()&&(J=void 0);this._set("rasterFunction",J);this.updateRasterFunction()}},{key:"url",set:function(J){this._set("url",c.sanitizeUrl(J,x))}},{key:"renderer",set:function(J){null==J&&null==this.rasterFunction?this._configDefaultRenderer("override"):(this._set("renderer",J),this.updateRenderer())}}]);return v}(L);E.__decorate([K.property()],L.prototype,"_cachedRendererJson",void 0);E.__decorate([K.property()],L.prototype,"_cachedRasterFunctionJson",
void 0);E.__decorate([K.property()],L.prototype,"_compatibleFullExtent",void 0);E.__decorate([K.property()],L.prototype,"_isConstructedFromFunctionRaster",void 0);E.__decorate([K.property()],L.prototype,"_rasterJobHandler",void 0);E.__decorate([K.property()],L.prototype,"bandIds",void 0);E.__decorate([K.property({json:{origins:{service:{read:{source:"copyrightText"}}}}})],L.prototype,"copyright",void 0);E.__decorate([K.property({json:{read:!1}})],L.prototype,"fullExtent",null);E.__decorate([K.property()],
L.prototype,"interpolation",void 0);E.__decorate([K.property()],L.prototype,"ioConfig",void 0);E.__decorate([K.property({type:[A],json:{write:!0}})],L.prototype,"multidimensionalDefinition",null);E.__decorate([K.property({type:r,json:{write:!0}})],L.prototype,"multidimensionalSubset",void 0);E.__decorate([K.property()],L.prototype,"raster",void 0);E.__decorate([K.property({type:b,json:{name:"renderingRule",write:!0}})],L.prototype,"rasterFunction",null);E.__decorate([K.property()],L.prototype,"rasterInfo",
void 0);E.__decorate([K.property()],L.prototype,"sourceJSON",void 0);E.__decorate([K.property({readOnly:!0,type:u,json:{read:!1}})],L.prototype,"spatialReference",void 0);E.__decorate([K.property({type:d})],L.prototype,"tileInfo",void 0);E.__decorate([K.property(t.url)],L.prototype,"url",null);E.__decorate([K.property({types:B.rasterRendererTypes,json:{name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy(){const W="raster-stretch"===this.renderer?.type&&"none"===this.renderer.stretchType&&
!this.renderer.useGamma;return{enabled:!this.loaded||"Raster"===this.raster.tileType||!W}}},origins:{"web-scene":{types:B.websceneRasterRendererTypes,name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy(W){return{enabled:W&&"vector-field"!==W.type&&"flow"!==W.type}}}}}}})],L.prototype,"renderer",null);E.__decorate([m.reader("renderer")],L.prototype,"readRenderer",null);E.__decorate([K.property()],L.prototype,"symbolizer",void 0);return L=E.__decorate([n.subclass("esri.layers.ImageryTileMixin")],
L)};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/rasterRenderers":function(){define("exports ./core/Warning ./renderers/ClassBreaksRenderer ./renderers/FlowRenderer ./renderers/RasterColormapRenderer ./renderers/RasterShadedReliefRenderer ./renderers/RasterStretchRenderer ./renderers/UniqueValueRenderer ./renderers/VectorFieldRenderer".split(" "),function(P,w,E,C,B,T,R,S,K){function D(n,g){if(!n)return null;if("classBreaks"===n.type&&n.classificationMethod){var c=n.authoringInfo||
{classificationMethod:""};c.classificationMethod=n.classificationMethod;n.authoringInfo=c}"vectorField"===n.type&&n.visualVariables&&!Array.isArray(n.visualVariables)&&(n.visualVariables=[n.visualVariables]);c=n?m[n.type]||null:null;if(c)return c=new c,c.read(n,g),c;g&&g.messages&&n&&g.messages.push(new w("renderer:unsupported","Renderers of type '"+(n.type||"unknown")+"' are not supported",{definition:n,context:g}));return null}const G={key:"type",base:null,typeMap:{"unique-value":S,"class-breaks":E,
"raster-colormap":B,"raster-stretch":R,"vector-field":K,"raster-shaded-relief":T,flow:C}},h={...G,typeMap:{...G.typeMap}};delete h.typeMap["vector-field"];delete h.typeMap.flow;const m={uniqueValue:S,classBreaks:E,rasterStretch:R,rasterColormap:B,vectorField:K,rasterShadedRelief:T,flowRenderer:C};P.ClassBreaksRenderer=E;P.FlowRenderer=C;P.RasterColormapRenderer=B;P.RasterShadedReliefRenderer=T;P.RasterStretchRenderer=R;P.UniqueValueRenderer=S;P.VectorFieldRenderer=K;P.fromJSON=function(n,g){return D(n,
g)};P.rasterRendererTypes=G;P.read=D;P.websceneRasterRendererTypes=h;Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/FlowRenderer":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../Color ../core/jsonMap ../core/JSONSupport ../core/screenUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/subclass ./mixins/VisualVariablesMixin ./support/AuthoringInfo ./support/LegendOptions".split(" "),
function(P,w,E,C,B,T,R,S,K,D,G,h,m,n,g){var c;C=new C.JSONMap({flow_from:"flow-from",flow_to:"flow-to"});B=c=function(t){function A(b){b=t.call(this,b)||this;b.density=.8;b.color=new E([255,255,255,1]);b.maxPathLength=200;b.trailWidth=1.5;b.flowSpeed=10;b.trailLength=100;b.smoothing=0;b.flowRepresentation="flow-from";b.type="flow";b.authoringInfo=null;b.legendOptions=null;b.trailCap="butt";b.background="none";return b}P._inherits(A,t);var r=A.prototype;r.clone=function(){const {density:b,maxPathLength:f,
trailWidth:d,flowSpeed:e,trailLength:q,smoothing:l,flowRepresentation:a,trailCap:k,background:p}=this,z=this.color.clone(),I=(this.visualVariables||[]).map(H=>H.clone()),N=this.authoringInfo?.clone(),O=this.legendOptions?.clone();return new c({density:b,color:z,maxPathLength:f,trailWidth:d,flowSpeed:e,trailLength:q,trailCap:k,background:p,smoothing:l,flowRepresentation:a,visualVariables:I,authoringInfo:N,legendOptions:O})};r.getSymbol=function(b,f){};r.getSymbolAsync=async function(b,f){};r.getSymbols=
function(){return[]};return P._createClass(A)}(m.VisualVariablesMixin(B.JSONSupport));w.__decorate([R.property({type:Number,json:{write:!0}})],B.prototype,"density",void 0);w.__decorate([R.property({type:E,json:{write:{allowNull:!0}}})],B.prototype,"color",void 0);w.__decorate([R.property({type:Number,cast:T.toPt,json:{write:!0}})],B.prototype,"maxPathLength",void 0);w.__decorate([R.property({type:Number,cast:T.toPt,json:{write:!0}})],B.prototype,"trailWidth",void 0);w.__decorate([R.property({type:Number,
json:{write:!0}})],B.prototype,"flowSpeed",void 0);w.__decorate([R.property({type:Number,json:{write:!0}})],B.prototype,"trailLength",void 0);w.__decorate([R.property({type:Number,cast:T.toPt,json:{write:!1}})],B.prototype,"smoothing",void 0);w.__decorate([R.property({type:C.apiValues,json:{type:C.jsonValues,read:{reader:C.read},write:{writer:C.write}}})],B.prototype,"flowRepresentation",void 0);w.__decorate([G.enumeration({flowRenderer:"flow"})],B.prototype,"type",void 0);w.__decorate([R.property({type:n,
json:{write:!0}})],B.prototype,"authoringInfo",void 0);w.__decorate([R.property({type:g.LegendOptions,json:{write:!0}})],B.prototype,"legendOptions",void 0);w.__decorate([R.property({type:String,json:{write:!0}})],B.prototype,"trailCap",void 0);w.__decorate([R.property({type:String,json:{write:!0}})],B.prototype,"background",void 0);return B=c=w.__decorate([h.subclass("esri.renderers.FlowRenderer")],B)})},"esri/renderers/RasterColormapRenderer":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/subclass ./support/ColormapInfo ./support/colorRampUtils".split(" "),
function(P,w,E,C,B,T,R,S,K,D,G){var h;E=h=function(m){function n(c){c=m.call(this,c)||this;c.colormapInfos=null;c.type="raster-colormap";return c}P._inherits(n,m);n.createFromColormap=function(c,t){if(!c)return null;const A=5===c[0].length;c=[...c].sort((r,b)=>r[0]-b[0]).map(r=>D.fromJSON({value:r[0],color:A?r.slice(1,5):r.slice(1,4).concat([255]),label:t?t[r[0]]??"":r[0]}));return new h({colormapInfos:c})};n.createFromColorramp=function(c){c=G.convertColorRampToColormap(c);return h.createFromColormap(c)};
var g=n.prototype;g.clone=function(){return new h({colormapInfos:this.colormapInfos.map(c=>c.toJSON())})};g.extractColormap=function(){return this.colormapInfos.map(({value:c,color:t})=>[c,t.r,t.g,t.b,1<t.a?t.a:255*t.a&255]).sort((c,t)=>c[0]-t[0])};return P._createClass(n)}(E.JSONSupport);w.__decorate([C.property({type:[D],json:{write:!0}})],E.prototype,"colormapInfos",void 0);w.__decorate([S.enumeration({rasterColormap:"raster-colormap"})],E.prototype,"type",void 0);return E=h=w.__decorate([K.subclass("esri.renderers.RasterColormapRenderer")],
E)})},"esri/renderers/support/ColormapInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Color ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),function(P,w,E,C,B,T,R,S,K){C=function(D){function G(){var h=D.apply(this,arguments)||this;h.value=null;h.label=null;h.color=null;return h}P._inherits(G,D);return P._createClass(G)}(C.JSONSupport);
w.__decorate([B.property({type:Number,json:{write:!0}})],C.prototype,"value",void 0);w.__decorate([B.property({type:String,json:{write:!0}})],C.prototype,"label",void 0);w.__decorate([B.property({type:E,json:{type:[T.Integer],write:!0}})],C.prototype,"color",void 0);return C=w.__decorate([K.subclass("esri.renderers.support.ColormapInfo")],C)})},"esri/renderers/support/colorRampUtils":function(){define(["exports","../../Color","../../core/colorUtils","../../core/jsonMap"],function(P,w,E,C){function B(r,
b){if(!r||!b||r.length!==b.length)return!1;for(let f=0;f<r.length;f++)if(r[f]>b[f]+2||r[f]<b[f]-2)return!1;return!0}function T(r){const b=r.clone();b.fromColor=r.toColor;b.toColor=r.fromColor;b.algorithm=r.algorithm;return b}function R(r){if("multipart"===r.type){r=r.clone();if(!r.colorRamps?.length)return r;r.colorRamps=r.colorRamps.reverse().map(b=>T(b));return r}return T(r)}function S(r,b){if(r){b=b??t;var f=null;"algorithmic"===r.type?b.some(d=>{if(B(r.fromColor.toRgb(),d.fromColor)&&B(r.toColor.toRgb(),
d.toColor))return f=d.id,!0}):"multipart"===r.type&&b.some(d=>{const e=r.colorRamps,q=d.colorRamps;if(e&&q&&e.length===q.length&&!q.some((l,a)=>{if(!B(e[a].fromColor.toRgb(),(new w(l.fromColor)).toRgb())||!B(e[a].toColor.toRgb(),(new w(l.toColor)).toRgb()))return!0})){if(f)return!0;f=d.id}});return f}}function K(r,b,f=!1){if(r){var d=S(r,b);null!=d||f||(r=R(r),d=S(r,b));return d}}function D(r,b=!1){return(r="string"===typeof r?r:K(r,void 0,b))?A.toJSON(r):null}function G(r){r=r||{};const b=r.numColors||
256;return{...r,numColors:b,distanceOffset:r.distanceOffset||0,interpolateAlpha:!!r.interpolateAlpha,distanceInterval:r.distanceInterval||1/(b-1),isCustomInterval:null!=r.isCustomInterval?r.isCustomInterval:null!==r.distanceInterval&&r.distanceInterval!==1/(b-1),weights:r.weights}}function h(r,b){let {fromColor:f,toColor:d}=r;f=[...f];d=[...d];3===f.length&&(f=f.concat([255]));3===d.length&&(d=d.concat([255]));r=r.algorithm||"esriCIELabAlgorithm";var e=G(b);const {numColors:q,distanceOffset:l,isCustomInterval:a,
interpolateAlpha:k}=e;if(1===q&&0===l)return[f];if(2===q&&0===l&&!a)return[f,d];var p={r:f[0],g:f[1],b:f[2]};b={r:d[0],g:d[1],b:d[2]};if("esriCIELabAlgorithm"===r){r=E.toLAB(p);b=E.toLAB(b);const {numColors:O,distanceOffset:H,distanceInterval:u,isCustomInterval:y}=e;let {l:x,a:L,b:Q}=r;r=(b.l-x)*u;p=(b.a-L)*u;e=(b.b-Q)*u;var z=[];if(H){var I=H/u;x+=I*r;L+=I*p;Q+=I*e}for(I=0;I<O-1;I++)z.push({l:x,a:L,b:Q}),x+=r,L+=p,Q+=e;z.push(y?{l:x,a:L,b:Q}:b);b=z}else if("esriHSVAlgorithm"===r){r=E.toHSV(p);b=
E.toHSV(b);const {numColors:O,distanceOffset:H,distanceInterval:u,isCustomInterval:y}=e;z=0===r.s;I=0===b.s;p=r.h;e=b.h;z&&!I?p=e:I&&!z&&(b={...b,h:p},e=p);z=Math.abs(e-p);180>z?e=(e-p)*u:(z=360-z,e=p>e?z*u:-z*u);z=(b.s-r.s)*u;I=(b.v-r.v)*u;let {s:x,v:L}=r;r=p;H&&(p=H/u,r=(r+p*e+360)%360,x+=p*z,L+=p*I);p=[];for(var N=0;N<O-1;N++)p.push({h:r,s:x,v:L}),r=(r+e+360)%360,x+=z,L+=I;p.push(y?{h:r,s:x,v:L}:b);b=p}else{p=E.toLCH(p);b=E.toLCH(b);const {numColors:O,distanceOffset:H,distanceInterval:u,isCustomInterval:y}=
e;e=p.h;z=b.h;r=2*Math.PI;e<=z?(I=z-e,e=z-e-r,e=Math.abs(e)<Math.abs(I)?e:I):(I=z+r-e,e=z-e,e=Math.abs(e)<Math.abs(I)?e:I);e*=u;z=(b.l-p.l)*u;I=(b.c-p.c)*u;let {l:x,c:L,h:Q}=p;H&&(p=H/u,x+=p*z,L+=p*I,Q=(Q+p*e+r)%r);p=[];for(N=0;N<O-1;N++)p.push({l:x,c:L,h:Q}),x+=z,L+=I,Q=(Q+e+r)%r;p.push(y?{l:x,c:L,h:Q}:b);b=p}r=[];p=f[3]??255;e=((d[3]??255)-p)/(q-1);for(z=0;z<q;z++){const {r:O,g:H,b:u}=E.toRGB(b[z]);r.push([O,H,u,k?Math.round(p+e*z):255])}return r}function m(r,b){const {numColors:f,interpolateAlpha:d}=
G(b);b=b?.weights;({colorRamps:r}=r);if(b){const z=b.reduce((I,N)=>I+N);b=b.map(I=>I/z)}else{b=[];for(var e=0;e<r.length;e++)b[e]=1/r.length}e=[];let q=0,l=0;const a=1/(f-1);let k=!1;for(let z=0;z<r.length;z++){var p=k?0:q*a-l;let I=z===r.length-1?f-1-q:(b[z]-p)/a;k=Math.ceil(I)===I;I=Math.ceil(I);0!==I&&(p/=b[z],p=h(r[z],{numColors:I,interpolateAlpha:d,distanceOffset:p,distanceInterval:a/b[z]}),q+=p.length,e.push(...p),l+=b[z])}b=[...r[r.length-1].toColor];3===b.length&&b.push(255);e.push(b);return e}
function n(r,b){r="toJSON"in r?r.toJSON():r;return"multipart"===r.type?m(r,b):h(r,b)}function g(r){r=E.toHSV(r);return{type:"HsvColor",Hue:r.h,Saturation:r.s,Value:r.v,AlphaValue:255}}function c(r){return{Algorithm:r.toJSON()?.Algorithm||"esriHSVAlgorithm",type:"AlgorithmicColorRamp",FromColor:g(r.fromColor),ToColor:g(r.toColor)}}const t=[{id:"aspect",type:"multipart",colorRamps:[{fromColor:[190,190,190],toColor:[255,45,8]},{fromColor:[255,45,8],toColor:[255,181,61]},{fromColor:[255,181,61],toColor:[255,
254,52]},{fromColor:[255,254,52],toColor:[0,251,50]},{fromColor:[0,251,50],toColor:[255,254,52]},{fromColor:[0,253,255],toColor:[0,181,255]},{fromColor:[0,181,255],toColor:[26,35,253]},{fromColor:[26,35,253],toColor:[255,57,251]},{fromColor:[255,57,251],toColor:[255,45,8]}]},{id:"black-to-white",fromColor:[0,0,0],toColor:[255,255,255]},{id:"blue-bright",fromColor:[204,204,255],toColor:[0,0,224]},{id:"blue-light-to-dark",fromColor:[211,229,232],toColor:[46,100,140]},{id:"blue-green-bright",fromColor:[203,
245,234],toColor:[48,207,146]},{id:"blue-green-light-to-dark",fromColor:[216,242,237],toColor:[21,79,74]},{id:"brown-light-to-dark",fromColor:[240,236,170],toColor:[102,72,48]},{id:"brown-to-blue-green-diverging-right",type:"multipart",colorRamps:[{fromColor:[156,85,31],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[33,130,145]}]},{id:"brown-to-blue-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[110,70,45],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[48,100,102]}]},
{id:"coefficient-bias",fromColor:[214,214,255],toColor:[0,57,148]},{id:"cold-to-hot-diverging",type:"multipart",colorRamps:[{fromColor:[69,117,181],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[214,47,39]}]},{id:"condition-number",type:"multipart",colorRamps:[{fromColor:[0,97,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,34,0]}]},{id:"cyan-to-purple",type:"multipart",colorRamps:[{fromColor:[0,245,245],toColor:[0,0,245]},{fromColor:[0,0,245],toColor:[245,0,245]}]},{id:"cyan-light-to-blue-dark",
type:"multipart",colorRamps:[{fromColor:[182,237,240],toColor:[31,131,224]},{fromColor:[31,131,224],toColor:[9,9,145]}]},{id:"distance",fromColor:[255,200,0],toColor:[0,0,255]},{id:"elevation1",type:"multipart",colorRamps:[{fromColor:[175,240,233],toColor:[255,255,179]},{fromColor:[255,255,179],toColor:[0,128,64]},{fromColor:[0,128,64],toColor:[252,186,3]},{fromColor:[252,186,3],toColor:[128,0,0]},{fromColor:[120,0,0],toColor:[105,48,13]},{fromColor:[105,48,13],toColor:[171,171,171]},{fromColor:[171,
171,171],toColor:[255,252,255]}]},{id:"elevation2",type:"multipart",colorRamps:[{fromColor:[118,219,211],toColor:[255,255,199]},{fromColor:[255,255,199],toColor:[255,255,128]},{fromColor:[255,255,128],toColor:[217,194,121]},{fromColor:[217,194,121],toColor:[135,96,38]},{fromColor:[135,96,38],toColor:[150,150,181]},{fromColor:[150,150,181],toColor:[181,150,181]},{fromColor:[181,150,181],toColor:[255,252,255]}]},{id:"errors",fromColor:[255,235,214],toColor:[196,10,10]},{id:"gray-light-to-dark",fromColor:[219,
219,219],toColor:[69,69,69]},{id:"green-bright",fromColor:[204,255,204],toColor:[14,204,14]},{id:"green-light-to-dark",fromColor:[220,245,233],toColor:[34,102,51]},{id:"green-to-blue",type:"multipart",colorRamps:[{fromColor:[32,204,16],toColor:[0,242,242]},{fromColor:[0,242,242],toColor:[2,33,227]}]},{id:"orange-bright",fromColor:[255,235,204],toColor:[240,118,5]},{id:"orange-light-to-dark",fromColor:[250,233,212],toColor:[171,65,36]},{id:"partial-spectrum",type:"multipart",colorRamps:[{fromColor:[242,
241,162],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]},{fromColor:[252,3,69],toColor:[176,7,237]},{fromColor:[176,7,237],toColor:[2,29,173]}]},{id:"partial-spectrum-1-diverging",type:"multipart",colorRamps:[{fromColor:[135,38,38],toColor:[240,149,12]},{fromColor:[240,149,12],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[74,80,181]},{fromColor:[74,80,181],toColor:[39,32,122]}]},{id:"partial-spectrum-2-diverging",type:"multipart",colorRamps:[{fromColor:[115,77,42],toColor:[201,
137,52]},{fromColor:[201,137,52],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[91,63,176]},{fromColor:[91,63,176],toColor:[81,13,97]}]},{id:"pink-to-yellow-green-diverging-bright",type:"multipart",colorRamps:[{fromColor:[158,30,113],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[99,110,45]}]},{id:"pink-to-yellow-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[97,47,73],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[22,59,15]}]},{id:"precipitation",type:"multipart",
colorRamps:[{fromColor:[194,82,60],toColor:[237,161,19]},{fromColor:[237,161,19],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,219,0]},{fromColor:[0,219,0],toColor:[32,153,143]},{fromColor:[32,153,143],toColor:[11,44,122]}]},{id:"prediction",type:"multipart",colorRamps:[{fromColor:[40,146,199],toColor:[250,250,100]},{fromColor:[250,250,100],toColor:[232,16,20]}]},{id:"purple-bright",fromColor:[255,204,255],toColor:[199,0,199]},{id:"purple-to-green-diverging-bright",type:"multipart",colorRamps:[{fromColor:[77,
32,150],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[20,122,11]}]},{id:"purple-to-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[67,14,89],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[24,79,15]}]},{id:"purple-blue-bright",fromColor:[223,184,230],toColor:[112,12,242]},{id:"purple-blue-light-to-dark",fromColor:[229,213,242],toColor:[93,44,112]},{id:"purple-red-bright",fromColor:[255,204,225],toColor:[199,0,99]},{id:"purple-red-light-to-dark",fromColor:[250,215,
246],toColor:[143,17,57]},{id:"red-bright",fromColor:[255,204,204],toColor:[219,0,0]},{id:"red-light-to-dark",fromColor:[255,224,224],toColor:[143,10,10]},{id:"red-to-blue-diverging-bright",type:"multipart",colorRamps:[{fromColor:[196,69,57],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[48,95,207]}]},{id:"red-to-blue-diverging-dark",type:"multipart",colorRamps:[{fromColor:[107,13,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[13,53,97]}]},{id:"red-to-green",type:"multipart",
colorRamps:[{fromColor:[245,0,0],toColor:[245,245,0]},{fromColor:[245,245,0],toColor:[0,245,0]}]},{id:"red-to-green-diverging-bright",type:"multipart",colorRamps:[{fromColor:[186,20,20],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[54,145,33]}]},{id:"red-to-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[97,21,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[16,69,16]}]},{id:"slope",type:"multipart",colorRamps:[{fromColor:[56,168,0],toColor:[255,255,0]},{fromColor:[255,
255,0],toColor:[255,0,0]}]},{id:"spectrum-full-bright",type:"multipart",colorRamps:[{fromColor:[255,0,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,0,255]}]},{id:"spectrum-full-dark",type:"multipart",colorRamps:[{fromColor:[153,0,0],toColor:[153,153,0]},{fromColor:[153,153,0],toColor:[0,153,153]},{fromColor:[0,153,153],toColor:[0,0,153]}]},{id:"spectrum-full-light",type:"multipart",colorRamps:[{fromColor:[255,153,153],toColor:[255,255,153]},
{fromColor:[255,255,153],toColor:[153,255,255]},{fromColor:[153,255,255],toColor:[153,153,255]}]},{id:"surface",type:"multipart",colorRamps:[{fromColor:[112,153,89],toColor:[242,238,162]},{fromColor:[242,238,162],toColor:[242,206,133]},{fromColor:[242,206,133],toColor:[194,140,124]},{fromColor:[194,140,124],toColor:[255,242,255]}]},{id:"temperature",type:"multipart",colorRamps:[{fromColor:[255,252,255],toColor:[255,0,255]},{fromColor:[255,0,255],toColor:[0,0,255]},{fromColor:[0,0,255],toColor:[0,
255,255]},{fromColor:[0,255,255],toColor:[0,255,0]},{fromColor:[0,255,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,128,0]},{fromColor:[255,128,0],toColor:[128,0,0]}]},{id:"white-to-black",fromColor:[255,255,255],toColor:[0,0,0]},{id:"yellow-to-dark-red",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[242,167,46]},{fromColor:[242,167,46],toColor:[107,0,0]}]},{id:"yellow-to-green-to-dark-blue",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[56,224,9]},{fromColor:[56,
224,9],toColor:[26,147,171]},{fromColor:[26,147,171],toColor:[12,16,120]}]},{id:"yellow-to-red",fromColor:[245,245,0],toColor:[255,0,0]},{id:"yellow-green-bright",fromColor:[236,252,204],toColor:[157,204,16]},{id:"yellow-green-light-to-dark",fromColor:[215,240,175],toColor:[96,107,45]}],A=new C.JSONMap({Aspect:"aspect","Black to White":"black-to-white","Blue Bright":"blue-bright","Blue Light to Dark":"blue-light-to-dark","Blue-Green Bright":"blue-green-bright","Blue-Green Light to Dark":"blue-green-light-to-dark",
"Brown Light to Dark":"brown-light-to-dark","Brown to Blue Green Diverging, Bright":"brown-to-blue-green-diverging-right","Brown to Blue Green Diverging, Dark":"brown-to-blue-green-diverging-dark","Coefficient Bias":"coefficient-bias","Cold to Hot Diverging":"cold-to-hot-diverging","Condition Number":"condition-number","Cyan to Purple":"cyan-to-purple","Cyan-Light to Blue-Dark":"cyan-light-to-blue-dark",Distance:"distance","Elevation #1":"elevation1","Elevation #2":"elevation2",Errors:"errors","Gray Light to Dark":"gray-light-to-dark",
"Green Bright":"green-bright","Green Light to Dark":"green-light-to-dark","Green to Blue":"green-to-blue","Orange Bright":"orange-bright","Orange Light to Dark":"orange-light-to-dark","Partial Spectrum":"partial-spectrum","Partial Spectrum 1 Diverging":"partial-spectrum-1-diverging","Partial Spectrum 2 Diverging":"partial-spectrum-2-diverging","Pink to YellowGreen Diverging, Bright":"pink-to-yellow-green-diverging-bright","Pink to YellowGreen Diverging, Dark":"pink-to-yellow-green-diverging-dark",
Precipitation:"precipitation",Prediction:"prediction","Purple Bright":"purple-bright","Purple to Green Diverging, Bright":"purple-to-green-diverging-bright","Purple to Green Diverging, Dark":"purple-to-green-diverging-dark","Purple-Blue Bright":"purple-blue-bright","Purple-Blue Light to Dark":"purple-blue-light-to-dark","Purple-Red Bright":"purple-red-bright","Purple-Red Light to Dark":"purple-red-light-to-dark","Red Bright":"red-bright","Red Light to Dark":"red-light-to-dark","Red to Blue Diverging, Bright":"red-to-blue-diverging-bright",
"Red to Blue Diverging, Dark":"red-to-blue-diverging-dark","Red to Green":"red-to-green","Red to Green Diverging, Bright":"red-to-green-diverging-bright","Red to Green Diverging, Dark":"red-to-green-diverging-dark",Slope:"slope","Spectrum-Full Bright":"spectrum-full-bright","Spectrum-Full Dark":"spectrum-full-dark","Spectrum-Full Light":"spectrum-full-light",Surface:"surface",Temperature:"temperature","White to Black":"white-to-black","Yellow to Dark Red":"yellow-to-dark-red","Yellow to Green to Dark Blue":"yellow-to-green-to-dark-blue",
"Yellow to Red":"yellow-to-red","Yellow-Green Bright":"yellow-green-bright","Yellow-Green Light to Dark":"yellow-green-light-to-dark"});P.PREDEFINED_JSON_COLOR_RAMPS=t;P.colorRampDict=A;P.convertColorRampToColormap=function(r,b){r=n(r,b);const f=b?.interpolateAlpha;r.forEach((d,e)=>{d.unshift(e);f||d.pop()});return r};P.convertColorRampToColors=n;P.convertRGBATo32Bit=function(r){r=r.reverse().map(b=>{b=b.toString(16);return 2>b.length?"0"+b:b});return 4294967295&Number.parseInt(r.join(""),16)};P.getColorRampId=
K;P.getColorRampJSON=function(r,b="esriCIELabAlgorithm"){const f=t.find(({id:d})=>d===r);return f?f.colorRamps?{type:"multipart",colorRamps:f.colorRamps.map(d=>({type:"algorithmic",algorithm:b,fromColor:[...d.fromColor],toColor:[...d.toColor]}))}:{type:"algorithmic",algorithm:b,fromColor:[...f.fromColor],toColor:[...f.toColor]}:null};P.getColorRampName=D;P.getRFxArgColorRampValue=function(r){const b=D(r);return b?"algorithmic"===r.type?{...c(r),Name:b}:r.colorRamps?(r=r.colorRamps.map(c),{type:"MultiPartColorRamp",
NumColorRamps:r.length,ArrayOfColorRamp:r,Name:b}):null:null};P.rasterColormapNames="random ndvi ndvi2 ndvi3 elevation gray hillshade".split(" ");Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/core/colorUtils":function(){define(["exports"],function(P){function w(D,G){const h=[];let m,n;if(D[0].length!==G.length)throw Error("dimensions do not match");const g=D.length,c=D[0].length;let t=0;for(m=0;m<g;m++){for(n=t=0;n<c;n++)t+=D[m][n]*G[n];h.push(t)}return h}function E(D){D=[D.r/
255,D.g/255,D.b/255].map(G=>.04045>=G?G/12.92:((G+.055)/1.055)**2.4);D=w(S,D);return{x:100*D[0],y:100*D[1],z:100*D[2]}}function C(D){D=w(K,[D.x/100,D.y/100,D.z/100]).map(G=>Math.min(1,Math.max(.0031308>=G?12.92*G:1.055*G**(1/2.4)-.055,0)));return{r:Math.round(255*D[0]),g:Math.round(255*D[1]),b:Math.round(255*D[2])}}function B(D){D=[D.x/95.047,D.y/100,D.z/108.883].map(G=>G>(6/29)**3?G**(1/3):1/3*(29/6)**2*G+4/29);return{l:116*D[1]-16,a:500*(D[0]-D[1]),b:200*(D[1]-D[2])}}function T(D){const G=D.l;D=
[(G+16)/116+D.a/500,(G+16)/116,(G+16)/116-D.b/200].map(h=>h>6/29?h**3:3*(6/29)**2*(h-4/29));return{x:95.047*D[0],y:100*D[1],z:108.883*D[2]}}function R(D){if("r"in D&&"g"in D&&"b"in D)return D;if("l"in D&&"c"in D&&"h"in D){var G=D.c,h=D.h;return C(T({l:D.l,a:G*Math.cos(h),b:G*Math.sin(h)}))}if("l"in D&&"a"in D&&"b"in D)return C(T(D));if("x"in D&&"y"in D&&"z"in D)return C(D);if("h"in D&&"s"in D&&"v"in D){h=(D.h+360)%360/60;G=D.v/100*255;D=D.s/100*G;const m=D*(1-Math.abs(h%2-1));switch(Math.floor(h)){case 0:h=
{r:D,g:m,b:0};break;case 1:h={r:m,g:D,b:0};break;case 2:h={r:0,g:D,b:m};break;case 3:h={r:0,g:m,b:D};break;case 4:h={r:m,g:0,b:D};break;case 5:case 6:h={r:D,g:0,b:m};break;default:h={r:0,g:0,b:0}}h.r=Math.round(h.r+G-D);h.g=Math.round(h.g+G-D);h.b=Math.round(h.b+G-D);return h}return D}const S=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],K=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];P.toHSV=function(D){if("h"in D&&"s"in D&&"v"in D)return D;var G=R(D);D=G.r;
const h=G.g,m=G.b;G=Math.max(D,h,m);const n=G-Math.min(D,h,m);D=0===n?0:G===D?(h-m)/n%6:G===h?(m-D)/n+2:(D-h)/n+4;0>D&&(D+=6);return{h:60*D,s:100*(0===n?0:n/G),v:100/255*G}};P.toLAB=function(D){return"l"in D&&"a"in D&&"b"in D?D:B(E(R(D)))};P.toLCH=function(D){if(!("l"in D&&"c"in D&&"h"in D)){var G=B(E(R(D)));D=G.l;var h=G.a;const m=G.b;G=Math.sqrt(h*h+m*m);h=Math.atan2(m,h);h=0<h?h:h+2*Math.PI;D={l:D,c:G,h}}return D};P.toRGB=R;P.toXYZ=function(D){return"x"in D&&"y"in D&&"z"in D?D:E(R(D))};Object.defineProperty(P,
Symbol.toStringTag,{value:"Module"})})},"esri/renderers/RasterShadedReliefRenderer":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../rest/support/colorRamps".split(" "),function(P,w,E,C,B,T,R,S,K,D){var G;E=G=function(h){function m(g){g=
h.call(this,g)||this;g.altitude=45;g.azimuth=315;g.colorRamp=null;g.hillshadeType="traditional";g.pixelSizePower=.664;g.pixelSizeFactor=.024;g.scalingType="none";g.type="raster-shaded-relief";g.zFactor=1;return g}P._inherits(m,h);var n=m.prototype;n.readColorRamp=function(g){return D.fromJSON(g)};n.clone=function(){return new G({hillshadeType:this.hillshadeType,altitude:this.altitude,azimuth:this.azimuth,zFactor:this.zFactor,scalingType:this.scalingType,pixelSizeFactor:this.pixelSizeFactor,pixelSizePower:this.pixelSizePower,
colorRamp:C.clone(this.colorRamp)})};return P._createClass(m)}(E.JSONSupport);w.__decorate([B.property({type:Number,json:{write:!0}})],E.prototype,"altitude",void 0);w.__decorate([B.property({type:Number,json:{write:!0}})],E.prototype,"azimuth",void 0);w.__decorate([B.property({types:D.types,json:{write:!0}})],E.prototype,"colorRamp",void 0);w.__decorate([S.reader("colorRamp")],E.prototype,"readColorRamp",null);w.__decorate([B.property({type:["traditional","multi-directional"],json:{write:!0}})],
E.prototype,"hillshadeType",void 0);w.__decorate([B.property({type:Number,json:{write:!0}})],E.prototype,"pixelSizePower",void 0);w.__decorate([B.property({type:Number,json:{write:!0}})],E.prototype,"pixelSizeFactor",void 0);w.__decorate([B.property({type:["none","adjusted"],json:{write:!0}})],E.prototype,"scalingType",void 0);w.__decorate([R.enumeration({rasterShadedRelief:"raster-shaded-relief"})],E.prototype,"type",void 0);w.__decorate([B.property({type:Number,json:{write:!0}})],E.prototype,"zFactor",
void 0);return E=G=w.__decorate([K.subclass("esri.renderers.RasterShadedReliefRenderer")],E)})},"esri/renderers/RasterStretchRenderer":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../core/accessorSupport/decorators/writer ./support/stretchRendererUtils ../rest/support/colorRamps".split(" "),
function(P,w,E,C,B,T,R,S,K,D,G,h){var m;E=m=function(n){function g(t){t=n.call(this,t)||this;t.colorRamp=null;t.computeGamma=!1;t.dynamicRangeAdjustment=!1;t.gamma=[];t.maxPercent=null;t.minPercent=null;t.numberOfStandardDeviations=null;t.outputMax=null;t.outputMin=null;t.sigmoidStrengthLevel=null;t.statistics=[];t.histograms=null;t.useGamma=!1;t.stretchType="none";t.type="raster-stretch";return t}P._inherits(g,n);var c=g.prototype;c.readColorRamp=function(t){if(t)return h.fromJSON(t)};c.writeStatistics=
function(t,A,r){t?.length&&(Array.isArray(t[0])||(t=t.map(b=>[b.min,b.max,b.avg,b.stddev])),A[r]=t)};c.readStretchType=function(t,A){t=A.stretchType;"number"===typeof t&&(t=G.stretchTypeFunctionEnum[t]);return G.stretchTypeJSONDict.read(t)};c.clone=function(){return new m({stretchType:this.stretchType,outputMin:this.outputMin,outputMax:this.outputMax,useGamma:this.useGamma,computeGamma:this.computeGamma,statistics:C.clone(this.statistics),gamma:C.clone(this.gamma),sigmoidStrengthLevel:this.sigmoidStrengthLevel,
numberOfStandardDeviations:this.numberOfStandardDeviations,minPercent:this.minPercent,maxPercent:this.maxPercent,colorRamp:C.clone(this.colorRamp),histograms:C.clone(this.histograms),dynamicRangeAdjustment:this.dynamicRangeAdjustment})};return P._createClass(g)}(E.JSONSupport);w.__decorate([B.property({types:h.types,json:{write:!0}})],E.prototype,"colorRamp",void 0);w.__decorate([S.reader("colorRamp")],E.prototype,"readColorRamp",null);w.__decorate([B.property({type:Boolean,json:{write:!0}})],E.prototype,
"computeGamma",void 0);w.__decorate([B.property({type:Boolean,json:{write:{target:"dra"},read:{source:"dra"}}})],E.prototype,"dynamicRangeAdjustment",void 0);w.__decorate([B.property({type:[Number],json:{write:!0}})],E.prototype,"gamma",void 0);w.__decorate([B.property({type:Number,json:{write:!0}})],E.prototype,"maxPercent",void 0);w.__decorate([B.property({type:Number,json:{write:!0}})],E.prototype,"minPercent",void 0);w.__decorate([B.property({type:Number,json:{write:!0}})],E.prototype,"numberOfStandardDeviations",
void 0);w.__decorate([B.property({type:Number,json:{read:{source:"max"},write:{target:"max"}}})],E.prototype,"outputMax",void 0);w.__decorate([B.property({type:Number,json:{read:{source:"min"},write:{target:"min"}}})],E.prototype,"outputMin",void 0);w.__decorate([B.property({type:Number,json:{write:!0}})],E.prototype,"sigmoidStrengthLevel",void 0);w.__decorate([B.property({json:{type:[[Number]],write:!0}})],E.prototype,"statistics",void 0);w.__decorate([B.property()],E.prototype,"histograms",void 0);
w.__decorate([D.writer("statistics")],E.prototype,"writeStatistics",null);w.__decorate([B.property({type:Boolean,json:{write:!0}})],E.prototype,"useGamma",void 0);w.__decorate([B.property({type:G.stretchTypeJSONDict.apiValues,json:{type:G.stretchTypeJSONDict.jsonValues,write:G.stretchTypeJSONDict.write}})],E.prototype,"stretchType",void 0);w.__decorate([S.reader("stretchType",["stretchType"])],E.prototype,"readStretchType",null);w.__decorate([R.enumeration({rasterStretch:"raster-stretch"})],E.prototype,
"type",void 0);return E=m=w.__decorate([K.subclass("esri.renderers.RasterStretchRenderer")],E)})},"esri/renderers/support/stretchRendererUtils":function(){define(["exports","../../core/jsonMap"],function(P,w){w=new w.JSONMap({none:"none",standardDeviation:"standard-deviation",histogramEqualization:"histogram-equalization",minMax:"min-max",percentClip:"percent-clip",sigmoid:"sigmoid"});P.stretchTypeFunctionEnum={0:"none",3:"standardDeviation",4:"histogramEqualization",5:"minMax",6:"percentClip",9:"sigmoid"};
P.stretchTypeJSONDict=w;Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/VectorFieldRenderer":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../Color ../geometry ../Graphic ../symbols ../core/jsonMap ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../geometry/support/normalizeUtils ../layers/support/rasterFunctions/vectorFieldUtils ./ClassBreaksRenderer ./mixins/VisualVariablesMixin ./support/ClassBreakInfo ./visualVariables/RotationVariable ./visualVariables/SizeVariable ./visualVariables/support/visualVariableUtils ../symbols/SimpleLineSymbol ../symbols/SimpleMarkerSymbol ../symbols/support/utils ../geometry/Point ../symbols/PictureMarkerSymbol".split(" "),
function(P,w,E,C,B,T,R,S,K,D,G,h,m,n,g,c,t,A,r,b,f,d,e,q,l,a,k){var p;const z=new Set(["esriMetersPerSecond","esriKilometersPerHour","esriKnots","esriFeetPerSecond","esriMilesPerHour"]);C=new R.JSONMap({beaufort_ft:"beaufort-ft",beaufort_km:"beaufort-km",beaufort_kn:"beaufort-kn",beaufort_m:"beaufort-m",beaufort_mi:"beaufort-mi",classified_arrow:"classified-arrow",ocean_current_kn:"ocean-current-kn",ocean_current_m:"ocean-current-m",simple_scalar:"simple-scalar",single_arrow:"single-arrow",wind_speed:"wind-barb"});
R=new R.JSONMap({flow_from:"flow-from",flow_to:"flow-to"});S=p=function(I){function N(H){H=I.call(this,H)||this;H.attributeField="Magnitude";H.flowRepresentation="flow-from";H.rotationType="arithmetic";H.style="single-arrow";H.symbolTileSize=50;H.type="vector-field";return H}P._inherits(N,I);var O=N.prototype;O.readInputUnit=function(H,u){return z.has(H)?c.unitKebabDict.fromJSON(H):null};O.readOutputUnit=function(H,u){return z.has(H)?c.unitKebabDict.fromJSON(H):null};O.clone=function(){return new p({attributeField:this.attributeField,
flowRepresentation:this.flowRepresentation,rotationType:this.rotationType,symbolTileSize:this.symbolTileSize,style:this.style,visualVariables:K.clone(this.visualVariables),inputUnit:this.inputUnit,outputUnit:this.outputUnit})};O.getGraphicsFromPixelData=async function(H,u=!1,y=[]){const x=[];var L=c.getUnitConversionFactor(this.inputUnit,this.outputUnit),Q=this.rotationVariables[0]?.rotationType||this.rotationType;u=u?c.convertVectorFieldData(H.pixelBlock,"vector-uv",Q,L):c.convertVectorFieldUnit(H.pixelBlock,
"vector-magdir",L);if(null==u)return x;H=H.extent;L=null!=u.mask&&0<u.mask.length;Q=0;const W=(H.xmax-H.xmin)/u.width,v=(H.ymax-H.ymin)/u.height;for(let J=0;J<u.height;J++)for(let M=0;M<u.width;M++,Q++){let U=new a({x:H.xmin+M*W+W/2,y:H.ymax-J*v-v/2,spatialReference:H.spatialReference});U=(await g.normalizeCentralMeridian(U))[0];var F=y.some(V=>V.intersects(U));L&&!u.mask[Q]||F||(F=new B({geometry:{type:"point",x:U.x,y:U.y,spatialReference:H.spatialReference},attributes:{Magnitude:u.pixels[0][Q],
Direction:u.pixels[1][Q]}}),F.symbol=this._getVisualVariablesAppliedSymbol(F),x.push(F))}return x};O.getSymbol=function(H,u){};O.getSymbolAsync=async function(H,u){};O.getSymbols=function(){return[]};O.getClassBreakInfos=function(){return this.styleRenderer?.classBreakInfos};O.getDefaultSymbol=function(){return this.styleRenderer?.defaultSymbol};O._getDefaultSymbol=function(H){return new q({path:"M14,32 14,18 9,23 16,3 22,23 17,18 17,32 z",outline:new e({width:0}),size:20,color:H||new E([0,92,230])})};
O._getVisualVariablesAppliedSymbol=function(H){if(H){var u=this.styleRenderer?.getSymbol(H)?.clone(),y=this.sizeVariables,x=this.rotationVariables;y&&y.length&&this.sizeVariables.forEach(L=>l.applySizesToSymbol(u,d.getAllSizes([L],H)));x&&x.length&&(H.attributes.Direction+="flow-to"===this.flowRepresentation===("ocean-current-kn"===this.style||"ocean-current-m"===this.style)?0:180,this.rotationVariables.forEach(L=>l.applyRotationToSymbol(u,d.getRotationAngle(L,H),L.axis)));return u}};O._createStyleRenderer=
function(H){let u={defaultSymbol:this._getDefaultSymbol(),classBreakInfos:[]};switch(H){case "single-arrow":u=this._createSingleArrowRenderer();break;case "beaufort-kn":u=this._createBeaufortKnotsRenderer();break;case "beaufort-m":u=this._createBeaufortMeterRenderer();break;case "beaufort-ft":u=this._createBeaufortFeetRenderer();break;case "beaufort-mi":u=this._createBeaufortMilesRenderer();break;case "beaufort-km":u=this._createBeaufortKilometersRenderer();break;case "ocean-current-m":u=this._createCurrentMeterRenderer();
break;case "ocean-current-kn":u=this._createCurrentKnotsRenderer();break;case "simple-scalar":u=this._createSimpleScalarRenderer();break;case "wind-barb":u=this._createWindBarbsRenderer();break;case "classified-arrow":u=this._createClassifiedArrowRenderer()}return new t(u)};O._createSingleArrowRenderer=function(){return{defaultSymbol:this._getDefaultSymbol()}};O._createBeaufortKnotsRenderer=function(){const H=this._getDefaultSymbol(new E([214,47,39])),u=this._getClassBreaks([0,1,3,6,10,16,21,27,33,
40,47,55,63],[[40,146,199],[89,162,186],[129,179,171],[160,194,155],[191,212,138],[218,230,119],[250,250,100],[252,213,83],[252,179,102],[250,141,52],[247,110,42],[240,71,29]]);return{defaultSymbol:H,classBreakInfos:u}};O._createBeaufortMeterRenderer=function(){const H=this._getDefaultSymbol(new E([214,47,39])),u=this._getClassBreaks([0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7],[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],
[250,185,132],[245,152,105],[237,117,81],[232,21,21]]);return{defaultSymbol:H,classBreakInfos:u}};O._createBeaufortFeetRenderer=function(){const H=this._getDefaultSymbol(new E([214,47,39]));var u=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];u=u.map(y=>3.28084*y);u=this._getClassBreaks(u,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]]);return{defaultSymbol:H,classBreakInfos:u}};
O._createBeaufortMilesRenderer=function(){const H=this._getDefaultSymbol(new E([214,47,39]));var u=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];u=u.map(y=>2.23694*y);u=this._getClassBreaks(u,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]]);return{defaultSymbol:H,classBreakInfos:u}};O._createBeaufortKilometersRenderer=function(){const H=this._getDefaultSymbol(new E([214,
47,39]));var u=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];u=u.map(y=>3.6*y);u=this._getClassBreaks(u,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]]);return{defaultSymbol:H,classBreakInfos:u}};O._createCurrentMeterRenderer=function(){const H=this._getDefaultSymbol(new E([177,177,177])),u=this._getClassBreaks([0,.5,1,1.5,2],[[78,26,153],[179,27,26],[202,128,26],[177,177,
177]]);return{defaultSymbol:H,classBreakInfos:u}};O._createCurrentKnotsRenderer=function(){const H=this._getDefaultSymbol(new E([177,177,177])),u=this._getClassBreaks([0,.25,.5,1,1.5,2,2.5,3,3.5,4],[[0,0,0],[0,37,100],[78,26,153],[151,0,100],[179,27,26],[177,78,26],[202,128,26],[177,179,52],[177,177,177]]);return{defaultSymbol:H,classBreakInfos:u}};O._createClassifiedArrowRenderer=function(){const H=this._getDefaultSymbol(new E([56,168,0]));var u=[0,1E-6,3.5,7,10.5,14];if(this.sizeVariables?.length){const y=
this.sizeVariables[0].minDataValue,x=this.sizeVariables[0].maxDataValue;if(y&&x){const L=(x-y)/5;u=Array.from(Array(6).keys()).map(Q=>y+L*Q)}}u=this._getClassBreaks(u,[[56,168,0],[139,309,0],[255,255,0],[255,128,0],[255,0,0]]);return{defaultSymbol:H,classBreakInfos:u}};O._createSimpleScalarRenderer=function(){return{defaultSymbol:k.fromJSON({imageData:"iVBORw0KGgoAAAANSUhEUgAAACsAAAArCAQAAABLVLlLAAAABGdBTUEAAYagMeiWXwAAAAJiS0dEAACqjSMyAAAACXBIWXMAAABIAAAASABGyWs+AAAC3ElEQVRIx9XXvW4cVRQH8N982btpsIREJECyiCXsxX4DKh6AliqGKCBBE2SlwlHgAbBD/AKmyEYUeQ1KahPZSZQvBCkQLTHZ7KGY8Xodz4w3a1NwbzVzz/znfJ//zbStVC5q3icKak9GAs2QIdDx3PtW/S011NW3p+M5Eomh11ipTIKe6+4LQzHaQ+G+63pIZNJJQXMpljwTwj1brpgx5w1zZlyx5Z4QnllEIm2xeeSUHBf0hV0bejo1Uh09G3aFvgXk7cCJFBc9EdaRVuHJJaOdKyTV2TVhYLMduNR0Q9gxL5GaaTDw8GzejrDRBpxWoGsySRW0dttKuattwNkIlFw2YXgzOdYq4Ox49PlM+JrKd5OusjTWhBuVxUfMX/KXXZ3WEmkuqa67wspR4BTbwtKr/5u4fFgStse/T7EifFPnnYl9zPq4vmUOPrRndgoHjDti1gOPqlyXoifcRNGQzUd31lDyfHmob1Gp35vSr+P6vilcQ5Egtyd8YF/ySg9NhPM+9M/IOaHwp5+PSZayXTvCogEUwlatC3J8LLwYtcWB8EuDXQVuCkV5/B4eNHb7wGBs87LBDS+xjdVSn09wq1G8dFM+9tSUhIGneLvUdniKxKpTYljCpu3j7rVWlHj/P23v4NPGUEyeCQnexe9lJjzEQqMjJs+EzNAX6B98dBZVRmroJx95x/A/6gln18EyfCUsl+qdXb/tjvfbw+mwforpUOBz4XLVoBwAn3aWnfeH246NyBXhrq7TTN5lNSP9RkU+puUJm3W2Tsdq0nZWM07srk7MwQrZSRysjjGWBLRJNsNbfj2JMR4AbxpU1XLAb9Mxfpsq5EjMuuiR8L0JiHOOBX3hiUvOmavN0nMueSzcceFk0BK4pMqLo7vDD1Z0qrtDx7Itt4Xwm9UqbMmk8S0Dtuzb2pvOU99Z1nLTOfleNmvfZfP2pYZmPfajwosKdDBNpacNpVGGsWX9CyDI8Xq/Sj6QAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE0LTExLTEwVDAzOjE3OjU4LTA1OjAwF+tHyQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMFQwMzoxNzo1OC0wNTowMGa2/3UAAAAASUVORK5CYII\x3d",
height:20,width:20,type:"esriPMS",angle:0})}};O._createWindBarbsRenderer=function(){const H=Array.from(Array(31).keys()).map(L=>5*L),u=[{range:"0-5",path:"M20 20 M5 20 A15 15 0 1 0 35 20 A15 15 0 1 0 5 20 M20 20 M10 20 A10 10 0 1 0 30 20 A10 10 0 1 0 10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTIwIDIwIE01IDIwIEExNSAxNSAwIDEgMCAzNSAyMCBBMTUgMTUgMCAxIDAgNSAyMCBNMjAgMjAgTTEwIDIwIEExMCAxMCAwIDEgMCAzMCAyMCBBMTAgMTAgMCAxIDAgMTAgMjAiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},
{range:"5-10",path:"M25 0 L25 40 M25 35 L17.5 37.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNyA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTTI1IDM1IEwxNy41IDM3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"10-15",path:"M25 0 L25 40 L10 45 L25 40",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNyA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"15-20",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L17.5 37.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjEyIDAgMTUgNDUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxNy41IDM3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"20-25",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNiA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCBNMjUgMzUgTDEwIDQwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},
{range:"25-30",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L17.5 32.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNiA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCBNMjUgMzUgTDEwIDQwIEwyNSAzNSBNMjUgMzAgTDE3LjUgMzIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"30-35",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"35-40",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxNy41IDI3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"40-45",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"45-50",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxNy41IDIyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},
{range:"50-55",path:"M25 0 L25 40 L10 40 L25 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"55-60",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L17.5 32.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxNy41IDMyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},
{range:"60-65",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"65-70",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxNy41IDI3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},
{range:"70-75",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"75-80",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxNy41IDIyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"80-85",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"85-90",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L17.5 17.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxNy41IDE3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"90-95",
path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxMCAyMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"95-100",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20 L25 15 M25 10 L17.5 12.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxMCAyMCBMMjUgMTUgTTI1IDEwIEwxNy41IDEyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"100-105",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"105-110",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDE3LjUgMjcuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"110-115",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},
{range:"115-120",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L17.5 22.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDE3LjUgMjIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"120-125",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"125-130",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L17.5 17.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDE3LjUgMTcuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"130-135",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"135-140",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDE3LjUgMTIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"140-145",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDEwIDE1IiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"145-150",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDEwIDE1IE0yNSAxMCBNMjUgNSBMMTcuNSA3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"}],y=k.fromJSON({imageData:"iVBORw0KGgoAAAANSUhEUgAAACgAAAApCAQAAADtq6NDAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJiS0dEAP+Hj8y/AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEY0lEQVRIx5XXWWxWRRQH8N+d+31tUdGAVjGglYJABFEBY91jfDAg7piYaFTccA++uMQEFRcSXlATtxiXqMQt4G4iisYl0ai4sIQYtVFZ1KIFKdTS0l4f7vRCS5fPebozc+bM/2z/Mzcx0AgSiUxXnKfIdMn875FIhX53U2n/B/s+kKM4UINTjTBZImixxnrv+9a2iL6zEoUBXcoudrWj/OtHm3wt02lfU9Qao9OnHvIhgmww84MEl1qnxfNmGrqHxAizLdPpC6chGcAxKGGcL+30gOERf1BSpUqVslQSV8d5ReZFe8VQ9avufJn31cWwlJV7iafKStGOE/1qvfH9qUxxu8ydUdmuSKbGO8YUdT2inKLG69pM70tliktl5qIkCAJGmusDG7Vqsc0WjZa4UBlBiA5YZIcjYzB7qDtH5kaUJFLs7RGZTZ42W4PRRmtwvbdt1+wGiaS4drEtDttdZYIDNVuAclR3vA3+dI3qHqmVSy7U6Tv1MScCPvPR7nIpFlsdCy3FdTLPGhK92e2CUITjMJ9ocwKxnsZqc3O3JwMma3d6UVLnyVxB4aXemZqvPqLdpJhW3KVVbY4yYImPo6M5Urv50fj+0z/FG9YaEiENs8UtMfXUaTeTePNHlhXfA1UU+2lyD1Il3Gtt9+adfpNG7dNlpg2U/T3KYLZ2dUWFdTgp3/rQ4sK973qnInV5TIf40x3dhvrJPBiqyWUo4wAtLqhQYS71qK+QKOFRywmGK/kpikzV6WMKhh58vGWs4TIJNjiEYLIuP8Tt4/zmLyqk+AyrJSbF+Qq1DgqRUPMxyl+9q3IQhX/rMCJ6tEunriDs1oSyQZKlr9AkhT2ZIARbJfaJS1vtVbHB+Rgi0RK/y1q1BWsEEyLoz40xtGKcARPVWB1BTPO7f4LNtpkUl1aoMbViLyZo0GRjPD3BxnxjqXeLYlvhqYrzMMG3HoyJXa3JjfnGlbYYFlP7Jh3qKsKY4hQ7TY0nG+xwRL61n63mxHtqNHosigyMLmClNwvuecFnOZB88nNBDzNkzhxEZaKMBVoKapggMzvHHXBEpNSSFAvtcFRsVn0bW8LlMmcXs+c0Kne3gRR32+zg4uXwjC6zit6Wt4a8LXVfcp/MtQXHn2ynGbuCmb8GvvFeJLEE82ReU9/n6+dkq2x3buG9Wn94smcgAw631RPR7BTH+kbmHReZoEpOdEe7zWqZl40s0JWs9Hmv7hjBHqPDwsjGKVJnWWqjbdZp1KhJi0aPmxYZsIRhlttgeF+Jlke41QcOQKoqilSb6HJzSvNG3G/UoWnxwsmt+sVaYwd63dRbqdnMyCPVeyRPvpYgdavM22oGKoMUVRbJfOWMwidJ8Zzb1UvmWK/VVUXzHaTjjrVYh1897HT7xxYEVUaa5SWb/WO+YUWa9SrwvigzM8YlzlYv2GSdVCYxxlBtVnnFq5olwp5/BEk/OLsf5LUmG2+inRJdVvjZ97ZH9/zP34ug1O91pf4p+D+JYBpvrKxfbwAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNC0xMS0xMFQwMzoxMjowOS0wNTowMB9ViV0AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTBUMDM6MTI6MDktMDU6MDBuCDHhAAAAAElFTkSuQmCC",
height:20,width:20,type:"esriPMS",angle:0}),x=H.map((L,Q)=>{if(Q!==H.length-1)if(0===Q)var W={minValue:L,maxValue:H[Q+1],symbol:y};else W=k.fromJSON({type:"esriPMS",imageData:u[Q].imageData,contentType:"image/svg+xml",height:32,width:32,angle:0}),W={minValue:L,maxValue:H[Q+1],symbol:W};return new r(W)});return{defaultSymbol:y,classBreakInfos:x}};O._getClassBreaks=function(H,u){return u.map((y,x)=>new r({minValue:H[x],maxValue:H[x+1],symbol:this._getDefaultSymbol(new E(y))}))};P._createClass(N,[{key:"styleRenderer",
get:function(){const H=this.attributeField,u=this._createStyleRenderer(this.style);u.field=H;return u}},{key:"sizeVariables",get:function(){const H=[];if(this.visualVariables)for(var u of this.visualVariables)"size"===u.type&&H.push(u);0===H.length&&(u=new f({field:"Magnitude",minSize:.2*this.symbolTileSize,maxSize:.8*this.symbolTileSize}),this.visualVariables?this.visualVariables.push(u):this._set("visualVariables",[u]),H.push(u));return H}},{key:"rotationVariables",get:function(){const H=[];if(this.visualVariables)for(var u of this.visualVariables)"rotation"===
u.type&&H.push(u);0===H.length&&(u=new b({field:"Direction",rotationType:this.rotationType}),this.visualVariables?this.visualVariables.push(u):this._set("visualVariables",[u]),H.push(u));return H}}]);return N}(A.VisualVariablesMixin(S.JSONSupport));w.__decorate([D.property({type:String,json:{write:!0}})],S.prototype,"attributeField",void 0);w.__decorate([D.property({type:R.apiValues,json:{type:R.jsonValues,read:{reader:R.read},write:{writer:R.write}}})],S.prototype,"flowRepresentation",void 0);w.__decorate([D.property({type:["geographic",
"arithmetic"],json:{write:!0}})],S.prototype,"rotationType",void 0);w.__decorate([D.property({type:C.apiValues,json:{type:C.jsonValues,read:{reader:C.read},write:{writer:C.write}}})],S.prototype,"style",void 0);w.__decorate([D.property({json:{write:!0}})],S.prototype,"symbolTileSize",void 0);w.__decorate([D.property({type:c.unitKebabDict.apiValues,json:{type:c.unitKebabDict.jsonValues,write:{writer:c.unitKebabDict.write}}})],S.prototype,"inputUnit",void 0);w.__decorate([m.reader("inputUnit")],S.prototype,
"readInputUnit",null);w.__decorate([D.property({type:c.unitKebabDict.apiValues,json:{type:c.unitKebabDict.jsonValues,read:{reader:c.unitKebabDict.read},write:{writer:c.unitKebabDict.write}}})],S.prototype,"outputUnit",void 0);w.__decorate([m.reader("outputUnit")],S.prototype,"readOutputUnit",null);w.__decorate([h.enumeration({vectorField:"vector-field"})],S.prototype,"type",void 0);w.__decorate([D.property({type:t})],S.prototype,"styleRenderer",null);w.__decorate([D.property({type:f})],S.prototype,
"sizeVariables",null);w.__decorate([D.property({type:b})],S.prototype,"rotationVariables",null);return S=p=w.__decorate([n.subclass("esri.renderers.VectorFieldRenderer")],S)})},"esri/layers/support/rasterFunctions/vectorFieldUtils":function(){define(["exports","../../../core/jsonMap","../PixelBlock","./pixelUtils"],function(P,w,E,C){function B(q,l){return c.get(q)/c.get(l)||1}function T(q,l="geographic"){const [a,k]=q;q=Math.sqrt(a*a+k*k);let p=Math.atan2(k,a)*t;p=(360+p)%360;"geographic"===l&&(p=
(450-p)%360);return[q,p]}function R(q,l="geographic"){let a=q[1];"geographic"===l&&(a=(450-a)%360);a%=360;q=q[0];return[q*Math.cos(a/t),q*Math.sin(a/t)]}function S(q,l,a="geographic",k=1){if(!C.isValidPixelBlock(q))return q;const {pixels:p,width:z,height:I}=q;var N=z*I;const O=p[0],H=p[1],u=q.pixelType.startsWith("f")?q.pixelType:"f32",y=E.createEmptyBand(u,N);N=E.createEmptyBand(u,N);let x=0;for(let L=0;L<I;L++)for(let Q=0;Q<z;Q++)"vector-uv"===l?([y[x],N[x]]=T([O[x],H[x]],a),y[x]*=k):([y[x],N[x]]=
R([O[x],H[x]],a),y[x]*=k,N[x]*=k),x++;q=new E({pixelType:u,width:q.width,height:q.height,mask:q.mask,validPixelCount:q.validPixelCount,maskIsAlpha:q.maskIsAlpha,pixels:[y,N]});q.updateStatistics();return q}function K(q=0,l=0,a=Math.PI,k=!0){k&&(a=(2*Math.PI-a)%(2*Math.PI));k=k?-1:1;const p=-7*k,z=-2*k,I=-16*k,[N,O]=G(0,l+13*k,a,21.75),[H,u]=G(q-5.5,l+p,a,21.75),[y,x]=G(q+5.5,l+p,a,21.75),[L,Q]=G(q-1.5,l+z,a,21.75),[W,v]=G(q+1.5,l+z,a,21.75),[F,J]=G(q-1.5,l+I,a,21.75),[M,U]=G(q+1.5,l+I,a,21.75);return[N,
O,H,u,L,Q,W,v,y,x,F,J,M,U]}function D(q=0,l=Math.PI,a=!0){a&&(l=(2*Math.PI-l)%(2*Math.PI));var k=a?-1:1,p=5*k;const z=20*k,I=25*k;k*=2;const N=a?1:-1;a=5*N;let [O,H]=[0+a,0-z],[u,y]=[O+2*N,H],[x,L]=[u-0*N,y+k],[Q,W]=[0-a,0-I],[v,F]=[Q+0*N,W-k],J=Math.ceil(q/5),M=Math.floor(J/10);J-=8*M;q=[];const U=[];for(let ja=0;ja<J/2;ja++,M--){0>=M&&1===J%2&&ja===(J-1)/2&&(Q=0,v=Q+0*N,W=(W+H)/2,F=W-k);const [ma,na]=G(Q,W,l,45);if(0<M){const [ra,qa]=G(u,W,l,45),[va,sa]=G(O,H,l,45);q.push(ra);q.push(qa);q.push(ma);
q.push(na);q.push(va);q.push(sa)}else{const [ra,qa]=G(u,y,l,45),[va,sa]=G(x,L,l,45),[xa,oa]=G(v,F,l,45);U.push(ma);U.push(na);U.push(xa);U.push(oa);U.push(va);U.push(sa);U.push(ra);U.push(qa)}W+=p;H+=p;y+=p;L+=p;F+=p}const [V,X]=G(0+a,0+z,l,45);p=7*N;const [Z,Y]=G(0+p,0+z,l,45),[ea,da]=G(0+a,0-I,l,45),[ia,fa]=G(0+p,0-I,l,45);return{pennants:q,barbs:U,shaft:[V,X,Z,Y,ea,da,ia,fa]}}function G(q,l,a,k=1){return[Math.sqrt(q*q+l*l)/k,(2*Math.PI+(2*Math.PI+Math.atan2(l,q))%(2*Math.PI)-a)%(2*Math.PI)]}function h(q,
l,a,k){a=B(k||"knots",a);for(k=1;k<l.length;k++)if(k===l.length-1){if(q<l[k]*a)break}else if(q<=l[k]*a)break;return Math.min(k-1,l.length-2)}function m(q,l,a,k,p){let z=0;switch(l){case "beaufort_kn":z=h(q,b,"knots",a);break;case "beaufort_km":z=h(q,b,"kilometer-per-hour",a);break;case "beaufort_ft":z=h(q,b,"feet-per-second",a);break;case "beaufort_m":z=h(q,b,"meter-per-second",a);break;case "classified_arrow":z=h(q,p??[],k,a);break;case "ocean_current_m":z=h(q,f,"meter-per-second",a);break;case "ocean_current_kn":z=
h(q,d,"knots",a)}return z}function n(q,l){const {style:a,inputUnit:k,outputUnit:p,breakValues:z}=l,I=A.fromJSON(k),N=A.fromJSON(p);let O=0,H=0;const {width:u,height:y,mask:x}=q,L=q.pixels[0];q=q.pixels[1];var Q=null!=x?x.filter(F=>0<F).length:u*y;const W=new Float32Array(42*Q);Q=new Uint32Array(15*Q);l=l.invertDirection?K(0,0,0,!1):r;for(let F=0;F<y;F++)for(let J=0;J<u;J++){var v=F*u+J;if(!x||x[F*u+J]){const M=(q[v]+360)%360/180*Math.PI,U=m(L[v],a,I,N,z);for(let V=0;V<l.length;V+=2)W[O++]=(J+.5)/
u,W[O++]=(F+.5)/y,W[O++]=l[V],W[O++]=l[V+1]+M,W[O++]=U,W[O++]=L[v];v=7*(O/42-1);Q[H++]=v;Q[H++]=v+1;Q[H++]=v+2;Q[H++]=v+0;Q[H++]=v+4;Q[H++]=v+3;Q[H++]=v+0;Q[H++]=v+2;Q[H++]=v+3;Q[H++]=v+2;Q[H++]=v+5;Q[H++]=v+3;Q[H++]=v+5;Q[H++]=v+6;Q[H++]=v+3}}return{vertexData:W,indexData:Q}}function g(q,l){let a=0,k=0;const {width:p,height:z,mask:I}=q;q=q.pixels[0];const N=[],O=[];var H=A.fromJSON(l.inputUnit);H=B(H,"knots");l="wind_speed"===l.style?5:Number.MAX_VALUE;for(let y=0;y<z;y++)for(let x=0;x<p;x++){var u=
q[y*p+x]*H;if((!I||I[y*p+x])&&u<l){for(let L=0;4>L;L++)N[a++]=(x+.5)/p,N[a++]=(y+.5)/z,N[a++]=2>L?-.5:.5,N[a++]=0===L%2?-.5:.5,N[a++]=0,N[a++]=u;u=4*(a/24-1);O[k++]=u;O[k++]=u+1;O[k++]=u+2;O[k++]=u+1;O[k++]=u+2;O[k++]=u+3}}return{vertexData:new Float32Array(N),indexData:new Uint32Array(O)}}const c=new Map;c.set("meter-per-second",1);c.set("kilometer-per-hour",.277778);c.set("knots",.514444);c.set("feet-per-second",.3048);c.set("mile-per-hour",.44704);const t=180/Math.PI,A=new w.JSONMap({esriMetersPerSecond:"meter-per-second",
esriKilometersPerHour:"kilometer-per-hour",esriKnots:"knots",esriFeetPerSecond:"feet-per-second",esriMilesPerHour:"mile-per-hour"}),r=K(0,0,0),b=[0,1,3,6,10,16,21,27,33,40,47,55,63],f=[0,.5,1,1.5,2],d=[0,.25,.5,1,1.5,2,2.5,3,3.5,4],e=[];P.convertToLocalDirections=function(q,l,a,k="geographic"){if(!C.isValidPixelBlock(q)||null==a)return q;q="vector-magdir"===l?q.clone():S(q,l);const p=q.pixels[1];for(let z=0;z<p.length;z++)p[z]="geographic"===k?(p[z]+a[z]+270)%360:(p[z]+360-a[z])%360;return"vector-magdir"===
l?q:S(q,"vector-magdir")};P.convertVectorFieldData=S;P.convertVectorFieldUnit=function(q,l,a=1){if(1===a||!C.isValidPixelBlock(q))return q;q=q.clone();const {pixels:k,width:p,height:z}=q,I=k[0],N=k[1];let O=0;for(let H=0;H<z;H++)for(let u=0;u<p;u++)"vector-uv"===l?(I[O]*=a,N[O]*=a):I[O]*=a,O++;q.updateStatistics();return q};P.createVFMesh=function(q,l){if("simple_scalar"===l.style)l=g(q,l);else if("wind_speed"===l.style){if(0===e.length)for(var a=0;30>a;a++)e.push(D(5*a,0,!l.invertDirection));l=A.fromJSON(l.inputUnit);
l=B(l,"knots");const {width:I,height:N,mask:O}=q;a=q.pixels[0];q=q.pixels[1];const H=[],u=[];let y=0,x=0;for(let L=0;L<N;L++)for(let Q=0;Q<I;Q++){var k=L*I+Q,p=a[k]*l;if((!O||O[L*I+Q])&&5<=p){const W=(q[k]+360)%360/180*Math.PI,{pennants:v,barbs:F,shaft:J}=e[Math.min(Math.floor(p/5),29)];if(0===v.length+F.length)continue;k=H.length/6;const M=(Q+.5)/I,U=(L+.5)/N;for(var z=0;z<v.length;z+=2)H[y++]=M,H[y++]=U,H[y++]=v[z],H[y++]=v[z+1]+W,H[y++]=0,H[y++]=p;for(z=0;z<F.length;z+=2)H[y++]=M,H[y++]=U,H[y++]=
F[z],H[y++]=F[z+1]+W,H[y++]=0,H[y++]=p;for(z=0;z<J.length;z+=2)H[y++]=M,H[y++]=U,H[y++]=J[z],H[y++]=J[z+1]+W,H[y++]=0,H[y++]=p;for(p=0;p<v.length/6;p++)u[x++]=k,u[x++]=k+1,u[x++]=k+2,k+=3;for(p=0;p<F.length/8;p++)u[x++]=k,u[x++]=k+1,u[x++]=k+2,u[x++]=k+1,u[x++]=k+2,u[x++]=k+3,k+=4;u[x++]=k+0;u[x++]=k+1;u[x++]=k+2;u[x++]=k+1;u[x++]=k+3;u[x++]=k+2;k+=4}}l={vertexData:new Float32Array(H),indexData:new Uint32Array(u)}}else l=n(q,l);return l};P.createVFMeshScalar=g;P.getUnitConversionFactor=B;P.sampleVectorField=
function(q,l,a,k=[0,0],p=.5){const {width:z,height:I,mask:N}=q,[O,H]=q.pixels,[u,y]=k;q=Math.round((z-u)/a);k=Math.round((I-y)/a);var x=q*k;const L=new Float32Array(x),Q=new Float32Array(x);x=new Uint8Array(x);l="vector-uv"===l;for(let v=0;v<k;v++)for(let F=0;F<q;F++){let J=0;const M=v*q+F,U=Math.max(0,v*a+y),V=Math.max(0,F*a+u),X=Math.min(I,U+a),Z=Math.min(z,V+a);for(let Y=U;Y<X;Y++)for(let ea=V;ea<Z;ea++){var W=Y*z+ea;if(!N||N[W]){J++;W=l?[O[W],H[W]]:[O[W],(360+H[W])%360];const [da,ia]=l?W:R(W);
L[M]+=da;Q[M]+=ia}}if(J>=(X-U)*(Z-V)*(1-p)){x[M]=1;const [Y,ea]=T([L[M]/J,Q[M]/J]);L[M]=Y;Q[M]=ea}else x[M]=0,L[M]=0,Q[M]=0}a=new E({width:q,height:k,pixels:[L,Q],mask:x});a.updateStatistics();return a};P.snapImageToSymbolTile=function(q,l,a,k,p){if(null==p||!p.spatialReference.equals(q.spatialReference))return{extent:q,width:Math.round(l/k),height:Math.round(a/k),resolution:q.width/l};const z=p.xmin;p=p.ymax;l=(q.xmax-q.xmin)/l*k;a=(q.ymax-q.ymin)/a*k;q.xmin=z+Math.floor((q.xmin-z)/l)*l;q.xmax=z+
Math.ceil((q.xmax-z)/l)*l;q.ymin=p+Math.floor((q.ymin-p)/a)*a;q.ymax=p+Math.ceil((q.ymax-p)/a)*a;return{extent:q,width:Math.round(q.width/l),height:Math.round(q.height/a),resolution:(l+a)/2}};P.unitKebabDict=A;P.uvComponentToVector=T;Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/PixelBlock":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Error ../../core/JSONSupport ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/subclass ./SimpleBandStatistics ./rasterFormats/pixelRangeUtils".split(" "),
function(P,w,E,C,B,T,R,S,K,D,G){var h;C=h=function(m){function n(c){c=m.call(this,c)||this;c.width=null;c.height=null;c.pixelType="f32";c.validPixelCount=null;c.mask=null;c.maskIsAlpha=!1;c.premultiplyAlpha=!1;c.statistics=null;c.depthCount=1;return c}P._inherits(n,m);n.createEmptyBand=function(c,t){return new (h.getPixelArrayConstructor(c))(t)};n.getPixelArrayConstructor=function(c){let t;switch(c){case "u1":case "u2":case "u4":case "u8":t=Uint8Array;break;case "u16":t=Uint16Array;break;case "u32":t=
Uint32Array;break;case "s8":t=Int8Array;break;case "s16":t=Int16Array;break;case "s32":t=Int32Array;break;case "f32":t=Float32Array;break;case "f64":t=Float64Array;break;case "c64":case "c128":case "unknown":t=Float32Array}return t};var g=n.prototype;g.castPixelType=function(c){if(!c)return"f32";c=c.toLowerCase();["u1","u2","u4"].includes(c)?c="u8":"unknown u8 s8 u16 s16 u32 s32 f32 f64".split(" ").includes(c)||(c="f32");return c};g.getPlaneCount=function(){return this.pixels?.length};g.addData=function(c){if(!c.pixels||
c.pixels.length!==this.width*this.height)throw new E("pixelblock:invalid-or-missing-pixels","add data requires valid pixels array that has same length defined by pixel block width * height");this.pixels||(this.pixels=[]);this.statistics||(this.statistics=[]);this.pixels.push(c.pixels);this.statistics.push(c.statistics??new D.SimpleBandStatistics)};g.getAsRGBA=function(){const c=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case "s8":case "s16":case "u16":case "s32":case "u32":case "f32":case "f64":this._fillFromNon8Bit(c);
break;default:this._fillFrom8Bit(c)}return new Uint8ClampedArray(c)};g.getAsRGBAFloat=function(){const c=new Float32Array(this.width*this.height*4);this._fillFrom32Bit(c);return c};g.updateStatistics=function(){if(this.pixels){this.statistics=this.pixels.map(A=>this._calculateBandStatistics(A,this.mask));var c=this.mask,t=0;if(null!=c)for(let A=0;A<c.length;A++)c[A]&&t++;else t=this.width*this.height;this.validPixelCount=t}};g.clamp=function(c){if(c&&"f64"!==c&&"f32"!==c&&this.pixels){var [t,A]=G.getPixelValueRange(c),
r=this.pixels,b=this.width*this.height,f=r.length,d=[];for(let a=0;a<f;a++){var e=h.createEmptyBand(c,b);var q=r[a];for(let k=0;k<b;k++){var l=q[k];e[k]=l>A?A:l<t?t:l}d.push(e)}this.pixels=d;this.pixelType=c}};g.extractBands=function(c){const {pixels:t,statistics:A}=this;if(null==c||0===c.length||!t||0===t.length)return this;var r=t.length,b=c.some(a=>a>=t.length),f=r===c.length&&!c.some((a,k)=>a!==k);if(b||f)return this;r=this.bandMasks?.length===r?c.map(a=>this.bandMasks[a]):void 0;let {mask:d,
validPixelCount:e}=this;const {width:q,height:l}=this;if(r){if(1===r.length)d=r[0];else for(b=q*l,d=(new Uint8Array(b)).fill(255),f=0;f<r.length;f++){const a=r[f];for(let k=0;k<b;k++)a[k]||(d[k]=0)}e=d.filter(a=>!!a).length}return new h({pixelType:this.pixelType,width:q,height:l,mask:d,bandMasks:r,validPixelCount:e,maskIsAlpha:this.maskIsAlpha,pixels:c.map(a=>t[a]),statistics:A&&c.map(a=>A[a])})};g.clone=function(){const c=new h({width:this.width,height:this.height,pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,
validPixelCount:this.validPixelCount});null!=this.mask&&(c.mask=this.mask instanceof Uint8Array?new Uint8Array(this.mask):this.mask.slice(0));this.bandMasks&&(c.bandMasks=this.bandMasks.map(r=>new Uint8Array(r)));let t;const A=h.getPixelArrayConstructor(this.pixelType);if(this.pixels&&0<this.pixels.length){c.pixels=[];const r=!!this.pixels[0].slice;for(t=0;t<this.pixels.length;t++)c.pixels[t]=r?this.pixels[t].slice(0,this.pixels[t].length):new A(this.pixels[t])}if(this.statistics)for(c.statistics=
[],t=0;t<this.statistics.length;t++)c.statistics[t]=B.clone(this.statistics[t]);c.premultiplyAlpha=this.premultiplyAlpha;return c};g._fillFrom8Bit=function(c){const {mask:t,maskIsAlpha:A,premultiplyAlpha:r,pixels:b}=this;if(c&&b&&b.length){var f,d;var e=f=d=b[0];3<=b.length?(f=b[1],d=b[2]):2===b.length&&(f=b[1]);var q=new Uint32Array(c),l=this.width*this.height;if(e.length!==l)T.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");else if(null!=t&&t.length===
l)if(A)for(c=0;c<l;c++){const a=t[c];if(a){const k=a/255;q[c]=r?a<<24|d[c]*k<<16|f[c]*k<<8|e[c]*k:a<<24|d[c]<<16|f[c]<<8|e[c]}}else for(c=0;c<l;c++)t[c]&&(q[c]=-16777216|d[c]<<16|f[c]<<8|e[c]);else for(c=0;c<l;c++)q[c]=-16777216|d[c]<<16|f[c]<<8|e[c]}else T.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")};g._fillFromNon8Bit=function(c){const {pixels:t,mask:A,statistics:r}=this;if(c&&t&&t.length){var b=this.pixelType,f=1,d=0;f=1;if(r&&0<r.length){for(var e of r)null!=
e.minValue&&(d=Math.min(d,e.minValue)),null!=e.maxValue&&null!=e.minValue&&(f=Math.max(f,e.maxValue-e.minValue));f=255/f}else f=255,"s8"===b?(d=-128,f=127):"u16"===b?f=65535:"s16"===b?(d=-32768,f=32767):"u32"===b?f=4294967295:"s32"===b?(d=-2147483648,f=2147483647):"f32"===b?(d=-3.4*1E39,f=3.4*1E39):"f64"===b&&(d=-Number.MAX_VALUE,f=Number.MAX_VALUE),f=255/(f-d);c=new Uint32Array(c);b=this.width*this.height;var q,l,a;e=q=l=t[0];if(e.length!==b)return T.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");
if(2<=t.length)if(q=t[1],3<=t.length&&(l=t[2]),null!=A&&A.length===b)for(a=0;a<b;a++)A[a]&&(c[a]=-16777216|(l[a]-d)*f<<16|(q[a]-d)*f<<8|(e[a]-d)*f);else for(a=0;a<b;a++)c[a]=-16777216|(l[a]-d)*f<<16|(q[a]-d)*f<<8|(e[a]-d)*f;else if(null!=A&&A.length===b)for(a=0;a<b;a++)q=(e[a]-d)*f,A[a]&&(c[a]=-16777216|q<<16|q<<8|q);else for(a=0;a<b;a++)q=(e[a]-d)*f,c[a]=-16777216|q<<16|q<<8|q}else T.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")};g._fillFrom32Bit=
function(c){const {pixels:t,mask:A}=this;if(!c||!t||!t.length)return T.getLogger(this).error("getAsRGBAFloat()","Unable to convert to RGBA. The input pixel block is empty.");let r,b,f,d;r=b=f=t[0];3<=t.length?(b=t[1],f=t[2]):2===t.length&&(b=t[1]);const e=this.width*this.height;if(r.length!==e)return T.getLogger(this).error("getAsRGBAFloat()","Unable to convert to RGBA. The pixelblock is invalid.");let q=0;if(null!=A&&A.length===e)for(d=0;d<e;d++)c[q++]=r[d],c[q++]=b[d],c[q++]=f[d],c[q++]=A[d]&1;
else for(d=0;d<e;d++)c[q++]=r[d],c[q++]=b[d],c[q++]=f[d],c[q++]=1};g._calculateBandStatistics=function(c,t){let A=Infinity,r=-Infinity;const b=c.length;let f,d=0;if(null!=t)for(f=0;f<b;f++)t[f]&&(d=c[f],A=d<A?d:A,r=d>r?d:r);else for(f=0;f<b;f++)d=c[f],A=d<A?d:A,r=d>r?d:r;return new D.SimpleBandStatistics(A,r)};return P._createClass(n)}(C.JSONSupport);w.__decorate([R.property({json:{write:!0}})],C.prototype,"width",void 0);w.__decorate([R.property({json:{write:!0}})],C.prototype,"height",void 0);w.__decorate([R.property({json:{write:!0}})],
C.prototype,"pixelType",void 0);w.__decorate([S.cast("pixelType")],C.prototype,"castPixelType",null);w.__decorate([R.property({json:{write:!0}})],C.prototype,"validPixelCount",void 0);w.__decorate([R.property({json:{write:!0}})],C.prototype,"mask",void 0);w.__decorate([R.property({json:{write:!0}})],C.prototype,"maskIsAlpha",void 0);w.__decorate([R.property({json:{write:!0}})],C.prototype,"pixels",void 0);w.__decorate([R.property()],C.prototype,"premultiplyAlpha",void 0);w.__decorate([R.property({json:{write:!0}})],
C.prototype,"statistics",void 0);w.__decorate([R.property({json:{write:!0}})],C.prototype,"depthCount",void 0);w.__decorate([R.property({json:{write:!0}})],C.prototype,"noDataValues",void 0);w.__decorate([R.property({json:{write:!0}})],C.prototype,"bandMasks",void 0);return C=h=w.__decorate([K.subclass("esri.layers.support.PixelBlock")],C)})},"esri/layers/support/SimpleBandStatistics":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers"],function(P,w){w=w._createClass(function(E=
null,C=null,B=null){this.minValue=E;this.maxValue=C;this.noDataValue=B});P.SimpleBandStatistics=w;Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/pixelRangeUtils":function(){define(["exports"],function(P){function w(C){return E[C]??[-3.4028234663852886E38,3.4028234663852886E38]}const E={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-3.4028234663852886E38,
3.4028234663852886E38],f64:[-Number.MAX_VALUE,Number.MAX_VALUE],unknown:void 0,c64:void 0,c128:void 0};P.convertNoDataToMask=function(C,B,T){if(!(C.depthCount&&1<C.depthCount)){var {pixels:R,statistics:S,pixelType:K}=C,D=R[0].length,G=C.bandMasks??[],h=C.mask??(new Uint8Array(D)).fill(255),m="f32"===K||"f64"===K,n=w(K),g=!1;for(let A=0;A<R.length;A++){const r="number"===typeof B?B:B[A];if(null==r)continue;var c=S?.[A].maxValue??n[1];if((S?.[A].minValue??n[0])>r+Number.EPSILON||c<r-Number.EPSILON)continue;
c=G[A]||(new Uint8Array(D)).fill(255);const b=R[A];var t=T?.customFloatTolerance;if(m&&0!==t){t||(t=9.999999E37<=Math.abs(r)?2E-7*Math.abs(r):"f32"===K?2**-23:Number.EPSILON);for(let f=0;f<b.length;f++)c[f]&&Math.abs(b[f]-r)<t&&(b[f]=0,c[f]=0,h[f]=0,g=!0)}else for(t=0;t<b.length;t++)c[t]&&b[t]===r&&(b[t]=0,c[t]=0,h[t]=0,g=!0);G[A]=c}g&&(C.bandMasks=G,C.mask=h);g&&"updateStatistics"in C&&C.updateStatistics()}};P.getPixelValueRange=w;Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/pixelUtils":function(){define(["exports",
"../PixelBlock","../rasterFormats/pixelRangeUtils"],function(P,w,E){function C(b){return null!=b&&"esri.layers.support.PixelBlock"===b.declaredClass&&b.pixels&&0<b.pixels.length}function B(b,f,d,e,q){const l=b.length;q=w.createEmptyBand(q,l);if(f)for(let a=0;a<l;a++)f[a]&&(q[a]=d[b[a]-e]);else for(f=0;f<l;f++)q[f]=d[b[f]-e];return q}function T(b,f,d,e){const q=null!=d&&2<=d.length?new Set(d):null;d=1===d?.length?d[0]:null;const l=!!f?.length;for(let a=0;a<b.length;a++)if(e[a]){const k=b[a];if(l){let p=
!1;for(let z=0;z<f.length;z+=2)if(k>=f[z]&&k<=f[z+1]){p=!0;break}p||(e[a]=0)}e[a]&&(k===d||q?.has(k))&&(e[a]=0)}}function R(b,f){const d=b[0].length;for(let e=0;e<d;e++)if(f[e]){let q=!1;for(let l=0;l<b.length;l++)if(b[l][e]){q=!0;break}q||(f[e]=0)}}function S(b,f){const d=b[0].length;for(let e=0;e<d;e++)if(f[e]){let q=!1;for(let l=0;l<b.length;l++)if(0===b[l][e]){q=!0;break}q&&(f[e]=0)}}function K(b,f,d,e,q,l,a,k){return{xmin:q<=d*b?0:q<d*b+b?q-d*b:b,ymin:l<=e*f?0:l<e*f+f?l-e*f:f,xmax:q+a<=d*b?0:
q+a<d*b+b?q+a-d*b:b,ymax:l+k<=e*f?0:l+k<e*f+f?l+k-e*f:f}}function D(b,f,d,e,q,l){const {width:a,height:k}=d.block,{x:p,y:z}=d.offset,{width:I,height:N}=d.mosaic;d=K(a,k,e,q,p,z,I,N);let O=0;var H=0;if(l){var u=l.hasGCSSShiftTransform?360:l.halfWorldWidth??0,y=a*l.resolutionX;const x=l.startX+e*y;x<u&&x+y>u?H=l.rightPadding:x>=u&&(O=l.leftMargin-l.rightPadding,H=0)}d.xmax-=H;if("number"===typeof f)for(l=d.ymin;l<d.ymax;l++)for(H=(q*k+l-z)*I+(e*a-p)+O,u=d.xmin;u<d.xmax;u++)b[H+u]=f;else for(l=d.ymin;l<
d.ymax;l++)for(H=(q*k+l-z)*I+(e*a-p)+O,u=l*a,y=d.xmin;y<d.xmax;y++)b[H+y]=f[u+y]}function G(b,f,d={}){const {clipOffset:e,clipSize:q,alignmentInfo:l,blockWidths:a}=d;if(a)return h(b,f,{blockWidths:a});var k=b.find(W=>C(W));if(null==k)return null;d=q?q.width:f.width;const p=q?q.height:f.height;var z=k.width,I=k.height;const N=f.width/z,O=f.height/I;f={offset:e||{x:0,y:0},mosaic:q||f,block:{width:z,height:I}};z=k.pixelType;var H=w.getPixelArrayConstructor(z);k=k.pixels.length;I=[];for(var u=0;u<k;u++){var y=
new H(d*p);for(var x=0;x<O;x++)for(var L=0;L<N;L++){var Q=b[x*N+L];C(Q)&&(Q=Q.pixels[u],D(y,Q,f,L,x,l))}I.push(y)}H=b.some(W=>null==W||null!=W.mask&&0<W.mask.length);y=b.some(W=>null!=W&&W.bandMasks&&1<W.bandMasks.length);H=H?new Uint8Array(d*p):void 0;y=y?[]:void 0;if(H){for(u=0;u<O;u++)for(x=0;x<N;x++)L=b[u*N+x],Q=null!=L?L.mask:null,null!=Q?D(H,Q,f,x,u,l):L?D(H,255,f,x,u,l):D(H,0,f,x,u,l);if(y)for(u=0;u<k;u++){x=new Uint8Array(d*p);for(L=0;L<O;L++)for(Q=0;Q<N;Q++){const W=b[L*N+Q],v=W?.bandMasks?.[u]??
W?.mask;null!=v?D(x,v,f,Q,L,l):W?D(x,255,f,Q,L,l):D(x,0,f,Q,L,l)}y.push(x)}}b=new w({width:d,height:p,pixels:I,pixelType:z,bandMasks:y,mask:H});b.updateStatistics();return b}function h(b,f,d){const e=b.find(x=>null!=x);if(null==e)return null;var q=b.some(x=>null!=x?!!x.mask:!0);const {width:l,height:a}=f;f=q?new Uint8Array(l*a):null;({blockWidths:d}=d);const k=[],p=e.getPlaneCount(),z=w.getPixelArrayConstructor(e.pixelType);if(q)for(let x=0,L=0;x<b.length;L+=d[x],x++)if(q=b[x],C(q)){var I=q.mask;
for(var N=0;N<a;N++)for(var O=0;O<d[x];O++)f[N*l+O+L]=null==I?255:I[N*q.width+O]}I=(q=b.some(x=>null!=x&&x.bandMasks&&1<x.bandMasks.length))?[]:void 0;N=l*a;for(O=0;O<p;O++){const x=new z(N),L=q?new Uint8Array(N):void 0;for(let Q=0,W=0;Q<b.length;W+=d[Q],Q++){const v=b[Q];if(C(v)){var H=v.pixels[O];if(null!=H){for(var u=0;u<a;u++)for(var y=0;y<d[Q];y++)x[u*l+y+W]=H[u*v.width+y];if(L)for(H=v.bandMasks?.[O]??v.mask,u=0;u<a;u++)for(y=0;y<d[Q];y++)L[u*l+y+W]=H?H[u*v.width+y]:255}}}k.push(x);I&&L&&I.push(L)}b=
new w({width:l,height:a,mask:f,bandMasks:I,pixels:k,pixelType:e.pixelType});b.updateStatistics();return b}function m(b){if(!C(b))return null;const f=b.clone(),{width:d,height:e,pixels:q}=b;var l=q[0];const a=f.pixels[0];b=b.mask;for(let z=2;z<e-1;z++){const I=new Map;for(var k=z-2;k<z+2;k++)for(var p=0;4>p;p++){const N=k*d+p;c(I,l[N],b?b[N]:1)}a[z*d]=n(I);a[z*d+1]=a[z*d+2]=a[z*d];for(k=3;k<d-1;k++)p=(z-2)*d+k+1,c(I,l[p],b?b[p]:1),p=(z-1)*d+k+1,c(I,l[p],b?b[p]:1),p=z*d+k+1,c(I,l[p],b?b[p]:1),p=(z+
1)*d+k+1,c(I,l[p],b?b[p]:1),p=(z-2)*d+k-3,g(I,l[p],b?b[p]:1),p=(z-1)*d+k-3,g(I,l[p],b?b[p]:1),p=z*d+k-3,g(I,l[p],b?b[p]:1),p=(z+1)*d+k-3,g(I,l[p],b?b[p]:1),a[z*d+k]=n(I);a[z*d+k+1]=a[z*d+k]}for(l=0;l<d;l++)a[l]=a[d+l]=a[2*d+l],a[(e-1)*d+l]=a[(e-2)*d+l];f.updateStatistics();return f}function n(b){if(0===b.size)return 0;let f=0,d=-1,e=0;const q=b.keys();let l=q.next();for(;!l.done;)e=b.get(l.value),e>f&&(d=l.value,f=e),l=q.next();return d}function g(b,f,d){0!==d&&(d=b.get(f),1===d?b.delete(f):b.set(f,
d-1))}function c(b,f,d){0!==d&&b.set(f,b.has(f)?b.get(f)+1:1)}function t(b,f,d){let {x:e,y:q}=f;const {width:l,height:a}=d;if(0===e&&0===q&&a===b.height&&l===b.width)return b;const {width:k,height:p}=b;f=Math.max(0,q);const z=Math.max(0,e),I=Math.min(e+l,k),N=Math.min(q+a,p);if(0>I||0>N||!C(b))return null;e=Math.max(0,-e);q=Math.max(0,-q);var {pixels:O}=b,H=l*a,u=O.length;const y=[];for(var x=0;x<u;x++){var L=O[x],Q=w.createEmptyBand(b.pixelType,H);for(let W=f;W<N;W++){const v=W*k;let F=(W+q-f)*l+
e;for(let J=z;J<I;J++)Q[F++]=L[v+J]}y.push(Q)}O=new Uint8Array(H);H=b.mask;for(u=f;u<N;u++)for(x=u*k,L=(u+q-f)*l+e,Q=z;Q<I;Q++)O[L++]=H?H[x+Q]:1;b=new w({width:d.width,height:d.height,pixelType:b.pixelType,pixels:y,mask:O});b.updateStatistics();return b}function A(b,f=!0){if(!C(b))return null;const {pixels:d,width:e,height:q,mask:l,pixelType:a}=b;b=[];const k=Math.round(e/2),p=Math.round(q/2),z=q-1,I=e-1;for(var N=0;N<d.length;N++){var O=d[N],H=w.createEmptyBand(a,k*p),u=0;for(var y=0;y<q;y+=2)for(var x=
0;x<e;x+=2){var L=O[y*e+x];if(f){var Q=x===I?L:O[y*e+x+1];const W=y===z?L:O[y*e+x+e],v=x===I?W:y===z?Q:O[y*e+x+e+1];H[u++]=(L+Q+W+v)/4}else H[u++]=L}b.push(H)}N=null;if(null!=l)for(N=new Uint8Array(k*p),O=0,H=0;H<q;H+=2)for(u=0;u<e;u+=2)y=l[H*e+u],f?(x=u===I?y:l[H*e+u+1],L=H===z?y:l[H*e+u+e],Q=u===I?L:H===z?x:l[H*e+u+e+1],N[O++]=y*x*L*Q?1:0):N[O++]=y;return new w({width:k,height:p,pixelType:a,pixels:b,mask:N})}function r(b,f,d,e,q=0){const {width:l,height:a}=b,{width:k,height:p}=f;b=e.cols;e=e.rows;
f=Math.ceil(k/b-.1/b);const z=Math.ceil(p/e-.1/e);let I,N,O,H,u;const y=f*b;var x=y*z*e;const L=new Float32Array(x),Q=new Float32Array(x),W=new Uint32Array(x),v=new Uint32Array(x);let F=0,J,M;for(let X=0;X<z;X++)for(let Z=0;Z<f;Z++){var U=12*(X*f+Z);x=d[U];I=d[U+1];N=d[U+2];O=d[U+3];H=d[U+4];u=d[U+5];for(var V=0;V<e;V++){F=(X*e+V)*y+Z*b;M=(V+.5)/e;for(let Y=0;Y<V;Y++)J=(Y+.5)/b,L[F+Y]=(x*J+I*M+N)*l+q,Q[F+Y]=(O*J+H*M+u)*a+q,W[F+Y]=Math.floor(L[F+Y]),v[F+Y]=Math.floor(Q[F+Y])}U+=6;x=d[U];I=d[U+1];N=
d[U+2];O=d[U+3];H=d[U+4];u=d[U+5];for(U=0;U<e;U++)for(F=(X*e+U)*y+Z*b,M=(U+.5)/e,V=U;V<b;V++)J=(V+.5)/b,L[F+V]=(x*J+I*M+N)*l+q,Q[F+V]=(O*J+H*M+u)*a+q,W[F+V]=Math.floor(L[F+V]),v[F+V]=Math.floor(Q[F+V])}return{offsets_x:L,offsets_y:Q,offsets_xi:W,offsets_yi:v,gridWidth:y}}P.NoDataInterpretation=void 0;(function(b){b[b.matchAny=0]="matchAny";b[b.matchAll=1]="matchAll"})(P.NoDataInterpretation||(P.NoDataInterpretation={}));P.MissingBandAction=void 0;(function(b){b[b.bestMatch=0]="bestMatch";b[b.fail=
1]="fail"})(P.MissingBandAction||(P.MissingBandAction={}));P.MAX_MAP_SIZE_GPU=6;P.approximateTransform=function(b,f,d,e,q="nearest"){if(!C(b))return null;"majority"===q&&(b=m(b));const {pixels:l,mask:a,bandMasks:k,pixelType:p}=b,z=b.width;var I=b.height;const N=w.getPixelArrayConstructor(p),O=l.length,{width:H,height:u}=f;b=!1;for(var y=0;y<d.length;y+=3)-1===d[y]&&-1===d[y+1]&&-1===d[y+2]&&(b=!0);const {offsets_x:x,offsets_y:L,offsets_xi:Q,offsets_yi:W,gridWidth:v}=r({width:z,height:I},f,d,e,"majority"===
q?.5:0);let F;f=(M,U,V,X)=>{const Z=M instanceof Float32Array||M instanceof Float64Array?0:.5;for(let Y=0;Y<u;Y++){F=Y*v;for(let ea=0;ea<H;ea++){if(0>x[F]||0>L[F])M[Y*H+ea]=0;else if(X)M[Y*H+ea]=U[Q[F]+W[F]*z];else{const da=Math.floor(x[F]),ia=Math.floor(L[F]),fa=Math.ceil(x[F]),ja=Math.ceil(L[F]),ma=x[F]-da,na=L[F]-ia;M[Y*H+ea]=!V||V[da+ia*z]&&V[fa+ia*z]&&V[da+ja*z]&&V[fa+ja*z]?(1-na)*((1-ma)*U[da+ia*z]+ma*U[fa+ia*z])+na*((1-ma)*U[da+ja*z]+ma*U[fa+ja*z])+Z:U[Q[F]+W[F]*z]}F++}}};d=[];e=k?.length===
O;I=[];for(y=0;y<O;y++){if(e){var J=new Uint8Array(H*u);f(J,k[y],k[y],!0);I.push(J)}J=new N(H*u);f(J,l[y],e?k[y]:a,"nearest"===q||"majority"===q);d.push(J)}q=new w({width:H,height:u,pixelType:p,pixels:d,bandMasks:e?I:void 0});if(null!=a)q.mask=new Uint8Array(H*u),f(q.mask,a,a,!0);else if(b)for(q.mask=new Uint8Array(H*u),b=0;b<H*u;b++)q.mask[b]=0>x[b]||0>L[b]?0:1;q.updateStatistics();return q};P.clip=t;P.colorize=function(b,f){if(!C(b)||!f||!f.indexedColormap&&!f.indexed2DColormap)return b;const d=
b.clone();var e=d.pixels;let q=d.mask;const l=d.width*d.height;if(1!==e.length)return b;const {indexedColormap:a,indexed2DColormap:k,offset:p,alphaSpecified:z}=f;b=0;e=e[0];f=new Uint8Array(e.length);const I=new Uint8Array(e.length),N=new Uint8Array(e.length);var O=0;if(a){const H=a.length-1;if(null!=q)for(b=0;b<l;b++)q[b]&&(O=4*(e[b]-p),O<p||O>H?q[b]=0:(f[b]=a[O],I[b]=a[O+1],N[b]=a[O+2],q[b]=a[O+3]));else{q=new Uint8Array(l);for(b=0;b<l;b++)O=4*(e[b]-p),O<p||O>H?q[b]=0:(f[b]=a[O],I[b]=a[O+1],N[b]=
a[O+2],q[b]=a[O+3]);d.mask=q}}else if(k)if(null!=q)for(b=0;b<l;b++)q[b]&&(O=k[e[b]],f[b]=O[0],I[b]=O[1],N[b]=O[2],q[b]=O[3]);else{q=new Uint8Array(l);for(b=0;b<l;b++)O=k[e[b]],f[b]=O[0],I[b]=O[1],N[b]=O[2],q[b]=O[3];d.mask=q}d.pixels=[f,I,N];d.statistics=null;d.pixelType="u8";d.maskIsAlpha=z;return d};P.compositeBands=function(b){if(!b?.length||b.some(p=>!C(p)))return null;if(1===b.length)return b[0]?.clone()??null;const {width:f,height:d,pixelType:e}=b[0];if(b.some(p=>p.width!==f||p.height!==d))return null;
const q=b.map(({mask:p})=>p).filter(p=>null!=p);let l=null;q.length&&(l=new Uint8Array(f*d),l.set(q[0]),1<q.length&&S(q.slice(1),l));const a=[];b.forEach(({pixels:p})=>a.push(...p));const k=[];b.map(({statistics:p})=>p).filter(p=>p?.length).forEach(p=>k.push(...p));return new w({pixelType:e,width:f,height:d,mask:l,pixels:a,statistics:k.length?k:null})};P.createColormapLUT=function(b){if(b){var f=b.colormap;if(f&&0!==f.length){f=f.sort((z,I)=>z[0]-I[0]);var d=0;0>f[0][0]&&(d=f[0][0]);var e=Math.max(256,
f[f.length-1][0]-d+1),q=new Uint8Array(4*e),l=[],a=0,k=0,p=5===f[0].length;if(65536<e)return f.forEach(z=>{l[z[0]-d]=p?z.slice(1):z.slice(1).concat([255])}),{indexed2DColormap:l,offset:d,alphaSpecified:p};if(b.fillUnspecified)for(b=f[k],a=b[0]-d;a<e;a++)q[4*a]=b[1],q[4*a+1]=b[2],q[4*a+2]=b[3],q[4*a+3]=p?b[4]:255,a===b[0]-d&&(b=k===f.length-1?b:f[++k]);else for(a=0;a<f.length;a++)b=f[a],k=4*(b[0]-d),q[k]=b[1],q[k+1]=b[2],q[k+2]=b[3],q[k+3]=p?b[4]:255;return{indexedColormap:q,offset:d,alphaSpecified:p}}}};
P.createMaskLUT=function(b,f,d){if("u8"!==b&&"s8"!==b&&"u16"!==b&&"s16"!==b)return null;var e=b.includes("16")?65536:256;b=b.includes("s")?-e/2:0;e=new Uint8Array(e);if(f)for(let l=0;l<f.length;l++){var q=Math.ceil(f[2*l]-b);const a=Math.floor(f[2*l+1]-b);for(;q<=a;q++)e[q]=255}else e.fill(255);if(d)for(f=0;f<d.length;f++)e[d[f]-b]=0;return{lut:e,offset:b}};P.createRemapLUT=function(b){const {srcPixelType:f,inputRanges:d,outputValues:e,allowUnmatched:q,noDataRanges:l,isLastInputRangeInclusive:a,outputPixelType:k}=
b;if("u8"!==f&&"s8"!==f&&"u16"!==f&&"s16"!==f)return null;var p=f.includes("16")?65536:256;b=f.includes("s")?-p/2:0;const z=w.createEmptyBand(k,p);p=new Uint8Array(p);q&&p.fill(255);const [I,N]=E.getPixelValueRange(k);if(d?.length&&e?.length){var O=d.map(x=>x-1E-6);O[0]=d[0];a&&(O[O.length-1]=d[d.length-1]);for(var H=0;H<O.length;H++){var u=e[H]>N?N:e[H]<I?I:e[H],y=Math.ceil(O[2*H]-b);const x=Math.floor(O[2*H+1]-b);for(;y<=x;y++)z[y]=u,p[y]=255}}if(l?.length)for(O=0;O<l.length;O++)for(u=Math.ceil(l[2*
O]-b),H=Math.floor(l[2*O+1]-b);u<=H;u++)p[u]=0;return{lut:z,offset:b,mask:p}};P.extractBands=function(b,f){return f?.length&&C(b)?b.extractBands(f):b};P.getClipBounds=K;P.getLocalArithmeticNorthRotations=function(b,f){const {coefficients:d,spacing:e}=f,{offsets_x:q,offsets_y:l,gridWidth:a}=r(b,b,d,{rows:e[0],cols:e[1]}),{width:k,height:p}=b;b=new Float32Array(k*p);f=180/Math.PI;for(let N=0;N<p;N++)for(let O=0;O<k;O++){var z=N*a+O,I=0===N?z:z-a;const H=N===p-1?z:z+a;z=q[I]-q[H];I=l[H]-l[I];isNaN(z)||
isNaN(I)?b[N*k+O]=90:(I=Math.atan2(I,z)*f,I=(360+I)%360,b[N*k+O]=I)}return b};P.interpolateOffsets=r;P.isValidPixelBlock=C;P.lookupBandValues=B;P.lookupPixels=function(b,f){if(!C(b))return null;const {pixels:d,mask:e}=b,q=d.length;let l=f.lut;const {offset:a}=f;l&&1===l[0].length&&(l=d.map(()=>l));const k=[];f=f.outputPixelType||"u8";for(let p=0;p<q;p++){const z=B(d[p],e,l[p],a||0,f);k.push(z)}b=new w({width:b.width,height:b.height,pixels:k,mask:e,pixelType:f});b.updateStatistics();return b};P.mask=
function(b,f){if(!C(b))return null;const {width:d,height:e,pixels:q}=b;var l=d*e;const a=new Uint8Array(l);b.mask?a.set(b.mask):a.fill(255);b=q.length;const {includedRanges:k,noDataValues:p,outputPixelType:z,matchAll:I,lookups:N}=f;if(N){l=[];for(f=0;f<b;f++){var O=N[f];O=B(q[f],a,O.lut,O.offset||0,"u8");l.push(O)}1===l.length?a.set(l[0]):I?R(l,a):S(l,a)}else if(I){f=[];for(O=0;O<b;O++){const H=new Uint8Array(l);H.set(a);T(q[O],k?.slice(2*O,2*O+2),p?.[O],H);f.push(H)}1===f.length?a.set(f[0]):R(f,
a)}else for(l=0;l<b;l++)T(q[l],k?.slice(2*l,2*l+2),p?.[l],a);return new w({width:d,height:e,pixelType:z,pixels:q,mask:a})};P.mosaic=G;P.mosaicPixelData=function(b,f){if(!b||0===b.length)return null;var d=b.find(N=>N.pixelBlock);if(!d||null==d.pixelBlock)return null;var e=(d.extent.xmax-d.extent.xmin)/d.pixelBlock.width;const q=(d.extent.ymax-d.extent.ymin)/d.pixelBlock.height,l=.01*Math.min(e,q),a=b.sort((N,O)=>Math.abs(N.extent.ymax-O.extent.ymax)>l?O.extent.ymax-N.extent.ymax:Math.abs(N.extent.xmin-
O.extent.xmin)>l?N.extent.xmin-O.extent.xmin:0);var k=Math.min.apply(null,a.map(N=>N.extent.xmin));const p=Math.min.apply(null,a.map(N=>N.extent.ymin)),z=Math.max.apply(null,a.map(N=>N.extent.xmax)),I=Math.max.apply(null,a.map(N=>N.extent.ymax));b={x:Math.round((f.xmin-k)/e),y:Math.round((I-f.ymax)/q)};k={width:Math.round((z-k)/e),height:Math.round((I-p)/q)};e={width:Math.round((f.xmax-f.xmin)/e),height:Math.round((f.ymax-f.ymin)/q)};if(Math.round(k.width/d.pixelBlock.width)*Math.round(k.height/d.pixelBlock.height)!==
a.length||0>b.x||0>b.y||k.width<e.width||k.height<e.height)return null;d=a.map(N=>N.pixelBlock);d=G(d,k,{clipOffset:b,clipSize:e});return{extent:f,pixelBlock:d}};P.remap=function(b,f){if(!C(b))return null;const {width:d,height:e}=b,{inputRanges:q,outputValues:l,outputPixelType:a,noDataRanges:k,allowUnmatched:p,isLastInputRangeInclusive:z}=f;f=b.pixels[0];const I=w.createEmptyBand(a,f.length),N=b.mask,O=new Uint8Array(d*e);N?O.set(N):O.fill(255);const H=b.pixelType.startsWith("f")?1E-6:0;b=q.map(F=>
F-H);b[0]=q[0];b[b.length-1]=q[q.length-1]+(z?1E-6:0);var u=q.length/2;const [y,x]=E.getPixelValueRange(a);for(var L=0;L<e;L++)for(var Q=0;Q<d;Q++){var W=L*d+Q;if(O[W]){var v=f[W];let F=!1;for(let J=u-1;0<=J;J--)if(v===b[2*J]||v>b[2*J]&&v<b[2*J+1]){I[W]=l[J];F=!0;break}F||(p?I[W]=v>x?x:v<y?y:v:O[W]=0)}}if(b=k?.length)for(u=0;u<e;u++)for(L=0;L<d;L++)if(Q=u*d+L,!N||N[Q])for(W=f[Q],v=0;v<b;v+=2)if(W>=k[v]&&W<=k[v+1]){I[Q]=0;O[Q]=0;break}return new w({width:d,height:e,pixelType:a,pixels:[I],mask:O})};
P.remapColor=function(b,f){if(!C(b))return null;b=b.clone();var {pixels:d}=b;const e=b.width*b.height,q=f.length,l=Math.floor(q/2),a=f[Math.floor(l)];d=d[0];let k,p,z,I,N,O,H=!1;const u=new Uint8Array(e),y=new Uint8Array(e),x=new Uint8Array(e);let L=b.mask;const Q=4===f[0].mappedColor.length;L||(L=new Uint8Array(e),L.fill(Q?255:1),b.mask=L);for(N=0;N<e;N++)if(L[N]){k=d[N];H=!1;O=l;p=a;z=0;for(I=q-1;1<I-z;){if(k===p.value){H=!0;break}k>p.value?z=O:I=O;O=Math.floor((z+I)/2);p=f[Math.floor(O)]}H||(k===
f[z].value?(p=f[z],H=!0):k===f[I].value?(p=f[I],H=!0):k<f[z].value?(H=!1,p=null):k>f[z].value&&(k<f[I].value?(p=f[z],H=!0):I===q-1?(H=!1,p=null):(p=f[I],H=!0)));H?(u[N]=p.mappedColor[0],y[N]=p.mappedColor[1],x[N]=p.mappedColor[2],L[N]=p.mappedColor[3]):u[N]=y[N]=x[N]=L[N]=0}b.pixels=[u,y,x];b.mask=L;b.pixelType="u8";b.maskIsAlpha=Q;return b};P.resampleByMajority=m;P.setValidBoundary=function(b,f,d){if(!C(b))return null;const {width:e,height:q}=b,l=f.x;f=f.y;const a=d.width+l;d=d.height+f;if(0>l||
0>f||a>e||d>q||0===l&&0===f&&a===e&&d===q)return b;b.mask||(b.mask=new Uint8Array(e*q));const k=b.mask;for(let p=0;p<q;p++){const z=p*e;for(let I=0;I<e;I++)k[z+I]=p<f||p>=d||I<l||I>=a?0:1}b.updateStatistics();return b};P.split=function(b,f,d){if(!C(b))return null;const {width:e,height:q}=f;let {width:l,height:a}=b;const k=new Map,p={x:0,y:0};d=null==d?1:1+d;for(let z=0;z<d;z++){const I=Math.ceil(l/e),N=Math.ceil(a/q);for(let O=0;O<N;O++){p.y=O*q;for(let H=0;H<I;H++){p.x=H*e;const u=t(b,p,f);k.set(`${z}/${O}/${H}`,
u)}}z<d-1&&(b=A(b));l=Math.round(l/2);a=Math.round(a/2)}return k};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/utils":function(){define("require exports ../../Color ../../symbols ../../core/asyncUtils ../../core/has ../../core/maybe ../../core/screenUtils ../../chunks/vec3f64 ../../layers/effects/jsonUtils ./cimSymbolUtils ./gfxUtils ./Symbol3DMaterial".split(" "),function(P,w,E,C,B,T,R,S,K,D,G,h,m){function n(l){l=l.symbolLayers;if(!l)return null;let a=null;
l.forEach(k=>{"object"===k.type&&k.resource?.href||(a="water"===k.type?k.color:k.material?k.material.color:null)});return a?new E(a):null}function g(l,a){if(null==a||null==l)return l;l=l.toRgba();l[3]*=a;return new E(l)}function c(l,a,k){if(l=l.symbolLayers){var p=z=>{a=a??z??(null!=k?q:null);return g(a,k)};l.forEach(z=>{if("object"!==z.type||!z.resource?.href||a)if("water"===z.type)z.color=p(z.color);else{const I=p(null!=z.material?z.material.color:null);null==z.material?z.material=new m.Symbol3DMaterial({color:I}):
z.material.color=I;null!=k&&"outline"in z&&null!=z.outline&&null!=z.outline.color&&(z.outline.color=g(z.outline.color,k))}})}}async function t(l,a){(l=l.symbolLayers)&&await B.forEach(l,async k=>A(k,a))}async function A(l,a){switch(l.type){case "extrude":l.size="number"===typeof a[2]?a[2]:0;break;case "icon":case "line":case "text":a=r(a);null!=a&&(l.size=a);break;case "path":const k=f(a,K.ONES,[l.width,void 0,l.height]);l.width=e(a[0],l.width,1,k);l.height=e(a[2],l.height,1,k);break;case "object":await b(l,
a)}}function r(l){for(const a of l)if("number"===typeof a)return a;return null}async function b(l,a){const {resourceSize:k,symbolSize:p}=await d(l),z=f(a,k,p);l.width=e(a[0],p[0],k[0],z);l.depth=e(a[1],p[1],k[1],z);l.height=e(a[2],p[2],k[2],z)}function f(l,a,k){for(let p=0;3>p;p++){const z=l[p];switch(z){case "symbol-value":return l=k[p],null!=l?l/a[p]:1;case "proportional":break;default:if(z&&a[p])return z/a[p]}}return 1}async function d(l){var {computeObjectLayerResourceSize:a}=await new Promise((O,
H)=>P(["./symbolLayerUtils"],O,H));a=await a(l,10);const {width:k,height:p,depth:z}=l;l=[k,z,p];let I=1;for(var N=0;3>N;N++){const O=l[N];if(null!=O){I=O/a[N];break}}for(N=0;3>N;N++)null==l[N]&&(l[N]=a[N]*I);return{resourceSize:a,symbolSize:l}}function e(l,a,k,p){switch(l){case "proportional":return k*p;case "symbol-value":return null!=a?a:k;default:return l}}const q=new E("white");w.applyColorToSymbol=function(l,a,k){if(l&&(a||null!=k))if(a&&(a=new E(a)),C.isSymbol3D(l))c(l,a,k);else if(C.isSymbol2D(l)){if(a=
a??l.color)l.color=g(a,k);null!=k&&"outline"in l&&l.outline&&l.outline.color&&(l.outline.color=g(l.outline.color,k))}};w.applyOpacityToColor=g;w.applyRotationToSymbol=function(l,a,k){l&&null!=a&&(C.isSymbol3D(l)?(l=l.symbolLayers)&&l.forEach(p=>{if(p&&"object"===p.type)switch(k){case "tilt":p.tilt=a;break;case "roll":p.roll=a;break;default:p.heading=a}}):!C.isSymbol2D(l)||"simple-marker"!==l.type&&"picture-marker"!==l.type&&"text"!==l.type||(l.angle=a))};w.applySizesToSymbol=async function(l,a){if(l&&
a){if(C.isSymbol3D(l))return t(l,a);if(C.isSymbol2D(l)&&(a=r(a),null!=a))switch(l.type){case "simple-marker":l.size=a;break;case "picture-marker":const k=l.width/l.height;1<k?(l.width=a,l.height=a*k):(l.width=a*k,l.height=a);break;case "simple-line":l.width=a;break;case "text":l.font.size=a}}};w.fetchWebStyleSymbol=async function(l,a){const k=await l.fetchSymbol(a);return k?k:l.fetchCIMSymbol(a)};w.getCSSFilterFromEffectList=function(l){if(!l)return null;l=l.effects.filter(a=>"bloom"!==a.type).map(a=>
a.toJSON());return D.effectFunctionsFromJSON(l)};w.getColorFromSymbol=function(l,a){if(!l)return null;let k=null;C.isSymbol3D(l)?k=n(l):C.isSymbol2D(l)&&(k="cim"===l.type?G.getCIMSymbolColor(l):l.color?new E(l.color):null);return k?g(k,a):null};w.getIconHref=function(l){return R.unwrapOrThrow(l.resource).href};w.getSymbolOutlineSize=function(l){return l?C.isSymbol3D(l)?(l=(l=l.symbolLayers?.at(-1))&&"outline"in l?l?.outline?.size:void 0,null!=l?l:0):S.px2pt(h.getStroke(l)?.width):0};w.isVolumetricSymbol=
function(l){if(null==l||!("symbolLayers"in l)||null==l.symbolLayers)return!1;switch(l.type){case "point-3d":return l.symbolLayers.some(a=>"object"===a.type);case "line-3d":return l.symbolLayers.some(a=>"path"===a.type);case "polygon-3d":return l.symbolLayers.some(a=>"object"===a.type||"extrude"===a.type);default:return!1}};w.symbolHasExtrudeSymbolLayer=function(l){return null!=l&&"polygon-3d"===l.type&&l.symbolLayers.some(a=>"extrude"===a.type)};Object.defineProperty(w,Symbol.toStringTag,{value:"Module"})})},
"esri/symbols/support/cimSymbolUtils":function(){define(["exports","../../Color","../cim/utils"],function(P,w,E){function C(h){h=E.toCIMSymbolJSON(h);if("CIMTextSymbol"===h?.type)return h.height??0;let m=0;if(h?.symbolLayers)for(const n of h.symbolLayers)E.isCIMMarker(n)&&null!=n.size&&n.size>m?m=n.size:E.isCIMStroke(n)&&null!=n.width&&n.width>m?m=n.width:E.isCIMFill(n);return m}function B(h,m,n,g){if(h)if("CIMTextSymbol"===h.type)null!=h.height&&(h.height*=m);else{if(n&&h.effects)for(const c of h.effects)S(c,
m);if(h.symbolLayers)for(const c of h.symbolLayers)switch(c.type){case "CIMPictureMarker":case "CIMVectorMarker":T(c,m,g);break;case "CIMPictureStroke":case "CIMSolidStroke":!g?.preserveOutlineWidth&&c.width&&(c.width*=m);break;case "CIMPictureFill":c.height&&(c.height*=m);c.offsetX&&(c.offsetX*=m);c.offsetY&&(c.offsetY*=m);break;case "CIMHatchFill":B(c.lineSymbol,m,!0,{...g,preserveOutlineWidth:!1}),c.offsetX&&(c.offsetX*=m),c.offsetY&&(c.offsetY*=m),c.separation&&(c.separation*=m)}}}function T(h,
m,n){if(h&&(h.markerPlacement&&R(h.markerPlacement,m),h.offsetX&&(h.offsetX*=m),h.offsetY&&(h.offsetY*=m),h.anchorPoint&&"Absolute"===h.anchorPointUnits&&(h.anchorPoint={x:h.anchorPoint.x*m,y:h.anchorPoint.y*m}),h.size=null!=h.size?h.size*m:0,"CIMVectorMarker"===h.type&&h.markerGraphics))for(const g of h.markerGraphics)h.scaleSymbolsProportionally||B(g.symbol,m,!0,n)}function R(h,m){E.isCIMMarkerStrokePlacement(h)&&h.offset&&(h.offset*=m);switch(h.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":h.customEndingOffset&&
(h.customEndingOffset*=m);h.offsetAlongLine&&(h.offsetAlongLine*=m);if(h.placementTemplate&&h.placementTemplate.length){var n=h.placementTemplate.map(g=>g*m);h.placementTemplate=n}break;case "CIMMarkerPlacementAlongLineVariableSize":h.maxRandomOffset&&(h.maxRandomOffset*=m);h.placementTemplate&&h.placementTemplate.length&&(n=h.placementTemplate.map(g=>g*m),h.placementTemplate=n);break;case "CIMMarkerPlacementOnLine":h.startPointOffset&&(h.startPointOffset*=m);break;case "CIMMarkerPlacementAtExtremities":h.offsetAlongLine&&
(h.offsetAlongLine*=m);break;case "CIMMarkerPlacementAtRatioPositions":h.beginPosition&&(h.beginPosition*=m);h.endPosition&&(h.endPosition*=m);break;case "CIMMarkerPlacementPolygonCenter":h.offsetX&&(h.offsetX*=m);h.offsetY&&(h.offsetY*=m);break;case "CIMMarkerPlacementInsidePolygon":h.offsetX&&(h.offsetX*=m),h.offsetY&&(h.offsetY*=m),h.stepX&&(h.stepX*=m),h.stepY&&(h.stepY*=m)}}function S(h,m){switch(h.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":h.width&&(h.width*=m);break;
case "CIMGeometricEffectBuffer":h.size&&(h.size*=m);break;case "CIMGeometricEffectCut":h.beginCut&&(h.beginCut*=m);h.endCut&&(h.endCut*=m);h.middleCut&&(h.middleCut*=m);break;case "CIMGeometricEffectDashes":h.customEndingOffset&&(h.customEndingOffset*=m);h.offsetAlongLine&&(h.offsetAlongLine*=m);if(h.dashTemplate&&h.dashTemplate.length){const n=h.dashTemplate.map(g=>g*m);h.dashTemplate=n}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":h.length&&
(h.length*=m);break;case "CIMGeometricEffectMove":h.offsetX&&(h.offsetX*=m);h.offsetY&&(h.offsetY*=m);break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":h.offset&&(h.offset*=m);break;case "CIMGeometricEffectRegularPolygon":h.radius&&(h.radius*=m);break;case "CIMGeometricEffectTaperedPolygon":h.fromWidth&&(h.fromWidth*=m);h.length&&(h.length*=m);h.toWidth&&(h.toWidth*=m);break;case "CIMGeometricEffectWave":h.amplitude&&(h.amplitude*=m),h.period&&(h.period*=m)}}function K(h,
m){if(h){var n="CIMTextSymbol"===h.type?h.symbol:h;h="CIMPolygonSymbol"===h.type;if(n?.symbolLayers)for(const g of n.symbolLayers)if(!(g.colorLocked||h&&(E.isCIMStroke(g)||E.isCIMMarker(g)&&g.markerPlacement&&E.isCIMMarkerStrokePlacement(g.markerPlacement))))switch(g.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":g.tintColor&&D(m,g.tintColor);break;case "CIMVectorMarker":g.markerGraphics?.forEach(c=>{K(c.symbol,m)});break;case "CIMSolidStroke":case "CIMSolidFill":D(m,
g.color);break;case "CIMHatchFill":K(g.lineSymbol,m)}}}function D(h,m){for(const n of h)if(n.join(".")===m.join("."))return;h.push(m)}function G(h,m,n){if(h){var g="CIMTextSymbol"===h.type?h.symbol:h;h="CIMPolygonSymbol"===g?.type;if(g?.symbolLayers)for(const c of g.symbolLayers)if(!c.colorLocked){if(h)if(n){if({layersToColor:g}=n,(E.isCIMStroke(c)||E.isCIMMarker(c)&&c.markerPlacement&&E.isCIMMarkerStrokePlacement(c.markerPlacement))&&"fill"===g||E.isCIMFill(c)&&"outline"===g)continue}else if(E.isCIMStroke(c)||
E.isCIMMarker(c)&&c.markerPlacement&&E.isCIMMarkerStrokePlacement(c.markerPlacement))continue;g=m.toArray();switch(c.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":c.tintColor=g;break;case "CIMVectorMarker":c.markerGraphics?.forEach(t=>{G(t.symbol,m,n)});break;case "CIMSolidStroke":case "CIMSolidFill":c.color=g;break;case "CIMHatchFill":G(c.lineSymbol,m,n)}}}}P.applyCIMSymbolColor=function(h,m,n){m instanceof w||(m=new w(m));(h=E.toCIMSymbolJSON(h))&&G(h,m,n)};P.applyCIMSymbolRotation=
function(h,m,n=!1){h=E.toCIMSymbolJSON(h);n&&0!==m&&(m=360-m);if("CIMTextSymbol"===h?.type)h.angle=m;else if("CIMPointSymbol"===h?.type&&h.symbolLayers){n=m-(h.angle||0);for(const g of h.symbolLayers)if(E.isCIMMarker(g)){let c=g.rotation||0;c=g.rotateClockwise?c-n:c+n;g.rotation=c}h.angle=m}};P.getCIMSymbolColor=function(h){h=E.toCIMSymbolJSON(h);const m=[];K(h,m);return m.length?new w(E.fromCIMColor(m[0])):null};P.getCIMSymbolRotation=function(h,m=!1){h=E.toCIMSymbolJSON(h);return"CIMTextSymbol"===
h?.type||"CIMPointSymbol"===h?.type?(h=h.angle,null!=h&&0!==h&&m?360-h:h??0):0};P.getCIMSymbolSize=C;P.getCIMSymbolType=function(h){h=E.toCIMSymbolJSON(h);if(!h)return null;switch(h.type){case "CIMPointSymbol":return"CIMPointSymbol";case "CIMLineSymbol":return"CIMLineSymbol";case "CIMPolygonSymbol":return"CIMPolygonSymbol";case "CIMTextSymbol":return"CIMTextSymbol";case "CIMMeshSymbol":return"CIMMeshSymbol";default:return null}};P.scaleCIMMarker=T;P.scaleCIMSymbol=B;P.scaleCIMSymbolTo=function(h,
m,n){if(h){var g=E.toCIMSymbolJSON(h);h=C(h);if(0===h){if(g)if("CIMTextSymbol"===g.type)g.height=m;else if(g.symbolLayers)for(const c of g.symbolLayers)switch(c.type){case "CIMPictureMarker":case "CIMVectorMarker":c.size=m;break;case "CIMPictureStroke":case "CIMSolidStroke":c.width=m}}else B(g,m/h,!1,n)}};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/utils":function(){define(["require","exports"],function(P,w){function E(h){return"function"===typeof h}function C(h){let m=
h.length;for(;m--;)if(!" /-,\n".includes(h.charAt(m)))return!1;return!0}function B(h,m){const n=[];var g=0;let c=-1;do c=h.indexOf("[",g),c>=g&&(c>g&&(g=h.substr(g,c-g),n.push([g,null,C(g)])),g=c+1,c=h.indexOf("]",g),c>=g&&(c>g&&(g=h.substr(g,c-g),(g=m[g])&&n.push([null,g,!1])),g=c+1));while(-1!==c);g<h.length-1&&(h=h.substr(g),n.push([h,null,C(h)]));return n}function T(h,m,n){let g="",c=null;for(const t of m){const [A,r,b]=t;if(A)b?c=A:(c&&(g+=c,c=null),g+=A);else if(m=h.attributes[r])c&&(g+=c,c=
null),g+=m}return R(g,n)}function R(h,m){"string"!==typeof h&&(h=String(h));switch(m){case "LowerCase":return h.toLowerCase();case "Allcaps":return h.toUpperCase();default:return h}}function S(h){return h?{r:h[0],g:h[1],b:h[2],a:h[3]/255}:{r:0,g:0,b:0,a:0}}function K(h){if(!h)return null;switch(h.type){case "CIMPolygonSymbol":if(h.symbolLayers)for(const m of h.symbolLayers)if(h=K(m),null!=h)return h;break;case "CIMTextSymbol":return K(h.symbol);case "CIMSolidFill":return h.color}}function D(h){if(h)switch(h.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(h=
h.symbolLayers)for(const m of h)if(h=D(m),null!=h)return h;break;case "CIMTextSymbol":return D(h.symbol);case "CIMSolidStroke":return h.color}}function G(h){if(h)switch(h.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(h.symbolLayers)for(const m of h.symbolLayers)if(h=G(m),void 0!==h)return h;break;case "CIMTextSymbol":return G(h.symbol);case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return h.width}}w.adjustTextCase=R;w.analyzeTextParts=B;w.assignTextValuesFromFeature=
T;w.attributesToFields=function(h){return(h?Object.keys(h):[]).map(m=>({name:m,alias:m,type:"string"===typeof h[m]?"esriFieldTypeString":"esriFieldTypeDouble"}))};w.colorToArray=function(h){return[h.r,h.g,h.b,h.a]};w.createLabelOverrideFunction=function(h,m,n){const g=B(m,h);return c=>T(c,g,n)};w.evaluateValueOrFunction=function(h,m,n,g){return E(h)?h(m,n,g):h};w.fromCIMColor=S;w.fromCIMFontDecoration=function(h){return h.underline?"underline":h.strikethrough?"line-through":"none"};w.fromCIMFontStyle=
function(h){let m="normal",n="normal";h&&(h=h.toLowerCase(),h.includes("italic")?m="italic":h.includes("oblique")&&(m="oblique"),h.includes("bold")?n="bold":h.includes("light")&&(n="lighter"));return{style:m,weight:n}};w.fromCIMHorizontalAlignment=function(h){switch(h){default:return"left";case "Right":return"right";case "Center":return"center";case "Justify":return"center"}};w.fromCIMVerticalAlignment=function(h){switch(h){default:return"top";case "Center":return"middle";case "Baseline":return"baseline";
case "Bottom":return"bottom"}};w.getFillColor=K;w.getFontStyle=function(h){if(!h)return"normal";switch(h.toLowerCase()){case "italic":return"italic";case "oblique":return"oblique";default:return"normal"}};w.getFontWeight=function(h){if(!h)return"normal";switch(h.toLowerCase()){case "bold":return"bold";case "bolder":return"bolder";case "lighter":return"lighter";default:return"normal"}};w.getStrokeColor=D;w.getStrokeWidth=G;w.getTintColor=h=>h.tintColor?S(h.tintColor):{r:255,g:255,b:255,a:1};w.getValue=
(h,m=0)=>null==h||isNaN(h)?m:h;w.importGeometryEngine=function(){return new Promise((h,m)=>P(["../../geometry/geometryEngineJSON"],h,m))};w.isCIMFill=function(h){return null!=h&&("CIMGradientFill"===h.type||"CIMHatchFill"===h.type||"CIMPictureFill"===h.type||"CIMSolidFill"===h.type||"CIMWaterFill"===h.type)};w.isCIMMarker=function(h){return"CIMVectorMarker"===h.type||"CIMPictureMarker"===h.type||"CIMBarChartMarker"===h.type||"CIMCharacterMarker"===h.type||"CIMPieChartMarker"===h.type||"CIMStackedBarChartMarker"===
h.type};w.isCIMMarkerStrokePlacement=function(h){return null!=h&&("CIMMarkerPlacementAlongLineRandomSize"===h.type||"CIMMarkerPlacementAlongLineSameSize"===h.type||"CIMMarkerPlacementAlongLineVariableSize"===h.type||"CIMMarkerPlacementAtExtremities"===h.type||"CIMMarkerPlacementAtMeasuredUnits"===h.type||"CIMMarkerPlacementAtRatioPositions"===h.type||"CIMMarkerPlacementOnLine"===h.type||"CIMMarkerPlacementOnVertices"===h.type)};w.isCIMStroke=function(h){return"CIMGradientStroke"===h.type||"CIMPictureStroke"===
h.type||"CIMSolidStroke"===h.type};w.isFeatureValueFn=E;w.isGeometryEngineRequired=h=>{if(!h)return!1;for(const m of h)switch(m.type){case "CIMGeometricEffectBuffer":case "CIMGeometricEffectOffset":case "CIMGeometricEffectDonut":return!0}return!1};w.isSVGImage=h=>h.includes("data:image/svg+xml");w.mapCIMSymbolToGeometryType=function(h){if(!h)return null;switch(h.type){case "CIMPointSymbol":case "CIMTextSymbol":return"esriGeometryPoint";case "CIMLineSymbol":return"esriGeometryPolyline";case "CIMPolygonSymbol":return"esriGeometryPolygon";
default:return null}};w.resampleHermite=function(h,m,n,g,c,t,A=!0){const r=m/c;n/=t;const b=Math.ceil(r/2),f=Math.ceil(n/2);for(let q=0;q<t;q++)for(let l=0;l<c;l++){const a=4*(l+(A?t-q-1:q)*c);var d=0;let k=0,p=0,z=0,I=0,N=0,O=0;const H=(q+.5)*n;for(let u=Math.floor(q*n);u<(q+1)*n;u++){var e=Math.abs(H-(u+.5))/f;const y=(l+.5)*r;e*=e;for(let x=Math.floor(l*r);x<(l+1)*r;x++){let L=Math.abs(y-(x+.5))/b;d=Math.sqrt(e+L*L);-1<=d&&1>=d&&(d=2*d*d*d-3*d*d+1,0<d&&(L=4*(x+u*m),O+=d*h[L+3],p+=d,255>h[L+3]&&
(d=d*h[L+3]/250),z+=d*h[L],I+=d*h[L+1],N+=d*h[L+2],k+=d))}}g[a]=z/k;g[a+1]=I/k;g[a+2]=N/k;g[a+3]=O/p}};w.toCIMSymbolJSON=function(h){return h.data?.symbol??null};Object.defineProperty(w,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/gfxUtils":function(){define("exports ../../assets ../../Color ../../request ../../core/LRUCache ../../core/screenUtils ./cimSymbolUtils".split(" "),function(P,w,E,C,B,T,R){function S(G){if(!G)return null;let h=null;switch(G.type){case "simple-fill":case "picture-fill":case "simple-marker":h=
S(G.outline);break;case "simple-line":const m=T.pt2px(G.width);null!=G.style&&"none"!==G.style&&0!==m&&(h={color:G.color,style:D(G.style),width:m,cap:G.cap,join:"miter"===G.join?T.pt2px(G.miterLimit):G.join});break;default:h=null}return h}const K=new B.LRUCache(1E3),D=(()=>{const G={};return h=>{if(G[h])return G[h];const m=h.replaceAll("-","");return G[h]=m}})();E=new E([128,128,128]);P.defaultThematicColor=E;P.dekebabifyLineStyle=D;P.getFill=function(G){const h=G.style;let m=null;if(G)switch(G.type){case "simple-marker":"cross"!==
h&&"x"!==h&&(m=G.color);break;case "simple-fill":"solid"===h?m=G.color:"none"!==h&&(m={type:"pattern",x:0,y:0,src:w.getAssetUrl(`esri/symbols/patterns/${h}.png`),width:5,height:5});break;case "picture-fill":m={type:"pattern",src:G.url,width:T.pt2px(G.width)*G.xscale,height:T.pt2px(G.height)*G.yscale,x:T.pt2px(G.xoffset),y:T.pt2px(G.yoffset)};break;case "text":m=G.color;break;case "cim":m=R.getCIMSymbolColor(G)}return m};P.getPatternUrlWithColor=function(G,h){const m=G+"-"+h;return void 0!==K.get(m)?
Promise.resolve(K.get(m)):C(G,{responseType:"image"}).then(n=>{n=n.data;const g=n.naturalWidth,c=n.naturalHeight,t=document.createElement("canvas");t.width=g;t.height=c;const A=t.getContext("2d");A.fillStyle=h;A.fillRect(0,0,g,c);A.globalCompositeOperation="destination-in";A.drawImage(n,0,0);n=t.toDataURL();K.put(m,n);return n})};P.getStroke=S;Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/DimensionalDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(P,w,E,C,B,T,R){var S;E=S=function(K){function D(G){G=K.call(this,G)||this;G.variableName=null;G.dimensionName=null;G.values=[];G.isSlice=!1;return G}P._inherits(D,K);D.prototype.clone=function(){return new S({variableName:this.variableName,dimensionName:this.dimensionName,values:C.clone(this.values),isSlice:this.isSlice})};return P._createClass(D)}(E.JSONSupport);w.__decorate([B.property({type:String,json:{write:!0}})],E.prototype,"variableName",void 0);w.__decorate([B.property({type:String,
json:{write:!0}})],E.prototype,"dimensionName",void 0);w.__decorate([B.property({type:T.types.array(T.types.oneOf([T.types.native(Number),T.types.array(T.types.native(Number))])),json:{write:!0}})],E.prototype,"values",void 0);w.__decorate([B.property({type:Boolean,json:{write:!0}})],E.prototype,"isSlice",void 0);return E=S=w.__decorate([R.subclass("esri.layers.support.DimensionalDefinition")],E)})},"esri/layers/support/MultidimensionalSubset":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../geometry/Extent ../../geometry/Polygon ../../geometry/support/jsonUtils ./DimensionalDefinition ../../geometry/Geometry".split(" "),
function(P,w,E,C,B,T,R,S,K,D,G,h,m,n){var g;E={base:n,key:"type",typeMap:{extent:D,polygon:G}};C=g=function(c){function t(A){A=c.call(this,A)||this;A.areaOfInterest=null;A.subsetDefinitions=null;return A}P._inherits(t,c);t.prototype.clone=function(){const A=this.subsetDefinitions?.map(b=>b.clone()),r=this.areaOfInterest?this.areaOfInterest.clone():this.areaOfInterest;return new g({areaOfInterest:r,subsetDefinitions:A})};P._createClass(t,[{key:"dimensions",get:function(){var {subsetDefinitions:A}=
this;if(null==A||0===A.length)return[];const r=new Map;A.forEach(b=>{if(b.dimensionName){if(Array.isArray(b.values[0])){var f=b.values;var d=f[0][0];f=f[b.values.length-1][1]}else f=b.values,d=f[0],f=f[b.values.length-1];r.has(b.dimensionName)?(b=r.get(b.dimensionName),b[0]=Math.min(d,b[0]),b[1]=Math.max(f,b[1])):r.set(b.dimensionName,[d,f])}});A=[];for(const b of r)A.push({name:b[0],extent:b[1]});return A}},{key:"variables",get:function(){const {subsetDefinitions:A}=this;if(null==A||0===A.length)return[];
const r=new Set;A.forEach(b=>{b.variableName&&r.add(b.variableName)});return[...r]}}]);return t}(C.JSONSupport);w.__decorate([B.property({types:E,json:{read:h.fromJSON,write:!0}})],C.prototype,"areaOfInterest",void 0);w.__decorate([B.property({readOnly:!0})],C.prototype,"dimensions",null);w.__decorate([B.property({readOnly:!0})],C.prototype,"variables",null);w.__decorate([B.property({type:[m],json:{write:!0}})],C.prototype,"subsetDefinitions",void 0);return C=g=w.__decorate([K.subclass("esri.layers.support.MultidimensionalSubset")],
C)})},"esri/layers/support/RasterFunction":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ./RasterFunctionTemplate".split(" "),function(P,w,E,C,B,T,R,S,K,D,
G){var h;const m=new Set(["raster","raster2","dem","fillraster"]),n=new Set(["rasters"]),g=r=>r&&r.rasterFunction?A.fromJSON(r):r,c=r=>r&&r instanceof A?r.toJSON():r,t=r=>r?.functionName&&!r.declaredClass?new A(r):r;T={types:{key:"type",base:null,typeMap:{RasterFunctionTemplate:G}},json:{write:!0,name:"rasterFunctionDefinition"}};let A=h=function(r){function b(d){d=r.call(this,d)||this;d.functionName=null;d.outputPixelType="unknown";d.variableName=null;d.functionDefinition=null;return d}P._inherits(b,
r);var f=b.prototype;f.readFunctionArguments=function(d){if(null==d)var e=null;else{d=C.clone(d);var q={};for(e of Object.keys(d))m.has(e.toLowerCase())?q[e]=g(d[e]):n.has(e.toLowerCase())&&Array.isArray(d[e])?q[e]=d[e].map(g):q[e]=d[e];e=q}return e};f.writeFunctionArguments=function(d,e,q){const l={};for(const a of Object.keys(d))m.has(a.toLowerCase())?l[a]=c(d[a]):n.has(a.toLowerCase())&&Array.isArray(d[a])?l[a]=d[a].map(c):l[a]=c(d[a]);e[q]=l};f.readFunctionName=function(d,e){d=e.rasterFunctionInfos;
const q=e.name;return q?q:d&&d.length&&"None"!==d[0].name?d[0].name:e.rasterFunctionDefinition?e.rasterFunctionDefinition.name:e.rasterFunction};f.clone=function(){return new h({functionName:this.functionName,functionArguments:C.clone(this.functionArguments),outputPixelType:this.outputPixelType,variableName:this.variableName,rasterFunctionDefinition:C.clone(this.rasterFunctionDefinition)})};P._createClass(b,[{key:"functionArguments",set:function(d){if(d){const e=Object.keys(d);if(e.some(q=>{var l;
if(l=m.has(q.toLowerCase()))q=d[q],l=q?.functionName&&!q.declaredClass;return l})||e.some(q=>n.has(q.toLowerCase())&&Array.isArray(d[q])&&d[q].some(l=>l?.functionName&&!l.declaredClass))){d=C.clone(d);for(const q of e)m.has(q.toLowerCase())?d[q]=t(d[q]):n.has(q.toLowerCase())&&Array.isArray(d[q])&&(d[q]=d[q].map(l=>t(l)))}}this._set("functionArguments",d)}},{key:"rasterFunctionDefinition",get:function(){return this.functionDefinition?.toJSON()},set:function(d){this.functionDefinition=d?G.fromJSON(d):
null}}]);return b}(E.JSONSupport);w.__decorate([B.property({json:{type:Object,name:"rasterFunctionArguments"}})],A.prototype,"functionArguments",null);w.__decorate([S.reader("functionArguments")],A.prototype,"readFunctionArguments",null);w.__decorate([D.writer("functionArguments")],A.prototype,"writeFunctionArguments",null);w.__decorate([B.property({json:{type:String,write:{target:"rasterFunction"}}})],A.prototype,"functionName",void 0);w.__decorate([S.reader("functionName",["rasterFunction","rasterFunctionInfos",
"rasterFunctionDefinition"])],A.prototype,"readFunctionName",null);w.__decorate([R.enumeration({C128:"c128",C64:"c64",F32:"f32",F64:"f64",S16:"s16",S32:"s32",S8:"s8",U1:"u1",U16:"u16",U2:"u2",U32:"u32",U4:"u4",U8:"u8",UNKNOWN:"unknown"},{ignoreUnknown:!1}),B.property({json:{default:"unknown"}})],A.prototype,"outputPixelType",void 0);w.__decorate([B.property({type:String,json:{read:!0,write:!0}})],A.prototype,"variableName",void 0);w.__decorate([B.property()],A.prototype,"rasterFunctionDefinition",
null);w.__decorate([B.property(T)],A.prototype,"functionDefinition",void 0);return A=h=w.__decorate([K.subclass("esri.layers.support.RasterFunction")],A)})},"esri/layers/support/RasterFunctionTemplate":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./RasterFunctionInfo ./RasterFunctionProperties".split(" "),
function(P,w,E,C,B,T,R,S,K,D,G){E=new E.JSONMap({0:"mosaic",1:"item",2:"item-group"},{useNumericKeys:!0});C=function(h){function m(){var n=h.apply(this,arguments)||this;n.functionType="mosaic";n.type="RasterFunctionTemplate";return n}P._inherits(m,h);return P._createClass(m)}(C.JSONSupport);w.__decorate([B.property({type:[String],json:{write:!0}})],C.prototype,"aliases",void 0);w.__decorate([B.property({type:Object,json:{write:!0}})],C.prototype,"arguments",void 0);w.__decorate([B.property({type:String,
json:{write:!0}})],C.prototype,"description",void 0);w.__decorate([B.property({type:D,json:{write:!0,name:"function"}})],C.prototype,"functionInfo",void 0);w.__decorate([B.property({type:E.apiValues,json:{type:[0,1,2],read:E.read,write:E.write}})],C.prototype,"functionType",void 0);w.__decorate([B.property({type:String,json:{write:!0}})],C.prototype,"group",void 0);w.__decorate([B.property({type:String,json:{write:!0}})],C.prototype,"help",void 0);w.__decorate([B.property({type:Number,json:{type:T.Integer,
write:!0,name:"_object_id"}})],C.prototype,"id",void 0);w.__decorate([B.property({type:String,json:{write:!0}})],C.prototype,"name",void 0);w.__decorate([B.property({type:String,json:{write:!0,name:"definition"}})],C.prototype,"queryDefinition",void 0);w.__decorate([B.property({type:String,json:{write:!0}})],C.prototype,"tag",void 0);w.__decorate([B.property({type:G,json:{write:!0}})],C.prototype,"properties",void 0);w.__decorate([B.property({type:String,json:{write:!0}})],C.prototype,"thumbnail",
void 0);w.__decorate([B.property({type:String,json:{write:!0}})],C.prototype,"thumbnailEx",void 0);w.__decorate([B.property({json:{type:["RasterFunctionTemplate"],write:!0}})],C.prototype,"type",void 0);return C=w.__decorate([K.subclass("esri.layers.support.RasterFunctionTemplate")],C)})},"esri/layers/support/RasterFunctionInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./rasterEnums".split(" "),
function(P,w,E,C,B,T,R,S,K){E=function(D){function G(){var h=D.apply(this,arguments)||this;h.pixelType="unknown";return h}P._inherits(G,D);return P._createClass(G)}(E.JSONSupport);w.__decorate([C.property({type:String,json:{write:!0}})],E.prototype,"name",void 0);w.__decorate([C.property({type:String,json:{write:!0}})],E.prototype,"description",void 0);w.__decorate([C.property({type:B.Integer,json:{type:B.Integer,write:!0,name:"_object_id"}})],E.prototype,"id",void 0);w.__decorate([C.property({type:String,
json:{type:K.pixelTypeKebabDict.jsonValues,read:K.pixelTypeKebabDict.read,write:K.pixelTypeKebabDict.write}})],E.prototype,"pixelType",void 0);w.__decorate([C.property({type:String,json:{write:!0}})],E.prototype,"type",void 0);return E=w.__decorate([S.subclass("esri.layers.support.RasterFunctionInfo")],E)})},"esri/layers/support/rasterEnums":function(){define(["exports","../../core/jsonMap"],function(P,w){const E=w.strict()({RSP_NearestNeighbor:"nearest",RSP_BilinearInterpolation:"bilinear",RSP_CubicConvolution:"cubic",
RSP_Majority:"majority"}),C=w.strict()({esriNoDataMatchAny:"any",esriNoDataMatchAll:"all"});w=w.strict()({U1:"u1",U2:"u2",U4:"u4",U8:"u8",S8:"s8",U16:"u16",S16:"s16",U32:"u32",S32:"s32",F32:"f32",F64:"f64",C64:"c64",C128:"c128",UNKNOWN:"unknown"});P.interpolationKebab=E;P.noDataInterpretationKebab=C;P.pixelTypeKebabDict=w;Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/RasterFunctionProperties":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./RasterFunctionVariable".split(" "),
function(P,w,E,C,B,T,R,S,K){T={key:"type",base:null,typeMap:{RasterFunctionVariable:K}};E=function(D){function G(){return D.apply(this,arguments)||this}P._inherits(G,D);return P._createClass(G)}(E.JSONSupport);w.__decorate([C.property({types:T,json:{types:T,name:"MatchVariable"}})],E.prototype,"matchVariable",void 0);w.__decorate([C.property({types:T,json:{types:T,name:"UnionDimension"}})],E.prototype,"unionDimension",void 0);w.__decorate([C.property({type:Number,json:{type:B.Integer,write:!0,name:"_object_id"}})],
E.prototype,"id",void 0);w.__decorate([C.property({type:String,json:{write:!0}})],E.prototype,"type",void 0);return E=w.__decorate([S.subclass("esri.layers.support.RasterFunctionProperties")],E)})},"esri/layers/support/RasterFunctionVariable":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(P,w,E,C,B,T,R,S){E=function(K){function D(){var G=K.apply(this,arguments)||this;G.isDataset=!1;G.isPublic=!1;G.type="RasterFunctionVariable";return G}P._inherits(D,K);return P._createClass(D)}(E.JSONSupport);w.__decorate([C.property({type:String,json:{write:!0}})],E.prototype,"name",void 0);w.__decorate([C.property({type:Number,json:{type:B.Integer,write:!0,name:"_object_id"}})],E.prototype,"id",void 0);w.__decorate([C.property({type:Boolean,json:{write:!0}})],E.prototype,"isDataset",void 0);
w.__decorate([C.property({type:Boolean,json:{write:!0}})],E.prototype,"isPublic",void 0);w.__decorate([C.property({json:{write:!0}})],E.prototype,"value",void 0);w.__decorate([C.property({type:String,json:{write:!0}})],E.prototype,"type",void 0);return E=w.__decorate([S.subclass("esri.layers.support.RasterFunctionVariable")],E)})},"esri/layers/support/RasterJobHandler":function(){define(["../../chunks/_rollupPluginBabelHelpers","../../core/Error","../../core/workers/workers","./PixelBlock"],function(P,
w,E,C){return function(){function B(){this._workerThread=null;this._destroyed=!1}var T=B.prototype;T.initialize=async function(){const R=await E.open("RasterWorker");this._destroyed?R.close():this._workerThread=R};T.destroy=function(){this._destroyed=!0;this._workerThread&&(this._workerThread.close(),this._workerThread=null)};T.convertVectorFieldData=async function(R,S){if(!this._workerThread)throw new w("raster-jobhandler:no-connection","no available worker connection");return(R=await this._workerThread.invoke("convertVectorFieldData",
{pixelBlock:R.pixelBlock.toJSON(),type:R.dataType},S))?new C(R):null};T.computeStatisticsHistograms=function(R,S){if(!this._workerThread)throw new w("raster-jobhandler:no-connection","no available worker connection");return this._workerThread.invoke("computeStatisticsHistograms",{pixelBlock:R.pixelBlock.toJSON()},S)};T.decode=async function(R,S){if(!this._workerThread)throw new w("raster-jobhandler:no-connection","no available worker connection");return(R=await this._workerThread.invoke("decode",
R,S))?new C(R):null};T.symbolize=async function(R,S){if(!this._workerThread)throw new w("raster-jobhandler:no-connection","no available worker connection");R={extent:R.extent&&R.extent.toJSON(),pixelBlock:null!=R.pixelBlock&&R.pixelBlock.toJSON(),simpleStretchParams:R.simpleStretchParams,bandIds:R.bandIds};return(S=await this._workerThread.invoke("symbolize",R,S))?new C(S):null};T.updateSymbolizer=async function(R,S){if(!this._workerThread)throw new w("raster-jobhandler:no-connection","no available worker connection");
const K=R?.rendererJSON?.histograms;await Promise.all(this._workerThread.broadcast("updateSymbolizer",{symbolizerJSON:R.toJSON(),histograms:K},S))};T.updateRasterFunction=async function(R,S){if(!this._workerThread)throw new w("raster-jobhandler:no-connection","no available worker connection");await Promise.all(this._workerThread.broadcast("updateRasterFunction",{rasterFunctionJSON:R.toJSON()},S))};T.process=async function(R,S){if(!this._workerThread)throw new w("raster-jobhandler:no-connection","no available worker connection");
return(R=await this._workerThread.invoke("process",{extent:R.extent?.toJSON(),primaryPixelSizes:R.primaryPixelSizes?.map(K=>null!=K?K.toJSON():null),primaryPixelBlocks:R.primaryPixelBlocks.map(K=>null!=K?K.toJSON():null),primaryRasterIds:R.primaryRasterIds},S))?new C(R):null};T.stretch=async function(R,S){if(!this._workerThread)throw new w("raster-jobhandler:no-connection","no available worker connection");if(!R?.pixelBlock)return null;R={srcPixelBlock:R.pixelBlock.toJSON(),stretchParams:R.stretchParams};
return(S=await this._workerThread.invoke("stretch",R,S))?new C(S):null};T.split=async function(R,S){if(!this._workerThread)throw new w("raster-jobhandler:no-connection","no available worker connection");if(!R?.pixelBlock)return null;R={srcPixelBlock:R.pixelBlock.toJSON(),tileSize:R.tileSize,maximumPyramidLevel:R.maximumPyramidLevel};const K=await this._workerThread.invoke("split",R,S);K&&K.forEach((D,G)=>{K.set(G,D?C.fromJSON(D):null)});return K};T.estimateStatisticsHistograms=async function(R,S){if(!this._workerThread)throw new w("raster-jobhandler:no-connection",
"no available worker connection");if(!R?.pixelBlock)return null;R={srcPixelBlock:R.pixelBlock.toJSON()};return await this._workerThread.invoke("estimateStatisticsHistograms",R,S)};T.mosaicAndTransform=async function(R,S){if(!this._workerThread)throw new w("raster-jobhandler:no-connection","no available worker connection");if(!R?.srcPixelBlocks?.length)return{pixelBlock:null};R={...R,srcPixelBlocks:R.srcPixelBlocks.map(K=>null!=K?K.toJSON():null)};S=await this._workerThread.invoke("mosaicAndTransform",
R,S);return{pixelBlock:S.pixelBlock?new C(S.pixelBlock):null,localNorthDirections:S.localNorthDirections}};T.createFlowMesh=async function(R,S){if(!this._workerThread)throw new w("raster-jobhandler:no-connection","no available worker connection");const K={buffer:R.flowData.data.buffer,maskBuffer:R.flowData.mask.buffer,width:R.flowData.width,height:R.flowData.height},{meshType:D,simulationSettings:G}=R;R=await this._workerThread.invoke("createFlowMesh",{meshType:D,flowData:K,simulationSettings:G},
{...S,transferList:[K.buffer,K.maskBuffer]});return{vertexData:new Float32Array(R.vertexBuffer),indexData:new Uint32Array(R.indexBuffer)}};T.getProjectionOffsetGrid=function(R,S){if(!this._workerThread)throw new w("raster-jobhandler:no-connection","no available worker connection");const K=null!=R.datumTransformation?R.datumTransformation.steps.map(G=>({wkid:G.wkid,wkt:G.wkt,isInverse:G.isInverse})):null,D=null!=R.rasterTransform?R.rasterTransform.toJSON():null;R={projectedExtent:R.projectedExtent.toJSON(),
srcBufferExtent:R.srcBufferExtent.toJSON(),pixelSize:R.pixelSize,hasWrapAround:R.hasWrapAround,spacing:R.spacing,datumTransformationSteps:K,rasterTransform:D,isAdaptive:R.isAdaptive,includeGCSGrid:R.includeGCSGrid};return this._workerThread.invoke("getProjectionOffsetGrid",R,S)};return P._createClass(B)}()})},"esri/layers/support/TileInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/unitUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../geometry/Point ../../geometry/SpatialReference ../../geometry/support/aaBoundingRect ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ./LOD ./TileKey".split(" "),
function(P,w,E,C,B,T,R,S,K,D,G,h,m,n,g,c,t,A,r){var b;E=new E.JSONMap({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});C=b=function(f){function d(q){q=f.call(this,q)||this;q.dpi=96;q.format=null;q.origin=null;q.size=null;q.spatialReference=null;return q}P._inherits(d,f);d.create=function(q={}){const {resolutionFactor:l=
1,scales:a,size:k=256,spatialReference:p=n.WebMercator,numLODs:z=24}=q;if(!c.isValid(p)){q=[];if(a)for(var I=0;I<a.length;I++){var N=a[I];q.push(new A({level:I,scale:N,resolution:N}))}else for(I=5E-4,N=z-1;0<=N;N--)q.unshift(new A({level:N,scale:I,resolution:I})),I*=2;return new b({dpi:96,lods:q,origin:new m(0,0,p),size:[k,k],spatialReference:p})}I=c.getInfo(p);q=q.origin?new m({x:q.origin.x,y:q.origin.y,spatialReference:p}):I?new m({x:I.origin[0],y:I.origin[1],spatialReference:p}):new m({x:0,y:0,
spatialReference:p});I=1/(39.37*B.getMetersPerUnitForSR(p)*96);N=[];if(a)for(var O=0;O<a.length;O++){var H=a[O];N.push(new A({level:O,scale:H,resolution:H*I}))}else{var u=c.isGeographic(p)?512/k*5.916575275917094E8:256/k*5.91657527591555E8;O=Math.ceil(z/l);N.push(new A({level:0,scale:u,resolution:u*I}));for(H=1;H<O;H++)u/=2**l,N.push(new A({level:H,scale:u,resolution:u*I}))}return new b({dpi:96,lods:N,origin:q,size:[k,k],spatialReference:p})};var e=d.prototype;e.readOrigin=function(q,l){return m.fromJSON({spatialReference:l.spatialReference,
...q})};e.readSize=function(q,l){return[l.cols,l.rows]};e.writeSize=function(q,l){l.cols=q[0];l.rows=q[1]};e.zoomToScale=function(q){const l=this.scales;if(0>=q)return l[0];if(q>=l.length-1)return l[l.length-1];const a=Math.floor(q);return l[a]/(l[a]/l[a+1])**(q-a)};e.scaleToZoom=function(q){const l=this.scales,a=l.length-1;let k=0;for(;k<a;k++){const p=l[k],z=l[k+1];if(p<=q)break;if(z===q)return k+1;if(p>q&&z<q)return k+Math.log(p/q)/Math.log(p/z)}return k};e.snapScale=function(q,l=.95){q=this.scaleToZoom(q);
return q%Math.floor(q)>=l?this.zoomToScale(Math.ceil(q)):this.zoomToScale(Math.floor(q))};e.tileAt=function(q,l,a,k){var p=this.lodAt(q);if(!p)return null;let z;if("number"===typeof l)z=l,l=a;else{if(c.equals(l.spatialReference,this.spatialReference))z=l.x,l=l.y;else{k=t.project(l,this.spatialReference);if(null==k)return null;z=k.x;l=k.y}k=a}a=p.resolution*this.size[0];p=p.resolution*this.size[1];k||(k=new r.TileKey(null,0,0,0,g.create()));k.level=q;k.row=Math.floor((this.origin.y-l)/p+.001);k.col=
Math.floor((z-this.origin.x)/a+.001);this.updateTileInfo(k);return k};e.updateTileInfo=function(q,l=b.ExtrapolateOptions.NONE){var a=this.lodAt(q.level);a||l!==b.ExtrapolateOptions.POWER_OF_TWO||(l=this.lods[this.lods.length-1],l.level<q.level&&(a=l));if(a){var k=q.level-a.level;l=a.resolution*this.size[0]/2**k;a=a.resolution*this.size[1]/2**k;q.id=`${q.level}/${q.row}/${q.col}`;q.extent||(q.extent=g.create());q.extent[0]=this.origin.x+q.col*l;q.extent[1]=this.origin.y-(q.row+1)*a;q.extent[2]=q.extent[0]+
l;q.extent[3]=q.extent[1]+a}};e.upsampleTile=function(q){const l=this._upsampleLevels[q.level];if(!l||-1===l.parentLevel)return!1;q.level=l.parentLevel;q.row=Math.floor(q.row/l.factor+.001);q.col=Math.floor(q.col/l.factor+.001);this.updateTileInfo(q);return!0};e.getTileBounds=function(q,l){var a=this.lodAt(l.level);if(null==a)return null;var {resolution:k}=a;a=k*this.size[0];k*=this.size[1];q[0]=this.origin.x+l.col*a;q[1]=this.origin.y-(l.row+1)*k;q[2]=q[0]+a;q[3]=q[1]+k;return q};e.lodAt=function(q){return this._levelToLOD?.[q]??
null};e.clone=function(){return b.fromJSON(this.write({}))};e.getOrCreateCompatible=function(q,l){if(256===this.size[0]&&256===this.size[1])return 256===q?this:null;const a=[],k=this.lods.length;for(let p=0;p<k;p++){const z=this.lods[p];a.push(new A({level:z.level,scale:z.scale,resolution:z.resolution*l}))}return new b({size:[q,q],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,lods:a})};e._initializeUpsampleLevels=
function(){const q=this.lods;this._upsampleLevels=[];let l=null;for(let a=0;a<q.length;a++){const k=q[a];this._upsampleLevels[k.level]={parentLevel:l?l.level:-1,factor:l?l.resolution/k.resolution:0};l=k}};P._createClass(d,[{key:"isWrappable",get:function(){const {spatialReference:q,origin:l}=this;if(q&&l){const a=c.getInfo(q);return q.isWrappable&&!!a&&Math.abs(a.origin[0]-l.x)<=a.dx}return!1}},{key:"lods",set:function(q){const l=[],a=this._levelToLOD={};q&&q.forEach(k=>{l.push(k.scale);a[k.level]=
k});this._set("scales",l);this._set("lods",q);this._initializeUpsampleLevels()}}]);return d}(C.JSONSupport);w.__decorate([T.property({type:Number,json:{write:!0}})],C.prototype,"compressionQuality",void 0);w.__decorate([T.property({type:Number,json:{write:!0}})],C.prototype,"dpi",void 0);w.__decorate([T.property({type:String,json:{read:E.read,write:E.write,origins:{"web-scene":{read:!1,write:!1}}}})],C.prototype,"format",void 0);w.__decorate([T.property({readOnly:!0})],C.prototype,"isWrappable",null);
w.__decorate([T.property({type:m,json:{write:!0}})],C.prototype,"origin",void 0);w.__decorate([D.reader("origin")],C.prototype,"readOrigin",null);w.__decorate([T.property({type:[A],value:null,json:{write:!0}})],C.prototype,"lods",null);w.__decorate([T.property({readOnly:!0})],C.prototype,"scales",void 0);w.__decorate([T.property({cast:f=>Array.isArray(f)?f:"number"===typeof f?[f,f]:[256,256]})],C.prototype,"size",void 0);w.__decorate([D.reader("size",["rows","cols"])],C.prototype,"readSize",null);
w.__decorate([h.writer("size",{cols:{type:R.Integer},rows:{type:R.Integer}})],C.prototype,"writeSize",null);w.__decorate([T.property({type:n,json:{write:!0}})],C.prototype,"spatialReference",void 0);C=b=w.__decorate([G.subclass("esri.layers.support.TileInfo")],C);(function(f){f=f.ExtrapolateOptions||(f.ExtrapolateOptions={});f[f.NONE=0]="NONE";f[f.POWER_OF_TWO=1]="POWER_OF_TWO"})(C||(C={}));return C})},"esri/layers/support/LOD":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(P,w,E,C,B,T,R,S){var K;E=K=function(D){function G(h){h=D.call(this,h)||this;h.cols=null;h.level=0;h.levelValue=null;h.origin=null;h.resolution=0;h.rows=null;h.scale=0;return h}P._inherits(G,D);G.prototype.clone=function(){return new K({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})};return P._createClass(G)}(E.JSONSupport);w.__decorate([C.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,
write:!1}}}})],E.prototype,"cols",void 0);w.__decorate([C.property({type:B.Integer,json:{write:!0}})],E.prototype,"level",void 0);w.__decorate([C.property({type:String,json:{write:!0}})],E.prototype,"levelValue",void 0);w.__decorate([C.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],E.prototype,"origin",void 0);w.__decorate([C.property({type:Number,json:{write:!0}})],E.prototype,"resolution",void 0);w.__decorate([C.property({json:{write:!0,
origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],E.prototype,"rows",void 0);w.__decorate([C.property({type:Number,json:{write:!0}})],E.prototype,"scale",void 0);return E=K=w.__decorate([S.subclass("esri.layers.support.LOD")],E)})},"esri/layers/support/TileKey":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers"],function(P,w){w=w._createClass(function(E,C,B,T,R){this.id=E;this.level=C;this.row=B;this.col=T;this.extent=R});P.TileKey=w;Object.defineProperty(P,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/FunctionRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Error ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseRaster ../rasterFunctions/pixelUtils ../../../rest/support/FeatureSet".split(" "),function(P,w,E,C,B,T,R,S,K,D,G){B=
function(h){function m(){var g=h.apply(this,arguments)||this;g.datasetFormat="Function";g.tileType="Raster";g.rasterFunction=null;return g}P._inherits(m,h);var n=m.prototype;n.open=async function(g){await this.init();const {rasterFunction:c}=this;this.primaryRasters?.rasters?.length?c.sourceRasters=this.primaryRasters.rasters:(this.primaryRasters=c.getPrimaryRasters(),this.rasterJobHandler&&this.primaryRasters.rasters?.forEach(d=>d.rasterJobHandler=this.rasterJobHandler));const {rasters:t,rasterIds:A}=
this.primaryRasters;var r=t.map(d=>d.rasterInfo?void 0:d.open(g));await Promise.all(r);r=t.map(({rasterInfo:d})=>d);var b=c.bind({rasterInfos:r,rasterIds:A});if(!b.success||0===r.length)throw new E("raster-function:open",`cannot bind the function: ${b.error??""}`);b="Table"===c.functionName?c:c.functionArguments?.raster;"Table"===b?.functionName&&(c.rasterInfo.attributeTable=G.fromJSON(b.functionArguments.attributeTableAsRecordSet));await this.syncJobHandler();const f=r[0];this.hasUniqueSourceStorageInfo=
1===r.length||r.slice(1).every(d=>this._hasSameStorageInfo(d,f));this.set("sourceJSON",t[0].sourceJSON);this.set("rasterInfo",c.rasterInfo)};n.syncJobHandler=async function(){return this.rasterJobHandler?.updateRasterFunction(this.rasterFunction)};n.fetchPixels=async function(g,c,t,A={}){const {rasters:r,rasterIds:b}=this.primaryRasters;var f=!1,{interpolation:d}=A,e=this.rasterFunction.flatWebGLFunctionChain?.hasSurfaceFunction;!A.requestRawData&&"bilinear"!==d&&e&&(f=1===r.length&&!A.skipRasterFunction,
A={...A,interpolation:"bilinear",requestRawData:f});e=r.map(k=>k.fetchPixels(g,c,t,A));e=await Promise.all(e);var q=e.map(k=>k.pixelBlock),l=f||A.requestRawData?e.map(k=>k.srcTilePixelSize):null;if(A.skipRasterFunction||q.every(k=>null==k))return e[0];const a=e.find(k=>null!=k.pixelBlock)?.extent??g;q=this.rasterJobHandler?await this.rasterJobHandler.process({extent:a,primaryPixelBlocks:q,primaryPixelSizes:l,primaryRasterIds:b}):this.rasterFunction.process({extent:a,primaryPixelBlocks:q,primaryPixelSizes:l,
primaryRasterIds:b});({transformGrid:l}=e[0]);if(!f||null==q||null==l)return{...e[0],pixelBlock:q};f={rows:l.spacing[0],cols:l.spacing[1]};d=this.rasterJobHandler?(await this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:[q],srcMosaicSize:{width:q.width,height:q.height},destDimension:{width:c,height:t},coefs:l.coefficients,sampleSpacing:f,projectDirections:!1,gcsGrid:null,isUV:!1,interpolation:d,alignmentInfo:void 0,blockWidths:null},A)).pixelBlock:D.approximateTransform(q,{width:c,height:t},
l.coefficients,f,d);return{extent:g,srcExtent:e[0].srcExtent,pixelBlock:d}};n._hasSameStorageInfo=function(g,c){const {storageInfo:t,pixelSize:A,spatialReference:r,extent:b}=g,{storageInfo:f,pixelSize:d,spatialReference:e,extent:q}=c;return A.x===d.x&&A.y===d.y&&r.equals(e)&&b.equals(q)&&t.blockHeight===f.blockHeight&&t.blockWidth===f.blockWidth&&t.maximumPyramidLevel===f.maximumPyramidLevel};return P._createClass(m)}(K);w.__decorate([C.property({type:String,json:{write:!0}})],B.prototype,"datasetFormat",
void 0);w.__decorate([C.property()],B.prototype,"tileType",void 0);w.__decorate([C.property()],B.prototype,"rasterFunction",void 0);w.__decorate([C.property()],B.prototype,"primaryRasters",void 0);return B=w.__decorate([S.subclass("esri.layers.support.rasterDatasets.FunctionRaster")],B)})},"esri/layers/support/rasterDatasets/BaseRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../request ../../../core/Error ../../../core/JSONSupport ../../../core/Logger ../../../core/maybe ../../../core/Promise ../../../core/promiseUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../arcgisLayerUrl ../commonProperties ../DimensionalDefinition ../LOD ../RasterStorageInfo ../TileInfo ./multidimensionalUtils ./RawBlockCache ../rasterFormats/pixelRangeUtils ../rasterFormats/RasterCodec ../rasterFunctions/pixelUtils ../rasterFunctions/rasterProjectionHelper ../rasterFunctions/vectorFieldUtils ../../../geometry/Extent ../../../geometry/Point".split(" "),
function(P,w,E,C,B,T,R,S,K,D,G,h,m,n,g,c,t,A,r,b,f,d,e,q,l,a,k,p,z,I){E=function(N){function O(){var u=N.apply(this,arguments)||this;u.datasetName=null;u.datasetFormat=null;u.hasUniqueSourceStorageInfo=!0;u.rasterInfo=null;u.ioConfig={sampling:"closest"};return u}P._inherits(O,N);var H=O.prototype;H.init=async function(){const u=k.load();this.addResolvingPromise(u);await this.when()};H.normalizeCtorArgs=function(u){u&&u.ioConfig&&(u={...u,ioConfig:{resolution:null,bandIds:null,sampling:"closest",
tileInfo:f.create(),...u.ioConfig}});return u};H.open=async function(u){throw new B("BaseRaster:open-not-implemented","open() is not implemented");};H.fetchTile=async function(u,y,x,L={}){const Q=L.tileInfo||this.rasterInfo.storageInfo.tileInfo;u=this.getTileExtentFromTileInfo(u,y,x,Q);return this.fetchPixels(u,Q.size[0],Q.size[1],L)};H.identify=async function(u,y={}){u=h.ensureClass(I,u).clone().normalize();const {multidimensionalDefinition:x,timeExtent:L}=y;var {rasterInfo:Q}=this;const {hasMultidimensionalTranspose:W,
multidimensionalInfo:v}=Q;var {transposedVariableName:F}=y,J=null!=v&&W&&(null!=L||d.isMultiSliceOrRangeDefinition(x));J&&!F&&(F=null!=x&&0<x.length?x[0].variableName??void 0:v.variables[0].name,y={...y,transposedVariableName:F});y=this._getRequestOptionsWithSliceId(y);const {spatialReference:M,extent:U}=Q;var {datumTransformation:V}=y;V=k.projectPoint(u,M,V);if(!U.intersects(V)||null!=Q.transform&&(V=Q.transform.inverseTransform(V),!Q.nativeExtent.intersects(V)))return{location:V,value:null};let X=
0;var Z=null!=F&&null!=v&&Q.hasMultidimensionalTranspose;if("Function"===this.datasetFormat){J=this.primaryRasters.rasters[0];if(Z)return J.identify(V,y);({pixelSize:Z}=Q);y=3*Z.x/2;Z=3*Z.y/2;y=new z({xmin:V.x-y,xmax:V.x+y,ymin:V.y-Z,ymax:V.y+Z,spatialReference:M});Z={interpolation:"nearest"};({pixelBlock:J}=await J.fetchPixels(y,3,3,Z));({pixelBlock:y}=await this.fetchPixels(y,3,3,Z));if(null==J)return{location:V,value:null};J=!J.mask||J.mask[4]?J.pixels.map(ma=>ma[4]):null;var Y;null!=y&&(Y=!y.mask||
y.mask[4]?y.pixels.map(ma=>ma[4]):void 0);return{location:V,value:J,processedValue:Y,pyramidLevel:0}}if(!Z)if(y.srcResolution)X=k.snapPyramid(y.srcResolution,Q,this.ioConfig.sampling).pyramidLevel;else if(X=await this.computeBestPyramidLevelForLocation(u,y),null==X)return{location:V,value:null};Y=this.identifyPixelLocation(V,X,null,Z);if(null===Y)return{location:V,value:null};const {row:ea,col:da,rowOffset:ia,colOffset:fa,blockWidth:ja}=Y;Y=e.getRasterId(this.url,F??y.sliceId);Q=`${X}/${ea}/${da}`;
F=e.getBlock(Y,null,Q);null==F&&(F=this.fetchRawTile(X,ea,da,y),e.putBlock(Y,null,Q,F));Y=await F;return null!=Y&&Y.pixels?.length?this._processIdentifyResult(Y,{srcLocation:V,position:ia*ja+fa,pyramidLevel:X,useTransposedTile:!!Z,requestSomeSlices:J,identifyOptions:y}):{location:V,value:null}};H.fetchPixels=async function(u,y,x,L={}){u=k.snapExtent(u);L=this._getRequestOptionsWithSliceId(L);var {_hasNoneOrGCSShiftTransform:Q}=this;if(L.requestRawData&&Q)return this._fetchPixels(u,y,x,L);var W=k.getWorldWidth(u.spatialReference),
v=k.getWorldWrapCount(u);if(null==W||0===v||1===v&&this._isGlobalWrappableSource&&Q)return this._fetchPixels(u,y,x,L);if(3<=v)return{extent:u,pixelBlock:null};const F=[],{xmin:J,xmax:M}=u,U=Math.round(W/(M-J)*y),V=U-Math.round((W/2-J)/(M-J)*y);let X=0;Q=[];for(let Y=0;Y<=v;Y++){var Z=new z({xmin:0===Y?J:-W/2,xmax:Y===v?M-W*Y:W/2,ymin:u.ymin,ymax:u.ymax,spatialReference:u.spatialReference});const ea=0===Y?U-V:Y===v?y-X:U;X+=ea;Q.push(ea);Z=L.disableWrapAround&&0<Y?null:this._fetchPixels(Z,ea,x,L);
F.push(Z)}W=(await Promise.all(F)).map(Y=>Y?.pixelBlock);v=null;y={width:y,height:x};v=this.rasterJobHandler?(await this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:W,srcMosaicSize:y,destDimension:null,coefs:null,sampleSpacing:null,interpolation:"nearest",alignmentInfo:null,blockWidths:Q},L)).pixelBlock:a.mosaic(W,y,{blockWidths:Q});L=k.projectExtent(u,this.rasterInfo.spatialReference,L.datumTransformation);return{extent:u,srcExtent:L,pixelBlock:v}};H.fetchRawPixels=async function(u,y,x,L=
{}){y={x:Math.floor(y.x),y:Math.floor(y.y)};const Q=await this._fetchRawTiles(u,y,x,L),{nativeExtent:W,nativePixelSize:v,storageInfo:F}=this.rasterInfo;var J=2**u,M=v.x*J;J*=v.y;M=new z({xmin:W.xmin+M*y.x,xmax:W.xmin+M*(y.x+x.width-1),ymin:W.ymax-J*(y.y+x.height-1),ymax:W.ymax-J*y.y,spatialReference:W.spatialReference});if(!Q)return{extent:M,srcExtent:M,pixelBlock:null};const {pixelBlocks:U,mosaicSize:V}=Q;if(1===U.length&&null!=U[0]&&U[0].width===x.width&&U[0].height===x.height)return{extent:M,srcExtent:M,
pixelBlock:Q.pixelBlocks[0]};u={x:y.x%(0<u?F.pyramidBlockWidth:F.blockWidth),y:y.y%(0<u?F.pyramidBlockHeight:F.blockHeight)};x=this.rasterJobHandler?(await this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:U,srcMosaicSize:V,destDimension:x,clipOffset:u,clipSize:x,coefs:null,sampleSpacing:null,interpolation:L.interpolation,alignmentInfo:null,blockWidths:null},L)).pixelBlock:a.mosaic(U,V,{clipOffset:u,clipSize:x});return{extent:M,srcExtent:M,pixelBlock:x}};H.fetchRawTile=function(u,y,x,L){throw new B("BaseRaster:read-not-implemented",
"fetchRawTile() is not implemented");};H.computeExtent=function(u){return k.projectExtent(this.rasterInfo.extent,u)};H.decodePixelBlock=function(u,y){return!this.rasterJobHandler||y.useCanvas?l.decode(u,y):this.rasterJobHandler.decode({data:u,options:y})};H.request=async function(u,y,x=0){const {customFetchParameters:L}=this.ioConfig,{range:Q,query:W,headers:v}=y;x=x??y.retryCount??this.ioConfig.retryCount;const F=Q?{Range:`bytes=${Q.from}-${Q.to}`}:null;try{return await C(u,{...y,query:{...W,...L},
headers:{...v,...F}})}catch(J){if(0<x)return x--,this.request(u,y,x);throw J;}};H.getSliceIndex=function(u){const {multidimensionalInfo:y}=this.rasterInfo;return null==y||null==u||0===u.length?null:d.getSliceIndex(u,y)};H.getTileExtentFromTileInfo=function(u,y,x,L){u=S.unwrapOrThrow(L.lodAt(u));return this.getTileExtent({x:u.resolution,y:u.resolution},y,x,L.origin,L.spatialReference,L.size)};H.updateTileInfo=function(){const {storageInfo:u,spatialReference:y,extent:x,pixelSize:L}=this.rasterInfo;
if(!u.tileInfo){const W=[];var Q=u.maximumPyramidLevel||0;let v=Math.max(L.x,L.y),F=1/.0254*96*v;for(let J=0;J<=Q;J++)W.push(new r({level:Q-J,resolution:v,scale:F})),v*=2,F*=2;Q=new I({x:x.xmin,y:x.ymax,spatialReference:y});u.tileInfo=new f({origin:Q,size:[u.blockWidth,u.blockHeight],spatialReference:y,lods:W});u.isVirtualTileInfo=!0}};H.createRemoteDatasetStorageInfo=function(u,y=512,x=512,L){const {width:Q,height:W,nativeExtent:v,pixelSize:F,spatialReference:J}=u,M=new I({x:v.xmin,y:v.ymax,spatialReference:J});
null==L&&(L=Math.max(0,Math.round(Math.log(Math.max(Q,W))/Math.LN2-8)));const U=this.computeBlockBoundary(v,512,512,{x:v.xmin,y:v.ymax},[F],L);u.storageInfo=new b({blockWidth:y,blockHeight:x,pyramidBlockWidth:y,pyramidBlockHeight:x,origin:M,firstPyramidLevel:1,maximumPyramidLevel:L,blockBoundary:U})};H.computeBestPyramidLevelForLocation=async function(u,y){return 0};H.computeBlockBoundary=function(u,y,x,L,Q,W=0,v=2){if(1===Q.length&&0<W){Q=[...Q];let {x:M,y:U}=Q[0];for(let V=0;V<W;V++)M*=v,U*=v,Q.push({x:M,
y:U})}W=[];const {x:F,y:J}=L;for(L=0;L<Q.length;L++){const {x:M,y:U}=Q[L];W.push({minCol:Math.floor((u.xmin-F+.1*M)/y/M),maxCol:Math.floor((u.xmax-F-.1*M)/y/M),minRow:Math.floor((J-u.ymax+.1*U)/x/U),maxRow:Math.floor((J-u.ymin-.1*U)/x/U)})}return W};H.getPyramidPixelSize=function(u){const {nativePixelSize:y}=this.rasterInfo,{pyramidResolutions:x,pyramidScalingFactor:L}=this.rasterInfo.storageInfo;if(0===u)return y;if(null!=x&&x.length)return x[u-1];u=L**u;return{x:y.x*u,y:y.y*u}};H.identifyPixelLocation=
function(u,y,x,L){const {spatialReference:Q,nativeExtent:W,storageInfo:v}=this.rasterInfo,{maximumPyramidLevel:F,origin:J,transposeInfo:M}=v,U=L&&null!=M?M.tileSize[0]:v.blockWidth;L=L&&null!=M?M.tileSize[1]:v.blockHeight;u=k.projectPoint(u,Q,x);if(!W.intersects(u)||0>y||y>F)return null;x=this.getPyramidPixelSize(y);const {x:V,y:X}=x;x=(J.y-u.y)/X/L;const Z=(u.x-J.x)/V/U;return{pyramidLevel:y,row:Math.floor(x),col:Math.floor(Z),rowOffset:Math.min(L-1,Math.floor((x-Math.floor(x))*L)),colOffset:Math.min(U-
1,Math.floor((Z-Math.floor(Z))*U)),blockWidth:U,srcLocation:u}};H.getTileExtent=function(u,y,x,L,Q,W){const [v,F]=W;x=L.x+x*v*u.x;y=L.y-y*F*u.y;return new z({xmin:x,xmax:x+v*u.x,ymin:y-F*u.y,ymax:y,spatialReference:Q})};H.getBlockWidthHeight=function(u){return{blockWidth:0<u?this.rasterInfo.storageInfo.pyramidBlockWidth:this.rasterInfo.storageInfo.blockWidth,blockHeight:0<u?this.rasterInfo.storageInfo.pyramidBlockHeight:this.rasterInfo.storageInfo.blockHeight}};H.isBlockOutside=function(u,y,x){u=
this.rasterInfo.storageInfo.blockBoundary[u];return!u||u.maxRow<y||u.maxCol<x||u.minRow>y||u.minCol>x};H._fetchPixels=async function(u,y,x,L={}){var Q=k.getWorldWrapCount(u);if(2<=Q)return{extent:u,pixelBlock:null};var W=this._getSourceDataInfo(u,y,x,L);const {pyramidLevel:v,srcResolution:F,srcExtent:J,srcWidth:M,srcHeight:U,ul:V}=W;if(0===M||0===U)return{extent:u,srcExtent:J,pixelBlock:null};var {rasterInfo:X}=this,Z=X.transform,Y="gcs-shift"===Z?.type,ea=null!=k.getWorldWidth(u.spatialReference);
if(Y||!ea)Q=k.getWorldWrapCount(W.srcExtent,Y);W=await this._fetchRawTiles(v,V,{width:M,height:U,wrapCount:Q},L);if(!W)return{extent:u,srcExtent:J,pixelBlock:null};var da=X.storageInfo;Y=0<v?da.pyramidBlockWidth:da.blockWidth;var ia=0<v?da.pyramidBlockHeight:da.blockHeight;let {x:fa,y:ja}=X.pixelSize;if(0<v){const {pyramidResolutions:oa,pyramidScalingFactor:wa}=da;null!=oa&&oa[v-1]?{x:fa,y:ja}=oa[v-1]:(da=wa**v,fa*=da,ja*=da)}var ma=X.spatialReference;X=new I({x:fa,y:ja,spatialReference:ma});const na=
Y===M&&ia===U&&0===V.x%Y&&0===V.y%ia;da=new I({x:(u.xmax-u.xmin)/y,y:(u.ymax-u.ymin)/x,spatialReference:u.spatialReference});const ra=!u.spatialReference.equals(ma),qa=ma.isGeographic?1E-9:1E-4;({datumTransformation:ma}=L);if(!ra&&na&&1===W.pixelBlocks.length&&Y===y&&ia===x&&this._isSameResolution(F,da,qa))return{extent:u,srcExtent:J,srcTilePixelSize:X,pixelBlock:W.pixelBlocks[0]};Y=ea&&null!=k.getWorldWidth(J.spatialReference)&&this._hasNoneOrGCSShiftTransform;(ea=L.requestProjectedLocalDirections&&
this.rasterInfo.dataType.startsWith("vector"))&&!this.rasterJobHandler&&await k.load();Q=this.rasterJobHandler?await this.rasterJobHandler.getProjectionOffsetGrid({projectedExtent:u,srcBufferExtent:W.extent,pixelSize:da.toJSON(),datumTransformation:ma,rasterTransform:Z,hasWrapAround:0<Q||Y,isAdaptive:!1!==this.ioConfig.optimizeProjectionAccuracy,includeGCSGrid:ea},L):k.getProjectionOffsetGrid({projectedExtent:u,srcBufferExtent:W.extent,pixelSize:da,datumTransformation:ma,rasterTransform:Z,hasWrapAround:0<
Q||Y,isAdaptive:!1,includeGCSGrid:ea});Z=!L.requestRawData;Y={rows:Q.spacing[0],cols:Q.spacing[1]};ia=this._hasNoneOrGCSShiftTransform?this._getRasterTileAlignmentInfo(v,W.extent.xmin):void 0;const {pixelBlocks:va,mosaicSize:sa,isPartiallyFilled:xa}=W;W=null;this.rasterJobHandler?(y=await this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:va,srcMosaicSize:sa,destDimension:Z?{width:y,height:x}:null,coefs:Z?Q.coefficients:null,sampleSpacing:Z?Y:null,projectDirections:ea,gcsGrid:ea?Q.gcsGrid:null,
isUV:"vector-uv"===this.rasterInfo.dataType,interpolation:L.interpolation,alignmentInfo:ia,blockWidths:null},L),{pixelBlock:Z,localNorthDirections:W}=y):(ia=a.mosaic(va,sa,{alignmentInfo:ia}),Z=Z?a.approximateTransform(ia,{width:y,height:x},Q.coefficients,Y,L.interpolation):ia,ea&&Q.gcsGrid&&(W=a.getLocalArithmeticNorthRotations({width:y,height:x},Q.gcsGrid),Z=p.convertToLocalDirections(Z,this.rasterInfo.dataType,W)));return L.requestRawData||ea?{extent:u,srcExtent:J,srcTilePixelSize:X,pixelBlock:Z,
transformGrid:Q,localNorthDirections:W,isPartiallyFilled:xa}:{extent:u,srcExtent:J,srcTilePixelSize:X,pixelBlock:Z}};H._fetchRawTiles=async function(u,y,x,L){const {origin:Q,blockBoundary:W}=this.rasterInfo.storageInfo,{blockWidth:v,blockHeight:F}=this.getBlockWidthHeight(u);let {x:J,y:M}=y,{width:U,height:V,wrapCount:X}=x;var Z=this._getRasterTileAlignmentInfo(u,0);L.buffer&&(J-=L.buffer.cols,M-=L.buffer.rows,U+=2*L.buffer.cols,V+=2*L.buffer.rows);var Y=0,ea=0;let da=0;X&&null!=Z&&({worldColumnCountFromOrigin:ea,
originColumnOffset:da,rightPadding:Y}=Z,ea*Z.blockWidth-Y>=J+U&&(Y=0));y=Math.floor(J/v);x=Math.floor(M/F);const ia=Math.floor((J+U+Y-1)/v);Y=Math.floor((M+V+Y-1)/F);var fa=W[u];if(!fa)return null;const {minRow:ja,minCol:ma,maxCol:na,maxRow:ra}=fa;if(0===X&&(Y<ja||ia<ma||x>ra||y>na))return null;fa=[];let qa=!1;const va=null==this.ioConfig.allowPartialFill?L.allowPartialFill:this.ioConfig.allowPartialFill;for(let oa=x;oa<=Y;oa++)for(let wa=y;wa<=ia;wa++){let aa=wa;!L.disableWrapAround&&X&&null!=Z&&
ea<=wa&&(aa=wa-ea-da);if(oa>=ja&&aa>=ma&&ra>=oa&&na>=aa){const ha=this._fetchRawTile(u,oa,aa,L);va?fa.push(new Promise(ba=>{ha.then(ka=>ba(ka)).catch(()=>{qa=!0;ba(null)})})):fa.push(ha)}else fa.push(Promise.resolve(null))}if(0===fa.length)return null;L=await Promise.all(fa);Z={height:(Y-x+1)*F,width:(ia-y+1)*v};({spatialReference:ea}=this.rasterInfo);u=this.getPyramidPixelSize(u);const {x:sa,y:xa}=u;return{extent:new z({xmin:Q.x+y*v*sa,xmax:Q.x+(ia+1)*v*sa,ymin:Q.y-(Y+1)*F*xa,ymax:Q.y-x*F*xa,spatialReference:ea}),
pixelBlocks:L,mosaicSize:Z,isPartiallyFilled:qa}};H._isSameResolution=function(u,y,x){return Math.abs(u.x-y.x)<x&&Math.abs(u.y-y.y)<x};H._fetchRawTile=function(u,y,x,L){var Q=this.rasterInfo.storageInfo.blockBoundary[u];if(!Q)return Promise.resolve(null);const {minRow:W,minCol:v,maxCol:F,maxRow:J}=Q;if(y<W||x<v||y>J||x>F)return Promise.resolve(null);const M=e.getRasterId(this.url,L.sliceId),U=`${u}/${y}/${x}`;Q=e.getBlock(M,L.registryId,U);if(null==Q){const V=new AbortController;Q=this.fetchRawTile(u,
y,x,{...L,signal:V.signal});e.putBlock(M,L.registryId,U,Q,V);Q.catch(()=>e.deleteBlock(M,L.registryId,U))}if(L.signal)D.onAbort(L,()=>{e.decreaseRefCount(M,L.registryId,U)});return Q};H._computeMagDirValues=function(u){const {bandCount:y,dataType:x}=this.rasterInfo;if((2!==y||"vector-magdir"!==x)&&"vector-uv"!==x||2!==u?.length||!u[0]?.length)return null;var L=u[0].length;if("vector-magdir"===x)return L=u[1].map(F=>(F+360)%360),[u[0],L];const [Q,W]=u;u=[];const v=[];for(let F=0;F<L;F++){const [J,
M]=p.uvComponentToVector([Q[F],W[F]]);u.push(J);v.push(M)}return[u,v]};H._getRasterTileAlignmentInfo=function(u,y){null==this._rasterTileAlighmentInfo&&(this._rasterTileAlighmentInfo=k.getRasterDatasetAlignmentInfo(this.rasterInfo));return null==this._rasterTileAlighmentInfo.pyramidsInfo?null:{startX:y,halfWorldWidth:this._rasterTileAlighmentInfo.halfWorldWidth,hasGCSSShiftTransform:this._rasterTileAlighmentInfo.hasGCSSShiftTransform,...this._rasterTileAlighmentInfo.pyramidsInfo[u]}};H._getSourceDataInfo=
function(u,y,x,L={}){const Q={datumTransformation:L.datumTransformation,pyramidLevel:0,pyramidResolution:null,srcExtent:null,srcHeight:0,srcResolution:null,srcWidth:0,ul:{x:0,y:0}};L.srcResolution&&(Q.srcResolution=L.srcResolution,this._updateSourceDataInfo(u,Q));var W=this.rasterInfo.storageInfo.maximumPyramidLevel||0;const {srcWidth:v,srcHeight:F,pyramidLevel:J}=Q;var M=v/y;const U=F/x,V=J<W&&16<=M*U;var X=J===W&&this._requireTooManySrcTiles(v,F,y,x);if(V||X||0===v||0===F){X=new I({x:(u.xmax-u.xmin)/
y,y:(u.ymax-u.ymin)/x,spatialReference:u.spatialReference});X=k.projectResolution(X,this.rasterInfo.spatialReference,u,Q.datumTransformation);const Z=!X||L.srcResolution&&X.x+X.y<L.srcResolution.x+L.srcResolution.y;V&&L.srcResolution&&Z&&(M=Math.round(Math.log(Math.max(M,U))/Math.LN2)-1,W-J+3>=M&&(W=2**M,X={x:L.srcResolution.x*W,y:L.srcResolution.y*W}));X&&(Q.srcResolution=X,this._updateSourceDataInfo(u,Q))}this._requireTooManySrcTiles(Q.srcWidth,Q.srcHeight,y,x)&&(Q.srcWidth=0,Q.srcHeight=0);return Q};
H._requireTooManySrcTiles=function(u,y,x,L){const {tileInfo:Q}=this.rasterInfo.storageInfo;return 256<=Math.ceil(u/Q.size[0])*Math.ceil(y/Q.size[1])||8<u/x||8<y/L};H._updateSourceDataInfo=function(u,y){y.srcWidth=0;y.srcHeight=0;var {rasterInfo:x}=this,L=x.spatialReference;const {srcResolution:Q,datumTransformation:W}=y,{pyramidLevel:v,pyramidResolution:F,excessiveReading:J}=k.snapPyramid(Q,x,this.ioConfig.sampling);if(!J&&(u=y.srcExtent||k.projectExtent(u,L,W),null!=u)){(L=x.transform)&&(u=L.inverseTransform(u));
y.srcExtent=u;var {x:M,y:U}=x.storageInfo.origin;x=Math.floor((u.xmin-M)/F.x+.1);L=Math.floor((U-u.ymax)/F.y+.1);var V=Math.floor((u.xmax-M)/F.x-.1),X=Math.floor((U-u.ymin)/F.y-.1);V=u.width<.1*F.x?0:V-x+1;u=u.height<.1*F.y?0:X-L+1;y.pyramidLevel=v;y.pyramidResolution=F;y.srcWidth=V;y.srcHeight=u;y.ul={x,y:L}}};H._getRequestOptionsWithSliceId=function(u){null!=this.rasterInfo.multidimensionalInfo&&null==u.sliceId&&(u={...u,sliceId:this.getSliceIndex(u.multidimensionalDefinition)});return u};H._processIdentifyResult=
function(u,y){const {srcLocation:x,position:L,pyramidLevel:Q,useTransposedTile:W}=y,v=u.pixels[0].length/u.width/u.height;if(u.mask&&!u.mask[L])return{location:x,value:null};const {multidimensionalInfo:F}=this.rasterInfo;if(null==F||!W)return y=u.pixels.map(Y=>Y[L]),u={location:x,value:y,pyramidLevel:Q},y=this._computeMagDirValues(y.map(Y=>[Y])),y?.length&&(u.magdirValue=y.map(Y=>Y[0])),u;let J=u.pixels.map(Y=>Y.slice(L*v,L*v+v)),M=this._computeMagDirValues(J);const {requestSomeSlices:U,identifyOptions:V}=
y;let X=d.createSlices(F,V.transposedVariableName);if(U){const Y=d.getSliceIds(X,V.multidimensionalDefinition,V.timeExtent);J=J.map(ea=>Y.map(da=>ea[da]));M=M?.map(ea=>Y.map(da=>ea[da]));X=Y.map(ea=>X[ea])}y=u.noDataValues||this.rasterInfo.noDataValue;u={pixels:J,pixelType:u.pixelType};let Z;null!=y&&(q.convertNoDataToMask(u,y),Z=u.mask);u=X.map((Y,ea)=>{Y={value:0===Z?.[ea]?null:J.map(da=>da[ea]),multidimensionalDefinition:Y.multidimensionalDefinition.map(da=>new A({...da,isSlice:!0}))};M?.length&&
(Y.magdirValue=[M[0][ea],M[1][ea]]);return Y});return{location:x,value:null,dataSeries:u,pyramidLevel:Q}};P._createClass(O,[{key:"_isGlobalWrappableSource",get:function(){const {rasterInfo:u}=this,y=k.getWorldWidth(u.spatialReference);return null!=y&&u.extent.width>=y/2}},{key:"_hasNoneOrGCSShiftTransform",get:function(){const {transform:u}=this.rasterInfo;return null==u||"gcs-shift"===u.type}},{key:"rasterJobHandler",set:function(u){this._set("rasterJobHandler",u);"Function"===this.datasetFormat&&
this.primaryRasters?.rasters?.forEach(y=>y.rasterJobHandler=u)}},{key:"url",set:function(u){this._set("url",c.sanitizeUrl(u,R.getLogger(this)))}}]);return O}(K.EsriPromiseMixin(T.JSONSupport));w.__decorate([G.property()],E.prototype,"_rasterTileAlighmentInfo",void 0);w.__decorate([G.property({readOnly:!0})],E.prototype,"_isGlobalWrappableSource",null);w.__decorate([G.property({readOnly:!0})],E.prototype,"_hasNoneOrGCSShiftTransform",null);w.__decorate([G.property()],E.prototype,"rasterJobHandler",
null);w.__decorate([G.property(t.url)],E.prototype,"url",null);w.__decorate([G.property({type:String,json:{write:!0}})],E.prototype,"datasetName",void 0);w.__decorate([G.property({type:String,json:{write:!0}})],E.prototype,"datasetFormat",void 0);w.__decorate([G.property()],E.prototype,"hasUniqueSourceStorageInfo",void 0);w.__decorate([G.property()],E.prototype,"rasterInfo",void 0);w.__decorate([G.property()],E.prototype,"ioConfig",void 0);w.__decorate([G.property()],E.prototype,"sourceJSON",void 0);
return E=w.__decorate([g.subclass("esri.layers.support.rasterDatasets.BaseRaster")],E)})},"esri/layers/support/RasterStorageInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../geometry/Point".split(" "),function(P,w,E,C,B,T,R,S){var K;E=K=function(D){function G(){var h=D.apply(this,arguments)||
this;h.blockWidth=void 0;h.blockHeight=void 0;h.compression=null;h.origin=null;h.firstPyramidLevel=null;h.maximumPyramidLevel=null;h.pyramidScalingFactor=2;h.pyramidBlockWidth=null;h.pyramidBlockHeight=null;h.isVirtualTileInfo=!1;h.tileInfo=null;h.transposeInfo=null;h.blockBoundary=null;return h}P._inherits(G,D);G.prototype.clone=function(){return new K({blockWidth:this.blockWidth,blockHeight:this.blockHeight,compression:this.compression,origin:C.clone(this.origin),firstPyramidLevel:this.firstPyramidLevel,
maximumPyramidLevel:this.maximumPyramidLevel,pyramidResolutions:C.clone(this.pyramidResolutions),pyramidScalingFactor:this.pyramidScalingFactor,pyramidBlockWidth:this.pyramidBlockWidth,pyramidBlockHeight:this.pyramidBlockHeight,isVirtualTileInfo:this.isVirtualTileInfo,tileInfo:C.clone(this.tileInfo),transposeInfo:C.clone(this.transposeInfo),blockBoundary:C.clone(this.blockBoundary)})};return P._createClass(G)}(E.JSONSupport);w.__decorate([B.property({type:Number,json:{write:!0}})],E.prototype,"blockWidth",
void 0);w.__decorate([B.property({type:Number,json:{write:!0}})],E.prototype,"blockHeight",void 0);w.__decorate([B.property({type:String,json:{write:!0}})],E.prototype,"compression",void 0);w.__decorate([B.property({type:S,json:{write:!0}})],E.prototype,"origin",void 0);w.__decorate([B.property({type:Number,json:{write:!0}})],E.prototype,"firstPyramidLevel",void 0);w.__decorate([B.property({type:Number,json:{write:!0}})],E.prototype,"maximumPyramidLevel",void 0);w.__decorate([B.property({json:{write:!0}})],
E.prototype,"pyramidResolutions",void 0);w.__decorate([B.property({type:Number,json:{write:!0}})],E.prototype,"pyramidScalingFactor",void 0);w.__decorate([B.property({type:Number,json:{write:!0}})],E.prototype,"pyramidBlockWidth",void 0);w.__decorate([B.property({type:Number,json:{write:!0}})],E.prototype,"pyramidBlockHeight",void 0);w.__decorate([B.property({type:Boolean,json:{write:!0}})],E.prototype,"isVirtualTileInfo",void 0);w.__decorate([B.property({json:{write:!0}})],E.prototype,"tileInfo",
void 0);w.__decorate([B.property()],E.prototype,"transposeInfo",void 0);w.__decorate([B.property()],E.prototype,"blockBoundary",void 0);return E=K=w.__decorate([R.subclass("esri.layers.support.RasterStorageInfo")],E)})},"esri/layers/support/rasterDatasets/multidimensionalUtils":function(){define(["exports","../../../core/arrayUtils","../DimensionalDefinition"],function(P,w,E){function C(n,g,c){const t=g.shift();0===c.length&&c.push({sliceId:-1,multidimensionalDefinition:[]});const A=c.length;for(let r=
0;r<A;r++){const b=c.shift().multidimensionalDefinition;t.values?.forEach(f=>{c.push({sliceId:-1,multidimensionalDefinition:[...b,{variableName:n,dimensionName:t.name,values:[f]}]})})}g.length&&C(n,g,c)}function B(n,g){return Array.isArray(n)?g[0]===g[1]?n[0]===g[0]||n[1]===g[0]:n[0]>=g[0]&&n[0]<=g[1]&&n[1]>=g[0]&&n[1]<=g[1]:n>=g[0]&&n<=g[1]}function T(n,g){return n[0]<=g[0]&&n[1]>=g[0]||n[0]<=g[1]&&n[1]>=g[1]||n[0]>=g[0]&&n[1]<=g[1]}function R(n){return 1===n.length?[n[0],n[0]]:[n[0],n[n.length-
1]]}function S(n,g,c){if(!g?.subsetDefinitions?.length)return n;if(c){const {variables:A}=g;if(A.length&&!A.includes(c))return null;g=g.subsetDefinitions.find(r=>r.dimensionName===n.name&&r.variableName===c);if(!g?.values?.length)return n;g=R(g.values)}else g=g.dimensions.find(({name:A})=>A===n.name)?.extent;const t=g;if(!t||!t?.length)return n;g=n.values.filter(A=>B(A,t));return{...n,extent:[...t],values:g}}function K(n,g,c){if(!g?.subsetDefinitions?.length)return!1;const {variables:t}=g;if(t.length&&
n.some(({variableName:A})=>A&&!t.includes(A)))return!0;for(let A=0;A<n.length;A++){const r=n[A],b=g.subsetDefinitions.find(f=>(""===r.variableName||f.variableName===r.variableName)&&f.dimensionName===r.dimensionName);if(b?.values.length){const f=R(b.values);if(!r.isSlice&&2===r.values.length&&!Array.isArray(r.values[0])&&r.values[0]!==r.values[1]&&c){if(!T(r.values,f))return!0}else if(r.values.some(d=>!B(d,f)))return!0}}return!1}function D(n,g){var c=n.dimensions.find(({name:b})=>"StdTime"===b);if(null==
c||null==g.start&&null==g.end)return g;g=g.clone();const {start:t,end:A}=g.toJSON(),r=t===A?[t]:null!=t&&null!=A?[t,A]:[t??A];if(2===r.length&&c?.extent.length&&(r[0]=Math.max(r[0],c.extent[0]),r[1]=Math.min(r[1],c.extent[1]??c.extent[0]),r[1]<r[0]))return null;c=new E({variableName:"",dimensionName:"StdTime",isSlice:1===r.length,values:r});if(K([c],n,!0))return null;g.start=new Date(r[0]);g.end=new Date(r[1]??r[0]);return g}function G(n,g={}){const {multidimensionalInfo:c,keyProperties:t}=n;if(null==
c)return null;const {variableName:A,multidimensionalSubset:r,multidimensionalDefinition:b}=g;n=null!=b?b[0]?.variableName:null;const f=A||n||t?.DefaultVariable;({variables:n}=c);r?.variables?.length&&(n=n.filter(({name:d})=>r.variables.includes(d)));return f?n.find(({name:d})=>d===f)??n[0]:n[0]}function h(n,g){var {values:c}=g;if(c?.length){g=Array.isArray(c[0]);var t=Array.isArray(n);return g!==t?-1:g&&t?c.findIndex(r=>r[0]===n[0]&&r[1]===n[1]):c.indexOf(n)}({extent:t}=g);if(Array.isArray(n)||n<
t[0]||n>t[1])return-1;c=g.interval||1;if("ISO8601"!==g.unit)return Math.round((n-t[0])/c);t=t[0];let A=-1;switch(g.intervalUnit?.toLowerCase()||"seconds"){case "seconds":A=Math.round((n-t)/1E3/c);break;case "minutes":A=Math.round((n-t)/6E4/c);break;case "hours":A=Math.round((n-t)/36E5/c);break;case "days":A=Math.round((n-t)/864E5/c);break;case "months":g=(new Date(n)).getUTCFullYear()-(new Date(t)).getUTCFullYear();c=(new Date(t)).getUTCMonth();t=(new Date(n)).getUTCMonth();A=0===g?t-c:t+11-c+12*
(g-1);break;case "years":A=Math.round(((new Date(n)).getUTCFullYear()-(new Date(t)).getUTCFullYear())/c);break;case "decades":A=Math.round(((new Date(n)).getUTCFullYear()-(new Date(t)).getUTCFullYear())/10/c)}return A}function m(n){var g=n.values?.length;if(g)return g;const {extent:c,unit:t}=n;g=n.interval||1;var A=c?c[1]-c[0]:0;if("ISO8601"!==t)return Math.round(A/g);switch(n.intervalUnit?.toLowerCase()??"seconds"){case "seconds":g=Math.round(A/1E3/g);break;case "minutes":g=Math.round(A/6E4/g);break;
case "hours":g=Math.round(A/36E5/g);break;case "days":g=Math.round(A/864E5/g);break;case "months":n=(new Date(c[1])).getUTCFullYear()-(new Date(c[0])).getUTCFullYear();g=(new Date(c[0])).getUTCMonth();A=(new Date(c[1])).getUTCMonth();g=0===n?A-g+1:A+11-g+12*(n-1)+1;break;case "years":g=Math.round(((new Date(c[1])).getUTCFullYear()-(new Date(c[0])).getUTCFullYear())/g);break;case "decades":g=Math.round(((new Date(c[1])).getUTCFullYear()-(new Date(c[0])).getUTCFullYear())/10/g);break;default:g=0}return g}
P.createSlices=function(n,g){const c=[];let t=0;(g?n.variables.filter(A=>A.name.toLowerCase()===g.toLowerCase()):[...n.variables].sort((A,r)=>A.name>r.name?1:-1)).forEach(A=>{const r=[],b=[...A.dimensions].sort((f,d)=>f.name>d.name?-1:1);C(A.name,b,r);r.forEach(f=>{c.push({...f,sliceId:t++})})});return c};P.getDefaultMultidimensionalDefinition=function(n,g={}){var c=G(n,g);if(!c)return null;n=[];const {dimensions:t,name:A}=c;if(0===t.length)return[new E({variableName:A,dimensionName:"",values:[],
isSlice:!0})];for(c=0;c<t.length;c++){const r=S(t[c],g.multidimensionalSubset,A);if(!r)return null;const {values:b,extent:f}=r;let d=b?.[0]??f[0];"stdz"===r.name.toLowerCase()&&!r.hasRanges&&Math.abs(f[1])<=Math.abs(f[0])&&(d=b?.length?b[b.length-1]:f[1]);n.push(new E({variableName:A,dimensionName:r.name,values:[d],isSlice:g.useRangeForRangedDimensionInfo?!!r.hasRanges:!0}))}return n};P.getDefaultVariablInfo=G;P.getSliceIds=function(n,g,c){let t=n;g&&(g=[...g].sort((A,r)=>A.dimensionName<r.dimensionName?
-1:1),g.forEach(({dimensionName:A,values:r,isSlice:b})=>{r.length&&(t=t.filter(f=>{f=f.multidimensionalDefinition.find(e=>e.dimensionName===A);if(null==f)return!1;const d=f.values[0];return"number"===typeof d?"number"===typeof r[0]?r.includes(d):r.some(e=>e[0]<=d&&e[1]>=d):"number"===typeof r[0]?r.some(e=>d[0]<=e&&d[1]>=e):b?r.some(e=>e[0]===d[0]&&e[0]===d[1]):r.some(e=>e[0]>=d[0]&&e[0]<=d[1]||e[1]>=d[0]&&e[1]<=d[1]||e[0]<d[0]&&e[1]>d[1])}))}));if(t.length&&c&&null!=c.start&&null!=c.end){const A=
c.start.getTime(),r=c.end.getTime(),b=t[0].multidimensionalDefinition.findIndex(f=>"StdTime"===f.dimensionName);-1<b&&(t=t.filter(f=>{f=f.multidimensionalDefinition[b].values[0];return A<=f&&r>=f}))}return t.map(A=>A.sliceId)};P.getSliceIndex=function(n,g){let c=0;var t=n[0].variableName;g=[...g.variables].sort((r,b)=>r.name>b.name?1:-1);for(var A=0;A<g.length;A++){const r=g[A],b=[...r.dimensions].sort((f,d)=>f.name>d.name?-1:1);if(r.name!==t)c+=b.map(f=>m(f)).reduce((f,d)=>f*d);else{t=b.map(f=>m(f));
g=b.length;for(let f=0;f<g;f++){A=n.find(d=>d.dimensionName===b[f].name);if(null==A)return null;A=h(A.values[0],b[f]);if(-1===A)return null;t.shift();c=f===g-1?c+A:c+A*t.reduce((d,e)=>d*e)}break}}return c};P.getSubsetVariablesFromMdInfo=function(n,g){if(null==g||null==n)return null;g=g.variables.map(c=>({...c}));n?.variables?.length&&(g=g.filter(({name:c})=>n.variables.includes(c)),g.forEach(c=>{c.dimensions=c.dimensions.map(t=>S(t,n,c.name)).filter(w.isSome)}));return g};P.hasExcludedVariableOrDimension=
K;P.intersectMultimensionalSubset=function(n,g){if(null==n)return{isOutside:!1};const {geometry:c,timeExtent:t,multidimensionalDefinition:A}=g;g=null;if(null!=t&&(g=D(n,t),null==g))return{isOutside:!0};const {areaOfInterest:r}=n;if(r&&c){const b="point"===c.type?c:"extent"===c.type?c.center:"polygon"===c.type?c.centroid:null;if(b&&!r.contains(b))return{isOutside:!0}}return null!=A&&A.length&&K(A,n,!0)?{isOutside:!0}:{isOutside:!1,intersection:{geometry:c,timeExtent:g,multidimensionalDefinition:A}}};
P.isMultiSliceOrRangeDefinition=function(n){return null!=n&&n.length?n.some(g=>{if(null==g.values)return!0;const c=g.values.length;return 0===c||1<c||!g.isSlice&&Array.isArray(g.values[0])}):!1};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/RawBlockCache":function(){define(["exports","../../../geometry","./EphemeralBlockCache","../rasterFunctions/rasterProjectionHelper","../../../geometry/Point"],function(P,w,E,C,B){function T(K,D){return(K=R.get(K))?
K[D]??null:null}const R=new Map,S=new E;P.decreaseRefCount=function(K,D,G){const h=R.get(K);if(!h)return null==D?S.decreaseRefCount(K,G):0;if(null==D||null==h[D])return S.decreaseRefCount(K,G);D=h[D]?.cache;K=D?.get(G);if(D&&K){K.refCount--;if(0===K.refCount){D.delete(G);for(D=0;D<h.length;D++)h[D]?.cache.delete(G);K.controller&&K.controller.abort()}return K.refCount}return 0};P.deleteBlock=function(K,D,G){const h=R.get(K);h?null==D||null==h[D]?S.deleteBlock(K,G):h[D]?.cache.delete(G):null==D&&S.deleteBlock(K,
G)};P.deleteRaster=function(K){R.delete(K)};P.getBlock=function(K,D,G){const h=R.get(K);if(!h)return null==D?S.getBlock(K,G):null;if(null==D||null==h[D]){for(D=0;D<h.length;D++){var m=h[D]?.cache.get(G);if(m)return m.refCount++,m.block}return S.getBlock(K,G)}if(K=h[D]?.cache.get(G))return K.refCount++,K.block;for(K=0;K<h.length;K++){if(K===D||!h[K])continue;m=h[K]?.cache;const n=m?.get(G);if(m&&n)return n.refCount++,m.set(G,n),n.block}return null};P.getRasterId=function(K,D){return null==D?K:`${K}?sliceId=${D}`};
P.putBlock=function(K,D,G,h,m=null){const n=R.get(K);if(n)if(null==D||null==n[D])S.putBlock(K,G,h,m);else{var g={refCount:1,block:h,isResolved:!1,isRejected:!1,controller:m};h.then(()=>g.isResolved=!0).catch(()=>g.isRejected=!0);n[D]?.cache.set(G,g)}else null==D&&S.putBlock(K,G,h,m)};P.register=function(K,D){D={extent:null,rasterInfo:D,cache:new Map};const G=R.get(K);if(G)return G.push(D),G.length-1;R.set(K,[D]);return 0};P.unregister=function(K,D){const G=R.get(K);G&&(G[D]=null,G.some(h=>null!=h)||
R.delete(K))};P.update=function(K,D,G,h,m,n,g=null){if(K=T(K,D)){D=K.extent;var {cache:c,rasterInfo:t}=K;if(!D||D.xmin!==G.xmin||D.xmax!==G.xmax||D.ymin!==G.ymin||D.ymax!==G.ymax){h=h??0;D=G.clone().normalize();var {spatialReference:A,transform:r}=t,b=new Set;for(let a=0;a<D.length;a++){var f=D[a];if(f.xmax-f.xmin<=h||f.ymax-f.ymin<=h)continue;var d=C.projectExtent(f,A,g);null!=r&&(d=r.inverseTransform(d));var e=new B({x:h,y:h,spatialReference:f.spatialReference});if(null==m&&(m=C.projectResolution(e,
A,f,g),!m))return;const {pyramidLevel:k,pyramidResolution:p,excessiveReading:z}=C.snapPyramid(m,t,n||"closest");if(z)return;({storageInfo:f}=t);var {origin:q}=f;e=Math.max(0,Math.floor((d.xmin-q.x)/p.x));q=Math.max(0,Math.floor((q.y-d.ymax)/p.y));const I=0<k?f.pyramidBlockWidth:f.blockWidth,N=0<k?f.pyramidBlockHeight:f.blockHeight;f=Math.max(0,Math.floor(e/I)-1);var l=Math.max(0,Math.floor(q/N)-1);e=Math.floor((e+Math.ceil((d.xmax-d.xmin)/p.x-.1)-1)/I)+1;d=Math.floor((q+Math.ceil((d.ymax-d.ymin)/
p.y-.1)-1)/N)+1;for(q=l;q<=d;q++)for(l=f;l<=e;l++)b.add(`${k}/${q}/${l}`)}c.forEach((a,k)=>{b.has(k)||(a=c.get(k),(null==a||a.isResolved||a.isRejected)&&c.delete(k))});K.extent={xmin:G.xmin,ymin:G.ymin,xmax:G.xmax,ymax:G.ymax}}}};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/EphemeralBlockCache":function(){define(["../../../chunks/_rollupPluginBabelHelpers"],function(P){return function(){function w(C=15E3,B=5E3){this._timer=null;this._cachedBlocks=
new Map;this._size=-1;this._duration=C;this._interval=Math.min(C,B)}var E=w.prototype;E.decreaseRefCount=function(C,B){C=C+"/"+B;B=this._cachedBlocks;if(B.has(C)){const T=B.get(C);T.refCount--;0>=T.refCount&&(B.delete(C),T.controller&&T.controller.abort());return T.refCount}return 0};E.getBlock=function(C,B){C=C+"/"+B;B=this._cachedBlocks;if(B.has(C)){const T=B.get(C);T.ts=Date.now();T.refCount++;B.delete(C);B.set(C,T);return T.block}return null};E.putBlock=function(C,B,T,R){const S=this._cachedBlocks;
C=C+"/"+B;S.has(C)?(T=S.get(C),T.ts=Date.now(),T.refCount++):S.set(C,{block:T,ts:Date.now(),refCount:1,controller:R});this._trim();this._updateTimer()};E.deleteBlock=function(C,B){const T=this._cachedBlocks;C=C+"/"+B;T.has(C)&&T.delete(C)};E.updateMaxSize=function(C){this._size=C;this._trim()};E.empty=function(){this._cachedBlocks.clear();this._clearTimer()};E.getCurrentSize=function(){return this._cachedBlocks.size};E._updateTimer=function(){if(null==this._timer){var C=this._cachedBlocks;this._timer=
setInterval(()=>{const B=Array.from(C),T=Date.now();for(let R=0;R<B.length;R++)if(B[R][1].ts<=T-this._duration)C.delete(B[R][0]);else break;0===C.size&&this._clearTimer()},this._interval)}};E._trim=function(){const C=this._cachedBlocks;if(!(-1===this._size||this._size>=C.size)){var B=Array.from(C);for(let T=0;T<B.length-this._size;T++)C.delete(B[T][0])}};E._clearTimer=function(){null!=this._timer&&(clearInterval(this._timer),this._timer=null)};return P._createClass(w)}()})},"esri/layers/support/rasterFunctions/rasterProjectionHelper":function(){define("exports ../../../geometry ../../../core/arrayUtils ../../../core/Error ../../../core/unitUtils ../../../chunks/pe ../../../geometry/projection ../../../geometry/Extent ../../../geometry/Point ../../../geometry/Polygon ../../../geometry/SpatialReference".split(" "),
function(P,w,E,C,B,T,R,S,K,D,G){function h(v,F,J){return!R.canProjectWithoutEngine(v,F,J)}function m(v,F,J){if((v=h(v,F,J))&&!R.isLoaded())throw new C("rasterprojectionhelper-project","projection engine is not loaded");return v}function n(v,F,J,M=null){const U=v.spatialReference;if(U.equals(F))return v;m(U,F,M);J=J.center;J=new S({xmin:J.x-v.x/2,xmax:J.x+v.x/2,ymin:J.y-v.y/2,ymax:J.y+v.y/2,spatialReference:U});M=R.project(J,F,M);J=z(F);null==M||null!=J&&M.width>=J?(F=B.getMetersPerUnitForSR(U)/B.getMetersPerUnitForSR(F),
v={x:v.x*F,y:v.y*F}):v={x:M.width,y:M.height};return v}function g(v,F=.01){return B.getMetersPerUnitForSR(v)?F/B.getMetersPerUnitForSR(v):0}function c(v,F,J=null,M=!0){const U=v.spatialReference;if(U.equals(F))return v;m(U,F,J);J=R.project(v,F,J);if(!M||!J)return J;t([v],[J],U,F);return J}function t(v,F,J,M){const U=I(J,!0),V=I(M,!0);J=g(J,500);M=g(M,500);if(J&&null!=U&&null!=V)for(let X=0;X<v.length;X++){const Z=F[X];if(!Z)continue;const {x:Y}=v[X],{x:ea}=Z;ea>=V[1]-M&&Math.abs(Y-U[0])<J?Z.x-=V[1]-
V[0]:ea<=V[0]+M&&Math.abs(Y-U[1])<J&&(Z.x+=V[1]-V[0])}}function A(v){const {inSR:F,outSR:J,datumTransformation:M,preferPE:U}=v;if(F.equals(J))return{points:v}=e(v,null),v;if(F.isWebMercator&&J.isWGS84||F.isWGS84&&J.isWebMercator){const {cols:Y,rows:ea,xres:da,yres:ia,usePixelCenter:fa,inSR:ja,outSR:ma}=v;let {xmin:na,ymax:ra}=v;fa&&(na+=da/2,ra-=ia/2);v=[];const qa=[];var V=Math.max(Y,ea);for(var X=0;X<V;X++){var Z=R.project(new K({x:na+da*Math.min(Y,X),y:ra-ia*Math.min(ea,X),spatialReference:ja}),
ma);X<=Y&&v.push(Z.x);X<=ea&&qa.push(Z.y)}V=[];for(X=0;X<Y;X++)for(Z=0;Z<ea;Z++)V.push([v[X],qa[Z]]);return V}return m(F,J,M)&&U&&(F.isGeographic||null!=f(F))?b(v):r(v)}function r(v){var {points:F}=e(v,null);const {inSR:J,outSR:M,datumTransformation:U}=v;v=F.map(V=>new K(V[0],V[1],J));F=R.project(v,M,U);U&&t(v,F,J,M);return F.map(V=>V?[V.x,V.y]:[NaN,NaN])}function b(v){const {inSR:F,outSR:J,datumTransformation:M}=v;var U=f(F);const {points:V,mask:X}=e(v,U);F.isGeographic||(v=F.wkid?T.PeFactory.coordsys(F.wkid):
T.PeFactory.fromString(F.isGeographic?T.PeDefs.PE_TYPE_GEOGCS:T.PeDefs.PE_TYPE_PROJCS,F.wkt),T.PeCSTransformations.projToGeog(v,V.length,V));if(null!=M&&M.steps.length){var Z;J.isGeographic&&(Z=V.map(([Y])=>179.9955<Y?1:-179.9955>Y?-1:0));M.steps.forEach(Y=>{const ea=Y.wkid?T.PeFactory.geogtran(Y.wkid):T.PeFactory.fromString(T.PeDefs.PE_TYPE_GEOGTRAN,Y.wkt);T.PeGTTransformations.geogToGeog(ea,V.length,V,null,Y.isInverse?T.PeDefs.PE_TRANSFORM_2_TO_1:T.PeDefs.PE_TRANSFORM_1_TO_2)});if(Z)for(v=0;v<V.length;v++){U=
Z[v];const Y=V[v][0],ea=179.9955<Y?1:-179.9955>Y?-1:0;U&&ea&&U!==ea&&(V[v][0]=0<U?Y+360:Y-360)}}J.isGeographic||(Z=f(J,!0),q(V,null!=Z&&Z.isEnvelope?[Z.bbox[1],Z.bbox[3]]:[-90,90]),Z=J.wkid?T.PeFactory.coordsys(J.wkid):T.PeFactory.fromString(J.isGeographic?T.PeDefs.PE_TYPE_GEOGCS:T.PeDefs.PE_TYPE_PROJCS,J.wkt),T.PeCSTransformations.geogToProj(Z,V.length,V));Z=V;if(X&&V.length!==X.length){Z=[];for(let Y=0,ea=0;Y<X.length;Y++)X[Y]?Z.push(V[ea++]):Z.push([NaN,NaN])}return Z}function f(v,F=!1){var J=
v.wkid||v.wkt;if(!J||v.isGeographic)return null;J=String(J);if(Q.has(J))return J=Q.get(J),F?J?.gcs:J?.pcs;var M=v.wkid?T.PeFactory.coordsys(v.wkid):T.PeFactory.fromString(v.isGeographic?T.PeDefs.PE_TYPE_GEOGCS:T.PeDefs.PE_TYPE_PROJCS,v.wkt);v=g(v,1E-4);v=d(M,v);M=d(M,0,!0);Q.set(J,{pcs:v,gcs:M});return F?M:v}function d(v,F=0,J=!1){var M=T.PePCSInfo.generate(v),U=J?v.horizonGcsGenerate():v.horizonPcsGenerate();if(!M||!U?.length)return null;v=!1;var V=U.find(da=>1===da.getInclusive()&&1===da.getKind());
if(!V){V=U.find(da=>1===da.getInclusive()&&0===da.getKind());if(!V)return null;v=!0}J=J?0:(2===M.getNorthPoleLocation()?1:0)|(2===M.getSouthPoleLocation()?2:0);M=M.isPannableRectangle();V=V.getCoord();if(v)return{isEnvelope:v,isPannable:M,vertices:V,coef:null,bbox:[V[0][0]-F,V[0][1]-F,V[1][0]+F,V[1][1]+F],poleLocation:J};F=0;v=[];let [X,Z]=V[0],[Y,ea]=V[0];for(let da=0,ia=V.length;da<ia;da++){F++;F===ia&&(F=0);const [fa,ja]=V[da],[ma,na]=V[F];if(na===ja)v.push([fa,ma,ja,na,2]);else{U=(ma-fa)/(na-
ja||1E-4);const ra=fa-U*ja;ja<na?v.push([U,ra,ja,na,0]):v.push([U,ra,na,ja,1])}X=X<fa?X:fa;Z=Z<ja?Z:ja;Y=Y>fa?Y:fa;ea=ea>ja?ea:ja}return{isEnvelope:!1,isPannable:M,vertices:V,coef:v,bbox:[X,Z,Y,ea],poleLocation:J}}function e(v,F){const J=[],{cols:M,rows:U,xres:V,yres:X,usePixelCenter:Z}=v;let {xmin:Y,ymax:ea}=v;Z&&(Y+=V/2,ea-=X/2);if(null==F){for(v=0;v<M;v++)for(F=0;F<U;F++)J.push([Y+V*v,ea-X*F]);return{points:J}}v=new Uint8Array(M*U);if(F.isEnvelope){const {bbox:[ra,qa,va,sa]}=F;for(let xa=0,oa=
0;xa<M;xa++){var da=Y+V*xa,ia=F.isPannable||da>=ra&&da<=va;for(var fa=0;fa<U;fa++,oa++){var ja=ea-X*fa;ia&&ja>=qa&&ja<=sa&&(J.push([da,ja]),v[oa]=1)}}return{points:J,mask:v}}da=F.coef;F=[];for(ia=0;ia<U;ia++){var ma=ea-X*ia;fa=[];ja=[];for(var na=0;na<da.length;na++){const [ra,qa,va,sa,xa]=da[na];ma===va&&va===sa?(fa.push(ra),fa.push(qa),ja.push(2),ja.push(2)):ma>=va&&ma<=sa&&(fa.push(ra*ma+qa),ja.push(xa))}ma=fa;if(2<fa.length){na=2===ja[0]?0:ja[0];let ra=fa[0];ma=[];for(let qa=1;qa<ja.length;qa++)if(2!==
ja[qa]||qa===ja.length-1)ja[qa]!==na&&(ma.push(0===na?Math.min(ra,fa[qa-1]):Math.max(ra,fa[qa-1])),na=ja[qa],ra=fa[qa]),qa===ja.length-1&&ma.push(0===ja[qa]?Math.min(ra,fa[qa]):Math.max(ra,fa[qa]));ma.sort((qa,va)=>qa-va)}else fa[0]>fa[1]&&(ma=[fa[1],fa[0]]);F.push(ma)}for(let ra=0,qa=0;ra<M;ra++)for(da=Y+V*ra,ia=0;ia<U;ia++,qa++)if(fa=ea-X*ia,ja=F[ia],2===ja.length)da>=ja[0]&&da<=ja[1]&&(J.push([da,fa]),v[qa]=1);else if(2<ja.length){ma=!1;for(na=0;na<ja.length;na+=2)if(da>=ja[na]&&da<=ja[na+1]){ma=
!0;break}ma&&(J.push([da,fa]),v[qa]=1)}return{points:J,mask:v}}function q(v,F){const [J,M]=F;for(F=0;F<v.length;F++){const U=v[F][1];if(U<J||U>M)v[F]=[NaN,NaN]}}function l(v){const F=z(v[0].spatialReference);if(2>v.length||null==F)return v[0];const J=g(v[0].spatialReference);v=v.filter(Z=>Z.width>J);if(1===v.length)return v[0];let {xmin:M,xmax:U,ymin:V,ymax:X}=v[0];for(let Z=1;Z<v.length;Z++){const Y=v[Z];U=Y.xmax+F*Z;V=Math.min(V,Y.ymin);X=Math.max(X,Y.ymax)}return new S({xmin:M,xmax:U,ymin:V,ymax:X,
spatialReference:v[0].spatialReference})}function a(v,F,J=null,M=!0){var U=v.spatialReference;if(U.equals(F))return v;var V=O(v);const X=z(U,!0);var Z=z(F);if(0===V||null==X||null==Z)return V=p(v,F,J,M),null==X&&null!=Z&&Math.abs(V.width-Z)<g(F)&&R.isLoaded()&&(U=f(U),null!=U&&U.poleLocation===y.None&&v.width<(U.bbox[2]-U.bbox[0])/2)?k(v,F)||V:V;Z=v.clone().normalize();if(1===Z.length&&v.xmax<X&&v.xmax-X/2>g(U)){const {xmin:Y,xmax:ea}=v;for(let da=0;da<=V;da++)Z[da]=new S({xmin:0===da?Y:-X/2,xmax:da===
V?ea-X*da:X/2,ymin:v.ymin,ymax:v.ymax,spatialReference:U})}v=Z.map(Y=>p(Y,F,J,M));return l(v.filter(E.isSome))}function k(v,F){const J=z(F);if(null==J)return null;let {xmin:M,ymin:U,xmax:V,ymax:X}=v;var Z=v.spatialReference;v=new D({spatialReference:Z,rings:[[[M,U],[V,U],[V,X],[M,X],[M,U]]]});v=R.project(v,F);if(2!==v.rings.length||!v.rings[0].length||!v.rings[1].length)return null;({rings:v}=v);Z=g(Z);F=new S({spatialReference:F});for(let Y=0;2>Y;Y++){M=V=v[Y][0][0];U=X=v[Y][0][1];for(let ea=0;ea<
v[Y].length;ea++)M=M>v[Y][ea][0]?v[Y][ea][0]:M,V=V<v[Y][ea][0]?v[Y][ea][0]:V,U=U>v[Y][ea][1]?v[Y][ea][1]:U,X=X<v[Y][ea][1]?v[Y][ea][1]:X;if(0===Y)F.ymin=U,F.ymax=X,F.xmin=M,F.xmax=V;else if(F.ymin=Math.min(F.ymin,U),F.ymax=Math.max(F.ymax,X),Math.abs(V-J/2)<Z)F.xmin=M,F.xmax+=J;else if(Math.abs(M+J/2)<Z)F.xmax=V+J;else return null}return F}function p(v,F,J=null,M=!0,U=!0){const V=v.spatialReference;if(V.equals(F)||!F)return v;m(V,F,J);const X=R.project(v,F,J);if(U&&F.isWebMercator&&X&&(X.ymax=Math.min(2.0037508342787E7,
X.ymax),X.ymin=Math.max(-2.0037508342787E7,X.ymin),X.ymin>=X.ymax))return null;if(!M||!X)return X;var Z=I(V,!0);M=I(F,!0);if(null==Z||null==M)return X;U=g(V,.001);const Y=g(V,500);var ea=g(F,.001);if(Math.abs(X.xmin-M[0])<ea&&Math.abs(X.xmax-M[1])<ea){ea=Math.abs(v.xmin-Z[0]);Z=Math.abs(Z[1]-v.xmax);if(ea<U&&Z>Y){X.xmin=M[0];var da=[];da.push(new K(v.xmax,v.ymin,V));da.push(new K(v.xmax,(v.ymin+v.ymax)/2,V));da.push(new K(v.xmax,v.ymax,V));da=da.map(ia=>c(ia,F,J)).filter(ia=>!isNaN(ia?.x)).map(ia=>
ia.x);X.xmax=Math.max.apply(null,da)}Z<U&&ea>Y&&(X.xmax=M[1],M=[],M.push(new K(v.xmin,v.ymin,V)),M.push(new K(v.xmin,(v.ymin+v.ymax)/2,V)),M.push(new K(v.xmin,v.ymax,V)),v=M.map(ia=>c(ia,F,J)).filter(ia=>!isNaN(ia?.x)).map(ia=>ia.x),X.xmin=Math.min.apply(null,v))}else v=g(F,.001),Math.abs(X.xmin-M[0])<v&&(X.xmin=M[0]),Math.abs(X.xmax-M[1])<v&&(X.xmax=M[1]);return X}function z(v,F=!1){return v?v.isWebMercator?2*(F?2.0037508342787E7:2.0037508342788905E7):v.wkid&&v.isGeographic?360:2*L[v.wkid]||null:
null}function I(v,F=!1){if(v.isGeographic)return[-180,180];v=z(v,F);return null!=v?[-v/2,v/2]:null}function N(v,F,J,M){v=(v-F)/J;0!==v-Math.floor(v)?v=Math.floor(v):M&&--v;return v}function O(v,F=!1){var J=z(v.spatialReference);if(null==J)return 0;const M=F?0:-(J/2),U=g(v.spatialReference),V=!F&&Math.abs(v.xmin+J/2)<U?-J/2:v.xmin;v=N(!F&&Math.abs(v.xmax-J/2)<U?J/2:v.xmax,M,J,!0);J=N(V,M,J,!1);return v-J}function H(v){const {projectedExtent:F,srcBufferExtent:J,pixelSize:M,datumTransformation:U,rasterTransform:V}=
v;var X=F.spatialReference;const Z=J.spatialReference;var Y=m(X,Z);const {xmin:ea,ymin:da,xmax:ia,ymax:fa}=F,ja=z(Z),ma=null!=ja&&(v.hasWrapAround||"gcs-shift"===V?.type);v=v.spacing||[32,32];var na=v[0]*M.x,ra=v[1]*M.y;const qa=1===v[0],va=Math.ceil((ia-ea)/na-.1/v[0])+(qa?0:1),sa=Math.ceil((fa-da)/ra-.1/v[1])+(qa?0:1);na=A({cols:va,rows:sa,xmin:ea,ymax:fa,xres:na,yres:ra,inSR:X,outSR:Z,datumTransformation:U,preferPE:4>=v[0],usePixelCenter:qa});ra=[];let xa,oa=0;const wa=qa?-1:NaN,{xmin:aa,xmax:ha,
ymax:ba,width:ka,height:la}=J,ca=g(Z,500),pa=null!=ja&&0<aa&&ha>ja/2;var ua=!1;Y&&(ua=f(X),ua=null!=ua&&0<ua.poleLocation);for(X=0;X<va;X++){Y=[];for(let ya=0;ya<sa;ya++){var ta=na[X*sa+ya];ma&&ta[0]>ha&&ta[0]>ja/2-ca?ta[0]-=ja:ma&&0===X&&0>ta[0]&&pa&&!V&&(ta[0]+=ja);!ta||isNaN(ta[0])||isNaN(ta[1])?(ra.push(wa),ra.push(wa),Y.push(null),oa++):(V&&(ta=V.inverseTransform(new K({x:ta[0],y:ta[1],spatialReference:Z})),ta=[ta.x,ta.y]),Y.push(ta),0<X&&ma&&xa[ya]&&ta[0]<xa[ya][0]&&(ta[0]+=ja,ua&&ta[0]>ha&&
ta[0]>ja&&(ta[0]-=ja)),ra.push((ta[0]-aa)/ka),ra.push((ba-ta[1])/la))}xa=Y}return{offsets:ra,error:null,coefficients:null,outofBoundPointCount:oa,spacing:v,size:qa?[va,sa]:[va-1,sa-1]}}function u(v,F,J){const {cols:M,rows:U}=F;F=new Float32Array((M-1)*(U-1)*12);const V=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),X=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let fa=0;fa<M-1;fa++){for(var Z=0;Z<U-1;Z++){var Y=fa*U*2+2*Z,ea=v[Y];const ja=v[Y+1];var da=v[Y+2],ia=v[Y+3];Y+=2*U;const ma=v[Y],na=v[Y+1],
ra=v[Y+2];Y=v[Y+3];let qa=0,va=12*(Z*(M-1)+fa);for(let sa=0;3>sa;sa++)F[va++]=V[qa++]*ea+V[qa++]*da+V[qa++]*ra;qa=0;for(da=0;3>da;da++)F[va++]=V[qa++]*ja+V[qa++]*ia+V[qa++]*Y;qa=0;for(ia=0;3>ia;ia++)F[va++]=X[qa++]*ea+X[qa++]*ma+X[qa++]*ra;qa=0;for(ea=0;3>ea;ea++)F[va++]=X[qa++]*ja+X[qa++]*na+X[qa++]*Y}if(J)for(Z=0;Z<F.length;Z++)isNaN(F[Z])&&(F[Z]=-1)}return F}var y;(function(v){v[v.None=0]="None";v[v.North=1]="North";v[v.South=2]="South";v[v.Both=3]="Both"})(y||(y={}));const x=(v,F,J,M=0)=>{if(1===
J[0])return[0,0];var U=1,V=-1,X=1,Z=-1;for(var Y=0;Y<v.length;Y+=2)isNaN(v[Y])||(U=U>v[Y]?v[Y]:U,V=V>v[Y]?V:v[Y],X=X>v[Y+1]?v[Y+1]:X,Z=Z>v[Y+1]?Z:v[Y+1]);const {cols:ea,rows:da}=F;F=(V-U)/ea/J[0];J=(Z-X)/da/J[1];M*=2;X=0;Z=!1;U=[0,0];for(V=0;V<ea-3;V++){for(Y=0;Y<da-3;Y++){var ia=V*da*2+2*Y;const fa=Math.abs(((v[ia]+v[ia+4]+v[ia+4*da]+v[ia+4*da+4])/4-v[ia+2*da+2])/F);ia=Math.abs(((v[ia+1]+v[ia+5]+v[ia+4*da+1]+v[ia+4*da+5])/4-v[ia+2*da+3])/J);fa+ia>X&&(X=fa+ia,U=[fa,ia]);if(M&&X>M){Z=!0;break}}if(Z)break}return U},
L={3395:2.0037508342789244E7,3410:1.7334193943686873E7,3857:2.0037508342788905E7,3975:1.7367530445161372E7,4087:2.0037508342789244E7,4088:2.0015108787169147E7,6933:1.7367530445161372E7,32662:2.0037508342789244E7,53001:2.001508679602057E7,53002:1.000754339801029E7,53003:2.001508679602057E7,53004:2.001508679602057E7,53016:1.4152803599503474E7,53017:1.7333573624304302E7,53034:2.001508679602057E7,53079:2.0015114352186374E7,53080:2.0015114352186374E7,54001:2.0037508342789244E7,54002:1.0018754171394624E7,
54003:2.0037508342789244E7,54004:2.0037508342789244E7,54016:1.4168658027268292E7,54017:1.736753044516137E7,54034:2.0037508342789244E7,54079:2.0037508342789244E7,54080:2.0037508342789244E7,54100:2.0037508342789244E7,54101:2.0037508342789244E7},Q=new Map,W=new Map;P.computeProjectedScales=function(v,F,J){var M=J?.tileSize??512,U=J?.alignGlobalDatasetWithAGOL??!0,V=!!J?.limitToSrcResolution;const {extent:X,spatialReference:Z,pixelSize:Y}=v;J=n(new K({x:Y.x,y:Y.y,spatialReference:Z}),F,X);if(null==J)return{projectedPixelSize:null,
scales:null,srcResolutions:null,isCustomTilingScheme:!1};const ea=(J.x+J.y)/2,da=B.getMetersPerUnitForSR(F);var ia=ea*da*96*39.37,fa=F.isGeographic?256/M*2.958287637958547E8:256/M*5.91657527591555E8,ja="vector-magdir"===v.dataType||"vector-uv"===v.dataType,ma=a(X,F),na=Math.min(Math.ceil(Math.log(Math.min(v.width,v.height)/32)/Math.LN2),Math.ceil(Math.log(fa/2/ia)/Math.LN2));!ja&&U&&(F.isGeographic||F.isWebMercator)&&(ja=0>ma.xmin*ma.xmax,!ja&&3>na&&(U=z(F),null!=U&&(ja=2**na*ea*M,M=Math.ceil(U/ja),
ja=1===M||2===M&&U/2-ma.xmax<ja)));M=ia;v=Math.min(2,Math.max(1.414,v.storageInfo?.pyramidScalingFactor||2));if(ja)M=fa,fa=F.isGeographic?1.341104507446289E-6:.29858214164761665,na=96*fa*da*39.37,F=n(new K({x:fa,y:fa,spatialReference:{wkid:F.isGeographic?4326:3857}}),Z,ma),F.x*=M/na,F.y*=M/na;else{F={x:Y.x,y:Y.y};for(ma=0;M<.5005*fa&&ma<na;)ma++,M*=v,F.x*=v,F.y*=v;1.001>=Math.max(M,fa)/Math.min(M,fa)&&(M=fa)}fa=[M];ma=[{x:F.x,y:F.y}];for(ia=Math.min(70.5310735,ia)/1.001;M>=ia;)M/=v,F.x/=v,F.y/=v,
fa.push(M),ma.push({x:F.x,y:F.y});if(V){const ra=.001*Y.x;V=ma.findIndex(qa=>qa.x>=Y.x-ra&&qa.x<=Y.x+ra);-1<V?(ma.length=V+1,fa.length=V+1):(V=ma.findIndex(qa=>qa.x<=Y.x+ra),0<V&&(ma.length=V,fa.length=V))}return{projectedPixelSize:J,scales:fa,srcResolutions:ma,isCustomTilingScheme:!ja}};P.defaultGridSpacing=32;P.defaultProjectionToleranceInPixels=4;P.getDefaultDatumTransformationForDataset=function(v,F,J){m(v.spatialReference,F);return J?R.getTransformation(F,v.spatialReference,v):R.getTransformation(v.spatialReference,
F,v)};P.getProjectedGridPoints=A;P.getProjectionOffsetGrid=function(v){var F=v.isAdaptive&&null==v.spacing;let J=v.spacing||[32,32],M=H(v);var U={cols:M.size[0]+1,rows:M.size[1]+1};const V=0<M.outofBoundPointCount&&M.outofBoundPointCount<M.offsets.length/2;let X=M.outofBoundPointCount===M.offsets.length/2||F&&V?[0,0]:x(M.offsets,U,J,4);const Z=(X[0]+X[1])/2;var Y=v.projectedExtent.spatialReference;const ea=v.srcBufferExtent.spatialReference;F&&(V||4<Z)&&(h(Y,ea,v.datumTransformation)&&(Y.isGeographic||
null!=f(Y)),J=[4,4],M=H({...v,spacing:J}),U={cols:M.size[0]+1,rows:M.size[1]+1},X=x(M.offsets,U,J,4));M.error=X;1<J[0]&&(M.coefficients=u(M.offsets,U,V));!v.includeGCSGrid||Y.isGeographic||Y.isWebMercator||(ea.isGeographic?M.gcsGrid={offsets:M.offsets,coefficients:M.coefficients,spacing:J}:(F=f(Y),null==F||F.isEnvelope||(Y&&!Y.isGeographic&&(F=String(Y.wkid||Y.wkt),W.has(F)?Y=W.get(F):(Y=(Y.wkid?T.PeFactory.coordsys(Y.wkid):T.PeFactory.fromString(T.PeDefs.PE_TYPE_PROJCS,Y.wkt)).getGeogcs().getCode(),
W.set(F,Y)),Y=new G({wkid:Y})),Y=a(v.projectedExtent,Y),{offsets:v}=H({...v,srcBufferExtent:Y,spacing:J}),U=u(v,U,V),M.gcsGrid={offsets:v,coefficients:U,spacing:J})));return M};P.getRasterDatasetAlignmentInfo=function(v){const F=v.storageInfo.origin.x;var J=z(v.spatialReference,!0);if(null==J)return{originX:F,halfWorldWidth:null,pyramidsInfo:null};const M=J/2,{nativePixelSize:U,storageInfo:V,extent:X}=v,{maximumPyramidLevel:Z,blockWidth:Y,pyramidScalingFactor:ea}=V;let da=U.x;const ia=[];v=null!=
v.transform&&"gcs-shift"===v.transform.type;const fa=F+(v?0:M);J=v?J-F:M-F;for(let ja=0;ja<=Z;ja++){const ma=(X.xmax-F)/da/Y,na=J/da/Y;ia.push({resolutionX:da,blockWidth:Y,datsetColumnCount:0===ma-Math.floor(ma)?ma:Math.ceil(ma),worldColumnCountFromOrigin:0===na-Math.floor(na)?na:Math.ceil(na),leftMargin:Math.round(fa/da)%Y,rightPadding:(Y-Math.round(J/da)%Y)%Y,originColumnOffset:Math.floor(fa/da/Y)});da*=ea}return{originX:F,halfWorldWidth:M,pyramidsInfo:ia,hasGCSSShiftTransform:v}};P.getWorldWidth=
z;P.getWorldWrapCount=O;P.load=async function(){R.isLoaded()||await R.load()};P.minimumGridSpacing=4;P.projectExtent=a;P.projectPoint=c;P.projectPolygon=function(v,F,J){if("extent"===v.type){const {xmin:M,ymin:U,xmax:V,ymax:X,spatialReference:Z}=v;v=new D({rings:[[[M,X],[V,X],[V,U],[M,U],[M,X]]],spatialReference:Z})}if(v.spatialReference.equals(F))return v;m(v.spatialReference,F,J);return R.project(v,F,J)};P.projectResolution=n;P.requirePE=h;P.snapExtent=function(v){v=v.clone().normalize();return 1===
v.length?v[0]:l(v)};P.snapPyramid=function(v,F,J){const {storageInfo:M,pixelSize:U}=F;var V=0;let X=!1;var {pyramidResolutions:Z}=M,Y="mixed"===M.tileInfo.format?.toLowerCase()?Math.max(1,Math.min(3,M.tileInfo.dpi/96)):1;Y=(v.x+v.y)/2/Y;if(null!=Z&&Z.length){v=Z[Z.length-1];v=(v.x+v.y)/2;var ea=(U.x+U.y)/2;if(Y<=ea)V=0;else if(Y>=v)V=Z.length,X=8<Y/v;else{v=ea;for(let da=1;da<=Z.length;da++){ea=(Z[da-1].x+Z[da-1].y)/2;if(Y<=ea){Y===ea?V=da:"down"===J?(V=da-1,X=8<Y/v):V="up"===J?da:Y-v>ea-Y||2<Y/v?
da:da-1;break}v=ea}}J=0===V?U:Z[V-1];X&&(Z=Math.min(J.x,J.y),Y=B.getMetersPerUnitForSR(F.spatialReference),19567<Z*Y&&(X=!1));return{pyramidLevel:V,pyramidResolution:new K({x:J.x,y:J.y,spatialReference:F.spatialReference}),excessiveReading:X}}V=Math.log(v.x/U.x)/Math.LN2;Y=Math.log(v.y/U.y)/Math.LN2;Z=F.storageInfo.maximumPyramidLevel||0;V="down"===J?Math.floor(Math.min(V,Y)):"up"===J?Math.ceil(Math.max(V,Y)):Math.round((V+Y)/2);0>V?V=0:V>Z&&(X=V>Z+3,V=Z);J=2**V;F=new K({x:J*F.nativePixelSize.x,y:J*
F.nativePixelSize.y,spatialReference:F.spatialReference});return{pyramidLevel:V,pyramidResolution:F,excessiveReading:X}};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/RasterCodec":function(){define("exports ../../../core/Error ../../../core/maybe ../PixelBlock ./ImageCanvasDecoder ./JpgPlus ./Lerc ./Lzw ./pixelRangeUtils ../../../chunks/Zlib ./Raw ./TiffDecoder ./utils".split(" "),function(P,w,E,C,B,T,R,S,K,D,G,h,m){async function n(p,z){if(!m.isPlatformLittleEndian)throw new w("rasterCoded:decode",
"lerc decoder is not supported on big endian platform");await R.load();const {offset:I}=z,{width:N,height:O,pixelType:H,statistics:u,depthCount:y,noDataValues:x,bandMasks:L,pixels:Q,mask:W}=R.decode(p,{inputOffset:I,returnInterleaved:z.returnInterleaved});return new C({width:N,height:O,pixelType:H.toLowerCase(),pixels:Q,mask:W,statistics:u,bandMasks:L,depthCount:y,noDataValues:x})}async function g(p,z){p=await h.decode(p,{...z,noDataValue:null});E.assertIsSome(p);p=new C({width:p.width,height:p.height,
pixels:p.pixels,pixelType:p.pixelType.toLowerCase(),mask:p.mask,statistics:null});p.updateStatistics();return p}async function c(p,z){p=await h.decodeTileOrStrip(p,z.customOptions);p=new C({width:p.width,height:p.height,pixels:p.pixels,pixelType:p.pixelType.toLowerCase(),mask:p.mask,statistics:null});p.updateStatistics();return p}function t(p,z){const I=z.pixelType||"u8",N=C.getPixelArrayConstructor(I),O="u8"===I?p:new N(p.buffer),H=[],u=z.planes||1;if(1===u)H.push(O);else for(let y=0;y<u;y++){const x=
(z.width||1)*(z.height||p.length),L=new N(x);for(let Q=0;Q<x;Q++)L[Q]=O[Q*u+y];H.push(L)}p=new C({width:z.width||1,height:z.height||p.length,pixels:H,pixelType:I,statistics:null});p.updateStatistics();return p}function A(p,z){p=(new D.Zlib(new Uint8Array(p))).getBytes();return t(p,z)}function r(p,z){p=S.decode(p,z.offset,z.eof,!z.isInputBigEndian);return t(p,z)}function b(p,z){p=T.decode(p,z.hasNoZlibMask??void 0);p=new C({width:p.width,height:p.height,pixels:p.pixels,pixelType:"U8",mask:p.mask,statistics:null});
p.updateStatistics();return p}function f(p,z){p=new Uint8Array(p);p=new a(p);const {width:I,height:N}=z;z=I*N;p=p.decode();let O=0;var H=0;let u;H=new Uint8Array(z);for(O=0;O<z;O++)H[O]=p[4*O+3];const y=new C({width:I,height:N,pixels:[],pixelType:"U8",mask:H,statistics:[]});for(O=0;3>O;O++){u=new Uint8Array(z);for(H=0;H<z;H++)u[H]=p[4*H+O];y.addData({pixels:u})}y.updateStatistics();return y}async function d(p,z,I,N){p=await (new B).decode(p,{applyJpegMask:!1,format:z,...I},N);p=new C(p);p.updateStatistics();
return p}function e(p){if(null==p)throw new w("rasterCodec:decode","parameter encodeddata is required.");p=new Uint8Array(p,0,10);let z="";255===p[0]&&216===p[1]?z="jpg":137===p[0]&&80===p[1]&&78===p[2]&&71===p[3]?z="png":67===p[0]&&110===p[1]&&116===p[2]&&90===p[3]&&73===p[4]&&109===p[5]&&97===p[6]&&103===p[7]&&101===p[8]&&32===p[9]?z="lerc":76===p[0]&&101===p[1]&&114===p[2]&&99===p[3]&&50===p[4]&&32===p[5]?z="lerc2":73===p[0]&&73===p[1]&&42===p[2]&&0===p[3]||77===p[0]&&77===p[1]&&0===p[2]&&42===
p[3]||73===p[0]&&73===p[1]&&43===p[2]&&0===p[3]||77===p[0]&&77===p[1]&&0===p[2]&&43===p[3]?z="tiff":71===p[0]&&73===p[1]&&70===p[2]?z="gif":66===p[0]&&77===p[1]?z="bmp":String.fromCharCode.apply(null,p).toLowerCase().includes("error")&&(z="error");return z}function q(p){let z=null;switch(p){case "lerc":case "lerc2":z=n;break;case "jpg":z=b;break;case "png":z=f;break;case "bsq":case "bip":z=(I,N)=>{var O=N.pixelType,H=null;let u=null;switch(O?O.toLowerCase():"f32"){case "u1":case "u2":case "u4":case "u8":u=
255;H=Uint8Array;break;case "u16":u=u||65535;H=Uint16Array;break;case "u32":u=u||2**32-1;H=Uint32Array;break;case "s8":u=u||-128;H=Int8Array;break;case "s16":u=u||-32768;H=Int16Array;break;case "s32":u=u||-(2**31);H=Int32Array;break;default:H=Float32Array}({pixelTypeCtor:O}={pixelTypeCtor:H,noDataValue:u});H=G.decode;I=H(I,{width:N.width,height:N.height,pixelType:O,format:p});N=new C({width:N.width,height:N.height,pixels:I.pixels,pixelType:N.pixelType,mask:I.mask,statistics:null});N.updateStatistics();
return N};break;case "tiff":z=g;break;case "deflate":z=A;break;case "lzw":z=r;break;case "error":z=()=>{throw new w("rasterCodec:decode","input data contains error");};break;default:z=()=>{throw new w("rasterCodec:decode","unsupported raster format");}}return z}function l(p,z=1){if(p){var {pixels:I,width:N,height:O,mask:H}=p;if(I&&0!==I.length){var u=I.length,y=N-1,x=O-1,L=[],Q,W,v=null,F=C.getPixelArrayConstructor(p.pixelType);if(0===z){for(z=0;z<u;z++){var J=I[z];var M=new F(y*x);for(Q=0;Q<x;Q++){var U=
Q*N;for(W=0;W<y;W++)M[Q*y+W]=J[U+W]}L.push(M)}if(null!=H)for(v=new Uint8Array(y*x),Q=0;Q<x;Q++)for(U=Q*N,W=0;W<y;W++)v[Q*y+W]=H[U+W]}else{for(z=0;z<u;z++){J=I[z];M=new F(y*x);for(Q=0;Q<x;Q++)for(U=Q*N,W=0;W<y;W++)M[Q*y+W]=(J[U+W]+J[U+W+1]+J[U+N+W]+J[U+N+W+1])/4;L.push(M)}if(H)for(v=new Uint8Array(y*x),Q=0;Q<x;Q++)for(U=Q*N,W=0;W<y;W++)v[Q*y+W]=Math.min.apply(null,[H[U+W],H[U+W+1],H[U+N+W],H[U+N+W+1]])}p.width=y;p.height=x;p.mask=v;p.pixels=L}}}var a=function(p){function z(H){var u,y;this.data=H;this.pos=
8;this.palette=[];this.imgData=[];this.transparency={};this.animation=null;this.text={};for(y=null;;){var x=this.readUInt32();var L=H=void 0;H=[];for(L=0;4>L;++L)H.push(String.fromCharCode(this.data[this.pos++]));H=H.join("");switch(H){case "IHDR":this.width=this.readUInt32();this.height=this.readUInt32();this.bits=this.data[this.pos++];this.colorType=this.data[this.pos++];this.compressionMethod=this.data[this.pos++];this.filterMethod=this.data[this.pos++];this.interlaceMethod=this.data[this.pos++];
break;case "acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||Infinity,frames:[]};break;case "PLTE":this.palette=this.read(x);break;case "fcTL":y&&this.animation.frames.push(y);this.pos+=4;y={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()};H=this.readUInt16();x=this.readUInt16()||100;y.delay=1E3*H/x;y.disposeOp=this.data[this.pos++];y.blendOp=this.data[this.pos++];y.data=[];break;case "IDAT":case "fdAT":"fdAT"===H&&
(this.pos+=4,x-=4);H=(null!=y?y.data:void 0)||this.imgData;for(L=0;0<=x?L<x:L>x;0<=x?++L:--L)H.push(this.data[this.pos++]);break;case "tRNS":this.transparency={};switch(this.colorType){case 3:this.transparency.indexed=this.read(x);x=255-this.transparency.indexed.length;if(0<x)for(H=0;0<=x?H<x:H>x;0<=x?++H:--H)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(x)[0];break;case 2:this.transparency.rgb=this.read(x)}break;case "tEXt":L=this.read(x);x=L.indexOf(0);H=
String.fromCharCode.apply(String,L.slice(0,x));this.text[H]=String.fromCharCode.apply(String,L.slice(x+1));break;case "IEND":y&&this.animation.frames.push(y);a:{switch(this.colorType){case 0:case 3:case 4:y=1;break a;case 2:case 6:y=3;break a}y=void 0}this.colors=y;this.hasAlphaChannel=4===(u=this.colorType)||6===u;u=this.colors+(this.hasAlphaChannel?1:0);this.pixelBitlength=this.bits*u;a:{switch(this.colors){case 1:u="DeviceGray";break a;case 3:u="DeviceRGB";break a}u=void 0}this.colorSpace=u;this.imgData=
new Uint8Array(this.imgData);return;default:this.pos+=x}this.pos+=4;if(this.pos>this.data.length)throw Error("Incomplete or corrupt PNG file");}}var I;z.load=function(H,u,y){"function"===typeof u&&(y=u);var x=new XMLHttpRequest;x.open("GET",H,!0);x.responseType="arraybuffer";x.onload=function(){var L=new Uint8Array(x.response||x.mozResponseArrayBuffer);L=new z(L);"function"===typeof(null!=u?u.getContext:void 0)&&L.render(u);return"function"===typeof y?y(L):void 0};return x.send(null)};z.prototype.read=
function(H){var u;var y=[];for(u=0;0<=H?u<H:u>H;0<=H?++u:--u)y.push(this.data[this.pos++]);return y};z.prototype.readUInt32=function(){var H=this.data[this.pos++]<<24;var u=this.data[this.pos++]<<16;var y=this.data[this.pos++]<<8;var x=this.data[this.pos++];return H|u|y|x};z.prototype.readUInt16=function(){var H=this.data[this.pos++]<<8;var u=this.data[this.pos++];return H|u};z.prototype.decodePixels=function(H){var u,y,x,L,Q,W,v,F;null==H&&(H=this.imgData);if(0===H.length)return new Uint8Array(0);
H=new D.Zlib(H);H=H.getBytes();var J=this.pixelBitlength/8;var M=J*this.width;var U=new Uint8Array(M*this.height);var V=H.length;for(y=L=Q=0;L<V;){switch(H[L++]){case 0:for(x=u=0;u<M;x=u+=1)U[y++]=H[L++];break;case 1:for(x=W=0;W<M;x=W+=1){u=H[L++];var X=x<J?0:U[y-J];U[y++]=(u+X)%256}break;case 2:for(x=X=0;X<M;x=X+=1){u=H[L++];var Z=(x-x%J)/J;W=Q&&U[(Q-1)*M+Z*J+x%J];U[y++]=(W+u)%256}break;case 3:for(x=F=0;F<M;x=F+=1)u=H[L++],Z=(x-x%J)/J,X=x<J?0:U[y-J],W=Q&&U[(Q-1)*M+Z*J+x%J],U[y++]=(u+Math.floor((X+
W)/2))%256;break;case 4:for(x=F=0;F<M;x=F+=1){u=H[L++];Z=(x-x%J)/J;X=x<J?0:U[y-J];0===Q?W=v=0:(W=U[(Q-1)*M+Z*J+x%J],v=Z&&U[(Q-1)*M+(Z-1)*J+x%J]);var Y=X+W-v;x=Math.abs(Y-X);Z=Math.abs(Y-W);Y=Math.abs(Y-v);X=x<=Z&&x<=Y?X:Z<=Y?W:v;U[y++]=(u+X)%256}break;default:throw Error("Invalid filter algorithm: "+H[L-1]);}Q++}return U};z.prototype.decodePalette=function(){var H,u,y,x;var L=this.palette;var Q=this.transparency.indexed||[];var W=new Uint8Array((Q.length||0)+L.length);var v=0;L.length;var F=u=H=0;
for(y=L.length;u<y;F=u+=3)W[v++]=L[F],W[v++]=L[F+1],W[v++]=L[F+2],W[v++]=null!=(x=Q[H++])?x:255;return W};z.prototype.copyToImageData=function(H,u){var y,x;var L=this.colors;var Q=null;var W=this.hasAlphaChannel;this.palette.length&&(Q=null!=(y=this._decodedPalette)?y:this._decodedPalette=this.decodePalette(),L=4,W=!0);H=H.data||H;var v=H.length;var F=Q||u;y=x=0;if(1===L)for(;y<v;)L=Q?4*u[y/4]:x,x=F[L++],H[y++]=x,H[y++]=x,H[y++]=x,H[y++]=W?F[L++]:this.transparency.grayscale&&this.transparency.grayscale===
x?0:255,x=L;else for(;y<v;)L=Q?4*u[y/4]:x,H[y++]=F[L++],H[y++]=F[L++],H[y++]=F[L++],H[y++]=W?F[L++]:this.transparency.rgb&&this.transparency.rgb[1]===F[L-3]&&this.transparency.rgb[3]===F[L-2]&&this.transparency.rgb[5]===F[L-1]?0:255,x=L};z.prototype.decode=function(){var H=new Uint8Array(this.width*this.height*4);this.copyToImageData(H,this.decodePixels());return H};var N=(I=p.document&&p.document.createElement("canvas"))&&I.getContext("2d");var O=function(H){N.width=H.width;N.height=H.height;N.clearRect(0,
0,H.width,H.height);N.putImageData(H,0,0);H=new Image;H.src=I.toDataURL();return H};z.prototype.decodeFrames=function(H){var u,y;if(this.animation){var x=this.animation.frames;var L=[];var Q=u=0;for(y=x.length;u<y;Q=++u){Q=x[Q];var W=H.createImageData(Q.width,Q.height);var v=this.decodePixels(new Uint8Array(Q.data));this.copyToImageData(W,v);Q.imageData=W;L.push(Q.image=O(W))}return L}};z.prototype.renderFrame=function(H,u){var y=this.animation.frames;var x=y[u];y=y[u-1];0===u&&H.clearRect(0,0,this.width,
this.height);1===(null!=y?y.disposeOp:void 0)?H.clearRect(y.xOffset,y.yOffset,y.width,y.height):2===(null!=y?y.disposeOp:void 0)&&H.putImageData(y.imageData,y.xOffset,y.yOffset);0===x.blendOp&&H.clearRect(x.xOffset,x.yOffset,x.width,x.height);return H.drawImage(x.image,x.xOffset,x.yOffset)};z.prototype.animate=function(H){var u,y=this;var x=0;var L=this.animation;var Q=L.numFrames;var W=L.frames;var v=L.numPlays;return(u=function(){var F=x++%Q;var J=W[F];y.renderFrame(H,F);if(1<Q&&x/Q<v)return y.animation._timeout=
setTimeout(u,J.delay)})()};z.prototype.stopAnimation=function(){var H;return clearTimeout(null!=(H=this.animation)?H._timeout:void 0)};z.prototype.render=function(H){H._png&&H._png.stopAnimation();H._png=this;H.width=this.width;H.height=this.height;H=H.getContext("2d");if(this.animation)return this.decodeFrames(H),this.animate(H);var u=H.createImageData(this.width,this.height);this.copyToImageData(u,this.decodePixels());return H.putImageData(u,0,0)};return z}(self);const k=new Set(["jpg","png","bmp",
"gif"]);P.decode=async function(p,z={},I){if(null==p)throw new w("rasterCodec:decode","missing encodeddata parameter.");let N=z.format&&z.format.toLowerCase();if(!("bsq"!==N&&"bip"!==N||null!=z.width&&null!=z.height))throw new w("rasterCodec:decode","requires width and height in options parameter.");if("tiff"===N&&z.customOptions)return c(p,z);if(!N||"bsq"!==N&&"bip"!==N&&"deflate"!==N&&"lzw"!==N)N=e(p);if(z.useCanvas&&k.has(N))return d(p,N,z,I);I=q(N);z.isPoint&&(z={...z},null!=z.width&&z.width++,
null!=z.height&&z.height++);p=await I(p,z);if(!p)return p;"jpg"!==N&&null!=z.noDataValue&&1===p.depthCount&&K.convertNoDataToMask(p,z.noDataValue,{customFloatTolerance:z.tolerance});z.isPoint&&l(p);return p};P.getFormat=function(p){p=e(p);"lerc2"===p?p="lerc":"error"===p&&(p="");return p};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/ImageCanvasDecoder":function(){define(["../../../chunks/_rollupPluginBabelHelpers","../../../core/Error","../../../core/promiseUtils",
"../../../chunks/Zlib"],function(P,w,E,C){return function(){function B(T){this._ctx=this._canvas=null;T&&(this._canvas=T.canvas,this._ctx=T.ctx||T.canvas&&T.canvas.getContext("2d"))}B.prototype.decode=function(T,R,S){if(!T||10>T.byteLength)throw new w("imagecanvasdecoder: decode","required a valid encoded data as input.");let {width:K=0,height:D=0,format:G}=R;const {applyJpegMask:h}=R;if(h&&(!K||!D))throw new w("imagecanvasdecoder: decode","image width and height are needed to apply jpeg mask directly to canvas");
return new Promise((m,n)=>{let g=null;"jpg"===G&&h&&(g=B._getMask(T,{width:K,height:D}));const c=new Blob([new Uint8Array(T)],{type:"jpg"==="image/"+G?"jpeg":G}),t=URL.createObjectURL(c),A=new Image;let r;A.src=t;A.onload=()=>{URL.revokeObjectURL(t);if(E.isAborted(S))n(E.createAbortError());else{K=A.width;D=A.height;if(this._canvas&&this._ctx){if(this._canvas.width!==K||this._canvas.height!==D)this._canvas.width=K,this._canvas.height=D;this._ctx.clearRect(0,0,K,D)}else this._canvas=document.createElement("canvas"),
this._canvas.width=K,this._canvas.height=D,this._ctx=this._canvas.getContext("2d");this._ctx.drawImage(A,0,0);var b=this._ctx.getImageData(0,0,K,D);r=b.data;var f;if(R.renderOnCanvas){if(g)for(f=0;f<g.length;f++)r[4*f+3]=g[f]?255:0;this._ctx.putImageData(b,0,0);m(null)}else{b=K*D;var d=new Uint8Array(b),e=new Uint8Array(b),q=new Uint8Array(b);if(g)for(f=0;f<b;f++)d[f]=r[4*f],e[f]=r[4*f+1],q[f]=r[4*f+2];else for(g=new Uint8Array(b),f=0;f<b;f++)d[f]=r[4*f],e[f]=r[4*f+1],q[f]=r[4*f+2],g[f]=r[4*f+3];
m({width:K,height:D,pixels:[d,e,q],mask:g,pixelType:"u8"})}}};A.onerror=()=>{URL.revokeObjectURL(t);n("cannot load image")}})};B._getMask=function(T,R){let S=null;try{var K=new Uint8Array(T);T=0;var D=K.length-2;for(T=Math.ceil(K.length/2);T<D&&(255!==K[T]||217!==K[T+1]);T++);T+=2;if(T<K.length-1){const G=(new C.Zlib(K.subarray(T))).getBytes();S=new Uint8Array(R.width*R.height);R=0;for(K=0;K<G.length;K++)for(D=7;0<=D;D--)S[R++]=G[K]>>D&1}}catch(G){}return S};return P._createClass(B)}()})},"esri/chunks/Zlib":function(){define(["exports",
"./_commonjsHelpers"],function(P,w){var E={exports:{}};E.exports;(function(C){(function(B){B=B();void 0!==B&&(C.exports=B)})(function(){var B=function(){function T(){this.bufferLength=this.pos=0;this.eof=!1;this.buffer=null}T.prototype={ensureBuffer:function(R){var S=this.buffer,K=S?S.byteLength:0;if(R<K)return S;for(var D=512;D<R;)D<<=1;R=new Uint8Array(D);for(D=0;D<K;++D)R[D]=S[D];return this.buffer=R},getByte:function(){for(var R=this.pos;this.bufferLength<=R;){if(this.eof)return null;this.readBlock()}return this.buffer[this.pos++]},
getBytes:function(R){var S=this.pos;if(R){this.ensureBuffer(S+R);for(R=S+R;!this.eof&&this.bufferLength<R;)this.readBlock();var K=this.bufferLength;R>K&&(R=K)}else{for(;!this.eof;)this.readBlock();R=this.bufferLength}this.pos=R;return this.buffer.subarray(S,R)},lookChar:function(){for(var R=this.pos;this.bufferLength<=R;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos])},getChar:function(){for(var R=this.pos;this.bufferLength<=R;){if(this.eof)return null;
this.readBlock()}return String.fromCharCode(this.buffer[this.pos++])},makeSubStream:function(R,S,K){for(var D=R+S;this.bufferLength<=D&&!this.eof;)this.readBlock();return new Stream(this.buffer,R,S,K)},skip:function(R){R||(R=1);this.pos+=R},reset:function(){this.pos=0}};return T}();return function(){function T(m){throw Error(m);}function R(m){var n=0,g=m[n++],c=m[n++];-1!=g&&-1!=c||T("Invalid header in flate stream");8!=(g&15)&&T("Unknown compression method in flate stream");0!=((g<<8)+c)%31&&T("Bad FCHECK in flate stream");
c&32&&T("FDICT bit set in flate stream");this.bytes=m;this.bytesPos=n;this.codeBuf=this.codeSize=0;B.call(this)}if(!self||!self.Uint32Array)return null;var S=new Uint32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),K=new Uint32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),D=new Uint32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,
393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]),G=[new Uint32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59E4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,
524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,
524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,
524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,
524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,
524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,
524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,
524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],h=[new Uint32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5];R.prototype=Object.create(B.prototype);R.prototype.getBits=function(m){for(var n=
this.codeSize,g=this.codeBuf,c=this.bytes,t=this.bytesPos,A;n<m;)"undefined"==typeof(A=c[t++])&&T("Bad encoding in flate stream"),g|=A<<n,n+=8;this.codeBuf=g>>m;this.codeSize=n-=m;this.bytesPos=t;return g&(1<<m)-1};R.prototype.getCode=function(m){var n=m[0],g=m[1];m=this.codeSize;for(var c=this.codeBuf,t=this.bytes,A=this.bytesPos;m<g;){var r;"undefined"==typeof(r=t[A++])&&T("Bad encoding in flate stream");c|=r<<m;m+=8}g=n[c&(1<<g)-1];n=g>>16;g&=65535;(0==m||m<n||0==n)&&T("Bad encoding in flate stream");
this.codeBuf=c>>n;this.codeSize=m-n;this.bytesPos=A;return g};R.prototype.generateHuffmanTable=function(m){for(var n=m.length,g=0,c=0;c<n;++c)m[c]>g&&(g=m[c]);for(var t=1<<g,A=new Uint32Array(t),r=1,b=0,f=2;r<=g;++r,b<<=1,f<<=1)for(var d=0;d<n;++d)if(m[d]==r){var e=0,q=b;for(c=0;c<r;++c)e=e<<1|q&1,q>>=1;for(c=e;c<t;c+=f)A[c]=r<<16|d;++b}return[A,g]};R.prototype.readBlock=function(){function m(e,q,l,a,k){for(e=e.getBits(l)+a;0<e--;)q[b++]=k}var n=this.getBits(3);n&1&&(this.eof=!0);n>>=1;if(0==n){var g=
this.bytes,c=this.bytesPos,t;"undefined"==typeof(t=g[c++])&&T("Bad block header in flate stream");var A=t;"undefined"==typeof(t=g[c++])&&T("Bad block header in flate stream");A|=t<<8;"undefined"==typeof(t=g[c++])&&T("Bad block header in flate stream");n=t;"undefined"==typeof(t=g[c++])&&T("Bad block header in flate stream");(n|t<<8)!=(~A&65535)&&T("Bad uncompressed block length in flate stream");this.codeSize=this.codeBuf=0;t=this.bufferLength;n=this.ensureBuffer(t+A);this.bufferLength=A=t+A;for(var r=
t;r<A;++r){if("undefined"==typeof(t=g[c++])){this.eof=!0;break}n[r]=t}this.bytesPos=c}else{if(1==n)c=G,t=h;else if(2==n){n=this.getBits(5)+257;t=this.getBits(5)+1;g=this.getBits(4)+4;c=Array(S.length);for(var b=0;b<g;)c[S[b++]]=this.getBits(3);c=this.generateHuffmanTable(c);b=g=0;t=n+t;for(A=Array(t);b<t;)r=this.getCode(c),16==r?m(this,A,2,3,g):17==r?m(this,A,3,3,g=0):18==r?m(this,A,7,11,g=0):A[b++]=g=r;c=this.generateHuffmanTable(A.slice(0,n));t=this.generateHuffmanTable(A.slice(n,t))}else T("Unknown block type in flate stream");
A=(n=this.buffer)?n.length:0;for(r=this.bufferLength;;){var f=this.getCode(c);if(256>f)r+1>=A&&(n=this.ensureBuffer(r+1),A=n.length),n[r++]=f;else{if(256==f){this.bufferLength=r;break}f-=257;f=K[f];var d=f>>16;0<d&&(d=this.getBits(d));g=(f&65535)+d;f=this.getCode(t);f=D[f];d=f>>16;0<d&&(d=this.getBits(d));f=(f&65535)+d;r+g>=A&&(n=this.ensureBuffer(r+g),A=n.length);for(d=0;d<g;++d,++r)n[r]=n[r-f]}}}};return R}()})})(E);w=w.getDefaultExportFromCjs(E.exports);P.Zlib=w})},"esri/layers/support/rasterFormats/JpgPlus":function(){define(["../../../chunks/_rollupPluginBabelHelpers",
"../../../chunks/Jpg","../../../chunks/Zlib"],function(P,w,E){return function(){function C(){}C.decode=function(B,T=!1){const R=new Uint8Array(B);B=new w.JpegImage;B.parse(R);const {width:S,height:K,numComponents:D,eof:G}=B,h=B.getData(S,K,!0),m=S*K;B=null;let n=0,g=0,c=0;if(!T&&G<R.length-1)try{var t=(new E.Zlib(R.subarray(G))).getBytes();B=new Uint8Array(m);for(n=T=0;n<t.length;n++)for(c=7;0<=c;c--)B[T++]=t[n]>>c&1}catch{}if(1===D&&h.length===S*K)t=new Uint8Array(h.buffer),t=[t,t,t];else{t=[];for(n=
0;3>n;n++)t.push(new Uint8Array(m));for(g=c=0;g<m;g++)for(n=0;3>n;n++)t[n][g]=h[c++]}return{width:S,height:K,pixels:t,mask:B}};return P._createClass(C)}()})},"esri/chunks/Jpg":function(){define(["exports","./_commonjsHelpers"],function(P,w){var E={exports:{}};E.exports;(function(C){(function(B){B=B();void 0!==B&&(C.exports=B)})(function(){var B=function(){function T(R){this.message="JPEG error: "+R}T.prototype=Error();T.prototype.name="JpegError";return T.constructor=T}();return function(){function T(){this.decodeTransform=
null;this.colorTransform=-1}function R(h,m){for(var n=0,g=[],c,t,A=16;0<A&&!h[A-1];)A--;g.push({children:[],index:0});var r=g[0],b;for(c=0;c<A;c++){for(t=0;t<h[c];t++){r=g.pop();for(r.children[r.index]=m[n];0<r.index;)r=g.pop();r.index++;for(g.push(r);g.length<=c;)g.push(b={children:[],index:0}),r.children[r.index]=b.children,r=b;n++}c+1<A&&(g.push(b={children:[],index:0}),r.children[r.index]=b.children,r=b)}return g[0].children}function S(h,m,n,g,c,t,A,r,b){function f(){if(0<H)return H--,O>>H&1;
O=h[m++];if(255===O){var Z=h[m++];if(Z)throw new B("unexpected marker "+(O<<8|Z).toString(16));}H=7;return O>>>7}function d(Z){for(;;){Z=Z[f()];if("number"===typeof Z)return Z;if("object"!==typeof Z)throw new B("invalid huffman sequence");}}function e(Z){for(var Y=0;0<Z;)Y=Y<<1|f(),Z--;return Y}function q(Z){if(1===Z)return 1===f()?1:-1;var Y=e(Z);return Y>=1<<Z-1?Y:Y+(-1<<Z)+1}function l(Z,Y){var ea=d(Z.huffmanTableDC);ea=0===ea?0:q(ea);Z.blockData[Y]=Z.pred+=ea;for(ea=1;64>ea;){var da=d(Z.huffmanTableAC),
ia=da&15;da>>=4;if(0===ia){if(15>da)break;ea+=16}else ea+=da,Z.blockData[Y+G[ea]]=q(ia),ea++}}function a(Z,Y){var ea=d(Z.huffmanTableDC);ea=0===ea?0:q(ea)<<b;Z.blockData[Y]=Z.pred+=ea}function k(Z,Y){Z.blockData[Y]|=f()<<b}function p(Z,Y){if(0<u)u--;else for(var ea=t;ea<=A;){var da=d(Z.huffmanTableAC),ia=da&15;da>>=4;if(0===ia){if(15>da){u=e(da)+(1<<da)-1;break}ea+=16}else ea+=da,Z.blockData[Y+G[ea]]=q(ia)*(1<<b),ea++}}function z(Z,Y){for(var ea=t,da=0,ia;ea<=A;){ia=G[ea];switch(y){case 0:da=d(Z.huffmanTableAC);
ia=da&15;da>>=4;if(0===ia)15>da?(u=e(da)+(1<<da),y=4):(da=16,y=1);else{if(1!==ia)throw new B("invalid ACn encoding");x=q(ia);y=da?2:3}continue;case 1:case 2:Z.blockData[Y+ia]?Z.blockData[Y+ia]+=f()<<b:(da--,0===da&&(y=2===y?3:0));break;case 3:Z.blockData[Y+ia]?Z.blockData[Y+ia]+=f()<<b:(Z.blockData[Y+ia]=x<<b,y=0);break;case 4:Z.blockData[Y+ia]&&(Z.blockData[Y+ia]+=f()<<b)}ea++}4===y&&(u--,0===u&&(y=0))}var I=n.mcusPerLine,N=m,O=0,H=0,u=0,y=0,x,L=g.length,Q,W,v,F;r=n.progressive?0===t?0===r?a:k:0===
r?p:z:l;var J=0;n=1===L?g[0].blocksPerLine*g[0].blocksPerColumn:I*n.mcusPerColumn;for(var M,U;J<n;){var V=c?Math.min(n-J,c):n;for(Q=0;Q<L;Q++)g[Q].pred=0;u=0;if(1===L){var X=g[0];for(F=0;F<V;F++)r(X,64*((X.blocksPerLine+1)*(J/X.blocksPerLine|0)+J%X.blocksPerLine)),J++}else for(F=0;F<V;F++){for(Q=0;Q<L;Q++)for(X=g[Q],M=X.h,U=X.v,W=0;W<U;W++)for(v=0;v<M;v++)r(X,64*((X.blocksPerLine+1)*((J/I|0)*X.v+W)+(J%I*X.h+v)));J++}H=0;(X=D(h,m))&&X.invalid&&(console.log("decodeScan - unexpected MCU data, next marker is: "+
X.invalid),m=X.offset);X=X&&X.marker;if(!X||65280>=X)throw new B("marker was not found");if(65488<=X&&65495>=X)m+=2;else break}(X=D(h,m))&&X.invalid&&(console.log("decodeScan - unexpected Scan data, next marker is: "+X.invalid),m=X.offset);return m-N}function K(h,m){h=m.blocksPerLine;for(var n=m.blocksPerColumn,g=new Int16Array(64),c=0;c<n;c++)for(var t=0;t<h;t++){var A=void 0,r=void 0,b=void 0,f=void 0,d=void 0,e=void 0,q=void 0,l=void 0,a=d=e=f=r=A=void 0,k=void 0,p=void 0,z=void 0,I=64*((m.blocksPerLine+
1)*c+t),N=g,O=m.quantizationTable,H=m.blockData;if(!O)throw new B("missing required Quantization Table.");for(var u=0;64>u;u+=8)A=H[I+u],l=H[I+u+1],q=H[I+u+2],e=H[I+u+3],d=H[I+u+4],f=H[I+u+5],b=H[I+u+6],r=H[I+u+7],A*=O[u],0===(l|q|e|d|f|b|r)?(A=5793*A+512>>10,N[u]=A,N[u+1]=A,N[u+2]=A,N[u+3]=A,N[u+4]=A,N[u+5]=A,N[u+6]=A,N[u+7]=A):(l*=O[u+1],q*=O[u+2],e*=O[u+3],d*=O[u+4],f*=O[u+5],b*=O[u+6],r*=O[u+7],z=5793*A+128>>8,p=5793*d+128>>8,k=q,a=b,d=2896*(l-r)+128>>8,r=2896*(l+r)+128>>8,e<<=4,f<<=4,z=z+p+1>>
1,p=z-p,A=3784*k+1567*a+128>>8,k=1567*k-3784*a+128>>8,a=A,d=d+f+1>>1,f=d-f,r=r+e+1>>1,e=r-e,z=z+a+1>>1,a=z-a,p=p+k+1>>1,k=p-k,A=2276*d+3406*r+2048>>12,d=3406*d-2276*r+2048>>12,r=A,A=799*e+4017*f+2048>>12,e=4017*e-799*f+2048>>12,f=A,N[u]=z+r,N[u+7]=z-r,N[u+1]=p+f,N[u+6]=p-f,N[u+2]=k+e,N[u+5]=k-e,N[u+3]=a+d,N[u+4]=a-d);for(O=0;8>O;++O)A=N[O],l=N[O+8],q=N[O+16],e=N[O+24],d=N[O+32],f=N[O+40],b=N[O+48],r=N[O+56],0===(l|q|e|d|f|b|r)?(A=5793*A+8192>>14,A=-2040>A?0:2024<=A?255:A+2056>>4,H[I+O]=A,H[I+O+8]=
A,H[I+O+16]=A,H[I+O+24]=A,H[I+O+32]=A,H[I+O+40]=A,H[I+O+48]=A,H[I+O+56]=A):(z=5793*A+2048>>12,p=5793*d+2048>>12,k=q,a=b,d=2896*(l-r)+2048>>12,r=2896*(l+r)+2048>>12,z=(z+p+1>>1)+4112,p=z-p,A=3784*k+1567*a+2048>>12,k=1567*k-3784*a+2048>>12,a=A,d=d+f+1>>1,f=d-f,r=r+e+1>>1,e=r-e,z=z+a+1>>1,a=z-a,p=p+k+1>>1,k=p-k,A=2276*d+3406*r+2048>>12,d=3406*d-2276*r+2048>>12,r=A,A=799*e+4017*f+2048>>12,e=4017*e-799*f+2048>>12,f=A,A=z+r,r=z-r,l=p+f,b=p-f,q=k+e,f=k-e,e=a+d,d=a-d,A=16>A?0:4080<=A?255:A>>4,l=16>l?0:4080<=
l?255:l>>4,q=16>q?0:4080<=q?255:q>>4,e=16>e?0:4080<=e?255:e>>4,d=16>d?0:4080<=d?255:d>>4,f=16>f?0:4080<=f?255:f>>4,b=16>b?0:4080<=b?255:b>>4,r=16>r?0:4080<=r?255:r>>4,H[I+O]=A,H[I+O+8]=l,H[I+O+16]=q,H[I+O+24]=e,H[I+O+32]=d,H[I+O+40]=f,H[I+O+48]=b,H[I+O+56]=r)}return m.blockData}function D(h,m,n){var g=h.length-1;n=n<m?n:m;if(m>=g)return null;var c=h[m]<<8|h[m+1];if(65472<=c&&65534>=c)return{invalid:null,marker:c,offset:m};for(m=h[n]<<8|h[n+1];!(65472<=m&&65534>=m);){if(++n>=g)return null;m=h[n]<<
8|h[n+1]}return{invalid:c.toString(16),marker:m,offset:n}}if(!self||!self.Uint8ClampedArray)return null;var G=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]);T.prototype={parse:function(h){function m(){var O=h[c]<<8|h[c+1];c+=2;return O}function n(){var O=m();O=c+O-2;var H=D(h,O,c);H&&H.invalid&&(console.log("readDataBlock - incorrect length, next marker is: "+
H.invalid),O=H.offset);O=h.subarray(c,O);c+=O.length;return O}function g(O){for(var H=Math.ceil(O.samplesPerLine/8/O.maxH),u=Math.ceil(O.scanLines/8/O.maxV),y=0;y<O.components.length;y++){N=O.components[y];var x=Math.ceil(Math.ceil(O.samplesPerLine/8)*N.h/O.maxH),L=Math.ceil(Math.ceil(O.scanLines/8)*N.v/O.maxV);N.blockData=new Int16Array(64*u*N.v*(H*N.h+1));N.blocksPerLine=x;N.blocksPerColumn=L}O.mcusPerLine=H;O.mcusPerColumn=u}var c=0,t=null,A=null,r=[],b=[],f=[],d=m();if(65496!==d)throw new B("SOI not found");
for(d=m();65497!==d;){switch(d){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var e=n();65504===d&&74===e[0]&&70===e[1]&&73===e[2]&&70===e[3]&&0===e[4]&&(t={version:{major:e[5],minor:e[6]},densityUnits:e[7],xDensity:e[8]<<8|e[9],yDensity:e[10]<<8|e[11],thumbWidth:e[12],thumbHeight:e[13],thumbData:e.subarray(14,14+3*e[12]*e[13])});65518===d&&65===e[0]&&100===
e[1]&&111===e[2]&&98===e[3]&&101===e[4]&&(A={version:e[5]<<8|e[6],flags0:e[7]<<8|e[8],flags1:e[9]<<8|e[10],transformCode:e[11]});break;case 65499:d=m()+c-2;for(var q;c<d;){var l=h[c++],a=new Uint16Array(64);if(0===l>>4)for(e=0;64>e;e++)q=G[e],a[q]=h[c++];else if(1===l>>4)for(e=0;64>e;e++)q=G[e],a[q]=m();else throw new B("DQT - invalid table spec");r[l&15]=a}break;case 65472:case 65473:case 65474:if(k)throw new B("Only single frame JPEGs supported");m();var k={};k.extended=65473===d;k.progressive=
65474===d;k.precision=h[c++];k.scanLines=m();k.samplesPerLine=m();k.components=[];k.componentIds={};e=h[c++];for(d=a=l=0;d<e;d++){q=h[c];var p=h[c+1]>>4;var z=h[c+1]&15;l<p&&(l=p);a<z&&(a=z);p=k.components.push({h:p,v:z,quantizationId:h[c+2],quantizationTable:null});k.componentIds[q]=p-1;c+=3}k.maxH=l;k.maxV=a;g(k);break;case 65476:q=m();for(d=2;d<q;){l=h[c++];a=new Uint8Array(16);for(e=p=0;16>e;e++,c++)p+=a[e]=h[c];z=new Uint8Array(p);for(e=0;e<p;e++,c++)z[e]=h[c];d+=17+p;(0===l>>4?f:b)[l&15]=R(a,
z)}break;case 65501:m();var I=m();break;case 65498:m();q=h[c++];e=[];for(d=0;d<q;d++){l=k.componentIds[h[c++]];var N=k.components[l];l=h[c++];N.huffmanTableDC=f[l>>4];N.huffmanTableAC=b[l&15];e.push(N)}d=h[c++];q=h[c++];l=h[c++];d=S(h,c,k,e,I,d,q,l>>4,l&15);c+=d;break;case 65535:255!==h[c]&&c--;break;default:if(255===h[c-3]&&192<=h[c-2]&&254>=h[c-2])c-=3;else throw new B("unknown marker "+d.toString(16));}d=m()}this.width=k.samplesPerLine;this.height=k.scanLines;this.jfif=t;this.eof=c;this.adobe=
A;this.components=[];for(d=0;d<k.components.length;d++){N=k.components[d];if(t=r[N.quantizationId])N.quantizationTable=t;this.components.push({output:K(k,N),scaleX:N.h/k.maxH,scaleY:N.v/k.maxV,blocksPerLine:N.blocksPerLine,blocksPerColumn:N.blocksPerColumn})}this.numComponents=this.components.length},_getLinearizedBlockData:function(h,m){var n=this.width/h,g=this.height/m,c,t,A=0,r=this.components.length,b=h*m*r,f=new Uint8ClampedArray(b),d=new Uint32Array(h);for(t=0;t<r;t++){var e=this.components[t];
var q=e.scaleX*n;var l=e.scaleY*g;A=t;var a=e.output;var k=e.blocksPerLine+1<<3;for(c=0;c<h;c++)e=0|c*q,d[c]=(e&4294967288)<<3|e&7;for(q=0;q<m;q++)for(e=0|q*l,e=k*(e&4294967288)|(e&7)<<3,c=0;c<h;c++)f[A]=a[e+d[c]],A+=r}if(m=this.decodeTransform)for(t=0;t<b;)for(h=e=0;e<r;e++,t++,h+=2)f[t]=(f[t]*m[h]>>8)+m[h+1];return f},_isColorConversionNeeded:function(){return this.adobe?!!this.adobe.transformCode:3===this.numComponents?0===this.colorTransform?!1:!0:1===this.colorTransform?!0:!1},_convertYccToRgb:function(h){for(var m,
n,g,c=0,t=h.length;c<t;c+=3)m=h[c],n=h[c+1],g=h[c+2],h[c]=m-179.456+1.402*g,h[c+1]=m+135.459-.344*n-.714*g,h[c+2]=m-226.816+1.772*n;return h},_convertYcckToRgb:function(h){for(var m,n,g,c,t=0,A=0,r=h.length;A<r;A+=4)m=h[A],n=h[A+1],g=h[A+2],c=h[A+3],h[t++]=-122.67195406894+n*(-6.60635669420364E-5*n+4.37130475926232E-4*g-5.4080610064599E-5*m+4.8449797120281E-4*c-.154362151871126)+g*(-9.57964378445773E-4*g+8.17076911346625E-4*m-.00477271405408747*c+1.53380253221734)+m*(9.61250184130688E-4*m-.00266257332283933*
c+.48357088451265)+c*(-3.36197177618394E-4*c+.484791561490776),h[t++]=107.268039397724+n*(2.19927104525741E-5*n-6.40992018297945E-4*g+6.59397001245577E-4*m+4.26105652938837E-4*c-.176491792462875)+g*(-7.78269941513683E-4*g+.00130872261408275*m+7.70482631801132E-4*c-.151051492775562)+m*(.00126935368114843*m-.00265090189010898*c+.25802910206845)+c*(-3.18913117588328E-4*c-.213742400323665),h[t++]=-20.810012546947+n*(-5.70115196973677E-4*n-2.63409051004589E-5*g+.0020741088115012*m-.00288260236853442*c+
.814272968359295)+g*(-1.53496057440975E-5*g-1.32689043961446E-4*m+5.60833691242812E-4*c-.195152027534049)+m*(.00174418132927582*m-.00255243321439347*c+.116935020465145)+c*(-3.43531996510555E-4*c+.24165260232407);return h},_convertYcckToCmyk:function(h){for(var m,n,g,c=0,t=h.length;c<t;c+=4)m=h[c],n=h[c+1],g=h[c+2],h[c]=434.456-m-1.402*g,h[c+1]=119.541-m+.344*n+.714*g,h[c+2]=481.816-m-1.772*n;return h},_convertCmykToRgb:function(h){for(var m,n,g,c,t=0,A=1/255,r=0,b=h.length;r<b;r+=4)m=h[r]*A,n=h[r+
1]*A,g=h[r+2]*A,c=h[r+3]*A,h[t++]=255+m*(-4.387332384609988*m+54.48615194189176*n+18.82290502165302*g+212.25662451639585*c-285.2331026137004)+n*(1.7149763477362134*n-5.6096736904047315*g-17.873870861415444*c-5.497006427196366)+g*(-2.5217340131683033*g-21.248923337353073*c+17.5119270841813)-c*(21.86122147463605*c+189.48180835922747),h[t++]=255+m*(8.841041422036149*m+60.118027045597366*n+6.871425592049007*g+31.159100130055922*c-79.2970844816548)+n*(-15.310361306967817*n+17.575251261109482*g+131.35250912493976*
c-190.9453302588951)+g*(4.444339102852739*g+9.8632861493405*c-24.86741582555878)-c*(20.737325471181034*c+187.80453709719578),h[t++]=255+m*(.8842522430003296*m+8.078677503112928*n+30.89978309703729*g-.23883238689178934*c-14.183576799673286)+n*(10.49593273432072*n+63.02378494754052*g+50.606957656360734*c-112.23884253719248)+g*(.03296041114873217*g+115.60384449646641*c-193.58209356861505)-c*(22.33816807309886*c+180.12613974708367);return h},getData:function(h,m,n){if(4<this.numComponents)throw new B("Unsupported color mode");
h=this._getLinearizedBlockData(h,m);if(1===this.numComponents&&n){n=h.length;m=new Uint8ClampedArray(3*n);for(var g=0,c=0;c<n;c++){var t=h[c];m[g++]=t;m[g++]=t;m[g++]=t}return m}if(3===this.numComponents&&this._isColorConversionNeeded())return this._convertYccToRgb(h);if(4===this.numComponents){if(this._isColorConversionNeeded())return n?this._convertYcckToRgb(h):this._convertYcckToCmyk(h);if(n)return this._convertCmykToRgb(h)}return h}};return T}()})})(E);w=w.getDefaultExportFromCjs(E.exports);P.JpegImage=
w})},"esri/layers/support/rasterFormats/Lerc":function(){define(["require","exports","../../../assets"],function(P,w,E){function C(D,G,h){h.set(D.slice(G,G+h.length))}function B(D){const {_malloc:G,_free:h,_lerc_getBlobInfo:m,_lerc_getDataRanges:n,_lerc_decode_4D:g,asm:c}=D;let t;const A=Object.values(c).find(b=>b&&"buffer"in b&&b.buffer===D.HEAPU8.buffer),r=b=>{b=b.map(e=>(e>>3<<3)+16);var f=b.reduce((e,q)=>e+q),d=G(f);t=new Uint8Array(A.buffer);f=b[0];b[0]=d;for(d=1;d<b.length;d++){const e=b[d];
b[d]=b[d-1]+f;f=e}return b};K.getBlobInfo=b=>{var f=new Uint8Array(48),d=new Uint8Array(24);const [e,q,l]=r([b.length,f.length,d.length]);t.set(b,e);t.set(f,q);t.set(d,l);var a=m(e,b.length,q,l,12,3);if(a)throw h(e),Error(`lerc-getBlobInfo: error code is ${a}`);t=new Uint8Array(A.buffer);C(t,q,f);C(t,l,d);f=new Uint32Array(f.buffer);var k=new Float64Array(d.buffer);const [p,z,,I,N,O,H,u,y,x,L]=f;d={version:p,depthCount:x,width:I,height:N,validPixelCount:H,bandCount:O,blobSize:u,maskCount:y,dataType:z,
minValue:k[0],maxValue:k[1],maxZerror:k[2],statistics:[],bandCountWithNoData:L};if(L)return d;if(1===x&&1===O)return h(e),d.statistics.push({minValue:k[0],maxValue:k[1]}),d;a=x*O*8;var Q=new Uint8Array(a),W=new Uint8Array(a);f=e;var v=k=0;let F=!1;t.byteLength<e+2*a?(h(e),F=!0,[f,k,v]=r([b.length,a,a]),t.set(b,f)):[k,v]=r([a,a]);t.set(Q,k);t.set(W,v);if(a=n(f,b.length,x,O,k,v))throw h(f),F||h(k),Error(`lerc-getDataRanges: error code is ${a}`);t=new Uint8Array(A.buffer);C(t,k,Q);C(t,v,W);b=new Float64Array(Q.buffer);
a=new Float64Array(W.buffer);W=d.statistics;for(Q=0;Q<O;Q++)if(1<x){v=b.slice(Q*x,(Q+1)*x);const J=a.slice(Q*x,(Q+1)*x),M=Math.min.apply(null,v),U=Math.max.apply(null,J);W.push({minValue:M,maxValue:U,depthStats:{minValues:v,maxValues:J}})}else W.push({minValue:b[Q],maxValue:a[Q]});h(f);F||h(k);return d};K.decode=(b,f)=>{const {maskCount:d,depthCount:e,bandCount:q,width:l,height:a,dataType:k,bandCountWithNoData:p}=f;var z=T[k],I=l*a;f=new Uint8Array(I*q);z=new Uint8Array(I*e*q*z.size);I=new Uint8Array(q);
var N=new Uint8Array(8*q);const [O,H,u,y,x]=r([b.length,f.length,z.length,I.length,N.length]);t.set(b,O);t.set(f,H);t.set(z,u);t.set(I,y);t.set(N,x);if(b=g(O,b.length,d,H,e,l,a,q,k,u,y,x))throw h(O),Error(`lerc-decode: error code is ${b}`);t=new Uint8Array(A.buffer);C(t,u,z);C(t,H,f);b=null;if(p){C(t,y,I);C(t,x,N);b=[];N=new Float64Array(N.buffer);for(let L=0;L<I.length;L++)b.push(I[L]?N[L]:null)}h(O);return{data:z,maskData:f,noDataValues:b}}}const T=[{pixelType:"S8",size:1,ctor:Int8Array,range:[-128,
127]},{pixelType:"U8",size:1,ctor:Uint8Array,range:[0,255]},{pixelType:"S16",size:2,ctor:Int16Array,range:[-32768,32767]},{pixelType:"U16",size:2,ctor:Uint16Array,range:[0,65536]},{pixelType:"S32",size:4,ctor:Int32Array,range:[-2147483648,2147483647]},{pixelType:"U32",size:4,ctor:Uint32Array,range:[0,4294967296]},{pixelType:"F32",size:4,ctor:Float32Array,range:[-3.4027999387901484E38,3.4027999387901484E38]},{pixelType:"F64",size:8,ctor:Float64Array,range:[-1.7976931348623157E308,1.7976931348623157E308]}];
let R=null,S=!1;const K={getBlobInfo:null,decode:null};w.decode=function(D,G={}){var h=G.inputOffset??0;D=D instanceof Uint8Array?D.subarray(h):new Uint8Array(D,h);h=K.getBlobInfo(D);const {data:m,maskData:n,noDataValues:g}=K.decode(D,h),{width:c,height:t,bandCount:A,depthCount:r,dataType:b,maskCount:f,statistics:d}=h;var e=T[b],q=new e.ctor(m.buffer);D=[];h=[];const l=c*t;var a=l*r;for(var k=0;k<A;k++){var p=q.subarray(k*a,(k+1)*a);if(G.returnInterleaved)D.push(p);else{a:{var z=l,I=r;if(2>I)break a;
const N=new e.ctor(z*I);for(let O=0,H=0;O<z;O++)for(let u=0,y=O;u<I;u++,y+=z)N[y]=p[H++];p=N}D.push(p)}h.push(n.subarray(k*a,(k+1)*a))}q=0===f?null:1===f?h[0]:new Uint8Array(l);if(1<f)for(q.set(h[0]),a=1;a<h.length;a++)for(k=h[a],p=0;p<l;p++)q[p]&=k[p];({noDataValue:G}=G);a=null!=G&&e.range[0]<=G&&e.range[1]>=G;if(0<f&&a)for(a=0;a<A;a++)for(k=D[a],p=h[a]||q,z=0;z<l;z++)0===p[z]&&(k[z]=G);({pixelType:e}=e);return{width:c,height:t,bandCount:A,pixelType:e,depthCount:r,statistics:d,pixels:D,mask:q,bandMasks:f===
A&&1<A?h:null,noDataValues:g}};w.getBlobInfo=function(D,G={}){D=D instanceof Uint8Array?D.subarray(G.inputOffset??0):new Uint8Array(D,G.inputOffset??0);return K.getBlobInfo(D)};w.isLoaded=function(){return S};w.load=function(){return R?R:R=(new Promise((D,G)=>P(["../../../chunks/lerc-wasm"],D,G))).then(D=>D.lercWasm).then(({default:D})=>D({locateFile:G=>E.getAssetUrl(`esri/layers/support/rasterFormats/${G}`)})).then(D=>{B(D);S=!0})};w.pixelTypeInfoMap=T;Object.defineProperty(w,Symbol.toStringTag,
{value:"Module"})})},"esri/layers/support/rasterFormats/Lzw":function(){define(["exports"],function(P){function w(T,R,S,K=!0){if(0!==R%4||0!==S%4){var D=new ArrayBuffer(4*Math.ceil(S/4));D=new Uint8Array(D);T=new Uint8Array(T,R,S);if(K)for(K=0;K<D.length;K+=4)D[K]=T[K+3],D[K+1]=T[K+2],D[K+2]=T[K+1],D[K+3]=T[K];else D.set(T);return new Uint32Array(D.buffer)}if(K){K=new Uint8Array(T,R,S);D=new Uint8Array(K.length);for(T=0;T<D.length;T+=4)D[T]=K[T+3],D[T+1]=K[T+2],D[T+2]=K[T+1],D[T+3]=K[T];return new Uint32Array(D.buffer)}return new Uint32Array(T,
R,S/4)}function E(){const T=[];for(let R=0;257>=R;R++)T[R]=[R];return T}function C(T,R){for(let S=0;S<R.length;S++)T.push(R[S])}const B=new Set;B.add(511);B.add(1023);B.add(2047);B.add(4095);B.add(8191);P.decode=function(T,R,S,K=!0){T=w(T,R,S,K);R=9;K=E();let D=32,G=K.length,h=[],m=1,n=T[0],g=0;const c=T.length;S=8*(4*c-S);const t=[];for(;null!=n;){if(D>=R)D-=R,g=n>>>32-R,n<<=R;else{g=n>>>32-D;n=T[m++];var A=R-D;D=32-A;g=(g<<A)+(n>>>D);n<<=A}if(257===g)break;if(256===g)R=9,K=E(),G=K.length,h=[];else{A=
K[g];if(null==A){if(g>K.length)throw Error("data integrity issue: code does not exist on code page");h.push(h[0]);K[G++]=h.slice();C(t,h)}else C(t,A),h.push(A[0]),1<h.length&&(K[G++]=h.slice()),h=A.slice();B.has(G)&&R++;0===D&&(n=T[m++],D=32);if(m>c||m===c&&D<=S)break}}return new Uint8Array(t)};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/Raw":function(){define(["../../../chunks/_rollupPluginBabelHelpers"],function(P){const w=E=>{let C=1;switch(E){case Uint8Array:case Int8Array:C=
1;break;case Uint16Array:case Int16Array:C=2;break;case Uint32Array:case Int32Array:case Float32Array:C=4;break;case Float64Array:C=8}return C};return function(){function E(){}E.decode=function(C,B){var T=B.pixelType;const R=[],S=B.width*B.height;var K=Math.floor(C.byteLength/(B.width*B.height*w(B.pixelType)));const {bandIds:D,format:G}=B;B=D&&D.length||Math.floor(C.byteLength/(B.width*B.height*w(B.pixelType)));var h=C.byteLength-C.byteLength%(S*w(T)),m=new T(C,0,S*K);let n,g,c,t,A=null;if("bip"===
G)for(n=0;n<B;n++){c=new T(S);t=D?D[n]:n;for(g=0;g<S;g++)c[g]=m[g*K+t];R.push(c)}else if("bsq"===G)for(n=0;n<B;n++)t=D?D[n]:n,R.push(m.subarray(t*S,(t+1)*S));if(h<C.byteLength-1)if(C=C.slice(h),8*C.byteLength<S)A=null;else{C=new Uint8Array(C,0,Math.ceil(S/8));T=new Uint8Array(S);for(h=m=h=B=K=0;h<C.length-1;h++)for(B=C[h],m=7;0<=m;m--)T[K++]=B>>m&1;for(m=7;K<S-1;)B=C[C.length-1],T[K++]=B>>m&1,m--;A=T}return{pixels:R,mask:A}};return P._createClass(E)}()})},"esri/layers/support/rasterFormats/TiffDecoder":function(){define("exports ../rasterDatasets/byteStreamUtils ../../../chunks/Jpg ./Lerc ./Lzw ./pixelRangeUtils ./TiffTags ./utils ../../../chunks/Zlib".split(" "),
function(P,w,E,C,B,T,R,S,K){function D(y,x){let L="unknown";3===y?L=64===x?"f64":"f32":1===y?1===x?L="u1":2===x?L="u2":4===x?L="u4":8>=x?L="u8":16>=x?L="u16":32>=x&&(L="u32"):2===y&&(8>=x?L="s8":16>=x?L="s16":32>=x&&(L="s32"));return L}function G(y){let x=null;switch(y?y.toLowerCase():"f32"){case "u1":case "u2":case "u4":case "u8":x=Uint8Array;break;case "u16":x=Uint16Array;break;case "u32":x=Uint32Array;break;case "s8":x=Int8Array;break;case "s16":x=Int16Array;break;case "s32":x=Int32Array;break;
case "f64":x=Float64Array;break;default:x=Float32Array}return x}function h(y,x){return{x:x[0]*y.x+x[1]*y.y+x[2],y:x[3]*y.x+x[4]*y.y+x[5]}}function m(y,x){return y.get(x)?.values?.[0]}function n(y,x,L,Q=0,W=R.TIFF_TAGS,v=4){var F=8===v;const J=F?a(new DataView(y,L,8),0,x):(new DataView(y,L,2)).getUint16(0,x),M=4+2*v;var U=F?8:2;F=U+J*M;if(L+F>y.byteLength)return{success:!1,ifd:null,nextIFD:null,requiredBufferSize:F};const V=L+F+4<=y.byteLength?k(new DataView(y,L+F,8===v?8:4),0,x,8===v):null;L+=U;U=
new Map;let X,Z,Y,ea=0,da=0;for(let fa=0;fa<J;fa++){var ia=new DataView(y,L+M*fa,M);X=ia.getUint16(0,x);Y=ia.getUint16(2,x);Z=R.getTagName(X,W);const ja=[];2===v?(ea=ia.getUint16(4,x),da=ia.getUint16(6,x)):4===v?(ea=ia.getUint32(4,x),da=ia.getUint32(8,x)):8===v&&(ea=k(ia,4,x,!0),da=k(ia,12,x,!0),ja.push(ia.getUint32(12,x)),ja.push(ia.getUint32(16,x)));ia={id:X,type:Y,valueCount:ea,valueOffset:da,valueOffsets:ja,values:null};b(y,x,ia,Q,!1,v);U.set(Z,ia)}return{success:!0,ifd:U,nextIFD:V,requiredBufferSize:F}}
function g(y,x){if(1!==x&&2!==x&&4!==x)return y;const L=new Uint8Array(y),Q=8/x;y=new Uint8Array(y.byteLength*Q);let W=0;const v=2**x-1;for(let F=0;F<L.length;F++){const J=L[F];for(let M=0;M<Q;M++)y[W++]=J<<x*M>>>8-x&v}return y.buffer}function c(y,x,L){const Q=new E.JpegImage;Q.parse(y);Q.colorTransform=6===L?-1:0;y=Q.getData(Q.width,Q.height,1!==x);return new Uint8Array(y.buffer)}function t(y){y=(new K.Zlib(y)).getBytes();var x=new ArrayBuffer(y.length);x=new Uint8Array(x);x.set(y);return x}async function A(y,
x,L,Q,W){var v=S.isPlatformLittleEndian===x,F=m(L,"BITSPERSAMPLE"),J=m(L,"SAMPLESPERPIXEL")??1,M=m(L,"PHOTOMETRICINTERPRETATION"),U=m(L,"SAMPLEFORMAT")??1,V=D(U,F),X=m(L,"COMPRESSION")??1,Z=G(V);if(34887===X)return await C.load(),C.decode(y,{inputOffset:Q}).pixels[0];if(1===X)M=y.slice(Q,Q+W),x=new Uint8Array(M);else if(8===X||32946===X)x=new Uint8Array(y,Q,W),x=t(x),M=x.buffer;else if(6===X)x=new Uint8Array(y,Q,W),x=c(x,J,M),M=x.buffer;else if(7===X){const Y=L.get("JPEGTABLES").values,ea=Y.length-
2;x=new Uint8Array(ea+W-2);for(let da=0;da<ea;da++)x[da]=Y[da];y=new Uint8Array(y,Q+2,W-2);for(Q=0;Q<y.length;Q++)x[ea+Q]=y[Q];x=c(x,J,M);M=x.buffer}else if(5===X)x=B.decode(y,Q,W,x),M=x.buffer;else throw Error("tiff-decode: unsupport compression "+X);M=g(M,F);if("u8"!==V&&"s8"!==V&&!v)switch(M=new ArrayBuffer(x.length),v=new Uint8Array(M),V){case "u16":case "s16":for(V=0;V<x.length;V+=2)v[V]=x[V+1],v[V+1]=x[V];break;case "u32":case "s32":case "f32":for(V=0;V<x.length;V+=4)v[V]=x[V+3],v[V+1]=x[V+
2],v[V+2]=x[V+1],v[V+3]=x[V]}F=new Z(M);v=m(L,"PREDICTOR")??1;V=m(L,"TILEWIDTH");x=m(L,"TILELENGTH");if(1<v&&(5===X||8===X||32946===X)&&V&&x){X=d(L);Z=new Z(F.length);Z.set(F);L=3===U&&3===v;X=X?1:J;J=L?4:1;U=V*J*X;L&&(Z=new Uint8Array(Z.buffer));for(v=0;v<x;v++)for(F=v*U,M=X;M<U;M++)Z[F+M]+=Z[F+M-X];if(L){L=new Uint8Array(Z.length);X*=V;for(V=0;V<x;V++)for(v=V*U,F=0;F<X;F++)for(M=0;M<J;M++)L[v+F*J+M]=Z[v+F+(J-M-1)*X];F=new Float32Array(L.buffer)}else F=Z}return F}async function r(y,x,L){const Q=
L.get("TILEOFFSETS")?.values;if(void 0===Q)return null;const W=L.get("TILEBYTECOUNTS")?.values,{width:v,height:F,pixelType:J,tileWidth:M,tileHeight:U}=f([L]);var V=d(L,x);const X=m(L,"SAMPLESPERPIXEL")||x.planes;var Z=v*F,Y=m(L,"BITSPERSAMPLE"),ea=34887===(m(L,"COMPRESSION")??1),da=G(J);const ia=[];for(var fa=0;fa<X;fa++)ia.push(new da(Z));let ja,ma,na,ra,qa,va,sa,xa;Z=Math.ceil(v/M);if(0===Y%8)if(ea&&V&&1<X)for(V=Math.round(Q.length/X),Y=0;Y<V;Y++){var oa=Math.floor(Y/Z)*U;na=Y%Z*M;da=oa*v+na;for(ea=
0;ea<X;ea++)if(fa=Y*X+ea,0!==W[fa])for(fa=await A(y,x.littleEndian,L,Q[fa],W[fa]),qa=0,ra=da,sa=Math.min(M,v-na),va=Math.min(U,F-oa),xa=ia[ea],ja=0;ja<va;ja++)for(ra=da+ja*v,qa=ja*M,ma=0;ma<sa;ma++,ra++,qa++)xa[ra]=fa[qa]}else for(Y=0;Y<Q.length;Y++)if(0!==W[Y])for(oa=Math.floor(Y/Z)*U,na=Y%Z*M,da=oa*v+na,fa=await A(y,x.littleEndian,L,Q[Y],W[Y]),qa=0,ra=da,sa=Math.min(M,v-na),va=Math.min(U,F-oa),oa=0;oa<X;oa++)if(xa=ia[oa],V||ea)for(ja=0;ja<va;ja++)for(ra=da+ja*v,qa=M*U*oa+ja*M,ma=0;ma<sa;ma++,ra++,
qa++)xa[ra]=fa[qa];else for(ja=0;ja<va;ja++)for(ra=da+ja*v,qa=ja*M*X+oa,ma=0;ma<sa;ma++,ra++,qa+=X)xa[ra]=fa[qa];return{width:v,height:F,pixelType:J,pixels:ia}}function b(y,x,L,Q=0,W=!1,v=4){if(L.values)return!0;var F=L.type,J=L.valueCount,M=L.valueOffset;let U=[];var V=N[F],X=8*V,Z=J*V,Y=J*N[F]*8,ea=8===v?64:32;v=L.valueOffsets;if(Y>ea&&Z>(W?y.byteLength:y?y.byteLength-M+Q:0))return L.offlineOffsetSize=[M,Z],L.values=null,!1;if(Y<=ea)if(x||(32>=ea?M>>>=32-Y:(y=v?.length?v[0]:M>>>0,x=v?.length?v[1]:
Math.round((M-y)/4294967296),32>=Y?(M=y>>>32-Y,v[0]=M):(M=y*2**(32-Y)+(x>>>32-Y),v[0]=y,v[1]=x>>>32-Y))),1===J&&X===ea)U=[M];else if(64===ea)for(y=v?.length?v[0]:M>>>0,M=v?.length?v[1]:Math.round((M-y)/4294967296),x=y,V=32,y=1;y<=J;y++)Z=32-X*y%32,V<X?(Z=x<<Z>>>32-V,Y=M<<32-V>>>32-V,x=M,U.push(Z+Y*2**(X-V)),V-=32-(X-V)):(U.push(x<<Z>>>32-X),V-=X),0===V&&(V=32,x=M);else for(y=1;y<=J;y++)U.push(M<<32-X*y>>>32-X);else for(M-=Q,W&&(M=0),J=M;J<M+Z;J+=V){switch(F){case 1:X=(new DataView(y,J,1)).getUint8(0);
break;case 2:X=(new DataView(y,J,1)).getUint8(0);break;case 3:X=(new DataView(y,J,2)).getUint16(0,x);break;case 4:case 13:X=(new DataView(y,J,4)).getUint32(0,x);break;case 5:X=(new DataView(y,J,4)).getUint32(0,x)/(new DataView(y,J+4,4)).getUint32(0,x);break;case 6:X=(new DataView(y,J,1)).getInt8(0);break;case 7:X=(new DataView(y,J,1)).getUint8(0);break;case 8:X=(new DataView(y,J,2)).getInt16(0,x);break;case 9:X=(new DataView(y,J,4)).getInt32(0,x);break;case 10:X=(new DataView(y,J,4)).getInt32(0,x)/
(new DataView(y,J+4,4)).getInt32(0,x);break;case 11:X=(new DataView(y,J,4)).getFloat32(0,x);break;case 12:X=(new DataView(y,J,8)).getFloat64(0,x);break;case 16:case 18:X=a(new DataView(y,J,8),0,x);break;case 17:v=new DataView(y,J,8);Y=(X=x)?v.getInt32(0,X):v.getUint32(0,X);v=X?v.getUint32(4,X):v.getInt32(4,X);ea=0<=(X?Y:v)?1:-1;X?Y*=ea:v*=ea;X=ea*(X?4294967296*v+Y:4294967296*Y+v);break;default:X=null}U.push(X)}if(2===F){F="";M=U;U=[];for(y=0;y<M.length;y++)0===M[y]&&""!==F?(U.push(F),F=""):F+=String.fromCharCode(M[y]);
""===F&&0!==U.length||U.push(F)}L.values=U;return!0}function f(y){var x=y[0];const L=m(x,"TILEWIDTH"),Q=m(x,"TILELENGTH"),W=m(x,"IMAGEWIDTH"),v=m(x,"IMAGELENGTH");var F=m(x,"BITSPERSAMPLE");const J=m(x,"SAMPLESPERPIXEL");var M=m(x,"SAMPLEFORMAT")??1;const U=D(M,F),V=d(x);var X=x.get("GDAL_NODATA")?.values;let Z=null;X?.length&&(Z=X.map(oa=>parseFloat(oa)),Z.some(oa=>isNaN(oa))&&(Z=null));var Y=m(x,"COMPRESSION")??1;switch(Y){case 1:X="NONE";break;case 2:case 3:case 4:case 32771:X="CCITT";break;case 5:X=
"LZW";break;case 6:case 7:X="JPEG";break;case 32773:X="PACKBITS";break;case 8:case 32946:X="DEFLATE";break;case 34712:X="JPEG2000";break;case 34887:X="LERC";break;default:X=String(Y)}let ea=!0,da="";O.has(Y)||(ea=!1,da+="unsupported tag compression "+Y);3<M&&(ea=!1,da+="unsupported tag sampleFormat "+M);1!==F&&2!==F&&4!==F&&0!==F%8&&(ea=!1,da+="unsupported tag bitsPerSample "+F);F=x.get("GEOASCIIPARAMS")?.values?.[0];if(F){var ia=(ia=F.split("|").find(oa=>oa.includes("ESRI PE String \x3d ")))?ia.replace("ESRI PE String \x3d ",
""):"";ia=ia.startsWith("COMPD_CS")||ia.startsWith("PROJCS")||ia.startsWith("GEOGCS")?{wkid:null,wkt:ia}:null}M=x.get("GEOTIEPOINTS")?.values;F=x.get("GEOPIXELSCALE")?.values;Y=x.get("GEOTRANSMATRIX")?.values;var fa=x.has("GEOKEYDIRECTORY")?x.get("GEOKEYDIRECTORY").data:null,ja=!1;x=!1;if(fa){ja=2===m(fa,"GTRasterTypeGeoKey");var ma=m(fa,"GTModelTypeGeoKey");2===ma?(fa=m(fa,"GeographicTypeGeoKey"),1024<=fa&&32766>=fa&&(ia={wkid:fa}),ia||32767!==fa||(x=!0,ia={wkid:4326})):1===ma&&(fa=m(fa,"ProjectedCSTypeGeoKey"),
1024<=fa&&32766>=fa&&(ia={wkid:fa}))}let na;F&&M&&6<=M.length?(na=[F[0],0,M[3]-M[0]*F[0],0,-Math.abs(F[1]),M[4]-M[1]*F[1]],ja&&(na[2]-=.5*na[0]+.5*na[1],na[5]-=.5*na[3]+.5*na[4])):Y&&16===Y.length&&(na=ja?[Y[0],Y[1],Y[3]-.5*Y[0],Y[4],Y[5],Y[7]-.5*Y[5]]:[Y[0],Y[1],Y[3],Y[4],Y[5],Y[7]]);if(na){M=[{x:0,y:v},{x:0,y:0},{x:W,y:v},{x:W,y:0}];fa=ja=Number.POSITIVE_INFINITY;let oa=ma=Number.NEGATIVE_INFINITY;for(let wa=0;wa<M.length;wa++)Y=h(M[wa],na),ja=Y.x>ja?ja:Y.x,ma=Y.x<ma?ma:Y.x,fa=Y.y>fa?fa:Y.y,oa=
Y.y<oa?oa:Y.y;M={xmin:ja,xmax:ma,ymin:fa,ymax:oa,spatialReference:ia}}else M={xmin:-.5,ymin:.5-v,xmax:W-.5,ymax:.5,spatialReference:ia};x&&(400<M.xmax-M.xmin||361<Math.max(Math.abs(M.xmin),Math.abs(M.xmax)))&&(ia=null,M.spatialReference=null);ia=e(y);let ra;let qa,va;if(0<ia.length){qa=Math.round(Math.log(W/m(ia[0],"IMAGEWIDTH"))/Math.LN2);var sa=ia[ia.length-1];va=Math.round(Math.log(W/m(sa,"IMAGEWIDTH"))/Math.LN2);ra=m(sa,"TILEWIDTH");sa=m(sa,"TILELENGTH")}ra=null!=va&&0<va?ra||L:null;sa=null!=
va&&0<va?sa||Q:null;let xa;L&&(xa=[{maxCol:Math.ceil(W/L)-1,maxRow:Math.ceil(v/Q)-1,minRow:0,minCol:0}],ia.forEach(oa=>{xa.push({maxCol:Math.ceil(m(oa,"IMAGEWIDTH")/m(oa,"TILEWIDTH"))-1,maxRow:Math.ceil(m(oa,"IMAGELENGTH")/m(oa,"TILELENGTH"))-1,minRow:0,minCol:0})}));Y=y[0].get("GDAL_METADATA")?.values?.[0];Y=u(Y);da+=" "+I({width:W,height:v,tileWidth:L,tileHeight:Q,planes:J,ifds:y});y=q(y).length===ia.length+1;return{width:W,height:v,tileWidth:L,tileHeight:Q,planes:J,isBSQ:V,pixelType:U,compression:X,
noData:Z,hasMaskBand:y,isSupported:ea,message:da,extent:M,isPseudoGeographic:x,affine:F?null:na,firstPyramidLevel:qa,maximumPyramidLevel:va,pyramidBlockWidth:ra,pyramidBlockHeight:sa,tileBoundary:xa,metadata:Y}}function d(y,x){return(y=y.get("PLANARCONFIGURATION")?.values)?2===y[0]:x?x.isBSQ:!1}function e(y){return y.filter(x=>1===m(x,"NEWSUBFILETYPE"))}function q(y){return y.filter(x=>{const L=4===((m(x,"NEWSUBFILETYPE")??0)&4);x=4===m(x,"PHOTOMETRICINTERPRETATION");return L&&x})}function l(y){const {littleEndian:x,
isBigTiff:L,firstIFDPos:Q}=p(y);var W=Q;const v=[];do if(W=z(y,x,W,0,R.TIFF_TAGS,L?8:4),W.success)v.push(W.ifd),W=W.nextIFD;else break;while(0<W);y=f(v);W=e(v);const F=q(v);return{...y,littleEndian:x,isBigTiff:L,ifds:v,pyramidIFDs:W,maskIFDs:F}}function a(y,x,L){const Q=y.getUint32(x,L);y=y.getUint32(x+4,L);return L?4294967296*y+Q:4294967296*Q+y}function k(y,x,L,Q){return Q?a(y,x,L):y.getUint32(x,L)}function p(y){var x=new DataView(y,0,16),L=x.getUint16(0,!1);y=null;if(18761===L)y=!0;else if(19789===
L)y=!1;else throw Error("unexpected endianess byte");var Q=x.getUint16(2,y);if(42!==Q&&43!==Q)throw Error("unexpected tiff identifier");L=4;if(Q=43===Q){const W=x.getUint16(L,y);L+=2;if(8!==W)throw Error("unsupported bigtiff version");if(0!==x.getUint16(L,y))throw Error("unsupported bigtiff version");L+=2}x=k(x,L,y,Q);return{littleEndian:y,isBigTiff:Q,firstIFDPos:x}}function z(y,x,L,Q=0,W=R.TIFF_TAGS,v=4){L=n(y,x,L,Q,W,v);let F;const J=L.ifd;J&&(R.ifdTags.forEach((M,U)=>{J.has(U)&&(F=J.get(U),F.data=
n(y,x,F.valueOffset-Q,Q,M).ifd)}),J.has("GEOKEYDIRECTORY")&&(F=J.get("GEOKEYDIRECTORY"),(W=F.values)&&4<W.length&&(W=W[0]+"."+W[1]+"."+W[2],F.data=n(y,x,F.valueOffset+6-Q,Q,R.GEO_KEYS,2).ifd,F.data&&F.data.set("GEOTIFFVersion",{id:0,type:2,valueCount:1,valueOffset:null,values:[W]}))),J.has("XMP")&&(F=J.get("XMP"),W=F.values,"number"===typeof W[0]&&7===F.type&&(F.values=[w.bytesToUTF8(new Uint8Array(W))])));return L}function I(y){const {width:x,height:L,tileHeight:Q,tileWidth:W}=y,v=y.planes,F=W?W*
Q:x*L;y=m(y.ifds[0],"BITSPERSAMPLE");let J="";F*v>2**30/(8<y?y/8:1)&&(J=W?"tiled tiff exceeding 1 gigabits per tile is not supported":"scanline tiff exceeding 1 gigabits is not supported");return J}const N=[0,1,1,2,4,8,1,1,2,4,8,4,8,-1,-1,-1,8,8,8],O=new Set([1,5,6,7,8,34712,34887]),H=(y,x,L)=>{if(!(y&&0<y.length&&x&&L))return null;let Q,W,v;const F=y[0].length,J=y.length,M=new Uint8Array(F);for(let V=0;V<J;V++)if(Q=y[V],W=x[V],v=L[V],0===V)for(var U=0;U<F;U++)M[U]=Q[U]<W||Q[U]>v?0:1;else for(U=0;U<
F;U++)M[U]&&(M[U]=Q[U]<W||Q[U]>v?0:1);return M},u=y=>{if(!y)return null;var x=y.match(/<Item(.*?)Item>/gi);if(!x||0===x.length)return null;y=new Map;var L;for(var Q=0;Q<x.length;Q++){var W=x[Q];var v=W.slice(6,W.indexOf("\x3e"));var F=W.indexOf("sample\x3d");-1<F&&(L=W.slice(F+8,W.indexOf('"',F+8)));F=W.indexOf("name\x3d");-1<F&&(v=W.slice(F+6,W.indexOf('"',F+6)));v&&(W=W.slice(W.indexOf("\x3e")+1,W.indexOf("\x3c/Item\x3e")).trim(),null!=L?y.has(v)?y.get(v)[L]=W:y.set(v,[W]):y.set(v,W));L=null}x=
y.get("STATISTICS_MINIMUM");v=y.get("STATISTICS_MAXIMUM");Q=y.get("STATISTICS_MEAN");W=y.get("STATISTICS_STDDEV");L=null;if(x&&v)for(L=[],F=0;F<x.length;F++)L.push({min:parseFloat(x[F]),max:parseFloat(v[F]),avg:Q&&parseFloat(Q[F]),stddev:W&&parseFloat(W[F])});v=y.get("BandName");Q=y.get("WavelengthMin");W=y.get("WavelengthMax");x=null;if(v)for(x=[],F=0;F<v.length;F++)x.push({BandName:v[F],WavelengthMin:Q&&parseFloat(Q[F]),WavelengthMax:W&&parseFloat(W[F])});v=y.get("DataType");return{statistics:L,
bandProperties:x,dataType:v,rawMetadata:y}};P.decode=async function(y,x={}){var L=x.pyramidLevel||0,Q=x.headerInfo||l(y);const {ifds:W,noData:v}=Q;if(0===W.length)throw Error("no valid image file directory");var F=I(Q);if(F)throw F;F=null;var J=-1===L?W[W.length-1]:W[L];x=v??x.noDataValue;if(Q.tileWidth)F=await r(y,Q,J);else{{const va=S.isPlatformLittleEndian===Q.littleEndian,sa=J.get("STRIPOFFSETS")?.values;if(void 0===sa)y=null;else{var {width:M,height:U,pixelType:V}=f([J]);L=m(J,"SAMPLESPERPIXEL")||
Q.planes;var X=m(J,"PHOTOMETRICINTERPRETATION");F=M*U;var Z=m(J,"BITSPERSAMPLE"),Y=G(V),ea=new Y(F*L),da=J.get("STRIPBYTECOUNTS")?.values,ia=m(J,"ROWSPERSTRIP"),fa=m(J,"COMPRESSION")??1;var ja=ia;if(0===Z%8)for(J=0;J<sa.length;J++){var ma=J*ia*M*L;ja=(J+1)*ia>U?U-J*ia:ia;if("u8"===V||"s8"===V||va)if(8===fa||32946===fa){var na=new Uint8Array(y,sa[J],da[J]);na=t(na);var ra=na.buffer}else 6===fa?(na=new Uint8Array(y,sa[J],da[J]),na=c(na,L,X),ra=na.buffer):5===fa?(na=B.decode(y,sa[J],da[J],Q.littleEndian),
ra=na.buffer):(da[J]!==ja*M*L*Z/8&&console.log("strip byte counts is different than expected"),ra=y.slice(sa[J],sa[J]+da[J]));else{if(6===fa||8===fa||32946===fa){na=new Uint8Array(y,sa[J],da[J]);var qa=t(na);ra=qa.buffer}else da[J]!==ja*M*L*Z/8&&console.log("strip byte counts is different than expected"),ra=new ArrayBuffer(da[J]),na=new Uint8Array(y,sa[J],da[J]),qa=new Uint8Array(ra);switch(V){case "u16":case "s16":for(ja=0;ja<na.length;ja+=2)qa[ja]=na[ja+1],qa[ja+1]=na[ja];break;case "u32":case "s32":case "f32":for(ja=
0;ja<na.length;ja+=4)qa[ja]=na[ja+3],qa[ja+1]=na[ja+2],qa[ja+2]=na[ja+1],qa[ja+3]=na[ja]}}ra=g(ra,Z);ja=new Y(ra);ea.set(ja,ma)}X=[];if(1===L)X.push(ea);else for(J=0;J<L;J++){Q=new Y(F);for(y=0;y<F;y++)Q[y]=ea[y*L+J];X.push(Q)}y={width:M,height:U,pixelType:V,pixels:X}}}F=await y}if(!F)return F;null!=x&&T.convertNoDataToMask(F,x);return F};P.decodeTileOrStrip=async function(y,x){const {headerInfo:L,ifd:Q,offsets:W,sizes:v}=x;var F=[];for(var J=0;J<W.length;J++){var M=await A(y,L.littleEndian,Q,W[J],
v[J]||y.byteLength);F.push(M)}var U=d(Q,L);y=m(Q,"BITSPERSAMPLE");J=m(Q,"SAMPLEFORMAT")??1;J=D(J,y);var V=m(Q,"SAMPLESPERPIXEL")||L.planes;const X=G(J);M=m(Q,"TILEWIDTH");const Z=m(Q,"TILELENGTH");var Y=m(Q,"COMPRESSION")??1;const ea=M*Z;y=[];let da=F[0];const ia=34887===Y;for(let fa=0;fa<V;fa++){Y=new X(ea);if(F.length===V)da=F[fa],da.length===ea&&(Y=da);else if(da.length)if(U||ia)Y=da.length===ea?da:da.slice(ea*fa,ea*(fa+1));else for(let ja=0;ja<ea;ja++)Y[ja]=da[ja*V+fa];y.push(Y)}F=L.noData?L.noData[0]:
x.noDataValue;U=(V=L.metadata?L.metadata.statistics:null)?V.map(fa=>fa.min):null;V=V?V.map(fa=>fa.max):null;J={pixelType:J,width:M,height:Z,pixels:y,noDataValue:F};null!=F?T.convertNoDataToMask(J,F):U&&V&&x.applyMinMaxConstraint&&(J.mask=H(y,U,V));return J};P.getImageInfo=f;P.getMaskIFDs=q;P.getPyramidIFDs=e;P.isBSQConfig=d;P.parseFieldValues=b;P.parseHeader=l;P.parseIFD=z;P.parseSignature=p;Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/byteStreamUtils":function(){define(["exports"],
function(P){P.bytesToUTF8=function(w,E){let C=0,B="",T=0,R=0;const S=w.length;for(;C<S;)if(R=w[C++],T=R>>4,8>T?T=1:15===T?(T=4,R=(R&7)<<18|(w[C++]&63)<<12|(w[C++]&63)<<6|w[C++]&63):14===T?(T=3,R=(R&15)<<12|(w[C++]&63)<<6|w[C++]&63):(T=2,R=(R&31)<<6|w[C++]&63),0!==R||E)B+=String.fromCharCode(R);return B};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/TiffTags":function(){define(function(){const P=(()=>{const B=[];B[254]="NEWSUBFILETYPE";B[255]="SUBFILETYPE";
B[256]="IMAGEWIDTH";B[257]="IMAGELENGTH";B[258]="BITSPERSAMPLE";B[259]="COMPRESSION";B[262]="PHOTOMETRICINTERPRETATION";B[263]="THRESHHOLDING";B[264]="CELLWIDTH";B[265]="CELLLENGTH";B[266]="FILLORDER";B[269]="DOCUMENTNAME";B[270]="IMAGEDESCRIPTION";B[271]="MAKE";B[272]="MODEL";B[273]="STRIPOFFSETS";B[274]="ORIENTATION";B[277]="SAMPLESPERPIXEL";B[278]="ROWSPERSTRIP";B[279]="STRIPBYTECOUNTS";B[280]="MINSAMPLEVALUE";B[281]="MAXSAMPLEVALUE";B[282]="XRESOLUTION";B[283]="YRESOLUTION";B[284]="PLANARCONFIGURATION";
B[285]="PAGENAME";B[286]="XPOSITION";B[287]="YPOSITION";B[288]="FREEOFFSETS";B[289]="FREEBYTECOUNTS";B[290]="GRAYRESPONSEUNIT";B[291]="GRAYRESPONSECURVE";B[292]="T4OPTIONS";B[293]="T6OPTIONS";B[296]="RESOLUTIONUNIT";B[297]="PAGENUMBER";B[300]="COLORRESPONSEUNIT";B[301]="TRANSFERFUNCTION";B[305]="SOFTWARE";B[306]="DATETIME";B[315]="ARTIST";B[316]="HOSTCOMPUTER";B[317]="PREDICTOR";B[318]="WHITEPOINT";B[319]="PRIMARYCHROMATICITIES";B[320]="COLORMAP";B[321]="HALFTONEHINTS";B[322]="TILEWIDTH";B[323]="TILELENGTH";
B[324]="TILEOFFSETS";B[325]="TILEBYTECOUNTS";B[326]="BADFAXLINES";B[327]="CLEANFAXDATA";B[328]="CONSECUTIVEBADFAXLINES";B[330]="SUBIFD";B[332]="INKSET";B[333]="INKNAMES";B[334]="NUMBEROFINKS";B[336]="DOTRANGE";B[337]="TARGETPRINTER";B[338]="EXTRASAMPLES";B[339]="SAMPLEFORMAT";B[340]="SMINSAMPLEVALUE";B[341]="SMAXSAMPLEVALUE";B[342]="TRANSFERRANGE";B[347]="JPEGTABLES";B[512]="JPEGPROC";B[513]="JPEGIFOFFSET";B[514]="JPEGIFBYTECOUNT";B[515]="JPEGRESTARTINTERVAL";B[517]="JPEGLOSSLESSPREDICTORS";B[518]=
"JPEGPOINTTRANSFORM";B[519]="JPEGQTABLES";B[520]="JPEGDCTABLES";B[521]="JPEGACTABLES";B[529]="YCBCRCOEFFICIENTS";B[530]="YCBCRSUBSAMPLING";B[531]="YCBCRPOSITIONING";B[532]="REFERENCEBLACKWHITE";B[700]="XMP";B[33550]="GEOPIXELSCALE";B[33922]="GEOTIEPOINTS";B[33432]="COPYRIGHT";B[42112]="GDAL_METADATA";B[42113]="GDAL_NODATA";B[50844]="RPCCOEFFICIENT";B[34264]="GEOTRANSMATRIX";B[34735]="GEOKEYDIRECTORY";B[34736]="GEODOUBLEPARAMS";B[34737]="GEOASCIIPARAMS";B[34665]="EXIFIFD";B[34853]="GPSIFD";B[40965]=
"INTEROPERABILITYIFD";return B})(),w=(()=>{const B=P.slice();B[36864]="ExifVersion";B[40960]="FlashpixVersion";B[40961]="ColorSpace";B[42240]="Gamma";B[37121]="ComponentsConfiguration";B[37122]="CompressedBitsPerPixel";B[40962]="PixelXDimension";B[40963]="PixelYDimension";B[37500]="MakerNote";B[37510]="UserComment";B[40964]="RelatedSoundFile";B[36867]="DateTimeOriginal";B[36868]="DateTimeDigitized";B[36880]="OffsetTime";B[36881]="OffsetTimeOriginal";B[36882]="OffsetTimeDigitized";B[37520]="SubSecTime";
B[37521]="SubSecTimeOriginal";B[37522]="SubSecTimeDigitized";B[37888]="Temperature";B[37889]="Humidity";B[37890]="Pressure";B[37891]="WaterDepth";B[37892]="Acceleration";B[37893]="CameraElevationAngle";B[42016]="ImageUniqueID";B[42032]="CameraOwnerName";B[42033]="BodySerialNumber";B[42034]="LensSpecification";B[42035]="LensMake";B[42036]="LensModel";B[42037]="LensSerialNumber";B[33434]="ExposureTime";B[33437]="FNumber";B[34850]="ExposureProgram";B[34852]="SpectralSensitivity";B[34855]="PhotographicSensitivity";
B[34856]="OECF";B[34864]="SensitivityType";B[34865]="StandardOutputSensitivity";B[34866]="RecommendedExposureIndex";B[34867]="ISOSpeed";B[34868]="ISOSpeedLatitudeyyy";B[34869]="ISOSpeedLatitudezzz";B[37377]="ShutterSpeedValue";B[37378]="ApertureValue";B[37379]="BrightnessValue";B[37380]="ExposureBiasValue";B[37381]="MaxApertureValue";B[37382]="SubjectDistance";B[37383]="MeteringMode";B[37384]="LightSource";B[37385]="Flash";B[37386]="FocalLength";B[37396]="SubjectArea";B[41483]="FlashEnergy";B[41484]=
"SpatialFrequencyResponse";B[41486]="FocalPlaneXResolution";B[41487]="FocalPlaneYResolution";B[41488]="FocalPlaneResolutionUnit";B[41492]="SubjectLocation";B[41493]="ExposureIndex";B[41495]="SensingMethod";B[41728]="FileSource";B[41729]="SceneType";B[41730]="CFAPattern";B[41985]="CustomRendered";B[41986]="ExposureMode";B[41987]="WhiteBalance";B[41988]="DigitalZoomRatio";B[41989]="FocalLengthIn35mmFilm";B[41990]="SceneCaptureType";B[41991]="GainControl";B[41992]="Contrast";B[41993]="Saturation";B[41994]=
"Sharpness";B[41995]="DeviceSettingDescription";B[41996]="SubjectDistanceRange";return B})(),E=(()=>{const B=[];B[1024]="GTModelTypeGeoKey";B[1025]="GTRasterTypeGeoKey";B[1026]="GTCitationGeoKey";B[2048]="GeographicTypeGeoKey";B[2049]="GeogCitationGeoKey";B[2050]="GeogGeodeticDatumGeoKey";B[2051]="GeogPrimeMeridianGeoKey";B[2052]="GeogLinearUnitsGeoKey";B[2053]="GeogLinearUnitSizeGeoKey";B[2054]="GeogAngularUnitsGeoKey";B[2055]="GeogAngularUnitSizeGeoKey";B[2056]="GeogEllipsoidGeoKey";B[2057]="GeogSemiMajorAxisGeoKey";
B[2058]="GeogSemiMinorAxisGeoKey";B[2059]="GeogInvFlatteningGeoKey";B[2061]="GeogPrimeMeridianLongGeoKey";B[2060]="GeogAzimuthUnitsGeoKey";B[3072]="ProjectedCSTypeGeoKey";B[3073]="PCSCitationGeoKey";B[3074]="ProjectionGeoKey";B[3075]="ProjCoordTransGeoKey";B[3076]="ProjLinearUnitsGeoKey";B[3077]="ProjLinearUnitSizeGeoKey";B[3078]="ProjStdParallel1GeoKey";B[3079]="ProjStdParallel2GeoKey";B[3080]="ProjNatOriginLongGeoKey";B[3081]="ProjNatOriginLatGeoKey";B[3082]="ProjFalseEastingGeoKey";B[3083]="ProjFalseNorthingGeoKey";
B[3084]="ProjFalseOriginLongGeoKey";B[3085]="ProjFalseOriginLatGeoKey";B[3086]="ProjFalseOriginEastingGeoKey";B[3087]="ProjFalseOriginNorthingGeoKey";B[3088]="ProjCenterLongGeoKey";B[3090]="ProjCenterEastingGeoKey";B[3091]="ProjCenterNorthingGeoKey";B[3092]="ProjScaleAtNatOriginGeoKey";B[3093]="ProjScaleAtCenterGeoKey";B[3094]="ProjAzimuthAngleGeoKey";B[3095]="ProjStraightVertPoleLongGeoKey";B[4096]="VerticalCSTypeGeoKey";B[4097]="VerticalCitationGeoKey";B[4098]="VerticalDatumGeoKey";B[4099]="VerticalUnitsGeoKey";
return B})(),C=new Map;C.set("EXIFIFD",w);C.set("GPSIFD","GPSVersionID GPSLatitudeRef GPSLatitude GPSLongitudeRef GPSLongitude GPSAltitudeRef GPSAltitude GPSTimeStamp GPSSatellites GPSStatus GPSMeasureMode GPSDOP GPSSpeedRef GPSSpeed GPSTrackRef GPSTrack GPSImgDirectionRef GPSImgDirection GPSMapDatum GPSDestLatitudeRef GPSDestLatitude GPSDestLongitudeRef GPSDestLongitude GPSDestBearingRef GPSDestBearing GPSDestDistanceRef GPSDestDistance GPSProcessingMethod GPSAreaInformation GPSDateStamp GPSDifferential GPSHPositioningError".split(" "));
return{TIFF_TAGS:P,ifdTags:C,GEO_KEYS:E,getTagName:(B,T)=>{T=(T||P)[B];void 0===T&&(T="unknown"+String(B));return T}}})},"esri/layers/support/rasterFormats/utils":function(){define(["exports"],function(P){const w=new ArrayBuffer(4),E=new Uint8Array(w);(new Uint32Array(w))[0]=1;P.isPlatformLittleEndian=1===E[0];Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/clipUtils":function(){define(["require","exports","../../../core/unitUtils","../../../geometry/Extent",
"../PixelBlock"],function(P,w,E,C,B){function T(K,D,G){if(!K)return K;const {width:h,height:m}=K,n=D.width/h,g=D.height/m,{xmin:c,ymax:t}=D;if("extent"===G.type){D=(G.xmin-c)/n;var A=(G.xmax-c)/n,r=(t-G.ymax)/g;G=(t-G.ymin)/g;G=[[[D,r],[D,G],[A,G],[A,r],[D,r]]]}else G=G.rings.map(f=>f.map(([d,e])=>[(d-c)/n,(t-e)/g]));D=document.createElement("canvas");D.width=h;D.height=m;const b=D.getContext("2d");b.fillStyle="#f00";G.forEach(f=>{b.beginPath();b.moveTo(f[0][0],f[0][1]);for(let d=0;d<f.length;d++)b.lineTo(f[d][0],
f[d][1]);b.closePath();b.fill()});G=b.getImageData(0,0,h,m).data;D=K.mask;A=h*m;r=new Uint8Array(A);for(let f=0;f<A;f++)if(!D||D[f])r[f]=127<G[4*f+3]?255:0;return new B({pixelType:K.pixelType,width:h,height:m,mask:r,maskIsAlpha:!1,pixels:[...K.pixels]})}function R(K,D,G){const {width:h,height:m}=K,n=new Uint8Array(h*m);var g=D.width/h,c=D.height/m;if(.5>G.width/g||.5>G.height/c)return new B({pixelType:K.pixelType,width:h,height:m,mask:n,pixels:[...K.pixels]});const {xmin:t,xmax:A,ymin:r,ymax:b}=D,
{xmin:f,xmax:d,ymin:e,ymax:q}=G;D=Math.max(t,f);var l=Math.min(A,d);G=Math.max(r,e);var a=Math.min(b,q),k=.5*g,p=.5*c;if(l-D<k||a-G<p||l<t+k||D>A-k||G>b-p||a<r+p)return new B({pixelType:K.pixelType,width:h,height:m,mask:n,pixels:[...K.pixels]});D=Math.max(0,(D-t)/g);l=Math.min(h,Math.max(0,(l-t)/g));a=Math.max(0,(b-a)/c);p=Math.min(m,Math.max(0,(b-G)/c));c=Math.round(D);g=Math.round(l)-1;k=Math.round(a);G=Math.round(p)-1;if(c===g&&.5<D%1&&.5>l%1||k===G&&.5<a%1&&.5>p%1)return new B({pixelType:K.pixelType,
width:h,height:m,mask:n,pixels:[...K.pixels]});if(0===c&&0===k&&g===h&&G===m)return K;D=K.mask;for(l=k;l<=G;l++)for(a=c;a<=g;a++)k=l*h+a,n[k]=D?D[k]:255;return new B({pixelType:K.pixelType,width:h,height:m,mask:n,pixels:[...K.pixels]})}function S(K,D,G){const {width:h,height:m}=K,n=new Uint8Array(h*m),g=D.width/h,c=D.height/m,{xmin:t,ymax:A}=D;({paths:D}=G);G=K.mask;for(let e=0;e<D.length;e++){const q=D[e];for(let l=0;l<q.length-1;l++){const [a,k]=q[l],[p,z]=q[l+1];let I=Math.floor((A-k)/c),N=Math.floor((A-
z)/c);if(N<I){var r=I;I=N;N=r}I=Math.max(0,I);N=Math.min(m-1,N);r=(p-a)/(z-k);for(let O=I;O<=N;O++){var b=O===I?Math.max(k,z):(m+1-O)*c,f=O===N?Math.min(k,z):b-c;b=z===k?Math.floor((a-t)/g):Math.floor((r*(b-k)+a-t)/g);f=z===k?Math.floor((p-t)/g):Math.floor((r*(f-k)+a-t)/g);if(f<b){var d=b;b=f;f=d}d=O*h;b=Math.max(0,b);f=Math.min(h-1,f);for(b=d+b;b<=d+f;b++)n[b]=G?G[b]:255}}}return new B({pixelType:K.pixelType,width:h,height:m,mask:n,pixels:[...K.pixels]})}w.clip=async function(K,D,G){if("extent"===
G.type)return R(K,D,G);const {width:h,height:m}=K,n=new Uint8Array(h*m),{contains:g,intersects:c}=await new Promise((t,A)=>P(["../../../geometry/geometryEngine"],t,A));return c(D,G)?"polyline"===G.type?S(K,D,G):g(G,D)?K:T(K,D,G):new B({pixelType:K.pixelType,width:h,height:m,mask:n,maskIsAlpha:!1,pixels:[...K.pixels]})};w.snapToRaster=function(K,D,G,h=!0){var {spatialReference:m}=K;if(!G.spatialReference.equals(m)){var n=E.getMetersPerUnitForSR(G.spatialReference),g=E.getMetersPerUnitForSR(m);n!==
g&&(n/=g,G={x:G.x*n,y:G.y*n})}const {x:c,y:t}=G;let {xmin:A,xmax:r,ymax:b,ymin:f}="extent"===D.type?D:D.extent;const {xmin:d,ymax:e}=K.extent;h?(A=d+(A>d?c*Math.round((A-d)/c):0),b=e-(b<e?t*Math.round((e-b)/t):0),r=d+(r>d?c*Math.round((r-d)/c):0),f=e-(f<e?t*Math.round((e-f)/t):0),m=new C({xmin:A,ymax:b,xmax:r,ymin:f,spatialReference:m}),K=Math.round(m.width/c),D=Math.round(m.height/t)):(K=Math.floor((r-A)/c+.8),D=Math.floor((b-f)/t+.8),A=d+(A>d?c*Math.floor((A-d)/c+.1):0),b=e-(b<e?t*Math.floor((e-
b)/t+.1):0),m=new C({xmin:A,ymax:b,xmax:A+K*c,ymin:b-D*t,spatialReference:m}));return{extent:m,width:K,height:D}};Object.defineProperty(w,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/rasterFunctionHelper":function(){define("exports ../../../core/colorUtils ../../../core/Error ../../../core/lang ./AspectFunction ./BandArithmeticFunction ./ColormapFunction ./CompositeBandFunction ./ConvolutionFunction ./CurvatureFunction ./ExtractBandFunction ./LocalFunction ./MaskFunction ./NDVIFunction ./RemapFunction ./SlopeFunction ./StatisticsHistogramFunction ./StretchFunction ./TableFunction".split(" "),
function(P,w,E,C,B,T,R,S,K,D,G,h,m,n,g,c,t,A,r){function b(u,y){({rasterFunctionArguments:u}=u);u&&(u.rasters||[u.raster]).forEach(x=>{x&&"number"!==typeof x&&("string"===typeof x?x.startsWith("http")&&(y.includes(x)||y.push(x)):"rasterFunctionArguments"in x&&b(x,y))})}function f(u,y){return"rasters"===y[0]&&Array.isArray(u.rasters)?u.rasters:y.map(x=>u[x])}function d(u){return!!(u&&"object"===typeof u&&u.rasterFunction&&u.rasterFunctionArguments)}function e(u){const {rasterFunction:y,rasterFunctionArguments:x}=
u,L={};for(const W in x){let v=x[W];var Q=W.toLowerCase();if("rasters"===Q&&Array.isArray(v))L.rasters=v.map(F=>d(F)?e(F):F);else switch(d(v)&&(v=e(v)),Q){case "dra":L.dra=v;break;case "pspower":L.psPower=v;break;case "pszfactor":L.psZFactor=v;break;case "bandids":L.bandIds=v;break;default:Q=W[0].toLowerCase()+W.slice(1),L[Q]=v}}"Local"!==y||L.rasters?.length||(L.rasters=["$$"]);return{...u,rasterFunctionArguments:L}}function q(u,y){const {rasterFunction:x,rasterFunctionArguments:L}=u;var Q=u.outputPixelType?.toLowerCase();
if(null==x||!H.has(x))throw new E("raster-function-helper",`unsupported raster function: ${x}`);var W=H.get(x);u=("function"===typeof W.ctor?W.ctor:W.ctor["default"]).fromJSON({...u,outputPixelType:Q});({rasterArgumentNames:Q}=u);W=[];const v=f(L,Q),F="rasters"===Q[0],J=[];for(let M=0;M<v.length;M++){const U=v[M];let V;null==U||"string"===typeof U&&U.startsWith("$")?W.push(y?.raster):"string"===typeof U?y[U]&&W.push(y[U]):"number"!==typeof U&&"rasterFunction"in U&&(V=q(U,y),F||(u.functionArguments[Q[M]]=
V),W.push(V));F&&J.push(V??U)}F&&(u.functionArguments.rasters=J);y&&(u.sourceRasters=W,y=y.raster?.url)&&(u.mainPrimaryRasterId=y);return u}function l(u,y){if(u&&y)for(const x in u){const L=u[x];L&&"object"===typeof L&&"type"in L&&("RasterFunctionTemplate"===L.type?l(L.arguments,y):"RasterFunctionVariable"===L.type&&null!=y[L.name]&&(L.value=y[L.name]))}}function a(u,y){if(!u||"object"!==typeof u)return u;const {value:x}=u;if(!x||"object"!==typeof x)return u.isDataset?"$$":x;if(Array.isArray(x))return 0===
x.length?[]:x.map(Q=>"object"===typeof Q&&"RasterFunctionVariable"===Q.type?a(Q,y):Q);if("value"in x&&["number","string","boolean"].includes(typeof x.value))return x.value;if(u.isDataset&&"Scalar"!==x.type)return"$$";if(!("type"in x))return x;u=x;switch(x.type){case "Scalar":u=x.value;break;case "AlgorithmicColorRamp":u=k(x);break;case "MultiPartColorRamp":u={type:"multipart",colorRamps:x.ArrayOfColorRamp.map(k)};break;case "ArgumentArray":if(x.elements?.length&&"RasterStatistics"!==x.elements[0].type){u=
[];for(let Q=0;Q<x.elements.length;Q++){const W=x.elements[Q];var {type:L}=W;if(L)if("RasterFunctionTemplate"===L)({renderingRule:L}=p(W,y)),u.push(L),null!=W._object_id&&y.set(W._object_id,L);else if("RasterFunctionVariable"===L)L=a(W,y),u.push(L),null!=W._object_id&&y.set(W._object_id,L);else throw new E("raster-function-helper","unsupported raster function json.");else u.push(W)}}else u=x.elements}null!=x._object_id&&y.set(x._object_id,u);return u}function k(u){const y=u.algorithm??"esriHSVAlgorithm";
let {FromColor:x,ToColor:L}=u;if(!Array.isArray(x)){const {r:Q,g:W,b:v}=w.toRGB({h:x.Hue,s:x.Saturation,v:x.Value});x=[Q,W,v,x.AlphaValue]}if(!Array.isArray(L)){const {r:Q,g:W,b:v}=w.toRGB({h:L.Hue,s:L.Saturation,v:L.Value});L=[Q,W,v,L.AlphaValue]}return{type:"algorithmic",algorithm:y,fromColor:x,toColor:L}}function p(u,y,x){x&&l(u,x);y={renderingRule:{},templates:y};z(u,y);return y}function z(u,y){if(u&&y.renderingRule){var {renderingRule:x,templates:L}=y,{function:Q,arguments:W,_object_id:v}=u;
if(Q&&W){null!=v&&L.set(v,x);x.rasterFunction=Q.type.replace("Function","");x.outputPixelType=Q.pixelType;u={};x.rasterFunctionArguments=u;for(const F in W)"type"!==F&&"object_id"!==F&&"_object_ref_id"!==F&&((y=W[F])&&"object"===typeof y&&"type"in y&&("RasterFunctionTemplate"===y.type||"RasterFunctionVariable"===y.type)?("RasterFunctionVariable"===y.type?u[F]=a(y,L):(x.rasterFunctionArguments[F]={},z(y,{renderingRule:x.rasterFunctionArguments[F],templates:L})),null!=y._object_id&&L.set(y._object_id,
u[F])):u[F]=y);u.DEM&&!u.Raster&&(u.Raster=u.DEM,delete u.DEM);switch(x.rasterFunction){case "Stretch":N(u);break;case "Colormap":"randomcolorramp"===u.ColorRamp?.type?.toLowerCase()&&(delete u.ColorRamp,u.ColormapName="Random");0===u.ColorSchemeType&&delete u.ColorRamp;break;case "Convolution":null!=u.ConvolutionType&&(u.Type=u.ConvolutionType,delete u.ConvolutionType);break;case "Mask":O(u)}}}}function I(u){const {renderingRule:y,templates:x}=u;if("object"===typeof y&&y?.rasterFunctionArguments&&
x.size){({rasterFunctionArguments:u}=y);for(const L in u){const Q=u[L],W="_object_ref_id"===L?Q:Q&&"object"===typeof Q&&"_object_ref_id"in Q?Q._object_ref_id:null;if(null!=W){if(!x.has(W))throw new E("raster-function-helper",`unsupported raster function json. _object_ref_id: ${W} does not exist`);const v=x.get(W);"_object_ref_id"!==L?u[L]=v:v&&"object"===typeof v&&Object.assign(u,v)}else Q&&"object"===typeof Q&&(Q.rasterFunctionArguments&&I({renderingRule:Q,templates:x}),Array.isArray(Q)&&Q.forEach((v,
F)=>{if("object"===typeof v)if(null!=v._object_ref_id){if(!x.has(v._object_ref_id))throw new E("raster-function-helper",`unsupported raster function json. _object_ref_id: ${Q} does not exist`);const J=x.get(W);J&&"object"===typeof J?Object.assign(v,J):Q[F]=J}else I({renderingRule:v,templates:x})}))}}}function N(u){u.Statistics?.length&&"object"===typeof u.Statistics&&(u.Statistics=u.Statistics.map(y=>[y.min,y.max,y.mean,y.standardDeviation]));null!=u.NumberOfStandardDeviation&&(u.NumberOfStandardDeviations=
u.NumberOfStandardDeviation,delete u.NumberOfStandardDeviation)}function O(u){u.NoDataValues?.length&&"string"===typeof u.NoDataValues[0]&&(u.NoDataValues=u.NoDataValues.filter(y=>""!==y).map(y=>Number(y)))}const H=new Map;H.set("Aspect",{desc:"Aspect Function",ctor:B,rasterArgumentNames:["raster"]});H.set("BandArithmetic",{desc:"Band Arithmetic Function",ctor:T,rasterArgumentNames:["raster"]});H.set("Colormap",{desc:"Colormap Function",ctor:R,rasterArgumentNames:["raster"]});H.set("CompositeBand",
{desc:"CompositeBand Function",ctor:S,rasterArgumentNames:["rasters"]});H.set("Convolution",{desc:"Convolution Function",ctor:K,rasterArgumentNames:["raster"]});H.set("ExtractBand",{desc:"ExtractBand Function",ctor:G,rasterArgumentNames:["raster"]});H.set("Curvature",{desc:"Curvature Function",ctor:D,rasterArgumentNames:["raster"]});H.set("Local",{desc:"Local Function",ctor:h,rasterArgumentNames:["rasters"]});H.set("Mask",{desc:"Mask Function",ctor:m,rasterArgumentNames:["raster"]});H.set("NDVI",
{desc:"NDVI Function",ctor:n,rasterArgumentNames:["raster"]});H.set("Remap",{desc:"Remap Function",ctor:g,rasterArgumentNames:["raster"]});H.set("Slope",{desc:"Slope Function",ctor:c,rasterArgumentNames:["raster"]});H.set("StatisticsHistogram",{desc:"Statistics Histogram Function",ctor:t,rasterArgumentNames:["raster"]});H.set("Stretch",{desc:"Stretch Function",ctor:A,rasterArgumentNames:["raster"]});H.set("Table",{desc:"Attribute Table Function",ctor:r,rasterArgumentNames:["raster"]});P.create=function(u,
y){y=y??{};u=C.clone(u);if("function"in u&&"arguments"in u&&u.arguments){const x=new Map;u=p(u,x,y);I(u);if(!u.renderingRule)throw new E("raster-function-helper","Unsupported raster function json.");u=u.renderingRule}if("rasterFunction"in u)return u=e(u),q(u,y);throw new E("raster-function-helper","unsupported raster function json.");};P.getPrimaryRasterUrls=b;P.getRasterValues=f;P.getSupportedFunctions=function(){const u=new Set;H.forEach((y,x)=>u.add(x));return u};P.register=function(u,y,x=["raster"],
L=""){H.set(u,{desc:L,ctor:y,rasterArgumentNames:x})};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/AspectFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./AspectFunctionArguments ./BaseRasterFunction ./surfaceUtils".split(" "),
function(P,w,E,C,B,T,R,S,K,D){C=function(G){function h(){var n=G.apply(this,arguments)||this;n.functionName="Aspect";n.functionArguments=null;n.rasterArgumentNames=["raster"];n.isGCS=!1;return n}P._inherits(h,G);var m=h.prototype;m._bindSourceRasters=function(){var n=this.sourceRasterInfos[0];this.isGCS=n.spatialReference?.isGeographic??!1;this.outputPixelType=this._getOutputPixelType("f32");n=n.clone();n.pixelType=this.outputPixelType;n.statistics=[{min:-1,max:360,avg:180,stddev:30}];n.histograms=
null;n.colormap=null;n.attributeTable=null;n.bandCount=1;this.rasterInfo=n;return{success:!0,supportsGPU:!0}};m._processPixels=function(n){const g=n.pixelBlocks?.[0];if(null==g)return null;const {extent:c,primaryPixelSizes:t}=n;n=t?.[0];return D.aspect(g,{resolution:null==n?c?{x:c.width/g.width,y:c.height/g.height}:{x:1,y:1}:n})};return P._createClass(h)}(K);w.__decorate([E.property({json:{write:!0,name:"rasterFunction"}})],C.prototype,"functionName",void 0);w.__decorate([E.property({type:S,json:{write:!0,
name:"rasterFunctionArguments"}})],C.prototype,"functionArguments",void 0);w.__decorate([E.property()],C.prototype,"rasterArgumentNames",void 0);w.__decorate([E.property({json:{write:!0}})],C.prototype,"isGCS",void 0);return C=w.__decorate([R.subclass("esri.layers.support.rasterFunctions.AspectFunction")],C)})},"esri/layers/support/rasterFunctions/AspectFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/Error ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(P,w,E,C,B,T,R,S,K){var D;E=D=function(G){function h(){return G.apply(this,arguments)||this}P._inherits(h,G);h.prototype.clone=function(){return new D({raster:this.raster})};return P._createClass(h)}(K);return E=D=w.__decorate([S.subclass("esri.layers.support.rasterFunctions.AspectFunctionArguments")],E)})},"esri/layers/support/rasterFunctions/BaseFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),
function(P,w,E,C,B,T,R,S){E=function(K){function D(){var G=K.apply(this,arguments)||this;G.raster=void 0;return G}P._inherits(D,K);return P._createClass(D)}(E.JSONSupport);w.__decorate([C.property({json:{write:!0}})],E.prototype,"raster",void 0);return E=w.__decorate([S.subclass("esri.layers.support.rasterFunctions.AspectFunctionArguments")],E)})},"esri/layers/support/rasterFunctions/BaseRasterFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/cast ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../PixelBlock ../RasterInfo".split(" "),
function(P,w,E,C,B,T,R,S,K,D){const G=new Set(["slope","aspect","curvature","hillshade","shadedrelief"]);E=function(h){function m(){var g=h.apply(this,arguments)||this;g.functionArguments=null;g.readingBufferSize=0;g.id=-1;g.isNoopProcess=!1;g.rawInputBandIds=[];g.isInputBandIdsSwizzled=!1;g.swizzledBandSelection=[];g.isBranch=!1;g._bindingResult=null;return g}P._inherits(m,h);var n=m.prototype;n.bind=function(g,c=!1,t=-1){this.id=t+1;t=this._getRasterValues();let A=!0;for(let b=0;b<t.length;b++){var r=
t[b];if(null!=r&&this._isRasterFunctionValue(r)){r=r.bind(g,c,this.id+b);if(!r.success)return this._bindingResult=r;A=A&&r.supportsGPU}}if(!this.rasterInfo||c)return this.sourceRasterInfos=this._getSourceRasterInfos(g),this._bindingResult=this._bindSourceRasters(),this._bindingResult.success&&this._patchRasterInfo(),this._bindingResult.supportsGPU=A&&this._bindingResult.supportsGPU,this.processInputBandIds(),this._bindingResult;this._bindingResult={success:!0,supportsGPU:!0};this.processInputBandIds();
return this._bindingResult};n.process=function(g){var c=this._getRasterValues();c=0===c.length?g.pixelBlocks??g.primaryPixelBlocks:c.map(t=>this._readRasterValue(t,g));return this._processPixels({...g,pixelBlocks:c})};n.processInputBandIds=function(){var g=this._getRasterValues().filter(this._isRasterFunctionValue);if(1<g.length)return this.rawInputBandIds=g.map(t=>t.processInputBandIds()[0]),this.isInputBandIdsSwizzled=this.rawInputBandIds.some((t,A)=>t!==A),g=g.filter(t=>"ExtractBand"===t.functionName),
g.length&&g.forEach((t,A)=>{t.isInputBandIdsSwizzled=!0;t.swizzledBandSelection=[A,A,A]}),this.rawInputBandIds;var c=g[0];if(c){if(g=c.processInputBandIds(),c.isInputBandIdsSwizzled)return this.rawInputBandIds=g}else{g=[];({bandCount:c}=this.sourceRasterInfos[0]);for(let t=0;t<c;t++)g.push(t)}g=this._getInputBandIds(g);this.isInputBandIdsSwizzled=g.some((t,A)=>t!==A);return this.rawInputBandIds=g};n.getPrimaryRasters=function(){const g=[],c=[];this._getPrimaryRasters(this,g,c);return{rasters:g,rasterIds:c}};
n.getWebGLProcessorDefinition=function(){const g=this._getWebGLParameters(),{raster:c,rasters:t}=this.functionArguments;t&&Array.isArray(t)&&t.length?(g.rasters=t.map(A=>this._isRasterFunctionValue(A)?A.getWebGLProcessorDefinition():"number"===typeof A?{name:"Constant",parameters:{value:A},pixelType:"f32",id:-1,isNoopProcess:!1}:{name:"Identity",parameters:{value:A},pixelType:"f32",id:-1,isNoopProcess:!1}),g.rasters.some(A=>null!=A)||(g.rasters=null)):this._isRasterFunctionValue(c)&&(g.raster=c.getWebGLProcessorDefinition());
return{name:this.functionName,parameters:g,pixelType:this.outputPixelType,id:this.id,isNoopProcess:this.isNoopProcess}};n._getOutputPixelType=function(g){return"unknown"===this.outputPixelType?g:this.outputPixelType??g};n._getWebGLParameters=function(){return{}};n._getInputBandIds=function(g){return g};n._isOutputRoundingNeeded=function(){const {outputPixelType:g}=this;return(g?.startsWith("u")||g?.startsWith("s"))??!1};n._getRasterValues=function(){const {rasterArgumentNames:g}=this;return"rasters"===
g[0]?this.functionArguments.rasters??[]:g.map(c=>this.functionArguments[c]).flat()};n._getSourceRasterInfos=function(g){const c=this._getRasterValues(),{rasterInfos:t,rasterIds:A}=g;if(0===c.length)return t;const r=c.map(f=>{if(f&&"object"===typeof f&&"bind"in f&&f.rasterInfo)return f.rasterInfo;if("string"===typeof f&&A.includes(f))return t[A.indexOf(f)];if("number"!==typeof f)return t[0]}),b=r.find(f=>f)??t[0];r.forEach((f,d)=>{void 0===f&&(r[d]=b)});return r};n._getPrimaryRasterId=function(g){return g?.url};
n._getPrimaryRasters=function(g,c=[],t=[]){for(let r=0;r<g.sourceRasters.length;r++){var A=g.sourceRasters[r];if("number"!==typeof A)if("bind"in A)this._getPrimaryRasters(A,c,t);else{const b=this._getPrimaryRasterId(A);null==b||t.includes(b)||(this.mainPrimaryRasterId===b?(c.unshift(A),t.unshift(b)):(c.push(A),t.push(b)))}}};n._isRasterFunctionValue=function(g){return null!=g&&"object"===typeof g&&"getWebGLProcessorDefinition"in g};n._readRasterValue=function(g,c){var {primaryPixelBlocks:t}=c;if(null==
g||"$$"===g)return g=t[0],null==g?null:g.clone();if("string"===typeof g)return g=c.primaryRasterIds.indexOf(g),-1===g?null:t[g];if("number"===typeof g){t=t[0];if(null==t)return null;const {width:A,height:r,pixelType:b,mask:f}=t;t=f?new Uint8Array(f):null;c=new Float32Array(A*r);c.fill(g);g=Array(this.sourceRasterInfos[0].bandCount).fill(c);return new K({width:A,height:r,pixelType:b,pixels:g,mask:t})}return g.process(c)};n._patchRasterInfo=function(){const {rasterInfo:g}=this;if(g?.keyProperties){var {bandCount:c,
keyProperties:t,statistics:A,histograms:r}=g,b=t.BandProperties;b&&b.length!==c&&(g.keyProperties={...t,BandProperties:void 0});A&&A.length!==c&&(g.statistics=A.length>c?A.slice(0,c):null);r&&r.length!==c&&(g.histograms=r.length>c?r.slice(0,c):null);t.BAND_COUNT&&Number(t.BAND_COUNT)!==c&&(g.keyProperties={...t,BAND_COUNT:"string"===typeof t.BAND_COUNT?String(c):c})}};P._createClass(m,[{key:"supportsGPU",get:function(){return this._bindingResult.supportsGPU}},{key:"flatWebGLFunctionChain",get:function(){var g=
this.getWebGLProcessorDefinition();if(!g)return null;const c=[g];({parameters:g}=g);for(g=g.rasters||g.raster&&[g.raster];g?.length;){c.unshift(...g);var t=[];for(var A=0;A<g.length;A++){var {parameters:r}=g[A];r=r.rasters||r.raster&&[r.raster];r?.length&&t.push(...r)}g=t}for(g=c.length-1;0<=g;g--)c[g].isNoopProcess&&c.splice(g,1);g=!1;for(t=0;t<c.length;t++)A=c[t],A.id=c.length-t-1,{rasters:A}=A.parameters,g=g||null!=A&&1<A.length;t=c.some(({name:b})=>G.has(b.toLowerCase()));return{functions:c,hasBranches:g,
hasSurfaceFunction:t}}}]);return m}(E.JSONSupport);w.__decorate([C.property({json:{write:!0}})],E.prototype,"functionName",void 0);w.__decorate([C.property({json:{write:!0}})],E.prototype,"functionArguments",void 0);w.__decorate([C.property()],E.prototype,"rasterArgumentNames",void 0);w.__decorate([C.property({json:{write:!0}}),B.cast(h=>h?.toLowerCase())],E.prototype,"outputPixelType",void 0);w.__decorate([C.property({json:{write:!0}})],E.prototype,"mainPrimaryRasterId",void 0);w.__decorate([C.property()],
E.prototype,"sourceRasters",void 0);w.__decorate([C.property({type:[D],json:{write:!0}})],E.prototype,"sourceRasterInfos",void 0);w.__decorate([C.property({json:{write:!0}})],E.prototype,"rasterInfo",void 0);w.__decorate([C.property({json:{write:!0}})],E.prototype,"readingBufferSize",void 0);w.__decorate([C.property({json:{write:!0}})],E.prototype,"id",void 0);w.__decorate([C.property()],E.prototype,"isNoopProcess",void 0);w.__decorate([C.property()],E.prototype,"supportsGPU",null);w.__decorate([C.property()],
E.prototype,"rawInputBandIds",void 0);w.__decorate([C.property()],E.prototype,"isInputBandIdsSwizzled",void 0);w.__decorate([C.property()],E.prototype,"swizzledBandSelection",void 0);w.__decorate([C.property()],E.prototype,"isBranch",void 0);w.__decorate([C.property()],E.prototype,"flatWebGLFunctionChain",null);w.__decorate([C.property()],E.prototype,"_bindingResult",void 0);return E=w.__decorate([S.subclass("esri.layers.support.rasterFunctions.BaseRasterFunction")],E)})},"esri/layers/support/RasterInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../geometry/Extent ../../geometry/SpatialReference ./RasterBandInfo ./RasterSensorInfo ./RasterStorageInfo".split(" "),
function(P,w,E,C,B,T,R,S,K,D,G,h){var m;E=m=function(n){function g(c){c=n.call(this,c)||this;c.attributeTable=null;c.bandCount=null;c.colormap=null;c.extent=null;c.format=void 0;c.height=null;c.width=null;c.histograms=null;c.keyProperties={};c.multidimensionalInfo=null;c.noDataValue=null;c.pixelSize=null;c.pixelType=null;c.isPseudoSpatialReference=!1;c.spatialReference=null;c.statistics=null;c.storageInfo=null;c.transform=null;return c}P._inherits(g,n);g.prototype.clone=function(){return new m({attributeTable:C.clone(this.attributeTable),
bandCount:this.bandCount,colormap:C.clone(this.colormap),extent:C.clone(this.extent),nativePixelSize:C.clone(this.nativePixelSize),format:this.format,height:this.height,width:this.width,histograms:C.clone(this.histograms),keyProperties:C.clone(this.keyProperties),multidimensionalInfo:C.clone(this.multidimensionalInfo),noDataValue:this.noDataValue,pixelSize:C.clone(this.pixelSize),pixelType:this.pixelType,isPseudoSpatialReference:this.isPseudoSpatialReference,spatialReference:C.clone(this.spatialReference),
statistics:C.clone(this.statistics),storageInfo:C.clone(this.storageInfo),transform:C.clone(this.transform)})};P._createClass(g,[{key:"bandInfos",get:function(){var c=this.keyProperties.BandProperties;if(!c?.length){c=[];for(var t=1;t<=this.bandCount;t++)c.push(new D({name:"band_"+t}));return c}c=c.map(A=>D.fromJSON(A));for(t=0;t<c.length;t++)c[t].name=c[t].name??"band_"+(t+1);return c}},{key:"dataType",get:function(){const c=this.keyProperties?.DataType?.toLowerCase()??"generic";return"stdtime"===
c?"standard-time":c}},{key:"nativeExtent",get:function(){return this._get("nativeExtent")||this.extent},set:function(c){c&&this._set("nativeExtent",c)}},{key:"nativePixelSize",get:function(){if(null==this.transform||!this.transform.affectsPixelSize)return this.pixelSize;const c=this.nativeExtent;return{x:c.width/this.width,y:c.height/this.height}}},{key:"hasMultidimensionalTranspose",get:function(){return!!this.storageInfo?.transposeInfo}},{key:"sensorInfo",get:function(){if(this.keyProperties?.SensorName)return G.fromJSON(this.keyProperties)}}]);
return g}(E.JSONSupport);w.__decorate([B.property({json:{write:!0}})],E.prototype,"attributeTable",void 0);w.__decorate([B.property({json:{write:!0}})],E.prototype,"bandCount",void 0);w.__decorate([B.property({readOnly:!0})],E.prototype,"bandInfos",null);w.__decorate([B.property({json:{write:!0}})],E.prototype,"colormap",void 0);w.__decorate([B.property({type:String,readOnly:!0})],E.prototype,"dataType",null);w.__decorate([B.property({type:S,json:{write:!0}})],E.prototype,"extent",void 0);w.__decorate([B.property({type:S,
json:{write:!0}})],E.prototype,"nativeExtent",null);w.__decorate([B.property({json:{write:!0}})],E.prototype,"nativePixelSize",null);w.__decorate([B.property({json:{write:!0}})],E.prototype,"format",void 0);w.__decorate([B.property({json:{write:!0}})],E.prototype,"height",void 0);w.__decorate([B.property({json:{write:!0}})],E.prototype,"width",void 0);w.__decorate([B.property({json:{write:!0}})],E.prototype,"hasMultidimensionalTranspose",null);w.__decorate([B.property({json:{write:!0}})],E.prototype,
"histograms",void 0);w.__decorate([B.property({json:{write:!0}})],E.prototype,"keyProperties",void 0);w.__decorate([B.property({json:{write:!0}})],E.prototype,"multidimensionalInfo",void 0);w.__decorate([B.property({json:{write:!0}})],E.prototype,"noDataValue",void 0);w.__decorate([B.property({json:{write:!0}})],E.prototype,"pixelSize",void 0);w.__decorate([B.property({json:{write:!0}})],E.prototype,"pixelType",void 0);w.__decorate([B.property()],E.prototype,"isPseudoSpatialReference",void 0);w.__decorate([B.property({readOnly:!0})],
E.prototype,"sensorInfo",null);w.__decorate([B.property({type:K,json:{write:!0}})],E.prototype,"spatialReference",void 0);w.__decorate([B.property({json:{write:!0}})],E.prototype,"statistics",void 0);w.__decorate([B.property({type:h,json:{write:!0}})],E.prototype,"storageInfo",void 0);w.__decorate([B.property({json:{write:!0}})],E.prototype,"transform",void 0);return E=m=w.__decorate([R.subclass("esri.layers.support.RasterInfo")],E)})},"esri/layers/support/RasterBandInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(P,w,E,C,B,T,R,S){function K(G){G=Number(G);return isNaN(G)?void 0:G}var D;E=D=function(G){function h(){var m=G.apply(this,arguments)||this;m.name=null;m.minWavelength=void 0;m.maxWavelength=void 0;m.radianceBias=void 0;m.radianceGain=void 0;m.reflectanceBias=void 0;m.reflectanceGain=void 0;m.solarIrradiance=void 0;return m}P._inherits(h,G);h.prototype.clone=function(){return new D({name:this.name,minWavelength:this.minWavelength,maxWavelength:this.maxWavelength,radianceBias:this.radianceBias,
radianceGain:this.radianceGain,reflectanceBias:this.reflectanceBias,reflectanceGain:this.reflectanceGain,solarIrradiance:this.solarIrradiance})};return P._createClass(h)}(E.JSONSupport);w.__decorate([C.property({json:{name:"BandName",write:!0}})],E.prototype,"name",void 0);w.__decorate([C.property({json:{name:"WavelengthMin",read:{reader:K},write:!0}})],E.prototype,"minWavelength",void 0);w.__decorate([C.property({json:{name:"WavelengthMax",read:{reader:K},write:!0}})],E.prototype,"maxWavelength",
void 0);w.__decorate([C.property({json:{name:"RadianceBias",read:{reader:K},write:!0}})],E.prototype,"radianceBias",void 0);w.__decorate([C.property({json:{name:"RadianceGain",read:{reader:K},write:!0}})],E.prototype,"radianceGain",void 0);w.__decorate([C.property({json:{name:"ReflectanceBias",read:{reader:K},write:!0}})],E.prototype,"reflectanceBias",void 0);w.__decorate([C.property({json:{name:"ReflectanceGain",read:{reader:K},write:!0}})],E.prototype,"reflectanceGain",void 0);w.__decorate([C.property({json:{name:"SolarIrradiance",
read:{reader:K},write:!0}})],E.prototype,"solarIrradiance",void 0);return E=D=w.__decorate([S.subclass("esri.layers.support.RasterBandInfo")],E)})},"esri/layers/support/RasterSensorInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer".split(" "),
function(P,w,E,C,B,T,R,S,K,D){function G(m){m=Number(m);return isNaN(m)?void 0:m}var h;E=h=function(m){function n(){var c=m.apply(this,arguments)||this;c.acquisitionDate=void 0;c.cloudCover=void 0;c.productName=void 0;c.sensorName=null;c.sensorAzimuth=void 0;c.sensorElevation=void 0;c.sunAzimuth=void 0;c.sunElevation=void 0;return c}P._inherits(n,m);var g=n.prototype;g.readAcquisitionDate=function(c){return new Date(c)};g.writeAcquisitionDate=function(c,t){t.AcquisitionDate=c.getTime()};g.clone=function(){return new h({acquisitionDate:this.acquisitionDate,
cloudCover:this.cloudCover,productName:this.productName,sensorName:this.sensorName,sensorAzimuth:this.sensorAzimuth,sensorElevation:this.sensorElevation,sunAzimuth:this.sunAzimuth,sunElevation:this.sunElevation})};return P._createClass(n)}(E.JSONSupport);w.__decorate([C.property({json:{name:"AcquisitionDate",write:!0}})],E.prototype,"acquisitionDate",void 0);w.__decorate([S.reader("acquisitionDate")],E.prototype,"readAcquisitionDate",null);w.__decorate([D.writer("acquisitionDate")],E.prototype,"writeAcquisitionDate",
null);w.__decorate([C.property({json:{name:"CloudCover",read:{reader:G},write:!0}})],E.prototype,"cloudCover",void 0);w.__decorate([C.property({json:{name:"ProductName",write:!0}})],E.prototype,"productName",void 0);w.__decorate([C.property({json:{name:"SensorName",write:!0}})],E.prototype,"sensorName",void 0);w.__decorate([C.property({json:{name:"SensorAzimuth",read:{reader:G},write:!0}})],E.prototype,"sensorAzimuth",void 0);w.__decorate([C.property({json:{name:"SensorElevation",read:{reader:G},
write:!0}})],E.prototype,"sensorElevation",void 0);w.__decorate([C.property({json:{name:"SunAzimuth",read:{reader:G},write:!0}})],E.prototype,"sunAzimuth",void 0);w.__decorate([C.property({json:{name:"SunElevation",read:{reader:G},write:!0}})],E.prototype,"sunElevation",void 0);return E=h=w.__decorate([K.subclass("esri.layers.support.RasterSensorInfo")],E)})},"esri/layers/support/rasterFunctions/surfaceUtils":function(){define(["exports","../PixelBlock","./pixelUtils"],function(P,w,E){function C(S){let {altitude:K,
azimuth:D}=S;const {hillshadeType:G,pixelSizePower:h=1,pixelSizeFactor:m=1,scalingType:n,isGCS:g,resolution:c}=S;var t="multi-directional"===G?2*S.zFactor:S.zFactor;const {x:A,y:r}=c;S=t/(8*A);var b=t/(8*r);g&&.001<t&&(S/=R,b/=R);"adjusted"===n&&(g?(S=A*R,b=r*R,S=(t+S**h*m)/(8*S),b=(t+b**h*m)/(8*b)):(S=(t+A**h*m)/(8*A),b=(t+r**h*m)/(8*r)));var f=(90-K)*Math.PI/180;t=Math.cos(f);let d=(360-D+90)*Math.PI/180,e=Math.sin(f)*Math.cos(d);f=Math.sin(f)*Math.sin(d);const q=[315,270,225,360,180,0],l=[60,60,
60,60,60,90];var a=new Float32Array([3,5,3,2,1,4]);const k=a.reduce((O,H)=>O+H);a=a.map(O=>O/k);const p="multi-directional"===G?q.length:1,z=new Float32Array(6),I=new Float32Array(6),N=new Float32Array(6);if("multi-directional"===G)for(let O=0;O<p;O++)K=l[O],D=q[O],f=(90-K)*Math.PI/180,t=Math.cos(f),d=(360-D+90)*Math.PI/180,e=Math.sin(f)*Math.cos(d),f=Math.sin(f)*Math.sin(d),z[O]=t,I[O]=e,N[O]=f;else z.fill(t),I.fill(e),N.fill(f);return{resolution:c,factor:[S,b],sinZcosA:e,sinZsinA:f,cosZ:t,sinZcosAs:I,
sinZsinAs:N,cosZs:z,weights:a,hillshadeType:["traditional","multi-directional"].indexOf(G)}}function B(S,K){const {width:D,height:G}=S;var h=D*G;const m=new Uint8Array(h),n=null!=S.mask;let g;if(n){g=new Uint8Array(S.mask);for(var c=0;c<g.length;c++)g[c]&&(m[c]=1,g[c]=1)}S=S.pixels[0];c=new Float32Array(h);const t=new Float32Array(h);let A=0;if(K){({resolution:r}=K);var r=r?(r.x+r.y)/2:1;A=200*K.zFactor/(r*r);r=new Float32Array(h)}K=K?.curvatureType;let b;let f;for(h=1;h<G-1;h++){const z=h*D;for(let I=
1;I<D-1;I++){const N=z+I;if(!g||0!==g[N]){if(g){if(7>g[N-D-1]+g[N-D]+g[N-D+1]+g[N-1]+g[N+1]+g[N+D-1]+g[N+D]+g[N+D+1]){m[N]=0;continue}var d=g[N-D-1]?S[N-D-1]:S[N];var e=g[N-D]?S[N-D]:S[N];var q=g[N-D+1]?S[N-D+1]:S[N];var l=g[N-1]?S[N-1]:S[N];var a=g[N+1]?S[N+1]:S[N];b=g[N+D-1]?S[N+D-1]:S[N];var k=g[N+D]?S[N+D]:S[N];f=g[N+D+1]?S[N+D+1]:S[N]}else d=S[N-D-1],e=S[N-D],q=S[N-D+1],l=S[N-1],a=S[N+1],b=S[N+D-1],k=S[N+D],f=S[N+D+1];c[N]=q+a+a+f-(d+l+l+b);t[N]=b+k+k+f-(d+e+e+q);if(null!=r){var p=S[N];const O=
.5*(l+a)-p;p=.5*(e+k)-p;"standard"===K?r[N]=-A*(O+p):(d=(-d+q+b-f)/4,l=(-l+a)/2,e=(e-k)/2,k=l*l,a=e*e,(q=k+a)&&(r[N]="profile"===K?A*(O*k+p*a+d*l*e)/q:-A*(O*a+p*k-d*l*e)/q))}}}}return{outMask:n?m:null,dzxs:c,dzys:t,curvatures:r}}function T(S,K,D){for(var G=0;G<D;G++)S[G*K]=S[G*K+1],S[(G+1)*K-1]=S[(G+1)*K-2];for(G=1;G<K-1;G++)S[G]=S[G+K],S[G+(D-1)*K]=S[G+(D-2)*K]}const R=1/111E3;P.GCS_FACTOR=R;P.aspect=function(S,K={}){if(!E.isValidPixelBlock(S))return S;var {resolution:D}=K;K=D?1/D.x:1;D=D?1/D.y:
1;const {dzxs:G,dzys:h,outMask:m}=B(S),{width:n,height:g}=S,c=new Float32Array(n*g);for(let A=1;A<g-1;A++){const r=A*n;for(let b=1;b<n-1;b++){var t=r+b;if(!m||m[t]){const f=G[t]*K;t=h[t]*D;let d=-1;if(0!==f||0!==t)d=90-57.29578*Math.atan2(t,-f),0>d&&(d+=360),360===d?d=0:360<d&&(d%=360);c[r+b]=d}}}T(c,n,g);return new w({width:n,height:g,pixels:[c],mask:m,pixelType:"f32",validPixelCount:S.validPixelCount,statistics:[{minValue:-1,maxValue:360}]})};P.calculateHillshadeParams=C;P.curvature=function(S,
K){if(!E.isValidPixelBlock(S))return S;const {curvatures:D,outMask:G}=B(S,K),{width:h,height:m}=S;T(D,h,m);S=new w({width:h,height:m,pixels:[D],mask:G,pixelType:"f32",validPixelCount:S.validPixelCount});S.updateStatistics();return S};P.hillshade=function(S,K){if(!E.isValidPixelBlock(S))return S;const {factor:D,sinZcosA:G,sinZsinA:h,cosZ:m,sinZcosAs:n,sinZsinAs:g,cosZs:c,weights:t}=C(K),[A,r]=D;K="traditional"===K.hillshadeType;const {width:b,height:f}=S,d=new Uint8Array(b*f),{dzxs:e,dzys:q,outMask:l}=
B(S);for(let k=1;k<f-1;k++){const p=k*b;for(let z=1;z<b-1;z++){const I=p+z;if(!l||l[I]){var a=e[I]*A;const N=q[I]*r,O=Math.sqrt(1+a*a+N*N);let H=0;if(K)a=255*(m+h*N-G*a)/O,0>a&&(a=0),H=a;else{const u=g.length;for(let y=0;y<u;y++){let x=255*(c[y]+g[y]*N-n[y]*a)/O;0>x&&(x=0);H+=x*t[y]}}d[I]=H&255}}}T(d,b,f);return new w({width:b,height:f,pixels:[d],mask:l,pixelType:"u8",validPixelCount:S.validPixelCount,statistics:[{minValue:0,maxValue:255}]})};P.slope=function(S,K){if(!E.isValidPixelBlock(S))return S;
var D=K.zFactor,G=K.pixelSizePower??1,h=K.pixelSizeFactor??1;const m=K.slopeType;var n=K.isGCS;const {x:g,y:c}=K.resolution;K=D/(8*g);let t=D/(8*c);n&&1E-4>Math.abs(D-1)&&(K/=R,t/=R);"adjusted"===m&&(K=(D+g**G*h)/(8*g),t=(D+c**G*h)/(8*c));const {dzxs:A,dzys:r,outMask:b}=B(S),{width:f,height:d}=S;D=new Float32Array(f*d);for(G=1;G<d-1;G++)for(h=G*f,n=1;n<f-1;n++){var e=h+n;if(!b||b[e]){var q=A[e]*K;e=r[e]*t;q=Math.sqrt(q*q+e*e);D[h+n]="percent-rise"===m?100*q:57.2957795*Math.atan(q)}}T(D,f,d);S=new w({width:f,
height:d,pixels:[D],mask:b,pixelType:"f32",validPixelCount:S.validPixelCount});S.updateStatistics();return S};P.tintHillshade=function(S,K,D,G){if(E.isValidPixelBlock(S)&&E.isValidPixelBlock(K)){var {min:h,max:m}=G;G=S.pixels[0];var {pixels:n,mask:g}=K;K=n[0];var c=255.00001/(m-h),t=new Uint8ClampedArray(K.length),A=new Uint8ClampedArray(K.length),r=new Uint8ClampedArray(K.length),b=D.length-1;for(let e=0;e<K.length;e++){if(g&&0===g[e])continue;var f=Math.floor((K[e]-h)*c);const [q,l]=D[0>f?0:f>b?
b:f];var d=G[e];f=d*l;const a=f*(1-Math.abs(q%2-1));d-=f;switch(Math.floor(q)){case 0:t[e]=f+d;A[e]=a+d;r[e]=d;break;case 1:t[e]=a+d;A[e]=f+d;r[e]=d;break;case 2:t[e]=d;A[e]=f+d;r[e]=a+d;break;case 3:t[e]=d;A[e]=a+d;r[e]=f+d;break;case 4:t[e]=a+d;A[e]=d;r[e]=f+d;break;case 5:case 6:t[e]=f+d,A[e]=d,r[e]=a+d}}S.pixels=[t,A,r];S.updateStatistics()}};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/BandArithmeticFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BandArithmeticFunctionArguments ./bandIndexUtils ./BaseRasterFunction".split(" "),
function(P,w,E,C,B,T,R,S,K,D){const G=new Set(["vari","mtvi2","rtvi-core","evi"]);C=function(h){function m(){var g=h.apply(this,arguments)||this;g.functionName="BandArithmetic";g.functionArguments=null;g.rasterArgumentNames=["raster"];return g}P._inherits(m,h);var n=m.prototype;n._bindSourceRasters=function(){this.outputPixelType=this._getOutputPixelType("f32");var g=this.sourceRasterInfos[0];if(2>g.bandCount)return{success:!1,supportsGPU:!1,error:"band-arithmetic-function: source raster has insufficient amount of raster bands"};
g=g.clone();g.pixelType=this.outputPixelType;g.statistics=null;g.histograms=null;g.bandCount="sultan"===this.functionArguments.method?3:1;g.keyProperties={...g.keyProperties,BandProperties:void 0};this.rasterInfo=g;return{success:!0,supportsGPU:!["custom","gvitm","sultan"].includes(this.functionArguments.method)}};n._processPixels=function(g){g=g.pixelBlocks?.[0];if(null==g)return g;const {method:c,bandIndexes:t}=this.functionArguments,A=t.split(" ").map(r=>parseFloat(r));return K.calculateBandIndex(g,
{method:c,bandIndexes:A,equation:t})};n._getWebGLParameters=function(){const g=this.functionArguments.bandIndexes.split(" ").map(r=>parseFloat(r)-1);2===g.length&&g.push(0);var c=this.isInputBandIdsSwizzled?[0,1,2]:g;const t=new Float32Array(3);({method:A}=this.functionArguments);switch(A){case "gndvi":case "nbr":case "ndbi":case "ndvi":case "ndvi-re":case "ndsi":case "ndmi":case "mndwi":c=K.getBandMatrix3([c[0],c[1],0]);var A="ndxi";break;case "ndwi":c=K.getBandMatrix3([c[1],c[0],0]);A="ndxi";break;
case "sr":case "sr-re":case "iron-oxide":case "ferrous-minerals":case "clay-minerals":c=K.getBandMatrix3([c[0],c[1],0]);A="sr";break;case "ci-g":case "ci-re":c=K.getBandMatrix3([c[0],c[1],0]);A="ci";break;case "savi":c=K.getBandMatrix3([c[0],c[1],0]);A="savi";t[0]=g[2]+1;break;case "tsavi":c=K.getBandMatrix3([c[0],c[1],0]);A="tsavi";t[0]=g[2]+1;t[1]=g[3]+1;t[2]=g[4]+1;break;case "msavi":c=K.getBandMatrix3([c[0],c[1],0]);A="msavi";break;case "gemi":c=K.getBandMatrix3([c[0],c[1],0]);A="gemi";break;
case "pvi":c=K.getBandMatrix3([c[0],c[1],0]);A="tsavi";t[0]=g[2]+1;t[1]=g[3]+1;break;case "vari":c=K.getBandMatrix3([c[0],c[1],c[2]]);A="vari";break;case "mtvi2":c=K.getBandMatrix3([c[0],c[1],c[2]]);A="mtvi2";break;case "rtvi-core":c=K.getBandMatrix3([c[0],c[1],c[2]]);A="rtvicore";break;case "evi":c=K.getBandMatrix3([c[0],c[1],c[2]]);A="evi";break;case "wndwi":c=K.getBandMatrix3([c[0],c[1],0]);A="wndwi";t[0]=g[3]?g[3]+1:.5;break;case "bai":c=K.getBandMatrix3([c[1],c[0],0]);A="bai";break;default:c=
K.getBandMatrix3([0,1,2]),A="custom"}return{bandIndexMat3:c,indexType:A,adjustments:t}};n._getInputBandIds=function(g){if("custom"===this.functionArguments.method)return g;var c=this.functionArguments.bandIndexes.split(" ").map(r=>parseFloat(r)-1);const t=g.length;c=c.map(r=>r>=t?t-1:r);const A=G.has(this.functionArguments.method)?3:2;c=c.slice(0,A).map(r=>g[r]);2===c.length&&c.push(0);return c};return P._createClass(m)}(D);w.__decorate([E.property({json:{write:!0,name:"rasterFunction"}})],C.prototype,
"functionName",void 0);w.__decorate([E.property({type:S,json:{write:!0,name:"rasterFunctionArguments"}})],C.prototype,"functionArguments",void 0);w.__decorate([E.property()],C.prototype,"rasterArgumentNames",void 0);return C=w.__decorate([R.subclass("esri.layers.support.rasterFunctions.BandArithmeticFunction")],C)})},"esri/layers/support/rasterFunctions/BandArithmeticFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./bandIndexUtils ./BaseFunctionArguments".split(" "),
function(P,w,E,C,B,T,R,S,K){var D;B=D=function(G){function h(){var m=G.apply(this,arguments)||this;m.method="custom";return m}P._inherits(h,G);h.prototype.clone=function(){return new D({method:this.method,bandIndexes:this.bandIndexes,raster:E.clone(this.raster)})};return P._createClass(h)}(K);w.__decorate([C.property({json:{type:String,write:!0}})],B.prototype,"bandIndexes",void 0);w.__decorate([T.enumeration(S.bandIndexMethodMap)],B.prototype,"method",void 0);return B=D=w.__decorate([R.subclass("esri.layers.support.rasterFunctions.BandArithmeticFunctionArguments")],
B)})},"esri/layers/support/rasterFunctions/bandIndexUtils":function(){define(["exports","../../../core/jsonMap","../PixelBlock","./customBandIndexUtils","./pixelUtils"],function(P,w,E,C,B){function T(d,e,q){const l=q.length,a=new Float32Array(l);for(let k=0;k<l;k++)if(null==d||d[k]){const p=e[k],z=q[k],I=p+z;I&&(a[k]=(p-z)/I)}return[a]}function R(d,e,q){const l=q.length,a=new Float32Array(l);for(let k=0;k<l;k++)if(null==d||d[k]){const p=e[k],z=q[k];z&&(a[k]=p/z)}return[a]}function S(d,e,q){const l=
e.length,a=new Float32Array(l);for(let k=0;k<l;k++)if(null==d||d[k]){const p=e[k],z=q[k];z&&(a[k]=p/z-1)}return[a]}function K(d,e,q,l){const a=q.length,k=new Float32Array(a);for(let p=0;p<a;p++)if(null==d||d[p]){const z=q[p],I=e[p],N=I+z+l;N&&(k[p]=(I-z)/N*(1+l))}return[k]}function D(d,e,q,l,a,k){const p=q.length,z=new Float32Array(p);k=-a*l+k*(1+l*l);for(let I=0;I<p;I++)if(null==d||d[I]){const N=q[I],O=e[I],H=a*O+N+k;H&&(z[I]=l*(O-l*N-a)/H)}return[z]}function G(d,e,q){const l=q.length,a=new Float32Array(l);
for(let k=0;k<l;k++)if(null==d||d[k]){const p=e[k];a[k]=.5*(2*(p+1)-Math.sqrt((2*p+1)**2-8*(p-q[k])))}return[a]}function h(d,e,q){const l=q.length,a=new Float32Array(l);for(let p=0;p<l;p++)if(null==d||d[p]){const z=q[p];var k=e[p];1!==z&&(k=(2*(k*k-z*z)+1.5*k+.5*z)/(k+z+.5),a[p]=k*(1-.25*k)-(z-.125)/(1-z))}return[a]}function m(d,e,q,l,a){const k=q.length,p=new Float32Array(k),z=Math.sqrt(1+l*l);for(let I=0;I<k;I++)if(null==d||d[I])p[I]=(e[I]-l*q[I]-a)/z;return[p]}function n(d,e){const [q,l,a,k,p,
z]=e;e=q.length;const I=new Float32Array(e);for(let N=0;N<e;N++)if(null==d||d[N])I[N]=-.2848*q[N]-.2435*l[N]-.5436*a[N]+.7243*k[N]+.084*p[N]-1.18*z[N];return[I]}function g(d,e){const [q,,l,a,k,p]=e;e=q.length;const z=new Float32Array(e),I=new Float32Array(e),N=new Float32Array(e);for(let O=0;O<e;O++)if(null==d||d[O])z[O]=p[O]?k[O]/p[O]*100:0,I[O]=q[O]?k[O]/q[O]*100:0,N[O]=a[O]?l[O]/a[O]*(k[O]/a[O])*100:0;return[z,I,N]}function c(d,e){const [q,l,a]=e;e=q.length;const k=new Float32Array(e);for(let p=
0;p<e;p++)if(null==d||d[p])for(p=0;p<e;p++){const z=q[p],I=l[p],N=I+z-a[p];N&&(k[p]=(I-z)/N)}return[k]}function t(d,e){const [q,l,a]=e;e=q.length;const k=new Float32Array(e);for(let p=0;p<e;p++)if(null==d||d[p])for(p=0;p<e;p++){const z=q[p],I=l[p],N=a[p];k[p]=1.5*(1.2*(z-N)-2.5*(I-N))*Math.sqrt((2*z+1)**2-6*z-5*Math.sqrt(I)-.5)}return[k]}function A(d,e){const [q,l,a]=e;e=q.length;const k=new Float32Array(e);for(let p=0;p<e;p++)if(null==d||d[p])for(p=0;p<e;p++){const z=q[p];k[p]=100*(z-l[p])-10*(z-
a[p])}return[k]}function r(d,e){const [q,l,a]=e;e=q.length;const k=new Float32Array(e);for(let p=0;p<e;p++)if(null==d||d[p])for(p=0;p<e;p++){const z=q[p],I=l[p],N=z+6*I-7.5*a[p]+1;N&&(k[p]=2.5*(z-I)/N)}return[k]}function b(d,e,q=.5){const [l,a,k]=e;e=a.length;const p=new Float32Array(e);for(let z=0;z<e;z++)if(null==d||d[z])for(z=0;z<e;z++){const I=l[z],N=a[z],O=k[z],H=I+q*N+(1-q)*O;H&&(p[z]=(I-q*N-(1-q)*O)/H)}return[p]}function f(d,e,q){const l=q.length,a=new Float32Array(l);for(let k=0;k<l;k++)if(null==
d||d[k])for(k=0;k<l;k++){const p=(.1-e[k])**2+(.06-q[k])**2;p&&(a[k]=1/p)}return[a]}w=new w.JSONMap({0:"custom",1:"ndvi",2:"savi",3:"tsavi",4:"msavi",5:"gemi",6:"pvi",7:"gvitm",8:"sultan",9:"vari",10:"gndvi",11:"sr",12:"ndvi-re",13:"sr-re",14:"mtvi2",15:"rtvi-core",16:"ci-re",17:"ci-g",18:"ndwi",19:"evi",20:"iron-oxide",21:"ferrous-minerals",22:"clay-minerals",23:"wndwi",24:"bai",25:"nbr",26:"ndbi",27:"ndmi",28:"ndsi",29:"mndwi"},{useNumericKeys:!0});P.bandIndexMethodMap=w;P.calculateBandIndex=function(d,
e){if(!B.isValidPixelBlock(d))return d;const {equation:q,method:l}=e;e=e.bandIndexes.map(z=>z-1);const {pixels:a,mask:k}=d;switch(l){case "gndvi":case "nbr":case "ndbi":case "ndvi":case "ndvi-re":case "ndsi":case "ndmi":case "mndwi":e=T(k,a[e[0]],a[e[1]]);break;case "ndwi":e=T(k,a[e[1]],a[e[0]]);break;case "sr":case "sr-re":case "iron-oxide":case "ferrous-minerals":case "clay-minerals":e=R(k,a[e[0]],a[e[1]]);break;case "ci-g":case "ci-re":e=S(k,a[e[0]],a[e[1]]);break;case "savi":e=K(k,a[e[0]],a[e[1]],
e[2]+1);break;case "tsavi":e=D(k,a[e[0]],a[e[1]],e[2]+1,e[3]+1,e[4]+1);break;case "msavi":e=G(k,a[e[0]],a[e[1]]);break;case "gemi":e=h(k,a[e[0]],a[e[1]]);break;case "pvi":e=m(k,a[e[0]],a[e[1]],e[2]+1,e[3]+1);break;case "gvitm":e=n(k,[a[e[0]],a[e[1]],a[e[2]],a[e[3]],a[e[4]],a[e[5]]]);break;case "sultan":e=g(k,[a[e[0]],a[e[1]],a[e[2]],a[e[3]],a[e[4]],a[e[5]]]);break;case "vari":e=c(k,[a[e[0]],a[e[1]],a[e[2]]]);break;case "mtvi2":e=t(k,[a[e[0]],a[e[1]],a[e[2]]]);break;case "rtvi-core":e=A(k,[a[e[0]],
a[e[1]],a[e[2]]]);break;case "evi":e=r(k,[a[e[0]],a[e[1]],a[e[2]]]);break;case "wndwi":e=b(k,[a[e[0]],a[e[1]],a[e[2]]],e[3]?e[3]+1:.5);break;case "bai":e=f(k,a[e[0]],a[e[1]]);break;case "custom":e=C.calculateCustomBandIndex(k,a,q);break;default:return d}const p=null!=k?new Uint8Array(k.length):null;null!=k&&null!=p&&p.set(k);d=new E({width:d.width,height:d.height,pixelType:"f32",pixels:e,mask:p});d.updateStatistics();return d};P.calculateNDVI=function(d,e,q,l){const {mask:a,pixels:k,width:p,height:z}=
d;d=k[q];e=k[e];q=e.length;const I=l?new Uint8Array(q):new Float32Array(q),N=l?100:1,O=l?100.5:0;for(let H=0;H<q;H++)if(null==a||a[H]){const u=d[H],y=e[H],x=u+y;x&&(I[H]=(u-y)/x*N+O)}l=new E({width:p,height:z,mask:a,pixelType:l?"u8":"f32",pixels:[I]});l.updateStatistics();return l};P.getBandMatrix3=function(d){const e=new Float32Array(9);e[3*d[0]]=1;e[3*d[1]+1]=1;e[3*d[2]+2]=1;return e};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/customBandIndexUtils":function(){define(["exports",
"../../../core/has"],function(P,w){const E=new Set("+-*/()".split(""));P.calculateCustomBandIndex=function(C,B,T){T=T.replaceAll(" ","");T.startsWith("-")&&(T="0"+T);T.startsWith("+")&&(T=T.slice(1,T.length));T=T.split("");var R=[],S=[],K="";for(var D=0;D<T.length;D++){const n=T[D];E.has(n)?(""!==K&&S.push(parseFloat(K)),R.push(n),K=""):"b"===n.toLowerCase()?(D++,K=n.concat(T[D]),S.push(B[parseInt(K[1],10)-1]),K=""):(K=K.concat(n),D===T.length-1&&S.push(parseFloat(K)))}let {ops:G,nums:h}={ops:R,nums:S};
if(0===G.length){C=1===h.length?h[0]:B[0];if(C instanceof Float32Array)return[C];var m=new Float32Array(B[0].length);"number"===typeof C?m.fill(C):m.set(C);return[m]}for(;0<G.length;){m=G;if(1===m.length)m={opIndex:0,numIndex:0};else{R=T=0;for(B=0;B<m.length;B++)if("("===m[B])T=B;else if(")"===m[B]){R=B;break}S=0===R?m:m.slice(T+1,R);B=-1;for(K=0;K<S.length;K++)if("*"===S[K]||"/"===S[K]){B=K;break}if(!(-1<B))for(K=0;K<S.length;K++)if("+"===S[K]||"-"===S[K]){B=K;break}0<R&&(B+=T+1);T=0;for(R=0;R<B;R++)"("===
m[R]&&T++;m={opIndex:B,numIndex:B-T}}const {numIndex:n,opIndex:g}=m;R=T=B=void 0;m=C;K=G[g];S=h[n];D=h[n+1];if("number"===typeof S&&"number"===typeof D)m=S+D;else{"number"===typeof S?(B=D,R=B.length,T=new Float32Array(R),T.fill(S)):(R=S.length,T=S,D.constructor===Number?(B=new Float32Array(R),B.fill(D)):B=D);S=new Float32Array(R);switch(K){case "+":for(K=0;K<R;K++)if(null==m||m[K])S[K]=T[K]+B[K];break;case "-":for(K=0;K<R;K++)if(null==m||m[K])S[K]=T[K]-B[K];break;case "*":for(K=0;K<R;K++)if(null==
m||m[K])S[K]=T[K]*B[K];break;case "/":for(K=0;K<R;K++)(null==m||m[K])&&B[K]&&(S[K]=T[K]/B[K]);break;case "(":case ")":throw Error("encountered error with custom band index equation");}m=S}if(1===G.length)break;else{B=G;B.splice(g,1);R=T=0;do{R=T=0;for(S=0;S<B.length;S++)if("("===B[S])T=S;else if(")"===B[S]){R=S;break}R===T+1&&B.splice(T,2)}while(R===T+1);G=B;h.splice(n,2,m)}}return[m]};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/ColormapFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./ColormapFunctionArguments ./colormaps ../../../renderers/support/colorRampUtils".split(" "),
function(P,w,E,C,B,T,R,S,K,D,G){C=function(h){function m(){var g=h.apply(this,arguments)||this;g.functionName="Colormap";g.functionArguments=null;g.rasterArgumentNames=["raster"];g.isNoopProcess=!0;return g}P._inherits(m,h);var n=m.prototype;n._bindSourceRasters=function(){var g=this.sourceRasterInfos[0];if(1<g.bandCount)return{success:!1,supportsGPU:!1,error:"colormap-function: source data must be single band"};let {colormap:c,colormapName:t,colorRamp:A,colorRampName:r}=this.functionArguments;if(!c?.length)if(A)c=
G.convertColorRampToColormap(A,{interpolateAlpha:!0});else if(r){const b=G.getColorRampJSON(r);b&&(c=G.convertColorRampToColormap(b))}else t&&(c=D.getColormapByName(t));if(!c?.length)return{success:!1,supportsGPU:!1,error:"colormap-function: missing colormap argument"};this.outputPixelType=this._getOutputPixelType("u8");g=g.clone();g.pixelType=this.outputPixelType;g.colormap=c;g.bandCount=1;this.rasterInfo=g;return{success:!0,supportsGPU:!0}};n._processPixels=function(g){return g.pixelBlocks?.[0]};
return P._createClass(m)}(S);w.__decorate([E.property({json:{write:!0,name:"rasterFunction"}})],C.prototype,"functionName",void 0);w.__decorate([E.property({type:K,json:{write:!0,name:"rasterFunctionArguments"}})],C.prototype,"functionArguments",void 0);w.__decorate([E.property()],C.prototype,"rasterArgumentNames",void 0);w.__decorate([E.property()],C.prototype,"isNoopProcess",void 0);w.__decorate([E.property({json:{write:!0}})],C.prototype,"indexedColormap",void 0);return C=w.__decorate([R.subclass("esri.layers.support.rasterFunctions.ColormapFunction")],
C)})},"esri/layers/support/rasterFunctions/ColormapFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/cast ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ../../../renderers/support/colorRampUtils ../../../rest/support/colorRamps".split(" "),function(P,w,E,C,B,T,
R,S,K,D){var G;S=G=function(h){function m(){return h.apply(this,arguments)||this}P._inherits(m,h);var n=m.prototype;n.castColormapName=function(g){if(!g)return null;g=g.toLowerCase();return K.rasterColormapNames.includes(g)?g:null};n.readColorRamp=function(g){return D.fromJSON(g)};n.readColorRampName=function(g,c){return g?(c=K.colorRampDict.jsonValues.find(t=>t.toLowerCase()===g.toLowerCase()))?K.colorRampDict.fromJSON(c):null:null};n.clone=function(){return new G({colormap:E.clone(this.colormap),
colormapName:this.colormapName,colorRamp:this.colorRamp?.clone(),colorRampName:this.colorRampName})};return P._createClass(m)}(S);w.__decorate([C.property({type:[[Number]],json:{write:!0}})],S.prototype,"colormap",void 0);w.__decorate([C.property({type:String,json:{write:!0}})],S.prototype,"colormapName",void 0);w.__decorate([B.cast("colormapName")],S.prototype,"castColormapName",null);w.__decorate([C.property({types:D.types,json:{write:!0}})],S.prototype,"colorRamp",void 0);w.__decorate([T.reader("colorRamp")],
S.prototype,"readColorRamp",null);w.__decorate([C.property({type:K.colorRampDict.apiValues,json:{type:K.colorRampDict.jsonValues,write:K.colorRampDict.write}})],S.prototype,"colorRampName",void 0);w.__decorate([T.reader("colorRampName")],S.prototype,"readColorRampName",null);return S=G=w.__decorate([R.subclass("esri.layers.support.rasterFunctions.ColormapFunctionArguments")],S)})},"esri/layers/support/rasterFunctions/colormaps":function(){define(["exports","../../../renderers/support/colorRampUtils"],
function(P,w){function E(S,K){const D=[],G=[];for(let h=0;h<S.length-1;h++)D.push({type:"algorithmic",algorithm:"esriHSVAlgorithm",fromColor:S[h].slice(1),toColor:S[h+1].slice(1)}),G.push(S[h+1][0]-S[h][0]);S=S[S.length-1][0];K=K??G;return w.convertColorRampToColors({type:"multipart",colorRamps:D},{numColors:S,weights:K})}function C(){const S=E([[0,255,255,255],[70,0,255,0],[80,205,173,193],[100,150,150,150],[110,120,51,100],[130,120,100,200],[140,28,3,144],[160,6,0,55],[180,10,25,30],[201,6,7,27]]);
for(let K=S.length;256>K;K++)S.push([6,27,7]);return S}function B(){const S=[];for(let K=0;256>K;K++){const D=[];for(let G=0;3>G;G++)D.push(Math.round(255*Math.random()));S.push(D)}return S}const T=[[36,0,255],[36,0,255],[36,0,255],[36,0,255],[112,75,3],[113,76,3],[114,77,3],[115,77,3],[116,78,3],[117,79,3],[118,79,3],[119,80,3],[121,81,4],[122,82,4],[123,82,4],[124,83,4],[125,84,4],[126,84,4],[127,85,4],[128,86,4],[129,86,4],[130,87,4],[131,88,4],[132,89,4],[133,89,4],[134,90,4],[135,91,4],[136,
91,4],[137,92,4],[138,93,4],[139,94,4],[140,94,4],[142,95,5],[143,96,5],[144,96,5],[145,97,5],[146,98,5],[147,99,5],[148,99,5],[149,100,5],[150,101,5],[151,101,5],[152,102,5],[153,103,5],[154,104,5],[155,104,5],[156,105,5],[157,106,5],[158,106,5],[159,107,5],[160,108,5],[161,108,5],[162,109,5],[164,110,6],[165,111,6],[166,111,6],[167,112,6],[168,113,6],[169,113,6],[170,114,6],[171,115,6],[172,116,6],[173,116,6],[174,117,6],[245,0,0],[245,5,0],[245,10,0],[246,15,0],[246,20,0],[246,25,0],[246,30,0],
[247,35,0],[247,40,0],[247,45,0],[247,50,0],[247,55,0],[248,60,0],[248,65,0],[248,70,0],[248,75,0],[249,81,0],[249,86,0],[249,91,0],[249,96,0],[250,101,0],[250,106,0],[250,111,0],[250,116,0],[250,121,0],[251,126,0],[251,131,0],[251,136,0],[251,141,0],[252,146,0],[252,151,0],[252,156,0],[252,156,0],[251,159,0],[250,162,0],[249,165,0],[248,168,0],[247,171,0],[246,174,0],[245,177,0],[245,179,0],[244,182,0],[243,185,0],[242,188,0],[241,191,0],[240,194,0],[239,197,0],[238,200,0],[237,203,0],[236,206,0],
[235,209,0],[234,212,0],[233,215,0],[232,218,0],[231,221,0],[230,224,0],[230,226,0],[229,229,0],[228,232,0],[227,235,0],[226,238,0],[225,241,0],[224,244,0],[223,247,0],[165,247,0],[163,244,0],[161,240,0],[158,237,0],[156,233,1],[154,230,1],[152,227,1],[149,223,1],[147,220,1],[145,216,1],[143,213,1],[140,210,2],[138,206,2],[136,203,2],[134,200,2],[132,196,2],[129,193,2],[127,189,2],[125,186,3],[123,183,3],[120,179,3],[118,176,3],[116,172,3],[114,169,3],[111,166,3],[109,162,4],[107,159,4],[105,155,
4],[103,152,4],[100,149,4],[98,145,4],[96,142,4],[94,138,5],[91,135,5],[89,132,5],[87,128,5],[85,125,5],[82,121,5],[80,118,5],[78,115,6],[76,111,6],[73,108,6],[71,105,6],[69,101,6],[67,98,6],[65,94,6],[62,91,7],[60,88,7],[58,84,7],[56,81,7],[53,77,7],[51,74,7],[49,71,7],[47,67,8],[44,64,8],[42,60,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],
[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,
57,8],[40,57,8]],R=[[36,0,255],[36,0,255],[36,0,255],[36,0,255],[245,20,0],[245,24,0],[245,29,0],[245,31,0],[247,33,0],[247,33,0],[247,37,0],[247,41,0],[247,41,0],[247,41,0],[247,45,0],[247,45,0],[247,47,0],[247,49,0],[247,49,0],[247,54,0],[247,54,0],[247,56,0],[247,58,0],[247,58,0],[250,62,0],[250,62,0],[250,62,0],[250,67,0],[250,67,0],[250,67,0],[250,69,0],[250,71,0],[250,71,0],[250,75,0],[250,75,0],[250,78,0],[250,79,0],[250,79,0],[250,79,0],[250,81,0],[250,83,0],[250,83,0],[250,87,0],[250,87,
0],[250,90,0],[250,92,0],[252,93,0],[252,93,0],[252,97,0],[252,97,0],[252,97,0],[252,97,0],[252,101,0],[252,101,0],[252,101,0],[252,101,0],[252,105,0],[252,105,0],[252,107,0],[252,109,0],[252,109,0],[252,113,13],[255,118,20],[255,119,23],[255,121,25],[255,126,33],[255,132,38],[255,133,40],[255,135,43],[255,141,48],[255,144,54],[255,150,59],[255,152,61],[255,153,64],[255,159,69],[255,163,77],[255,165,79],[255,168,82],[255,174,87],[255,176,92],[255,181,97],[255,183,99],[255,186,102],[255,191,107],[255,
197,115],[255,201,120],[255,203,123],[255,205,125],[255,209,130],[255,214,138],[255,216,141],[255,218,143],[255,224,150],[255,228,156],[255,234,163],[255,236,165],[255,238,168],[255,243,173],[255,248,181],[255,252,186],[253,252,186],[250,252,187],[244,250,180],[238,247,176],[234,246,173],[231,245,169],[223,240,163],[217,237,157],[211,235,150],[205,233,146],[200,230,142],[195,227,136],[189,224,132],[184,222,126],[180,220,123],[174,217,119],[169,214,114],[163,212,108],[160,210,105],[154,207,101],[148,
204,96],[143,201,93],[138,199,88],[134,197,84],[130,194,81],[126,191,77],[117,189,70],[115,186,68],[112,184,64],[106,181,60],[100,179,55],[94,176,49],[92,174,47],[90,173,45],[81,168,37],[75,166,33],[71,163,28],[66,160,24],[62,158,21],[56,156,14],[51,153,0],[51,153,0],[51,153,0],[50,150,0],[50,150,0],[50,150,0],[50,150,0],[49,148,0],[49,148,0],[49,148,0],[48,145,0],[48,145,0],[48,145,0],[48,145,0],[48,143,0],[48,143,0],[48,143,0],[48,143,0],[47,140,0],[47,140,0],[47,140,0],[47,140,0],[46,138,0],[46,
138,0],[46,138,0],[46,138,0],[45,135,0],[45,135,0],[45,135,0],[45,135,0],[44,133,0],[44,133,0],[44,133,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[42,128,0],[42,128,0],[42,128,0],[42,125,0],[42,125,0],[42,125,0],[42,125,0],[41,122,0],[41,122,0],[41,122,0],[41,122,0],[40,120,0],[40,120,0],[40,120,0],[40,120,0],[40,120,0],[39,117,0],[39,117,0],[39,117,0],[39,117,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],
[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,
0],[38,115,0]];P.getColormapByName=function(S){let K;switch(S){case "elevation":K=E([[0,0,191,191],[51,0,0,255],[102,255,0,255],[153,255,0,127],[204,191,63,127],[256,20,20,20]]);break;case "gray":K=w.convertColorRampToColors({type:"algorithmic",algorithm:"esriHSVAlgorithm",fromColor:[0,0,0],toColor:[255,255,255]});break;case "hillshade":K=E([[0,38,41,54],[69,79,82,90],[131,156,156,156],[256,253,253,241]],[.268,.238,.495]);break;case "ndvi":K=T;break;case "ndvi2":K=C();break;case "ndvi3":K=R;break;
case "random":K=B()}return K?K=K.map((D,G)=>[G,...D]):null};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/CompositeBandFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./CompositeBandFunctionArguments ./pixelUtils".split(" "),
function(P,w,E,C,B,T,R,S,K,D){C=function(G){function h(){var n=G.apply(this,arguments)||this;n.functionName="CompositeBand";n.functionArguments=null;n.rasterArgumentNames=["rasters"];return n}P._inherits(h,G);var m=h.prototype;m._bindSourceRasters=function(){var {sourceRasterInfos:n}=this,g=n[0];this.outputPixelType=this._getOutputPixelType(g.pixelType);g=g.clone();g.attributeTable=null;g.colormap=null;g.pixelType=this.outputPixelType;g.bandCount=n.map(({bandCount:c})=>c).reduce((c,t)=>c+t);if(n.every(({statistics:c})=>
null!=c&&c.length)){const c=[];n.forEach(({statistics:t})=>null!=t&&c.push(...t));g.statistics=c}if(n.every(({histograms:c})=>null!=c&&c.length)){const c=[];n.forEach(({histograms:t})=>null!=t&&c.push(...t));g.histograms=c}1<g.bandCount&&(g.colormap=null,g.attributeTable=null);n=n.every(c=>c.keyProperties.BandProperties?.length)?n.flatMap(c=>c.keyProperties.BandProperties):void 0;g.keyProperties={...g.keyProperties,BandProperties:n};this.rasterInfo=g;return{success:!0,supportsGPU:3>=g.bandCount}};
m._processPixels=function(n){({pixelBlocks:n}=n);return n&&null!=n?.[0]?D.compositeBands(n):null};m._getWebGLParameters=function(){return{bandCount:this.rasterInfo.bandCount}};return P._createClass(h)}(S);w.__decorate([E.property({json:{write:!0,name:"rasterFunction"}})],C.prototype,"functionName",void 0);w.__decorate([E.property({type:K,json:{write:!0,name:"rasterFunctionArguments"}})],C.prototype,"functionArguments",void 0);w.__decorate([E.property()],C.prototype,"rasterArgumentNames",void 0);return C=
w.__decorate([R.subclass("esri.layers.support.rasterFunctions.CompositeBandFunction")],C)})},"esri/layers/support/rasterFunctions/CompositeBandFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),function(P,
w,E,C,B,T,R,S){var K;B=K=function(D){function G(){var m=D.apply(this,arguments)||this;m.rasters=[];return m}P._inherits(G,D);var h=G.prototype;h.writeRasters=function(m,n){n.rasters=m.map(g=>"number"===typeof g||"string"===typeof g?g:g.toJSON())};h.clone=function(){return new K({rasters:E.clone(this.rasters)})};return P._createClass(G)}(S);w.__decorate([C.property({json:{write:!0}})],B.prototype,"rasters",void 0);w.__decorate([R.writer("rasters")],B.prototype,"writeRasters",null);return B=K=w.__decorate([T.subclass("esri.layers.support.rasterFunctions.CompositeBandFunctionArguments")],
B)})},"esri/layers/support/rasterFunctions/ConvolutionFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../rasterFunctionConstants ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./ConvolutionFunctionArguments ./convolutionUtils".split(" "),function(P,w,E,C,B,T,R,
S,K,D,G,h){C=function(m){function n(){var c=m.apply(this,arguments)||this;c.functionName="Convolution";c.rasterArgumentNames=["raster"];return c}P._inherits(n,m);var g=n.prototype;g._bindSourceRasters=function(){const {convolutionType:c,rows:t,cols:A,kernel:r}=this.functionArguments;if(!Object.values(S.convolutionKernel).includes(c))return{success:!1,supportsGPU:!1,error:`convolution-function: the specified kernel type is not supported ${c}`};if(c!==S.convolutionKernel.none&&t*A!==r.length)return{success:!1,
supportsGPU:!1,error:"convolution-function: the specified rows and cols do not match the length of the kernel"};var b=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType(b.pixelType);b=b.clone();b.pixelType=this.outputPixelType;const f=[S.convolutionKernel.none,S.convolutionKernel.sharpen,S.convolutionKernel.sharpen2,S.convolutionKernel.sharpening3x3,S.convolutionKernel.sharpening5x5];"u8"===this.outputPixelType||f.includes(c)||(b.statistics=null,b.histograms=null);b.colormap=
null;b.attributeTable=null;this.rasterInfo=b;return{success:!0,supportsGPU:25>=r.length}};g._processPixels=function(c){c=c.pixelBlocks?.[0];if(null==c||this.functionArguments.convolutionType===S.convolutionKernel.none)return c;let {kernel:t,rows:A,cols:r}=this.functionArguments;const b=t.reduce((f,d)=>f+d);0!==b&&1!==b&&(t=t.map(f=>f/b));return h.convolute(c,{kernel:t,rows:A,cols:r,outputPixelType:this.outputPixelType})};g._getWebGLParameters=function(){let {kernel:c}=this.functionArguments;const t=
c.reduce((r,b)=>r+b);0!==t&&1!==t&&(c=c.map(r=>r/t));const A=new Float32Array(25);A.set(c);return{kernelRows:this.functionArguments.rows,kernelCols:this.functionArguments.cols,kernel:A,clampRange:K.getPixelValueRange(this.outputPixelType)}};return P._createClass(n)}(D);w.__decorate([E.property({json:{write:!0,name:"rasterFunction"}})],C.prototype,"functionName",void 0);w.__decorate([E.property({type:G,json:{write:!0,name:"rasterFunctionArguments"}})],C.prototype,"functionArguments",void 0);w.__decorate([E.property()],
C.prototype,"rasterArgumentNames",void 0);return C=w.__decorate([R.subclass("esri.layers.support.rasterFunctions.ConvolutionFunction")],C)})},"esri/layers/support/rasterFunctionConstants":function(){define(["exports"],function(P){const w={plus:1,minus:2,times:3,sqrt:4,power:5,abs:10,divide:23,exp:25,exp10:26,exp2:27,int:30,float:32,ln:35,log10:36,log2:37,mod:44,negate:45,roundDown:48,roundUp:49,square:53,floatDivide:64,floorDivide:65},E={bitwiseAnd:11,bitwiseLeftShift:12,bitwiseNot:13,bitwiseOr:14,
bitwiseRightShift:15,bitwiseXOr:16,booleanAnd:17,booleanNot:18,booleanOr:19,booleanXOr:20,equalTo:24,greaterThan:28,greaterThanEqual:29,lessThan:33,lessThanEqual:34,isNull:31,notEqual:46},C={acos:6,asin:7,atan:8,atanh:9,cos:21,cosh:22,sin:51,sinh:52,tan:56,tanh:57,acosh:59,asinh:60,atan2:61},B={majority:38,max:39,mean:40,med:41,min:42,minority:43,range:47,stddev:54,sum:55,variety:58,majorityIgnoreNoData:66,maxIgnoreNoData:67,meanIgnoreNoData:68,medIgnoreNoData:69,minIgnoreNoData:70,minorityIgnoreNoData:71,
rangeIgnoreNoData:72,stddevIgnoreNoData:73,sumIgnoreNoData:74,varietyIgnoreNoData:75},T={setNull:50,conditional:78},R={...w,...E,...C,...B,...T};P.bandIndexType={userDefined:0,NDVI:1,SAVI:2,TSAVI:3,MSAVI:4,GEMI:5,PVI:6,GVITM:7,Sultan:8,VARI:9,GNDVI:10,SR:11,NDVIRe:12,SRRe:13,MTVI2:14,RTVICore:15,CIRe:16,CIG:17,NDWI:18,EVI:19,ironOxide:20,ferrousMinerals:21,clayMinerals:22,WNDWI:23,BAI:24,NBR:25,NDBI:26,NDMI:27,NDSI:28,MNDWI:29};P.cellStatisticalOperation=B;P.colorRampName={aspect:"Aspect",blackToWhite:"Black to White",
blueBright:"Blue Bright",blueLightToDark:"Blue Light to Dark",blueGreenBright:"Blue-Green Bright",blueGreenLightToDark:"Blue-Green Light to Dark",brownLightToDark:"Brown Light to Dark",brownToBlueGreenDivergingBright:"Brown to Blue Green Diverging, Bright",brownToBlueGreenDivergingDark:"Brown to Blue Green Diverging, Dark",coefficientBias:"Coefficient Bias",coldToHotDiverging:"Cold to Hot Diverging",conditionNumber:"Condition Number",cyanToPurple:"Cyan to Purple",cyanLightToBlueDark:"Cyan-Light to Blue-Dark",
distance:"Distance",elevation1:"Elevation #1",elevation2:"Elevation #2",errors:"Errors",grayLightToDark:"Gray Light to Dark",greenBright:"Green Bright",greenLightToDark:"Green Light to Dark",greenToBlue:"Green to Blue",orangeBright:"Orange Bright",orangeLightToDark:"Orange Light to Dark",partialSpectrum:"Partial Spectrum",partialSpectrum1Diverging:"Partial Spectrum 1 Diverging",partialSpectrum2Diverging:"Partial Spectrum 2 Diverging",pinkToYellowGreenDivergingBright:"Pink to YellowGreen Diverging, Bright",
pinkToYellowGreenDivergingDark:"Pink to YellowGreen Diverging, Dark",precipitation:"Precipitation",prediction:"Prediction",purpleBright:"Purple Bright",purpleToGreenDivergingBright:"Purple to Green Diverging, Bright",purpleToGreenDivergingDark:"Purple to Green Diverging, Dark",purpleBlueBright:"Purple-Blue Bright",purpleBlueLightToDark:"Purple-Blue Light to Dark",purpleRedBright:"Purple-Red Bright",purpleRedLightToDark:"Purple-Red Light to Dark",redBright:"Red Bright",redLightToDark:"Red Light to Dark",
redToBlueDivergingBright:"Red to Blue Diverging, Bright",redToBlueDivergingDark:"Red to Blue Diverging, Dark",redToGreen:"Red to Green",redToGreenDivergingBright:"Red to Green Diverging, Bright",redToGreenDivergingDark:"Red to Green Diverging, Dark",slope:"Slope",spectrumFullBright:"Spectrum-Full Bright",spectrumFullDark:"Spectrum-Full Dark",spectrumFullLight:"Spectrum-Full Light",surface:"Surface",temperature:"Temperature",whiteToBlack:"White to Black",yellowToDarkRed:"Yellow to Dark Red",yellowToGreenToDarkBlue:"Yellow to Green to Dark Blue",
yellowToRed:"Yellow to Red",yellowGreenBright:"Yellow-Green Bright",yellowGreenLightToDark:"Yellow-Green Light to Dark"};P.colormapName={random:"Random",NDVI:"NDVI",NDVI2:"NDVI2",NDVI3:"NDVI3",elevation:"Elevation",gray:"Gray",hillshade:"Hillshade"};P.convolutionKernel={userDefined:-1,lineDetectionHorizontal:0,lineDetectionVertical:1,lineDetectionLeftDiagonal:2,lineDetectionRightDiagonal:3,gradientNorth:4,gradientWest:5,gradientEast:6,gradientSouth:7,gradientNorthEast:8,gradientNorthWest:9,smoothArithmeticMean:10,
smoothing3x3:11,smoothing5x5:12,sharpening3x3:13,sharpening5x5:14,laplacian3x3:15,laplacian5x5:16,sobelHorizontal:17,sobelVertical:18,sharpen:19,sharpen2:20,pointSpread:21,none:255};P.curvatureType={standard:0,platform:1,profile:2};P.localArithmeticOperation=w;P.localConditionalOperation=T;P.localLogicalOperation=E;P.localOperators=R;P.localTrigonometricOperation=C;P.missingBandAction={bestMatch:0,fail:1};P.noDataInterpretation={matchAny:0,matchAll:1};P.slopeType={degree:1,percentRise:2,adjusted:3};
P.stretchType={none:0,standardDeviation:3,histogramEqualization:4,minMax:5,percentClip:6,sigmoid:9};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/ConvolutionFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../rasterFunctionConstants ./BaseFunctionArguments ./convolutionUtils".split(" "),
function(P,w,E,C,B,T,R,S,K){var D;B=D=function(G){function h(){var m=G.apply(this,arguments)||this;m.rows=3;m.cols=3;m.kernel=[0,0,0,0,1,0,0,0,0];return m}P._inherits(h,G);h.prototype.clone=function(){return new D({cols:this.cols,rows:this.rows,kernel:[...this.kernel],convolutionType:this.convolutionType,raster:E.clone(this.raster)})};P._createClass(h,[{key:"convolutionType",set:function(m){this._set("convolutionType",m);const n=K.convolutionKernels.get(m);n&&m!==R.convolutionKernel.userDefined&&
m!==R.convolutionKernel.none&&(m=Math.sqrt(n.length),this._set("kernel",n),this._set("cols",m),this._set("rows",m))}}]);return h}(S);w.__decorate([C.property({json:{type:Number,write:!0}})],B.prototype,"rows",void 0);w.__decorate([C.property({json:{type:Number,write:!0}})],B.prototype,"cols",void 0);w.__decorate([C.property({json:{name:"type",type:Number,write:!0}})],B.prototype,"convolutionType",null);w.__decorate([C.property({json:{type:[Number],write:!0}})],B.prototype,"kernel",void 0);return B=
D=w.__decorate([T.subclass("esri.layers.support.rasterFunctions.ConvolutionFunctionArguments")],B)})},"esri/layers/support/rasterFunctions/convolutionUtils":function(){define(["exports","../PixelBlock","../rasterFunctionConstants"],function(P,w,E){function C(D){const G=Math.sqrt(D.length),h=D.slice(0,G),m=[1];for(let n=1;n<G;n++){let g=null;for(let c=0;c<G;c++){const t=D[c+n*G],A=D[c];if(null==g)if(0===A){if(t)return{separable:!1,row:null,col:null}}else g=t/A;else if(t/A!==g)return{separable:!1,row:null,
col:null}}if(null==g)return{separable:!1,row:null,col:null};m.push(g)}return{separable:!0,row:h,col:m}}function B(D,G,h,m,n,g,c){const t=new Float32Array(G*h),A=g.length,r=c?0:m,b=c?m:0;c=c?1:G;for(let f=r;f<h-r;f++){const d=f*G;for(let e=b;e<G-b;e++){if(n&&!n[d+e])continue;let q=0;for(let l=0;l<A;l++)q+=D[d+e+(l-m)*c]*g[l];t[d+e]=q}}return t}function T(D,G,h=!0){const {pixels:m,width:n,height:g,pixelType:c,mask:t}=D;D=m.length;const A=[],{kernel:r,rows:b,cols:f}=G;for(G=0;G<D;G++){var d=m[G],e=n,
q=g,l=b,a=f,k=t,p=r;const z=new Float32Array(e*q),I=Math.floor(l/2),N=Math.floor(a/2);for(let O=I;O<q-I;O++){const H=O*e;for(let u=N;u<e-N;u++){if(k&&!k[H+u])continue;let y=0;for(let x=0;x<l;x++)for(let L=0;L<a;L++)y+=d[H+u+(x-I)*e+L-N]*p[x*a+L];z[H+u]=y}}d=z;h&&R(d,n,g,b,f);A.push(d)}return new w({width:n,height:g,pixelType:c,pixels:A,mask:t})}function R(D,G,h,m,n){m=Math.floor(m/2);for(var g=0;g<m;g++)for(var c=0;c<G;c++)D[g*G+c]=D[(n-1-g)*G+c],D[(h-1-g)*G+c]=D[(h-n+g)*G+c];m=Math.floor(n/2);for(g=
0;g<h;g++){c=g*G;for(let t=0;t<m;t++)D[c+t]=D[c+n-1-t],D[c+G-t-1]=D[c+G+t-n]}}function S(D,G,h,m=!0){const {pixels:n,width:g,height:c,pixelType:t,mask:A}=D;D=n.length;const r=[],b=G.length,f=h.length,d=Math.floor(b/2),e=Math.floor(f/2);for(let q=0;q<D;q++){let l=B(n[q],g,c,d,A,G,!0);l=B(l,g,c,e,A,h,!1);m&&R(l,g,c,b,f);r.push(l)}return new w({width:g,height:c,pixelType:t,pixels:r,mask:A})}const K=new Map;K.set(E.convolutionKernel.none,[0,0,0,0,1,0,0,0,0]);K.set(E.convolutionKernel.lineDetectionHorizontal,
[-1,-1,-1,2,2,2,-1,-1,-1]);K.set(E.convolutionKernel.lineDetectionVertical,[-1,2,-1,-1,2,-1,-1,2,-1]);K.set(E.convolutionKernel.lineDetectionLeftDiagonal,[2,-1,-1,-1,2,-1,-1,-1,2]);K.set(E.convolutionKernel.lineDetectionRightDiagonal,[-1,-1,2,-1,2,-1,2,-1,-1]);K.set(E.convolutionKernel.gradientNorth,[-1,-2,-1,0,0,0,1,2,1]);K.set(E.convolutionKernel.gradientWest,[-1,0,1,-2,0,2,-1,0,1]);K.set(E.convolutionKernel.gradientEast,[1,0,-1,2,0,-2,1,0,-1]);K.set(E.convolutionKernel.gradientSouth,[1,2,1,0,0,
0,-1,-2,-1]);K.set(E.convolutionKernel.gradientNorthEast,[0,-1,-2,1,0,-1,2,1,0]);K.set(E.convolutionKernel.gradientNorthWest,[-2,-1,0,-1,0,1,0,1,2]);K.set(E.convolutionKernel.smoothArithmeticMean,[.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111]);K.set(E.convolutionKernel.smoothing3x3,[.0625,.125,.0625,.125,.25,.125,.0625,.125,.0625]);K.set(E.convolutionKernel.smoothing5x5,[1,1,1,1,1,1,4,4,4,1,1,4,12,4,1,1,4,4,4,1,1,1,1,
1,1]);K.set(E.convolutionKernel.sharpening3x3,[-1,-1,-1,-1,9,-1,-1,-1,-1]);K.set(E.convolutionKernel.sharpening5x5,[-1,-3,-4,-3,-1,-3,0,6,0,-3,-4,6,21,6,-4,-3,0,6,0,-3,-1,-3,-4,-3,-1]);K.set(E.convolutionKernel.laplacian3x3,[0,-1,0,-1,4,-1,0,-1,0]);K.set(E.convolutionKernel.laplacian5x5,[0,0,-1,0,0,0,-1,-2,-1,0,-1,-2,17,-2,-1,0,-1,-2,-1,0,0,0,-1,0,0]);K.set(E.convolutionKernel.sobelHorizontal,[-1,-2,-1,0,0,0,1,2,1]);K.set(E.convolutionKernel.sobelVertical,[-1,0,1,-2,0,2,-1,0,1]);K.set(E.convolutionKernel.sharpen,
[0,-.25,0,-.25,2,-.25,0,-.25,0]);K.set(E.convolutionKernel.sharpen2,[-.25,-.25,-.25,-.25,3,-.25,-.25,-.25,-.25]);K.set(E.convolutionKernel.pointSpread,[-.627,.352,-.627,.352,2.923,.352,-.627,.352,-.627]);P.convolute=function(D,G){const h=C(G.kernel),m=!1!==G.mirrorEdges;D=h.separable?S(D,h.row,h.col,m):T(D,G,m);({outputPixelType:G}=G);G&&D.clamp(G);return D};P.convoluteSeparable=S;P.convolutionKernels=K;P.separateKernels=C;Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/CurvatureFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./CurvatureFunctionArguments ./surfaceUtils".split(" "),
function(P,w,E,C,B,T,R,S,K,D){C=function(G){function h(){var n=G.apply(this,arguments)||this;n.functionName="Curvature";n.functionArguments=null;n.rasterArgumentNames=["raster"];n.isGCS=!1;return n}P._inherits(h,G);var m=h.prototype;m._bindSourceRasters=function(){this.outputPixelType=this._getOutputPixelType("f32");const n=this.sourceRasterInfos[0].clone();n.pixelType=this.outputPixelType;n.statistics=null;n.histograms=null;n.colormap=null;n.attributeTable=null;n.bandCount=1;this.rasterInfo=n;this.isGCS=
n.spatialReference?.isGeographic??!1;return{success:!0,supportsGPU:!0}};m._processPixels=function(n){const g=n.pixelBlocks?.[0];if(null==g)return null;const {zFactor:c,curvatureType:t}=this.functionArguments,{extent:A,primaryPixelSizes:r}=n;n=r?.[0];return D.curvature(g,{zFactor:this.isGCS&&1<=c?c*D.GCS_FACTOR:c,curvatureType:t,resolution:null==n?A?{x:A.width/g.width,y:A.height/g.height}:{x:1,y:1}:n})};m._getWebGLParameters=function(){const {zFactor:n,curvatureType:g}=this.functionArguments;return{curvatureType:g,
zFactor:this.isGCS&&1<=n?n*D.GCS_FACTOR:n}};return P._createClass(h)}(S);w.__decorate([E.property({json:{write:!0,name:"rasterFunction"}})],C.prototype,"functionName",void 0);w.__decorate([E.property({type:K,json:{write:!0,name:"rasterFunctionArguments"}})],C.prototype,"functionArguments",void 0);w.__decorate([E.property()],C.prototype,"rasterArgumentNames",void 0);w.__decorate([E.property({json:{write:!0}})],C.prototype,"isGCS",void 0);return C=w.__decorate([R.subclass("esri.layers.support.rasterFunctions.CurvatureFunction")],
C)})},"esri/layers/support/rasterFunctions/CurvatureFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(P,w,E,C,B,T,R,S,K,D,G){var h;const m=new E.JSONMap({0:"standard",1:"platform",2:"profile"},{useNumericKeys:!0});E=h=function(n){function g(){var t=n.apply(this,arguments)||this;t.curvatureType="standard";t.zFactor=1;return t}P._inherits(g,n);var c=g.prototype;c.readCurvatureType=function(t,A){return m.fromJSON(A.type??A.curvatureType??0)};c.clone=function(){return new h({curvatureType:this.curvatureType,zFactor:this.zFactor,raster:this.raster})};return P._createClass(g)}(G);w.__decorate([C.property({json:{write:{target:"type"}}}),
S.enumeration(m)],E.prototype,"curvatureType",void 0);w.__decorate([K.reader("curvatureType",["type","curvatureType"])],E.prototype,"readCurvatureType",null);w.__decorate([C.property({type:Number,json:{write:!0}})],E.prototype,"zFactor",void 0);return E=h=w.__decorate([D.subclass("esri.layers.support.rasterFunctions.CurvatureFunctionArguments")],E)})},"esri/layers/support/rasterFunctions/ExtractBandFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./bandIndexUtils ./BaseRasterFunction ./ExtractBandFunctionArguments ./pixelUtils".split(" "),
function(P,w,E,C,B,T,R,S,K,D,G){C=function(h){function m(){var g=h.apply(this,arguments)||this;g.functionName="ExtractBand";g.functionArguments=null;g.rasterArgumentNames=["raster"];return g}P._inherits(m,h);var n=m.prototype;n._bindSourceRasters=function(){const {functionArguments:g,sourceRasterInfos:c}=this;var t=c[0];const {method:A,bandNames:r,bandWavelengths:b,bandIds:f,missingBandAction:d}=g,e=r?.length&&("name"===A||"id"!==A&&!f?.length),q=b?.length&&("wavelength"===A||"id"!==A&&!f?.length);
var l=d===G.MissingBandAction.fail;l=e?this._matchBandNames(t,r):q?this._matchBandWavelengths(t,b,l):this._matchBandIds(t,f,l);if(null==l)return{success:!1,supportsGPU:!1,error:`extract-band-function: Invalid ${e?"band names":q?"band wavelengths":"band ids"} for the imagery data source`};this.functionArguments.bandIds=l;this.functionArguments.method="id";this.outputPixelType=this._getOutputPixelType("f32");t=t.clone();t.pixelType=this.outputPixelType;t.bandCount=l.length;const {statistics:a,histograms:k}=
t;null!=a&&a.length&&(t.statistics=l.map(z=>a[z]||a[a.length-1]));null!=k&&k.length&&(t.histograms=l.map(z=>k[z]||k[k.length-1]));let p=t.keyProperties?.BandProperties;p?.length&&(p=l.map(z=>z>=p.length?p[p.length-1]:p[z]),t.keyProperties={...t.keyProperties,BandProperties:p});this.rasterInfo=t;return{success:!0,supportsGPU:3>=t.bandCount}};n._processPixels=function(g){g=g.pixelBlocks?.[0];if(null==g)return null;const c=g.pixels.length,t=this.functionArguments.bandIds.map(A=>A>=c?c-1:A);return g.extractBands(t)};
n._getWebGLParameters=function(){let g;if(this.isInputBandIdsSwizzled)g=this.swizzledBandSelection.length?this.swizzledBandSelection:[0,1,2];else{g=[...this.functionArguments.bandIds];0===g.length?g=[0,1,2]:3>g.length&&(g[1]=g[1]??g[0],g[2]=g[2]??g[1]);for(let c=0;3>c;c++)g[c]=Math.min(g[c],2)}return{bandIndexMat3:S.getBandMatrix3(g)}};n._getInputBandIds=function(g){const c=g.length;return this.functionArguments.bandIds.map(t=>t>=c?c-1:t).map(t=>g[t])};n._matchBandNames=function(g,c){g=g.bandInfos.map(({name:A})=>
A.toLowerCase());const t=[];for(let A=0;A<c.length;A++){const r=c[A].toLowerCase();let b=g.indexOf(r);-1===b&&"nearinfrared"===r&&(b=g.findIndex(f=>f.startsWith("nearinfrared_1")),-1===b&&(b=g.findIndex(f=>f.startsWith("nearinfrared"))));if(-1===b)return null;t.push(b)}return t};n._matchBandIds=function(g,c,t){const {bandCount:A}=g;return!c?.length||t&&c.some(r=>0>r||r>=A)?null:c};n._matchBandWavelengths=function(g,c,t){var {bandInfos:A}=g;g=[];for(var r=0;r<A.length;r++){const {minWavelength:b,maxWavelength:f}=
A[r];if(!b||!f)return null;g.push({minWavelength:b,maxWavelength:f})}({wavelengthMatchTolerance:A}=this.functionArguments);r=[];for(let b=0;b<c.length;b++){const f=c[b];let d=!1,e=-1,q=Number.MAX_VALUE;for(let l=0;l<g.length;l++){const a=g[l],k=Math.abs(f-(a.minWavelength+a.maxWavelength)/2);f>=a.minWavelength&&f<=a.maxWavelength?k<q&&(d=!0,e=l,q=k):!d&&k<q&&(e=l,q=k)}!d&&A&&q<A&&(d=!0);if(!d&&t)return null;r.push(e)}return r};return P._createClass(m)}(K);w.__decorate([E.property({json:{write:!0,
name:"rasterFunction"}})],C.prototype,"functionName",void 0);w.__decorate([E.property({type:D,json:{write:!0,name:"rasterFunctionArguments"}})],C.prototype,"functionArguments",void 0);w.__decorate([E.property()],C.prototype,"rasterArgumentNames",void 0);return C=w.__decorate([R.subclass("esri.layers.support.rasterFunctions.ExtractBandFunction")],C)})},"esri/layers/support/rasterFunctions/ExtractBandFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ./pixelUtils".split(" "),
function(P,w,E,C,B,T,R,S,K,D){var G;C=G=function(h){function m(){var n=h.apply(this,arguments)||this;n.bandIds=[];n.bandNames=[];n.bandWavelengths=[];n.missingBandAction=D.MissingBandAction.bestMatch;return n}P._inherits(m,h);m.prototype.clone=function(){return new G({bandIds:[...this.bandIds],bandNames:[...this.bandNames],missingBandAction:this.missingBandAction,method:this.method,wavelengthMatchTolerance:this.wavelengthMatchTolerance})};return P._createClass(m)}(K);w.__decorate([E.property({json:{write:!0}})],
C.prototype,"bandIds",void 0);w.__decorate([E.property({json:{write:!0}})],C.prototype,"bandNames",void 0);w.__decorate([E.property({json:{write:!0}})],C.prototype,"bandWavelengths",void 0);w.__decorate([R.enumeration({0:"name",1:"wavelength",2:"id"})],C.prototype,"method",void 0);w.__decorate([E.property({json:{write:!0}})],C.prototype,"missingBandAction",void 0);w.__decorate([E.property({json:{write:!0}})],C.prototype,"wavelengthMatchTolerance",void 0);return C=G=w.__decorate([S.subclass("esri.layers.support.rasterFunctions.ExtractBandFunctionArguments")],
C)})},"esri/layers/support/rasterFunctions/LocalFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../rasterFunctionConstants ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./LocalFunctionArguments ./localUtils".split(" "),function(P,w,E,C,B,T,R,S,K,D,G,h){C=function(m){function n(){var c=
m.apply(this,arguments)||this;c.functionName="Local";c.functionArguments=null;c.rasterArgumentNames=["rasters"];return c}P._inherits(n,m);var g=n.prototype;g._bindSourceRasters=function(){var {sourceRasterInfos:c}=this,t=c[0];const {bandCount:A}=t;var {processAsMultiband:r}=this.functionArguments;if(c.some(d=>d.bandCount!==A))return{success:!1,supportsGPU:!1,error:"local-function: input rasters do not have same band count"};const {operation:b,rasters:f}=this.functionArguments;c=h.operandsCount[b];
if(!(999===c||f.length===c||1>=f.length&&1===c))return{success:!1,supportsGPU:!1,error:`local-function: the length of functionArguments.rasters does not match operation's requirement: ${c}`};this.outputPixelType=this._getOutputPixelType("f32");t=t.clone();t.pixelType=this.outputPixelType;t.statistics=null;t.histograms=null;t.colormap=null;t.attributeTable=null;t.bandCount=999!==c||r?A:1;if(r=h.getOutputDomain(b)){t.statistics=[];for(let d=0;d<t.bandCount;d++)t.statistics[d]={min:r[0],max:r[1],avg:(r[0]+
r[1])/2,stddev:(r[0]+r[1])/10}}this.rasterInfo=t;return{success:!0,supportsGPU:1===t.bandCount&&3>=c&&(11>b||16<b)}};g._processPixels=function(c){({pixelBlocks:c}=c);return null==c||c.some(t=>null==t)?null:h.local(c,this.functionArguments.operation,{processAsMultiband:this.functionArguments.processAsMultiband,outputPixelType:this.outputPixelType??void 0})};g._getWebGLParameters=function(){const {operation:c}=this.functionArguments,t=h.operandsCount[c],A=Object.keys(S.localOperators).find(d=>S.localOperators[d]===
c)?.toLowerCase()??"undefined";var r=this.outputPixelType??"f32";let [b,f]=K.getPixelValueRange(r);if(r=r.startsWith("u")||r.startsWith("s"))b-=1E-4,f+=1E-4;return{imageCount:t,operationName:A,domainRange:[b,f],isOutputRounded:r}};return P._createClass(n)}(D);w.__decorate([E.property({json:{write:!0,name:"rasterFunction"}})],C.prototype,"functionName",void 0);w.__decorate([E.property({type:G,json:{write:!0,name:"rasterFunctionArguments"}})],C.prototype,"functionArguments",void 0);w.__decorate([E.property()],
C.prototype,"rasterArgumentNames",void 0);return C=w.__decorate([R.subclass("esri.layers.support.rasterFunctions.LocalFunction")],C)})},"esri/layers/support/rasterFunctions/LocalFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),
function(P,w,E,C,B,T,R,S){var K;B=K=function(D){function G(){var m=D.apply(this,arguments)||this;m.rasters=[];m.processAsMultiband=!0;return m}P._inherits(G,D);var h=G.prototype;h.writeRasters=function(m,n){n.rasters=m.map(g=>"number"===typeof g||"string"===typeof g?g:g.toJSON())};h.clone=function(){return new K({operation:this.operation,processAsMultiband:this.processAsMultiband,rasters:E.clone(this.rasters)})};return P._createClass(G)}(S);w.__decorate([C.property({json:{write:!0}})],B.prototype,
"operation",void 0);w.__decorate([C.property({json:{write:!0}})],B.prototype,"rasters",void 0);w.__decorate([R.writer("rasters")],B.prototype,"writeRasters",null);w.__decorate([C.property({json:{write:!0}})],B.prototype,"processAsMultiband",void 0);return B=K=w.__decorate([T.subclass("esri.layers.support.rasterFunctions.LocalFunctionArguments")],B)})},"esri/layers/support/rasterFunctions/localUtils":function(){define(["exports","../PixelBlock","../rasterFunctionConstants","../rasterFormats/pixelRangeUtils"],
function(P,w,E,C){function B(aa,ha=!1){var ba=aa.map(ca=>ca.mask);const ka=ba.filter(ca=>null!=ca);var la=aa[0].pixels[0].length;if(0===ka.length)return(new Uint8Array(la)).fill(255);aa=new Uint8Array(ka[0]);if(1===ka.length)return aa;if(!ha){for(ha=1;ha<ka.length;ha++)for(ba=ka[ha],la=0;la<aa.length;la++)aa[la]&&(aa[la]=ba[la]?255:0);return aa}if(ka.length!==ba.length)return(new Uint8Array(la)).fill(255);for(ha=1;ha<ka.length;ha++)for(ba=ka[ha],la=0;la<aa.length;la++)0===aa[la]&&(aa[la]=ba[la]?255:
0);return aa}function T(aa,ha,ba){const [ka,la]=aa;aa=ka.length;ba=w.createEmptyBand(ba,aa);for(let ca=0;ca<aa;ca++)if(!ha||ha[ca])ba[ca]=ka[ca]+la[ca];return ba}function R(aa,ha,ba){[aa]=aa;ha=w.createEmptyBand("f32",aa.length);ha.set(aa);return ha}function S(aa,ha,ba){const [ka,la]=aa;aa=ka.length;ba=w.createEmptyBand(ba,aa);for(let ca=0;ca<aa;ca++)if(!ha||ha[ca])ba[ca]=ka[ca]-la[ca];return ba}function K(aa,ha,ba){const [ka,la]=aa;aa=ka.length;ba=w.createEmptyBand(ba,aa);for(let ca=0;ca<aa;ca++)if(!ha||
ha[ca])ba[ca]=ka[ca]*la[ca];return ba}function D(aa,ha,ba){[aa]=aa;const ka=aa.length;ba=w.createEmptyBand(ba,ka);for(let la=0;la<ka;la++)if(!ha||ha[la])ba[la]=Math.sign(aa[la])*Math.floor(Math.abs(aa[la]));return ba}function G(aa,ha,ba){const [ka,la]=aa;aa=ka.length;ba=w.createEmptyBand(ba,aa);for(let ca=0;ca<aa;ca++)if(!ha||ha[ca])ba[ca]=ka[ca]/la[ca];return ba}function h(aa,ha,ba){return G(aa,ha,"f32")}function m(aa,ha,ba){const [ka,la]=aa;aa=ka.length;ba=w.createEmptyBand(ba,aa);for(let ca=0;ca<
aa;ca++)if(!ha||ha[ca])ba[ca]=Math.floor(ka[ca]/la[ca]);return ba}function n(aa,ha,ba,ka){aa=aa[0];const la=aa.length;ba=w.createEmptyBand(ba,la);if(ka===E.localTrigonometricOperation.atanh){for(ka=0;ka<la;ka++)if(ha[ka]){var ca=aa[ka];1<=Math.abs(ca)?ha[ka]=0:ba[ka]=Math.atanh(ca)}return ba}ka=ka===E.localTrigonometricOperation.asin?Math.asin:Math.acos;for(ca=0;ca<la;ca++)if(ha[ca]){const pa=aa[ca];1<Math.abs(pa)?ha[ca]=0:ba[ca]=ka(pa)}return ba}function g(aa,ha,ba,ka){[aa]=aa;const la=aa.length;
ba=w.createEmptyBand(ba,la);for(let ca=0;ca<la;ca++)if(!ha||ha[ca])ba[ca]=ka(aa[ca]);return ba}function c(aa,ha,ba,ka){const [la,ca]=aa;aa=la.length;ba=w.createEmptyBand(ba,aa);for(let pa=0;pa<aa;pa++)if(!ha||ha[pa])ba[pa]=ka(la[pa],ca[pa]);return ba}function t(aa,ha,ba){const [ka,la]=aa;aa=ka.length;ba=w.createEmptyBand(ba,aa);for(let ca=0;ca<aa;ca++)if(!ha||ha[ca])ba[ca]=ka[ca]&la[ca];return ba}function A(aa,ha,ba){const [ka,la]=aa;aa=ka.length;ba=w.createEmptyBand(ba,aa);for(let ca=0;ca<aa;ca++)if(!ha||
ha[ca])ba[ca]=ka[ca]<<la[ca];return ba}function r(aa,ha,ba){[aa]=aa;const ka=aa.length;ba=w.createEmptyBand(ba,ka);for(let la=0;la<ka;la++)if(!ha||ha[la])ba[la]=~aa[la];return ba}function b(aa,ha,ba){const [ka,la]=aa;aa=ka.length;ba=w.createEmptyBand(ba,aa);for(let ca=0;ca<aa;ca++)if(!ha||ha[ca])ba[ca]=ka[ca]|la[ca];return ba}function f(aa,ha,ba){const [ka,la]=aa;aa=ka.length;ba=w.createEmptyBand(ba,aa);for(let ca=0;ca<aa;ca++)if(!ha||ha[ca])ba[ca]=ka[ca]>>la[ca];return ba}function d(aa,ha,ba){const [ka,
la]=aa;aa=ka.length;ba=w.createEmptyBand(ba,aa);for(let ca=0;ca<aa;ca++)if(!ha||ha[ca])ba[ca]=ka[ca]^la[ca];return ba}function e(aa,ha,ba){const [ka,la]=aa;aa=ka.length;ba=w.createEmptyBand(ba,aa);for(let ca=0;ca<aa;ca++)if(!ha||ha[ca])ba[ca]=ka[ca]&&la[ca]?1:0;return ba}function q(aa,ha,ba){[aa]=aa;const ka=aa.length;ba=w.createEmptyBand(ba,ka);for(let la=0;la<ka;la++)if(!ha||ha[la])ba[la]=aa[la]?0:1;return ba}function l(aa,ha,ba){const [ka,la]=aa;aa=ka.length;ba=w.createEmptyBand(ba,aa);for(let ca=
0;ca<aa;ca++)if(!ha||ha[ca])ba[ca]=ka[ca]||la[ca]?1:0;return ba}function a(aa,ha,ba){const [ka,la]=aa;aa=ka.length;ba=w.createEmptyBand(ba,aa);for(let ca=0;ca<aa;ca++)if(!ha||ha[ca])ba[ca]=(ka[ca]?1:0)^(la[ca]?1:0);return ba}function k(aa,ha,ba){const [ka,la]=aa;aa=ka.length;ba=w.createEmptyBand(ba,aa);for(let ca=0;ca<aa;ca++)if(!ha||ha[ca])ba[ca]=ka[ca]===la[ca]?1:0;return ba}function p(aa,ha,ba,ka){[aa]=aa;const la=aa.length;ba=w.createEmptyBand(ba,la);const ca=ka===Math.E;for(let pa=0;pa<la;pa++)if(!ha||
ha[pa])ba[pa]=ca?Math.exp(aa[pa]):ka**aa[pa];return ba}function z(aa,ha,ba){return p(aa,ha,ba,10)}function I(aa,ha,ba){return p(aa,ha,ba,2)}function N(aa,ha,ba){return p(aa,ha,ba,Math.E)}function O(aa,ha,ba,ka){[aa]=aa;const la=aa.length;ba=w.createEmptyBand(ba,la);for(let ca=0;ca<la;ca++)if(!ha||ha[ca])0>=aa[ca]?ha[ca]=0:ba[ca]=ka(aa[ca]);return ba}function H(aa,ha,ba){return O(aa,ha,ba,Math.log10)}function u(aa,ha,ba){return O(aa,ha,ba,Math.log2)}function y(aa,ha,ba){return O(aa,ha,ba,Math.log)}
function x(aa,ha,ba){const [ka,la]=aa;aa=ka.length;ba=w.createEmptyBand(ba,aa);for(let ca=0;ca<aa;ca++)if(!ha||ha[ca])ba[ca]=ka[ca]>la[ca]?1:0;return ba}function L(aa,ha,ba){const [ka,la]=aa;aa=ka.length;ba=w.createEmptyBand(ba,aa);for(let ca=0;ca<aa;ca++)if(!ha||ha[ca])ba[ca]=ka[ca]>=la[ca]?1:0;return ba}function Q(aa,ha,ba){const [ka,la]=aa;aa=ka.length;ba=w.createEmptyBand(ba,aa);for(let ca=0;ca<aa;ca++)if(!ha||ha[ca])ba[ca]=ka[ca]<la[ca]?1:0;return ba}function W(aa,ha,ba){const [ka,la]=aa;aa=
ka.length;ba=w.createEmptyBand(ba,aa);for(let ca=0;ca<aa;ca++)if(!ha||ha[ca])ba[ca]=ka[ca]<=la[ca]?1:0;return ba}function v(aa,ha,ba){[aa]=aa;aa=aa.length;ba=w.createEmptyBand(ba,aa);if(!ha)return ba;for(let ka=0;ka<aa;ka++)ba[ka]=ha[ka]?0:1;return ba}function F(aa,ha,ba){const [ka,la]=aa;aa=ka.length;ba=w.createEmptyBand(ba,aa);for(let ca=0;ca<aa;ca++)if(!ha||ha[ca])ba[ca]=ka[ca]%la[ca];return ba}function J(aa,ha,ba){[aa]=aa;const ka=aa.length;ba=w.createEmptyBand(ba,ka);for(let la=0;la<ka;la++)if(!ha||
ha[la])ba[la]=-aa[la];return ba}function M(aa,ha,ba){const [ka,la]=aa;aa=ka.length;ba=w.createEmptyBand(ba,aa);for(let ca=0;ca<aa;ca++)if(!ha||ha[ca])ba[ca]=ka[ca]===la[ca]?0:1;return ba}function U(aa,ha,ba){const [ka,la]=aa;aa=ka.length;ba=w.createEmptyBand(ba,aa);const ca=new Uint8Array(aa);for(let pa=0;pa<aa;pa++)null!=ha&&!ha[pa]||0!==ka[pa]||(ba[pa]=la[pa],ca[pa]=255);return{band:ba,mask:ca}}function V(aa,ha,ba){const [ka,la,ca]=aa;aa=ka.length;ba=w.createEmptyBand(ba,aa);for(let pa=0;pa<aa;pa++)if(!ha||
ha[pa])ba[pa]=ka[pa]?la[pa]:ca[pa];return ba}function X(aa,ha,ba){const ka=aa.length;if(2>ka)return aa[0];const [la]=aa,ca=la.length;ba=w.createEmptyBand(ba,ca);for(let pa=0;pa<ca;pa++)if(!ha||ha[pa]){let ua=la[pa];for(let ta=1;ta<ka;ta++){const ya=aa[ta][pa];ua<ya&&(ua=ya)}ba[pa]=ua}return ba}function Z(aa,ha,ba){const ka=aa.length;if(2>ka)return aa[0];const [la]=aa,ca=la.length;ba=w.createEmptyBand(ba,ca);for(let pa=0;pa<ca;pa++)if(!ha||ha[pa]){let ua=la[pa];for(let ta=1;ta<ka;ta++){const ya=aa[ta][pa];
ua>ya&&(ua=ya)}ba[pa]=ua}return ba}function Y(aa,ha,ba){const ka=aa.length;if(2>ka)return aa[0];const [la]=aa,ca=la.length;ba=w.createEmptyBand(ba,ca);for(let pa=0;pa<ca;pa++)if(!ha||ha[pa]){let ua=la[pa],ta=ua;for(let ya=1;ya<ka;ya++){const za=aa[ya][pa];ta<za?ta=za:ua>za&&(ua=za)}ba[pa]=ta-ua}return ba}function ea(aa,ha,ba){const ka=aa.length;if(2>ka)return aa[0];var [la]=aa;la=la.length;ba=w.createEmptyBand(ba,la);for(let ca=0;ca<la;ca++)if(!ha||ha[ca]){let pa=0;for(let ua=0;ua<ka;ua++)pa+=aa[ua][ca];
ba[ca]=pa/ka}return ba}function da(aa,ha,ba){const ka=aa.length;if(2>ka)return aa[0];var [la]=aa;la=la.length;ba=w.createEmptyBand(ba,la);for(let ca=0;ca<la;ca++)if(!ha||ha[ca])for(let pa=0;pa<ka;pa++)ba[ca]+=aa[pa][ca];return ba}function ia(aa,ha,ba){const ka=aa.length;if(2>ka)return aa[0];var [la]=aa;la=la.length;ba=w.createEmptyBand(ba,la);for(let ua=0;ua<la;ua++)if(!ha||ha[ua]){const ta=new Float32Array(ka);let ya=0;for(var ca=0;ca<ka;ca++){var pa=aa[ca];ya+=pa[ua];ta[ca]=pa[ua]}ya/=ka;ca=0;for(pa=
0;pa<ka;pa++)ca+=(ta[pa]-ya)**2;ba[ua]=Math.sqrt(ca/ka)}return ba}function fa(aa,ha,ba){const ka=aa.length;if(2>ka)return aa[0];const la=Math.floor(ka/2);var [ca]=aa;ca=ca.length;ba=w.createEmptyBand(ba,ca);const pa=new Float32Array(ka),ua=1===ka%2;for(let ta=0;ta<ca;ta++)if(!ha||ha[ta]){for(let ya=0;ya<ka;ya++)pa[ya]=aa[ya][ta];pa.sort();ba[ta]=ua?pa[la]:(pa[la]+pa[la-1])/2}return ba}function ja(aa,ha,ba){const [ka,la]=aa;if(null==la)return ka;aa=ka.length;ba=w.createEmptyBand(ba,aa);for(let ca=
0;ca<aa;ca++)ha[ca]&&(ka[ca]===la[ca]?ba[ca]=ka[ca]:ha[ca]=0);return ba}function ma(aa,ha,ba){const ka=aa.length;if(2>=ka)return ja(aa,ha,ba);const la=aa[0].length;ba=w.createEmptyBand(ba,la);const ca=new Map;for(let ua=0;ua<la;ua++)if(!ha||ha[ua]){ca.clear();let ta;for(var pa=0;pa<ka;pa++)ta=aa[pa][ua],ca.set(ta,ca.has(ta)?ca.get(ta)+1:1);let ya=pa=0;for(const za of ca.keys())pa=ca.get(za),pa>ya&&(ya=pa,ta=za);ba[ua]=ta}return ba}function na(aa,ha,ba){const ka=aa.length;if(2>=ka)return ja(aa,ha,
ba);const la=aa[0].length;ba=w.createEmptyBand(ba,la);const ca=new Map;for(let ua=0;ua<la;ua++)if(!ha||ha[ua]){ca.clear();let ta;for(var pa=0;pa<ka;pa++)ta=aa[pa][ua],ca.set(ta,ca.has(ta)?ca.get(ta)+1:1);pa=0;let ya=aa.length;for(const za of ca.keys())pa=ca.get(za),pa<ya&&(ya=pa,ta=za);ba[ua]=ta}return ba}function ra(aa,ha,ba){const ka=aa.length;if(2>ka)return aa[0];var [la]=aa;la=la.length;ba=w.createEmptyBand(ba,la);const ca=new Set;for(let pa=0;pa<la;pa++)if(!ha||ha[pa]){ca.clear();let ua;for(let ta=
0;ta<ka;ta++)ua=aa[ta][pa],ca.add(ua);ba[pa]=ca.size}return ba}function qa(aa,ha,ba,ka){let [la,ca]=C.getPixelValueRange(ba);if(ba=ba.startsWith("u")||ba.startsWith("s"))la-=1E-5,ca+=1E-5;for(let pa=0;pa<ha.length;pa++)if(ha[pa]){const ua=aa[pa];isNaN(ua)||ua<la||ua>ca?ha[pa]=0:ka[pa]=ba?Math.round(ua):ua}}const va=new Map;va.set(E.localTrigonometricOperation.acos,[0,Math.PI]);va.set(E.localTrigonometricOperation.asin,[-Math.PI/2,Math.PI/2]);va.set(E.localTrigonometricOperation.atan,[-Math.PI/2,Math.PI/
2]);va.set(E.localTrigonometricOperation.cos,[-1,1]);va.set(E.localTrigonometricOperation.sin,[-1,1]);va.set(E.localLogicalOperation.booleanAnd,[0,1]);va.set(E.localLogicalOperation.booleanNot,[0,1]);va.set(E.localLogicalOperation.booleanOr,[0,1]);va.set(E.localLogicalOperation.booleanXOr,[0,1]);va.set(E.localLogicalOperation.equalTo,[0,1]);va.set(E.localLogicalOperation.notEqual,[0,1]);va.set(E.localLogicalOperation.greaterThan,[0,1]);va.set(E.localLogicalOperation.greaterThanEqual,[0,1]);va.set(E.localLogicalOperation.lessThan,
[0,1]);va.set(E.localLogicalOperation.lessThanEqual,[0,1]);va.set(E.localLogicalOperation.isNull,[0,1]);const sa=new Map,xa=new Map,oa=new Map,wa=new Map;P.getOutputDomain=function(aa){return va.get(aa)};P.local=function(aa,ha,ba={}){sa.size||(sa.set(4,Math.sqrt),sa.set(6,Math.acos),sa.set(7,Math.asin),sa.set(8,Math.atan),sa.set(9,Math.atanh),sa.set(10,Math.abs),sa.set(21,Math.cos),sa.set(22,Math.cosh),sa.set(48,Math.floor),sa.set(49,Math.ceil),sa.set(51,Math.sin),sa.set(52,Math.sinh),sa.set(56,Math.tan),
sa.set(57,Math.tanh),sa.set(59,Math.acosh),sa.set(60,Math.asinh),sa.set(65,Math.floor),xa.set(5,Math.pow),xa.set(61,Math.atan2),oa.set(1,T),oa.set(2,S),oa.set(3,K),oa.set(11,t),oa.set(12,A),oa.set(12,A),oa.set(13,r),oa.set(14,b),oa.set(15,f),oa.set(16,d),oa.set(17,e),oa.set(18,q),oa.set(19,l),oa.set(20,a),oa.set(23,G),oa.set(24,k),oa.set(25,N),oa.set(26,z),oa.set(27,I),oa.set(28,x),oa.set(29,L),oa.set(30,D),oa.set(31,v),oa.set(32,R),oa.set(33,Q),oa.set(34,W),oa.set(35,y),oa.set(36,H),oa.set(37,u),
oa.set(44,F),oa.set(45,J),oa.set(46,M),oa.set(64,h),oa.set(65,m),oa.set(76,V),oa.set(78,V),wa.set(38,ma),wa.set(39,X),wa.set(40,ea),wa.set(41,fa),wa.set(42,Z),wa.set(43,na),wa.set(47,Y),wa.set(54,ia),wa.set(55,da),wa.set(58,ra),wa.set(66,ma),wa.set(67,X),wa.set(68,ea),wa.set(69,fa),wa.set(70,Z),wa.set(71,na),wa.set(72,Y),wa.set(73,ia),wa.set(74,da),wa.set(75,ra));var ka=B(aa,66<=ha&&75>=ha);const {outputPixelType:la="f32"}=ba,ca=!wa.has(ha)||ba.processAsMultiband,pa=ca?aa[0].pixels.length:1;ba=[];
for(let ya=0;ya<pa;ya++){var ua=wa.has(ha)&&!ca?aa.flatMap(za=>za.pixels):aa.map(za=>za.pixels[ya]),ta=!0;ha===E.localConditionalOperation.setNull?(ka=U(ua,ka,la),ua=ka.band,ka=ka.mask,ta=!1):oa.has(ha)?ua=oa.get(ha)(ua,ka,"f64"):sa.has(ha)?ua=ha===E.localTrigonometricOperation.asin||ha===E.localTrigonometricOperation.acos||ha===E.localTrigonometricOperation.atanh?n(ua,ka,"f64",ha):g(ua,ka,"f64",sa.get(ha)):xa.has(ha)?ua=c(ua,ka,"f64",xa.get(ha)):wa.has(ha)?ua=wa.get(ha)(ua,ka,"f64"):(ua=ua[0],ta=
!1);ta&&ha!==E.localLogicalOperation.isNull&&!va.has(ha)&&(ta=w.createEmptyBand(la,ua.length),ka||(ka=(new Uint8Array(ua.length)).fill(255)),qa(ua,ka,la,ta),ua=ta);ba.push(ua)}aa=aa[0];return new w({width:aa.width,height:aa.height,pixelType:la,mask:ha===E.localLogicalOperation.isNull?null:ka,pixels:ba})};P.operandsCount=[0,2,2,2,1,2,1,1,1,1,1,2,2,1,2,2,2,2,1,2,2,1,1,2,2,1,1,1,2,2,1,1,1,2,2,1,1,1,999,999,999,999,999,999,2,1,2,999,1,1,2,1,1,1,999,999,1,1,999,1,1,2,999,999,2,2,999,999,999,999,999,999,
999,999,999,999,3,999,3];Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/MaskFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/mathUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./MaskFunctionArguments ./pixelUtils".split(" "),
function(P,w,E,C,B,T,R,S,K,D,G){B=function(h){function m(){var g=h.apply(this,arguments)||this;g.functionName="Mask";g.functionArguments=null;g.rasterArgumentNames=["raster"];return g}P._inherits(m,h);var n=m.prototype;n._bindSourceRasters=function(){var g=this.sourceRasterInfos[0].clone();const {pixelType:c}=g;this.outputPixelType=this._getOutputPixelType(c);g.pixelType=this.outputPixelType;this.rasterInfo=g;const {includedRanges:t,normalizedNoDataValues:A}=this.functionArguments;if(!t?.length&&
!A?.length)return{success:!1,supportsGPU:!1,error:"missing includedRanges or noDataValues argument"};let r=[];for(let b=0;b<g.bandCount;b++){const f=G.createMaskLUT(c,t?.slice(2*b,2*b+2),A?.[b]);if(null==f){r=null;break}r.push(f)}this.lookups=r;g=null!=A&&A.every(b=>b?.length===A[0]?.length);return{success:!0,supportsGPU:(!t||t.length<=2*G.MAX_MAP_SIZE_GPU)&&(!A||g&&A[0].length<=G.MAX_MAP_SIZE_GPU)}};n._processPixels=function(g){g=g.pixelBlocks?.[0];if(null==g)return null;const {outputPixelType:c,
lookups:t}=this,{includedRanges:A,noDataInterpretation:r,normalizedNoDataValues:b}=this.functionArguments;return G.mask(g,{includedRanges:A,noDataValues:b,outputPixelType:c,matchAll:r===G.NoDataInterpretation.matchAll,lookups:t})};n._getWebGLParameters=function(){const {includedRanges:g,normalizedNoDataValues:c}=this.functionArguments,t=new Float32Array(G.MAX_MAP_SIZE_GPU);t.fill(E.NUMBER_MAX_FLOAT32);c?.[0]?.length&&t.set(c[0]);const A=new Float32Array(G.MAX_MAP_SIZE_GPU);for(let r=0;r<A.length;r+=
2)A[r]=g?.[r]??-E.NUMBER_MAX_FLOAT32,A[r+1]=g?.[r+1]??E.NUMBER_MAX_FLOAT32;g&&g.length&&A.set(g);return{bandCount:this.sourceRasterInfos[0].bandCount,noDataValues:t,includedRanges:A}};return P._createClass(m)}(K);w.__decorate([C.property({json:{write:!0,name:"rasterFunction"}})],B.prototype,"functionName",void 0);w.__decorate([C.property({type:D,json:{write:!0,name:"rasterFunctionArguments"}})],B.prototype,"functionArguments",void 0);w.__decorate([C.property()],B.prototype,"rasterArgumentNames",void 0);
w.__decorate([C.property({json:{write:!0}})],B.prototype,"lookups",void 0);return B=w.__decorate([S.subclass("esri.layers.support.rasterFunctions.MaskFunction")],B)})},"esri/layers/support/rasterFunctions/MaskFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ./pixelUtils".split(" "),
function(P,w,E,C,B,T,R,S,K){var D;C=D=function(G){function h(){var m=G.apply(this,arguments)||this;m.includedRanges=null;m.noDataValues=null;m.noDataInterpretation=K.NoDataInterpretation.matchAny;return m}P._inherits(h,G);h.prototype.clone=function(){return new D({includedRanges:this.includedRanges?.slice()??[],noDataValues:this.noDataValues?.slice()??[],noDataInterpretation:this.noDataInterpretation})};P._createClass(h,[{key:"normalizedNoDataValues",get:function(){var {noDataValues:m}=this;if(!m?.length)return null;
let n=!1;m=m.map(g=>"number"===typeof g?(n=!0,[g]):"string"===typeof g?(g=g.trim().split(" ").filter(c=>""!==c.trim()).map(c=>Number(c)),n=n||0<g.length,0===g.length?null:g):null);return n?m:null}}]);return h}(S);w.__decorate([E.property({json:{write:!0}})],C.prototype,"includedRanges",void 0);w.__decorate([E.property({json:{write:!0}})],C.prototype,"noDataValues",void 0);w.__decorate([E.property()],C.prototype,"normalizedNoDataValues",null);w.__decorate([E.property({json:{write:!0}})],C.prototype,
"noDataInterpretation",void 0);return C=D=w.__decorate([R.subclass("esri.layers.support.rasterFunctions.MaskFunctionArguments")],C)})},"esri/layers/support/rasterFunctions/NDVIFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./bandIndexUtils ./BaseRasterFunction ./NDVIFunctionArguments".split(" "),
function(P,w,E,C,B,T,R,S,K,D){C=function(G){function h(){var n=G.apply(this,arguments)||this;n.functionName="NDVI";n.functionArguments=null;n.rasterArgumentNames=["raster"];return n}P._inherits(h,G);var m=h.prototype;m._bindSourceRasters=function(){const {scientificOutput:n,visibleBandID:g,infraredBandID:c}=this.functionArguments;this.outputPixelType=this._getOutputPixelType(n?"f32":"u8");var t=this.sourceRasterInfos[0];const A=Math.max(g,c);if(2>t.bandCount||A>=t.bandCount)return{success:!1,supportsGPU:!1,
error:"ndvi-function: source raster has insufficient amount of raster bands"};t=t.clone();t.pixelType=this.outputPixelType;t.colormap=null;t.histograms=null;t.bandCount=1;t.keyProperties={...t.keyProperties,BandProperties:void 0};const [r,b,f,d]=n?[-1,1,0,.1]:[0,200,100,10];t.statistics=[{min:r,max:b,avg:f,stddev:d}];this.rasterInfo=t;return{success:!0,supportsGPU:!0}};m._processPixels=function(n){n=n.pixelBlocks?.[0];if(null==n)return null;const {visibleBandID:g,infraredBandID:c,scientificOutput:t}=
this.functionArguments;return S.calculateNDVI(n,g,c,!t)};m._getWebGLParameters=function(){const {visibleBandID:n,infraredBandID:g,scientificOutput:c}=this.functionArguments;return{bandIndexMat3:S.getBandMatrix3(this.isInputBandIdsSwizzled?[0,1,2]:[g,n,0]),scaled:!c}};m._getInputBandIds=function(n){const {visibleBandID:g,infraredBandID:c}=this.functionArguments;return[c,g,0].map(t=>n[t])};return P._createClass(h)}(K);w.__decorate([E.property({json:{write:!0,name:"rasterFunction"}})],C.prototype,"functionName",
void 0);w.__decorate([E.property({type:D,json:{write:!0,name:"rasterFunctionArguments"}})],C.prototype,"functionArguments",void 0);w.__decorate([E.property()],C.prototype,"rasterArgumentNames",void 0);return C=w.__decorate([R.subclass("esri.layers.support.rasterFunctions.NDVIFunction")],C)})},"esri/layers/support/rasterFunctions/NDVIFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(P,w,E,C,B,T,R,S){var K;C=K=function(D){function G(){var h=D.apply(this,arguments)||this;h.visibleBandID=0;h.infraredBandID=1;h.scientificOutput=!1;return h}P._inherits(G,D);G.prototype.clone=function(){const {visibleBandID:h,infraredBandID:m,scientificOutput:n}=this;return new K({visibleBandID:h,infraredBandID:m,scientificOutput:n})};return P._createClass(G)}(S);w.__decorate([E.property({json:{write:!0}})],C.prototype,"visibleBandID",void 0);w.__decorate([E.property({json:{write:!0}})],C.prototype,
"infraredBandID",void 0);w.__decorate([E.property({json:{write:!0}})],C.prototype,"scientificOutput",void 0);return C=K=w.__decorate([R.subclass("esri.layers.support.rasterFunctions.NDVIFunctionArguments")],C)})},"esri/layers/support/rasterFunctions/RemapFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/mathUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./pixelUtils ./RemapFunctionArguments".split(" "),
function(P,w,E,C,B,T,R,S,K,D,G,h){B=function(m){function n(){var c=m.apply(this,arguments)||this;c.functionName="Remap";c.functionArguments=null;c.rasterArgumentNames=["raster"];c.lookup=null;return c}P._inherits(n,m);var g=n.prototype;g._bindSourceRasters=function(){const c=this.sourceRasterInfos[0].clone(),{pixelType:t}=c;this.outputPixelType=this._getOutputPixelType(t);c.pixelType=this.outputPixelType;c.colormap=null;c.histograms=null;c.bandCount=1;c.attributeTable=null;const {statistics:A}=c,
{allowUnmatched:r,outputValues:b,inputRanges:f,noDataRanges:d,isLastInputRangeInclusive:e}=this.functionArguments;if(null!=A&&A.length&&b?.length)if(r){var q=Math.min.apply(null,[...b,A[0].min]),l=Math.max.apply(null,[...b,A[0].max]);c.statistics=[{...A[0],min:q,max:l}]}else{l=q=b[0];for(let a=0;a<b.length;a++)q=q>b[a]?b[a]:q,l=l>b[a]?l:b[a];c.statistics=[{...A[0],min:q,max:l}]}this.rasterInfo=c;this.lookup=r?null:G.createRemapLUT({srcPixelType:t,inputRanges:f,outputValues:b,noDataRanges:d,allowUnmatched:r,
isLastInputRangeInclusive:e,outputPixelType:this.outputPixelType});return{success:!0,supportsGPU:(!b||b.length<=G.MAX_MAP_SIZE_GPU)&&(!d||d.length<=G.MAX_MAP_SIZE_GPU)}};g._processPixels=function(c){c=c.pixelBlocks?.[0];if(null==c)return null;const {lookup:t,outputPixelType:A}=this;if(t){const q=G.lookupPixels(c,{lut:[t.lut],offset:t.offset,outputPixelType:A});null!=q&&t.mask&&(q.mask=G.lookupBandValues(c.pixels[0],c.mask,t.mask,t.offset,"u8"));return q}const {inputRanges:r,outputValues:b,noDataRanges:f,
allowUnmatched:d,isLastInputRangeInclusive:e}=this.functionArguments;return G.remap(c,{inputRanges:r,outputValues:b,noDataRanges:f,outputPixelType:A,allowUnmatched:d,isLastInputRangeInclusive:e})};g._getWebGLParameters=function(){const {allowUnmatched:c,noDataRanges:t,isLastInputRangeInclusive:A}=this.functionArguments,r=new Float32Array(3*G.MAX_MAP_SIZE_GPU);var b=this.functionArguments.inputRanges??[],f=this.functionArguments.outputValues??[];const d=f.length;for(let e=0;e<G.MAX_MAP_SIZE_GPU;e++)if(r[3*
e]=b[2*e]??E.NUMBER_MAX_FLOAT32-1,r[3*e+1]=b[2*e+1]??E.NUMBER_MAX_FLOAT32,r[3*e+2]=f[e]??0,e<d&&(0<e&&(r[3*e]-=1E-5),e<d-1||!A))r[3*e+1]-=1E-5;b=new Float32Array(2*G.MAX_MAP_SIZE_GPU);b.fill(E.NUMBER_MAX_FLOAT32);t?.length&&b.set(t);f=K.getPixelValueRange(this.outputPixelType);return{allowUnmatched:c,rangeMaps:r,noDataRanges:b,clampRange:f}};return P._createClass(n)}(D);w.__decorate([C.property({json:{write:!0,name:"rasterFunction"}})],B.prototype,"functionName",void 0);w.__decorate([C.property({type:h,
json:{write:!0,name:"rasterFunctionArguments"}})],B.prototype,"functionArguments",void 0);w.__decorate([C.property()],B.prototype,"rasterArgumentNames",void 0);w.__decorate([C.property({json:{write:!0}})],B.prototype,"lookup",void 0);return B=w.__decorate([S.subclass("esri.layers.support.rasterFunctions.RemapFunction")],B)})},"esri/layers/support/rasterFunctions/RemapFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(P,w,E,C,B,T,R,S){var K;C=K=function(D){function G(){var h=D.apply(this,arguments)||this;h.inputRanges=null;h.outputValues=null;h.noDataRanges=null;h.allowUnmatched=!1;h.isLastInputRangeInclusive=!1;return h}P._inherits(G,D);G.prototype.clone=function(){return new K({inputRanges:[...this.inputRanges],outputValues:[...this.outputValues],noDataRanges:[...this.noDataRanges],allowUnmatched:this.allowUnmatched,isLastInputRangeInclusive:this.isLastInputRangeInclusive})};return P._createClass(G)}(S);
w.__decorate([E.property({json:{write:!0}})],C.prototype,"inputRanges",void 0);w.__decorate([E.property({json:{write:!0}})],C.prototype,"outputValues",void 0);w.__decorate([E.property({json:{write:!0}})],C.prototype,"noDataRanges",void 0);w.__decorate([E.property({json:{write:!0}})],C.prototype,"allowUnmatched",void 0);w.__decorate([E.property({json:{write:!0}})],C.prototype,"isLastInputRangeInclusive",void 0);return C=K=w.__decorate([R.subclass("esri.layers.support.rasterFunctions.RemapFunctionArguments")],
C)})},"esri/layers/support/rasterFunctions/SlopeFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./SlopeFunctionArguments ./surfaceUtils".split(" "),function(P,w,E,C,B,T,R,S,K,D){C=function(G){function h(){var n=G.apply(this,arguments)||this;n.functionName=
"Slope";n.functionArguments=null;n.rasterArgumentNames=["raster"];n.isGCS=!1;return n}P._inherits(h,G);var m=h.prototype;m._bindSourceRasters=function(){this.outputPixelType=this._getOutputPixelType("f32");const n=this.sourceRasterInfos[0].clone();n.pixelType=this.outputPixelType;n.statistics="percent-rise"!==this.functionArguments.slopeType?[{min:0,max:90,avg:1,stddev:1}]:null;n.histograms=null;n.colormap=null;n.attributeTable=null;n.bandCount=1;this.rasterInfo=n;this.isGCS=n.spatialReference?.isGeographic??
!1;return{success:!0,supportsGPU:!0}};m._processPixels=function(n){const g=n.pixelBlocks?.[0];if(null==g)return null;const {zFactor:c,slopeType:t,pixelSizePower:A,pixelSizeFactor:r}=this.functionArguments,{isGCS:b}=this,{extent:f,primaryPixelSizes:d}=n;n=d?.[0];return D.slope(g,{zFactor:c,slopeType:t,pixelSizePower:A,pixelSizeFactor:r,isGCS:b,resolution:null==n?f?{x:f.width/g.width,y:f.height/g.height}:{x:1,y:1}:n})};m._getWebGLParameters=function(){const {zFactor:n,slopeType:g,pixelSizeFactor:c,
pixelSizePower:t}=this.functionArguments;return{zFactor:this.isGCS&&1<=n?n*D.GCS_FACTOR:n,slopeType:g,pixelSizeFactor:c??0,pixelSizePower:t??0}};return P._createClass(h)}(S);w.__decorate([E.property({json:{write:!0,name:"rasterFunction"}})],C.prototype,"functionName",void 0);w.__decorate([E.property({type:K,json:{write:!0,name:"rasterFunctionArguments"}})],C.prototype,"functionArguments",void 0);w.__decorate([E.property()],C.prototype,"rasterArgumentNames",void 0);w.__decorate([E.property({json:{write:!0}})],
C.prototype,"isGCS",void 0);return C=w.__decorate([R.subclass("esri.layers.support.rasterFunctions.SlopeFunction")],C)})},"esri/layers/support/rasterFunctions/SlopeFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(P,w,E,C,B,T,R,S,K,D){var G;E=new E.JSONMap({1:"degree",2:"percent-rise",3:"adjusted"},{useNumericKeys:!0});D=G=function(h){function m(){var n=h.apply(this,arguments)||this;n.slopeType="degree";n.zFactor=1;n.pixelSizePower=.664;n.pixelSizeFactor=.024;n.removeEdgeEffect=!1;return n}P._inherits(m,h);m.prototype.clone=function(){return new G({slopeType:this.slopeType,zFactor:this.zFactor,pixelSizePower:this.pixelSizePower,pixelSizeFactor:this.pixelSizeFactor,removeEdgeEffect:this.removeEdgeEffect,
raster:this.raster})};return P._createClass(m)}(D);w.__decorate([S.enumeration(E)],D.prototype,"slopeType",void 0);w.__decorate([C.property({type:Number,json:{write:!0}})],D.prototype,"zFactor",void 0);w.__decorate([C.property({type:Number,json:{name:"psPower",write:!0}})],D.prototype,"pixelSizePower",void 0);w.__decorate([C.property({type:Number,json:{name:"psZFactor",write:!0}})],D.prototype,"pixelSizeFactor",void 0);w.__decorate([C.property({type:Boolean,json:{write:!0}})],D.prototype,"removeEdgeEffect",
void 0);return D=G=w.__decorate([K.subclass("esri.layers.support.rasterFunctions.SlopeFunctionArguments")],D)})},"esri/layers/support/rasterFunctions/StatisticsHistogramFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./StatisticsHistogramFunctionArguments".split(" "),
function(P,w,E,C,B,T,R,S,K){C=function(D){function G(){var m=D.apply(this,arguments)||this;m.functionName="StatisticsHistogram";m.functionArguments=null;m.rasterArgumentNames=["raster"];m.isNoopProcess=!0;return m}P._inherits(G,D);var h=G.prototype;h._bindSourceRasters=function(){var m=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType("u8");m=m.clone();const {statistics:n,histograms:g}=this.functionArguments;g&&(m.histograms=g);n&&(m.statistics=n);this.rasterInfo=m;return{success:!0,
supportsGPU:!0}};h._processPixels=function(m){return m.pixelBlocks?.[0]};return P._createClass(G)}(S);w.__decorate([E.property({json:{write:!0,name:"rasterFunction"}})],C.prototype,"functionName",void 0);w.__decorate([E.property({type:K,json:{write:!0,name:"rasterFunctionArguments"}})],C.prototype,"functionArguments",void 0);w.__decorate([E.property()],C.prototype,"rasterArgumentNames",void 0);w.__decorate([E.property({json:{write:!0}})],C.prototype,"indexedColormap",void 0);w.__decorate([E.property()],
C.prototype,"isNoopProcess",void 0);return C=w.__decorate([R.subclass("esri.layers.support.rasterFunctions.StatisticsHistogramFunction")],C)})},"esri/layers/support/rasterFunctions/StatisticsHistogramFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),
function(P,w,E,C,B,T,R,S,K){var D;B=D=function(G){function h(){var n=G.apply(this,arguments)||this;n.statistics=null;n.histograms=null;return n}P._inherits(h,G);var m=h.prototype;m.readStatistics=function(n,g){if(!n?.length)return null;const c=[];n.forEach(t=>{c.push({min:t.min,max:t.max,avg:t.avg??t.mean,stddev:t.stddev??t.standardDeviation})});return c};m.writeStatistics=function(n,g,c){if(n?.length){var t=[];n.forEach(A=>{A={...A,mean:A.avg,standardDeviation:A.stddev};delete A.avg;delete A.stddev;
t.push(A)});g[c]=t}};m.clone=function(){return new D({statistics:E.clone(this.statistics),histograms:E.clone(this.histograms)})};return P._createClass(h)}(K);w.__decorate([C.property({json:{write:!0}})],B.prototype,"statistics",void 0);w.__decorate([T.reader("statistics")],B.prototype,"readStatistics",null);w.__decorate([S.writer("statistics")],B.prototype,"writeStatistics",null);w.__decorate([C.property({json:{write:!0}})],B.prototype,"histograms",void 0);return B=D=w.__decorate([R.subclass("esri.layers.support.rasterFunctions.StatisticsHistogramFunctionArguments")],
B)})},"esri/layers/support/rasterFunctions/StretchFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./pixelUtils ./StretchFunctionArguments ./stretchUtils".split(" "),function(P,w,E,C,B,T,R,S,K,D,G){C=function(h){function m(){var g=h.apply(this,arguments)||
this;g.functionName="Stretch";g.functionArguments=null;g.rasterArgumentNames=["raster"];g.lookup=null;g.cutOffs=null;return g}P._inherits(m,h);var n=m.prototype;n._bindSourceRasters=function(){this.cutOffs=this.lookup=null;var g=this.sourceRasterInfos[0];const {pixelType:c}=g;var {functionArguments:t}=this;const {dynamicRangeAdjustment:A,gamma:r,useGamma:b}=t;if(!A&&["u8","u16","s8","s16"].includes(c)){t=G.getStretchCutoff(t.toJSON(),{rasterInfo:g});const f=this._isOutputRoundingNeeded()?"round":
"float";this.lookup=G.createStretchLUT({pixelType:c,...t,gamma:b?r:null,rounding:f});this.cutOffs=t}else A||(this.cutOffs=G.getStretchCutoff(t.toJSON(),{rasterInfo:g}));this.outputPixelType=this._getOutputPixelType(c);g=g.clone();g.pixelType=this.outputPixelType;g.statistics=null;g.histograms=null;g.colormap=null;g.attributeTable=null;"u8"===this.outputPixelType&&(g.keyProperties.DataType="processed");this.rasterInfo=g;return{success:!0,supportsGPU:!A}};n._processPixels=function(g){g=g.pixelBlocks?.[0];
if(null==g)return g;var {lookup:c}=this;if(c)return K.lookupPixels(g,{...c,outputPixelType:this.rasterInfo.pixelType});({functionArguments:c}=this);const t=this.cutOffs||G.getStretchCutoff(c.toJSON(),{rasterInfo:this.sourceRasterInfos[0],pixelBlock:g});return G.stretch(g,{...t,gamma:c.useGamma?c.gamma:null,outputPixelType:this.outputPixelType})};n._getWebGLParameters=function(){const {outputMin:g=0,outputMax:c=255,gamma:t,useGamma:A}=this.functionArguments,r=2<=this.rasterInfo.bandCount?3:1,b=A&&
t&&t.length?G.computeGammaCorrection(r,t):[1,1,1],{minCutOff:f,maxCutOff:d}=this.cutOffs??{minCutOff:[0,0,0],maxCutOff:[255,255,255]};1===f.length&&(f[1]=f[2]=f[0],d[1]=d[2]=d[0]);const e=new Float32Array(r);var q;for(q=0;q<r;q++)e[q]=(c-g)/(d[q]-f[q]);q=this._isOutputRoundingNeeded();return{bandCount:r,outMin:g,outMax:c,minCutOff:f,maxCutOff:d,factor:e,useGamma:A,gamma:A&&t?t:[1,1,1],gammaCorrection:A&&b?b:[1,1,1],stretchType:this.functionArguments.stretchType,isOutputRounded:q,type:"stretch"}};
return P._createClass(m)}(S);w.__decorate([E.property({json:{write:!0,name:"rasterFunction"}})],C.prototype,"functionName",void 0);w.__decorate([E.property({type:D,json:{write:!0,name:"rasterFunctionArguments"}})],C.prototype,"functionArguments",void 0);w.__decorate([E.property()],C.prototype,"rasterArgumentNames",void 0);w.__decorate([E.property({json:{write:!0}})],C.prototype,"lookup",void 0);w.__decorate([E.property({json:{write:!0}})],C.prototype,"cutOffs",void 0);return C=w.__decorate([R.subclass("esri.layers.support.rasterFunctions.StretchFunction")],
C)})},"esri/layers/support/rasterFunctions/StretchFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),function(P,w,E,C,B,T,R,S,K,
D){var G;E=new E.JSONMap({0:"none",3:"standard-deviation",4:"histogram-equalization",5:"min-max",6:"percent-clip",9:"sigmoid"},{useNumericKeys:!0});D=G=function(h){function m(){var g=h.apply(this,arguments)||this;g.computeGamma=!1;g.dynamicRangeAdjustment=!1;g.gamma=[];g.histograms=null;g.statistics=null;g.stretchType="none";g.useGamma=!1;return g}P._inherits(m,h);var n=m.prototype;n.writeStatistics=function(g,c,t){g?.length&&(Array.isArray(g[0])||(g=g.map(A=>[A.min,A.max,A.avg,A.stddev])),c[t]=g)};
n.clone=function(){return new G({stretchType:this.stretchType,outputMin:this.outputMin,outputMax:this.outputMax,useGamma:this.useGamma,computeGamma:this.computeGamma,statistics:C.clone(this.statistics),gamma:C.clone(this.gamma),sigmoidStrengthLevel:this.sigmoidStrengthLevel,numberOfStandardDeviations:this.numberOfStandardDeviations,minPercent:this.minPercent,maxPercent:this.maxPercent,histograms:C.clone(this.histograms),dynamicRangeAdjustment:this.dynamicRangeAdjustment,raster:this.raster})};return P._createClass(m)}(D);
w.__decorate([B.property({type:Boolean,json:{write:!0}})],D.prototype,"computeGamma",void 0);w.__decorate([B.property({type:Boolean,json:{name:"dra",write:!0}})],D.prototype,"dynamicRangeAdjustment",void 0);w.__decorate([B.property({type:[Number],json:{write:!0}})],D.prototype,"gamma",void 0);w.__decorate([B.property()],D.prototype,"histograms",void 0);w.__decorate([B.property({type:Number,json:{write:!0}})],D.prototype,"maxPercent",void 0);w.__decorate([B.property({type:Number,json:{write:!0}})],
D.prototype,"minPercent",void 0);w.__decorate([B.property({type:Number,json:{write:!0}})],D.prototype,"numberOfStandardDeviations",void 0);w.__decorate([B.property({type:Number,json:{name:"max",write:!0}})],D.prototype,"outputMax",void 0);w.__decorate([B.property({type:Number,json:{name:"min",write:!0}})],D.prototype,"outputMin",void 0);w.__decorate([B.property({type:Number,json:{write:!0}})],D.prototype,"sigmoidStrengthLevel",void 0);w.__decorate([B.property({json:{type:[[Number]],write:!0}})],D.prototype,
"statistics",void 0);w.__decorate([K.writer("statistics")],D.prototype,"writeStatistics",null);w.__decorate([R.enumeration(E)],D.prototype,"stretchType",void 0);w.__decorate([B.property({type:Boolean,json:{write:!0}})],D.prototype,"useGamma",void 0);return D=G=w.__decorate([S.subclass("esri.layers.support.rasterFunctions.StretchFunctionArguments")],D)})},"esri/layers/support/rasterFunctions/stretchUtils":function(){define(["exports","../../../core/maybe","../PixelBlock","../rasterFormats/pixelRangeUtils",
"../../../renderers/support/stretchRendererUtils"],function(P,w,E,C,B){function T(m,n=256){n=Math.min(n,256);const {size:g,counts:c}=m;m=new Uint8Array(g);var t=c.reduce((d,e)=>d+e/n,0);let A=0;var r=0;let b=0,f=t;for(let d=0;d<g;d++)if(b+=c[d],!(d<g-1&&b+c[d+1]<f)){for(;A<n-1&&f<b;)A++,f+=t;for(;r<=d;r++)m[r]=A;r=d+1}for(t=r;t<g;t++)m[t]=n-1;return m}function R(m,n){m=Math.min(Math.max(m,-100),100);n=Math.min(Math.max(n??0,-100),100);let g=0,c=0;const t=new Uint8Array(256);for(g=0;256>g;g++)0<m&&
100>m?c=(200*g-25500+510*n)/(2*(100-m))+128:0>=m&&-100<m?c=(200*g-25500+510*n)*(100+m)/2E4+128:100===m?(c=200*g-25500+256*(100-m)+510*n,c=0<c?255:0):-100===m&&(c=128),t[g]=255<c?255:0>c?0:c;return t}function S(m,n,g,c){let t=Infinity,A=-Infinity;var r=0,b=0;const f=m.length;for(var d=0;d<f;d++){var e=m[d];if(!n||n[d])t=e<t?e:t,A=e>A?e:A,r+=e,b++}if(0===b)return{statistics:{min:0,max:0,avg:0,stddev:0},histogram:null};r/=b;d=0;for(e=0;e<f;e++)if(!n||n[e])d+=(m[e]-r)**2;e=n?n.filter(q=>q).length:f;r=
{min:t,max:A,avg:r,stddev:1>=e?0:Math.sqrt(d/(e-1))};if(!c)return{statistics:r,histogram:null};if(["u8","s8","u4","u2","u1"].includes(g)){b=A-t+1;g=new Uint32Array(b);for(c=0;c<f;c++)n&&!n[c]||g[m[c]-t]++;return{statistics:r,histogram:{min:t-.5,max:A+.5,size:b,counts:g}}}g=new Uint32Array(256);c=(A-t)/256;if(0===c)return{statistics:r,histogram:{min:t,max:A,size:1,counts:(new Uint32Array(1)).fill(b)}};b=new Uint32Array(257);for(d=0;d<f;d++)n&&!n[d]||b[Math.floor((m[d]-t)/c)]++;for(m=0;255>m;m++)g[m]=
b[m];g[255]=b[255]+b[256];return{statistics:r,histogram:{min:t,max:A,size:256,counts:g}}}function K(m){if(null==m||!m.pixels?.length)return null;const {pixels:n,mask:g,bandMasks:c,pixelType:t}=m,A=m.width*m.height,r=n.length;let b,f;let d;var e;const q=[],l=[];for(d=0;d<r;d++){var a=new Uint32Array(256);var k=n[d];var p=c?.[d]??g;if("u8"===t)if(b=-.5,f=255.5,p)for(e=0;e<A;e++)p[e]&&a[k[e]]++;else for(e=0;e<A;e++)a[k[e]]++;else{e=!1;m.statistics||(m.updateStatistics(),e=!0);var z=m.statistics;b=z[d].minValue;
f=z[d].maxValue;var I=(f-b)/256;if(0===I)for(!z||m.validPixelCount||e||m.updateStatistics(),I=(m.validPixelCount||m.width*m.height)/256,e=0;256>e;e++)a[e]=Math.round(I*(e+1))-Math.round(I*e);else{z=new Uint32Array(257);for(e=0;e<A;e++)p&&!p[e]||z[Math.floor((k[e]-b)/I)]++;for(e=0;255>e;e++)a[e]=z[e];a[255]=z[255]+z[256]}}q.push({min:b,max:f,size:256,counts:a});for(e=p=k=I=0;256>e;e++)I+=a[e],k+=e*a[e];k/=I;for(e=0;256>e;e++)p+=a[e]*(e-k)**2;e=Math.sqrt(p/(I-1));I=(f-b)/256;a=(k+.5)*I+b;I*=e;l.push({min:b,
max:f,avg:a,stddev:I})}return{statistics:l,histograms:q}}function D(m,n){if(null==n||0===n.length)return m;const g=Math.max.apply(null,n),{minCutOff:c,maxCutOff:t,outMin:A,outMax:r,histogramLut:b}=m;return c.length===n.length||c.length<=g?m:{minCutOff:n.map(f=>c[f]),maxCutOff:n.map(f=>t[f]),histogramLut:b?n.map(f=>b[f]):null,outMin:A,outMax:r}}function G(m,n){const g=new Float32Array(m);for(let c=0;c<m;c++)g[c]=1<n[c]?2<n[c]?6.5+(n[c]-2)**2.5:6.5+100*(2-n[c])**4:1;return g}const h=[.299,.587,.114];
P.computeGammaCorrection=G;P.computeGammaValues=function(m,n,g){const c=[];for(let f=0;f<n.length;f++){var t=0,A=0,r=0;"min"in n[f]?{min:t,max:A,avg:r}=n[f]:[t,A,r]=n[f];r=r??0;"u8"!==m&&(r=255*(r-t)/(A-t));g&&(r*=h[f]);t=c;A=t.push;if(0>=r||255<=r)r=1;else{var b=0;150!==r&&(b=150>=r?45*Math.cos(.01047*r):17*Math.sin(.021*r));b=Math.log((r+b)/255);0===b?r=1:(r=Math.log(r/255)/b,r=isNaN(r)?1:Math.min(9.9,Math.max(.01,r)))}A.call(t,r)}return c};P.computeStatisticsHistograms=function(m){const {pixels:n,
mask:g,pixelType:c,bandMasks:t}=m;var A=n.map((r,b)=>S(r,t?.[b]??g,c,!0));m=A.map(({statistics:r})=>r);A=A.map(({histogram:r})=>r);return{statistics:m,histograms:A}};P.createContrastBrightnessLUT=R;P.createHistogramEqualizationLUT=T;P.createStretchLUT=function(m){const {minCutOff:n,maxCutOff:g,gamma:c,pixelType:t,rounding:A}=m,r=m.outMin||0,b=m.outMax||255;if(!["u8","u16","s8","s16"].includes(t))return null;const f=n.length;let d,e,q=0;"s8"===t?q=-127:"s16"===t&&(q=-32767);let l=256;["u16","s16"].includes(t)&&
(l=65536);var a=[],k=[];const p=b-r;for(d=0;d<f;d++)k[d]=g[d]-n[d],a[d]=0===k[d]?0:p/k[d];let z;const I=[];let N,O;if(c&&c.length>=f)for(a=G(f,c),d=0;d<f;d++){O=[];for(e=0;e<l;e++)if(0===k[d])O[e]=r;else{var H=e+q;z=(H-n[d])/k[d];N=1;1<c[d]&&(N-=(1/p)**(z*a[d]));H<g[d]&&H>n[d]?(H=N*p*z**(1/c[d])+r,O[e]="floor"===A?Math.floor(H):"round"===A?Math.round(H):H):O[e]=H>=g[d]?b:r}I[d]=O}else for(d=0;d<f;d++){O=[];for(e=0;e<l;e++)H=e+q,H<=n[d]?O[e]=r:H>=g[d]?O[e]=b:(k=(H-n[d])*a[d]+r,O[e]="floor"===A?Math.floor(k):
"round"===A?Math.round(k):k);I[d]=O}if(null!=m.contrastOffset)for(m=R(m.contrastOffset,m.brightnessOffset),d=0;d<f;d++)for(O=I[d],e=0;e<l;e++)O[e]=m[O[e]];return{lut:I,offset:q}};P.estimateStatisticsFromHistograms=function(m){const n=[];for(let A=0;A<m.length;A++){const {min:r,max:b,size:f,counts:d}=m[A];let e=0;var g=0;for(var c=0;c<f;c++)e+=d[c],g+=c*d[c];g/=e;c=0;for(var t=0;t<f;t++)c+=d[t]*(t-g)**2;t=(b-r)/f;n.push({min:r,max:b,avg:(g+.5)*t+r,stddev:Math.sqrt(c/(e-1))*t})}return n};P.estimateStatisticsHistograms=
K;P.getStretchCutoff=function(m,n){const {pixelBlock:g,bandIds:c,returnHistogramLut:t,rasterInfo:A}=n;var r=null;n=null;var b=m.stretchType;"number"===typeof b&&(b=B.stretchTypeFunctionEnum[b]);m.dra?"minMax"===b&&null!=g&&g.statistics?r=g.statistics.map(H=>[H.minValue,H.maxValue,0,0]):(n=K(g),r=null!=n?n.statistics:null,n=null!=n?n.histograms:null):(r=0<m.statistics?.length?m.statistics:A.statistics,n="histograms"in m?m.histograms:void 0,n||(n=A.histograms));"percentClip"!==b&&"histogramEqualization"!==
b||n?.length||(b="minMax");var f=r?.length||n?.length||A.bandCount;const d=[],e=[];let q,l,a,k;r&&!Array.isArray(r[0])&&(r=r.map(H=>[H.min,H.max,H.avg,H.stddev]));const [p,z]=C.getPixelValueRange(A.pixelType);if(!r?.length){r=[];for(a=0;a<f;a++)r.push([p,z,1,1]);"standardDeviation"===b&&(b="minMax")}switch(b){case "none":for(a=0;a<f;a++)d[a]=p,e[a]=z;break;case "minMax":for(a=0;a<f;a++){var I=r[a];d[a]=I[0];e[a]=I[1]}break;case "standardDeviation":for(a=0;a<f;a++)I=r[a],d[a]=I[2]-m.numberOfStandardDeviations*
I[3],e[a]=I[2]+m.numberOfStandardDeviations*I[3],d[a]<I[0]&&(d[a]=I[0]),e[a]>I[1]&&(e[a]=I[1]);break;case "histogramEqualization":w.assertIsSome(n);for(a=0;a<f;a++)d[a]=n[a].min,e[a]=n[a].max;break;case "percentClip":w.assertIsSome(n);for(a=0;a<n.length;a++){r=n[a];q=new Uint32Array(r.size);var N=[...r.counts];20<=N.length&&(N[0]=N[1]=N[2]=N[N.length-1]=N[N.length-2]=0);I=0;f=(r.max-r.min)/r.size;l=-.5===r.min&&1===f?.5:0;for(k=0;k<r.size;k++)I+=N[k],q[k]=I;N=(m.minPercent||0)*I/100;d[a]=r.min+l;
for(k=0;k<r.size;k++)if(q[k]>N){d[a]=r.min+f*(k+l);break}N=(1-(m.maxPercent||0)/100)*I;e[a]=r.max+l;for(k=r.size-2;0<=k;k--)if(q[k]<N){e[a]=r.min+f*(k+2-l);break}e[a]<d[a]&&(r=d[a],d[a]=e[a],e[a]=r)}break;default:for(a=0;a<f;a++)I=r[a],d[a]=I[0],e[a]=I[1]}let O;"histogramEqualization"===b?(w.assertIsSome(n),b=n[0].size||256,m=0,t&&(O=n.map(H=>T(H)))):(b=m.max||255,m=m.min||0);return D({minCutOff:d,maxCutOff:e,outMax:b,outMin:m,histogramLut:O},c)};P.stretch=function(m,n){if(null==m||!m.pixels?.length)return m;
const {mask:g,bandMasks:c,width:t,height:A,pixels:r}=m,{minCutOff:b,maxCutOff:f,gamma:d}=n;var e=n.outMin||0;const q=n.outMax||255,l=t*A,a=n.outputPixelType||"u8";m=m.pixels.map(()=>E.createEmptyBand(a,l));const k=m.length;var p=q-e,z=[],I=[];for(var N=0;N<k;N++)I[N]=f[N]-b[N],z[N]=0===I[N]?0:p/I[N];N=a.startsWith("u")||a.startsWith("s");n=!!n.isRenderer;if(d&&d.length>=k){z=G(k,d);for(var O=0;O<k;O++){var H=c?.[O]??g;for(let y=0;y<l;y++)if(null==H||H[y]){if(0===I[O]){m[O][y]=e;continue}var u=r[O][y];
const x=(u-b[O])/I[O];let L=1;1<d[O]&&(L-=(1/p)**(x*z[O]));u<f[O]&&u>b[O]?(u=L*p*x**(1/d[O])+e,m[O][y]=n?Math.floor(u):N?Math.round(u):u):m[O][y]=u>=f[O]?q:e}}}else for(p=0;p<k;p++)for(I=c?.[p]??g,O=0;O<l;O++)if(null==I||I[O])H=r[p][O],H<f[p]&&H>b[p]?(H=(H-b[p])*z[p]+e,m[p][O]=n?Math.floor(H):N?Math.round(H):H):m[p][O]=H>=f[p]?q:e;e=new E({width:t,height:A,mask:g,bandMasks:c,pixels:m,pixelType:a});e.updateStatistics();return e};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/TableFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./TableFunctionArguments".split(" "),
function(P,w,E,C,B,T,R,S,K){C=function(D){function G(){var m=D.apply(this,arguments)||this;m.functionName="Table";m.functionArguments=null;m.rasterArgumentNames=["raster"];m.isNoopProcess=!0;return m}P._inherits(G,D);var h=G.prototype;h._bindSourceRasters=function(){var m=this.sourceRasterInfos[0];if(1<m.bandCount||m.pixelType.startsWith("f"))return{success:!1,supportsGPU:!1,error:"table-function: Source data must be single band and integer pixel type."};const {attributeTableAsRecordSet:n}=this.functionArguments;
if(!n)return{success:!1,supportsGPU:!1,error:"table-function: Missing attributeTableAsRecordSet argument."};this.outputPixelType=this._getOutputPixelType(m.pixelType);m=m.clone();m.pixelType=this.outputPixelType;m.bandCount=1;"thematic"!==m.dataType&&(m.keyProperties=m.keyProperties?{...m.keyProperties,DataType:"thematic"}:{DataType:"thematic"});this.rasterInfo=m;return{success:!0,supportsGPU:!0}};h._processPixels=function(m){return m.pixelBlocks?.[0]};return P._createClass(G)}(S);w.__decorate([E.property({json:{write:!0,
name:"rasterFunction"}})],C.prototype,"functionName",void 0);w.__decorate([E.property({type:K,json:{write:!0,name:"rasterFunctionArguments"}})],C.prototype,"functionArguments",void 0);w.__decorate([E.property()],C.prototype,"rasterArgumentNames",void 0);w.__decorate([E.property()],C.prototype,"isNoopProcess",void 0);return C=w.__decorate([R.subclass("esri.layers.support.rasterFunctions.TableFunction")],C)})},"esri/layers/support/rasterFunctions/TableFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(P,w,E,C,B,T,R){var S;B=S=function(K){function D(){var G=K.apply(this,arguments)||this;G.attributeTableAsRecordSet=null;return G}P._inherits(D,K);D.prototype.clone=function(){return new S({attributeTableAsRecordSet:E.clone(this.attributeTableAsRecordSet)})};return P._createClass(D)}(R);w.__decorate([C.property({json:{write:!0}})],B.prototype,"attributeTableAsRecordSet",void 0);return B=S=w.__decorate([T.subclass("esri.layers.support.rasterFunctions.TableFunctionArguments")],B)})},"esri/renderers/support/rasterRendererHelper":function(){define("exports ../../Color ../../rasterRenderers ../../core/unitUtils ../../layers/support/Field ../../layers/support/RasterInfo ../FlowRenderer ./AuthoringInfo ./ClassBreakInfo ./colorRampUtils ./rasterRendererChecks ./UniqueValueInfo ../../rest/support/ClassBreaksDefinition ../../rest/support/generateRendererUtils ../../rest/support/MultipartColorRamp ../RasterStretchRenderer ../UniqueValueRenderer ../RasterColormapRenderer ../RasterShadedReliefRenderer ../ClassBreaksRenderer ../VectorFieldRenderer".split(" "),
function(P,w,E,C,B,T,R,S,K,D,G,h,m,n,g,c,t,A,r,b,f){function d(v,F){v=e(v,F?.variableName);const {bandCount:J}=v;let {bandIds:M,stretchType:U}=F||{};M?.some(ea=>ea>=J)&&(M=null);let V=v.statistics,X=v.histograms;1<J?(M=M?.length?M:q(v),V=null==V?null:M?.map(ea=>V[ea]),X=null==X?null:M?.map(ea=>X[ea])):M=[0];null==U&&(U=a(v));let Z=!1;switch(U){case "none":Z=!1;break;case "percent-clip":Z=!X?.length;break;default:Z=!V?.length}var {dataType:Y}=v;Y=1===M?.length&&Q.has(Y)?x:null;Y=new c({stretchType:U,
dynamicRangeAdjustment:Z,colorRamp:Y,outputMin:0,outputMax:255,gamma:1===M?.length?[1]:[1,1,1],useGamma:!1});"percent-clip"===U?Y.maxPercent=Y.minPercent=.25:"standard-deviation"===U&&(Y.numberOfStandardDeviations=2);if(!Z&&(null!=v.multidimensionalInfo||F?.includeStatisticsInStretch))if("percent-clip"===U)Y.histograms=X;else if("min-max"===U||"standard-deviation"===U)Y.statistics=V;return Y}function e(v,F){if(!F)return v;let J=v.statistics,M=v.histograms;var {multidimensionalInfo:U}=v;if(F&&null!=
U&&(U=U.variables.find(V=>V.name===F))){const {statistics:V,histograms:X}=U;V?.length&&(J=V);X?.length&&(M=X)}return T.fromJSON({...v.toJSON(),statistics:J,histograms:M})}function q(v){const F=v.bandCount;if(1===F)return null;if(2===F)return[0];({bandInfos:v}=v);let J;if(v.length===F){const {red:M,green:U,blue:V,nir:X}=l(v);null!=M&&null!=U&&null!=V?J=[M,U,V]:null!=X&&null!=M&&null!=U&&(J=[X,M,U])}!J&&3<=F&&(J=[0,1,2]);return J}function l(v){const F={};for(let U=0;U<v.length;U++){var J=v[U],M=J.name.toLowerCase();
"red"===M?F.red=U:"green"===M?F.green=U:"blue"===M?F.blue=U:"nearinfrared"===M||"nearinfrared_1"===M||"nir"===M?F.nir=U:J.maxWavelength&&J.minWavelength&&(M=J.minWavelength,J=J.maxWavelength,null==F.blue&&410<=M&&480>=M&&480<=J&&540>=J?F.blue=U:null==F.green&&490<=M&&560>=M&&560<=J&&610>=J?F.green=U:null==F.red&&595<=M&&670>=M&&660<=J&&730>=J?F.red=U:null==F.nir&&700<=M&&860>=M&&800<=J&&950>=J&&(F.nir=U))}return F}function a(v){let F="percent-clip";const {pixelType:J,dataType:M,histograms:U,statistics:V,
multidimensionalInfo:X}=v;v=Q.has(M)||"generic"===M&&null!=X;"u8"!==J||"processed"!==M&&null!=U&&null!=V?"u8"===J||"elevation"===M||v?F="min-max":null!=U?F="percent-clip":null!=V&&(F="min-max"):F="none";return F}function k(v,F,J,M){if(!G.isUVRendererSupported(v,F))return null;const {attributeTable:U,statistics:V}=v,X=p(U,F),Z=I(U,"red"),Y=I(U,"green"),ea=I(U,"blue");v=new S;const da=[],ia=new Set,fa=!!(Z&&Y&&ea);if(null!=U)U.features.forEach(ja=>{var ma=ja.attributes[X.name];ia.has(ja.attributes[X.name])||
null==ma||(ia.add(ma),ma=!fa||"single"!==Z.type&&"double"!==Z.type||"single"!==Y.type&&"double"!==Y.type||"single"!==ea.type&&"double"!==ea.type||U.features.some(na=>1<na.attributes[Z.name]||1<na.attributes[Y.name]||1<na.attributes[ea.name])?1:255,da.push(new h({value:ja.attributes[X.name],label:ja.attributes[X.name]+"",symbol:{type:"simple-fill",style:"solid",outline:null,color:fa?new w([ja.attributes[Z.name]*ma,ja.attributes[Y.name]*ma,ja.attributes[ea.name]*ma,1]):new w([0,0,0,0])}})))});else if(V?.[0])for(F=
V[0].min;F<=V[0].max;F++)da.push(new h({value:F,label:F.toString(),symbol:{type:"simple-fill",style:"solid",outline:null,color:new w([0,0,0,0])}}));da.sort((ja,ma)=>ja.value&&"string"===typeof ja.value.valueOf()?0:ja.value>ma.value?1:-1);if(!fa){const ja=D.convertColorRampToColormap(L,{numColors:da.length});da.forEach((ma,na)=>ma.symbol.color=new w(ja[na].slice(1,4)));v.colorRamp=L}if(J||M){const ja=J||D.convertColorRampToColormap(M,{numColors:da.length}).map(ma=>ma.slice(1));da.forEach((ma,na)=>
ma.symbol.color=new w(ja[na]));v.colorRamp=M}return new t({field:X.name,uniqueValueInfos:da,authoringInfo:v})}function p(v,F,J){let M;null!=v?(M=F?v.fields.find(U=>F.toLowerCase()===U.name.toLowerCase()):z(v.fields),M||(J||(M=v.fields.find(U=>"string"===U.type)),M||(M=I(v,"value")))):M=new B({name:"value"});return M}function z(v){let F;for(let J=0;J<v.length;J++){const M=v[J].name.toLowerCase();if("string"===v[J].type){if(M.startsWith("class")){F=v[J];break}null==F&&(M.endsWith("name")||M.endsWith("type"))&&
(F=v[J])}}return F}function I(v,F){return null==v?null:v.fields.find(J=>J.name.toLowerCase()===F)}function N(v){if(!G.isColormapRendererSupported(v))return null;let F;const {attributeTable:J,colormap:M}=v;if(null!=J){const U=I(J,"value"),V=p(J,null,!0);"string"===V.type&&(F={},J.features.forEach(X=>{X=X.attributes;F[X[U.name]]=V?X[V.name]:X[U.name]}))}return A.createFromColormap(M,F)}function O(v,F,J){let M=0,U=0;null!=v.attributeTable?(v=v.attributeTable,M=U=v.features[0].attributes[F.name],v.features.forEach(V=>
{V=V.attributes[F.name];V<M&&(M=V);V>U&&(U=V)})):null!=v.histograms&&(v=v.histograms,M=v[0].min,U=v[0].max);return(U-M)/J}function H(v){if(!G.isVectorFieldRendererSupported(v))return null;if(null!=v.statistics&&v.statistics.length&&("vector-magdir"===v.dataType||"vector-uv"===v.dataType)){const {minMagnitude:J,maxMagnitude:M}=y(v.dataType,v.statistics);var F=[{type:"size",field:"Magnitude",minSize:10,maxSize:40,minDataValue:J,maxDataValue:M}]}v=null!=v.multidimensionalInfo?W.get(v.multidimensionalInfo.variables[0].unit):
null;F=new f({visualVariables:F,inputUnit:v,rotationType:"geographic"});F.visualVariables=[...F.sizeVariables,...F.rotationVariables];return F}function u(v){return{color:v.symbolLayers[0].material?.color,type:"esriSFS",style:"esriSFSSolid"}}function y(v,F){if("vector-magdir"===v)v=F[0].min,F=F[0].max;else{const J=F[0].min,M=F[0].max,U=F[1].min;F=F[1].max;v=0;F=Math.max(Math.abs(J),Math.abs(U),Math.abs(M),Math.abs(F))}return{minMagnitude:v,maxMagnitude:F}}const x=g.fromJSON({type:"multipart",colorRamps:[{fromColor:[0,
0,255],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]}]}),L=g.fromJSON(D.PREDEFINED_JSON_COLOR_RAMPS[0]),Q=new Set("scientific standard-time vector-uv vector-magdir vector-u vector-v vector-magnitude vector-direction".split(" ")),W=new Map([["m/s","meter-per-second"],["km/h","kilometer-per-hour"],["knots","knots"],["ft/s","feet-per-second"],["mph","mile-per-hour"]]);P.createClassBreaksRenderer=function(v,F){v=e(v,F?.variableName);const {attributeTable:J}=
v;if(!G.isClassBreaksSupported(v))return null;const M=null!=v.histograms?v.histograms[0]:null,U=null!=F?.numClasses&&isFinite(F?.numClasses)?F.numClasses:5,V=new S({classificationMethod:F?.classificationMethod,colorRamp:F?.colorRamp});let X=F?.field||"value";const Z=[],Y=[],ea=null!=J,da=ea&&J.fields.find(na=>"count"===na.name.toLowerCase()),ia=ea?J.fields.find(na=>na.name.toLowerCase()===X.toLowerCase()):void 0;if(ia&&ea){X=ia.name;const na=J.features.length;let ra=0;J.features.forEach(qa=>ra+=(da?
qa.attributes[da.name]:50)/na);J.features.forEach(qa=>{const va=qa.attributes[ia.name];qa=da?qa.attributes[da.name]:50;if(0<qa){Y.push(qa);qa=Math.max(1,Math.round(qa/na/ra*1E3));for(let sa=0;sa<qa;sa++)Z.push(va)}})}else{var {pixelType:fa}=v;const na=(M.max-M.min)/M.size,ra=(fa=fa.includes("s")||fa.includes("u"))&&1===na?Math.floor(M.min+.5):M.min,qa=fa&&1===na?Math.floor(M.max-.5):M.max,va=M.size;let sa=0,xa;M.counts.forEach(oa=>sa+=oa/va);M.counts.forEach((oa,wa)=>{if(0<oa)for(Y.push(oa),oa=Math.max(1,
Math.round(oa/va/sa*1E3)),xa=ea?J.features[wa].attributes[ia.name]:0===wa?ra:wa===va-1?qa:M.min+na*(wa+.5),wa=0;wa<oa;wa++)Z.push(xa)})}fa=F?.classificationMethod||"natural-breaks";let ja=F?.definedInterval;"defined-interval"!==fa||ja||(ja=O(v,ia,U));v=n.createGenerateRendererClassBreaks({values:Z,valueFrequency:Y,normalizationTotal:null,definition:new m({classificationMethod:fa,breakCount:U,definedInterval:ja})});let ma=F?.colors;ma||(F=F?.colorRamp||x,V.colorRamp=F,ma=D.convertColorRampToColormap(F,
{numColors:v.classBreaks.length,interpolateAlpha:!0}).map(na=>na.slice(1)));F=v.classBreaks.map((na,ra)=>new K({minValue:na.minValue,maxValue:na.maxValue,label:na.label,symbol:{type:"simple-fill",color:ma[ra]}}));return new b({field:X,classBreakInfos:F,authoringInfo:V})};P.createColormapRenderer=N;P.createDefaultRenderer=function(v,F){const {attributeTable:J,colormap:M}=v;if(G.isVectorFieldRendererSupported(v)){var U=H(v);if(null!=U)return U}return null!=M&&(U=N(v),null!=U)||null!=J&&(U=k(v),null!=
U)?U:d(v,F)};P.createFlowRenderer=function(v){if(!G.isFlowRendererSupported(v))return null;let F;if(null!=v.statistics&&0<v.statistics.length&&("vector-magdir"===v.dataType||"vector-uv"===v.dataType)){const {minMagnitude:J,maxMagnitude:M}=y(v.dataType,v.statistics);F=[{type:"color",field:"Magnitude",stops:[{value:J,color:"#1020C0"},{value:M,color:"#C02010"}]}]}return new R({visualVariables:F})};P.createShadedReliefRenderer=function(v,F="traditional"){if(!G.isShadedReliefRendererSupported(v))return null;
({extent:v}=v);v=v.width*C.getMetersPerUnitForSR(v.spatialReference);return new r({hillshadeType:F,scalingType:5E6<v?"adjusted":"none"})};P.createStretchRenderer=d;P.createUVRenderer=k;P.createVectorFieldRenderer=H;P.estimateMagnitudeRange=y;P.getBandNames=function(v,F){const J=v.bandInfos.map(({name:M})=>M);return F?.length?F.map(M=>J[M]):J};P.getClassField=p;P.getDefaultBandCombination=q;P.getDefaultInterpolation=function(v,F,J){const M=["nearest","bilinear","cubic","majority"].find(U=>U===J?.toLowerCase());
return"Map"===F?M??"bilinear":"standard-time"===v.dataType?M??"nearest":"thematic"===v.dataType||v.attributeTable||v.colormap?"nearest"===M||"majority"===M?M:"nearest":M??"bilinear"};P.getDefinedInterval=O;P.getField=I;P.getSupportedRendererTypes=function(v,F=!1){const J=["raster-stretch"];G.isColormapRendererSupported(v,F)&&J.push("raster-colormap");G.isUVRendererSupported(v)&&J.push("unique-value");G.isClassBreaksSupported(v,F)&&J.push("class-breaks");G.isShadedReliefRendererSupported(v)&&J.push("raster-shaded-relief");
G.isVectorFieldRendererSupported(v)&&J.push("vector-field");G.isFlowRendererSupported(v)&&J.push("flow");return J};P.getVariableRasterInfo=e;P.getWellKnownBandIndexes=l;P.normalizeRendererJSON=function(v){if("uniqueValue"===v.type){var F=v.uniqueValueInfos;F?.[0].symbol?.symbolLayers?.length&&(v.uniqueValueInfos=F?.map(J=>({value:J.value,label:J.label,symbol:J.symbol?u(J.symbol):null})));return v}"classBreaks"===v.type&&(F=v.classBreakInfos,F[0].symbol?.symbolLayers?.length&&(v.classBreakInfos=F.map(J=>
({classMinValue:J.classMinValue,classMaxValue:J.classMaxValue,label:J.label,symbol:J.symbol?u(J.symbol):null}))));return v};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/rasterRendererChecks":function(){define(["exports"],function(P){function w(E){return["u8","s8"].includes(E.pixelType)&&null!=E.statistics?.[0]?.min&&null!=E.statistics[0]?.max&&1===E.bandCount}P.isClassBreaksSupported=function(E,C=!1){const {attributeTable:B,bandCount:T}=E;return 1===T&&(!C||
null!=B||null!=E.histograms)};P.isColormapRendererSupported=function(E,C=!1){const {bandCount:B,colormap:T,pixelType:R}=E;return 1===B&&(!!T?.length||!C&&"u8"===R)};P.isFlowRendererSupported=function(E){({dataType:E}=E);return"vector-uv"===E||"vector-magdir"===E};P.isShadedReliefRendererSupported=function(E){const {bandCount:C,dataType:B,pixelType:T}=E;return"elevation"===B||"generic"===B&&1===C&&("s16"===T||"s32"===T||"f32"===T||"f64"===T)};P.isSingleBand8BitRasterWithStats=w;P.isUVRendererSupported=
function(E,C){const {attributeTable:B,bandCount:T}=E;return null==B&&w(E)?!0:null==B||1<T||C&&null==B.fields.find(R=>R.name.toLowerCase()===C.toLowerCase())?!1:!0};P.isVectorFieldRendererSupported=function(E){({dataType:E}=E);return"vector-uv"===E||"vector-magdir"===E};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/ClassBreaksDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),
function(P,w,E,C,B,T,R,S,K,D){T=new E.JSONMap({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"});E=new E.JSONMap({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});C=function(G){function h(m){m=G.call(this,m)||this;m.type="class-breaks-definition";m.breakCount=
null;m.classificationField=null;m.classificationMethod=null;m.normalizationField=null;m.normalizationType=null;return m}P._inherits(h,G);P._createClass(h,[{key:"standardDeviationInterval",set:function(m){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",m)}},{key:"definedInterval",set:function(m){"defined-interval"===this.classificationMethod&&this._set("definedInterval",m)}}]);return h}(C.JSONSupport);w.__decorate([K.enumeration({classBreaksDef:"class-breaks-definition"})],
C.prototype,"type",void 0);w.__decorate([B.property({json:{write:!0}})],C.prototype,"breakCount",void 0);w.__decorate([B.property({json:{write:!0}})],C.prototype,"classificationField",void 0);w.__decorate([B.property({type:String,json:{read:T.read,write:T.write}})],C.prototype,"classificationMethod",void 0);w.__decorate([B.property({json:{write:!0}})],C.prototype,"normalizationField",void 0);w.__decorate([B.property({json:{read:E.read,write:E.write}})],C.prototype,"normalizationType",void 0);w.__decorate([B.property({value:null,
json:{write:!0}})],C.prototype,"standardDeviationInterval",null);w.__decorate([B.property({value:null,json:{write:!0}})],C.prototype,"definedInterval",null);return C=w.__decorate([D.subclass("esri.rest.support.ClassBreaksDefinition")],C)})},"esri/rest/support/generateRendererUtils":function(){define(["exports","../../core/Logger"],function(P,w){function E(m){var n=m.definition;const {classificationMethod:g,normalizationType:c,definedInterval:t}=n;n=n.breakCount??1;const A=[];var r=m.values;if(0===
r.length)return[];r=r.sort((l,a)=>l-a);var b=r[0],f=r[r.length-1];if("equal-interval"===g)if(r.length>=n){r=(f-b)/n;m=b;for(var d=1;d<n;d++){var e=Number((b+d*r).toFixed(6));A.push({minValue:m,maxValue:e,label:C(m,e,c)});m=e}A.push({minValue:m,maxValue:f,label:C(m,f,c)})}else r.forEach(l=>{A.push({minValue:l,maxValue:l,label:C(l,l,c)})});else if("natural-breaks"===g){r=B(r);m=T(r.uniqueValues,m.valueFrequency||r.valueFrequency,n);for(d=1;d<n;d++)r.uniqueValues.length>d&&(e=Number(r.uniqueValues[m[d]].toFixed(6)),
A.push({minValue:b,maxValue:e,label:C(b,e,c)}),b=e);A.push({minValue:b,maxValue:f,label:C(b,f,c)})}else if("quantile"===g)if(r.length>=n&&b!==f){m=Math.ceil(r.length/n);d=0;for(e=1;e<n;e++){var q=m+d-1;q>r.length&&(q=r.length-1);0>q&&(q=0);A.push({minValue:b,maxValue:r[q],label:C(b,r[q],c)});b=r[q];d+=m;m=Math.ceil((r.length-d)/(n-e))}A.push({minValue:b,maxValue:f,label:C(b,f,c)})}else for(n=-1,f=0;f<r.length;f++)b=r[f],b!==n&&(n=b,A.push({minValue:n,maxValue:b,label:C(n,b,c)}),n=b);else if("standard-deviation"===
g)if(m=K(r),d=D(r,m),0===d)A.push({minValue:r[0],maxValue:r[0],label:C(r[0],r[0],c)});else{r=S(b,f,n,m,d)*d;d=0;for(e=n;1<=e;e--)q=Number((m-(e-.5)*r).toFixed(6)),A.push({minValue:b,maxValue:q,label:C(b,q,c)}),b=q,d++;e=Number((m+.5*r).toFixed(6));A.push({minValue:b,maxValue:e,label:C(b,e,c)});b=e;d++;for(q=1;q<=n;q++)e=d===2*n?f:Number((m+(q+.5)*r).toFixed(6)),A.push({minValue:b,maxValue:e,label:C(b,e,c)}),b=e,d++}else if("defined-interval"===g){if(!t)return A;n=r[0];f=r[r.length-1];r=Math.ceil((f-
n)/t);b=n;for(m=1;m<r;m++)d=Number((n+m*t).toFixed(6)),A.push({minValue:b,maxValue:d,label:C(b,d,c)}),b=d;A.push({minValue:b,maxValue:f,label:C(b,f,c)})}return A}function C(m,n,g){let c=null;return c=m===n?g&&"percent-of-total"===g?m+"%":m.toString():g&&"percent-of-total"===g?m+"% - "+n+"%":m+" - "+n}function B(m){const n=[],g=[];let c=Number.MIN_VALUE,t=1,A=-1;for(let r=0;r<m.length;r++){const b=m[r];b===c?(t++,g[A]=t):null!==b&&(n.push(b),c=b,t=1,g.push(t),A++)}return{uniqueValues:n,valueFrequency:g}}
function T(m,n,g){var c=m.length;const t=[];g>c&&(g=c);for(var A=0;A<g;A++)t.push(Math.round(A*c/g-1));t.push(c-1);A=R(t,m,n,g);c=A.mean;A=A.sdcm;var r=g,b=0,f=0;let d=0,e=0,q=!0;for(let a=0;2>a&&q;a++){0===a&&(q=!1);for(var l=0;l<r-1;l++)for(;t[l+1]+1!==t[l+2];)if(t[l+1]+=1,b=G(l,t,m,n),d=b.sbMean,b=b.sbSdcm,f=G(l+1,t,m,n),e=f.sbMean,f=f.sbSdcm,b+f<A[l]+A[l+1])A[l]=b,A[l+1]=f,c[l]=d,c[l+1]=e,q=!0;else{--t[l+1];break}for(l=r-1;0<l;l--)for(;t[l]!==t[l-1]+1;)if(--t[l],b=G(l-1,t,m,n),d=b.sbMean,b=b.sbSdcm,
f=G(l,t,m,n),e=f.sbMean,f=f.sbSdcm,b+f<A[l-1]+A[l])A[l-1]=b,A[l]=f,c[l-1]=d,c[l]=e,q=!0;else{t[l]+=1;break}}q&&(A=R(t,m,n,g));return t}function R(m,n,g,c){let t=[];var A=[],r=[];let b=0;const f=[],d=[];for(var e=0;e<c;e++){var q=G(e,m,n,g);f.push(q.sbMean);d.push(q.sbSdcm);b+=d[e]}q=b;for(e=!0;e||b<q;){e=!1;t=[];for(A=0;A<c;A++)t.push(m[A]);for(r=0;r<c;r++)for(q=m[r]+1;q<=m[r+1];q++)if(A=n[q],0<r&&q!==m[r+1]&&Math.abs(A-f[r])>Math.abs(A-f[r-1]))m[r]=q;else if(r<c-1&&m[r]!==q-1&&Math.abs(A-f[r])>Math.abs(A-
f[r+1])){m[r+1]=q-1;break}q=b;b=0;A=[];r=[];for(let l=0;l<c;l++){A.push(f[l]);r.push(d[l]);const a=G(l,m,n,g);f[l]=a.sbMean;d[l]=a.sbSdcm;b+=d[l]}}if(b>q){for(n=0;n<c;n++)m[n]=t[n],f[n]=A[n],d[n]=r[n];b=q}return{mean:f,sdcm:d}}function S(m,n,g,c,t){m=Math.max(c-m,n-c)/t/g;return 1<=m?1:.5<=m?.5:.25}function K(m){let n=0;for(let g=0;g<m.length;g++)n+=m[g];return n/=m.length}function D(m,n){let g=0;for(let c=0;c<m.length;c++){const t=m[c];g+=(t-n)*(t-n)}g/=m.length;return Math.sqrt(g)}function G(m,
n,g,c){var t=0,A=0;for(var r=n[m]+1;r<=n[m+1];r++){const b=c[r];t+=g[r]*b;A+=b}0>=A&&h.warn("Exception in Natural Breaks calculation");t/=A;A=0;for(r=n[m]+1;r<=n[m+1];r++)A+=c[r]*(g[r]-t)**2;return{sbMean:t,sbSdcm:A}}const h=w.getLogger("esri.rest.support.generateRendererUtils");P.createGenerateRendererClassBreaks=function(m){const {normalizationTotal:n}=m;return{classBreaks:E(m),normalizationTotal:n}};P.createGenerateRendererUniqueValues=function(m){m=B(m);const n=[],g=m.uniqueValues.length;for(let c=
0;c<g;c++){const t=m.uniqueValues[c];n.push({value:t,count:m.valueFrequency[c],label:t.toString()})}return{uniqueValues:n}};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/RasterSymbolizer":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/colorUtils ../../core/JSONSupport ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../layers/support/RasterInfo ../../layers/support/rasterFunctions/pixelUtils ../../layers/support/rasterFunctions/stretchUtils ../../layers/support/rasterFunctions/surfaceUtils ./colorRampUtils ./rasterRendererChecks".split(" "),
function(P,w,E,C,B,T,R,S,K,D,G,h,m,n,g,c){function t(A){return h.isValidPixelBlock(A)&&0!==A.validPixelCount}C=function(A){function r(f){return A.call(this,f)||this}P._inherits(r,A);var b=r.prototype;b.bind=function(){const {rendererJSON:f}=this;if(!f)return{success:!1};this.lookup={rendererJSON:{}};let d;switch(f.type){case "uniqueValue":d=this._updateUVRenderer(f);break;case "rasterColormap":d=this._updateColormapRenderer(f);break;case "rasterStretch":d=this._updateStretchRenderer(f);break;case "classBreaks":d=
this._updateClassBreaksRenderer(f);break;case "rasterShadedRelief":d=this._updateShadedReliefRenderer(f);break;case "vectorField":d=this._updateVectorFieldRenderer();break;case "flowRenderer":d=this._updateFlowRenderer()}return d};b.symbolize=function(f){let d=f&&f.pixelBlock;if(!t(d))return d;if(f.simpleStretchParams&&"rasterStretch"===this.rendererJSON.type)return this.simpleStretch(d,f.simpleStretchParams);try{3<d.pixels.length&&(d=d.extractBands([0,1,2]));let e;switch(this.rendererJSON.type){case "uniqueValue":case "rasterColormap":e=
this._symbolizeColormap(d);break;case "classBreaks":e=this._symbolizeClassBreaks(d);break;case "rasterStretch":e=this._symbolizeStretch(d,f.bandIds);break;case "rasterShadedRelief":const q=f.extent;e=this._symbolizeShadedRelief(d,{isGCS:q.spatialReference.isGeographic,resolution:{x:(q.xmax-q.xmin)/d.width,y:(q.ymax-q.ymin)/d.height}})}return e}catch(e){return B.getLogger(this).error("symbolize",e.message),d}};b.simpleStretch=function(f,d){if(!t(f))return f;try{return 3<f.pixels.length&&(f=f.extractBands([0,
1,2])),m.stretch(f,{...d,isRenderer:!0})}catch(e){return B.getLogger(this).error("symbolize",e.message),f}};b.generateWebGLParameters=function(f){if(["uniqueValue","rasterColormap","classBreaks"].includes(this.rendererJSON.type)){const {indexedColormap:a,offset:k}=this.lookup.colormapLut||{};return{colormap:a,colormapOffset:k,type:"lut"}}const {pixelBlock:d,isGCS:e,resolution:q,bandIds:l}=f;({rendererJSON:f}=this);return"rasterStretch"===f.type?this._generateStretchWebGLParams(d,f,l):"rasterShadedRelief"===
f.type?this._generateShadedReliefWebGLParams(f,e,q??void 0):"vectorField"===f.type?this._generateVectorFieldWebGLParams(f):null};b._isLUTChanged=function(f){if(!this.lookup||!this.lookup.rendererJSON)return!0;if("colorRamp"in this.rendererJSON){const d=this.rendererJSON.colorRamp;if(f)return JSON.stringify(d)!==JSON.stringify(this.lookup.rendererJSON.colorRamp);({...this.rendererJSON});({...this.lookup.rendererJSON})}return JSON.stringify(this.rendererJSON)!==JSON.stringify(this.lookup.rendererJSON)};
b._symbolizeColormap=function(f){return this._isLUTChanged()&&!this.bind().success?f:h.colorize(f,this.lookup.colormapLut)};b._symbolizeClassBreaks=function(f){const {canUseIndexedLUT:d}=this._analyzeClassBreaks(this.rendererJSON);return this._isLUTChanged()&&!this.bind().success?f:d?h.colorize(f,this.lookup.colormapLut):h.remapColor(f,this.lookup.remapLut??[])};b._symbolizeStretch=function(f,d){const {rasterInfo:e}=this,{pixelType:q,bandCount:l}=e,a=this.rendererJSON;var k=["u8","u16","s8","s16"].includes(q);
let p;var {dra:z}=a;({gamma:I}=this.lookup);if("histogramEqualization"===a.stretchType){k=z?null:this.lookup?.histogramLut;d=m.getStretchCutoff(a,{rasterInfo:e,pixelBlock:f,bandIds:d,returnHistogramLut:!k});var I=m.stretch(f,{...d,gamma:I,isRenderer:!0});I=h.lookupPixels(I,{lut:z?d.histogramLut:k,offset:0})}else if(k){if(z)z=m.getStretchCutoff(a,{rasterInfo:e,pixelBlock:f,bandIds:d}),p=m.createStretchLUT({pixelType:q,...z,gamma:I,rounding:"floor"});else{if(this._isLUTChanged()&&!this.bind().success)return f;
p=this.lookup?this.lookup.stretchLut:null}if(!p)return f;1<l&&null!=d&&d.length===f?.pixels.length&&p?.lut.length===l&&(p={lut:d.map(N=>p.lut[N]),offset:p.offset});I=h.lookupPixels(f,p)}else z=m.getStretchCutoff(a,{rasterInfo:e,pixelBlock:f,bandIds:d}),I=m.stretch(f,{...z,gamma:I,isRenderer:!0});if(a.colorRamp){if(this._isLUTChanged(!0)&&!this.bind().success)return f;I=h.colorize(I,this.lookup?.colormapLut)}return I};b._symbolizeShadedRelief=function(f,d){var e=this.rendererJSON;d=n.hillshade(f,{...e,
...d});if(!e.colorRamp||this._isLUTChanged(!0)&&!this.bind().success)return d;e=this.lookup?this.lookup.hsvMap:null;if(!e)return d;n.tintHillshade(d,f,e,this.rasterInfo.statistics?.[0]??{min:0,max:8E3});return d};b._isVectorFieldData=function(){const {bandCount:f,dataType:d}=this.rasterInfo;return 2===f&&("vector-magdir"===d||"vector-uv"===d)};b._updateVectorFieldRenderer=function(){return this._isVectorFieldData()?{success:!0}:{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; VectorFieldRenderer only supports "vector-magdir" and "vector-uv".`}};
b._updateFlowRenderer=function(){return this._isVectorFieldData()?{success:!0}:{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; FlowRenderer only supports "vector-magdir" and "vector-uv".`}};b._updateUVRenderer=function(f){const {bandCount:d,attributeTable:e,pixelType:q}=this.rasterInfo,l=f.field1;if(!l)return{success:!1,error:"Unsupported renderer; missing UniqueValueRenderer.field."};const a=f.defaultSymbol;var k=1===d&&["u8","s8"].includes(q);if(!c.isUVRendererSupported(this.rasterInfo,
l)&&!k)return{success:!1,error:"Unsupported data; UniqueValueRenderer is only supported on single band data with a valid raster attribute table."};const p=[];if(null!=e){const z=e.fields.find(I=>"value"===I.name.toLowerCase());if(!z)return{success:!1,error:"Unsupported data; the data's raster attribute table does not have a value field."};e.features.forEach(I=>{const N=f.uniqueValueInfos?.find(O=>String(O.value)===String(I.attributes[l]))?.symbol?.color;N?p.push([I.attributes[z.name]].concat(N)):
a&&p.push([I.attributes[z.name]].concat(a.color))})}else{if("value"!==l.toLowerCase())return{success:!1,error:'Unsupported renderer; UniqueValueRenderer.field must be "Value" when raster attribute table is not availalbe.'};f.uniqueValueInfos?.forEach(z=>{const I=z?.symbol?.color;I?p.push([parseInt(""+z.value,10)].concat(I)):a&&p.push([parseInt(""+z.value,10)].concat(a?.color))})}if(0===p.length)return{success:!1,error:"Invalid UniqueValueRenderer. Cannot find matching records in the raster attribute table."};
k=h.createColormapLUT({colormap:p});this.lookup={rendererJSON:f,colormapLut:k};this.canRenderInWebGL=!0;return{success:!0}};b._updateColormapRenderer=function(f){if(!c.isColormapRendererSupported(this.rasterInfo))return{success:!1,error:"Unsupported data; the data source does not have a colormap."};var d=f.colormapInfos.map(e=>[e.value].concat(e.color)).sort((e,q)=>e[0]-q[0]);if(!d||0===d.length)return{success:!1,error:"Unsupported renderer; ColormapRenderer must have meaningful colormapInfos."};
d=h.createColormapLUT({colormap:d});this.lookup={rendererJSON:f,colormapLut:d};this.canRenderInWebGL=!0;return{success:!0}};b._updateShadedReliefRenderer=function(f){if(!c.isShadedReliefRendererSupported(this.rasterInfo))return{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; ShadedReliefRenderer only supports "elevation", or single band float/s16 data.`};if(f.colorRamp){var d=g.convertColorRampToColormap(f.colorRamp,{interpolateAlpha:!0});d=h.createColormapLUT({colormap:d});
const e=[],q=d.indexedColormap;for(let l=0;l<q.length;l+=4){const a=E.toHSV({r:q[l],g:q[l+1],b:q[l+2]});e.push([a.h/60,a.s/100,255*a.v/100])}this.lookup={rendererJSON:f,colormapLut:d,hsvMap:e}}else this.lookup=null;this.canRenderInWebGL=!0;return{success:!0}};b._analyzeClassBreaks=function(f){const {attributeTable:d,pixelType:e}=this.rasterInfo,q=null!=d?d.fields.find(k=>"value"===k.name.toLowerCase()):null,l=null!=d?d.fields.find(k=>k.name.toLowerCase()===f.field.toLowerCase()):null,a=null!=q&&null!==
l;return{canUseIndexedLUT:["u8","u16","s8","s16"].includes(e)||a,tableValueField:q,tableBreakField:l}};b._updateClassBreaksRenderer=function(f){var {attributeTable:d}=this.rasterInfo;const {canUseIndexedLUT:e,tableValueField:q,tableBreakField:l}=this._analyzeClassBreaks(f);var a=f.classBreakInfos;if(!a?.length)return{success:!1,error:"Unsupported renderer; missing or invalid ClassBreaksRenderer.classBreakInfos."};a=a.sort((N,O)=>N.classMaxValue-O.classMaxValue);var k=a[a.length-1],p=f.minValue;if(!e){var z=
[];for(var I=0;I<a.length;I++)z.push({value:a[I].classMinValue??p,mappedColor:a[I].symbol.color}),p=a[I].classMaxValue;z.push({value:k.classMaxValue,mappedColor:k.symbol.color});this.lookup={rendererJSON:f,remapLut:z};this.canRenderInWebGL=!1;return{success:!0}}z=[];if(null!=d&&null!=q&&null!==l&&q!==l){k=q.name;const N=l.name,O=a[a.length-1],{classMaxValue:H}=O;p=f.minValue;for(I of d.features){d=I.attributes[k];const u=I.attributes[N],y=u===H?O:u<p?null:a.find(({classMaxValue:x})=>x>u);y&&z.push([d].concat(y.symbol.color))}}else{p=
Math.floor(f.minValue);for(I=0;I<a.length;I++){for(d=a[I];p<d.classMaxValue;p++)z.push([p].concat(d.symbol.color));p=Math.ceil(d.classMaxValue)}k.classMaxValue===p&&z.push([k.classMaxValue].concat(k.symbol.color))}a=h.createColormapLUT({colormap:z,fillUnspecified:!1});this.lookup={rendererJSON:f,colormapLut:a};this.canRenderInWebGL=!0;return{success:!0}};b._isHistogramRequired=function(f){return"percentClip"===f||"histogramEqualization"===f};b._isValidRasterStatistics=function(f){return null!=f&&
0<f.length&&null!=f[0].min&&null!=f[0].max};b._updateStretchRenderer=function(f){let {stretchType:d,dra:e}=f;if(!("none"===d||f.statistics?.length||this._isValidRasterStatistics(this.rasterInfo.statistics)||e))return{success:!1,error:"Unsupported renderer; StretchRenderer.statistics is required when dynamic range adjustment is not used."};var q=f.histograms||this.rasterInfo.histograms;!this._isHistogramRequired(f.stretchType)||q?.length||e||(d="minMax");const {computeGamma:l,useGamma:a,colorRamp:k}=
f;let {gamma:p}=f;a&&l&&!p?.length&&(p=m.computeGammaValues(this.rasterInfo.pixelType,f.statistics?.length?f.statistics:this.rasterInfo.statistics));var z=this.rasterInfo.pixelType;const I=!e&&["u8","u16","s8","s16"].includes(z);"histogramEqualization"===d?(z=q.map(N=>m.createHistogramEqualizationLUT(N)),this.lookup={rendererJSON:f,histogramLut:z}):I&&(q=m.getStretchCutoff(f,{rasterInfo:this.rasterInfo}),z=m.createStretchLUT({pixelType:z,...q,gamma:a?p:null,rounding:"floor"}),this.lookup={rendererJSON:f,
stretchLut:z});k&&(z=g.convertColorRampToColormap(k,{interpolateAlpha:!0}),this.lookup||(this.lookup={rendererJSON:f}),this.lookup.colormapLut=h.createColormapLUT({colormap:z}),this.lookup.rendererJSON=f);this.lookup.gamma=a&&p?.length?p:null;this.canRenderInWebGL=!0;return{success:!0}};b._generateStretchWebGLParams=function(f,d,e){let q=null,l=null;var a=this.lookup&&this.lookup.colormapLut;d.colorRamp&&a&&(q=a.indexedColormap,l=a.offset);"histogramEqualization"===d.stretchType&&(d={...d,stretchType:"minMax"});
({gamma:a}=this.lookup);const k=!!(d.useGamma&&a&&a.some(y=>1!==y)),{minCutOff:p,maxCutOff:z,outMin:I,outMax:N}=m.getStretchCutoff(d,{rasterInfo:this.rasterInfo,pixelBlock:f,bandIds:e});var O=0;null!=f&&(O=f.getPlaneCount(),2===O&&(f=f.clone(),f.statistics=[f.statistics[0]],f.pixels=[f.pixels[0]]));({bandCount:f}=this.rasterInfo);e=Math.min(3,e?.length||O||f,f);f=new Float32Array(e);O=q||k?1:255;let H;for(H=0;H<p.length;H++)f[H]=z[H]===p[H]?0:(N-I)/(z[H]-p[H])/O;const u=new Float32Array(e);if(k&&
a)for(H=0;H<e;H++)u[H]=1<a[H]?2<a[H]?6.5+(a[H]-2)**2.5:6.5+100*(2-a[H])**4:1;return{bandCount:e,outMin:I/O,outMax:N/O,minCutOff:p,maxCutOff:z,factor:f,useGamma:k,gamma:k?a:[1,1,1],gammaCorrection:k?u:[1,1,1],colormap:q,colormapOffset:l,stretchType:d.stretchType,type:"stretch"}};b._generateShadedReliefWebGLParams=function(f,d=!1,e={x:0,y:0}){let q=null,l=null;const a=this.lookup&&this.lookup.colormapLut;f.colorRamp&&a&&(q=a.indexedColormap,l=a.offset);d=n.calculateHillshadeParams({...f,isGCS:d,resolution:e});
e=this.rasterInfo.statistics?.[0];return{...d,minValue:e?.min??0,maxValue:e?.max??8E3,hillshadeType:"traditional"===f.hillshadeType?0:1,type:"hillshade",colormap:q,colormapOffset:l}};b._generateVectorFieldWebGLParams=function(f){const {style:d,inputUnit:e,outputUnit:q,visualVariables:l,symbolTileSize:a,flowRepresentation:k}=f;let p;var z=this.rasterInfo.statistics?.[0].min??0,I=this.rasterInfo.statistics?.[0].max??50,N=l?.find(u=>"sizeInfo"===u.type)??{type:"sizeInfo",field:"Magnitude",maxDataValue:I,
maxSize:.8*a,minDataValue:z,minSize:.2*a},O=N.minDataValue??z,H=N.maxDataValue??I;I=null!=N.maxSize&&null!=N.minSize?[N.minSize/a,N.maxSize/a]:[.2,.8];"wind_speed"===d&&(I[0]=I[1]=(I[0]+I[1])/2);z=null!=O&&null!=H?[O,H]:null;if("classified_arrow"===d)if(null!=O&&null!=H&&null!=N)for(p=[],O=(N.maxDataValue-N.minDataValue)/5,H=0;6>H;H++)p.push(N.minDataValue+O*H);else p=[0,1E-6,3.5,7,10.5,14];N="flow_to"===k===("ocean_current_kn"===d||"ocean_current_m"===d)?0:Math.PI;O=l?.find(u=>"rotationInfo"===u.type);
return{breakValues:p,dataRange:z,inputUnit:e,outputUnit:q,symbolTileSize:a,symbolPercentRange:I,style:d||"single_arrow",rotation:N,rotationType:this.rasterInfo.storageInfo?.tileInfo&&"vector-uv"===this.rasterInfo.dataType?"geographic":O?.rotationType||f.rotationType,type:"vectorField"}};return P._createClass(r)}(C.JSONSupport);w.__decorate([T.property({json:{write:!0}})],C.prototype,"rendererJSON",void 0);w.__decorate([T.property({type:G,json:{write:!0}})],C.prototype,"rasterInfo",void 0);w.__decorate([T.property({json:{write:!0}})],
C.prototype,"lookup",void 0);w.__decorate([T.property()],C.prototype,"canRenderInWebGL",void 0);return C=w.__decorate([D.subclass("esri.renderers.support.RasterSymbolizer")],C)})},"esri/rest/support/ImageHistogramParameters":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../TimeExtent ../../core/deprecate ../../core/JSONSupport ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../geometry/support/jsonUtils ../../layers/support/MosaicRule ../../layers/support/RasterFunction ../../geometry/Point".split(" "),
function(P,w,E,C,B,T,R,S,K,D,G,h,m,n,g,c){var t;T=t=function(A){function r(){var f=A.apply(this,arguments)||this;f.geometry=null;f.mosaicRule=null;f.rasterFunction=null;f.pixelSize=null;f.raster=void 0;f.timeExtent=null;return f}P._inherits(r,A);var b=r.prototype;b.writeGeometry=function(f,d,e){null!=f&&(d.geometryType=m.getJsonType(f),d[e]=f.toJSON())};b.clone=function(){return new t(R.clone({geometry:this.geometry,mosaicRule:this.mosaicRule,rasterFunction:this.rasterFunction,pixelSize:this.pixelSize,
raster:this.raster,timeExtent:this.timeExtent}))};P._createClass(r,[{key:"renderingRule",get:function(){B.deprecatedProperty(S.getLogger(this),"renderingRule",{replacement:"rasterFunction",version:"4.27",warnOnce:!0});return this._get("rasterFunction")},set:function(f){B.deprecatedProperty(S.getLogger(this),"renderingRule",{replacement:"rasterFunction",version:"4.27",warnOnce:!0});this._set("rasterFunction",f)}}]);return r}(T.JSONSupport);w.__decorate([K.property({types:E.geometryTypes,json:{read:m.fromJSON}})],
T.prototype,"geometry",void 0);w.__decorate([h.writer("geometry")],T.prototype,"writeGeometry",null);w.__decorate([K.property({type:n,json:{write:!0}})],T.prototype,"mosaicRule",void 0);w.__decorate([K.property({type:g})],T.prototype,"renderingRule",null);w.__decorate([K.property({type:g,json:{write:!0,name:"renderingRule"}})],T.prototype,"rasterFunction",void 0);w.__decorate([K.property({type:c,json:{write:!0}})],T.prototype,"pixelSize",void 0);w.__decorate([K.property({json:{write:!0}})],T.prototype,
"raster",void 0);w.__decorate([K.property({type:C,json:{read:{source:"time"},write:{target:"time"}}})],T.prototype,"timeExtent",void 0);return T=t=w.__decorate([G.subclass("esri.rest.support.ImageHistogramParameters")],T)})},"esri/layers/support/MosaicRule":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/deprecate ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../core/accessorSupport/ensureType ../../geometry/Point ./DimensionalDefinition ./RasterFunction".split(" "),
function(P,w,E,C,B,T,R,S,K,D,G,h,m,n,g,c){var t;const A=C.strict()({MT_FIRST:"first",MT_LAST:"last",MT_MIN:"min",MT_MAX:"max",MT_MEAN:"mean",MT_BLEND:"blend",MT_SUM:"sum"}),r=C.strict()({esriMosaicNone:"none",esriMosaicCenter:"center",esriMosaicNadir:"nadir",esriMosaicViewpoint:"viewpoint",esriMosaicAttribute:"attribute",esriMosaicLockRaster:"lock-raster",esriMosaicNorthwest:"northwest",esriMosaicSeamline:"seamline"});C=t=function(b){function f(e){e=b.call(this,e)||this;e.ascending=!0;e.itemRasterFunction=
null;e.lockRasterIds=null;e.method=null;e.multidimensionalDefinition=null;e.objectIds=null;e.operation=null;e.sortField=null;e.sortValue=null;e.viewpoint=null;e.where=null;return e}P._inherits(f,b);var d=f.prototype;d.readAscending=function(e,q){return null!=q.ascending?q.ascending:null!=q.sortAscending?q.sortAscending:!0};d.readMethod=function(e,q){e=q.mosaicMethod||q.defaultMosaicMethod;switch(e?e.toLowerCase().replace("esrimosaic",""):""){case "byattribute":case "attribute":e="esriMosaicAttribute";
break;case "lockraster":e="esriMosaicLockRaster";break;case "center":e="esriMosaicCenter";break;case "northwest":e="esriMosaicNorthwest";break;case "nadir":e="esriMosaicNadir";break;case "viewpoint":e="esriMosaicViewpoint";break;case "seamline":e="esriMosaicSeamline";break;case "none":e="esriMosaicNone";break;default:e="esriMosaicNone"}return r.fromJSON(e)};d.writeMultidimensionalDefinition=function(e,q,l){null!=e&&(e=e.filter(({variableName:a,dimensionName:k})=>a&&"*"!==a||k),e.length&&(q[l]=e.map(a=>
a.toJSON())))};d.readOperation=function(e,q){e=q.mosaicOperation;q=q.mosaicOperator&&q.mosaicOperator.toLowerCase();q=e||(q?A.toJSON(q):null);return A.fromJSON(q)||"first"};d.castSortValue=function(e){return null==e||"string"===typeof e||"number"===typeof e?e:`${e}`};d.clone=function(){return new t({ascending:this.ascending,itemRasterFunction:T.clone(this.itemRasterFunction),lockRasterIds:T.clone(this.lockRasterIds),method:this.method,multidimensionalDefinition:T.clone(this.multidimensionalDefinition),
objectIds:T.clone(this.objectIds),operation:this.operation,sortField:this.sortField,sortValue:this.sortValue,viewpoint:T.clone(this.viewpoint),where:this.where})};P._createClass(f,[{key:"itemRenderingRule",get:function(){E.deprecatedProperty(R.getLogger(this),"itemRenderingRule",{replacement:"itemRasterFunction",version:"4.27",warnOnce:!0});return this._get("itemRasterFunction")},set:function(e){E.deprecatedProperty(R.getLogger(this),"itemRenderingRule",{replacement:"itemRasterFunction",version:"4.27",
warnOnce:!0});this._set("itemRasterFunction",e)}}]);return f}(B.JSONSupport);w.__decorate([S.property({type:Boolean,json:{write:!0}})],C.prototype,"ascending",void 0);w.__decorate([D.reader("ascending",["ascending","sortAscending"])],C.prototype,"readAscending",null);w.__decorate([S.property({type:c,json:{name:"itemRenderingRule",write:!0}})],C.prototype,"itemRasterFunction",void 0);w.__decorate([S.property({type:c})],C.prototype,"itemRenderingRule",null);w.__decorate([S.property({type:[m.Integer],
json:{write:{overridePolicy(){return{enabled:"lock-raster"===this.method}}}}})],C.prototype,"lockRasterIds",void 0);w.__decorate([S.property({type:String,json:{type:r.jsonValues,write:{target:"mosaicMethod",writer:r.write}}})],C.prototype,"method",void 0);w.__decorate([D.reader("method",["mosaicMethod","defaultMosaicMethod"])],C.prototype,"readMethod",null);w.__decorate([S.property({type:[g],json:{write:!0}})],C.prototype,"multidimensionalDefinition",void 0);w.__decorate([h.writer("multidimensionalDefinition")],
C.prototype,"writeMultidimensionalDefinition",null);w.__decorate([S.property({type:[m.Integer],json:{name:"fids",write:!0}})],C.prototype,"objectIds",void 0);w.__decorate([S.property({json:{type:A.jsonValues,read:{reader:A.read},write:{target:"mosaicOperation",writer:A.write}}})],C.prototype,"operation",void 0);w.__decorate([D.reader("operation",["mosaicOperation","mosaicOperator"])],C.prototype,"readOperation",null);w.__decorate([S.property({type:String,json:{write:{overridePolicy(){return{enabled:"attribute"===
this.method}}}}})],C.prototype,"sortField",void 0);w.__decorate([S.property({type:[String,Number],json:{write:{allowNull:!0,overridePolicy(){return{enabled:"attribute"===this.method,allowNull:!0}}}}})],C.prototype,"sortValue",void 0);w.__decorate([K.cast("sortValue")],C.prototype,"castSortValue",null);w.__decorate([S.property({type:n,json:{write:!0}})],C.prototype,"viewpoint",void 0);w.__decorate([S.property({type:String,json:{write:!0}})],C.prototype,"where",void 0);return C=t=w.__decorate([G.subclass("esri.layers.support.MosaicRule")],
C)})},"esri/views/2d/engine/flow/dataUtils":function(){define("exports ../../../../geometry ../../../../core/has ../../../../core/Logger ../../../../core/mathUtils ../../../../core/promiseUtils ../../../../core/RandomLCG ../../../../geometry/support/spatialReferenceUtils ../../../../geometry/Extent".split(" "),function(P,w,E,C,B,T,R,S,K){function D(b,f){const d=m(f.data,f.width,f.height,b.smoothing);return b.interpolate?(e,q)=>{const l=Math.floor(e),a=Math.floor(q);if(0>l||l>=f.width||0>a||a>=f.height)return[0,
0];e-=l;q-=a;const k=l<f.width-1?l+1:l,p=a<f.height-1?a+1:a;return[(d[2*(a*f.width+l)]*(1-q)+d[2*(p*f.width+l)]*q)*(1-e)+(d[2*(a*f.width+k)]*(1-q)+d[2*(p*f.width+k)]*q)*e,(d[2*(a*f.width+l)+1]*(1-q)+d[2*(p*f.width+l)+1]*q)*(1-e)+(d[2*(a*f.width+k)+1]*(1-q)+d[2*(p*f.width+k)+1]*q)*e]}:(e,q)=>{e=Math.round(e);q=Math.round(q);return 0>e||e>=f.width||0>q||q>=f.height?[0,0]:[d[2*(q*f.width+e)],d[2*(q*f.width+e)+1]]}}function G(b,f,d,e,q,l,a,k,p){const z=[];let I=0,[N,O]=f(d,e);N*=b.velocityScale;O*=b.velocityScale;
z.push({x:d,y:e,t:I,speed:Math.sqrt(N*N+O*O)});for(let y=0;y<b.verticesPerLine;y++){let [x,L]=f(d,e);x*=b.velocityScale;L*=b.velocityScale;const Q=Math.sqrt(x*x+L*L);if(Q<b.minSpeedThreshold)break;const W=x/Q,v=L/Q;d+=W*b.segmentLength;e+=v*b.segmentLength;I+=b.segmentLength/Q;if(Math.acos(W*H+v*u)>b.maxTurnAngle)break;if(b.collisions){var H=Math.round(d*p);var u=Math.round(e*p);if(0>H||H>a-1||0>u||u>k-1)break;const F=l[u*a+H];if(-1!==F&&F!==q)break;l[u*a+H]=q}z.push({x:d,y:e,t:I,speed:Q});H=W;u=
v}return z}function h(b,f,d,e){const q=[],l=new R,a=1/Math.max(b.lineCollisionWidth,1),k=Math.round(d*a),p=Math.round(e*a),z=new Int32Array(k*p);for(var I=0;I<z.length;I++)z[I]=-1;I=[];for(let N=0;N<e;N+=b.lineSpacing)for(let O=0;O<d;O+=b.lineSpacing)I.push({x:O,y:N,sort:l.getFloat()});I.sort((N,O)=>N.sort-O.sort);for(const {x:N,y:O}of I)l.getFloat()<b.density&&(d=G(b,f,N,O,q.length,z,k,p,a),2>d.length||q.push(d));return q}function m(b,f,d,e){if(0===e)return b;const q=Math.round(3*e),l=Array(2*q+
1);var a=0;for(var k=-q;k<=q;k++){var p=Math.exp(-k*k/(e*e));l[k+q]=p;a+=p}for(e=-q;e<=q;e++)l[e+q]/=a;a=new Float32Array(b.length);for(e=0;e<d;e++)for(k=0;k<f;k++){var z=p=0;for(var I=-q;I<=q;I++)if(!(0>k+I||k+I>=f)){var N=l[I+q];p+=N*b[2*(e*f+(k+I))];z+=N*b[2*(e*f+(k+I))+1]}a[2*(e*f+k)]=p;a[2*(e*f+k)+1]=z}b=new Float32Array(b.length);for(e=0;e<f;e++)for(k=0;k<d;k++){z=p=0;for(I=-q;I<=q;I++)0>k+I||k+I>=d||(N=l[I+q],p+=N*a[2*((k+I)*f+e)],z+=N*a[2*((k+I)*f+e)+1]);b[2*(k*f+e)]=p;b[2*(k*f+e)+1]=z}return b}
function n(b,f){const d=new R;var e=b.reduce((k,p)=>k+p.length,0);e=new Float32Array(4*e);const q=Array(b.length);let l=0,a=0;for(const k of b){b=l;for(const p of k)e[4*l]=p.x,e[4*l+1]=p.y,e[4*l+2]=p.t,e[4*l+3]=p.speed,l++;q[a++]={startVertex:b,numberOfVertices:k.length,totalTime:k[k.length-1].t,timeSeed:f?d.getFloat():0}}return{lineVertices:e,lineDescriptors:q}}function g(b,f){function d(H,u,y,x,L,Q,W,v){const F=9*p;let J=0;k[F+J++]=H;k[F+J++]=u;k[F+J++]=1;k[F+J++]=y;k[F+J++]=Q;k[F+J++]=W;k[F+J++]=
x/2;k[F+J++]=L/2;k[F+J++]=v;p++;k[F+J++]=H;k[F+J++]=u;k[F+J++]=-1;k[F+J++]=y;k[F+J++]=Q;k[F+J++]=W;k[F+J++]=-x/2;k[F+J++]=-L/2;k[F+J++]=v;p++}const {lineVertices:e,lineDescriptors:q}=b;var l=b=0;for(var a of q)b+=2*a.numberOfVertices,l+=6*(a.numberOfVertices-1);const k=new Float32Array(9*b);a=new Uint32Array(l);let p=0;b=0;for(const H of q){const {totalTime:u,timeSeed:y}=H;let x=l=null,L=null;var z=null,I=null,N=null;for(let Q=0;Q<H.numberOfVertices;Q++){z=e[4*(H.startVertex+Q)];const W=e[4*(H.startVertex+
Q)+1],v=e[4*(H.startVertex+Q)+2],F=e[4*(H.startVertex+Q)+3];let J=null,M=null;var O=null;let U=null;0<Q&&(J=z-l,M=W-x,O=Math.sqrt(J*J+M*M),J/=O,M/=O,1<Q?(I=J+I,N=M+N,O=Math.sqrt(I*I+N*N),I/=O,N/=O,O=Math.min(1/(I*J+N*M),f),I*=O,N*=O,O=-N,U=I):(O=-M,U=J),null!==O&&null!==U&&(d(l,x,L,O,U,u,y,F),a[b++]=p-2,a[b++]=p,a[b++]=p-1,a[b++]=p,a[b++]=p+1,a[b++]=p-1));l=z;x=W;L=v;I=J;N=M;z=F}d(l,x,L,-N,I,u,y,z)}return{vertexData:k,indexData:a}}function c(b){function f(X,Z){var Y=v+J,ea=F+M,da=Math.sqrt(Y*Y+ea*
ea);Y/=da;ea/=da;var ia=v*Y+F*ea,fa=J+U,ja=M+V;da=Math.sqrt(fa*fa+ja*ja);fa/=da;ja/=da;var ma=J*fa+M*ja;da=O;var na=H,ra=u,qa=y;ea=-(ea/ia);Y/=ia;ia=x;var va=L,sa=Q,xa=W;ja=-(ja/ma);fa/=ma;ma=16*I;let oa=0;for(const wa of[1,2])for(const aa of[1,2,3,4])p[ma+oa++]=da,p[ma+oa++]=na,p[ma+oa++]=ra,p[ma+oa++]=qa,p[ma+oa++]=ia,p[ma+oa++]=va,p[ma+oa++]=sa,p[ma+oa++]=xa,p[ma+oa++]=wa,p[ma+oa++]=aa,p[ma+oa++]=X,p[ma+oa++]=Z,p[ma+oa++]=ea/2,p[ma+oa++]=Y/2,p[ma+oa++]=ja/2,p[ma+oa++]=fa/2,I++;z[N++]=I-8;z[N++]=
I-7;z[N++]=I-6;z[N++]=I-7;z[N++]=I-5;z[N++]=I-6;z[N++]=I-4;z[N++]=I-3;z[N++]=I-2;z[N++]=I-3;z[N++]=I-1;z[N++]=I-2}function d(X,Z,Y,ea,da,ia){v=J;F=M;J=U;M=V;null==v&&null==F&&(v=J,F=M);if(null!=x&&null!=L){U=X-x;V=Z-L;const fa=Math.sqrt(U*U+V*V);U/=fa;V/=fa}null!=v&&null!=F&&f(da,ia);O=x;H=L;u=Q;y=W;x=X;L=Z;Q=Y;W=ea}function e(X,Z){v=J;F=M;J=U;M=V;null==v&&null==F&&(v=J,F=M);null!=v&&null!=F&&f(X,Z)}const {lineVertices:q,lineDescriptors:l}=b;let a=b=0;for(var k of l){const X=k.numberOfVertices-1;
b+=8*X;a+=12*X}const p=new Float32Array(16*b),z=new Uint32Array(a);let I=0,N=0,O,H,u,y,x,L,Q,W,v,F,J,M,U,V;for(const X of l){V=U=M=J=F=v=W=Q=L=x=y=u=H=O=null;const {totalTime:Z,timeSeed:Y}=X;for(k=0;k<X.numberOfVertices;k++)d(q[4*(X.startVertex+k)],q[4*(X.startVertex+k)+1],q[4*(X.startVertex+k)+2],q[4*(X.startVertex+k)+3],Z,Y);e(Z,Y)}return{vertexData:p,indexData:z}}function t(b,f){const d=f.pixels,{width:e,height:q}=f,l=new Float32Array(e*q*2),a=f.mask||new Uint8Array(e*q*2);f.mask||a.fill(255);
if("vector-uv"===b)for(b=0;b<e*q;b++)l[2*b]=d[0][b],l[2*b+1]=-d[1][b];else if("vector-magdir"===b)for(b=0;b<e*q;b++){f=d[0][b];const k=B.deg2rad(d[1][b]),p=Math.sin(k-Math.PI/2);l[2*b]=Math.cos(k-Math.PI/2)*f;l[2*b+1]=p*f}return{data:l,mask:a,width:e,height:q}}async function A(b,f,d,e,q,l){const a={requestProjectedLocalDirections:!0,signal:l};null!=q&&(a.timeExtent=q);if("imagery"===b.type)return await b.load({signal:l}),q=b.rasterInfo.dataType,(b=await b.fetchImage(f,d,e,a))&&null!=b.pixelData&&
null!=b.pixelData.pixelBlock?t(q,b.pixelData.pixelBlock):{data:new Float32Array(d*e*2),mask:new Uint8Array(d*e),width:d,height:e};await b.load({signal:l});q=b.rasterInfo.dataType;return(b=await b.fetchPixels(f,d,e,a))&&null!=b.pixelBlock?t(q,b.pixelBlock):{data:new Float32Array(d*e*2),mask:new Uint8Array(d*e),width:d,height:e}}const r=C.getLogger("esri.views.2d.engine.flow.dataUtils");P.createAnimatedLinesData=n;P.createFlowMesh=async function(b,f,d,e){const q=performance.now();var l=D(f,d);const a=
performance.now();d=h(f,l,d.width,d.height);f=performance.now();l=n(d,!0);d=performance.now();b="Streamlines"===b?g(l,10):c(l);l=performance.now();E("esri-2d-profiler")&&(r.info("I.1","_createFlowFieldFromData (ms)",Math.round(a-q)),r.info("I.2","_getStreamlines (ms)",Math.round(f-a)),r.info("I.3","createAnimatedLinesData (ms)",Math.round(d-f)),r.info("I.4","create{Streamlines|Particles}Mesh (ms)",Math.round(l-d)),r.info("I.5","createFlowMesh (ms)",Math.round(l-q)),r.info("I.6","Mesh size (bytes)",
b.vertexData.buffer.byteLength+b.indexData.buffer.byteLength));await Promise.resolve();T.throwIfAborted(e);return b};P.createParticlesMesh=c;P.createStreamlinesMesh=g;P.loadImagery=async function(b,f,d,e,q,l){const a=performance.now();var k=S.getInfo(f.spatialReference);if(!k)return d=await A(b,f,d,e,q,l),E("esri-2d-profiler")&&r.info("I.7","loadImagery, early exit (ms)",Math.round(performance.now()-a)),E("esri-2d-profiler")&&r.info("I.9","Number of parts",1),d;const [p,z]=k.valid,I=Math.ceil(f.width/
(z-p)),N=f.width/I,O=Math.round(d/I);let H=f.xmin;const u=[];k=performance.now();for(let y=0;y<I;y++){const x=new K({xmin:H,xmax:H+N,ymin:f.ymin,ymax:f.ymax,spatialReference:f.spatialReference});u.push(A(b,x,O,e,q,l));H+=N}b=await Promise.all(u);E("esri-2d-profiler")&&r.info("I.8","All calls to _fetchPart (ms)",Math.round(performance.now()-k));E("esri-2d-profiler")&&r.info("I.9","Number of parts",b.length);e={data:new Float32Array(d*e*2),mask:new Uint8Array(d*e),width:d,height:e};f=0;for(const y of b){for(b=
0;b<y.height;b++)for(q=0;q<y.width;q++)f+q>=d||(e.data[2*(b*d+f+q)]=y.data[2*(b*y.width+q)],e.data[2*(b*d+f+q)+1]=y.data[2*(b*y.width+q)+1],e.mask[b*d+f+q]=y.mask[b*y.width+q]);f+=y.width}E("esri-2d-profiler")&&r.info("I.10","loadImagery, general exit (ms)",Math.round(performance.now()-a));return e};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/RasterFactory":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../core/Error ./CloudRaster ./ImageAuxRaster ./ImageServerRaster ./MRFRaster ./TIFFRaster".split(" "),
function(P,w,E,C,B,T,R){const S=new Map;S.set("CRF",{desc:"Cloud Raster Format",constructor:E});S.set("MRF",{desc:"Meta Raster Format",constructor:T});S.set("TIFF",{desc:"GeoTIFF",constructor:R});S.set("RasterTileServer",{desc:"Raster Tile Server",constructor:B});S.set("JPG",{desc:"JPG Raster Format",constructor:C});S.set("PNG",{desc:"PNG Raster Format",constructor:C});S.set("GIF",{desc:"GIF Raster Format",constructor:C});S.set("BMP",{desc:"BMP Raster Format",constructor:C});return function(){function K(){}
K.open=async function(D){const {url:G,ioConfig:h,sourceJSON:m}=D;let n=D.datasetFormat;null==n&&G.lastIndexOf(".")&&(n=G.slice(G.lastIndexOf(".")+1).toUpperCase());if("OVR"===n||"TIF"===n)n="TIFF";else if("JPG"===n||"JPEG"===n||"JFIF"===n)n="JPG";G.toLowerCase().includes("/imageserver")&&!G.toLowerCase().includes("/wcsserver")&&(n="RasterTileServer");const g={bandIds:null,sampling:null},c={url:G,sourceJSON:m,datasetFormat:n,ioConfig:h??g};let t,A;if(n&&this.supportedFormats.has(n)){if("CRF"===n&&
!h?.enableCRF)throw new w("rasterfactory:open",`cannot open raster: ${G}`);t=S.get(n).constructor;A=new t(c);await A.open({signal:D.signal});return A}if(n)throw new w("rasterfactory:open","not a supported format "+n);const r=Array.from(S.keys());let b=0;const f=()=>{n=r[b++];if(!n||"CRF"===n&&!h?.enableCRF)return null;t=S.get(n).constructor;A=new t(c);return A.open({signal:D.signal}).then(()=>A).catch(()=>f())};return f()};K.register=function(D,G,h){S.has(D.toUpperCase())||S.set(D.toUpperCase(),{desc:G,
constructor:h})};P._createClass(K,null,[{key:"supportedFormats",get:function(){const D=new Set;S.forEach((G,h)=>D.add(h));return D}}]);return K}()})},"esri/layers/support/rasterDatasets/CloudRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../LOD ../RasterInfo ../RasterStorageInfo ../TileInfo ./BaseRaster ./DBFParser ../rasterTransforms/utils ../../../rest/support/FeatureSet ../../../geometry/SpatialReference ../../../geometry/Extent ../../../geometry/Point".split(" "),
function(P,w,E,C,B,T,R,S,K,D,G,h,m,n,g,c,t,A,r,b){const f=new Map;f.set("int16","esriFieldTypeSmallInteger");f.set("int32","esriFieldTypeInteger");f.set("int64","esriFieldTypeInteger");f.set("float32","esriFieldTypeSingle");f.set("float64","esriFieldTypeDouble");f.set("text","esriFieldTypeString");E=function(d){function e(){var l=d.apply(this,arguments)||this;l.storageInfo=null;l.datasetFormat="CRF";return l}P._inherits(e,d);var q=e.prototype;q.open=async function(l){await this.init();({data:l}=await this.request(this.url+
"/conf.json",{signal:l?.signal}));if(!this._validateHeader(l))throw new C("cloudraster:open","Invalid or unsupported conf.json.");this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1);const {storageInfo:a,rasterInfo:k}=this._parseHeader(l);"thematic"===k.dataType&&(l=await this._fetchAuxiliaryInformation(),k.attributeTable=l);this._set("storageInfo",a);this._set("rasterInfo",k);this.ioConfig.retryCount=this.ioConfig.retryCount||0};q.fetchRawTile=async function(l,a,k,p={}){var {transposeInfo:z}=
this.rasterInfo.storageInfo,{transposedVariableName:I}=p;l=(z=!(!z||!I))?0:this.rasterInfo.storageInfo.maximumPyramidLevel-l;if(0>l)return null;I=this._buildCacheFilePath(l,a,k,p.multidimensionalDefinition,I);a=this._getIndexRecordFromBundle(a,k,z);k=await this.request(I,{range:{from:0,to:this.storageInfo.headerSize-1},responseType:"array-buffer",signal:p.signal});if(!k)return null;k=new Uint8Array(k.data);a=this._getTileEndAndContentType(k,a);if(0===a.recordSize)return null;p=await this.request(I,
{range:{from:a.position,to:a.position+a.recordSize},responseType:"array-buffer",signal:p.signal});if(!p)return null;const [N,O]=this._getTileSize(z);return this.decodePixelBlock(p.data,{width:N,height:O,planes:null,pixelType:null,returnInterleaved:z})};q._validateHeader=function(l){const a="origin extent geodataXform LODInfos blockWidth blockHeight bandCount pixelType pixelSizeX pixelSizeY format packetSize".split(" ");return l&&"RasterInfo"===l.type&&!a.some(k=>!l[k])};q._parseHeader=function(l){var a=
"u1 u2 u4 u8 s8 u16 s16 u32 s32 f32 f64".split(" ")[l.pixelType];const {bandCount:k,histograms:p,colormap:z,blockWidth:I,blockHeight:N,firstPyramidLevel:O,maximumPyramidLevel:H}=l,u=l.statistics&&l.statistics.map(da=>({min:da.min,max:da.max,avg:da.mean,stddev:da.standardDeviation,median:da.median,mode:da.mode}));var y=l.extent.spatialReference,x=l.geodataXform?.spatialReference;y=new A(y?.wkid||y?.wkt?y:x);x=new r({xmin:l.extent.xmin,ymin:l.extent.ymin,xmax:l.extent.xmax,ymax:l.extent.ymax,spatialReference:y});
const L=new b({x:l.pixelSizeX,y:l.pixelSizeY,spatialReference:y}),Q=Math.round((x.xmax-x.xmin)/L.x),W=Math.round((x.ymax-x.ymin)/L.y),v=this._parseTransform(l.geodataXform),F=v?x:null;v&&(x=v.forwardTransform(x),L.x=(x.xmax-x.xmin)/Q,L.y=(x.ymax-x.ymin)/W);const J=l.properties??{};var M=l.format.toLowerCase().replace("cache/","");const U=new b(l.origin.x,l.origin.y,y);let V;var X;if(z&&z.colors)for(V=[],X=0;X<z.colors.length;X++){var Z=z.colors[X];var Y=z.values?z.values[X]:X;V.push([Y,Z&255,Z<<16>>>
24,Z<<8>>>24,Z>>>24])}Z=l.LODInfos;Y=[];for(X=0;X<Z.levels.length;X++)Y.push(new D({level:Z.levels[X],resolution:Z.resolutions[X],scale:96/.0254*Z.resolutions[X]}));Z=new m({dpi:96,lods:Y,format:M,origin:U,size:[I,N],spatialReference:y});M={recordSize:8,packetSize:l.packetSize,headerSize:l.packetSize*l.packetSize*8+64};Y=[{maxCol:Math.ceil(Q/I)-1,maxRow:Math.ceil(W/N)-1,minCol:0,minRow:0}];let ea=2;if(0<H)for(X=0;X<H;X++)Y.push({maxCol:Math.ceil(Q/ea/I)-1,maxRow:Math.ceil(W/ea/N)-1,minCol:0,minRow:0}),
ea*=2;l=l.mdInfo;X=null;l&&J._yxs&&(X=J._yxs,X={packetSize:X.PacketSize,tileSize:[X.TileXSize,X.TileYSize]});a=new G({width:Q,height:W,pixelType:a,bandCount:k,extent:x,nativeExtent:F,transform:v,spatialReference:y,pixelSize:L,keyProperties:J,statistics:u,histograms:p,multidimensionalInfo:l,colormap:V,storageInfo:new h({blockWidth:I,blockHeight:N,pyramidBlockWidth:I,pyramidBlockHeight:N,origin:U,tileInfo:Z,transposeInfo:X,firstPyramidLevel:O,maximumPyramidLevel:H,blockBoundary:Y})});return{storageInfo:M,
rasterInfo:a}};q._parseTransform=function(l){if(!c.isTransformSupported(l))throw new C("cloudraster:open","the data contains unsupported geodata transform types");l=c.readTransform(l);if("identity"===l.type)return null;if("polynomial"!==l.type||!l.forwardCoefficients?.length||!l.inverseCoefficients?.length)throw new C("cloudraster:open","the data contains unsupported geodata transforms - both forward and inverse coefficients are required currently");return l};q._fetchAuxiliaryInformation=async function(l){var a=
this.request(this.url+"/conf.vat.json",{signal:l}).then(p=>p.data).catch(()=>null);l=this.request(this.url+"/conf.vat.dbf",{responseType:"array-buffer",signal:l}).then(p=>p.data).catch(()=>null);a=await Promise.all([a,l]);let k;if(a[0]){l=a[0].fields;const p=a[0].values;if(l&&p){l=l.map(I=>({type:"OID"===I.name?"esriFieldTypeOID":f.get(I.type),name:I.name,alias:I.alias||I.name}));const z=p.map(I=>({attributes:I}));l&&p&&(k={fields:l,features:z})}}!k&&a[1]&&(k=g.parse(a[1]).recordSet);return t.fromJSON(k)};
q._buildCacheFilePath=function(l,a,k,p,z){var I=this._getPackageSize(!!z);k=Math.floor(k/I)*I;a="R"+this._toHexString4(Math.floor(a/I)*I)+"C"+this._toHexString4(k);I="L";I=10<=l?I+l.toString():I+("0"+l.toString());({multidimensionalInfo:l}=this.rasterInfo);const N=p?.[0];if(null==l||!N)return`${this.url}/_alllayers/${I}/${a}.bundle`;p="_yxs";if(!z){p=l.variables.find(O=>O.name===N.variableName).dimensions[0].values.indexOf(N.values[0]).toString(16);l=4-p.length;for(k=0;k<l;k++)p="0"+p;p="S"+p}z=this._getVariableFolderName(z||
N.variableName);return`${this.url}/_alllayers/${z}/${p}/${I}/${a}.bundle`};q._getPackageSize=function(l=!1){const {transposeInfo:a}=this.rasterInfo.storageInfo;return l&&null!=a?a.packetSize??0:this.storageInfo.packetSize};q._getTileSize=function(l=!1){const {storageInfo:a}=this.rasterInfo,{transposeInfo:k}=a;return l&&null!=k?k.tileSize:a.tileInfo.size};q._getVariableFolderName=function(l){l=l.trim();return""===l?"_v":l.replaceAll(/[\{|\}\-]/g,"_").replace("\\*","_v")};q._getIndexRecordFromBundle=
function(l,a,k=!1){k=this._getPackageSize(k);l=l%k*k+a%k;if(0>l)throw Error("Invalid level / row / col");return l*this.storageInfo.recordSize+64};q._getTileEndAndContentType=function(l,a){l=l.subarray(a,a+8);a=0;let k;for(k=0;5>k;k++)a|=(l[k]&255)<<8*k;const p=a&0xffffffffff;a=0;for(k=5;8>k;k++)a|=(l[k]&255)<<8*(k-5);return{position:p,recordSize:a&0xffffffffff}};q._toHexString4=function(l){l=l.toString(16);if(4!==l.length){let a=4-l.length;for(;0<a--;)l="0"+l}return l};return P._createClass(e)}(n);
w.__decorate([B.property({readOnly:!0})],E.prototype,"storageInfo",void 0);w.__decorate([B.property({type:String,json:{write:!0}})],E.prototype,"datasetFormat",void 0);return E=w.__decorate([K.subclass("esri.layers.support.rasterDatasets.CloudRaster")],E)})},"esri/layers/support/rasterDatasets/DBFParser":function(){define(["../../../chunks/_rollupPluginBabelHelpers","./byteStreamUtils"],function(P,w){function E(C){var B=C.fields;C=C.records;const T=B.some(G=>"oid"===G.name.toLowerCase())?"OBJECTID":
"OID";B=[{name:T,type:"esriFieldTypeOID",alias:"OID"}].concat(B.map(G=>({name:G.name,type:"esriFieldType"+G.typeName,alias:G.name})));const R=B.map(G=>G.name),S=[];let K=0,D=0;C.forEach(G=>{const h={};h[T]=K++;for(D=1;D<R.length;D++)h[R[D]]=G[D-1];S.push({attributes:h})});return{displayFieldName:"",fields:B,features:S}}return function(){function C(){}C.parse=function(B){var T=new DataView(B),R=T.getUint8(0)&3;if(3!==R)return{header:{version:R},recordSet:null};const S=T.getUint32(4,!0);var K=T.getUint16(8,
!0);const D=T.getUint16(10,!0);K={version:R,recordCount:S,headerByteCount:K,recordByteCount:D};let G=32;const h=[],m=[];if(3===R){for(;13!==T.getUint8(G);)R=String.fromCharCode(T.getUint8(G+11)).trim(),h.push({name:w.bytesToUTF8(new Uint8Array(B,G,11)),type:R,typeName:"String Date Double Boolean String Integer".split(" ")["CDFLMN".split("").indexOf(R)],length:T.getUint8(G+16)}),G+=32;G+=1;if(0<h.length)for(;m.length<S&&B.byteLength-G>D;){const n=[];32===T.getUint8(G)?(G+=1,h.forEach(g=>{if("C"===
g.type)n.push(w.bytesToUTF8(new Uint8Array(B,G,g.length)).trim());else if("N"===g.type)n.push(parseInt(String.fromCharCode.apply(null,new Uint8Array(B,G,g.length)).trim(),10));else if("F"===g.type)n.push(parseFloat(String.fromCharCode.apply(null,new Uint8Array(B,G,g.length)).trim()));else if("D"===g.type){const c=String.fromCharCode.apply(null,new Uint8Array(B,G,g.length)).trim();n.push(new Date(parseInt(c.substring(0,4),10),parseInt(c.substring(4,6),10)-1,parseInt(c.substring(6,8),10)))}G+=g.length}),
m.push(n)):G+=D}}T=E({fields:h,records:m});return{header:K,fields:h,records:m,recordSet:T}};P._createClass(C,null,[{key:"supportedVersions",get:function(){return[5]}}]);return C}()})},"esri/layers/support/rasterTransforms/utils":function(){define(["exports","./GCSShiftTransform","./IdentityTransform","./PolynomialTransform"],function(P,w,E,C){const B={GCSShiftXform:w,IdentityXform:E,PolynomialXform:C},T=Object.keys(B);P.isTransformSupported=function(R){return!R||T.includes(R?.type)};P.readTransform=
function(R){if(!R?.type)return null;var S=B[R?.type];return S?(S=new S,S.read(R),S):null};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterTransforms/GCSShiftTransform":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseRasterTransform".split(" "),
function(P,w,E,C,B,T,R,S,K){var D;C=D=function(G){function h(){var n=G.apply(this,arguments)||this;n.type="gcs-shift";n.tolerance=1E-8;return n}P._inherits(h,G);var m=h.prototype;m.forwardTransform=function(n){n=n.clone();if("point"===n.type)return n.x>180+this.tolerance&&(n.x-=360),n;n.xmin>=180-this.tolerance?(n.xmax-=360,n.xmin-=360):n.xmax>180+this.tolerance&&(n.xmin=-180,n.xmax=180);return n};m.inverseTransform=function(n){n=n.clone();if("point"===n.type)return n.x<-this.tolerance&&(n.x+=360),
n;n.xmin<-this.tolerance&&(n.xmin+=360,n.xmax+=360);return n};m.clone=function(){return new D({tolerance:this.tolerance})};return P._createClass(h)}(K);w.__decorate([R.enumeration({GCSShiftXform:"gcs-shift"})],C.prototype,"type",void 0);w.__decorate([E.property()],C.prototype,"tolerance",void 0);return C=D=w.__decorate([S.subclass("esri.layers.support.rasterTransforms.GCSShiftTransform")],C)})},"esri/layers/support/rasterTransforms/BaseRasterTransform":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),
function(P,w,E,C,B,T,R,S){E=function(K){function D(){return K.apply(this,arguments)||this}P._inherits(D,K);var G=D.prototype;G.forwardTransform=function(h){return h};G.inverseTransform=function(h){return h};P._createClass(D,[{key:"affectsPixelSize",get:function(){return!1}}]);return D}(E.JSONSupport);w.__decorate([C.property()],E.prototype,"affectsPixelSize",null);w.__decorate([C.property({json:{write:!0}})],E.prototype,"spatialReference",void 0);return E=w.__decorate([S.subclass("esri.layers.support.rasterTransforms.BaseRasterTransform")],
E)})},"esri/layers/support/rasterTransforms/IdentityTransform":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/Error ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseRasterTransform".split(" "),function(P,w,E,C,B,T,R,S,K,D){var G;E=G=function(h){function m(){var n=h.apply(this,arguments)||
this;n.type="identity";return n}P._inherits(m,h);m.prototype.clone=function(){return new G};return P._createClass(m)}(D);w.__decorate([S.enumeration({IdentityXform:"identity"})],E.prototype,"type",void 0);return E=G=w.__decorate([K.subclass("esri.layers.support.rasterTransforms.IdentityTransform")],E)})},"esri/layers/support/rasterTransforms/PolynomialTransform":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseRasterTransform ../../../geometry/Point ../../../geometry/Extent".split(" "),
function(P,w,E,C,B,T,R,S,K,D,G,h,m,n){function g(A,r,b){const {x:f,y:d}=r;if(2>b)return{x:A[0]+f*A[2]+d*A[4],y:A[1]+f*A[3]+d*A[5]};if(2===b){r=f*f;b=d*d;var e=f*d;return{x:A[0]+f*A[2]+d*A[4]+r*A[6]+e*A[8]+b*A[10],y:A[1]+f*A[3]+d*A[5]+r*A[7]+e*A[9]+b*A[11]}}r=f*f;b=d*d;e=f*d;const q=r*f,l=r*d,a=f*b,k=d*b;return{x:A[0]+f*A[2]+d*A[4]+r*A[6]+e*A[8]+b*A[10]+q*A[12]+l*A[14]+a*A[16]+k*A[18],y:A[1]+f*A[3]+d*A[5]+r*A[7]+e*A[9]+b*A[11]+q*A[13]+l*A[15]+a*A[17]+k*A[19]}}function c(A,r,b){const {xmin:f,ymin:d,
xmax:e,ymax:q,spatialReference:l}=r;r=[];if(2>b)r.push({x:f,y:q}),r.push({x:e,y:q}),r.push({x:f,y:d}),r.push({x:e,y:d});else{var a=10;for(var k=0;k<a;k++)r.push({x:f,y:d+(q-d)*k/(a-1)}),r.push({x:e,y:d+(q-d)*k/(a-1)});a=8;for(k=1;k<=a;k++)r.push({x:f+(e-f)*k/a,y:d}),r.push({x:f+(e-f)*k/a,y:q})}r=r.map(p=>g(A,p,b));a=r.map(p=>p.x);r=r.map(p=>p.y);return new n({xmin:Math.min.apply(null,a),xmax:Math.max.apply(null,a),ymin:Math.min.apply(null,r),ymax:Math.max.apply(null,r),spatialReference:l})}var t;
E=t=function(A){function r(){var f=A.apply(this,arguments)||this;f.polynomialOrder=1;f.type="polynomial";return f}P._inherits(r,A);var b=r.prototype;b.readForwardCoefficients=function(f,d){const {coeffX:e,coeffY:q}=d;if(!e?.length||!q?.length||e.length!==q.length)return null;f=[];for(d=0;d<e.length;d++)f.push(e[d]),f.push(q[d]);return f};b.writeForwardCoefficients=function(f,d,e){e=[];const q=[];for(let l=0;l<f?.length;l++)0===l%2?e.push(f[l]):q.push(f[l]);d.coeffX=e;d.coeffY=q};b.readInverseCoefficients=
function(f,d){const {inverseCoeffX:e,inverseCoeffY:q}=d;if(!e?.length||!q?.length||e.length!==q.length)return null;f=[];for(d=0;d<e.length;d++)f.push(e[d]),f.push(q[d]);return f};b.writeInverseCoefficients=function(f,d,e){e=[];const q=[];for(let l=0;l<f?.length;l++)0===l%2?e.push(f[l]):q.push(f[l]);d.inverseCoeffX=e;d.inverseCoeffY=q};b.forwardTransform=function(f){if("point"===f.type){const d=g(this.forwardCoefficients,f,this.polynomialOrder);return new m({x:d.x,y:d.y,spatialReference:f.spatialReference})}return c(this.forwardCoefficients,
f,this.polynomialOrder)};b.inverseTransform=function(f){if("point"===f.type){const d=g(this.inverseCoefficients,f,this.polynomialOrder);return new m({x:d.x,y:d.y,spatialReference:f.spatialReference})}return c(this.inverseCoefficients,f,this.polynomialOrder)};b.clone=function(){return new t({polynomialOrder:this.polynomialOrder,forwardCoefficients:this.forwardCoefficients?[...this.forwardCoefficients]:null,inverseCoefficients:this.inverseCoefficients?[...this.inverseCoefficients]:null})};P._createClass(r,
[{key:"inverseCoefficients",get:function(){var f=this._get("inverseCoefficients"),d=this._get("forwardCoefficients");if(!f&&d&&2>this.polynomialOrder){const [e,q,l,a,k,p]=d;f=l*p-k*a;d=k*a-l*p;f=[(k*q-e*p)/f,(l*q-e*a)/d,p/f,a/d,-k/f,-l/d]}return f},set:function(f){this._set("inverseCoefficients",f)}},{key:"affectsPixelSize",get:function(){return 0<this.polynomialOrder}}]);return r}(h);w.__decorate([C.property({json:{write:!0}})],E.prototype,"polynomialOrder",void 0);w.__decorate([C.property()],E.prototype,
"forwardCoefficients",void 0);w.__decorate([K.reader("forwardCoefficients",["coeffX","coeffY"])],E.prototype,"readForwardCoefficients",null);w.__decorate([G.writer("forwardCoefficients")],E.prototype,"writeForwardCoefficients",null);w.__decorate([C.property({json:{write:!0}})],E.prototype,"inverseCoefficients",null);w.__decorate([K.reader("inverseCoefficients",["inverseCoeffX","inverseCoeffY"])],E.prototype,"readInverseCoefficients",null);w.__decorate([G.writer("inverseCoefficients")],E.prototype,
"writeInverseCoefficients",null);w.__decorate([C.property()],E.prototype,"affectsPixelSize",null);w.__decorate([S.enumeration({PolynomialXform:"polynomial"})],E.prototype,"type",void 0);return E=t=w.__decorate([D.subclass("esri.layers.support.rasterTransforms.PolynomialTransform")],E)})},"esri/layers/support/rasterDatasets/ImageAuxRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/has ../../../core/promiseUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ./BaseRaster ./InMemoryRaster ./pamParser ../rasterFormats/RasterCodec ../rasterFunctions/stretchUtils ../rasterTransforms/PolynomialTransform ../../../geometry/SpatialReference ../../../geometry/Extent".split(" "),
function(P,w,E,C,B,T,R,S,K,D,G,h,m,n,g,c,t,A){E=function(r){function b(){return r.apply(this,arguments)||this}P._inherits(b,r);var f=b.prototype;f.open=async function(d){await this.init();var e=await this._fetchData(d);let {spatialReference:q,statistics:l,histograms:a,transform:k}=await this._fetchAuxiliaryData(d);(d=!q)&&(q=new t({wkid:3857}));a?.length&&null==l&&(l=g.estimateStatisticsFromHistograms(a));const {width:p,height:z}=e;let I=new A({xmin:-.5,ymin:.5-z,xmax:p-.5,ymax:.5,spatialReference:q});
const N=k?k.forwardTransform(I):I;var O=!0;k&&(O=(O=k.forwardCoefficients)&&0===O[1]&&0===O[2])&&(k=null,I=N);e=new h({data:{extent:N,nativeExtent:I,transform:k,pixelBlock:e,statistics:l,histograms:a,keyProperties:{DateType:"Processed"},isPseudoSpatialReference:d}});await e.open();e.data=null;this._set("rasterInfo",e.rasterInfo);this._inMemoryRaster=e};f.fetchRawTile=function(d,e,q,l={}){return this._inMemoryRaster.fetchRawTile(d,e,q,l)};f._fetchData=async function(d){({data:d}=await this.request(this.url,
{responseType:"array-buffer",signal:d?.signal}));var e=n.getFormat(d).toUpperCase();if("JPG"===e||"PNG"===e||"GIF"===e||"BMP"===e)this._set("datasetFormat",e);else throw new C("image-aux-raster:open","the data is not a supported format");e=e.toLowerCase();const q="gif"===e||"bmp"===e||!B("ios");d=await this.decodePixelBlock(d,{format:e,useCanvas:q,hasNoZlibMask:!0});if(null==d)throw new C("image-aux-raster:open","the data cannot be decoded");return d};f._fetchAuxiliaryData=async function(d){d=d?.signal;
var e=this.ioConfig.skipExtensions??[],q=e.includes("aux.xml")?null:this.request(this.url+".aux.xml",{responseType:"xml",signal:d}),l=this.datasetFormat;e=(l="JPG"===l?"jgw":"PNG"===l?"pgw":"BMP"===l?"bpw":null)&&e.includes(l)?null:this.request(this.url.slice(0,this.url.lastIndexOf("."))+"."+l,{responseType:"text",signal:d});q=await T.eachAlways([q,e]);if(d?.aborted)throw T.createAbortError();d=m.parsePAMInfo(q[0].value?.data);d.transform||(q=q[1].value?q[1].value.data.split("\n").slice(0,6).map(a=>
Number(a)):null,d.transform=6===q?.length?new c({forwardCoefficients:[q[4],q[5],q[0],-q[1],q[2],-q[3]]}):null);return d};return P._createClass(b)}(G);w.__decorate([R.property({type:String,json:{write:!0}})],E.prototype,"datasetFormat",void 0);return E=w.__decorate([D.subclass("esri.layers.support.rasterDatasets.ImageAuxRaster")],E)})},"esri/layers/support/rasterDatasets/InMemoryRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/promiseUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../RasterInfo ./BaseRaster ../rasterFunctions/pixelUtils ../rasterFunctions/stretchUtils ../../../geometry/Extent ../../../geometry/SpatialReference".split(" "),
function(P,w,E,C,B,T,R,S,K,D,G,h,m,n,g,c){E=function(t){function A(){var b=t.apply(this,arguments)||this;b.datasetFormat="MEMORY";b.data=null;return b}P._inherits(A,t);var r=A.prototype;r.open=async function(b){await this.init();var f=this.data;const {pixelBlock:d,statistics:e,histograms:q,name:l,keyProperties:a,nativeExtent:k,transform:p}=this.data,{width:z,height:I,pixelType:N}=d,O=f.extent??new g({xmin:-.5,ymin:.5,xmax:z-.5,ymax:I-.5,spatialReference:new c({wkid:3857})});f=new G({width:z,height:I,
pixelType:N,extent:O,nativeExtent:k,transform:p,pixelSize:{x:O.width/z,y:O.height/I},spatialReference:O.spatialReference,bandCount:d.pixels.length,keyProperties:a||{},statistics:e,isPseudoSpatialReference:f.isPseudoSpatialReference??!f.extent,histograms:q});this.createRemoteDatasetStorageInfo(f,512,512);this._set("rasterInfo",f);this.updateTileInfo();await this._buildInMemoryRaster(d,{width:512,height:512},b);this.datasetName=l;this.url="/InMemory/"+l};r.fetchRawTile=function(b,f,d,e){b=this._pixelBlockTiles.get(`${b}/${f}/${d}`);
return Promise.resolve(b)};r._buildInMemoryRaster=async function(b,f,d){var e=this.rasterInfo.storageInfo.maximumPyramidLevel;const q=this.rasterJobHandler?this.rasterJobHandler.split({pixelBlock:b,tileSize:f,maximumPyramidLevel:e},d):Promise.resolve(m.split(b,f,e));f=null!=this.rasterInfo.statistics;e=null!=this.rasterInfo.histograms;b=f?Promise.resolve({statistics:null,histograms:null}):this.rasterJobHandler?this.rasterJobHandler.estimateStatisticsHistograms({pixelBlock:b},d):Promise.resolve(n.estimateStatisticsHistograms(b));
b=await B.eachAlways([q,b]);if(!b[0].value&&b[1].value)throw new C("inmemory-raster:open","failed to build in memory raster");this._pixelBlockTiles=b[0].value;f||(this.rasterInfo.statistics=b[1].value?.statistics);e||(this.rasterInfo.histograms=b[1].value?.histograms)};return P._createClass(A)}(h);w.__decorate([T.property({type:String,json:{write:!0}})],E.prototype,"datasetFormat",void 0);w.__decorate([T.property()],E.prototype,"data",void 0);return E=w.__decorate([D.subclass("esri.layers.support.rasterDatasets.InMemoryRaster")],
E)})},"esri/layers/support/rasterDatasets/pamParser":function(){define("exports ../../../geometry ../../../core/arrayUtils ./xmlUtilities ../rasterTransforms/PolynomialTransform ../../../geometry/SpatialReference".split(" "),function(P,w,E,C,B,T){function R(h,m){if(!h||!m)return null;const n=[];for(let g=0;g<h.length;g++)n.push(h[g]),n.push(m[g]);return n}function S(h){var m=C.getElement(h,"GeodataXform");h=C.getElementNumericValue(m,"SpatialReference/WKID")||C.getElementValue(m,"SpatialReference/WKT");
h=D(h);if("typens:PolynomialXform"!==m.getAttribute("xsi:type"))return{spatialReference:h,transform:null};var n=C.getElementNumericValue(m,"PolynomialOrder")??1,g=C.getElementNumericValues(m,"CoeffX/Double");const c=C.getElementNumericValues(m,"CoeffY/Double");var t=C.getElementNumericValues(m,"InverseCoeffX/Double");m=C.getElementNumericValues(m,"InverseCoeffY/Double");g=R(g,c);t=R(t,m);n=g&&t&&g.length&&t.length?new B({spatialReference:h,polynomialOrder:n,forwardCoefficients:g,inverseCoefficients:t}):
null;return{spatialReference:h,transform:n}}function K(h){const m=C.getElementNumericValue(h,"NoDataValue");var n=C.getElement(h,"Histograms/HistItem");const g=C.getElementNumericValue(n,"HistMin"),c=C.getElementNumericValue(n,"HistMax"),t=C.getElementNumericValue(n,"BucketCount");n=C.getElementValue(n,"HistCounts")?.split("|").map(d=>Number(d));let A,r,b,f;C.getElements(h,"Metadata/MDI").forEach(d=>{const e=Number(d.textContent??d.nodeValue);switch(d.getAttribute("key").toUpperCase()){case "STATISTICS_MINIMUM":A=
e;break;case "STATISTICS_MAXIMUM":r=e;break;case "STATISTICS_MEAN":b=e;break;case "STATISTICS_STDDEV":f=e}});h=C.getElementNumericValue(h,"Metadata/SourceBandIndex");return{noDataValue:m,histogram:n?.length&&null!=g&&null!=c?{min:g,max:c,size:t||n.length,counts:n}:null,sourceBandIndex:h,statistics:null!=A&&null!=r?{min:A,max:r,avg:b,stddev:f}:null}}function D(h){if(!h)return null;var m=Number(h);if(!isNaN(m)&&0!==m)return new T({wkid:m});h=String(h);if(h.startsWith("COMPD_CS")){if(!h.includes("VERTCS")||
!h.includes("GEOGCS")&&!h.startsWith("PROJCS"))return null;m=h.indexOf("VERTCS");var n=h.indexOf("PROJCS");n=-1<n?n:h.indexOf("GEOGCS");if(-1===n)return null;n=h.slice(n,h.lastIndexOf("]",m)+1).trim();h=h.slice(m,h.lastIndexOf("]")).trim();m=(m=G(n))?new T({wkid:m}):new T({wkt:n});if(h=G(h))m.vcsWkid=h;return m}if(!h.startsWith("GEOGCS")&&!h.startsWith("PROJCS"))return null;m=G(h);return 0!==m?new T({wkid:m}):new T({wkt:h})}function G(h){var m=h.replaceAll("]","[").replaceAll('"',"").split("[").map(g=>
g.trim()).filter(g=>""!==g);m=m[m.length-1].split(",");const n=m[0]?.toLowerCase();return"epsg"!==n&&"esri"!==n||!h.endsWith('"]]')||(h=Number(m[1]),isNaN(h)||0===h)?0:h}P.parsePAMInfo=function(h){if("pamdataset"!==h?.documentElement.tagName?.toLowerCase())return{};const m={spatialReference:null,transform:null,metadata:{},rasterBands:[],statistics:null,histograms:null};h.documentElement.childNodes.forEach(n=>{if(1===n.nodeType)if(C.isSameTagIgnoreNS(n,"SRS"))m.spatialReference||(n=C.getElementValue(n),
m.spatialReference=D(n));else if(C.isSameTagIgnoreNS(n,"Metadata"))if("xml:ESRI"===n.getAttribute("domain")){const {spatialReference:g,transform:c}=S(n);m.transform=c;m.spatialReference||(m.spatialReference=g)}else C.getElements(n,"MDI").forEach(g=>m.metadata[g.getAttribute("key")]=C.getElementValue(g));else C.isSameTagIgnoreNS(n,"PAMRasterBand")&&(n=K(n),null!=n.sourceBandIndex&&null==m.rasterBands[n.sourceBandIndex]?m.rasterBands[n.sourceBandIndex]=n:m.rasterBands.push(n))});h=m.rasterBands;h.length&&
(m.statistics=h[0].statistics?h.map(n=>n.statistics).filter(E.isSome):null,m.histograms=h[0].histogram?h.map(n=>n.histogram).filter(E.isSome):null);return m};P.parseSpatialReference=D;Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/xmlUtilities":function(){define(["exports"],function(P){function w(T,R){if(!T||!R)return[];var S=R;R.includes("/")?(S=R.slice(0,R.indexOf("/")),R=R.slice(R.indexOf("/")+1)):R="";const K=[];if(R){T=w(T,S);for(S=0;S<T.length;S++)w(T[S],
R).forEach(D=>K.push(D));return K}R=T.getElementsByTagNameNS("*",S);if(!R||0===R.length)return[];for(T=0;T<R.length;T++)K.push(R[T]||R.item(T));return K}function E(T,R){if(!T||!R)return null;let S=R;R.includes("/")?(S=R.slice(0,R.indexOf("/")),R=R.slice(R.indexOf("/")+1)):R="";T=w(T,S);return 0<T.length?R?E(T[0],R):T[0]:null}function C(T,R=null){if(T=R?E(T,R):T)if(T=T.textContent||T.nodeValue)return T.trim();return null}function B(T,R){T=w(T,R);R=[];let S;for(let K=0;K<T.length;K++)if(S=T[K].textContent||
T[K].nodeValue)S=S.trim(),""!==S&&R.push(S);return R}P.getElement=E;P.getElementNumericValue=function(T,R){T=C(T,R);return Number(T)};P.getElementNumericValues=function(T,R){return B(T,R).map(S=>Number(S))};P.getElementValue=C;P.getElementValues=B;P.getElements=w;P.getNodeNameIgnoreNS=function(T){return T.nodeName.slice(T.nodeName.lastIndexOf(":")+1)};P.getSpaceDelimitedNumericValues=function(T,R=null){return C(T,R)?.split(" ").map(S=>Number(S))??[]};P.isSameTagIgnoreNS=function(T,R){T=T?.nodeName?.toLowerCase();
R=R.toLowerCase();return T.slice(T.lastIndexOf(":")+1)===R};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/ImageServerRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/maybe ../../../core/urlUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../RasterInfo ../RasterStorageInfo ../TileInfo ../TilemapCache ./BaseRaster ../rasterFunctions/pixelUtils ../rasterTransforms/GCSShiftTransform ../../../rest/imageService/fetchRasterInfo ../../../geometry/SpatialReference ../../../geometry/Point ../../../geometry/Extent".split(" "),
function(P,w,E,C,B,T,R,S,K,D,G,h,m,n,g,c,t,A,r,b,f,d){function e(q,l){if(!q)return null;const {minScale:a,maxScale:k,minLOD:p,maxLOD:z}=l;if(null!=p&&null!=z)return n.fromJSON({...q,lods:q.lods.filter(({level:I})=>null!=I&&I>=p&&I<=z)});if(0!==a&&0!==k){const I=a?Math.round(1E4*a)/1E4:Infinity,N=k?Math.round(1E4*k)/1E4:-Infinity;return n.fromJSON({...q,lods:q.lods.filter(O=>{O=Math.round(1E4*O.scale)/1E4;return O<=I&&O>=N})})}return n.fromJSON(q)}E=function(q){function l(){var k=q.apply(this,arguments)||
this;k._levelOffset=0;k._tilemapCache=null;k._slices=null;k.datasetFormat="RasterTileServer";k.tileType=null;return k}P._inherits(l,q);var a=l.prototype;a.open=async function(k){await this.init();var p=k&&k.signal;k=this.sourceJSON?{data:this.sourceJSON}:await this.request(this.url,{query:{f:"json"},signal:p});k.ssl&&(this.url=this.url.replace(/^http:/i,"https:"));this.sourceJSON=k=k.data;if(!k)throw new C("imageserverraster:open","cannot initialize tiled image service, missing service info");if(!k.tileInfo)throw new C("imageserverraster:open",
"use ImageryLayer to open non-tiled image services");this._fixScaleInServiceInfo();var z="jpg jpeg png png8 png24 png32 mixed".split(" ");this.tileType=k.cacheType;null==this.tileType&&(z.includes(k.tileInfo.format.toLowerCase())?this.tileType="Map":"lerc"===k.tileInfo.format.toLowerCase()?this.tileType="Elevation":this.tileType="Raster");this.datasetName=k.name?.slice(k.name.indexOf("/")+1)??"";p=await this._fetchRasterInfo({signal:p});if(null==p)throw new C("image-server-raster:open","cannot initialize image service");
z="Map"===this.tileType?e(k.tileInfo,k):n.fromJSON(k.tileInfo);B.assertIsSome(z);const [I,N]=this._computeMinMaxLOD(p,z),{extent:O,pixelSize:H}=p,u=.5/p.width*H.x,y=Math.max(H.x,H.y),{lods:x}=z;if("Map"!==this.tileType&&0!==k.maxScale||Math.abs(H.x-H.y)>u||!x.some(X=>Math.abs(X.resolution-y)<u))H.x=H.y=I.resolution,p.width=Math.ceil((O.xmax-O.xmin)/H.x-.1),p.height=Math.ceil((O.ymax-O.ymin)/H.y-.1);const L=I.level-N.level,[Q,W]=z.size,v=[],F=[];x.forEach((X,Z)=>{X.level>=N.level&&X.level<=I.level&&
v.push({x:X.resolution,y:X.resolution});Z<x.length-1&&F.push(Math.round(10*X.resolution/x[Z+1].resolution)/10)});v.sort((X,Z)=>X.x-Z.x);const J=this.computeBlockBoundary(O,Q,W,z.origin,v,L),M=1<v.length?v.slice(1):null;var U;k.transposeInfo&&(U={tileSize:[k.transposeInfo.rows,k.transposeInfo.cols],packetSize:p.keyProperties?._yxs.PacketSize??0});const V=1>=F.length||3<=F.length&&F.slice(0,F.length-1).every(X=>X===F[0])?F[0]??2:Math.round(10/(N.resolution/I.resolution)**(-1/L))/10;p.storageInfo=new m({blockWidth:z.size[0],
blockHeight:z.size[1],pyramidBlockWidth:z.size[0],pyramidBlockHeight:z.size[1],pyramidResolutions:M,pyramidScalingFactor:V,compression:z.format,origin:z.origin,firstPyramidLevel:1,maximumPyramidLevel:L,tileInfo:z,transposeInfo:U,blockBoundary:J});this._fixGCSShift(p);this._set("rasterInfo",p);k.capabilities.toLowerCase().includes("tilemap")&&(U={tileInfo:p.storageInfo.tileInfo,parsedUrl:T.urlToObject(this.url),url:this.url,tileServers:[]},this._tilemapCache=new g.TilemapCache({layer:U}))};a.fetchRawTile=
async function(k,p,z,I={}){const {storageInfo:N,extent:O}=this.rasterInfo;var {transposeInfo:H}=N,u=null!=H&&!!I.transposedVariableName;if(this._slices&&!u&&null==I.sliceId)return null;({data:I}=await this.request(`${this.url}/tile/${u?0:N.maximumPyramidLevel-k+this._levelOffset}/${p}/${z}`,{query:this._slices?u?{variable:I.transposedVariableName}:{sliceId:I.sliceId||0}:null,responseType:"array-buffer",signal:I.signal}));if(!I)return null;H=u?H.tileSize:N.tileInfo.size;u=await this.decodePixelBlock(I,
{width:H[0],height:H[1],planes:null,pixelType:null,isPoint:"Elevation"===this.tileType,returnInterleaved:u,noDataValue:this.rasterInfo.noDataValue});if(null==u)return null;H=N.blockBoundary[k];if("jpg"!==N.compression||z>H.minCol&&z<H.maxCol&&p>H.minRow&&p<H.maxRow)return u;const {origin:y,blockWidth:x,blockHeight:L}=N,{x:Q,y:W}=this.getPyramidPixelSize(k);var v=Math.round((O.xmin-y.x)/Q)%x;k=Math.round((O.xmax-y.x)/Q)%x||x;var F=Math.round((y.y-O.ymax)/W)%L;I=Math.round((y.y-O.ymin)/W)%L||L;v=z===
H.minCol?v:0;F=p===H.minRow?F:0;t.setValidBoundary(u,{x:v,y:F},{width:(z===H.maxCol?k:x)-v,height:(p===H.maxRow?I:L)-F});return u};a.getSliceIndex=function(k){if(!this._slices||null==k||0===k.length)return null;for(let p=0;p<this._slices.length;p++){const z=this._slices[p].multidimensionalDefinition;if(z.length===k.length&&!z.some(I=>{var N=k.find(H=>I.variableName===H.variableName&&H.dimensionName===I.dimensionName);if(!N)return!0;const O=Array.isArray(I.values[0])?`${I.values[0][0]}-${I.values[0][1]}`:
I.values[0];N=Array.isArray(N.values[0])?`${N.values[0][0]}-${N.values[0][1]}`:N.values[0];return O!==N}))return p}return null};a.fetchVariableStatisticsHistograms=async function(k,p){var z=this.request(this.url+"/statistics",{query:{variable:k,f:"json"},signal:p}).then(I=>I.data?.statistics);k=this.request(this.url+"/histograms",{query:{variable:k,f:"json"},signal:p}).then(I=>I.data?.histograms);z=await Promise.all([z,k]);z[0]&&z[0].forEach(I=>{I.avg=I.mean;I.stddev=I.standardDeviation});return{statistics:z[0]||
null,histograms:z[1]||null}};a.computeBestPyramidLevelForLocation=async function(k,p={}){if(!this._tilemapCache)return 0;k=this.identifyPixelLocation(k,0,p.datumTransformation);if(null===k)return null;let z=0;var {maximumPyramidLevel:I}=this.rasterInfo.storageInfo;I=I-z+this._levelOffset;const N=k.srcLocation;for(;0<=I;){try{if("available"===await this._tilemapCache.fetchAvailability(I,k.row,k.col,p))break}catch{}I--;z++;k=this.identifyPixelLocation(N,z,p.datumTransformation);if(null===k)return null}return-1===
I||null==k?null:z};a._fetchRasterInfo=async function(k){var p=this.sourceJSON;if("Map"===this.tileType){k=p.fullExtent||p.extent;var z=Math.ceil((k.xmax-k.xmin)/p.pixelSizeX-.1);const I=Math.ceil((k.ymax-k.ymin)/p.pixelSizeY-.1),N=b.fromJSON(p.spatialReference||k.spatialReference);p=new f({x:p.pixelSizeX,y:p.pixelSizeY,spatialReference:N});return new h({width:z,height:I,bandCount:3,extent:d.fromJSON(k),spatialReference:N,pixelSize:p,pixelType:"u8",statistics:null,keyProperties:{DataType:"processed"}})}({signal:z}=
k);k=r.fetchServiceRasterInfo(this.url,this.sourceJSON,{signal:z,query:this.ioConfig.customFetchParameters});p=p.hasMultidimensions?this.request(`${this.url}/slices`,{query:{f:"json"},signal:z}).then(I=>I.data&&I.data.slices).catch(()=>null):null;p=await Promise.all([k,p]);this._slices=p[1];return p[0]};a._fixScaleInServiceInfo=function(){const {sourceJSON:k}=this;k.minScale&&0>k.minScale&&(k.minScale=0);k.maxScale&&0>k.maxScale&&(k.maxScale=0)};a._fixGCSShift=function(k){const {extent:p,spatialReference:z}=
k;-1<p.xmin&&181<p.xmax&&z?.wkid&&z.isGeographic&&(k.nativeExtent=k.extent,k.transform=new A,k.extent=k.transform.forwardTransform(p))};a._computeMinMaxLOD=function(k,p){const {pixelSize:z}=k,I=.5/k.width*z.x;({lods:k}=p);var N=p.lodAt(Math.max.apply(null,k.map(y=>y.level)));p=p.lodAt(Math.min.apply(null,k.map(y=>y.level)));var {tileType:O}=this;if("Map"===O)return this._levelOffset=k[0].level,[N,p];if("Raster"===O)return[k.find(y=>y.resolution===z.x)??N,p];const {minScale:H,maxScale:u}=this.sourceJSON;
O=N;0<u&&((O=k.find(y=>Math.abs(y.scale-u)<I))||(O=k.filter(y=>y.scale>u).sort((y,x)=>y.scale>x.scale?1:-1)[0]??N));N=p;0<H&&(N=k.find(y=>Math.abs(y.scale-H)<I)??p,this._levelOffset=N.level-p.level);return[O,N]};return P._createClass(l)}(c);w.__decorate([R.property({type:String,json:{write:!0}})],E.prototype,"datasetFormat",void 0);w.__decorate([R.property()],E.prototype,"tileType",void 0);return E=w.__decorate([G.subclass("esri.layers.support.rasterDatasets.ImageServerRaster")],E)})},"esri/layers/support/TilemapCache":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../request ../../core/Accessor ../../core/ByteSizeUnit ../../core/Error ../../core/handleUtils ../../core/LRUCache ../../core/PooledArray ../../core/promiseUtils ../../core/reactiveUtils ../../core/scheduling ../../core/urlUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./TileKey ./Tilemap".split(" "),
function(P,w,E,C,B,T,R,S,K,D,G,h,m,n,g,c,t,A,r,b,f){var d;P.TilemapCache=d=function(e){function q(a){a=e.call(this,a)||this;a._pendingTilemapRequests={};a.request=C;a.size=32;a._prefetchingEnabled=!0;return a}w._inherits(q,e);var l=q.prototype;l.initialize=function(){this._tilemapCache=new K.LRUCache(2*T.ByteSizeUnit.MEGABYTES);this.addHandles([h.watch(()=>{const {layer:a}=this;return[a?.parsedUrl,a?.tileServers,a?.apiKey,a?.customParameters]},()=>this._initializeTilemapDefinition(),h.initial)])};
l.fetchTilemap=function(a,k,p,z){if(!this.layer.tileInfo.lodAt(a)||a<this.effectiveMinLOD||a>this.effectiveMaxLOD)return Promise.reject(new R("tilemap-cache:level-unavailable",`Level ${a} is unavailable in the service`));const I=this._tmpTilemapDefinition;if(a=this._tilemapFromCache(a,k,p,I))return Promise.resolve(a);const N=z&&z.signal;z={...z,signal:null};return new Promise((O,H)=>{G.onAbort(N,()=>H(G.createAbortError()));const u=f.tilemapDefinitionId(I);let y=this._pendingTilemapRequests[u];if(!y){y=
f.Tilemap.fromDefinition(I,z).then(L=>{this._tilemapCache.put(u,L,L.byteSize);return L});const x=()=>delete this._pendingTilemapRequests[u];this._pendingTilemapRequests[u]=y;y.then(x,x)}y.then(O,H)})};l.getAvailability=function(a,k,p){return!this.layer.tileInfo.lodAt(a)||a<this.effectiveMinLOD||a>this.effectiveMaxLOD?"unavailable":(a=this._tilemapFromCache(a,k,p,this._tmpTilemapDefinition))?a.getAvailability(k,p):"unknown"};l.fetchAvailability=function(a,k,p,z){return!this.layer.tileInfo.lodAt(a)||
a<this.effectiveMinLOD||a>this.effectiveMaxLOD?Promise.reject(new R("tile-map:tile-unavailable","Tile is not available",{level:a,row:k,col:p})):this.fetchTilemap(a,k,p,z).catch(I=>I).then(I=>{if(I instanceof f.Tilemap){I=I.getAvailability(k,p);if("unavailable"===I)throw new R("tile-map:tile-unavailable","Tile is not available",{level:a,row:k,col:p});return I}if(G.isAbortError(I))throw I;return"unknown"})};l.fetchAvailabilityUpsample=function(a,k,p,z,I){z.level=a;z.row=k;z.col=p;const N=this.layer.tileInfo;
N.updateTileInfo(z);const O=this.fetchAvailability(a,k,p,I).catch(H=>{if(G.isAbortError(H))throw H;if(N.upsampleTile(z))return this.fetchAvailabilityUpsample(z.level,z.row,z.col,z,I);throw H;});this._fetchAvailabilityUpsamplePrefetch(z.id,a,k,p,I,O);return O};l._fetchAvailabilityUpsamplePrefetch=async function(a,k,p,z,I,N){if(this._prefetchingEnabled&&null!=a){var O=`prefetch-${a}`;if(!this.hasHandles(O)){var H=new AbortController;N.then(()=>H.abort(),()=>H.abort());var u=!1;N=S.makeHandle(()=>{u||
(u=!0,H.abort())});this.addHandles(N,O);await m.waitTicks(10,H.signal).catch(()=>{});u||(u=!0,this.removeHandles(O));if(!G.isAborted(H))for(a=new b.TileKey(a,k,p,z),I={...I,signal:H.signal},k=this.layer.tileInfo,p=0;d._prefetches.length<d._maxPrefetch&&k.upsampleTile(a);++p){const y=this.fetchAvailability(a.level,a.row,a.col,I);d._prefetches.push(y);z=()=>{d._prefetches.removeUnordered(y)};y.then(z,z)}}}};l._initializeTilemapDefinition=function(){if(this.layer.parsedUrl){var {parsedUrl:a,apiKey:k,
customParameters:p}=this.layer;this._tilemapCache.clear();this._tmpTilemapDefinition={service:{url:a.path,query:n.objectToQuery({...a.query,...p,token:k??a.query?.token}),tileServers:this.layer.tileServers,request:this.request},width:this.size,height:this.size,level:0,row:0,col:0}}};l._tilemapFromCache=function(a,k,p,z){z.level=a;z.row=k-k%this.size;z.col=p-p%this.size;a=f.tilemapDefinitionId(z);return this._tilemapCache.get(a)};w._createClass(q,[{key:"effectiveMinLOD",get:function(){return this.minLOD??
this.layer.tileInfo.lods[0].level}},{key:"effectiveMaxLOD",get:function(){return this.maxLOD??this.layer.tileInfo.lods[this.layer.tileInfo.lods.length-1].level}},{key:"test",get:function(){const a=this;return{get prefetchingEnabled(){return a._prefetchingEnabled},set prefetchingEnabled(k){a._prefetchingEnabled=k},hasTilemap(k,p,z){return!!a._tilemapFromCache(k,p,z,a._tmpTilemapDefinition)}}}}]);return q}(B);P.TilemapCache._maxPrefetch=4;P.TilemapCache._prefetches=new D({initialSize:d._maxPrefetch});
E.__decorate([g.property({constructOnly:!0})],P.TilemapCache.prototype,"layer",void 0);E.__decorate([g.property({constructOnly:!0})],P.TilemapCache.prototype,"minLOD",void 0);E.__decorate([g.property({constructOnly:!0})],P.TilemapCache.prototype,"maxLOD",void 0);E.__decorate([g.property({constructOnly:!0})],P.TilemapCache.prototype,"request",void 0);E.__decorate([g.property({constructOnly:!0})],P.TilemapCache.prototype,"size",void 0);P.TilemapCache=d=E.__decorate([r.subclass("esri.layers.support.TilemapCache")],
P.TilemapCache);Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/core/ByteSizeUnit":function(){define(["exports"],function(P){P.ByteSizeUnit=void 0;var w=P.ByteSizeUnit||(P.ByteSizeUnit={});w[w.KILOBYTES=1024]="KILOBYTES";w[w.MEGABYTES=1048576]="MEGABYTES";w[w.GIGABYTES=1073741824]="GIGABYTES";Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/Tilemap":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../request ../../core/arrayUtils ../../core/Error ../../core/lang ../../core/typedArrayUtil ../../geometry/support/UintArray".split(" "),
function(P,w,E,C,B,T,R,S){function K(G){if(G.service.tileServers?.length){var h=G.service.tileServers;h=`${h&&h.length?h[G.row%h.length]:G.service.url}/tilemap/${G.level}/${G.row}/${G.col}/${G.width}/${G.height}`}else h=`${G.service.url}/tilemap/${G.level}/${G.row}/${G.col}/${G.width}/${G.height}`;(G=G.service.query)&&(h=`${h}?${G}`);return h}let D=function(){function G(m){this._validateJSON(m);const {location:n,data:g}=m;this.location=Object.freeze(T.clone(n));let c=m=!0;const t=S.newUintArray(Math.ceil(this.location.width*
this.location.height/32));let A=0;for(let r=0;r<g.length;r++){const b=r%32;g[r]?(c=!1,t[A]|=1<<b):m=!1;31===b&&++A}c?(this._availability="unavailable",this.byteSize=40):m?(this._availability="available",this.byteSize=40):(this._availability=t,this.byteSize=40+R.estimateSize(t))}var h=G.prototype;h.getAvailability=function(m,n){if("unavailable"===this._availability||"available"===this._availability)return this._availability;m=(m-this.location.top)*this.location.width+(n-this.location.left);n=m>>5;
const g=this._availability;return 0>n||n>g.length?"unknown":g[n]&1<<m%32?"available":"unavailable"};G.fromDefinition=function(m,n){const g=m.service.request||E,{row:c,col:t,width:A,height:r}=m,b={query:{f:"json"}};n=n?{...b,...n}:b;return g(K(m),n).then(f=>f.data).catch(f=>{if(f&&f.details&&422===f.details.httpStatus)return{location:{top:c,left:t,width:A,height:r},valid:!0,data:C.constant(A*r,0)};throw f;}).then(f=>{if(f.location&&(f.location.top!==c||f.location.left!==t||f.location.width!==A||f.location.height!==
r))throw new B("tilemap:location-mismatch","Tilemap response for different location than requested",{response:f,definition:{top:c,left:t,width:A,height:r}});return G.fromJSON(f)})};G.fromJSON=function(m){return Object.freeze(new G(m))};h._validateJSON=function(m){if(!m||!m.location)throw new B("tilemap:missing-location","Location missing from tilemap response");if(!1===m.valid)throw new B("tilemap:invalid","Tilemap response was marked as invalid");if(!m.data)throw new B("tilemap:missing-data","Data missing from tilemap response");
if(!Array.isArray(m.data))throw new B("tilemap:data-mismatch","Data must be an array of numbers");if(m.data.length!==m.location.width*m.location.height)throw new B("tilemap:data-mismatch","Number of data items does not match width/height of tilemap");};return w._createClass(G)}();P.Tilemap=D;P.tilemapDefinitionId=function(G){return`${G.level}/${G.row}/${G.col}/${G.width}/${G.height}`};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/UintArray":function(){define(["exports",
"../../core/typedArrayUtil"],function(P,w){P.newUintArray=function(E,C=!1){return E<=w.NATIVE_ARRAY_MAX_SIZE?C?Array(E).fill(0):Array(E):new Uint32Array(E)};P.uintArrayFrom=function(E){return(w.isArray(E)?E.length:E.byteLength/8)<=w.NATIVE_ARRAY_MAX_SIZE?Array.from(E):new Uint32Array(E)};P.uintSubArray=function(E,C,B){return Array.isArray(E)?E.slice(C,C+B):E.subarray(C,C+B)};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/rest/imageService/fetchRasterInfo":function(){define("exports ../../request ../../geometry/Extent ../../geometry/Point ../../geometry/SpatialReference ../../layers/support/RasterInfo ../utils ../support/FeatureSet".split(" "),
function(P,w,E,C,B,T,R,S){async function K(D,G,h){D=R.parseUrl(D);const {rasterFunction:m,sourceJSON:n}=G||{};G=m?JSON.stringify(m.rasterFunctionDefinition||m):null;G=R.encode({...D.query,renderingRule:G,f:"json"});G=R.asValidOptions(G,h);D=D.path;h=n||await w(D,G).then(l=>l.data);var g=h.hasRasterAttributeTable?w(`${D}/rasterAttributeTable`,G):null,c=h.hasColormap?w(`${D}/colormap`,G):null,t=h.hasHistograms?w(`${D}/histograms`,G):null,A=10.3<=h.currentVersion?w(`${D}/keyProperties`,G):null;D=h.hasMultidimensions?
w(`${D}/multidimensionalInfo`,G):null;G=await Promise.allSettled([g,c,t,A,D]);D=null;if(h.minValues&&h.minValues.length===h.bandCount)for(D=[],g=0;g<h.minValues.length;g++)D.push({min:h.minValues[g],max:h.maxValues[g],avg:h.meanValues[g],stddev:h.stdvValues[g]});c=E.fromJSON(h.extent);g=Math.ceil(c.width/h.pixelSizeX-.1);c=Math.ceil(c.height/h.pixelSizeY-.1);t=B.fromJSON(h.spatialReference||h.extent.spatialReference);A="fulfilled"===G[0].status?G[0].value?S.fromJSON(G[0].value.data):null:null;const r=
"fulfilled"===G[1].status?G[1].value?.data.colormap:null,b="fulfilled"===G[2].status?G[2].value?.data.histograms:null,f="fulfilled"===G[3].status?G[3].value?.data??{}:{};G="fulfilled"===G[4].status?G[4].value?.data.multidimensionalInfo:null;G?.variables?.length&&G.variables.forEach(l=>{l.statistics?.length&&l.statistics.forEach(a=>{a.avg=a.mean;a.stddev=a.standardDeviation})});const {defaultVariable:d,serviceDataType:e}=h;d&&d!==f.DefaultVariable&&(f.DefaultVariable=d);e&&e.includes("esriImageServiceDataTypeVector")&&
!e.includes(f.DataType)&&(f.DataType=e.replace("esriImageServiceDataType",""));let q=h.noDataValue;h.noDataValues?.length&&h.noDataValues.some(l=>l!==q)&&(q=h.noDataValues);return new T({width:g,height:c,bandCount:h.bandCount,extent:E.fromJSON(h.extent),spatialReference:t,pixelSize:new C({x:h.pixelSizeX,y:h.pixelSizeY,spatialReference:t}),pixelType:h.pixelType.toLowerCase(),statistics:D,attributeTable:A,colormap:r,histograms:b,keyProperties:f,noDataValue:q,multidimensionalInfo:G})}P.fetchServiceRasterInfo=
function(D,G,h){return K(D,{sourceJSON:G},h)};P.generateRasterInfo=function(D,G,h){return K(D,{rasterFunction:G},h)};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/MRFRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../PixelBlock ../RasterInfo ../RasterStorageInfo ./BaseRaster ./pamParser ./xmlUtilities ../rasterFormats/utils ../rasterFunctions/stretchUtils ../../../geometry/SpatialReference ../../../geometry/Extent ../../../geometry/Point".split(" "),
function(P,w,E,C,B,T,R,S,K,D,G,h,m,n,g,c,t,A,r,b){const f=new Map;f.set("Int8","s8");f.set("UInt8","u8");f.set("Int16","s16");f.set("UInt16","u16");f.set("Int32","s32");f.set("UInt32","u32");f.set("Float32","f32");f.set("Float64","f32");f.set("Double64","f32");const d=new Map;d.set("none",{blobExtension:".til",isOneSegment:!0,decoderFormat:"bip"});d.set("lerc",{blobExtension:".lrc",isOneSegment:!1,decoderFormat:"lerc"});d.set("deflate",{blobExtension:".pzp",isOneSegment:!0,decoderFormat:"deflate"});
d.set("jpeg",{blobExtension:".pjg",isOneSegment:!0,decoderFormat:"jpg"});E=function(e){function q(){var a=e.apply(this,arguments)||this;a._files=null;a._storageIndex=null;a.datasetFormat="MRF";return a}P._inherits(q,e);var l=q.prototype;l.open=async function(a){await this.init();this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1);var k=a?a.signal:null,p=await this.request(this.url,{responseType:"xml",signal:k});const {rasterInfo:z,files:I}=this._parseHeader(p.data);-1===this.ioConfig.skipExtensions?.indexOf("aux.xml")&&
(a=await this._fetchAuxiliaryData(a),null!=a&&(z.statistics=a.statistics??z.statistics,(z.histograms=a.histograms)&&null==z.statistics&&(z.statistics=t.estimateStatisticsFromHistograms(a.histograms))));this._set("rasterInfo",z);this._files=I;k=await this.request(I.index,{responseType:"array-buffer",signal:k});this._storageIndex=this._parseIndex(k.data);const {blockWidth:N,blockHeight:O}=this.rasterInfo.storageInfo;k=this.rasterInfo.storageInfo.pyramidScalingFactor;const {width:H,height:u}=this.rasterInfo;
a=[];p=this._getBandSegmentCount();let y=0,x=-1;for(;y<this._storageIndex.length;){x++;const L=Math.ceil(H/N/k**x)-1,Q=Math.ceil(u/O/k**x)-1;y+=(L+1)*(Q+1)*p*4;a.push({maxRow:Q,maxCol:L,minCol:0,minRow:0})}this.rasterInfo.storageInfo.blockBoundary=a;0<x&&(this.rasterInfo.storageInfo.firstPyramidLevel=1,this.rasterInfo.storageInfo.maximumPyramidLevel=x);this.updateTileInfo()};l.fetchRawTile=async function(a,k,p,z={}){const {blockWidth:I,blockHeight:N,blockBoundary:O}=this.rasterInfo.storageInfo;var H=
O[a];if(!H||H.maxRow<k||H.maxCol<p||H.minRow>k||H.minCol>p)return null;const {bandCount:u,pixelType:y}=this.rasterInfo,{ranges:x,actualTileWidth:L,actualTileHeight:Q}=this._getTileLocation(a,k,p);if(!x||0===x.length)return null;if(0===x[0].from&&0===x[0].to)return a=new Uint8Array(I*N),new D({width:I,height:N,pixels:null,mask:a,validPixelCount:0});({bandIds:k}=this.ioConfig);p=this._getBandSegmentCount();H=[];for(a=a=0;a<p;a++)k&&!k.includes(a)||H.push(this.request(this._files.data,{range:{from:x[a].from,
to:x[a].to},responseType:"array-buffer",signal:z.signal}));z=await Promise.all(H);a=z.map(v=>v.data.byteLength).reduce((v,F)=>v+F);H=new Uint8Array(a);let W=0;for(a=0;a<p;a++)H.set(new Uint8Array(z[a].data),W),W+=z[a].data.byteLength;a=d.get(this.rasterInfo.storageInfo.compression).decoderFormat;k=await this.decodePixelBlock(H.buffer,{width:I,height:N,format:a,planes:k?.length||u,pixelType:y});if(null==k)return null;({noDataValue:z}=this.rasterInfo);if(null!=z&&"lerc"!==a&&!k.mask&&(z=z[0],null!=
z)){p=k.width*k.height;H=new Uint8Array(p);if(1E24<Math.abs(z))for(a=0;a<p;a++)1E-6<Math.abs((k.pixels[0][a]-z)/z)&&(H[a]=1);else for(a=0;a<p;a++)k.pixels[0][a]!==z&&(H[a]=1);k.mask=H}p=z=0;if(L!==I||Q!==N)if(H=k.mask)for(a=0;a<N;a++)for(p=a*I,z=a<Q?L:0;z<I;z++)H[p+z]=0;else for(H=new Uint8Array(I*N),k.mask=H,a=0;a<Q;a++)for(p=a*I,z=0;z<L;z++)H[p+z]=1;return k};l._parseIndex=function(a){if(0<a.byteLength%16)throw Error("invalid array buffer must be multiples of 16");let k,p,z,I,N;if(c.isPlatformLittleEndian){k=
new Uint8Array(a);z=new ArrayBuffer(a.byteLength);p=new Uint8Array(z);for(I=0;I<a.byteLength/4;I++)for(N=0;4>N;N++)p[4*I+N]=k[4*I+3-N];a=new Uint32Array(z)}else a=new Uint32Array(a);return a};l._getBandSegmentCount=function(){return d.get(this.rasterInfo.storageInfo.compression).isOneSegment?1:this.rasterInfo.bandCount};l._getTileLocation=function(a,k,p){const {blockWidth:z,blockHeight:I,pyramidScalingFactor:N}=this.rasterInfo.storageInfo,{width:O,height:H}=this.rasterInfo,u=this._getBandSegmentCount();
let y,x;var L,Q=0;let W=0;for(L=0;L<a;L++)W=N**L,y=Math.ceil(O/z/W),x=Math.ceil(H/I/W),Q+=y*x;W=N**a;y=Math.ceil(O/z/W);x=Math.ceil(H/I/W);Q=4*(Q+(k*y+p))*u;a=this._storageIndex.subarray(Q,Q+4*u);Q=L=0;const v=[];for(let F=0;F<u;F++)L=a[4*F]*2**32+a[4*F+1],Q=L+a[4*F+2]*2**32+a[4*F+3],v.push({from:L,to:Q});return{ranges:v,actualTileWidth:p<y-1?z:Math.ceil(O/W)-z*(y-1),actualTileHeight:k<x-1?I:Math.ceil(H/W)-I*(x-1)}};l._parseHeader=function(a){var k=g.getElement(a,"MRF_META/Raster");if(!k)throw new C("mrf:open",
"not a valid MRF format");var p=g.getElement(k,"Size"),z=parseInt(p.getAttribute("x"),10),I=parseInt(p.getAttribute("y"),10);const N=parseInt(p.getAttribute("c"),10);p=(g.getElementValue(k,"Compression")||"none").toLowerCase();if(!d.has(p))throw new C("mrf:open","currently does not support compression "+p);var O=g.getElementValue(k,"DataType")||"UInt8";const H=f.get(O);if(null==H)throw new C("mrf:open","currently does not support pixel type "+O);var u=g.getElement(k,"PageSize");O=parseInt(u.getAttribute("x"),
10);u=parseInt(u.getAttribute("y"),10);k=g.getElement(k,"DataValues");let y;k&&(k=k.getAttribute("NoData"),null!=k&&(y=k.trim().split(" ").map(J=>parseFloat(J))));if(g.getElement(a,"MRF_META/CachedSource"))throw new C("mrf:open","currently does not support MRF referencing other data files");var x=g.getElement(a,"MRF_META/GeoTags"),L=g.getElement(x,"BoundingBox");k=!1;if(null!=L){var Q=parseFloat(L.getAttribute("minx"));var W=parseFloat(L.getAttribute("miny")),v=parseFloat(L.getAttribute("maxx"));
L=parseFloat(L.getAttribute("maxy"));var F=g.getElementValue(x,"Projection")||"";x=A.WGS84;"LOCAL_CS[]"!==F?F.toLowerCase().startsWith("epsg:")?(F=Number(F.slice(5)),isNaN(F)||0===F||(x=new A({wkid:F}))):x=n.parseSpatialReference(F)??A.WGS84:(k=!0,x=new A({wkid:3857}));Q=new r(Q,W,v,L);Q.spatialReference=x}else k=!0,Q=new r({xmin:-.5,ymin:.5-I,xmax:z-.5,ymax:.5,spatialReference:new A({wkid:3857})});W=g.getElement(a,"MRF_META/Rsets");v=parseInt(W&&W.getAttribute("scale")||"2",10);W=Q.spatialReference;
O=new h({origin:new b({x:Q.xmin,y:Q.ymax,spatialReference:W}),blockWidth:O,blockHeight:u,pyramidBlockWidth:O,pyramidBlockHeight:u,compression:p,pyramidScalingFactor:v});u=new b({x:Q.width/z,y:Q.height/I,spatialReference:W});z=new G({width:z,height:I,extent:Q,isPseudoSpatialReference:k,spatialReference:W,bandCount:N,pixelType:H,pixelSize:u,noDataValue:y,storageInfo:O});I=g.getElementValue(a,"datafile");a=g.getElementValue(a,"IndexFile");a={mrf:this.url,index:a||this.url.replace(".mrf",".idx"),data:I||
this.url.replace(".mrf",d.get(p).blobExtension)};return{rasterInfo:z,files:a}};l._fetchAuxiliaryData=async function(a){try{const {data:k}=await this.request(this.url+".aux.xml",{responseType:"xml",signal:a?.signal});return n.parsePAMInfo(k)}catch{return null}};return P._createClass(q)}(m);w.__decorate([B.property()],E.prototype,"_files",void 0);w.__decorate([B.property()],E.prototype,"_storageIndex",void 0);w.__decorate([B.property({type:String,json:{write:!0}})],E.prototype,"datasetFormat",void 0);
return E=w.__decorate([K.subclass("esri.layers.support.rasterIO.MRFRaster")],E)})},"esri/layers/support/rasterDatasets/TIFFRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/arrayUtils ../../../core/Error ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/has ../../../core/accessorSupport/decorators/subclass ../RasterInfo ../RasterStorageInfo ./BaseRaster ./DBFParser ./pamParser ../rasterFormats/TiffDecoder ../rasterFormats/TiffTags ../rasterFunctions/stretchUtils ../rasterTransforms/PolynomialTransform ../../../rest/support/FeatureSet ../../../geometry/SpatialReference ../../../geometry/Extent ../../../geometry/Point".split(" "),
function(P,w,E,C,B,T,R,S,K,D,G,h,m,n,g,c,t,A,r,b,f,d){E=function(e){function q(){var a=e.apply(this,arguments)||this;a._files=null;a._headerInfo=null;a._bufferSize=1048576;a.datasetFormat="TIFF";return a}P._inherits(q,e);var l=q.prototype;l.open=async function(a){await this.init();var k=a?a.signal:null,{data:p}=await this.request(this.url,{range:{from:0,to:this._bufferSize},responseType:"array-buffer",signal:k});if(!p)throw new B("tiffraster:open","failed to open url "+this.url);this.datasetName=
this.url.slice(this.url.lastIndexOf("/")+1,this.url.lastIndexOf("."));const {littleEndian:z,firstIFDPos:I,isBigTiff:N}=g.parseSignature(p);var O=[];await this._readIFDs(O,p,z,I,0,N?8:4,k);const {imageInfo:H,rasterInfo:u}=this._parseIFDs(O);k=g.getPyramidIFDs(O);p=g.getMaskIFDs(O);this._headerInfo={littleEndian:z,isBigTiff:N,ifds:O,pyramidIFDs:k,maskIFDs:p,...H};this._set("rasterInfo",u);if(!H.isSupported)throw new B("tiffraster:open","this tiff is not supported: "+H.message);if(!H.tileWidth)throw new B("tiffraster:open",
"none-tiled tiff is not optimized for access, convert to COG and retry.");k=O[0].get("PREDICTOR")?.values?.[0];if(3===O[0].get("SAMPLEFORMAT")?.values?.[0]&&2===k)throw new B("tiffraster:open","unsupported horizontal difference encoding. Predictor\x3d3 is supported for floatting point data");({skipExtensions:O=[]}=this.ioConfig);O.includes("aux.xml")||(k=await this._fetchAuxiliaryMetaData(a),null!=k&&this._processPAMInfo(k,u));O.includes("vat.dbf")||1!==u.bandCount||"u8"!==u.pixelType||(u.attributeTable=
await this._fetchAuxiliaryTable(a),null!=u.attributeTable&&(u.keyProperties.DataType="thematic"));this.updateTileInfo()};l.fetchRawTile=async function(a,k,p,z={}){if(!this._headerInfo?.isSupported||this.isBlockOutside(a,k,p))return null;const I=await this._fetchRawTiffTile(a,k,p,!1,z);null!=I&&this._headerInfo.hasMaskBand&&(a=await this._fetchRawTiffTile(a,k,p,!0,z),null!=a&&a.pixels[0]instanceof Uint8Array&&(I.mask=a.pixels[0]));return I};l._parseIFDs=function(a){const k=g.getImageInfo(a),{width:p,
height:z,tileWidth:I,tileHeight:N,planes:O,pixelType:H,compression:u,firstPyramidLevel:y,maximumPyramidLevel:x,pyramidBlockWidth:L,pyramidBlockHeight:Q,tileBoundary:W,affine:v,metadata:F}=k;let J=n.parseSpatialReference(k.extent.spatialReference?.wkt||k.extent.spatialReference?.wkid);var M=!!k.isPseudoGeographic;null==J&&(M=!0,J=new b({wkid:3857}));const U=new f({...k.extent,spatialReference:J});var V=U?new d({x:U.xmin,y:U.ymax,spatialReference:J}):new d({x:0,y:0});V=new G({blockWidth:I,blockHeight:N,
pyramidBlockWidth:L,pyramidBlockHeight:Q,compression:u,origin:V,firstPyramidLevel:y,maximumPyramidLevel:x,blockBoundary:W});const X=new d({x:(U.xmax-U.xmin)/p,y:(U.ymax-U.ymin)/z,spatialReference:J}),Z=F?{BandProperties:F.bandProperties,DataType:F.dataType}:{};let Y=null;var ea=a[0].get("PHOTOMETRICINTERPRETATION")?.values?.[0];a=a[0].get("COLORMAP")?.values;if(3>=ea&&3<a?.length&&0===a.length%3){Y=[];ea=a.length/3;for(let da=0;da<ea;da++)Y.push([da,a[da]>>>8,a[da+ea]>>>8,a[da+2*ea]>>>8])}M=new D({width:p,
height:z,bandCount:O,pixelType:H,pixelSize:X,storageInfo:V,spatialReference:J,isPseudoSpatialReference:M,keyProperties:Z,extent:U,colormap:Y,statistics:F?F.statistics:null});v?.length&&(M.nativeExtent=new f({xmin:-.5,ymin:.5-z,xmax:p-.5,ymax:.5,spatialReference:J}),M.transform=new A({polynomialOrder:1,forwardCoefficients:[v[2]+v[0]/2,v[5]-v[3]/2,v[0],v[3],-v[1],-v[4]]}),M.extent=M.transform.forwardTransform(M.nativeExtent),M.pixelSize=new d({x:(U.xmax-U.xmin)/p,y:(U.ymax-U.ymin)/z,spatialReference:J}),
V.origin.x=-.5,V.origin.y=.5);return{imageInfo:k,rasterInfo:M}};l._processPAMInfo=function(a,k){k.statistics=a.statistics??k.statistics;(k.histograms=a.histograms)&&null==k.statistics&&(k.statistics=t.estimateStatisticsFromHistograms(a.histograms));if(a.transform&&null==k.transform){k.transform=a.transform;k.nativeExtent=k.extent;const p=k.transform.forwardTransform(k.nativeExtent);k.pixelSize=new d({x:(p.xmax-p.xmin)/k.width,y:(p.ymax-p.ymin)/k.height,spatialReference:k.spatialReference});k.extent=
p}k.isPseudoSpatialReference&&a.spatialReference&&(k.spatialReference=a.spatialReference,k.extent.spatialReference=k.nativeExtent.spatialReference=k.storageInfo.origin.spatialReference=k.spatialReference)};l._readIFDs=async function(a,k,p,z,I,N=4,O){if(!z)return null;if(z>=k.byteLength||0>z)k=(await this.request(this.url,{range:{from:z+I,to:z+I+this._bufferSize},responseType:"array-buffer",signal:O})).data,I=z+I,z=0;z=await this._readIFD(k,p,z,I,c.TIFF_TAGS,N,O);a.push(z.ifd);if(!z.nextIFD)return null;
await this._readIFDs(a,k,p,z.nextIFD-I,I,N,O)};l._readIFD=async function(a,k,p,z,I=c.TIFF_TAGS,N=4,O){if(!a)return null;p=g.parseIFD(a,k,p,z,I,N);if(p.success){const H=[];p.ifd?.forEach(u=>{u.values||H.push(u)});0<H.length&&(N=H.map(u=>u.offlineOffsetSize).filter(C.isSome),I=Math.min.apply(null,N.map(u=>u[0])),Math.min.apply(null,N.map(u=>u[0]+u[1]))-I<=this._bufferSize&&({data:N}=await this.request(this.url,{range:{from:I,to:I+this._bufferSize},responseType:"array-buffer",signal:O}),a=N,z=I,H.forEach(u=>
g.parseFieldValues(a,k,u,z))));p.ifd?.has("GEOKEYDIRECTORY")&&(I=p.ifd.get("GEOKEYDIRECTORY"),(N=I?.values)&&4<N.length&&(N=N[0]+"."+N[1]+"."+N[2],O=await this._readIFD(a,k,I.valueOffset+6-z,z,c.GEO_KEYS,2,O),I.data=O.ifd,I.data&&I.data.set("GEOTIFFVersion",{id:0,type:2,valueCount:1,valueOffset:null,values:[N]})));return p}if(p.requiredBufferSize&&p.requiredBufferSize!==a.byteLength)return a=(await this.request(this.url,{range:{from:z,to:z+p.requiredBufferSize+4},responseType:"array-buffer",signal:O})).data,
a.byteLength<p.requiredBufferSize?null:this._readIFD(a,k,0,z,c.TIFF_TAGS,4,O)};l._fetchRawTiffTile=async function(a,k,p,z,I={}){k=this._getTileLocation(a,k,p,z);if(!k)return null;const {ranges:N,actualTileWidth:O,actualTileHeight:H,ifd:u}=k;k=N.map(Q=>this.request(this.url,{range:Q,responseType:"array-buffer",signal:I.signal}));k=await Promise.all(k);p=k.map(Q=>Q.data.byteLength).reduce((Q,W)=>Q+W);p=1===k.length?k[0].data:new ArrayBuffer(p);z=[0];var y=[0];if(1<k.length){const Q=new Uint8Array(p);
for(let W=0,v=0;W<k.length;W++){const F=k[W].data;Q.set(new Uint8Array(F),v);z[W]=v;v+=F.byteLength;y[W]=F.byteLength}}const {blockWidth:x,blockHeight:L}=this.getBlockWidthHeight(a);a=await this.decodePixelBlock(p,{format:"tiff",customOptions:{headerInfo:this._headerInfo,ifd:u,offsets:z,sizes:y},width:x,height:L,planes:null,pixelType:null});if(null==a)return null;if(O!==x||H!==L)if(y=a.mask)for(k=0;k<L;k++)for(z=k*x,p=k<H?O:0;p<x;p++)y[z+p]=0;else for(y=new Uint8Array(x*L),a.mask=y,k=0;k<H;k++)for(z=
k*x,p=0;p<O;p++)y[z+p]=1;return a};l._getTileLocation=function(a,k,p,z=!1){const {firstPyramidLevel:I,blockBoundary:N}=this.rasterInfo.storageInfo;var O=0===a?0:a-(I-1);({_headerInfo:a}=this);if(!a)return null;z=z?a.maskIFDs[O]:0===O?a?.ifds[0]:a?.pyramidIFDs[O-1];if(!z)return null;var H=g.isBSQConfig(z,a);a=z.get("TILEOFFSETS")?.values;if(void 0===a)return null;const u=z.get("TILEBYTECOUNTS")?.values,{minRow:y,minCol:x,maxRow:L,maxCol:Q}=N[O];if(k>L||p>Q||k<y||p<x)return null;O=z.get("IMAGEWIDTH")?.values?.[0];
const W=z.get("IMAGELENGTH")?.values?.[0],v=z.get("TILEWIDTH")?.values?.[0],F=z.get("TILELENGTH")?.values?.[0],J=[];if(H){({bandCount:H}=this.rasterInfo);for(let M=0;M<H;M++){const U=M*(L+1)*(Q+1)+k*(Q+1)+p;J[M]={from:a[U],to:a[U]+u[U]-1}}}else H=k*(Q+1)+p,J.push({from:a[H],to:a[H]+u[H]-1});for(a=0;a<J.length;a++)if(null==J[a].from||!J[a].to)return null;return{ranges:J,ifd:z,actualTileWidth:p===Q?O%v||v:v,actualTileHeight:k===L?W%F||F:F}};l._fetchAuxiliaryMetaData=async function(a){try{const {data:k}=
await this.request(this.url+".aux.xml",{responseType:"xml",signal:a?.signal});return n.parsePAMInfo(k)}catch{return null}};l._fetchAuxiliaryTable=async function(a){try{const {data:k}=await this.request(this.url+".vat.dbf",{responseType:"array-buffer",signal:a?.signal}),p=m.parse(k);return p?.recordSet?r.fromJSON(p.recordSet):null}catch{return null}};return P._createClass(q)}(h);w.__decorate([T.property()],E.prototype,"_files",void 0);w.__decorate([T.property()],E.prototype,"_headerInfo",void 0);w.__decorate([T.property()],
E.prototype,"_bufferSize",void 0);w.__decorate([T.property({type:String,json:{write:!0}})],E.prototype,"datasetFormat",void 0);return E=w.__decorate([K.subclass("esri.layers.support.rasterDatasets.TIFFRaster")],E)})},"*noref":1}});
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../PopupTemplate ../core/Error ../core/Logger ../core/MultiOriginJSONSupport ../core/promiseUtils ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/subclass ./Layer ./mixins/ArcGISService ./mixins/BlendLayer ./mixins/CustomParametersMixin ./mixins/ImageryTileMixin ./mixins/OperationalLayer ./mixins/PortalLayer ./mixins/RefreshableLayer ./mixins/ScaleRangeLayer ./mixins/TemporalLayer ./support/commonProperties ./support/Field ./support/rasterEnums ./support/RasterFunction ./support/rasterDatasets/FunctionRaster ./support/rasterDatasets/RasterFactory ./support/rasterFunctions/rasterFunctionHelper ../support/popupUtils".split(" "),function(P,
w,E,C,B,T,R,S,K,D,G,h,m,n,g,c,t,A,r,b,f,d,e,q,l,a,k,p,z,I,N,O){T=function(H){function u(...x){x=H.call(this,...x)||this;x._primaryRasters=[];x.bandIds=null;x.interpolation=null;x.legendEnabled=!0;x.isReference=null;x.listMode="show";x.sourceJSON=null;x.version=null;x.type="imagery-tile";x.operationalLayerType="ArcGISTiledImageServiceLayer";x.popupEnabled=!0;x.popupTemplate=null;x.fields=null;return x}P._inherits(u,H);var y=u.prototype;y.normalizeCtorArgs=function(x,L){return"string"===typeof x?{url:x,
...L}:x};y.load=function(x){const L=null!=x?x.signal:null;this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service"]},x).catch(R.throwIfAbortError).then(()=>this._openRaster(L)));return Promise.resolve(this)};y.createPopupTemplate=function(x){const {rasterFields:L}=this,Q=new Set(L.map(({name:W})=>W).filter(W=>"raster.servicepixelvalue.raw"!==W.toLowerCase()));return O.createPopupTemplate({fields:L,title:this.title},{...x,visibleFieldNames:Q})};y.generateRasterInfo=async function(x,
L){x=D.ensureClass(p,x);if(!x)return this.rasterInfo;try{const Q={raster:this._primaryRasters[0]};1<this._primaryRasters.length&&this._primaryRasters.forEach(F=>Q[F.url]=F);const W=N.create(x.functionDefinition?.toJSON()??x.toJSON(),Q),v=new z({rasterFunction:W});await v.open(L);return v.rasterInfo}catch(Q){if(Q instanceof C)throw Q;throw new C("imagery-tile-layer","the given raster function is not supported");}};y.write=function(x,L){const Q=this._primaryRasters[0]??this.raster;if(this.loaded?"RasterTileServer"===
Q.datasetFormat&&("Raster"===Q.tileType||"Map"===Q.tileType):this.url&&/\/ImageServer(\/|\/?$)/i.test(this.url))return P._get(P._getPrototypeOf(u.prototype),"write",this).call(this,x,L);L&&L.messages&&L.messages.push(new C("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${`${L.origin}/${L.layerContainerType||"operational-layers"}`}'`,{layer:this}));return null};y._openRaster=async function(x){let L=!1;if(this.raster)this.raster.rasterInfo||
await this.raster.open(),"Function"===this.raster.datasetFormat?(L=!0,this._primaryRasters=this.raster.primaryRasters.rasters):this._primaryRasters=[this.raster],this.url=this.raster.url;else{var {rasterFunction:Q}=this;const v=[this.url];Q&&N.getPrimaryRasterUrls(Q.toJSON(),v);var W=await Promise.all(v.map(J=>I.open({url:J,sourceJSON:this.sourceJSON,ioConfig:{sampling:"closest",...this.ioConfig,customFetchParameters:this.customParameters},signal:x})));const F=W.findIndex(J=>null==J);if(-1<F)throw new C("imagery-tile-layer:open",
`cannot open raster: ${v[F]}`);this._primaryRasters=W;if(Q){const J={raster:this._primaryRasters[0]};1<this._primaryRasters.length&&this._primaryRasters.forEach(M=>J[M.url]=M);Q=N.create(Q.functionDefinition?.toJSON()??Q.toJSON(),J);Q=new z({rasterFunction:Q});try{await Q.open(),this.raster=Q}catch(M){Q=B.getLogger(this),M instanceof C&&Q.error("imagery-tile-layer:open",M.message),Q.warn("imagery-tile-layer:open","the raster function cannot be applied and is removed"),this._set("rasterFunction",null),
this.raster=W[0]}}else this.raster=W[0]}W=this.raster.rasterInfo;if(!W)throw new C("imagery-tile-layer:load","cannot load resources on "+this.url);this._set("rasterInfo",L?W:this._primaryRasters[0].rasterInfo);this._set("spatialReference",W.spatialReference);this.sourceJSON=this.sourceJSON||this.raster.sourceJSON;null!=this.sourceJSON?this.read("Map"===this.raster.tileType&&null!=this.sourceJSON.minLOD&&null!=this.sourceJSON.maxLOD?this.sourceJSON:{...this.sourceJSON,minScale:0,maxScale:0},{origin:"service"}):
this.read({tileInfo:this.rasterInfo.storageInfo.tileInfo.toJSON()},{origin:"service"});this.title||(this.title=this.raster.datasetName);"Map"===this.raster.tileType&&(this.popupEnabled=!1);this._configDefaultSettings();this.addHandles(S.watch(()=>this.customParameters,v=>{this.raster&&(this.raster.ioConfig.customFetchParameters=v)}))};P._createClass(u,[{key:"defaultPopupTemplate",get:function(){return this.createPopupTemplate()}},{key:"rasterFields",get:function(){var x=new a({name:"Raster.ServicePixelValue",
alias:"Pixel Value",domain:null,editable:!1,length:50,type:"string"}),L=new a({name:"Raster.ServicePixelValue.Raw",alias:"Raw Pixel Value",domain:null,editable:!1,length:50,type:"string"});x=[x,L];({rasterInfo:L}=this);var Q=L?.attributeTable;if(Q=null!=Q?Q.fields:null)Q=Q.filter(W=>"oid"!==W.type&&"value"!==W.name.toLowerCase()).map(W=>{const v=W.clone();v.name="Raster."+W.name;return v}),x.push(...Q);Q=L?.dataType;L=L?.multidimensionalInfo;"vector-magdir"!==Q&&"vector-uv"!==Q||null==L||(L=L.variables[0].unit?.trim(),
x.push(new a({name:"Raster.Magnitude",alias:"Magnitude"+(L?` (${L})`:""),domain:null,editable:!1,type:"double"})),x.push(new a({name:"Raster.Direction",alias:"Direction (\u00b0)",domain:null,editable:!1,type:"double"})));return x}}]);return u}(t.BlendLayer(e.ScaleRangeLayer(b.OperationalLayer(f.PortalLayer(A.CustomParametersMixin(r.ImageryTileMixin(q.TemporalLayer(c.ArcGISService(d.RefreshableLayer(T.MultiOriginJSONMixin(g)))))))))));w.__decorate([K.property()],T.prototype,"_primaryRasters",void 0);
w.__decorate([K.property({type:[D.Integer],json:{write:{overridePolicy(){return{enabled:!this.loaded||"Raster"===this.raster.tileType||"0,1,2"!==this.bandIds?.join(",")}}}}})],T.prototype,"bandIds",void 0);w.__decorate([K.property({json:{write:{overridePolicy(){return{enabled:!this.loaded||"Raster"===this.raster.tileType||"bilinear"!==this.interpolation}}}}}),m.enumeration(k.interpolationKebab)],T.prototype,"interpolation",void 0);w.__decorate([K.property(l.legendEnabled)],T.prototype,"legendEnabled",
void 0);w.__decorate([K.property({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],T.prototype,"isReference",void 0);w.__decorate([K.property({type:["show","hide"]})],T.prototype,"listMode",void 0);w.__decorate([K.property({json:{read:!0,write:!0}})],T.prototype,"blendMode",void 0);w.__decorate([K.property()],T.prototype,"sourceJSON",void 0);w.__decorate([K.property({readOnly:!0,json:{origins:{service:{read:{source:"currentVersion"}}}}})],T.prototype,"version",void 0);
w.__decorate([K.property({readOnly:!0,json:{read:!1}})],T.prototype,"type",void 0);w.__decorate([K.property({type:["ArcGISTiledImageServiceLayer"]})],T.prototype,"operationalLayerType",void 0);w.__decorate([K.property({type:Boolean,value:!0,json:{read:{source:"disablePopup",reader(H,u){return!u.disablePopup}},write:{target:"disablePopup",overridePolicy(){return{enabled:!this.loaded||"Raster"===this.raster.tileType}},writer(H,u,y){u[y]=!H}}}})],T.prototype,"popupEnabled",void 0);w.__decorate([K.property({type:E,
json:{read:{source:"popupInfo"},write:{target:"popupInfo",overridePolicy(){return{enabled:!this.loaded||"Raster"===this.raster.tileType}}}}})],T.prototype,"popupTemplate",void 0);w.__decorate([K.property({readOnly:!0})],T.prototype,"defaultPopupTemplate",null);w.__decorate([K.property({readOnly:!0,type:[a]})],T.prototype,"fields",void 0);w.__decorate([K.property({readOnly:!0,type:[a]})],T.prototype,"rasterFields",null);return T=w.__decorate([n.subclass("esri.layers.ImageryTileLayer")],T)});
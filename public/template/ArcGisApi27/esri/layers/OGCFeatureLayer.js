// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../geometry ../PopupTemplate ../renderers/ClassBreaksRenderer ../renderers/DictionaryRenderer ../renderers/DotDensityRenderer ../renderers/HeatmapRenderer ../renderers/PieChartRenderer ../renderers/Renderer ../renderers/SimpleRenderer ../renderers/UniqueValueRenderer ../renderers/support/jsonUtils ../renderers/support/types ../core/MultiOriginJSONSupport ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ../geometry/support/typeUtils ./Layer ./graphics/sources/OGCFeatureSource ./mixins/APIKeyMixin ./mixins/BlendLayer ./mixins/CustomParametersMixin ./mixins/FeatureEffectLayer ./mixins/FeatureReductionLayer ./mixins/OperationalLayer ./mixins/OrderedLayer ./mixins/PortalLayer ./mixins/RefreshableLayer ./mixins/ScaleRangeLayer ./mixins/TemporalLayer ./support/commonProperties ./support/FeatureType ./support/Field ./support/fieldProperties ./support/fieldUtils ./support/LabelClass ./support/labelingInfo ../rest/support/Query ../support/popupUtils ../geometry/Extent ../geometry/SpatialReference".split(" "),
function(k,c,p,x,U,V,W,X,Y,Z,aa,ba,ca,q,b,d,da,ea,fa,y,r,z,A,B,C,D,E,F,G,H,I,J,K,L,h,M,N,O,n,P,Q,t,R,S,T){p=O.defineFieldProperties();b=function(u){function l(a){a=u.call(this,a)||this;a.capabilities=null;a.collectionId=null;a.copyright=null;a.definitionExpression=null;a.description=null;a.displayField=null;a.elevationInfo=null;a.fields=null;a.fieldsIndex=null;a.fullExtent=null;a.geometryType=null;a.hasZ=void 0;a.labelingInfo=null;a.labelsVisible=!0;a.legendEnabled=!0;a.maxRecordCount=null;a.objectIdField=
null;a.operationalLayerType="OGCFeatureLayer";a.popupEnabled=!0;a.popupTemplate=null;a.screenSizePerspectiveEnabled=!0;a.source=new A.OGCFeatureSource({layer:k._assertThisInitialized(a)});a.spatialReference=null;a.title=null;a.type="ogc-feature";a.typeIdField=null;a.types=null;a.url=null;return a}k._inherits(l,u);var e=l.prototype;e.destroy=function(){this.source?.destroy()};e.load=function(a){this.addResolvingPromise(this.loadFromPortal({supportedTypes:["OGCFeatureServer"]},a).then(()=>this._fetchService(a)));
return this.when()};e.on=function(a,f){return k._get(k._getPrototypeOf(l.prototype),"on",this).call(this,a,f)};e.createPopupTemplate=function(a){return R.createPopupTemplate(this,a)};e.createQuery=function(){return new t};e.getField=function(a){return this.fieldsIndex.get(a)};e.getFieldDomain=function(a,f){let g,m=!1;const v=this.typeIdField&&f?.feature?.attributes?.[this.typeIdField];null!=v&&this.types&&(m=this.types.some(w=>w.id==v?(g=w.domains?.[a],"inherited"===g?.type&&(g=this._getLayerDomain(a)),
!0):!1));m||g||(g=this._getLayerDomain(a));return g};e.queryFeatures=function(a,f){return this.load().then(()=>this.source.queryFeatures(t.from(a)||this.createQuery(),f)).then(g=>{g?.features?.forEach(m=>{m.layer=m.sourceLayer=this});return g})};e.serviceSupportsSpatialReference=function(a){return this.source?.serviceSupportsSpatialReference(a)??!1};e._fetchService=async function(a){await this.source.load(a);this.read(this.source.featureDefinition,{origin:"service"});n.fixRendererFields(this.renderer,
this.fieldsIndex);n.fixTimeInfoFields(this.timeInfo,this.fieldsIndex)};e._getLayerDomain=function(a){if(!this.fields)return null;for(const f of this.fields)if(f.name===a&&f.domain)return f.domain;return null};k._createClass(l,[{key:"defaultPopupTemplate",get:function(){return this.createPopupTemplate()}},{key:"effectiveMaxRecordCount",get:function(){return this.maxRecordCount??this.capabilities?.query.maxRecordCount??5E3}},{key:"isTable",get:function(){return this.loaded&&null==this.geometryType}},
{key:"renderer",set:function(a){n.fixRendererFields(a,this.fieldsIndex);this._set("renderer",a)}}]);return l}(B.APIKeyMixin(D.CustomParametersMixin(F.FeatureReductionLayer(E.FeatureEffectLayer(C.BlendLayer(H.OrderedLayer(L.TemporalLayer(K.ScaleRangeLayer(G.OperationalLayer(I.PortalLayer(J.RefreshableLayer(b.MultiOriginJSONMixin(z)))))))))))));c.__decorate([d.property({readOnly:!0,json:{origins:{service:{read:!0}}}})],b.prototype,"capabilities",void 0);c.__decorate([d.property({type:String,json:{write:!0}})],
b.prototype,"collectionId",void 0);c.__decorate([d.property({type:String})],b.prototype,"copyright",void 0);c.__decorate([d.property({readOnly:!0})],b.prototype,"defaultPopupTemplate",null);c.__decorate([d.property({type:String})],b.prototype,"definitionExpression",void 0);c.__decorate([d.property({readOnly:!0,type:String,json:{origins:{service:{name:"collection.description"}}}})],b.prototype,"description",void 0);c.__decorate([d.property({type:String})],b.prototype,"displayField",void 0);c.__decorate([d.property({type:Number})],
b.prototype,"effectiveMaxRecordCount",null);c.__decorate([d.property(h.elevationInfo)],b.prototype,"elevationInfo",void 0);c.__decorate([d.property({type:[N],json:{origins:{service:{name:"layerDefinition.fields"}}}})],b.prototype,"fields",void 0);c.__decorate([d.property(p.fieldsIndex)],b.prototype,"fieldsIndex",void 0);c.__decorate([d.property({readOnly:!0,type:S,json:{origins:{service:{name:"layerDefinition.extent"}}}})],b.prototype,"fullExtent",void 0);c.__decorate([d.property({type:r.featureGeometryTypeKebabDictionary.apiValues,
json:{origins:{service:{name:"layerDefinition.geometryType",read:{reader:r.featureGeometryTypeKebabDictionary.read}}}}})],b.prototype,"geometryType",void 0);c.__decorate([d.property({type:Boolean,json:{origins:{service:{name:"layerDefinition.hasZ"}}}})],b.prototype,"hasZ",void 0);c.__decorate([d.property({type:Boolean,readOnly:!0})],b.prototype,"isTable",null);c.__decorate([d.property({type:[P],json:{origins:{"web-document":{name:"layerDefinition.drawingInfo.labelingInfo",read:{reader:Q.reader},write:!0}}}})],
b.prototype,"labelingInfo",void 0);c.__decorate([d.property(h.labelsVisible)],b.prototype,"labelsVisible",void 0);c.__decorate([d.property(h.legendEnabled)],b.prototype,"legendEnabled",void 0);c.__decorate([d.property({type:Number})],b.prototype,"maxRecordCount",void 0);c.__decorate([d.property({type:String,json:{origins:{service:{name:"layerDefinition.objectIdField"}}}})],b.prototype,"objectIdField",void 0);c.__decorate([d.property({type:["OGCFeatureLayer"]})],b.prototype,"operationalLayerType",
void 0);c.__decorate([d.property(h.popupEnabled)],b.prototype,"popupEnabled",void 0);c.__decorate([d.property({type:x,json:{name:"popupInfo",write:!0}})],b.prototype,"popupTemplate",void 0);c.__decorate([d.property({types:q.rendererTypes,json:{origins:{service:{name:"layerDefinition.drawingInfo.renderer",write:!1},"web-scene":{types:q.webSceneRendererTypes,name:"layerDefinition.drawingInfo.renderer",write:!0}},name:"layerDefinition.drawingInfo.renderer",write:!0}})],b.prototype,"renderer",null);c.__decorate([d.property(h.screenSizePerspectiveEnabled)],
b.prototype,"screenSizePerspectiveEnabled",void 0);c.__decorate([d.property({readOnly:!0})],b.prototype,"source",void 0);c.__decorate([d.property({readOnly:!0,type:T,json:{origins:{service:{read:!0}}}})],b.prototype,"spatialReference",void 0);c.__decorate([d.property({type:String,json:{write:{enabled:!0,ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"collection.title"}}}})],b.prototype,"title",void 0);c.__decorate([d.property({readOnly:!0,json:{read:!1}})],b.prototype,"type",void 0);c.__decorate([d.property({type:String,
readOnly:!0})],b.prototype,"typeIdField",void 0);c.__decorate([d.property({type:[M]})],b.prototype,"types",void 0);c.__decorate([d.property(h.url)],b.prototype,"url",void 0);return b=c.__decorate([y.subclass("esri.layers.OGCFeatureLayer")],b)});
// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("../../chunks/_rollupPluginBabelHelpers ../../request ../../core/Error ../../core/fontUtils ../../core/promiseUtils ../../support/base64Utils ../../views/2d/engine/webgl/animatedFormats/apng ../../views/2d/engine/webgl/animatedFormats/gif".split(" "),function(n,g,h,p,k,q,l,m){async function r(b,c){b=window.URL.createObjectURL(b);try{const {data:a}=await g(b,{...c,responseType:"image"});return a}catch(a){if(!k.isAbortError(a))throw new h("mapview-invalid-resource",`Could not fetch requested resource at ${b}`);
throw a;}finally{window.URL.revokeObjectURL(b)}}async function t(b,c){const {arrayBuffer:a,mediaType:d}=await u(b,c);b="image/png"===d;if("image/gif"===d&&m.isAnimatedGIF(a))return m.parseGif(a);if(b&&l.isAnimatedPNG(a))return l.parseApng(a,c);b=new Blob([a],{type:d});return r(b,c)}async function u(b,c){if(b.includes(";base64,")){c=b.indexOf(";base64,");var a=b.indexOf(";base64,")+8;a=b.substring(a);a=q.base64ToArrayBuffer(a);b=b.substring(0,c).replace("data:","");a={arrayBuffer:a,mediaType:b}}else try{const d=
await g(b,{responseType:"array-buffer",...c}),e=d.data,f=d.getHeader("Content-Type");a={arrayBuffer:e,mediaType:f}}catch(d){if(!k.isAbortError(d))throw new h("mapview-invalid-resource",`Could not fetch requested resource at ${b}`);}return a}return function(){function b(){this._resourceMap=new Map;this._inFlightResourceMap=new Map;this.geometryEnginePromise=this.geometryEngine=null}var c=b.prototype;c.destroy=function(){this._inFlightResourceMap.clear();this._resourceMap.clear()};c.getResource=function(a){return this._resourceMap.get(a)??
null};c.fetchResource=async function(a,d){var e=this._resourceMap.get(a);if(e)return{width:e.width,height:e.height};if(e=this._inFlightResourceMap.get(a))return e.then(f=>({width:f.width,height:f.height}));e=t(a,d);this._inFlightResourceMap.set(a,e);return e.then(f=>{this._inFlightResourceMap.delete(a);this._resourceMap.set(a,f);return{width:f.width,height:f.height}},()=>({width:0,height:0}))};c.deleteResource=function(a){this._inFlightResourceMap.delete(a);this._resourceMap.delete(a)};c.loadFont=
function(a){return p.loadFont(a)};return n._createClass(b)}()});
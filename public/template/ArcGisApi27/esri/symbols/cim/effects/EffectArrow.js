// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../geometry/GeometryCursor ../../../geometry/geometryCursorCollectUtils ../CIMCursor ../CurveHelper ../enums".split(" "),function(r,p,v,q,w,t,m){const x=m.GeometricEffectArrowType.OpenEnded;let u=function(){function g(){}g.local=function(){null===g.instance&&(g.instance=new g);return g.instance};g.prototype.execute=function(l,h,a,b,c){return new y(l,h,a)};return p._createClass(g)}();u.instance=null;let y=function(g){function l(a,b,c){a=
g.call(this,a,!1,!0)||this;a._curveHelper=new t.CurveHelper;a._width=(void 0!==b.width?b.width:5)*c;a._arrowType=void 0!==b.geometricEffectArrowType?b.geometricEffectArrowType:void 0!==b.arrowType?b.arrowType:x;a._offsetFlattenError=t.PIXEL_TOLERANCE*c;return a}p._inherits(l,g);var h=l.prototype;h.processPath=function(a){const b=v.GeometryCursor.createEmptyOptimizedCIM(a.geometryType);switch(this._arrowType){default:this._constructSimpleArrow(b,a,!0);break;case m.GeometricEffectArrowType.Block:this._constructSimpleArrow(b,
a,!1);break;case m.GeometricEffectArrowType.Crossed:this._constructCrossedArrow(b,a)}return b};h._constructSimpleArrow=function(a,b,c){var d=b.pathLength(),f=this._width;d<2*f&&(f=d/2);var e=this._curveHelper.getSubCurve(b,0,d-f);if(e&&e.nextPath()&&(e.seekPathStart(),d=f/2,!this._curveHelper.isEmpty(e)&&(e=q.collectPath(e),f=this._constructOffset(e,-d)))&&(e=this._constructOffset(e,d))){var k=this._constructArrowBasePoint(f,-d/2);k&&(d=this._constructArrowBasePoint(e,d/2))&&(b.seekInPath(b.numPoints-
1),b=[b.x,b.y],a.pushPath(e),a.nextPath(),a.nextPoint(),a.setControlPoint(),a.pushPoint(d),a.nextPoint(),a.setControlPoint(),a.pushPoint(b),a.nextPoint(),a.setControlPoint(),a.pushPoint(k),a.nextPoint(),a.setControlPoint(),a.pushPoints(f.reverse()),a.setControlPoint(),c||(a.setControlPointAt(0),a.setControlPointAt(a.numPoints-1),a.pushPoint(e[0])),a.reset())}};h._constructCrossedArrow=function(a,b){var c=b.pathLength(),d=this._width;c<3.732050807568877*d&&(d=c/3.732050807568877);b.seekPathStart();
var f=this._curveHelper.getSubCurve(b,0,c-2.732050807568877*d);if(f){f.nextPath();var e=d/2;if(!this._curveHelper.isEmpty(f)){var k=q.collectPath(f);if(f=this._constructOffset(k,e))if(k=this._constructOffset(k,-e))if(c=this._curveHelper.getSubCurve(b,0,c-d))if(c.nextPath(),!this._curveHelper.isEmpty(c)&&(c=q.collectPath(c),d=this._constructOffset(c,e))){var n=this._constructOffset(c,-e);if(n&&(c=d[d.length-1],d=this._constructArrowBasePoint(d,e/2))){var z=n[n.length-1];if(e=this._constructArrowBasePoint(n,
-e/2))b.seekInPath(b.numPoints-1),b=[b.x,b.y],a.pushPath(f),a.nextPath(),a.nextPoint(),a.setControlPoint(),a.pushPoint(z),a.nextPoint(),a.setControlPoint(),a.pushPoint(e),a.nextPoint(),a.setControlPoint(),a.pushPoint(b),a.nextPoint(),a.setControlPoint(),a.pushPoint(d),a.nextPoint(),a.setControlPoint(),a.pushPoint(c),a.nextPoint(),a.setControlPoint(),a.pushPoints(k.reverse()),a.nextPoint(),a.setControlPoint(),a.reset()}}}}};h._constructOffset=function(a,b){return this._curveHelper.offset(a,b,m.GeometricEffectOffsetMethod.Rounded,
4,this._offsetFlattenError)};h._constructArrowBasePoint=function(a,b){if(!a||2>a.length)return null;var c=a[a.length-2];a=a[a.length-1];c=[a[0]-c[0],a[1]-c[1]];this._curveHelper.normalize(c);return[a[0]+c[1]*b,a[1]-c[0]*b]};return p._createClass(l)}(w.PathEffectCursor);r.EffectArrow=u;Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})});
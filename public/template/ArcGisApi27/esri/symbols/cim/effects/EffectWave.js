// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../geometry/GeometryCursor","../enums","../GeometryWalker"],function(q,r,w,p,h){let t=function(){function g(){}g.local=function(){null===g.instance&&(g.instance=new g);return g.instance};g.prototype.execute=function(k,a,b,d,c){return new x(k,a,b)};return r._createClass(g)}();t.instance=null;let x=function(){function g(a,b,d){this._inputGeometries=a;this._height=(void 0!==b.amplitude?b.amplitude:2)*d;this._period=(void 0!==b.period?
b.period:3)*d;this._style=b.waveform;0>=this._height&&(this._height=Math.abs(this._height));0>=this._period&&(this._period=Math.abs(this._period));this._pattern=new h.DashPattern;this._pattern.addValue(this._period);this._pattern.addValue(this._period);this._walker=new h.GeometryWalker;this._walker.updateTolerance(d)}var k=g.prototype;k.next=function(){for(var a=this._inputGeometries.next();a;){if(0===this._height||0===this._period||(a=this._processGeom(a)))return a;a=this._inputGeometries.next()}return null};
k._processGeom=function(a){const b=w.GeometryCursor.createEmptyOptimizedCIM(a.geometryType);for(;a.nextPath();){b.startPath();const d=a.pathLength();if(this._walker.init(a,this._pattern))switch(this._style){default:this._constructCurve(b,d,!1);break;case p.GeometricEffectWaveform.Square:this._constructSquare(b,d);break;case p.GeometricEffectWaveform.Triangle:this._constructTriangle(b,d);break;case p.GeometricEffectWaveform.Random:this._constructCurve(b,d,!0)}else for(;a.nextPoint();)b.pushXY(a.x,
a.y)}return b};k._constructCurve=function(a,b,d){var c=Math.round(b/this._period);0===c&&(c=1);const e=this._period/16,f=1/(16*c+1);b=2*Math.PI*b/(b/c);c=2*Math.PI*Math.random();const y=2*Math.PI*Math.random(),z=2*Math.PI*Math.random(),A=.75-Math.random()/2,B=.75-Math.random()/2,l=new h.Pos;this._walker.curPointAndAngle(l);a.pushPoint(l.pt);let u=0;for(;;)if(this._walker.nextPointAndAngle(e,l)){const n=u;u+=f;let m;if(d){const v=this._height/2*(1+.3*Math.sin(A*b*n+c));m=v*Math.sin(b*n+y);m+=v*Math.sin(B*
b*n+z);m/=2}else m=.5*this._height*Math.sin(.5*b*n);a.pushXY(l.pt[0]-m*l.sa,l.pt[1]+m*l.ca)}else{a.pushPoint(this._walker.getPathEnd());break}};k._constructSquare=function(a,b){Math.round(b/this._period);for(b=!0;;){let d=!1;if(this._walker.curPositionIsValid()){const c=new h.Pos;this._walker.curPointAndAngle(c);const e=new h.Pos;if(this._walker.nextPointAndAngle(this._period,e)){const f=new h.Pos;this._walker.nextPointAndAngle(this._period,f)&&(b?(a.pushPoint(c.pt),b=!1):a.pushPoint(c.pt),a.pushXY(c.pt[0]-
this._height/2*c.sa,c.pt[1]+this._height/2*c.ca),a.pushXY(e.pt[0]-this._height/2*e.sa,e.pt[1]+this._height/2*e.ca),a.pushXY(e.pt[0]+this._height/2*e.sa,e.pt[1]-this._height/2*e.ca),a.pushXY(f.pt[0]+this._height/2*f.sa,f.pt[1]-this._height/2*f.ca),d=!0)}}if(!d){a.pushPoint(this._walker.getPathEnd());break}}};k._constructTriangle=function(a,b){Math.round(b/this._period);for(b=!0;;){let d=!1;if(this._walker.curPositionIsValid()){const c=new h.Pos;this._walker.curPointAndAngle(c);const e=new h.Pos;if(this._walker.nextPointAndAngle(this._period/
2,e)){const f=new h.Pos;this._walker.nextPointAndAngle(this._period,f)&&(this._walker.nextPosition(this._period/2)&&(b?(a.pushPoint(c.pt),b=!1):a.pushPoint(c.pt),a.pushXY(e.pt[0]-this._height/2*e.sa,e.pt[1]+this._height/2*e.ca),a.pushXY(f.pt[0]+this._height/2*f.sa,f.pt[1]-this._height/2*f.ca)),d=!0)}}if(!d){a.pushPoint(this._walker.getPathEnd());break}}};return r._createClass(g)}();q.EffectWave=t;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})});
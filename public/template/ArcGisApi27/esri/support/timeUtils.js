// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define(["exports","../TimeExtent","../core/arrayUtils","../core/promiseUtils","../core/timeUtils"],function(h,f,m,n,k){function p(a){return void 0!==a.timeInfo}h.getTimeExtentFromLayers=async function(a,c){if(0===a.length)return f.allTime;const d=a.filter(p);await Promise.all(d.map(b=>b.load({signal:c})));a=[];var g=[];for(var e of d)"feature"!==e?.type&&"map-image"!==e?.type||!e.timeInfo?.hasLiveData?g.push(e):a.push(e);e=b=>null==b||b.isAllTime;g=g.map(b=>b.timeInfo?.fullTimeExtent);if(g.some(e))return f.allTime;
a=a.map(async b=>{const {timeExtent:l}=await b.fetchRecomputedExtents({signal:c});return l?l:b.timeInfo?.fullTimeExtent});a=(await n.eachAlways(a)).map(b=>b.value);return a.some(e)?f.allTime:[...a,...g].filter(m.isSome).reduce((b,l)=>b.union(l))};h.toLocalTimeExtent=function(a){if(!a)return a;const {start:c,end:d}=a;return new f({start:null!=c?k.offsetDate(c,c.getTimezoneOffset(),"minutes"):c,end:null!=d?k.offsetDate(d,d.getTimezoneOffset(),"minutes"):d})};h.toUTCTimeExtent=function(a){if(!a)return a;
const {start:c,end:d}=a;return new f({start:null!=c?k.offsetDate(c,-c.getTimezoneOffset(),"minutes"):c,end:null!=d?k.offsetDate(d,-d.getTimezoneOffset(),"minutes"):d})};Object.defineProperty(h,Symbol.toStringTag,{value:"Module"})});
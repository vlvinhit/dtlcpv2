// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define(["exports","../symbols/support/unitConversionUtils"],function(e,w){function p(a,b){return null!=b&&b.mode?b.mode:(a?k:l).mode}function q(a,b){return null!=b?b:a?k:l}function m(a,b){return p(null!=a?a.hasZ:!1,b)}function r(a){const b=n(a);return m(a.geometry,b)}function n(a){return a.layer&&"elevationInfo"in a.layer?a.layer.elevationInfo:null}function t(a,b,c,d,f,h,g=null){if(null!=h){var u=null!=g?g.mode:"absolute-height";if("on-the-ground"===u)return 0;({absoluteZ:h}=v(b,c,d,f,a,h));a:{g=
null!=g&&null!=g.offset?g.offset:0;switch(u){case "absolute-height":a=h-g;break a;case "relative-to-ground":a=h-((a.elevationProvider.getElevation(b,c,d,f,"ground")??0)+g);break a;case "relative-to-scene":a=h-((a.elevationProvider.getElevation(b,c,d,f,"scene")??0)+g);break a}a=void 0}return a}}function v(a,b,c,d,f,h){const g=null!=h.offset?h.offset:0;switch(h.mode){case "absolute-height":return{absoluteZ:c+g,elevation:0};case "on-the-ground":return c=f.elevationProvider.getElevation(a,b,0,d,"ground")??
0,{absoluteZ:c,elevation:c};case "relative-to-ground":return a=f.elevationProvider.getElevation(a,b,c,d,"ground")??0,{absoluteZ:c+a+g,elevation:a};case "relative-to-scene":return a=f.elevationProvider.getElevation(a,b,c,d,"scene")??0,{absoluteZ:c+a+g,elevation:a}}}const k={mode:"absolute-height",offset:0},l={mode:"on-the-ground",offset:null};e.absoluteHeightElevationInfo=k;e.elevationContextAffectsAlignment=function(a,b){if(null==b)return!1;({mode:b}=b);return null!=b&&("scene"===a&&"relative-to-scene"===
b||"ground"===a&&"absolute-height"!==b)};e.elevationInfoLikeEquals=function(a,b){return a===b||null!=a&&null!=b&&a.mode===b.mode&&a.offset===b.offset};e.getConvertedElevation=function(a,b,c,d=null){return t(a,b.x,b.y,b.hasZ?b.z:0,b.spatialReference,c,d)};e.getConvertedElevationFromVector=function(a,b,c,d,f=null){return t(a,b[0],b[1],2<b.length?b[2]:0,c,d,f)};e.getEffectiveElevationInfo=q;e.getEffectiveElevationMode=p;e.getGeometryEffectiveElevationInfo=function(a,b){return q(null!=a?!!a.hasZ:!1,b)};
e.getGeometryEffectiveElevationMode=m;e.getGraphicEffectiveElevationInfo=function(a){var b=n(a);a=m(a.geometry,b);b=null!=b&&"on-the-ground"!==a?(b.offset??0)*w.getMetersPerUnit(b.unit??"meters"):0;return{mode:a,offset:b}};e.getGraphicEffectiveElevationMode=r;e.getZForElevationMode=function(a,b,c){if(null!=c&&c.mode){var d=a.hasZ?a.z:0,f=null!=c.offset?c.offset:0;switch(c.mode){case "absolute-height":return d-f;case "on-the-ground":return 0;case "relative-to-ground":return a=(b.elevationProvider.getElevation(a.x,
a.y,d,a.spatialReference,"ground")??0)+f,d-a;case "relative-to-scene":return a=(b.elevationProvider.getElevation(a.x,a.y,d,a.spatialReference,"scene")??0)+f,d-a}}};e.hasGraphicFeatureExpressionInfo=function(a){if("on-the-ground"===r(a))return!1;a=n(a);a=null!=a&&a.featureExpressionInfo?a.featureExpressionInfo.expression:null;return!(!a||"0"===a)};e.onTheGroundElevationInfo=l;e.zValueInAbsoluteHeightMode=v;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});
// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./Analysis ./LineOfSightAnalysisObserver ./LineOfSightAnalysisTarget ../core/Collection ../core/collectionUtils ../core/maybe ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ../geometry/projection ../geometry/support/aaBoundingBox ../support/elevationInfoUtils".split(" "),function(n,d,b,u,v,w,p,x,q,e,E,F,G,y,
z,l,A){const m=w.ofType(v);b=function(r){function g(a){a=r.call(this,a)||this;a.type="line-of-sight";a.observer=null;a.extent=null;return a}n._inherits(g,r);var h=g.prototype;h.initialize=function(){this.addHandles(q.watch(()=>this._computeExtent(),a=>{null!=a&&null!=a.pending||this._set("extent",null!=a?a.extent:null)},q.syncAndInitial))};h.waitComputeExtent=async function(){const a=this._computeExtent();return null!=a?a.pending:Promise.resolve()};h._computeExtent=function(){var a=this.spatialReference;
if(null==this.observer||null==this.observer.position||null==a)return null;const t=f=>"absolute-height"===A.getGeometryEffectiveElevationMode(f.position,f.elevationInfo);var c=this.observer.position;c=l.fromValues(c.x,c.y,c.z,c.x,c.y,c.z);for(const f of this.targets)if(null!=f.position){const k=z.projectOrLoad(f.position,a);if(null!=k.pending)return{pending:k.pending,extent:null};if(null!=k.geometry){const {x:B,y:C,z:D}=k.geometry;l.expandWithVec3(c,[B,C,D])}}a=l.toExtent(c,a);t(this.observer)&&this.targets.every(t)||
(a.zmin=void 0,a.zmax=void 0);return{pending:null,extent:a}};h.clear=function(){this.observer=null;this.targets.removeAll()};n._createClass(g,[{key:"targets",get:function(){return this._get("targets")||new m},set:function(a){this._set("targets",p.referenceSetter(a,this.targets,m))}},{key:"spatialReference",get:function(){return null!=this.observer&&null!=this.observer.position?this.observer.position.spatialReference:null}},{key:"requiredPropertiesForEditing",get:function(){return[x.applySome(this.observer,
a=>a.position)]}}]);return g}(b);d.__decorate([e.property({type:["line-of-sight"]})],b.prototype,"type",void 0);d.__decorate([e.property({type:u,json:{read:!0,write:!0}})],b.prototype,"observer",void 0);d.__decorate([e.property({cast:p.castForReferenceSetter,type:m,nonNullable:!0,json:{read:!0,write:!0}})],b.prototype,"targets",null);d.__decorate([e.property({value:null,readOnly:!0})],b.prototype,"extent",void 0);d.__decorate([e.property({readOnly:!0})],b.prototype,"spatialReference",null);d.__decorate([e.property({readOnly:!0})],
b.prototype,"requiredPropertiesForEditing",null);return b=d.__decorate([y.subclass("esri.analysis.LineOfSightAnalysis")],b)});